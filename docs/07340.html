<html>
<head>
<title>New Year’s Resolution: A DevOps Transformation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新年决心:DevOps转型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/new-years-resolution-a-devops-transformation-aea0e25b4147?source=collection_archive---------11-----------------------#2021-01-05">https://betterprogramming.pub/new-years-resolution-a-devops-transformation-aea0e25b4147?source=collection_archive---------11-----------------------#2021-01-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="20c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们今年转变我们的部署流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6d6bbb09f2d21467c08976566d81a0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gx3Vnxb8UdzTEvb7SHQUUw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">史蒂夫·哈拉马在<a class="ae ky" href="https://unsplash.com/s/photos/circle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="732f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">为什么是DevOps？</h1><p id="9e99" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">DevOps是一种文化转变，将开发和运营结合到一个团队中。自动化框架是成功实施DevOps转型的关键支柱。本文详细介绍了在您的堆栈上实现DevOps的实际步骤。</p><p id="4d5f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">问问你自己:</p><ul class=""><li id="30df" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated">我的开发人员是自动还是手动测试他们的特性？</li><li id="2c2e" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">我的团队会自动集成他们的功能吗？</li><li id="0303" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">我们手工交付工件到生产吗？</li><li id="fb78" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">在提升之前，我们是否证明代码自动工作？</li><li id="ea7a" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">我们是否不断地证明代码在相同的测试中也能工作？</li><li id="9ef3" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">我们是否自动将工作特征发布到生产中？</li><li id="a69e" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">我们能自动恢复生产错误吗？</li></ul><p id="0ed6" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">所有这些阶段都代表了DevOps的成熟度。本文为您提供了一种分解DevOps自动化组件的方法，并计划让2021年成为您的团队实现DevOps的新水平的一年。</p><p id="1b86" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">下图展示了角色、自动化组件和测试类型，用于识别要自动化的阶段和确保成功的策略。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/f2f25be8bc5f859d104c999f24f83fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oquFZxOPU5QEnMVx7M-Quw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DevOps基础架构的自动化组件</p></figure><p id="a979" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">上图中的黄色圆圈表示核心自动化开发过程。</p><ul class=""><li id="f7c4" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated">测试优先开发</li><li id="5541" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">连续累计</li><li id="510c" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">连续交货</li><li id="7acb" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">持续部署</li></ul><p id="45e1" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">蓝色圆圈表示核心自动化操作流程。</p><ul class=""><li id="0521" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated">连续监视</li><li id="a1ed" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">持续恢复</li></ul><p id="5221" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">DevOps的理想是让一个团队通过支持各种箭头指示的所有交互来拥有整个流。</p><p id="c84f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在本文中，我概述了DevOps在2021年走向成熟的三个阶段。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="f6df" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">第一步。自动化开发和集成测试</h1><h2 id="5581" class="no lh it bd li np nq dn lm nr ns dp lq mh nt nu ls ml nv nw lu mp nx ny lw nz bi translated">面向开发自动化的测试优先单元测试</h2><p id="d4fb" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">当开发人员构建一个新特性时，单元测试和回归测试是自动化的两个目标。</p><p id="6b06" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如果你从未读过或尝试过测试优先，那就从<a class="ae ky" href="http://www.extremeprogramming.org/rules/testfirst.html" rel="noopener ugc nofollow" target="_blank"> Ron Jeffries的优秀参考文献</a>开始吧。作为一名开发人员，通过首先编写底层功能的测试，然后使测试成功，来集中精力证明您打算实现的代码是有效的。当您在应用程序中组装组件时，复制该过程。通过这样做，您逐渐构建了一组覆盖单元级代码的回归测试。</p><h2 id="c50c" class="no lh it bd li np nq dn lm nr ns dp lq mh nt nu ls ml nv nw lu mp nx ny lw nz bi translated">烟雾测试和持续集成</h2><p id="5a59" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">一旦开发人员构建了特性，他们就准备好集成工件了。这就是团队实施冒烟测试的地方。为了理解冒烟测试，问问你自己，“在发布过程中什么会出错？”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a1feea4f6cb6f1d4ca44c82eb465b457.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*HK-pKqSR62bSG9hOL2nIHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">工件部署的瀑布</p></figure><p id="bc29" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">发布过程的每一步都涉及到将工件同步到更广阔的环境中。从开发到阶段，发布会影响其他开发人员，因此我们需要确保新环境中没有任何问题。从舞台环境到生产，发布会影响我们的客户，所以我们需要额外的证据来证明没有任何问题。</p><p id="8184" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">人工集成的标志是人工执行烟雾测试任务。例如:</p><ul class=""><li id="1687" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated">点击一个web应用程序并检查它是否正确呈现</li><li id="5010" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">确保运行执行后数据库管道是最新的</li><li id="0048" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated">调用web API并确保结果与期望值相匹配</li></ul><p id="08e5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">要将您的集成从手工过程转换为持续集成，可以从每次您在环境之间升级工件时自动化冒烟测试开始。</p><p id="eb49" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">另外，我特意选择了<em class="ob"> sync </em>这个词，而不是<em class="ob"> copy </em>。在自动化中，动词很重要，而<em class="ob">同步</em>意味着只有已经改变的工件才会被复制。总是通过只发布变更来最小化意外变更的风险。</p><h2 id="ee84" class="no lh it bd li np nq dn lm nr ns dp lq mh nt nu ls ml nv nw lu mp nx ny lw nz bi translated">将自动化测试构建到持续集成中</h2><p id="1463" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">持续集成中自动化测试的反馈循环对于尽早捕捉缺陷至关重要。在开发中解决的缺陷比在生产中发现的缺陷要便宜得多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/08c51514fb5ec5968b637a04fdd55ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cKhYFO5QFgQtjm0fKqC45Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从集成和开发测试中创建冒烟和回归测试</p></figure><p id="ac11" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">手动部署总是有一个重要的QA角色，执行手动测试来发现问题和验证功能。</p><p id="adb4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">当您将您的团队发展成自动化的DevOps团队时，QA的角色是通过在代码中实现冒烟和回归测试，而不是作为点击或手动查询，来发展手动集成测试。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="19a6" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">第二步。持续交付和监控</h1><p id="a0fb" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">当您通过自动化QA和回归测试解决了质量问题，您就为连续交付和监控做好了准备。正如冒烟和回归测试对于持续集成至关重要一样，持续监控对于持续交付也是必不可少的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/ab194fe60a02202eaa2cee197f12affc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDkljtlY0_6dUafZsaF_xA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在连续交付中利用冒烟和回归测试</p></figure><p id="5761" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">operations actor拥有经过测试的“准备部署”的工件，并且可以手动发布它们，但是如果没有持续的监控，这里的流程就不是DevOps。</p><p id="b843" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">连续监控是从步骤1中的烟雾测试和回归组件中自然产生的。我们有快速冒烟测试，因为这些测试需要运行以将工件传递到阶段。此外，回归测试分阶段运行，并验证了更深层次的功能。然后，我们可以在开发和运营中重用相同的代码——这就是DevOps的深层价值点。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="eee3" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">第三步。持续部署和恢复</h1><p id="4402" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">至此，您已经实现了成为DevOps团队的新年愿望，并准备好开始完整的DevOps生命周期:持续部署和恢复。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/aa6557e761b84c94985ef4fc467351d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNp-GbIietHYiuH9B2l9ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成熟开发团队的生命周期</p></figure><p id="b9f5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如何实现连续恢复将取决于您的堆栈。对于数据库，以下是一些标准方法:</p><ul class=""><li id="0afc" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated"><a class="ae ky" href="https://flywaydb.org/" rel="noopener ugc nofollow" target="_blank"> Flyway </a>:详细的变更跟踪和细粒度的恢复</li><li id="7bfe" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated"><a class="ae ky" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_CreateSnapshot.html" rel="noopener ugc nofollow" target="_blank">数据库快照</a>:缺点是经常需要一些停机时间来恢复</li><li id="90f7" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated"><a class="ae ky" href="https://docs.snowflake.com/en/user-guide/data-time-travel.html" rel="noopener ugc nofollow" target="_blank">时间旅行:</a>一些像雪花这样的数据库允许时间旅行，所以你可以实现定制的回滚过程</li></ul><p id="85cc" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">对于web和服务应用程序，部署框架提供了丰富的无缝恢复方法:</p><ul class=""><li id="8f44" class="mz na it ma b mb mu me mv mh nb ml nc mp nd mt ne nf ng nh bi translated"><a class="ae ky" href="https://martinfowler.com/bliki/CanaryRelease.html?ref=wellarchitected" rel="noopener ugc nofollow" target="_blank">金丝雀</a></li><li id="dad4" class="mz na it ma b mb ni me nj mh nk ml nl mp nm mt ne nf ng nh bi translated"><a class="ae ky" href="https://aws.amazon.com/quickstart/architecture/blue-green-deployment/" rel="noopener ugc nofollow" target="_blank">绿色/蓝色</a></li></ul><p id="7a12" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">连续恢复是连续部署的先决条件，因为在自动化部署之前，如果出现问题，您需要自动化回滚。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="6e85" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="c15d" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">如果您有独立的开发和运营团队，2021年可能是将您的组织转变为DevOps团队的一年。要获得灵感，请观看AWS上的<a class="ae ky" href="https://www.youtube.com/watch?v=wugkTArXBYo" rel="noopener ugc nofollow" target="_blank">devo PS简介</a>来理解这个概念。</p><p id="c629" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">同样，DevOps适用于任何开发产品的团队。DevOps团队可以是一组拥有生产分析系统的数据科学家，也可以是一个构建消费者网站的网络团队。从根本上说，这是一种敏捷和持续交付的文化。</p></div></div>    
</body>
</html>