<html>
<head>
<title>How To Handle Spreadsheet Uploads for Your Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为您的Web应用程序处理电子表格上传</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-handle-spreadsheet-uploads-for-your-web-app-70dc266323c3?source=collection_archive---------13-----------------------#2021-04-12">https://betterprogramming.pub/how-to-handle-spreadsheet-uploads-for-your-web-app-70dc266323c3?source=collection_archive---------13-----------------------#2021-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="185e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">管理web应用程序的电子表格导入、映射和验证</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62aa682c7d3a0ffef7e5d6074d6935bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7_WsD3sYFNgIc4Ax"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@homajob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="5ed5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到数据，电子表格非常有用，用途广泛。如果您的web应用程序处理任何类型的数据——从销售渠道到损益表——您可能已经处理过导入CSV文件的问题。</p><p id="722e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CSV上传遇到的第一个问题是数据的格式。例如:</p><ul class=""><li id="a003" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">如果列的名称与您想要的不同(例如，列名为<code class="fe me mf mg mh b">Name</code>而不是<code class="fe me mf mg mh b">FullName</code>)该怎么办？</li><li id="1425" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">如果数据的格式不同(即日期格式为<code class="fe me mf mg mh b">MM-DD-YYYY</code>而不是<code class="fe me mf mg mh b">YYYY-DD-MM</code>)会怎样？</li><li id="0570" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">如果一些数据无效(例如无效的电话号码，如<code class="fe me mf mg mh b">123-456-789</code>)怎么办？</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/0edb969849957e86de6ee7c087a416c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U68_PIjXukTzwi5YbKA7vQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"> unDraw </a></p></figure><p id="95bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于这些可能性，您将意识到您需要某种类型的列映射和验证能力，以便只导入您的web应用程序可以理解的有效数据。</p><p id="f4d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个例子，我将使用新的<a class="ae ky" href="https://github.com/hotgluexyz/gluestick" rel="noopener ugc nofollow" target="_blank"> gluestick库</a>，它有两个部分:</p><ul class=""><li id="6ddc" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://www.npmjs.com/package/gluestick-elements" rel="noopener ugc nofollow" target="_blank"> gluestick-elements </a>:一组React组件，可以轻松地为用户构建直观的导入+验证体验。</li><li id="eafd" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><a class="ae ky" href="https://hub.docker.com/r/hotglue/gluestick-api" rel="noopener ugc nofollow" target="_blank"> gluestick-api </a>:一个Dockerized Python API，处理对导入的CSV数据的解析、验证和映射。它还允许你将数据直接发送到云服务，如S3自动气象站。</li></ul><p id="bbbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢，请随意阅读<a class="ae ky" href="https://docs.gluestick.xyz/" rel="noopener ugc nofollow" target="_blank">胶水棒文档</a>或<a class="ae ky" href="https://bit.ly/2KBGGq1" rel="noopener ugc nofollow" target="_blank">加入他们的松弛部分</a>以获取更多信息。为了给你一些参考，最终结果如下所示(一个互动演示是在CodeSandbox 上提供的<a class="ae ky" href="https://1c1dl.csb.app/" rel="noopener ugc nofollow" target="_blank">):</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/49aacc1e7b8b2cdc937d796fae635ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*b-U0hdf9pkpp1s5jwdPVsg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终的映射流程</p></figure><p id="16d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事不宜迟，让我们开始吧！</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="4ad6" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">后端</h1><p id="bfae" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在我们开始设置前端之前，让gluestick-api在本地机器上运行。在这样做之前，确保你已经安装并运行了Python和<a class="ae ky" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>。</p><p id="d9fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个例子，我们将使用gluestick CLI开始。但是如果你想手动操作，你可以<a class="ae ky" href="https://docs.gluestick.xyz/quickstart/installation#install-gluestick-api" rel="noopener ugc nofollow" target="_blank">遵循文档</a>。</p><h2 id="1ee5" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">安装CLI</h2><p id="84bd" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">让我们从安装CLI开始，它可以在<a class="ae ky" href="https://pypi.org/project/gluestick/" rel="noopener ugc nofollow" target="_blank"> PyPi </a>上获得:</p><pre class="kj kk kl km gt of mh og oh aw oi bi"><span id="268e" class="nt mx it mh b gy oj ok l ol om">$ pip install gluestick</span></pre><h2 id="8e88" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">安装Docker映像</h2><p id="3374" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">现在我们可以获取最新版本的gluestick-api并创建默认配置。我建议在一个唯一的目录中执行此操作。</p><pre class="kj kk kl km gt of mh og oh aw oi bi"><span id="434c" class="nt mx it mh b gy oj ok l ol om">$ mkdir mygluestick-project</span><span id="afe7" class="nt mx it mh b gy on ok l ol om">$ cd mygluestick-project</span><span id="c95e" class="nt mx it mh b gy on ok l ol om">$ gluestick install</span><span id="9155" class="nt mx it mh b gy on ok l ol om">Created default gluestick-api configuration.<br/>Pulling the gluestick-api Docker image...<br/>Using default tag: latest<br/>latest: Pulling from hotglue/gluestick-api<br/>Digest: sha256:6d1a0fdbd884e252a5e6f7abf8f227366b7a1be4fd2ddae4cbd37fe4f217bbcf<br/>Status: Image is up to date for hotglue/gluestick-api:latest<br/>docker.io/hotglue/gluestick-api:latest<br/>Latest gluestick-api Docker image pulled.</span></pre><p id="4097" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里，您现在可以为您的数据配置一个<a class="ae ky" href="https://docs.gluestick.xyz/gluestick-api/configuration#configure-a-target" rel="noopener ugc nofollow" target="_blank">目标，比如AWS S3，但是我们现在将跳过这一部分。</a></p><h2 id="5a08" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">启动API</h2><p id="19b2" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">现在让我们运行API。默认情况下，它从端口<code class="fe me mf mg mh b">5000</code>开始，但是您可以使用<code class="fe me mf mg mh b">--port=$PORT</code>选项更改端口:</p><pre class="kj kk kl km gt of mh og oh aw oi bi"><span id="2081" class="nt mx it mh b gy oj ok l ol om">$ gluestick run</span><span id="87ed" class="nt mx it mh b gy on ok l ol om">Starting gluestick-api...<br/>[2021-04-07 20:30:22 +0000] [1] [INFO] Starting gunicorn 20.1.0<br/>[2021-04-07 20:30:22 +0000] [1] [INFO] Listening at: <a class="ae ky" href="http://0.0.0.0:5000" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:5000</a> (1)<br/>[2021-04-07 20:30:22 +0000] [1] [INFO] Using worker: sync<br/>[2021-04-07 20:30:22 +0000] [9] [INFO] Booting worker with pid: 9</span></pre><p id="dd23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！现在，我们可以继续配置前端了。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="b18d" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">前端</h1><p id="d10b" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">现在我们可以在React应用程序中配置<code class="fe me mf mg mh b">gluestick-elements</code>库了。</p><p id="c246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想继续，这个例子的代码可以在<a class="ae ky" href="https://codesandbox.io/s/gluestick-demo-1c1dl" rel="noopener ugc nofollow" target="_blank"> CodeSandbox </a>上找到:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="20ec" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">安装软件包</h2><p id="e82f" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">让我们通过npm安装软件包:</p><pre class="kj kk kl km gt of mh og oh aw oi bi"><span id="59cc" class="nt mx it mh b gy oj ok l ol om">npm install --save gluestick-elements</span></pre><h2 id="7756" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">元素‌Add</h2><p id="5e7d" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">现在我们可以将React元素添加到我们的项目中了！下面是一个带有<code class="fe me mf mg mh b"><a class="ae ky" href="https://docs.gluestick.xyz/gluestick-elements/gluestick" rel="noopener ugc nofollow" target="_blank">GlueStick</a></code> <a class="ae ky" href="https://docs.gluestick.xyz/gluestick-elements/gluestick" rel="noopener ugc nofollow" target="_blank">组件</a>的简单例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq op l"/></div></figure><h2 id="46dc" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">测试元素</h2><p id="d3b1" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">现在一切都在运行，我们可以测试整个流程了！如果你需要一些测试数据，你可以下载一个<a class="ae ky" href="https://cdn.statically.io/gh/hotgluexyz/recipes/master/src/sync-output/Lead-20210128T125258.csv" rel="noopener ugc nofollow" target="_blank">样本</a>T4。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/49aacc1e7b8b2cdc937d796fae635ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*b-U0hdf9pkpp1s5jwdPVsg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终的映射流程</p></figure><p id="d7cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">gluestick将执行以下操作:</p><ol class=""><li id="736e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu or mb mc md bi translated">解析输入CSV文件并确定可用的列。</li><li id="73a0" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu or mb mc md bi translated">挑选最匹配的列名作为建议的映射，并运行任何验证。</li><li id="9c95" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu or mb mc md bi translated">向用户显示任何无效行，并告诉他们有效信息占数据的百分比。</li><li id="db97" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu or mb mc md bi translated">向用户预览最终数据。</li><li id="8b57" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu or mb mc md bi translated">将数据发送到最终目的地(S3、谷歌云存储等)。).</li></ol></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="695b" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">结论</h1><p id="6c33" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">这就是全部了！下一步是<a class="ae ky" href="https://docs.gluestick.xyz/gluestick-elements/schema" rel="noopener ugc nofollow" target="_blank">定制您想要的文件的模式</a>和<a class="ae ky" href="https://docs.gluestick.xyz/gluestick-api/configuration#configure-a-target" rel="noopener ugc nofollow" target="_blank">配置您想要的任何目标</a>。</p><p id="a7e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对gluestick感兴趣，我推荐你看看<a class="ae ky" href="https://docs.gluestick.xyz/" rel="noopener ugc nofollow" target="_blank">的文档</a>。</p><p id="bcdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我非常乐意回答下面的任何问题。感谢阅读！</p></div></div>    
</body>
</html>