# 理解和应用 JavaScript 中的闭包

> 原文：<https://betterprogramming.pub/understanding-and-applying-closures-in-javascript-c0a321e59f1f>

## 尽可能用最简单的方式学习闭包

![](img/929dc08f267e02f73fa8dd01b941fa62.png)

照片由 [Dragos Gontariu](https://unsplash.com/@dragos126?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄。

我记得我第一次遇到术语*闭包*。It 在 Instagram 上发布了一些重要的 JavaScript 话题。

看到这个帖子后，我试着找了一个关于闭包的简单教程。我看了这么多例子，但我还是不明白。我在网上遇到的大多数教程都没有给出可以轻松实现的真实例子。这让我很难知道如何以及在哪里使用闭包。

在某些时候，我想到了忘记这个主题，转到其他 JavaScript 主题。关闭可能确实看起来势不可挡。

然而，一旦你掌握了其中的诀窍，你会立刻成为一名更好的程序员。

# 闭包到底是什么

闭包是 JavaScript 上的一个特性，它允许您从嵌套函数或子函数中访问父函数的作用域。

最简单的形式是，闭包是保存数据的函数。每次创建函数时都会创建一个闭包。

闭包让我们能够将数据存储在一个单独的范围内，只在需要的时候访问它。

我们需要闭包的一个简单原因是为了给我们的一些数据隐私。有时，我们希望定义只能从脚本的特定部分访问的变量。闭包最适合这种情况。

## 简单的例子

在本例中，我们将创建一个嵌套在另一个函数中的函数。子函数访问存储在父函数中的变量:

这里，我们有一个名为`returnMsg`的函数，它可以访问父函数`writeMsg`的变量。这意味着`returnMsg`可以访问`msg`变量。在这个例子中，`returnMsg`是闭包。

## 实际例子

当您想要将数据与操作该数据的函数相关联时，闭包会非常方便。这类似于面向对象的编程，其中对象允许您将对象的属性与一个或多个方法相关联。

因此，您可以在任何通常只使用一个方法的地方使用闭包。

您可能希望这样做的情况很常见。用 frontend JavaScript 编写的大部分代码都是基于事件的(只有当用户以某种方式与网页交互时才生效)。您定义一些行为，然后将它附加到由用户启动的事件(如单击或双击)。代码作为回调(响应事件而执行的单个函数)附加。

例如，假设我们想在页面上添加按钮，以便在用户点击任何按钮时调整`div`元素的宽度和高度:

这里，宽度和高度首先分别设置为 60px 和 50px。我们创建了三个按钮。每当用户点击时，它们都会将`div`元素增大到一个特定的大小。每个按钮调用一个功能。

增量由`adjust`函数中的`adjustOne`、`adjustTwo`和`adjustThree`函数完成。

## 另一个例子

假设我们想要创建一个计数器，当用户点击一个按钮时，它增加拍手的次数:

创建自调用的父箭头功能。拍手次数首先在父函数`addClap`中初始化为`0`。子函数用于在用户点击按钮时将计数器加 1。

由此，我们可以看到`clapCounter`变量是在子函数外部声明的，但是我们能够从内部访问它。

这基本上是最简单的闭包形式。

# 关闭范围系列

一个闭包有三个范围系列:

*   词法范围或静态范围。这个作用域访问它自己的变量。
*   父函数范围。该作用域访问其父函数的变量。
*   全球范围。这将访问函数之外的任何变量(即全局变量)。

## 词汇范围

词法范围意味着在一个函数外部定义的变量可以在另一个函数内部访问。然而，反之则不成立。在内部函数中定义的变量不能在该函数外部访问。

这意味着父函数的变量可以被它们的子函数访问，但是子函数的变量不能被父函数访问。

假设我有一个内部定义了变量的父函数`x`和一个内部也定义了变量的子函数`y`。`y`的变量只能在`y`内部访问。它是私有的，而`x`的变量可以在`x`和`y`两个函数中访问。

词法范围也称为静态范围。词法范围的概念在闭包中被广泛使用。

一个演示词法范围的简单示例:

在上面的代码片段中，创建了两个函数:`myFunction()`和`mySecondFunc()`。`myFunction()`是具有函数作用域的父函数，而`mySecondFunc()`是具有词法作用域的子函数。两个函数内部都定义了变量(分别为`age`和`hobby`)。

`age`变量可以从两个函数内部访问，但是`hobby`变量只能在`mySecondFunc()`函数内部访问。

`name`变量具有全局作用域，因此可以从脚本中的任何地方访问它。

提示:避免使用全局变量。

# 结论

这就是我对闭包的概述。您可能一直在使用闭包，甚至没有意识到这一点，但是如果您没有，请尝试一下。

从现在开始，当你在你的代码或者任何你在网上看到的代码中看到闭包时，你可以很容易地指出它们，看到它们在做什么，以及为什么它们被使用。

除了练习，别无他法。你现在已经有了基本的知识。深入研究一些现有的代码——无论是您的代码还是您能找到的任何代码——并尝试识别闭包以及为什么使用它们。使用闭包练习得越多，对主题的理解就越好。

感谢阅读。我希望这篇文章能帮助您更好地理解闭包。

如果你有任何问题，请在评论中向我提问！