<html>
<head>
<title>Unused Images and Resources Clean Up in Xcode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Xcode会清理未使用的图像和资源</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/unused-images-and-resources-clean-up-in-xcode-2fa68b4e202b?source=collection_archive---------11-----------------------#2019-07-23">https://betterprogramming.pub/unused-images-and-resources-clean-up-in-xcode-2fa68b4e202b?source=collection_archive---------11-----------------------#2019-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="70b1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何轻松清理项目中未使用的图像和资源</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/428934fe4d058a6c8561b2f4c9757f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXkFt_Kh3w1cWzhgpIIcoA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/woman-sitting-while-operating-macbook-pro-1181676/" rel="noopener ugc nofollow" target="_blank">克里斯蒂娜·莫里洛</a>在<a class="ae ky" href="https://www.pexels.com/photo/woman-sitting-while-operating-macbook-pro-1181676/" rel="noopener ugc nofollow" target="_blank">的像素</a>上拍摄</p></figure><p id="7bfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">未使用的图像可以作为项目中不同迭代的结果而存在。一旦某个功能不再需要并被删除，它并不总是被完全清除。因此，知道如何清理Xcode资产是很有用的。</p><p id="4a2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像我在关于<a class="ae ky" href="https://www.avanderlee.com/xcode/unused-localized-strings/" rel="noopener ugc nofollow" target="_blank">清理未使用的本地化字符串</a>的博文中一样，我将介绍几个你可以用来清理你的项目的工具:</p><ul class=""><li id="fed9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://github.com/onevcat/FengNiao/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">蜂鸟</a></li><li id="eb7b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://github.com/tinymind/LSUnusedResources" rel="noopener ugc nofollow" target="_blank"> LSUnusedResources </a></li></ul><p id="78fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，很多像<a class="ae ky" href="https://www.macupdate.com/v1/app/mac/41546/slender" rel="noopener ugc nofollow" target="_blank">细长</a>这样曾经用来做这项工作的工具不再被维护。所以，我们来看看<em class="mj">现在的</em>都在干嘛！</p><p id="b598" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我将使用我的日常工作项目<a class="ae ky" href="https://collect.wetransfer.com/" rel="noopener ugc nofollow" target="_blank">通过WeTransfer </a>收集。这个项目的资产已经两年没有清理了。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="2d25" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">使用蜂鸟清理未使用的图像</h1><p id="2e6f" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">风鸟是一个命令行工具，大部分是用Swift编写的。它是开源的，可以在Github上获得。可以通过克隆存储库并运行安装脚本来安装它:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="6076" class="nt ms it np b gy nu nv l nw nx">&gt; git clone https://github.com/onevcat/FengNiao.git<br/>&gt; cd FengNiao<br/>&gt; ./install.sh</span></pre><p id="1564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用它非常简单，只需在终端中将目录切换到您的项目文件夹，然后执行FengNiao:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="78a8" class="nt ms it np b gy nu nv l nw nx">&gt; fengniao</span></pre><p id="e82c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将首先向您显示结果，然后您可以选择删除、忽略或列出未使用的资源。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="9ce2" class="nt ms it np b gy nu nv l nw nx">Searching unused file. This may take a while...<br/>218 unused files are found. Total Size: 19.09 MB<br/>What do you want to do with them? (l)ist|(d)elete|(i)gnore</span></pre><p id="2c1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列出这些文件表明也检查了依赖项。显然，我们不想关注这些，因为它们不受我们的管理。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="4db0" class="nt ms it np b gy nu nv l nw nx">1.57 KB /Users/antoinevanderlee/Documents/GIT-Projects/WeTransfer/Coyote/Submodules/Rabbit/Submodules/Alamofire/docs/docsets/Alamofire.docset/Contents/Resources/Documents/img/gh.png</span></pre><p id="096f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了列出依赖项资产，该工具还列出了文档文件夹的图像。因此，我们需要使用一些额外的选项再次运行该工具。</p><p id="47f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用— help参数列出所有可用的选项。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="932d" class="nt ms it np b gy nu nv l nw nx">$ fengniao --help<br/>Usage: fengniao [options]<br/>  -p, --project:<br/>      Root path of your Xcode project. Default is current folder.<br/>  --force:<br/>      Delete the found unused files without asking.<br/>  -e, --exclude:<br/>      Exclude paths from search.<br/>  -r, --resource-extensions:<br/>      Resource file extensions need to be searched. Default is 'imageset jpg png gif'<br/>  -f, --file-extensions:<br/>      In which types of files we should search for resource usage. Default is 'm mm swift xib storyboard plist'<br/>  --skip-proj-reference:<br/>      Skip the Project file (.pbxproj) reference cleaning. By skipping it, the project file will be left untouched. You may want to skip ths step if you are trying to build multiple projects with dependency and keep .pbxproj unchanged while compiling.<br/>  --version:<br/>      Print version.<br/>  -h, --help:<br/>      Print this help message.</span></pre><p id="2112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">排除选项是我们需要的选项。在查看了为Collect列出的所有路径之后，我们发现可以忽略相当多的路径。这会产生以下命令:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="77bb" class="nt ms it np b gy nu nv l nw nx">fengniao --exclude Carthage Pods Submodules Vendor guides fastlane</span></pre><p id="e6c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这告诉工具忽略包含依赖项的文件夹，以及我们的文档和浪子文件夹。最终结果包含44个要清理的未使用资源:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/c041e810384530307760b06cbd84bca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z3EDzARoTJ_sS-ky.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用蜂鸟清理未使用的图像</p></figure><p id="9d57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了验证这些是未使用的资产，我随机挑选了一些，并在Xcode中进行了搜索。事实证明，这些资产确实是闲置的，可以清理掉。</p><p id="56c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再次运行该工具证明了它的预期工作！</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ea29" class="nt ms it np b gy nu nv l nw nx">$ fengniao --exclude Carthage Pods Submodules Vendor guides fastlane<br/>Searching unused file. This may take a while...<br/>😎 Hu, you have no unused resources in path: /Users/antoinevanderlee/Documents/GIT-Projects/WeTransfer/Coyote.</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="c97f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">使用LSUnusedResources清理未使用的图像</h1><p id="95a8" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated"><a class="ae ky" href="https://github.com/tinymind/LSUnusedResources" rel="noopener ugc nofollow" target="_blank"> LSUnusedResources </a>是一款Mac app，做的事情和风鸟一模一样:清理不用的图片和资源。它也是开源的，但是不再维护了。在撰写本文时，最后一次提交已经追溯到一年前。然而，它仍然运行，因此值得一试！</p><p id="7291" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可执行文件可以从Github页面下载。它可能会告诉你打开它不安全。如果有，可以用Control + Open打开。在使用默认设置运行它之后，它显示了与FengNiao几乎相同的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/175f7afe927717cb645e31709fb61d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7omrMnbm8Tpb3pKa.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">未使用的图像导致LSUnusedResources</p></figure><p id="ce03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像我们对FengNiao所做的那样，我们现在应该用排除的文件夹再次运行它。我们必须通过用管道符号分隔文件夹来填充资源后缀:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c028" class="nt ms it np b gy nu nv l nw nx">Carthage|Pods|Submodules|Vendor|guides|fastlane</span></pre><p id="d1fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="37f5" class="nt ms it np b gy nu nv l nw nx">Total: 106, unused: 21, time: 1.53s, size: 328.92</span></pre><p id="9e0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都是未使用的资产，可以使用应用程序中的删除按钮轻松删除。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="c35c" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">比较结果:蜂鸟还是未使用的资源？</h1><p id="25d1" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">比较这两种结果显示了一些巨大的差异:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="6e14" class="nt ms it np b gy nu nv l nw nx">FengNiao:          44 unused files / Total Size: 440.06 KB<br/>LSUnusedResources: 21 unused files / Total Size: 328.92 KB</span></pre><p id="c173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">起初，这似乎主要与Coyote中的两个扩展目标有关。FengNiao正确地检查了这些，但是LSUnusedResources似乎忽略了它们。</p><p id="f12c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了完全确定，我为每个工具创建了一个分支，并比较了变化。这证实了蜂鸟做得更好，找到了更多的闲置资源。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ad5a" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">清理那些不用的图像总是安全的吗？</h1><p id="3afe" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">肯定不是！在删除资产之前，最好仔细检查一下。有一个常见的例子，资产被使用，但仍然被列为未使用。这是当您基于某些条件建立对资源的引用时。</p><p id="2824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在Coyote中，我们使用以下代码:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="d574" class="nt ms it np b gy nu nv l nw nx">UIImage(named: "\(iconName)\(iconSize.sizeString)")</span></pre><p id="fc29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是，所有这些图像都在两个结果中列出，因此在删除图像之前需要手动检查结果。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="17b2" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">额外收获:清理你的Xcode开发者文件</h1><p id="d04d" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">既然你已经开始清理了，那么也清理一下你的Xcode开发者文件怎么样？</p><p id="5c30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一个很棒的工具叫做<a class="ae ky" href="https://github.com/vashpan/xcode-dev-cleaner" rel="noopener ugc nofollow" target="_blank"> DevCleaner </a>，它可以很容易地为你删除高达20GB的未使用数据。这是我第一次运行它后看到的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/3d90899742284e088a5599c4f24aa1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2mS0EfNM6eN0XI5J.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用DevCleaner清理Xcode开发者文件</p></figure><p id="a220" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要知道这个应用会默认删除你所有旧的iOS版本。例如，在我的例子中，它选择了所有的iOS 11和12设备支持文件，只给我留下了iOS 13的设备支持。这显然不是你想要的。因此，仔细选择并根据你的需要进行调整。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="0d46" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="1749" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">清理您的项目以删除未使用的图像绝对值得一试。这将使您的项目保持整洁，没有您不再使用的资产。保持警惕，在删除之前手动检查结果。</p></div></div>    
</body>
</html>