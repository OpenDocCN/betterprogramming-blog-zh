<html>
<head>
<title>Beginning Python Programming — Part 11</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python编程入门—第11部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/beginning-python-programming-part-11-1dc915b4f0fd?source=collection_archive---------9-----------------------#2019-06-10">https://betterprogramming.pub/beginning-python-programming-part-11-1dc915b4f0fd?source=collection_archive---------9-----------------------#2019-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8a62" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用模块和虚拟环境</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/81f5f3ea638c3fccac7c59a570f81075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_FhbfLgo1iYhB1cS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">里卡多·维亚纳在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7005" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上一篇文章中，我们介绍了如何构建代码的技巧、PEP 8格式指南以及一些编码原则。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/better-programming/beginning-python-programming-part-10-afd00b71f04e" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python编程入门—第10部分</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">在上一篇文章中，我们讨论了与错误相关的所有内容，以帮助减少程序中的错误数量。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="fbb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，我们将介绍更多的工具来帮助您保持代码的整洁，以及防止您重复发明轮子的常见实践。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7bc2" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">包装</h1><p id="d436" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">包是包含项目可重用代码的独立项目，与其他语言中的库或框架同义。</p><p id="f525" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么一个包裹里装的是什么呢？</p><p id="cf75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您希望在其他项目中重用的代码之外，一个包由一个<code class="fe nr ns nt nu b">README.md</code>、一个<code class="fe nr ns nt nu b">LICENSE</code>和一个<code class="fe nr ns nt nu b">setup.py</code>文件组成。</p><ul class=""><li id="e5fd" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">README.md</code> (markdown) —包含关于您的软件包的信息，可用于了解您的软件包的用途。</li><li id="a553" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">LICENSE</code> —这是许可协议或使用条款。用这个让其他人知道他们是否需要给你信用，他们是否可以将它用于商业应用，他们是否可以进行修改和重新分发，如果你不承担损害赔偿责任，等等。</li><li id="9c92" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">setup.py</code> —这在您首次安装软件包时运行。它告诉Python任何依赖关系，并提供关于您的包的元数据，这些元数据将从包存储库中显示给用户。</li></ul><p id="961e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在所有这些中，<code class="fe nr ns nt nu b">setup.py</code>是最重要的，因为它是你的软件包如何安装的。</p><p id="9246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我阅读许可证时，我总是被一些事情逗笑，当程序打印“你好，世界！”时，有人包括“对所造成的损害不承担责任”</p><p id="c8c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">撇开笑不谈，当你与世界分享你的代码时，这和setup.py一样重要。虽然您可能通过编写一个有益的程序为世界做了一件好事，但如果它不能与特定版本的Python一起工作，并且您的程序损坏了系统，那么您将承担责任，即使最终用户是最终决定在他们的计算机上运行您的程序的人。</p><p id="ba8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python有数千个包可供您使用。我使用过连接到LDAP服务器的包来对用户执行工作，使用过远程SSH到另一台机器来运行脚本的包，使用过运行web服务器的包，等等。</p><p id="e0a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给出这些例子，你可能对别人写了什么有一个很好的想法，以及你能写什么的一些方向。当你开始使用软件包时，你会对你能用它们做什么有更多的想法。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="adac" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">Pip命令</h1><p id="c056" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我们可以使用<code class="fe nr ns nt nu b">pip</code>命令下载软件包。<code class="fe nr ns nt nu b">pip</code>利用一个名为<a class="ae ky" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> Python包索引(简称Pypi </a>)的在线包存储库。</p><p id="9dda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在早期的Python版本中，<code class="fe nr ns nt nu b">pip</code>不包含在内。在Linux操作系统上，有一个名为<code class="fe nr ns nt nu b">python-pip</code>或<code class="fe nr ns nt nu b">python36-pip</code>的安装包。</p><p id="9a5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">pip</code>是一个简单的实用程序。与<code class="fe nr ns nt nu b">apt</code>、<code class="fe nr ns nt nu b">yum</code>或<code class="fe nr ns nt nu b">brew</code>非常相似，您可以搜索包，获取关于包的信息，或者安装和删除包。</p><p id="7e72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最常用的几个命令是:</p><ul class=""><li id="aff8" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip search &lt;package_name&gt;</code> —搜索要安装的软件包</li><li id="efcc" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip list</code> —列出所有已安装的软件包</li><li id="03ee" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip info &lt;package_name&gt;</code> —获取关于已安装软件包的信息</li><li id="24f6" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip freeze</code> —以需求格式提供已安装软件包的列表(稍后将详细介绍)</li><li id="ab0d" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip install &lt;package_name&gt;</code> —安装软件包或以逗号分隔的软件包列表；使用<code class="fe nr ns nt nu b">pip install -U &lt;package_name&gt;</code>将软件包升级到其最新版本。</li><li id="4e25" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip uninstall &lt;package_name&gt;</code> —卸载软件包或以逗号分隔的软件包列表</li></ul><p id="5655" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本系列的前面，我说过我使用<a class="ae ky" href="https://github.com/python/black" rel="noopener ugc nofollow" target="_blank">黑色</a>来格式化我的代码。这通常是我在所有电脑上安装的第一个软件包。这个想法来自亨利·福特关于t型车颜色的<a class="ae ky" href="http://oplaunch.com/blog/2015/04/30/the-truth-about-any-color-so-long-as-it-is-black/" rel="noopener ugc nofollow" target="_blank">名言</a></p><p id="142d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您希望使用它，可以使用以下命令安装它:</p><p id="08ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">pip install black</code></p><p id="c8d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用其他格式化程序，但是我不太关心它们如何缩进我的代码。这完全是主观的，所以我强烈建议你在决定一个之前把它们都检查一遍。</p><p id="ab92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="oj ok ep" href="https://medium.com/u/35ebb723d4a4?source=post_page-----1dc915b4f0fd--------------------------------" rel="noopener" target="_blank"> Kevin Peters </a>已经写了一篇关于Python格式化程序的很棒的文章，所以如果你想做自己的研究，我会推荐你参考他的文章。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/3yourmind/auto-formatters-for-python-8925065f9505" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python的自动格式化程序👨‍💻🤖</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">正如你在最近的栈溢出开发者调查中看到的，Python是最流行的编程语言之一…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="ol l mj mk ml mh mm ks ly"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/d1a2e16e896a94e92811a4c11b18c65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j7LBWVE3_nZuqgqS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@fellowferdi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">费迪南·斯托尔</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="59c6" class="mu mv it bd mw mx on mz na nb oo nd ne jz op ka ng kc oq kd ni kf or kg nk nl bi translated">虚拟环境</h1><p id="67d5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">安装包时，会将它们安装到系统Python包目录中。虽然一开始可能不明显，但在您创建了多个项目之后，这可能会产生问题。</p><p id="f3b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，项目A依赖于Django 1.11，而项目B依赖于Django 2.1。系统一次只能处理Django的一个版本，这意味着当我们试图修复另一个项目时，其中一个项目会被破坏。</p><p id="9e6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入虚拟环境。</p><p id="5c1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虚拟环境允许您创建一个项目本地Python目录来存储该项目的所有依赖项。这意味着项目A可以在本地安装Django 1.11，而项目B可以在本地安装Django 2.1。</p><p id="cb43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种工作方式不太专业，Python创建了一个文件夹，该文件夹将可执行文件链接回创建它的Python版本。这允许您在具有多个依赖项的多个项目中使用同一个Python解释器。</p><p id="601d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很棒，对吧？不幸的是，这个令人敬畏的工具也是一把双刃剑。如果您更新创建这个虚拟环境的Python解释器，它可能会破坏您的代码或虚拟环境。有些包仅针对特定版本的Python而设计，并利用了不推荐使用的功能。当您更新到删除这些不推荐使用的功能的版本时，它会破坏包。不酷，对吧？当然，这无论如何都会发生，但这仍然是一个真实的暗示。记住，你不是复制Python解释器，只是链接回它。</p><h2 id="c00f" class="os mv it bd mw ot ou dn na ov ow dp ne li ox oy ng lm oz pa ni lq pb pc nk pd bi translated">我们如何创建一个虚拟环境？</h2><p id="8cc6" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">同样，如果您使用的是没有安装pip的Linux发行版，那么您可能也需要安装虚拟环境包。你可以通过安装名为<code class="fe nr ns nt nu b">python-venv</code>或<code class="fe nr ns nt nu b">python36-venv</code>的包来实现。(如果你想知道，像CentOS这样的发行版默认<code class="fe nr ns nt nu b">python</code>是指Python 2，而<code class="fe nr ns nt nu b">python36</code>是指Python 3.6。)</p><p id="6a61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装之后，您应该使用<code class="fe nr ns nt nu b">cd</code>切换到应该保存您的项目的目录，然后使用以下命令在您的项目文件夹中创建一个虚拟环境目录:</p><p id="1b70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">python -m venv venv</code></p><p id="ad48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是告诉<code class="fe nr ns nt nu b">python</code>使用<code class="fe nr ns nt nu b">-m</code>模块<code class="fe nr ns nt nu b">venv</code>在名为<code class="fe nr ns nt nu b">venv</code>的文件夹中创建一个虚拟环境。您可以随意命名<code class="fe nr ns nt nu b">venv</code>文件夹，但是大多数教程和项目都使用<code class="fe nr ns nt nu b">venv</code>。在*nix系统上，使用<code class="fe nr ns nt nu b">.venv</code>隐藏文件夹是可以接受的。</p><p id="296a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想使用不同于系统默认版本的Python，请使用以下命令:</p><pre class="kj kk kl km gt pe nu pf pg aw ph bi"><span id="eef7" class="os mv it nu b gy pi pj l pk pl">/path/to/other/pythonx.x -m venv venv</span></pre><p id="c4d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您查看新创建的venv文件夹，您会看到以下文件夹:</p><ul class=""><li id="97e2" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">bin/</code> —包含用于此虚拟环境的Python可执行文件的链接。</li><li id="e7c9" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">lib/</code> —包括安装到此虚拟环境中的软件包，如Django或Black</li><li id="6332" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">include/</code> —包含用于编译python包的C头文件</li><li id="1b79" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pyvenv.cfg</code> —包含关于此虚拟环境的配置信息</li><li id="7108" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated"><code class="fe nr ns nt nu b">pip-selfcheck.json</code> —包含关于虚拟环境中pip的元数据。</li></ul><p id="35ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建虚拟环境后，您需要激活虚拟环境；否则，您仍将使用和安装默认Python解释器的包。您可以使用以下命令完成此操作:</p><p id="ae19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Linux和macOS上:<br/> <code class="fe nr ns nt nu b">source venv/bin/activate</code></p><p id="1324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Windows上:<br/> <code class="fe nr ns nt nu b">venv/bin/activate</code></p><p id="760c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Windows上，<code class="fe nr ns nt nu b">activate</code>是到激活虚拟环境的<code class="fe nr ns nt nu b">activate.bat</code>的链接。在*nix系统上，<code class="fe nr ns nt nu b">activate</code>是一个shell脚本，当用作内置<code class="fe nr ns nt nu b">source</code>命令的参数时，它会做同样的事情。</p><p id="bd1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你在命令提示符前看到<code class="fe nr ns nt nu b">(venv)</code>时，你就知道它被激活了。</p><p id="b30d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要退出虚拟环境的命令提示符，可以使用<code class="fe nr ns nt nu b">deactivate</code>。</p><p id="bd3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 开始安装包之前，一定要确保虚拟环境已经激活<strong class="lb iu"> <em class="pm">。有些包，比如formatters和linters，你可以全局安装，因为你几乎可以保证在所有项目中使用它们。其他的包，比如ansible，是作为全局包安装的；但是，当包或依赖项与项目中的包或依赖项冲突时，您仍然可以使用虚拟环境来安装这些包的旧版本。</em></strong></p><p id="1419" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pm">linter是用来对你的代码进行静态分析的工具；它们确保您遵守最佳实践。</em><a class="oj ok ep" href="https://medium.com/u/8832e1dc427b?source=post_page-----1dc915b4f0fd--------------------------------" rel="noopener" target="_blank"><em class="pm">Itech</em></a><em class="pm"/><a class="ae ky" href="https://medium.com/python-pandemonium/what-is-flake8-and-why-we-should-use-it-b89bd78073f2" rel="noopener"><em class="pm">在flake8 </em> </a> <em class="pm">上写了一个帖子，其中包括其他人如果你想了解更多关于林挺的信息。林挺不同于自动格式化程序；它只显示项目中有问题的代码；它不会改变代码的布局，也不会为您修复这些问题。在PyCharm中，我用</em><a class="ae ky" href="https://plugins.jetbrains.com/plugin/7973-sonarlint" rel="noopener ugc nofollow" target="_blank"><em class="pm">sonar lint</em></a><em class="pm">来拯救我不做傻事。</em></p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/afd360d3a8493ba7f541ab5dcdccee8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2kR4XT8Lwr_cLurH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f95f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pm">有趣的事实:</em> <a class="ae ky" href="https://www.wired.com/story/the-matrix-code-sushi-recipe/" rel="noopener ugc nofollow" target="_blank"> <em class="pm">《黑客帝国》中的电脑屏幕是根据寿司食谱</em> </a> <em class="pm">制作的。</em></p><h1 id="5452" class="mu mv it bd mw mx on mz na nb oo nd ne jz op ka ng kc oq kd ni kf or kg nk nl bi translated">高级设置</h1><p id="2dec" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">最近，一位同事向我介绍了几个非常酷的实用程序。第一个是<a class="ae ky" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank"> pyenv </a>。Pyenv允许你在不影响系统Python的情况下，在你的电脑上管理多个版本的Python。</p><p id="fb0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在*nix机器上更新系统Python被认为是有害的，因为一些内置应用程序可能需要特定版本的Python。如果您覆盖它，您可能会破坏您的系统。这就是pyenv帮忙的原因。</p><p id="8fbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装非常简单，但超出了本教程的范围。我强烈建议你看一下，亲自尝试一下。</p><p id="d34e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的另一个简洁的pip包叫做<a class="ae ky" href="https://pypi.org/project/pipx/" rel="noopener ugc nofollow" target="_blank"> pipx </a>。<code class="fe nr ns nt nu b">pipx</code>允许您在虚拟环境中安装python包，然后在您的路径中创建一个到<code class="fe nr ns nt nu b">/usr/local/bin/</code>的符号链接。这意味着您可以将Python包作为独立的应用程序使用(如果有意义的话),或者您可以将全局Python包(如Black)用于整个系统。</p><p id="9f72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以像安装任何其他pip包<code class="fe nr ns nt nu b">pip install pipx</code>一样安装它，它将在全球范围内可用。从那里，您可以使用<code class="fe nr ns nt nu b">pipx install black</code>为Black创建一个虚拟环境，并使其对整个系统可用。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="d97d" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">需求文件</h1><p id="1431" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">早些时候，我提到了<code class="fe nr ns nt nu b">pip freeze</code>和需求文件，现在我想更详细地讨论这些。</p><p id="99e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">pip freeze</code>提供您已经安装的所有软件包的列表。它特定于您当前所处的环境，无论是系统解释器还是虚拟环境。运行此命令时，您会看到类似以下内容的输出:</p><pre class="kj kk kl km gt pe nu pf pg aw ph bi"><span id="cb4e" class="os mv it nu b gy pi pj l pk pl">Django==2.2.2<br/>pytz==2019.1<br/>sqlparse==0.3.0</span></pre><p id="eece" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是安装Django 2.2.2后的输出。首先，pip下载Django，然后运行我们前面谈到的setup.py。在setup.py中，列出了两个依赖项:pytz和sqlparse。这些可能是特定于版本的，通常如此，所以pip将它们与Django一起安装。一旦依赖关系得到满足，Django安装就完成了，我们可以开始一个新的Django项目。</p><p id="5ebd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不打算在我的教程中介绍Django，因为已经有更好的教程了。</p><p id="2ee2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照惯例，文件是我们存储项目pip需求的地方。我们可以使用以下命令将该文件传递给pip:</p><p id="b5d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">pip install -r requirements.txt</code></p><p id="9537" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，您需要与上述命令的需求文件位于同一个目录中。否则，您需要传递当前目录的相对路径(即<code class="fe nr ns nt nu b">somefolder/requirements.txt</code>)。</p><p id="c493" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了列出的包，我们还有用<code class="fe nr ns nt nu b">==</code>分隔的版本号。这意味着匹配这个精确的版本。如果我们想要一个更早的版本，我们可以改变版本号，我们将收到那个版本。</p><p id="f738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想确保新安装的软件总是更新到最新版本，您可以省略最后的<code class="fe nr ns nt nu b">==#.#.#</code>。</p><p id="5c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果你想安装一个特定的版本，你可以使用<code class="fe nr ns nt nu b">&lt;=</code>来包含你指定的版本，或者使用<code class="fe nr ns nt nu b">&lt;</code>来获得最新的包，只要它比你指定的版本低。</p><p id="aa11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想确保您总是获得比特定版本更高的版本，您可以使用<code class="fe nr ns nt nu b">&gt;</code>或<code class="fe nr ns nt nu b">&gt;=</code>。</p><p id="a39a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，你可以混合两者，在末尾用<code class="fe nr ns nt nu b">&gt;=0.2,&lt;0.3</code>来表示大于或等于0.2和小于0.3。这意味着0.2.1将被安装，而0.25或0.3将被拒绝。</p><p id="ebc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">pip freeze</code>因输出重定向而派上用场。您可以使用<br/> <code class="fe nr ns nt nu b">pip freeze &gt; requirements.txt</code>将输出发送到名为<code class="fe nr ns nt nu b">requirements.txt</code>的文件中。如果文件不存在，将创建该文件；否则，里面的文本将被替换。如果出于某种原因，你想附加文本(不建议)，你可以使用<code class="fe nr ns nt nu b">&gt;&gt;</code>代替。</p><p id="7710" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在创建需求文件时，使用输出重定向可以为您节省大量时间。我喜欢做的事情是将我所有的测试需求从我的生产需求中分离出来。这样，pytest或coverage之类的包就不会安装到生产环境中。我将所有这些放在测试阶段安装的一个<code class="fe nr ns nt nu b">test_requirements.txt</code>文件中。</p><p id="9325" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我清理需求文件的另一件事是在每个包上运行<br/> <code class="fe nr ns nt nu b">pip show &lt;package&gt;</code>来确定每个包需要什么。<code class="fe nr ns nt nu b">pip show Django</code>的输出显示“Requires: pytz，sqlparse。”</p><p id="2459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于此，我可以从我的需求文件中删除pytz和sqlparse。您可以按照您希望的任何顺序来完成这项工作，但是我通常从Django或Flask等核心需求开始，到我知道可能需要其他包的其他需求，从上到下完成剩余的包。</p><p id="6141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，如果一个依赖项被更新，并且版本没有包含在您的需求文件中，这可能会导致问题，正如下面评论中的<a class="oj ok ep" href="https://medium.com/u/cc6a49fe4899?source=post_page-----1dc915b4f0fd--------------------------------" rel="noopener" target="_blank"> Peter </a>所提到的。关于原因的更多细节，请看他的回答。</p><p id="dbbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我这样做是因为有时我可能希望Django更新到下一个版本，这可能也包括一个更新的包需求。如果它是一个不应该在没有仔细检查的情况下更新的关键应用程序，则只保留列出的所有软件包。</p><p id="6bfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不知道哪些可能，不要担心；这需要时间和经验。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0870" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">摘要</h1><p id="54dc" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">今天我们讨论了帮助我们使用预写代码执行任务的包，<code class="fe nr ns nt nu b">pip</code>允许我们安装这些包，以及虚拟环境，这样我们可以保持我们的开发环境整洁。我们还介绍了需求文件，以及当我们与他人共享应用程序或将应用程序安装到不同的环境中时，如何使用它们来确保安装所有的依赖项。</p><h2 id="fb5d" class="os mv it bd mw ot ou dn na ov ow dp ne li ox oy ng lm oz pa ni lq pb pc nk pd bi translated">链接</h2><p id="90e7" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果您想了解更多关于创建自己的包或将包上传到Pypi的信息，请查看Python打包用户指南。</p><div class="lv lw gp gr lx ly"><a href="https://packaging.python.org/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python打包用户指南-Python打包用户指南</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">Python打包用户指南(PyPUG)是打包Python软件的教程和指南的集合。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">packaging.python.org</p></div></div></div></a></div><p id="1a74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想了解更多关于安装软件包和虚拟环境的信息，请查看本指南:</p><div class="lv lw gp gr lx ly"><a href="https://packaging.python.org/tutorials/installing-packages/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">安装包Python打包用户指南</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">由于大多数Linux发行版处理Python 3迁移的方式，使用系统Python的Linux用户…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">packaging.python.org</p></div></div></div></a></div><p id="7b20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些也在<a class="ae ky" href="https://docs.python.org" rel="noopener ugc nofollow" target="_blank">docs.python.org</a>播出。</p><div class="lv lw gp gr lx ly"><a href="https://docs.python.org/3/installing/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">安装Python模块-Python 3 . 7 . 3文档</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">对于公司和其他机构用户，请注意许多组织都有自己的关于使用和…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">docs.python.org</p></div></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="6377" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">下一步是什么？</h1><p id="2bf8" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我们已经走了很长一段路。我本来打算写异步，但是我决定先介绍迭代器和生成器可能更有好处。两者都允许你循环遍历序列，我们将学习它们如何相似，如何不同，以及我们如何使用它们来改进我们的代码。</p><p id="cea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在那之前，实践你所学到的！</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/@broebling/beginning-python-programming-part-12-5450ae804936" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python编程入门—第12部分</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">在上一篇文章中，我们介绍了包和虚拟环境。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="po l mj mk ml mh mm ks ly"/></div></div></a></div></div></div>    
</body>
</html>