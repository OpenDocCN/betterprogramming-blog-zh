<html>
<head>
<title>Manipulating JavaScript Strings Using Template Literals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用模板文字操作JavaScript字符串</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/manipulating-javascript-strings-using-template-literals-f7070412099f?source=collection_archive---------6-----------------------#2021-04-09">https://betterprogramming.pub/manipulating-javascript-strings-using-template-literals-f7070412099f?source=collection_archive---------6-----------------------#2021-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d82" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">JavaScript模板文本、标记模板文本和众所周知的标记库简介</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aba04aafd8ed2c0016add2a62e4d4ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQIP0YhexHVrQxz6CxJdSg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="e38a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有没有写过类似这样的代码？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="687e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">控制台消息显示<code class="fe lw lx ly lz b">1 + 2 + 3 = 6</code>。</p><p id="b109" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出是漂亮的，但是组成它的代码是丑陋和混乱的(第4行)。让我们通过使用模板文字和标记模板文字来美化它。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="1fff" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">模板文字</h1><p id="b911" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">根据<a class="ae ne" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" rel="noopener ugc nofollow" target="_blank"> MDN Web文档</a>:</p><blockquote class="nf ng nh"><p id="c8fd" class="ky kz ni la b lb lc ju ld le lf jx lg nj li lj lk nk lm ln lo nl lq lr ls lt im bi translated">模板文字是允许嵌入表达式的字符串文字。</p><p id="4da3" class="ky kz ni la b lb lc ju ld le lf jx lg nj li lj lk nk lm ln lo nl lq lr ls lt im bi">…</p><p id="4f69" class="ky kz ni la b lb lc ju ld le lf jx lg nj li lj lk nk lm ln lo nl lq lr ls lt im bi translated">模板文字用反斜杠(<code class="fe lw lx ly lz b">`</code>)字符而不是双引号或单引号括起来。"</p></blockquote><p id="70f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">模板文字允许占位符(<code class="fe lw lx ly lz b">${ }</code>)。<code class="fe lw lx ly lz b">${expression}</code>中的任何<code class="fe lw lx ly lz b">expression</code>都将被求值并插入到字符串中。</p><p id="2a1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，前面的代码可以实现为:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="9da6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在模板文字格式中，第4行看起来更简洁。</p><p id="6252" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">模板文字可以嵌套。在反勾号模板中，您可以在占位符(<code class="fe lw lx ly lz b">${ }</code>)中插入内部反勾号。</p><p id="fce2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="5914" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第4行是一个纯模板文字。</p><p id="5e06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第5行是嵌套的模板文字。</p><p id="0be9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4、5线均输出<code class="fe lw lx ly lz b">20</code>。</p><p id="a5c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">源代码中插入的换行符是模板文字的一部分。使用模板文字来组成多行字符串更容易。</p><p id="db7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下代码将在控制台输出中保留该形状:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="ffaa" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">标记的模板文字</h1><p id="b201" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">标记模板文字是模板文字的更高级形式。它们在模板文字之前有一个函数。这个函数称为tag函数，它可以对模板文字执行操作，并返回被操作的字符串(或任何内容)。</p><p id="f6fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">标记函数的第一个参数包含一个从其模板文本派生的字符串值数组。剩下的参数是模板文本中的表达式。</p><p id="66e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们创建下面的函数<code class="fe lw lx ly lz b">myTag</code>来返回参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="bae3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是纯文本的用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="6378" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个参数是一个数组:<code class="fe lw lx ly lz b">[“This is a plain string”, raw: array(1)]</code>。</p><p id="4b75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是多行模板文字的用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="c2cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个参数是一个数组:<code class="fe lw lx ly lz b">[“<br/> — — — — — — -<br/> | | |<br/> | * | * |<br/> | | |<br/> — — — — — — -<br/>”, raw: Array(1)]</code>。结果保留回车键。</p><p id="f49a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当模板文本是带插值的字符串时，第一个参数是从非占位符字符串的值派生的数组。其余的参数是占位符表达式。换句话说，第二个参数是第一个插值值(<code class="fe lw lx ly lz b">1</code>)，第三个参数是第二个插值值(<code class="fe lw lx ly lz b">2</code>)，依此类推。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="e0b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个自变量是<code class="fe lw lx ly lz b">[“The first value is “, “, and the second value is “, “.”, raw: Array(3)]</code>，第二个自变量是<code class="fe lw lx ly lz b">1</code>，第三个自变量是<code class="fe lw lx ly lz b">2</code>。</p><p id="c574" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是更多带标记的模板文字及其控制台消息的示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="81c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，我们已经使用了函数声明来定义标记函数。标签函数也可以是函数表达式。不管是函数声明还是函数表达式，标记函数都可以在其函数体中使用其他模板文字和标记模板文字。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="df3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能已经注意到，在tag函数的第一个参数中有一个<code class="fe lw lx ly lz b">raw</code>属性。它类似于<code class="fe lw lx ly lz b">String.raw</code>，它保留输入的原始字符串，不处理转义序列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="1963" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第5行显示新行开始一个新行。</p><p id="354e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第9行显示换行符用<code class="fe lw lx ly lz b">String.raw</code>保留。</p><p id="4169" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第12行使用<code class="fe lw lx ly lz b">String.raw</code>，对结果没有影响。</p><p id="cc28" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第17-38行是第39行使用的<code class="fe lw lx ly lz b">tabValues</code>函数。这个例子展示了如何使用tag函数的参数和原始值。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="b8b6" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">众所周知的标签库</h1><p id="9a55" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">自ES2015以来，已标记的模板文字一直可用。它已经应用于许多图书馆。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/1ceabb7f81f833e0f811df4cceebd93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6i1H_o3KLdcakO2lBYb3Kw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ne" href="https://www.npmtrends.com/" rel="noopener ugc nofollow" target="_blank">国家预防机制趋势</a></p></figure><ul class=""><li id="a6e8" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><code class="fe lw lx ly lz b"><a class="ae ne" href="https://github.com/styled-components/styled-components" rel="noopener ugc nofollow" target="_blank">styled-components</a></code>采用带标签的模板文字来支持用JavaScript编写CSS。在<a class="ae ne" href="https://medium.com/better-programming/styled-components-a-css-in-js-approach-755f6a196c42" rel="noopener">另一篇文章</a>中有详细描述。</li><li id="1694" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe lw lx ly lz b"><a class="ae ne" href="https://github.com/kentcdodds/babel-plugin-macros" rel="noopener ugc nofollow" target="_blank">babel-plugin-macros</a></code>使用带标签的模板文字来<a class="ae ne" rel="noopener ugc nofollow" target="_blank" href="/an-introduction-to-javascript-compile-time-processing-f77571e71dfd">启用编译时处理</a>。</li><li id="2e8b" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe lw lx ly lz b"><a class="ae ne" href="https://github.com/zspecza/common-tags" rel="noopener ugc nofollow" target="_blank">common-tags</a></code>是ES2015+中处理字符串的模板文字标签。</li><li id="1408" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated">是一个高效的、富于表现力的、可扩展的HTML模板库。</li></ul><h2 id="0272" class="ob mi it bd mj oc od dn mn oe of dp mr lh og oh mt ll oi oj mv lp ok ol mx om bi translated">常见标签示例</h2><p id="06ec" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated"><code class="fe lw lx ly lz b">common-tags</code>导出一堆有用的预煮模板标签供消费。<a class="ae ne" href="https://medium.com/better-programming/10-fun-facts-about-create-react-app-eb7124aa3785" rel="noopener">创建React App </a>默认包含包。这些标签功能非常方便。</p><p id="0db8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">标签正确地缩进了数组以及字符串替换中的换行符。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="d50b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第9行打印出没有<code class="fe lw lx ly lz b">html</code>标签的结果字符串。结果在注释中(第10-13行)。第10行多了一个换行符，第12行的对齐方式不正确。</p><p id="63e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第20行打印出带有<code class="fe lw lx ly lz b">html</code>标签的结果字符串。结果在注释中(第21-25行)。对齐和缩进是正确的。</p><p id="3faa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">safeHtml</code>标签类似于<code class="fe lw lx ly lz b">html</code>。此外，它对替换字符串进行安全的HTML转义。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="822f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第15行使用了<code class="fe lw lx ly lz b">safeHtml</code>标签。安全HTML转义应用于动态生成的代码(第22-24行),这些代码显示在注释(第21-25行)中。</p><p id="7b50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">oneLineCommaListsAnd</code>标签将数组替换内联为逗号分隔的列表，最后一个列表前面是单词<code class="fe lw lx ly lz b">and</code>。此外，字符串呈现在一行上。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="6065" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第4行使用了<code class="fe lw lx ly lz b">oneLineCommaListsAnd</code>标签。如果不涉及i18n，组合字符串是非常有效的。</p><p id="c7e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">common-tags</code>里有很多有趣的标签。尝试它们很有趣。</p><p id="89b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">common-tags</code>也公开了一个创建你自己的模板标签的接口。创建模板标签甚至更有趣。</p><h2 id="0cea" class="ob mi it bd mj oc od dn mn oe of dp mr lh og oh mt ll oi oj mv lp ok ol mx om bi translated">lit-html示例</h2><p id="d432" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated"><code class="fe lw lx ly lz b">lit-html</code>提供使用模板文字编写HTML模板的功能。它提供两个主要出口:</p><ul class=""><li id="4385" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><code class="fe lw lx ly lz b">html</code>:用于产生<code class="fe lw lx ly lz b">TemplateResult</code>的模板标签。</li><li id="e621" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe lw lx ly lz b">render()</code>:将<code class="fe lw lx ly lz b">TemplateResult</code>渲染到DOM容器的函数。</li></ul><p id="b341" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它需要安装软件包:</p><pre class="kj kk kl km gt on lz oo op aw oq bi"><span id="a138" class="ob mi it lz b gy or os l ot ou">npm i lit-html</span></pre><p id="969d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在<code class="fe lw lx ly lz b">package.json</code>的<code class="fe lw lx ly lz b"><a class="ae ne" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">dependencies</a></code>中看到新的包:</p><pre class="kj kk kl km gt on lz oo op aw oq bi"><span id="ccc0" class="ob mi it lz b gy or os l ot ou">"devDependencies": {<br/>  "lit-html": "^1.3.0"<br/>}</span></pre><p id="2540" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是一个向ID为<code class="fe lw lx ly lz b">test</code>的元素呈现问候消息的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="1fce" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="416b" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">在本文中，我们探讨了JavaScript模板文本、标记模板文本和众所周知的标记库。它们可以有效地操作字符串等等。</p><p id="bd00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，也有理由考虑避免标记的模板文字。据说用字符串写代码违反了软件工程的基本法则，因为它给类型检查、林挺、格式化、i18n、优化、编译等带来了挑战。</p><p id="502e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">嗯，凡事都有利有弊。你自己做选择。</p><p id="8ce0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。我希望这有所帮助。你可以在这里看到我的其他媒体出版物<a class="ae ne" href="https://medium.com/@jenniferfubook/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">。</a></p></div></div>    
</body>
</html>