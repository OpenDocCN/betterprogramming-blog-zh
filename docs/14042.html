<html>
<head>
<title>Running Rust Tasks With “xtask” and “xtaskops”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用“xtask”和“xtaskops”运行Rust任务</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/running-rust-tasks-with-xtask-and-xtaskops-a2193e67dc25?source=collection_archive---------3-----------------------#2022-10-29">https://betterprogramming.pub/running-rust-tasks-with-xtask-and-xtaskops-a2193e67dc25?source=collection_archive---------3-----------------------#2022-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dadf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">突击测验:你如何编写和运行你的日常任务？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6a7eb0e1559d1902bf614ca9fb465be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YEaW0GK-HMicGe4d.png"/></div></div></figure><p id="892b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你有一个中等规模的React项目，或者一个用Go或任何其他语言开发的项目，你可能会发现自己需要自己的构建、测试或CI任务。</p><p id="1091" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，对于Node.js中的<code class="fe ln lo lp lq b">npm</code>或<code class="fe ln lo lp lq b">yarn</code>，您可以编写自己的<code class="fe ln lo lp lq b">test:integration</code>任务，该任务只运行您的集成测试:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="2939" class="lv lw iq lq b gy lx ly l lz ma">$ yarn test:integration</span></pre><p id="d2c3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">test:integration</code>可能是任何一系列的shell命令，告诉您的测试运行程序要过滤什么。</p><p id="664d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有时，这些作业有依赖关系，所以您要以正确的方式对它们进行排序:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="2912" class="lv lw iq lq b gy lx ly l lz ma">$ yarn clean &amp;&amp; yarn build &amp;&amp; yarn test:integration</span></pre><p id="84d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，你把这些放进你的<code class="fe ln lo lp lq b">package.json</code>文件:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="706a" class="lv lw iq lq b gy lx ly l lz ma">"ci": "yarn clean &amp;&amp; yarn build &amp;&amp; yarn test:integration"</span></pre><p id="34f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最终变成了:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="4649" class="lv lw iq lq b gy lx ly l lz ma">$ yarn ci</span></pre><p id="f628" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于<code class="fe ln lo lp lq b">make</code>或者类似的工具，对于所有类型的任务，比如构建、lint、测试、覆盖、CI、发布，看起来都非常相似。</p><p id="967e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有时，您必须编写自己的“CI工具”shell脚本:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="334b" class="lv lw iq lq b gy lx ly l lz ma">$ ./ci/build-dev.sh</span></pre><h1 id="ebc1" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">我们如何在Rust项目中做到这一点？</h1><p id="4819" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">通过向您的清单文件添加一些shell脚本(对于Rust - <code class="fe ln lo lp lq b">cargo.toml</code>)，实际上不可能像使用<code class="fe ln lo lp lq b">yarn</code>或<code class="fe ln lo lp lq b">npm</code>那样对Cargo执行特定的任务。</p><p id="c463" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">人们通常通过为特定需求调用定制的shell脚本来解决这个问题，或者通过使用(滥用？)<code class="fe ln lo lp lq b">make</code>，类似围棋界是怎么做的。</p><p id="24f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有几个原因可以解释为什么我们要走这条简单的路线。它们是:</p><ul class=""><li id="8df2" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">这很简单，只需命名任务并开始</li><li id="8900" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">我们都知道shell命令</li><li id="c5a0" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">运行顺序和故障模式也是从shell继承的</li><li id="1e14" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">易于实验和迭代</li></ul><h1 id="8174" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">工作流问题</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/25a53ccf68c7a49ced76eeb6921d3f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8nft7XQ1RUvhHDNO.png"/></div></div></figure><p id="4865" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">尝试一个shell命令，并将其粘贴为一个<code class="fe ln lo lp lq b">make</code>任务，这对于简单的情况非常有用。</p><p id="65f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是，对于任何一个中等规模的项目，问问你自己这些问题:</p><ul class=""><li id="2063" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">如何给<code class="fe ln lo lp lq b">make</code>提供自定义参数？(或<code class="fe ln lo lp lq b">npm</code>任务)</li><li id="897e" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">给shell脚本提供参数怎么样？和标志或选项？还有违约？</li></ul><p id="1db8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">答案是:你回到那个时候你所熟悉的任何shell脚本voodoo。</p><p id="3b68" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">提示用户输入更糟糕，以特定的顺序运行任务(解析任务图)留给您，手工编码顺序。</p><h1 id="deb4" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">生产力问题</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/19fe4d342275922e269fc3d1b384edb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_eUyeQijxxRhrZp3.png"/></div></div></figure><p id="e20f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就像在“普通”软件中一样，为了提高工作效率，您需要:</p><ul class=""><li id="f6f6" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">做一些程序化的逻辑</li><li id="aa84" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">重用您现有的代码库</li><li id="721f" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">导入其他人的库或任务</li><li id="bf9b" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">调试、推理或测试任务的能力</li></ul><p id="c3d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所有这些在<code class="fe ln lo lp lq b">npm</code>或<code class="fe ln lo lp lq b">make</code>或类似的工具中都是不可能的，而且这是一种创作shell脚本的痛苦体验。</p><h1 id="908e" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">有什么解决方案吗？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5aacc31974869c7831a7aace1185626b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_9osvhZPT1atvH5l.png"/></div></div></figure><p id="32aa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">显然，对于这一挑战有几种解决方案。</p><h2 id="8490" class="lv lw iq bd mc nm nn dn mg no np dp mk la nq nr mm le ns nt mo li nu nv mq nw bi translated">声明性“线性”构建工具</h2><p id="5c87" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">有一些典型的工具是为“运行我的shell命令”而开发的，比如<code class="fe ln lo lp lq b">yarn</code>、<code class="fe ln lo lp lq b">make</code>等。</p><p id="d4b1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以使用您所知道的关于环境变量、shell命令排序和逻辑(<code class="fe ln lo lp lq b">&amp;&amp;</code>等)的一切，使用位置参数<code class="fe ln lo lp lq b">$1, $2,</code>等。希望一切都好。</p><h2 id="19d0" class="lv lw iq bd mc nm nn dn mg no np dp mk la nq nr mm le ns nt mo li nu nv mq nw bi translated">更智能的“制造”工具，半声明式</h2><p id="24e2" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">像<code class="fe ln lo lp lq b">just</code>或<code class="fe ln lo lp lq b">cargo-make</code>这样的工具是专门为解决与任务相关的痛苦而构建的，这是一件好事。</p><p id="2c48" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如用<code class="fe ln lo lp lq b">cargo-make</code>构建任务看起来像这样:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="09fb" class="lv lw iq lq b gy lx ly l lz ma">[tasks.A]<br/>dependencies = ["B", "C"]</span><span id="e997" class="lv lw iq lq b gy nx ly l lz ma">[tasks.B]<br/>dependencies = ["D"]</span><span id="fc50" class="lv lw iq lq b gy nx ly l lz ma">[tasks.C]<br/>dependencies = ["D2"]</span><span id="d88a" class="lv lw iq lq b gy nx ly l lz ma">[tasks.D]<br/>script = "echo hello"</span><span id="386f" class="lv lw iq lq b gy nx ly l lz ma">[tasks.D2]<br/>alias="D"</span></pre><p id="0315" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以我们得到:</p><ul class=""><li id="84d2" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">具有依赖性的任务优先工具、订单解决方案</li><li id="2f12" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">参数和命名的便利性</li></ul><p id="d344" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是，我们最终会受到在shell或我们使用的工具上运行命令的限制。</p><h2 id="4881" class="lv lw iq bd mc nm nn dn mg no np dp mk la nq nr mm le ns nt mo li nu nv mq nw bi translated">编程语言DSL工具</h2><p id="08d9" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">在这一类别中，您有一个库或一个基础结构，您可以自己构建任务。</p><p id="8df3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您得到的只是一种以方便的方式运行完全支持编程语言的任务的方法，以及一些胶水。</p><p id="bccc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Ruby中的<code class="fe ln lo lp lq b"><a class="ae ny" href="https://github.com/ruby/rake" rel="noopener ugc nofollow" target="_blank">rake</a></code>就是一个很好的例子。它看起来像<code class="fe ln lo lp lq b">make</code>，但是你用你的母语:Ruby来构建你的所有任务。</p><p id="3a13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在某个时间点，一个类似的解决方案(更像是一个指南)出现了:<code class="fe ln lo lp lq b"><a class="ae ny" href="https://github.com/matklad/cargo-xtask" rel="noopener ugc nofollow" target="_blank">xtask</a></code>。</p><h1 id="6a2e" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">xtask</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/74a013ccbdc9456e93f0dc91c5507d84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Rr8YNeOKYU0PbBVK.png"/></div></div></figure><p id="022a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">xtask</code>是一个约定，一个项目成立的惯例。</p><p id="58e5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您遵循设置步骤，您最终会得到一个<code class="fe ln lo lp lq b">cargo xtask</code>命令和一个名为<code class="fe ln lo lp lq b">xtask</code>的新Rust项目，您可以在其中构建所有的定制内容。</p><p id="e218" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常使用<code class="fe ln lo lp lq b">xtask</code>意味着你习惯使用货物。</p><p id="5610" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这也意味着你可以充分发挥Rust的潜力:导入库、重用项目逻辑、测试、lint和安全地运行你的构建任务。</p><h1 id="e0ce" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">设置<code class="fe ln lo lp lq b">xtask</code></h1><p id="e44f" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">我们正试图从单机箱项目转移到多机箱工作空间，其中有两个成员:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="1048" class="lv lw iq lq b gy lx ly l lz ma">[ your-project, xtask ]</span></pre><p id="8cf1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你的项目名为<code class="fe ln lo lp lq b">acme</code>，将你的代码移动到一个新的<code class="fe ln lo lp lq b">acme/</code>内部文件夹。</p><p id="eed0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，在您的项目中:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="8a0c" class="lv lw iq lq b gy lx ly l lz ma">$ cargo new --bin xtask</span></pre><p id="ad8e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">设置您的工作空间(根<code class="fe ln lo lp lq b">cargo.toml</code>):</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="1fcc" class="lv lw iq lq b gy lx ly l lz ma">[workspace]<br/>members = [<br/>  "acme",<br/>  "xtask"<br/>]</span></pre><p id="5dbd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为<code class="fe ln lo lp lq b">cargo</code>添加一个别名以了解<code class="fe ln lo lp lq b">xtask</code>(在<code class="fe ln lo lp lq b">.cargo/config</code>):</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="c0fb" class="lv lw iq lq b gy lx ly l lz ma">[alias]<br/>xtask = "run --package xtask --"</span></pre><p id="848f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就是这样。现在<code class="fe ln lo lp lq b">xtask</code>项目由您来构建了。像对待任何其他应该执行构建任务的二进制文件一样对待它。</p><p id="c428" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是你想要的:</p><ul class=""><li id="b117" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">轻松获取命令和参数</li><li id="895f" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">将命令路由到您轻松编写的任务</li><li id="b6ba" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">轻松创作任务</li></ul><p id="6cf8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，还没有推荐的方法来轻松创作<code class="fe ln lo lp lq b">xtask</code>任务。</p><p id="ae93" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是<code class="fe ln lo lp lq b">xtaskops</code>诞生的原因。</p><h1 id="4619" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">使用xtaskops</h1><p id="ce2c" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">使用<a class="ae ny" href="https://github.com/jondot/xtaskops" rel="noopener ugc nofollow" target="_blank"> xtaskops </a>，这是一个完全加载的<code class="fe ln lo lp lq b">xtask</code>二进制文件，有比你需要的更多的任务。它或多或少适合单个屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/916ed59efeea9a8d86d12155b51c0c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g-QMeWKAf0Dcgilk.png"/></div></div></figure><p id="4335" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过使用<code class="fe ln lo lp lq b">xtaskops</code>库，你可以免费获得Rust中的所有常见任务，然后还可以获得一些很酷的任务，比如<code class="fe ln lo lp lq b">bloat-deps</code>(根据大小显示最大的依赖关系)和<code class="fe ln lo lp lq b">powerset</code>(对功能组合进行测试)。</p><p id="85ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只需将它们连接到您选择的CLI框架(这里，我们使用的是<code class="fe ln lo lp lq b">clap</code>)。</p><p id="aa80" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是今天在<code class="fe ln lo lp lq b">xtaskops</code>中可用的一些任务:</p><ul class=""><li id="626d" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">显示发布版本中最大的板条箱</li><li id="3b51" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">显示板条箱建造时间</li><li id="9b1c" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">开发人员运行货物检查，然后对每个文件更改进行货物测试</li><li id="f89e" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">ci连续运行典型的CI任务:fmt、clippy和tests</li><li id="d618" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">覆盖率运行覆盖率</li><li id="8f41" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">单据在观察模式下运行货物单据</li><li id="6a4a" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">安装已安装货物工具</li><li id="b48f" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">powerset使用powerset功能执行配置项构建</li></ul><p id="6c52" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要运行自己的命令，使用<code class="fe ln lo lp lq b">cmd!</code>宏:</p><pre class="kg kh ki kj gt lr lq ls lt aw lu bi"><span id="6cb2" class="lv lw iq lq b gy lx ly l lz ma">cmd!(your,command,here)</span></pre><h1 id="af9f" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">对每个项目使用<code class="fe ln lo lp lq b">xtask</code></h1><p id="822f" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">您可以使用由<code class="fe ln lo lp lq b">xtask</code>驱动的<a class="ae ny" href="https://github.com/rusty-ferris-club/rust-starter" rel="noopener ugc nofollow" target="_blank">生锈启动器</a>，而不是为每个项目反复手动设置<code class="fe ln lo lp lq b">xtask</code>。</p><p id="0610" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于已经存在的项目，你可以复制<code class="fe ln lo lp lq b">xtask</code>文件或者使用<a class="ae ny" href="https://github.com/rusty-ferris-club/backpack" rel="noopener ugc nofollow" target="_blank">背包</a>，这样可以很容易的抓取部分库。</p><p id="48a8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当然，你可能想做一个你自己的启动项目:为你自己设置一次<code class="fe ln lo lp lq b">xtask</code>，然后在你所有的工作中重复使用你的项目。然后使用<a class="ae ny" href="https://github.com/rusty-ferris-club/backpack" rel="noopener ugc nofollow" target="_blank">背包</a>从你的仓库地址开始每一个新项目。</p><h1 id="94aa" class="mb lw iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="cb30" class="pw-post-body-paragraph kr ks iq kt b ku ms jr kw kx mt ju kz la mu lc ld le mv lg lh li mw lk ll lm ij bi translated">在添加另一个<code class="fe ln lo lp lq b">make</code>任务或编写另一个定制shell构建脚本之前，请记住:</p><ul class=""><li id="5067" class="mx my iq kt b ku kv kx ky la mz le na li nb lm nc nd ne nf bi translated">您的构建、ci、工作流、差事代码——仍然是维护的代码</li><li id="92b9" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">不要低估使用shell命令的任务的维护开销</li><li id="c619" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">你的shell voodoo最好是没有bug的，经过测试和推理的</li><li id="b802" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">最好重用团队在知识、代码、标准和实践方面的投资</li><li id="9924" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated"><code class="fe ln lo lp lq b">make</code>可能很棘手，需要遗忘的知识(例如<code class="fe ln lo lp lq b">.PHONY</code>)</li><li id="6c4b" class="mx my iq kt b ku ng kx nh la ni le nj li nk lm nc nd ne nf bi translated">package.json任务通常需要额外的包(<code class="fe ln lo lp lq b">rimraf</code>、<code class="fe ln lo lp lq b">concurrently</code>)</li></ul><p id="0c08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以使用<code class="fe ln lo lp lq b">xtask</code>来减轻所有这些痛苦，并编写更多的Rust代码。</p></div></div>    
</body>
</html>