<html>
<head>
<title>4 Approaches to Declutter AWS Cloud Environments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清理AWS云环境的4种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-approaches-to-declutter-aws-cloud-environments-7e59b76c6206?source=collection_archive---------18-----------------------#2022-01-03">https://betterprogramming.pub/4-approaches-to-declutter-aws-cloud-environments-7e59b76c6206?source=collection_archive---------18-----------------------#2022-01-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a02a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">净化您的云环境</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/74681ffaabd0810850ea7b79075849fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yuXJmVenV-1PU_D-yFeg5Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@patrickian4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">帕特里克·福尔</a>在<a class="ae ky" href="https://unsplash.com/s/photos/candy-scoop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="4638" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建云资源就像从糖果店买糖果一样简单。对于一个组织(初创或已建立)来说，只需点击几下鼠标，就可以通过公共云提供商创建一个帐户，并最终创建可能包含复杂基础架构的资源来支持分布式环境。</p><p id="f5e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着时间的推移，包括未使用或不想要的资源在内的“杂物”会越积越多。这种混乱不仅限于计算、存储等类别，还可能包括未使用的角色、过度特权策略、未使用的标签等。这种云混乱会导致:</p><ul class=""><li id="eb31" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">不必要的云支出增加</li><li id="76d8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">攻击表面积的增加暴露了安全风险</li></ul><p id="adfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近面临了一个类似的挑战，这篇文章总结了我通过清理混乱来净化AWS环境(有多个帐户)的方法。这种净化工作最终将提供对正在使用的资源的更多控制，并有助于减少攻击面、增强安全态势和降低运营成本。</p><p id="0fe5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面总结了清理AWS环境的多种方法。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9b95" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">通过值得信赖的顾问识别闲置或未充分利用的资源—成本优化</h1><p id="91a3" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/premiumsupport/technology/trusted-advisor/" rel="noopener ugc nofollow" target="_blank"> AWS可信顾问</a>中的“成本优化”功能不仅推荐了节省成本的方法，还列出了可能会被删除的未使用或闲置资源。这是一项非常有用的服务，是开始清理云混乱的良好开端，但不是万能的，因为对资源利用率的检查仅限于:</p><ul class=""><li id="5ce4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">空闲RDS数据库实例</li><li id="8ef7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">空闲负载平衡器</li><li id="bb07" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">低利用率EC2实例</li><li id="e31e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">无关联的IP地址</li><li id="8c81" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">未充分利用的EBS卷</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/cda18cd3dcf5af376660c8ed8b4f956c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcv-si5tuHcNkVk7YFGs8A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">AWS值得信赖的顾问—成本优化</p></figure><h1 id="6905" class="mq mr it bd ms mt no mv mw mx np mz na jz nq ka nc kc nr kd ne kf ns kg ng nh bi translated">通过AWS安全中心调查结果识别不必要的资源</h1><p id="246f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/security-hub/" rel="noopener ugc nofollow" target="_blank"> AWS安全中心</a>主要用于检测与安全最佳实践的偏差，并通过自动响应和补救措施加快平均解决时间。然而，AWS Security Hub的一个关键特性是从几个AWS集成和合作伙伴服务中汇总安全发现。</p><p id="3db3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS集成包括Amazon GuardDuty、Amazon Inspector、Amazon Macie、AWS IAM Access Analyzer、AWS Systems Manager Patch Manager、AWS Config和AWS Firewall Manager。这意味着安全调查结果将集中在广泛的AWS资源上，其中也包括IAM角色和策略。</p><p id="ddd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">补救每个安全发现是一个繁琐的过程，但有助于从资源角度了解组织的状况。例如，补救安全发现的流程将识别未使用的SNS主题、SQS队列、机密、KMS密钥、过度配置的策略、具有控制台访问权限但没有MFA设置的用户等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/a9ce9057f8e4ef207a687a8c3020d3cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4B9_G4VmAg6fE08Bl_Nzw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">修正AWS安全中心发现的问题</p></figure><h1 id="8748" class="mq mr it bd ms mt no mv mw mx np mz na jz nq ka nc kc nr kd ne kf ns kg ng nh bi translated">确定适当的标签并标记所需的资源</h1><p id="1123" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">一旦清理了空闲的、未充分利用的和不必要的资源，确定一组可用于对资源进行分组并进行适当标记的清晰标记就非常重要。</p><p id="74a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">强烈建议使用基础设施即代码(IaaC)等方法(例如Terraform或AWS CloudFormation)进行资源标记。标记资源的另一种手动方法是使用服务“<a class="ae ky" href="https://docs.aws.amazon.com/ARG/latest/userguide/tagging-resources.html" rel="noopener ugc nofollow" target="_blank"> AWS资源组</a>”下的“标记编辑器”功能</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/77fd60ebd862996b8e36be970418ac39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPnWfq5MgePtLytksTJv5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过AWS资源组管理标记—标记编辑器</p></figure><p id="0a3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还建议将所需标签激活为“成本分配标签”。这可以通过AWS计费下的“成本分配标签”选项来完成</p><h1 id="2876" class="mq mr it bd ms mt no mv mw mx np mz na jz nq ka nc kc nr kd ne kf ns kg ng nh bi translated">识别附加了不需要的标记的资源，以清理资源或附加到资源的标记</h1><p id="dd49" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在此净化工作之前，可能存在标签。这些标签可以与需要或需要删除的资源相关联。EC2服务下的“标签”部分将列出所有使用的标签和相关资源。查看不需要的标签将有助于进一步清理环境。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/ee56a202347b534b951809d8c361c503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvoVcqvoTrOGwa_B1cMUSg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过Amazon EC2服务管理标签</p></figure><h1 id="37eb" class="mq mr it bd ms mt no mv mw mx np mz na jz nq ka nc kc nr kd ne kf ns kg ng nh bi translated">通过自动化解决方案(如云托管)维护环境健全性</h1><p id="523b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated"><a class="ae ky" href="https://cloudcustodian.io/#" rel="noopener ugc nofollow" target="_blank">云托管</a>是一款开源工具，可以通过确保遵守安全策略、标记策略、未使用资源的垃圾收集和成本管理来自动管理云环境。该工具易于使用，并允许使用易于阅读的DSL创建数百万个策略。该工具提供了消除云混乱所需的自动化，强烈推荐使用。</p><h1 id="16f8" class="mq mr it bd ms mt no mv mw mx np mz na jz nq ka nc kc nr kd ne kf ns kg ng nh bi translated">结论</h1><p id="f30d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">总之，清理云环境通常是一项被忽视的任务。然而，就实际支出而言，这可能被证明是极其昂贵的，但对安全态势而言，这是一个迫在眉睫的风险。从长远来看，在一次性清理之后，通过云托管等工具设置自动化将被证明是非常有益的。</p></div></div>    
</body>
</html>