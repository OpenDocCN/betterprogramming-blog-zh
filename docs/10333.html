<html>
<head>
<title>Angular 13 Firebase Authentication Tutorial With AngularFire 7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AngularFire 7的Angular 13 Firebase认证教程</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-13-firebase-authentication-tutorial-with-angularfire-7-23dc8cee42c4?source=collection_archive---------0-----------------------#2021-12-29">https://betterprogramming.pub/angular-13-firebase-authentication-tutorial-with-angularfire-7-23dc8cee42c4?source=collection_archive---------0-----------------------#2021-12-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="736b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Angular和Firebase实现社交和传统登录策略</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2ee671f50b3e9ac9aeea62c427e8a44e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RdWveAGcLV-jCfgy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">圭多·詹森在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="c344" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="9852" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">身份验证是保护我们的应用免受未注册用户攻击的关键。在本教程中，您将学习如何在Firebase中实现传统的电子邮件/密码登录和谷歌社交登录，使用新的可摇树<a class="ae ky" href="https://github.com/angular/angularfire" rel="noopener ugc nofollow" target="_blank"> AngularFire </a> v.7.0模块化SDK，这允许我们充分利用新的可摇树Firebase JS SDK (v9) 。</p><p id="6369" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您还将学习如何使用AngularFire Auth Guard保护路由，以及如何根据用户是否经过身份验证将他们重定向到特定页面。</p><blockquote class="ms mt mu"><p id="f82e" class="lr ls mv lt b lu mn ju lw lx mo jx lz mw mp mc md mx mq mg mh my mr mk ml mm im bi translated">请注意，在撰写本教程时，Angular fire v.7.0 API <a class="ae ky" href="https://github.com/angular/angularfire/blob/master/docs/version-7-upgrade.md" rel="noopener ugc nofollow" target="_blank">仍在开发中，功能还不完整</a>；这些文档还没有更新到最新版本。AngularFire提供了一个兼容层，允许您使用最新版本的库，同时完全支持AngularFire v6.0 API。也就是说，如果你和我一样好奇，并且喜欢尝试你所有库的最新版本，那就继续享受这篇教程吧。</p></blockquote><p id="32eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是我们今天将构建的应用程序的预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/b45fffbf23804dfca9ecb92d628c266d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uTYu5EZ9CmUVDkUIEEJPCg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">身份验证应用程序预览</p></figure><p id="38a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以在这里找到完整的代码。</p><h2 id="b6a0" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">索引</h2><ul class=""><li id="ce25" class="nm nn it lt b lu lv lx ly ma no me np mi nq mm nr ns nt nu bi translated">建立一个firebase项目。</li><li id="e1b6" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">使用AngularFire设置角度投影。</li><li id="f7dc" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">构建应用程序。</li><li id="dd21" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">创建仪表板。</li><li id="bdb4" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">创建身份验证模块。</li><li id="5407" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">正在添加Google登录。</li><li id="0f0a" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">保护路线。</li></ul></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="a613" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">设置Firebase项目</h1><p id="60c9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要创建一个新的Firebase项目，我们需要登录到<a class="ae ky" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台。</a>完成后，我们可以点击Add Project创建一个新项目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/102cbff8a4e826a16e0921f601568a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEGeQlurnZg77RVUQ419Jw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Firebase —创建新项目</p></figure><p id="7c36" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们需要为我们的项目选择一个名称:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/2e27cb5bf1c07a9811953d578bf7afa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eq4TugPmUC_XFesmvLTXuw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Firebase —选择名称</p></figure><p id="0d7f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">决定我们是否希望谷歌分析在我们的项目中(你的选择，我会选择否):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/9e2649eacc573c9dda75dad8530f9215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ls_rkVfB6xW7-PkEXsGDbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">firebase——支持谷歌分析</p></figure><p id="309e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们完了！我们现在有一个可爱的新的Firebase项目。</p><h2 id="e2b8" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">将Firebase添加到Web应用程序</h2><p id="9c92" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们需要将Firebase添加到我们的Angular应用程序中。为此，我们需要在控制面板中点击Web app按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/17fbdd1d37f1020651a964ea2ae89a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUPGAHiqvtfKQeYI9VeoXw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Firebase —添加web应用程序</p></figure><p id="4306" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后我们需要选择一个名称:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/0dcada5256515602debe3cad69894f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yc-B8ZYe5S8dn_LECk2ThQ.png"/></div></div></figure><p id="0dd9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们现在有了稍后将用于向我们的Angular应用程序添加Firebase的配置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/0ea9c4480e7bdd79b1948754d4c2aa1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2pEndz9CHfDx1GEHtNASA.png"/></div></div></figure><h2 id="6857" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">添加身份验证</h2><p id="d7bb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是时候添加身份验证并选择我们想要实现的登录方法了。在本教程中，我们将添加一个Google社交登录和一个传统的电子邮件/密码登录。转到身份验证页面，选择提供商:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/b7c5d1f20a9997d6d2221aa3ae010ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PH8FrfZnjy9wlTcCFmlD2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Firebase —选择登录方法</p></figure><p id="8847" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们启用了这两种登录方法，我们的身份验证控制面板应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4247ed326f9fc27b6eaac4ac15eed294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hd_xOSSrmDwmsemRDk-OHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">启用Firebase的登录方法</p></figure><p id="ed0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">仅此而已！我们现在已经完全设置好了Firebase应用程序，并准备就绪。是时候开始使用我们的Angular应用程序了。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="4b5f" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">设置角度项目</h1><p id="38a5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们要做的第一件事是用Angular CLI创建一个新项目。</p><p id="ce81" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:如果您还没有安装Angular CLI，您可以通过运行以下命令来安装:</em></p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="b2c5" class="na la it ov b gy oz pa l pb pc">npm i -g @angular/cli</span></pre><p id="89f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要创建新的角度项目，我们可以运行以下命令:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="1f4c" class="na la it ov b gy oz pa l pb pc">ng new ngbytes-fireauth</span></pre><p id="afaf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">注意:当被问及是否要在新应用中添加路线时，不要忘记回答是！</em></p><p id="a7ae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦CLI发挥了它的魔力，我们就可以用我们最喜欢的IDE打开新创建的项目(我建议使用<a class="ae ky" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VSCode </a>，这是我通常使用的一个)。</p><h2 id="507c" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">添加火基和角火</h2><p id="17cf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们将Firebase和Angularfire添加到我们的项目中。为此，我们将使用AngularFire原理图，它将负责为我们设置一切。让我们运行以下命令:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="bb69" class="na la it ov b gy oz pa l pb pc">ng add @angular/fire</span></pre><p id="39c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们会被问一系列问题，比如我们想要设置哪些Firebase特性。对于本教程，我们只需要添加身份验证，因此我们选择:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/92ae6af942be59afd8efe9536ffb6fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4SatsRPgzyNIOk5HaVC3g.png"/></div></div></figure><p id="034e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后我们会被问到我们想要使用的Firebase帐户，以及我们想要设置哪个项目。选择我们之前创建的项目，然后选择我们之前创建的应用程序。</p><p id="2b5f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们完成了所有这些，您将会看到原理图已经为我们处理了所有的Firebase配置。厉害！</p><h2 id="1146" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">添加角形材料</h2><p id="dc7d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们还会添加有棱角的材料。我们将再次使用原理图:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="c8ae" class="na la it ov b gy oz pa l pb pc">ng add @angular/material</span></pre><h2 id="16ce" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">禁用strictPropertyInitialization</h2><p id="6bac" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们需要将<code class="fe pe pf pg ov b">tsconfig.json</code>文件中的<code class="fe pe pf pg ov b">strictPropertyInitialization</code>属性设置为false。我们这样做是因为从版本12开始，所有新的Angular应用程序都默认启用严格模式，这意味着如果我们声明任何类属性而没有在构造函数中设置它们(Angular中的常见做法)，TypeScript将会抱怨。我们的<code class="fe pe pf pg ov b">tsconfig.json</code>文件应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">tsconfig.json文件</p></figure><h2 id="5be1" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">删除角样板</h2><p id="7ff7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，但同样重要的是，我们将删除Angular在<code class="fe pe pf pg ov b">app.component.html</code>中自动生成的样板代码。非常小心，确保在删除样板代码时不要删除<code class="fe pe pf pg ov b">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code>标签，否则路由器将无法工作。</p><p id="e83c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">删除所有内容后，您的<code class="fe pe pf pg ov b">app.component.html</code>应该只包含路由器出口标签:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/35762c51e181766132be7cd475c64355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*JA4Fc1QufutXtfAAX5IwdQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">app.component.html的路由器出口标签</p></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="cc29" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">创建仪表板</h1><p id="f0fe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是时候开始构建我们的Angular app了。让我们从创建一个<code class="fe pe pf pg ov b">dashboard</code>模块开始。这是一个模块，它将包含我们想要保护的页面，防止未经授权的用户访问。让我们首先在<code class="fe pe pf pg ov b">src/app</code>目录中创建一个<code class="fe pe pf pg ov b">features</code>目录，它将包含我们所有的特性模块:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="9b79" class="na la it ov b gy oz pa l pb pc">mkdir features</span></pre><p id="4735" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个新目录中，我们将使用Angular CLI创建我们的<code class="fe pe pf pg ov b">dashboard</code>模块:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="960f" class="na la it ov b gy oz pa l pb pc">ng g m dashboard -m app --route dashboard</span></pre><p id="6065" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:我们正在使用</em> <code class="fe pe pf pg ov b"><em class="mv">--route</em></code> <em class="mv">选项，这将在新模块中创建一个组件，并将该组件的路由添加到在</em> <code class="fe pe pf pg ov b"><em class="mv">-m</em></code> <em class="mv">选项提供的模块中声明的</em> <code class="fe pe pf pg ov b"><a class="ae ky" href="https://angular.io/api/router/Routes" rel="noopener ugc nofollow" target="_blank"><em class="mv">Routes</em></a></code> <em class="mv">数组中。</em></p><p id="3e61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您将看到CLI已经在<code class="fe pe pf pg ov b">features</code>目录中创建了一个<code class="fe pe pf pg ov b">dashboard</code>模块，以及它对应的<code class="fe pe pf pg ov b">dashboard-routing.module.ts</code>和组件。还修改了<code class="fe pe pf pg ov b">app-routing.module.ts</code>，增加了一条<code class="fe pe pf pg ov b">dashboard</code>路线，懒加载了<code class="fe pe pf pg ov b">DashboardModule</code>。</p><p id="6763" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们通过修改<code class="fe pe pf pg ov b">dashboard.component.html</code>文件向<code class="fe pe pf pg ov b">dashboard</code>组件添加一些信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仪表板组件模板</p></figure><p id="4ddf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以随意向该文件添加任何内容。</p><p id="9645" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:不要忘记将</em> <code class="fe pe pf pg ov b"><em class="mv">MatToolbarModule</em></code> <em class="mv">导入到</em> <code class="fe pe pf pg ov b"><em class="mv">DashboardModule</em></code> <em class="mv">中，如果你也决定使用它的话。</em></p><p id="db52" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们添加一点CSS，使仪表板看起来很漂亮:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仪表板组件CSS</p></figure><p id="d60f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">瞧，我们的<code class="fe pe pf pg ov b">dashboard</code>模块准备好了！要查看它，我们可以导航到<code class="fe pe pf pg ov b"><a class="ae ky" href="http://localhost:4200/dashboard" rel="noopener ugc nofollow" target="_blank">http://localhost:4200/dashboard</a></code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/2f72a3e57a08ca2ec365a7426fd4b4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTUcEEq7tYLYj8XC1DZVBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仪表板预览</p></figure><p id="1869" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是时候开始我们的认证了。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="1f86" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">创建身份验证模块</h1><p id="8f8d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在<code class="fe pe pf pg ov b">features</code>目录中，我们将使用Angular CLI创建一个<code class="fe pe pf pg ov b">auth</code>模块:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="6649" class="na la it ov b gy oz pa l pb pc">ng g m auth --routing</span></pre><p id="0e0b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:我们正在使用</em> <code class="fe pe pf pg ov b"><em class="mv">--routing</em></code> <em class="mv">标志，它生成一个</em> <code class="fe pe pf pg ov b"><em class="mv">auth-routing.module.ts</em></code> <em class="mv">以及</em> <code class="fe pe pf pg ov b"><em class="mv">auth.module.ts</em></code>。</p><p id="285e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们创建了我们的模块，我们需要将它对应的路径添加到<code class="fe pe pf pg ov b">app-routing.module.ts</code>文件中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将路线添加到app-routing模块</p></figure><p id="b95e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，我们添加了一个通配符路由，它重定向到默认路由。我们这样做是为了如果我们试图导航到任何不存在的路由，而不是抛出一个错误，我们将被重定向。</p><h2 id="3295" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">创建授权服务</h2><p id="994c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们与Firebase和AngularFire的所有互动都将在<code class="fe pe pf pg ov b">AuthService</code>中进行。为了创建我们的服务，我们将再次使用Angular CLI。在我们的<code class="fe pe pf pg ov b">app</code>目录中:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="599a" class="na la it ov b gy oz pa l pb pc">mkdir core<br/>cd core<br/>mkdir services<br/>cd services<br/>ng g s auth</span></pre><p id="a903" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们的<code class="fe pe pf pg ov b">authService</code>中，我们需要做的第一件事是在构造函数中注入AngularFire <code class="fe pe pf pg ov b">Auth</code>实例。然后，我们将创建一个<code class="fe pe pf pg ov b">login</code>方法，它将接收登录数据(电子邮件和密码)，并使用<code class="fe pe pf pg ov b">signInWithEmailAndPassword</code> AngularFire方法登录:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用非类型化登录方法的AuthService</p></figure><p id="fd12" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是，我们的<code class="fe pe pf pg ov b">login</code>功能是不是有点不对劲？我们有一个非常不体面的<code class="fe pe pf pg ov b">any</code>！因为我们正在使用TypeScript，并且我们希望所有的东西都被很好地输入，所以让我们创建一个<code class="fe pe pf pg ov b">LoginData</code>接口来输入我们的登录数据。在我们的<code class="fe pe pf pg ov b">core</code>目录中:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="4951" class="na la it ov b gy oz pa l pb pc">mkdir interfaces<br/>cd interfaces<br/>touch login-data.interface.ts</span></pre><p id="c7f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是我们的界面外观:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LoginData接口<a class="ae ky" href="https://gist.github.com/NyaGarcia/2ec63c5fe25c1d281fcdb011722e9712" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/nya Garcia/2 EC 63 C5 Fe 25 C1 d 281 fcdb 011722 e 9712</a></p></figure><p id="b0d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以使用我们的新接口来正确地键入我们的<code class="fe pe pf pg ov b">login</code>函数的参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有类型化登录功能的AuthService</p></figure><p id="779b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">看起来好多了，不是吗？</p><p id="da71" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还将创建一个register方法，它将使用AngularFire <code class="fe pe pf pg ov b">createUserWithEmailAndPassword</code>方法，以便新用户可以在我们的应用程序中注册。我们还将创建一个<code class="fe pe pf pg ov b">logout</code>方法，正如您可能猜到的，它将允许我们的用户注销我们的应用程序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向AuthService添加注册和注销功能</p></figure><p id="7406" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这就是我们目前在<code class="fe pe pf pg ov b">AuthService</code>中所要做的一切(我们稍后将添加谷歌社交登录选项)。</p><p id="833b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在是创建注册和登录表单的时候了，这样我们的用户就可以通过身份验证了。</p><h2 id="99ca" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">创建登录页面</h2><p id="bfc4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在<code class="fe pe pf pg ov b">auth</code>目录中，我们将创建一个<code class="fe pe pf pg ov b">login-page</code>组件，它将显示一条欢迎消息、用户可以登录的登录表单，以及稍后的google登录按钮:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="0fe8" class="na la it ov b gy oz pa l pb pc">mkdir pages<br/>cd pages<br/>ng g c login-page</span></pre><p id="67d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们创建了我们的页面，让我们转到<code class="fe pe pf pg ov b">login-page.component.html</code>文件并添加一个简单的标题:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="6117" class="na la it ov b gy oz pa l pb pc">&lt;h1&gt;Welcome to NgBytes Login&lt;/h1&gt;</span></pre><p id="2f82" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于页面是路由组件，我们需要向指向<code class="fe pe pf pg ov b">LoginPageComponent</code>的<code class="fe pe pf pg ov b">auth-routing.module.ts</code>文件添加一个路由，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在AuthRoutingModule中路由LoginPageComponent</p></figure><p id="495e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们运行<code class="fe pe pf pg ov b">npm start</code>脚本，并检查所有东西都被正确路由。如果你打开浏览器进入<code class="fe pe pf pg ov b">localhost:4200</code>，你应该会看到这个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/c9ffa48da5fb1e8f27db7763c4bbabb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcSLbo8OtfQR9Ii8Pm7hWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">登录页面组件预览</p></figure><p id="7981" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">厉害！是时候创建一个登录表单了，这样我们的用户就可以登录我们的应用程序了:</p><h2 id="2038" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">创建登录表单</h2><p id="e085" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们将在我们的<code class="fe pe pf pg ov b">auth</code>目录中创建一个<code class="fe pe pf pg ov b">login-form</code>组件:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="00bf" class="na la it ov b gy oz pa l pb pc">mkdir components<br/>cd components<br/>ng g c login-form</span></pre><p id="4d48" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:因为我们不会在本教程中编写任何测试，所以可以随意删除</em> <code class="fe pe pf pg ov b"><em class="mv">login-form.component.spec.ts</em></code> <em class="mv">文件。</em></p><p id="1467" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了创建我们的表单，我们将使用反应式表单模块。我们还将使用棱角分明的材质模块来设计我们的造型。因为这不是本教程的目标，所以我不会详细讨论如何使用反应式表单。</p><p id="2905" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们将把<code class="fe pe pf pg ov b">ReactiveFormsModule</code>、<code class="fe pe pf pg ov b">MatInputModule</code>、<code class="fe pe pf pg ov b">MatFormFieldModule</code>和<code class="fe pe pf pg ov b">MatButtonModule</code>模块导入到我们的<code class="fe pe pf pg ov b">AuthModule</code>中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将模块导入AuthModule</p></figure><p id="b8fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们将在我们的<code class="fe pe pf pg ov b">login-form.component.ts</code>文件中创建表单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">loginform组件逻辑</p></figure><p id="766c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，我们在表单中添加了基本验证:电子邮件和密码字段都是必填的，电子邮件字段只允许有效的电子邮件地址。</p><p id="5abd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">提示:发现我们使用</em> <code class="fe pe pf pg ov b"><em class="mv">EventEmitter</em></code> <em class="mv">在提交时发出表单数据很奇怪吗？这是因为我们使用了智能/非智能组件模式，该模式将业务逻辑从纯粹的表示组件中分离出来。</em></p><p id="4ca9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，在我们的<code class="fe pe pf pg ov b">login-form.component.html</code>文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LoginFormComponent模板</p></figure><p id="4b63" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mv">注意:看到我们如何在表单无效时禁用提交按钮了吗？这是一个糟糕的实践(可怜的UX)，我这样做的唯一原因是为了简洁，因为本教程应该专注于AngularFire，而不是角形的最佳实践。但是，请注意，不要在家里这样做！</em></p><p id="27d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们在<code class="fe pe pf pg ov b">login-form.component.css</code>文件中添加一点CSS来使表单更漂亮(如果你愿意，可以跳过这一步):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">loginform组件CSS</p></figure><p id="dd30" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">太好了！我们现在有了一个可爱的登录表单。剩下的就是将它添加到<code class="fe pe pf pg ov b">login-page.component.html</code>模板中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将登录表单添加到登录页面</p></figure><p id="a203" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还需要将之前创建的<code class="fe pe pf pg ov b">authService</code>注入到我们的<code class="fe pe pf pg ov b">login-page.component.ts</code>文件中，并创建一个<code class="fe pe pf pg ov b">login</code>方法，该方法将使用<code class="fe pe pf pg ov b">authService</code>让用户登录，并在完成后重定向到仪表板。不要忘记捕捉任何可能的错误！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在登录页面组件中创建登录方法</p></figure><p id="94f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们通过浏览浏览器并填写表单来测试一下我们到目前为止所做的工作。如您所见，如果我们试图将电子邮件字段留空，或者输入无效的电子邮件，将会显示一个错误，这意味着我们的验证工作非常出色。但是，如果我们尝试按提交按钮…</p><p id="6476" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的控制台出现用户未找到错误。嗯，我们当然是。我们还没有注册任何用户吧？让我们创建一个注册表，这样我们就可以这样做了！</p><h2 id="1d14" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">创建注册页面</h2><p id="8010" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">就像我们对登录页面所做的一样，我们将创建一个注册页面，它将包含注册表单。在<code class="fe pe pf pg ov b">auth/pages</code>目录内:</p><pre class="kj kk kl km gt ou ov ow ox aw oy bi"><span id="a07f" class="na la it ov b gy oz pa l pb pc">ng g c register-page</span></pre><p id="8c30" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们为注册页面添加一个标题和一些样式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">RegisterPageComponent模板</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">RegisterPageComponent CSS<a class="ae ky" href="https://gist.github.com/NyaGarcia/f6f3f5892f711fa31fa4acac1c886968" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/nya Garcia/f6f 3f 5892 f 711 fa 31 fa 4 acac 1c 886968</a></p></figure><p id="594a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，但同样重要的是，我们需要向<code class="fe pe pf pg ov b">auth-routing.module.ts</code>文件添加一个<code class="fe pe pf pg ov b">register</code>路径:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加RegisterPageComponent路由</p></figure><p id="1fa9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">既然我们的注册页面已经完成，那么我们需要做的就是创建一个注册表单…或者我们需要做什么？</p><p id="7837" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的登录表单有两个字段，一个电子邮件和一个密码字段。我们的注册表需要有两个字段，一个电子邮件和一个密码字段。明白我的意思了吗？我们的两种形式将完全相同！你可能会想，不，它们不一样。一个表单用于登录，另一个用于注册新用户；两种完全不同的逻辑。</p><p id="3870" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而…</p><p id="1edb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">还记得我们如何使用智能/非智能组件模式将登录表单从登录页面中分离出来吗？我们的登录表单根本不负责执行任何逻辑，而是我们的登录页面。这意味着我们可以在注册页面中自由重用登录表单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将登录表单添加到注册页面</p></figure><p id="b6bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">很整洁，不是吗？现在是实现注册新用户的逻辑的时候了。当然，我们会在我们的<code class="fe pe pf pg ov b">register-page.component.ts</code>文件中这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将寄存器逻辑添加到RegisterPageComponent</p></figure><p id="1f8c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，我们调用了<code class="fe pe pf pg ov b">authService.register</code>方法，该方法将在我们的Firebase应用程序中注册新用户，然后我们导航到登录页面，以便我们新注册的用户可以登录到我们的应用程序。</p><p id="d891" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们给登录页面添加一些最后的润色:一个将新用户重定向到注册页面的按钮，并稍微改变一下布局，使其看起来不错:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">改进登录页面</p></figure><p id="f166" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一些CSS魔法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向登录页面添加样式</p></figure><p id="6a79" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">既然我们已经使登录页面看起来很漂亮，让我们花点时间对注册页面做同样的事情:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">改进注册页面</p></figure><p id="4501" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">更多CSS:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向注册页面添加样式</p></figure><p id="30aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是时候测试我们到目前为止所做的事情了。前往您的浏览器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/a56d50ac980cfa147b2e0871baf3d190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*8DLjcszEUuX1WLJ80BuI2A.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">注册新用户并登录</p></figure><p id="d485" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">厉害！我们正在登录我们的应用！然而，我们仍然缺少一些东西，不是吗？我们需要一个注销选项！让我们将它添加到我们的仪表板中。</p><h2 id="99dc" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">添加注销选项</h2><p id="3baa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们前往我们的<code class="fe pe pf pg ov b">dashboard.component.html</code>，创建一个注销选项:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向仪表板添加注销选项</p></figure><p id="436d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们有了注销选项，我们需要给我们的<code class="fe pe pf pg ov b">dashboard.component.ts</code>添加一些逻辑。首先，我们将在构造函数中注入<code class="fe pe pf pg ov b">AuthService</code>，然后我们将创建一个<code class="fe pe pf pg ov b">logout</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向仪表板组件添加注销方法</p></figure><p id="5c32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，一旦我们调用了<code class="fe pe pf pg ov b">logout</code>方法，我们将把用户重定向到默认路线。就是这样！我们已经成功实现了一种让用户从我们的应用中注销的方法。让我们再次测试我们的应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/866cc6bf7fa5974977af836b1b60d296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*s2HaIuK5zaI8VcWe-UzFUg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">注销</p></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="197a" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">添加Google登录</h1><p id="4d82" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，我们的传统登录已经完全实现，是时候添加我们的谷歌社交登录了。为此，我们将首先在<code class="fe pe pf pg ov b">auth.service</code>中创建必要的方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向AuthService添加loginWithGoogle方法</p></figure><p id="a3a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们需要在登录页面上添加一个Google登录按钮:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加Google登录按钮</p></figure><p id="5967" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们需要给我们的<code class="fe pe pf pg ov b">login-page.component.ts</code>添加一个<code class="fe pe pf pg ov b">loginWithGoogle</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向LoginPageComponent添加loginWithGoogle方法</p></figure><p id="02c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们完了！让我们到我们的浏览器那里试一试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/b08cc627d15e338fe3e4a8fff89947d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*f-JtfXA6h2TJEBJsN63HJw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">登录google</p></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="49fc" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">保护路线</h1><p id="cc5d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你试图导航到仪表板页面<code class="fe pe pf pg ov b">localhost:4200/dashboard</code>，你会发现你可以这样做，即使你未经认证。为了解决这个问题，我们将使用AngularFire提供的auth guard，自动将未授权用户重定向到登录页面。在我们的<code class="fe pe pf pg ov b">app-routing.module.ts</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">保护路线</p></figure><p id="8fc6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如你所看到的，我们用AngularFire <code class="fe pe pf pg ov b">AuthGuard</code>保护了<code class="fe pe pf pg ov b">dashboard</code>路线，并且我们用AngularFire <code class="fe pe pf pg ov b">redirectUnauthorizedTo</code>管道建造了一个<code class="fe pe pf pg ov b">redirectUnauthorizedToLogin</code>管道，然后提供给<code class="fe pe pf pg ov b">AuthGuard</code>。这将确保任何试图访问仪表板页面的未经身份验证的用户都将被自动重定向到登录页面。请随意打开您的浏览器，尝试一下。</p><p id="d837" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">同样，我们不希望未经授权的用户访问仪表板，如果用户已经过身份验证，他们就不能导航到登录页面。让我们创建另一个自定义管道，它将已经登录的用户重定向到仪表板:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将重定向登录添加到主路由保护</p></figure><p id="0d19" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，如果我们登录并尝试访问登录页面，我们将被自动重定向到控制面板。</p><h2 id="139f" class="na la it bd lb nb nc dn lf nd ne dp lj ma nf ng ll me nh ni ln mi nj nk lp nl bi translated">可以激活的助手</h2><p id="6f78" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">AngularFire为我们提供了一个<code class="fe pe pf pg ov b">canActivate</code>助手，我们可以将它与spread操作符一起使用，使我们的路线更具可读性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用canActivate助手使路线更具可读性</p></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="766b" class="kz la it bd lb lc oh le lf lg oi li lj jz oj ka ll kc ok kd ln kf ol kg lp lq bi translated">结论</h1><p id="69f6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">那都是乡亲们！恭喜您，您已经使用Angular 13和最新的AngularFire 7模块化SDK成功创建了一个身份验证应用程序。</p><p id="a685" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请记住，新的API并不完整，所以如果您决定继续使用它，那么风险自负。此外，请记住，AngularFire 7提供了一个兼容层，以便您可以继续使用以前的AngularFire 6 API。</p><p id="2fe6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望这个教程对你有用。非常感谢您的阅读。</p></div></div>    
</body>
</html>