<html>
<head>
<title>Stop Breaking the Open-Closed Principle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止打破开闭原则</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/stop-breaking-the-ocp-108dcba14a07?source=collection_archive---------7-----------------------#2022-08-18">https://betterprogramming.pub/stop-breaking-the-ocp-108dcba14a07?source=collection_archive---------7-----------------------#2022-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cbd0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当你打破OCP原理时，你能做什么？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a559d9ebba7e613d9e099f040905566e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LVwXqMqYnBDNRrdp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@timmossholder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">蒂姆·莫斯霍尔德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="4dff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">技术工程面试中最常见的一个问题是:什么是<code class="fe lv lw lx ly b">S.O.L.I.D</code>以及你是否能为每个原则提供一些例子。</p><p id="5920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有很多资源宣扬SOLID应该如何工作。然而，实际上，魔鬼就在细节中。</p><h1 id="0c4a" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">开闭原则</h1><p id="dc63" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">这是什么？</p><blockquote class="mw mx my"><p id="78a9" class="kz la mz lb b lc ld ju le lf lg jx lh na lj lk ll nb ln lo lp nc lr ls lt lu im bi translated">对象或实体应该对扩展开放，但对修改关闭。</p></blockquote><p id="3ac2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着实体应该是可扩展的，而不需要修改实体本身。</p><p id="f632" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">违反OCP的头号标志是使用<code class="fe lv lw lx ly b">if-else</code>或<code class="fe lv lw lx ly b">switch</code>语句。顺便提一下，<code class="fe lv lw lx ly b">if-else</code>或<code class="fe lv lw lx ly b">switch</code>的任何分支都应该为可能的代码味道打上一个小问号。</p><p id="abfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能在代码库中找到的情况示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="17cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设业务需求发生了变化，您需要添加一个<code class="fe lv lw lx ly b">AnalyticsLogger</code>，它将记录在<code class="fe lv lw lx ly b">GoogleAnalytics</code>或<code class="fe lv lw lx ly b">FacebookAnalytics</code>中。</p><p id="3d01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的<code class="fe lv lw lx ly b">Logger</code>类是开放扩展的，但同时也会开放修改(因为你实际上需要添加一个新的<code class="fe lv lw lx ly b">switch case</code>)，这就违反了<code class="fe lv lw lx ly b">OCP</code>。</p><p id="4cec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看另一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="5697" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">if-else</code>分支逻辑在不同的存储可能性之间进行选择:首先也是最重要的，糟糕的代码味道是使用了不是常量或枚举的字符串文字:这样会导致很多不好的事情和错误，但那是另一回事了。</p><p id="1ed1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设<code class="fe lv lw lx ly b">Product Owner</code>在一个月后到来，并且希望应用程序能够在内存中存储一些东西，而不是两种持久的方式。接下来会发生什么？另一个<code class="fe lv lw lx ly b">else if</code>案例场景，然后是另一个，以此类推。</p><p id="8912" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他情况可能是，但不限于:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf"><p id="42e4" class="ng nh it bd ni nj nk nl nm nn no lu dk translated">我们可以清楚地看到这里出现了一种模式。</p></blockquote><p id="7569" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">现在自然的问题是，我们如何解决它？怎么才能预防呢？</p><p id="bb5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有可能的实现场景都应该符合某种抽象(接口、协议等)。)，正确实施的决策者应该在责任链中被移到更高的位置。</p><p id="1e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在带有<code class="fe lv lw lx ly b">StorageService</code>的例子中说明这一点，我们将使用一个叫做<code class="fe lv lw lx ly b">Strategy</code>的行为设计模式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f108" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您仔细查看第32行，然后查看第38–40行，我们可以得出这样的结论:<code class="fe lv lw lx ly b">StorageService</code>实体现在已经被“锁定”，对修改关闭，并对扩展开放。第38–40行告诉我们，我们可以根据需要添加多少新的存储方法，而不需要修改<code class="fe lv lw lx ly b">StorageService</code>中的代码。</p><p id="3c71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们回到了一个干净的架构的轨道上，只需要根据设计模式进行简单的代码转换。</p><p id="6974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于一张图片胜过千言万语，如果代码库没有针对可伸缩性进行适当的架构和构建，我将提供一个可视化的表示，说明代码中的一个简单更改是如何在如此多的级别上产生影响的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/de42a7231baadae34c9ced01a28c83d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ura7mmKJPEBGBqobU8XXOA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:戴夫·尼科莱特</p></figure><p id="cd78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">感谢阅读！</em></p><p id="6262" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">敬请期待更多。</em></p><div class="nv nw gp gr nx ny"><a href="https://medium.com/@catalin.patrascu/membership" rel="noopener follow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">用我的推荐链接加入媒体- Catalin Patrascu</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">阅读Catalin Patrascu的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>