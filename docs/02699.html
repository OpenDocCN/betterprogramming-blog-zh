<html>
<head>
<title>Capturing Photos Using the Camera in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中使用相机拍摄照片</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/capturing-photos-using-camera-in-flutter-585656cd3a69?source=collection_archive---------1-----------------------#2019-12-18">https://betterprogramming.pub/capturing-photos-using-camera-in-flutter-585656cd3a69?source=collection_archive---------1-----------------------#2019-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f6b6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将您的相机带入您的应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/efcde5048b4d55e8bf839ceee52fef63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGeqIXydVtdNT9mA1Rzhiw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/s/photos/camera?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@sharegrid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> ShareGrid </a>拍摄的照片</p></figure><p id="6cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://medium.com/better-programming/displaying-photos-from-your-photo-library-in-flutter-applications-34b8799a3849" rel="noopener">的上一篇文章</a>中，我讨论了如何使用Flutter中的图像拾取器包从照片库中选择图像。它工作得很好，我们能够在我们的应用程序中显示图像。</p><p id="eb6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这最后一部分，我将演示如何使用手机的摄像头捕捉照片并显示在屏幕上。强烈建议您阅读第一部分，因为在之前的帖子中已经讨论了很多配置和权限请求。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0c02" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="5a2d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">第一步是安装<a class="ae ky" href="https://pub.dev/packages/camera" rel="noopener ugc nofollow" target="_blank">相机</a>插件。相机插件将允许我们使用设备上的物理相机并拍摄照片。首先向pubspec.yaml文件添加相机依赖项，如下面的实现所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b0b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要更新_showOptions方法，以考虑用户何时选择从相机拍照选项。实现如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="ecb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">showCamera方法负责访问可用的相机，然后将用户带到一个单独的视图来预览照片。第一个摄像头将是背面摄像头。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="4d28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，TakePicturePage不存在。TakePicturePage将负责允许用户使用他们的相机捕捉照片。在下一节中，您将学习如何向用户显示相机预览，然后将捕获的照片发送回主页，以便它可以显示在屏幕上。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7c0e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从相机中捕捉照片</h1><p id="531b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当用户选择相机选项时，他们被带到拍照页面。拍照页面将允许他们预览图片，然后点击按钮进行拍摄。</p><p id="074c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拍照页面使用CameraController来拍照。CameraController还用于设置和配置预览。TakePicturePage小部件的初始化如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2b73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建TakePicturePage小部件，camera是必需的参数。TakePicturePage也是一个有状态的小部件，由initState方法组成，它负责初始化相机控制器。</p><p id="509e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是预览相机。要做到这一点，你可以在物理设备或Android模拟器上运行应用程序。请注意，预览和拍照在iOS模拟器上不起作用。</p><p id="2844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">预览相机视图的实现如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8688" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用FutureBuilder来评估_ initializecameracontrollerfuture，然后使用CameraView来显示相机的预览。如果未来仍在解析，那么我们显示一个循环的CircularProgressIndicator()而不是CameraPreview小部件。</p><p id="8313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/fa1420a9750623c56e44a84d959002ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/1*SG4f6L0YMBtuvYOlHuY13w.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安卓模拟器假房间测试摄像头捕捉</p></figure><p id="caf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Android使用虚拟房间模拟，因此用户可以使用模拟器测试拍照，而不必在真实的物理设备上安装应用程序。</p><p id="3f18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">始终、始终、始终确保在将应用部署到生产环境之前，在物理设备上运行应用</p><p id="9375" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步是拍照。我们在堆栈中添加了一个FloatingButton作为第二个子元素。按钮将负责捕捉照片。点击按钮时，触发_takePicture方法。_takePicture方法的实现如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="36ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们等待_ initializeCameraControllerFuture解析。一旦解决了未来问题，我们就获得了保存图像的临时目录的路径。最后，我们调用_cameraController实例上的takePicture函数，该函数拍摄照片并将其保存到特定路径。拍照后，我们从堆栈中弹出页面，并通过将路径作为第二个参数传递给Navigator.pop方法来发回路径。这意味着呼叫者现在可以访问该路径，并使用它来显示最近捕获的照片。</p><p id="b90c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到主页小部件，我们从导航器中获取路径并设置状态，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9042" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们在setState闭包内设置了_path的值，这将导致构建函数被触发，从而显示捕获的图像。构建函数的实现如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="6b73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7c4a83ff43aa0262b97eeba1147ee741.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/1*VRFAiXr80D1CLPw6AMVzwQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用相机套装拍照</p></figure><p id="2192" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，您了解了如何从物理设备上捕获图像并在页面上显示。我鼓励你下载代码，在设备上运行应用程序，并尝试一下。</p><p id="dc78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/azamsharp/AzamSharp-Weekly/blob/master/photo_app_camera.zip" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p><div class="nd ne gp gr nf ng"><a href="https://medium.com/better-programming/displaying-photos-from-your-photo-library-in-flutter-applications-34b8799a3849" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">在Flutter应用程序中显示照片库中的照片</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">向您的Flutter应用程序介绍美丽的图像</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ks ng"/></div></div></a></div><p id="8270" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p></div></div>    
</body>
</html>