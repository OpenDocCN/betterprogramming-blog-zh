# JavaScript 中常用的设计模式

> 原文：<https://betterprogramming.pub/commonly-used-design-patterns-in-javascript-bfcd91827002>

## 单例模式、迭代器模式和工厂模式

![](img/6d8dc62ca4a1a4c73dc94f8c62728806.png)

乔治·帕甘三世在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片。

设计模式使我们能够以标准的方式组织程序代码。

《设计模式:可重用面向对象软件的元素》一书于 1994 年出版，书中提出了 23 种面向对象程序使用的设计模式。

在本文中，我们将研究 JavaScript 程序中一些更常用的设计模式，包括单例模式、迭代器模式和工厂模式。

# 一个

Singleton 是 JavaScript 中常见的一种模式。它是一个只创建一个对象实例的类。

在 JavaScript 中，我们用 object literal 来定义一个不是类的实例的对象。例如，我们有:

```
const obj = {
  foo: 1
}
```

我们还有类语法，它做的事情和构造函数一样，我们可以定义一个`getInstance`方法来获得一个类的实例。

要创建一个单例类，我们可以编写如下代码:

既然我们将`this`赋给了`this.instance`，并在`getInstance`中返回，我们应该总是得到相同的引用。

我们应该让`foo1 === foo2`成为`true`，因为它们引用了`Foo`类的同一个实例。

单例类对于 facade 对象隐藏程序的复杂性很有用。由程序的不同部分共享的状态对象也使单例类成为一个好的选择。

它们还让我们无需创建全局变量就能共享数据。全局范围没有被污染，所以它是共享数据的一个好选择。

# **迭代器**

迭代器模式是一种我们创建迭代器来顺序访问容器中的数据的模式。

我们需要这种模式来遍历集合中的项目，而不暴露底层数据结构。我们还应该能够在不改变接口的情况下遍历聚合对象中的对象。

在 JavaScript 中，我们可以定义可迭代的对象和生成器来实现这一点。

要定义一个可迭代对象，我们可以这样写:

正如我们所见，`iterableObj`从外部隐藏了它内部的数组。此外，我们可以将它更改为我们想要的任何其他内容，而不必担心在外部更改代码。

`[Symbol.iterator]`自 ES6 起，发电机功能已可用。从此以后，我们可以很容易地定义迭代器。

我们还可以定义返回生成器的生成器函数。为此，我们可以编写以下代码:

这与`iterableObj`相似，因为它们都使用发电机。不同之处在于`generatorFn`是一个返回生成器的生成器函数。生成器是我们迭代的对象。

![](img/bd8aa651e400ead4374220ef106efd09.png)

照片由[纳希尔·纳赛尔](https://unsplash.com/@nahilnaseer?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄。

# **工厂**

工厂模式以工厂功能为中心。它是一个不使用`new`关键字构造类的实例或构造函数就返回对象的函数。

我们希望使用工厂模式使代码更具可读性，因为它允许我们创建从更多代码中返回新对象的函数。

它还允许我们在不知道创建对象的代码的情况下返回对象。我们不必担心实例化什么类来创建对象，或者它是如何创建的。

在 JavaScript 中，当一个函数返回一个不带`new`关键字的对象时，它就是一个工厂函数。

例如，我们可以如下创建一个简单的工厂函数:

```
const createFoo = () => ({
  foo: 1
});
```

调用`createFoo`函数时，它总是返回`{ foo: 1 }`对象。它总是返回一个不带`new`关键字的对象，所以它是一个工厂函数，使用工厂模式。

工厂函数在 JavaScript 中很常见。例如，浏览器使用`document.querySelector()`方法获取一个给定 CSS 选择器的 DOM 对象。

JavaScript 中到处都有类似的返回对象的方法。

单例模式创建一个对象的单个实例。在 JavaScript 中，我们可以用对象文字或一个类的`getInstance`方法来实现这一点，它总是返回一个类的同一个实例。

它对于共享数据和隐藏实现的复杂性很有用。

迭代器模式让我们在不知道实现的情况下遍历对象集合。此外，它让我们可以在不改变接口的情况下改变底层的数据结构和逻辑。

除了生成器函数，JavaScript 还有迭代器来做这件事。

最后，工厂模式在 JavaScript 中很常见。任何不使用`new`关键字实例化就返回新对象的函数都是工厂函数。

这对向其他开发人员隐藏创建对象的复杂性很有用。例如，我们不必担心`document.querySelector()`如何从 DOM 中获取元素。它只返回匹配选择器的第一个 DOM 元素。