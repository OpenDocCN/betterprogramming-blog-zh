<html>
<head>
<title>Compose and Pipe in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中合成和管道</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/compose-and-pipe-in-javascript-medium-d1e1b2b21f83?source=collection_archive---------1-----------------------#2020-10-05">https://betterprogramming.pub/compose-and-pipe-in-javascript-medium-d1e1b2b21f83?source=collection_archive---------1-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c10b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">函数式编程:JavaScript中的<strong class="ak">组成</strong>和<strong class="ak">管道</strong>是什么？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e0e5b6ad485fcc0a17506415b0041dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QJRGmyvwn9G-rhTu"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Neil Daftary 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="0848" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Compose</code>和<code class="fe lv lw lx ly b">Pipe</code>是JavaScript函数式编程中最强大的概念。然而，它们可能很难理解。本文将帮助您更好地掌握这些功能。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4f83" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">作曲</strong></h1><p id="2fe9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在代数中，函数组合<strong class="lb iu"> </strong>允许你将一个函数应用于另一个函数的输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/edb944b75c5963b2dbe8eafc908f16e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*0YgQNEzUJfIxcLLD2K2LFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="a2ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，函数<code class="fe lv lw lx ly b">g</code>被应用于将函数<code class="fe lv lw lx ly b">f</code>应用于<code class="fe lv lw lx ly b">x</code>的结果。正如我们所看到的，函数组合是从右向左工作的。</p><p id="be0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">compose</code>在JavaScript中也可以得到同样的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/d79cc605b4496171588e66b0fb7a83ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*ha_OpILp3TFPDklYXV5nXw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="fcc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧…真的很困惑。让我们看一个例子。</p><p id="0477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设我们想得到一个用户的名字，并把它大写。首先，我们必须编写一个提取用户名的函数:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="8324" class="nj mh it ly b gy nk nl l nm nn">const user = {name: 'Gianmarco', password: 1234}<br/>const getUserName = (user) =&gt; user.name<br/>getUserName(user)<br/>// 'Gianmarco'</span></pre><p id="ae2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后是一个大写字符串的函数:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="f3f6" class="nj mh it ly b gy nk nl l nm nn">const upperCase = (string) =&gt; string.toUpperCase()<br/>upperCase('Gianmarco')<br/>// 'GIANMARCO'</span></pre><p id="1693" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以将这两个函数组合成一个函数来执行这两个操作:获取名称并将其大写。</p><p id="b0cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用之前看到的<code class="fe lv lw lx ly b">compose()</code>的实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="a801" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个<code class="fe lv lw lx ly b">compose()</code>实现的问题是它只接受两个函数作为参数(在我们的例子中，<code class="fe lv lw lx ly b">upperCase()</code>和<code class="fe lv lw lx ly b">getUserName()</code>)。</p><p id="f570" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想添加另一个返回字符串前四个字符的函数:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="5bec" class="nj mh it ly b gy nk nl l nm nn">const firstFour = (string) =&gt; string.substring(0,4)<br/>firstFour(‘GIANMARCO’);<br/>// 'GIAN'</span></pre><p id="1e4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如何一次编写两个以上的函数？</p><p id="e17e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用<code class="fe lv lw lx ly b">Compose</code>和<code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/javascript-scene/reduce-composing-software-fe22f0c39a1d" rel="noopener">reduceRight()</a></code> <strong class="lb iu"> </strong>的方法:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="5180" class="nj mh it ly b gy nk nl l nm nn">const compose = (...functions) =&gt; x =&gt; functions.reduceRight((acc, fn) =&gt; fn(acc), x);</span></pre><p id="fd99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个实现中，<code class="fe lv lw lx ly b">compose()</code>采用<em class="nq"> rest参数</em>(任意数量的参数——在这个例子中，任意数量的函数)并返回一个采用初始值<code class="fe lv lw lx ly b">x</code>的函数。然后，它使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/javascript-scene/reduce-composing-software-fe22f0c39a1d" rel="noopener">reduceRight()</a></code> <strong class="lb iu"> </strong>方法从右向左迭代<code class="fe lv lw lx ly b">functions</code>中的每个函数<code class="fe lv lw lx ly b">fn</code>，并依次将其应用于累加值<code class="fe lv lw lx ly b">acc</code>。</p><p id="9fce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更简单地说，<code class="fe lv lw lx ly b">compose()</code>将任意数量的函数从右向左应用于前一个函数的输出。</p><p id="5069" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个新的<code class="fe lv lw lx ly b">compose()</code>实现，我们现在可以创建一个函数来获取用户名，大写，并只返回它的前四个字符:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="555d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很酷，对吧？</p><p id="26d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它就像一个从右到左工作的命令列表(从数学符号的意义上来说)。当我们调用<code class="fe lv lw lx ly b">compose()</code>时，函数<code class="fe lv lw lx ly b">getUserName()</code>是最后一个参数，因为它是要执行的第一个函数。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="77cc" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">管道</strong></h1><p id="99f1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">Pipe</code>和<code class="fe lv lw lx ly b">compose()</code>一模一样，但是是从左到右工作的。我个人更喜欢它而不是<code class="fe lv lw lx ly b">compose()</code>，因为你可以把它想象成一系列事件。</p><p id="98f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想用<code class="fe lv lw lx ly b">pipe()</code>重新创建上面的<code class="fe lv lw lx ly b">compose()</code>函数，我们可以使用这个实现:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="0d47" class="nj mh it ly b gy nk nl l nm nn">const pipe = (...functions) =&gt; x =&gt; functions.reduce((acc, fn) =&gt; fn(acc), x);</span></pre><p id="c2fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你注意到的，我们现在使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/javascript-scene/reduce-composing-software-fe22f0c39a1d" rel="noopener">reduce()</a></code> <strong class="lb iu"> </strong>而不是<code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/javascript-scene/reduce-composing-software-fe22f0c39a1d" rel="noopener">reduceRight()</a></code>，因为函数从左到右迭代。</p><p id="d4b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的最终结果将是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="fddf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一系列事件，<code class="fe lv lw lx ly b">pipe()</code>将<code class="fe lv lw lx ly b">getUserName()</code>应用于我们的初始数据，然后将<code class="fe lv lw lx ly b">upperCase()</code>应用于将<code class="fe lv lw lx ly b">getUserName()</code>应用于我们的初始数据的结果。最后，它会将<code class="fe lv lw lx ly b">firstFour()</code>应用到将<code class="fe lv lw lx ly b">upperCase()</code>应用到将<code class="fe lv lw lx ly b">getUserName()</code>应用到初始数据的结果的输出中。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="ac0f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="f202" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">希望这篇文章能澄清你的一些疑惑，帮助你掌握<code class="fe lv lw lx ly b">Compose</code>和<code class="fe lv lw lx ly b">Pipe</code>的潜力。</p><p id="965a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以创建像工厂传送带一样接收数据的函数，这些数据经过所有这些不同的函数，直到我们最终获得输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/81f4cf88ec6df7af330a3bc09c648c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M66BkV3mHUFs417euzOJaA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="f859" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nq">考虑</em> <a class="ae ky" href="https://ebelinggianmarco.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="nq">成为中等成员</em></strong></a><strong class="lb iu"><em class="nq"/></strong><em class="nq">如果你喜欢看这样的故事，并且想帮助我这个作家。每月5美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae ky" href="https://ebelinggianmarco.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="nq">我的链接报名，我会得到一点佣金。</em> </strong> </a></p></div></div>    
</body>
</html>