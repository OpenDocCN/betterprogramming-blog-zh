# 后端开发人员 API 响应的 3 个技巧

> 原文：<https://betterprogramming.pub/3-tips-on-api-responses-for-backend-developers-8df31c23882e>

## 关于 API 响应，我希望我已经知道了什么

![](img/6afad417fc32589aa7f916472725ec1b.png)

加布里埃尔·海因策在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

我现在做全栈 web 开发者已经 4 年了，但是我还记得我早期的奋斗。尽管我认为前端开发并不容易，但我一直认为后端开发是我工作中最棘手的部分。

距离我编写第一个 API 已经有一段时间了，从那以后我学到了很多。具体来说，在成为后端开发人员之前，我希望知道如何产生完美的 API 响应。现在，是时候分享它们了，这样任何阅读本文的后端开发人员都可以从中受益。

现在让我们来深入研究这 3 个关于 API 响应的技巧。

# 总是返回一个对象

当构建返回单个值的 API 时，您可能会尝试直接序列化它，如下所示:

原始 API 响应

这实际上是一个有效的 JSON 响应，如下所示:

*   字符串(例如`"Hello world"`)
*   一个数字(例如`1`)
*   一个布尔值(如`true`)
*   `null`

您可能希望这样做来保持 API 响应的干净和简单，但这实际上是一种糟糕的方法。我来解释一下原因。

假设您需要让 API 返回多个值。这是一个相当常见的场景。毕竟，您无法知道您的 API 需要如何发展才能满足未来的需求。在这种情况下，您将被迫将 API 响应转换为对象，从而彻底改变 API 响应。

例如，新的响应将是这样的:

新的 API 响应

这个小小的改变将迫使任何调用该 API 的开发人员相应地更新他们的代码。这是因为 API 最初返回的数组现在存储在`result`字段中，这在旧的响应中没有出现。

问题在于原始的 API 响应，它应该总是一个对象。特别是，通过生成如下响应，当添加新字段时，开发人员不必更改他们的逻辑。

最初的 API 响应应该是怎样的

# 除了 JSON，还有其他数据格式

JSON 是您通常想要使用的数据格式。同时，你必须记住，HTTP 头可以采用许多可能的 MIME 类型。`application/json`不是唯一可用的。

具体来说，可能会要求您检索一些数据并生成纯文本文件或结构化文件，如 CSV 文件。这确实发生在我身上，正如这篇文章中所描述的。

[](https://codeburst.io/returning-csv-content-from-an-api-in-spring-boot-63ea82bbcf0f) [## 从 Spring Boot 的 API 返回 CSV 内容

### 通过直接返回 CSV 数据来避免转换开销

codeburst.io](https://codeburst.io/returning-csv-content-from-an-api-in-spring-boot-63ea82bbcf0f) 

在这种情况下，您的方法可能是开发一个用 JSON 返回所需数据的 API。然后，让调用者处理将其转换成所需格式的过程。虽然这种方法没有错误，但不是最好的方法。

你不应该把数据检索过程和数据转换过程分开，只是为了让你的 API 更加标准。因为您可以直接返回以所需格式构造的数据，所以您应该开发一个自定义 API 来实现这一点。

尽管与其他 API 相比，这个 API 可能看起来非常规，但它将直接满足您的需求。此外，将整个逻辑放在一个地方会更加优雅和易于维护。

# 不要省略`null`值

如 [ECMA-404](https://www.ecma-international.org/publications-and-standards/standards/ecma-404/) 标准所述，`null`是一个有效的 JSON 值。

> 一个*值*可以是双引号中的*字符串*，或者是*数字*，或真或假或空，或者是*对象*或*数组—* [引入 JSON](https://www.json.org/json-en.html)

开发人员通常倾向于从他们的回答中过滤掉所有的`null`值，以使它们更简洁。这本身并没有错，尤其是当性能和网络使用是优先考虑的因素时。事实上，JSON 越大，下载和解析它需要的时间就越多。

另一方面，从 JSON 响应中省略`null`值不应该是首选方法。

第一，因为`null`和缺失值在 JSON 中有两种不同的含义。第一个表示“无值”，第二个表示“无给定值”*。*具体来说，如果你熟悉 JavaScript，这和`[null](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null)`和`[undefined](https://developer.mozilla.org/en-US/docs/Glossary/undefined)`的区别是一样的。差别是微妙的，但是能够区分这两种细微差别可能是至关重要的。

第二，返回一个响应，它的字段根据它们的值而变化，这很容易使调用 API 的开发人员感到困惑。原因是 API 的响应应该总是一致的。不遵守这一原则很容易导致失败，也使调试过程更加复杂。

第三，缺少值会引入不必要的不确定性。调用 API 的开发人员可能会奇怪为什么省略了一些字段。因为弄清楚这是不是故意的可能不容易，这将导致不必要的怀疑。

# 结论

为您的 API 找到正确的响应是很棘手的，这取决于您的需求。然而，有几个小贴士可以让你避免将来因为过去的错误决定而头疼。在这里，我们看了我认为的关于 API 响应的 3 个最重要的技巧，以我作为高级后端开发人员的经验为依据。我已经成功地使用它们很长时间了，我希望在编写我的第一个 API 之前就了解它们。

感谢阅读！我希望我的故事对你有所帮助。如果有任何问题、意见或建议，请随时联系我。