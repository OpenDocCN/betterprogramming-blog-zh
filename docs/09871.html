<html>
<head>
<title>5 Tips in Bash Scripting for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bash脚本初学者的5个技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-tips-in-bash-scripting-for-beginners-e113a2cf1510?source=collection_archive---------1-----------------------#2021-10-24">https://betterprogramming.pub/5-tips-in-bash-scripting-for-beginners-e113a2cf1510?source=collection_archive---------1-----------------------#2021-10-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b156" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Bash脚本中的有用技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a003924c7d8126d3b6392920f37d5c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-7dwsa6BaaHMNJGY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@trancepole?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马蒂亚斯·施罗德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="4dca" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.如何与最终用户互动</h1><p id="9ae2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将提供一个简单的<code class="fe mn mo mp mq b">read</code>语句示例，展示如何与最终用户进行交互。注意，在这个例子中，我们不处理错误，因为我们想保持简单。让我们创建<code class="fe mn mo mp mq b">read.sh</code>脚本。</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="0c57" class="mv la it mq b gy mw mx l my mz">echo "Enter your First Name: "<br/>read FIRSTNAME<br/>echo "Enter your Last Name: "<br/>read LASTNAME</span><span id="5296" class="mv la it mq b gy na mx l my mz">echo ""<br/>echo "Your Full Name is $FIRSTNAME $LASTNAME"</span><span id="7f25" class="mv la it mq b gy na mx l my mz">echo ""<br/>echo "Enter your Age: "<br/>read AGE</span><span id="1ad1" class="mv la it mq b gy na mx l my mz">echo "Next year, you will be `expr $AGE + 1` years old."</span></pre><p id="6f08" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">让我们现在运行它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/bce105ade15cc0601aaeb184d4bf9144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/0*KI9_52HdPjGSi_Aj.png"/></div></figure><p id="8908" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">注意我们是如何用反斜线<code class="fe mn mo mp mq b">expr $AGE + 1</code>来写这个表达式的</p><h1 id="71e4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.退出状态</h1><p id="aee9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在Unix中，每个命令都有一个退出代码，取值范围从<strong class="lt iu"> 0到255 </strong>。我们应该记住的是，0意味着成功，其他都是错误。为了得到退出代码，我们可以运行<code class="fe mn mo mp mq b">$?</code>。例如，我将运行命令<code class="fe mn mo mp mq b">wc</code>。</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="2020" class="mv la it mq b gy mw mx l my mz">cat<!-- --> <!-- -->myscript.sh | wc</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/1768b655e793c527003f706ab00ffccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lQVv9Ruf1P7FZwQG.png"/></div></div></figure><p id="9bc3" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果我想得到退出代码:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="7126" class="mv la it mq b gy mw mx l my mz">echo<!-- --> <!-- -->$?</span></pre><p id="9a5d" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们得到0表示成功。现在，假设我们想要删除一个不存在的文件。</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="9f01" class="mv la it mq b gy mw mx l my mz">rm non_exist_script.sh</span><span id="7d72" class="mv la it mq b gy na mx l my mz">echo $?</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6fbfbd209561df559b21ce09af45a38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-2HjXLYUupMXswIt.png"/></div></div></figure><p id="af7e" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这里的退出代码是1，这意味着“不成功”，更具体地说，这意味着不允许操作。最后，如果我们写了一个脚本，并希望在出现错误时终止它，我们可以添加行<code class="fe mn mo mp mq b">set -e</code>。</p><h1 id="04e6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.如何搜索文件或目录</h1><p id="ed4f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">试图在我们的硬盘或目录和子目录中找到一个文件是很常见的。我们可以在Unix/Linux中使用<code class="fe mn mo mp mq b">find</code> <strong class="lt iu"> </strong>命令轻松做到这一点。假设我正在寻找包含单词<code class="fe mn mo mp mq b">report</code>的文件名</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="948d" class="mv la it mq b gy mw mx l my mz">find<!-- --> <!-- -->. -iname "*report*"</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/5669c16faef84a943f2bcf38bf2efd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PMvjUfdWUXg-78cC.png"/></div></div></figure><p id="4bc2" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">注意，<code class="fe mn mo mp mq b">.</code>指的是我们当前的目录，我们可以像<code class="fe mn mo mp mq b">/home</code>一样显式地使用路径，<code class="fe mn mo mp mq b">-iname</code>会让<code class="fe mn mo mp mq b">find</code>忽略文件名的大小写，如果你想区分大小写，你应该使用引号内的<code class="fe mn mo mp mq b">-name</code>和<code class="fe mn mo mp mq b">*</code>来指代任何字符，所以本质上，<strong class="lt iu"> </strong>我们寻找的是包含子串<code class="fe mn mo mp mq b">report</code>的文件名。</p><p id="d4a1" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">关于对搜索有用的通配符:</p><ul class=""><li id="31dc" class="nj nk it lt b lu nb lx nc ma nl me nm mi nn mm no np nq nr bi translated"><code class="fe mn mo mp mq b">*</code>零个或多个字符</li><li id="6bb0" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated"><code class="fe mn mo mp mq b">?</code>任何一个字符</li><li id="0f00" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated"><code class="fe mn mo mp mq b">[]</code>括号中的任何字符</li></ul><h1 id="489d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.如何获得目录的大小</h1><p id="c525" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我想查看系统的已用空间和可用空间，可以使用以下命令:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="052c" class="mv la it mq b gy mw mx l my mz">df<!-- --> <!-- -->-h</span></pre><p id="6e7d" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">现在，如果我想获得一个文件夹中每个文件夹的大小，我可以键入:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="843a" class="mv la it mq b gy mw mx l my mz">du<!-- --> <!-- -->-hs * | sort<!-- --> <!-- -->-h -r</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1e288b96d0296b44b046952905749b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/0*pAZSM5vJOOdF2e0o.png"/></div></figure><h1 id="a050" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.如何连接多个CSV文件</h1><p id="deb5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设您的文件是<code class="fe mn mo mp mq b">my_file_1.csv</code>、<code class="fe mn mo mp mq b">my_file_2.csv, my_file_3.csv</code>等等，并且您想将它们连接成一个文件。然后，您可以使用以下命令来完成此操作:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="1d3c" class="mv la it mq b gy mw mx l my mz">cat my_file_*.csv &gt; merged.csv</span></pre><p id="4b6e" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们生成一个名为<code class="fe mn mo mp mq b">merged.csv</code>的文件。</p><h2 id="a2fa" class="mv la it bd lb ny nz dn lf oa ob dp lj ma oc od ll me oe of ln mi og oh lp oi bi translated">如何处理标题</h2><p id="5f4a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，如果您的csv文件有文件头，并且您希望只保留一个文件的文件头，那么您可以使用以下命令:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="8725" class="mv la it mq b gy mw mx l my mz">awk '(NR == 1) || (FNR &gt; 1)' my_file_*.csv &gt; merged.csv</span></pre><p id="4751" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">FNR指的是单个文件中已处理记录的数量，NR指的是所有文件，所以我们保留第一行，即文件头，忽略每个文件的第一行。</p><p id="2ca8" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">最后，如果您想删除所有文件的标题:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="52f0" class="mv la it mq b gy mw mx l my mz">awk 'FNR &gt; 1' my_file_*.csv &gt; merged.csv</span></pre></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="b265" class="pw-post-body-paragraph lr ls it lt b lu nb ju lw lx nc jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">最初发布于<a class="ae ky" href="https://predictivehacks.com/tips/" rel="noopener ugc nofollow" target="_blank">预测黑客</a></p></div></div>    
</body>
</html>