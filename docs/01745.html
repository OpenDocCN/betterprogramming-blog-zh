<html>
<head>
<title>How To Install Apache on macOS 10.15 Catalina Using Homebrew</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用自制软件在macOS 10.15 Catalina上安装Apache</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-install-apache-on-macos-10-15-catalina-using-homebrew-78373ad962eb?source=collection_archive---------2-----------------------#2019-10-10">https://betterprogramming.pub/how-to-install-apache-on-macos-10-15-catalina-using-homebrew-78373ad962eb?source=collection_archive---------2-----------------------#2019-10-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3b94" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何在macOS Catalina上设置Apache/PHP开发环境的最新系列文章的第1部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bf16893c770d43a7b6ddfaeb748ed158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCX432e1r2ZOrQecJNNCOw.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来源:凯西·麦克马伦</p></figure><p id="9d95" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文面向那些希望在Mac上安装Apache web服务器作为开发环境的一部分的web开发人员。</p><p id="99a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这篇文章是系列文章中<a class="ae lq" href="https://medium.com/p/ad5b6c9ffb17/edit" rel="noopener">下一篇的先决条件，它将引导你使用自制软件和PECL安装PHP。</a></p><p id="4e22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种安装Apache的方法会禁用macOS预装的版本，允许更灵活的版本控制，并将继续在所有macOS版本上工作。</p><p id="6ff5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些说明对当前所有版本的macOS都适用。此外，您不必从全新安装操作系统开始使用这里的信息，但我已经看到了一些奇怪的事情发生在升级和全新安装时(例如，在升级后完全丢失了<code class="fe lr ls lt lu b">mod_deflate.so</code>模块扩展文件)。我强烈推荐全新安装，但是如果你要冒险升级，请准备好寻找一些文件和路径。</p><p id="763a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们开始吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="58c9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步伐</h1><h2 id="eb60" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">获取最新的操作系统更新</h2><p id="80a6" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">如果您刚刚安装了全新的操作系统，您可能不需要这样做。如果您正在升级，请进入“系统偏好设置”并选择“软件更新”图标，以确保一切都是最新的。</p><h2 id="9d84" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">安装Xcode</h2><p id="7510" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">如果您对安装整个Xcode应用程序不感兴趣，那也没关系。Homebrew install命令将安装它需要的基本Xcode命令行工具。然而，我建议完全安装，尤其是如果您运行的是Catalina。为此，您可以从终端运行以下命令。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="5100" class="mu md it lu b gy np nq l nr ns">xcode-select --install</span></pre><h2 id="6df1" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">安装自制软件</h2><p id="5809" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">以下命令将安装Homebrew。</p><p id="15b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:下面的命令是一个单行，由于页面宽度限制，在Medium中已经换行。确保复制整行。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="54e3" class="mu md it lu b gy np nq l nr ns">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</span></pre><h2 id="883a" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">创建Apache日志文件目录</h2><p id="a6f0" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">Apache预配置了自己的日志目录，但我们将创建自己的<code class="fe lr ls lt lu b">/usr/local/log/</code>文件夹，以便在需要时可以轻松找到它们。如果您打算继续阅读下一篇文章并安装PHP，我们也将对PHP日志使用相同的日志文件位置，并将所有日志放在一个地方。</p><p id="b916" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按照以下步骤创建适当的目录并设置它们的权限。忽略任何你可能收到的<em class="nt">已经存在的</em>消息。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="c166" class="mu md it lu b gy np nq l nr ns">sudo mkdir /usr/local/log</span><span id="c0fb" class="mu md it lu b gy nu nq l nr ns">sudo mkdir /usr/local/log/httpd</span><span id="01fc" class="mu md it lu b gy nu nq l nr ns">sudo chgrp -R staff /usr/local/log/httpd</span><span id="74fb" class="mu md it lu b gy nu nq l nr ns">sudo chmod -R ug+w /usr/local/log/httpd/</span></pre><h2 id="6094" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">安装和配置Apache</h2><p id="67fb" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">macOS 10.15 Catalina预装了Apache。然而，我们将通过自制软件安装Apache，然后将其配置为在端口80上运行，而不是使用交付的版本。</p><p id="a3cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您已经运行了预安装的Apache，那么需要首先关闭它，并删除任何自动加载脚本。运行以下两个命令没有坏处，即使是在全新安装时。</p><p id="e345" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:第二个命令是一个单行，由于页面宽度的限制，它在Medium中换行了。确保复制整行。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="01a1" class="mu md it lu b gy np nq l nr ns">sudo apachectl stop</span><span id="6dda" class="mu md it lu b gy nu nq l nr ns">sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist 2&gt;/dev/null</span></pre><p id="db15" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在安装家酿提供的新版Apache。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="c1b6" class="mu md it lu b gy np nq l nr ns">brew install httpd</span></pre><p id="1f66" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成后，运行以下命令启动Apache服务，并确保它在登录时自动重启。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="86a8" class="mu md it lu b gy np nq l nr ns">brew services start httpd</span></pre><p id="7759" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，您已经安装了Homebrew版本的Apache，并将其配置为在重启时自动启动。它应该已经在运行了，所以您应该能够将浏览器指向<a class="ae lq" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>并看到一个简单的标题，上面写着<em class="nt">它工作了！</em></p><p id="5e98" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，我们当前指向端口8080。我们将在下面的步骤中改变这种情况。现在我们有了一个可以工作的web服务器，我们想做一些配置上的改变，让它更符合我们的喜好——或者更符合我的喜好。</p><p id="b1be" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们打开Apache配置文件:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="d824" class="mu md it lu b gy np nq l nr ns">open -e /usr/local/etc/httpd/httpd.conf</span></pre><h2 id="7afc" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">更改监听端口</h2><p id="ce81" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">向下滚动，找到显示<em class="nt"> Listen 8080 </em>的行，并将其更改为:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="fc14" class="mu md it lu b gy np nq l nr ns">Listen 80</span></pre><h2 id="d37a" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">启用有用的Apache模块</h2><p id="6d37" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">接下来，您可以启用下面两个方便的Apache模块。您可以搜索以下两行，并通过删除前导hashtag #来取消对它们的注释。</p><p id="ff26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">提示:deflate行在<code class="fe lr ls lt lu b">LoadModule</code>部分的中间，rewrite行在<code class="fe lr ls lt lu b">LoadModule</code>部分的最底部。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="34dc" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">LoadModule</strong> deflate_module lib/httpd/modules/mod_deflate.so<br/><br/><strong class="lu iu">LoadModule</strong> rewrite_module lib/httpd/modules/mod_rewrite.so</span></pre><h2 id="d6fa" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">更改Apache用户和组设置</h2><p id="945d" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">默认情况下，Apache作为用户<em class="nt"> _www </em>和组<strong class="kw iu"/>_ www运行。一会儿，我们将把我们的默认文档目录设置为我们主文件夹中的一个站点目录，当您试图访问您主目录中的文件时，这些用户和组设置将导致权限问题。</p><p id="6a59" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在您的<code class="fe lr ls lt lu b">httpd.conf</code>文件中向下滚动大约三分之一，您会发现两行设置了Apache将运行的用户和组。更改这些以匹配您的用户帐户。将<code class="fe lr ls lt lu b">your_username</code>替换为您的MacBook用户名，并使用群组名<code class="fe lr ls lt lu b">staff</code>。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="ffac" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">User</strong> your_username<br/><br/><strong class="lu iu">Group</strong> staff</span></pre><h2 id="ef2b" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">设置Apache服务器管理员和服务器名称</h2><p id="4244" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">找到<code class="fe lr ls lt lu b">ServerAdmin</code>行，通过移除前导标签#来启用它(如果需要)，然后将电子邮件更改为您自己的电子邮件:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="eb72" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">ServerAdmin</strong> yourname@email.com</span></pre><p id="056c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过删除开头的hashtag #并将其更改为<code class="fe lr ls lt lu b">localhost</code>，在配置中启用Apache服务器名称:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="e26c" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">ServerName</strong> localhost</span></pre><h2 id="f3a4" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">更改文档根目录、目录和覆盖</h2><p id="285e" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">接下来，我们将更改Apache的文档根目录。这是Apache用来提供文件的文件夹。默认情况下，文档根被配置为<code class="fe lr ls lt lu b">/usr/local/var/www</code>。因为我们正在创建一个开发环境，并且希望尽可能避免文件夹权限问题，所以我们将把文档根目录更改为我们主目录中的一个文件夹(我们很快就会创建这个文件夹)。</p><p id="5396" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">继续向下滚动，找到<code class="fe lr ls lt lu b">DocumentRoot</code>行。改为:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="afa6" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">DocumentRoot</strong> "/Users/your_username/Sites"</span></pre><p id="f5cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，您还需要更改位于<code class="fe lr ls lt lu b">DocumentRoot</code>行正下方的标签引用。这也应该更改为指向您的新文档根目录:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="8a34" class="mu md it lu b gy np nq l nr ns">&lt;<strong class="lu iu">Directory</strong> "/Users/your_username/Sites"&gt;;</span></pre><p id="1596" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在同一块，你会发现一个<code class="fe lr ls lt lu b">AllowOverride</code>设置。这应该从<em class="nt">无</em>更改为允许<em class="nt">所有</em>超控:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="baf2" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">AllowOverride</strong> All</span></pre><h2 id="5995" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">设置Apache错误日志位置</h2><p id="3969" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">最后，我们将Apache错误日志的位置设置为我们之前创建的文件夹。向下滚动一点，找到<code class="fe lr ls lt lu b">ErrorLog</code>的那一行。将其改为如下:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="ea6b" class="mu md it lu b gy np nq l nr ns"><strong class="lu iu">ErrorLog</strong> "/usr/local/log/httpd/error_log"</span></pre><p id="f0dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">保存并退出文本编辑器。</p><h2 id="6a6d" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">创建站点文件夹</h2><p id="c49a" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">使用下面两行创建一个站点文件夹，并添加一个<code class="fe lr ls lt lu b">index.html</code>文件，让我们开始吧:</p><p id="9c5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:第二个命令是一个单行，由于页面宽度的限制，它在Medium中换行了。确保复制整行。</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="3f6a" class="mu md it lu b gy np nq l nr ns">mkdir ~/Sites</span><span id="f2c3" class="mu md it lu b gy nu nq l nr ns">echo "&lt;h1&gt;It Works in my Sites Folder&lt;/h1&gt;;" &gt; ~/Sites/index.html</span></pre><h2 id="d023" class="mu md it bd me mv mw dn mi mx my dp mm ld mz na mo lh nb nc mq ll nd ne ms nf bi translated">重启Apache</h2><p id="d00b" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">现在，我们将重新启动以确保我们的配置设置是正确的:</p><pre class="kj kk kl km gt nl lu nm nn aw no bi"><span id="26bb" class="mu md it lu b gy np nq l nr ns">sudo apachectl -k restart</span></pre><p id="f8b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">尝试浏览到您的本地主机的新位置:<a class="ae lq" href="http://localhost/" rel="noopener ugc nofollow" target="_blank"> http://localhost </a></p><p id="fa02" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果这有效，并且您看到消息<em class="nt">它在我的站点文件夹</em>中有效，那么恭喜您！您已经在端口80上运行了一个新的web服务器实例。</p><p id="3a97" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您收到一个错误，一个可能的原因是在您的<code class="fe lr ls lt lu b">httpd.conf</code>文件中的目录条目周围使用了双引号。有时文本编辑器会将这些转换成拉丁字符类型的引号。这些引号是可选的，可以删除。尝试删除双引号并重新启动Apache。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d006" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">第二部分</h1><p id="412d" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">如果您是一名PHP开发人员，并且希望继续您的开发环境设置，那么请阅读本系列的第二部分，<a class="ae lq" href="https://medium.com/@crmcmullen/how-to-install-a-php-7-2-on-macos-10-15-catalina-using-homebrew-and-pecl-ad5b6c9ffb17" rel="noopener">如何使用自制软件和PECL在macOS 10.15 Catalina上安装PHP 7.2</a>。</p></div></div>    
</body>
</html>