<html>
<head>
<title>What Is the Difference Between map() and forEach() in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中map()和forEach()有什么区别？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-the-difference-between-map-and-foreach-in-javascript-9bc49afa2703?source=collection_archive---------4-----------------------#2019-11-25">https://betterprogramming.pub/what-is-the-difference-between-map-and-foreach-in-javascript-9bc49afa2703?source=collection_archive---------4-----------------------#2019-11-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d01" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用法、速度比较等等</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d8aa0518024f17025ade8d0fbac98024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tj-pjSpGWwVktC9BZvVIqA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jannerboy62?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">尼克·费因斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/difference?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="0137" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JavaScript中一些最受欢迎的函数可能是<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>。它们都是从ECMAScript 5或者简称为<code class="fe lv lw lx ly b">es5</code>开始存在的。</p><p id="6d92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将谈论它们之间的主要区别，并向你展示一些它们的用法。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="f19d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">阅读前</h1><p id="44b5" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">基本上，在JavaScript中遍历一个对象取决于该对象是否是一个<code class="fe lv lw lx ly b">iterable</code>。默认情况下，数组是可迭代的。</p><p id="c3d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>都包含在<code class="fe lv lw lx ly b">Array.prototype</code>里，所以我们不需要考虑<code class="fe lv lw lx ly b">iterable</code>。如果你想进一步学习，我建议你看看JavaScript中的<code class="fe lv lw lx ly b">iterable</code>对象是什么！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="331f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">什么是<code class="fe lv lw lx ly b">map()</code>和<code class="fe lv lw lx ly b">forEach()</code>？</h1><p id="1942" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>是array中的helper方法，可以很容易地循环数组。我们曾经在一个数组上循环，如下所示，没有任何帮助函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f768" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从JavaScript时代一开始，循环就伴随着我们。它需要3个表达式:初始值、条件和最终表达式。</p><p id="1790" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是循环数组的经典方式。自ECMAScript 5以来，新的函数似乎让我们更快乐。</p><h2 id="e0aa" class="nf mh it bd mi ng nh dn mm ni nj dp mq li nk nl ms lm nm nn mu lq no np mw nq bi translated">地图</h2><p id="f047" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>与<code class="fe lv lw lx ly b">for</code>循环做的完全一样，除了<code class="fe lv lw lx ly b">map</code>创建一个新数组，结果是在调用数组中的每个元素上调用一个提供的函数。</p><p id="d345" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它有两个参数:一个回调函数，稍后调用<code class="fe lv lw lx ly b">map</code>或<code class="fe lv lw lx ly b">forEach</code>时会调用这个函数，另一个是上下文变量<code class="fe lv lw lx ly b">thisArg</code>，回调函数在调用时会用到这个变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="bda4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回调函数可以如下使用。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="bb28" class="nf mh it ly b gy nv nw l nx ny">arr.map((str) =&gt; { console.log(Number(str)); })</span></pre><p id="d619" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>的结果不等于原数组。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="7cc0" class="nf mh it ly b gy nv nw l nx ny">const arr = [1];<br/>const new_arr = arr.map(d =&gt; d);</span><span id="ddff" class="nf mh it ly b gy nz nw l nx ny">arr === new_arr; // false</span></pre><p id="bf6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以将对象作为<code class="fe lv lw lx ly b">thisArg</code>传递给<code class="fe lv lw lx ly b">map</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4381" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对象<code class="fe lv lw lx ly b">obj</code>变成了<code class="fe lv lw lx ly b">map</code>的<code class="fe lv lw lx ly b">thisArg</code>。但箭头回调函数无法获取<code class="fe lv lw lx ly b">obj</code>作为其<code class="fe lv lw lx ly b">thisArg</code>。</p><p id="290e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为箭头函数的工作方式不同于普通函数。访问<a class="ae ky" href="https://www.geeksforgeeks.org/difference-between-regular-functions-and-arrow-functions/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>看看箭头函数和普通函数有什么不同。</p><h2 id="8596" class="nf mh it bd mi ng nh dn mm ni nj dp mq li nk nl ms lm nm nn mu lq no np mw nq bi translated">为每一个</h2><p id="9ff7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">forEach</code>是数组的另一个循环函数，但是<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>在使用上有所不同。有两个参数<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>可以接受——一个回调函数和<code class="fe lv lw lx ly b">thisArg</code>,它们将这两个参数用作它们的<em class="oa"> this。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9f19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，有什么不同呢？</p><p id="f606" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>返回原数组的新数组。然而<code class="fe lv lw lx ly b">forEach</code>却没有。但两者都保证了原对象的不变性。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="ce72" class="nf mh it ly b gy nv nw l nx ny">[1,2,3].map(d =&gt; d + 1); // [2, 3, 4];<br/>[1,2,3].forEach(d =&gt; d + 1); // undefined;</span></pre><p id="bb74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> ~~编辑~~ </strong></p><p id="afd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">forEach</code>如果您更改数组内部的值，不会确保数组的不变性。这个方法只在你不接触里面的任何值的时候保证不变性。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="2d17" class="nf mh it ly b gy nv nw l nx ny">[{a: 1, b: 2}, {a: 10, b: 20}].forEach((obj) =&gt; obj.a += 1);<br/>// [{a: 2, b: 2}, {a: 11, b: 21}]<br/>// The array has been changed!</span></pre><p id="1819" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的例子来自于<a class="ob oc ep" href="https://medium.com/u/34f1ed47628d?source=post_page-----9bc49afa2703--------------------------------" rel="noopener" target="_blank">肯尼·马丁·里格斯</a>。谢谢大家！👏</p><h1 id="8513" class="mg mh it bd mi mj od ml mm mn oe mp mq jz of ka ms kc og kd mu kf oh kg mw mx bi translated">什么时候使用map()和forEach()？</h1><p id="d846" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">因为它们之间的主要区别在于是否有返回值，所以您可能希望使用<code class="fe lv lw lx ly b">map</code>来创建一个新数组，而使用<code class="fe lv lw lx ly b">forEach</code>来映射这个数组。</p><p id="a24c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个简单的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在React中，<code class="fe lv lw lx ly b">map</code>非常常用于创建元素，因为<code class="fe lv lw lx ly b">map</code>在操作原始数组的数据后创建并返回一个新数组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，<code class="fe lv lw lx ly b">forEach</code>在您想对数据做一些事情而不创建新数组时很有用。顺便说一下，这个例子可以用<code class="fe lv lw lx ly b">filter</code>来重构。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="daad" class="nf mh it ly b gy nv nw l nx ny">subjects.filter(subject =&gt; mySubjectId.includes(subject.id)).length;</span></pre><p id="b5bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，我建议您在创建将要使用的新数组时使用<code class="fe lv lw lx ly b">map</code>,在不需要创建新数组时使用<code class="fe lv lw lx ly b">forEach</code>,但是您需要对数据做一些事情。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="e62f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">速度比较</h1><p id="1bf8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">有些帖子提到<code class="fe lv lw lx ly b">map</code>比<code class="fe lv lw lx ly b">forEach</code>快。所以，我很好奇这是不是真的。我发现了这个对比结果:</p><div class="kj kk kl km gt ab cb"><figure class="oi kn oj ok ol om on paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/396861c9c5f37cfa740763c6b2a80a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*55Seox72v1ozLlrK16H7ng.png"/></div></figure><figure class="oi kn oo ok ol om on paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/c4a650d50a4d615672b5e5d231941754.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*D8LOC9L2ulbAukMbhvuZ1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk op di oq or translated"><a class="ae ky" href="https://jsperf.com/foreach-v-map" rel="noopener ugc nofollow" target="_blank">左结果jsPerf </a>和<a class="ae ky" href="https://jsperf.com/map-vs-foreach-speed-test?source=post_page-----f38111822c0f----------------------" rel="noopener ugc nofollow" target="_blank">右结果jsPerf </a></p></figure></div><p id="8f0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码看起来非常相似，但结果却相反。一些测试说<code class="fe lv lw lx ly b">forEach</code>更快，一些测试说<code class="fe lv lw lx ly b">map</code>更快。</p><p id="5ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许你在告诉自己<code class="fe lv lw lx ly b">map</code> / <code class="fe lv lw lx ly b">forEach</code>比另一个更快，你可能是对的。老实说，我不确定。我认为对于现代web开发来说，可读性比<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>之间的速度更重要。</p><p id="1e8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但有一点可以肯定——它们都比JavaScript的内置特性<code class="fe lv lw lx ly b">for</code> loop慢。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="cbb1" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="8f74" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">forEach</code>是循环遍历一个可迭代对象的方便函数，可能会美化你的代码，给你更多的可读性。</p><p id="901d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是要记住的一个真正重要的基调是理解每一个都做什么以及何时使用它们。</p><p id="b7a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您想创建一个不影响原始数组的新数组时，<code class="fe lv lw lx ly b">map</code>会比较好，而当您只想映射一个数组时，<code class="fe lv lw lx ly b">forEach</code>会更好。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4f82" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">资源</h1><ul class=""><li id="f928" class="os ot it lb b lc my lf mz li ou lm ov lq ow lu ox oy oz pa bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for" rel="noopener ugc nofollow" target="_blank">用于循环MDN </a></li><li id="5310" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map" rel="noopener ugc nofollow" target="_blank">地图MDN </a></li><li id="e53e" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><a class="ae ky" href="https://www.geeksforgeeks.org/difference-between-regular-functions-and-arrow-functions/" rel="noopener ugc nofollow" target="_blank">箭头功能与普通功能</a></li><li id="ff5b" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> forEach MDN </a></li><li id="130f" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><a class="ae ky" href="https://jsperf.com/foreach-v-map" rel="noopener ugc nofollow" target="_blank">map vs forEach jsPerf</a>—<code class="fe lv lw lx ly b">forEach</code>更快</li><li id="b7f9" class="os ot it lb b lc pb lf pc li pd lm pe lq pf lu ox oy oz pa bi translated"><a class="ae ky" href="https://jsperf.com/map-vs-foreach-speed-test?source=post_page-----f38111822c0f----------------------" rel="noopener ugc nofollow" target="_blank">map vs forEach jsPerf</a>—<code class="fe lv lw lx ly b">map</code>更快</li></ul></div></div>    
</body>
</html>