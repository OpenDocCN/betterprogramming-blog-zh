<html>
<head>
<title>AWS Cost Allocation Tags and Cost Reduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS成本分配标签和成本降低</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/aws-cost-allocation-tags-and-cost-reduction-8a0e46e39e75?source=collection_archive---------12-----------------------#2020-09-08">https://betterprogramming.pub/aws-cost-allocation-tags-and-cost-reduction-8a0e46e39e75?source=collection_archive---------12-----------------------#2020-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="46c3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用成本分摊标签优化您的AWS服务，每月支付更少的费用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3d30558a7f0cfc5efdbbf376f6983a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CAljLBm1CL8oiswp"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯汀·罗伊在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c2ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Bob刚到办公室开始新聘用的首席技术官的第一天工作，就被总裁Martha叫进了一间会议室，总裁马上把他介绍给了会计主管Amanda。他们相互寒暄了几句，然后玛莎开始了正题:</p><p id="747f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“Bob，我们有几个团队在亚马逊上开发软件应用程序，我们的费用非常高。我们认为这是不必要的高，我们希望你调查一下，并加以控制。”</p><p id="9ea3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">玛莎把亚马逊网络服务(AWS)账单报告的截图放在桌子上，指着它。</p><p id="febf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“这对我们来说是个问题:我们不知道这笔钱花在了什么地方，我们需要看到更多细节。”</p><p id="6314" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Amanda插话说，“Bob，看，我们有用于报告目的的财务维度，我可以为你提供一些关于我们真正希望看到的一些信息的指导，以便最终生成的报告反映这些维度—如果你能做到这一点，这将真正帮助我们内部。”</p><p id="033c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“鲍勃，我们不能强调这是多么重要。这些项目对我们的业务来说变得非常昂贵，”玛莎重申道。</p><p id="87b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“我们有多少个项目？”鲍勃问道。</p><p id="7221" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“我们总共有四个项目:两个在航空部门，两个在能源部门。如果有关系的话，航空部门有75名开发人员，能源部门有25名开发人员，”这位首席执行官回应道。</p><p id="978c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鲍勃明白了这个问题，并回答说:“我会看看我能做些什么，并有一些想法。我可能无法为您提供回顾性的见解，但展望未来，我们应该能够更好地了解正在发生的事情，并开始降低成本。”</p><p id="e074" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">会议以鲍勃走向他的办公桌而结束。<em class="ls">成本分配标签应该对我们有帮助</em>，他一边寻找可能知道他办公室在哪里的人，一边心想。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="e114" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">成本分配标签介绍</h1><p id="812d" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在这个虚构的故事中，Bob需要弄清楚这些费用来自哪里，以便他可以开始降低成本。AWS cost explorer虽然很有帮助，但在这种情况下它本身是不够的。Bob需要更多的细节，而这正是成本分配标签(cat)有用的地方。AWS中还有其他工具可以帮助Bob完成这项任务，我们将在本文后面简要介绍这些工具。</p><p id="5e87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，标签有一些我们应该知道的特征(如果我错过了什么，请添加您的评论):</p><ul class=""><li id="59b4" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">标签有助于展示资源之间的关系。</li><li id="43c9" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">标签是关于资源的元数据，这些简单的键值对可以添加到AWS中的任何资源中。</li><li id="0063" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">标签理想上是一个键和一个值，并置着一个键和多个值。</li><li id="0789" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">标签被限制为每个资源50个。</li><li id="2aa3" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">标签上可以实施规则，这有助于确保一致性并满足合规性要求。</li><li id="631d" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">有些标签也是由AWS自动生成的(例如<code class="fe nl nm nn no b">aws:createdBy</code>)——这些标签是不可变的。</li><li id="113e" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">除了成本分配，标签还可用于自动化、操作和访问，以及安全风险管理。</li><li id="abf3" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">由于与cat相关，标签可用于识别成本中心、业务单位、部门、项目、产品、地理区域或目的，以便进行财务报告。</li><li id="677a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">标记仅在标记创建时出现在报告中，没有回溯。</li></ul><p id="8f0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一节中，我们将查看AWS billing dashboard，在这里我们可以激活一个标记，还可以查看根据该标记过滤的报告。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="f5d1" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">开单控制板中的成本分配标签</h1><p id="2cdc" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在本节中，我们将查看AWS计费仪表板，该仪表板可供帐户持有人使用，它有两个感兴趣的项目:成本浏览器<a class="ae kv" href="https://aws.amazon.com/aws-cost-management/aws-cost-explorer/" rel="noopener ugc nofollow" target="_blank">和成本分配标签</a>和<a class="ae kv" href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html" rel="noopener ugc nofollow" target="_blank"/>。我们可以在下一张图中看到这两者。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/810583baa2d1080011a1f68204690dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pwz9AM1RX_uYEvkT"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AWS我的开单控制板-&gt;成本分配标签</p></figure><p id="3d15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下图中，一个非活动的成本分配标记将被激活，然后将执行一个刷新请求。图像中的注释提到了标记S3桶——我们可以标记AWS中的任何资源。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/03e014ebba9bd40efc4e70919d17fffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O5ohWWYPQutqjmW8"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">激活<code class="fe nl nm nn no b">costCenter</code>成本分配标签，然后发出刷新请求。</p></figure><p id="50b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图展示了我们如何在AWS cost management cost explorer AWS web UI中按标签进行过滤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/6a0ac6e1abb7e057706d3e1be03c760e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xgrr0cjpeNoTI0RwdPz5YA.png"/></div></div></figure><p id="4c67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们通过<code class="fe nl nm nn no b">costCenter</code>标签12345过滤，我们可以得到一个概念，具体来说，这个键和值的相关成本是多少。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/f79e055748fd106fdaa5c30d9f9036fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1TyBic0piewX-C0OFot6Q.png"/></div></div></figure><p id="ce75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一节中，我们将查看三个示例，这些示例涉及如何通过web界面、命令行(CLI)和编程方式用两个标记来标记资源，比如本例中的EC2实例。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6690" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">标签示例(用户界面、命令行界面、代码)</h1><p id="3e47" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在这一节中，我们将回顾如何在创建时将cat应用到AWS EC2实例的三个例子。我们将通过web用户界面(UI)和AWS命令行进行标记，最后，我们将演示如何在创建时使用<a class="ae kv" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>标记EC2实例。</p><h2 id="d10d" class="ns mb iq bd mc nt nu dn mg nv nw dp mk lf nx ny mm lj nz oa mo ln ob oc mq od bi translated">通过web用户界面(UI)标记EC2实例</h2><p id="4416" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">通过AWS web界面创建EC2实例非常简单。我们可以在下面看到，我们可以在第五步中添加标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/835159ff470c344131185312635934c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TsLuK388pC7lJKrPl9yT7g.png"/></div></div></figure><p id="34cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，我们已经跳过了，下面你可以看到第五步，我们已经为这个实例分配了<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>键值对(kvp)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/259f8adaddc431b8511d37278e2aa8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qgID4m1tCO2b57msWzazw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将成本中心和部门标记添加到EC2实例配置中。</p></figure><p id="f54e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦实例启动，我们可以看到我们上面分配的标签被分配给了实例本身。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/c870e7f4da0f5dca5255cbede937c267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmKpfe0IZCbQYqZRRnUOMQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">实例正在启动，我们可以在这里看到<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>标记。</p></figure><h2 id="c7f7" class="ns mb iq bd mc nt nu dn mg nv nw dp mk lf nx ny mm lj nz oa mo ln ob oc mq od bi translated">通过命令行界面(CLI)标记EC2实例</h2><p id="0523" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这个例子相当简单。此处未包括的步骤涉及设置配置文件，这需要创建用户并分配适当的权限，以及创建VPC。</p><p id="55c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要在<code class="fe nl nm nn no b">/Users/[user]/.aws/credentials</code>文件中创建一个概要文件，它包括带有AWS提供的值的<code class="fe nl nm nn no b">aws_access_key_id</code>和<code class="fe nl nm nn no b">aws_secret_access_key</code>。这对于下面的示例和后面的编程示例都是必要的。</p><p id="ff02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的脚本将在<code class="fe nl nm nn no b">us-east-1</code>区域创建一个<code class="fe nl nm nn no b">t2.micro</code>实例，并将其部署在<code class="fe nl nm nn no b">subnet-0969b587cc72969d2</code>子网中。对于这个例子来说，最重要的是EC2实例将被标记为<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>kvp。</p><pre class="kg kh ki kj gt oh no oi oj aw ok bi"><span id="a227" class="ns mb iq no b gy ol om l on oo">aws ec2 run-instances --image-id ami-02354e95b39ca8dec --count 1 --instance-type t2.micro --region us-east-1 --profile thospfuller-aws-cli --subnet subnet-0969b587cc72969d2 <strong class="no ir">--tag-specifications</strong> 'ResourceType=instance,Tags=[{Key=costCenter,Value=45678}, {Key=department,Value=Energy}]'</span></pre><p id="67bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上述子网值可以在VPS子网选项下找到，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/508a9025570cdd5c232f0638f1741306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRzmJbHNnX1fPo2EYAYHIw.png"/></div></div></figure><p id="3041" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下图中，我们可以看到EC2实例上出现了<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>标记。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/43fb8677e91b6d8dca218d34041c43f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xjd7XtlFie8SnqOkFDEPog.png"/></div></div></figure><p id="ae36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就把我们带到了我们将在这里讨论的最后一个例子，那就是以编程方式启动一个用适当的kvp标记的EC2实例。</p><h2 id="1037" class="ns mb iq bd mc nt nu dn mg nv nw dp mk lf nx ny mm lj nz oa mo ln ob oc mq od bi translated">以编程方式标记EC2实例</h2><p id="e282" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">与前面的例子类似，这个例子相当简单。此处未包括的步骤涉及设置配置文件，这需要创建用户并分配适当的权限，以及创建VPC。</p><p id="7245" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要在<code class="fe nl nm nn no b">/Users/[user]/.aws/credentials</code>文件中创建一个概要文件，它包括带有AWS提供的值的<code class="fe nl nm nn no b">aws_access_key_id</code>和<code class="fe nl nm nn no b">aws_secret_access_key</code>。</p><p id="deb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面将在<code class="fe nl nm nn no b">us-east-1</code>区域创建一个<code class="fe nl nm nn no b">t2.micro instance</code>，将其部署在<code class="fe nl nm nn no b">subnet-0969b587cc72969d2</code>子网中，并且，对本例来说最重要的是，用<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>kvp标记它。</p><p id="01b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">49号线有<code class="fe nl nm nn no b">costAllocation</code>和<code class="fe nl nm nn no b">department</code>kvp。注意<a class="ae kv" href="https://gist.github.com/thospfuller/0a2a7809dbf75a0c7a3e2b749bed7d0b" rel="noopener ugc nofollow" target="_blank">下面的要点可以在GitHub </a>上找到，文件也可以在下面的库中找到<a class="ae kv" href="https://github.com/thospfuller/NodeExamples" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="0736" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下图中，我们可以看到脚本执行时的输出，以及指向<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>标签的指针。注意<code class="fe nl nm nn no b">instance id</code>就在指向标签的红色箭头指针上方。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/fd77874b73c90ee5b100abda753f3372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GuBGiisauYEnko9xVu5G3Q.png"/></div></div></figure><p id="39b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下图中，我们可以看到EC2实例启动时的<code class="fe nl nm nn no b">instance id</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/e672133954013d0d18b35cf3284734a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6L2WhrY0XUpCYEHhaLMpA.png"/></div></div></figure><p id="4961" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们可以在下图中看到<code class="fe nl nm nn no b">costCenter</code>和<code class="fe nl nm nn no b">department</code>标记键和值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/62af8f212e6a65f5f6e19a4d9807dabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJseiuW5WPhT5zJszDzsTg.png"/></div></div></figure><p id="443c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一节中，我们将讨论AWS组织、AWS配置，以及这些服务如何帮助企业实现标签合规性。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="01bb" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">服从</h1><p id="ff54" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">依赖cat来确保分配给资源的标签的应用和格式一致的企业有两种选择:AWS组织和AWS配置<em class="ls">。</em>因为人们可以很容易地直接从源头上了解这些，我们只提供一个简短的描述，这将有助于读者看到不同之处:</p><ul class=""><li id="0dcd" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/organizations/" rel="noopener ugc nofollow" target="_blank"> AWS组织</a> —AWS组织用于账户管理，可以将多个AWS账户合并到一个组织下进行集中管理；AWS组织服务还有助于预算、安全性和合规性。</li><li id="cdad" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/blogs/devops/aws-config-checking-for-compliance-with-new-managed-rule-options/" rel="noopener ugc nofollow" target="_blank"> AWS配置</a> — AWS配置也是一项服务，可帮助用户评估、审计、评估、保护AWS特定资源的配置，并对其进行故障排除。如果您的企业没有使用AWS组织，那么AWS Config可以作为管理标签的替代方案；参见<a class="ae kv" href="https://docs.aws.amazon.com/config/latest/developerguide/tagging.html" rel="noopener ugc nofollow" target="_blank">标记你的AWS配置资源</a>。</li></ul><p id="f4c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有审计和执行，业务很容易以混乱结束，因此重要的是不仅要使用可用的工具来更好地了解资金的去向，还要确保所有资源都是以适当的格式用适当的标记创建的。请记住，工程师必须应用这些变化，如果没有执行和遵从，他们根本不会这样做，或者始终如一和正确地这样做[7]。</p><p id="233a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们虚构的故事中，Bob不仅想要利用CATs，而且他还将从利用AWS组织或AWS配置中额外受益，特别是考虑到他负责监管拥有100名软件工程师和支持人员的两个部门。</p><p id="7b58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">演示这两个服务如何工作超出了本文的范围；然而，我们可能会在以后的文章中对此进行深入研究。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="2fe8" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">使用成本分配标签时的策略</h1><p id="3893" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">到目前为止，我们已经介绍了标记和成本分配标记，演示了如何将标记添加到资源(如EC2图像)中，并回顾了如何确保合规性措施到位，以确保标记键和值符合预期的格式。</p><p id="43ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在本文中讨论的最后一个难题涉及标记策略。仅仅允许工程师和经理向他们正在使用的AWS资源添加具有已知值的标签是不够的。事实上，在Bob经营的这种规模的组织中，这正是您想要避免的，因为企业有多个部门和许多软件工程师和支持人员。在这种情况下，需要根据管理这些部门的人员的意见来制定标记策略，由最高级别的CTO来确保标记在整个企业中是统一的，并且定义了一个最小的标记集，以及应用于整个企业中使用的每个可标记资源的可选标记。</p><p id="4b9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，当谈到成本分配标记(cat)时，我们的CTO Bob将希望确保定义必需和可选标记的最小集合，并确保适当的键值对与财务报告维度相结合，这将由会计主管Amanda提供。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="ba86" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="cabd" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在本文中，我们介绍了成本分配标记，演示了它们是如何工作的，并回顾了两个服务，AWS Organizations和AWS Config，它们可用于在所有AWS资源中实现标记遵从性。这些并不是Bob控制AWS使用成本的唯一工具。事实上，添加以下任何一项都会有所帮助:</p><ul class=""><li id="b3d6" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/aws-cost-management/" rel="noopener ugc nofollow" target="_blank">成本管理</a></li><li id="c4f9" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/aws-cost-management/aws-budgets/" rel="noopener ugc nofollow" target="_blank">预算</a></li><li id="5326" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitor_estimated_charges_with_cloudwatch.html" rel="noopener ugc nofollow" target="_blank">计费告警</a></li><li id="f749" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/premiumsupport/technology/trusted-advisor/" rel="noopener ugc nofollow" target="_blank">值得信赖的顾问</a></li><li id="fe8a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">第三方成本优化软件</li><li id="8e3f" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">持续改进战略[15，16，17，18]</li><li id="5a08" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">开发<a class="ae kv" href="https://d1.awsstatic.com/whitepapers/architecture/AWS-Performance-Efficiency-Pillar.pdf" rel="noopener ugc nofollow" target="_blank">性能优化的架构</a>【13】</li></ul><p id="e1b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们以对标记策略的基本讨论结束了本文，标记策略非常重要，在定义一组用于整个企业和成本分配目的的必需和可选标记时，需要在整个企业范围内给予关注。</p><p id="7ce7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们崭露头角的CTO Bob将在业务中实施标签策略方面有一个良好的开端，但你会怎么做呢？完成下面的测试后，请在评论中告诉我。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="8e05" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">恶作剧</h1><p id="49f7" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">你以为你完了，是吗？</p><p id="099a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没错，拿出一张白纸和一支笔，因为我已经包括了一个突击测验。如果你没有纸和笔，把你的答案放在评论区进行讨论。</p><ol class=""><li id="d8fd" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr ov nd ne nf bi translated">找到另外三个可以标记的资源。(这很容易)</li><li id="c474" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">哪些资源不能被标记？(这个比较难，见[10]，不要假设它是正确的或者完整的。)</li><li id="982d" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">开发成本优化的架构是[填空]的五大支柱之一。(提示“AWS[后接三个字]。”) [8]</li><li id="2056" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">说出2中的其他四个支柱。不用看笔记。</li><li id="f80c" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">AWS组织和AWS配置有什么区别？</li><li id="69b3" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">在我们上面虚构的故事中，对他工作的企业来说，什么是更合适的服务(AWS组织、AWS配置或两者都有)？为什么？</li><li id="1690" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">企业可以同时使用AWS组织和AWS配置吗？</li><li id="8e4f" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated">成本优化支柱的补充是什么？(有一个具体的支柱，有一个非常具体的原因。)</li></ol></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="115b" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">推荐阅读</h1><ol class=""><li id="e9c5" class="mx my iq ky b kz ms lc mt lf ow lj ox ln oy lr ov nd ne nf bi translated"><a class="ae kv" href="https://d1.awsstatic.com/whitepapers/aws-tagging-best-practices.pdf" rel="noopener ugc nofollow" target="_blank">标记最佳实践:实施有效的AWS资源标记策略</a></li><li id="94d1" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.cloudforecast.io/blog/aws-tagging-best-practices?utm_source=Medium_TPF_AWSCostReduxCAT" rel="noopener ugc nofollow" target="_blank"> AWS标记最佳实践指南:第1部分，共3部分</a></li><li id="2d6b" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.cloudforecast.io/blog/aws-tagging-best-practices-guide-part-2?utm_source=Medium_TPF_AWSCostReduxCAT" rel="noopener ugc nofollow" target="_blank"> AWS标签最佳实践指南:第2部分，共3部分</a></li><li id="99df" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/deactivate-built-in-tags.html" rel="noopener ugc nofollow" target="_blank">停用AWS生成的成本分配标签</a></li><li id="929b" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://medium.com/@george_51059/reduce-aws-costs-74ef79f4f348" rel="noopener">如何降低您的AWS成本？根据这些指南，节省高达50万美元！</a></li><li id="895b" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/blogs/containers/cost-optimization-for-kubernetes-on-aws/" rel="noopener ugc nofollow" target="_blank">基于AWS的Kubernetes成本优化</a></li><li id="ba3a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.metricly.com/aws-tagging-best-practices/" rel="noopener ugc nofollow" target="_blank"> AWS标记最佳实践—终极指南</a></li><li id="6af1" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/blogs/mt/best-practices-for-organizational-units-with-aws-organizations/" rel="noopener ugc nofollow" target="_blank">拥有AWS组织的组织单位的最佳实践</a></li><li id="9492" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/blogs/apn/the-5-pillars-of-the-aws-well-architected-framework/" rel="noopener ugc nofollow" target="_blank">AWS良好架构框架的5大支柱</a></li><li id="d890" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://support.cloudability.com/hc/en-us/articles/205005327-AWS-spending-that-can-t-be-tagged" rel="noopener ugc nofollow" target="_blank">无法标记的AWS支出</a></li><li id="d65d" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/organizations/latest/userguide/services-that-can-integrate-config.html" rel="noopener ugc nofollow" target="_blank"> AWS配置和AWS组织</a></li><li id="3f1b" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://aws.amazon.com/blogs/mt/managing-aws-organizations-accounts-using-aws-config-and-aws-cloudformation-stacksets/" rel="noopener ugc nofollow" target="_blank">使用AWS配置和AWS云信息堆栈集管理AWS组织账户</a></li><li id="966b" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://wa.aws.amazon.com/wat.pillar.performance.en.html" rel="noopener ugc nofollow" target="_blank">性能效率</a></li><li id="1e1a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/ce-rightsizing.html" rel="noopener ugc nofollow" target="_blank">通过合理调整建议优化您的成本</a></li><li id="a729" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.mckinsey.com/industries/automotive-and-assembly/our-insights/still-learning-from-toyota#" rel="noopener ugc nofollow" target="_blank">(仍)向丰田学习</a></li><li id="b7a8" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://hbr.org/2019/05/creating-a-culture-of-continuous-improvement" rel="noopener ugc nofollow" target="_blank">创造持续改进的文化</a></li><li id="a785" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.tothenew.com/blog/the-kaizen-approach-to-software-development/" rel="noopener ugc nofollow" target="_blank">软件开发的改善方法</a></li><li id="aa72" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ov nd ne nf bi translated"><a class="ae kv" href="https://www.petrikainulainen.net/software-development/processes/why-continuous-improvement-is-worth-it/" rel="noopener ugc nofollow" target="_blank">为什么持续改进是值得的？</a></li></ol></div></div>    
</body>
</html>