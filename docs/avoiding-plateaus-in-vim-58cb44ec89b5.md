# 避免 Vim 中的平稳状态

> 原文：<https://betterprogramming.pub/avoiding-plateaus-in-vim-58cb44ec89b5>

## 高效 Vim 的不同模式和运作方式

![](img/d0ec5f373df8a740f88844d573732ca3.png)

Vi/Vim/Neovim 是一种编写文档(或代码)的方法，与传统的文字处理器和编码编辑器相比，它依靠键盘命令和一些编辑模式来更有效地修改和导航文本。它既有陡峭的学习曲线，也有看似无限的你可以适应的平稳期。你可以长时间停滞不前，甚至意识不到你已经停止了进步。

在 Vi/Vim/Neovim 中学习新事物往往需要打破一个现在已经成为肌肉记忆的习惯，从而让自己感到不舒服。你不能只是读几分钟新的东西，然后回到你正在做的事情。相反，你必须找到一种方法来打破你目前使用的模式，并记得尝试你读到的新事物。这是一种你支付的税，最初会让你慢下来，但后来可能会帮助你变得更有效率。

我想举例说明我使用的一些方法，并带您浏览一下 Vim 中较少使用的模式。我相信这些可以帮助你摆脱这些停滞状态，帮助你提高写文本或代码的效率。我希望它们会对你有用。

# 重新开始

*定期保存您的 Vim/Neovim 设置。*

有许多 Vim 博客和教程是由花了数年时间创建真正优雅的设置的人编写的，然而，我们倾向于只提取他们设置的片段。例外情况是，我们倾向于在刚接触 Vim/Neovim 时引入其他人的完整设置，并将它们作为我们未来几年的基础。但是如果你把自己交给他们几天会发生什么呢？

我发现，在存放我的 Vim 配置的一两周内——并从别人的开始——我学到的关于配置 Vim/Neovim 的知识比一年中其他时间都多。你会讨厌别人的设置，但同时，你会意识到你不知道是什么导致了你不喜欢的行为。这个难题迫使你学习更多关于 Vi/Vim/Neovim 的知识:查阅 Vim `:help`文档，在线查找资料，学习如何调试 Vim，并尝试自己的配置设置。

短时间内把自己交给别人思考是我们在其他场合都可能做过的事情。大学教授令人信服的演讲或我们正在参加的会议让我们进入学生的角色，我们的大脑在短时间内成为一片空白。通过别人的眼睛看到一个想法是身临其境的，有时会有启发性。之后，你总是会回到某种形式的自己，但你经历的过程会帮助你更好地理解一个想法的内部运作，并重新评估你实现该想法的方法中每个小组件的重要性(通常是用更好的组件替换效率较低的组件)。

在一两个星期的时间里，我沉浸在别人的 Vim/Neovim 配置中，开始只把我原来藏起来的那些基本设置移植回来。有些是我离不开的环境，有些是我喜欢的环境。我最终得到的是一个定制的混合配置，我自己也获得了更多关于 Vim/Neovim 的知识。

# 实践

写作、复习和练习。

为你自己建立一个常规，你可以边学边记笔记，每隔几天回来复习这些笔记。

通过用自己的话写下你所学到的东西，在 Linux 命令行、基础设施配置或 Vim/Neovim 改进等方面变得更高效会容易得多。我把《[实用 Vim](https://pragprog.com/titles/dnvim2/practical-vim-second-edition/) 》这本书的几个章节分了开来，意识到如果不放慢阅读速度、记笔记、复习、每次阅读至少练习一件事，学习任何一个章节都是多么困难。

使用一个笔记系统是很重要的，这个系统可以快速记笔记，你可以在以后完善和使用它来重新指导你自己这个概念。如果你不得不每次停止阅读几分钟来完成一个笔记，或者将笔记提交给一个让你很难回顾笔记的系统，那么很可能你会完全放弃记笔记。记笔记和复习笔记必须简单、方便、有效。

我使用一个笔记工具，它允许我在任何设备上写笔记(在 markdown 中)，添加标签和/或反向链接，并轻松地搜索笔记。这些特点足以让我快速记笔记，而不会太大程度地打断学习流程。之后，我可以很容易地找到它们，在会议中进行提炼、重新措辞或回顾。笔记工具的功能和方法各不相同，但最重要的是不要浪费时间去寻找完美的笔记工具，而忽略了开发一种技术来提高你学习困难主题的能力的总体目标。

我们的大脑有自己的试探法来决定将什么输入提交给长期记忆(或肌肉记忆，这是我们学习 Vim 的目标的一部分)。大脑需要被哄骗来接受我们偶然发现的一条信息，并认为它足够重要，以防止褪色和被遗忘。在你觉得有用的时候写下一些东西，会出乎意料地有效地让它存在更久。即使你把收到的信息一字不差地打出来，也比什么都不写要好。

物理学家理查德·费曼曾经回复一位正在查看费曼笔记的历史学家，称这些笔记是他日常工作的记录。费曼回应道

> 它们不是我思考过程的记录。他们*是我思维过程的*。我真的写了论文。

写作本身可以成为你向他人学习或自学有用东西的过程。学生们有时会认为记笔记意味着匆忙地划掉他们所听讲座的糟糕表述，因此记笔记名声不佳。他们通常会告诉你，最好全神贯注于演讲者，并与他们将要阐述的概念联系起来。他们是对的！但是当你能控制阅读或听力的速度时，写作也是消化复杂信息的一种很好的方式。倒带和重读经常由你支配，这是写作可以有效地用于自学的基础。

我每隔几天就抽出时间来复习 Vim 上的笔记(或者一些关于 Linux 命令行实用程序的珍闻),并强迫自己在每次复习时都练习几遍。没有定期的回顾，几天后我会忘记我写下的东西。没有一次练习，我会退回到我以前的(效率更低的)做事方式。和学习像钢琴这样的乐器没什么区别。

# 改掉坏习惯

*不要让懒惰的习惯根深蒂固。*

Vim 是高度可配置的，这意味着您可以阻止它支持一些键盘命令。几年前我在 *thoughtbot* 上看到一个这样的例子，它建议配置 Vim，这样你就不会被诱惑去滥用 Vim 的插入模式，比如禁用某些键，比如 backspace 和箭头键。我接受了这个建议，它在强迫我更好地使用动作(在 Vim 的正常模式下)方面惊人地有效。

让“插入模式”更加难以忍受

同样，Vim 的*视觉选择*模式也值得避免。这种模式使 Vim 更像传统的文本编辑器，你在这里花的时间越长，你在平台上逗留的时间就越长。请注意，这种视觉模式不要与 Vim 的其他视觉模式混淆，它们都非常有用。事实上，Vi 是在名为“Ex”的较老的 Unix 文本编辑器中调用“可视模式”的快捷方式。这当然催生了 Vi，讽刺的是现在 Ex 命令可以在 Vim 内部运行。

一些坏习惯只是对好工具或技术的低效使用。例如，点重复不是一件坏事，但是，将一个动作应用到文档中的一个图案，然后敲击点键 20 次是低效的。

# 学习 Vim 模式

*努力学习宏、ex 命令和视觉模式中的不同技巧。*

虽然我们可能会使用一些 ex 命令——比如`:edit`、`:write`和`:quit`——但是还有很多不太常用的命令会提高你的效率。很多时候，ex-command 的击键次数比正常模式下的动作少。有时这只是很小的节省，例如，ex 命令`:t$`将当前行复制到文档的底部，而不是普通模式的`yyGp`。其他时候，您可以通过键入(并通过 tab 键切换)`:%normal <some-normal-mode-command >`将正常模式命令应用于整个文档。不同的 ex 命令越用越直观。

宏甚至更强大，可以有那种“哇！”能够说服一个局外人开始学习 Vim 的印象。能够记录和重复击键可以为代码库重构任务节省数小时甚至数天的时间。此外，它们的编写速度比 shell 脚本快得多，您可以观察它们以人类可读的速度运行。当你不想在文档中计算行数时，这些宏甚至可以作为 ex mode `:normal`命令使用。

视觉模式(线条、字符和块)也很好，在许多情况下比其他模式更合适。将可视选择与 ex-mode 结合使用也是一种方法，可以使命令更加精确，或者确保整个文档的替换不会对可视窗口之外的文本部分造成附带损害。

有时候视觉角色模式更容易执行，也更符合你想做的事情。例如，键入`vu`或`vU`比`~`更容易到达，并且更准确地适用于您希望将*更改为*的情况，而不仅仅是更改大小写(并且在宏中使用更安全)。您还可以使用正常的单词运动(如`b`、`w`和`e`)前后移动您已经开始的部分，并使用`o`再次将光标移动到选择的末尾，从而允许您建立非常精确的视觉字符选择。

视觉块模式是 Vim 对多光标插入模式的一种回答。确保至少了解它，否则你会让 Emacs、Sublime 和 VSCode 用户觉得他们在编辑器中做了最好的选择。我们不希望他们现在赢得辩论，是吗？

# 忘记 Emacs

*了解我们从 Emacs 继承的东西，并尝试采用更符合 Vi/Vim 习惯的替代方法。*

重要的是要理解我们从 Emacs 世界带来的包袱，如果可能的话，抛弃它，支持 Vi/Vim 方法。如此多的`Ctrl` + `<some_letter>`键盘快捷键都是从他们的世界继承而来，就像`j`、`k`和`q`导航和关闭“man”页面的用法来自我们的世界一样。

Emacs 没有发明`Ctrl`键，但是考虑一下让你不舒服的小指弯曲到键盘的左下角，问问你自己当你老了 20、30 或 40 岁的时候会有多舒服。你的左手腕达到这些目标的动作具有足够的挑战性，以至于我们的眼睛可以轻微地引导我们。

你可能甚至没有意识到，当你的手离开键盘上正常的休息位置后，你用了多少眼睛(甚至是外围)来把它们放回原位。作为示范:在打字键盘上放一张纸，尝试像平常一样使用代码编辑器、web 浏览器和其他应用程序。您可能会注意到某些区域的困难:在鼠标和键盘之间的转换，以及将整只手抬起和放下的其他手部动作(如使用 CTRL、ALT 和 CMD 键)。

通过 CTRL、ALT 和 CMD 键驱动如此多的功能，我们已经接受了，但 Vi/Vim 不是这样构建的。Vi/Vim 似乎是为了用最少的物理动作更容易地控制你的编辑器而构建的。相比之下，我们很少使用 CTRL 键，而是把它留给不经常发生的操作(比如管理窗格)。

许多键映射现在已经成为 Vim 插件生态系统中的惯例，它们是围绕 Emacs 启发的键命令建立的，而不是我们使用 ex 命令的命令行模式。更改(和重新学习)自定义键盘命令使之更符合 Vi/Vim 习惯的好处是，当您没有所有插件和自己的机器时，您会更有效。

无论您是通过 SSH 连接到远程服务器、结对编程、在同事自己的机器上(有自己的插件和配置设置)向他们展示 Vim 技巧，还是在 docker 容器中执行，您都将和在自己的机器上一样高效。请注意，使用 docker 容器，您可以将 Vim config 文件夹作为一个卷挂载，如果您必须拥有它的话，但是在 docker 容器中使用 Vi 在几秒钟内更改一个文件也是很强大的。

也许你正在用某种`Ctrl` + `…`组合键打开你的书呆子树或者望远镜文件浏览器或者你的模糊查找器。相反，你可以通过隐藏(几乎)原生 Netrw `:E`或`:Explore`来打开你的文件浏览器，或者通过`:find`(只是通过`:f`而不是`Ctrl` + `p`来调用你的模糊查找器。

更彻底地学习 Netrw，并在当前的文件浏览器和 Netrw 之间保持一个较小的差距，这将使你不仅在使用无插件 Vim 时更有效率，在使用 Linux 时也是如此。蒂姆·波普甚至有一个插件，名为[vim-醋](https://github.com/tpope/vim-vinegar)，旨在成为 NerdTree 的一个更轻/更精简的版本，但反映了 Netrw 的一些映射。但是类似地，您可以定制 Telescope 或 Nerdtree，使它们更接近于本机 Netrw 命令。但是也有半打`g.netrw_…`设置您可以配置本机，使其足够。我目前正在使用类似于`:20Lex` ( `Lex`是`Lexpore`的简称，`20`设置屏幕 20%的宽度)的命令来打开窗口左侧的文件浏览器。一些额外的 Netrw 配置设置我改编自本文。

您是否知道 bash 命令行默认为`set -o emacs`，但是您也可以很容易地将其切换到`set -o vi`？不要使用所有基于`Ctrl`的键盘命令(或者试图找出如何让`Meta`键在 Mac 上工作),你可以用`Esc`代替 Vi 正常模式来划分你的命令行(除了`j`和`k`通过命令而不是 up 和 down 行返回和前进，这在这里是不相关的)。尝试一下，你可能会比默认的 Emacs 模式更喜欢它。

# 结论

这是对高效 Vim 的不同模式和操作方式的旋风式概述，但希望叙述是连贯的，并与追溯 Vi/Vim 根源的总体建议一致。如果我可以把事情归结为一句话，我想应该是这样的:回到 Ex/Vi/Vim/Neovim 的根源，你会发现比寻找插件更能让你高效。

打个比方，你发现了一个你喜欢的乐队或音乐家，很快就用完了他们的音乐目录。你从那里去哪里更深入地了解那个世界？从那里扩展到他们启发的一些其他艺术家，很少能像回溯去发现启发和影响你发现的最初艺术家的音乐那样富有成效。你可能会花上几年来填补所有的空白，但仍然无法完成。

Vim 确实类似于学习弹钢琴:通过练习和重复发展肌肉记忆比寻找更好的 MIDI 音序器和琶音工具有更多的好处。花时间成为一个更熟练的音乐家是一种与停留在装饰和修饰上完全不同的心态。