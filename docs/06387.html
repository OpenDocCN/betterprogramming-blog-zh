<html>
<head>
<title>How to Prevent Screen Capture in iOS 14</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS 14如何防止截屏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-prevent-screen-capture-at-ios-14-1f01173c31c0?source=collection_archive---------0-----------------------#2020-09-28">https://betterprogramming.pub/how-to-prevent-screen-capture-at-ios-14-1f01173c31c0?source=collection_archive---------0-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="723d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从屏幕截图和屏幕录像中保护应用中的敏感信息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5a5f8645036cab4c653278834dca01f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*orxm_zyBdc-wChuW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Jona Friedri 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="316a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">iOS 14自带了一个叫做Back Tap的新功能。它可以让你在iPhone背面自定义双击和三击，以触发快捷键、辅助功能、滚动手势和系统操作，包括屏幕截图。没什么大的水花但是超级有用。我见过许多用户对点击屏幕截图的便利感到兴奋。</p><p id="3b7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为开发人员，我们开发的应用程序可能包含敏感内容:自拍、家人照片、支付细节、版权内容和机密信息。如何保护我们的应用程序并保护用户的敏感信息免受截图和屏幕记录的影响是一个很大的问题。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5dba" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.构建我们的示例自拍应用程序</h1><p id="2e6c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">比方说，我们正在开发一款名为Selfie的应用，用于与朋友和关系分享自拍，而这些自拍并不打算被拍摄和发布给公众。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/158eeeaf8e168ad2eaaf8450d492071c.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*dmyQTzmeeLWGGc-_HSryKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的自拍应用</p></figure><h2 id="510e" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">成分布局</h2><p id="bc28" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">通过使用iOS 13+中的组合集合视图，我们创建了一个简单的垂直流布局:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的构图布局</p></figure><ul class=""><li id="1a2b" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">每个项目通过使用派系的宽度和高度来占据其群组的整个空间。</li><li id="e49b" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">每组取屏幕的整个宽度和屏幕高度的60%。</li></ul><h2 id="bf5c" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">可区分数据源</h2><p id="2a22" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">然后我们注册单元并应用数据源:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的可区分数据源</p></figure><ul class=""><li id="3618" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">将单元格注册到<code class="fe oc od oe of b">UICollectionViewDiffableDataSource</code>的实例中。</li><li id="47ee" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">将100个样本图像应用到<code class="fe oc od oe of b">.main</code>部分。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="708f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.检测并阻止屏幕捕获</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/af46791072fa1babc40dfb069ff27cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/1*TjiozmpQIsnZm6_fBIgwsQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">防止杨梦进行屏幕录制</p></figure><p id="7a18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能够通过使用通知<code class="fe oc od oe of b">UIScreen.capturedDidChangeNotification</code>来检测屏幕录制即将发生。然后，我们可以立即隐藏屏幕，并弹出一个警告窗口，让用户知道他们不允许在我们的应用程序中拍摄内容的屏幕记录。</p><h2 id="abac" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">ui screen . captureddidchange notification</h2><p id="b5e8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了检测屏幕记录，我们创建了一个名为<code class="fe oc od oe of b">ScreenProtector</code>的专用类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的CapturedDidChangeNotification</p></figure><ul class=""><li id="d012" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated"><code class="fe oc od oe of b">warningWindow</code>属性存储警告窗口的有效实例。</li><li id="8239" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">使用连接的场景检索当前窗口。</li><li id="d2ac" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">通过注册<code class="fe oc od oe of b">UIScreen.capturedDidChangeNotification</code>通知开始阻止屏幕录制。</li><li id="d832" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">当检测到屏幕录制时，隐藏当前窗口并显示警告提示。</li></ul><h2 id="9f44" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">隐藏屏幕</h2><p id="ceb0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">iOS 11.0中引入了新标志<code class="fe oc od oe of b">isCaptured</code>。它指示屏幕是否被捕获，是否是屏幕录制、播放、镜像等。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的《隐藏屏幕》</p></figure><h2 id="2e8d" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">当前警告</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ul class=""><li id="ad3e" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">如果存在任何警告窗口，请进行清理。</li><li id="c14f" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">生成具有屏幕尺寸的示例警告消息标签。</li><li id="8ef1" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">创建与内容窗口大小相同的警告窗口。</li><li id="3e8e" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">动态显示标签，并使警告窗口可见。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5ff9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.检测并防止屏幕截图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/81c478ccff3548fc16ff63fe383dea77.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/1*5Kt54Pxqsu0ubW_4uxhqqQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">防止杨梦截图</p></figure><p id="70e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然没有办法阻止iOS在我们的应用程序中截图，但我们可以检测何时截图，并在检测后删除最后保存的图像。</p><h2 id="64d8" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">ui application . userdidtakescreenshotnotification</h2><p id="649b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了检测是否截图，我们在我们的<code class="fe oc od oe of b">ScreenProtector</code>中注册通知<code class="fe oc od oe of b">UIApplication.userDidTakeScreenshotNotification</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">防止杨梦截图</p></figure><h2 id="92af" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">AppDelegate的屏幕保护程序</h2><p id="ac3e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们有了<code class="fe oc od oe of b">ScreenProtector</code>来检测和防止屏幕截图和屏幕捕获，我们将创建一个保护程序的实例，并将其放在AppDelegate中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦代表</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="22aa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="4342" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们的应用中，保护用户的敏感信息始终是重中之重。本文介绍了一种通过注册和监听<code class="fe oc od oe of b">UIApplication.userDidTakeScreenshotNotification</code>和<code class="fe oc od oe of b">UIScreen.capturedDidChangeNotification</code>通知来检测和阻止屏幕截图和屏幕录像的方法。我相信这个话题还有更多值得探索的地方。</p><p id="5a13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读，请在评论中留下您可能有的任何问题。</p><p id="ebdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面提到的所有代码都可以在这个<a class="ae ky" href="https://github.com/ericleiyang/PreventScreenCaptureIniOS14.git" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p></div></div>    
</body>
</html>