<html>
<head>
<title>Simplifying Measurement in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简化Swift中的测量</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/measurement-in-swift-simplified-30207fd8282c?source=collection_archive---------3-----------------------#2021-08-01">https://betterprogramming.pub/measurement-in-swift-simplified-30207fd8282c?source=collection_archive---------3-----------------------#2021-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8e88" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速简单的实施</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/35c5db2739e0b3e86c49a7050b97f0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYUpnUfE8BrTTMGrvUMahQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://unsplash.com/photos/WahfNoqbYnM" rel="noopener ugc nofollow" target="_blank"> unsplash </a>的<a class="ae kv" href="https://unsplash.com/@wwarby" rel="noopener ugc nofollow" target="_blank"> William Warby </a>。</p></figure><p id="1f28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我一直喜欢使用显式<code class="fe ls lt lu lv b">Measurement</code>值(量值和单位)的想法，但我通常发现它们在实际代码中很麻烦。</p><p id="4d89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几个解决方案，但我发现它们不尽人意。</p><p id="d4e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，经过一些研究和思考，我发现下面的语法是一个理想的语法，它很好地支持Xcode中任何类型的<code class="fe ls lt lu lv b">Dimension</code>的可用单元的自动完成。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="6d38" class="ma mb iq lv b gy mc md l me mf">let m: Mass = 123(.kilograms) // =&gt; 123.0 kg<br/>let m2: Mass = 123(.kilograms) + 17(.stones) // =&gt; 230.95493 kg<br/>m2.converted(to: .pounds) // 509.1688786398349 lb</span></pre><p id="3693" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经过一点思考和实验，我能够非常简洁地实现它:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="9d0e" class="ma mb iq lv b gy mc md l me mf">public typealias Mass = Measurement&lt;UnitMass&gt;<br/>​<br/>public extension Double { <br/>  func callAsFunction &lt;U: Dimension&gt;(_ units: U) -&gt; Measurement&lt;U&gt; {<br/>       Measurement(value: self, unit: units)<br/>  }<br/>}<br/>​<br/>public extension Int {<br/>  func callAsFunction &lt;U: Dimension&gt;(_ units: U) -&gt; Measurement&lt;U&gt; {<br/>       Measurement(value: Double(self), unit: units)<br/>  }<br/>}</span></pre><p id="385d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为隐式单位化零值添加一个小扩展:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="008f" class="ma mb iq lv b gy mc md l me mf">// Example<br/>let z: Mass = .zero<br/>​<br/>// Using<br/>public extension Measurement where UnitType: Dimension {<br/>   static var zero: Measurement&lt;UnitType&gt; {<br/>       Measurement(value: 0, unit: UnitType.baseUnit())<br/>   }<br/>}</span></pre><p id="4ae8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过在<code class="fe ls lt lu lv b">Double</code>和<code class="fe ls lt lu lv b">Int</code>扩展中使用泛型，我们可以轻松地包含任何其他的<code class="fe ls lt lu lv b">Measurement</code>和<code class="fe ls lt lu lv b">Units</code>，而不需要编写额外的繁琐的样板代码。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="09fe" class="ma mb iq lv b gy mc md l me mf">public typealias Duration = Measurement&lt;UnitDuration&gt;<br/>public typealias Angle = Measurement&lt;UnitAngle&gt;<br/>public typealias Length = Measurement&lt;UnitLength&gt;<br/>public typealias Speed = Measurement&lt;UnitSpeed&gt;</span></pre><p id="b88c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您发现自己想要或需要某个特定<code class="fe ls lt lu lv b">Dimension</code>的额外单元，可以轻松添加为扩展单元:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="4f05" class="ma mb iq lv b gy mc md l me mf">// As an example<br/>extension UnitDuration {<br/>   <br/>   static let SecondsPerDay: Double = 86_400<br/>   <br/>   static let days = UnitDuration(symbol: "days", <br/>     converter: UnitConverterLinear(coefficient: SecondsPerDay))<br/>​<br/>   static let weeks = UnitDuration(symbol: "weeks",<br/>     converter: UnitConverterLinear(coefficient: SecondsPerDay * 7))<br/>​<br/>   static let months = UnitDuration(symbol: "months",<br/>    converter: UnitConverterLinear(coefficient: SecondsPerDay * 30))<br/>​<br/>   static let years = UnitDuration(symbol: "years",<br/>   converter: UnitConverterLinear(coefficient: SecondsPerDay * 365))<br/>}</span></pre><p id="9bdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果这是有用的，看一看<a class="ae kv" href="https://gist.github.com/wildthink/4b63ab16250f17d04b85309b5338b479" rel="noopener ugc nofollow" target="_blank">这里</a>的完整代码以及一些其他有用的补充。</p><p id="cbe4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有兴趣了解更多关于单位和度量以及如何创建你自己的自定义单位和度量，我推荐以下内容。</p><ul class=""><li id="abae" class="mg mh iq ky b kz la lc ld lf mi lj mj ln mk lr ml mm mn mo bi translated"><a class="ae kv" href="https://developer.apple.com/documentation/foundation/units_and_measurement" rel="noopener ugc nofollow" target="_blank">苹果:单位和测量</a></li><li id="92ac" class="mg mh iq ky b kz mp lc mq lf mr lj ms ln mt lr ml mm mn mo bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/unit-and-measurement-in-swift-7c6be4a25586">Swift中的单位和测量</a></li></ul></div></div>    
</body>
</html>