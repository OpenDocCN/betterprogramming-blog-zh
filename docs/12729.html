<html>
<head>
<title>Smooth Read Less/Read More Feature in Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue中的平滑少读/多读功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/smooth-read-less-read-more-feature-in-vue-83d26734cb92?source=collection_archive---------6-----------------------#2022-06-27">https://betterprogramming.pub/smooth-read-less-read-more-feature-in-vue-83d26734cb92?source=collection_archive---------6-----------------------#2022-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7db8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">平滑且自主的可扩展块内容</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dfc47efed1eff9e94895c06752b20591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hN1pgeG6K-9O8PP6jde4cg.png"/></div></div></figure><p id="abae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我被要求创建一个基本的少读/多读数据块内容。很基本的东西，对吧？</p><p id="10e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，在网上浏览Vue 3版本并不成功。对于这么简单的东西，我不想使用库。最后，我用了一个自制的解决方案。</p><p id="de12" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我向您介绍一个100行代码的组件，它提供:</p><ul class=""><li id="6a91" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">流畅的动画</li><li id="78aa" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">可定制的初始高度:用于折叠状态</li><li id="df63" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">自主行为:检测切换按钮的必要性</li></ul><p id="eec9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一切都将逐步引入，这样你就可以在任何适合你需要的时候停下来。</p><h1 id="ce25" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">简单的可扩展块内容</h1><p id="15d8" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">首先，您需要从一个基本块内容组件开始。切换按钮将显示或隐藏块的主体。这里没有什么超级复杂的。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/28c7974fd4971636bd1874794038024f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K75Ybkdvgzvh6Ir7hpVOZg.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">来源:作者</p></figure><h2 id="6e4f" class="nj mg it bd mh nk nl dn ml nm nn dp mp ld no np mr lh nq nr mt ll ns nt mv nu bi translated">用流畅的动画</h2><p id="6424" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">开始有趣的是添加一个平滑的动画。Vue为过渡和动画提供了完整的文档。</p><div class="nv nw gp gr nx ny"><a href="https://vuejs.org/guide/built-ins/transition.html" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">过渡| Vue.js</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">vue . js——渐进式JavaScript框架</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">vuejs.org</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><p id="f477" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我推荐你阅读JavaScript钩子部分，它解释了如何在动画中控制转换过程和CSS行为。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="98d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里必须注意几点:</p><ul class=""><li id="2783" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">周围<code class="fe oo op oq or b">Transition</code>组件的使用(L11)</li><li id="0872" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">几个Javascript钩子定义了动画的行为(L11-L16)</li><li id="13be" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">带有<code class="fe oo op oq or b">transition</code>属性的CSS转换定义(L96)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/188224a0db694dd40195d91deb51354b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KG34pKkFn-Kk9FvtKbV_6A.gif"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">可扩展块内容(来源:作者)</p></figure><p id="e033" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在能够显示包含以下内容的块内容:</p><ul class=""><li id="35fc" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">流畅的动画</li></ul><p id="ac7a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们继续，然后允许一个初始高度，这将站在折叠状态。</p><h1 id="8908" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">调整折叠状态的高度</h1><p id="59af" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">改进具有初始高度的部件是另一个难点。</p><p id="3996" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">实际上，<code class="fe oo op oq or b">overflow</code> CSS规则不是一个“可转换”的属性，这意味着在转换过程中不能有一个可以与<code class="fe oo op oq or b">height</code>结合的中间状态。</p><p id="7331" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，我们将不得不用一个预览块内容来保存折叠的内容。此外，我们必须使用两个新变量:</p><ul class=""><li id="0509" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">最初显示的可见行数</li><li id="9046" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">那些线条的高度(<code class="fe oo op oq or b">line-height</code>)</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="1ccf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里，应注意几个技术要点:</p><p id="6e11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe oo op oq or b"><a class="ae on" href="https://vuejs.org/guide/built-ins/transition.html#the-transition-component" rel="noopener ugc nofollow" target="_blank">Transition</a></code> <a class="ae on" href="https://vuejs.org/guide/built-ins/transition.html#the-transition-component" rel="noopener ugc nofollow" target="_blank">组件</a></p><p id="a549" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它现在嵌套了两个不同的块:预览和扩展内容。</p><h2 id="b416" class="nj mg it bd mh nk nl dn ml nm nn dp mp ld no np mr lh nq nr mt ll ns nt mv nu bi translated"><strong class="ak">过渡模式</strong></h2><p id="340b" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">注意L9上的<code class="fe oo op oq or b">mode="out-in"</code>。它确保两个块之间的转换顺利完成:预览块首先离开DOM然后将扩展的内容输入到DOM中。</p><p id="c823" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe oo op oq or b">visibleLines</code>道具</p><p id="678f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个新道具有助于定义预览块的高度。此外，我们需要<code class="fe oo op oq or b">line-height</code>，这里设置为<code class="fe oo op oq or b">24px</code>。根据你的排版风格随意修改。您甚至可以将它作为组件的<code class="fe oo op oq or b">prop</code>来提供。这个道具会用两次。</p><p id="34fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，在L48上，计算预览块的高度，以便可以在过渡钩子中使用它。</p><p id="fb40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第二，在L108上的<code class="fe oo op oq or b">style</code>标签中设置预览<code class="fe oo op oq or b">div</code>的<code class="fe oo op oq or b">max-height</code>。Vue使用关键字<code class="fe oo op oq or b">v-bind</code>帮助完成这项工作(更多细节<a class="ae on" href="https://vuejs.org/api/sfc-css-features.html#v-bind-in-css" rel="noopener ugc nofollow" target="_blank">在这里</a>)，它依赖于底层的<a class="ae on" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties" rel="noopener ugc nofollow" target="_blank"> CSS变量</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/16066711f6b3ecb2f15db30d00fd4a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*w95a--GkJY_KxZMT6yFGGA.gif"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">用少读/多读功能屏蔽内容(来源:作者)</p></figure><p id="529a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们刚刚完成了组件的第二个预期特征:</p><ul class=""><li id="c2d6" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">可定制的初始高度:用于折叠状态</li></ul><p id="7df9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个平滑的少读/多读功能运行得很好…但没那么好。与预览的最小高度相比，如果内容不够长会怎么样？嗯，切换按钮在任何情况下都会被呈现。那不是超级方便。</p><p id="b636" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们来看看如何克服这个问题。</p><h1 id="8312" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">奖励点:自主触发需要检测</h1><p id="30c1" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">我想你已经在这里找到了。目标是让组件检测是否有必要显示切换按钮。</p><p id="3a0f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，我们将只使用<code class="fe oo op oq or b">onMounted</code>钩子(可能您可以使用一个观察器)和一个<a class="ae on" href="https://vuejs.org/guide/essentials/template-refs.html#accessing-the-refs" rel="noopener ugc nofollow" target="_blank">模板引用</a>。不多不少。</p><p id="ab08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从下面的L59到L64，你会看到只需要将实际预览高度与<code class="fe oo op oq or b">maxHeightCollapsed</code>进行比较。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cb6a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们终于完成了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/2687400dc89888b6bc07c8d6fa1a95d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tWEvRCdvRqG9r-xL96CpNQ.gif"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">自主切换按钮需要检测(来源:作者)</p></figure><h1 id="6e43" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">简单地</h1><p id="1b1d" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">嗯，这是一个快速的…但正如你可能已经看到的，Vue提供了一堆工具来快速轻松地控制过渡行为。此外，CSS变量管理有助于动态设置组件的初始状态。</p><p id="a800" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望这篇文章能帮助您创建超级漂亮的可扩展包装器和可切换的块内容。首先，我感到惊讶的是，这个话题在网上并没有被广泛报道。但是最后我想通了，创建这样的组件并没有那么复杂。</p><h1 id="c6d4" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">资源</h1><div class="nv nw gp gr nx ny"><a href="https://vuejs.org/guide/built-ins/transition.html" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">过渡| Vue.js</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">vue . js——渐进式JavaScript框架</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">vuejs.org</p></div></div><div class="oh l"><div class="ou l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">使用CSS自定义属性(变量)- CSS:级联样式表| MDN</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">自定义属性(有时称为CSS变量或级联变量)是由CSS作者定义的实体…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">developer.mozilla.org</p></div></div><div class="oh l"><div class="ov l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://vuejs.org/guide/essentials/template-refs.html#accessing-the-refs" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">模板参考| Vue.js</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">虽然Vue的声明性呈现模型为您抽象出了大部分直接的DOM操作，但仍然可能有…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">vuejs.org</p></div></div><div class="oh l"><div class="ow l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>