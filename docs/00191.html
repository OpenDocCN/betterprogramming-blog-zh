<html>
<head>
<title>Handling API in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Native中处理API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/handling-api-like-a-boss-in-react-native-364abd92dc3d?source=collection_archive---------0-----------------------#2018-09-14">https://betterprogramming.pub/handling-api-like-a-boss-in-react-native-364abd92dc3d?source=collection_archive---------0-----------------------#2018-09-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a85eafe835ad03e637c1fa9d06da54b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIjfoUR90CUKibydNhq_Bw.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@jantined?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">詹汀·杜恩博斯</a>在<a class="ae kf" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="31ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你做过任何有一系列元素的项目，比如名字、地址、图像、视频等等。，那么你很可能见过术语<em class="le"> API </em>。</p><p id="633b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">API是应用程序编程接口的首字母缩写，它是一个软件中介，允许两个应用程序相互通信。每次你使用像脸书这样的应用程序，发送即时消息或在手机上查看天气，你都在使用一个API。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="0983" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">API是如何工作的？</h1><p id="dced" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">想象一下，你坐在餐馆的一张桌子旁，有一份菜单可供选择。厨房是“系统”的一部分，它将为你的订单做准备。缺少的是将您的订单传达给厨房并将您的食物送回您餐桌的关键环节。</p><p id="2bad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是服务员，或者API的用武之地。服务员是信使(或API)，接受你的请求并告诉厨房(系统)做什么。</p><p id="9dba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后服务员会把回答反馈给你——在这种情况下，就是食物。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="7d01" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">你必须知道的基本术语:</h1><p id="7766" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">如果你熟悉JavaScript和ES6，那么你一定熟悉f <a class="ae kf" href="https://developers.google.com/web/updates/2015/03/introduction-to-fetch" rel="noopener ugc nofollow" target="_blank"> etch </a>。</p><p id="5064" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">fetch是一个为React Native设计的出色的网络API，但是因为它相对较新，所以在使用它时需要注意一些事情。</p><p id="0c2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">承诺:</strong>承诺表示异步操作的最终结果。它是一个占位符，成功的结果值或失败的原因将在其中具体化。它要么给你一个回应，要么给你一个错误，即拒绝。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="7325" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">在React Native中集成API:</h1><p id="477a" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在React Native中，我们可以使用Fetch来满足我们的需求。您可以简单地通过Fetch调用URL，并根据需要向服务器发出请求。</p><p id="b239" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">React Native中的生命周期方法。</strong>有几种生命周期方法可以反应原生。在本文中，我们将使用其中的三种生命周期方法；<code class="fe mv mw mx my b">constructor</code>、<code class="fe mv mw mx my b">componentDidMount</code>和<code class="fe mv mw mx my b">Render</code>。</p><p id="4153" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我假设你知道状态和构造函数，以及它们在React Native中的用法。如果没有，请在这里浏览基础知识<a class="ae kf" href="https://reactjs.org/docs/state-and-lifecycle.html" rel="noopener ugc nofollow" target="_blank">，然后回到这里享受处理API的乐趣。</a></p><div class="mz na gp gr nb nc"><a href="https://medium.com/@sudhirKr/react-native-navigating-between-the-screens-and-code-structure-for-beginners-6b815ee8f79" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">反应导航初学者(高级版-3)</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">几个月前我开始和react native一起工作，我必须说这是一个从全职…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq jz nc"/></div></div></a></div></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="09ad" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">第一步</h1><p id="5f8c" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">在这里，我创建了两个状态。一个是<code class="fe mv mw mx my b">boolean</code>状态，另一个是<code class="fe mv mw mx my b">array</code>状态。</p><p id="1342" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">加载状态是针对加载程序映像的，它会一直显示，直到在后端进行API调用并获取数据。</p><p id="c0ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Datasource是一个空数组，所有的JSON值都将添加到这个数组中；稍后在我们的代码中使用。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nr mu l"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="03cf" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">第二步</h1><p id="fe40" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">一旦构造器部分完成，我们将继续我们在这里要做的部分——从API获取数据用于列表。</p><p id="bbb7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在将使用<code class="fe mv mw mx my b">componentDidMount</code>方法，因为我希望在应用程序开始时调用API。</p><p id="8030" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一个URL，我使用了一个虚拟的API，你可以通过谷歌很容易地找到它。</p><p id="b2d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用Fetch调用URL，然后它返回一个带有<code class="fe mv mw mx my b">then</code>和<code class="fe mv mw mx my b">catch</code>的承诺。类似于<code class="fe mv mw mx my b">try</code>和<code class="fe mv mw mx my b">catch</code>。</p><p id="35fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">来自API的响应是JSON的形式，它被获取，然后被设置成我们已经创建的状态。</p><p id="d4e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看说明这一点的代码:</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nr mu l"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="4a3d" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">最后一步</h1><p id="34c5" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">现在，最后一部分——使用我们在React本地项目中获取的数据。</p><p id="8fc6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将在清单中使用React Native的<code class="fe mv mw mx my b">FlatList</code>组件，因为这是建议的并且易于实现。在我们的<code class="fe mv mw mx my b">render</code>函数中，我们将把代码写成:</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nr mu l"/></div></figure><p id="c4fd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">组件要求一个源、一个键和需要呈现的内容。</p><p id="bf08" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用datasource作为内容源，id值作为键，我们需要的视图将在<code class="fe mv mw mx my b">renderItem</code>方法中呈现。</p><p id="151f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们希望一个人的名字，电子邮件id，和该人所属的公司简单列表。</p><p id="a432" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是代码。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nr mu l"/></div></figure><p id="ffc8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以添加样式和更多元素。您可以根据需要添加任意数量的，并且存在于数组JSON中。</p><p id="fc6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将在这里为您提供完整的代码片段。检查一下，像老板一样统治API！</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="nr mu l"/></div></figure><p id="ff47" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，请不要只是复制和粘贴代码——这会破坏本文中的所有工作。</p><p id="c38c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你完成了编码部分，这就是你看到的屏幕。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2f3bfb13f3e0b0351576713fb61f9c81.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*jJLTaCrLPrvaylNhjfFrvQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">使用React Native FlatList和JSON API列出详细信息</p></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="55a9" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">结论</h1><p id="3b80" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">我们了解了什么是API，以及它是如何工作的。我们学习了<code class="fe mv mw mx my b">FlatList</code>以及如何在React Native中使用它。我们学习了React Native中使用的各种生命周期方法。</p><p id="648d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是时候走出去，在你的应用程序中列出一切，从你的未来计划到你最喜欢的目的地。</p><p id="78e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请随时留下任何反馈。</p></div></div>    
</body>
</html>