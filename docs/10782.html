<html>
<head>
<title>Deploy Solidity Contracts to an NFT Marketplace With Price Feed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将可靠性合同部署到具有价格反馈的NFT市场</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/solidity-contracts-for-an-nft-marketplace-5a706bb94486?source=collection_archive---------4-----------------------#2022-01-27">https://betterprogramming.pub/solidity-contracts-for-an-nft-marketplace-5a706bb94486?source=collection_archive---------4-----------------------#2022-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eeac" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用图表和代码示例解释</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4debed26076df21990af39225782a7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLFYYoHoduBPnjJx0Hqepg.jpeg"/></div></div></figure><p id="6b5d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将一步一步地检查合同，在每一步中，我们将首先查看一个从较高层次解释流程的图表，然后，我们将查看代码。</p><p id="8665" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在文章的最后，我们将使用Remix IDE和Metamask将合同部署到Polygon Testnet，并创建+上传一个NFT到市场。</p><p id="316e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里可以看到完整的代码<a class="ae ln" href="https://gist.github.com/pguso/802890442a9aa2f1d3d6d76bb3f0a91d" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="9ade" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">什么是NFT？</h1><blockquote class="mg mh mi"><p id="5a3e" class="kr ks mj kt b ku kv jr kw kx ky ju kz mk lb lc ld ml lf lg lh mm lj lk ll lm ij bi translated"><em class="iq"> NFT(不可替代)</em>多少意味着它是独一无二的，不能被别的东西替代。例如，一个比特币是可替代的——用一个比特币换另一个比特币，你会得到完全一样的东西。然而，独一无二的交易卡是不可替代的。如果你把它换成另一张卡，你会得到完全不同的东西。</p></blockquote><p id="c84d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常用于艺术或项目在元宇宙，但它可以是任何数字或真实的。例如，NFT可以是现实世界中的房屋的参考，并且所有权是公开可追踪的。</p><p id="1d81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们开始看看创建和销售NFT的流程。为了理解solidity代码，你需要对Solidity有一个基本的了解，或者如果你不完全理解，你可以检查<a class="ae ln" href="https://docs.soliditylang.org/en/v0.8.0/" rel="noopener ugc nofollow" target="_blank"> solidity文档</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/67e766f0468e6a81c7bfc071a70b1d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3L_PWTkwlots240adv82g.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">NFT -&gt; createToken()</p></figure><p id="bd50" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，NFT必须在可以在市场或其他地方交易之前被创建。</p><p id="c031" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在上图中，您可以看到<code class="fe ms mt mu mv b"><strong class="kt ir">createToken()</strong></code>方法调用了<code class="fe ms mt mu mv b">ERC721URIStorage</code>契约的三个方法，该契约是OpenZeppelin契约回购<a class="ae ln" href="https://github.com/OpenZeppelin/openzeppelin-contracts" rel="noopener ugc nofollow" target="_blank">中经过良好测试和维护的契约之一。<code class="fe ms mt mu mv b">createToken()</code>方法将接收<code class="fe ms mt mu mv b">tokenURI</code>作为参数，例如从URI到IPFS:</a></p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="8c51" class="na lp iq mv b gy nb nc l nd ne"><a class="ae ln" href="https://ipfs.io/ipfs/Qme7ss3ARVgxv6rXqVPiikMJ8u2NLgmgszg13pYrDKEoiu" rel="noopener ugc nofollow" target="_blank">https://ipfs.io/ipfs/Qme7ss3ARVgxv6rXqVPiikMJ8u2NLgmgszg13pYrDKEoiu</a></span></pre><p id="12c6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe ms mt mu mv b">_safeMint()</code>方法中，将生成NFT，并将发送者设置为所有者。之后，<code class="fe ms mt mu mv b">_setTokenURI()</code>方法会将上面的IPFS URI设置为令牌URI。</p><p id="b2f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe ms mt mu mv b">_setApprovalForAll()</code>方法中，市场合同将获得津贴，为业主管理NFT。这意味着市场合同将被允许出售NFT，并在收到买方付款后转让所有权。至少它将返回newItemId，从1开始，并随着每个新的NFT而递增。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="8abe" class="na lp iq mv b gy nb nc l nd ne">function <strong class="mv ir">createToken</strong>(string memory tokenURI) public returns (uint) {<br/>    _tokenIds.increment();<br/>    uint256 newItemId = _tokenIds.current();<br/><br/>    _safeMint(msg.sender, newItemId);<br/>    _setTokenURI(newItemId, tokenURI);<br/>    setApprovalForAll(contractAddress, true);<br/>    return newItemId;<br/>}</span></pre><p id="560e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们需要将创建的NFT添加到市场中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/3bb9f234b987b8ef5e92f94908dc28af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRFEeExvcrxkR40-eDoFTQ.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">NFTMarket -&gt; addItemToMarket()</p></figure><p id="4135" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在两次需求检查之后，我们将创建一个新的<code class="fe ms mt mu mv b">MarketItem</code>并将其推送到一个包含marketplace的所有NFT的数组中，然后NFT被传输到marketplace，之后，我们发出一个包含新MarketItem细节的事件。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="0a40" class="na lp iq mv b gy nb nc l nd ne">function <strong class="mv ir">addItemToMarket</strong>(<br/>    address nftContract,<br/>    uint256 tokenId,<br/>    uint256 price<br/>) public payable nonReentrant {<br/>    require(price &gt; 0, "Price must be at least 1 wei");<br/>    require(msg.value == listingPrice, "Price must be equal to listing price");<br/><br/>    _itemIds.increment();<br/>    uint256 itemId = _itemIds.current();<br/><br/>    idToMarketItem[itemId] =  MarketItem(<br/>        itemId,<br/>        nftContract,<br/>        tokenId,<br/>        payable(msg.sender),<br/>        payable(address(0)),<br/>        price<br/>    );<br/><br/>    IERC721(nftContract).safeTransferFrom(msg.sender, address(this), tokenId);<br/><br/>    emit MarketItemCreated(<br/>        itemId,<br/>        nftContract,<br/>        tokenId,<br/>        msg.sender,<br/>        address(0),<br/>        price<br/>    );<br/>}</span></pre><p id="4764" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们需要收到一份未售出的NFT的清单，买家可以查看并购买。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/84ebc5a3c821be5a0678d5ff664d05e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AtlXAt-t5okpVIZ6thQt6A.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">NFTMarket -&gt; getUnsoldItems()</p></figure><p id="ed7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们读取市场拥有的所有NFT的计数，迭代商品，并检查市场契约是否是当前所有者，如果是，则将其添加到商品数组，并在最后返回所有未售出的商品。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="e47c" class="na lp iq mv b gy nb nc l nd ne">function <strong class="mv ir">getUnsoldItems</strong>() public view returns (MarketItem[] memory) {<br/>    uint itemCount = _itemIds.current();<br/>    uint unsoldItemCount = _itemIds.current() - _itemsSold.current();<br/>    uint currentIndex = 0;<br/><br/>    MarketItem[] memory items = new MarketItem[](unsoldItemCount);<br/>    for (uint i = 0; i &lt; itemCount; i++) {<br/>        if (idToMarketItem[i + 1].owner == address(0)) {<br/>            uint currentId = i + 1;<br/>            MarketItem memory currentItem = idToMarketItem[currentId];<br/>            items[currentIndex] = currentItem;<br/>            currentIndex += 1;<br/>        }<br/>    }<br/><br/>    return items;<br/>}</span></pre><p id="2cd7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">至少我们想卖掉物品，把所有权转让给买家。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/58f6d4576c1bf55139955b80f59460ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fu96TyeJYLh8ABGCltqlsA.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">NFT market-&gt; sellItemAndTransferOwnership()</p></figure><p id="a7c8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ms mt mu mv b">sellItemAndTransferOwnership()</code>方法有一个修饰符，它将直接或间接地阻止契约调用它自己。我们要求发送者需要支付确切的要价。我们将NFT从市场转移给买家，并将支付的金额发送给NFT的所有者。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="1aca" class="na lp iq mv b gy nb nc l nd ne">function <strong class="mv ir">sellItemAndTransferOwnership</strong>(<br/>    address nftContract,<br/>    uint256 itemId<br/>) public payable nonReentrant {<br/>    uint price = idToMarketItem[itemId].price;<br/>    uint tokenId = idToMarketItem[itemId].tokenId;<br/>    require(msg.value == price, "Please submit the asking price in order to complete the purchase");<br/><br/>    idToMarketItem[itemId].seller.transfer(msg.value);<br/>    IERC721(nftContract).transferFrom(address(this), msg.sender, tokenId);<br/>    idToMarketItem[itemId].owner = payable(msg.sender);<br/>    _itemsSold.increment();<br/>    payable(owner).transfer(listingPrice);<br/>}</span></pre><p id="f8cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是主要的过程。</p><p id="1f34" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们有额外的方法通过给定的id用<code class="fe ms mt mu mv b">getMarketItemById()</code>获取市场项目的细节，并通过所有者/创建者用<code class="fe ms mt mu mv b">getItemsByOwner()</code>显示NFTs。</p><p id="8d47" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一个有趣的帮助方法是<code class="fe ms mt mu mv b">getLatestPrice()</code>,你可以在市场契约上调用它。它继承自PriceConsumerV3协定。这里我们将地址<code class="fe ms mt mu mv b">0xd0D5e3DB44DE05E9F294BB0a3bEEaF030DE24Ada</code>传递给<code class="fe ms mt mu mv b">AggregatorV3Interface</code>这个地址是多边形测试网(孟买)上MATIC的美元价格。</p><p id="fb98" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您将这些合同部署到另一个网络和/或想要使用不同的价格源，您可以查看<a class="ae ln" href="https://docs.chain.link/docs/reference-contracts/" rel="noopener ugc nofollow" target="_blank"> chainlink文档</a>以获取您需要添加到<code class="fe ms mt mu mv b">AggregatorV3Interface</code>的地址。</p><p id="1755" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是一个伪代码示例，说明如何计算NFTs的价格并显示当前的美元价值:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="d95c" class="na lp iq mv b gy nb nc l nd ne">const latestPrice = NFTMarket.getLatestPrice()<br/>const priceInUsd = (item.price/(10**18)) * (latestPrice/10**8)</span></pre><p id="9c1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在部署这些合同时，您首先需要部署市场合同，然后在部署NFT合同时，将市场合同地址传递给它。</p><p id="dfb5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一个(几乎)完整的流程图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/8d969c6224dc436f1b94f75eb36274e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EA__Sk8HsBZ6i4_AsP4H_A.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">完整的可视化流程(为简单起见，未包括所有细节)</p></figure><p id="a954" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们想通过Remix IDE部署我们的契约并运行一些方法。你可以从<a class="ae ln" href="https://gist.github.com/pguso/802890442a9aa2f1d3d6d76bb3f0a91d" rel="noopener ugc nofollow" target="_blank">这里</a>得到完整的代码。</p><p id="05ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">打开<a class="ae ln" href="https://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank">混音IDE </a>。</p><ol class=""><li id="0b65" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">在<code class="fe ms mt mu mv b">contracts &gt; Market.sol</code>下新建一个文件。</li><li id="1df8" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">将<a class="ae ln" href="https://gist.github.com/pguso/802890442a9aa2f1d3d6d76bb3f0a91d" rel="noopener ugc nofollow" target="_blank">这里</a>的完整代码粘贴到新文件中。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/ea779634d5e58649f55f9ba8512b9535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CmqcNUpzDkR-AmFmXOJhg.png"/></div></div></figure><p id="2c10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们想整理我们的合同。</p><ol class=""><li id="82bb" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">切换到编译选项卡。</li><li id="e8f8" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">选择版本0.8.0和</li><li id="04c3" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">点击<code class="fe ms mt mu mv b">Compile Market.sol</code>。</li></ol><p id="4d43" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果一切顺利，您将在编译选项卡上看到一个绿色的成功图标。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/86676b83835a2be0a57d4fb401f070ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMUb2MqFZYNThesH--sbUA.png"/></div></div></figure><p id="9328" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我使用Chrome和Metamask扩展进行部署。你可以在这里下载并安装Metamask <a class="ae ln" href="https://metamask.io/download/" rel="noopener ugc nofollow" target="_blank">。然后，打开元掩码，按照给出的步骤设置元掩码。</a></p><p id="ea1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请将多边形Mumbai-Testnet添加到元掩码。</p><p id="fbb8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以检查多边形<a class="ae ln" href="https://docs.polygon.technology/docs/develop/metamask/config-polygon-on-metamask/" rel="noopener ugc nofollow" target="_blank">文档</a>或者遵循下面的两个步骤。</p><p id="be11" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">打开元蒙版并:</p><ol class=""><li id="a2da" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">打开网络列表</li><li id="3a82" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">点击添加网络。忽略我的网络列表，我已经配置了几个。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/f9f6c1ac1c0dc41f693137c800cfa419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLsZ9ystvVj65QCfzQbLGw.png"/></div></div></figure><p id="b96e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">浏览器中会打开一个新选项卡来添加网络。</p><ol class=""><li id="3c8a" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">添加一个网络名，我选择多边形Testnet。</li><li id="a4c1" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">2.添加新的RPC URL<a class="ae ln" href="https://rpc-mumbai.maticvigil.com/" rel="noopener ugc nofollow" target="_blank">https://rpc-mumbai.maticvigil.com/</a>。</li><li id="c297" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">3.将链ID设置为80001(请忽略我的错误消息，我已经配置了网络)。</li><li id="8db3" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">可以选择添加货币符号MATIC。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/cfcd5f87b8870522caf5f9129943e80d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wno6AyIPFbUnp1O3HkE9Uw.png"/></div></div></figure><p id="b015" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，您需要为部署费用获取一些测试脚本。你可以在这里得到它们。只需将您的帐户地址粘贴为钱包地址，提交后您将收到MATIC进行测试，它没有任何实际价值。</p><p id="d4cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们部署我们的合同。</p><ol class=""><li id="f942" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">切换到“部署和运行事务”选项卡。</li><li id="9691" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">选择注入的Web3。</li><li id="0c97" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">从下拉列表中选择<code class="fe ms mt mu mv b">NFTMarket</code>合同。</li><li id="e625" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">点击部署。</li></ol><p id="16b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将弹出Metamask并要求您确认部署，请单击确认。几分钟后，您将在已部署的合同下看到一个条目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/b216b5745bdd98f426c99b57dcd0a309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UXMKGLkDWpujIKCw4mZUA.png"/></div></div></figure><p id="24b1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们部署NFT合同。</p><ol class=""><li id="0380" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">从下拉列表中选择NFT合同。</li><li id="588f" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">将地址复制到市场合同中。</li><li id="9040" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">通过复制的地址输入。</li><li id="9d72" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">点击部署。Metamask将再次要求确认。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/cc87fac69ee9a5a1c86f7b254f173c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WB0RvAfiNmqQLCAmahhlzg.png"/></div></div></figure><p id="dff5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">恭喜你，你已经部署好了与区块链互动的一切，来运营你的NFT市场。</p><p id="5bf7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们想运行我们之前理论上经历过的方法。</p><ol class=""><li id="526f" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">打开NFT合同。</li><li id="71c5" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">在字段中粘贴一个IPFS地址，例如<code class="fe ms mt mu mv b"><a class="ae ln" href="https://ipfs.io/ipfs/Qme7ss3ARVgxv6rXqVPiikMJ8u2NLgmgszg13pYrDKEoiu" rel="noopener ugc nofollow" target="_blank">https://ipfs.io/ipfs/Qme7ss3ARVgxv6rXqVPiikMJ8u2NLgmgszg13pYrDKEoiu</a></code>。</li><li id="03ff" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">点击<code class="fe ms mt mu mv b">createToken</code>运行该方法。元掩码将再次弹出，因为我们将向区块链写入一些内容。橙色按钮将在区块链上生成一项交易，并收取一定费用。</li></ol><p id="8070" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你把1放入NFT合同面板底部的<code class="fe ms mt mu mv b">tokenURI</code>字段，你可以检查是否一切正常，你将收到同样的IPFS·URI。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/5030edfa37daef6ff23007ccf0aeacc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqGzDc1zVRGE3AeTqseB1A.png"/></div></div></figure><p id="a04e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们将NFT加入市场。</p><ol class=""><li id="7623" class="nj nk iq kt b ku kv kx ky la nl le nm li nn lm no np nq nr bi translated">将<code class="fe ms mt mu mv b">100000000000000000 Wei</code>粘贴到0.1 MATIC的值字段中，这是你为上市向市场合约支付的费用。你可以在这里找到一个单位转换器<a class="ae ln" href="https://polygonscan.com/unitconverter" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="a13a" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">打开<code class="fe ms mt mu mv b">addItemToMarket</code>方法。</li><li id="1373" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">将地址粘贴到您的NFT合同上。</li><li id="7e19" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">为我们要上传到市场的令牌id加1。</li><li id="2c57" class="nj nk iq kt b ku ns kx nt la nu le nv li nw lm no np nq nr bi translated">添加您想要为NFT设置的价格，为了简单起见，我只粘贴了上面的<code class="fe ms mt mu mv b">100000000000000000 Wei</code>。</li></ol><p id="7638" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个按钮上的红色表示这个方法被标记为payable，您需要发送(在这个例子中是一些MATIC)给这些方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/03e44d51cb789946b814586bdfbff3d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZRFV6JNyQzy-p6hQGbDe6Q.png"/></div></div></figure><p id="e8cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您的阅读。如有疑问，欢迎写评论。</p></div></div>    
</body>
</html>