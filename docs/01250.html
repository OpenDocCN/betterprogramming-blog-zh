<html>
<head>
<title>Creating a Twitch Command Script With Streamlabs Chatbot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Streamlabs聊天机器人创建Twitch命令脚本</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-twitch-command-script-with-streamlabs-chatbot-step-by-step-a9f8cccd680d?source=collection_archive---------3-----------------------#2019-08-27">https://betterprogramming.pub/creating-a-twitch-command-script-with-streamlabs-chatbot-step-by-step-a9f8cccd680d?source=collection_archive---------3-----------------------#2019-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6ebe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建Twitch命令的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b29dfb509685822fbb1e1d3dc514ef04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NpyG5eqOBZJ9s2aF"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1550" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:这篇文章仍然非常有用，但是你可以在这里找到一个更小的系列<a class="ae kv" href="https://nintendoengineer.medium.com/how-to-create-a-twitch-command-script-for-streamlabs-chatbot-part-1-the-necessities-5ce937ae8183" rel="noopener">，这里许多不必要的文字被清理掉，文章更加集中在每个主题上。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="ec87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你在这里可能是因为你想做一个<a class="ae kv" href="https://help.twitch.tv/s/article/chat-commands" rel="noopener ugc nofollow" target="_blank">抽动</a>的命令。这是一个很酷的小功能，可以给你的视频聊天增添趣味，对我来说，是给别人的视频聊天增添趣味。</p><p id="9d03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于偶然发现这种想法的人:“等等，什么？抽动命令？”Twitch命令是在查看器聊天中设置的触发器，调用时通常会自动返回一条消息。</p><p id="b033" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这主要是为了唤起更多的兴趣，吸引更多的观众。</p><p id="ab4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你属于前一类人，并且一直在网上寻找创建这样一个命令的简单指南，不久前我也是你。</p><p id="874d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">背景故事时间！</p><p id="6bda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在几个月的时间里，我在Twitch上和一个非常酷的流光交了朋友:<a class="ae kv" href="https://twitch.tv/theslychemist" rel="noopener ugc nofollow" target="_blank">the sylchemist</a>。</p><p id="4b9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在看到这个人投入到工作中的时间和努力以及总体的友好态度后，我决定把帮助他发展渠道作为一个个人目标。</p><p id="c40c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一名. NET开发人员，我提供了我的服务，他问我是否能为他创建一个命令。我想这不会很难，只是一点谷歌和Python编程，没什么大不了的。于是，我说:“当然！”</p><p id="8ccc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你读的时候脑子里有摩根·弗里曼的画外音。</p><p id="220d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我对了一半(还是错了一半？)，因为有一些<a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki" rel="noopener ugc nofollow" target="_blank">文档</a>可用，但不足以让您立即投入使用。</p><p id="4726" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要害怕！这篇文章是我帮助你做到这一点的尝试，这样你就不必经历我在启动和运行我的第一个Twitch命令时所经历的一切。</p><p id="becc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个帖子看起来很大，但其中大约一半是可选的奖励材料，放在<em class="lz">附录A </em>和<em class="lz"> B </em>中。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="7ede" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">必需品</h1><p id="1a8b" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">为了能够跟随，你需要几样东西:</p><ul class=""><li id="1f59" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">一个<a class="ae kv" href="https://www.twitch.tv/" rel="noopener ugc nofollow" target="_blank"> Twitch </a>账号——用于在发布前测试你的命令。你可能已经有一个了，不然你为什么会在这里？</li><li id="4dc6" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">这将处理和运行您的命令，并为调试提供日志记录，这是您最需要的。使用您的Twitch帐户登录机器人和流媒体工具。</li><li id="0366" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">一个可以编译Python的IDE。我使用<a class="ae kv" href="https://www.jetbrains.com/pycharm/download/#section=windows" rel="noopener ugc nofollow" target="_blank"> Jetbrains PyCharm社区版，</a>因为它既免费又非常好。它有内置的智能感知，它知道PEP 8的样式规则，这有助于保持你的代码干净，如果你需要，你可以很容易地测试你的方法。你可以随意使用你选择的代码编辑器，只要它能编译Python。与在记事本中编码相比，这将为你节省相当多的愚蠢的错误。</li><li id="a460" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><a class="ae kv" href="https://www.python.org/downloads/release/python-2713/" rel="noopener ugc nofollow" target="_blank"> Python 2.7.13 </a>。是的，Python在撰写本文时是3.7.4版本，但Streamlabs Chatbot可以与2.7.13版本的编译器一起工作。不要射杀信使。之后，打开Streamlabs聊天机器人，前往<em class="lz">脚本</em>部分。点击右上角的设置图标，将路径添加到<code class="fe nl nm nn no b">Python27\Lib</code>文件夹(不是<em class="lz"> Libs </em>)。如果让Python用默认设置安装自己，它应该在<code class="fe nl nm nn no b">C:\Python27\Lib</code>中:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/43ced72aae7fa75dbfc6bf918fc2cb56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cE-YgdlxXMxDRGP5wrjtew.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在本练习中，您可以忽略API键字段。</p></figure><ul class=""><li id="9691" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">在这篇文章中，至少假设了一些基本的编程技能。这是一篇关于创建Twitch命令的文章，所以我不会深入到变量和方法/函数调用以及它们是如何工作的。在继续之前，您应该熟悉这些条款。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1dd6" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">我们在建造什么？</h1><p id="121d" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">所以，显然我们要写一些代码，但是我们实际上在构建什么呢？</p><p id="1371" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为这是设置和发布命令的基础，所以我们保持简单。让我们创建一个命令，当被查看者调用时，返回一条消息，说明这个人实际上来自外太空的可能性。</p><p id="b94e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个例子很复杂，但是不要担心，它远没有听起来那么难。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5df3" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">基本设置</h1><p id="0b49" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">所有的Streamlabs Chatbot (SC)命令都有一些你需要正确实现的基础，以便它在用户界面中作为一个可运行的脚本出现，更不用说运行它了。</p><p id="0246" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些是:</p><h2 id="dde5" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">文件命名</h2><p id="0159" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">对于作为SC脚本的Python脚本，格式应该是<code class="fe nl nm nn no b">command_StreamlabsSystem.py</code>。</p><p id="a575" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，让我们首先创建一个<code class="fe nl nm nn no b">mulder</code>目录，并在该目录中创建<code class="fe nl nm nn no b">mulder_StreamlabsSystem.py</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/2737fac5479267c30dfec724baab7256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*GPwmq5tZKbTE2JJtltXMDQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">穆德似乎是这个命令的合适名字。</p></figure><p id="916a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以自由选择在哪里创建这个目录，只要它的名称与命令的名称相同。</p><p id="47ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">专业提示:如果你在你机器的内部SC脚本目录中创建它，当我们进入测试/发布阶段时，它将节省大量的导入和更新工作。</p><p id="080a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Windows上，您可以在以下位置找到它:</p><pre class="kg kh ki kj gt od no oe of aw og bi"><span id="d050" class="nq mb iq no b gy oh oi l oj ok">C:\Users\USERNAME\AppData\Roaming\Streamlabs\Streamlabs Chatbot\Services\Scripts.</span></pre><h2 id="c3bd" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">基本结构</h2><p id="2dc5" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">SC不会在脚本部分显示您的脚本，除非它至少包含以下内容:</p><ul class=""><li id="2c38" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">脚本信息——这是一组全局变量，SC使用它们来填充<code class="fe nl nm nn no b">Scripts</code>部分中的一些字段。让我们将这些添加到我们的空脚本中:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/07b706f98c92ecd7e00164dfb4ccdc02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nkde97UUXEWflVdd2nAyAw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">你不必包括评论(灰色部分)。</p></figure><ul class=""><li id="e1d9" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">脚本初始化器——<code class="fe nl nm nn no b">Init()</code><em class="lz"/>方法由SC在每次脚本被(重新)加载到<code class="fe nl nm nn no b">Scripts</code>部分时运行。在<code class="fe nl nm nn no b">Script Information</code>下添加以下内容(为清洁起见，先添加一条新线):</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/60aff42b713b2b9e95e8f8f9e3330e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIYY48R9maSKZITXdSxGlg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">你的IDE可能会抱怨大写的“I ”,但是SC希望这样。</p></figure><ul class=""><li id="45cb" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">脚本执行:每次在Twitch视频聊天中输入任何命令时，SC都会运行<code class="fe nl nm nn no b">Execute(data)</code>方法。我们稍后将讨论如何只过滤<code class="fe nl nm nn no b">mulder</code>命令。<code class="fe nl nm nn no b">data</code>参数由SC自动传递，包含发送者和消息的信息。让我们把这个添加到我们的脚本中:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/bf0d7dadee84ef04c0fedf6cf236d938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qxrmMzR35Ioqp8keZ0qY1g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">是的，是的，大写的E，我们知道。</p></figure><ul class=""><li id="6e5a" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">脚本迭代逻辑:<code class="fe nl nm nn no b">Tick()</code>方法在脚本每次运行时运行，顾名思义，就是每次运行。即使聊天中没有输入数据或任何内容，这种逻辑也会运行。它只是连续运行。让我们将它添加到我们的脚本中:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/8d13bd917e3546e7df3c2a3dc36da061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeLFqRjNDXV5tGbwpN5JOg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们不会在我们的例子中使用它，但是在创建更高级的命令时它会很有用。</p></figure><p id="d01d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对！现在我们得到了我们需要的，所以SC至少会承认我们的努力。您的文件现在应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/ac3e232f534836beb6ef4f14df92b59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SDzc1dI5bfsiOaLAyDlVQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">基于PEP 8，PyCharm建议在方法之间新增两行，所以我只是照着做。</p></figure><p id="a1c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您的文件看起来不像这样，请确保进行必要的调整。</p><h2 id="c35b" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">加载脚本</h2><p id="e8d8" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">如果您之前利用了专业技巧，这将是小菜一碟。只需打开SC，转到<code class="fe nl nm nn no b">Scripts</code>部分，它应该已经在那里了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/7cb1209557249afa2b73e196ce557561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CQnT0-KsPRH-Sz10ViUGbw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">看莫特在那里发光！</p></figure><p id="703c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以看到<code class="fe nl nm nn no b">Mulder</code>命令和我的一些其他命令(要实时查看它们，请查看<a class="ae kv" href="https://twitch.tv/theslychemist" rel="noopener ugc nofollow" target="_blank">the sylchemist</a>的流)。</p><p id="8f88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们都在同一个<code class="fe nl nm nn no b">SC Scripts</code>文件夹中，所以当我创建它们的时候它们会自动出现。</p><p id="6886" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果它没有出现，试着点击右上角的重新加载按钮。如果它仍然没有出现，请检查前面的所有步骤或尝试下面的选项。</p><p id="7469" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你没有遵循专业建议，你将不得不绕远路:</p><ul class=""><li id="6667" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">使用您喜欢的工具压缩<code class="fe nl nm nn no b">mulder</code>目录。</li><li id="8db0" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">转到SC中的<code class="fe nl nm nn no b">Scripts</code>部分，点击右上角的<em class="lz">导入</em>按钮(左起第二个按钮)。</li><li id="6bcb" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">转到保存<code class="fe nl nm nn no b">.zip</code>文件的地方，选择它进行导入。</li><li id="c04a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">它现在应该出现在列表中。</li></ul><p id="6c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">公平的警告:如果你像这样加载命令，当你不得不调试代码时，它会变得非常乏味非常快。您将更改代码，压缩文件，导入它，然后您可以测试它。</p><p id="c590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果修复不起作用，你可以从头再做一遍。遵循<em class="lz">基本设置</em>部分给出的建议可以避免这种情况。然后，它变得像点击重新加载按钮一样简单。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="221d" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">实现逻辑</h1><p id="d0ee" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在我们已经有了基础，是时候给我们的脚本添加一些功能或逻辑了。</p><p id="aacc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的命令逻辑放在<code class="fe nl nm nn no b">Execute(data)</code>方法中，当聊天中发布消息时，SC会调用该方法。</p><p id="530f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一些问题需要考虑，但我会指导你完成，所以让我们开始吧！</p><p id="8118" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还记得我说过聊天中的任何命令(或者消息)都会触发我们的<code class="fe nl nm nn no b">Execute(data)</code>方法吗？</p><p id="101d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们只想响应命令<code class="fe nl nm nn no b">“!mulder”</code>，所以我们应该验证消息中的第一件事实际上是这样说的。我们使用为此传递的<code class="fe nl nm nn no b">data</code>参数，因为它包含一些我们可以利用的<a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki/Data-Object" rel="noopener ugc nofollow" target="_blank">属性和方法</a>。</p><p id="1973" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一种这样的方法是<code class="fe nl nm nn no b">data.GetParam(int id)</code>。我们将使用它来获取消息中的第一个内容，并验证它是否等于<code class="fe nl nm nn no b">“!mulder”</code>。如果没有，我们什么都不做。但是说够了，让我们来实现它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/621b843a714da15ba333a3429adc0c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMiQApmnt80P-raL-h-LLg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Python使用从零开始的索引，所以消息中的第一件事是在索引0处。</p></figure><p id="053e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的命令应该基于概率来声明某人是否是外星人。</p><p id="b433" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来介绍一下那个概率，给它一个10%左右的值，那么每十个人里面，其实就有一个是外星人。该死的。</p><p id="e12e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，决定某人是否是外星人是一个单独的微观责任，我们可以委托给一个实用方法。</p><p id="80a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将该方法添加到<code class="fe nl nm nn no b">Tick()</code>方法下，并为其添加概率:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/2729d6588c51c450b260554b38269cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWBoM_BpG_u22p3im0WOZw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">目前看起来不错！</p></figure><p id="5b92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要加强这一点，如果某人是外星人，就让它返回<code class="fe nl nm nn no b">True</code>，如果不是，就让它返回<code class="fe nl nm nn no b">False</code>。</p><p id="0398" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python有原生的随机方法，但是它们似乎不太适合SC。我们将使用SC提供的随机功能，即<code class="fe nl nm nn no b"><a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki/Miscelaneous" rel="noopener ugc nofollow" target="_blank">Parent.GetRandom(int min, int max</a></code> <a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki/Miscelaneous" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> ) </em> </a>返回一个0到100之间的值。</p><p id="f2bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们得到一个低于或等于我们概率的值，我们返回<code class="fe nl nm nn no b">True</code>，否则，我们返回<code class="fe nl nm nn no b">False</code>(你可以忽略父错误):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/c84be3661af71dedd739f65f69ca3132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8zWNlaW-Gf3ZcrYb8ufgg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">random _ chance≤alien _ probability已经等于True或False，所以我们用它作为返回值。</p></figure><p id="f6d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据结果，我们将向聊天室发送两条消息中的一条。</p><p id="b799" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使事情更清晰，让我们引入另一个实用方法来处理发送消息:<code class="fe nl nm nn no b">send_message(message)</code>。您可以在<code class="fe nl nm nn no b">is_alien()</code>方法下添加以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/dd846d429e832886a870d634392bc266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*075HjGoB5EznQBhEffSQVg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">看起来不太像，但从长远来看，它将使我们的代码更易读。你能想象到处都是红色的曲线吗？</p></figure><p id="15a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在两个可能的消息中使用触发该命令的查看者的用户名。</p><p id="02c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们必须从<code class="fe nl nm nn no b">data</code>参数中获取，并且我们不想违反DRY原则(不要重复自己)，所以让我们引入一个变量来保存用户名:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/60bb1f06245c119cb8b1c201660a862a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z87GoLwz6fLNXaq9Wyebgg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们将引用用户名变量，而不是每次都从数据中获取。</p></figure><p id="a9c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要根据<code class="fe nl nm nn no b">is_alien()</code>响应发送消息。添加该逻辑完善了我们的命令逻辑:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/393865f8648082c7ff71c05c9d3b8bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rmjfc7r1nJuOECVVngaX6g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">看你走了！你是一个支持抽搐指令的创造者。</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0907" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">尝试一下</h1><p id="d4ec" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">首先，转到SC的<code class="fe nl nm nn no b">Scripts</code>部分，像以前一样重新加载脚本，并确保通过选中右边的框来启用<code class="fe nl nm nn no b">Mulder</code>命令。</p><p id="8eb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/06727362565025d50ef94c743f7116f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3eB9VnJCYa10yz4iIVtHQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">好东西！</p></figure><p id="5cb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，前往SC的<em class="lz">控制台</em>部分(左上)，在聊天中键入<code class="fe nl nm nn no b">!mulder</code>并点击回车。</p><p id="b703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">魔法随之而来！穆德正在评判你的本性。试了几次，他终于发现我不是这个星球的人:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/741a5cfa0c3ce255e1e591d5391318f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*befhsaaJepSFvd0KOTH-7A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">就因为我不需要氧气生存…穆德喜欢反应过度。</p></figure><p id="2e3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我可以祝贺你写了你的第一个Twitch命令脚本吗？这是我为智能化学家创建命令的基本流程。你可以在这里停下来，运行，并创建一组命令，你可以自由地这样做。</p><p id="f03c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，如果你想从网上随便找一个人那里得到更多的建议——也请阅读接下来的几节，至少是关于调试代码的部分。这将被证明是一个救命恩人。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="b812" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">附录A:调试</h1><p id="d6eb" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我知道，我知道，这不是最性感的话题。</p><p id="bf5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">脚本应该只是像你编码时想象的那样工作，这应该是它的结束。我在编码时经常有这种想法，因为几乎没有什么东西是一蹴而就的。</p><p id="f426" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">甚至上面的示例项目也需要我做一些调整才能正确完成，因为会发生一些愚蠢的错误(别担心，脚本会像图中所示的那样工作，我只是必须先修复我的)。所以，让我们开始用SC调试吧。</p><h2 id="53c5" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">记录</h2><p id="96d4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这就是我要给你看的全部内容。记录你的脚本在做什么，什么时候做，这是找出bug可能藏在哪里的最快方法(准备好苍蝇拍)。</p><p id="baa4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，SC有自己的日志方法:<code class="fe nl nm nn no b">Parent.Log(string command, string message)</code>，我们将使用它。</p><p id="f7f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们开始吧。</p><p id="53fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，log方法看起来有些庞大，因为我们将不止一次地使用它，所以让我们创建一个实用方法来包装它。</p><p id="2c41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">额外的好处是，我们不需要在每次想要记录一些东西时都指定命令。它保持不变，这样做可以让我们保持干燥:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/f90d8200bfea22f6c34787aecf27a0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gY0w8JL3Cqb0byrlyzUAcw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">您可以将它一直放在底部，send_message方法的下面。</p></figure><p id="c0b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我注意到我们在两个不同的地方使用了字面命令名，这违反了DRY原则，所以让我们解决这个问题。</p><p id="c64c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将一个全局变量添加到我们已有的变量中，并用该变量替换所有的<code class="fe nl nm nn no b">“!mulder”</code>实例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/7432f51a8c80f783657f7a9a2cfd9378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ee5aB2cElwk_OtVXWJS-dQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/d7179e3f32dc928c73e5bceba3405736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X37z_zeebkWXT8rdulEJDA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/b8f032602f44ed37b505582c28bc39a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfM7gYD6LgzbIxUbmXc9YQ.png"/></div></div></figure><p id="44f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们给我们正在使用的方法添加一些日志语句:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/4700dcde5a0b6a84031a7721e708fdec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3q1d6nu8DmLwCv-5mEzAQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/074cdec66532fd163550d0eddee86e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cWB70HF1znojfWkIlM1QA.png"/></div></div></figure><p id="369f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好事正在这里发生。在SC中重新加载脚本，然后通过单击右上角的中间图标移动到日志窗口:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/d890ced1cd37baf65864264931425dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*lenBK5c0Aj2oY4Hj6h4Qig.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">圆形的“信息”按钮。</p></figure><p id="d6c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">清除右上角带有重新加载符号的窗口，并移动到SC的<em class="lz">控制台</em>部分。再次输入<code class="fe nl nm nn no b">!mulder</code>，返回日志窗口。</p><p id="7394" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它应该向您显示流经不同方法的日志:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/218725d4ac0324f1e0865e7d5ac825b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kFgPSlMHGkLfwDbu4gNayQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我看不错！</p></figure><p id="b696" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">程序中有很多地方可能出错，在调试这些问题时，使用日志来确定位置将会节省大量时间。</p><p id="749f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着您继续创建更高级的命令，您将认识到在哪里以及如何放置日志来验证正确的值正在被传递，或者检查您需要的方法是否被实际调用。</p><p id="180e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以用日志做很多事情。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6bf9" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">附录B:很高兴有</h1><p id="71be" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这里有一些你可以添加到你的命令中的好东西，让它看起来更酷一点，但是它们并不是创建你的命令所必需的。</p><h2 id="468e" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">增加冷却时间</h2><p id="2d35" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">你可能不希望你的命令在任何时候都能被所有人使用，即使它们很棒。你可能有一个繁忙的聊天，或者有人可能是一个巨魔和垃圾邮件的命令。</p><p id="7a01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是冷却的用武之地。SC有几个<a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki/Cooldown-Management" rel="noopener ugc nofollow" target="_blank">手柄</a>用来添加和检查用户或命令的冷却时间。我将在这里展示用户特定的冷却时间。</p><p id="1955" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它包括两个小的补充:</p><p id="bc7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nl nm nn no b">Execute(data)</code>方法的末尾添加用户冷却时间，使用<code class="fe nl nm nn no b">data.User</code>获取查看器的用户ID，并将30秒指定为冷却时间:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/59b4aeea6e0788204724e9d3309ebb78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcS4CMXtZ-2VtrXjrpWpbA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这应该会减少触发器的数量。</p></figure><p id="7c62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在<code class="fe nl nm nn no b">Execute(data)</code>方法的开始，在命令检查中，包含了一个对用户冷却时间的额外检查。</p><p id="8efd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果用户在冷却期间再次调用这个命令，我们不想执行我们的逻辑。加上那点逻辑:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/e7edcd5847c0d22ce5492e74e1b771a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJC2eH3VGTf5MOMi86QeIA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">现在巨魔们被挫败了！</p></figure><p id="9f9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检查我是否能在彼此之后立即触发该命令会产生一个有希望的结果。该命令不执行，因为我在过去30秒内触发了它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/790a81bdcfe649a47376078538d7157b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZjaioJdiqlU-ZHOzGVCwg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我想他上次得出错误的结论后一定哑口无言了。</p></figure><p id="56fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你知道如何添加用户冷却时间了。</p><p id="e9e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为命令本身增加一个冷却时间有一个相似的流程，简单的交换用户冷却方法和命令冷却方法。</p><h2 id="3c6c" class="nq mb iq bd mc nr ns dn mg nt nu dp mk lf nv nw mm lj nx ny mo ln nz oa mq ob bi translated">添加用户界面</h2><p id="cc4f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">你可能见过也可能没见过SC中某些命令的界面，控制器可以在其中更改脚本中使用的值。它看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/e90a4a4d4b06133af348ace008dde99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzCl8np-JHK2NlCIco-wSw.png"/></div></div></figure><p id="e4fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">巨大的额外好处是，冷却时间和其他值可以在脚本之外更改，根本不用接触脚本。</p><p id="e7d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这节省了相当多的工作，并使不习惯脚本的人更容易处理脚本。</p><p id="3e32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想在我们的剧本中加入这一点，所以让我们开始吧:</p><p id="8aa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们在与Python文件相同的文件夹中创建<code class="fe nl nm nn no b">UI_Config.json</code>文件。获得正确的命名，创建它并在IDE中打开它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/5b86b35737f2927777736d58517f6b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xR2HPKgymI-NzLeUuWPg-g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这里有点空…</p></figure><p id="a27a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SC在他们的<a class="ae kv" href="https://github.com/AnkhHeart/Streamlabs-Chatbot-Python-Boilerplate/wiki/Creating-UI-Config-File" rel="noopener ugc nofollow" target="_blank"> GitHub Wiki </a>页面上记录了文件的格式和选项。首先，我们必须选择我们的值将被转储到的文件的名称和类型，以便在我们的脚本中使用。</p><p id="7943" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将以下内容添加到文件中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/58eebf0dd926fcd462821e89e2e3dc26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*1MGCn-grEQLoyW_4eiyY-A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">注意括号和引号。</p></figure><p id="7889" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的脚本需要两个值:百分比形式的概率和秒形式的冷却时间。两者都是数字，所以我们需要一个数字框。</p><p id="a16d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们添加这些内容并填写字段:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/954a2f60f81732ee7d6f8134aa89a309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*on-iesCX4-q5r6kKzWxnlA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">value:初始值，label:出现在框上方的内容，tooltip:当鼠标悬停在它上面时。</p></figure><p id="bb1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存文件，返回SC中的<em class="lz">脚本</em>部分并重新加载脚本。</p><p id="62b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你现在点击<code class="fe nl nm nn no b">Mulder</code>命令时，它显示了我们全新的用户界面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/846abed48442390fc1863cc2e190f479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smMv8QscbGgRg_Au65bK0Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是什么！？你的莫特在进化！</p></figure><p id="4ea5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还没到那一步，朋友。还记得我们定义的输出文件吗？点击UI中的<em class="lz">保存设置</em>，返回IDE。</p><p id="e7fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您应该看到创建了两个新文件:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/b2ce1bb38a87e6efb7c17fe7e6a15533.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*eG2wjrYynJYEbBUTJzn7vg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">到目前为止，一切顺利。</p></figure><p id="48ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们对<code class="fe nl nm nn no b">settings.json</code>文件感兴趣，这是我们定义的文件。如果打开它，您会看到我们定义的值及其数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pk"><img src="../Images/a158a47fda15f069e17b8c09717aa593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkF5Wir8MkWtzXo5jyNpxw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是由SC自动生成的。不错吧。</p></figure><p id="0476" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在想使用这些动态更新的值，而不是文件中的硬编码值。为此，我们需要导入一些库来帮助读取这个设置文件。</p><p id="9aa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在全局脚本信息变量上方添加以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/2db8645403e0f2f5e171cf2049bbdf9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXm7D6KzJ4KS4nB72MDEbQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们接下来会用到这些。</p></figure><p id="154a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在加载文件之前，我们需要一些东西来存储这些变量。为此，让我们创建一个全局设置对象:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/6b65b8837ed5593d9748ed9f729c4d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UOfBT5Wq6B1WeIErZlHZqg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">开始是空的，接下来我们将加载值。</p></figure><p id="99ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当脚本被(重新)加载时，我们只想一次性读取这些值。没有必要在每次脚本执行时都读取它们。</p><p id="446a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哪种方法在每次(重新)加载时只运行一次？你记得！这是<code class="fe nl nm nn no b">Init()</code>方法。让我们开始一步一步地给它添加逻辑。</p><p id="7329" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要让Python知道我们将要改变我们的全局设置对象:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pn"><img src="../Images/bcd83410dd698be70b2da39d73c983d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EaOa8E5zdr7DJzjQ5Mnd9w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">现在Python知道当我们在方法中使用它时，我们指的是全局设置对象。</p></figure><p id="8cc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要访问<code class="fe nl nm nn no b">settings.json</code>文件。</p><p id="1ab4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于它与我们当前所在的脚本在同一个位置，我们可以请求Python获取我们现在所在的目录的路径，以供以后使用:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/146ac3b2dde65646e22d34cd35201345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxLV6NJfPr3uEG2w_4eF8w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">只要再久一点，你就能做到！</p></figure><p id="761e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那好吧。现在，让我们开始有趣的部分:读取文件并将内容存储在我们的设置对象中。</p><p id="25b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用之前定义的工作目录来构造文件的完整路径，并使用实际的文件名来连接它。确保文件名与<code class="fe nl nm nn no b">UI_Config.json</code>中定义的文件名完全相同:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi po"><img src="../Images/2abd1ead5bd93c900c82232ebc263142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R1ML2BCooRllW-nkOnPKNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们已经加载了设置！</p></figure><p id="8088" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！现在我们已经加载了设置，我们可以使用该对象来访问UI中定义的值。</p><p id="41d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将硬编码的值替换为对应的动态引用(确保拼写与<code class="fe nl nm nn no b">UI_Config.json</code>文件中的拼写相匹配):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pk"><img src="../Images/56de4789b1bc77d63fbf840c9d42c375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_g5XNuGqTZcEXczecgkqrQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pp"><img src="../Images/4c40a6335ca6a52ee92759dc543f81ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LODBIv3kvGHt2cya89P6LQ.png"/></div></div></figure><p id="79d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考试时间！前往SC，转到<em class="lz">脚本</em>部分并重新加载脚本。</p><p id="2bb8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在控制台中调用该命令会产生我们之前得到的结果，但是现在我们可以从脚本外部动态地更改我们的值:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pq"><img src="../Images/2dd6560c1ec329b0c285fdeb85ccb6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzWIv2hY_FOmEqVaa2y45w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一样，但不一样？</p></figure><p id="c191" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">额外的好处:我们可以在试图读取我们的设置文件时捕捉到一个可能的错误。在我们当前的场景中，读取错误会导致脚本中断，但是如果我们捕获并处理这个错误，我们就能够构建一个回退。</p><p id="ec18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是更干净的处理方式。以下代码捕获任何错误或Python行话中的异常，记录错误以供研究，并提供回退值，以便脚本可以继续运行，同时您可以冷静地调查发生了什么:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pr"><img src="../Images/167edb01b2249b8d17b21ff6b3ff6871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7V0z-EIMcWlwGiSwF8Lbjg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">确保拼写正确！</p></figure><p id="075c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是你如何融入用户界面！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="f878" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结束了</h1><p id="81ec" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我想说的就是这些，这是真的，但我明白所有这些步骤对一个新人来说似乎很令人生畏。不过，不用担心。创建一些命令后，这将成为你的第二天性，我保证。</p><p id="642d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是创建Twitch命令脚本的“基本”步骤。</p><p id="535d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已吗？是和不是。是的，这是你如何建立一个命令脚本，不，你可以在Python中做更多的事情。</p><p id="c01f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择几乎是无穷无尽的。对于不同的基本、半高级和极度高级命令的集合，看一看<a class="ae kv" href="https://twitch.tv/theslychemist" rel="noopener ugc nofollow" target="_blank">the sylchemist</a>的流。我的大多数命令在那里都是可见的。</p><p id="88c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据这篇文章的表现，如果有人对更先进的技术感兴趣，我会再写几篇文章，展示如何播放音乐，让查看器超时，甚至使用全局状态来“记住”查看器和他们以前的操作。</p><p id="6ab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读，请记住:真相就在那里…</p></div></div>    
</body>
</html>