<html>
<head>
<title>Creating a Multi-Language App in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Native中创建多语言应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-multi-language-app-in-react-native-9828b138c274?source=collection_archive---------0-----------------------#2019-07-08">https://betterprogramming.pub/creating-a-multi-language-app-in-react-native-9828b138c274?source=collection_archive---------0-----------------------#2019-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="baad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用react-native-localize和i18n为React本地应用程序添加多语言支持</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/941ace286ab6ed3781a13912facdbb20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GgmGZJnFec994dvCDpbWQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托马斯·凯利在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">语言一直是任何业务的重要组成部分。随着业务的增长，他们通常会考虑扩展到不同的国家和地区。为了在这些新地区取得成功，提供本地化服务非常重要。</p><p id="c63d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到手机app，条件也没什么不同。随着应用程序的用户群扩展到不同的国家，为用户提供以他们的母语使用应用程序的能力非常重要。</p><p id="2bfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一块，我们将通过使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://github.com/react-native-community/react-native-localize" rel="noopener ugc nofollow" target="_blank">react-native-localize</a></code>包来构建一个支持多种语言的React原生应用。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="9dc1" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">先决条件</strong></h1><p id="c767" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">本教程需要React Native的基础知识。要设置您的开发机器，请遵循官方指南<a class="ae ky" href="https://facebook.github.io/react-native/docs/0.59/getting-started" rel="noopener ugc nofollow" target="_blank">这里的</a>。</p><p id="1438" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了确保我们在同一页上，以下是本教程中使用的版本-</p><ul class=""><li id="d658" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">节点v10.15.0</li><li id="8205" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">国家预防机制6.4.1</li><li id="d57d" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">纱线1.16.0</li><li id="bcce" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">react-原生0.59.9</li><li id="3b63" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">反应-原生-本地化1.1.3</li><li id="2d40" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">i18n-js 3.3.0</li></ul></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b6df" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">入门</strong></h1><p id="83fe" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们将建立一个React本地应用程序，它将支持<strong class="lb iu">英语</strong>、<strong class="lb iu">法语、</strong>和<strong class="lb iu">阿拉伯语</strong>。</p><p id="5bd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nr">注:如果你想马上看一下源代码，这里是GitHub </em> <a class="ae ky" href="https://github.com/vikrantnegi/react-native-multi-language-app" rel="noopener ugc nofollow" target="_blank"> <em class="nr">链接</em> </a> <em class="nr">。</em></p><p id="56a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用<code class="fe lv lw lx ly b">react-native-cli</code>创建新项目，请在终端中键入以下内容:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="8530" class="nw mh it ly b gy nx ny l nz oa">$ react-native init multiLanguage<br/>$ cd multiLanguage</span></pre><h2 id="fef9" class="nw mh it bd mi ob oc dn mm od oe dp mq li of og ms lm oh oi mu lq oj ok mw ol bi translated"><strong class="ak">添加所需的库</strong></h2><p id="2feb" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">通过键入以下命令安装<code class="fe lv lw lx ly b">react-native-localize</code>:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="1f21" class="nw mh it ly b gy nx ny l nz oa">$ yarn add react-native-localize</span></pre><p id="f734" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后使用以下链接它:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="db2d" class="nw mh it ly b gy nx ny l nz oa">$ react-native link react-native-localize</span></pre><p id="f7ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nr">注意:如果您在安装过程中遇到任何错误，请在此</em>  <em class="nr">处查看安装说明</em> <a class="ae ky" href="https://github.com/react-native-community/react-native-localize#setup" rel="noopener ugc nofollow" target="_blank"> <em class="nr">。</em></a></p><p id="8dfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">react-native-localize</code>库可以让你访问很多与本地化相关的设备常量，但是没有<code class="fe lv lw lx ly b">i18n</code>库。</p><p id="1c0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://github.com/fnando/i18n-js" rel="noopener ugc nofollow" target="_blank">I18n.js</a></code>为JavaScript提供I18n翻译。</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="56f5" class="nw mh it ly b gy nx ny l nz oa">$ yarn add i18n-js</span></pre><p id="460b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于<code class="fe lv lw lx ly b">i18n-js</code>似乎没有提供任何缓存/记忆，我们将使用<code class="fe lv lw lx ly b">lodash.memoize</code>来实现同样的目的:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="bdc5" class="nw mh it ly b gy nx ny l nz oa">$ yarn add lodash.memoize</span></pre><h2 id="a637" class="nw mh it bd mi ob oc dn mm od oe dp mq li of og ms lm oh oi mu lq oj ok mw ol bi translated"><strong class="ak">添加翻译</strong></h2><p id="9a54" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在<code class="fe lv lw lx ly b">src</code>中创建一个<code class="fe lv lw lx ly b">translations</code>目录，然后创建三个JSON文件，每种语言一个。</p><p id="3796" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.<code class="fe lv lw lx ly b">en.json</code>为英文</p><p id="b847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<code class="fe lv lw lx ly b">fr.json</code>用于法语</p><p id="ad54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.<code class="fe lv lw lx ly b">ar.json</code>为阿拉伯语</p><p id="e638" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些文件包含带有键和值的JSON对象。</p><p id="4ec8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每种语言的密钥都是相同的，并将在应用程序中用于显示文本。</p><p id="859e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该值将是我们希望向用户显示的文本，并且对于每种语言都是不同的。</p><p id="98b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于英语:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="3f6c" class="nw mh it ly b gy nx ny l nz oa">{</span><span id="c0f1" class="nw mh it ly b gy om ny l nz oa">  "hello": "Hello World!"</span><span id="36a4" class="nw mh it ly b gy om ny l nz oa">}</span></pre><p id="b9bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于法语:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="4c49" class="nw mh it ly b gy nx ny l nz oa">{</span><span id="b98d" class="nw mh it ly b gy om ny l nz oa">  "hello": "Salut le Monde!"</span><span id="7674" class="nw mh it ly b gy om ny l nz oa">}</span></pre><p id="667f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于阿拉伯语:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="b35d" class="nw mh it ly b gy nx ny l nz oa">{</span><span id="1e4c" class="nw mh it ly b gy om ny l nz oa">  "hello": "أهلاً بالعالم"</span><span id="d621" class="nw mh it ly b gy om ny l nz oa">}</span></pre><p id="4cd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您可以为应用程序中使用的每个文本添加更多的键值对。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="798e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">添加主代码</strong></h1><p id="3029" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">打开<code class="fe lv lw lx ly b">App.js</code>文件和以下导入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="19a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们将添加一些稍后会用到的辅助函数和常量:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="b365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将创建我们的<code class="fe lv lw lx ly b">App</code>类组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="df23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的构造函数方法中，我们调用了<code class="fe lv lw lx ly b">setI18nConfig()</code>来设置初始配置。</p><p id="d8c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在<code class="fe lv lw lx ly b">componentDidMount()</code>中，我们将添加一个事件监听器，它将监听任何变化，如果发生任何变化，就调用<code class="fe lv lw lx ly b">handleLocalizationChange()</code>。</p><p id="deea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">handleLocalizationChange()</code>方法触发<code class="fe lv lw lx ly b">setI18nConfig()</code>和<code class="fe lv lw lx ly b">forceUpdate()</code>。这对于Android设备来说是必要的，因为组件需要重新渲染才能看到变化。</p><p id="fb84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将删除<code class="fe lv lw lx ly b">componentWillUnmount()</code>生命周期方法中的监听器。</p><p id="b7e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在<code class="fe lv lw lx ly b">render()</code>中，我们将使用<code class="fe lv lw lx ly b">translate()</code>返回<code class="fe lv lw lx ly b">hello</code>，并将<code class="fe lv lw lx ly b">key</code>作为参数传递给它。然后，它会自动计算出语言和需要为该语言显示的文本。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="a26a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">运行应用程序</strong></h1><p id="2c1c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在是时候看看我们的翻译是否有效了。</p><p id="5075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过键入以下命令在模拟器或仿真器中运行您的应用程序:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="cb90" class="nw mh it ly b gy nx ny l nz oa">$ react-native run-ios<br/>$ react-native run-android</span></pre><p id="c42d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/232b5c563a909074475131ed57ce5dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*cCpM4lAUW__1ZWt2kAbvKA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">默认英语语言</p></figure><p id="7d49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，将设备语言设置更改为法语，然后再次打开应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/7fc55b1d86ae67b6b79c818fafd76174.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*jS5PO6xv6DMlLfzXXNMbHA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">法语你好</p></figure><p id="afff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样的，你可以把你的语言设置改成阿拉伯语，看到阿拉伯语的<code class="fe lv lw lx ly b">hello</code>。</p><p id="fe59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止一切顺利。</p><p id="2cf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我选择了一些随机的语言，而这些语言的翻译没有包含在应用程序中，会发生什么呢？会回落到什么语言？</p><p id="1aab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实证明，<code class="fe lv lw lx ly b">findBestLanguage</code>的目标是返回最佳翻译。因此，它会查看您的语言偏好设置，以确定备用语言。</p><p id="113a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你进入iOS模拟器中的<strong class="lb iu">语言&amp;区域</strong>设置，你可以看到语言的优先顺序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/801f05f61e9e27415188d4a3c8eff570.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Wsy3gMRJQrsOBpMNZZNlcw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">语言首选顺序设置</p></figure><p id="10d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果选择的语言不是首选语言，<code class="fe lv lw lx ly b">findBestAvailableLanguage</code>返回<code class="fe lv lw lx ly b">undefined</code>，因此保留的值将是您的<a class="ae ky" href="https://github.com/vikrantnegi/react-native-multi-language-app/blob/master/App.js#L25" rel="noopener ugc nofollow" target="_blank">后备</a>，因为您的翻译中没有用户首选的语言。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="f97a" class="nw mh it bd mi ob oc dn mm od oe dp mq li of og ms lm oh oi mu lq oj ok mw ol bi translated"><strong class="ak">奖金</strong></h2><p id="df88" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">react-native-localize</code>具有API，可以访问与批次本地化相关的设备常量。请务必查看<a class="ae ky" href="https://github.com/react-native-community/react-native-localize#api" rel="noopener ugc nofollow" target="_blank">文档</a>中提供的完整API。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="c19a" class="nw mh it bd mi ob oc dn mm od oe dp mq li of og ms lm oh oi mu lq oj ok mw ol bi translated"><strong class="ak">结论</strong></h2><p id="bf9d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">添加多语言支持就是这么简单。您现在可以使用<code class="fe lv lw lx ly b">react-native-localize</code>在您的应用中轻松提供多语言支持，这有助于提高用户的应用使用率。</p><p id="4880" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nr">在Github repo中找到源代码</em> <a class="ae ky" href="https://github.com/vikrantnegi/react-native-multi-language-app" rel="noopener ugc nofollow" target="_blank"> <em class="nr">这里</em> </a> <em class="nr">。</em></p></div></div>    
</body>
</html>