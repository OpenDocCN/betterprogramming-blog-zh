<html>
<head>
<title>AWS Serverless App: Continuous Integration and Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS无服务器应用程序:持续集成和部署</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/aws-serverless-app-continuous-integration-and-deployment-cb6f19474b3c?source=collection_archive---------8-----------------------#2019-07-01">https://betterprogramming.pub/aws-serverless-app-continuous-integration-and-deployment-cb6f19474b3c?source=collection_archive---------8-----------------------#2019-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3999" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">AWS无服务器应用系列的第2部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1fc256576743f046a1eb2ea1ee0aa382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nePpv2BPf92cMDLhlMU5kw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@matthewhenry?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马太·亨利</a>在<a class="ae kv" href="https://unsplash.com/s/photos/architecture?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="735a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几种方法可以将最新的代码库上传到您的测试和生产服务器上。手动复制它们是很好的，但是让一些人来负责运行测试和部署代码将会节省您的团队大量的人力。</p><p id="0398" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也将减少人为错误的机会。本文涵盖了一些步骤，您可以采取这些步骤将持续集成和部署(CI/CD)添加到在AWS无服务器应用程序的<a class="ae kv" href="https://medium.com/@edyvision/aws-serverless-app-where-to-start-11268309a1cf" rel="noopener">第1部分中创建的无服务器项目中，但是这些操作可以应用于任何无服务器项目。关于在AWS上构建无服务器API的更多细节，请查看作者的书<em class="ls">在AWS上构建无服务器Node.js应用</em>。</a></p><div class="lt lu gp gr lv lw"><a href="https://www.amazon.com/Building-Serverless-Node-js-Apps-AWS-ebook/dp/B08RN4WKFD/ref=sr_1_1?dchild=1&amp;keywords=eidan+rosado&amp;qid=1610222811&amp;sr=8-1" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd ir gy z fp mb fr fs mc fu fw ip bi translated">在AWS上构建无服务器Node.js应用程序:从哪里开始的简要指南</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">购买在AWS上构建无服务器Node.js应用程序:从哪里开始的简要指南:阅读Kindle商店评论-Amazon.com</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">www.amazon.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk kp lw"/></div></div></a></div></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="8678" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎来到AWS无服务器应用程序教程集的第2部分。到目前为止，您应该已经有了一个一直在使用的无服务器项目。如果没有，可以随意派生或克隆教程的<a class="ae kv" href="https://medium.com/better-programming/aws-serverless-app-where-to-start-11268309a1cf" rel="noopener">第1部分的</a><a class="ae kv" href="https://github.com/EdyVision/drug-search-service" rel="noopener ugc nofollow" target="_blank"> GitHub </a>中的示例药物搜索项目。</p><p id="5acb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将把我们的项目与Travis CI和Codeship连接起来，让您了解两者是如何工作的。请随意选择最适合你的方式。如果你的项目是开源项目，<a class="ae kv" href="https://travis-ci.org/" rel="noopener ugc nofollow" target="_blank"> Travis CI </a>和<a class="ae kv" href="https://circleci.com/" rel="noopener ugc nofollow" target="_blank"> CircleCI </a>都提供免费构建。</p><p id="c4a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将添加以下内容:</p><ul class=""><li id="ceb3" class="ms mt iq ky b kz la lc ld lf mu lj mv ln mw lr mx my mz na bi translated">带ESLint的棉绒配置</li><li id="094d" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">测试基础文件(还没有测试)</li><li id="4bbd" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">Travis CI配置文件</li><li id="04cc" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">代码发布的配置步骤</li></ul><h2 id="2603" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated"><strong class="ak">设置</strong></h2><p id="579a" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">首先，在您喜欢的CI/CD服务提供商处创建您的帐户，并将其绑定到您的GitHub帐户。该帐户将需要访问您的存储库。您可以默认允许所有人访问，也可以单独添加他们(建议减少潜在费用)。</p><p id="9888" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在GitHub中已经有了一个无服务器项目，那就继续添加吧。如果您克隆了同一个药物搜索项目，那么您需要将它添加到CI/CD服务的存储库列表中。我们会马上添加其余的。</p><p id="319b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了执行部署，您还需要一个AWS服务帐户或用户帐户。</p><h2 id="212c" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated"><strong class="ak">让CI/CD发挥作用</strong></h2><p id="d6c3" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">有几种方法可以让您的团队利用CI/CD——一种是在合并之前验证特性分支。</p><p id="d303" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当开发人员发布他们的更改时，您可以配置您的CI/CD构建，用linter验证代码格式，运行单元测试，并检查其启动能力。在您的无服务器应用程序的情况下，最后两个是在部署之前知道特性构建是否会破坏您的主分支和活动资源的决定性方法。</p><p id="8259" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在合并到主分支或主要分支时，服务可以通过linter运行并再次执行单元测试，但是您也可以让您的服务部署到您的项目，无论它在哪里托管(在我们的例子中是AWS)。</p><h2 id="82a4" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated"><strong class="ak">设置代码船</strong></h2><p id="3657" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">进入您的项目设置，在Tests选项卡中，更新您的设置命令以包括以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/e0468016cd40bb5f2282cc3c470a1c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eeZ74X9hHbvwImF7BWIjKg.png"/></div></div></figure><p id="9b30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将全局安装serverless来执行您的测试并允许部署。它还将安装项目的依赖项。</p><p id="b4ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，将<code class="fe of og oh oi b">npm test</code>添加到测试配置框中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/96174b12acd921776c3a1e73fad2e61d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MnV-126uCW9BOErmi6bcw.png"/></div></div></figure><p id="c2b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还记得我们在第1部分中创建的服务或用户帐户吗？如果你还没有创建一个，现在就是时候了。</p><p id="b3da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建之后，获取生成的AWS访问密钥和密码，并将它们添加到环境变量部分:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/43a3bad07298bcc9e57302380be77251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OlYWWYlH0YKedXZMqsvgaQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是在脚本中部署和使用AWS服务所必需的</p></figure><p id="12df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来我们将设置linter并测试基础文件。如果您不打算设置Travis，您可以跳过下一部分。</p><h2 id="cf20" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated"><strong class="ak">设置Travis CI </strong></h2><p id="c5ab" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">首先，为存储库启用Travis。进入你的仪表板，点击加号。它将提供搜索栏。</p><p id="f606" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开始搜索项目，并打开项目开关:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/7d5fe027281b01712fd02dcb1f172903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCIeEqNSzoJsTu5Ouym7MA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">切换开关以启用存储库</p></figure><p id="53fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击settings按钮提供您需要的任何定制，比如您的AWS访问和用于部署和AWS服务使用的密钥。</p><p id="9d33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将它们放在环境变量部分，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/16d5a126a8a35dbb4aeb9f2503201d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6aY21OKHuArqnU7rE-Fqw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Travis CI允许您在构建日志中显示，但不建议这样做</p></figure><p id="7def" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后将以下内容添加到项目根目录下的<code class="fe of og oh oi b">.travis.yml</code>文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="87d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要脱机运行无服务器测试，甚至执行部署，您将需要无服务器。为了安装运行测试所需的依赖项，您需要做一个<code class="fe of og oh oi b">npm install</code>。<code class="fe of og oh oi b">npm test</code>将运行您的linter和单元测试，我们将在接下来的部分中设置。</p><p id="63d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，部署阶段有一个条件，即它是否是主分支(对于PRs，它会自动这样设置)以及它是否是PR。我们不希望它在公关期间尝试部署，只是运行测试。它应该只将合并部署到主分支中。</p><h2 id="2343" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated">设置棉绒机</h2><p id="ae6f" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">我们还没有测试，但是我们可以用我们的<code class="fe of og oh oi b">npm test</code>命令很快地连接一个linter来执行。使用以下终端命令安装ESLint依赖项:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/89ae47457e2659fbdc19847d51049b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4V8g7LwKr1qfpXzKFEuZXg.png"/></div></div></figure><p id="4326" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将需要一个ESLint配置。你可以在GitHub中找到大量的例子。</p><p id="3a3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我在药物搜索项目中使用的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="5bcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还需要更新您的<code class="fe of og oh oi b">package.json</code>脚本列表，如下所示:</p><pre class="kg kh ki kj gt oq oi or os aw ot bi"><span id="27d2" class="ng nh iq oi b gy ou ov l ow ox">"scripts": {</span><span id="4939" class="ng nh iq oi b gy oy ov l ow ox">   "start": "sls offline --noAuth",</span><span id="7866" class="ng nh iq oi b gy oy ov l ow ox">   "test": "NODE_ENV=test PORT=9100 ./node_modules/.bin/nyc ./node_modules/.bin/mocha --opts mocha.opts",</span><span id="860b" class="ng nh iq oi b gy oy ov l ow ox">   "offline": "sls offline start",</span><span id="3150" class="ng nh iq oi b gy oy ov l ow ox">   "precommit": "eslint .",</span><span id="0115" class="ng nh iq oi b gy oy ov l ow ox">   "pretest": "eslint --ignore-path .gitignore ."</span><span id="23ca" class="ng nh iq oi b gy oy ov l ow ox">},</span></pre><p id="aea4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的本地机器上，运行以下命令来启动linter:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/c72ad6857ed4a1276e9580407c64f595.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*JStQHeed9WljrvHAB5wP-Q.png"/></div></figure><p id="7726" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可能会发现自己犯了一些林挺错误，也可能不会——我知道我犯了。为了让您的构建成功，您需要修复用红色标记的林挺问题(也称为错误),或者根据需要修改ESLint配置以将错误减少到零。</p><h2 id="7924" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated">设置测试</h2><p id="8772" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">正如您可能已经注意到的，测试命令还依赖于用于确定测试覆盖的NYC模块，并且测试命令使用了我们没有的<code class="fe of og oh oi b">mocha.opts</code>。</p><p id="2631" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为代码覆盖率安装NYC:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/90a5fe8cc05a33bd862a7ef85f841d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*hS7LjpSOd8a33kY5tgif2w.png"/></div></figure><p id="f46b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要在项目目录的根目录下创建一个<code class="fe of og oh oi b">mocha.opts</code>文件，如下所示:</p><pre class="kg kh ki kj gt oq oi or os aw ot bi"><span id="7a0b" class="ng nh iq oi b gy ou ov l ow ox">--timeout 5000<br/>--reporter list<br/>--ui bdd<br/>--exit<br/>test/bootstrap.test.js<br/>test/**/*.test.js<br/>test/**/**/*.test.js</span></pre><p id="1fb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在当你运行<code class="fe of og oh oi b">npm test</code>时，它会尝试给你代码覆盖率，但也会遇到一个失败消息。让我们在测试目录中添加一些支持文件。</p><p id="88d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe of og oh oi b">test</code>目录的根目录下，添加以下<code class="fe of og oh oi b">bootstrap.test.js</code>文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="3727" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe of og oh oi b">test</code>目录中创建一个名为<code class="fe of og oh oi b">support</code>的新目录。</p><p id="0f84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加一个名为<code class="fe of og oh oi b">slsOfflineTestConfig.js</code>的文件，并将以下函数放入其中:</p><pre class="kg kh ki kj gt oq oi or os aw ot bi"><span id="17d3" class="ng nh iq oi b gy ou ov l ow ox">module.exports.getSlsOfflinePort = () =&gt; {</span><span id="6108" class="ng nh iq oi b gy oy ov l ow ox">   return process.env.PORT || '3005';</span><span id="19a8" class="ng nh iq oi b gy oy ov l ow ox">};</span></pre><p id="d6d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，当您运行<code class="fe of og oh oi b">npm test</code> <strong class="ky ir"> </strong>命令时，输出应该如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/9dbdaf8d4da5f4f9c26fab513eeb3e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TBlJmfBzusYRzRDrkyEgw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这里应该不会显示任何错误，目前只有0个通过和0个覆盖率</p></figure><p id="ec20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">呀！看起来是时候写一些测试了。我们将在下一篇文章中讨论这个问题。</p><h2 id="48c1" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated"><strong class="ak">触发构建</strong></h2><p id="7cfa" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">有了所有最新的更改和linter修复，您现在有相当多的更改需要推进。如果这还不在一个特性分支上，那么继续做一个<code class="fe of og oh oi b">git checkout -b branchName</code>，提交你的修改，并把它们上传到GitHub。Codeship，Travis，或者你正在使用的任何东西都将被触发，并尝试构建。</p><p id="4062" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>如果您在尝试上推之前没有设置Codeship或Travis来进行此回购，它可能不会按预期触发构建。</p><p id="81c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您创建了一个拉请求，您的页面将显示类似下图的构建状态:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/540401fe960dd40c70e5baa4d72ddd82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gxa1IZWLQW1bD7LrNeDWIw.png"/></div></div></figure><p id="f5b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是您的代码开始构建时的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/9931537f2379ddb215fbbd0de61733bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L2lDWYI6kWLvO6VI6hRg9w.png"/></div></div></figure><p id="60aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，在分支或PR构建期间，Travis CI将如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/437c4fa142c068a4bdd7a441edad4baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzcPPH8qtvgq5j76ZwM5sw.png"/></div></div></figure><h2 id="75a4" class="ng nh iq bd ni nj nk dn nl nm nn dp no lf np nq nr lj ns nt nu ln nv nw nx ny bi translated">配置部署步骤</h2><p id="81f1" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">您的项目正在报告一个成功的构建——耶！让我们再取消一个手动步骤。</p><p id="3c3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Travis CI配置已经定义了部署步骤，并将执行<code class="fe of og oh oi b">sls deploy -v</code>。这将把您的最新文件上传到您的AWS资源。您可以在此步骤中指定这将进行到哪个阶段。默认情况下，阶段是<code class="fe of og oh oi b">dev</code>，但也可以是<code class="fe of og oh oi b">test</code>、<code class="fe of og oh oi b">prod</code>等。</p><p id="acf4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于Codeship，选择Deploy选项卡，并创建部署管道:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/afa70a0cfef699d5092f36e6e2196f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6z4BuNxmInwdCR_G6uiUg.png"/></div></div></figure><p id="909a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分支可以完全匹配，也可以给定一个模式(如果您的团队发布标签，这很方便)。现在从Add Deployment部分选择脚本。您需要输入以下信息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/52d823cdaaac9fb0389eaaf61d245691.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*uYfsDIXWkG-y_vkLUaU5SA.png"/></div></figure><p id="63d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你就完了。如果您合并您的拉请求，它将立即触发最终的构建和部署。在您从任一服务提供商处收到成功电子邮件后，您的资源应该会自动可用。</p><p id="a03d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有gists和整个药物搜索项目库都可以在<a class="ae kv" href="https://github.com/EdyVision/drug-search-service" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上公开获得。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="a942" class="ph nh iq bd ni pi pj pk nl pl pm pn no jw po jx nr jz pp ka nu kc pq kd nx pr bi translated">下一步是什么</h1><p id="0b25" class="pw-post-body-paragraph kw kx iq ky b kz nz jr lb lc oa ju le lf ob lh li lj oc ll lm ln od lp lq lr ij bi translated">这就是了。您的项目现在应该使用预期的触发器进行构建和部署。想想这会为你或你的团队节省多少时间。就我个人而言，在开始时我无法在CI/CD服务提供商之间做出选择，最终我经历了Travis和Codeship的步骤，以了解他们如何与我的项目一起工作。</p><p id="5365" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在下一篇文章“AWS无服务器应用:测试”中探索测试和调试</p><p id="0783" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>