<html>
<head>
<title>Build and Deploy a Jekyll Website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建和部署Jekyll网站</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-static-website-with-jekyll-and-automatically-deploy-it-to-aws-s3-using-circle-ci-26c1b266e91f?source=collection_archive---------6-----------------------#2019-10-04">https://betterprogramming.pub/build-a-static-website-with-jekyll-and-automatically-deploy-it-to-aws-s3-using-circle-ci-26c1b266e91f?source=collection_archive---------6-----------------------#2019-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fe75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Jekyll创建一个静态网站，并使用CircleCI将其自动部署到AWS S3</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/93c1bf17db860828c31e4809157c8057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCg7Q5VkuWdJGSdmn0G-PQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">扎克·赖纳在<a class="ae ky" href="https://unsplash.com/s/photos/jekyll?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="c24e" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">概观</h1><p id="4db2" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在这篇文章中，我将解释使用Jekyll构建我的网站所使用的高级架构，并使用<a class="ae ky" href="https://circleci.com/" rel="noopener ugc nofollow" target="_blank"> CircleCI </a>到<a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> AWS S3 </a>自动部署它。</p><p id="ba0e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">除了存储图像或文件，S3还可以托管由HTML、CSS和JavaScript组成的静态网站。</p><p id="5297" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">亚马逊在S3为您提供5GB的免费存储层，这意味着托管该解决方案没有任何成本。如果你想让你的网站使用一个特定的URL，你只需要为Route 53域名付费。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="1d8a" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">吉基尔博士</h1><p id="ea5a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">Jekyll是一个简单的、支持博客的静态站点生成器，非常适合个人、项目或组织站点。可以把它想象成一个基于文件的CMS，没有所有的复杂性。</p><p id="101e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Jekyll获取你的内容，渲染markdown和liquid模板，然后吐出一个完整的静态网站。Jekyll是GitHub页面背后的引擎，您可以使用它来托管来自GitHub存储库的站点。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a51b" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">切尔莱西</h1><blockquote class="mz na nb"><p id="b085" class="ly lz nc ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">“CircleCI的持续集成和交付平台通过自动化构建、测试和部署流程，帮助软件团队自信地快速发布代码。</p><p id="2928" class="ly lz nc ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">CircleCI提供了一个平台，让团队快速发展，轻松扩展，并每天自信地构建。”——<em class="it">出自</em><a class="ae ky" href="https://circleci.com/about/" rel="noopener ugc nofollow" target="_blank"><em class="it">https://circleci.com/about/</em></a></p></blockquote></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="52c8" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">高层视图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/e6873f8ea44a51415dfa757f6dc34d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*i8pVTWD2tdykt5QM.png"/></div></div></figure><p id="52e6" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Jekyll用于构建网站和生成静态内容。Git用于将代码提交给GitHub(如果您不知道Git和GitHub之间的区别，请查看未来关于这方面的帖子)。</p><p id="0109" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">GitHub向CircleCI发送一个请求(web hook ), circle ci将提取代码、构建、运行测试，并部署到AWS S3登台环境。一旦代码经过测试和验证，CircleCI上的手动批准就会开始构建过程，并将其部署到生产环境中。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="5ee0" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">入门指南</h1><p id="31d7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">让我们开始吧。首先安装<a class="ae ky" href="https://jekyllrb.com/" rel="noopener ugc nofollow" target="_blank">杰基尔</a>，你需要<a class="ae ky" href="https://www.ruby-lang.org/en/" rel="noopener ugc nofollow" target="_blank">红宝石</a>来安装宝石。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="d15c" class="nm lh it ni b gy nn no l np nq">$ gem install bundler jekyll</span></pre><p id="cd21" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">创建新网站:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="c35e" class="nm lh it ni b gy nn no l np nq">$ jekyll new my-awesome-site <br/>$ cd my-awesome-site</span></pre><p id="1a10" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Jekyll将创建一个基本的网站结构。</p><p id="bc0b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">构建网站并使其在本地服务器上可用:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="6a65" class="nm lh it ni b gy nn no l np nq">$ bundle exec jekyll serve</span></pre><p id="9309" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">本地网址:<a class="ae ky" href="http://localhost:4000" rel="noopener ugc nofollow" target="_blank">本地主机:4000 </a>。</p><p id="5d50" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">第一部分完成了！哲基尔跑了！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="caca" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">暂存和生产存储桶</h1><p id="cf6f" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">现在，我们将为暂存和生产存储区设置带有web主机的S3文件夹。</p><ul class=""><li id="8a16" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">登录您的AWS帐户，如果您没有帐户，请创建一个新帐户。如果您使用免费服务，将不会被收费。点击了解有关免费层<a class="ae ky" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></li><li id="f493" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">点击S3 -&gt; <em class="nc">创建桶</em>。</li><li id="0a58" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">为您的存储桶指定一个唯一的名称，并在末尾添加<code class="fe of og oh ni b">-staging</code>:【唯一名称】-staging。</li><li id="2e1b" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">选择离您最近的<em class="nc">区域</em>并点击<em class="nc">创建</em>。</li><li id="b7ff" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">点击你新创建的文件夹-&gt;选择<em class="nc">属性</em>和<em class="nc">启用静态</em>网站托管。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/589ef259e469188eae687e0e170c7ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IDyWo-kGKFTdLpa0.png"/></div></div></figure><ul class=""><li id="c9aa" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">选择<em class="nc">权限</em>、<em class="nc">公共权限设置</em>、<em class="nc">编辑</em>，取消勾选所有复选框<em class="nc">并保存</em>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/6db4b1628544e8680e931119af239e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2dNqM93w0jngAqBr.png"/></div></div></figure><ul class=""><li id="53cb" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">选择<em class="nc">存储桶策略</em>并包含以下策略以允许<code class="fe of og oh ni b">GetObject</code>。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="05ad" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">重复上面的过程，创建一个新的bucket，在最后添加<code class="fe of og oh ni b">-production</code>:【唯一名称】——production。</li><li id="39f8" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">现在让我们测试这些桶:TK</li><li id="a973" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">创建一个简单的<code class="fe of og oh ni b">index.html</code>并上传到两个S3存储桶。</li></ul><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="e439" class="nm lh it ni b gy nn no l np nq">&lt;p&gt;Hello World&lt;/p&gt;</span></pre><p id="921d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，我们将创建CloudFront发行版。Amazon CloudFront是一种快速内容交付网络(CDN)服务，它在一个对开发人员友好的环境中，以低延迟、高传输速度向全球客户安全地交付数据、视频、应用程序和API。</p><ul class=""><li id="5662" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">从AWS仪表板中，选择<em class="nc"> CloudFront </em>。</li><li id="5503" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">点击web选项下的<em class="nc">创建发行版</em>和<em class="nc">开始</em>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/7886f846b2fd752d4d885c7357774887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OvhQMxyEHqtswp-H.png"/></div></div></figure><ul class=""><li id="2edf" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">在<em class="nc">源域名</em>选项中，选择您之前创建的S3暂存桶，并点击<em class="nc">创建分发。</em></li><li id="4567" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">从CloudFront发行版列表中，单击您新创建的发行版。复制<em class="nc">域名</em> <code class="fe of og oh ni b">XXXXX.cloudfront.net</code>并粘贴到新的浏览器标签页中。您应该会看到您的HTML页面。</li><li id="f660" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated">重复这个过程，并创建您的生产分布</li></ul><p id="c846" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">恭喜你！</p><p id="33f2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">桶已创建！</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="3d19" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">贮藏室ˌ仓库</h1><p id="ee64" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">源代码将存储在<a class="ae ky" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。为了向GiHub提交代码，我们将使用<a class="ae ky" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank"> Git </a></p><h2 id="a60d" class="nm lh it bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated">下载并安装Git</h2><p id="606a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">登录您的GitHub帐户，如果您没有，请创建一个新帐户。如果你的库是公开的，GitHub不会向你收费。创建一个名字很棒的新存储库。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/c4de635711695455e0d386126b434904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-qt1_UQAy80C7NVc.png"/></div></div></figure><p id="bfe4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">复制新创建的GitHub存储库的地址。</p><p id="138e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">初始化你的Jekyll文件夹。</p><ul class=""><li id="88af" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">前往您的网站文件夹:</li></ul><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="1a6f" class="nm lh it ni b gy nn no l np nq">$ cd my-awesome-site</span></pre><ul class=""><li id="86f3" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">运行以下命令初始化Git文件夹:</li></ul><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="49aa" class="nm lh it ni b gy nn no l np nq">$ git init <br/>$ git remote add origin git@github.com:your github repository</span></pre><p id="9274" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在你的网站根目录下创建一个名为<code class="fe of og oh ni b">.gitignore</code>的新文件。这个文件将指示Git忽略某些不会被推送到存储库的文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><ul class=""><li id="c7e6" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated">将您的代码添加、提交并推送到存储库:</li></ul><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f906" class="nm lh it ni b gy nn no l np nq">$ git add .<br/>$ git commit -m "description"<br/>$ git push -u origin master</span></pre><p id="21bc" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您可能需要在此阶段输入您的密码。</p><p id="a8bf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">转到您的GitHub库，您应该会看到文件列表。现在，我们准备创建一个连续的部署过程。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="900e" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">部署</h1><p id="bebe" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">部署过程通过CircleCI运行。</p><p id="576f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">当<em class="nc"> develop </em>分支与<em class="nc"> master </em>合并时，它会自动提示CircleCI中的一个工作流来构建网站并将其部署到【staging URL】。</p><p id="2aa9" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">一旦您测试了更改(在移动和桌面上，以及所有浏览器上，包括IE11)，单击工作流中的<code class="fe of og oh ni b">confirm_deploy</code>按钮，部署将开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/3e0bea99f29f60d50cc07bdff2146a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l9dZy-Q-DYNE4jB9.png"/></div></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="be9c" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">CircleCI本地配置</h1><p id="ecbe" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">CircleCI配置存储在位于<code class="fe of og oh ni b">~/.circleci/config.yml</code>的单个YAML文件中，其中<code class="fe of og oh ni b">~</code>是项目目录的根目录。</p><p id="5140" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">由于使用CircleCI的大部分工作都发生在该文件中，因此了解YAML格式的基础知识非常重要。YAML是所有编程语言的人性化数据序列化标准。</p><p id="0092" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">它是另一种数据序列化语言JSON的严格超集。这意味着它能做JSON能做的一切…甚至更多。</p><p id="b2a2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们将在<code class="fe of og oh ni b">config.yml</code>配置四项工作:</p><h2 id="595a" class="nm lh it bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated"><strong class="ak">构建</strong></h2><ol class=""><li id="3a5d" class="nr ns it ma b mb mc me mf mh oz ml pa mp pb mt pc nx ny nz bi translated">检查代码。</li><li id="3dc2" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">安装Jekyll。</li><li id="bc33" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">建立网站。</li><li id="095c" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">坚持到<code class="fe of og oh ni b">_site</code>文件夹。</li></ol><h2 id="b38a" class="nm lh it bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated"><strong class="ak">部署_暂存</strong></h2><ol class=""><li id="6ee9" class="nr ns it ma b mb mc me mf mh oz ml pa mp pb mt pc nx ny nz bi translated">安装AWS CLI。</li><li id="8478" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">添加AWS凭据。</li><li id="b617" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">部署到S3集结地。</li><li id="13bb" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">清除CloudFront临时缓存。</li></ol><h2 id="d5a1" class="nm lh it bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated"><strong class="ak">确认_部署</strong></h2><ol class=""><li id="d144" class="nr ns it ma b mb mc me mf mh oz ml pa mp pb mt pc nx ny nz bi translated">在试运行环境中测试后手动批准。</li></ol><h2 id="0f22" class="nm lh it bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated"><strong class="ak">部署_生产</strong></h2><ol class=""><li id="1ebd" class="nr ns it ma b mb mc me mf mh oz ml pa mp pb mt pc nx ny nz bi translated">安装AWS CLI。</li><li id="100c" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">添加AWS凭据。</li><li id="cddf" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">部署到S3生产。</li><li id="0a7e" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt pc nx ny nz bi translated">清除CloudFront生产缓存。</li></ol><p id="c4cf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">创建文件<code class="fe of og oh ni b">config.ym</code> l，复制下面的内容并保存在<code class="fe of og oh ni b">~/.circleci/</code>文件夹中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="7244" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">用第一篇文章中创建的bucket和CloudFront IDs替换<code class="fe of og oh ni b">YOUR BUCKET</code>和<code class="fe of og oh ni b">YOUR CLOUDFRONT ID</code>。</p><p id="6bad" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">你可以在CircleCI网站上找到大量的文档。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="7fb1" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">部署</h1><p id="8a25" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">部署过程通过CircleCI运行。</p><p id="cf2f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">当<em class="nc"> develop </em>分支与<em class="nc"> master </em>合并时，它会自动提示CircleCI中的一个工作流来构建网站并将其部署到【staging URL】。</p><p id="74c1" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">一旦您测试了更改(在移动和桌面上，以及所有浏览器上，包括IE11)，单击工作流中的<code class="fe of og oh ni b">confirm_deploy</code>按钮，部署将开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/fc2d977a6de08c8ce44dbd3748ad0165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RRj7wjCCcdfAGWkz.png"/></div></div></figure><p id="97c5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">登录<a class="ae ky" href="https://circleci.com/docs/2.0/" rel="noopener ugc nofollow" target="_blank"> CircleCI </a>仪表盘或使用您的GitHub帐户创建一个新帐户。这将整合CircleCI和GitHub。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/3eb9b6f7681ce9f3f5e424afe447187c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o4SFCld9aAgz7gZM.png"/></div></div></figure><p id="abca" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">点击<em class="nc">添加项目</em>，然后<em class="nc">跟随项目。</em></p><p id="c0ff" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">保持操作系统为Linux，选择<em class="nc"> Ruby </em>作为语言，点击<em class="nc">开始构建</em>。这将开始构建过程，但它将失败，因为我们还没有包括我们的AWS变量。</p><p id="1466" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">登录AWS控制台，进入<em class="nc"> IAM </em>(身份和访问管理)。AWS身份和访问管理(IAM)使您能够安全地管理对AWS服务和资源的访问。</p><p id="749c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">使用IAM，您可以创建和管理AWS用户和组，并使用权限来允许和拒绝他们对AWS资源的访问。</p><p id="7946" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">让我们创建一个新用户，使用严格的策略将内容上传到S3并清空CloudFront缓存。</p><p id="a247" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">选择<em class="nc">添加用户</em>并授予其编程访问权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/016c71756e964f0a1517a04c4092643a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9uH_exVEmQNQjvZ5.png"/></div></div></figure><p id="a88c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">点击<em class="nc">下一步</em>，然后选择<em class="nc">直接附加已有策略</em>，选择<em class="nc"> CloudFrontFullAccess </em>选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/cedd32b98bdd13cdddadcc2e08d23e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XEJlyHZz7eWbi9FR.png"/></div></div></figure><p id="2379" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">点击<em class="nc">下一步</em>，插入您想要的任何标签，然后再次点击<em class="nc">下一步</em>。查看您的项目并点击<em class="nc">创建用户。</em></p><p id="e83b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu">现在非常重要:</strong>下载您的CSV凭证(您的访问密钥ID和秘密访问密钥)或将其记在某个安全的地方。</p><p id="dd9e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，选择您的用户并点击<em class="nc">添加内嵌策略</em>。选择<em class="nc"> JSON选项卡</em>，并将以下内容复制到您的策略中。用上面创建的存储桶替换存储桶的名称。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="9933" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这将允许该用户仅向策略中列出的特定存储桶添加对象。为策略提供一个名称，并点击<em class="nc">创建策略。</em></p><p id="3dd3" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">恭喜你！您已经创建了您的IAM用户。</p><p id="bf37" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，让我们回到CircleCI并添加AWS键。登录CircleCI仪表盘，点击<em class="nc">工作流程</em>，然后齿轮高亮显示如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/d6fa52594b7406e80260667cea8e6e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/0*SXBRZo35X6A_lFIg.png"/></div></figure><p id="b55f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">选择<em class="nc">环境变量</em>选项并添加两个变量:</p><ul class=""><li id="f9cb" class="nr ns it ma b mb mu me mv mh nt ml nu mp nv mt nw nx ny nz bi translated"><code class="fe of og oh ni b">AWS_ACCESS_KEY_ID</code>，以及</li><li id="163e" class="nr ns it ma b mb oa me ob mh oc ml od mp oe mt nw nx ny nz bi translated"><code class="fe of og oh ni b">AWS_SECRET_ACCESS_KEY</code>用来自用户凭证的值。</li></ul><p id="a8d7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，我们将在网站中提交一些更改，这将自动触发CircleCI构建并将其部署到AWS中。使用以下命令对代码进行任何更改并提交:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="060d" class="nm lh it ni b gy nn no l np nq">$ git add .<br/>$ git commit -m "description"<br/>$ git push</span></pre><p id="d38e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您可能需要在此阶段输入您的密码。</p><p id="9ef7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">重新登录CircleCI，点击<em class="nc">工作流</em>，您应该会看到您的任务正在运行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/9b04d95668dcdc4450d00da156742028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-Pnqz9iBkq3XlV9d.png"/></div></div></figure><p id="f0e3" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">单击任务，它将扩展到您的工作流项目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/ddc51f8597c5c37996607e5897055327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3_zXI9uXZMqPD7Ua.png"/></div></div></figure><p id="7365" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">点击工作，它会详细说明步骤。工作流将在<em class="nc"> confirm_deploy停止。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/a6b643349ad7fa2b109d82b588ed9511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9ocsBEIRWmFmVTRX.png"/></div></div></figure><p id="5da7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，转到您的CloudFront staging URL，您将看到您部署的网站。如果一切正常，点击<em class="nc">确认_部署</em>批准部署。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/c4b516725da87db712c7113492ab595b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_EvPEMkjXZ89IInW.png"/></div></div></figure><p id="5ccb" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这将继续该过程，并将其部署到生产环境中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/6487536f938b108ad616e000a6935a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S21D6f5Pi6wgupx4.png"/></div></div></figure><p id="5068" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在可以重复这个过程，每次提交都会触发构建并部署到登台环境。</p></div></div>    
</body>
</html>