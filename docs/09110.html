<html>
<head>
<title>Python Data Class—A Shorthand for Writing Classes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python数据类——编写类的简写</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/python-data-classes-196496c32d75?source=collection_archive---------11-----------------------#2021-07-15">https://betterprogramming.pub/python-data-classes-196496c32d75?source=collection_archive---------11-----------------------#2021-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d5c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用数据类来删除__init__()、__repr__()、以及其他样板代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2d749f0ee9d8758c940aeab1ff64c0f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OLOp0zED6guwtmzS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@martinshreder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马丁·施瑞德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="fe41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python数据类是<a class="ae ky" href="https://www.codingem.com/what-is-a-python-class/" rel="noopener ugc nofollow" target="_blank">类</a>的特殊类型。它允许您停止编写与类相关的重复性样板代码。比如可以去掉<code class="fe lv lw lx ly b">__init__()</code>方法。</p><p id="4f70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建一个数据类，在类定义前面添加一个<code class="fe lv lw lx ly b">@dataclass</code>装饰器，并为类属性提供类型信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="d478" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以通过以下方式创建对象:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="de64" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)</span></pre><p id="08c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们通过首先使用一个类，然后用一个数据类简化它，来看看数据类解决了什么问题。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="2bc1" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">初始化</h1><h2 id="1a5b" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="c994" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">创建Python对象时，您希望使用用户定义的值对其进行初始化。</p><p id="669e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中，有一个为<a class="ae ky" href="https://www.codingem.com/what-is-a-python-class/" rel="noopener ugc nofollow" target="_blank">类</a>预留的<code class="fe lv lw lx ly b">__init__()</code>方法<strong class="lb iu"> </strong>。它被称为构造函数方法，可以用来初始化一个对象。当您创建新对象时，会自动执行此方法。</p><p id="0ad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们创建一个带有初始化器的<code class="fe lv lw lx ly b">Fruit</code>类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="e979" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以像这样创建水果对象:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="7328" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.2)<br/>print(banana.color)</span></pre><p id="aeb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="527c" class="mf mg it ly b gy mh mi l mj mk">Yellow</span></pre><p id="ffad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你如何在Python中创建了类。让我们看看数据类能为你做什么。</p><h2 id="e4e0" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="d079" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">Python 3.7引入了数据类来简化类的创建。</p><p id="6718" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以使用数据类来摆脱您的<code class="fe lv lw lx ly b">__init__()</code>方法。</p><p id="7d79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示，让我们使用一个数据类来实现上面的<code class="fe lv lw lx ly b">Fruit</code>类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="1fc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查一下代码:</p><ul class=""><li id="e076" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">首先，从<code class="fe lv lw lx ly b">dataclasses</code>库中导入<code class="fe lv lw lx ly b">dataclass</code>。</li><li id="ffc7" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">然后<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/understand-python-decorators-in-3-minutes-ec48fdc8e2cf">用一个<code class="fe lv lw lx ly b"><strong class="lb iu">@</strong>dataclass</code>装饰器装饰</a>这个<code class="fe lv lw lx ly b">Fruit</code>类。这就把类变成了数据类。</li><li id="2ee5" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">最后，不需要实现<code class="fe lv lw lx ly b">__init__()</code>方法，只需用类型信息将属性添加到类中。</li></ul><p id="4c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您可以测试这个数据类:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="1a61" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>print(banana.color)</span></pre><p id="fcba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="3c99" class="mf mg it ly b gy mh mi l mj mk">Yellow</span></pre><p id="ba61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它的工作原理和<code class="fe lv lw lx ly b">Fruit</code>的班级版一模一样。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="85c8" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">表示字符串</h1><p id="42fa" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">在Python中，<code class="fe lv lw lx ly b">repr()</code>函数返回一个对象的字符串表示。它通过调用该类的<code class="fe lv lw lx ly b">__repr__()</code>方法来实现这一点。您可以重写此方法，根据需要自定义字符串表示形式。</p><h2 id="10c2" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="5dff" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">让我们再次使用我们的<code class="fe lv lw lx ly b">Fruit</code>类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="1c3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个<code class="fe lv lw lx ly b">Fruit</code>对象，并在其上调用<code class="fe lv lw lx ly b">repr()</code>。因为您还没有提供对<code class="fe lv lw lx ly b">__repr__()</code>方法的实现，所以一个默认版本被称为:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="95b9" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>print(repr(banana))</span></pre><p id="fe94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="3e88" class="mf mg it ly b gy mh mi l mj mk">&lt;__main__.Fruit object at 0x7f4b20f01d00&gt;</span></pre><p id="6cc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这不是人类可读的。</p><p id="9497" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过覆盖<code class="fe lv lw lx ly b">__repr__()</code>方法，用一个人类友好的版本替换字符串表示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="09bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以再次调用<code class="fe lv lw lx ly b">Fruit</code>对象上的<code class="fe lv lw lx ly b">repr()</code>,以获得更易读的字符串表示:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="986d" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>print(repr(banana))</span></pre><p id="f7fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="e2a5" class="mf mg it ly b gy mh mi l mj mk">Fruit(name='Banana', color='Yellow', weight=0.1)</span></pre><p id="c1f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是你在课堂上的做法。现在让我们看看数据类如何处理字符串表示。</p><h2 id="3da1" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="b71d" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">一个数据类自动为您实现了<code class="fe lv lw lx ly b">__repr__()</code>的人性化版本。</p><p id="8ee1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们创建一个数据类，<code class="fe lv lw lx ly b">Fruit</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="248d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在对一个<code class="fe lv lw lx ly b">Fruit</code>对象调用<code class="fe lv lw lx ly b">repr()</code>:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="c398" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>print(repr(banana))</span></pre><p id="a7b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="e7a9" class="mf mg it ly b gy mh mi l mj mk">Fruit(name='Banana', color='Yellow', weight=0.1)</span></pre><p id="9aa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，结果是可读的。这为您节省了代码行，因为您不需要覆盖<code class="fe lv lw lx ly b">__repr__()</code>方法。</p><p id="2c11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不喜欢这种表示，也可以在数据类中覆盖它。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="34a1" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">两个物体相等吗？</h1><h2 id="f736" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="86f3" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">如果你想比较两个对象，你需要实现<code class="fe lv lw lx ly b">__eq__()</code>方法。如果要检查两个对象的属性是否相同，这很有用。</p><p id="8c62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们给<code class="fe lv lw lx ly b">Fruit</code>类添加一个<code class="fe lv lw lx ly b">__eq__()</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="284c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过创建两个具有相同属性的<code class="fe lv lw lx ly b">Fruit</code>对象来对此进行测试:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="2015" class="mf mg it ly b gy mh mi l mj mk">fruit1 = Fruit("Banana", "Yellow", 0.1)<br/>fruit2 = Fruit("Banana", "Yellow", 0.1)</span><span id="63f5" class="mf mg it ly b gy on mi l mj mk">print(fruit1 == fruit2)</span></pre><p id="b2c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="9c1f" class="mf mg it ly b gy mh mi l mj mk">True</span></pre><p id="2002" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想要在你的类中实现平等是很常见的。这就是数据类可以帮助您节省时间的地方。</p><h2 id="bf06" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="f3fc" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">数据类自动为您实现<code class="fe lv lw lx ly b">__eq__()</code>方法。</p><p id="9962" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用<code class="fe lv lw lx ly b">Fruit</code>的数据类版本来比较两个相同的<code class="fe lv lw lx ly b">Fruit</code>对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="e84b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="148d" class="mf mg it ly b gy mh mi l mj mk">True</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="5aa7" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">如何对对象进行排序和比较</h1><h2 id="ee25" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="1804" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">要比较两个对象，您需要实现比较方法。这些是:</p><ul class=""><li id="5dfd" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__lt__()</code> —小于</li><li id="1eb1" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__gt__()</code> —大于</li><li id="4992" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__eq__()</code> —等于</li><li id="f6fb" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__ne__()</code> —不相等</li><li id="720c" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__ge__()</code> —大于或等于</li><li id="7152" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b">__le__()</code> —小于或等于</li></ul><p id="70dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们可以通过重量来比较<code class="fe lv lw lx ly b">Fruit</code>对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="511c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来测试一下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="bf9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="8627" class="mf mg it ly b gy mh mi l mj mk">banana &lt; apple:  True<br/>banana &gt; apple:  False<br/>banana &lt;= apple:  True<br/>banana &gt;= apple:  False<br/>banana == apple:  False<br/>banana != apple:  True</span></pre><p id="da37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的，这需要大量的样板文件来完成，尽管这是一个非常基本的操作。</p><p id="c3f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，数据类可以帮助你。</p><h2 id="ae7b" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="3d67" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">比较数据类对象很方便——您不需要实现任何冗长的比较方法。</p><p id="bc3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要启用数据分类比较，请执行以下操作:</p><ul class=""><li id="89f9" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">将<code class="fe lv lw lx ly b"><strong class="lb iu">@</strong>dataclass</code>装饰器的参数<code class="fe lv lw lx ly b">order</code>设置为<code class="fe lv lw lx ly b">True</code></li><li id="e783" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">使用<code class="fe lv lw lx ly b">field()</code>功能定义您希望在比较中考虑的属性。</li></ul><p id="9002" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示这一点，让我们编写一个支持基于权重的比较<code class="fe lv lw lx ly b">&lt;&gt;, ≥, ≤, ==, !=</code>的<code class="fe lv lw lx ly b">Fruit</code>数据类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用数据类比较对象节省了16行代码</p></figure><p id="968e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们仔细看看代码</p><ul class=""><li id="c08f" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">在顶部，您从<code class="fe lv lw lx ly b">dataclasses</code>模块导入<code class="fe lv lw lx ly b">field</code>。</li><li id="6a9f" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe lv lw lx ly b"><strong class="lb iu">@</strong>dataclass</code>装饰器接受参数。默认情况下，<code class="fe lv lw lx ly b">order</code>被设置为<code class="fe lv lw lx ly b">False</code>。要启用比较，您需要设置<code class="fe lv lw lx ly b">order=True</code>。</li><li id="f699" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">在数据类中，您为每个属性分配一个<code class="fe lv lw lx ly b">field</code>来突出显示您想要比较的内容。设置<code class="fe lv lw lx ly b">compare=False</code>忽略比较中的属性。设置<code class="fe lv lw lx ly b">compare=True</code>以在比较中考虑属性。</li></ul><p id="1240" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您可以比较<code class="fe lv lw lx ly b">Fruit</code>对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="134f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="cec5" class="mf mg it ly b gy mh mi l mj mk">banana &lt; apple:  True<br/>banana &gt; apple:  False<br/>banana &lt;= apple:  True<br/>banana &gt;= apple:  False<br/>banana == apple:  False<br/>banana != apple:  True</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="29e4" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">如何散列对象</h1><h2 id="4782" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="4eef" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">哈希值是唯一的整数值，用于在查找过程中快速比较字典键。</p><p id="f1be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了散列你的对象，你可以覆盖<code class="fe lv lw lx ly b">__hash__()</code>方法。此外，您需要实现<code class="fe lv lw lx ly b">__eq__()</code>方法来使其工作。</p><p id="03a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们使<code class="fe lv lw lx ly b">Fruit</code>类可散列，这样两个相同的对象返回相同的散列。具有唯一属性的对象应该返回唯一的哈希。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="bdd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建三个<code class="fe lv lw lx ly b">Fruit</code>对象——两个相同，一个独特:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="b48d" class="mf mg it ly b gy mh mi l mj mk">fruit1 = Fruit("Banana", "Yellow", 0.1)<br/>fruit2 = Fruit("Banana", "Yellow", 0.1)<br/>fruit3 = Fruit("Banana", "Brown", 0.2)</span><span id="d0b5" class="mf mg it ly b gy on mi l mj mk">print(hash(fruit1))<br/>print(hash(fruit2))<br/>print(hash(fruit3))</span></pre><p id="1dbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出示例:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="f4a6" class="mf mg it ly b gy mh mi l mj mk">-6457846617344767246<br/>-6457846617344767246</span><span id="1f4a" class="mf mg it ly b gy on mi l mj mk">-4509737671946749260</span></pre><p id="a785" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于哈希的知识，请看这里的<a class="ae ky" href="https://www.programiz.com/python-programming/methods/built-in/hash" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="4a15" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="d519" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">可以通过在<code class="fe lv lw lx ly b"><strong class="lb iu">@</strong>dataclass</code>装饰器中将<code class="fe lv lw lx ly b">unsafe_hash</code>设置为<code class="fe lv lw lx ly b">True</code>来散列数据类对象。</p><p id="4373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这使得<code class="fe lv lw lx ly b">Fruit</code>是可散列的，因此两个相同的对象返回相同的散列。具有唯一属性的对象应该返回唯一的哈希。</p><p id="61d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="a5a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，两个相同的对象具有唯一的哈希值:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="6891" class="mf mg it ly b gy mh mi l mj mk">fruit1 = Fruit("Banana", "Yellow", 0.1)<br/>fruit2 = Fruit("Banana", "Yellow", 0.1)<br/>fruit3 = Fruit("Banana", "Brown", 0.2)</span><span id="8411" class="mf mg it ly b gy on mi l mj mk">print(hash(fruit1))<br/>print(hash(fruit2))<br/>print(hash(fruit3))</span></pre><p id="3d5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出示例:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="8fd2" class="mf mg it ly b gy mh mi l mj mk">2454484982753268175<br/>2454484982753268175</span><span id="aed3" class="mf mg it ly b gy on mi l mj mk">5881766570306781446</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="3b82" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">如何为对象提供默认值</h1><h2 id="4c72" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">班级</h2><p id="3e70" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">您可以在初始化器中为类属性提供默认值。</p><p id="1f9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们创建一个<code class="fe lv lw lx ly b">Fruit</code>类，其中<code class="fe lv lw lx ly b">Fruit</code>对象默认为苹果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="6f4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来测试一下:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="34bc" class="mf mg it ly b gy mh mi l mj mk">apple = Fruit()<br/>banana = Fruit("Banana", "Yellow", 0.1)</span><span id="1949" class="mf mg it ly b gy on mi l mj mk">print(apple.name)<br/>print(banana.name)</span></pre><p id="fdbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="fe93" class="mf mg it ly b gy mh mi l mj mk">Apple<br/>Banana</span></pre><h2 id="92a6" class="mf mg it bd mt nj nk dn mx nl nm dp nb li nn no nd lm np nq nf lq nr ns nh nt bi translated">数据类别</h2><p id="1124" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">您可以向数据类添加默认属性。为此，请为class属性分配一个值。不要忘记添加类型信息。</p><p id="5056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们默认设置<code class="fe lv lw lx ly b">Fruit</code>对象为苹果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="7432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="c752" class="mf mg it ly b gy mh mi l mj mk">Apple<br/>Banana</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="7ce9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您现在已经了解了如何使用数据类来使代码更短、更简洁。现在让我们看看Python中其他一些有用的数据类独有的特性。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="ddb2" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">初始化后如何定义数据类属性</h1><p id="ea4f" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><strong class="lb iu"> Post initialization </strong>让您定义在初始化过程中不想添加的类的属性。</p><p id="eec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用post初始化，请在您的类中实现<code class="fe lv lw lx ly b">__post_init__()</code>方法。初始化完成后，会立即自动调用此方法。</p><p id="f80f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们将<code class="fe lv lw lx ly b">info</code>属性添加到用一句话描述对象的<code class="fe lv lw lx ly b">Fruit</code>类中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="6696" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以创建一个香蕉对象，并在其上调用信息:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="0923" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>print(banana.info)</span></pre><p id="bb22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="bcd3" class="mf mg it ly b gy mh mi l mj mk">This is a Yellow Banana that weighs 0.1 kilos</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="4b1d" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">如何创建不可变的数据类</h1><p id="6a1d" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">有时创建一个对象的值不能改变的类是很有用的。这可以通过数据类来完成。</p><p id="9479" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建一个不可变的数据类，将一个<code class="fe lv lw lx ly b">frozen=True</code>传递给<code class="fe lv lw lx ly b"><strong class="lb iu">@</strong>dataclass</code>装饰器。</p><p id="6fbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们使<code class="fe lv lw lx ly b">Fruit</code>类不可变:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="c05d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果试图改变<code class="fe lv lw lx ly b">Fruit</code>对象的属性:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="2d57" class="mf mg it ly b gy mh mi l mj mk">banana = Fruit("Banana", "Yellow", 0.1)<br/>banana.name = "Apple"</span></pre><p id="431c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">会引发一个错误:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="5b28" class="mf mg it ly b gy mh mi l mj mk">dataclasses.FrozenInstanceError: cannot assign to field 'name'</span></pre><p id="2364" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该错误表明您不能修改不可变的类。</p><p id="76e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，冻结的类也不能修改自己。例如，您不能让一个方法改变它的属性。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="d3dd" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">数据类别转换</h1><p id="4a85" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">您可以将数据类对象转换为字典或元组。</p><p id="422e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，从数据类导入<code class="fe lv lw lx ly b">astuple()</code>和<code class="fe lv lw lx ly b">asdict()</code>方法。</p><ul class=""><li id="fbf0" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">使用<code class="fe lv lw lx ly b">astuple()</code>转换成一个元组。</li><li id="e371" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">使用<code class="fe lv lw lx ly b">asdict()</code>转换成字典。</li></ul><p id="13f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="da77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="b5ce" class="mf mg it ly b gy mh mi l mj mk">('Banana', 'Yellow', 0.1)<br/>{'name': 'Banana', 'color': 'Yellow', 'weight': 0.1}</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="5d7d" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="e8f0" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">今天，您学习了如何通过使用Python中的数据类来减少样板代码。通过将您的类变成数据类，您可以去掉<code class="fe lv lw lx ly b">__init__()</code>和其他常见的双下划线方法。</p><p id="aee8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。编码快乐！</p><p id="c48c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我很想加入你的LinkedIn网络。请随意连接<a class="ae ky" href="https://www.linkedin.com/in/artturi-jalli-29619413a" rel="noopener ugc nofollow" target="_blank">阿图里·贾利</a>。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="9697" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">你可能会发现见解深刻</h1><div class="oo op gp gr oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/50-python-interview-questions-and-answers-5230fe2a0db6"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">50 Python面试问答</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">Ace您的下一次编码面试</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">better编程. pub</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div><div class="oo op gp gr oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/10-useful-python-snippets-to-code-like-a-pro-e3d9a34e6145"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">10个有用的Python片段，让你像专业人士一样编写代码</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">我每天使用的有用的提示和技巧</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">better编程. pub</p></div></div><div class="pa l"><div class="pg l pc pd pe pa pf ks or"/></div></div></a></div></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="c5b1" class="ms mg it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">参考</h1><div class="oo op gp gr oq or"><a href="https://docs.python.org/3/" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">文件</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">欢迎光临！这是Python 3.9.6的文档。</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">docs.python.org</p></div></div></div></a></div></div></div>    
</body>
</html>