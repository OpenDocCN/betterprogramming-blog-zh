<html>
<head>
<title>The Power of String Interpolation in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中字符串插值的强大功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-power-of-string-interpolation-in-swift-6fe392ebde6c?source=collection_archive---------4-----------------------#2019-08-09">https://betterprogramming.pub/the-power-of-string-interpolation-in-swift-6fe392ebde6c?source=collection_archive---------4-----------------------#2019-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8207" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索Swift中的字符串插值新超能力</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3d0df4327c3f4bbf0c566620b21655f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuYAqTVmV4tsnjsDdVm9cg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@impatrickt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">帕特里克·托马索</a>在<a class="ae kv" href="https://unsplash.com/search/photos/string?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="65dc" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">我们说字符串，我们写字符串</strong></h1><p id="6cd0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">弦在我们的世界里无处不在。我们开发人员以字符串开始我们的一天，在我们最喜欢的IDE中编写代码，以字符串结束，编写我们的状态电子邮件。</p><p id="313a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不管我们愿不愿意，我们每天都在写大量的字符串插值。我们没有其他选择。</p><p id="3634" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">也许你现在在想，我什么时候使用了字符串插值？我觉得我没用过！</p><p id="bb56" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">嗯，也许你没有发现它，但是相信我——你每天都在使用它！</p><p id="776c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mp">如果我每天都在使用它，为什么我现在需要学习它？</em></p><p id="420a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">世界上很多编程语言都支持字符串插值。Swift从一开始就支持字符串插值。但是在Swift 5.0中，它获得了超能力，这就是为什么我写这篇文章并探索字符串插值的一些新特性。我们开始吧！</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="ecb5" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated">什么是字符串插值？</h1><p id="8649" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">字符串插值是在字符串中包含一个变量或常量。这是一种通过在字符串文字中混合常量、变量和文字及其值来构建新字符串的方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/6bb7331a417f500220b2acc1f61f9845.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*tY5Pn4e1vZcOFCpYP10bYg.png"/></div></figure><p id="f269" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">假设我想说“<em class="mp">早上好”</em>到“<em class="mp">boudhayan”</em>，我该怎么做？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/5227c1d9dd8df11fda49741ab97dc7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*m6U2XyCuASbtBKV1706uJA.png"/></div></figure><p id="2f0b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们都知道——我们每天都在使用这种代码。很简单。</p><h2 id="1d55" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">字符串插值只是一个众所周知的功能的花哨名称</h2><p id="7ae2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mp">现在让我们检查Swift代码，看看它在Swift标准库中是如何定义的。</em></p><p id="8bb4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这只是一个简单的类型别名:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/828305a72f99752164c47ee0c6215b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ab08FGNQplj-BB_cM01seg.png"/></div></div></figure><h2 id="6dae" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated"><strong class="ak">那么Swift 5中的字符串插值有什么新功能呢？</strong></h2><p id="aa54" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在，我们可以扩展字符串插值，以包括我们自己的自定义插值。我们现在可以随心所欲地使用字符串插值—没有任何限制！</p><p id="7a78" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">但这实际上意味着什么呢？让我们创建两个简单的自定义插值，看看我们能做些什么。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="d70f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里我们创建了两个<code class="fe nq nr ns nt b">String.StringInterpolation</code>的扩展。</p><p id="fddb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">创建自定义插值时，需要遵循两个步骤:</p><ol class=""><li id="396a" class="nx ny iq lq b lr mk lu ml lx nz mb oa mf ob mj oc od oe of bi translated">创建一个扩展的<code class="fe nq nr ns nt b">String.StringInterpolation</code></li><li id="1cc4" class="nx ny iq lq b lr og lu oh lx oi mb oj mf ok mj oc od oe of bi translated">为<code class="fe nq nr ns nt b">mutating func appnedInterpolation()</code>编写自定义实现</li></ol><p id="4dee" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们实现实际的方法。我们必须给<code class="fe nq nr ns nt b">appendInterpolation</code>方法一个定制的实现。这个方法为我们带来了所有的魔力，所以请确定我们想要达到的目标，并据此给出实现方案。</p><p id="6bed" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第一个扩展中，我们希望字符串插值为我们拼写所有的整数值，这样我们就不需要编写更多的代码。在第二个扩展中，它做的和第一个完全一样，只是用了<code class="fe nq nr ns nt b">date</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="79c4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是我们自定义的字符串插值。如你所见，它正在拼读终端中的<code class="fe nq nr ns nt b">age</code>和<code class="fe nq nr ns nt b">date</code>。</p><p id="184a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">没错，这就是我们说的字符串插值的超能力！</p><p id="44d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以用字符串插值实现很多其他的东西。</p><p id="3a9c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">例如，我们可以将闭包作为一个参数。在下面的代码片段中，我们实现了一个定制的字符串插值函数，它将一个<code class="fe nq nr ns nt b">autoclosure</code>闭包和一个字符串文字作为参数。<code class="fe nq nr ns nt b">condition</code>闭包返回<code class="fe nq nr ns nt b">Bool</code>，如果闭包返回<code class="fe nq nr ns nt b">true</code>，那么只有它在字符串后面追加字符串，否则不进行插值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3b25" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果<code class="fe nq nr ns nt b">age</code>大于<code class="fe nq nr ns nt b">18</code>，则仅打印<code class="fe nq nr ns nt b">literal</code>消息。</p><p id="7607" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们再举一个例子。在下面的代码片段中，<code class="fe nq nr ns nt b">appendInterpolation</code>函数从<code class="fe nq nr ns nt b">String</code>中取一个<code class="fe nq nr ns nt b">array</code>，如果<code class="fe nq nr ns nt b">array</code>为<code class="fe nq nr ns nt b">empty</code>，则打印<code class="fe nq nr ns nt b">default</code>消息；否则，它将<code class="fe nq nr ns nt b">array</code>元素与<code class="fe nq nr ns nt b">-&gt;</code>元素连接并打印。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="85d1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">假设我们有一个想要在控制台中打印的<code class="fe nq nr ns nt b">optional</code>字符串。但是每当我们在<code class="fe nq nr ns nt b">print</code>函数中写它时，我们都会得到一个著名的编译器警告:它说我们不能简单地打印可选的。如果我们像这样打印，那么它打印的是一个<code class="fe nq nr ns nt b">optional</code>中的值。我们不想要这个——我们想打印那个<code class="fe nq nr ns nt b">String</code>的精确值。</p><p id="9fcf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们有两种选择。一种是强制展开<code class="fe nq nr ns nt b">string</code>可选。另一种是通过使用<code class="fe nq nr ns nt b">??</code>操作符给它一个<code class="fe nq nr ns nt b">default</code>值。我们可以做同样的事情，但是要用更详细的方式。</p><p id="f2f9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们通过使用字符串插值来简化它。我们可以实现如下所示的字符串插值函数，它采用一个<code class="fe nq nr ns nt b">one</code>可选字符串和一个<code class="fe nq nr ns nt b">default</code>值。如果<code class="fe nq nr ns nt b">optional</code>字符串包含<code class="fe nq nr ns nt b">nil</code>值，则打印<code class="fe nq nr ns nt b">default</code>值，否则展开<code class="fe nq nr ns nt b">value</code>可选字符串并打印包装后的值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7170" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">到目前为止，我们已经看到了实现自定义字符串插值方法的范围。我们可以做无限的事情——我们可以玩这个。我们可以创建自己的使用字符串插值的自定义类型，这从字面上显示了字符串插值的超级能力。我们将创建一个可以使用插值初始化的<code class="fe nq nr ns nt b">ConsoleMessage</code>类型，并为不同类型的<code class="fe nq nr ns nt b">Message</code>以预定义的插值格式打印不同的消息。</p><p id="cbe9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">实现如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="abe4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本文中，我们实现了许多自定义的字符串插值函数。令人惊讶的事实是，这不是极限——我们可以用它做许多其他有趣的事情，也可以用它做严肃的用例。</p><p id="6e17" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为什么要等？现在就去做吧！</p><p id="cba8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>