<html>
<head>
<title>Why Is There an F in Front of This String?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么这个字符串前面有一个F？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-is-there-an-f-before-this-string-9a87e6d43563?source=collection_archive---------14-----------------------#2019-08-21">https://betterprogramming.pub/why-is-there-an-f-before-this-string-9a87e6d43563?source=collection_archive---------14-----------------------#2019-08-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d33c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">f字符串和字符串格式介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61b0138934287e05257f5297abc10dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_b7M1rCRZLGQDQLXV07_EA.png"/></div></div></figure><p id="97e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Python中，如何将变量添加到字符串中？如果我有某人的名字，我如何把它打印出来，并附上额外的信息，比如问候信息？</p><p id="fb88" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">定义字符串格式:</p><p id="01cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">名词。一种奇特的说法:“让字符串/文本看起来像你想要的那样，不管是用变量、换行符、空格、大写字母等等。</p><p id="8005" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">示例:“<em class="lq">这个简单的命令行应用程序输出的字符串格式非常棒，它有颜色和一切！</em></p><p id="e2ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在过去的几年里，字符串格式已经有了很大的发展。让我们快速回顾一下过去格式化字符串的方法，滚动到底部看一些f字符串的例子。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="091b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">从基础开始</h1><p id="0726" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在Python中，一切都是对象，包括字符串。这提供了额外的灵活性，例如:<code class="fe mv mw mx my b">"a" * 4 == "aaaa"</code>，也就是说，您可以通过加法和乘法“连接”字符串。</p><p id="d1ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在过去的好时光里，我们是这样做的。让我们以一个经典的Python2 Hello World应用程序为例。</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="fb37" class="nd lz it my b gy ne nf l ng nh">#!/usr/bin/env python <br/>name = input("What's your name? ") <br/>print "Hello " + name</span></pre><p id="b958" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个例子中，我们使用最基本的字符串格式。用<code class="fe mv mw mx my b">+</code>符号连接(添加)两个字符串。</p><p id="14e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您将这段代码保存到<code class="fe mv mw mx my b">hello_name.py</code>并运行<code class="fe mv mw mx my b">python hello_name.py</code>，您将看到输出为<code class="fe mv mw mx my b">Hello Henry</code>，亨利被您键入的任何内容所替代。</p><p id="69c7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这对于基本脚本来说很棒，阅读起来也很有意义，但是如果我们想做类似于<code class="fe mv mw mx my b">"Hello " + name + ", looks like the weather will be " + weather_temp + " " + weather_scale + " degrees today."</code>的事情呢？</p><p id="d23c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这仍然是可能的，但肯定不是很容易阅读。</p><p id="1d4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们想取一个像<code class="fe mv mw mx my b">123.45678</code>这样的数，把它打印成<code class="fe mv mw mx my b">$123.46</code>呢？这种方法在字符串格式化方面有明显的局限性。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="a522" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">%的魔力</h1><p id="1511" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">那么，让我们回到我们的例子。</p><p id="cea1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设我们有一个float(一个带小数的数字，如in，而不是一个整数),我们想把它打印成一个货币，带逗号和四舍五入。</p><p id="5645" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们如何做到这一点？</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="1383" class="nd lz it my b gy ne nf l ng nh">amount = float(input("How much? ")) # Convert input (str) to float print("This much? " + amount)</span></pre><p id="13ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们输入<code class="fe mv mw mx my b">1234.56789</code>，我们会返回<code class="fe mv mw mx my b">"This much? 1234.56789"</code>。那么，我们如何把它打印成美元和美分的数字呢？</p><p id="9fcf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以使用称为<em class="lq">字符串格式化操作符</em>或<code class="fe mv mw mx my b">%</code>的东西。不用在末尾添加字符串，我们可以只放一个<code class="fe mv mw mx my b">%</code>符号，后面跟着一个类型(比如<code class="fe mv mw mx my b">d</code>代表整数，<code class="fe mv mw mx my b">f</code>代表浮点，<code class="fe mv mw mx my b">s</code>代表字符串，等等)。)然后在其后加上要替换的变量。这提供了(稍微)更可读的代码。</p><p id="0777" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们上面的例子是:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="0220" class="nd lz it my b gy ne nf l ng nh">amount = float(input("How much? ")) # Convert input (str) to float print("This much? %f" % amount)</span></pre><p id="b327" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是，这仍然不能帮助我们将<code class="fe mv mw mx my b">1234.56789</code>转换为<code class="fe mv mw mx my b">$1,234.57</code>。</p><p id="5466" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，我们需要使用<a class="ae ni" href="https://python-reference.readthedocs.io/en/latest/docs/str/formatting.html#conversion-flags" rel="noopener ugc nofollow" target="_blank"> <em class="lq">转换标志</em> </a>。</p><p id="8614" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，如果我们正在格式化一个浮点数，我们可以用<code class="fe mv mw mx my b">%.2f</code>代替<code class="fe mv mw mx my b">%f</code>，这将把浮点数四舍五入到两位小数。</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="800a" class="nd lz it my b gy ne nf l ng nh">amount = float(input("How much? ")) # Convert input (str) to float print("This much? $%.2f" % amount)</span></pre><p id="8fb4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以，现在我们的输出是<code class="fe mv mw mx my b">$1234.57</code>，但是我们仍然没有千位分隔符的逗号...</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="93b2" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">没有格式就不能拼写“字符串格式”</h1><p id="d14b" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">所以，Python中的一切都是对象。对象可以有方法(函数),那么我们为什么不在string对象中添加一个方法来帮助我们格式化字符串呢？</p><p id="8233" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">欢迎<code class="fe mv mw mx my b">string.format()</code>。</p><p id="efce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这对Python来说是一个巨大的飞跃。我们不仅仅获得了一种更可读的格式化字符串的方式(在脚注中有更多的介绍)，我们还获得了更复杂的格式化规则。</p><p id="99f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们回到我们的例子。</p><p id="e659" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设我们有一个float(一个带小数的数字，如in，而不是一个整数),我们想把它打印成一个货币，带逗号和四舍五入。我们如何做到这一点？</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="6a4a" class="nd lz it my b gy ne nf l ng nh">amount = float(input("How much? ")) # Convert input (str) to float print("This much? ${0:,.2f}".format(amount))</span></pre><p id="2460" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的产量现在是<code class="fe mv mw mx my b">This much? $1,234.57</code>但是怎么做呢？</p><p id="8e14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">format的基本语法是，它取第一个参数(括号后的值，所以<code class="fe mv mw mx my b">.format(first, second)</code>有两个参数，<code class="fe mv mw mx my b">first</code>和<code class="fe mv mw mx my b">second</code>，并将其放在第一个索引中(用<code class="fe mv mw mx my b">0</code>表示)，所以<code class="fe mv mw mx my b">x = 123</code>，<code class="fe mv mw mx my b">"The number is {0}".format(x)</code>返回<code class="fe mv mw mx my b">The number is 123</code>。</p><p id="5304" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mv mw mx my b">,</code>告诉Python用逗号将数字格式化，这样1200000就变成了1，200000(如果您正在构建一个国际应用程序，请记住在某些国家中<code class="fe mv mw mx my b">,</code>和<code class="fe mv mw mx my b">.</code>符号是颠倒的)。</p><p id="b6ad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好吧，那么<code class="fe mv mw mx my b">.format</code>可以做我们想做的一切。那你为什么这么喜欢f弦？</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="cada" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">F弦改变你生活的真正原因</h1><p id="9e7e" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">尽管有普遍的看法，开发不是(也不应该)完成工作。它是关于以一种未来开发人员能够理解和扩展的方式把工作做好。</p><p id="3b86" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mv mw mx my b">String.format</code>拥有您需要的所有功能。Python 2.7拥有您需要的所有功能。事实上，C拥有你需要的所有功能，几乎可以完成任何任务。</p><p id="8513" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当python升级到版本3时，它对语言做了一些彻底的、突破性的改变，虽然有些是为了性能，有些是为了功能，但我个人最喜欢的f-strings主要是为了健壮性、可读性和适应性。</p><p id="2dbb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">f-string没有引入任何新的功能，但是它们极大地增加了可读性和适应性(它们也提高了性能，但是对我来说，这是一个旁注)。</p><p id="9f04" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们先举个简单的例子:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="5b81" class="nd lz it my b gy ne nf l ng nh">name = "Jenny" <br/>company = "Acme Inc." <br/>print(f"Hi {name}, welcome to {company}.")</span></pre><p id="30dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mv mw mx my b">&gt;&gt;&gt; 'Hi Jenny, welcome to Acme Inc'</code></p><p id="8d6d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过简单地在字符串前添加一个<code class="fe mv mw mx my b">f</code>，我们已经能够输入当前<a class="ae ni" href="https://python-textbok.readthedocs.io/en/1.0/Variables_and_Scope.html" rel="noopener ugc nofollow" target="_blank">范围</a>中的任何变量，并在字符串中打印它。这不是真正的革命性，但革命性的是它有多容易理解。</p><p id="7777" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在今天的世界中，代码不是为了执行一个功能而编写的，而是被编写、测试、审查、修改、扩展，并且有一天，可能被替换。</p><p id="10fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可读性是关键，f字符串提供了可读性的巨大飞跃。如果你对Python一无所知，并且看了前面的例子，我敢打赌你能猜到输出是什么样子。</p><p id="e426" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">永远不要低估可读性的价值。对于我们的简单示例，这似乎太简单了，但是让我们看一个更复杂的示例，进行SQL查询。</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="6698" class="nd lz it my b gy ne nf l ng nh">col1 = 'bar' <br/>col2 = 'baz' <br/>query = f'SELECT * FROM foo WHERE {col1} = ? AND {col2} = ?' cursor.execute(query, params)</span></pre><p id="e584" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该查询返回列<code class="fe mv mw mx my b">bar</code>和<code class="fe mv mw mx my b">baz</code>中的值等于<code class="fe mv mw mx my b">params</code>中设置的值的所有行。这并不令人兴奋，但更有价值，在企业环境中更有可能。</p><p id="c981" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们用一个<code class="fe mv mw mx my b">%</code>操作符或者一个<code class="fe mv mw mx my b">.format()</code>函数重写，它很快变得更加难以阅读。</p><p id="8cf1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">f字符串可用的格式类似于<code class="fe mv mw mx my b">.format</code>，所以我不会在本文中包括它，但我希望我已经让你相信f字符串是有价值的。用于测试、可读性、可扩展性等等。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="87e5" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">有趣的事实</h1><ul class=""><li id="0ab8" class="nj nk it kw b kx mq la mr ld nl lh nm ll nn lp no np nq nr bi translated">您可以使用小写字母或大写字母F，字符串格式将是相同的。<code class="fe mv mw mx my b">f"The result is {result}"</code>与<code class="fe mv mw mx my b">F"The result is {result}"</code>相同。</li><li id="ad59" class="nj nk it kw b kx ns la nt ld nu lh nv ll nw lp no np nq nr bi translated">如果你想格式化多行的字符串，你可以在每一行的前面加上一个<code class="fe mv mw mx my b">f</code>变量:</li></ul><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="4b84" class="nd lz it my b gy ne nf l ng nh">print( <br/>f"Hi {name}" <br/>"welcome to my post" <br/>f"you're {num_days} late" <br/>)</span></pre><ul class=""><li id="39ef" class="nj nk it kw b kx ky la lb ld nx lh ny ll nz lp no np nq nr bi translated">或者，您可以简单地使用Python的多行字符串(用三重引号或三重双引号表示):</li></ul><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="7afc" class="nd lz it my b gy ne nf l ng nh">print( <br/>f"""Hi {name} <br/>welcome to my post <br/>you're {num_days} late""" <br/>)</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="1dc4" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">巧妙的事实</h1><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="c8bb" class="nd lz it my b gy ne nf l ng nh">decimals = 3 <br/>amount = float(input("How much? ")) # Convert input (str) to float print(f"This much? ${amount:,.{decimals}f}")</span></pre><p id="77a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">输入为<code class="fe mv mw mx my b">12312.123123</code>，该脚本的输出为<code class="fe mv mw mx my b">This much? $12,312.123</code>。</p><p id="1103" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注:请不要这样，这个真的很难读。</p><p id="9fe5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="36b9" class="nd lz it my b gy ne nf l ng nh">data = {"x": 123} <br/>print(f'The result is {data["x"]}')</span></pre><p id="990d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者，相当于:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="7ce8" class="nd lz it my b gy ne nf l ng nh">data = {"x": 123} <br/>print(f"The result is {data['x']}")</span></pre></div></div>    
</body>
</html>