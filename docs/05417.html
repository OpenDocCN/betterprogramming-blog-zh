<html>
<head>
<title>10 Things to Look for in Every Code Review</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在每次代码审查中要寻找的10件事</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/10-things-to-look-for-in-every-code-review-3f7fe67ba817?source=collection_archive---------3-----------------------#2020-07-07">https://betterprogramming.pub/10-things-to-look-for-in-every-code-review-3f7fe67ba817?source=collection_archive---------3-----------------------#2020-07-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="acbb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的代码更易维护和健壮的指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/da02d189bb5be00fde9b8518738bbaab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3TNiF40ieWfxfYH_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">西蒙·艾布拉姆斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码评审是开发过程中不可或缺的一部分。它们有助于确保您构建健壮且可维护的工具。代码审查的好处包括增加项目的可见性，在团队成员之间共享知识，最重要的是，检测错误和提高可维护性。</p><p id="b5b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何将代码提交审查的开发人员都希望得到建设性的反馈。反馈不应仅限于关于样式、行距或命名的注释。</p><p id="b520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">代码审查的主要焦点应该是给出建设性的反馈，这将使代码更具可读性、可维护性和无bug性。</em></p><p id="37f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是每次代码审查中需要注意的10件事。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2d1a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">1.功能</h1><p id="fd39" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">代码是否如开发人员所愿？首先，代码评审员负责检查代码评审中定义的目标是否达到。这些变化解决了所有的特性或错误修复了吗？</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d068" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">2.设计</h1><p id="5d00" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在理想的情况下，任何软件设计的改变都应该在实现之前进行讨论和评估。唉，我们并不是生活在一个完美的世界中，所以可能会有这样的情况，设计没有事先讨论，需要大量的重构来使代码更改符合标准。</p><ul class=""><li id="461d" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">查看提议的<a class="ae ky" href="https://en.wikipedia.org/wiki/Software_design_pattern" rel="noopener ugc nofollow" target="_blank">设计模式</a>是否与代码评审中的变更相匹配。程序逻辑在类之间是如何划分的，这些类之间是如何交互的？</li><li id="a803" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">代码是否遵循<a class="ae ky" href="https://en.wikipedia.org/wiki/Object-oriented_design" rel="noopener ugc nofollow" target="_blank">面向对象设计</a>原则？</li><li id="998a" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">UI代码和逻辑代码是分开的吗？组件的划分方式有意义吗？</li><li id="cfea" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">项目中的文件组织直观吗？例如，UI文件、图像、脚本、类和头文件都在不同的文件夹中吗？</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0060" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">3.识别重复代码</h1><p id="3a57" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">【不重复自己(干)</em> </strong></p><p id="bb6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重复的代码会导致重复的错误、增加的复杂性和不必要的开销。不要重复自己(DRY)是软件开发人员的常用口头禅。</p><p id="4a36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">避免重码的原因:</strong></p><ul class=""><li id="7e0e" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">这使得代码库冗长且难以维护。</li><li id="3410" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">一个维护者可能在一个地方修复了一个bug，但在另一个地方却没有。</li><li id="428b" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">重复的代码意味着需要运行重复次数的测试。</li></ul><p id="7b79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何修复:</strong></p><ul class=""><li id="2d95" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">如果函数在整个类中重复，那么这段代码应该被移到一个单独的函数中。</li><li id="878a" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">如果这个重复的代码在多个项目中使用，那么这个代码应该被添加到一个<a class="ae ky" href="https://git-scm.com/book/en/v2/Git-Tools-Submodules" rel="noopener ugc nofollow" target="_blank">子模块</a>或者单独的项目中，被所有的项目引用。</li><li id="c42f" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">多个类中是否存在重复的功能？确保使用继承将减少重复函数的数量。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="fb65" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">4.考虑算法的运行时间</h1><p id="dfc4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">算法的运行时间取决于执行的操作数量，可以用<a class="ae ky" href="https://en.wikipedia.org/wiki/Big_O_notation" rel="noopener ugc nofollow" target="_blank">大O </a>符号表示。操作越多，运行应用程序的时间就越长。</p><ul class=""><li id="9571" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">有没有不需要的操作？应该删除所有不必要的计算。</li><li id="f6bb" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">算法是不是在做重复的工作？我们能否使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Memoization" rel="noopener ugc nofollow" target="_blank">内存化</a>来缓存数据，以避免多次运行相同的计算？</li><li id="2190" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">识别嵌套循环。有没有一种不用操作就能简化操作的方法？</li><li id="ff8f" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">访问数据时的查找成本是多少？有没有一种数据结构可以用来简化它？</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6e36" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">5.移除代码中所有硬编码的值</h1><p id="bbfe" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果硬编码值需要存在于项目中，使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Constant_(computer_programming)" rel="noopener ugc nofollow" target="_blank">常量</a>和描述性变量名。</p><ul class=""><li id="0b0b" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">特定于类的常量应该作为静态类变量添加。</li><li id="7ffe" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">可配置常数应该是配置类的一部分。</li><li id="3889" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">不可配置的和在类之间共享的常量应该在一个常量文件中，并且只在需要的时候包含。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a306" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">6.错误处理</h1><p id="d4cb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">代码是否包含彻底的<a class="ae ky" href="https://medium.com/better-programming/handling-errors-in-python-9f1b32952423" rel="noopener">错误处理</a>？</p><ul class=""><li id="c004" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">异常应该处理由于用户输入、硬件限制、网络问题等导致的无效输入。</li><li id="0f1b" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">断言应该验证条件，以帮助检测错误和验证测试用例。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d48d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">7.存储器分配</h1><p id="118f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果<code class="fe no np nq nr b">malloc()</code>或<code class="fe no np nq nr b">free()</code>被误用，内存分配可能容易出错。由于内存分配导致的最危险软件错误的详细列表可以在<a class="ae ky" href="https://cwe.mitre.org/top25/archive/2019/2019_cwe_top25.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ul class=""><li id="2b5e" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><strong class="lb iu">如果内存中未使用的对象从未被释放，就会发生内存泄漏</strong>。这将导致应用程序使用比所需更多的内存，并可能降低系统速度。</li><li id="d545" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu">过早释放</strong>发生在<strong class="lb iu"> </strong>一个仍被程序使用的对象被释放的时候。结果是一个陈旧的指针，这将导致对malloc和free的进一步调用崩溃。</li><li id="5d55" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">通过释放一个已经释放的对象，一个对象可以被双重释放。同样，将来对malloc和free的调用可能会崩溃。</li></ul><p id="15e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用Python等具有内置垃圾收集功能的语言时，您不太可能遇到内存分配问题。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="8c87" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">8.评论</h1><p id="8bd9" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果不清楚为什么一部分代码存在，这是需要注释的好迹象。</p><ul class=""><li id="e2d2" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">评论应该简洁且可操作。</li><li id="c61a" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">注释应该解释<em class="lv">为什么</em>代码存在——而不是<em class="lv">代码在做什么</em>。</li><li id="ae58" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">IDE注释关键字，如<code class="fe no np nq nr b">TODO</code>、<code class="fe no np nq nr b">FIXME</code>、<code class="fe no np nq nr b">CHECKME</code>、<code class="fe no np nq nr b">PENDING</code>等，应该用来标识注释的具体类别。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="8a4d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">9.一致性</h1><p id="c891" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">整个代码库的风格应该在命名、间距和括号方面保持一致。理想情况下，您的团队已经建立了风格指南。</p><ul class=""><li id="b134" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">函数、变量和类的命名一致吗？</li><li id="eeb1" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">如果没有风格指南，代码应该与代码库的其余部分保持一致。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b798" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">10.安全并行编程</h1><p id="ab71" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果代码包含并行编程，则必须检查<a class="ae ky" href="https://en.wikipedia.org/wiki/Deadlock" rel="noopener ugc nofollow" target="_blank">死锁</a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Race_condition" rel="noopener ugc nofollow" target="_blank">竞争条件</a>。仅仅通过运行代码来测试这些问题是很有挑战性的，所以让另一个开发人员来研究这些问题是很重要的。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6b5d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">额外资源</h1><p id="a11d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">以下是一些标准的代码审查工具:</p><ul class=""><li id="24f3" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><a class="ae ky" href="https://www.atlassian.com/software/crucible" rel="noopener ugc nofollow" target="_blank">坩埚</a></li><li id="eb0f" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://www.reviewboard.org/" rel="noopener ugc nofollow" target="_blank">审查委员会</a></li><li id="48fd" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://about.gitlab.com/handbook/engineering/workflow/code-review/" rel="noopener ugc nofollow" target="_blank"> Gitlab </a></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/d6023e8222e9b6fed0ac58bc73b23474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PrAuWVwPwimP1j35OMx57g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gitlab代码审查来自<a class="ae ky" href="https://about.gitlab.com/releases/2018/10/22/gitlab-11-4-released/" rel="noopener ugc nofollow" target="_blank"> Gitlab发行说明</a></p></figure><p id="1181" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码风格指南:</p><ul class=""><li id="53c1" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><a class="ae ky" href="https://www.python.org/dev/peps/pep-0008/" rel="noopener ugc nofollow" target="_blank"> Python Pep 8风格指南</a></li><li id="f7c9" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://google.github.io/styleguide/cppguide.html" rel="noopener ugc nofollow" target="_blank">谷歌C++风格指南</a></li><li id="80ed" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://google.github.io/styleguide/jsguide.html" rel="noopener ugc nofollow" target="_blank">谷歌Javascript风格指南</a></li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="775e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="9e9e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我希望这篇文章能让您更深入地了解在审查代码时应该寻找什么。</p><p id="ddbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您遵循本文中的指导原则，代码审查可以减少错误，并确保一致性、效率和可维护性。</p><p id="2982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的团队目前不需要代码评审，我希望这篇文章已经让您相信了代码评审在开发和维护健壮系统中的重要作用。</p></div></div>    
</body>
</html>