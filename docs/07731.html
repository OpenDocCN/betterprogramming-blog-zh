<html>
<head>
<title>9 Security Implications to Consider Before Deploying a Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署Web应用程序前需要考虑的9个安全问题</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/9-security-implications-to-consider-before-deploying-a-web-app-1f94a58c6fc9?source=collection_archive---------13-----------------------#2021-02-12">https://betterprogramming.pub/9-security-implications-to-consider-before-deploying-a-web-app-1f94a58c6fc9?source=collection_archive---------13-----------------------#2021-02-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9cac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">保护web应用程序免受最常见攻击的清单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d2ad1715fa1099673be3b85a4413eba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_0TlzGwuP25BMsI5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/photos/DoWZMPZ-M9s" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="a4bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当部署一个新的web应用程序时，它通常要接受安全检查。但是也有急于走向市场的情况，因此部署安全性条件较低的应用程序的第一个版本并不罕见。</p><p id="341a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每隔三到四年，<a class="ae ky" href="https://owasp.org/" rel="noopener ugc nofollow" target="_blank"> OWASP </a>就会发布一份<a class="ae ky" href="https://owasp.org/www-project-top-ten/" rel="noopener ugc nofollow" target="_blank">十大网络应用安全风险的列表。</a>这个列表反映了web服务实现中最常见的错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ed7b1e39d4969c4f3fddc7fd2dfdfab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*i8NDh7sPDfApqY0V.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最新发布的OWASP前10名(2017年)与前一版(2013年)之间的变化</p></figure><p id="ccd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的职业生涯中，我开发过几个具有高安全性含义的web应用程序。在这段时间里，我已经提交、发现并修复了所有这些类型的错误。我也进行了一些道德上的黑客攻击，所以我对开发人员通常失败的地方有所了解。</p><p id="5548" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将强调在部署web应用程序之前要考虑的不同的安全方面，与底层技术无关。</p><p id="d75a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">免责声明:</strong>这是基于OWASP十大安全检查清单和我自己的经验。您的web应用程序可能不需要此列表中的某些点，或者可能需要下面没有列出的一些安全考虑事项。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="36c0" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设计</h1><p id="93fc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">良好的API设计是避免安全问题的关键。遵循设计最佳实践和良好的API文档有助于识别restful API中的危险信号。</p><p id="5839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有<a class="ae ky" href="https://stackoverflow.blog/2020/03/02/best-practices-for-rest-api-design/" rel="noopener ugc nofollow" target="_blank">指南</a>和特定工具，像<a class="ae ky" href="https://swagger.io/tools/swagger-editor/" rel="noopener ugc nofollow" target="_blank"> Swagger编辑器</a>和<a class="ae ky" href="https://swagger.io/specification/" rel="noopener ugc nofollow" target="_blank"> OpenAPI规范</a>对这些目的非常有用。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6ed1" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">认证和授权</h1><p id="5035" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">大多数情况下，您的应用程序会有一个私有区域，因此您应该在执行任何请求之前执行身份验证和授权控制。</p><p id="625c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果请求者不是具有活动会话和所需权限的有效用户，这些控制应该阻止任何操作的执行。</p><p id="8cb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好的API文档应该包括认证细节。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="100a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">访问控制— CORS</h1><p id="4fc0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">访问控制应该仅限于web应用程序域(或白名单)。如果服务器上启用了CORS，预检请求将检查请求的来源是否允许，如果不允许，将抛出错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/cca1cbcd08eef441025f27562600716d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhfpjeSVZHPk2NqbZyFXRQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从JSFiddle向GitHub发出请求会抛出一个CORS错误</p></figure><p id="a316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开发阶段使用非常宽松的CORS配置，并在生产环境中意外地部署这种配置是很常见的。</p><p id="3b25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以用test-cors.org测试你的服务器上是否启用了CORS。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2ad4" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">SQL注入</h1><p id="e0bc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这种攻击包括在服务器数据库中执行表单注入查询。这样，黑客可以从我们的数据库或系统中提取、修改或删除数据。</p><p id="c9a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保护我们的服务器免受这种攻击的最好方法是净化数据库查询中可能结束的所有参数。</p><p id="1dfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://sqlmap.org/" rel="noopener ugc nofollow" target="_blank"> sqlmap </a>是识别SQL注入缺陷的伟大工具。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="5067" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">HTTP安全标头</h1><p id="8960" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">HTTP安全头对于保护我们的应用程序免受常见攻击非常有用。像<a class="ae ky" href="https://helmetjs.github.io/" rel="noopener ugc nofollow" target="_blank">头盔</a>这样的库允许我们在<a class="ae ky" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>应用中无缝地添加这些头。</p><p id="6cb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多用于不同目的的<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#security" rel="noopener ugc nofollow" target="_blank"> HTTP安全头</a>可以帮助缓解最常见的攻击:</p><h2 id="6948" class="nb me it bd mf nc nd dn mj ne nf dp mn li ng nh mp lm ni nj mr lq nk nl mt nm bi translated"><strong class="ak">XSS<em class="nn">袭击</em>袭击</strong></h2><p id="ab49" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://portswigger.net/web-security/cross-site-scripting" rel="noopener ugc nofollow" target="_blank">跨站点脚本</a> (XSS)攻击包括执行攻击者注入可信网站的任意JavaScript代码。在最新的OWASP Top 10 (2017)中，XSS是第七大最常见的web应用程序漏洞。</p><p id="8355" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" rel="noopener ugc nofollow" target="_blank">Content-Security-Policy</a></code> <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" rel="noopener ugc nofollow" target="_blank"> </a>报头和严格的输入净化可以防止和降低XSS攻击的风险。如果需要支持遗留浏览器，还应该设置<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection" rel="noopener ugc nofollow" target="_blank">X-XSS-Protection</a></code>头。</p><h2 id="755a" class="nb me it bd mf nc nd dn mj ne nf dp mn li ng nh mp lm ni nj mr lq nk nl mt nm bi translated"><strong class="ak"> <em class="nn">点击劫持</em> </strong></h2><p id="ea1c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/Security/Types_of_attacks#click-jacking" rel="noopener ugc nofollow" target="_blank"> Clickjacking </a>包括劫持用户在网站中的交互，例如他们的点击或击键，使用顶层的一个看不见的框架来欺骗用户执行非预期的操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/7d2ef37b76d82868954fc9ae6447ba2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DxbyMTczr1xcL1BQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户点击了绿色的付费按钮，却没有意识到他们实际上是在恶意网页的透明顶层点击了红色的付费按钮。图片来自<a class="ae ky" href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/09-Testing_for_Clickjacking.html" rel="noopener ugc nofollow" target="_blank"> OWASP </a>。</p></figure><p id="3d67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过添加HTTP头<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" rel="noopener ugc nofollow" target="_blank">Content-Security-Policy</a></code> <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" rel="noopener ugc nofollow" target="_blank"> frame-ancestors </a>或<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options" rel="noopener ugc nofollow" target="_blank">X-Frame-Options</a></code>来增加对应用程序的保护，以防止我们的站点嵌入或被嵌入到<code class="fe no np nq nr b">iframe</code>中。</p><h2 id="6957" class="nb me it bd mf nc nd dn mj ne nf dp mn li ng nh mp lm ni nj mr lq nk nl mt nm bi translated"><strong class="ak">CSRF<em class="nn">袭击</em>袭击</strong></h2><p id="33f4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/Security/Types_of_attacks#cross-site_request_forgery_csrf" rel="noopener ugc nofollow" target="_blank">跨站点请求伪造</a> (CSRF)是一种攻击，它迫使用户的浏览器在他们当前登录的web应用程序上执行不必要的操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/84db3301bd0ba18a85c0d5f54df4b8d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fl325rdpiOD9EqKltHFbPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CSRF攻击的例子</p></figure><p id="cdd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">针对CSRF攻击的主要缓解措施是使用CSRF令牌和<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" rel="noopener ugc nofollow" target="_blank">SameSite</a></code>cookie。对于Node.js应用程序，<code class="fe no np nq nr b"><a class="ae ky" href="https://www.npmjs.com/package/csurf" rel="noopener ugc nofollow" target="_blank">csurf</a></code>模块为CSRF令牌的创建和验证创建一个中间件。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d60e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">错误处理</h1><p id="3caf" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如<a class="ae ky" href="https://en.wikipedia.org/wiki/Murphy%27s_law" rel="noopener ugc nofollow" target="_blank">墨菲定律</a>所述，如果某些事情可能出错，它就会出错，所以你的restful API应该准备好优雅地处理错误。</p><p id="cdbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">避免在错误中暴露可能对攻击者有用的信息(如技术、版本或非常描述性的消息)。通过返回标准状态代码和一般响应来处理HTTP错误。</p><p id="14ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好的API文档应该包括不同错误响应的细节，比如未授权访问或内部服务器错误。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2606" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">日志记录、监控和审计</h1><p id="8983" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">最重要的是创建并保存应用服务器的日志，以便能够随时了解发生了什么。所收集日志的数量和详细程度因应用程序而异。</p><p id="afbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保适当的日志轮换以避免生成巨大的日志文件，并根据日志保留策略保留旧的日志文件以符合审计要求。</p><p id="3db2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Security_information_and_event_management" rel="noopener ugc nofollow" target="_blank"> SIEM，</a>您可以设置这些日志来创建警报，并在我们的应用程序中检测到异常时触发警报。</p><p id="7b75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最新的OWASP Top 10 (2017)首次将日志记录和监控不足列为常见的web应用安全风险。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b0fc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最新的系统和依赖项</h1><p id="1a5f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">每个软件和每个系统都应该定期更新，至少要安装安全补丁。</p><p id="45a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像<a class="ae ky" href="https://anchore.com/" rel="noopener ugc nofollow" target="_blank"> Anchore </a>或<a class="ae ky" href="https://snyk.io/" rel="noopener ugc nofollow" target="_blank"> Snyk </a>这样的工具可以帮助你发现已知的漏洞，这样你就可以快速修复它们。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="65e9" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">HTTPS</h1><p id="a7b0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">始终使用SSL/TLS上的HTTP在客户端和服务器之间建立安全的通信通道。</p><p id="5c0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在与<code class="fe no np nq nr b"><a class="ae ky" href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/Strict-Transport-Security" rel="noopener ugc nofollow" target="_blank">Strict-Transport-Security</a></code>头(HSTS)的连接中强制使用HTTPS。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="469e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最后的想法</h1><p id="14a8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">安全级别必须根据您所保护的数据的敏感性进行调整。安全漏洞可能会给企业带来严重的后果，有时直到出现问题时才考虑安全性，而此时可能已经太晚了。</p><p id="1f98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然<a class="ae ky" href="https://medium.com/@aprilcwright/is-it-even-possible-to-be-completely-secure-6c7a92a297a9" rel="noopener">不可能完全安全</a>，但是考虑到这些因素可以极大地降低安全事故及其相关风险。</p><p id="ce9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>