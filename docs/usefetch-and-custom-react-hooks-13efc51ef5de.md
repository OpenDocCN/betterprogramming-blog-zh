# 使用 Fetch 和自定义 React 挂钩

> 原文：<https://betterprogramming.pub/usefetch-and-custom-react-hooks-13efc51ef5de>

## 看看 useFetch 的一些优点

![](img/d850e9286755210052b6e03c762a7197.png)

安德鲁·庞斯在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

# 重要的事情先来

React 16.8 发布后，React 挂钩改变了我们看待组件的方式。他们使得使用 React 类组件变得没有必要。然而，降低基于类的组件的重要性是有代价的。如果你正在创建基于类的组件，你不能添加生命周期事件——那么使用 React 首先有什么意义呢？

这就是 React Hooks 来救援的地方。胡克斯让你的机能处于类固醇状态。您可以停止依赖类，转而使用函数(如果您更喜欢类而不是函数，情况就不同了)。钩子将彻底改变 React 代码的编写方式。迟早，你会陷入其中。

# 定制挂钩？

在某些情况下，您可能已经多次对类组件(有状态的)使用了相同的逻辑。以前，我们可以通过依赖渲染道具和高阶组件来处理这种情况。但是我们可以用定制的钩子以一种更简单、更干净的方式来完成。这些是普通的 JavaScript 函数，可以在其中使用其他钩子，并且包含一个通用的有状态逻辑，可以在多个组件中重用。这些函数都以“使用”一词为前缀。

重申一下，钩子只是函数，所以避免重复代码和应用 DRY 模式的一个好方法(如果你不知道 DRY 是什么，我推荐你阅读我的关于干净代码的文章)是创建定制钩子，并导入重用它所必需的所有组件。

# 做家庭作业

如果你更关心生产力而不是学习，看看 npm 包，看看是否已经有一个定制的钩子满足你的需要。然而，我的建议是，即使有一个适合你的定制钩子，你也应该发展技能来创建自己的钩子。

# 钩子的规则

据[官方 React 网站](https://reactjs.org/docs/hooks-rules.html)介绍，使用 React 钩子需要遵循一些规则:

*   仅从 React 函数组件调用挂钩。不要从常规的 JavaScript 函数中调用钩子。(只有一个地方可以调用钩子——在你自己的定制钩子中。我们一会儿就会了解到这一点。)
*   只调用顶层的钩子。不要在循环、条件或嵌套函数中调用钩子。

# useFetch 挂钩用途

前端做 HTTP 请求的方法有很多，最常见的是 Axios 和 fetch。这个自定义挂钩的目的是封装您的请求，并避免项目中的代码重复:

上面这段代码是自定义的钩子，但是我们如何在现实中使用它呢？这很简单:

# useFetch 有什么优势？

使用钩子，您可以从视图(您的功能组件)访问您的数据层，创建一个更可靠的结构来分离这些概念。当您需要在您的功能组件中处理多个请求时，这一点更加重要。当您只需要获取一次数据，而不需要在 URL 中进行分页、参数或查询参数更新时，那么`useFetch`就不那么有用了。