<html>
<head>
<title>Replace Delegation With Combine in Swift 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift 5中将委托替换为组合</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/replace-delegation-with-combine-in-swift-5-e4c193655e7b?source=collection_archive---------8-----------------------#2020-06-23">https://betterprogramming.pub/replace-delegation-with-combine-in-swift-5-e4c193655e7b?source=collection_archive---------8-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d075" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">摆脱这种冗长的协议一致性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/681a3648d196bfb4339d0b99f98f041f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3pkEFN1EK2cOUlDG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@rmrdnl?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹尼尔·罗梅罗</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="8cda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将学习如何实现一个通用的iOS设计模式，委托，使用<a class="ae ky" href="https://developer.apple.com/documentation/combine" rel="noopener ugc nofollow" target="_blank">结合</a>的发布者和订阅者。</p><p id="27a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将比较标准委托方法和使用组合的方法。</p><p id="e658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该项目的源代码可以在文章的底部找到。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b5af" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="8618" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">考虑以下两个屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/3179096c6b2b0f0f3acb441fd37fb47e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iqs8mL5KMYCfGpBDpk_gSQ.jpeg"/></div></div></figure><p id="8d71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一个屏幕上，我们简单地显示了一个项目列表。当我们点击“添加项目”按钮时，第二个屏幕出现，允许我们添加新项目。</p><p id="dc75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实现它的传统方法如下:</p><h2 id="30be" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">ItemsViewController</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="5620" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，在<code class="fe no np nq nr b">addButtonTapped(sender:)</code>方法中，我们创建了<code class="fe no np nq nr b">AddItemViewController</code>并将<code class="fe no np nq nr b">self</code>分配给它的<code class="fe no np nq nr b">delegate</code>属性。</p><p id="6839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们按照<code class="fe no np nq nr b">AddItemViewControllerDelegate</code>获得一个新增加的项目，并更新<code class="fe no np nq nr b">tableView</code>。</p><h2 id="2013" class="na md it bd me nb nc dn mi nd ne dp mm li nf ng mo lm nh ni mq lq nj nk ms nl bi translated">AddItemViewController</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，在<code class="fe no np nq nr b">doneButtonTapped(sender:)</code>方法中，我们运行委托的<code class="fe no np nq nr b">didAddItem(item:)</code>并关闭视图控制器。</p><p id="40c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们怎样才能让这变得更简单呢？如果我们不需要任何委托协议，可以简单地通过<em class="ns">观察</em>来寻找<code class="fe no np nq nr b">ItemsViewController</code>中的新项目，那会怎么样？</p><p id="7e17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">欢迎联合出版公司的出版商和观察员。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3811" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用联合收割机</h1><p id="02d0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们移除<code class="fe no np nq nr b">AddItemViewControllerDelegate</code>并创建一个<code class="fe no np nq nr b">String</code>类型的<code class="fe no np nq nr b">PassthroughSubject</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="31c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到我们在<code class="fe no np nq nr b">doneButtonTapped(sender:)</code>方法中向<code class="fe no np nq nr b">newItem</code>主题发送了一个新值。</p><p id="4bf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在<code class="fe no np nq nr b">AddItemViewController</code>有了一个有效的发布者，我们可以在<code class="fe no np nq nr b">ItemsViewController</code>中订阅它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们仔细看看我们是如何观察新物品的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="bf33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦一个新值被发送到<code class="fe no np nq nr b">AddItemViewController</code>中的<code class="fe no np nq nr b">newItem</code>主题，我们就更新<code class="fe no np nq nr b">.handleEvents</code>操作符中的<code class="fe no np nq nr b">tableView</code>。注意，为了防止我们的订阅被立即取消分配，我们创建了<code class="fe no np nq nr b">subscriptions</code>属性来存储我们的订阅。</p><p id="fcb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们最终用Combine取代了传统的委托方法。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6b22" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="014d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">从GitHub下载完成的项目:</p><div class="nt nu gp gr nv nw"><a href="https://github.com/zafarivaev/ReplaceDelegation-Combine" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">zafarivaev/replace delegation-组合</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">示例项目展示了一种在两个视图控制器之间进行对话的组合方法。为中等教程写的…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><p id="4ad5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想了解更多关于联合收割机的信息吗？查看我的其他相关文章:</p><div class="nt nu gp gr nv nw"><a href="https://medium.com/better-programming/7-sequential-operators-you-should-know-from-swift-combine-1775ce3c47c8" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">Swift Combine中您应该知道的7个顺序运算符</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">第一个、最后一个、计数、包含、全部满足、减少等等</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="ol l oh oi oj of ok ks nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a href="https://medium.com/better-programming/how-to-create-your-own-combine-subscriber-in-swift-5-702b3f9c68c4" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">如何在Swift 5中创建自己的联合收割机订户</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">将逻辑封装在单独的类中</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="om l oh oi oj of ok ks nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a href="https://medium.com/better-programming/5-transforming-combine-operators-you-should-know-4603fe112d74" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">5你应该知道的变换组合运算符</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">用清晰的例子</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="on l oh oi oj of ok ks nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a href="https://levelup.gitconnected.com/9-filtering-combine-operators-you-should-know-9c1ef2911352" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">你应该知道的9个过滤组合运算符</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">用清晰的例子</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="of l"><div class="oo l oh oi oj of ok ks nw"/></div></div></a></div><p id="d3fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>