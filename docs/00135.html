<html>
<head>
<title>An Introduction to Angular HTTP Interceptors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角HTTP拦截器介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-http-interceptors-what-are-they-and-how-to-use-them-52e060321088?source=collection_archive---------0-----------------------#2018-05-22">https://betterprogramming.pub/angular-http-interceptors-what-are-they-and-how-to-use-them-52e060321088?source=collection_archive---------0-----------------------#2018-05-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cc64" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它们是什么以及如何使用它们</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/70f75f82d8c850bfab8468d332f219df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kaGsp7vMmipbmJ5k5STKhA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">泰勒·米利根在<a class="ae ky" href="https://unsplash.com/search/photos/ruby?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8d15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇短文中，我将解释什么是HTTP拦截器以及如何最好地使用它们。我分享的信息是基于Angular的官方文档，我强烈建议你看看。你可以在这里找到:<a class="ae ky" href="https://angular.io/guide/http#intercepting-requests-and-responses" rel="noopener ugc nofollow" target="_blank">拦截请求和响应</a>。</p><p id="8cdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想知道，这篇文章的内容对Angular 2，4和6有效，现在只称为Angular。1.0版本，或AngularJS，现在已经过时了。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="51dc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">拦截器简介</h1><p id="b38c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">使用HTTP拦截器有很多好处。您可以使用它们来设置标题(例如JWT)，重定向错误响应，并且通常会帮助您避免代码重复。</p><p id="f39e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看如何设置HTTP拦截器。我将在这里跳过如何创建Angular项目的细节，但是如果你需要帮助，你可以参考文档。我会在这篇文章的结尾链接完整的代码，所以在你读完之后可以随意查看。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="80ef" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">实现拦截器</h1><p id="6f02" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">编写HTTP拦截器非常简单，您所要做的就是遵循以下步骤:</p><ol class=""><li id="c879" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">创建一个实现<code class="fe ni nj nk nl b">HttpInterceptor</code>的类，然后用<code class="fe ni nj nk nl b">@Injectable</code>来修饰它</li><li id="9c4c" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">提供拦截器</li></ol><p id="630f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一个Angular开发者，你已经知道如何提供服务，但是有一个问题，对于<code class="fe ni nj nk nl b">HttpInterceptor</code>，你必须在<code class="fe ni nj nk nl b">AppModule</code>中提供服务。</p><p id="61ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以这样做:</p><pre class="kj kk kl km gt nr nl ns nt aw nu bi"><span id="0e2a" class="nv md it nl b gy nw nx l ny nz">{ provide: <a class="ae ky" href="https://angular.io/api/common/http/HTTP_INTERCEPTORS" rel="noopener ugc nofollow" target="_blank">HTTP_INTERCEPTORS</a>, useClass: NoopInterceptor, multi: true }</span></pre><p id="27b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">遵循官方文档中的说明并创建一个新的数组来存储所有的拦截器是一个很好的实践，这样您只需要向数组中添加新的拦截器，然后在<code class="fe ni nj nk nl b">AppModule</code>的根中提供数组。</p><p id="4d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拦截器的工作方式是首先查看请求，然后调用next。以下拦截器是一个无操作拦截器，它什么也不做:</p><pre class="kj kk kl km gt nr nl ns nt aw nu bi"><span id="64b2" class="nv md it nl b gy nw nx l ny nz">intercept(<strong class="nl iu">req</strong>: HttpRequest&lt;any&gt;, next: HttpHandler):<br/>    Observable&lt;HttpEvent&lt;any&gt;&gt; {<br/>    return next.handle(req);<br/>  }</span></pre><p id="00b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">据我所知，你不能配置拦截器在某些条件下激活(如果你这样做，请让我知道如何！).您可以通过检查<strong class="lb iu"> req </strong>参数来配置一个拦截器，使其仅针对某些路由激活，如下例所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="4896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有一个使用JWT作为身份验证方法的应用程序，您可以编写一个HTTP拦截器来设置JWT报头(如果可用的话)。使用<strong class="lb iu"> intercept </strong>方法，您可以像下面这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="cc2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望这能对你有所帮助。</p><p id="5d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的代码可以在这里找到:【https://stackblitz.com/angular/kmeqdgdrenj】T2</p></div></div>    
</body>
</html>