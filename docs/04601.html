<html>
<head>
<title>GraphQL Myths and Misconceptions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GraphQL的神话和误解</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/graphql-myths-and-misconceptions-40d2d6db9b3b?source=collection_archive---------15-----------------------#2020-04-23">https://betterprogramming.pub/graphql-myths-and-misconceptions-40d2d6db9b3b?source=collection_archive---------15-----------------------#2020-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a2cb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">消除围绕GraphQL的困惑</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/03cd4656583543f86adc699173f798cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a96dgs6IX0PJBMygx-u5Tg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1699510" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae kv" href="https://pixabay.com/users/TeeFarm-199315/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1699510" rel="noopener ugc nofollow" target="_blank"> TeeFarm </a></p></figure><p id="30b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，告诉我，为什么我和我团队中的一名工程师就<a class="ae kv" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>的好处进行了一场辩论，他试图通过说“你喜欢它只是因为它对前端开发人员有好处”来结束这场辩论</p><p id="c843" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">老实说，我有点不高兴，因为我认为这是我职业生涯中为数不多的一次，另一个只知道服务器端开发的工程师看不起我的意见，因为我喜欢构建用户界面。</p><p id="41fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">稍加思考后，我意识到他是对的。GraphQL真的很适合客户端。它对服务器端也很好，但这不是我们谈话的重点。</p><p id="306a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当比较GraphQL和REST时，可以观察到一个典型的REST服务是为服务器优化的，而GraphQL服务是为客户端和服务器端开发优化的。</p><p id="0245" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">换句话说，GraphQL服务旨在让客户满意和高效。</p><p id="0559" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这不是我第一次进行这样的讨论，所以我很乐意继续讨论我在GraphQL福音之旅中遇到的一些关于GraphQL的误解。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d790" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">1.您正在暴露您的整个数据库</h1><p id="e902" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">"但是William，使用GraphQL，你就把你的整个数据库暴露给客户去做他们想做的任何事情."</p><p id="8bc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您没有暴露整个数据库。我曾经和一些人交谈过，他们讽刺地将GraphQL描述为一种暴露整个数据库的方式，允许客户从您的数据库中查询他们想要的任何内容。</p><p id="2dc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这通常被描述为一个骗局，看起来GraphQL基本上是您前端的一个数据库连接器。这个定义有几个问题。</p><h2 id="472b" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated"><strong class="ak">你可以拥有一个没有数据库的GraphQL服务</strong></h2><p id="ea6c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">正如GraphQL服务不必基于图形数据库一样，您也可以拥有没有数据库的GraphQL服务。它可以用于执行计算和处理的服务或其他服务的代理。</p><h2 id="1d49" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated"><strong class="ak">你设计自己的模式</strong></h2><p id="77cc" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">由于您设计了自己的GraphQL模式，该服务将只公开您希望通过您的模式访问的内容。</p><h2 id="9d0b" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated"><strong class="ak">您可以限制用户查询的复杂性</strong></h2><p id="bd9c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">因为GraphQL查询可以嵌套和批处理，所以有一些工具可以让您对查询的复杂性实施一些限制。</p><p id="c851" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，有像<a class="ae kv" href="https://github.com/slicknode/graphql-query-complexity" rel="noopener ugc nofollow" target="_blank"> GraphQL查询复杂性</a>这样的工具，通过限制查询的复杂性和防止过度嵌套的查询来帮助防止不良行为者。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0e0a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">2.GraphQL不安全</h1><p id="53f8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">GraphQL服务就像你创造的一样安全。需要明白的一点是，GraphQL只是你的应用程序的一部分；查询层。</p><p id="c195" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是GraphQL的创建者在与Airbnb等其他公司交谈时重申的一件事，以了解GraphQL在野外是如何使用的。</p><p id="b687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当脸书开始使用GraphQL时，他们已经有了良好构建的安全和数据提取层，GraphQL可以融入其中，所以他们没有发现在<a class="ae kv" href="https://spec.graphql.org/June2018/" rel="noopener ugc nofollow" target="_blank"> GraphQL规范</a>中强调这些事情的必要性。</p><p id="2124" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">他们认为他们在脸书拥有的所有层和工具都是显而易见的，其他开发者和公司都可以使用。这使得社区很难就如何处理GraphQL应用程序上的身份验证和授权达成共识。</p><p id="dec5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好消息是，我们在REST服务中喜欢的许多安全方法和应用程序也可以以类似的方式用于保护GraphQL服务。</p><p id="8e43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一些实现安全性的方法(有些非常类似于我们已经为REST服务所做的)</p><ul class=""><li id="5a9e" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated"><a class="ae kv" href="https://jwt.io/introduction/" rel="noopener ugc nofollow" target="_blank"> JSON Web令牌</a>:就像对待REST服务一样，通过头部传递这些令牌。</li><li id="653d" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">API密钥:您可以实现自己的API密钥系统，或者通过API网关代理服务来保护应用程序。Yelp的公共GraphQL API 就是一个很好的例子。</li><li id="25bc" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><a class="ae kv" href="http://spec.graphql.org/June2018/#sec-Language.Directives" rel="noopener ugc nofollow" target="_blank"> GraphQL指令</a>:您可以使用GraphQL指令作为拦截器来解决对您的图的一部分实施访问权限的问题。<a class="ae kv" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo GraphQL </a>通过实现一个auth指令提供了一个很好的例子。</li></ul><p id="726c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有关使用指令强制访问权限的更多信息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="8faf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，从<a class="ae kv" href="https://www.apollographql.com/docs/graphql-tools/schema-directives/#enforcing-access-permissions" rel="noopener ugc nofollow" target="_blank"> Apollo GraphQL的文档中，</a>你可以看到访问是由用户角色使用<code class="fe ny nz oa ob b">@auth</code>指令控制的。禁用字段只能由<code class="fe ny nz oa ob b">ADMIN</code>级用户访问，而<code class="fe ny nz oa ob b">canPost</code>字段只能由<code class="fe ny nz oa ob b">REVIEWER</code>级角色的用户访问。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d06c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">3.GraphQL仅适用于移动和网络应用</h1><p id="e746" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">"如果你没有多个移动和网络客户端，就没有理由使用GraphQL . "</p><p id="8d30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GraphQL最初是随着脸书向移动世界的转移而诞生的。它已经被前端和全栈世界广泛采用，这使得一些企业架构师很容易将其视为前端世界的虚假趋势。</p><p id="038a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用GraphQL进行服务器到服务器的连接没有任何限制。</p><p id="03a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于GraphQL服务的出色开发经验，一些优秀的开发人员已经为现有的解决方案构建了GraphQL实现。</p><p id="2c04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有几个例子。</p><ul class=""><li id="f605" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">GraphQL-Kafka-Subscriptions :这是一个库，使您能够使用GraphQL订阅向<a class="ae kv" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank"> Kafka </a>查询和发布主题。</li><li id="498b" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><a class="ae kv" href="https://github.com/davidyaha/graphql-redis-subscriptions" rel="noopener ugc nofollow" target="_blank">graph QL-Redis-Subscriptions</a>:订阅<a class="ae kv" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> Redis </a>消息代理的接口。</li><li id="1aa7" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><a class="ae kv" href="https://rejoiner.io/" rel="noopener ugc nofollow" target="_blank">回复</a>:来自<a class="ae kv" href="https://grpc.io/" rel="noopener ugc nofollow" target="_blank"> gRPC </a>微服务的统一GraphQL模式。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a546" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">4.HTTP/2要干掉GraphQL了</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc nx l"/></div></figure><p id="7630" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哦是的。这是一个大的。GraphQL的一个主要卖点是，它允许客户机在一个HTTP请求中批处理和获取多个资源。这很有吸引力，因为发出HTTP请求非常昂贵。</p><p id="3404" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了HTTP/2，建立HTTP连接的成本大大降低了，因此这个卖点的吸引力也就减少了。</p><p id="401c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，这是否意味着一旦所有人都开始使用HTTP/2，GraphQL将会死气沉沉，毫无意义？我不这么认为。尽管如此，能够批量查询并不是人们使用和喜爱GraphQL的唯一原因。</p><p id="5f96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GraphQL的整个开发者体验棒极了。拥有类型化模式和查询API的标准语言等特性也是开发人员喜欢GraphQL的原因。如果您想更深入地了解这一点，请查看这篇写得很好的文章。</p><div class="od oe gp gr of og"><a href="https://medium.com/@__xuorig__/is-graphql-still-relevant-in-an-http2-world-64964f207b8" rel="noopener follow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">在HTTP2的世界里，GraphQL还有用吗？</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">GraphQL提供的不仅仅是减少往返行程。</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">medium.com</p></div></div><div class="op l"><div class="oq l or os ot op ou kp og"/></div></div></a></div><p id="871e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我认为，从长远来看，HTTP/2实际上有助于提高GraphQL的能力和效率，而不是扼杀它。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d522" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="ab62" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">GraphQL肯定不是完美的，但我认为它在改善开发人员体验和我们如何构建产品方面有很多贡献。</p><p id="ebc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢你阅读这篇文章，如果你对此有任何想法或者我遗漏了什么，请告诉我。注意安全，洗手！</p></div></div>    
</body>
</html>