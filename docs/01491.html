<html>
<head>
<title>Why The Guardian Switched From MongoDB to PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">《卫报》为何从MongoDB转向PostgreSQL</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-the-guardian-switched-from-mongodb-to-postgresql-861b6cf01e1f?source=collection_archive---------0-----------------------#2019-09-19">https://betterprogramming.pub/why-the-guardian-switched-from-mongodb-to-postgresql-861b6cf01e1f?source=collection_archive---------0-----------------------#2019-09-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bccc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">他们为什么要转换，他们是如何迁移的，以及为什么他们现在不这么做</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f73af5a0ffa6e6f69ce14c4f5112c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*edYLRFW8hoxTMNWf3c7g9w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Jordi Fernandez 在<a class="ae ky" href="https://unsplash.com/s/photos/migration?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="74e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在【2018年初，英国报纸和在线出版物《卫报》将其230万条内容从<a class="ae ky" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>切换到<a class="ae ky" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="1716" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们为什么要换？今天他们会有什么不同？</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="419f" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">伦敦服务器被烤熟的那天</h1><p id="69c4" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">2015年7月<a class="ae ky" href="https://www.theguardian.com/uk-news/live/2015/jul/01/heatwave-live-britain-hottest-day-2015" rel="noopener ugc nofollow" target="_blank"/>，一场大规模的热浪袭击了伦敦，导致《卫报》仅在三年后就从MongoDB转向PostgreSQL，这是一个不寻常的结果。</p><p id="cc84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当时,《卫报》的数据在一个标准的NoSQL数据库中；MongoDB存储在本地的Guardian Cloud，这是位于国王十字附近的Guardian办公室地下室的数据中心。</p><p id="5cbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当《卫报》的作者们在博客上直播热浪的时候,《卫报》的开发者们正忙着让主要的服务器重新上线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9604cd97bf64f6c8223d7e9d7fe6d487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*hUYgblRt4_YotXlf80_16g.png"/></div></figure><p id="ecd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">酷热导致《卫报》的内部CMS工具Composer及其数据库出现故障——导致《卫报》的网站临时切换到伦敦其他地方的故障转移服务器。</p><p id="c710" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是促使向更可靠的亚马逊网络服务(AWS)转变宜早不宜迟的决定性因素。</p><p id="e763" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是为什么要离开MongoDB呢？</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="eb2c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">AWS也有MongoDB，但是…</h1><p id="32b5" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在热浪对其故障转移程序进行压力测试后不久，卫报将其服务器从卫报云转移到AWS。</p><p id="858b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，与MongoDB争论的真正焦点很快就出现了。</p><p id="4a66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参与该项目的开发人员透露，解决ops manager(Mongo的数据库管理软件)的问题需要数百小时的工程时间:</p><blockquote class="nc nd ne"><p id="f8b5" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">OpsManager并没有真正兑现其无忧数据库管理的承诺。[...]我们每年至少损失两个月的工程时间来做这项数据库管理工作。——<a class="ae ky" href="https://www.theguardian.com/profile/philip-mcmahon" rel="noopener ugc nofollow" target="_blank">菲利普·麦克马洪</a>，<a class="ae ky" href="https://www.theguardian.com/profile/maria-livia-chiorean" rel="noopener ugc nofollow" target="_blank">玛利亚-利维雅·奇奥利安</a>，<a class="ae ky" href="https://www.theguardian.com/profile/susie-coleman" rel="noopener ugc nofollow" target="_blank">苏西·科尔曼</a>和<a class="ae ky" href="https://www.theguardian.com/profile/akash-askoolum" rel="noopener ugc nofollow" target="_blank">阿卡什·阿斯库勒姆</a>在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="fe60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，该团队已经支付了昂贵的Mongo支持合同，但是在长达两个小时的数据库中断期间没有得到有用的支持。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="72a9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">MongoDB并不适合AWS</h1><p id="4a3a" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">公平地说,《卫报》有独特的需求，需要数百行Ruby脚本来处理AWS基础设施:</p><blockquote class="nc nd ne"><p id="e00d" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">由于编辑需求，我们需要在AWS中自己的基础设施上运行数据库集群和OpsManager，而不是使用Mongo的托管数据库产品。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="2d11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着开发人员不断地在数据库基础设施上工作，而不是让OpsManager处理后端。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="5e68" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">从NoSQL转行的决定</h1><p id="cb44" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">两年后,《卫报》决定是时候最终放弃他们在AWS上为MongoDB定制的基础设施了。</p><p id="1ee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最自然的选择应该是亚马逊的NoSQL产品DynamoDB。</p><p id="a28d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是缺少了一个关键的特征，这就造成了所有的不同。</p><p id="da40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间是《卫报》从MongoDB转向PostgreSQL的主要原因——自从DynamoDB最近添加了这一缺失的重要功能以来，今天可能会做出不同的选择。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="cec5" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">黑仔失踪的特征</h1><p id="4200" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">《卫报》需要一个名为<a class="ae ky" href="https://brightlineit.com/encryption-at-rest-important-business/" rel="noopener ugc nofollow" target="_blank"> <em class="nf">的静态加密</em> </a>功能，不幸的是，DynamoDB当时没有提供。</p><p id="3f28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开发商推迟了项目，但最终，他们不得不决定:</p><blockquote class="nc nd ne"><p id="9692" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">在等了大约九个月来添加这个特性之后，我们最终放弃了，并寻找其他东西，最终选择在AWS RDS[关系数据库服务]上使用Postgres。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="b6d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从NoSQL转换到SQL带来了一系列挑战，以及一个独特的技术解决方案:<code class="fe nl nm nn no b">jsonb</code>列类型，它支持JSON blob中字段的索引。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="6cbb" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">他们是如何做到的</h1><p id="167a" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">SQL和NoSQL数据库通常被认为是截然相反的:</p><blockquote class="nc nd ne"><p id="4424" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">像MongoDB这样的文档数据库使用JSON文档来存储记录，就像关系数据库中的表和行存储记录一样。—<a class="ae ky" href="https://www.mongodb.com/json-and-bson" rel="noopener ugc nofollow" target="_blank">MongoDB JSON白皮书</a></p></blockquote><p id="1f28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">据开发人员称，<code class="fe nl nm nn no b">jsonb</code>类型有助于使PostgreSQL中的数据模型看起来更像MongoDB记录:</p><blockquote class="nc nd ne"><p id="9c54" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">我们希望通过使用<code class="fe nl nm nn no b">jsonb</code>类型，我们可以从Mongo迁移到Postgres，对我们的数据模型做最小的改动。此外，如果我们想在未来转移到一个更加关系化的模型，我们有这个选项。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="4415" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用JSON blob意味着更少的数据重组和更快的迁移。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="cdff" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">堆栈溢出的威力</h1><p id="af14" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">社区支持可能是决定什么软件被广泛采用的最重要的因素。</p><p id="e659" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">《卫报》的决定似乎就是如此:</p><blockquote class="nc nd ne"><p id="8b4d" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">Postgres的另一个优点是它的成熟程度:我们想问的每个问题在大多数情况下都已经在堆栈溢出中得到了回答。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="55a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，使用众所周知的通用SQL server是一个优势。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="3d6b" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">《卫报》是如何做出改变的</h1><p id="5ff1" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">开发人员需要一种与新的PostgreSQL数据库对话的方式，所以第一步是制作一个PostgreSQL API。</p><p id="477c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们需要逐个功能地复制旧的MongoDB API:</p><blockquote class="nc nd ne"><p id="e4b0" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">我们使用了<a class="ae ky" href="https://tpolecat.github.io/doobie/" rel="noopener ugc nofollow" target="_blank"> doobie </a>，Scala的纯功能JDBC层，添加了<a class="ae ky" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>用于本地运行和测试，并改进了日志记录和关注点分离。。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="9006" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到2017年8月底，他们已经部署了一个快速、现代化的API，使用PostgreSQL作为其数据库，但在他们将生产服务器切换到PostgreSQL之前，还需要10个月。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="b7a9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">在卫报的引擎盖下</h1><p id="e98f" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在《卫报》上，所有的文章都存在于《卫报》的内容API(CAPI)中，为应用程序和网站提供动力。</p><p id="8c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与此同时，卫报的内部CMS Composer是建立在2014年的<a class="ae ky" href="https://www.scala-lang.org/" rel="noopener ugc nofollow" target="_blank"> Scala </a>、<a class="ae ky" href="http://scalatra.org/" rel="noopener ugc nofollow" target="_blank"> Scalatra Framework </a>和<a class="ae ky" href="https://angularjs.org/" rel="noopener ugc nofollow" target="_blank"> Angular.js </a>的网络堆栈之上的。</p><blockquote class="nc nd ne"><p id="2ca9" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">如果CAPI的弹性搜索集群发生了什么事，那么我们会从Composer的数据库中重新索引它。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="c6d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，开发人员只需迁移一个数据库。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="5f6a" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">迁移魔法</h1><p id="7d86" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">使用<a class="ae ky" href="https://www.scala-sbt.org/" rel="noopener ugc nofollow" target="_blank"> Scala </a> <code class="fe nl nm nn no b"><a class="ae ky" href="https://www.scala-sbt.org/" rel="noopener ugc nofollow" target="_blank">sbt</a></code> <a class="ae ky" href="https://www.scala-sbt.org/" rel="noopener ugc nofollow" target="_blank">工具</a>迁移过程非常顺利:</p><blockquote class="nc nd ne"><p id="8726" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">我们使用了一个sbt项目来执行迁移。我们采用的方法允许我们使用我们有信心的语言工作，并执行多次“测试迁移”,直到我们有信心在生产中运行它。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="1c7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2017年末，开发人员疯狂地测试访问PostgreSQL数据库的新API以及迁移数据。</p><p id="562f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在投入生产之前尝试测试迁移的服务器会产生一系列问题:与代理问题相关的短暂中断。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="a7a1" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">拔掉插头</h1><p id="9228" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">最后，在2018年4月，是时候关闭代理并向世界推出新迁移的PostgreSQL数据库了:</p><blockquote class="nc nd ne"><p id="c89c" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">团队聚集在一台电脑周围。开关就在一键之外。没有人再呼吸了。完全沉默。咔嚓！零钱已经用完了。什么都没坏！我们都放松了。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="2348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令人印象深刻的是，超过230万篇文章已经从MongoDB转移到PostgreSQL，零宕机<strong class="lb iu"> </strong> — <strong class="lb iu"> </strong>，直到描述这一过程的文章于2018年11月发表，才有人注意到。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="40df" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">今天会有所不同吗？</h1><p id="a1a3" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">导致PostgreSQL决策的致命特性是缺少支持静态加密的DynamoDB。这就引出了一个问题:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="e900" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果该项目被推迟到2019年，会发生什么？</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="3d87" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">DynamoDB现在提供静态加密</h1><p id="6dd7" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">截至2019年9月，<a class="ae ky" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>默认为静态加密。</p><p id="0477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Guardian需要静态加密功能来保护其数据免受底层存储的未授权访问。</p><p id="e9c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是等待DynamoDB的加入意味着又要在一个不可靠的服务器上托管一年的内容，并签订昂贵的支持合同。</p><p id="582d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，长达一小时的数据库中断是转换的强大动力。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="30b1" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">换回来了还来得及吗？</h1><p id="8b7d" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">进行这种转换的开发人员希望PostgreSQL作为关系数据库的附加特性有一天会有用:</p><blockquote class="nc nd ne"><p id="5a9c" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">此外，如果我们想在未来转移到一个更相关的模型，我们可以选择。— <a class="nj nk ep" href="https://medium.com/u/20f674c57775?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">菲利普·麦克马洪</a>等人在<a class="ae ky" href="https://www.theguardian.com/info/2018/nov/30/bye-bye-mongo-hello-postgres" rel="noopener ugc nofollow" target="_blank">卫报</a></p></blockquote><p id="4e91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于《卫报》上发布的内容类型——文档——很可能《卫报》的数据库将保持文档存储格式。</p><p id="e999" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个事实，以及JSON blob数据类型的使用，意味着从PostgreSQL切换回NoSQL文档数据库的选项总是存在的。</p><p id="100a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在工程师们刚刚花了近一年时间编写全新的SQL API之后，切换回来将是从零开始重写NoSQL API。</p><p id="a887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能是一个交易破坏者，因为在当前时间切换回来没有任何明显的优势。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="ecee" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">重大的决定</h1><p id="c267" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">伦敦有记录以来最热的七月天的命运转折，以及DynamoDB中静态加密的延迟推出，意味着《卫报》的内容现在托管在PostgreSQL数据库中。</p><p id="c418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢开发人员在《卫报》上详细描述了他们的旅程，我们已经了解了为什么该出版物放弃了他们在伦敦的本地服务器，以及为什么这一举动导致了从NoSQL到SQL数据库的迁移。</p><p id="d7ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过使用JSON blob列类型，开发人员能够快速地从MongoDB迁移到PostgreSQL，而无需停机。</p><p id="40e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果今天考虑类似的举措，事情会有所不同——因为AWS上的DynamoDB现在支持静态加密。</p><p id="0657" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果开发人员现在考虑改变，他们可能会选择留在NoSQL，从而更快地过渡。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="6b17" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">进一步阅读</h1><ul class=""><li id="a79b" class="np nq it lb b lc mw lf mx li nr lm ns lq nt lu nu nv nw nx bi translated"><a class="ae ky" href="https://www.shippable.com/" rel="noopener ugc nofollow" target="_blank">可发货【2017年</a><a class="ae ky" href="http://blog.shippable.com/why-we-moved-from-nosql-mongodb-to-postgressql" rel="noopener ugc nofollow" target="_blank">11月</a>从MongoDB迁移到PostgreSQL:</li></ul><div class="ny nz gp gr oa ob"><a href="http://blog.shippable.com/why-we-moved-from-nosql-mongodb-to-postgressql" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">为什么我们从NoSQL MongoDB迁移到PostgreSQL</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">几年前，我们将代码库转移到monorepo，这帮助我们在代码重用方面实现了巨大的扩展…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">blog.shippable.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="9dde" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated"><a class="nj nk ep" href="https://medium.com/u/4a10cd338224?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank"> Ajay Kulkarni </a>在2019年7月的一篇文章中讨论了为什么SQL打败了NoSQL:</li></ul><div class="ny nz gp gr oa ob"><a href="https://blog.timescale.com/blog/why-sql-beating-nosql-what-this-means-for-future-of-data-time-series-database-348b777b847a/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">为什么SQL打败了NoSQL，这对数据的未来意味着什么</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">在被遗弃多年之后，SQL今天正在卷土重来。怎么会这样这将对…产生什么影响</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">blog.timescale.com</p></div></div><div class="ok l"><div class="ot l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="fdd1" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated"><a class="nj nk ep" href="https://medium.com/u/69099c2f9012?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank"> Rick Negrin </a>在【2018年7月的一篇帖子中认为NoSQL不是合适的工具:</li></ul><div class="ny nz gp gr oa ob"><a href="https://www.memsql.com/blog/why-nosql-databases-wrong-tool-for-modern-application/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">为什么NoSQL数据库是现代应用的错误工具</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">是时候让我们承认我们早就知道的事实了:NoSQL是很多人的错误工具…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">www.memsql.com</p></div></div><div class="ok l"><div class="ou l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="f7d9" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated"><a class="ae ky" href="https://dzone.com/users/1304649/judahgabriel.html" rel="noopener ugc nofollow" target="_blank"> Judah Himango </a>在2017年9月的一篇文章<a class="ae ky" href="https://dzone.com/articles/the-biggest-challenges-of-moving-to-nosql" rel="noopener ugc nofollow" target="_blank">中讨论了搬到NoSQL的问题</a>:</li></ul><div class="ny nz gp gr oa ob"><a href="https://dzone.com/articles/the-biggest-challenges-of-moving-to-nosql" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">迁移到NoSQL - DZone数据库的最大挑战</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">我们正处于软件世界向NoSQL数据存储的转变中，尤其是在网络和移动领域…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">dzone.com</p></div></div><div class="ok l"><div class="ov l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="32c4" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated">这个关于StackOverflow的<a class="ae ky" href="https://stackoverflow.com/questions/53427464/postgresql-jsonb-update-multiple-nested-fields?stw=2" rel="noopener ugc nofollow" target="_blank"> 2018问题</a>由<a class="ae ky" href="https://twitter.com/gdndevelopers" rel="noopener ugc nofollow" target="_blank">卫报</a>、<a class="nj nk ep" href="https://medium.com/u/acfd5c92b9fc?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">玛利亚-利维雅</a>的一位前开发人员提出，她是卫报关于交换机的文章的合著者，展示了PostgreSQL如何与<code class="fe nl nm nn no b">jsonb</code>数据类型一起工作:</li></ul><div class="ny nz gp gr oa ob"><a href="https://stackoverflow.com/questions/53427464/postgresql-jsonb-update-multiple-nested-fields?stw=2" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">PostgreSQL jsonb更新多个嵌套字段</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">在postgresql数据库中有一个id字段和一个jsonb字段的表。jsonb的结构看起来有点像…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">stackoverflow.com</p></div></div><div class="ok l"><div class="ow l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="2209" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated"><a class="nj nk ep" href="https://medium.com/u/4b564dc9965a?source=post_page-----861b6cf01e1f--------------------------------" rel="noopener" target="_blank">鲁文·勒纳</a>在2015年1月<a class="ae ky" href="https://www.linuxjournal.com/content/postgresql-nosql-database" rel="noopener ugc nofollow" target="_blank"/>于<a class="ae ky" href="https://www.linuxjournal.com/" rel="noopener ugc nofollow" target="_blank"> Linux Journal </a>撰文时，曾暗示使用PostgreSQL作为使用<code class="fe nl nm nn no b">jsonb</code>的文档数据库:</li></ul><div class="ny nz gp gr oa ob"><a href="https://www.linuxjournal.com/content/postgresql-nosql-database" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">NoSQL数据库</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">在过去的几年中，计算机世界最有趣的趋势之一是NoSQL的快速发展</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">www.linuxjournal.com</p></div></div><div class="ok l"><div class="ox l om on oo ok op ks ob"/></div></div></a></div><ul class=""><li id="c24a" class="np nq it lb b lc ld lf lg li oq lm or lq os lu nu nv nw nx bi translated"><a class="ae ky" href="https://olery.com/" rel="noopener ugc nofollow" target="_blank"> Olery </a>也在2015年从MongoDB迁移回PostgreSQL】:</li></ul><div class="ny nz gp gr oa ob"><a href="https://developer.olery.com/blog/goodbye-mongodb-hello-postgresql/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">再见MongoDB，你好PostgreSQL</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">Olery成立于大约5年前。最初是由Ruby开发的单一产品(Olery信誉)…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">developer.olery.com</p></div></div></div></a></div></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="f6c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">德里克·奥斯汀博士是《职业编程:如何在6个月内成为一名成功的6位数程序员 》一书的作者，该书现已在亚马逊上架。</p></div></div>    
</body>
</html>