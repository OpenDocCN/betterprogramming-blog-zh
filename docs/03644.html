<html>
<head>
<title>Build a “Send Me a Message” Component for Your Site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为你的站点创建一个“给我发消息”组件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-send-me-a-message-component-for-your-site-229c2b8195e1?source=collection_archive---------18-----------------------#2020-02-24">https://betterprogramming.pub/build-a-send-me-a-message-component-for-your-site-229c2b8195e1?source=collection_archive---------18-----------------------#2020-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e79a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建一个简单的React组件，允许用户直接从您的站点向您发送消息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bdea7572f870363864034e7fc9ab27ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adsRSb1JboA65iyEtws7Iw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚当·索罗门在<a class="ae ky" href="https://unsplash.com/s/photos/hello?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有想过如何让用户直接从你的网站给你发信息？这似乎有点复杂，不是吗？</p><p id="264b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这里告诉你，这真的很简单。我们只需要把几个已经存在的部分放在一起，然后根据我们的喜好进行裁剪。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="be30" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">目标</h1><p id="c11f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">开发一个组件，允许用户直接从你网站上的表单发送电子邮件。</p><p id="ff79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终产品如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/a1da37fb1327adce8a19ffdc374f22b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*teijnvVQnn11DgUQRFyOQw.png"/></div></figure><p id="f323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从电子邮件的角度来看:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/839b02f10c7970bdcb5347ae0e4cca56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*hYEQA4N8N8YazWxfJKrAZA.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="abdb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们将使用的工具</h1><ul class=""><li id="1c0c" class="nb nc it lb b lc mu lf mv li nd lm ne lq nf lu ng nh ni nj bi translated"><a class="ae ky" href="https://nodemailer.com/" rel="noopener ugc nofollow" target="_blank"> Nodemailer </a> —一个npm模块，我们将使用它以编程方式发送电子邮件。</li><li id="8fb8" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">express . js—node . js的web应用程序框架，允许我们快速启动并运行我们的应用程序。</li><li id="d335" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">React —我们将用来创建表单的前端库。</li><li id="dc77" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><a class="ae ky" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>和<a class="ae ky" href="https://reactstrap.github.io/" rel="noopener ugc nofollow" target="_blank">reacts trap</a>——帮助我们快速创建漂亮组件的UI库。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2bd0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">环境设置</h1><p id="5c86" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我已经创建了一篇附带文章，介绍如何创建一个前端React应用程序并将其连接到您的后端Express应用程序。本指南是本教程的基础。</p><ul class=""><li id="574c" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated"><a class="ae ky" href="https://medium.com/@ryangleason82/connect-your-express-and-react-applications-using-axios-c35723b6d667" rel="noopener">使用Axios连接您的Express和React应用</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="51b6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="78bd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我简单概述一下我们将如何创建这个应用程序。如果你有任何困惑，我会在本文底部贴一个GitHub repo的链接，这样你就可以看到完整的资源库。</p><ul class=""><li id="28a5" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated"><a class="ae ky" href="#e80c" rel="noopener ugc nofollow">布局我们的目录结构</a></li><li id="e2bf" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><a class="ae ky" href="#1ed2" rel="noopener ugc nofollow">创建表单</a></li><li id="b88e" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><a class="ae ky" href="#3924" rel="noopener ugc nofollow">设置后端</a></li><li id="fc85" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">发送电子邮件！</li></ul><p id="9b8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很简单，对吧？我们开始吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e80c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">布局我们的目录结构</h1><p id="d718" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">下面是您的目录结构的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/cfce9abda8b7daa563c57d24fa0edfef.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*MdAlDu9pfXlqMWLjMG4fsw.png"/></div></figure><p id="0fcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到我们的Express后端有<code class="fe nt nu nv nw b">server.js</code>, React前端有<code class="fe nt nu nv nw b">client</code>目录中的所有内容。</p><p id="8d85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的<code class="fe nt nu nv nw b">src</code>文件夹中，我们正在添加一个组件:<code class="fe nt nu nv nw b">InputForm.js</code>。顾名思义，它将是我们的表单组件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1ed2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建我们的表单</h1><p id="8cf3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">将目录更改为<code class="fe nt nu nv nw b">client</code>，我们将创建我们的表单。</p><p id="cafd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行以下命令安装<code class="fe nt nu nv nw b">reactstrap</code>和<code class="fe nt nu nv nw b">bootstrap</code>。这些库将帮助我们制作一个漂亮的表单组件。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="367f" class="ob md it nw b gy oc od l oe of">npm i --save reactstrap bootstrap</span></pre><p id="a1b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并将下面一行添加到您的<code class="fe nt nu nv nw b">index.js</code>中:</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="06b8" class="ob md it nw b gy oc od l oe of">import "bootstrap/dist/css/bootstrap.min.css";</span></pre><p id="9759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们将在名为<code class="fe nt nu nv nw b">InputForm.js</code>的组件中用于表单的代码。</p><p id="0e2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想更详细地了解我是如何使用React钩子创建这个表单的，你可以查看这篇文章:<a class="ae ky" href="https://medium.com/better-programming/easily-create-a-form-with-react-hooks-1cab17e2be0d" rel="noopener"> <em class="og">用React钩子</em> </a>轻松创建一个表单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">InputForm.js</p></figure><p id="d270" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了完整起见，这里是<code class="fe nt nu nv nw b">App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">App.js</p></figure><p id="0752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行<code class="fe nt nu nv nw b">npm start</code>，您应该会在localhost:3000处看到下面的表单:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/2caa8465ba7fdd15cdbcf730f51b7478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*xxjgNlvAblb0WZd8kXrd7Q.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3924" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置我们的后端</h1><p id="f271" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">将目录改回父目录。现在我们将安装更多的库来帮助我们。</p><p id="46c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装以下模块(用于后端):</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="0e26" class="ob md it nw b gy oc od l oe of">npm i --save nodemailer express cors</span></pre><p id="17dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将把代码贴在下面，然后向你解释为什么每一行都是必要的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">server.js</p></figure><ul class=""><li id="e821" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated">第3行:我们将在端口5000上托管后端，在端口3000上托管前端(因为这是React的默认端口)。</li><li id="f06d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第5行:一个包含我们凭证的配置文件。一个名为<code class="fe nt nu nv nw b">config.js</code>的简单文件，与我们的<code class="fe nt nu nv nw b">server.js</code>文件在同一层。看起来是这样的:</li></ul><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="bf75" class="ob md it nw b gy oc od l oe of">module.exports = {<br/>USER: "enteryouremailaddresshere@gmail.com",<br/>PASS: "enteryourpasswordhere"<br/>};</span></pre><ul class=""><li id="0b8e" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated">第6行:为了允许我们的两个服务器相互通信，我们需要启用一个CORS策略。</li><li id="bc01" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第8行:我们允许我们的应用程序使用所有来源的CORS策略。有关如何更好地选择政策的更多信息，请访问npm上的<a class="ae ky" href="https://www.npmjs.com/package/cors" rel="noopener ugc nofollow" target="_blank">CORS文档</a>。</li><li id="d864" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第9行和第10行:Express的应用程序设置。</li><li id="d7db" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第12-18行:<code class="fe nt nu nv nw b">nodemailer</code>要求您创建一个<code class="fe nt nu nv nw b">transport</code>来连接到SMTP服务器。在这里，我们决定使用哪种服务(如Gmail ),并提供我们的登录凭证。</li><li id="377d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第20-26行:我们登录我们的帐户。如果您在登录时遇到问题(SSL错误)，您需要启用您的Gmail帐户从第三方应用程序发送邮件。点击<a class="ae ky" href="https://myaccount.google.com/lesssecureapps" rel="noopener ugc nofollow" target="_blank">该链接</a>并将其转到上的<em class="og">。我建议<em class="og">在你不用的时候把它关掉</em>。或者创建一封测试邮件。</em></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/f3c32ec6955e986eb0b6c1fd8c36970b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2rPfxvMMnKsHDBLW08Gvw.png"/></div></div></figure><ul class=""><li id="4317" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated">第28-46行:我们的<code class="fe nt nu nv nw b">POST</code>路线定义。这段代码是当我们从前端接收到<code class="fe nt nu nv nw b">axios</code>请求时在后端发生的事情。</li><li id="297c" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">您将看到在第29行和第30行，我们从请求中获取参数。</li><li id="741f" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第32-36行:我们正在创建实际的电子邮件消息。您可以看到这里的每个字段如何映射到电子邮件的不同部分。</li><li id="0057" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">第39-45行:生成响应并发送回我们的前端。它将决定消息是否通过，然后在我们的前端，我们可以看到<code class="fe nt nu nv nw b">if (res.dat.msg === ‘suc’)</code>，然后记录<code class="fe nt nu nv nw b">“Email has been sent”</code>，否则，返回<code class="fe nt nu nv nw b">FAILURE</code>。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7d51" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">发邮件！</h1><p id="0f5d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">填写您的表格，然后单击提交。您应该会看到这条<code class="fe nt nu nv nw b">console.log()</code>消息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fa31c717638a93aa74f5bd996ff65575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*tcD_rpKQnIu_Y4hVPIiHHw.png"/></div></figure><p id="de8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的收件箱里有一封类似这样的邮件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/839b02f10c7970bdcb5347ae0e4cca56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*hYEQA4N8N8YazWxfJKrAZA.png"/></div></figure><p id="61be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。我们现在使用<code class="fe nt nu nv nw b">nodemailer</code>以编程方式发送电子邮件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="59df" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">回顾</h1><p id="a57c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们到底做了什么？</p><ul class=""><li id="900a" class="nb nc it lb b lc ld lf lg li np lm nq lq nr lu ng nh ni nj bi translated">在前端用React设置一个全栈Node.js应用程序。</li><li id="1254" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">使用React创建了一个表单。</li><li id="278a" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">在后端设置一个API路由来处理来自前端的请求。</li><li id="6d45" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">发了封邮件。</li></ul><p id="280c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如承诺的那样，这里有一个到GitHub repo的链接。</p><p id="019b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读！如果您有任何问题、意见或顾虑，请随时留下您的意见。</p></div></div>    
</body>
</html>