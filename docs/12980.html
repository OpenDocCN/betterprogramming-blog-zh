<html>
<head>
<title>How To Integrate Dialogflow With GPT-3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Dialogflow与GPT-3集成</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-integrate-dialogflow-with-gpt-3-creating-a-personal-virtual-mental-health-assistant-from-fee7d363993a?source=collection_archive---------0-----------------------#2022-07-17">https://betterprogramming.pub/how-to-integrate-dialogflow-with-gpt-3-creating-a-personal-virtual-mental-health-assistant-from-fee7d363993a?source=collection_archive---------0-----------------------#2022-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="495b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从头开始创建虚拟精神健康助手</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/72100d0d3f92cebd4c3c6cd140dad2da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VTQnkQ9Ykgr7cXin9jBfMw.jpeg"/></div></div></figure><p id="6941" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">dialog flow——Google的自然语言理解平台是一个受欢迎的工具，它使设计对话式用户界面并将其集成到您的应用程序中变得容易。您可以使用Dialogflow来构建聊天机器人、语音助手和其他可以大规模模拟人类对话的代理。</p><p id="9127" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">另一方面，GPT-3是OpenAI最大的语言模型，因其产生令人印象深刻的输出的能力而臭名昭著，经常欺骗人类认为它是由人类编写的。例如，该模型可以生成问题和答案对、描述，甚至博客帖子。该模型非常先进，甚至可以在一次竞赛中击败专业文案。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ln"><img src="../Images/0f8a321e6dfcd0215116376504ade54f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bH5Rk-X2DqPdE6xZ"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">随着训练参数数量的增加，人类检测文本是否是人工智能生成的能力急剧下降。GPT-3制造的假新闻已经很难与真新闻区分开来。在其中一个实验中，结果显示只有50%的假新闻能够被检测出来！</p></figure><p id="ec1f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">前一段关于GPT 3号的内容是由GPT 3号通过完成我给定的提示生成的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/e340b16a76fc0f68281570a1dbec6768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONtiNrtQrg5uAQDPEHf4-w.png"/></div></div></figure><p id="2de8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于GPT-3可以生成高质量的输出，开发人员可以用它来创建聊天机器人、内容生成器和自然语言领域的许多其他应用程序。在本文中，我们将探索如何利用GPT-3的强大功能，并在我们的Dialogflow应用程序中利用它。对于本教程，我将创建一个虚拟的精神健康助手，它可以与其用户自由交谈，并提供一个安全的空间来表达自己的感受。让我们开始吧。</p><h1 id="5434" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">第一步:创建你的OpenAI账户</h1><p id="a438" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">你必须注册并创建一个<a class="ae mq" href="https://beta.openai.com/signup" rel="noopener ugc nofollow" target="_blank"> OpenAI账户</a>来接收你的API令牌。不用担心；它是免费的。你只需验证你的电话号码，你将获得价值18美元的免费积分，这给了我们足够多的请求来试验和玩这个模型。创建您的帐户后，您可以登录并从仪表板查看游乐场。</p><h1 id="81d2" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤2:设置您的Dialogflow代理</h1><p id="3b1d" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">创建一个新的<a class="ae mq" href="https://dialogflow.cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Dialogflow </a>代理，它将与GPT-3集成。给你的经纪人一个名字，我们就搞定了。对于这个项目，我们将只使用提供的默认欢迎和回退意图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/ef058d4166a04a5c8c1951bd470017df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TUH5mEwAqkHMayMI2mxyg.png"/></div></div></figure><h1 id="32ff" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤3:配置欢迎和回退意图</h1><p id="3bb1" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">每当用户用“嗨”问候机器人时，就会触发默认的欢迎意图每当机器人不理解用户输入时，就会触发回退<code class="fe ms mt mu mv b"> </code>意图。因为我们没有在我们的bot中添加任何新的意图，所以除了“Hi/hello”之外的所有用户话语都将触发默认的回退意图。我们可以通过在我们的webhook实现中进行API调用来使用这个后备意图与GPT-3进行通信。现在，删除欢迎意图中的默认响应，并启用webhook调用来实现它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/e0f97be53481237a0826d4173f9f8505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHZxek5hzCVlM4w65V5_ng.png"/></div></div></figure><p id="890d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于回退意图，启用webhook call for fulfillment来调用GPT-3 API，并根据用户的查询做出响应。如果API由于冷启动而失败或花费太长时间(超过五秒)，我们会添加一个默认响应“您能再说一遍吗”，这样我们就可以捕获用户话语，并在失败时再次调用API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/f37468f9d0e1732423da623b940d2525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkXVoNXpZ2S2PAu0tmGerQ.png"/></div></div></figure><h1 id="a579" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤4:编写Webhook实现</h1><p id="fa78" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">为了创建我们的虚拟精神健康机器人，我们需要使用<a class="ae mq" href="https://en.wikipedia.org/wiki/Webhook" rel="noopener ugc nofollow" target="_blank"> Webhook </a>调用我们在Dialogflow中的实现来将我们的自定义逻辑添加到意图中。为此，我们必须创建自己的实现API来处理Dialogflow用户请求，并获取GPT-3生成的响应。我将使用Node.js和Axios作为我的服务器，但也可以随意使用任何其他框架。让我们开始编码吧。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="4b16" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们为默认的Welcome &amp; Fallback意图添加了处理函数，这些函数将在意图被触发时执行。对于回退意图处理程序来说，重要的是我们创建了一个函数query GPT——它接收用户的话语并向GPT-3完成端点发出POST请求。该函数将AI响应发送回用户，并等待另一个查询。简单，嗯？</p><h2 id="6092" class="na lu iq bd lv nb nc dn lz nd ne dp md la nf ng mf le nh ni mh li nj nk mj nl bi translated">让我们来看看提示</h2><p id="b247" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">GPT-3只根据提供给模型的输入提示生成文本。微调这个输入提示对于用GPT-3获得好的结果是至关重要的。这催生了一个新的研究领域，叫做<a class="ae mq" href="https://docs.cohere.ai/prompt-engineering-wiki/" rel="noopener ugc nofollow" target="_blank">快速工程</a>，旨在产生最佳结果。为了创建我们的精神健康助手，下面是我选择的提示:</p><p id="81a1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">“以下是与一个可以与用户进行有意义对话的AI助手的对话。助手乐于助人、善解人意且友好。它的目标是让用户通过感觉被听到而感觉更好。随着每一次回应，人工智能助手都会提示用户自然地继续对话。”</p><h1 id="9943" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤5:托管Webhook API</h1><p id="8d5b" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">现在我们需要的东西都有了。是时候托管我们的API了，这样就可以通过Dialogflow在互联网上访问它。我们可以使用许多免费的云服务提供商，如<a class="ae mq" href="http://netlify.com" rel="noopener ugc nofollow" target="_blank"> Netlify </a>或<a class="ae mq" href="http://vercel.com" rel="noopener ugc nofollow" target="_blank"> Vercel </a>来托管我们的API。但是由于这不是一个生产应用程序，只是为了演示，我使用了<a class="ae mq" href="http://repl.it" rel="noopener ugc nofollow" target="_blank"> Repl.it </a>来托管我的节点服务器。要开始，只需注册到<a class="ae mq" href="http://repl.it" rel="noopener ugc nofollow" target="_blank"> repl.it </a>，创建一个新的节点项目，并粘贴上面的Webhook实现代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/a92ea0170dfa69cb153c2aa0c8287863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjui-T8O38jmBBRPE5RHSQ.png"/></div></div></figure><p id="9807" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要查询GPT-3 API，您将需要它的访问令牌，您可以在OpenAI仪表板的“查看API密钥”中找到它。永远不要在代码中直接暴露你的密钥。总是使用环境变量来存储机密。复制您的API令牌，转到Repl中的Secrets选项卡，将其粘贴为新环境变量“<code class="fe ms mt mu mv b">OPENAI_API_KEY</code>”的值，然后保存。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/70a207eb9d019a13067628cc077ee866.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*cup7lVSNCWyq2C0GfTcyeQ.png"/></div></figure><p id="f0da" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，您的代码可以安全地访问API令牌并请求GPT-3！点击Run，服务器就部署好了。然后，您将找到您的服务器的已发布端点URL。</p><h1 id="04e6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">最后一步:在Dialogflow中更新Webhook URL</h1><p id="5439" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">最后一步是在Dialogflow中启用Webhook Fulfillment，并将端点的URL粘贴到Repl服务器中，然后点击save。请确保在您的repl URL末尾添加“/dialogflow ”,以访问我们的POST端点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/c76c4d2d1447e620011ccab72afeb01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKjfbzfoY0-5jdkAr3XQow.png"/></div></div></figure><p id="b274" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就是这样！您的对话流代理现在应该通过回退意图与GPT-3集成。剩下要做的就是测试你的心理健康助理。</p><h1 id="7a8d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结果呢</h1><p id="fea0" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">你可以在这里自己测试这个机器人:<a class="ae mq" href="https://amagastya.com/gpt3" rel="noopener ugc nofollow" target="_blank">https://amagastya.com/gpt3</a></p><div class="kg kh ki kj gt ab cb"><figure class="np kk nq nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/07df3e1e2ef07b866b5b1457f4732af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*DPV7Wcim6qa3hZdEoJG4GQ.jpeg"/></div></figure><figure class="np kk nv nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2252cc551908cf4cedd9b2b17ff4a9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*k12MfGJoIUJ4l2CUTcBxiQ.jpeg"/></div></figure><figure class="np kk nw nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6921939df32601c038b5e6a044cc9abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*xGfuOflm9-FoFGOu-rM-vw.jpeg"/></div><p class="lo lp gj gh gi lq lr bd b be z dk nx di ny nz translated">悲伤的确是生活的一部分，哈哈</p></figure></div><div class="ab cb"><figure class="np kk oa nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/444ff5066c0aba1658daf7878f817244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*RQEX2XW3P1E3iEPDfoR7ew.jpeg"/></div></figure><figure class="np kk oa nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/be9f4b812f4017d8e7d5e1c9e4bd3945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*52nBE0GJY4Pcsv2cReZSeA.jpeg"/></div></figure></div><h1 id="1320" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="e0a6" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">正如你所看到的，它并不完美，但机器人的大部分工作。机器人可以与用户进行有意义的对话，甚至表现出关心和同情的迹象。</p><p id="b78b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请记住，我们没有添加任何意图，整个对话仅由GPT-3处理。用Dialogflow实现这个结果几乎是不可能的，因为我们永远无法准确预测用户可能会说什么，所以考虑所有可能的意图将是一个巨大的挑战。</p><p id="8227" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，通过GPT-3，我们可以处理这种复杂的开放式对话，使这些通用的开放领域情况成为大型语言模型的一个伟大用例，因为它们可以轻松地模拟和维护人类对话。</p><p id="34a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请注意，通过更改您的输入GPT-3提示，您可以用您的机器人创建酷和古怪的体验。我希望这能激发你创造自己的机器人体验，并从中获得乐趣。🙂</p><p id="d51f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，我想用一首短诗来结束这篇文章:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/a89bee013c8793eee1ea8a785d1f94de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MRTc0ZEVrHnCT_Mq"/></div></div></figure><p id="6cbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢创建自己的GPT-3动力虚拟助理。敬请关注更多内容！</p><p id="54a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">想要连接吗？请在Linkedin上关注我，网址是https://www.linkedin.com/in/amoghagastya/<a class="ae mq" href="https://www.linkedin.com/in/amoghagastya/" rel="noopener ugc nofollow" target="_blank">和https://amagastya.com</a><a class="ae mq" href="https://amagastya.com" rel="noopener ugc nofollow" target="_blank">的</a></p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="4963" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">也读—</p><div class="oj ok gp gr ol om"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-give-your-chatbot-the-power-of-neural-search-with-openai-ebcff5194170"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">使用GPT 3优化你的聊天机器人的对话智能</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">用OpenAI赋予你的聊天机器人神经搜索的能力</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">better编程. pub</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa kp om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-finetune-gpt-3-finetuning-our-virtual-mental-health-assistant-641c1f3b1ef3"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">微调GPT-3使用Python创建一个虚拟精神健康助理机器人</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">为特定任务构建您自己的ChatGPT</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">better编程. pub</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa kp om"/></div></div></a></div></div></div>    
</body>
</html>