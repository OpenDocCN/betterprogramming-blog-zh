<html>
<head>
<title>Lock Screen Widgets in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI中的锁屏小工具</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lock-screen-widgets-in-swiftui-1585aaa93ed4?source=collection_archive---------3-----------------------#2022-09-06">https://betterprogramming.pub/lock-screen-widgets-in-swiftui-1585aaa93ed4?source=collection_archive---------3-----------------------#2022-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f0fb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过这个锁屏小工具教程，为iOS 16和watchOS 9的新版本做好准备。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb10fbcc29c0dd8b2936509525b0f1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dU-LR8WOs6jryhIltPOBvw.png"/></div></div></figure><h1 id="df9b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="d8aa" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">随着许多令人兴奋的新功能在今年秋天进入iOS，作为一名iOS开发人员，我一直坚持的一个功能是将小部件带到锁定屏幕。主屏幕小工具让用户更容易看到及时的数据，现在iOS更进一步，让用户进入锁定屏幕。我总觉得这是iOS设备上缺失的部分——只需要扫一眼锁屏，就能更新你最喜欢的应用程序。</p><p id="4f3e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，让我们看看如何用一些闪亮的新部件来扩展我们的应用程序。</p><h1 id="f44e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">锁定屏幕Widgets</h1><p id="7977" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">好吧，这到底是怎么回事？watchOS的复杂性以新的锁屏小工具的形式出现在了iOS上。这也意味着，如果我们遵循一组样式规则，我们可以为我们的小部件编写一次代码，并在不同的设备上使用它。用于在SwiftUI中创建小部件的框架被称为<code class="fe mk ml mm mn b">WidgetKit</code>。你可能很熟悉它，它从2020年就有了，还有iOS 14的发布。但是现在，最初的widget家族(苹果称之为widget)得到了扩展，有了新的细微差别。</p><p id="a45c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">原始小部件系列中增加了3种新的小部件类型:</p><ul class=""><li id="aff6" class="mo mp iq ll b lm mf lp mg ls mq lw mr ma ms me mt mu mv mw bi translated"><code class="fe mk ml mm mn b">accessoryRectangular</code>，显示多行文本或更小的图形</li><li id="5751" class="mo mp iq ll b lm mx lp my ls mz lw na ma nb me mt mu mv mw bi translated"><code class="fe mk ml mm mn b">accessoryCircular</code>，用于显示进度视图和量表</li><li id="43c9" class="mo mp iq ll b lm mx lp my ls mz lw na ma nb me mt mu mv mw bi translated"><code class="fe mk ml mm mn b">accessoryInline</code>，仅显示文本，对于较长的内容很有用</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/f9bef7fd1f9386959bcf3b7c12e54230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ntCvky7eWWisE-Ze"/></div></div></figure><p id="5c62" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe mk ml mm mn b">accessoryCorner</code>也是存在的，但是由于那个是在watchOS上单独使用的，我们就留到下次吧。</p><p id="48f8" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">它们可以被渲染成3种不同的颜色。但在iOS上，为了适应锁屏的吸引力，只能在我们的锁屏小工具上使用去饱和版本。我们可以在Xcode的实时视图中检查小部件的外观和可见性，或者直接在模拟器上构建它们。因为小部件存在于一个单独的方案中，所以很容易节省时间，只在处理它们的时候重新构建它们，但是我们将在稍后的教程部分讨论这个问题。</p><p id="c577" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们已经提到了一些规则，所以让我们来讨论一下。嗯，它们并不是真正的规则，只是在设计小部件时需要记住的一些事情，以使它们更有吸引力和易于使用。</p><h2 id="981b" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated"><strong class="ak">言简意赅</strong></h2><p id="505e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们为小部件获得的空间非常有限。我们应该简明扼要，只展示必要的信息。把它当成一件好事。你不需要展示太多，比如应用程序的标题或任何相关的文字。以苹果的健身小工具为例。它只显示3个同心圆，没有文字或数字，但是用户确切地知道哪个圆显示什么数据。</p><p id="54e6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">此外，将小部件的内容包装在<code class="fe mk ml mm mn b">ViewThatFits{ ... }</code>中会很有用，尤其是在避免较长文本的自动省略时。</p><h2 id="9a39" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated"><strong class="ak">牢记设计</strong></h2><p id="f076" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">用户会在他们的锁屏上组合不同应用的小工具，所以你应该在设计小工具时坚持苹果的风格规则。当看到粗体文本或内容旁边的竖线时，他们希望获得特定信息，因此请进行研究并利用SwiftUI提供的默认字体参数和样式的优势。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/3989b031d88078f3129230f7f00899ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iofgY9TnPkVZChz8"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated">来源:<a class="ae nt" href="http://developer.apple.com" rel="noopener ugc nofollow" target="_blank">developer.apple.com</a></p></figure><p id="299e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为了应用这些样式，我们使用如下修饰符:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="3daf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">用彩色背景测试你的小部件，这可以使内容不那么明显。我们可以利用这里的<code class="fe mk ml mm mn b">AccessortWidgetBackground()</code>，它给了我们漂亮的自然不透明背景。</p><h2 id="4717" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated"><strong class="ak">连接您的小工具和应用</strong></h2><p id="b2ae" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">锁屏小工具的行为与watchOS的复杂功能非常相似，因此它们不可交互。它们旨在显示你的应用程序中的简略内容，而不是可点击的元素。当点击时，他们在当前打开的屏幕上进入应用程序，或者，如果实现，深入链接到应用程序内的特定视图。我不会深入讨论深度链接的细节，因为那是另外一篇博文，但是一旦你为你的应用程序配置了深度链接，你只需将<code class="fe mk ml mm mn b">.widgetURL(entry.url)</code>添加到你的小部件的视图中，它就会像魔法一样工作。</p><h2 id="3108" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated">隐私</h2><p id="ae86" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因为我们在锁定屏幕上显示数据，所以我们需要对显示的内容保持谨慎。默认情况下，微件在锁定的屏幕上显示未编辑的数据，这有暴露用户个人和敏感数据的危险。</p><p id="5617" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你可能会问，当屏幕被锁定时，我们如何实现敏感数据的编辑？假设我们在一个矩形小部件中显示一些敏感数据。我们可以在屏幕锁定时显示占位符，反之亦然:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/0aa81c7c631e8a0add0615892323eabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P0wRc6QGp0vRta3R"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/d045a3f51c0007d3ff1c08b874af981c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*33S2gt5ExOfN2JFM"/></div></div></figure><p id="cad1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这也适用于其他小部件格式。要在SwiftUI中实现这一点，只需在视图中添加<code class="fe mk ml mm mn b">.privacySensitive()</code>修饰符。您可以只标记敏感数据，如文本，并保留图标显示。加载数据时，该屏蔽视图也可以用作骨架视图。</p><p id="438c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">留下来看看如何在⌨️.代码中实现这一点</p><h1 id="982e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">辅导的📚</h1><h2 id="1690" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated">设置🔧</h2><p id="91d8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">给你的项目添加一个新目标，然后找到<code class="fe mk ml mm mn b">Widget Extension</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/6a8a8faa9a686c7dceb7e8831c47655e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y4a0ofcY4vgcqIP9"/></div></div></figure><p id="3ca2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">给小部件目标命名。比如我的app叫Sparkle，那么我的目标就会被命名为<code class="fe mk ml mm mn b">SparkleWidgets</code>。</p><p id="abd3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">现在打开<code class="fe mk ml mm mn b">SparkleWidgets.swift</code>文件。在这里可以找到所有与小部件相关的代码。</p><p id="9171" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为了简要解释文件中自动生成的代码，我们可以看到:</p><ul class=""><li id="22b9" class="mo mp iq ll b lm mf lp mg ls mq lw mr ma ms me mt mu mv mw bi translated"><strong class="ll ir">时间线提供者</strong>，负责小部件的刷新时间</li><li id="d916" class="mo mp iq ll b lm mx lp my ls mz lw na ma nb me mt mu mv mw bi translated"><strong class="ll ir">入口视图</strong>，用于呈现小部件的UI，类似于您可能已经熟悉的SwiftUI视图</li><li id="66ec" class="mo mp iq ll b lm mx lp my ls mz lw na ma nb me mt mu mv mw bi translated"><strong class="ll ir"> widget Configuration </strong>，连接提供者配置和视图，为Widget设置一些配置，比如我们支持的Widget类型，显示名称等。</li><li id="d72b" class="mo mp iq ll b lm mx lp my ls mz lw na ma nb me mt mu mv mw bi translated"><strong class="ll ir">预览提供者</strong>，Xcode的实时预览工具</li></ul><p id="44c5" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果您愿意，您可以将这些结构提取到单独的文件中，使项目更加清晰。</p><h2 id="f0b7" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated">履行</h2><p id="4957" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">有3种类型的锁屏窗口小部件，我们想决定每个小部件如何呈现以及它显示什么数据。实现这一点的最常见选项是在视图主体中使用switch case语句，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="2021" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你将需要<code class="fe mk ml mm mn b">widgetFamily</code> <a class="ae nt" href="https://developer.apple.com/documentation/swiftui/environmentvalues" rel="noopener ugc nofollow" target="_blank">环境值</a>来完成这项工作。您可能注意到了<code class="fe mk ml mm mn b">Gauge</code>视图，这是iOS小部件的新视图。它有一系列风格可供选择，通常会显示我们应用程序中某样东西的范围或进度。</p><h2 id="bc9a" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated">在应用程序之间传递数据</h2><p id="0767" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">理想情况下，我们希望在小部件上显示某种动态数据，而不特别使用静态文本。</p><p id="26ce" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，让我们在这个组合中添加一个新的元素:让我们将主应用程序中的数据与小部件本身共享。这可以通过多种方式完成，但建议使用应用程序组和用户默认设置。</p><p id="83ec" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">应用程序组为单个开发团队创建共享存储，在我们的应用程序之间使用。</p><p id="e565" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">方法如下:</p><p id="5315" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">选择你的主要目标并导航到<code class="fe mk ml mm mn b">Signing &amp; Capabilities</code>标签。然后按左上角的<code class="fe mk ml mm mn b">+ Capability</code>按钮，搜索<code class="fe mk ml mm mn b">App Groups</code>选项。这应该出现在您的Xcode窗口中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ae2365ab93afd11b1ff51db9661d2b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/0*XDG_XbEhdQM7PZD8"/></div></figure><p id="3ae8" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">使用加号按钮添加新容器。您必须使用以下格式命名它:<code class="fe mk ml mm mn b">group.your_app's_bundle_id</code>。您可以通过快速切换到<code class="fe mk ml mm mn b">General</code>选项卡找到您的捆绑包id。回到<code class="fe mk ml mm mn b">Signing &amp; Capabilities</code>选项卡，选择应用程序组部分的复选框，设置完成。</p><p id="d6df" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们完成编码吧🚀。在您的主应用程序中，只要业务逻辑方便，就将数据保存到我们新创建的共享数据容器中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="274c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我使用了一个字符串数组，因为我的widget显示了我的todo应用程序中前3个最紧急的未完成任务，但这里可以使用任何类型的数据，这取决于您的逻辑。</p><p id="c98d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">另一方面——小部件的时间到了。同样，无论代码中的哪个位置有意义，您都可以使用下面的代码行来检索从主应用程序发送的数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b19f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我将一个空数组作为默认值，因为它允许我在锁屏界面上方便地处理空状态。</p><p id="172c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">免责声明:如果您使用自定义类型传递数据，它在小部件的方案中是不可见的。要使该类可见，请在Xcode中打开class/struct文件，并打开右侧边栏。然后导航到名为<code class="fe mk ml mm mn b">Identity and Type</code>的第一个选项卡，确保选中<code class="fe mk ml mm mn b">Target Membership</code>部分下小部件目标旁边的框。假设我决定使用自定义的<code class="fe mk ml mm mn b">Todo</code>类型，而不是字符串。那么我的<code class="fe mk ml mm mn b">Todo.swift</code>文件将具有以下成员资格:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/2ba6f371f3aa21dc4072232fe32b4938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n0s9-EZ7TroOghgN"/></div></div></figure><p id="a356" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在应用了修饰之后，我的<code class="fe mk ml mm mn b">accessoryRectangular</code>小部件代码现在看起来像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="492c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这个小部件看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/ad3104c8f9102570a651aeaaafbc9bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tNUheTUEHsgb4NnC"/></div></div></figure><p id="241a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们也实现这个圆形小部件。我将使用前面提到的<code class="fe mk ml mm mn b">Gauge</code>视图来显示我的“完成所有待办事项”比率。我们必须将完成的待办事项除以待办事项的总数。因为我们的标尺被用作进度循环，所以结果将是标尺的值。对于文本部分，我们将显示为一个分数。代码应该是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/2196de63e07a3fce29da542b09526eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xNtgf1w7RBzY92x_"/></div></div></figure><p id="201c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果你想要，比方说一个线性进度条，你可以使用<code class="fe mk ml mm mn b">accessoryLinearCapacity</code>。</p><h2 id="0c4d" class="nd ks iq bd kt ne nf dn kx ng nh dp lb ls ni nj ld lw nk nl lf ma nm nn lh no bi translated">刷新小部件🔄</h2><p id="26d4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因此，我们可以在应用程序之间传递数据，太棒了🏅。但是我们如何触发重载小部件上的数据来保持数据最新呢？</p><p id="4923" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">就我而言，每当我的待办事项列表以任何方式改变时，我都喜欢进行更新:编辑、删除，等等。</p><p id="9810" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这就是WidgetKit中的<code class="fe mk ml mm mn b">WidgetCenter</code>类的用武之地，更准确地说，是<code class="fe mk ml mm mn b">WidgetCenter.shared.reloadAllTimelines()</code>函数。执行这一行将完全如其名。或者，您可以使用<code class="fe mk ml mm mn b">reloadTimelines(ofKind: String)</code>指定重新加载哪个时间轴。</p><p id="28f6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们在设备上运行这个东西，看看我们得到了什么:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ca9df1d6172d197208109bd27f39c7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/0*91PK1ZJfpOdLpV7F"/></div></figure><p id="1c30" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这就是🪄.</p><p id="f53e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">您可以看到当应用程序中的数据被修改时，小部件是如何变化的。</p><h1 id="bd48" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">从这里去哪里？</h1><p id="e115" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">接下来有几件事要尝试。例如，您可以尝试将我们新创建的小部件构建为Apple Watch complications。或者实现第三种小部件类型，<code class="fe mk ml mm mn b">accessoryInline</code>。</p><p id="2e85" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我也鼓励你去看看新的锁屏<a class="ae nt" href="https://developer.apple.com/documentation/ActivityKit" rel="noopener ugc nofollow" target="_blank">现场活动</a>。它们将我们刚刚使用的WidgetKit与ActivityKit框架相结合，并且可以与我们的锁屏小部件进行逻辑组合。</p><p id="f2cf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">感谢阅读。玩得开心！</p><pre class="kg kh ki kj gt ob mn oc od aw oe bi"><span id="37ad" class="nd ks iq mn b gy of og l oh oi">Want to Connect?</span><span id="be88" class="nd ks iq mn b gy oj og l oh oi">This story was originally published <a class="ae nt" href="https://arsfutura.com/magazine/lock-screen-widgets-in-swiftui/" rel="noopener ugc nofollow" target="_blank">here</a>. Also, I'd be happy to connect on <a class="ae nt" href="https://github.com/nbiscan" rel="noopener ugc nofollow" target="_blank">GitHub</a> and <a class="ae nt" href="https://www.linkedin.com/in/natkobiscan" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>.</span></pre></div></div>    
</body>
</html>