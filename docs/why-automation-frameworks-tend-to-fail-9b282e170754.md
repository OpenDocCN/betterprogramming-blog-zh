# 测试自动化框架容易失败的 5 个原因

> 原文：<https://betterprogramming.pub/why-automation-frameworks-tend-to-fail-9b282e170754>

## 探究测试自动化框架崩溃的最常见原因

![](img/6a7cfb5bf81b3c8333eba897c7677f03.png)

杰西·陈在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片。

在过去的五年里，我有幸为许多公司维护和构建了许多自动化框架。每个框架都有自己独特的挑战和优势。有些兴旺，有些失败。

我从我的每一次自动化经历中学到了很多，无论是最佳实践还是理解要避免的模式(关于这些的更多信息，请看我关于 [JavaScript 反模式](https://js.plainenglish.io/6-javascript-ui-testing-anti-patterns-you-need-to-avoid-f77f9902ef9e?sk=d51e845b0348a58c38a333e8008bbb42)的文章)。在整个过程中，我注意到了许多似乎预示着自动化失败的事件。

以下是我认为工程部门在编写新的自动化框架时最常犯的错误。我已经花了时间来包括你能做什么来确保你的框架是以最好的方式构建的，以避免这些错误。

# 1.错误的东西

自动化失败最常见的预测之一是无法用正确的知识或人才来服务框架。通常，缺乏技术知识与缺乏基本的框架知识相结合，会导致可维护性的彻底崩溃。

我为一家公司工作，该公司在没有正确研究如何使用框架或它能提供什么的情况下实现了自动化解决方案。该商店选择使用 Cypress.io，但选择将其作为测试工具，而不是一体化自动化解决方案。他们没有使用内置的请求库，而是选择使用 SDK。此外，他们写出了由`cy.task()`调用的复杂的 Java 风格的工作流，而不是使用 Cypress 命令。

这并不是说他们的设计是错误的——对于 Java 和 Selenium 的组合来说，这个框架应该是合理的。问题是他们选择了 JavaScript 框架并实现了 Java 解决方案。

我花了几个月的时间进行重构，试图让框架更接近 Cypress 本身。事实上，令人失望的是，我从未为这家公司编写过新的测试。我花了整个任期重构以前的工作，以便它接近及格。这个框架从一开始就被打破了——这都是因为没有能力对产品进行适当的研究和审查。

不要因为框架听起来有吸引力而选择它，而是研究产品提供。确保框架符合您的需求。查看它在 GitHub 上的存储库，并检查“问题”选项卡。如果提出的任何问题可能会影响您测试应用程序的方式，比如当您知道您的应用程序使用第三方集成时，Cypress 不处理 windows，那么这就是一个危险信号。

最重要的是，做好你的尽职调查。目的是让这个框架成为你构建过程的基石。

# 2.编写可测试的代码

构建一个成功的自动化框架的最关键的元素之一是拥有一个易于测试的应用程序。有很多工程公司没有考虑编程对测试的影响。引用《软件测试中的经验教训》一书[](https://www.amazon.com/Lessons-Learned-Software-Testing-Context-Driven/dp/0471081124)*中的一段话可以很好地总结这一点:*

> *“他们并不是不关心测试或质量。他们可能只是不明白他们的行为对测试过程的影响。”*

*简而言之，并不是所有的工程团队都将测试自动化的想法放在他们头脑的最前面。这样做会创建一个难以测试的应用程序(或者在某些情况下，难以测试)。这可能表现为依赖脆弱的选择器标准(非唯一的选择器，如 class、ID 和 xPath)、不可靠的应用程序性能，以及缺乏注重质量的工具，如用于分解测试数据的 API 方法。*

*如果您发现您的团队在编程时没有考虑到测试自动化，寻求与开发人员合作，讨论为什么这是一个问题，以及您如何作为一个团队来解决它。通过引入独特的选择器标准(`data-id`、`data-testid`或`data-cy`)或支持 QA 的 API 方法等概念，慢慢地(但经过深思熟虑地)努力使您的代码在每一次迭代中都更具可测试性。*

*在蓝图、计划和整理会议上大声说出来(如果你是基于 Scrum 的),并引起对一个特性如何难以测试的注意。试着从用户和机器的角度制定解决方案，使之变得更容易。*

*作为软件质量的仲裁者，我们必须确保我们提倡用自动化的思想来编写代码，以减少元素难以自动化的情况。这样做将创建一个易于人和机器测试的应用程序，从而使现在和未来的自动化努力取得成功。*

# *3.在黑暗中摸索*

*我想说清楚，我个人对在 CI 之外构建自动化框架感到内疚。事实上，我注意到在构建新的自动化框架时，这是相当普遍的。在 CI 之外构建框架的主要问题是失败的自动化运行缺乏反响。*

*失败的 CI 构建应该成为开发和 QA 采取行动的催化剂。当自动化在 CI 之外运行时，逃逸到试运行、验证或生产环境的可能性会成倍增加。这是因为在 CI 之外运行会限制可见性和监督。只有开始运行的工程师知道测试失败了。与此同时，团队的其他成员还蒙在鼓里。*

*为什么不让团队知道呢？*

*在 CI 中，您有一个包含错误消息、日志和其他标准的报告，帮助工程师支持他们的案例，说明为什么必须解决故障。CI 之外的失败运行没有这种奢侈。当然，您可以使用 Allure 之类的工具或 Pytest-HTML 之类的包来生成运行报告。然而，CI 构建允许失败在整个团队中自动传播——最明显的是通过聊天应用程序，如 Slack。*

*[](https://donthitsave.com/comic/2016/07/15/it-works-on-my-computer) [## 不要点击保存-漫画:它在我的电脑上工作

### 昨晚我看了路易斯·CK 的现场表演。相当不错的东西。那家伙应该认真考虑从事喜剧事业…

donthitsave.com](https://donthitsave.com/comic/2016/07/15/it-works-on-my-computer) 

此外，还有一个老问题“它在我的机器上工作”,如上面的漫画所示。

在本地运行自动化应该被认为与在本地构建应用程序是一样的。仅仅因为它在您的机器上通过，并不意味着它会在 CI 中通过。始终检查以确保您的跑步在两种情况下都通过。如果没有，那么您必须调查故障并确定后续步骤。* 

# *4.狂热的自动化*

*你是否曾为一家寻求一切自动化的自动化工厂工作过？*

*测试自动化背后的想法是将一系列高度可重复的任务提供给计算机。任务，例如从 20 个过滤器中选择一个，清除该选择，然后选择下一个过滤器。手动执行，行为会变得单调和精神负担。这导致测试人员疲劳，从而导致逃逸。为了减少测试人员的疲劳，并确保我们不会被手工测试的重压压垮，我们自动化了一系列的任务。⁴*

*然而，有些商店将这一点发挥到了极致。管理层雇佣了一个在自动化方面有经验的质量工程师，并且立即想要自动化每一个测试用例。不幸的是，100%自动化不是一个可行的目标。最主要的原因是自动化不是取代手工测试的手段。我们需要手工测试就像我们需要自动化一样——这两种测试方法在这个时候是不可分的。*

*那么为什么这么多商店想这么做呢？对自动化能提供什么缺乏理解。*

*对许多人来说，自动化的想法意味着手工测试脚本的终结。商店再也不用担心执行手动测试用例了——计算机现在可以做到。*

*我们应该深思熟虑地选择什么时候自动化，当我们不能时，手动测试，而不是寻求为所有事情编写自动化。*

# *5.语言很重要*

*我曾经通过在 Clojure 中构建一个自动化框架，对质量和开发之间的语言同质性采取了一种狂热的方法。我们的开发人员用 Clojure 和 Clojurescript 编写，所以我觉得用 Clojure 编写对质量也有好处。*

*我们找到了一个测试运行程序(Kaocha)和一个 web 驱动程序(Etaoin)并开始工作。该项目成功了几个星期，然后才发现故障点:web 驱动程序和测试运行程序分别由一个开发人员维护。⁵应该任何一个开发人员从他们各自的项目中抽出时间，我们的框架将面临崩溃的风险。*

*我学到了什么？*

*在构建自动化框架时，编程语言的选择很重要——这是我在选择 Clojure 时没有考虑的。当时，我想尽可能密切地参与质量和开发。我没有想到 Clojure 的自动化社区会这么小，或者测试产品会这么少。我只是想把质量和发展结合起来，以便更容易地向左转。*

*我在另一家商店再次经历了这种情况，尽管我对语言选择采取了更仔细、更周到的方法。这家商店正在努力维护几年前开发的老化的 Ruby 框架。我的任务是审核框架并选择前进的道路，无论是重构还是重写。*

*在工程管理部门的支持下，更高级的质量工程师和我选择用 Python 重写，尽管他们明显希望使用 Cypress。我们选择了 Python，因为它在语法上与 Ruby 相似，并且对于我们的助理工程师来说更容易学习。*

*不幸的是，该公司几周后被收购，所以所有自动化(除了我的团队)都暂停了。我继续独自开发框架，持续了几个月，直到其他团队能够再次自动化。然而，到这个时候，团队已经决定他们宁愿使用 JavaScript 和 Cypress，而不是 Python。*

*你选择的语言很重要。当构建一个自动化框架时，检查(并反复检查)您正在使用的语言是否被认可。不要使用一种可能很难招到人或者受欢迎程度正在下降的语言。⁶确实使用了一种能提供足够工具和机会的语言。*

# *摘要*

*自动化测试可以为任何开发团队提供显著的生活质量和生产力提升。然而，构建自动化框架可能是一个困难的过程。在选择语言和架构时，请确保您是经过深思熟虑的。与您的开发人员协作，在编程时考虑自动化。*

*最重要的是，对于测试自动化要有现实的期望。*

# *资源*

1.  *Kaner，Cem 等人*在软件测试中吸取的经验教训:一种上下文驱动的方法*。Wiley，2002 年，第 10 页。*
2.  **敏捷测试:测试人员和敏捷团队实用指南*，作者 Lisa Crispin 和 Janet Gregory，Addison-Wesley，2014 年，第 287-288 页。*
3.  *洛夫斯杰夫。“它在我的电脑上工作。”【donthitsave.com】不要打救，[2016](http://donthitsave.com)。*
4.  *敏捷测试:测试人员和敏捷团队实用指南，第 280 页。*
5.  *这在当时是真的。每个项目现在在 GitHub 上都有大量的贡献者，这使得他们更加可靠。*
6.  **十字形的状态*，[octoverse.github.com/](http://octoverse.github.com/)。*