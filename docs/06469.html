<html>
<head>
<title>Automatic Meter Reading With YOLOv4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YOLOv4自动抄表</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/yolov4-for-water-meter-reading-5d27191bc053?source=collection_archive---------4-----------------------#2020-10-05">https://betterprogramming.pub/yolov4-for-water-meter-reading-5d27191bc053?source=collection_archive---------4-----------------------#2020-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="27a7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个经过训练的深度学习模型，可以从图片中自动读取仪表</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f90ff7e7586e30a10377d0d48cf1de35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*eMtI0WSXAX0gXmsUqOUANw.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片来自<a class="ae kr" href="https://challengedata.ens.fr/login/?next=/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">高等师范学校</a></p></figure><h1 id="f684" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">简介</strong></h1><p id="3185" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">许多需要大量劳动力的任务都实现了自动化。在世界上的许多地区，诸如电、气和水之类的公用事业的消耗是由需要人工读取的仪表来监控的。这种仪表的读数需要公用事业提供商的雇员或代表在场。随着人工智能领域的进步，抄表任务可以部分自动化。</p><p id="28a9" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">在本文中，我们将展示一个项目，这个项目是关于一个经过训练的模型，它可以自动从图片中读取电表。培训用的笔记本在谷歌<a class="ae kr" href="https://colab.research.google.com/drive/1doXXwpcZXNdBh0-u4ZpaBpWv9GOVDNpu" rel="noopener ugc nofollow" target="_blank"> Colab </a>上。结果显示在这个<a class="ae kr" href="http://dnalexen.pythonanywhere.com/" rel="noopener ugc nofollow" target="_blank"> web app </a>上，代码可以在这个<a class="ae kr" href="https://github.com/dnalexen/ai_water_meter_reading" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中获得。</p><p id="72d5" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">上面是一个仪表的图像，其指数读数为1357米。</p><h2 id="aeba" class="ml kt iq bd ku mm mn dn ky mo mp dp lc lt mq mr le lx ms mt lg mb mu mv li mw bi translated"><strong class="ak">目录</strong></h2><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d635" class="ml kt iq my b gy nc nd l ne nf">1. <a class="ae kr" href="#e39c" rel="noopener ugc nofollow">Presentation of the data set</a><br/>2. <a class="ae kr" href="#aff1" rel="noopener ugc nofollow">Goal of the project</a><br/>3. <a class="ae kr" href="#6825" rel="noopener ugc nofollow">Standard approach for automatic meter reading (AMR)</a><br/>4. <a class="ae kr" href="#6db9" rel="noopener ugc nofollow">Implementation of a YOLOv4 model</a><br/>5. <a class="ae kr" href="#9fb0" rel="noopener ugc nofollow">Conclusion</a><br/>6. <a class="ae kr" href="#9e94" rel="noopener ugc nofollow">Resources</a></span></pre></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="e39c" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated"><strong class="ak">数据集的展示</strong></h1><p id="841e" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">根据<a class="ae kr" href="https://www.etalab.gouv.fr/licence-ouverte-open-licence" rel="noopener ugc nofollow" target="_blank"> Etalab开放许可证</a>的条款<a class="ae kr" href="https://challengedata.ens.fr/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">数据集</a>、<a class="ae kr" href="https://challengedata.ens.fr/terms_of_use" rel="noopener ugc nofollow" target="_blank">开放</a>来自<a class="ae kr" href="https://www.suez.com/en" rel="noopener ugc nofollow" target="_blank">苏伊士</a>，这是一家总部位于法国的专门从事水和废物管理的公司。</p><p id="c48d" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">它具有:</p><ul class=""><li id="1801" class="ns nt iq lm b ln mg lq mh lt nu lx nv mb nw mf nx ny nz oa bi translated">由793张水表图片组成的训练集，由人工标注</li><li id="0566" class="ns nt iq lm b ln ob lq oc lt od lx oe mb of mf nx ny nz oa bi translated">416张水表图片的测试集</li></ul><div class="kg kh ki kj gt ab cb"><figure class="og kk oh oi oj ok ol paragraph-image"><img src="../Images/d7e05446185214ac59bee6e3af10d56c.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*kVRwbwOx8FaZTSoL"/></figure><figure class="og kk oh oi oj ok ol paragraph-image"><img src="../Images/a3511698835d42526da8acccb44b894a.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*1ad4mpgkbg2yaKnf"/><p class="kn ko gj gh gi kp kq bd b be z dk om di on oo translated">图片来自<a class="ae kr" href="https://challengedata.ens.fr/login/?next=/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">高等师范学校</a></p></figure></div></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="aff1" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated">项目的目标</h1><p id="b3a5" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">该项目的目标是读取以立方米为单位的确切用水量。如下图所示，立方米写在黑底白字上。一般来说，在我们的数据集中，水表显示两种类型的信息:</p><ul class=""><li id="1d68" class="ns nt iq lm b ln mg lq mh lt nu lx nv mb nw mf nx ny nz oa bi translated">消耗量的立方米数，黑色背景上的白色数字或相反的数字。这是我们需要从图片中提取的信息。</li><li id="24c9" class="ns nt iq lm b ln ob lq oc lt od lx oe mb of mf nx ny nz oa bi translated">消耗量的升数，数字为红底白字或相反。在读取指数时，仪表的这一部分将被忽略，因为在向消费者计费时，只有立方米是有用的。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/59e6ef35ea5d1ff10e1672c532d9f3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/0*wB11HP3TBE2zIMEe"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片来自<a class="ae kr" href="https://challengedata.ens.fr/login/?next=/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">高等师范学校</a></p></figure></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="6825" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated"><strong class="ak">自动抄表(AMR)的标准方法</strong></h1><p id="a075" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">用计算机读取仪表读数有三个主要步骤:</p><ul class=""><li id="0f82" class="ns nt iq lm b ln mg lq mh lt nu lx nv mb nw mf nx ny nz oa bi translated">仪表的定位</li><li id="1944" class="ns nt iq lm b ln ob lq oc lt od lx oe mb of mf nx ny nz oa bi translated">仪表中数字的检测</li><li id="b1ff" class="ns nt iq lm b ln ob lq oc lt od lx oe mb of mf nx ny nz oa bi translated">数字的分类</li></ul><p id="f6e9" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">我们的数据集面临许多挑战:</p><ul class=""><li id="2c63" class="ns nt iq lm b ln mg lq mh lt nu lx nv mb nw mf nx ny nz oa bi translated">这些照片是从不同的角度拍摄的</li><li id="4379" class="ns nt iq lm b ln ob lq oc lt od lx oe mb of mf nx ny nz oa bi translated">所有的图片都有不同的尺寸</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oq"><img src="../Images/4649d2d5b86c7ae8f3f776ebd00509d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fknNa4keyVG9BJTW"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">训练集和测试集中图像宽度的箱线图。图片由作者提供。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oq"><img src="../Images/6ff2d5272bf2e577a81934cf66bf43ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GLSekH38XF1jUfdE"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">训练集和测试集中图像高度的箱线图。图片由作者提供。</p></figure></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="6db9" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated"><strong class="ak">yolov 4型号的实施</strong></h1><p id="b280" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">因为YOLO是用于对象检测的最好的卷积神经网络(CNN)算法之一。我们决定用YOLOv4的PyTorch版本来实现我们的模型。</p><h2 id="d0b8" class="ml kt iq bd ku mm mn dn ky mo mp dp lc lt mq mr le lx ms mt lg mb mu mv li mw bi translated">给列车组的图片贴标签</h2><p id="fc82" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">我们定义了12类我们想要在图片上检测的对象:从0到9的10个数字，与升相对应的仪表部分，以及整个计数器。</p><p id="616a" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">我们通过画出找到的每个物体的边界框来标记每张图片。</p><p id="eb6e" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">下面的截图显示了一张标签在<a class="ae kr" href="https://labelbox.com/" rel="noopener ugc nofollow" target="_blank"> Labelbox </a>上的图片，这是一个可以标注数据的平台。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi ov"><img src="../Images/2ea0831c3bb2f1a614c3fb31765a407a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mjAZNj9SI21mopwI"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片来自<a class="ae kr" href="https://challengedata.ens.fr/login/?next=/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">高等师范学校</a></p></figure><p id="6530" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">从左到右，我们注释了两个类的对象<code class="fe ow ox oy my b">0</code>，两个类的对象<code class="fe ow ox oy my b">8</code>，一个类的对象<code class="fe ow ox oy my b">6</code>，一个类的对象<code class="fe ow ox oy my b">liters</code>，<strong class="lm ir"> </strong>和一个类的对象<code class="fe ow ox oy my b">counter</code>，它包含了前面所有的六个对象。所以在这幅图中，我们总共有七个物体。</p><h2 id="e8ad" class="ml kt iq bd ku mm mn dn ky mo mp dp lc lt mq mr le lx ms mt lg mb mu mv li mw bi translated">图片的预处理</h2><p id="78e9" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">由于图片的形状不同，我们决定将它们的大小调整为608x608。我们对<a class="ae kr" href="https://roboflow.com/" rel="noopener ugc nofollow" target="_blank"> Roboflow </a>进行了放大，随机将图片顺时针旋转90°，逆时针旋转90°，然后上下颠倒。</p><p id="33a6" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">Roboflow是一个平台，开发者可以用你的数据来管理他们的计算机视觉项目。它允许你将你的图像与在<a class="ae kr" href="https://labelbox.com/" rel="noopener ugc nofollow" target="_blank">标签盒</a>上完成的注释整合在一起，并在你的图像上应用一些变换。</p><h2 id="3fd8" class="ml kt iq bd ku mm mn dn ky mo mp dp lc lt mq mr le lx ms mt lg mb mu mv li mw bi translated">训练模型</h2><p id="bbf5" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">我们用由<a class="ae kr" href="https://roboflow.com/" rel="noopener ugc nofollow" target="_blank"> Roboflow </a>准备的笔记本在<a class="ae kr" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌实验室</a>上进行了培训。</p><p id="15b2" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">以下是TensorBoard绘制的过去100个纪元的损失图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oz"><img src="../Images/a3a3ed53dcdd9e5affc136f7e9a6cca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kej3oI2f_0oTPq12"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">TensorBoard的损失图。图片由作者提供。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi pa"><img src="../Images/eca01058eeb43f1b72cfcd2b0cae123e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PSKnE6BacISeG48z"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">TensorBoard的损失图。图片由作者提供。</p></figure><p id="97d3" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">该指标是一个经过修改的<a class="ae kr" href="https://link.springer.com/10.1007%2F978-0-387-30164-8_884" rel="noopener ugc nofollow" target="_blank">零一损耗</a>，因为读数应该是准确的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/caf263f82a336c49dc0fb9840407c268.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/0*7kpX-NcgbS2P4IDT"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图片来自<a class="ae kr" href="https://challengedata.ens.fr/login/?next=/participants/challenges/30/" rel="noopener ugc nofollow" target="_blank">高等师范学校</a></p></figure><p id="3488" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">⌊⋅⌋是浮点数的整数部分。</p><p id="43f6" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">将500个时期的训练分成四个阶段，每个阶段100个时期，我们在测试集上达到了0.63的分数。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="9fb0" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated"><strong class="ak">结论</strong></h1><p id="b33e" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">在本文中，我们展示了使用基于YOLOv4的模型读取水表的方法。我们面临的主要问题是一些数字之间的混淆。一些改进的空间可能是更多的增强，如模糊，亮度和噪声。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="9e94" class="ks kt iq bd ku kv nn kx ky kz no lb lc jw np jx le jz nq ka lg kc nr kd li lj bi translated"><strong class="ak">资源</strong></h1><p id="25f2" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">[1] <strong class="lm ir"> </strong> R. Laroca，V. Barroso，M. A. Diniz，G. Gonç alves，W. R. Schwartz，D. Menotti，<a class="ae kr" href="https://www.researchgate.net/publication/330884234_Convolutional_Neural_Networks_for_Automatic_Meter_Reading" rel="noopener ugc nofollow" target="_blank">用于自动抄表的卷积神经网络</a> (2019)，电子成像杂志</p><p id="5191" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">【2】<strong class="lm ir"/>j . Solawetz，J. Nelson，<a class="ae kr" href="https://blog.roboflow.com/training-yolov4-on-a-custom-dataset/" rel="noopener ugc nofollow" target="_blank">如何在自定义数据集上训练yolov 4</a>(2020)，<a class="ae kr" href="https://blog.roboflow.com/" rel="noopener ugc nofollow" target="_blank">https://blog.roboflow.com/</a></p></div></div>    
</body>
</html>