<html>
<head>
<title>How To Publish a React Component Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何发布React组件库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-publish-a-react-component-library-c89a07566770?source=collection_archive---------8-----------------------#2020-01-08">https://betterprogramming.pub/how-to-publish-a-react-component-library-c89a07566770?source=collection_archive---------8-----------------------#2020-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8439" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">既然你已经创造了一些有用的东西，那就和全世界分享吧</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/378ad22db7149c1aa7b2976a8d03003e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgzX0xxBdcR7N_AI0etDnQ.png"/></div></div></figure><ul class=""><li id="41e6" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">GitHub回购:<a class="ae lj" href="https://github.com/leon0707/demo-component" rel="noopener ugc nofollow" target="_blank">https://github.com/leon0707/demo-component</a></li></ul><p id="f465" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">您已经在React项目中创建了一个非常有用的组件。你想与开源世界分享它，并希望它能帮助其他开发者。</p><p id="992c" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">最常见的方法是将其发布到<a class="ae lj" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>中，JavaScript开发人员可以在那里轻松下载JS库并将其导入到他们的项目中。</p><p id="2cac" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">本文将一步一步地演示如何做到这一点，并强调您可能会遇到的潜在问题。</p><p id="32a3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">让我们创建一个更复杂的场景，以便它更接近真实世界的项目。</p><ol class=""><li id="b480" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lx lg lh li bi translated">在<code class="fe ly lz ma mb b">DemoComponent</code>中，它导入CSS和图像文件，并使用其他React库。</li><li id="1373" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lx lg lh li bi translated">当使用<a class="ae lj" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel </a>编译React组件时，您不希望在编译时包含所有依赖项，如React、react-dom。不仅会增加包的大小，而且拥有React的多个副本也会导致错误。</li></ol></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="7ad4" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">首先，创建一个React组件项目</h1><p id="bd39" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">在本地开发环境中创建项目目录，在GitHub.com上创建存储库。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="0549" class="np mp iq mb b gy nq nr l ns nt">mkdir react-democomponent<br/>cd react-democomponent<br/>mkdir src<br/>npm init</span></pre><p id="3a1a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">使用默认值创建<code class="fe ly lz ma mb b">package.json</code>文件是可以的。这些价值观将来会改变。</p><p id="685f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">该目录将如下所示:</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="1e1f" class="np mp iq mb b gy nq nr l ns nt">/react-democomponent<br/>--- /src<br/>--- .gitignore<br/>--- LICENSE<br/>--- package.json<br/>--- README.md</span></pre><p id="0887" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这将是一个React项目，所以我们需要先安装React和<code class="fe ly lz ma mb b">prop-types</code>。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="91fb" class="np mp iq mb b gy nq nr l ns nt">npm install --save-dev react prop-types</span></pre><p id="ee23" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">选择您已经创建的组件或复制<a class="ae lj" href="https://github.com/leon0707/demo-component/tree/master/src" rel="noopener ugc nofollow" target="_blank">演示组件</a>并将其移动到<code class="fe ly lz ma mb b">src</code>文件夹中。</p><p id="8eb6" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><code class="fe ly lz ma mb b">DemoComponent</code>有三个部分:</p><ul class=""><li id="5377" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">反应组件本身。</li><li id="15a6" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated">样式文件。</li><li id="77d5" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated">SVG图像文件。</li></ul><p id="c6e3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">目标是创建一个包含所有这些内容的JS文件，这样就可以将它导入到其他React项目中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9b64" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这个组件很简单，看起来像一个下载按钮。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="ece4" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">第二步。编译组件</h1><p id="73a6" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">有些浏览器不会理解最新的ECMAScript和React JSX语法，因此有必要将ES6、ES7、ES8代码或JSX转换为向后兼容版本的JavaScript代码。<a class="ae lj" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank">巴别塔</a>会这样做。</p><p id="1578" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">安装Babel依赖项并创建一个Babel配置文件。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="142d" class="np mp iq mb b gy nq nr l ns nt">npm install --save-dev @babel/cli @babel/core @babel/preset-env @babel/preset-react</span></pre><p id="3846" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><code class="fe ly lz ma mb b">.babelrc</code>文件。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="b7b6" class="np mp iq mb b gy nq nr l ns nt">{<br/>  "presets": ["@babel/preset-env", "@babel/preset-react"]<br/>}</span></pre><p id="b938" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><code class="fe ly lz ma mb b">@babel/preset-env</code>将所有利用最新JavaScript特性的代码转换成与不支持最新JavaScript特性的浏览器兼容的代码。</p><p id="243e" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这个插件也可以使捆绑文件变小。开发人员可以指定代码兼容的浏览器的最小版本。更多详情:<a class="ae lj" href="https://babeljs.io/docs/en/babel-preset-env" rel="noopener ugc nofollow" target="_blank">巴别塔文档</a>。</p><p id="2288" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><code class="fe ly lz ma mb b">@babel/preset-react</code>将最新的JSX转换成JavaScript代码。更多细节:<a class="ae lj" href="https://babeljs.io/docs/en/babel-preset-react" rel="noopener ugc nofollow" target="_blank">巴别塔文件</a>。</p><p id="3f25" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在<code class="fe ly lz ma mb b">DemoComponent</code>中，创建了一个类别属性<code class="fe ly lz ma mb b">handleOnClick</code>。<a class="ae lj" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Class_fields" rel="noopener ugc nofollow" target="_blank">类属性仍然是一个实验特性</a>，还不支持。为了让它在组件中工作，你必须添加一个Babel插件。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="48f0" class="np mp iq mb b gy nq nr l ns nt">npm install --save-dev @babel/plugin-proposal-class-properties</span></pre><p id="4b8a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">将<code class="fe ly lz ma mb b">"plugins": ["@babel/plugin-proposal-class-properties"]</code>添加到<code class="fe ly lz ma mb b">.babelrc</code>文件中。</p><p id="2142" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">如果插件未启用，将会引发错误:</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="3e31" class="np mp iq mb b gy nq nr l ns nt">ERROR in ./src/DemoComponent.js<br/>Module build failed (from ./node_modules/babel-loader/lib/index.js):<br/>SyntaxError: Support for the experimental syntax ‘classProperties’ isn’t currently enabled.</span></pre><p id="a824" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">webpack是一个面向现代JavaScript应用的静态模块捆绑器。我们需要做的就是创建一个webpack配置文件。</p><p id="358f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">安装webpack和webpack CLI工具。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="9b23" class="np mp iq mb b gy nq nr l ns nt">npm install --save-dev webpack webpack-cli</span></pre><p id="aa91" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><code class="fe ly lz ma mb b">webpack.config.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="5409" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><code class="fe ly lz ma mb b">entry</code>对象是webpack开始构建包的地方。</li><li id="6b50" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated"><code class="fe ly lz ma mb b">output</code>对象告诉webpack在哪里发出它创建的包，以及如何命名这些文件。</li><li id="59af" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated"><code class="fe ly lz ma mb b">loader</code>允许webpack处理其他类型的文件，并将它们转换成有效的模块，供您的应用程序使用，并添加到依赖图中。</li></ul><p id="7669" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在该项目中，使用了四台装载机:</p><ul class=""><li id="9fc5" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><code class="fe ly lz ma mb b">babel-loader</code>trans files JavaScript文件。</li><li id="c3d7" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated"><code class="fe ly lz ma mb b">style-loader</code>和<code class="fe ly lz ma mb b">css-loader</code>加载CSS样式表并注入DOM。</li><li id="74c9" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lf lg lh li bi translated"><code class="fe ly lz ma mb b">url-loader</code>将文件转换为base64 URIs。</li></ul><p id="b32d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">需要安装这些软件包。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="10df" class="np mp iq mb b gy nq nr l ns nt">npm install --save-dev babel-loader style-loader css-loader url-loader</span></pre><p id="8cc8" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在<code class="fe ly lz ma mb b">package.json</code>中增加<code class="fe ly lz ma mb b">build</code>。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="7a7a" class="np mp iq mb b gy nq nr l ns nt">...<br/>"scripts": {<br/>    "build": "webpack --mode production --display-modules"<br/>},<br/>...</span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="fca5" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">构建包</h1><p id="3b72" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">现在您可以构建这个包了。</p><p id="2bcd" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">运行<code class="fe ly lz ma mb b">npm run-script build</code>，在<code class="fe ly lz ma mb b">dist</code>下已经创建了<code class="fe ly lz ma mb b">main.js</code>。这是将在npm注册表上分发的文件，其他人可以搜索和下载该文件。</p><p id="966f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这是日志:</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="030b" class="np mp iq mb b gy nq nr l ns nt">Hash: 869e38eb4f7cf4851eb0<br/>Version: webpack 4.41.5<br/>Time: 1613ms<br/>Built at: 01/07/2020 7:59:49 PM<br/>  Asset      Size  Chunks             Chunk Names<br/>main.js  18.8 KiB       0  [emitted]  main<br/>Entrypoint main = main.js<br/> [0] ./node_modules/react/index.js 190 bytes {0} [built]<br/> [1] ./node_modules/prop-types/index.js 710 bytes {0} [built]<br/> [2] ./node_modules/react/cjs/react.production.min.js 6.49 KiB {0} [built]<br/> [3] ./node_modules/object-assign/index.js 2.06 KiB {0} [built]<br/> [4] ./node_modules/prop-types/factoryWithThrowingShims.js 1.58 KiB {0} [built]<br/> [5] ./node_modules/prop-types/lib/ReactPropTypesSecret.js 314 bytes {0} [built]<br/> [6] ./src/DemoComponent.css 580 bytes {0} [built]<br/> [7] ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js 5.83 KiB {0} [built]<br/> [8] ./node_modules/css-loader/dist/cjs.js!./src/DemoComponent.css 276 bytes {0} [built]<br/> [9] ./node_modules/css-loader/dist/runtime/api.js 2.04 KiB {0} [built]<br/>[10] ./src/DemoComponent.js + 1 modules 8.11 KiB {0} [built]<br/>     | ./src/DemoComponent.js 3.32 KiB [built]<br/>     | ./src/logo.png 4.77 KiB [built]</span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="ea0c" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">第三步。在本地测试</h1><p id="b69d" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">这很简单。您需要导入这个React组件，并在React项目中使用它。</p><p id="0d98" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">更新<code class="fe ly lz ma mb b">package.json</code>文件，向其中添加有意义的信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="dd0d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">用您自己的信息替换这些值。注意，<code class="fe ly lz ma mb b">main</code>应该指向构建的JS文件。</p><p id="561f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">运行<code class="fe ly lz ma mb b">npm link</code>在全局文件夹中创建一个链接到这个包的符号链接。</p><p id="52d7" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">要将这个包导入到您的React项目中，您需要转到React项目的目录并运行<code class="fe ly lz ma mb b">npm link react-download-button</code>或<code class="fe ly lz ma mb b">package.json</code>中的名称。</p><p id="2823" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">导入包。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="a327" class="np mp iq mb b gy nq nr l ns nt">import DemoComponent from 'react-download-button';</span></pre><p id="c25d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">此时，将会抛出一个错误，因为有两个React实例。一个在您的React项目中，另一个在您创建的包中。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="da5f" class="np mp iq mb b gy nq nr l ns nt">Error: Minified React error #321</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/98faf083d2f5cd94a2b86e64b5b92cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3RFPNbfduTeg1xnDTGYFg.png"/></div></div></figure><p id="b3b0" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这是真的。如果你查看建筑日志或者打开编辑器中的<code class="fe ly lz ma mb b">main.js</code>，你可以找到<code class="fe ly lz ma mb b">react.production.min.js</code>。</p><p id="3230" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">要解决这个问题，您需要:</p><ol class=""><li id="1e93" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lx lg lh li bi translated">从包文件中删除<code class="fe ly lz ma mb b">react.production.min.js</code>。</li><li id="2d15" class="kr ks iq kt b ku mc kw md ky me la mf lc mg le lx lg lh li bi translated">告诉React项目的webpack您想要使用哪个React实例。</li></ol><h2 id="246f" class="np mp iq bd mq nx ny dn mu nz oa dp my ky ob oc na la od oe nc lc of og ne oh bi translated"><strong class="ak">第一步</strong></h2><p id="06af" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">检查构建日志，有一些包不应该包含在包文件中。它们增加了包的大小并导致不必要的问题。</p><p id="3b73" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">比如<code class="fe ly lz ma mb b">react</code>、<code class="fe ly lz ma mb b">prop-types</code>，就不应该包括在内。您可以通过添加<code class="fe ly lz ma mb b">webpacke-node-externals</code>轻松排除它们或其他包。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="5d1c" class="np mp iq mb b gy nq nr l ns nt">npm install --save <!-- -->webpacke-node-externals</span></pre><p id="a677" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">更新包中的<code class="fe ly lz ma mb b">webpack.config.js</code>。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="e660" class="np mp iq mb b gy nq nr l ns nt">const nodeExternals = require('webpack-node-externals');</span><span id="c9ab" class="np mp iq mb b gy oi nr l ns nt">module.exports = {<br/>  ...<br/>  target: 'node',<br/>  externals: [nodeExternals()]<br/>}</span></pre><p id="24f8" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">运行<code class="fe ly lz ma mb b">npm run-script build</code>重建捆绑文件。这一次，文件中不再有<code class="fe ly lz ma mb b">react</code>和<code class="fe ly lz ma mb b">props-types</code>。但是，React项目应该有它们，这些需要在<code class="fe ly lz ma mb b">package.json</code>中指定。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="ca85" class="np mp iq mb b gy nq nr l ns nt">"peerDependencies": {<br/>   "react": "^16.12.0",<br/>   "prop-types": "^15.7.2"<br/>}</span></pre><h2 id="0b76" class="np mp iq bd mq nx ny dn mu nz oa dp my ky ob oc na la od oe nc lc of og ne oh bi translated"><strong class="ak">第二步</strong></h2><p id="7a90" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">在React项目文件中，更新webpack配置文件。</p><pre class="kg kh ki kj gt nl mb nm nn aw no bi"><span id="19cf" class="np mp iq mb b gy nq nr l ns nt">  "resolve" = {<br/>    alias: {<br/>      react: path.resolve('./node_modules/react')<br/>    }<br/>  }</span></pre><p id="2080" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这将告诉webpack使用本地React，而不是<code class="fe ly lz ma mb b">DemoComponent</code>目录中的React。</p><p id="07b9" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">现在，您创建的包可以在任何React项目中使用。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="82ef" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">第四步。在npm上发布</h1><p id="b525" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">建议有一个有用的自述文件来演示如何使用您的包以及您希望其他开发人员知道的细节。</p><p id="b88b" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">一旦你认为一切看起来都很完美，就去https://www.npmjs.com/注册并验证邮件。</p><p id="1a13" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">然后，转到包目录运行<code class="fe ly lz ma mb b">npm login</code>和<code class="fe ly lz ma mb b">npm publish</code>。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="4ad8" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">结束</h1><p id="336f" class="pw-post-body-paragraph lk ll iq kt b ku ng jr lm kw nh ju ln ky ni lp lq la nj ls lt lc nk lv lw le ij bi translated">您应该可以看到您的包发布在npmjs.com上，并且可以通过运行<code class="fe ly lz ma mb b">npm install &lt;package name&gt;</code>下载。</p></div></div>    
</body>
</html>