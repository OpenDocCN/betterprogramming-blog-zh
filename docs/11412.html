<html>
<head>
<title>How to Use Rust Structs, Methods (Impl), and Traits With Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">举例说明如何使用Rust结构、方法(Impl)和特征</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/learn-rust-by-example-structs-methods-impl-and-traits-de11e8d02b68?source=collection_archive---------2-----------------------#2022-03-17">https://betterprogramming.pub/learn-rust-by-example-structs-methods-impl-and-traits-de11e8d02b68?source=collection_archive---------2-----------------------#2022-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dea3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">生锈的例子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/44f808ffdba3ee387ec6e3d62566e7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N30miaz4DxUTTVRp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@miniminion?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">菲利斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1508" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我总是发现，当学习一门编程语言时，如果所提供的例子反映了真实世界的用例，会很有帮助。不幸的是，这类例子没有提供或者很难找到。</p><p id="56a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，Rust编程语言手册中的“<a class="ae ky" href="https://doc.rust-lang.org/book/ch05-01-defining-structs.html" rel="noopener ugc nofollow" target="_blank">定义和实例化结构</a>”一节提供了一个例子，其中定义了结构，然后通过为代码本身中的每个字段指定一个值来创建该结构的实例。在现实世界中，没有一个程序员会因为一个显而易见的原因而这样做。它也没有解释如何在代码中使用结构。</p><p id="da18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我需要这篇文章的特色图片，下面是一个结构的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/146a357500b43756658364b43ca4f3f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KASLClaTCH8scKrbjmL6jg.png"/></div></div></figure><p id="c55e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开始撰写文章之前，让我们先通过提供结构的概述和在代码中使用结构的用例来了解一些日常工作。所有源代码也可以在GitHub = &gt;<a class="ae ky" href="https://github.com/sungkim11/rust-struct" rel="noopener ugc nofollow" target="_blank">https://github.com/sungkim11/rust-struct</a>上获得。</p><h1 id="b0bc" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结构</h1><p id="76fc" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">结构是用户定义的类型，我们可以用它来存储一个或多个不同类型的变量。一个结构允许我们将相关的代码组合在一起，并按照<a class="ae ky" href="https://www.koderhq.com/tutorial/rust/struct/" rel="noopener ugc nofollow" target="_blank">https://www.koderhq.com/tutorial/rust/struct/</a>按照现实世界中的实体来建模我们的应用程序。</p><p id="9852" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结构的一个例子是:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3c30" class="my lx it mu b gy mz na l nb nc">struct User {<br/>     active: bool,     <br/>     username: String,     <br/>     email: String,     <br/>     sign_in_count: u64, <br/>}</span></pre><h2 id="093c" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">你会在哪里使用结构？</h2><p id="bf0d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">使用结构的一个很好的用例是调用REST API，其中响应以JSON格式返回。JSON格式的一个例子是:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9340" class="my lx it mu b gy mz na l nb nc">{<br/>  <strong class="mu iu">"active"</strong>: true<br/>  <strong class="mu iu">"username"</strong>: "user",<br/>  <strong class="mu iu">"email"</strong>: "user@user.com", <br/>  "<strong class="mu iu">sign_in_count"</strong>: 2<br/>}</span></pre><p id="9c04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您从上面看到的，Struct类似于JSON，您可以将JSON值映射到Struct。在现实世界中，结构用于解析JSON值。通常称为反序列化/解码将JSON转换为struct，序列化/编码将struct转换为JSON。</p><h1 id="d64c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">先决条件</h1><h2 id="5465" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">比特币基地休息API</h2><p id="d725" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将开发一个应用程序，通过https://developers.coinbase.com/api/v2#data-endpoints的比特币基地REST API(<a class="ae ky" href="https://developers.coinbase.com/api/v2#data-endpoints" rel="noopener ugc nofollow" target="_blank"/>)获得比特币的美元或BTC美元价格。</p><p id="db2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个简单的应用程序，调用比特币基地REST API，解析REST API响应，然后打印出BTC-美元价格。</p><p id="5bec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要调用比特币基地REST API，只需将以下URL复制并粘贴到您的浏览器中:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9b0d" class="my lx it mu b gy mz na l nb nc"><a class="ae ky" href="https://api.coinbase.com/v2/prices/:currency_pair/spot" rel="noopener ugc nofollow" target="_blank">https://api.coinbase.com/v2/prices/BTC-USD/spot</a></span></pre><p id="6817" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，它应该返回或下载包含以下内容的JSON格式的<code class="fe no np nq mu b">response.json</code>文件，该文件提供了即期价格以及“基础货币”或“BTC-美元”。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="29c5" class="my lx it mu b gy mz na l nb nc">{<br/>     "data":{<br/>          "base":"BTC",<br/>          "currency":"USD",<br/>          "amount":"40731.94"<br/>     }<br/>}</span></pre><h2 id="391f" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">铁锈板条箱</h2><p id="44a8" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在我们开始开发应用程序之前，我们需要添加两个Rust板条箱:</p><ul class=""><li id="b48a" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">Serde:它是一个有效和通用地序列化和反序列化Rust数据结构的框架。他们的crates.io网址是<a class="ae ky" href="https://crates.io/crates/serde" rel="noopener ugc nofollow" target="_blank">https://crates.io/crates/serde</a>。Serde用于将JSON数据映射到Rust数据结构或Struct。它用于将JSON反序列化或转换为struct，并将struct序列化或转换为JSON。</li><li id="5967" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">Reqwest</code>:是Rust的HTTP客户端。他们的crates.io网址是<a class="ae ky" href="https://crates.io/crates/reqwest" rel="noopener ugc nofollow" target="_blank">https://crates.io/crates/reqwest</a>。<code class="fe no np nq mu b">Reqwest</code>是用来向比特币基地发出HTTPS请求的REST API。</li></ul><p id="6e33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<code class="fe no np nq mu b">Cargo.toml</code>被修改为包括如下两个板条箱:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="01ce" class="my lx it mu b gy mz na l nb nc">[package]<br/>name = "rust-struct"<br/>version = "0.1.0"<br/>edition = "2021"</span><span id="75ec" class="my lx it mu b gy of na l nb nc"># See more keys and their definitions at <a class="ae ky" href="https://doc.rust-lang.org/cargo/reference/manifest.html" rel="noopener ugc nofollow" target="_blank">https://doc.rust-lang.org/cargo/reference/manifest.html</a></span><span id="3d69" class="my lx it mu b gy of na l nb nc">[dependencies]<br/>serde = { version = "1.0.136", features = ["derive"] }<br/>reqwest = { version = "0.11", features = ["blocking", "json"] }</span></pre><h1 id="7d52" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">学习如何使用Rust结构、方法(Impl)和特征</h1><p id="90ad" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在本文中，我们将使用现实世界中的例子来说明以下教训:</p><ul class=""><li id="80a6" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">第1课:定义结构</li><li id="cb48" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">第2课:将结构传递给函数</li><li id="07df" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">第3课:将方法(impl)定义为结构</li><li id="8275" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">第4课:将特征定义为结构</li><li id="795e" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">第五课:结合所有课程</li></ul><h2 id="8761" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">第1课:定义结构</h2><p id="b7a5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们通过镜像JSON数据结构来定义Rust Struct。</p><p id="f7eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> JSON (response.json) </strong></p><p id="f658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下JSON具有如下所示的层次结构或嵌套结构:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4b56" class="my lx it mu b gy mz na l nb nc">{<br/>     "data":{<br/>          "base":"BTC",<br/>          "currency":"USD",<br/>          "amount":"40731.94"<br/>     }<br/>}</span></pre><p id="fac5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">锈蚀结构</strong></p><p id="e9d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Rust Struct通过创建两个结构来支持嵌套结构，其中数据类型<em class="og">“coin price”</em>用于复制JSON的嵌套结构。</p><p id="4df3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，它实现Serde的反序列化，将JSON数据映射到Rust Struct。从JSON文件创建struct的最简单的方法是转到quick type(<a class="ae ky" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank">https://app.quicktype.io/</a>)然后复制JSON作为源并指定Rust作为目标。我修改了结构名以满足我的需要。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d251" class="my lx it mu b gy mz na l nb nc">#[derive(Serialize, Deserialize, Debug)]<br/>pub struct CoinbasePrice {<br/>    pub data: <strong class="mu iu">CoinPrice</strong><br/>}</span><span id="0884" class="my lx it mu b gy of na l nb nc">#[derive(Serialize, Deserialize, Debug)]<br/>pub struct <strong class="mu iu">CoinPrice</strong> {<br/>    pub base: String,<br/>    pub currency: String,<br/>    pub amount: String,<br/>}</span></pre><p id="1c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> REST API请求</strong></p><p id="e2f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们定义了结构之后，我们将需要发出REST API请求。这是通过reqwest::Client完成的，在代码中反映为:</p><ul class=""><li id="4af3" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">创建一个新的客户端— <code class="fe no np nq mu b">let client = Client::new();</code></li><li id="6536" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">发出REST API请求— <code class="fe no np nq mu b">let resp_spot_price = client.get(&amp;spot_url).send();</code></li></ul><p id="fdf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中它将响应分配给一个变量，称为<code class="fe no np nq mu b">resp_spot_price</code>。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="50bb" class="my lx it mu b gy mz na l nb nc">let spot_url = format!("https://api.coinbase.com/v2/prices/{currency}-{rates}/spot",          <br/>     currency = "BTC",<br/>     rates = "USD");     </span><span id="9477" class="my lx it mu b gy of na l nb nc">let client = Client::new();    <br/>let resp_spot_price = client.get(&amp;spot_url)        <br/>     .send();</span></pre><p id="cb79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解析REST API JSON响应</strong></p><p id="888f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们发出REST API请求后，我们使用</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9e94" class="my lx it mu b gy mz na l nb nc">match {<br/>     Ok()<br/>     Err ()<br/>}  </span></pre><p id="3ee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为<code class="fe no np nq mu b">resp_spot_price</code>是一个值，所以它被包装在<code class="fe no np nq mu b">Result</code>类型中。</p><p id="cf81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以通过将JSON响应分配给CoinbasePrice类型的变量，将JSON响应(即值)解析为一个结构。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b887" class="my lx it mu b gy mz na l nb nc">match resp_spot_price {        <br/>     Ok(parsed_spot_price) =&gt; {<br/>          let coinprice = parsed_spot_price.json::&lt;CoinbasePrice&gt;().unwrap();  </span></pre><p id="8617" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">将JSON响应分配给结构</strong></p><p id="22ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意<code class="fe no np nq mu b">CoinbasePrice</code>结构的结构如下:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="26f1" class="my lx it mu b gy mz na l nb nc">CoinbasePrice<br/>     data<br/>          base<br/>          currency<br/>          amount</span></pre><p id="3207" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们解析了对<code class="fe no np nq mu b">CoinbasePrice</code>结构的JSON响应之后，我们可以将来自<code class="fe no np nq mu b">CoinbasePrice</code>结构的值赋给<code class="fe no np nq mu b">CoinPrice</code>结构。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="31c7" class="my lx it mu b gy mz na l nb nc">let spot_price = CoinPrice {<br/>     base: coinprice.data.base,<br/>     currency: coinprice.data.currency,<br/>     amount: coinprice.data.amount            <br/>};</span></pre><p id="8f59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">打印加密价格</strong></p><p id="a02d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，使用<code class="fe no np nq mu b">CoinPrice</code> struct打印出加密价格，这意味着base = spot_price.base。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f879" class="my lx it mu b gy mz na l nb nc">println!("SPOT: {base}-{currency}: {amount}",<br/>     base=spot_price.base,                   <br/>     currency=spot_price.currency,                <br/>     amount=spot_price.amount);</span></pre><p id="e68d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">完成代码</strong></p><p id="3bec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，下面提供了完整的代码，其中有两个文件:</p><ul class=""><li id="279f" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe no np nq mu b">main.rs</code>:只调用<code class="fe no np nq mu b">rust_struct_1.rs</code>中的<code class="fe no np nq mu b">rust_struct_1</code>函数</li><li id="76e6" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">rust_struct_1.rs</code></li></ul><p id="c360" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">main.rs</code>的代码是</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c5bc" class="my lx it mu b gy mz na l nb nc">//Lesson 1: Structs<br/>//Declare Modules<br/>mod rust_struct_1;<br/>//Call Lesson 1: Structs<br/>fn main() {<br/>       rust_struct_1::rust_struct_1(); <br/>}</span></pre><p id="21e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">rust_struct_1.rs</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="7e9b" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">第2课:将结构传递给函数</h2><p id="332e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们详细阐述了上一课添加一个函数，其中我们将struct实例传递给一个函数。</p><p id="4eab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个函数只是将打印功能从主代码块转移到一个函数中，以演示如何将struct实例传递给一个以struct name ( <code class="fe no np nq mu b">CoinPrice</code>)作为参数的函数。</p><p id="b17d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主代码块中的代码片段:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a2e4" class="my lx it mu b gy mz na l nb nc">println!("SPOT: {base}-{currency}: {amount}",<br/>     base=spot_price.base,<br/>     currency=spot_price.currency,<br/>     amount=spot_price.amount);</span></pre><p id="4d83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将结构名(<code class="fe no np nq mu b">CoinPrice</code>)作为参数的函数<code class="fe no np nq mu b">print_coin_price</code>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1264" class="my lx it mu b gy mz na l nb nc">fn print_coin_price(coin_price:CoinPrice) {<br/>     println!("SPOT: {base}-{currency}: {amount}",<br/>          base=coin_price.base,<br/>          currency=coin_price.currency,<br/>          amount=coin_price.amount);<br/>}</span></pre><p id="e45a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">完成代码</strong></p><p id="dde4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，下面提供了完整的代码，其中有两个文件:</p><ul class=""><li id="d7e3" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe no np nq mu b">main.rs</code>:只调用<code class="fe no np nq mu b">rust_struct_2.rs</code>中的<code class="fe no np nq mu b">rust_struct_2</code>函数</li><li id="bb69" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">rust_struct_2.rs</code></li></ul><p id="ed26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">main.rs</code>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5d46" class="my lx it mu b gy mz na l nb nc">//Lesson 2: Pass Structs to Function<br/>//Declare Modules<br/>mod rust_struct_1;<br/>//Call Lesson 2: Pass Structs to Function<br/>fn main() {<br/>       rust_struct_2::rust_struct_2(); <br/>}</span></pre><p id="434d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">rust_struct_2.rs</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="b8b0" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">第3课:将方法(impl)定义为结构</h2><p id="3b98" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们可以在结构中增加一个函数。这些函数通常被称为方法，并且仅可用于结构的实例。为了定义一个方法，我们使用关键字<code class="fe no np nq mu b">impl</code> <em class="og"> </em>用struct<em class="og">(</em><code class="fe no np nq mu b">CoinPrice</code><em class="og">)</em>的包装器修改了函数<code class="fe no np nq mu b">print_coin_price</code>，并将参数改为self。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="fb6c" class="my lx it mu b gy mz na l nb nc">impl CoinPrice {<br/>     fn print_coinprice(self) {<br/>          println!("SPOT: {base}-{currency}: {amount}",<br/>               base=self.base,<br/>               currency=self.currency,<br/>               amount=self.amount);<br/>    }<br/>}</span></pre><p id="fb8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们已经向struct添加了一个方法，所以要调用这个方法，我们只需使用:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1921" class="my lx it mu b gy mz na l nb nc">pot_price.print_coinprice();</span></pre><p id="0414" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">完成代码</strong></p><p id="1305" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，下面提供了完整的代码，其中有两个文件:</p><ul class=""><li id="ce0f" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe no np nq mu b">main.rs</code>:它只是调用<code class="fe no np nq mu b">rust_struct_3.rs</code>中的<code class="fe no np nq mu b">rust_struct_3</code>函数</li><li id="6013" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">rust_struct_3.rs</code></li></ul><p id="3916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">main.rs</code>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="41e8" class="my lx it mu b gy mz na l nb nc">//Lesson 3: Define Method (impl) to Struct<br/>//Declare Modules<br/>mod rust_struct_1;<br/>//Call Lesson 3: Define Method (impl) to Struct<br/>fn main() {<br/>       rust_struct_3::rust_struct_3(); <br/>}</span></pre><p id="1245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">rust_struct_3.rs</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="231e" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">第4课:将特征定义为结构</h2><p id="6b10" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">一个结构可以有多个方法。特征用于声明和分组这些方法。</p><p id="8f0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">定义特性</strong></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6697" class="my lx it mu b gy mz na l nb nc">pub trait Price {<br/>     fn format_coinprice(&amp;self) -&gt; String;<br/>     fn return_coinprice(&amp;self) -&gt; String;<br/>}</span></pre><p id="33b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">为Struct实现Trait(<em class="og">coin price</em>)</strong></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0c20" class="my lx it mu b gy mz na l nb nc">impl Price for CoinPrice {<br/>     fn format_coinprice(&amp;self) -&gt; String {<br/>          return format!("SPOT: {base}-{currency}: {amount}",<br/>               base=self.base,<br/>               currency=self.currency,<br/>               amount=self.amount);<br/>}<br/>     fn return_coinprice(&amp;self) -&gt; String {<br/>          return format!("SPOT: {amount}",<br/>               amount=self.amount);<br/>     }<br/>}</span></pre><p id="eb98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">调用特征</strong>中的Struct (" <em class="og"> CoinPrice </em>")方法</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d7d5" class="my lx it mu b gy mz na l nb nc">println!("{}", spot_price.format_coinprice());<br/>println!("{}", spot_price.return_coinprice());</span></pre><h2 id="6d7f" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated"><strong class="ak">完成代码</strong></h2><p id="ac3b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">最后，下面提供了完整的代码，其中有两个文件:</p><ul class=""><li id="d572" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe no np nq mu b">main.rs</code>:只调用<code class="fe no np nq mu b">rust_struct_4.rs</code>中的<code class="fe no np nq mu b">rust_struct_4</code>函数</li><li id="8043" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">rust_struct_4.rs</code></li></ul><p id="d659" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">main.rs</code>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4a66" class="my lx it mu b gy mz na l nb nc">//Lesson 4: Define Trait to Struct<br/>//Declare Modules<br/>mod rust_struct_1;<br/>//Call Lesson 4: Define Trait to Struct<br/>fn main() {<br/>       rust_struct_4::rust_struct_4(); <br/>}</span></pre><p id="0467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">rust_struct_4.rs</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="2d3e" class="my lx it bd ly nd ne dn mc nf ng dp mg li nh ni mi lm nj nk mk lq nl nm mm nn bi translated">第五课:结合所有课程</h2><p id="eec0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">最后，我们结合前面的所有课程来实现结构、方法(Impl)和特征。代码已经过修改，包含了所有比特币基地价格数据API，可以在一行中打印出现货、买入和卖出的BTC-美元价格以及买入和卖出之间的价差。</p><p id="d547" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面提供了完整的代码，其中有两个文件:</p><ul class=""><li id="9548" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe no np nq mu b">main.rs</code>:只调用<code class="fe no np nq mu b">rust_struct_5.rs</code>中的<code class="fe no np nq mu b">rust_struct_5</code>函数</li><li id="81eb" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe no np nq mu b">rust_struct_5.rs</code></li></ul><p id="b5c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">main.rs</code>:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bd18" class="my lx it mu b gy mz na l nb nc">//Lesson 5: Combine all lessons<br/>//Declare Modules<br/>mod rust_struct_1;<br/>//Call Lesson 5: Combine all lessons<br/>fn main() {<br/>       rust_struct_5::rust_struct_5(); <br/>}</span></pre><p id="6761" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe no np nq mu b">rust_struct_5.rs</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="870b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章是有帮助的！感谢阅读。</p></div></div>    
</body>
</html>