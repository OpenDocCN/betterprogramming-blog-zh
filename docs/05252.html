<html>
<head>
<title>Create a Text-to-GIF Animation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建文本到GIF的动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/text-to-gif-animation-reactjs-devlog-5378fc70fd1?source=collection_archive---------19-----------------------#2020-06-23">https://betterprogramming.pub/text-to-gif-animation-reactjs-devlog-5378fc70fd1?source=collection_archive---------19-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d454" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从构思到出版…以及它是如何不按计划进行的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2d516efc2f3cc7ec55fa234670089378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kvNFtgCxS8vZ4fhSUYf5kw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="3009" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我有一个想法，从简单的文本创建故事板会很酷，例如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/c0b1f72bacc9f1ae8cfa26b4d359fba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aamCvnoOUTHAX9si.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lv">用户用文本描述场景并获取图像作为输出</em></p></figure><p id="1e7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将分享我的想法，并与你一起建立从想法到出版的过程。</p><p id="5bb0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我一定会给你看最后的结果！</p><p id="3584" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">剧透:</strong>没有按计划结束。<a class="ae lw" href="https://framd.cc/" rel="noopener ugc nofollow" target="_blank">TL；博士:最终结果</a>。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="1502" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">0.想法</h1><p id="e29e" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我开始想象这个想法——首先用笔和纸，然后通过<a class="ae lw" href="https://draw.io/" rel="noopener ugc nofollow" target="_blank"> Draw.io </a>(你可以看到上面的第一个概念)。然后，我写了一个概述:</p><blockquote class="nb nc nd"><p id="aec6" class="ky kz ne la b lb lc ju ld le lf jx lg nf li lj lk ng lm ln lo nh lq lr ls lt im bi translated">用户使用简单的英语定义场景:</p><p id="2575" class="ky kz ne la b lb lc ju ld le lf jx lg nf li lj lk ng lm ln lo nh lq lr ls lt im bi translated"><code class="fe ni nj nk nl b">Scene</code> <br/> <code class="fe ni nj nk nl b">Ann as woman to the right</code> <br/> <code class="fe ni nj nk nl b">Frame</code> <br/></p><p id="6996" class="ky kz ne la b lb lc ju ld le lf jx lg nf li lj lk ng lm ln lo nh lq lr ls lt im bi translated">场景定义描述<em class="it">演员</em>(装饰)和<em class="it">画面</em>。<br/> <em class="it">演员</em>使用预置的小精灵像<code class="fe ni nj nk nl b">tree</code>、<code class="fe ni nj nk nl b">man</code>、<code class="fe ni nj nk nl b">woman</code>。<br/> <em class="it">帧</em>定义了演员执行的动作。</p><p id="132e" class="ky kz ne la b lb lc ju ld le lf jx lg nf li lj lk ng lm ln lo nh lq lr ls lt im bi translated">用户将能够分享他们的故事，并喜欢和修改其他人的。</p></blockquote><p id="9fda" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想法和语言或多或少有了定义，是时候起草发展计划了:</p><ol class=""><li id="2312" class="nm nn it la b lb lc le lf lh no ll np lp nq lt nr ns nt nu bi translated">设置—项目准备</li><li id="56f3" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">JSON to images——测试我是否能按照自己的意愿创建图像</li><li id="4908" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">图像到GIF——确保我可以在客户端生成GIF，尝试一些库</li><li id="d7a7" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">文本到JSON——我需要为该语言创建一个解析器</li><li id="9002" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">后端—登录/保存/共享流需要</li><li id="4b99" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">出版</li></ol><p id="06d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">注:</strong>为简洁起见，我就不提很多死路一条的想法或者愚蠢的错误了。所以如果你觉得一切都太顺利了，那只是因为剪辑的原因。此外，我将削减大量代码，并使用伪代码风格来缩短源代码。如果你有任何问题，请不要犹豫地问。</p><p id="a698" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们走吧！</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="a590" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">1.设置</h1><p id="8d44" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我需要一个Git存储库来组织我的开发过程，并需要一个框架来加速它。我使用了<a class="ae lw" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>和<a class="ae lw" href="https://githowto.com/create_a_project" rel="noopener ugc nofollow" target="_blank"> git init </a>:</p><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="d7ef" class="oe mf it nl b gy of og l oh oi">npx create-react-app my-app<br/>cd my-app<br/># [skipped TypeScript adding process]<br/>git init -y<br/>git commit -m "initial"<br/>npm start</span></pre><p id="c581" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重要思想:我们需要快速检验我们的想法。你使用哪种语言、框架或VCS并不重要，只要你对它感到舒适和有效率。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="b823" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">2.JSON到图像</h1><p id="d267" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我从定义一个简单的JSON开始，测试我是否可以基于这个结构呈现图像。</p><p id="2b1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">JSON应描述:</p><ul class=""><li id="9815" class="nm nn it la b lb lc le lf lh no ll np lp nq lt oj ns nt nu bi translated"><code class="fe ni nj nk nl b">sprites</code> —我们演员和装饰的图片网址</li><li id="ed36" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt oj ns nt nu bi translated"><code class="fe ni nj nk nl b">scenes</code> —应包含并定位演员和装饰</li><li id="c13d" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt oj ns nt nu bi translated"><code class="fe ni nj nk nl b">frames</code> —应该包含动作，比如“安向左移动”</li></ul><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="0958" class="oe mf it nl b gy of og l oh oi">({<br/>  sprites: { name: 'http://sprite.url' },<br/>  scenes:<br/>    // scene descriptions<br/>    { scene_ONE:<br/>        { entries:<br/>            /* entries with their sprites and position */<br/>            { Ann: { sprite: 'woman'<br/>                   , position: { /* ... */ }<br/>                   }<br/>            }<br/>        },<br/>    },<br/>  frames:<br/>    [ { scene_name: 'scene_ONE'<br/>      , actions: [<br/>          { target: 'Ann'<br/>          , action: 'move'<br/>          , value: {x, y}<br/>          }<br/>        ]<br/>      }<br/>    , // ...other frames<br/>    ]<br/>})</span></pre><p id="84f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于演员，我定义了三个预设精灵——<code class="fe ni nj nk nl b">tree</code>、<code class="fe ni nj nk nl b">woman</code>和<code class="fe ni nj nk nl b">man</code>——并在项目中添加了相关图像。</p><p id="da4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，对于每一帧，我们将执行所有的动作(移动和说话)。</p><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="ae56" class="oe mf it nl b gy of og l oh oi">// for each frame<br/>const computedFrames = frames.map(frame =&gt; {<br/>  // clone entries<br/>  const entries = _.merge({}, frame.scene.entries);<br/>  // perform actions on the target entry<br/>  frame.actions.forEach(action =&gt; {<br/>    const entry = entries[action.target];</span><span id="9b21" class="oe mf it nl b gy ok og l oh oi">    if (action.type == 'talk') {<br/>      entry.says = action.value;<br/>    }</span><span id="a42e" class="oe mf it nl b gy ok og l oh oi">    if (action.type == 'move') {<br/>      entry.position = action.value;<br/>    }<br/>  });</span><span id="0ad0" class="oe mf it nl b gy ok og l oh oi">  return { entries };<br/>});</span></pre><p id="d34b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于绘制入口精灵，我们肯定会使用<a class="ae lw" href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D" rel="noopener ugc nofollow" target="_blank">画布</a>:</p><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="a99a" class="oe mf it nl b gy of og l oh oi">// draw the entries<br/>const images = computedFrames.map(frame =&gt; {<br/>  const canvas = document.create('canvas');<br/>  const ctx = canvas.getContext('2d');<br/>  frame.entries.forEach(entry =&gt; {<br/>    ctx.drawImage(entry.sprite); // for sprites<br/>    ctx.fillText(entry.says);    // for speech<br/>  });<br/>  // return rendered frame URL<br/>  return URL.createObjectURL(canvas.toBlob());<br/>})</span></pre><p id="fef7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Canvas可以将其内容导出为<a class="ae lw" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL" rel="noopener ugc nofollow" target="_blank">数据URL </a>或<a class="ae lw" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob" rel="noopener ugc nofollow" target="_blank"> blob </a>。稍后我们将需要它来生成<code class="fe ni nj nk nl b">.gif</code>。</p><p id="0326" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际上，代码更加异步:<code class="fe ni nj nk nl b">toBlob</code>是异步的，所有的图片都应该在<code class="fe ni nj nk nl b">ctx.drawImage</code>之前下载。我用一个<a class="ae lw" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" rel="noopener ugc nofollow" target="_blank">承诺</a>链来处理这个。</p><p id="75e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此时，我已经证明了图像可以按照预期进行渲染:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/808b3e11e2a6a338680ce84d173ae419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vymHLVKkJk2hxc_u.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lv">第一张效果图！万岁！</em></p></figure><p id="656c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以我们可以继续前进…</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="358d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">3.图像到GIF</h1><p id="da65" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">这需要对可用的库进行一些研究。我已经用<a class="ae lw" href="https://github.com/jnordberg/gif.js" rel="noopener ugc nofollow" target="_blank"> gif.js </a>结束了。唉，它目前已经有一年没有更新了，但它做得相当好(<a class="ae lw" href="http://jnordberg.github.io/gif.js/" rel="noopener ugc nofollow" target="_blank"> demo </a>)。</p><p id="1a21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了生成一个<code class="fe ni nj nk nl b">.gif</code>文件，我们需要将每张图像输入到<code class="fe ni nj nk nl b">gif.js</code>生成器，然后对其调用<code class="fe ni nj nk nl b">render()</code>:</p><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="6930" class="oe mf it nl b gy of og l oh oi">const gif = new GIF({ /* GIF settings */ });</span><span id="bc2d" class="oe mf it nl b gy ok og l oh oi">images.forEach(imgUrl =&gt; {<br/>  const img = new Image();<br/>  img.src = imgUrl;<br/>  gif.addFrame(img, { delay: 1000 });<br/>});</span><span id="f210" class="oe mf it nl b gy ok og l oh oi">gif.on('finished', blob =&gt; {<br/>  // Display the blob<br/>  updateGifURL(URL.createObjectURL(blob));<br/>});</span><span id="cd71" class="oe mf it nl b gy ok og l oh oi">gif.render();</span></pre><p id="601c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太棒了—现在我们可以生成并下载<code class="fe ni nj nk nl b">.gif</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/42959c31fbaaa95ea2d348c70b7521ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/0*jB6tXS7qRFcuaEv1.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lv">行动起来！</em></p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="9798" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">4.文本到JSON</h1><p id="0df2" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我希望用户用简单的英语输入命令。这对我来说很难，因为我甚至不知道从哪里开始:</p><ul class=""><li id="774a" class="nm nn it la b lb lc le lf lh no ll np lp nq lt oj ns nt nu bi translated">创建我自己的解析器？</li><li id="94c2" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt oj ns nt nu bi translated"><code class="fe ni nj nk nl b">input.split(/\n/)</code>然后用正则表达式？</li><li id="8d7a" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt oj ns nt nu bi translated">用一些英语语法解析器？</li></ul><p id="759d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，在四处搜索之后，我看到了这篇文章“<a class="ae lw" href="https://dev.to/barryosull/writing-a-dsl-parser-using-pegjs--4igo" rel="noopener ugc nofollow" target="_blank">使用PegJS </a>编写DSL解析器”，这篇文章向我介绍了PEG.js ( <a class="ae lw" href="https://dev.to/barryosull" rel="noopener ugc nofollow" target="_blank"> @barryosull </a>，谢谢)。</p><p id="cde6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PEG.js是一个简单易用的解析器构建器:</p><ol class=""><li id="eaae" class="nm nn it la b lb lc le lf lh no ll np lp nq lt nr ns nt nu bi translated">您使用类似正则表达式的规则来定义您的语言。</li><li id="f7b3" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">它用你个人的、新鲜的、新的解析器生成一个<code class="fe ni nj nk nl b">.js</code>文件。</li><li id="980e" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">您插入这个解析器并对您的文本运行它。</li></ol><p id="9388" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，下面是我的规则中的一段摘录，它解析了<code class="fe ni nj nk nl b">Scene</code> s:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/097f0af0d8eee5933ad40b2741e0299b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6uXUHQjU8TyekdX-.png"/></div></div></figure><p id="52d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些规则将解析此文本:</p><p id="6e60" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe ni nj nk nl b"><em class="ne">Scene</em></code><em class="ne"><br/></em>T3】</p><p id="9c58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">致本JSON:</p><pre class="kj kk kl km gt oa nl ob oc aw od bi"><span id="6a64" class="oe mf it nl b gy of og l oh oi">{<br/>    "type": "scene",<br/>    "values": [<br/>      {<br/>        "type": "object",<br/>        "objectName": "Tree",<br/>        "sprite": "tree",<br/>        "state": {<br/>            "y": 160,<br/>            "scale": 1.5<br/>        }<br/>      }<br/>    ]<br/>}</span></pre><p id="4a6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在玩了PEG.js <a class="ae lw" href="https://pegjs.org/online" rel="noopener ugc nofollow" target="_blank">在线版本</a>的几个小时后，我终于有了一种可以很好地使用的语言和输出结构。</p><p id="389a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">把它插入应用程序后，我得到了这个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/873ba9a66079f565b918ae8104ead386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TnttbVLFzYaP9IPh.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">看，他们边说边听</p></figure><p id="6453" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">边注1: </strong>至此，我放弃了模糊定位<code class="fe ni nj nk nl b">Ann to the right</code>的想法，更新了PEG.js，定义了一个类似js的对象符号:<code class="fe ni nj nk nl b">Ann at { x: 100 y: 100 }</code>。</p><p id="f257" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">旁注2: </strong>另外，我不能在每次文本更新时都重新生成GIF。它太沉重了:100ms-UI-thread-blocking-on-every-keystone heavy。</p><p id="1c6c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lw" href="https://rxjs.dev/" rel="noopener ugc nofollow" target="_blank"> RxJS </a>前来救援:<a class="ae lw" href="https://thinkrx.io/rxjs/debounceTime-vs-throttleTime-vs-auditTime-vs-sampleTime/" rel="noopener ugc nofollow" target="_blank">去抖</a>用于输入文本更新和一个简单的<a class="ae lw" href="https://thinkrx.io/rxjs/timer/" rel="noopener ugc nofollow" target="_blank">定时器</a>，映射到帧开关<code class="fe ni nj nk nl b">imgRef.current.src = next_frame</code>来模仿动画。</p><p id="ca72" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际的<code class="fe ni nj nk nl b">.gif </code>只有在用户点击下载按钮时才会生成。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="f268" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">5.后端</h1><p id="a71d" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">这个宠物项目已经花了我一个周末的开发时间，所以我不得不放弃所有与后端相关的任务，暂时坚持使用静态web应用程序。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="8d12" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">6.出版</h1><p id="cc4f" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我使用<a class="ae lw" href="https://pages.github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub Pages </a>特性来部署和共享项目。</p><p id="2cd2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">GitHub Pages将在其域名<code class="fe ni nj nk nl b">http://username.github.io/repository</code>下为您的网站提供服务。因为我以后可能会添加后端——我需要购买一个域名，这样我现在分享的所有链接在将来仍然有效。</p><p id="6722" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">挑选名字对我来说总是很难。经过一个小时的挣扎，我终于有了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/928dd1de12ce555af01731fe5c7d4d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rZlX6vM2CFvW3JRx.png"/></div></div></figure><p id="7b19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">去<a class="ae lw" href="https://framd.cc/" rel="noopener ugc nofollow" target="_blank"> framd.cc </a>试试吧。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="678e" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结尾部分</h1><p id="e840" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">情节转折:在部署并与朋友分享项目后，我发现我缺少精灵！事实证明，人们不能只用一个男人、一个女人和一棵树的形象来讲述很多故事。所以我决定用表情符号作为精灵。现在你有很多这样的东西🌳👩‍🚀🌍正确地讲述你的故事。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="f9a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样！感谢您阅读本文。</p><p id="8e30" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有什么问题吗？把它们贴在评论区——我很乐意回答！</p></div></div>    
</body>
</html>