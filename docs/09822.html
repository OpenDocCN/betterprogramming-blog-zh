<html>
<head>
<title>How to Validate Fields Using Jetpack Compose in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中使用Jetpack Compose验证字段</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-validate-fields-using-jetpack-compose-in-android-5ea1522331c7?source=collection_archive---------3-----------------------#2021-10-18">https://betterprogramming.pub/how-to-validate-fields-using-jetpack-compose-in-android-5ea1522331c7?source=collection_archive---------3-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8c20" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">检查电子邮件和密码字段是否正确，并相应地显示消息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3269a107fbce86a6fcf99fcb8b4467e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7MlHF8hEoSyyhAGL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@trueagency?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">真实社</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4d2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习当用户提交表单并显示自定义错误消息时如何验证输入数据。本文中的验证包括:空提交、有效电子邮件检查、字符长度检查、单选按钮组选择检查等。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7546" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="e2c8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Jetpack Compose是谷歌最近试图让Android开发者轻松构建UI的尝试之一。</p><blockquote class="mz na nb"><p id="66f6" class="kz la nc lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated"><em class="it">“Jetpack Compose是一款用于构建原生Android UI的现代工具包。Jetpack Compose以更少的代码、强大的工具和直观的Kotlin APIs简化并加速了Android上的UI开发。”— </em> <a class="ae ky" href="https://developer.android.com/jetpack/compose/tutorial" rel="noopener ugc nofollow" target="_blank"> <em class="it">安卓开发者</em> </a></p></blockquote><p id="3672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jetpack Compose的稳定版本1.0最近发布，这意味着它的生产就绪。因此，这将是学习如何使用下一代UI套件进行Android开发的大好时机。</p><p id="1753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要安装Android Studio —北极狐(2020.3.1) <strong class="lb iu"> </strong>版本才能使用Jetpack Compose。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ea14" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">先决条件</h1><p id="5ca1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在进一步学习之前，您必须具备如何使用Jetpack Compose的基本知识。如果你是作曲新手，我强烈推荐阅读以下文章:</p><ul class=""><li id="d1c0" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">"<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/build-android-layouts-in-jetpack-compose-bda2e0837f5e">在JetPack Compose中构建Android布局</a>"</li><li id="00cc" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/android-keyboard-handling-using-jetpack-compose-c478f7afaae0">“使用Jetpack Compose处理Android键盘”</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="830a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">空的和无效的电子邮件验证</h1><h2 id="ef1f" class="nu md it bd me nv nw dn mi nx ny dp mm li nz oa mo lm ob oc mq lq od oe ms of bi translated">空验证</h2><p id="3b4a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们从一个简单的空字段检查开始。首先，我们需要创建一个输入文本字段，在用户输入时更新值。我们知道jetpack compose是一个基于状态的UI，所以我们需要创建一个<code class="fe og oh oi oj b">mutableStateOf</code>字符串和一个更新该字符串的lambda。看一看:</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="a89e" class="nu md it oj b gy oo op l oq or">@Composable<br/>fun ValidationsComposble(){<br/><br/><strong class="oj iu">    </strong>var name by remember <strong class="oj iu">{ <em class="nc">mutableStateOf</em></strong>("") <strong class="oj iu">}<br/>    </strong>val nameTextUpdate = <strong class="oj iu">{ </strong>data : String <strong class="oj iu">-&gt;<br/>        name = data</strong><br/>    <strong class="oj iu">}<br/><br/></strong>}</span></pre><p id="925b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要创建另一个可组合函数来构建UI，它将<code class="fe og oh oi oj b">mutableStateOf</code> <strong class="lb iu"> <em class="nc"> </em> </strong>字符串和更新函数作为输入。我们使用字符串输入来显示文本，并更新函数来捕获用户键入的文本。看一看:</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="aa38" class="nu md it oj b gy oo op l oq or">@Composable<br/>fun ValidationsUI(<br/>    <strong class="oj iu">name : String,<br/>    nameUpdate : (String) -&gt; Unit</strong><br/>){<br/><br/>    <em class="nc">Column</em>(<br/>        modifier = Modifier<br/>            .<em class="nc">fillMaxSize</em>()<br/>            .<em class="nc">padding</em>(start = 16.<em class="nc">dp</em>, end = 16.<em class="nc">dp</em>, top = 16.<em class="nc">dp</em>)<br/>            .<em class="nc">verticalScroll</em>(rememberScrollState())<br/>    )<strong class="oj iu">{<br/><br/>        <em class="nc">OutlinedTextField</em></strong>(<br/>            value<strong class="oj iu"> = name,<br/>            </strong>onValueChange<strong class="oj iu"> = nameUpdate,</strong><br/>            label = <strong class="oj iu">{ </strong><em class="nc">Text</em>("Name") <strong class="oj iu">}</strong>,<br/>            modifier = Modifier<br/>                .<em class="nc">fillMaxWidth</em>(),<br/>        <strong class="oj iu">)<br/><br/>    }<br/><br/></strong>}</span></pre><p id="c52f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们添加一个提交按钮，当用户点击它时，我们必须验证文本输入，如果字段为空，则显示错误。验证逻辑应该在父函数中完成，因为它会影响状态和UI。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="91f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是在输入文本无效时更新UI。为此，我们需要ValidationsUI函数的另一个布尔输入。布尔变量也应该是<code class="fe og oh oi oj b">mutableStateOf</code> <em class="nc">，</em>，这样用户界面就可以相应地更新。看看最终的实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><h2 id="9911" class="nu md it bd me nv nw dn mi nx ny dp mm li nz oa mo lm ob oc mq lq od oe ms of bi translated">电子邮件验证</h2><p id="b12f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">不管验证的类型是什么，实现都是一样的。在电子邮件验证的情况下，我们验证电子邮件而不是使用<code class="fe og oh oi oj b">isEmpty</code>，其余的事情都是一样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/e36d19a3c16d26e5d335e255eb78bba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txISRqSPZfRiwzOxqdfwEA.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="13a6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">带有错误消息的验证</h1><p id="917d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在上面的输出中，它清楚地显示了错误字段，并且它将为空字段完成工作。但是当涉及到特定的验证时，比如电子邮件、数字验证等，用户需要知道消息哪里出错了，而不仅仅是突出显示字段。</p><p id="677a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开箱即用，jetpack compose没有任何特定的东西来处理它。因此，我们需要使用现有的<code class="fe og oh oi oj b">OutlinedTextField</code>创建一个显示错误消息的输入字段。</p><p id="3a91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实现很简单，我们只需要创建一个新的compose函数，并添加<code class="fe og oh oi oj b">OutlinedTextField</code>接受的所有输入。然后根据<code class="fe og oh oi oj b">Column</code>中的错误标志执行显示错误的<code class="fe og oh oi oj b">OutlinedTextField</code>和<code class="fe og oh oi oj b">Text</code>字段。<code class="fe og oh oi oj b">errorMsg</code>是我们添加的额外输入，用于显示基于上下文的错误消息。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="a42a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，在您的composable中，我们没有使用<code class="fe og oh oi oj b"><em class="nc">OutlinedTextField</em></code> <strong class="lb iu"> <em class="nc"> </em> </strong>，而是使用了<code class="fe og oh oi oj b">OutlineTextFieldWithErrorView</code>，它显示了一条没有多余代码的错误消息。看一下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/7bbf2b2aa3cc364ff9c2de94d5fb3793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xb4-kFS5gZCoxWqmhce98g.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="22e4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">单选按钮组验证</h1><blockquote class="mz na nb"><p id="dac1" class="kz la nc lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated">它不会偏离上述实现太多</p></blockquote><p id="7109" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从创建一个广播组开始。为了简单起见，让我们考虑一个性别选择特性。这里我们有三个单选按钮:男性、女性和其他。默认情况下，应该取消选择所有按钮。看一看:</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="ac60" class="nu md it oj b gy oo op l oq or">@Composable<br/>fun ShowRadioGroup(<br/>    <br/>) {<br/>    Column<strong class="oj iu">{<br/>        </strong>Row <strong class="oj iu">{</strong></span><span id="7125" class="nu md it oj b gy ov op l oq or"><strong class="oj iu">            </strong><em class="nc">RadioButton</em>(<br/>                selected = false,<br/>                onClick = <strong class="oj iu">{ }</strong>)<br/>            Text(<br/>                text = "Male",<br/>                modifier = Modifier<br/>                    .<em class="nc">clickable </em><strong class="oj iu">{ }<br/>                    </strong>.<em class="nc">padding</em>(start = 4.<em class="nc">dp</em>)<br/>            )</span><span id="2c89" class="nu md it oj b gy ov op l oq or">            <em class="nc">Spacer</em>(modifier = Modifier.<em class="nc">size</em>(4.<em class="nc">dp</em>))</span><span id="482a" class="nu md it oj b gy ov op l oq or">            RadioButton(<br/>                selected = false,<br/>                onClick = <strong class="oj iu">{ }<br/>            </strong>)<br/>            <em class="nc">Text</em>(<br/>                text = "Female",<br/>                modifier = Modifier<br/>                    .<em class="nc">clickable</em>(onClick = <strong class="oj iu">{ </strong> <strong class="oj iu">}</strong><br/>                    .<em class="nc">padding</em>(start = 4.<em class="nc">dp</em>)<br/>            )</span><span id="44b7" class="nu md it oj b gy ov op l oq or">        <strong class="oj iu">}<br/>        </strong><br/>    <strong class="oj iu">}<br/></strong>}</span></pre><p id="da59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们需要更新选择的状态，我们需要选择的标签作为状态，还需要一个函数来更新选择的状态，就像我们以前做的那样。除此之外，我们还需要一个布尔值来维护错误状态。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0766" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">表单验证</h1><p id="6d54" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们将所有代码放在一起实现表单验证。该表单包括姓名、电子邮件和单选按钮组验证。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><h1 id="e501" class="mc md it bd me mf ow mh mi mj ox ml mm jz oy ka mo kc oz kd mq kf pa kg ms mt bi translated">输出</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/f6b97d9c26179fd3f4353743387a65be.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/1*dgBFE_50SbND4-nNOX0G9Q.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读。</p></div></div>    
</body>
</html>