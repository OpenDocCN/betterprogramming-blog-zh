# 停止在你的代码中使用幻数和变量

> 原文：<https://betterprogramming.pub/stop-using-magic-numbers-and-variables-in-your-code-4e86f008b84c>

## 没有人会理解你的程序。即使是你

![](img/bc083d91b0d0e326458356b910896a36.png)

伊莎贝尔·玛利亚·古纳-维拉斯科于 [Unsplash](https://unsplash.com/s/photos/coding?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 拍摄的照片

你有没有因为阅读不是自己写的代码而挠头的经历？

你当然有。

你不是一个看不懂代码的糟糕程序员。也许写代码的程序员是个魔术师——不是那种魔术师。

在编码的时候，请记住这句话。

> “编写代码的时候，要把最终维护你代码的人想象成一个知道你住哪儿的暴力精神病患者。”—约翰·伍德

许多程序都苦于这样一个事实，即它们在编写时没有考虑到另一个读者。如果在编写代码时，你的后脑勺没有暴力的精神病患者，那么很可能会有一些糟糕的代码溜进来。

过一段时间后，你可能也很难读懂你自己的代码，除非你写的代码每个人都能永远理解。

# 什么是魔法？

请不要把我们今天说的魔术和魔术方法(邓德方法)混为一谈。

你很可能使用了`__init__`作为你的类的初始化器。你试过用`__str__`来控制打印对象时发生的事情吗？

我们不喜欢的魔术是魔术变量和魔术数字。

## 神奇的变量

神奇变量的变量名并不反映它所代表的内容。这个名字完全是胡言乱语，对读者来说毫无意义。

以下代码声明了一个神奇的变量:

```
a = [i for i in range(1,7)]
```

`a`可以是任何东西。当然，这是一个从 1 到 6 的列表，但是我们将如何使用它呢？成绩，房间里的门，冰箱里的剩菜？

你不可能知道这段代码应该做什么。

```
dice_alternatives = [die for die in range(1,7)]
```

代码都是关于骰子的，代码根据骰子的面的数量创建了一个列表。现在说得通了。

![](img/9967b0aacaa8b0c9404cf46961a76e7b.png)

伊恩·冈萨雷斯在 [Unsplash](https://unsplash.com/s/photos/dice?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

你能找到改进上面代码的方法吗？

它仅限于标准模具。因为我们习惯了有六个面的骰子，所以我们对这个代码没问题。然而，在骰子的世界里，你有一系列的选择。

```
die_faces = 6
dice_alternatives = [die for die in range(1,(die_faces+1))] 
//+1 cause range does not include the last number.
```

我打赌你见过这样的矩阵:

```
for i in range(3):
    for j in range(3):
        print('*', end='')
    print()
```

将`i`变成`row`以及将`j`变成`column`的微小调整会大有帮助。

## 神奇的数字

考虑以下代码:

```
x = 13
y = 21if x>=y:
    print('old enough to drink')
```

这个准则是有意义的，因为你知道它是关于饮酒年龄的。代码读起来不好，因为`x`应该是`age`而`y`应该是`legal_age`。

它可能看起来像这样:

```
age = int(input('What is your age? (whole number)'))
legal_age = 21
can_drink = Falseif age>=legal_age:
    print('old enough to drink')
    can_drink = True
```

如我所说，这并不是幻数的最大罪犯。如果你在表达式中间使用一个数字，就变得难以理解。

```
distance = orig_distance * 0.393701
```

只有训练有素的眼睛才能捕捉到英寸的转换。尤其是如果这仅涉及一小部分代码，而其余部分使用公制数字。没有任何注释或适当的变量名，这对于许多程序员来说将是难以理解的。

## 那里有一个图书馆

在某些情况下，您可以使用库。

我们都知道圆周率大致是 3.14。因为我们在日常讲话中把圆周率说成 3.14，所以在我们的代码中使用这个值是很诱人的。

```
circle_radius = 12.6
area_circle = 3.14*circle_radius**2
print(str(area_circle))
```

上面的代码返回`498.5064`。

代码和结果看起来很好，因为我们可以假设每个人都知道 pi 是 3.14，但是在您的情况下可能不够好。

对于我们使用数学库的代码所要表达的意思，没有混淆，而且更准确。

```
import mathcircle_radius = 12.6
area_circle = math.pi*circle_radius**2
print(str(area_circle))
```

上面的代码返回`498.7592496839155`。

# 为什么我们会有不良的编码习惯？

老实说，这不全是你的错。

你见过多少次这样的课程:用`j`和`k`做嵌套循环，用`i`做循环，函数中的参数`n`，以及像`a`、`b`或`c`这样的变量名？

这不仅仅发生在 YouTube 上。这在大学和其他学习编程的地方经常发生。

我看过的大多数编码教程都会在某个时候，在课程中使用神奇的变量和神奇的数字。这样做的主要原因是你不想浪费时间看别人编好的变量名。

实时解释更宽容。一个很差的变量名不伤那一刻的教学。然而，代码通常是作为额外的材料提供的，这使得以后理解代码本身变得更加困难。

当你想给某人看一个快速的例子时，很容易使变量名毫无意义，以后也无法阅读。

过了一段时间，你开始将这些融入到你真正的代码中，并且你已经开始将你的坏习惯应用到你的日常工作中。一面大红旗应该在那一点上飘扬。

# 最后的想法

我们做个交易吧。

当你和你的同事讨论一段代码时，使用糟糕的变量名是可以的。当你测试你的代码时，这样做是可以的。希望你以后有时间重构它。(我们知道你永远没有时间重构。我们不要自欺欺人了。)

当你写别人会用的代码或者你一年后要维护的代码时，请不要让魔法出现。

当然，如果你的代码很神奇，那就太好了。如果它充满了神奇的变数，那它就不是。

让我们消灭错误的魔法，让代码中正确的魔法继续前进。

谢了。