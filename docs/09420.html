<html>
<head>
<title>How To Integrate GraphQL Databases in Your Frontend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在前端集成GraphQL数据库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-integrate-graphql-databases-in-your-frontend-25cddc13411?source=collection_archive---------7-----------------------#2021-08-23">https://betterprogramming.pub/how-to-integrate-graphql-databases-in-your-frontend-25cddc13411?source=collection_archive---------7-----------------------#2021-08-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8106" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用FaunaDB和Next.js构建一个简单的笔记应用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/10cacbcf65b5283dba8f8753f1f1a5b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vZ8nWl7_OAXFxj1I"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://unsplash.com/@amandazi_photography" rel="noopener ugc nofollow" target="_blank"> Amandazi摄影</a>上<a class="ae ky" href="http://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="270e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><h2 id="1326" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">FaunaDB是什么，为什么要用它？</h2><p id="af58" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">说到构建web应用程序，MongoDB是最流行的数据库解决方案之一。毫无疑问，使用和理解起来很简单。</p><p id="f709" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">例如，假设您想要从<code class="fe ne nf ng nh b">Note</code>集合中检索一个项目列表。你可以用<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-mongoose-with-node-js-913a8073b29c">猫鼬库</a>做类似的事情:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="7808" class="lr la it nh b gy nm nn l no np">Note.find({}).lean();</span></pre><p id="9801" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">这行代码将返回每个项目的所有字段。虽然这可能行得通，但在某些情况下有一个小问题。如果您只想显示列表中的一个字段，例如,<code class="fe ne nf ng nh b">title</code>属性，该怎么办？</p><p id="0ae2" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">这就是FaunaDB的用武之地。和MongoDB一样，它也是一个非SQL数据库，但是使用GraphQL作为查询方法之一。这意味着，如果您只需要每个便笺的<code class="fe ne nf ng nh b">title</code>字段，您可以运行这个GraphQL命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b4a2fe3a04feafc126e2dbe8c7f28463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*Fnd7Z1YiOQmyMMewkFpgVA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自数据库的所有注释</p></figure><p id="ebef" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">就这么简单！此外，因为它是基于云的，所以非常适合无服务器应用程序。因此，您不必担心数据库环境的维护，因为动物群会为您处理一切。因此，它可以让您专注于编写应用程序，并构建您梦想的项目。</p><p id="8a00" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">总而言之，FaunaDB带来了稳定性、易用性和开发速度。</p><p id="90c1" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">既然我们已经讨论了它的成果，让我们开始吧！</p><p id="9195" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">本教程结束时，您将拥有一个具有基本CRUD功能的笔记应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/1697ae2199219bf2ddb980191f7d4f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ewQW8yxZn34a_fV4K-cdnw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本文的结果</p></figure><h1 id="dd8b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">项目设置</h1><h2 id="8d1b" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">创建Next.js存储库</h2><p id="c69e" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">要搭建Next.js项目，请运行以下终端命令:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="211f" class="lr la it nh b gy nm nn l no np">npx create-next-app fauna-tutorial</span></pre><h2 id="a333" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">模块安装</h2><p id="9ea7" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">我们的项目使用以下依赖关系:</p><ul class=""><li id="eede" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">formik</code>:我们将使用表单来捕捉用户输入。福米克图书馆将帮助我们做到这一点。</li><li id="0e73" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">graphql</code>和<code class="fe ne nf ng nh b">graphql-request</code>:帮助我们在数据库上运行GraphQL请求。</li><li id="a2e8" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">顾名思义，这个模块将让我们构建模态和弹出窗口。</li></ul><p id="f3a3" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">要安装这些依赖项，请执行以下bash命令:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="39ed" class="lr la it nh b gy nm nn l no np">npm i formik graphql graphql-request reactjs-popup</span></pre><h2 id="d7e2" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">项目文件夹结构</h2><p id="cfd2" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">我们现在需要在项目目录中创建一些文件夹。这将鼓励文件组织。</p><p id="6989" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在项目目录的根目录中，创建以下文件和文件夹:</p><ul class=""><li id="9601" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">这个文件夹将保存我们的GraphQL配置和其他帮助方法。</li><li id="dc20" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">components</code>:将包含我们的可重用组件。</li><li id="2140" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">schema.graphql</code>:<code class="fe ne nf ng nh b">schema.graphql</code>文件将保存我们的<code class="fe ne nf ng nh b">Note</code>集合的模式。</li></ul><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="9691" class="lr la it nh b gy nm nn l no np">mkdir utils components<br/>touch schema.graphql</span></pre><p id="10e3" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">最后，您的项目文件夹应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e8439695e9cb2c11ec399b06af73f914.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*8lGnfIIFmOrOj21X7oLZdQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目文件夹目录</p></figure><p id="f8ce" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">完成后，就该建立我们的动物数据库了。</p><h2 id="be18" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">建立FaunaDB</h2><p id="3e44" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">继续之前，在<a class="ae ky" href="https://dashboard.fauna.com/" rel="noopener ugc nofollow" target="_blank"> FaunaDB的网页</a>上做一个账户。接下来，选择“新建数据库”来预配新数据库。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/bae5a2fe9eb42daf9aa49b71229672ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*dOKDqF-CNTPaflowk0dHKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建我们的数据库</p></figure><p id="c8a4" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">现在，为您的新服务器指定一个名称及其托管区域。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/333f8f9937f08b05c1c8d1799ecd5201.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*O59-2G1EDcOzxu-0JPjfRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据库设置</p></figure><p id="b84b" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">创建服务器后，单击“GraphQL”导航至GraphQL平台:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/a0fe2d5fa02af2bd574e5d70f378df4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EfnjNHQNrHpXb49kI2Gj3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">去GraphQL游乐场</p></figure><p id="692f" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">FaunaDB将要求您导入一个GraphQL模式。我们的模式将告诉动物界我们数据的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/477f27a77c40f03a498cee930f79b24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5sy6WzkYsa_RJycmjfWsUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入模式</p></figure><p id="fc1a" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在下一节中，我们将创建该应用程序所需的模式。</p><h2 id="490f" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">设计笔记模式</h2><p id="6e65" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">现在让我们创建我们的<code class="fe ne nf ng nh b">Note</code>集合的模式。</p><p id="be98" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">之前，我们在项目中创建了一个<code class="fe ne nf ng nh b">schema.graphql</code>文件。在该文件中编写以下代码块:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="bf51" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第2行和第3行:每个<code class="fe ne nf ng nh b">Note</code>文档都有一个<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。两者都是类型<code class="fe ne nf ng nh b">String</code>。</li><li id="c838" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第6行:当用户查询<code class="fe ne nf ng nh b">allNotes</code>时，数据库将返回数据库中存在的所有笔记。</li></ul><p id="c91f" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">将该文件导入数据库，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/2932229f8426350e933a71fa3f8a9357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qAed9IOeUmf-JD40tScnQA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入我们的模式</p></figure><h2 id="3b18" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">使用GraphQL操场</h2><p id="1f11" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">我们可以使用Fauna的GraphQL playground在我们的数据库上执行CRUD操作。</p><p id="1339" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在操场上，从编写下面这段代码开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="a067" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第2行:创建一个<code class="fe ne nf ng nh b">Note</code>记录，并指定它的<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。</li></ul><p id="94bd" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">这将是输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/f16732d0557ce802c63dcb0bc6213202.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*mzMnwpXr6pAM4w7StpO1Ug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="6496" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">太好了！我们现在已经向数据库添加了数据。</p><p id="8696" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">现在让我们验证操作是否成功:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="5416" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第2行:将所有的笔记存入存储器。</li><li id="8d3f" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第4–6行:检索它们的<code class="fe ne nf ng nh b">id</code>、<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/0ceb2f68f751550d62e16506288534f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*B1h95GaYzfDS5FI8zaZdqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="b09f" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">太好了！这意味着我们的行动成功了。</p><h2 id="f60c" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">获取凭据</h2><p id="23b4" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">我们现在去拿安全钥匙。我们将需要这个来连接我们的数据库前端。</p><p id="271e" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">单击左侧面板中的“安全”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/ba7774465c4ddc07186c63a54ef00812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzg0vGZptMpcIcmP4uu9gw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“安全”</p></figure><p id="6375" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">完成此步骤后，单击“新建密钥”。确保您已经选择了以下设置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/69f51473fc757ff6fa1a3184ecca5f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*CqJ8U1DhGtozhHUPFM4ltw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新密钥的设置</p></figure><p id="ef39" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">然后，弗娜会给你分配一个密钥:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/65e40f82aa7322cc29b44a1355dc276b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pq8tyPtfL4vvHSAKJyq8pw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">获取密钥</p></figure><p id="d36b" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">将该字符串复制到项目的<code class="fe ne nf ng nh b">.env.local</code>文件中，如下所示:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="2536" class="lr la it nh b gy nm nn l no np">NEXT_PUBLIC_FAUNA_SECRET=myKey</span></pre><p id="d415" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">完成后，让我们现在构建我们的项目。</p><h1 id="7012" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建实用函数和自定义组件</h1><p id="750a" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在使用笔记功能之前，让我们创建助手函数和React元素。</p><h2 id="a347" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">定义我们的GraphQL查询</h2><p id="d440" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在你的<code class="fe ne nf ng nh b">utils</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">queryStrings.js</code>的文件。顾名思义，这个文件将保存我们的CRUD进程所需的GraphQL查询。</p><p id="bf19" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在该文件中，首先编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="2252" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第4行:<code class="fe ne nf ng nh b">insertNote</code>命令将运行一个突变请求。这里，<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>是<code class="fe ne nf ng nh b">String</code>类型的变量。</li><li id="5026" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第5行:这将告诉Fauna插入一个<code class="fe ne nf ng nh b">Note</code>文档，并指定<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。</li><li id="fdfd" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第13–16行:<code class="fe ne nf ng nh b">findNoteByID</code>查询搜索具有所需ID的文档。如果注释存在，服务器将返回其<code class="fe ne nf ng nh b">_id</code>、<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。</li></ul><p id="ac96" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">接下来，在<code class="fe ne nf ng nh b">queryStrings.js</code>文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="5581" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">让我们一点一点地解构这段代码:</p><ul class=""><li id="ae76" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">getAllNotes</code>将查询数据库中的所有记录。我们将使用它们的<code class="fe ne nf ng nh b">id</code>和<code class="fe ne nf ng nh b">title</code>字段。</li><li id="dea2" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">deleteNote</code>突变将找到具有所需ID的文档并删除它。</li><li id="49e7" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><code class="fe ne nf ng nh b">updateQuery</code>变量将搜索具有特定ID的注释。找到后，动物群将编辑其<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>字段。</li></ul><p id="83f4" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">完成后，现在让我们配置我们的GraphQL客户端。</p><h2 id="5fb5" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">定义我们的GraphQL客户端</h2><p id="f039" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在本节中，我们将编写我们的动物客户端配置。这将允许我们链接我们的前端和后端。</p><p id="24e0" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">utils</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">graphqlClient.js</code>的文件。在这里，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="250c" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第4行:用我们选择的端点创建一个客户机。</li><li id="a894" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第6行:提供我们的密钥用于认证目的。</li><li id="b6be" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第10行:导出这个配置，这样我们就可以向我们的动物群客户端发出请求。</li></ul><h2 id="5a0d" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">创建查询函数</h2><p id="e12f" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">utils</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">noteFunctions.js</code>的文件。这个文件将由执行GraphQL查询的帮助函数组成。</p><p id="2eb9" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在这里，编写以下代码块:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">构建我们的项目</p></figure><ul class=""><li id="41d8" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第10–12行:运行<code class="fe ne nf ng nh b">insertQuery</code>查询。这将告诉动物创建一个新的笔记。我们还通过参数提供了<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>变量。</li><li id="aa26" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第14–16行:该函数将调用<code class="fe ne nf ng nh b">updateQuery</code>命令。</li><li id="7746" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第17–19行:<code class="fe ne nf ng nh b">deleteNote</code>方法将执行<code class="fe ne nf ng nh b">deleteQuery</code>。我们提供<code class="fe ne nf ng nh b">id</code>字段作为参数。这将从数据库中删除所选记录。</li></ul><p id="1fbd" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">接下来，在同一个文件中编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="fbf4" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第1–4行:该函数将获取服务器中的所有笔记并返回结果。</li><li id="12dc" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第5–8行:<code class="fe ne nf ng nh b">getSingleNote</code>将从集合中检索所需的文档。</li></ul><h2 id="e363" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">编写我们的弹出组件</h2><p id="f156" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在这一部分，我们将构建一个自定义的React弹出组件。当用户点击一个项目时，UI会在一个弹出窗口中显示它的信息。</p><p id="ce97" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">components</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">PopupComponent.js</code>的文件。在这里，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="b2c3" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第5行:<code class="fe ne nf ng nh b">PopupComponent</code>模块将接受一个<code class="fe ne nf ng nh b">id</code>道具。这将是记录的ID。</li><li id="9f87" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第8–10行:调用<code class="fe ne nf ng nh b">getSingleNote</code>函数。这将获得具有匹配ID的记录。稍后，将结果存储在<code class="fe ne nf ng nh b">data</code>钩子中。</li></ul><p id="7a29" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">接下来，将这段代码添加到同一个文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="c830" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第6行:单击时，将用户重定向到<code class="fe ne nf ng nh b">edit</code>页面，并将注释的<code class="fe ne nf ng nh b">id</code>字段作为URL参数发送。</li></ul><h2 id="e59c" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">创建我们的列表组件</h2><p id="6419" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">components</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">NotesList.js</code>的文件。该模块将在列表中显示客户的笔记。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="707d" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第7行:<code class="fe ne nf ng nh b">NotesList</code>会接受一个<code class="fe ne nf ng nh b">data</code>道具。这将是包含用户笔记的数组。</li></ul><p id="09c4" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">现在，将这段代码添加到<code class="fe ne nf ng nh b">NotesList.js</code>中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="2046" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">从这段代码中可以得出一些推论:</p><ul class=""><li id="e454" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第5行和第19行:<code class="fe ne nf ng nh b">Popup</code>标签之间的所有代码都将是弹出窗口的一部分。</li><li id="51cc" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第6–9行:如果用户按下这个<code class="fe ne nf ng nh b">button</code>元素，弹出窗口将会打开。方法将从DOM中移除这个模态。</li><li id="f462" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第12行:用注释的<code class="fe ne nf ng nh b">id</code>字段作为道具显示我们的<code class="fe ne nf ng nh b">PopupComponent</code>。</li><li id="64c0" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第20–27行:单击时，运行<code class="fe ne nf ng nh b">deleteNote</code>方法并刷新页面。</li></ul><p id="86f9" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">我们现在已经为此应用奠定了基础。在下一节中，我们将把这些模块结合在一起，让我们的web应用变得更加生动。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h1 id="602d" class="kz la it bd lb lc pa le lf lg pb li lj jz pc ka ll kc pd kd ln kf pe kg lp lq bi translated">构建我们的项目</h1><h2 id="544c" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">显示注释列表和删除功能</h2><p id="95b1" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在<code class="fe ne nf ng nh b">pages/index.js</code>中，开始编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="6b51" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第9–11行:从数据库中获取所有记录，并将结果存储到<code class="fe ne nf ng nh b">data</code>钩子中。</li></ul><p id="9543" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">完成后，在<code class="fe ne nf ng nh b">pages/index.js</code>中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="5e32" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第3行:点击时，引导用户到<code class="fe ne nf ng nh b">add</code>页面。我们稍后将处理这条路线。</li><li id="d93a" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第4行:使用条件渲染。如果<code class="fe ne nf ng nh b">data</code>的值是<code class="fe ne nf ng nh b">null</code>(响应还没有加载)，通知用户数据正在路上。数据加载后，向用户显示列表。</li></ul><p id="e69e" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">运行代码。这将是结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/22e01e04cac582d6f83ee29d96cf4818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*COR3KehCHFP858wCpKTlZw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="cb72" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">太好了！我们的代码有效。现在让我们来处理我们的<code class="fe ne nf ng nh b">add</code>路线。</p><h2 id="a1d0" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">添加注释</h2><p id="8ac0" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">pages/</code>目录中，创建一个名为<code class="fe ne nf ng nh b">add.js</code>的新文件。这里，从编写以下代码块开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="8a8d" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第13–16行:当用户提交表单时，调用<code class="fe ne nf ng nh b">addNote</code>函数并将用户的输入作为参数传入。该过程完成后，将用户重定向到主页。</li></ul><p id="f428" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">接下来，在同一个文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="fc8d" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第3行和第6行:为我们的<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>值创建输入字段。</li></ul><p id="b8fe" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">这将是输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/422bc6288a65de53e9a8a7faf66be8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ddE4_jiQQNQM9dKsgB0_5A.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><h2 id="f090" class="lr la it bd lb ls lt dn lf lu lv dp lj lw lx ly ll lz ma mb ln mc md me lp mf bi translated">更新注释</h2><p id="046f" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">在您的<code class="fe ne nf ng nh b">pages</code>文件夹中，创建一个名为<code class="fe ne nf ng nh b">edit.js</code>的新文件。这条路线将允许用户更新他们选择的笔记。</p><p id="8221" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">在这里，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="7e9c" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第16行:每当React检测到<code class="fe ne nf ng nh b">isReady</code>变量的变化时，这个<code class="fe ne nf ng nh b">useEffect</code>函数中的代码就会运行。这将告诉我们路由器字段是否可以在客户端使用。</li><li id="fa33" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第15行:如果<code class="fe ne nf ng nh b">router.isReady</code>是<code class="fe ne nf ng nh b">true</code>(我们可以消费<code class="fe ne nf ng nh b">useRouter's</code>字段)，调用<code class="fe ne nf ng nh b">getData</code>方法。这将检索当前记录的信息。这里，我们使用URL的<code class="fe ne nf ng nh b">id</code>参数作为<code class="fe ne nf ng nh b">getData</code>函数的参数。</li></ul><p id="3774" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">第二步，在同一个文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="579a" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated">第5行和第6行:这个表单的初始值将是注释的当前<code class="fe ne nf ng nh b">title</code>和<code class="fe ne nf ng nh b">body</code>值。</li><li id="91d2" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated">第8–10行:当用户提交时，运行<code class="fe ne nf ng nh b">editNote</code>方法。这将根据用户的当前输入更新文档。</li></ul><p id="5d02" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">这将是代码的输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/5eae769c4404c9a37399eba556b18eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*iJXDW3MLLHRAlA6VGJUgBA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="62df" class="pw-post-body-paragraph mg mh it mi b mj mz ju ml mm na jx mo lw nb mq mr lz nc mt mu mc nd mw mx my im bi translated">我们完事了。</p><h1 id="cced" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">额外资源</h1><p id="c924" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated"><a class="ae ky" href="https://github.com/HussainArif12/fauna-next-tutorial" rel="noopener ugc nofollow" target="_blank"> GitHub仓库的代码</a>。</p><ul class=""><li id="9b2e" class="nu nv it mi b mj mz mm na lw nw lz nx mc ny my nz oa ob oc bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/lets-build-a-note-taking-app-with-react-and-faunadb-a2a1d5e78359">让我们用FaunaDB和React</a>——<a class="pf pg ep" href="https://medium.com/u/ce572601b7e?source=post_page-----25cddc13411--------------------------------" rel="noopener" target="_blank">特雷弗-因德雷克·拉斯恩</a>来构建一个笔记应用</li><li id="6f2a" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><a class="ae ky" href="https://levelup.gitconnected.com/create-a-bookmark-manager-app-using-faunadb-and-netlify-serverless-functions-7d4365652692" rel="noopener ugc nofollow" target="_blank">用FaunaDB和Netlify函数创建一个书签管理器App</a>——<a class="pf pg ep" href="https://medium.com/u/24d03d066e6c?source=post_page-----25cddc13411--------------------------------" rel="noopener" target="_blank">Yogesh Chavan</a></li><li id="8a65" class="nu nv it mi b mj od mm oe lw of lz og mc oh my nz oa ob oc bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=92qPXQa_BUQ" rel="noopener ugc nofollow" target="_blank">将Next.js用于动物群和GraphQL！—李·罗宾逊</a></li></ul><h1 id="c467" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="ca89" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lw mp mq mr lz ms mt mu mc mv mw mx my im bi translated">正如您在上面的代码示例中看到的，使用FaunaDB就像在公园里散步一样简单。它是稳定的，允许开发者快速构建他们的应用程序。动物群对无服务器应用程序很有用。这意味着程序员不必担心数据库的维护或设置。非常感谢您的阅读！编码快乐！</p></div></div>    
</body>
</html>