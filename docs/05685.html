<html>
<head>
<title>SwiftUI’s matchGeometryEffect in iOS 14 — Animate Grids</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI在iOS 14中的matchGeometryEffect动画网格</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swiftuis-matchgeometryeffect-in-ios-14-ab701b2c99c3?source=collection_archive---------4-----------------------#2020-07-28">https://betterprogramming.pub/swiftuis-matchgeometryeffect-in-ios-14-ab701b2c99c3?source=collection_archive---------4-----------------------#2020-07-28</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="1ec2" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">爱上这个新的修改器，创建令人惊叹的动画</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/b238a2884a43cd8aa0852d864ab37e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7A0_99XVpb6KVFZm"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Joanna Kosinska 在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="9bb8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">SwiftUI的第二次迭代引入了一个非常酷的修饰符:<code class="fe lw lx ly lz b">matchedGeometryEffect</code>。</p><p id="987c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该修改器允许您创建惊人的过渡，以跨层次动画视图。要使用它，您需要做的就是将它附加到两个视图上，并确保指定了相同的标识符。</p><p id="abab" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它有一些强大的用例——从动画尺寸变化到视图位置变化的插值。</p><p id="3f2b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当在SwiftUI网格中创建跨视图的奇特模式转换时，或者当用动画重新加载SwiftUI视图时，您肯定会发现它非常方便。</p><p id="cd04" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在接下来的部分中，我们将探索使用<code class="fe lw lx ly lz b">matchedGeometryEffect</code>可以做的一系列事情。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="6c27" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">SwiftUI基本matchedGeometryEffect</h1><p id="db9a" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">下面是一个简单的<code class="fe lw lx ly lz b">matchedGeometryEffect</code>修改器的定义:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="1b53" class="ni mi iu lz b gz nj nk l nl nm">matchedGeometryEffect(id: "unique", in: namespace)</span></pre><ul class=""><li id="f00b" class="nn no iu lc b ld le lg lh lj np ln nq lr nr lv ns nt nu nv bi translated"><code class="fe lw lx ly lz b">id</code>是一个唯一的标识符，设置在您希望动画或插值的一对视图上。</li><li id="411a" class="nn no iu lc b ld nw lg nx lj ny ln nz lr oa lv ns nt nu nv bi translated"><code class="fe lw lx ly lz b">Namespace</code>是一个属性包装器，用于区分视图间的id，基本上防止SwiftUI中的名称冲突。</li></ul><p id="fd30" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">还有几个可选参数可以在修饰符中传递。我们将很快讨论它们。</p><p id="ad5b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们来看一个简单的<code class="fe lw lx ly lz b">matchedGeometry</code>的例子:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/48300129ae1fac5ac32416285bbb059f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lUt7s045vhJcq9r2BphenQ.gif"/></div></div></figure><p id="156a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">哇！我们设法制作了两个文本视图，显示视图重载中的数字。对于演示如何交换两个数字的可视化演示来说，这不是很棒吗？</p><p id="7a79" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您也可以对<em class="oe"> n </em>个数字进行同样的操作。只需确保指定了正确的对id。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="d8b3" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">使用matchedGeometryEffect制作大小和位置动画</h1><p id="2541" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们之前看到的是整个<code class="fe lw lx ly lz b">frame</code>的动画。但是我们也可以通过指定适当的属性来选择只制作<code class="fe lw lx ly lz b">size</code>和<code class="fe lw lx ly lz b">position</code>的动画:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="9daa" class="ni mi iu lz b gz nj nk l nl nm">.matchedGeometryEffect(id: "id", in: nSpace, properties: .size)<br/>.matchedGeometryEffect(id: "id", in: nSpace, properties: .position)</span></pre><p id="d488" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当您只想显示一个缩放过渡(使用<code class="fe lw lx ly lz b">size</code>)或想要插入位置时，这很方便。</p><p id="553e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是要确保正确设置属性。例如:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj of"><img src="../Images/3a78b9eda737e67af6b230616650ec38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yjZuu2fTZYcGaYJMiauLDQ.gif"/></div></div></figure><p id="1d3a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如您所见，圆角矩形仅过渡其<code class="fe lw lx ly lz b">size</code>。所以，它并不是真的从左向右移动。与此同时，圆只对它的<code class="fe lw lx ly lz b">position</code>进行插值，但不会对它的<code class="fe lw lx ly lz b">size</code>进行动画处理，直到我们将属性设置为<code class="fe lw lx ly lz b">frame</code>。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="6cc8" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">使用命名空间ID</h1><p id="c9d6" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">有时，您希望将名称空间传递给子视图或导航链接。</p><p id="840a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为此，您需要在目标视图中指定<code class="fe lw lx ly lz b">Namespace.ID</code>作为类型:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj og"><img src="../Images/ea15c53f582fd0cd8ef95354d30781fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kR9ZeXzn6Prk88Yk6m0jfg.png"/></div></div></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="f630" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">具有matchedGeometryEffect的SwiftUI网格</h1><p id="cfdc" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">网格在SwiftUI 2.0中是一个巨大的增加，它们与<code class="fe lw lx ly lz b">matchedGeometryEffect</code>是天作之合。</p><p id="9f41" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从跨布局过渡到英雄模式的动画，我们都可以做到。</p><p id="b2b6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在下面的截屏中，我们展示了如何在显示所选项列表的同时，使用<code class="fe lw lx ly lz b">matchedGeometryEffect</code>将项目从SwiftUI网格中插入和移除。所有内容都包含在不到50行代码中:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oh"><img src="../Images/d464a47e89686f0c82e5f80f640638cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Vqxc1XQBnsxiWCqxlvOnXQ.gif"/></div></div></figure><p id="9717" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如您所见，我们已经创建了两个ScrollViews。一个保存带有三个列项目的<code class="fe lw lx ly lz b">LazyVGrid</code>，另一个保存在<code class="fe lw lx ly lz b">HStack</code>中选择的项目。为了选择和取消选择项目，我们创建了一个数组<code class="fe lw lx ly lz b">selectedItemIDs</code>。</p><p id="d290" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">GitHub 上的<a class="ae kz" href="https://github.com/anupamchugh/iOS14-Resources/blob/master/SwiftUIMatchedGeometryEffect/SwiftUIMatchedGeometryEffect/ContentView.swift" rel="noopener ugc nofollow" target="_blank">提供了该动画的完整源代码以及视图和实用方法。</a></p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="faf1" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">结论</h1><p id="eae3" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">那是一个包裹。我希望这能启发你建立一些很酷的过渡。SwiftUI中的动画已经变得更加简单、灵活和强大。</p><p id="4d74" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢阅读。</p></div></div>    
</body>
</html>