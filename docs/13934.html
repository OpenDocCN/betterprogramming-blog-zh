<html>
<head>
<title>How To Read a JSON File From Assets in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从Angular中的资产读取JSON文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-read-a-json-file-from-assets-in-angular-7c8313cd4fb1?source=collection_archive---------1-----------------------#2022-10-17">https://betterprogramming.pub/how-to-read-a-json-file-from-assets-in-angular-7c8313cd4fb1?source=collection_archive---------1-----------------------#2022-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d1f2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/@lorenzozar/list/angular-5496c492a185" rel="noopener">有角度的</a></h2><div class=""/><div class=""><h2 id="8959" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">从Angular的assets文件夹中读取JSON文件的3种方法</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/a6c31a0d33c13707be7a12b67681fb94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qW5oswMvgzEQ-9ANDouvIQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">可在<a class="ae le" href="https://jsonplaceholder.typicode.com/todos/" rel="noopener ugc nofollow" target="_blank">https://jsonplaceholder.typicode.com/</a>找到示例。您可以使用https://jsoneditoronline.org/的<a class="ae le" href="https://jsoneditoronline.org/" rel="noopener ugc nofollow" target="_blank">来试验JSON数据。</a></p></figure><p id="fa78" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在从事一个兼职项目时，我想从我的assets文件夹中的一个本地JSON文件中读取数据。</p><p id="2abd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">事实证明至少有几种方法可以做到这一点。我将提到最常见的几种，但您可以在下面找到更多:</p><ol class=""><li id="6ecf" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">使用<code class="fe mk ml mm mn b">import</code>语句</li><li id="a676" class="mb mc iq lh b li mo ll mp lo mq ls mr lw ms ma mg mh mi mj bi translated">使用角度HttpClient</li></ol><h1 id="9188" class="mt mu iq bd mv mw mx my mz na nb nc nd kf ne kg nf ki ng kj nh kl ni km nj nk bi translated">从Angular中的资产读取JSON文件</h1><h2 id="c0ab" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">1.使用import语句</h2><p id="8cbe" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">在Angular中从assets文件夹中读取JSON文件的一种方法是在组件中使用<code class="fe mk ml mm mn b">import</code>语句。</p><p id="3780" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果你正在学习Angular，还没有遇到HttpClient，这是最简单的方法。或者至少是没有引入新概念的那种。</p><p id="b53f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因为我想从我的<code class="fe mk ml mm mn b">app.component.ts</code>文件的assets文件夹中读取一个JSON文件，所以我使用了如下的<code class="fe mk ml mm mn b">import</code>:</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="9b24" class="nl mu iq mn b gy of og l oh oi">import * as jsonData from '../assets/data.json';</span></pre><p id="f83e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这就差不多够了。您需要在您的<code class="fe mk ml mm mn b">tsconfig.json</code>文件的<code class="fe mk ml mm mn b">compilerOptions</code>中添加<code class="fe mk ml mm mn b">"resolveJsonModule": true</code>，它是您的Angular应用程序的根。</p><p id="ec00" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是一个<code class="fe mk ml mm mn b">tsconfig.json</code>的简化例子:</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="5ccb" class="nl mu iq mn b gy of og l oh oi">// <!-- -->tsconfig.json</span><span id="f431" class="nl mu iq mn b gy oj og l oh oi">{<br/>  "compileOnSave": false,<br/>  "compilerOptions": {<br/>    ...<br/>    "resolveJsonModule": true,<br/>    ...<br/> },<br/>  "angularCompilerOptions": {<br/>  ...<br/> }<br/>}</span></pre><p id="b00a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在某些情况下，这还不够，您可能还需要将<code class="fe mk ml mm mn b">esModuleInterop</code>设置为true。在我的情况下，这是没有必要的。</p><p id="737f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最终，<code class="fe mk ml mm mn b">AppComponent</code>会变成这样:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="19a8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是我的控制台截图:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/a86eab3ec24012ce5d99181be4cd7c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQ4YnRKWC2-OiTBPVbTmhw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Console.log of data.json</p></figure><p id="7f65" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这假设您在项目的<code class="fe mk ml mm mn b">src/assets</code>文件夹中有一个<code class="fe mk ml mm mn b">data.json</code>文件。</p><h2 id="9ebf" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">2.使用角度HttpClient</h2><p id="3965" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">从Angular的assets文件夹中读取JSON文件的另一种方法是使用HttpClient模块。</p><p id="9de4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们需要导入<code class="fe mk ml mm mn b">app.module.ts</code>中的<code class="fe mk ml mm mn b">HttpClientModule</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="7f86" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其次，我们需要在<code class="fe mk ml mm mn b">app.component.ts</code>中导入<code class="fe mk ml mm mn b">HttpClient</code>，并将其注入构造函数中，以在组件中公开使用。</p><p id="9f7d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，我们可以使用get方法从文件中获取数据。</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="288e" class="nl mu iq mn b gy of og l oh oi">this.httpClient.get(this.URL).subscribe(console.log);</span></pre><p id="6605" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，我们只需订阅Angular HttpClient生成的<code class="fe mk ml mm mn b">Observable</code>,并将数据记录在控制台中。</p><p id="f343" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对于初学者来说，这种工作方式可能不太直观，因为它引入了两个新概念:</p><ul class=""><li id="5d00" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma on mh mi mj bi translated"><a class="ae le" href="https://angular.io/guide/http" rel="noopener ugc nofollow" target="_blank"> HttpClient </a></li><li id="da7a" class="mb mc iq lh b li mo ll mp lo mq ls mr lw ms ma on mh mi mj bi translated"><a class="ae le" href="https://www.vitainbeta.org/rxjs-primer/" rel="noopener ugc nofollow" target="_blank"> RxJS和可观察/订阅模式</a></li></ul><p id="7950" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然而，应用程序通常通过HTTP协议连接到服务器。因此，迟早你会了解那些概念。</p><p id="60e6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">请注意，将异步效果与组件隔离开来是一个很好的实践。换句话说，您不希望在组件中包含HTTP请求。</p><p id="4fe3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">例如，你应该在一个<a class="ae le" href="https://www.vitainbeta.org/angular-services/" rel="noopener ugc nofollow" target="_blank">服务</a>中拥有它。为简单起见，此处省略。</p><p id="e812" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，这里是<code class="fe mk ml mm mn b">AppComponent</code>的样子:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="def5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">不用说，日志和上一个非常相似。它看起来是这样的:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/5948945e77b17a49e08919833bdf8f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZznCssQRwaECyoEKBUpBA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Console.log of data.json</p></figure><p id="db82" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您觉得这有点让人不知所措，请阅读使用Fetch API一节。</p><p id="0e7a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过使用本机Fetch API可以读取JSON文件。这将消除一些与RxJS和HttpClient模块相关的复杂性。</p><h2 id="2d53" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">3.从Angular中的资产读取JSON文件的其他方法</h2><p id="dd13" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">在Angular中，还有一些其他方法可以从assets文件夹中读取JSON文件。</p><p id="f1b8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我就不赘述了，因为它们不太可能被使用，但是，值得一提。</p><h2 id="0aca" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">3.1添加一个类型文件—JSON-typing ings . d . ts</h2><p id="f679" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">当<code class="fe mk ml mm mn b">tsconfig.json</code>中的<code class="fe mk ml mm mn b">resolveJsonModule</code>和<code class="fe mk ml mm mn b">esModuleInterop</code>都被设置为<code class="fe mk ml mm mn b">true</code>时，如果出现错误，这似乎是可行的。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="aeba" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果是这种情况，您必须在app文件夹中名为<code class="fe mk ml mm mn b">json-typings.d.ts</code>的文件中声明JSON模块。</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="d504" class="nl mu iq mn b gy of og l oh oi">//  json-typings.d.ts</span><span id="df1f" class="nl mu iq mn b gy oj og l oh oi">declare module "*.json" {<br/>    const value: any;<br/>    export default value;<br/>}</span></pre><h2 id="6afa" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">3.2使用获取API</h2><p id="4fa4" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">我们还可以使用本机Fetch API读取JSON文件，这在所有浏览器中都可用。</p><p id="5366" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，您的代码将如下所示:</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="0a39" class="nl mu iq mn b gy of og l oh oi">// app.component.ts</span><span id="a377" class="nl mu iq mn b gy oj og l oh oi">ngOnInit(): void {<br/>    fetch('./assets/data.json').then(res =&gt; res.json())<br/>    .then(console.log); // do something with data<br/>}</span></pre><h2 id="24ed" class="nl mu iq bd mv nm nn dn mz no np dp nd lo nq nr nf ls ns nt nh lw nu nv nj iw bi translated">3.3使用带角度的JsonPipe</h2><p id="3b62" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">知道这一点很好，即使这不是从JSON文件中读取数据的方法。</p><p id="f978" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">JsonPipe直接来自<a class="ae le" href="https://angular.io/api/common/JsonPipe" rel="noopener ugc nofollow" target="_blank"> Angular </a>，它将一个值转换成JSON格式的表示。该值必须在属性中，而不是在assets中的JSON文件中。</p><p id="9df8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，您应该首先使用上述任何一种方法将JSON文件中的对象分配给一个属性。</p><p id="14a1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">完成后，就可以如下使用JsonPipe了:</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="a716" class="nl mu iq mn b gy of og l oh oi">&lt;p&gt;{{ data | json}}&lt;/p&gt;</span></pre><p id="242d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我建议使用<code class="fe mk ml mm mn b">&lt;pre&gt;</code>标签让结果更漂亮。</p><pre class="kp kq kr ks gt ob mn oc od aw oe bi"><span id="6c85" class="nl mu iq mn b gy of og l oh oi">&lt;pre&gt;{{ data | json}}&lt;/pre&gt;</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi op"><img src="../Images/48d9d7c22d90ed2287d52ec36ac320ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vug-Q1FBGaWz1tafebFPmw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><pre>{{ data | json}}</pre></p></figure><p id="e265" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如文档中所述，这主要用于调试目的。</p><p id="fa34" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您正在学习Angular，您可能会对这个简单的教程感兴趣:</p><div class="oq or gp gr os ot"><a href="https://www.vitainbeta.org/angular-tutorial/" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd ja gy z fp oy fr fs oz fu fw iz bi translated">角度教程- 2022 - vitainbeta</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">这想成为一个非常好的角度教程。正是我希望我有一个当我开始学习角在我的…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">www.vitainbeta.org</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ky ot"/></div></div></a></div></div></div>    
</body>
</html>