<html>
<head>
<title>Getting Started With iOS Animation (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS动画入门(第2部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/getting-start-with-ios-animation-part-2-65f5bcd0c087?source=collection_archive---------15-----------------------#2020-06-24">https://betterprogramming.pub/getting-start-with-ios-animation-part-2-65f5bcd0c087?source=collection_archive---------15-----------------------#2020-06-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f513" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何创建类似电影的动画</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1aa96cd59cb2fb968ae826296a9df5f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PP8FGMLjvOpRajEtmAVX-Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@bryanhanson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布莱恩·汉森</a>在<a class="ae kv" href="https://unsplash.com/s/photos/hummingbird?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="73c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个系列的<a class="ae kv" href="https://medium.com/@nqtuan86/getting-start-with-ios-animation-part-1-7bd3a673bee4" rel="noopener">第一部分，我们学习了如何实现<code class="fe ls lt lu lv b">UIView</code>动画。在这一部分，我们将看到如何在iOS中从图像序列创建动画。</a></p><p id="cdd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将从只使用UIKit内置函数来制作装载循环序列图像的动画开始。接下来，我们将看到如何实现<a class="ae kv" href="https://airbnb.design/lottie/" rel="noopener ugc nofollow" target="_blank"> Lottie </a>库来制作这种相同的动画(唱歌的鸟),但是更加优雅和容易——同时也提供更好的性能。最后，我们将对制作同类动画的各种方法和工具进行比较。</p><p id="a8e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，这是我们在本教程结束时应该得到的预期结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/8a8876f8839f26753e6212eda6b6c66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*rA5aAEi4i48lDFsMxXhG2A.gif"/></div></figure><p id="83c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程是从上一个教程发展而来的。你可以在这里下载这个项目。但是，即使你是从零开始做一个项目，你也可以跟随这个教程。请记住，这个故事是在一个单独的视图控制器上，并且有一个函数，返回，使人能够消除并返回到上一个(第一个)视图控制器。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="a4dd" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">设置视图</h1><p id="f150" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">现在我们必须设置初始视图组件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="d6ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能已经注意到，我们在视图中央插入了一个<code class="fe ls lt lu lv b">UIImageView</code>，并在左上角添加了一个后退按钮。现在，我们在这里没有什么可看的，因为我们只有一个返回按钮，可以返回到上一页。在<code class="fe ls lt lu lv b">viewDidAppear</code>中，我们调用了<code class="fe ls lt lu lv b">animateSequenceImages</code>函数，但是现在它是空的。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="3840" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">使用UIKit制作图像序列动画</h1><p id="24cb" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">首先，我们将创建加载动画。因此，我们应该有一个图像序列作为资产提供给这个动画。我们需要在Xcode中创建一个图像参考文件夹，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/8901c6d2d4caa271af925d6b17909d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zarsgykraG6sWBTbZEaoA.png"/></div></div></figure><p id="56c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以通过本文结尾的链接下载该项目。或者你可以下载一个你在谷歌上找到的GIF文件，把它拆分成一个图像序列。如果你这样做，我建议使用<a class="ae kv" href="https://ezgif.com/split" rel="noopener ugc nofollow" target="_blank"> ezgif </a>来分割这个gif文件。</p><p id="a293" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">酷！我们有资产，现在让它动起来:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="bc91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这很简单:</p><ol class=""><li id="3091" class="ne nf iq ky b kz la lc ld lf ng lj nh ln ni lr nj nk nl nm bi translated">通过<code class="fe ls lt lu lv b">animationImages</code>变量向<code class="fe ls lt lu lv b">UIImageView</code>输入所有<code class="fe ls lt lu lv b">UIImage</code>资产。</li><li id="0638" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">分配动画持续时间(<code class="fe ls lt lu lv b">animationDuration = 5</code>)。</li><li id="bdc2" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">我们不重复动画(<code class="fe ls lt lu lv b">animationRepeatCount = 0</code>)。</li><li id="dcdc" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">最后启动动画(<code class="fe ls lt lu lv b">sequenceImageView.startAnimating()</code>)。</li></ol><p id="b561" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上，我们希望在动画制作时淡出这个加载视图——这就是为什么我们让动画持续时间为五秒钟——但是我们在两秒钟后就淡出了。</p><p id="5dff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是目前为止的结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/5d1ca5150d1b3c0af4dc703471d274fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*QOAEcWbfX9-yfmi7kRbaZA.gif"/></div></figure></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="390a" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">用洛蒂制作动画</h1><p id="85d2" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">Lottie是一个开源框架，最初由Airbnb创建:</p><blockquote class="ns nt nu"><p id="ce3e" class="kw kx nv ky b kz la jr lb lc ld ju le nw lg lh li nx lk ll lm ny lo lp lq lr ij bi translated">“Lottie是一个iOS、Android和React原生库，可以实时渲染After Effects动画，允许应用程序像使用静态图像一样轻松地使用动画。”— <a class="ae kv" href="https://airbnb.design/lottie/" rel="noopener ugc nofollow" target="_blank">洛蒂的官方网站</a></p></blockquote><p id="0cfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要在我们的项目中安装<code class="fe ls lt lu lv b">lottie-ios</code>。Lottie支持CocoaPods、Carthage和Swift包管理器。详情可以咨询他们的<a class="ae kv" href="https://github.com/airbnb/lottie-ios" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>。</p><p id="92c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，我们需要为洛蒂找到资产。LottieFiles是搜索动画资源的绝佳资源。下载你在这里找到的任何免费JSON，并将其命名为<code class="fe ls lt lu lv b">bird.json</code>。将此文件拖放到当前项目中。Lottie的JSON动画文件就像是一个<code class="fe ls lt lu lv b">UIImageView</code>的PNG。</p><p id="d937" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们在视图控制器中设置洛蒂视图(<code class="fe ls lt lu lv b">AnimationView</code>)。其实用<code class="fe ls lt lu lv b">AnimationView</code>和一个普通的<code class="fe ls lt lu lv b">UIImageView</code>很像。我们声明变量:</p><pre class="kg kh ki kj gt nz lv oa ob aw oc bi"><span id="fea8" class="od mf iq lv b gy oe of l og oh"><strong class="lv ir">private</strong> <strong class="lv ir">var</strong> giftView: AnimationView!</span></pre><p id="97f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以在<code class="fe ls lt lu lv b">setupUI()</code>函数中初始化这个视图:</p><pre class="kg kh ki kj gt nz lv oa ob aw oc bi"><span id="072d" class="od mf iq lv b gy oe of l og oh">giftView = AnimationView(name: "bird")<br/>giftView.frame = <strong class="lv ir">self</strong>.view.frame<br/>giftView.contentMode = .scaleAspectFit<br/>giftView.alpha = 0<br/>giftView.loopMode = .autoReverse<br/>view.addSubview(giftView)</span></pre><p id="77b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">AnimationView(name: “bird”)</code>是告诉Lottie框架在主包中寻找文件<code class="fe ls lt lu lv b">bird.json</code>。我们可以注意到，除了<code class="fe ls lt lu lv b">loopMode</code>之外，其他的都和一个<code class="fe ls lt lu lv b">UIImageView</code>一模一样。<code class="fe ls lt lu lv b">loopMode</code>告诉我们动画会向前向后播放，直到停止。</p><p id="f2b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们想在载入淡出时触发鸣鸟动画。我们将在<code class="fe ls lt lu lv b">viewDidAppear</code>中的<code class="fe ls lt lu lv b">animateSequenceImages()</code>完成时调用<code class="fe ls lt lu lv b">animateGift()</code>:</p><pre class="kg kh ki kj gt nz lv oa ob aw oc bi"><span id="c472" class="od mf iq lv b gy oe of l og oh">animateSequenceImages {<br/>    self.animateGift()<br/>}</span></pre><p id="17c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">animateGift()</code>里面，我们淡入<code class="fe ls lt lu lv b">AnimationView</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ea29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">play()</code>功能启动<code class="fe ls lt lu lv b">AnimationView</code>的动画。这是我们的最终结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/8a8876f8839f26753e6212eda6b6c66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*rA5aAEi4i48lDFsMxXhG2A.gif"/></div></figure></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="c450" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">比较不同形式的动画</h1><p id="ede6" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">实际上，有很多方法可以将类似电影的动画嵌入到视图控制器中。</p><p id="b97f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了洛蒂和我们刚刚做的图像序列方法，我们还可以使用GIF，视频，或者甚至使用贝塞尔路径和/或<code class="fe ls lt lu lv b">UIView</code>的动画函数组合来编码。设计师和开发人员开始喜欢Lottie动画而不是其他格式的原因有很多。让我们比较一下洛蒂和你的其他选择。</p><h2 id="0f99" class="od mf iq bd mg oi oj dn mk ok ol dp mo lf om on mq lj oo op ms ln oq or mu os bi translated">PNG序列图像</h2><p id="9254" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">PNG序列图形的最大缺点之一是它们的尺寸相当大，这使得设计师在不同的界面上导出和操作它们有些麻烦。</p><p id="d698" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相比之下，Lottie文件非常小，大小适中，因此下载速度很快，并尽可能保持网站或应用程序运行顺畅。</p><h2 id="6cdc" class="od mf iq bd mg oi oj dn mk ok ol dp mo lf om on mq lj oo op ms ln oq or mu os bi translated">GIF格式</h2><p id="2b69" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">虽然比PNG图形小，gif仍然是一种非常占用空间的格式，比简单的Lottie动画平均大一倍。</p><p id="7196" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">gif通常也以固定的尺寸缩放。这意味着您不能修改它们以更好地适应不同于它们最初创建时的界面上的缩放。Lottie动画为您提供了所需的空间，您可以根据大尺寸解决方案以及小尺寸屏幕进行调整。</p><h2 id="f1c6" class="od mf iq bd mg oi oj dn mk ok ol dp mo lf om on mq lj oo op ms ln oq or mu os bi translated">录像</h2><p id="0c51" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">关于一个简单而简短的动画，视频内容经常出现。对于视频内容，尤其是真人表演，你需要安排大量的资源，包括道具、演员和地点。动画是相对简单和便宜的替代品，但仍能完成工作。</p><p id="e2ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就编码而言，处理视频比处理<code class="fe ls lt lu lv b">AnimationView</code>(就像处理<code class="fe ls lt lu lv b">UIImageView</code>一样简单)要麻烦得多。更不用说:一个好的动画会吸引你的访问者，而不会强迫他们关掉它。</p><h2 id="a0b7" class="od mf iq bd mg oi oj dn mk ok ol dp mo lf om on mq lj oo op ms ln oq or mu os bi translated">代码动画</h2><p id="594d" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">应用程序开发团队希望简化开发流程，尽可能节约成本和资源。</p><p id="4717" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用代码编写动画可能是一个时间和技能密集型的过程，更不用说在编写代码时遇到大量问题是多么容易。与其将宝贵的资源用于外包项目或雇用熟练的员工，为什么不使用Lottie形式的替代动画工具，这种工具直观、可扩展且兼容多种平台？</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="d965" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">从这里去哪里</h1><p id="4de8" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">你可以在这里下载项目<a class="ae kv" href="https://www.dropbox.com/sh/hirw5786plbyspb/AAAdXMiQkuXE43Yup3llAPDOa?dl=0" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="da8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们学习了如何使用PNG序列图像和Lottie创建类似电影的动画。我们还发现了一个伟大的洛蒂动画资源:<a class="ae kv" href="https://lottiefiles.com/" rel="noopener ugc nofollow" target="_blank">洛蒂文件</a>。我们也看到了为什么Lottie在短动画方面比其他所有的动画形式都要好。</p><p id="cdb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们完成了这个系列的第二部分。在下一部分，我们将看到如何制作视图控制器之间的过渡动画。这是我们三部分系列的最终结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ae4218c55e267815d44b611deb15882a.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*Nbh4E2lhoN9OrlkjqCD1ZQ.gif"/></div></figure></div></div>    
</body>
</html>