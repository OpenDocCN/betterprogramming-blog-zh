<html>
<head>
<title>How to Use the Swift Package Manager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Swift软件包管理器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-swift-package-manager-9235d8324f7e?source=collection_archive---------16-----------------------#2020-04-13">https://betterprogramming.pub/how-to-use-swift-package-manager-9235d8324f7e?source=collection_archive---------16-----------------------#2020-04-13</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="0bfa" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让椰子和迦太基从你的项目中退出</h2></div><p id="96ba" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">Swift Package Manager (SPM)是苹果在2015年与Swift一起发布的Swift的依赖管理器，加入了其他知名的依赖管理器，如<a class="ae lf" href="https://cocoapods.org/" rel="noopener ugc nofollow" target="_blank"> CocoaPods </a>和<a class="ae lf" href="https://github.com/Carthage/Carthage" rel="noopener ugc nofollow" target="_blank"> Carthage </a>。然而，直到Xcode 11的发布，这个工具才被集成到Xcode本身中，这使得它更容易使用。现在，我们将学习如何使用Swift Package Manager。</p><h1 id="0eca" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">Swift套餐</h1><p id="a7cf" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">Swift包由一系列包含源代码和清单的文件组成，一个名为<code class="fe md me mf mg b">Package.swift</code>的文件(在根目录中找到)，它定义了包的名称、内容等等。当我们编译这些文件时，我们生成一个单独的模块，然后可以共享(例如从GitHub)导入到其他项目中。这些文件被编译成一个模块，然后可以被其他项目导入。</p><h1 id="5948" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">如何创建Swift包</h1><p id="d362" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">使用Xcode 11，很容易创建Swift包。在Xcode菜单中，选择文件&gt;新建&gt; Swift包:</p><figure class="mi mj mk ml gu mm gi gj paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gi gj mh"><img src="../Images/1624cf85ad0e3058b6f431ff0884f808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8iVOU7nIgIJhbOfU.png"/></div></div></figure><p id="87b3" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">然后我们给项目命名并创建它:</p><figure class="mi mj mk ml gu mm gi gj paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gi gj mh"><img src="../Images/96b67a2a4ae8430117f4c3e859da8594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3KBPjbYQGCxPVR1R.png"/></div></div></figure><p id="24ac" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">就这么简单—我们现在已经生成了一个Swift包。我们在屏幕上首先看到的是<code class="fe md me mf mg b">Package.swift</code>文件的内容:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="c3d2" class="mx lh iu mg b be my mz l na nb">import PackageDescription<br/> <br/>let package = Package(<br/>    name: "MyLibrary",<br/>    products: [<br/>        // Products define the executables and libraries produced by a package, and make them visible to other packages.<br/>        .library(<br/>            name: "MyLibrary",<br/>            targets: ["MyLibrary"]),<br/>    ],<br/>    dependencies: [<br/>        // Dependencies declare other packages that this package depends on.<br/>        // .package(url: /* package url */, from: "1.0.0"),<br/>    ],<br/>    targets: [<br/>        // Targets are the basic building blocks of a package. A target can define a module or a test suite.<br/>        // Targets can depend on other targets in this package, and on products in packages which this package depends on.<br/>        .target(<br/>            name: "MyLibrary",<br/>            dependencies: []),<br/>        .testTarget(<br/>            name: "MyLibraryTests",<br/>            dependencies: ["MyLibrary"]),<br/>    ]<br/>)</span></pre><p id="cc73" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">在这个宣言中我们发现:</p><ul class=""><li id="0cff" class="nc nd iu kl b km kn kp kq ks ne kw nf la ng le nh ni nj nk bi translated"><code class="fe md me mf mg b">name</code>—项目名称。</li><li id="f26d" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated"><code class="fe md me mf mg b">products</code> <strong class="kl iv"> — </strong>定义项目中定义的哪些可执行文件和库对其他包可见。</li><li id="bbf9" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated"><code class="fe md me mf mg b">dependencies</code> —这里定义了我们项目所依赖的其他包。</li><li id="a12f" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated"><code class="fe md me mf mg b">targets</code> —这是我们向主项目添加新依赖项的地方。</li></ul><h1 id="33fd" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">添加依赖项:示例</h1><p id="14aa" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">例如，假设我们想要创建一个Swift包，并且我们知道我们将使用<code class="fe md me mf mg b">RxSwift</code>库。首先，我们访问<code class="fe md me mf mg b">RxSwift</code> GitHub存储库。如果我们深入到它指示如何安装的地方，我们会看到它为我们提供了<em class="nq"> Cocoapods </em>、<em class="nq"> Carthage、</em>和<em class="nq"> Swift包管理器</em>的选项。后者是我们感兴趣的，在那里我们可以观察我们必须添加到我们的Swift产品包中的依赖关系和目标:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="5dc3" class="mx lh iu mg b be my mz l na nb">let package = Package(<br/>  name: "RxTestProject",<br/>  dependencies: [<br/>    .package(url: "https://github.com/ReactiveX/RxSwift.git", from: "5.0.0")<br/>  ],<br/>  targets: [<br/>    .target(name: "RxTestProject", dependencies: ["RxSwift", "RxCocoa"])<br/>  ]<br/>)</span></pre><p id="e955" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">因此，在我们的<code class="fe md me mf mg b">Package.swift</code>中，我们将这些值相加，如下所示:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="b228" class="mx lh iu mg b be my mz l na nb">import PackageDescription<br/> <br/>let package = Package(<br/>    name: "MyLibrary",<br/>    products: [<br/>        // Products define the executables and libraries produced by a package, and make them visible to other packages.<br/>        .library(<br/>            name: "MyLibrary",<br/>            targets: ["MyLibrary"]),<br/>    ],<br/>    dependencies: [<br/>        // Dependencies declare other packages that this package depends on.<br/>        .package(url: "https://github.com/ReactiveX/RxSwift.git", from: "5.0.0")<br/>    ],<br/>    targets: [<br/>        // Targets are the basic building blocks of a package. A target can define a module or a test suite.<br/>        // Targets can depend on other targets in this package, and on products in packages which this package depends on.<br/>        .target(<br/>            name: "MyLibrary",<br/>            dependencies: ["RxSwift", "RxCocoa"]),<br/>        .testTarget(<br/>            name: "MyLibraryTests",<br/>            dependencies: ["MyLibrary"]),<br/>    ]<br/>)</span></pre><p id="fe78" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">值<code class="fe md me mf mg b">from: “5.0.0”</code>告诉我们哪个版本的RxSwift将包含在我们的项目中。也就是说，将包括等于或高于5.0.0的RxSwift的最新版本。但是，我们也可以指明只包含某个版本、分支甚至修订版:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="eeb7" class="mx lh iu mg b be my mz l na nb">// Version of a package<br/>.package (url: "https://github.com/ReactiveX/RxSwift.git", .exact ("5.1.0"))<br/> <br/>// Version of a certain branch (for example, develop)<br/>.package (url: "https://github.com/ReactiveX/RxSwift.git", .branch ("develop"))<br/> <br/>// Version of a certain revision (commit):<br/>.package (url: "https://github.com/ReactiveX/RxSwift.git", .revision ("002d325b0bdee94e"))</span></pre><p id="483a" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">将依赖项添加到我们的项目后，当我们构建它时，我们会看到侧面导航菜单中出现一个新部分(“Swift Package Dependencies”)，指示我们已添加到项目中的依赖项(在本例中为<code class="fe md me mf mg b">RxSwift</code>)。</p><figure class="mi mj mk ml gu mm gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/84f36957ad4bedbad0e38e3470494e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/0*pEKEMoxyISRCUhta.png"/></div></figure><h1 id="aa0f" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">平台设置</h1><p id="5b87" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">在<code class="fe md me mf mg b">Package.swift</code>文件中，我们还可以指出我们的项目是为哪个平台或操作系统指定的。例如，如果我们希望我们的Swift产品包仅用于iOS 12+操作系统，我们可以这样表示:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="24a2" class="mx lh iu mg b be my mz l na nb">let package = Package(<br/>    name: "MyLibrary",<br/>    platforms: [.iOS(.v12)],<br/>    products: [<br/>      ...</span></pre><p id="ff12" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">如<a class="ae lf" href="https://developer.apple.com/documentation/swift_packages/platform" rel="noopener ugc nofollow" target="_blank">苹果文档</a>所示，支持的不同平台有:</p><ul class=""><li id="040d" class="nc nd iu kl b km kn kp kq ks ne kw nf la ng le nh ni nj nk bi translated">ios</li><li id="ffd2" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated">Linux操作系统</li><li id="c4f9" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated">马科斯</li><li id="5ab6" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated">tvOS</li><li id="fe62" class="nc nd iu kl b km nl kp nm ks nn kw no la np le nh ni nj nk bi translated">watchOS</li></ul><p id="f28b" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我们也可以定义多个平台。例如:</p><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="21a4" class="mx lh iu mg b be my mz l na nb">let package = Package(<br/>    name: "MyLibrary",<br/>    platforms: [.iOS(.v12), .macOS(.v10_15)],<br/>    products: [<br/>      ...</span></pre><h1 id="7969" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">向我们的Swift产品包添加代码</h1><p id="a03b" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">一旦我们配置了项目，我们就可以添加代码了。记住——我们希望在导入Swift包<em class="nq">的项目中使用的类和方法必须声明为public </em>。一旦我们完成了项目并将它上传到一个存储库(比如GitHub或GitLab)，我们就可以下载它并将其包含在其他项目中。</p><h1 id="4d08" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">如何向我们的应用程序添加Swift包</h1><p id="264b" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">要将我们创建的Swift包添加到应用程序中，我们只需执行以下操作(只要我们使用Xcode 11):</p><ul class=""><li id="716a" class="nc nd iu kl b km kn kp kq ks ne kw nf la ng le nh ni nj nk bi translated">从顶部菜单我们进入<em class="nq"> </em>文件&gt; Swift包&gt;添加包依赖:</li></ul><figure class="mi mj mk ml gu mm gi gj paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gi gj mh"><img src="../Images/3d9a609ba865a51f049b438dd5b731fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wh90lT5zQXOCnMkS.png"/></div></div></figure><ul class=""><li id="2c5e" class="nc nd iu kl b km kn kp kq ks ne kw nf la ng le nh ni nj nk bi translated">在出现的窗口中，我们添加项目URL并按“OK”(这将把Swift包下载到我们的项目中):</li></ul><figure class="mi mj mk ml gu mm gi gj paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gi gj ns"><img src="../Images/f7671b58b8b320068b20be8ea21bd55a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kduP-NYxRK4NvJgm.png"/></div></div></figure><ul class=""><li id="4358" class="nc nd iu kl b km kn kp kq ks ne kw nf la ng le nh ni nj nk bi translated">无论我们想在哪里使用它，我们只需导入它们:</li></ul><pre class="mi mj mk ml gu mt mg mu bn mv mw bi"><span id="aebb" class="mx lh iu mg b be my mz l na nb">#import MyLibray</span></pre><h1 id="0bb1" class="lg lh iu bd li lj lk ll lm ln lo lp lq ka lr kb ls kd lt ke lu kg lv kh lw lx bi translated">结论</h1><p id="c9db" class="pw-post-body-paragraph kj kk iu kl b km ly jv ko kp lz jy kr ks ma ku kv kw mb ky kz la mc lc ld le in bi translated">随着Swift Package Manager添加到Xcode 11，为我们的项目创建和添加依赖关系变得非常容易。这开辟了一种新的方式，例如，调整我们的应用程序——从单一的应用程序到由模块组成的应用程序——并帮助我们更容易地在项目之间共享代码。</p></div></div>    
</body>
</html>