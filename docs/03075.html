<html>
<head>
<title>Build a Global Dialog Modal Infrastructure With React Hooks and Redux Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React钩子和Redux钩子构建一个全局对话模态基础设施</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/global-dialog-modal-infrastructure-with-react-hooks-and-redux-hooks-1b6bedd052a6?source=collection_archive---------3-----------------------#2020-01-19">https://betterprogramming.pub/global-dialog-modal-infrastructure-with-react-hooks-and-redux-hooks-1b6bedd052a6?source=collection_archive---------3-----------------------#2020-01-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的模态出现在你喜欢的任何地方</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/320c84e8c9b3275b6553e987c1a2bc65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJnA1n422AfEU23e-eWSBA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">罗恩·惠特克在<a class="ae ky" href="https://unsplash.com/s/photos/patterns?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="39b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于对话模式几乎与每个web应用程序密不可分，所以您需要明智地构建它的基础设施。使用React hooks(版本16.8及以上)，您可以轻松优雅地跨应用程序重用逻辑。在本文中，我们将介绍一种使用React钩子和Redux钩子创建对话模态基础设施的全局管理方法。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="eb7b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">选择正确的方法</h1><p id="7732" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">受<a class="ae ky" href="http://atomicdesign.bradfrost.com/chapter-2/" rel="noopener ugc nofollow" target="_blank">原子设计方法</a>的启发，最佳实践场景是使用外部/内部可重用组件库将模态容器从应用程序中分离出来。然后你需要问自己，你要去哪里管理Modal的逻辑？你在使用全球管理库吗？在哪里呈现它——在DOM中预先确定的位置，还是动态追加？</p><p id="00ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建模态基础设施的方法有很多，您可以使用以下方法管理其逻辑。</p><h2 id="093b" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">本地管理</h2><p id="6651" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">保存一个全局模态组件，并管理使用它的每个组件的局部状态。您可以使用<a class="ae ky" href="https://reactjs.org/docs/portals.html" rel="noopener ugc nofollow" target="_blank"> React Portal </a>来呈现它，React Portal 直接在消费组件内部呈现，并提供了一种在父组件的DOM层次结构之外的DOM节点中呈现子组件的方法。另一种方法是全局包含模态对话框元素，并以旧的方式动态添加其子元素。</p><p id="19fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在应用程序中很少使用对话模式，并且在构建可靠的基础设施上的投资是负面的，那么您可以选择这种快速实现。</p><h2 id="b841" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">全球管理</h2><p id="e8e1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您已经在使用状态管理库(比如Redux ),并且在整个应用程序中使用对话框模态，那么您最好在全局状态中管理它的逻辑，创建一个可重用的共享逻辑并将其呈现为一个全局元素。如今，用钩子很容易做到——让我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="68c7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">带有React和Redux挂钩的全局模式</h1><p id="ecba" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">假设您在一个<strong class="lb iu">外部库</strong>中托管您的通用和可重用组件，您应该创建一个模态目录，该目录具有一个<code class="fe nm nn no np b">&lt;Modal /&gt;</code>组件，该组件将其子组件:<code class="fe nm nn no np b">&lt;ModalTitle /&gt;</code>、<code class="fe nm nn no np b">&lt;ModalHeader /&gt;</code>、<code class="fe nm nn no np b">&lt;ModalBody /&gt;</code>和<code class="fe nm nn no np b">&lt;ModalFooter /&gt;</code>呈现为子组件和原子组件。</p><p id="9aa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在应用程序中使用模态组件是通过创建一个<code class="fe nm nn no np b">&lt;ModalWrapper /&gt;</code>容器来实现的，这个容器使用全局状态管理钩子(例如Redux钩子)来呈现模态组件并管理它的可视状态。容器将有它的视图、缩减器、常量和自定义钩子文件。</p><p id="8c78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，将<code class="fe nm nn no np b">&lt;ModalWrapper /&gt;</code>包含在全局级别中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">索引. jsx</p></figure><p id="7572" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建一个<code class="fe nm nn no np b">&lt;ModalWrapper /&gt;</code>容器，根据商店的参数(大小、类型、主体、标题等)呈现模式对话框。).</p><p id="813c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显示一个对话框模态是通过使用带有你所请求的参数的定制钩子调度<code class="fe nm nn no np b">SHOW_MODAL/HIDE_MODAL</code>动作来完成的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ModalWrapper.jsx</p></figure><p id="78a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<a class="ae ky" href="https://reactjs.org/docs/code-splitting.html#reactlazy" rel="noopener ugc nofollow" target="_blank"> react.lazy </a>动态地呈现一个定制组件，该组件采用一个函数，该函数必须调用一个动态<code class="fe nm nn no np b">import()</code>并且必须返回一个<code class="fe nm nn no np b">Promise</code>，该函数解析为一个带有包含react组件的<code class="fe nm nn no np b">default</code>导出的模块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">modalWrapperReducer.js</p></figure><p id="e0f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有任何特殊的处理，例如，对于一个确认对话框，你可以为它创建一个可重用的钩子，并且基本上为你所有的可重用模态的逻辑。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">modalWrapperHooks.js</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c81d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用法示例</h1><ul class=""><li id="08d8" class="ns nt it lb b lc mu lf mv li nu lm nv lq nw lu nx ny nz oa bi translated">渲染一个基本模态将来自组件钩子文件，带有带有所有必要参数的<code class="fe nm nn no np b">useShowModal</code>钩子。</li><li id="80d2" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">在模态内部呈现动态组件是通过传递绝对路径和可选的组件属性来完成的。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">modalUsageHooks.js</p></figure><p id="efc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e37c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><p id="8a18" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">模态是常见的，如果您正在使用最新的React、Redux和React-Redux版本，您可以很容易地以模块化和可重用的方式创建基础设施。</p></div></div>    
</body>
</html>