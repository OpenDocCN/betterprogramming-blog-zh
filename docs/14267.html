<html>
<head>
<title>5 Python Modules That Make Building APIs Easier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个Python模块，使构建API变得更加容易</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-python-modules-that-make-building-apis-easier-a8d39911f6a8?source=collection_archive---------2-----------------------#2022-11-23">https://betterprogramming.pub/5-python-modules-that-make-building-apis-easier-a8d39911f6a8?source=collection_archive---------2-----------------------#2022-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a4f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">快速测试和交付这些终端</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/24831e3f2c5b032df49c301ebc9fa117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zaVQgYpZO5yUjkR_uZflQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/development?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@ffstop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">的照片</a></p></figure><p id="0e84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API运行着我们的数字世界。几乎地球上的每个网站都会在某个时候利用API。无论是从后端获取数据还是执行复杂的计算，API调用出现在现代网站上的几率几乎是100%。</p><p id="8e3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于这些服务位于许多大型产品的核心，您可能会认为构建它们的原型会简单而快速。情况并非总是如此。构建一个健壮的API有隐藏的复杂性。幸运的是，使用Python，您可以随意使用大量久经考验的工具。让您以前所未有的速度开发、测试和发布API的工具。最好的部分是你不必浪费时间在一堆样板代码上。</p><p id="b8e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探索几个专门用于构建和测试API的Python模块。这些模块展示了如何快速地将您的API想法付诸实践。</p><h1 id="4cb3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">1.FastAPI</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/7fdf7532744c65662998b0d0af6d0c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLBCaqoFqTT5M30EVUVT2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="56d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>就是<em class="mo">快</em>。您可以比许多其他平台更快地构建API原型。这是一个用于构建API的完整框架，并以定义端点的异常清晰的语法而自豪。只需添加一个装饰器，返回一些数据，就可以开始比赛了。</p><p id="d3a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看下面这个超级简短的例子。在这个例子中，我们在应用程序的根处用一个<code class="fe mp mq mr ms b">GET</code>方法定义了一个单一的路由:</p><pre class="kj kk kl km gt mt ms mu bn mv mw bi"><span id="6bf2" class="mx lw it ms b be my mz l na nb">from fastapi import FastAPI<br/><br/>app = FastAPI()<br/><br/>@app.get("/")<br/>def get_root():<br/>    return {"response": "hello"}</span></pre><p id="6eb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个方法将为任何到达端点的人提供一个简单的JSON响应。虽然这是一个基本的例子，但是它显示了构建一个端点需要多么少的代码。</p><p id="0bdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe mp mq mr ms b">uvicorn</code>模块通过执行以下命令来运行这个示例:</p><pre class="kj kk kl km gt mt ms mu bn mv mw bi"><span id="5305" class="mx lw it ms b be my mz l na nb">python3 -m uvicorn main:app</span></pre><p id="2e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FastAPI混淆了所有混乱的请求/响应处理，留给您一个光滑、干净的接口来构建您的API。它还允许您使用Python中的类型提示进行构建，并且默认包含一个用于自动文档的<a class="ae ky" href="https://github.com/swagger-api/swagger-ui" rel="noopener ugc nofollow" target="_blank"> Swagger UI </a>。</p><p id="e6c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看官方<a class="ae ky" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI文档</a>了解更多详细信息。</p><h1 id="348f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">2.瓶</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7b0569a6d08763ba08c33bcb2d09fec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/0*LQKWAafFe-CWujWI.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://flask.palletsprojects.com/en/2.2.x/" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="20d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在Python世界中，您可能在某个时候听说过Flask。毫无疑问，这是使用Python构建API最流行的方式之一。它很容易上手，有大量的现有支持和更多的第三方插件。</p><p id="08e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://flask.palletsprojects.com/en/2.2.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>为Python上的API提供了基本的构建模块。如果您正在寻找一个高度可扩展的平台，这就是它。唯一的缺点是它会变得非常复杂。初来乍到的Flask用户可能会觉得有点不知所措。</p><p id="280b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个提供单一路线的示例Flask应用程序:</p><pre class="kj kk kl km gt mt ms mu bn mv mw bi"><span id="595e" class="mx lw it ms b be my mz l na nb"># ./my_app.py<br/><br/>from flask import Flask<br/><br/>app = Flask(__name__)<br/><br/>@app.route("/")<br/>def basic_route():<br/>    return {"response":"hello"}</span></pre><p id="3293" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过运行以下命令轻松启动开发Flask服务器:</p><pre class="kj kk kl km gt mt ms mu bn mv mw bi"><span id="f1b3" class="mx lw it ms b be my mz l na nb">python3 -m flask --app my_app run</span></pre><p id="623b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flask与FastAPI非常相似，事实上，两个模块都利用了一些相同的底层思想。虽然Flask看起来一样，但它是一个更完整的框架，不仅可以构建API，还可以构建完整的web应用程序。如果将来你想要比简单的后端更多的功能，Flask可能是一个更好的选择。</p><p id="5c7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://flask.palletsprojects.com/en/2.2.x/" rel="noopener ugc nofollow" target="_blank">官方烧瓶文档</a>了解更多实现细节。</p><h1 id="370f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">3.比请求更快</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/e8dd230812b6a11dd31e977f7ad5789f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kp5eKuPzSXGxX0mz5OZEwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/juancarlospaco/faster-than-requests" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="eb30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都使用过Python中的<code class="fe mp mq mr ms b">requests</code>库来与网页或API交互。但是你注意到图书馆有多慢了吗？如果您必须向外部资源或其他中间端点发出大量请求，那么<code class="fe mp mq mr ms b">requests</code>库可能会让您陷入困境。</p><p id="d68f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是<code class="fe mp mq mr ms b"><a class="ae ky" href="https://github.com/juancarlospaco/faster-than-requests" rel="noopener ugc nofollow" target="_blank">faster-than-requests</a></code>图书馆存在的原因。正是因为它和<code class="fe mp mq mr ms b">requests</code>库几乎一模一样但是速度更快。比如，<em class="mo">快了很多</em>。如果参考上面的统计数据，这个库比标准库快30多倍。</p><p id="f199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好的部分是，你可以用与<code class="fe mp mq mr ms b">requests</code>相同的名字导入它，并且你不需要显著改变你现有的模块调用。</p><p id="3e81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看GitHub官方页面，了解比请求更快的信息:</p><div class="ne nf gp gr ng nh"><a href="https://github.com/juancarlospaco/faster-than-requests" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">GitHub-juancarlospaco/比请求更快:Python 3上更快的请求</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">库速度文件LOC依赖关系开发者WebSockets多线程Web Scraper内置快于请求…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ks nh"/></div></div></a></div><h1 id="5049" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.VCR.py</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/a5b0977cc8233b35dece7dd28cd2ffd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alsKaayaM_gFffbBesO5mw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://vcrpy.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="4aa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我非常喜欢使用<a class="ae ky" href="https://vcrpy.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> VCR </a>库进行Ruby测试。自然地，当我得知它被移植到Python时，我激动不已。VCR.py模块是原始Ruby版本的端口，它的工作方式也非常好。</p><p id="c3ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个模块允许您记录真实的HTTP响应，然后在以后回放它们。响应存储在“包埋盒”中，您可以为不同的测试装载不同的包埋盒。</p><p id="bc22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您有一个来自远程API的相当大、复杂的HTTP响应，您的一个测试使用了这个响应。这个API的响应对于测试的成功至关重要。响应也是巨大的，无法包含在每个测试运行中。它太长或太大，无法在网络上反复运行。这就是录像机拯救世界的地方。</p><p id="ff4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样记录来自真实测试端点的响应:</p><pre class="kj kk kl km gt mt ms mu bn mv mw bi"><span id="2e88" class="mx lw it ms b be my mz l na nb">import json<br/>import vcr<br/>import urllib<br/><br/>URL = "https://jsonplaceholder.typicode.com/todos/1"<br/><br/>with vcr.use_cassette('fixtures/vcr_cassettes/test.json'):<br/>    http_res = urllib.request.urlopen(URL)<br/>    res = json.loads(http_res.read())<br/>    assert res['id'] == 1</span></pre><p id="c2ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码将对一些测试JSON数据执行一个简单的HTTP请求。一旦请求完成一次，它将被加载到一个盒子中，然后每次后续运行都将使用这个盒子，而不是实际的HTTP请求。现在你甚至不需要在线运行这个测试！</p><p id="5e30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">官方文件是<a class="ae ky" href="https://vcrpy.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">可在这里</a>获得。</p><h1 id="e85b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.Swagger UI</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/db0106f9178f9612c86b2e8f646e8835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YMkf6L-ZcXlMdfFB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://swagger.io/tools/swagger-ui/" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="4696" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你以前没有用过<a class="ae ky" href="https://swagger.io/tools/swagger-ui/" rel="noopener ugc nofollow" target="_blank"> Swagger UI </a>，那你就错过了。这是一种自动可视化API的强大方法。您不必在完全独立的UI或文档服务上投入大量工作。您只需提供每个端点的基本信息。Swagger将自动为您构建API explorer并生成文档。还有比这更简单的吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/6ee2de0b5ec07434ce46f13832642a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_f3RrBeg72cgdA_rs1gA1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://swagger.io/tools/swagger-ui/" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="06e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Swagger UI可以集成到很多流行的框架中，比如Flask。在某些情况下，你所需要做的就是在你的方法上附加一个基本的<a class="ae ky" href="https://pypi.org/project/flask-swagger/" rel="noopener ugc nofollow" target="_blank">文档串</a>，你很快就会有完整的API文档。</p><p id="728b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要浪费时间为API文档重新发明轮子。使用Swagger UI，立即获得功能丰富的服务。</p><p id="dea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://swagger.io/docs/open-source-tools/swagger-ui/usage/installation/" rel="noopener ugc nofollow" target="_blank">官方文件</a>了解更多信息。</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="5d46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！喜欢这篇文章吗？下面是我的一些其他帖子:</p><ul class=""><li id="aeae" class="og oh it lb b lc ld lf lg li oi lm oj lq ok lu ol om on oo bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/a-simple-way-to-make-rpcs-with-python-52ad8e9286c1"> <em class="mo">用Python制作RPC的简单方法</em> </a></li><li id="42fa" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/python-modules-that-make-handling-json-even-faster-f577d8948a5"> <em class="mo"> Python模块，让处理JSON更快</em> </a></li><li id="822e" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/clean-up-your-kubernetes-deployments-using-ansible-10a000db313b"> <em class="mo">使用Ansible </em> </a>清理您的Kubernetes部署</li></ul></div></div>    
</body>
</html>