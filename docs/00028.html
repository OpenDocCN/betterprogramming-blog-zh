<html>
<head>
<title>How to Extract Words From PDFs With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python从pdf中提取单词</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-convert-pdfs-into-searchable-key-words-with-python-85aab86c544f?source=collection_archive---------4-----------------------#2017-05-12">https://betterprogramming.pub/how-to-convert-pdfs-into-searchable-key-words-with-python-85aab86c544f?source=collection_archive---------4-----------------------#2017-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c1d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">仅提取您需要的文本</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d5ffeafe35baa4905b4b04e5c6c4aff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gBhskaNM1Axh0JjL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Raphael Schaller 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="6120" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我在<a class="ae ky" href="https://medium.com/better-programming/how-to-connect-to-google-sheets-with-python-83d0b96eeea6" rel="noopener">的上一篇文章</a>中提到的，我一直在与一个客户合作，帮助他们解析数百个PDF文件，提取关键词，使它们变得可搜索。</p><p id="dd96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决问题的一部分是弄清楚如何从所有这些PDF文件中提取文本数据。你可能会惊讶地发现事情没那么简单。你看，pdf是Adobe的专有格式，当涉及到从每个文件中自动提取信息的过程时，它有自己的小怪癖。</p><p id="e66f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，我们有适合这项工作的语言:Python。现在，我已经明确了我对Python的热爱。它很容易阅读，有一大堆很棒的库，可以让你做基本上任何事情。它是你多功能腰带上的完美工具。正如我之前提到的，它让你成为蝙蝠侠。</p><p id="15d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来是一个教程，教你如何解析一个PDF文件，并把它转换成一个关键字列表。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="239e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置</h1><p id="08db" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于本教程，我将使用Python 3.6.3。你可以使用任何你喜欢的版本(只要它支持相关的库)。</p><p id="3df6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要学习本教程，您需要以下Python库:</p><ul class=""><li id="c1be" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><a class="ae ky" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank"> PyPDF2 </a>(将简单的基于文本的PDF文件转换成Python可读的文本)</li><li id="6d0f" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://textract.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> textract </a>(将重要的扫描PDF文件转换成Python可读的文本)</li><li id="114a" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> NLTK </a>(清理短语并将其转换为关键字)</li></ul><p id="154d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个库都可以在终端(在macOS上)中使用以下命令安装:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c2ce" class="ns md it no b gy nt nu l nv nw">pip install PyPDF2</span><span id="7040" class="ns md it no b gy nx nu l nv nw">pip install textract</span><span id="ea8b" class="ns md it no b gy nx nu l nv nw">pip install nltk</span></pre><p id="aef5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将下载解析PDF文档和提取关键字所需的库。为此，请确保您的PDF文件存储在您编写脚本的文件夹中。</p><p id="f3fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">启动您最喜欢的编辑器并键入:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5164" class="ns md it no b gy nt nu l nv nw">Note: All lines starting with # are comments.</span></pre><h2 id="30af" class="ns md it bd me ny nz dn mi oa ob dp mm li oc od mo lm oe of mq lq og oh ms oi bi translated">步骤1:导入所有库</h2><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="2974" class="ns md it no b gy nt nu l nv nw">import PyPDF2 <br/>import textract</span><span id="7b3f" class="ns md it no b gy nx nu l nv nw">from nltk.tokenize import word_tokenize<br/>from nltk.corpus import stopwords</span></pre><h2 id="3615" class="ns md it bd me ny nz dn mi oa ob dp mm li oc od mo lm oe of mq lq og oh ms oi bi translated">第二步:阅读PDF文件</h2><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d7d3" class="ns md it no b gy nt nu l nv nw">#Write a for-loop to open many files (leave a comment if you'd like to learn how).</span><span id="8148" class="ns md it no b gy nx nu l nv nw">filename = '<em class="oj">enter the name of the file here' </em></span><span id="00c1" class="ns md it no b gy nx nu l nv nw">#open allows you to read the file.</span><span id="051e" class="ns md it no b gy nx nu l nv nw">pdfFileObj = open(filename,'rb')</span><span id="f7b1" class="ns md it no b gy nx nu l nv nw">#The pdfReader variable is a readable object that will be parsed.</span><span id="592f" class="ns md it no b gy nx nu l nv nw">pdfReader = PyPDF2.PdfFileReader(pdfFileObj)</span><span id="4a5b" class="ns md it no b gy nx nu l nv nw">#Discerning the number of pages will allow us to parse through all the pages.</span><span id="a114" class="ns md it no b gy nx nu l nv nw">num_pages = pdfReader.numPages<br/>count = 0<br/>text = ""</span><span id="3d9d" class="ns md it no b gy nx nu l nv nw">#The while loop will read each page.<br/>while count &lt; num_pages:<br/>    pageObj = pdfReader.getPage(count)<br/>    count +=1<br/>    text += pageObj.extractText()</span><span id="c4e5" class="ns md it no b gy nx nu l nv nw">#This if statement exists to check if the above library returned words. It's done because PyPDF2 cannot read scanned files.</span><span id="8525" class="ns md it no b gy nx nu l nv nw">if text != "":<br/>   text = text</span><span id="9d31" class="ns md it no b gy nx nu l nv nw">#If the above returns as False, we run the OCR library textract to #convert scanned/image based PDF files into text.</span><span id="6137" class="ns md it no b gy nx nu l nv nw">else:<br/>   text = textract.process(fileurl, method='tesseract', language='eng')</span><span id="5764" class="ns md it no b gy nx nu l nv nw">#Now we have a text variable that contains all the text derived from our PDF file. Type print(text) to see what it contains. It likely contains a lot of spaces, possibly junk such as '\n,' etc.</span><span id="d07b" class="ns md it no b gy nx nu l nv nw">#Now, we will clean our text variable and return it as a list of keywords.</span></pre><h2 id="6941" class="ns md it bd me ny nz dn mi oa ob dp mm li oc od mo lm oe of mq lq og oh ms oi bi translated">步骤3:将文本转换成关键词</h2><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="3436" class="ns md it no b gy nt nu l nv nw">#The word_tokenize() function will break our text phrases into individual words.</span><span id="bbbb" class="ns md it no b gy nx nu l nv nw">tokens = word_tokenize(text)</span><span id="7ce8" class="ns md it no b gy nx nu l nv nw">#We'll create a new list that contains punctuation we wish to clean.<br/>punctuations = ['(',')',';',':','[',']',',']</span><span id="1471" class="ns md it no b gy nx nu l nv nw">#We initialize the stopwords variable, which is a list of words like "The," "I," "and," etc. that don't hold much value as keywords.</span><span id="1522" class="ns md it no b gy nx nu l nv nw">stop_words = stopwords.words('english')</span><span id="46c1" class="ns md it no b gy nx nu l nv nw">#We create a list comprehension that only returns a list of words that are NOT IN stop_words and NOT IN punctuations.</span><span id="405c" class="ns md it no b gy nx nu l nv nw">keywords = [word for word in tokens if not word in stop_words and not word in punctuations]</span></pre><p id="b6f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经将文件的关键字存储为一个列表。你可以用它做任何你想做的事。如果您想让PDF可搜索或解析大量文件并进行聚类分析，请将其存储在电子表格中。你也可以用它来创建一个求职简历推荐系统。</p><p id="c15e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你觉得这篇教程很有价值！如果你有任何要求，想要一些澄清，或发现一个错误，请让我知道！</p></div></div>    
</body>
</html>