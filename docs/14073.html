<html>
<head>
<title>How to Run Ganache in a Browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在浏览器中运行Ganache</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-run-ganache-in-a-browser-399db3eaa22?source=collection_archive---------13-----------------------#2022-11-01">https://betterprogramming.pub/how-to-run-ganache-in-a-browser-399db3eaa22?source=collection_archive---------13-----------------------#2022-11-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0bee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用区块链发展网的逐步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ff4a697fc05ec0e13eafde5e71b32b21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47nuqOCrNXqH0LV0huibIQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者提供的图片</p></figure><p id="924d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当开发Web3项目时，有一个本地的区块链devnet进行测试是很有帮助的。Ganache是以太坊生态系统中最受欢迎的工具之一，也是T2松露的一部分。Ganache允许您使用不同的设置来设置本地区块链，以便在部署之前彻底测试您的智能合约。</p><p id="860e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在终端中查看本地区块链的输出有助于您了解项目在真实环境中的表现。将输出设置为变量以操作一些前端代码的能力甚至更有用。有些用户可能不知道在浏览器中运行Ganache可以做到这一点。</p><p id="256f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文探讨了如何在浏览器中运行Ganache，并强调了三个使开发Web3项目变得更容易的新特性。</p><h1 id="bcd8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">浏览器中的Ganache</h1><p id="339e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在Web3开发过程中，运行一个本地区块链实例来测试您的智能合约是必不可少的。通过以这种方式进行测试，在使用节点服务(比如<a class="ae lr" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>)将合同部署到测试网或主网之前，您可以确认一切正常。这最大限度地降低了增加每日限额的风险，并确保您只需部署一次。Ganache是一个模拟以太网的优秀工具，它允许开发人员:</p><ul class=""><li id="02bd" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><a class="ae lr" href="https://trufflesuite.com/blog/introducing-ganache-7/#2-fork-any-ethereum-test-network-without-waiting-for-sync-time" rel="noopener ugc nofollow" target="_blank">分叉任何以太坊网络，无需等待同步</a></li><li id="bead" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://trufflesuite.com/blog/introducing-ganache-7/#5-mine-blocks-instantly-at-interval-or-on-demand" rel="noopener ugc nofollow" target="_blank">建立块挖掘规则(即时、按需、间隔)</a></li><li id="c9b4" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://trufflesuite.com/blog/introducing-ganache-7/#7-impersonate-any-account" rel="noopener ugc nofollow" target="_blank">冒充任何真实账户，无需其私钥</a></li><li id="0967" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">使用以太坊JSON-RPC支持进行函数调用</li></ul><p id="bef9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，许多使用这个工具的人可能不知道，从v7.0.0.0开始，Ganache也可以在您的浏览器中运行。在浏览器中运行允许您将本地区块链的输出设置为变量，然后您可以使用这些变量来测试您的前端代码。这个可视化的过程有助于你理解你的用户将如何与你的项目交互，也使你能够完全离线测试你的dApp(当使用一个本地实例时)。</p><p id="8b3f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过首先在浏览器中运行Ganache并微调dApp的反应方式，一旦一切正常，您就可以轻松地将提供者切换到您的节点服务API。此外，自从Ganache的最新更新(撰写本文时的版本为7.3.2)以来，您现在可以在浏览器中运行Ganache时<a class="ae lr" href="https://trufflesuite.com/blog/three-new-ganache-features-to-improve-your-developer-experience/#zero-config-mainnet-forking-now-available-in-the-browser" rel="noopener ugc nofollow" target="_blank">分叉以太坊mainnet。这允许你通过你的前端代码与真实的账户和合同进行交互。</a></p><h1 id="d8c7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">该项目</h1><p id="fa34" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">本节将使用Truffle及其VS代码扩展创建一个基本的智能契约。然后，我们将首先通过命令行将我们的契约部署到Ganache。之后，我们将创建一个简单的前端，在浏览器中使用Ganache，并与我们部署的契约进行交互。</p><h2 id="6be9" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">要求</h2><p id="34ff" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">对于本项目，我们将使用以下内容:</p><ul class=""><li id="9519" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><a class="ae lr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> NodeJS / NPM </a></li><li id="4851" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://trufflesuite.com/docs/truffle/getting-started/installation/" rel="noopener ugc nofollow" target="_blank">松露</a>松露&amp;松露<a class="ae lr" href="https://github.com/trufflesuite/ganache#readme" rel="noopener ugc nofollow" target="_blank">松露</a></li><li id="6fef" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://code.visualstudio.com/Download" rel="noopener ugc nofollow" target="_blank">VS代码编辑器</a></li><li id="2547" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://marketplace.visualstudio.com/items?itemName=trufflesuite-csi.truffle-vscode" rel="noopener ugc nofollow" target="_blank">用于VS代码扩展的块菌</a></li></ul><h2 id="5371" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤1 —安装</h2><p id="42ac" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">首先，我们可以在我们的终端中运行命令<code class="fe np nq nr ns b">node --version</code>来确保NodeJS和NPM已经<a class="ae lr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">正确地安装在我们的机器上</a>。</p><p id="3a2a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将通过运行以下命令来安装Truffle和Ganache:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="26c1" class="nd lt iq ns b gy nx ny l nz oa">npm install -g truffle ganache</span></pre><p id="4132" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">分别用<code class="fe np nq nr ns b">truffle --version</code>和<code class="fe np nq nr ns b">ganache --version</code>检查Truffle和Ganache的版本号会告诉我们这两个工具是否安装成功。</p><p id="431b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一步是<a class="ae lr" href="https://code.visualstudio.com/Download" rel="noopener ugc nofollow" target="_blank">安装VS代码</a>，然后导航到编辑器中的Extensions选项卡并搜索Truffle for VS代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/1b1195e71740bb87c50e99c678b61ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/0*WcI1CoN0f21xYz-q.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/5a48ee74f6aa7dd74defb8df2374d030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SicQI9A_v4TKYTsi.png"/></div></div></figure><p id="27d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们已经准备好开始这个项目的工作，所有的东西都已经安装好了。</p><h2 id="4f8d" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤2 —设置项目</h2><p id="2f8d" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">使用Truffle for VS代码扩展，我们可以通过VS代码命令面板轻松创建一个新的Truffle项目。在编辑器中按下<code class="fe np nq nr ns b">ctrl + shift + P</code>打开命令面板，键入<code class="fe np nq nr ns b">truffle</code>查看我们可以使用的命令列表。选择Truffle: New Solidity Project，然后创建一个基本项目，在所需的文件夹中创建一个新项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/24df2044cf21988421e163242e7315f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*nA6HclFwOpgZxhvs.png"/></div></div></figure><p id="4bd2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将创建一个初始化的项目，它具有简单的文件夹结构和示例代码，如果我们愿意，可以使用这些代码。</p><p id="a539" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的智能合约代码中使用<code class="fe np nq nr ns b">console.log</code>的能力是Ganache 最近提供的另一个新特性<a class="ae lr" href="https://trufflesuite.com/blog/three-new-ganache-features-to-improve-your-developer-experience/#ability-to-use-consolelog-from-solidity" rel="noopener ugc nofollow" target="_blank">。在我们为项目创建智能契约之前，让我们通过安装所需的包来设置它。导航到终端中的项目文件夹，然后键入以下命令:</a></p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="8d8e" class="nd lt iq ns b gy nx ny l nz oa">npm install @ganache/console.log</span></pre><h2 id="149d" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤3 —撰写智能合同</h2><p id="4d14" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们项目的智能合同将是一个基本的，我们可以捐赠一些ETH，并要求看到平衡。</p><p id="0b39" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe np nq nr ns b">contracts</code>文件夹中，创建一个新文件，并将其命名为SimpleContract.sol。接下来，使用以下智能合同代码填充该文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="5d44" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的智能合约中的代码相对简单。当我们部署智能契约时，它在控制台中显示一条消息，提供捐赠ETH和查询余额的功能，并在调用函数时在控制台中打印消息。</p><h2 id="42f5" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤4 —部署到Ganache</h2><p id="b2ce" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在安装了Truffle for VS代码扩展之后，我们可以通过右键单击智能契约文件并选择Deploy Contracts来轻松地进行部署。然而，如果我们想看到我们的控制台消息，我们将不得不使用我们自己的终端，而不是内置在VS代码中的终端。这在将来可能会改变，但是我们必须创建一个简单的迁移脚本来执行部署。</p><p id="7e5b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe np nq nr ns b">migrations</code>文件夹中，创建一个名为<code class="fe np nq nr ns b">1_SimpleContract.js</code>的新脚本，并输入以下代码:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="3180" class="nd lt iq ns b gy nx ny l nz oa">const SimpleContract = artifacts.require("SimpleContract");</span><span id="a85a" class="nd lt iq ns b gy og ny l nz oa">module.exports = function (deployer) {<br/>  deployer.deploy(SimpleContract);<br/>};</span></pre><p id="3317" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，打开一个新的终端窗口并启动Ganache:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="cb48" class="nd lt iq ns b gy nx ny l nz oa">ganache</span></pre><p id="f3c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当控制台消息出现时，我们将在这个终端窗口中看到它们。我们现在打开了两个终端窗口:一个运行Ganache，另一个在Truffle项目的文件夹中打开。</p><p id="a83a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在Truffle项目所在位置打开的终端窗口中，键入以下命令来启动部署:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="3eed" class="nd lt iq ns b gy nx ny l nz oa">truffle migrate --network development</span></pre><p id="15f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果部署成功，我们可以在终端中看到我们的控制台消息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0622d06fb4ccf216d3afd25dce68fe13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*-pvE_BDEYcptPK5i.png"/></div></figure><p id="53b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">太好了！我们的合同在本地Ganache实例上生效！我们暂时让Ganache运行，这样我们就可以使用浏览器与我们的合同进行交互。在我们开始之前，从我们输入<code class="fe np nq nr ns b">migrate</code>命令的终端的输出中复制<code class="fe np nq nr ns b">contract address</code>。我们将使用这个地址将我们的前端指向我们的智能合约。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/09c75a54545bf518cabb84306705983d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*fgPBI7jc4p0-Qzjd.png"/></div></figure><h2 id="af03" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤5 —构建前端</h2><p id="bb28" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated"><strong class="kx ir"> 5a。—设置</strong></p><p id="14f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于这个项目的前端，我们将使用React。导航到一个新的空文件夹，然后键入:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="d029" class="nd lt iq ns b gy nx ny l nz oa">npx create-react-app ganache-browser-test</span></pre><p id="8eaa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将安装Web3。JS来轻松地与我们的智能合同进行交互。导航到我们的新项目文件夹并安装Web3。JS用这个命令:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="c77f" class="nd lt iq ns b gy nx ny l nz oa">cd ganache-browser-test<br/>npm install web3</span></pre><p id="0a14" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">新版的create-react-app与Web3不兼容。JS，所以我们需要安装特定版本的React脚本。我们可以用这个命令来实现:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="ee3e" class="nd lt iq ns b gy nx ny l nz oa">npm install --save-exact react-scripts@4.0.3</span></pre><p id="6f99" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，为了在我们的浏览器中使用Ganache，我们将把它作为一个依赖项直接安装:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="738d" class="nd lt iq ns b gy nx ny l nz oa">npm install ganache</span></pre><p id="7514" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者，您可以在HTML中添加CDN链接，以便从浏览器访问Ganache:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="8e79" class="nd lt iq ns b gy nx ny l nz oa">&lt;script src="https://cdn.jsdelivr.net/npm/ganache@7.3.2/dist/web/ganache.min.js"&gt;&lt;/script&gt;</span></pre><p id="8c73" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在处理前端代码之前，我们需要创建一个包含合同ABI的文件，以便与智能合同进行交互。我们可以直接从我们的松露项目中复制文件。导航到我们松露项目的<code class="fe np nq nr ns b">build/contracts</code>文件夹，复制<code class="fe np nq nr ns b">SimpleContract.json</code>文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/b4b5f5b7d9627dbfcf730d6d7da41912.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/0*wmk3Yea0IxNgtJUW.png"/></div></figure><p id="2506" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，在编辑器中打开我们的前端项目，创建一个名为<code class="fe np nq nr ns b">abi</code>的新文件夹。在该文件夹中，粘贴<code class="fe np nq nr ns b">SimpleContract.json</code>文件。我们前端的文件结构现在看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/cfc44c3cc8b91fbc3712c5611af4d8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/0*yEQCMbenNnyDexgD.png"/></div></figure><p id="8fc2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 5b。—前端代码</strong></p><p id="8667" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以开始在我们的前端工作，所有的设置都不碍事。首先，打开<code class="fe np nq nr ns b">src</code>文件夹中的<code class="fe np nq nr ns b">App.js</code>文件，用以下代码替换样板代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="662f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">确保将<code class="fe np nq nr ns b">CONTRACT_ADDRESS</code>更改为我们在第4步部署智能合同时收到的地址。同样，<code class="fe np nq nr ns b">USER_ADDRESS</code>是将调用这些函数的帐户。我们可以从我们第一次在终端中启动Ganache实例时显示的帐户列表中得到这个信息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/ab8cc15e57d9f3e93abd91b7ce302116.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/0*vdoYV_kFRtoCUVMv.png"/></div></figure><p id="76ad" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些账户地址都可以。</p><p id="bea1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们继续之前，让我们花点时间浏览一下我们编写的代码:</p><ul class=""><li id="640c" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">我们导入我们的依赖项和<code class="fe np nq nr ns b">SimpleContract</code> JSON文件。</li><li id="3754" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">设置<code class="fe np nq nr ns b">ganache</code>和<code class="fe np nq nr ns b">Web3</code>变量。</li><li id="56e0" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">创建一个空的<code class="fe np nq nr ns b">options</code>变量，我们用它初始化我们的<code class="fe np nq nr ns b">provider</code>实例。</li><li id="383c" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">注意</strong>:这个<code class="fe np nq nr ns b">options</code>变量是我们设置<a class="ae lr" href="https://github.com/trufflesuite/ganache#documentation" rel="noopener ugc nofollow" target="_blank">我们希望本地区块链实例包含的任何选项</a>的地方，比如在浏览器中严格运行Ganache(不在我们的另一个终端窗口中运行)时分叉Mainnet或Goerli。</li><li id="58f8" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">使用我们的<code class="fe np nq nr ns b">localhost URL</code>和端口<code class="fe np nq nr ns b">8545</code>初始化我们的<code class="fe np nq nr ns b">web3</code>对象，其中我们的Ganache实例已经在运行。</li><li id="36e7" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">注意</strong>:此时可以通过使用<code class="fe np nq nr ns b">provider</code>变量代替localhost在浏览器中严格运行Ganache。在这种情况下，我们使用<code class="fe np nq nr ns b">localhost</code>,因为我们希望与已经部署的智能契约进行交互，并在终端输出中看到我们的<code class="fe np nq nr ns b">console.log</code>消息。</li><li id="0b8f" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">设置我们的<code class="fe np nq nr ns b">CONTRACT_ADDRESS</code>和<code class="fe np nq nr ns b">USER_ADDRESS</code>变量。</li><li id="873e" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">创建一个契约实例，我们可以用它来调用<code class="fe np nq nr ns b">App</code>代码中的函数。</li><li id="27e6" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">创建<code class="fe np nq nr ns b">contractBalance</code> React状态变量及其<code class="fe np nq nr ns b">set</code>方法。</li><li id="9ebe" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">定义我们的<code class="fe np nq nr ns b">donate</code>和<code class="fe np nq nr ns b">getBalance</code>功能。</li><li id="ccdb" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">最后，我们为我们的前端返回<code class="fe np nq nr ns b">html</code>。</li></ul><p id="e05e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 5c。—运行项目</strong></p><p id="7050" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们可以用<code class="fe np nq nr ns b">npm start</code>运行我们的应用程序来显示我们的前端，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/6146dfac9bf5a50280b77d97747bb1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NKqvSP0ug0R42ROt.png"/></div></div></figure><p id="9cb2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们测试我们的项目时，我们可以在运行Ganache的终端窗口上看到结果和我们的<code class="fe np nq nr ns b">console.log</code>消息，并且我们前端的ETH天平成功地用新的天平进行了更新。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/23a8017087dfea32318cfe82f999aef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/0*nYo0t-Q-28MxHo82.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/91ed4d5e5ccee9e047f7dc54bab60a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/0*BHqsqIRpDlCy14DK.png"/></div></figure><h2 id="7676" class="nd lt iq bd lu ne nf dn ly ng nh dp mc le ni nj me li nk nl mg lm nm nn mi no bi translated">步骤6 —在浏览器中用Ganache派生Goerli或Mainnet</h2><p id="6e8c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">既然我们知道我们的项目在本地运行的Ganache实例上正常运行，下一步就是在testnet和mainnet的分叉版本上运行它。在本文中，我们不会介绍这样做的实际过程，但是设置这样做很简单。我们需要做的只是修改几行前端代码。</p><p id="e378" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，options变量需要指定我们希望分叉哪个网络:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="9208" class="nd lt iq ns b gy nx ny l nz oa">const options = { fork: { network: 'goerli' } };</span></pre><p id="72e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">或者:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="d335" class="nd lt iq ns b gy nx ny l nz oa">const options = { fork: { network: 'mainnet' } };</span></pre><p id="9a38" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后我们需要更新我们的<code class="fe np nq nr ns b">web3</code>变量声明:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="b092" class="nd lt iq ns b gy nx ny l nz oa">const web3 = new Web3(options);</span></pre><p id="1702" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们需要确保在我们分叉的网络上用我们的地址更新<code class="fe np nq nr ns b">CONTRACT_ADDRESS</code>。我们还需要将<code class="fe np nq nr ns b">USER_ADDRESS</code>更新到同一个网络上的一个帐户地址，该地址有足够的资金捐赠给我们的合同。</p><p id="ea49" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当分叉mainnet时，这部分代码可能看起来像这样:</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="6ac5" class="nd lt iq ns b gy nx ny l nz oa">const options = { fork: { network: 'mainnet' } };<br/>const provider = ganache.provider(options);</span><span id="689d" class="nd lt iq ns b gy og ny l nz oa">const web3 = new Web3(provider);</span><span id="8894" class="nd lt iq ns b gy og ny l nz oa">const CONTRACT_ADDRESS = '0x692586eaC70114C8F4714D89E7f72FAAbaeE0Cd7'  <br/>const USER_ADDRESS = web3.utils.toChecksumAddress('0xCe7A99Bba7018fa455E6eD5CF88a7F26010F1E8F');</span></pre><p id="2714" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这样，我们就可以在浏览器中使用Ganache，用mainnet的分叉版本来测试我们的项目。</p><h1 id="74dc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="3c13" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">通过创建一个接口来测试项目有助于可视化您的dApp是如何运行的，并让您更好地了解它一旦在mainnet上为用户执行将会如何。在测试前端代码的同时在浏览器中运行是Ganache成为开发工具包中如此强大的工具的一个特性。要了解更多关于与Ganache合作或为项目做贡献的信息，<a class="ae lr" href="https://github.com/trufflesuite/ganache#documentation" rel="noopener ugc nofollow" target="_blank">查看他们的GitHub </a>或<a class="ae lr" href="https://trufflesuite.com/docs/ganache/quickstart/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div></div>    
</body>
</html>