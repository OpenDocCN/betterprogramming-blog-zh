<html>
<head>
<title>Stop Mixing Constants With the Type String in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止在Golang中将常量与类型字符串混合</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/stop-mixing-constants-with-the-type-string-in-golang-d3589d8ae84d?source=collection_archive---------5-----------------------#2021-05-13">https://betterprogramming.pub/stop-mixing-constants-with-the-type-string-in-golang-d3589d8ae84d?source=collection_archive---------5-----------------------#2021-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="560f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Golang的无类型常量可能会使您的工作更容易。但是有一个条件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a260800d310fa2547a0018fadf84aad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xwfO4pZA5hym4asU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比尔·牛津在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8e8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果在我使用一个库的时候有一件事让我恼火，不管是什么编程语言，那就是当作者让我不知道应该给函数提供什么参数的时候。当函数期望我提供一个特定的常量时，情况会变得更糟。</p><p id="a5a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Go 是一种强静态类型语言，因此我希望看到一些线索，告诉我哪些常量适合哪个函数，而不必对库进行逆向工程。我的IDE应该告诉我应该用什么选项来给函数输入。</p><p id="21d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个问题的核心来自这样的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="4604" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lx">去游乐场试试:</em><a class="ae ky" href="https://play.golang.org/p/EMEvOL-zSVA" rel="noopener ugc nofollow" target="_blank"><em class="lx">https://play.golang.org/p/EMEvOL-zSVA</em></a></p><p id="0241" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两个非类型化的字符串常量<em class="lx"> ( </em> <code class="fe ly lz ma mb b">FormalGreeting</code>和<code class="fe ly lz ma mb b">CasualGreeting</code>)不提供任何关于在哪里使用它们的信息。相反，谁会在不看源代码的情况下猜测常量是作为<code class="fe ly lz ma mb b">sayHello</code>函数的输入而存在的呢？这个例子可能过于简单了，但是对于许多使用库的开发人员来说，这种常量确实是浪费时间。</p><p id="741a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您考虑这个问题并且来自不同的编程语言时，您可能会立即想到枚举作为一种解决方案。Golang不实现枚举，但提供了更好地管理常数的惯用方法。</p><p id="4d7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以非类型化的字符串常量是不好的，因为它们会误导人。</p><pre class="kj kk kl km gt mc mb md me aw mf bi"><span id="75f1" class="mg mh it mb b gy mi mj l mk ml">const FormalGreeting = "Hello, "</span></pre><p id="233a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要明确的是，这不是一个好的解决方案，因为您无法解决前面提到的任何问题:</p><pre class="kj kk kl km gt mc mb md me aw mf bi"><span id="7f08" class="mg mh it mb b gy mi mj l mk ml">const FormalGreeting string = "Hello, "</span></pre><p id="ac3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Go中，要创建类型化枚举，只需创建一个自定义类型并定义该类型的常量。</p><pre class="kj kk kl km gt mc mb md me aw mf bi"><span id="43fe" class="mg mh it mb b gy mi mj l mk ml">type GreetingType string<br/>const FormalGreeting <!-- -->GreetingType <!-- -->= "Hello, "</span></pre><p id="f66e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我的主张的来源。您总是可以为您的字符串常量创建一个自定义类型，从而提高可用性和可维护性。因此，在Golang中，任何常量都不应该是string类型，也不应该是非类型化的。</p><p id="6aec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lx">操场试玩改版:</em>【https://play.golang.org/p/dauiqCxbAE5】<em class="lx"/></p><h1 id="3a8d" class="mm mh it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">如果我遵循这个建议，我应该期待什么变化？</h1><p id="4b79" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">坏消息是类型<code class="fe ly lz ma mb b">GreetingType</code>的常量不能赋给字符串变量。在极少数情况下，您可能需要将自定义类型转换回字符串。</p><pre class="kj kk kl km gt mc mb md me aw mf bi"><span id="cfee" class="mg mh it mb b gy mi mj l mk ml">var s string<br/>s = string(<!-- -->FormalGreeting)</span></pre><p id="d1fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，您可能需要将一个字符串转换成您的自定义类型(例如在一些测试案例中)。</p><pre class="kj kk kl km gt mc mb md me aw mf bi"><span id="eaa1" class="mg mh it mb b gy mi mj l mk ml">var g GreetingType<br/>g = GreetingType("What's up"<!-- -->)</span></pre><h1 id="61c0" class="mm mh it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">如果非类型化常量如此有害，那么它们有什么用？</h1><p id="e238" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我不停地说你不应该使用无类型的常量。我不得不深入挖掘，理解它们为什么存在。以下是我的发现:</p><ul class=""><li id="75bd" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated">对数值类型非常严格，非类型常量在数值运算时会有所帮助。因此，您可以一劳永逸地定义PI值，然后乘以该常数，而不管要乘以的变量是什么类型。</li><li id="389c" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">一般来说，无类型常数是为了更容易处理混合数据类型和表达式。</li></ul><h1 id="89e3" class="mm mh it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">从那时起，下一个学习目标是什么？</h1><p id="c13c" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我认为这篇文章是介绍在Go中编写枚举的惯用方法的好机会。但是，在写的时候，发现了一篇不到一个月前写的文章。</p><div class="nw nx gp gr ny nz"><a href="https://levelup.gitconnected.com/implementing-enums-in-golang-9537c433d6e2" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">在Golang中实现枚举</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">枚举将相关的常数组合在一个类型中。枚举是一个具有广泛用途的强大功能。然而…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><h1 id="c6fb" class="mm mh it bd mn mo ov mq mr ms ow mu mv jz ox ka mx kc oy kd mz kf oz kg nb nc bi translated">参考</h1><ul class=""><li id="338a" class="ni nj it lb b lc nd lf ne li pa lm pb lq pc lu nn no np nq bi translated">官方文件:<a class="ae ky" href="https://blog.golang.org/constants" rel="noopener ugc nofollow" target="_blank">https://blog.golang.org/constants</a></li><li id="7d43" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">关于类型化和非类型化变量的解释:<a class="ae ky" href="https://www.callicoder.com/golang-typed-untyped-constants/" rel="noopener ugc nofollow" target="_blank">https://www.callicoder.com/golang-typed-untyped-constants/</a></li><li id="9a4d" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">类型化与非类型化的比较<a class="ae ky" href="https://medium.com/golangspec/untyped-constants-in-go-2c69eb519b5b" rel="noopener">https://medium . com/golangspec/untyped-constants-in-go-2c 69 EB 519 b 5b</a></li><li id="ec3c" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated">Go 2.0可能有enum支持:<a class="ae ky" href="https://github.com/golang/go/issues/19814" rel="noopener ugc nofollow" target="_blank">https://github.com/golang/go/issues/19814</a></li></ul></div></div>    
</body>
</html>