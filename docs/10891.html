<html>
<head>
<title>How to Write Proper Docstrings for a Python Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Python函数编写正确的文档字符串</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-write-proper-docstrings-for-a-python-function-7c40b8d2e153?source=collection_archive---------2-----------------------#2022-02-02">https://betterprogramming.pub/how-to-write-proper-docstrings-for-a-python-function-7c40b8d2e153?source=collection_archive---------2-----------------------#2022-02-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0e50" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解定义函数的文档字符串的最佳实践</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/734bf2cfa5ba07eaad38cc3a48fb2450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pYZoZKf4xXyeCi9l"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯利·西克玛</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="110f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们遇到一个新的函数时，我们经常需要查阅它的文档来弄清楚如何使用它。例如，我们遇到了内置的<code class="fe lv lw lx ly b">id</code>函数，我们知道我们可以检查一个对象的内存地址。然而，很可能我们不知道如何调用这个函数。除了在网上查资料，还有什么方法可以获取相关信息？</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="8db0" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; help(id)<br/>Help on built-in function id in module builtins:</span><span id="e1f5" class="md me it ly b gy mj mg l mh mi">id(obj, /)<br/>    Return the identity of an object.<br/>    <br/>    This is guaranteed to be unique among simultaneously existing objects.<br/>    (CPython uses the object's memory address.)</span></pre><p id="2bf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中，我们可以使用<code class="fe lv lw lx ly b">help</code>函数来检索<code class="fe lv lw lx ly b">id</code>函数的文档字符串。从一般的角度来看，我们使用文档字符串来引用函数、类或模块的文档。在我们的例子中，我们正在查看函数的文档字符串，它提供了关于如何使用<code class="fe lv lw lx ly b">id</code>的具体说明。重要的是，可以在Python控制台中通过简单的帮助调用来访问文档字符串，而不需要依赖任何外部资源。因此，文档字符串不仅可以提供关于函数用法的信息，而且可以方便地访问。在本文中，我们将学习如何为Python中的函数编写合适的文档字符串。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="8071" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">基本结构</h1><p id="691f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">函数的docstring是位于函数头部下方的多行字符串。按照惯例，我们使用三重引号将字符串括起来。只要匹配，您可以使用双引号或单引号来构成三重引号。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3abd" class="md me it ly b gy mf mg l mh mi">def the_function():<br/>    """the docstring<br/>    goes here, as a multi-line string<br/>    below the head<br/>    """</span></pre><p id="2c71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个多行字符串，需要三个关键元素和第四个可选元素。</p><ul class=""><li id="78ba" class="nn no it lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated"><strong class="lb iu">功能总结。</strong>功能是做什么的？它应该提供该函数执行的操作的高级摘要。</li><li id="6c9b" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu">参数。</strong>函数中使用了哪些参数？</li><li id="62af" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu">返回值。</strong>函数返回哪种数据？</li><li id="1c91" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu">异常(可选)。</strong>该函数会引发哪些可能的异常？</li></ul></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="d2c1" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">文档字符串的样式</h1><p id="6992" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">关于Python中docstring的样式还没有达成共识。例如，如下图所示，最流行的Python IDEs之一提供了5种不同的格式:Plain、Epytext、reStructuredText(也称为reST)、NumPy和Google。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/ecb65f81714ea293ccaa9a8fd8d657fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N5Gd2zdFNXnsMIjpxI3BpQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PyCharm支持不同的文档字符串格式</p></figure><p id="29b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这些格式中，默认格式是reST。下面的代码片段向您展示了使用reST的函数的docstring。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">reST格式的Docstring</p></figure><p id="005d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种常见的风格是谷歌one，因为它得到了谷歌的认可。下面是一个例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Google格式的文档字符串</p></figure><p id="f612" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管不同的格式使文档字符串看起来不同，但基本元素是相同的。在实践中，选择偏好的风格或遵循公司的惯例是程序员个人的事。对于本文，我将坚持reST风格来展示相关的例子。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="c90b" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">文档参数和返回值</h1><p id="97c8" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">一个函数的概要应该是简单明了的。本质上，你应该简洁地告诉用户这个功能是做什么的。之后，下一步是记录函数使用的每个参数。使用reST风格，每个参数都以<code class="fe lv lw lx ly b">:param</code>开始，不同的参数应该作为单独的行列出。对于每个参数，我们需要提供以下信息:</p><ul class=""><li id="c0cb" class="nn no it lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated"><strong class="lb iu"> Name </strong>:应该和函数头中使用的完全匹配。</li><li id="ad0c" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu"> Type </strong>:你希望参数是什么类型的数据？指定它。</li><li id="eac1" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu">描述</strong>:根据参数的直观程度，提供有用的描述，帮助用户理解这个参数是什么，或者如果目的不太清楚，为什么需要这个参数。</li><li id="63d3" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><strong class="lb iu">默认值</strong>(可选):如果参数有默认值，请指定。值得注意的是，如果用户不清楚为什么选择一个特定的值作为默认值，我们需要提供一个简短的理由。</li></ul><p id="0620" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">遵循这个原则，让我们看一个带有简单示例的docstring。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文档字符串中的参数和返回值</p></figure><p id="6c72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的例子提供了三个参数所需的docstring，包括它们各自的名称、类型和解释。另外，因为<code class="fe lv lw lx ly b">taking_int</code>有默认值，所以在docstring中也提到了。当一个参数的docstring扩展到多行时，记得在第二行插入一些缩进，这样不同参数之间的界限就很清楚了。</p><p id="2660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于函数的返回值，docstring使用<code class="fe lv lw lx ly b">:return</code>来表示返回值的类型和解释。解释应该简明易懂。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="e09d" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">指定任何可能的例外</h1><p id="c3f9" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">当您的函数引发任何异常时，您应该在docstring中指定它们，以便当用户读取docstring时，他们知道可能会遇到的异常，从而可以避免或处理它们。</p><p id="a280" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们仍然考虑<code class="fe lv lw lx ly b">quotient</code>函数，它包括除法运算:<code class="fe lv lw lx ly b">dividend / divisor</code>。我们知道，如果除数为0，则除法是未定义的，并且我们可以看到，如果我们试图将一个数除以0，会发生什么:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="ec51" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; 1 / 0<br/>Traceback (most recent call last):<br/>  File “&lt;stdin&gt;”, line 1, in &lt;module&gt;<br/>ZeroDivisionError: division by zero</span></pre><p id="295b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们应该在docstring中指定这样一个异常，如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">指定异常</p></figure><p id="4675" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，我们显式地检查divisor是否为0，并在它为0时提高<code class="fe lv lw lx ly b">ZeroDivisionError</code>。请注意，即使我们没有显式地引发这个异常，当我们调用类似于<code class="fe lv lw lx ly b">quotient(1, 0)</code>的东西时，这样的异常仍然会被引发，因为Python在任何适用的时候都会引发<code class="fe lv lw lx ly b">ZeroDivisionError</code>。在这里，我明确地提出了这个异常，因为我想向您展示由函数提出的异常应该如何记录在docstring中。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="7622" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="efc8" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在本文中，我们学习了如何为函数提供文档字符串，这将有助于用户更好地理解您的函数。他们可以简单地调用<code class="fe lv lw lx ly b">help(the_function)</code>来检索函数的文档。或者，一个函数有一个名为<code class="fe lv lw lx ly b">__doc__</code>的特殊属性，您可以调用<code class="fe lv lw lx ly b">print(the_function.__doc__)</code>来显示该函数的文档字符串。</p><p id="b756" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于一个函数，它的文档字符串应该由三个基本部分组成:一句话的摘要、参数(名称、类型、解释和默认值，如果设置的话)和返回值(类型和解释)。如果函数可以引发异常，也应该指定它。</p><p id="b772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建函数的文档字符串有不同的方式。关键是始终坚持一种特定的风格。例如，如果你在一个团队中工作，使用你的团队已经同意的风格。如果你只是为自己编写函数/模块，采用你最习惯的风格。</p></div></div>    
</body>
</html>