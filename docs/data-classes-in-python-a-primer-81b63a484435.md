# Python 中的数据类:入门

> 原文：<https://betterprogramming.pub/data-classes-in-python-a-primer-81b63a484435>

## 它和普通的 Python 类有什么不同？

![](img/824790ed8432960934e432bb518d3743.png)

照片由[费利佩·斯基亚罗利](https://unsplash.com/@flpschi?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

数据类基本上是一个普通的 Python 类，带有一个`@dataclass`装饰器。顾名思义，*数据*类通常是为主要包含*数据*和存储状态的类创建的。该特性是在 [Python3.7](https://www.python.org/dev/peps/pep-0557/) 中引入的，但在 Python3.6 中也被向后移植了。

因为数据类实际上是类，所以您可以自由地使用继承、用户定义的方法和其他 Python 类特性。

# Python 类概述

在进入数据类之前，让我们快速回顾一下常规的 Python 类。

Python 类概述:属性和方法

一个类就像一个对象构造器，你可以把它看作一个用户定义的创建对象的蓝图。对象是一个类的实例，它有属性和方法，作为一种将数据和功能捆绑在一起的方式。

## 属性

可以被认为是类对象中的变量(属性)。参照上面的例子，一旦`bread`对象被实例化，其属性如`name`、`units`、`price`可以通过`bread.name`、`bread.price`等访问。

## 方法

可以看作是生活在一个类中的函数。在上面的例子中，`calc_stock_value()`是`Inventory`类中的一个方法，可以被实例`bread`调用。

# Python 数据类

数据类与常规类的区别在于，数据类装饰器`@dataclass`有助于自动生成和维护一组针对类的特殊方法，从而减少样板代码。这些方法可以大致分为:

1.  初始化方法— `.__init__()`
2.  表示方法— `.__repr__()`
3.  比较法— `.__eq__()`、`.__le__()`、`.__ge__()`等。

演示如何定义数据类和内置方法

注意，虽然上面的代码块中没有这些方法，但是初始化、表示和比较部分仍然有效，因为装饰器在后台处理它们。

## **初始化方法**

`__init__`方法类似于`C++`和 Java 中的构造函数。它用于初始化对象的状态，并在对象创建时执行。

让我们考虑下面一个常规 Python 类中的`__init__`片段:

```
# __init__ in regular class
def __init__(self, name):
    self.name = name
```

注意到单词`name`重复了 3 次，只是为了简单地初始化一个对象。最重要的是，多个`self`的存在可能会让不熟悉面向对象编程(OOP)概念的初学者感到困惑。

相反，在数据类中，不需要`__init__`方法。借助于[变量注释](https://www.python.org/dev/peps/pep-0526/)，您只需要在类定义下面列出您的数据类所需的字段。

## **表示方法**

当在没有显式定义`__repr__`的情况下打印常规 Python 类中的对象时，结果不会给出关于实例的任何有用信息。

```
bread = Inventory('bread', 10, 2.5)
print(bread)
# returns <__main__.Inventory object at 0x7f9fca781700>
```

`__repr__`方法在调试时特别有用，因为它提供了一个更具代表性的对象视图。常规类中需要一个自定义的`__repr__`方法，如下所示。

在常规 Python 类中定义 __repr__。

相反，默认情况下，这个方法由数据类装饰器负责。

## **比较方法**

为了执行基本的对象比较，需要在常规 Python 类中定义类似`__eq__`的比较方法，如下所示:

在常规类中定义 __eq__ 并比较类实例

同样，数据类装饰器自动管理这一点，不需要方法的显式定义。

# Python 数据类的两个重要特性

以下概念不是数据类独有的。：

1.  默认值分配
2.  类型提示

然而，数据类提供了一种实现它们的简洁方法，并提高了可读性，如下面的代码所示:

在数据类中定义默认值和类型提示。

## 缺省值

在 Python 中定义常规类时，默认值赋值和类型提示是在`__init__`方法中完成的。我希望你会同意上面的数据类定义比下面的代码块简洁得多。

在常规 Python 类中定义默认值和类型提示

## 类型提示

在数据类中定义属性(字段)时，类型提示是必需的。如果在字段中不存在，该属性将被忽略，并且不会成为数据类的一部分。

如果不想为数据类的字段指定确切的类型，建议使用`Any`类型(参见上面数据类示例中的`discount`字段)。

请注意，这些数据类型在运行时不是强制的。为了捕捉类型错误，鼓励使用像`[mypy](http://mypy-lang.org)`这样的包。

# **总结**

数据类是 Python 3.7 中引入的新特性。如果您计划创建一个主要由属性组成的类，这很方便，因为它有助于:

*   自动生成样板代码以获得对象的正确初始化、表示和比较
*   提高可读性，特别是分配默认值和类型提示

感谢您花时间阅读我的文章。如果你喜欢你所读到的，看看下面这个故事:

[](/the-walrus-operator-in-python-3-8-a-primer-f0156ad80948) [## Python 3.8 中的 Walrus 算子:初级读本

### 知道如何使用它

better 编程. pub](/the-walrus-operator-in-python-3-8-a-primer-f0156ad80948)