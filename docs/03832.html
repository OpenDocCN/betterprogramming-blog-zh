<html>
<head>
<title>How to Comment a DeployGate Link for Each Build Version on GitHub Pull Requests With Bitrise</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Bitrise注释GitHub Pull请求上每个构建版本的DeployGate链接</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-comment-a-deploygate-link-for-each-build-version-on-github-pull-requests-with-bitrise-6a0943bc56ca?source=collection_archive---------21-----------------------#2020-03-06">https://betterprogramming.pub/how-to-comment-a-deploygate-link-for-each-build-version-on-github-pull-requests-with-bitrise-6a0943bc56ca?source=collection_archive---------21-----------------------#2020-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8e97" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个简单的提示，让你的同事在他们的拉动式请求审查期间更快地审查你的应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/38233fc032cd1523250cb4f95941efb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1wGpl3ZUIh7wj1YHFDxCA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@divinetechygirl?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">克里斯蒂娜·莫里路</a>从<a class="ae kv" href="https://www.pexels.com/photo/eyeglasses-in-front-of-laptop-computer-1181253/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><h1 id="20e1" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">背景</h1><p id="1bce" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">作为一名开发人员，当你在GitHub上创建一个pull请求时，你不仅需要让你的同事检查你的代码，有时你还需要让他们在你添加了新功能、修复了错误等之后确认应用的行为。</p><p id="3f16" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在我的项目中，当我创建一个新的pull请求时，一个<a class="ae kv" href="https://www.bitrise.io/" rel="noopener ugc nofollow" target="_blank"> Bitrise </a>工作流会自动构建一个应用程序并上传到<a class="ae kv" href="https://deploygate.com/" rel="noopener ugc nofollow" target="_blank"> DeployGate </a>。当构建完成时，控制台上配置的DeployGate 的通知<a class="ae kv" href="https://docs.deploygate.com/docs/chat-integration" rel="noopener ugc nofollow" target="_blank">提到了Slack通道，评审人员可以通过单击通道中的下载链接来访问应用程序。</a></p><p id="9dd4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然而，由于DeployGate通知总是提供与最新构建版本相同的链接，并且不能将其作为GitHub pull请求上的评论发布，因此评审人员几乎从未捕捉到应用程序的正确构建版本进行评审，他们必须进入控制台并无论如何都要查找应用程序(或者放弃，只查看代码)。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="a131" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">解决办法</h1><p id="9e21" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">作为上述一些问题的解决方案，我在现有的Bitrise工作流中添加了以下步骤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/a59ef463b4a2027c10d54a88320f663d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0q-Bi41J5k82vdrfimSxQ.png"/></div></div></figure><h2 id="f0d2" class="nc kx iq bd ky nd ne dn lc nf ng dp lg lx nh ni li mb nj nk lk mf nl nm lm nn bi translated"><a class="ae kv" href="https://www.bitrise.io/integrations/steps/script" rel="noopener ugc nofollow" target="_blank">脚本</a></h2><p id="9364" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://www.bitrise.io/integrations/steps/deploygate--upload-app-bitrise-step" rel="noopener ugc nofollow" target="_blank">将应用上传到控制台的工作流步骤之一</a>deploy gate Upload返回<code class="fe no np nq nr b">$DEPLOYGATE_UPLOAD_APP_STEP_RESULT_JSON</code>。通过使用里面的值，您可以创建到适当应用程序的直接链接。我使用<a class="ae kv" href="https://stedolan.github.io/jq/" rel="noopener ugc nofollow" target="_blank"> jq </a>通过引用<a class="ae kv" href="https://gist.github.com/fromkk/6987bbdebf1bd6b56fa3811d51bdbe88" rel="noopener ugc nofollow" target="_blank"> fromkk的要点</a>来解析JSON数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="821e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe no np nq nr b">$DEPLOYMENT_BASE_URL</code>是预先在该工作流上设置的环境变量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/64cc8f16bd2c020d70390b0ba07bba22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHYrHaTM2WY5AhsRa4BOeA.png"/></div></div></figure><h2 id="3bcc" class="nc kx iq bd ky nd ne dn lc nf ng dp lg lx nh ni li mb nj nk lk mf nl nm lm nn bi translated"><a class="ae kv" href="https://app.bitrise.io/integrations/steps/create-install-page-qr-code" rel="noopener ugc nofollow" target="_blank">创建安装页面二维码</a></h2><p id="5b98" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创建直接链接的二维码甚至更好，因为评论者只需扫描代码就可以轻松获得应用程序。只需在这一步将<code class="fe no np nq nr b">$DEPLOYGATE_DOWNLOAD_URL</code>设置为<code class="fe no np nq nr b">Public Install Page URL</code>就能给你带来你需要的东西。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3ba31b93d489422a26b10d0a3d01d48f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*43wbCM9IDqjOXGWURmJF3Q.png"/></div></figure><h2 id="99a7" class="nc kx iq bd ky nd ne dn lc nf ng dp lg lx nh ni li mb nj nk lk mf nl nm lm nn bi translated"><a class="ae kv" href="https://app.bitrise.io/integrations/steps/comment-on-github-pull-request" rel="noopener ugc nofollow" target="_blank">评论GitHub拉请求</a></h2><p id="503a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">通过使用该步骤，由前述步骤创建的下载链接和QR码图像URL可以被发送到适当的拉取请求。</p><p id="88b4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不要忘记预先生成并设置您的<a class="ae kv" href="https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line" rel="noopener ugc nofollow" target="_blank">个人访问令牌</a>，这是访问存储库所必需的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/a00b9a8c3c3563b6dadf34f0d26e9659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMtGjZcVkQCHKJ-tPrH2Sg.png"/></div></div></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="1113" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">完成的</h1><p id="720c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">完成构建后，您可以在pull请求上看到这样的注释:</p><blockquote class="nx ny nz"><p id="2333" class="lo lp oa lq b lr mk jr lt lu ml ju lw ob mm lz ma oc mn md me od mo mh mi mj ij bi translated">"正在添加:审阅者必须是DeployGate上的团队成员。如果您无法访问该链接，您可以询问管理员。”</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/0e853a3b9415d5ee7c18da2a56e75419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mo8TfJ-F9xq4l3Q6kYFDlA.png"/></div></div></figure><p id="aa50" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">虽然只是一个小小的改变，但是你创建的拉请求越多，就越有意义。</p><p id="cd53" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">享受您的编码和审查！</p></div></div>    
</body>
</html>