<html>
<head>
<title>3 Ways to Rotate Objects in SceneKit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SceneKit中旋转对象的3种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-ways-to-rotate-objects-in-scenekit-86ed8c2f5490?source=collection_archive---------10-----------------------#2022-04-08">https://betterprogramming.pub/3-ways-to-rotate-objects-in-scenekit-86ed8c2f5490?source=collection_archive---------10-----------------------#2022-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a160" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看看在SwiftUI的SceneKit中旋转对象的不同方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a94d0092388f6be2b50e1403c43efc1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4E-kj2CsCYexZeUvvMPuFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文章中的一个棋子<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/start-building-a-3d-chess-game-using-scenekit-and-swiftui-3d072b025db2">构建一个3D象棋游戏</a></p></figure><p id="5545" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与编码中的许多构造一样，通常有不止一种方法来做同样的事情。有时他们之间的差异是显而易见的，一个循环的经典案例。每个循环都可以有repeat/while、do/while或。</p><p id="c3ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，SceneKit中的框架也不例外，至少有三种方法可以旋转想到的对象；这是任何3D框架的核心部分。</p><p id="8265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是与我们的循环示例不同，在循环示例中，差异是显而易见的，理解在SceneKit代码中进行旋转的差异可能是令人困惑的。的确，用不同的方法转向同一个角度，有时会得到不同的结果。请和我一起看看这三种选择，以及它们可能会让你失败/愚弄你的地方。我想看的三个列在这里。</p><ul class=""><li id="ada7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe me mf mg mh b">SCNActions</code></li><li id="b300" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">换位</li><li id="98f1" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">四元数</li></ul><h1 id="ee9b" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">场景</h1><p id="6de3" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我在SceneKit上发表的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/adding-gestures-to-your-swiftui-rubik-cube-app-12ed853ce0aa">前几篇文章</a>中使用了这些。在我看来，这是在代码中制作旋转/变换动画的最简单的方法。</p><p id="7de1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">挑战——使用<code class="fe me mf mg mh b">SCNActions</code>,您可能遇到的第一个问题是精度下降。当你运行一个<code class="fe me mf mg mh b">SCNAction</code>，要求它停留在完成时的位置(这不是默认的)，你很快就会发现旋转90度可以得到89.9998。我不认为这对许多应用程序有什么影响，当然对游戏来说也是如此，但是如果你小心的话，它可能会破坏程序。</p><p id="9fd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是等等——精度并不是唯一的问题，因为<code class="fe me mf mg mh b">SCNActions</code>本质上使用的是欧拉角。想到了至少两个进一步的问题，这两个问题都与在不止一个平面上移动物体有关。这个动画GIF展示了第一个—</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/a092cc312f4e4876dca470fd149d5104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pf55EHafMC-snMOm6-YbxA.gif"/></div></div></figure><p id="2000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你看到的是X和Y平面上45度的旋转。我对两个模型都应用了相同的旋转，但是根据我使用角度的顺序，我得到了不同的结果。这很微妙，但仔细观察，你会发现不同之处。改变顺序后我移动得越多，就越明显。</p><p id="7ad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">插图后面的代码是[gotcha],在包含<code class="fe me mf mg mh b">SCNAction.sequence</code>的行中。复制代码并在您的模型上运行，您将得到相同的结果。请注意，我使用订阅类型的设置将我的<code class="fe me mf mg mh b">GameScene</code>链接到我的SwiftUI界面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1cbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在将<code class="fe me mf mg mh b">SCNAction.sequence</code>改为<code class="fe me mf mg mh b">SCNAction.group</code>并重新运行相同的代码。第二次它会起作用；只有两者会以相同的角度结束。这个上下文中的<code class="fe me mf mg mh b">SCNAction.group</code>意味着并行地进行变更。</p><p id="e315" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是等等——因为你还没有脱离困境，并行运行你的旋转可能绕过序列问题，但是还有第二个更隐蔽的问题可能出现，即万向节锁。</p><p id="d65c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你的两个轴在同一个平面上时，你得到了万向锁定。当这种情况发生时，你失去了在你的三个平面之一移动的能力。</p><p id="9115" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于giro-scopes对飞机和宇宙飞船相当重要，您可以放心，也有一个解决万向锁的方法，尽管我不确定我是否会在您的代码中麻烦地实现它。您可以通过添加第四个轴来固定它，您可以在该轴上旋转。</p><h1 id="9f59" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><code class="fe me mf mg mh b">SCNMatrix4MakeRotation</code></h1><p id="a88d" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我想说解决框架挑战的真正办法是使用矩阵变换，这是真的——但事实并非如此。我用一个动画GIF引导这一部分，它使用欧拉角和矩阵变换来做同样的动作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/78052367eae7ce2bfb5e0d9cf012aced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Z0sHz4QRl73l9Wn-SmO0mg.gif"/></div></div></figure><p id="ec6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以将红色和绿色的轴对齐，有效地将自己放入万向锁中。然而，有一个关键的区别。对于欧拉角，我不得不在三个平面上分割我的旋转，并使用类似动作的东西来组合它们——通过变换，我可以同时完成它们[此处未显示]。这样做的好处是，我怀疑你可以更有效地发现矩阵代码中的万向锁定。</p><p id="9bcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这里展示了左边进行转换的代码。在不利方面，我认为它比欧拉角更难理解。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="a641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显示的代码只是三个平面中的一个，它们本质上都是一样的。当然，就像<code class="fe me mf mg mh b">SCNActions</code>一样，你转换的顺序会影响结果。我在这里使用的一个有用的代码特性是<code class="fe me mf mg mh b">SCNTransation</code>来制作动画。事实上非常有价值，因为不像SwiftUI中的动画，它给你一个完成块，直到动画结束才会触发。</p><h1 id="21dc" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">四元数</h1><p id="ab20" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">现在，我必须承认在这个例子中——我不确定这说明了这些东西的力量，它们能做的比我今天要用的多得多。</p><p id="e924" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">四元数是图形动画中的黄金标准；它们速度快，占用空间少(比矩阵少)，而且没有万向锁定问题，但缺点是不容易使用。</p><p id="2132" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是移动我们的<code class="fe me mf mg mh b">redNode</code>方向的代码，就像我们移动矩阵和欧拉角一样。虽然代码看起来有点像C，但请放心，它很快。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="3080" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码的动画GIF看起来很像上一个，注意，虽然看起来好像我使用四元数失去了一个自由度，但我没有。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/d620cbf480ad5023aecad86169b33082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wt0hQxbZn51BnF6lr4hDiA.gif"/></div></div></figure><h1 id="781b" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="4aa3" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我认为公平地说，无论你最终在项目中使用什么方法，你都应该坚持下去。使用不同的方法来旋转物体会被认为是不良的做法。你也可以通过仔细选择万向锁发生的方向来编写代码。<a class="ae ky" href="https://www.youtube.com/watch?v=zc8b2Jo7mno" rel="noopener ugc nofollow" target="_blank">这是一个很棒的视频</a>，完整地介绍了欧拉角。</p><p id="e15c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些使我想到了本文的结尾。我希望你能像我写这本书一样喜欢读它，并像我一样，在这个过程中学到一两件事。</p><p id="3438" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个链接，链接到我为展示<a class="ae ky" href="https://bitbucket.org/wizard1066/scenekits/commits/fc82eca1383744a7a65599400081c3694c6ed2c6" rel="noopener ugc nofollow" target="_blank">演示图</a>而构建的代码库——一个文件中有两个文件；它不是一段即插即用的代码，是按原样提供的。</p><pre class="kj kk kl km gt nn mh no np aw nq bi"><span id="2415" class="nr mo it mh b gy ns nt l nu nv"><strong class="mh iu">Want to Connect?</strong></span><span id="ca94" class="nr mo it mh b gy nw nt l nu nv">Join me on <a class="ae ky" href="https://www.linkedin.com/in/mark-lucking-4631049/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a> to connect, collaborate or just a chat.</span></pre><div class="nx ny gp gr nz oa"><a href="https://omar-shehata.medium.com/how-to-fix-gimbal-lock-in-n-dimensions-f2f7baec2b5e" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">如何固定N维万向锁</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">如何将四元数推广到更高维？为什么万向节锁有时会发生…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">omar-shehata.medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div></div></div>    
</body>
</html>