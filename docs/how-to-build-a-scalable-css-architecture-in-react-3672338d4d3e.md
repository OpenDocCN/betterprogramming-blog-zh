# 如何在 React 中构建可伸缩的 CSS 架构

> 原文：<https://betterprogramming.pub/how-to-build-a-scalable-css-architecture-in-react-3672338d4d3e>

## 在 React 项目中构建 CSS 的最佳方式是什么？

![](img/11d6273755ccaa9186beb1a4f359a8d5.png)

[马太·亨利](https://unsplash.com/@matthewhenry?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍照。

没有什么比杂乱无章的 CSS 架构更让人抓狂的了。如果你曾经参与过一个包含大量样式和组件的大型项目，那么你会非常清楚其中的可怕之处。到处都是 CSS 样式，从长期删除的组件的未使用的样式表中分离出来，到处都是`!important`。整件事都是卡夫卡式的——没有任何东西是有意义的，所有的逻辑似乎都飞出了窗外。

虽然有许多关于服务器端代码的干净架构的流行书籍，但 CSS 是构建应用程序时经常被忽略的部分。你不能把所有的东西都放进一个 CSS 文件里，然后就到此为止。你的程序越大，你的风格就变得越笨拙。开始时的一点点计划可以获得长期的利益。

但是在我们进入解决方案之前，有必要讨论一下替代方案。

*注意:本文从 React 的角度讨论 CSS 架构，但是同样的原则也可以用于其他前端框架。*

# 可供选择的事物

## 1.基础——内联样式或 CSS 样式表

在 React 中进行样式化的最简单方法是使用内联样式。由于显而易见的原因，这当然不理想。连 React 官方文档[都不推荐](https://reactjs.org/docs/dom-elements.html#style)。当我懒得创建一个单独的 CSS 文件时，或者当我只是添加诸如填充或边距之类的一次性样式时，我会不时地使用它来构建原型。

另一种基本方法是普通的 CSS 文件。您可以简单地在组件旁边创建一个普通的 CSS 文件:

并将其导入组件:

这种方法有几个问题。首先，样式是全局可访问的，这意味着每个组件都可以访问您创建的样式。在上面的例子中，任何其他使用类`primary-button`的组件都将从`styles.css`文件继承样式。在某一点上，命名变成了一场噩梦，你最终不得不求助于 BEM 之类的东西。

## 2.顺风 CSS

顺风是一个有趣的选择。这是一个实用优先的 CSS 框架，这意味着您可以访问低级的实用类，而不是像 Bootstrap 或布尔玛那样预先设计的组件。你基本上是通过应用类来设计组件的样式。

我喜欢顺风。我在工作和项目中使用它。一旦你习惯了，应用样式就变得快速而简单——尤其是原型设计变得轻而易举。每当需要应用样式时，不必将选项卡更改为单独的 CSS 文件，从而避免了上下文切换。此外，您不必担心常见的 CSS 问题，如命名类或维护 CSS 文件。下面是使用顺风的典型 React 组件的样子:

不幸的是，它也会给你的 JSX 增加很多混乱。创建 React 应用程序时，我的首要任务之一是构建易于阅读和维护的小组件。将一堆顺风类与 JSX 中的视图和逻辑混合在一起可能会很混乱。

当然，有一些方法可以抑制肿胀。Tailwind 建议您将常用的样式提取到组件中。也可以选择使用`@apply`作为常用的样式，比如:

```
.btn-primary {
  @apply bg-transparent rounded border-solid border-2 border-red-600 text-red-600 m-5 px-10 py-5;
}
```

然后可以像普通 CSS 类一样使用它:

```
<button className="btn-primary">Click me!</button>
```

然而，并不是所有的东西都可以被转换成一个组件，使用像`@apply`这样的东西来封装常用的样式看起来非常接近于用传统的方式做事。如果你能在模板中看到所有这些类，那么 Tailwind 是一个不错的选择。但对我来说，它似乎以制造新问题为代价解决了某些问题。

## 3.CSS-in-JS

JS 中的 CSS 是另一种选择。有几个流行的库，包括样式组件和情感。基本上，您使用 JavaScript 来设计组件的样式。下面是一个使用样式化组件的 React 组件的示例:

这种方法有一些优点。像使用 Tailwind 一样，您可以避免类名冲突的麻烦。您的样式就在组件中，删除组件也会删除样式，从而便于清理。你也可以利用道具来动态改变风格。

虽然有一点学习曲线，但我并不喜欢这种语法。但是在我看来，最大的缺点是它弄乱了你的代码。在一定的规模下，你的组件中会有一堆 CSS-in-JS，这使得它们很难阅读和管理。

# 我的解决方案是:CSS 模块和一个全局样式文件夹

CSS 模块基本上是 CSS 文件，其中类名的作用域是本地的，这意味着我们可以在文件中使用我们想要的任何名称，而不允许任何其他组件访问它。命名一直是 CSS 的痛点之一，催生了对 BEM 等解决方案的需求。CSS 模块消除了这种担心。现在你可以有 50 个“包装器”或“容器”分布在你的 CSS 中，只要你使用 CSS 模块，风格就不会互相影响。

CSS 模块也更容易维护。这些模块通常与组件放在同一个文件夹中，这样很容易找到。这使得它们在组件被删除的情况下很容易被移除，从而避免了一堆未使用的样式表。

对我来说，成功的因素是造型和视角之间关注点的清晰分离。这是一个使用 CSS 模块的组件的例子。

首先，用你喜欢的名字创建 CSS 模块，如果你使用 [SASS](https://sass-lang.com/) 的话，给它加上`.module.css`或`.module.scss`:

然后，将 CSS 模块导入组件:

如你所见，JSX 变得更加易读。该组件简洁明了。所有的造型都局限于`MyComponent.module.scss`。

最后但同样重要的是，CSS 模块是熟悉的。虽然 Tailwind 和 CSS-in-JS 库现在确实非常流行，但它们也是您必须学习和习惯的另一件事情。如果你在一个不熟悉这些工具的团队中工作，你必须能够为他们做一个强有力的案例，因为对于一个多年来一直以传统方式做前端设计的人来说，这些不是无关紧要的转变。CSS 模块允许您以习惯的方式应用样式，同时仍然获得可伸缩性和可维护性的好处。

您可能已经注意到，我在 CSS 模块中使用了 SASS。虽然这肯定不是必需的，但 SASS 给了您很多好处，包括变量、嵌套和混合。它也已经存在了一段时间，许多前端开发人员可能都有这方面的经验。

使用这种方法，您还需要一个全局样式文件夹。为了实现跨多个页面或组件甚至整个站点共享的样式，比如布局、颜色和版式，全局样式仍然是必要的。这个 styles 文件夹可以保持精简，因为大多数组件的样式就在 components 文件夹中的 JSX 文件旁边。我推荐使用[7-1 模式](https://sass-guidelin.es/)来组织你的全球风格文件夹。

# **做出明智的决定**

如果我还不能说服你 CSS 模块的优点，我建议你开始一个小项目，并在上面的每一个不同的策略中实现风格。这将让你更好地了解你喜欢或不喜欢每种方法。

整理你的风格不应该是事后的想法。尽早考虑干净的 CSS 架构是快乐的开发人员、更干净、更易维护的代码和更好的用户体验的关键。