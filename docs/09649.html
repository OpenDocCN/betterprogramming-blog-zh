<html>
<head>
<title>Training LSTM Model With MLCompute on iOS or macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS或macOS上使用MLCompute训练LSTM模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/train-lstm-with-mlcompute-on-ios-macos-8e9326ce948f?source=collection_archive---------11-----------------------#2021-09-21">https://betterprogramming.pub/train-lstm-with-mlcompute-on-ios-macos-8e9326ce948f?source=collection_archive---------11-----------------------#2021-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="00a5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用MLCompute框架为您的iOS应用程序构建预测模型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dfc98b606dc412878b713342d81ee259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QLBFu9kL2w8pip17-xjHg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"> Undraw </a></p></figure><p id="0c64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在WWDC 2020期间，苹果展示了一个新的<a class="ae kv" href="https://developer.apple.com/documentation/mlc…" rel="noopener ugc nofollow" target="_blank"> MLCompute </a>框架。它提供了一个灵活的API，用于在不同的计算单元上训练和推理神经网络。</p><p id="6130" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近有一个任务，训练一个LSTM模型。</p><p id="1f67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">LSTM是一个先进的RNN(递归神经网络)，在预测之间有两个状态，不像香草RNN。</p><p id="7c5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这改善了预测结果，并保护我们在训练过程中免受梯度消失的影响。</p><h1 id="878e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">时间数列预测法</h1><p id="8db8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们的任务是利用当前状态预测未来趋势。我们可以训练LSTM来解决这个问题:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/36e6482065ccb247ac28a2c6d1d6fb05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KoN6mlvLz8ZKe0UzmEojhg.png"/></div></div></figure><h1 id="1a16" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">张量</h1><p id="2c41" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><code class="fe mq mr ms mt b">MLCompute</code>用<code class="fe mq mr ms mt b">MLCTensor</code> <strong class="ky ir"> </strong>进行计算。我们需要设置一个<code class="fe mq mr ms mt b">MLCTensor</code> <strong class="ky ir"> </strong>对象数组来设置LSTM:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="4267" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了与<code class="fe mq mr ms mt b">LSTM</code>一起工作，<code class="fe mq mr ms mt b">MLCompute</code>提供了两个类:</p><p id="1690" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是<code class="fe mq mr ms mt b">MLCLSTMDescriptor</code>类的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1326" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mq mr ms mt b">MLCLSTMLayer </code>的代码是:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="a3e1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">建立管道</strong></h1><ul class=""><li id="dced" class="mw mx iq ky b kz mk lc ml lf my lj mz ln na lr nb nc nd ne bi translated">对于推论，它使用:<code class="fe mq mr ms mt b">MLCInferenceGraph</code></li><li id="a67f" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">对于火车，它使用:<code class="fe mq mr ms mt b"> MLCTrainingGraph</code></li><li id="ac91" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">初始化以上两个对象并设置我们的LSTM层，我们需要使用<code class="fe mq mr ms mt b">MLCGraph</code>。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="cd93" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">训练</strong></h1><p id="baea" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在训练之前，我们需要使用<code class="fe mq mr ms mt b">MLCTensorData</code>对象包装我们的数据，然后执行如下所示的训练循环:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="ab26" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">结果</strong></h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk mv l"/></div></figure><p id="71cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以从我的GitHub资源库下载一个示例项目:</p><div class="nl nm gp gr nn no"><a href="https://github.com/dhrebeniuk/MLCLSTMExample" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">GitHub-dhrebeniuk/mlclstm示例:如何将LSTM与MLCompute结合使用的示例</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">示例我们如何使用LSTM与MLCompute。通过创建帐户，为dhrebeniuk/MLCLSTMExample开发做出贡献…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kp no"/></div></div></a></div><p id="7520" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。感谢阅读。</p></div></div>    
</body>
</html>