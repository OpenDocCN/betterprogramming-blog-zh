<html>
<head>
<title>Build a Collaborative Pixel Art App With Flutter and Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Flutter和Firebase构建一个协作像素艺术应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-collaborative-pixel-art-app-with-flutter-and-firebase-d4a027b4534b?source=collection_archive---------2-----------------------#2022-09-26">https://betterprogramming.pub/build-a-collaborative-pixel-art-app-with-flutter-and-firebase-d4a027b4534b?source=collection_archive---------2-----------------------#2022-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e6ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建您自己的休息/场所</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8bb9b0d050ad7d073b5529e7a6c4ed99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AlW9m4YnAN2tW43O"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">帕斯卡尔·贝纳登在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="f2df" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="ffbe" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最近你可能听说过<a class="ae kv" href="https://www.reddit.com/r/place/" rel="noopener ugc nofollow" target="_blank"> r/place </a>或<a class="ae kv" href="https://place.zevent.fr/" rel="noopener ugc nofollow" target="_blank"> z/place </a>，如果你没有听说过，你可能会想我在说什么。这些是合作项目和社会实验，用户可以通过一次改变一个像素的颜色来编辑画布。在活动结束时，通常是两三天，你已经得到了一个美丽的像素艺术作品。你可以在<a class="ae kv" href="https://en.wikipedia.org/wiki/R/place" rel="noopener ugc nofollow" target="_blank">维基百科</a>上找到所有信息。</p><blockquote class="mk ml mm"><p id="7840" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">我决定把这篇文章分成两节。第一个致力于基本特性。第二个增加了一些高级功能，如认证，像素更新历史，放大/缩小和托管。</p></blockquote><p id="ccdd" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">嘶！你可以在我的GitHub账户上找到完整的项目！它遵循<code class="fe mw mx my mz b">Clean Architecture</code>模式，但有一些自由。我没有为这篇文章全力以赴的冲动。</p><div class="na nb gp gr nc nd"><a href="https://github.com/duribreux/place" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">GitHub — duribreux/place</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">一点一点地成为艺术家。</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr kp nd"/></div></div></a></div><blockquote class="mk ml mm"><p id="9167" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">我可能已经跳过了自愿(或不自愿)的一些实现细节。如果需要，请参考资料来源，并在评论区随意提问。如果你想经营自己的地方，也一定要查看自述文件。</p></blockquote><h1 id="3a81" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">你会得到什么</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div></figure><div class="na nb gp gr nc nd"><a href="https://place-3fcc2.web.app/#/" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">地方</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">一点一点地成为艺术家。</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">place-3fcc2.web.app</p></div></div></div></a></div><h1 id="7b22" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">基本要求</h1><ul class=""><li id="5796" class="nu nv iq lq b lr ls lu lv lx nw mb nx mf ny mj nz oa ob oc bi translated">一种绘制像素并选择其颜色的方法。</li><li id="9472" class="nu nv iq lq b lr od lu oe lx of mb og mf oh mj nz oa ob oc bi translated">存储像素的实时数据库，最重要的是，当发生变化时通知用户。</li></ul><h2 id="2ed5" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">把我画成你的…</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/c356aeca4494897fd674aff6caef2dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AHtT20cusRIIigug"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/es/@alicegrace?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">爱丽丝·迪特里希</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="441e" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">首先，让我们创建一个类来描述一个像素。没什么疯狂的。我们只需要一个<code class="fe mw mx my mz b">Offset</code>描述它在2D的位置，就可以知道在哪里抽签以及它当前的<code class="fe mw mx my mz b">Color</code>。在高级部分，我们可能会添加一些信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="e2d5" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">为了绘制像素，我们需要一个提供画布的小部件。这就是<a class="ae kv" href="https://api.flutter.dev/flutter/widgets/CustomPaint-class.html" rel="noopener ugc nofollow" target="_blank">定制绘画</a>的目的，它需要一个<a class="ae kv" href="https://api.flutter.dev/flutter/rendering/CustomPainter-class.html" rel="noopener ugc nofollow" target="_blank">定制画家</a>来指定我们想要表达什么以及如何表达我们的艺术</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="67af" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">默认情况下，<code class="fe mw mx my mz b">CustomPaint</code>将占据整个屏幕，但我想为所有人提供相同的绘图体验，所以我将它固定为<code class="fe mw mx my mz b">1920x1080</code>——超过200万像素。绰绰有余！有趣的是，还有两个额外的属性我们没有使用。<code class="fe mw mx my mz b">isComplex</code>和<code class="fe mw mx my mz b">willChange</code>。如果你发疯了，你可能想把它们设置为<code class="fe mw mx my mz b">true</code>以从缓存中获益。</p><p id="1a0b" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">然后我们需要创建我们的<code class="fe mw mx my mz b">CustomPainter</code>和它的<code class="fe mw mx my mz b">Paint</code>设置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="4e1c" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">这个稍微复杂一点。如你所见，我们的画师扩展了<code class="fe mw mx my mz b">CustomPainter</code>。这样做，我们需要覆盖<code class="fe mw mx my mz b">paint</code>和<code class="fe mw mx my mz b">shouldRepaint</code>方法。我们给它一个<code class="fe mw mx my mz b">List&lt;Pixel&gt;</code>作为参数画出来……就这样。我们不需要repaint参数，每当像素列表更新时，视图将被重新构建。那么很简单，我们只需要遍历像素列表，并在各自的<code class="fe mw mx my mz b">Offset</code>坐标上画出它们。</p><blockquote class="mk ml mm"><p id="23ad" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">你可能已经注意到我已经将<code class="fe mw mx my mz b"><em class="iq">strokeWidth</em></code>设置为10，这是一些大的像素。这只是因为我想让它比1x1像素更直观。还有20万像素的乐趣。</p></blockquote><p id="bd9d" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">此外，我们需要一种方法来确定像素的坐标。最简单的方法似乎是将<code class="fe mw mx my mz b">CustomPaint</code>包装成一个<code class="fe mw mx my mz b">Listener</code>小部件，并实现<code class="fe mw mx my mz b">onPointerDown</code>回调。通过这样做，我们受益于<code class="fe mw mx my mz b">localePosition</code>事件参数，给我们光标的位置。不要使用<code class="fe mw mx my mz b">position</code>。否则，你会得到绝对位置，我们想要画布中的相对位置，而不是在应用程序屏幕中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><blockquote class="mk ml mm"><p id="03b2" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">你可能想检查是否没有键盘上的键被按下，否则当你试图在画布中移动的时候就会产生像素(alt / ⌥ + clic)</p></blockquote><p id="69ac" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">最后，为了挑选一种颜色，我决定使用<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/flutter_colorpicker" rel="noopener ugc nofollow" target="_blank">flutter_colorpicker</a></code>包。我本可以自己实现一个小部件，但是，嘿…让我们不要重新发明轮子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="7cb0" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">没什么好说的。<code class="fe mw mx my mz b">BlockPicker</code>小部件放在脚手架<code class="fe mw mx my mz b">AppBar</code>上，每当<code class="fe mw mx my mz b">onColorChanged</code>触发时，我保存新的<code class="fe mw mx my mz b">Color</code>，以便提供给<code class="fe mw mx my mz b">CustomPainter</code>。你可以使用默认布局，或者像我一样创建一个符合你需要的布局。</p><h1 id="e84f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">坚持</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/f9c7cfd9b691c356d1fccf9bbbd9a4ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2QPIpNmGdv6-EfUV"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@imgix?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> imgix </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="2cd2" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">建立数据库最快的方法之一可能是使用<a class="ae kv" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>。它易于使用，有很好的文档记录，并且大多数基本用法都是免费的。您只需要在Firebase控制台中创建一个项目，启用<a class="ae kv" href="https://firebase.google.com/products/realtime-database?gclid=CjwKCAjwpqCZBhAbEiwAa7pXeaAr2R7rR4MDrTirnuX8UghhQwTcguho8gIG73GNvN6-5_43s7giuhoCoScQAvD_BwE&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank"> Firebase实时数据库</a>，并在您的flutter项目中配置<a class="ae kv" href="https://pub.dev/packages/firebase_database" rel="noopener ugc nofollow" target="_blank"> Firebase数据库</a>。现在，不要担心权限，只允许任何人读写您的数据库。</p><pre class="kg kh ki kj gt ox mz oy oz aw pa bi"><span id="1dae" class="oi kx iq mz b gy pb pc l pd pe">{<br/>  "rules": {<br/>    ".read": true,<br/>    ".write": true,<br/>  }<br/>}</span></pre><p id="c68a" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">最坏的情况是我们会失去画布。我相信我们能应付得来。</p><h1 id="3ec0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">网路层</h1><p id="82fc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们做得又快又干净！设置一个<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/flutter_bloc" rel="noopener ugc nofollow" target="_blank">BLoC</a></code>和一个<code class="fe mw mx my mz b">FirebasePixelsRepository</code>分别与我们的表示层和Firebase数据库交互。</p><blockquote class="mk ml mm"><p id="dbc8" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">我也在用<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/injectable" rel="noopener ugc nofollow" target="_blank"><em class="iq">injectable</em></a></code>框架。这不是强制性的，如果不喜欢依赖注入，你可以自己实例化类。没什么大不了的！</p></blockquote><p id="5486" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">让我们从存储库开始。正如我在引言中所说的，我们需要一种方法，以便在数据库发生修改时得到通知。这就是为什么我们使用一个<code class="fe mw mx my mz b">Realtime database</code>和……<code class="fe mw mx my mz b"><a class="ae kv" href="https://dart.dev/tutorials/language/streams" rel="noopener ugc nofollow" target="_blank">Streams</a></code>。<code class="fe mw mx my mz b">listen</code>的目标是对数据的变化做出相应的反应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="2792" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated"><code class="fe mw mx my mz b">PixelsRepository</code>是一个简单的接口。让我们务实一点，我们只需要两个功能。</p><ol class=""><li id="2400" class="nu nv iq lq b lr mo lu mp lx pf mb pg mf ph mj pi oa ob oc bi translated"><code class="fe mw mx my mz b">createPixel</code>创建一个基于其坐标的唯一散列所引用的像素。每当我们改变它的颜色时，这将给我们一个简单的方法来访问它，并防止我们盲目地在一个永远增长的列表中创建另一个。</li><li id="4813" class="nu nv iq lq b lr od lu oe lx of mb og mf oh mj pi oa ob oc bi translated"><code class="fe mw mx my mz b">listenPixels</code>订阅我们数据库中的任何添加或更改，并在新像素被创建或更新时通过将它们推入流来通知我们。了解更多关于<a class="ae kv" href="https://api.flutter.dev/flutter/async/StreamGroup-class.html" rel="noopener ugc nofollow" target="_blank"> StreamGroup </a>的信息。</li></ol><p id="e59b" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated"><code class="fe mw mx my mz b">PixelModel</code>看起来是这样的。注意，我已经创建了两个<code class="fe mw mx my mz b">converters</code>来平滑地序列化(反序列化)对象。花费不多。很有帮助。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="cab8" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">现在，让我们在存储库和表示层之间建立一座小小的桥梁。<a class="ae kv" href="https://en.wikipedia.org/wiki/Separation_of_concerns" rel="noopener ugc nofollow" target="_blank">关注点分离原则</a> …你知道该怎么做！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="9b34" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">不要害怕！真的没有什么。我们的集团正在监听<code class="fe mw mx my mz b">PixelsEventListen</code>和<code class="fe mw mx my mz b">PixelsEventAdd</code>匹配我们的存储库方法。我们还创建了一个自定义的<code class="fe mw mx my mz b">Stream</code>和一个<code class="fe mw mx my mz b">Map&lt;int, Pixel&gt;</code>来通过流提供给表示层。</p><p id="b8cf" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">有两件事值得一提:首先，我们使用<code class="fe mw mx my mz b">listen</code>来订阅流。第二，我们没有<code class="fe mw mx my mz b">cancelOnError</code>。让我们保持(数据)流动。</p><blockquote class="mk ml mm"><p id="3246" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">如果您非常细心，您可能已经发现了<code class="fe mw mx my mz b"><em class="iq">round</em></code>方法调用。是因为我设置的<code class="fe mw mx my mz b"><em class="iq">strokeWidth</em></code>。我需要计算10x10像素的原点坐标，而不是我点击的精确像素。如果我单击(19，12)，我希望保存的偏移量为(15，15)。这样，像素将覆盖从(10，10)到(20，20)的区域</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="711b" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">只需将您的块添加到您的视图中，并将流提供给一个<code class="fe mw mx my mz b">StreamBuilder</code>小部件。然后将<code class="fe mw mx my mz b">data</code>发送到画布。您的应用程序小部件应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="ee84" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">就是这样！此时，您应该能够在多个窗口中运行它，在一个窗口中创建像素，并看到它在其他窗口中复制。</p><h1 id="14da" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">让它发光</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pj"><img src="../Images/d01b29803fa21aa6d3f7998f63ba8208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CEUCibRRCwUnwic2"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/ja/@sfkopstein?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> shraga kopstein </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c8a6" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">从现在开始，我会加快一点速度。目标是提供一些额外的特性，以更接近真实的r/place规则，而又没有太多的限制。我不想禁止你乱来。</p><h2 id="a18e" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">验证用户</h2><p id="209e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">添加<code class="fe mw mx my mz b">firebase_auth</code>包，启用firebase控制台中的<code class="fe mw mx my mz b">Authentication</code>功能，允许<code class="fe mw mx my mz b">anonymous</code>作为<code class="fe mw mx my mz b">sign-in method</code>。然后创建一个<code class="fe mw mx my mz b">firebase_auth_repository</code>来处理它。显然，添加其他注册方式(如电子邮件、谷歌等)取决于您。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="22da" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">既然我们已经有了一些非常基本的身份验证概念，我们可以稍微升级一下我们的安全规则。</p><pre class="kg kh ki kj gt ox mz oy oz aw pa bi"><span id="c30a" class="oi kx iq mz b gy pb pc l pd pe">{<br/>  "rules": {<br/>    ".read": true,<br/>    ".write": “auth != null”,<br/>  }<br/>}</span></pre><p id="a842" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">嘣！现在只有经过认证的用户才能写像素。接下来创建一个<code class="fe mw mx my mz b">AuthCubit</code>来与视图交互，给它添加一个按钮，一切都准备好了！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="2bbb" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">一个<code class="fe mw mx my mz b">Cubit</code>不会像集团那样要求你创建自定义事件。直接调用方法就行了！</p><h2 id="35ab" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">修改历史</h2><p id="277f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">每当添加或修改像素时，记录所有更改的时间。让我们使用我们用来保存<code class="fe mw mx my mz b">Pixels</code>的同一个<code class="fe mw mx my mz b">Realtime database</code>。为此，只需更新<code class="fe mw mx my mz b">createPixel</code>方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="0194" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">完成了。在我们创建一个像素的同时，我们也<code class="fe mw mx my mz b">push</code>了一个新的唯一引用，并为其设置了我们像素的信息。唯一的区别是我们将永远坚持所有的改变。也许用它们来制作一个回放？</p><p id="1cf6" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">正如我们为像素的创建所做的那样，只需编写一个专用的流。在表示层，只需向包含一列<code class="fe mw mx my mz b">ListTile</code>的<code class="fe mw mx my mz b">ListView</code>提供数据，每一列都是像素更新。我将让您检查实现的存储库，这很简单。</p><h2 id="0fa6" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">放大/缩小</h2><p id="aca1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">你还没准备好。直到现在，用户必须有一个非常大的屏幕才能看到整个画布。为了解决这个问题，首先你可能想添加某种双<code class="fe mw mx my mz b">SingleChildScrollView</code>小部件来进行垂直和水平滚动，但这将是一个错误，而且无论如何也不会顺利工作。</p><p id="eb34" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">您需要将画布包装在一个<code class="fe mw mx my mz b"><a class="ae kv" href="https://api.flutter.dev/flutter/widgets/InteractiveViewer-class.html" rel="noopener ugc nofollow" target="_blank">InteractiveViewer</a></code>小部件中，只需记住将<code class="fe mw mx my mz b">constrained</code>属性设置为false，并根据您的需要调整<code class="fe mw mx my mz b">minScale</code>和<code class="fe mw mx my mz b">maxScale</code>。这样，无论你的屏幕大小如何，你都可以导航到任何你想去的地方。查看<a class="ae kv" href="https://api.flutter.dev/flutter/widgets/InteractiveViewer-class.html" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov nt l"/></div></figure><p id="a929" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">一定要检查<a class="ae kv" href="https://github.com/duribreux/place" rel="noopener ugc nofollow" target="_blank">库</a>来处理布局约束以及如何正确排序小部件。</p><h2 id="0342" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">主办；主持</h2><p id="713f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">老实说，就像遵循官方文档一样简单。</p><p id="8181" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">运行<code class="fe mw mx my mz b">flutter build web -—release</code>,然后运行<code class="fe mw mx my mz b">firebase init hosting</code>命令行，回答几个问题，你就会得到主机URL。如果你想对你的域有更多的控制，检查Firebase控制台中的<code class="fe mw mx my mz b">hosting</code>配置。</p><pre class="kg kh ki kj gt ox mz oy oz aw pa bi"><span id="40a2" class="oi kx iq mz b gy pb pc l pd pe">? What do you want to use as your public directory? build/web<br/>? Configure as a single-page app (rewrite all urls to /index.html)? No<br/>? Set up automatic builds and deploys with GitHub? No<br/>✔ Wrote build/web/404.html</span></pre><p id="50f3" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">确保将<code class="fe mw mx my mz b">build/web</code>设置为您的公共存储库。这是你的消息来源。然后运行<code class="fe mw mx my mz b">firebase deploy</code>你就活了！</p></div><div class="ab cl pk pl hu pm" role="separator"><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp"/></div><div class="ij ik il im in"><p id="013a" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">我希望你喜欢读它，就像我喜欢写它一样。它非常密集，我确定我已经跳过了一些细节，但是如果需要的话记得检查<a class="ae kv" href="https://github.com/duribreux/place" rel="noopener ugc nofollow" target="_blank">库</a>。</p></div><div class="ab cl pk pl hu pm" role="separator"><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp pq"/><span class="pn bw bk po pp"/></div><div class="ij ik il im in"><h2 id="3275" class="oi kx iq bd ky oj ok dn lc ol om dp lg lx on oo li mb op oq lk mf or os lm ot bi translated">想要更多吗？</h2><div class="na nb gp gr nc nd"><a rel="noopener  ugc nofollow" target="_blank" href="/detect-user-inactivity-in-flutter-applications-af42b08101c"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">检测颤振应用中的用户不活动</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">防止数据泄露</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">better编程. pub</p></div></div><div class="nm l"><div class="pr l no np nq nm nr kp nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a rel="noopener  ugc nofollow" target="_blank" href="/a-guide-to-handling-user-privacy-to-comply-with-gdpr-in-flutter-applications-9914ab479240"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">颤振应用中符合GDPR的用户隐私处理指南</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">通过在收集数据前询问来保持合规性</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">better编程. pub</p></div></div><div class="nm l"><div class="ps l no np nq nm nr kp nd"/></div></div></a></div></div></div>    
</body>
</html>