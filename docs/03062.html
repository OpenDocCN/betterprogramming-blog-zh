<html>
<head>
<title>Write a Data-Based Library to Summarize What’s Around Here</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">写一个基于数据的库来总结这里的东西</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/write-a-data-based-library-to-summarize-whats-around-here-9e8ad83fe198?source=collection_archive---------11-----------------------#2020-01-17">https://betterprogramming.pub/write-a-data-based-library-to-summarize-whats-around-here-9e8ad83fe198?source=collection_archive---------11-----------------------#2020-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="47f3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我如何用谷歌地图附近的API改善我的旅行冒险</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/42cb9a97ef9077547b0d59644cb8b9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNWLlXiHpv92HE-uwo0zPA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新加坡老山街警察局。胡安·德迪奥斯·桑托斯摄</p></figure><p id="957f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我的旅行冒险中，我偶尔会停下来，看着地平线，发现自己在问:“这个地区是什么样的地方？”当然，你可以四处看看，可能会发现这里有一家餐馆，那里有一家咖啡馆，还有一家看起来每晚花费500多美元的酒店。但是这里到底有什么？我想知道！这个问题的后续是经典的“这个地区的平均价格范围是多少？”(一个背包客的最爱)。</p><p id="5dd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想在这里说明的一点是，我有问题，需要答案的问题，以及以数据形式出现的答案。你可能知道，谷歌地图就是提供这些答案的工具。但是我想在每次好奇虫咬我的时候打开地图应用吗？没有。我要不要在脑子里总结所有的数据来推断这里是什么样的地方？也没有。那么这里有什么选择呢？好吧，让我们做一个图书馆。</p><p id="525f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我照做了。我构建的库是一个包装器，包装了Google Maps Nearby Places API，它检索特定区域内的位置并总结它们的某些属性。这个图书馆的名字是<a class="ae lu" href="https://github.com/juandes/places-summarized" rel="noopener ugc nofollow" target="_blank">地名汇总</a>，在这篇文章中，我想介绍它，并展示我在过去几个月里去过的一些地方的汇总。跟我来。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7e47097bb3dda163421c761a1f2b5509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iULRLCcPyvNHjZOIwWX40g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京台场的日落。胡安·德·迪奥斯·桑多斯(【https://www.instagram.com/juandesr/】T4)的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4660" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">谷歌地图应用编程接口附近的地方</h1><p id="fa5b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">在进入精彩部分之前，我想先介绍一下背景知识，说几句关于Google Maps Places Nearby API的话，这是Places总结背后的工具。附近的地方是Google Maps API的一个特性，它可以搜索一组给定坐标附近的地方。例如，假设你想知道你的家乡周围有什么(你可能已经记住了，但是，嘿，我说的是假设！).为此，你可以使用谷歌地图(但这有什么意思呢？)或获取API密钥，并使用您所在城镇的坐标和所需半径请求他们的服务。</p><p id="365b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对附近API的调用返回一个JSON字符串，其中包含给定坐标附近的位置及其属性。这些属性中的一些是<code class="fe mz na nb nc b">places_level</code>(地点价格水平)和<code class="fe mz na nb nc b">rating</code>。默认情况下，Google根据重要性对位置附近的地方进行排名，因此实际上并不是所有的地方都被返回。如果您希望缩小结果范围，并按距离对网站进行排序，那么您必须使用一些可选参数，如<code class="fe mz na nb nc b">rankBy</code>(指定排名模式)和<code class="fe mz na nb nc b">type</code>(描述位置类型，如餐馆或购物中心)。</p><p id="4939" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，这项服务并不完全免费。然而，谷歌地图每月提供200美元的信贷，对于这样的项目来说绰绰有余。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a416" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">汇总的位置</h1><p id="401f" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">汇总地点的目标是汇总附近地点返回的属性。这个库有一个<code class="fe mz na nb nc b">Client</code>对象和一个名为<code class="fe mz na nb nc b">places_summary</code>的方法，该方法将位置和半径作为参数，并返回一个包含汇总值的<code class="fe mz na nb nc b">Summary</code>。</p><p id="d9eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在库的第一个版本中，摘要包括以下内容:</p><ul class=""><li id="7fb0" class="nd ne it la b lb lc le lf lh nf ll ng lp nh lt ni nj nk nl bi translated">位置的数量</li><li id="e150" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">位置评级列表</li><li id="77c9" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">一个地点拥有的评级数量列表</li><li id="5764" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">地点的价格水平列表。该值代表该位置的价格水平，范围为1到4。</li><li id="b76c" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">包含每个位置类型的计数的字典</li><li id="861f" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">所有地点的平均评分</li><li id="c9b5" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">所有地点的平均收视率</li><li id="1a35" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated">平均价格水平</li></ul><p id="27b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除此之外，<code class="fe mz na nb nc b">Summary</code>有两种方法:</p><ul class=""><li id="f510" class="nd ne it la b lb lc le lf lh nf ll ng lp nh lt ni nj nk nl bi translated"><code class="fe mz na nb nc b">ratings_by_type</code>:返回给定类型位置的等级</li><li id="07de" class="nd ne it la b lb nm le nn lh no ll np lp nq lt ni nj nk nl bi translated"><code class="fe mz na nb nc b">average_rating_by_type</code>:计算给定类型位置的平均等级</li></ul><p id="d0a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认情况下，Places Nearby call最多返回20个位置，这有点令人失望。然而，返回的对象包含一个<code class="fe mz na nb nc b">pagetoken</code>值，一个可以用作<code class="fe mz na nb nc b">places_summary</code>的参数的字符串，通常放在附近。在这种情况下，它从先前的搜索中返回以下最多20个结果。<code class="fe mz na nb nc b">Summary</code>对象将这个<code class="fe mz na nb nc b">pagetoken</code>作为属性保存。我这样设计是因为<code class="fe mz na nb nc b">Client</code>有一个名为<code class="fe mz na nb nc b">get_more_results</code>的方法，它接受一个<code class="fe mz na nb nc b">Summary</code>并使用那个<code class="fe mz na nb nc b">pagetoken</code>来检索下一个位置。</p><p id="0fc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="575f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了测试这个库，我创建了一个类似于<code class="fe mz na nb nc b">Client</code>的<code class="fe mz na nb nc b">FakeClient</code>类，但是除了它没有任何参数并且实际上不进行API调用。相反，它从作为库的一部分的本地文件中读取，这是来自我保存为JSON文件的API的响应；地点是悉尼谷歌办公室周围的区域。下面，你会发现一个<code class="fe mz na nb nc b">FakeClient</code>和回应的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a972" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是闲聊够了，让我们看看一些结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7a85ab3f78ed65650ee30d3520d700e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4vfsnQSQsdPgasRX2VyvEA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">巴厘岛Pigstone海滩。胡安·德·迪奥斯·桑多斯(<a class="ae lu" href="https://www.instagram.com/juandesr/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/juandesr/</a>)的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d860" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用例:总结我去过的一些地方</h1><p id="71fa" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">为了测试这个库(这也是我创建它的原因)，我编写了一个小脚本，使用这个库来总结和可视化我在旅行中访问过的一些地方的结果。具体来说，我正在绘制<code class="fe mz na nb nc b">rating</code>、<code class="fe mz na nb nc b">user_ratings_total</code>和<code class="fe mz na nb nc b">price_level</code>的直方图，以及显示位置类型百分比的条形图。</p><p id="9c95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有问题的地方是新加坡的中心(1.2871404，103.844437)；藏谷，来自印尼巴厘岛的地区(-8.6465434，115.1367221)；东京新宿(35.6955425，139.7009607)；以及马来西亚吉隆坡的中国城(3.1453656，101.6986553)。</p><p id="cf63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这些地方中的每一个，我使用1000m的半径和四次<code class="fe mz na nb nc b">get_more_results</code>。下面你会发现所有的图表。但首先，让我们看看代码的第一部分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3b42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该脚本将API键、位置、半径和一个参数<code class="fe mz na nb nc b">get</code>(可怕的名称，我应该更改它)作为参数，该参数指定您想要调用<code class="fe mz na nb nc b">get_more_results</code>的次数。脚本做的第一件事是解析参数。然后，我们使用密钥声明客户机，并调用<code class="fe mz na nb nc b">client.places_summary</code>来获取摘要。接下来，我们迭代<code class="fe mz na nb nc b">get</code>次以获得更多结果。</p><p id="8571" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，在这个循环中，我使用了一个sleep语句来暂停脚本五秒钟，因为否则，对API的调用就会失败；我相信这与我的客户/支付层有关，或者是一些奇怪的事情(如果有人知道，请告诉我)。</p><p id="bb09" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看一下图表，从评分开始(图片的标题指定了位置)。</p><h2 id="b99b" class="nt md it bd me nu nv dn mi nw nx dp mm lh ny nz mo ll oa ob mq lp oc od ms oe bi translated">等级</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b013d77cf8dfbec34b339b93a95bc004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0qXyCUvIxok7o6EQ3OV0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">苍谷附近地区的收视率</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5fecf8601e38f8516281951e60782911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0OdIHTUc5cFDpbCKzgQaw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新加坡核心附近地区的评级</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/052d3da9e64782b2972a7b6c5d6917e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_29NRbWMAe4MIAiQrkyofg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉隆坡唐人街附近地区的收视率</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9330134ab2c8b6e54cb9f533d794ad04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIV5_lew5cPO2Tq12i8T3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京新宿附近地区的收视率</p></figure><p id="da47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在所有这些地点中，平均评分最高的是仓谷。虽然这看起来很酷，但我并不感到惊讶，因为仓谷本质上是一个充满海滩、酒吧、餐馆、海滩和更多餐馆的旅游区。而且我也不知道很多给海滩差评的人(有就发截图给我)。</p><p id="9ddd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">说到评分，我还想调查一个位置有多少评论。在下一节中，您将找到这些值。</p><h2 id="dfb7" class="nt md it bd me nu nv dn mi nw nx dp mm lh ny nz mo ll oa ob mq lp oc od ms oe bi translated">每个地点的评论总数</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ddb7e5b0e418931527cec9606027de56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhf0bG0CLnodPcZrDKk_Tg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">苍谷附近地方的总用户评分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f576eb0ef17e9a230c44ce8d5fd9e8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiwWEzfSh7IiIzhnq3uQMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新加坡核心地区附近的总用户评分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/70bdb1990d131a1f54da1adc40dcf760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r8XsfTEPc-_inN5233rLmQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉隆坡中国城附近的用户总评分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/01a1ae01cbb70e509ff8ce8ea6c61d0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrfIigVJopI5y0xZaAMxYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京新宿附近地区的总用户评分</p></figure><p id="7bea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据直方图及其在x轴早期的峰值，四个不同的位置有许多地方具有低数量的评论。在新加坡，图表在2000点左右下降，然后在下降前略有上升。然后，在最后，有一个地方有惊人的30，000条评论:那个地区是克拉克码头。总的来说，平均值为1，630.62，但我们需要考虑到30，000的值会使平均值向该数字移动。对于未来，我应该用中间值来代替它。</p><p id="30f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">关于其他地点，新宿的平均价格是371.32，吉隆坡538.810，仓谷100.92。</p><p id="f1a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是这到底告诉我们什么呢？嗯，它当然说新加坡的人民和游客喜欢评价他们的地方。</p><p id="57db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了创建直方图，我使用了以下代码:</p><pre class="kj kk kl km gt of nc og oh aw oi bi"><span id="bcd4" class="nt md it nc b gy oj ok l ol om">sns.distplot(r['ratings']).set_title(<br/>    'Ratings of locations from {}'.format(location))<br/>plt.savefig('{}_{}.png'.format(location, 'ratings'),<br/>            dpi=320, orientation='landscape')<br/>plt.clf()</span></pre><h2 id="5215" class="nt md it bd me nu nv dn mi nw nx dp mm lh ny nz mo ll oa ob mq lp oc od ms oe bi translated">位置</h2><p id="0d9e" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">来回答“这附近有什么样的地方？”我计算了每个地区位置类型的百分比。下面你会发现图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/4f7b886bbe5c5b3952508790cd25524a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KcFLD_8HMymjK49-FouXFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仓谷附近的地点类型</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/eecd6fb1ac10712863823e0d63736997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvoPVEMeq9YyfUc0ZC_NSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新加坡核心附近的地点类型</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/57030ab4379df74d59d221b229737a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCXDpJ87mQDDUHOHCMD-AA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉隆坡唐人街附近的地点类型</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/15c590e807db2f2e47f304996855c341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5RHKnT7q20C5XXw_G-zpw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京新宿附近的地点类型</p></figure><p id="f67e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">住宿是这里的大赢家。在四个地点中的三个(除了新宿)，住宿类型<em class="oo">的地点是该地区最丰富的，其次是与食品相关的地点。在仓谷，一些地点包括购物、看医生、泡温泉和租车(你看到有多少辆摩托车了吗？！).从新加坡来看，顶级场所也是类似的，但随后酒吧和夜总会会随着情节起舞，而银行和金融网站也会打招呼。</em></p><p id="3f95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，有新宿地区，在我看来是四个地区中最独特的。首先，住宿不是最常见的地点——食物才是，大约有30%的地点。日本食物如此出名和受欢迎是有原因的。</p><p id="57bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我之前没有提到的是，一个位置可以有多种类型。通常，当所讨论的位置有一个通用类型，如<em class="oo">食物</em>时，就会出现这种情况。在这种情况下，通用标签会附带一个粒度更细、更精确的标签。例如，在图中，你可以看到几个与食物有某种联系的类别，例如<em class="oo">外卖</em>、<em class="oo">咖啡馆</em>、<em class="oo">送餐</em>、<em class="oo">超市</em>和<em class="oo">面包店</em>。但是日本不仅仅是食物。他们也对时尚和发型感兴趣。看一下图表，你会发现<em class="oo">美容院</em>和<em class="oo">护发</em>。</p><p id="2ba5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是用于生成该图的代码。注意，首先我将<code class="fe mz na nb nc b">r[‘location_types’]</code>(字典)转换成熊猫数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/642aeb37f9f577d3e4f5ba30a9b6024d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JooAS25cdOj0safSs4C8AA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉隆坡塔。胡安·德·迪奥斯·桑多斯(<a class="ae lu" href="https://www.instagram.com/juandesr/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/juandesr/</a>)的照片</p></figure><h2 id="b16b" class="nt md it bd me nu nv dn mi nw nx dp mm lh ny nz mo ll oa ob mq lp oc od ms oe bi translated">价格水平</h2><p id="e1be" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在是最后一组图表，价格水平。在我的实验中，我发现并不是很多地方都有这样的价格水平。不过，这有点道理。这个属性最常见于<em class="oo">餐馆</em>类型的位置，这种地方人们会指定一个价格级别。</p><p id="423f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，正如我们刚刚看到的，除了新宿的数据外，餐馆只占不到10%的位置。因此，价格水平的样本很小。例如，在新加坡的数据中只有三个价格水平，在仓谷有两个，在吉隆坡没有。另一方面，新宿的餐馆越来越多，所以它恢复了30%的价格。不幸的是，由于缺乏数据，我将只绘制东京的价格水平。将来，我想在<code class="fe mz na nb nc b">Client</code>中添加通过<code class="fe mz na nb nc b">type</code>过滤的选项，这样我们就可以将它传递给API调用来检索特定类型的位置。现在，让我们看看数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2a0efdfe9fccf30527b424f7ae700770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UICAc51GbWx0kxioj5lr5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京新宿地区的物价水平</p></figure><p id="00fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不言自明，对吗？根据这个图表，这个地区的平均价格范围是“2”这如何准确地转化为实际的钱？这有点复杂，需要额外的数据。但是因为我们知道最高价格水平是“4”，我们可以解释和估计价格应该在OK范围内，在像东京这样的地方，价格应该在10到20美元左右。你同意吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b362302eaf6a794d3253b0056bb9ca98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUKZ4y5gzHzG4FPdeMZurw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">东京新宿。胡安·德·迪奥斯·桑多斯(<a class="ae lu" href="https://www.instagram.com/juandesr/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/juandesr/</a>)的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9d29" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">概述</h1><p id="030c" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">有一个很小的机会，至少有一次你问，“这附近有什么样的地方？”我知道我有。为了回答这个问题，我创建了一个名为Places Summarized的小Python库，它使用Google Maps Nearby API来汇总给定位置附近的地点的属性。在本文中，我介绍并总结了这个库。我还展示了一个小的用例，用我在旅行中去过的一些地方作为例子。在这个实验中，我发现，根据评分，仓谷的大多数地方都很不错，如果你需要一个好的发型师，那么新宿就是合适的地方。</p><p id="c6f3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">图书馆还没有在我想要的地方。首先，文档是薄弱的。然后是我之前提到的我想要添加的特性，例如，按类型过滤的机制。在此基础上，我想实现一个方法，将摘要写入JSON文件，另一个方法将其转换为Pandas数据帧。让我们看看进展如何。</p><p id="9e51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，如果你不介意的话，我要出去找那些便宜的餐馆。再见！</p><p id="b4f5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在这里找到图书馆:</p><div class="op oq gp gr or os"><a href="https://github.com/juandes/places-summarized" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">juandes/places-汇总</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">Places Summarized是围绕Google Maps的Places API的一个包装器，它总结了附近位置的属性…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ks os"/></div></div></a></div><p id="dbe5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在本文中使用的完整脚本如下:</p><div class="op oq gp gr or os"><a href="https://github.com/juandes/wanderdata-scripts/blob/master/places-summarized/main.py" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">juandes/wander data-脚本</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">地方总结脚本</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg ks os"/></div></div></a></div><p id="61b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！</p></div></div>    
</body>
</html>