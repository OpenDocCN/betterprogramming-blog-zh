<html>
<head>
<title>How To Create Simple Virtual Audio Interfaces In Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Linux下创建简单的虚拟音频接口</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-simple-virtual-audio-interfaces-in-linux-5e4de6ac53b9?source=collection_archive---------6-----------------------#2022-08-11">https://betterprogramming.pub/how-to-create-simple-virtual-audio-interfaces-in-linux-5e4de6ac53b9?source=collection_archive---------6-----------------------#2022-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e873" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">没有所有开销的音频路由幸福</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e5af61899f03794324185bb23d17b400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kkFEuN1cK2p39UMWhrrRdA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯利·西克玛在<a class="ae ky" href="https://unsplash.com/s/photos/audio?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f5c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">过去在Linux中处理坏的音频驱动程序和设备的笨重日子已经成为过去。如今，有<a class="ae ky" href="https://ubuntustudio.org/" rel="noopener ugc nofollow" target="_blank">的整个发行致力于声音设计和音乐制作</a>。你可以获得最流行的现成发行版，并期望许多音频接口一开始就能正常工作。</p><p id="b223" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当您需要更多的音频路由和连接灵活性时，会发生什么呢？</p><p id="d030" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多大型、复杂的音频框架，如用于Linux的<a class="ae ky" href="https://jackaudio.org/" rel="noopener ugc nofollow" target="_blank"> Jack </a>和<a class="ae ky" href="https://www.freedesktop.org/wiki/Software/PulseAudio/" rel="noopener ugc nofollow" target="_blank"> PluseAudio </a>。这些有这么多可配置的选项和移动部件，它会让你恶心。如果你想做的只是增加一些额外的环回接口，这就有点多余了。另外，你可能会花更多的时间来设置它们，而不是实际创建你需要的界面。</p><p id="d527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探索一种使用许多Linux发行版通用的音频子系统创建虚拟界面的简单方法。<a class="ae ky" href="https://alsa-project.org/wiki/Main_Page" rel="noopener ugc nofollow" target="_blank"> ALSA项目</a>提供了一种直接、简单的方式来管理音频接口和基本配置。让我们试一试。</p><h2 id="16f6" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">基本命令</h2><p id="e8ed" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果你已经熟悉使用默认的ALSA实用程序，你可以跳过。如果您刚接触ALSA或需要复习，请运行这些命令，以便快速识别和管理连接的声音设备。</p><p id="7618" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您还没有安装ALSA实用程序包，您会想先这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9e04" class="lv lw it mu b gy my mz l na nb">sudo apt install alsa-utils</span></pre><p id="da84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来看看几个基本的列表命令。这些命令向您显示操作系统可以看到的连接设备。</p><p id="ebb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显示所有播放设备:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4fda" class="lv lw it mu b gy my mz l na nb">aplay -l</span></pre><p id="6859" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显示所有录制设备:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f28d" class="lv lw it mu b gy my mz l na nb">arecord -l</span></pre><p id="c80e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个命令显示系统上可用的播放和录制设备。这有助于识别设备的名称、硬件ID和通道数量。您还可以在此处检查以确保任何外围设备(尤其是USB接口)都已正确连接。</p><p id="7d19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下命令将显示ALSA的混音面板。这允许您调整输入和输出级别，并对每个设备进行小的配置更改:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1543" class="lv lw it mu b gy my mz l na nb">alsamixer</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/96e06a8baa936720bbe15b3a195bf1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pb2taR52EI7v6dvZGnh1Tw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">alsamixer面板。</p></figure><p id="ac7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经了解了一些基础知识，让我们看看如何实际创建一些环回接口。</p><h2 id="a261" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">加载环回模块</h2><p id="04e5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了创建虚拟环回接口，我们需要将一个特殊的模块加载到ALSA的操作系统中。这个模块叫做<code class="fe nd ne nf mu b">snd-aloop</code>，它允许你发送音频到一个接口的一边，并让它出现在另一边的输出上。这有点像连接两个组件的虚拟音频电缆。</p><p id="5e4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这些虚拟接口，您可以执行更复杂的音频路由。您可以将音频路由到一个接口，该接口将在另一端捕捉或处理声音，或者简单地复制声音。当您可以访问相对无限数量的虚拟接口时，有大量的可能性。</p><p id="297c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用以下命令加载模块:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1766" class="lv lw it mu b gy my mz l na nb">sudo modprobe snd-aloop</span></pre><p id="c26d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果您运行<code class="fe nd ne nf mu b">arecord -l</code>或<code class="fe nd ne nf mu b">aplay -l</code>，您应该会看到以下新增内容:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="949e" class="lv lw it mu b gy my mz l na nb">card 1: Loopback [Loopback], device 0: Loopback PCM [Loopback PCM]<br/>  Subdevices: 7/8<br/>  Subdevice #0: subdevice #0<br/>  Subdevice #1: subdevice #1<br/>  Subdevice #2: subdevice #2<br/>  Subdevice #3: subdevice #3<br/>  Subdevice #4: subdevice #4<br/>  Subdevice #5: subdevice #5<br/>  Subdevice #6: subdevice #6<br/>  Subdevice #7: subdevice #7<br/>card 1: Loopback [Loopback], device 1: Loopback PCM [Loopback PCM]<br/>  Subdevices: 8/8<br/>  Subdevice #0: subdevice #0<br/>  Subdevice #1: subdevice #1<br/>  Subdevice #2: subdevice #2<br/>  Subdevice #3: subdevice #3<br/>  Subdevice #4: subdevice #4<br/>  Subdevice #5: subdevice #5<br/>  Subdevice #6: subdevice #6<br/>  Subdevice #7: subdevice #7</span></pre><p id="5d38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个接口为您提供输入和输出，以便发送和采集音频。列出的第一个设备(<code class="fe nd ne nf mu b">device 0</code>)是您将音频输入路由到的设备。第二个装置(<code class="fe nd ne nf mu b">device 1</code>)是你能从第一个装置听到它的地方。你发送到第一个界面的所有东西都会出现在第二个界面上。</p><p id="fe16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想将音频路由到第一个接口的硬件ID，您应该这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5ce0" class="lv lw it mu b gy my mz l na nb">hw:1,0,0</span></pre><p id="1e8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想引用第二个接口来监听它，您应该这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1ae9" class="lv lw it mu b gy my mz l na nb">hw:1,1,0</span></pre><p id="5748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe nd ne nf mu b">arecord</code>和<code class="fe nd ne nf mu b">aplay</code>来测试这一点，方法是在第一个界面中播放一个WAV文件，并在第二个界面中收听(录制)它。</p><h2 id="efe9" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">自定义环回接口</h2><p id="b2ec" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果您想要创建一对以上的默认环回接口，您可以通过创建一个特殊的配置文件来轻松实现。</p><p id="2806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建下面的文件<code class="fe nd ne nf mu b">/etc/modprobe.d/alsa-loopback.conf</code>并用下面的内容填充它:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c85b" class="lv lw it mu b gy my mz l na nb">option snd-aloop enable=1,1,1,1 index=0,1,2,3</span></pre><p id="49ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建四对独立的环回接口。您可以通过在<code class="fe nd ne nf mu b">enable</code>后添加或删除一个<code class="fe nd ne nf mu b">1</code>并相应地添加<code class="fe nd ne nf mu b">index</code>值来修改已启用接口的数量。</p><p id="f4ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您启用了这个配置，那么确保模块在每次启动时都被加载是一个好主意。</p><p id="d6c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行以下命令以确保<code class="fe nd ne nf mu b">snd-aloop</code>模块在启动时加载:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d35a" class="lv lw it mu b gy my mz l na nb">echo "snd_aloop" &gt; /etc/modules-load.d/snd-aloop.conf</span></pre><p id="b075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，每次重新启动时，您都应该加载带有自定义接口数量的<code class="fe nd ne nf mu b">snd-aloop</code>模块。</p><h2 id="14f3" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">尝试一下</h2><p id="8457" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果你想测试你新发明的虚拟界面，你可以加载你最喜欢的音频应用程序，并选择它们作为输入/输出设备。如果您在命令行上工作，您也可以使用下面的命令来执行测试。</p><p id="4f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你需要测试文件，你可以尝试一些在freesound.org的免费WAV文件。</p><p id="c458" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面将播放一个测试文件到输入环回:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="638e" class="lv lw it mu b gy my mz l na nb">aplay -D hw:1,0,0 test_input.wav</span></pre><p id="a3b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面将把它记录在输出回环之外:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f7be" class="lv lw it mu b gy my mz l na nb">arecord -D hw:1,1,0 -f S16_LE -c 2 -r 48000 test_output.wav</span></pre><p id="c53b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望您现在已经实现了音频路由天堂，而没有实现更复杂的音频服务器框架的所有麻烦。如果你想了解更多关于ALSA的信息，你可以点击这里查看官方文件<a class="ae ky" href="https://alsa-project.org/wiki/Documentation" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="e82b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！看看下面更多的帖子:</p><ul class=""><li id="42e7" class="nn no it lb b lc ld lf lg li np lm nq lq nr lu ns nt nu nv bi translated"><a class="ae ky" href="https://tateg.medium.com/7-github-repositories-with-free-software-tools-and-tips-53ce4aa71003" rel="noopener"> 7个包含免费软件、工具和技巧的GitHub库</a></li><li id="32c8" class="nn no it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><a class="ae ky" href="https://levelup.gitconnected.com/10-common-mistakes-developers-make-when-reviewing-code-81b042c3d642" rel="noopener ugc nofollow" target="_blank">开发人员在审查代码时会犯的10个常见错误</a></li></ul></div></div>    
</body>
</html>