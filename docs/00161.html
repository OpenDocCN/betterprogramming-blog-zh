<html>
<head>
<title>Supercharge your debugging experience for Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">增强Node.js的调试体验</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/supercharge-your-debugging-experience-for-node-js-3f0ddfaffbb2?source=collection_archive---------0-----------------------#2018-07-22">https://betterprogramming.pub/supercharge-your-debugging-experience-for-node-js-3f0ddfaffbb2?source=collection_archive---------0-----------------------#2018-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2d80" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当控制台日志不够用时</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/6431a777499bd7d46199c51cda5352ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*QPv3rvO0JdRsAxAZJ73arg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用节点调试</p></figure><h1 id="9d9d" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">看到这个你会怎么做？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/d285057d81de33109456e3e29d97954b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6ysZ6S1dooVus6IQgy-Gg.png"/></div></div></figure><p id="25c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可能会检查每一行代码，试图找到一个错别字。如果您没有发现拼写错误，您可能会开始使用console.logs来查看代码的输出，这很麻烦。肯定有更好的方法吗？</p><h1 id="277d" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">用控制台日志调试服务器端javascript代码是过时的。</h1><p id="5d16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">控制台日志是不够的。他们要求我们一行一行地慢慢来，每次都重新启动我们的服务器。控制台日志还会用不必要的代码搅乱我们的代码库，删除它们需要付出努力。</p><p id="9cfc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">证据A:在虚拟数据和其他进程中发现控制台日志需要多少能量？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi ms"><img src="../Images/e34f191727fdd9345bfc13e94f6195af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGldRIssNv2IrlT2RyMPtQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">哦，控制台乱糟糟的。我的控制台日志在哪里？</p></figure><p id="3eb4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">非常令人生畏。不一定要这样。</p><p id="3944" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">更有效的方法是用断点进行调试。有了断点，我们可以单步执行调用堆栈和事件循环来诊断问题。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">菲利普·罗伯茨:到底什么是事件循环？JSConf欧盟</p></figure><p id="bb80" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你明白了。是时候探索其他选择了。有哪些选择？很高兴你问了！</p><p id="a9f1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><em class="mv">对了，文末还有一个很好吃的犒劳——(随便说说！).</em></p><h1 id="8a41" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">节点有内置的检查器！</h1><p id="640e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">没错:Node其实有一个<a class="ae mw" href="https://nodejs.org/en/docs/guides/debugging-getting-started/" rel="noopener ugc nofollow" target="_blank">内置的检查器</a>。检查员使用引擎盖下的<a class="ae mw" href="https://chromedevtools.github.io/debugger-protocol-viewer/v8/" rel="noopener ugc nofollow" target="_blank"> v8调试器协议查看器</a>。</p><p id="7e77" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我展示给你看。让我们开始一个新的节点项目:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx mu l"/></div></figure><p id="9e4b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">启动我们的项目并安装express和nodemon:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx mu l"/></div></figure><p id="e2a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们有了一个基本的express服务器。但是我们没有以传统的方式使用<code class="fe my mz na nb b">node server.js</code>命令，而是向节点命令inspector添加了一个额外的标志。</p><p id="23be" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe my mz na nb b">--inspect</code>告诉节点公开新的调试协议。</p><p id="bea1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦我们用inspector启动服务器，控制台输出如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi nc"><img src="../Images/bd380406dff367f4b7b3a77e7d22ffda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32J7CSAzBtm68CwiVS0Ukw.png"/></div></div></figure><p id="1efb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">太好了，成功了！用开发工具打开位于<a class="ae mw" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>的Chrome。注意到额外的东西了吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/06f9df4a5b19e8321ec914aae1e8c7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*2yQvTe6JAo2RA3ikPvmXaw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">请注意移动检查器旁边的节点元素</p></figure><p id="bb52" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们浏览器内部的节点？确实是的！我们仍然像以前一样使用我们的应用程序— <code class="fe my mz na nb b">localhost:3000</code></p><p id="6f4e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe my mz na nb b"><a class="ae mw" href="http://0.0.0.0:9229/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:9229/</a></code>端口供开发工具使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi ne"><img src="../Images/106b24192dd9ee93a72a02585b9ca13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-W3U7eUzBnnDu6dTlx9TnQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">在我们的浏览器中检查服务器端代码</p></figure><h1 id="3143" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">节点检查器是做什么的？</h1><p id="1bf5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">节点检查器允许您将DevTools用户界面与<a class="ae mw" href="https://nodejs.org/docs/latest/api/debugger.html" rel="noopener ugc nofollow" target="_blank">本机节点调试器</a>一起使用。DevTools现在可以直接连接到节点进程了！</p><div class="kj kk kl km gt ab cb"><figure class="nf kn ng nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><img src="../Images/4ecc27483b8f5c662a3a69a4a822e0a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*96kIUeQeiuald7L9hhs3tg.png"/></div></figure><figure class="nf kn nl nh ni nj nk paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><img src="../Images/0f7f69c4ce0398bef38d3d40bebf029f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*QgaoW4G_1s_XzvfDSs0QvA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk nm di nn no translated">【https://nodejs.org/docs/latest/api/debugger.html T4】</p></figure></div><p id="f623" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你知道如何在Firefox或Safari上运行，请在评论中告诉我们。</p><h1 id="ed9f" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">使用调试器</h1><p id="6e65" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用chrome调试器类似于对客户端代码使用调试器。你设置断点，执行代码，跨过断点，找到bug。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi np"><img src="../Images/085447e8d278710e0e4b3791c72c5f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*oJ4fn7Z1cRl0GkHYM1HWCw.gif"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用断点来单步执行我们的代码</p></figure><p id="ac0f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你能想象当我们在一个大控制器中有一个错误时，这有多有用吗？我们可以访问调试器、调用堆栈、作用域、局部变量、全局变量等。我们有这么多锋利的工具可以用！</p><h1 id="f9c8" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">把它带到另一个高度</h1><p id="af8d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还没完呢。2018年7月20日对于调试node来说是一个非常特殊的日子。为什么？</p><p id="6d55" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">谷歌Chrome实验室团队开源了他们的高级调试工具:<a class="ae mw" href="https://github.com/GoogleChromeLabs/ndb" rel="noopener ugc nofollow" target="_blank"> ndb </a>！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi nq"><img src="../Images/4b28d33843e6b8f3e004b14ed06e91f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rWYfeqbUdSshrgdaPk8B1A.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><em class="nr"> ndb是由Chrome DevTools </em>提供的Node.js的改进调试体验</p></figure><p id="c318" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Ndb是一个很好的调试工具。让我们试一试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi ns"><img src="../Images/cac0efaea83c6cc5b99750e3a09524ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXSaqsezWEQKXgbTG05idQ.png"/></div></div></figure><h2 id="822a" class="nt kv it bd kw nu nv dn la nw nx dp le ma ny nz lg me oa ob li mi oc od lk oe bi translated">安装ndb</h2><pre class="kj kk kl km gt of nb og oh aw oi bi"><span id="5eca" class="nt kv it nb b gy oj ok l ol om">npm install -g ndb</span></pre><p id="b1b2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">它就像任何其他npm包一样，易于使用和安装。</p><h2 id="47b1" class="nt kv it bd kw nu nv dn la nw nx dp le ma ny nz lg me oa ob li mi oc od lk oe bi translated">使用</h2><p id="e14b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要使用ndb，我们只需在启动脚本前面加上ndb。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/182392a0a57218356f1d5949202dda27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*wRMJM0VeE43AUwWr_KmOKA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">将ndb附加到我们的启动脚本</p></figure><p id="d8fd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">就是这样！让我们重启我们的服务器——注意我们使用的是nodemon——就像任何传统项目一样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi oo"><img src="../Images/9e73e052f22afbc287077ac4c885c6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1v5zsxhawXXibGeE6MLBGg.gif"/></div></div></figure><p id="b38d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们有一个新的chrome实例，专门用于调试。多酷啊。</p><p id="054f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们甚至可以访问节点<code class="fe my mz na nb b"><a class="ae mw" href="https://nodejs.org/api/process.html" rel="noopener ugc nofollow" target="_blank">process</a></code>全局对象——这是节点的<code class="fe my mz na nb b">window</code>对象。</p><p id="7037" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">关于新调试器的黑客新闻讨论—来看看吧！</p><div class="op oq gp gr or os"><a href="https://news.ycombinator.com/item?id=17581521" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">nd b-node . js的改进调试体验|黑客新闻</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">也就是说，在VSCode和WebStorm中，我不时会看到一些挑剔的问题，比如源地图无法工作…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">news.ycombinator.com</p></div></div></div></a></div><p id="abaf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你想让你的Node技能更上一层楼，我推荐通读《<a class="ae mw" href="https://amzn.to/2Munptt" rel="noopener ugc nofollow" target="_blank"> <em class="mv">用Node和Express进行Web开发:利用JavaScript栈</em> </a>》一书。</p><p id="8944" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">感谢阅读，保持敬畏！❤</p></div></div>    
</body>
</html>