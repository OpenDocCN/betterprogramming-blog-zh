<html>
<head>
<title>How to Connect to Google Sheets With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python连接到Google Sheets</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-connect-to-google-sheets-with-python-83d0b96eeea6?source=collection_archive---------8-----------------------#2017-05-04">https://betterprogramming.pub/how-to-connect-to-google-sheets-with-python-83d0b96eeea6?source=collection_archive---------8-----------------------#2017-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3eaf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用Google Sheets作为应用程序数据存储的一部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6aeb71a319464624529aa5765409c951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*29oYxkRDpQmfkEj4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@goumbik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢卡斯·布拉塞克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="3fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我与一位客户合作，帮助解析数百个PDF文件，为它们分配关键字，以便它们以后可以被搜索到。</p><p id="a711" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">挑战的一部分是知道从哪里下载哪些文件。客户端将每个PDF文件存储在AWS上，它们的特定URL存储在Google Sheets的单元格中。</p><p id="60e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我喜欢Python编程语言。它很容易阅读，并且有大量的库，允许你用它做任何事情。它是你多功能腰带中最完美、最通用的工具。简而言之，Python让你成为蝙蝠侠。</p><p id="88ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来是一个教程，教你如何使用Python来连接自己选择的Google电子表格，以便从所述表格中检索信息。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8e73" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">设置</strong></h1><p id="d179" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">所以为了这个，我用了Python 3.6.3。你可以使用任何你喜欢的版本。据我所知，Python 2.7也支持连接Google Sheets的相关库(<a class="ae ky" href="http://gspread.readthedocs.io" rel="noopener ugc nofollow" target="_blank"> gspread </a>)。</p><p id="f7f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于设置，您可以首先进入您的终端(假设您在OSX)并键入以下内容:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="05bf" class="ne md it na b gy nf ng l nh ni">pip install gspread</span></pre><p id="2ead" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将下载连接到Google sheets所需的库。</p><p id="f66d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您需要从<a class="ae ky" href="https://console.developers.google.com/apis/library" rel="noopener ugc nofollow" target="_blank"> Google的API服务获取您的凭证。</a>在这里，您应该搜索“Google Drive”并执行以下操作:</p><ol class=""><li id="3ff4" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">点击结果。</li><li id="aa6a" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">接受服务条款。</li><li id="b1da" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">创建一个项目。</li><li id="e480" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">创建项目后，单击Enable。</li></ol><p id="e547" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，请遵循以下步骤:</p><ol class=""><li id="fd6b" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">单击左侧导航栏上的“创建凭据”按钮。</li><li id="633b" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">单击新建创建凭据按钮。</li><li id="a3ec" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">选择服务帐户密钥选项。</li><li id="e85e" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">在服务帐户下，选择新服务帐户。</li><li id="41e0" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">给它起个名字。</li><li id="4551" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">选择项目&gt;角色中的所有者。</li><li id="d8e3" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">点击JSON并下载文件。</li></ol><p id="16f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:<strong class="lb iu"> </strong>该文件包含您访问该项目的特定凭证，并且是唯一的副本。请妥善保管此文件。对于这个项目来说，最简单的做法是将这个JSON文件存储在与您的代码相同的目录中。</p><p id="aa05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开JSON文件(可以用自己喜欢的文本编辑器)，复制信息后跟<code class="fe nx ny nz na b">client_email:</code>。</p><p id="887d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一点很重要:使用Python代码访问您希望访问的电子表格，并将其与您从<code class="fe nx ny nz na b">client_email:</code>复制的电子邮件共享。这很重要，因为您需要让您的API凭证访问您的电子表格。</p><p id="2ea5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用以下命令启动您最喜欢的代码编辑器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="b975" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以访问您的电子表格，并且可以使用gspread库中的函数来操纵进出Python的信息。从<a class="ae ky" href="https://github.com/burnash/gspread" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中获取特定的命令来使用这个库。</p><p id="ba33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有任何问题、评论、错误或批评，请告诉我！</p><p id="5776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">玩得开心成为蝙蝠侠与蟒蛇。</p></div></div>    
</body>
</html>