<html>
<head>
<title>Create and Deploy a Face Swap App Using Python and Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Streamlit创建和部署面部交换应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-and-deploy-a-face-swap-app-using-python-and-streamlit-857b4b5b8ea2?source=collection_archive---------1-----------------------#2022-08-23">https://betterprogramming.pub/create-and-deploy-a-face-swap-app-using-python-and-streamlit-857b4b5b8ea2?source=collection_archive---------1-----------------------#2022-08-23</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="394d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">关于如何使用面部交换和StyleGan项目来交换真实面部和虚假面部的教程</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/aa67f711f709e5f720d6678e4f3ea0f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NWbAhyjysujiqchW"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@rhett__noonan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">瑞德·卫斯理</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="1173" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">人工智能和机器学习已经变得非常流行，并为各种目的服务。令人惊讶的是，它们甚至被用来制造假的人！</p><p id="499d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你能想象这个人不存在吗？</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lw"><img src="../Images/47956a99f2a110db6daecbc7a28d9e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joJ6tY4ETdLKthLvWQ2O8g.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来源:由https://this-person-does-not-exist.com/<a class="ae kz" href="https://this-person-does-not-exist.com/en" rel="noopener ugc nofollow" target="_blank">自动生成</a></p></figure><p id="573b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这张照片是由<a class="ae kz" href="https://en.wikipedia.org/wiki/StyleGAN" rel="noopener ugc nofollow" target="_blank"> StyleGAN，</a>一个假人生成器工具生成的。</p><h1 id="2e2b" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">如何利用假人代会？</h1><p id="7f89" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">以下是一些可以考虑的想法:</p><ul class=""><li id="f00c" class="mu mv iu lc b ld le lg lh lj mw ln mx lr my lv mz na nb nc bi translated">你在写一个人工智能算法来区分假脸和真脸。您可以生成任意多的虚拟数据来训练您的模型。</li><li id="4e49" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">你想在网上卖一些你的衣服。如果有人穿这种衣服，广告看起来会更有吸引力。如果你想隐藏你的脸，你可以把它换成一个不存在的脸。</li><li id="0d34" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">你有一个营销活动，想在你的演示文稿中展示一些人。雇个模特是要花钱的。还有，网上有些照片是有版权的。所以，你可以选择一张假照片。</li></ul><p id="ac89" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，您将学习如何:</p><ul class=""><li id="01f8" class="mu mv iu lc b ld le lg lh lj mw ln mx lr my lv mz na nb nc bi translated">使用StyleGan算法生成假的人。</li><li id="48e2" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">使用<a class="ae kz" href="https://github.com/wuhuikai/FaceSwap" rel="noopener ugc nofollow" target="_blank">换脸</a> Python项目轻松换脸。</li><li id="c214" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">使用<a class="ae kz" href="https://share.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>库创建一个简单的Web UI来上传照片和更改面部。</li><li id="f951" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">只需点击几下鼠标，即可将应用部署到<a class="ae kz" href="https://share.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a> Cloud，并与您的朋友分享这个有趣的项目。</li></ul><p id="8c68" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p><h1 id="a4b5" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">技术概述</h1><h2 id="454b" class="ni ly iu bd lz nj nk dn md nl nm dp mh lj nn no mj ln np nq ml lr nr ns mn nt bi translated">StyleGAN快速介绍</h2><p id="af4b" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">StyleGAN是一个开源项目，它使用深度学习算法来生成不同性别和种族组合的人脸的逼真图像。</p><p id="020b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要观看演示，请访问<a class="ae kz" href="https://this-person-does-not-exist.com/en" rel="noopener ugc nofollow" target="_blank">https://this-person-does-not-exist.com</a>页面。它会在你每次刷新页面时生成一个新面孔。</p><p id="956a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要了解更多算法，请查看他们的<a class="ae kz" href="https://github.com/NVlabs/stylegan" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</p><h2 id="8362" class="ni ly iu bd lz nj nk dn md nl nm dp mh lj nn no mj ln np nq ml lr nr ns mn nt bi translated">面部交换快速介绍</h2><p id="72c6" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">Face Swap是一个公共Python项目，可以让你和别人交换脸。它可以用于照片、视频，甚至是直播相机。</p><p id="bad6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你只需要一个源和一个目标图像。代码将生成照片组合的结果。</p><h2 id="08a6" class="ni ly iu bd lz nj nk dn md nl nm dp mh lj nn no mj ln np nq ml lr nr ns mn nt bi translated">简化快速介绍</h2><p id="6981" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">Streamlit是一个开源Python框架，用于在短时间内创建和部署web应用程序。它主要由数据科学家使用。它不需要前端开发经验，因为它的学习曲线很短。</p><h1 id="c225" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">准备项目</h1><p id="435c" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">现在你知道从哪里得到假面了。</p><p id="f06b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这一步，我们将基于源图像和目标图像生成新的人脸。</p><p id="d03f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">执行以下命令来安装面交换要求:</p><pre class="kk kl km kn gu nu nv nw nx aw ny bi"><span id="8007" class="ni ly iu nv b gz nz oa l ob oc">$ git clone <a class="ae kz" href="https://github.com/wuhuikai/FaceSwap.git" rel="noopener ugc nofollow" target="_blank">https://github.com/wuhuikai/FaceSwap.git</a></span><span id="eac3" class="ni ly iu nv b gz od oa l ob oc">$ cd FaceSwap</span><span id="bb8f" class="ni ly iu nv b gz od oa l ob oc">$ python3 -m pip install -r requirements.txt</span></pre><p id="128b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">生成结果图像就像运行以下命令一样简单:</p><pre class="kk kl km kn gu nu nv nw nx aw ny bi"><span id="84f4" class="ni ly iu nv b gz nz oa l ob oc">python3 main.py — src {source.jpg} — dst {target.jpg} — out {result.jpg} — correct_color — no_debug_window</span></pre><p id="4cf4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">参数解释:</p><ul class=""><li id="5c22" class="mu mv iu lc b ld le lg lh lj mw ln mx lr my lv mz na nb nc bi translated"><code class="fe oe of og nv b">--src</code>是源照片的路径。</li><li id="02dd" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><code class="fe oe of og nv b">--dst</code>是目标照片的路径。</li><li id="9edc" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><code class="fe oe of og nv b">--out</code>将是结果照片的路径。</li><li id="12f2" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><code class="fe oe of og nv b">--correct_color</code>努力使照片的颜色尽可能真实。</li><li id="5e7b" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><code class="fe oe of og nv b">--no_debug_window</code>禁用调试窗口。</li></ul><p id="2084" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">脚本输出:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oh"><img src="../Images/a4d0daa2a1bdf372acc63a0e72da0a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKM7J2WZCxq91hnRYVmAEw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">源图由StyleGan提供，目标图由@patrikvelich提供</p></figure><h1 id="76d6" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">部署项目</h1><p id="00c8" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">到目前为止，我们一直在使用终端执行Python脚本来交换面部。如果有一个用户可以上传源照片和目标照片的用户界面就好了。</p><p id="c865" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将使用Streamlit API为原始的Face Swap代码创建一个简单的UI。实现这一点最简单的方法是派生他们的GitHub库并修改<code class="fe oe of og nv b">main.py</code>文件。</p><p id="6623" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了简洁起见，我不打算在这里粘贴原始代码。如果你想看，请查看下面的参考资料部分。</p><p id="2d34" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是修改后的代码:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oi oj l"/></div></figure><p id="742f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">主要变化:</p><ul class=""><li id="c581" class="mu mv iu lc b ld le lg lh lj mw ln mx lr my lv mz na nb nc bi translated">增加了<code class="fe oe of og nv b">streamlit</code>和<code class="fe oe of og nv b">PIL</code>的依赖关系。</li><li id="eb2e" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">使用<code class="fe oe of og nv b">st_uploader</code>为UI创建了浏览按钮。</li><li id="63a9" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">使用<code class="fe oe of og nv b">cv2.cvtColor(numpy.array(source_image), cv2.IMREAD_COLOR)</code>将<code class="fe oe of og nv b">PIL</code>图像转换为<code class="fe oe of og nv b">cv2</code>格式。这是必需的，因为原始代码期望<code class="fe oe of og nv b">cv2</code>。</li><li id="2f45" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated">使用<code class="fe oe of og nv b">st.image(output,width=500)</code>显示图像。</li></ul><p id="c651" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来，修改<code class="fe oe of og nv b">requirements.txt </code>文件，简化部署所需的it:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oi oj l"/></div></figure><p id="7bd0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">登录您的Streamlit账户<a class="ae kz" href="https://share.streamlit.io/" rel="noopener ugc nofollow" target="_blank">https://share.streamlit.io/</a>。</p><p id="8cc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">选择您的应用程序的GitHub repo，然后单击部署:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lw"><img src="../Images/bd45b3d9a0edf5638dc745f04adfa1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zx4O4oMayy-CQBAf2fTAhg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在Streamlit中部署新应用</p></figure><p id="4a90" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">就是这样！</p><p id="dd94" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">部署过程将需要几分钟时间。喝杯咖啡，然后享受你的新应用。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ok"><img src="../Images/4f9ece4ca2ba92e15ff6a866338652c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Ae1qx12cFOxIwO1MvZl46A.gif"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">streamlit上的面部交换演示</p></figure><p id="f216" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">相当令人印象深刻！成绩还不错。注意，为了更好的效果，你应该选择相似的姿势和灯光。如果你想完美的效果，你可以使用你的Photoshop技巧。</p><p id="5385" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">点击分享，与您的朋友分享应用程序。他们可以通过邀请链接在浏览器中试用这款应用。</p><h1 id="bc4c" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">结论</h1><p id="5d37" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">在本教程中，您学习了一种使用Face Swap和StyleGan生成和交换面的简单方法。您还知道如何使用Streamlit部署web应用程序并与其他人共享。</p><p id="12bf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该应用程序的用户界面是最小的演示目的。如果你想让它更有趣，我鼓励你去探索Streamlit的<a class="ae kz" href="https://docs.streamlit.io/library/api-reference" rel="noopener ugc nofollow" target="_blank"> API参考</a>。</p><p id="67b3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望你喜欢这篇文章。感谢您的阅读，下次再见！</p><h1 id="f919" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">参考</h1><ul class=""><li id="99cc" class="mu mv iu lc b ld mp lg mq lj ol ln om lr on lv mz na nb nc bi translated"><a class="ae kz" href="https://github.com/kirshiyin89/FaceSwapWeb" rel="noopener ugc nofollow" target="_blank">我的脸互换GitHub回购</a></li><li id="7f3d" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><a class="ae kz" href="https://github.com/wuhuikai/FaceSwap" rel="noopener ugc nofollow" target="_blank">原脸互换GitHub回购</a></li><li id="fc40" class="mu mv iu lc b ld nd lg ne lj nf ln ng lr nh lv mz na nb nc bi translated"><a class="ae kz" href="https://github.com/NVlabs/stylegan" rel="noopener ugc nofollow" target="_blank"> StyleGan GitHub repo </a></li></ul></div></div>    
</body>
</html>