<html>
<head>
<title>Creating Custom Geometry With Standard Shapes in SceneKit Under SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI下的SceneKit中使用标准形状创建自定义几何体</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-custom-geometry-with-standard-shapes-in-scenekit-under-swiftui-48f38743454f?source=collection_archive---------13-----------------------#2022-05-13">https://betterprogramming.pub/creating-custom-geometry-with-standard-shapes-in-scenekit-under-swiftui-48f38743454f?source=collection_archive---------13-----------------------#2022-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3bf0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">继续我对SceneKit的调查</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fc8a4d53aa102d6db52da8462730afb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TNp8GKwrg9ml8moo3TMMfA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个虚构的星球——一个自定义形状，使用球面作为基础绘制</p></figure><p id="2a1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不久前，我写了一篇关于Swift算法库的<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/8-algorithms-destined-for-the-standard-library-in-swift-d5a407ae625a">文章</a>。苹果开发的一套代码原语，嗯，有一天可能会成为核心的Swift语言。这些实现可能是比你我有时间精心制作的代码更好的代码。像堆栈和双端数组这样的数据结构——你应该使用而不是重新发明代码。</p><p id="81ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，我想继续探索自定义几何网格和形状，即重用苹果已经编写的代码，尽管可能与Swift算法库略有不同。</p><p id="f109" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，在SceneKit中，你可以构建六个预定义的形状，比如<code class="fe lv lw lx ly b">SCNSphere</code>、<code class="fe lv lw lx ly b">SCNCylinder</code>和<code class="fe lv lw lx ly b">SCNBox</code>。他们都很好，但有时你想要/需要更多。</p><p id="4d0a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，通过在您的自定义几何体中使用这些预定义的形状，您可能会变得更容易一些——和我一起看看如何使用SceneKit来构建您的模型的基本框架，然后在以后添加到它。请注意，我计划使用本月早些时候在本文中发表的createGeometry例程。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="787d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和以前一样，我想从一些代码开始，通过扩展提取顶点模板来构建给定的形状。提前为这段代码道歉，它与其他一些scene kit snip-let一样，看起来属于计算机科学类。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为Swift 5.5从对象的几何图形中返回顶点的扩展</p></figure><p id="58c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在几个音符；正如我说的，这是一个模板，所以在标准对象的情况下，我得到的是1x1x1的东西，不管我放进去的是什么大小。</p><p id="e42a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使结果更加实用，我添加了代码来潜在地增加模板的大小。这是我在SceneKit中作为自定义对象重新导入和重绘的数据的图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/26cec2e8de905c92ff35981d9c998d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_X6m5F1GsGcSGZfxxXF2ow.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从SceneKit中计算的顶点构造的自定义球体</p></figure><p id="2c7d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">澄清一下，我没有计算这个球体的顶点。SceneKit做了所有的计算。我只是提取它们，然后用它们来构建你在这里看到的自定义球体。将所有这些放在一起的代码如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="6675" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您运行这段代码并仔细观察，您可能会注意到一些奇怪的事情，您得到了超过600个顶点；它有625——超过600的顶点形成这个形状。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5ad15c99a71486aa05d7628a2d1d84f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WsxeQxzOtthpIF33u8D4MA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您将在球体集中找到其他数据</p></figure><p id="0d1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">bon——现在你可能会问，在这一点上我们要做什么。毕竟，我所做的不仅仅是简单地做了一件我本可以用线条材料更难完成的工作。所以和我一起去找点乐子。假设您有了坐标，在重建几何图形之前，通过添加以下行代码来修改其中的一些坐标—</p><pre class="kj kk kl km gt mi ly mj mk aw ml bi"><span id="1118" class="mm mn it ly b gy mo mp l mq mr"><strong class="ly iu">if</strong> vectors![i].y &gt; 1.5 || vectors![i].y &lt; -1.5 || vectors![i].x &gt; 1.5 || vectors![i].x &lt; -1.5 {</span><span id="c6c8" class="mm mn it ly b gy ms mp l mq mr"><strong class="ly iu">let</strong> newVector = <strong class="ly iu">SCNVector3</strong>(vectors![i].x * 1.1, vectors![i].y * 1.1, vectors![i].z * 1.1)</span><span id="906f" class="mm mn it ly b gy ms mp l mq mr">vectors![i] = newVector<br/>}</span></pre><p id="82ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后你会得到这个——宇宙岩石形状。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4bd11e8d5b60e65ea25d770b9339e37b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*v4KWySlHY2FB7Cy-u_qruQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一组改变的球体</p></figure><p id="7dfe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，你可以享受几个小时的乐趣；尝试一下——添加这段代码使顶点数量翻倍，并尝试一下我在这篇文章<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/build-a-mesh-using-custom-geometry-in-scenekit-under-swiftui-44cadaa3727d">中展示的魔山代码。</a></p><p id="73d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，600个顶点并不算多，用这段简短的代码将它们翻倍。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="56c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">产生这种情况的代码——不，我不太清楚内核发生了什么——我让您去研究。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0907d0aa906cc67140b858e0a9991596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*u60s60HT2MpC0S7U4ji-yg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个有更多顶点的球体集合，这次是我计算的[使用SCNSphere作为模板]</p></figure><p id="0004" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事实上，你也可以对经线做同样的事情，但是说够了——真正的乐趣开始于你不使用线，而是弄清楚如何使用三角形。</p><pre class="kj kk kl km gt mi ly mj mk aw ml bi"><span id="27d8" class="mm mn it ly b gy mo mp l mq mr">for i in stride(from: 0, to: 3600, by: 1) {<br/>  indices.append(Int32(i + 0))<br/>  indices.append(Int32(i + 1))<br/>  indices.append(Int32(i + 25))</span><span id="2133" class="mm mn it ly b gy ms mp l mq mr">  indices.append(Int32(i + 1))<br/>  indices.append(Int32(i + 26))<br/>  indices.append(Int32(i + 25))<br/>}</span></pre><p id="3fdc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以创造一个充满神奇山脉的星球。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ee7efc893c976160bbdfd07aa9a2e3c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WFhrLGPBpALgECWTcLr2KA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">覆盖着三角形和魔山的球体</p></figure><p id="9421" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着“fait au complet”改变我们的几何着色方法，根据土地的高度改变颜色。我这样做是因为这篇文章中的图片。</p><p id="ae99" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，这并不完美——要达到这一点，你需要更加努力，更加努力地匹配边缘，这是这篇<a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/build-a-mesh-using-custom-geometry-in-scenekit-under-swiftui-44cadaa3727d">论文</a>中描述的任务。</p><p id="4cb0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有这些都让我想到了这篇短文的结尾。希望你觉得有用。尝试一些其他形状，尝试鬼混的颜色和顶点返回…这是一个真正的兔子洞。</p></div></div>    
</body>
</html>