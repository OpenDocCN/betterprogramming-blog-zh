<html>
<head>
<title>How To Replace Your Python For Loops with Map, Filter, and Reduce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Map、Filter和Reduce替换Python For循环</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-replace-your-python-for-loops-with-map-filter-and-reduce-c1b5fa96f43a?source=collection_archive---------0-----------------------#2019-12-14">https://betterprogramming.pub/how-to-replace-your-python-for-loops-with-map-filter-and-reduce-c1b5fa96f43a?source=collection_archive---------0-----------------------#2019-12-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dd70" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用函数式编程编写更多语义代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7d4c57d5d44f28fce055a4c30716d4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*73oXq1pNNQoEUd9pOq4jXA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@fatosi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">法托斯Bytyqi </a>在<a class="ae ky" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你曾经看过你的代码，看到一个for循环的瀑布吗？你是否发现自己不得不眯着眼睛，靠向显示器才能看得更清楚？</p><p id="1a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我知道我有。</p><p id="4730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">For循环是解决问题的瑞士军刀，但是，当扫描代码来快速阅读您所做的事情时，它们可能会让人不知所措。</p><p id="c046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">三种技术——map、filter和reduce——通过提供描述<em class="lv">为什么</em>要迭代的功能替代方案，帮助治疗for循环狂躁症。我<a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">以前写过</a>关于用JavaScript开始使用这些技术，但是用Python实现略有不同。</p><p id="45f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将简要介绍这三种技术，强调它们在JavaScript和Python中的语法差异，然后举例说明如何转换常见的for循环。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2093" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">什么是映射、过滤和减少？</h1><p id="2be6" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">回顾我以前编写的代码，我意识到在95%的时间里，当循环字符串或数组时，我会执行下列操作之一:<strong class="lb iu">将一系列语句映射到每个值，<strong class="lb iu">过滤满足特定标准的值，或者<strong class="lb iu">将数据集减少为单个聚合值。</strong></strong></strong></p><p id="7001" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这种认识，这三种方法就是识别和实现，您循环遍历iterable的原因通常属于这三种功能类别之一:</p><ul class=""><li id="5918" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><strong class="lb iu">映射</strong>:对每个项目应用相同的一组步骤，存储结果。</li><li id="6924" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu">过滤器</strong>:应用验证标准，存储评估为真的项目。</li><li id="bc3e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><strong class="lb iu"> Reduce </strong>:返回一个在元素间传递的值。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="dc16" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">是什么让Python映射/过滤/还原与众不同？</h1><p id="c841" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在Python中，这三种技术以函数的形式存在，而不是数组或字符串类的方法。这意味着你应该写<code class="fe no np nq nr b">map(function, my_list)</code>而不是写<code class="fe no np nq nr b">my_array.map(function)</code>。</p><p id="fd65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，每种技术都需要传递一个函数，该函数将为每个项目执行。通常，该函数被编写为匿名函数(在JavaScript中称为粗箭头函数)。然而，在Python中，你经常会看到使用lambda表达式。</p><p id="e69a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">lambda表达式和arrow函数之间的语法实际上非常相似。将<code class="fe no np nq nr b">=&gt;</code>替换为<code class="fe no np nq nr b">:</code>，并确保使用关键字<code class="fe no np nq nr b">lambda</code>，其余内容几乎相同。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="b981" class="nw me it nr b gy nx ny l nz oa">// JavaScript Arrow Function<br/>const square = number =&gt; number * number;</span><span id="4e4c" class="nw me it nr b gy ob ny l nz oa">// Python Lambda Expression<br/>square = lambda number: number * number</span></pre><p id="fe1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">arrow函数和lambda表达式之间的一个关键区别在于，arrow函数能够扩展为具有多个语句的完整函数，而lambda表达式则限于返回的单个表达式。因此，当使用<code class="fe no np nq nr b">map()</code>、<code class="fe no np nq nr b">filter()</code>或<code class="fe no np nq nr b">reduce()</code>时，如果需要对每个项目执行多个操作，首先定义您的功能，然后包括它。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="00af" class="nw me it nr b gy nx ny l nz oa">def inefficientSquare(number):<br/>   result = number * number<br/>   return result</span><span id="6a34" class="nw me it nr b gy ob ny l nz oa">map(inefficientSquare, my_list)</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a84a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">替换为循环</h1><p id="be3f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">好了，言归正传。以下是将由map、filter和reduce替换的循环的三个常见示例。我们的编程提示:计算列表中奇数的平方和。</p><p id="b48f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，这个例子用basic for循环。注意:这纯粹是为了演示，甚至可以在没有map/filter/reduce的情况下进行改进。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="5519" class="nw me it nr b gy nx ny l nz oa">numbers = [1,2,3,4,5,6]<br/>odd_numbers = []<br/>squared_odd_numbers = []<br/>total = 0</span><span id="28e6" class="nw me it nr b gy ob ny l nz oa"># filter for odd numbers<br/>for number in numbers:<br/>   if number % 2 == 1:<br/>      odd_numbers.append(number)</span><span id="94bf" class="nw me it nr b gy ob ny l nz oa"># square all odd numbers<br/>for number in odd_numbers:<br/>   squared_odd_numbers.append(number * number)</span><span id="d116" class="nw me it nr b gy ob ny l nz oa"># calculate total<br/>for number in squared_odd_numbers:<br/>   total += number</span><span id="a65c" class="nw me it nr b gy ob ny l nz oa"># calculate average</span></pre><p id="60a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将每个步骤转换为以下函数之一:</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="6d74" class="nw me it nr b gy nx ny l nz oa">from functools import reduce</span><span id="fd9a" class="nw me it nr b gy ob ny l nz oa">numbers = [1,2,3,4,5,6]</span><span id="878a" class="nw me it nr b gy ob ny l nz oa">odd_numbers = filter(lambda n: n % 2 == 1, numbers)</span><span id="4725" class="nw me it nr b gy ob ny l nz oa">squared_odd_numbers = map(lambda n: n * n, odd_numbers)</span><span id="a954" class="nw me it nr b gy ob ny l nz oa">total = reduce(lambda acc, n: acc + n, squared_odd_numbers)</span></pre><p id="053c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几个重要的语法点需要强调。</p><ul class=""><li id="19ae" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><code class="fe no np nq nr b">map()</code>和<code class="fe no np nq nr b">filter()</code>均为本地提供。但是，必须从Python 3+中的<code class="fe no np nq nr b">functools</code>库导入<code class="fe no np nq nr b">reduce()</code>。</li><li id="20f7" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">lambda表达式是所有三个函数中的第一个参数，而iterable是第二个参数</li><li id="71a2" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe no np nq nr b">reduce()</code>的lambda表达式需要两个参数:累加器(传递给每个元素的值)和单个元素本身。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="0d72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">最美好的祝愿正在远离堆积如山的for循环。重要的是要记住for循环确实在代码中有一席之地，但扩展工具包绝不是坏事。</em></p></div></div>    
</body>
</html>