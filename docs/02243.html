<html>
<head>
<title>What is the Chain of Responsibility Design Pattern?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是责任链设计模式？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-chain-of-responsibility-design-pattern-ff4d22abd124?source=collection_archive---------3-----------------------#2019-11-16">https://betterprogramming.pub/what-is-chain-of-responsibility-design-pattern-ff4d22abd124?source=collection_archive---------3-----------------------#2019-11-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a47" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将发送方与接收方分离，使您的代码更加灵活</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a26268ae1d41d861f98a18afb97c3249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEPUmliXjDylz_ql1HfKkQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">何塞·丰塔诺在<a class="ae ky" href="https://unsplash.com/s/photos/chain?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="0110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">责任链使得请求的发送者独立于接收者。请求可以传递给多个连续的类，这些类可以处理或验证数据，并将其进一步传递给最终的处理程序。</p><p id="c91c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个处理程序都有定制的逻辑，但是共享一个公共接口，所以处理程序可以互换使用，它们的数量和顺序可以在运行时定义。</p><p id="0cc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用责任链的一个常见例子是一组处理传入HTTP请求的请求中间件。根据配置的不同，我们可能会检查用户的凭证、HTTP头或请求体。</p><p id="bf59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有些路由可能是公开的，我们将只使用基本验证，但有些路由应该只对管理员可用，并经过彻底验证。</p><p id="815a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">责任链给了我们很大的灵活性，如果我们的请求不满足其中一个需求，它允许快速失败。让我们看看这样的场景是如何实现的。</p><p id="9c8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们正在创建一个微型API，它将只处理<code class="fe lv lw lx ly b">GET</code>请求并检查用户的API密钥。</p><p id="5893" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API验证是一个更复杂的任务，因为它可能需要数据库查询，所以我们将从一个简单的HTTP动词检查开始，只有当它成功时，我们才会进一步进行。</p><p id="42f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个中间件必须共享相同的接口。它由数据处理和设置可选后继者的方法组成。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="bf51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们正在处理通过<code class="fe lv lw lx ly b">Request</code>公开的数据。它允许访问来自<code class="fe lv lw lx ly b">$_GET</code>和<code class="fe lv lw lx ly b">$_SERVER</code>超级全球的数据。在现实生活中，我们不应该直接操作它们，但是为了简单起见，我们将省略任何数据清理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="1187" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">GetMiddleware</code>将使用关于收到的请求类型的数据。如果我们收到的不是<code class="fe lv lw lx ly b">GET</code>，我们应该抛出一个错误并中断执行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="bf0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了检查用户是否发送了正确的API密钥，我们需要从<code class="fe lv lw lx ly b">$_GET</code>访问数据。为了简单起见，允许的键被硬编码到类中，但是在实际的应用程序中，我们将为此使用外部数据源。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="b168" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的中间件已经准备好了，所以现在我们必须把它们放在一起，看看结果。所有请求都将由<code class="fe lv lw lx ly b">App</code>处理，如果验证成功，客户端将收到样本响应。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="8423" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Response</code>显示短消息，以JSON的形式发送<code class="fe lv lw lx ly b">GET</code>参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="fced" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常简单的例子，但是可以看出添加或删除中间件非常简单。</p><p id="6767" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每一个都是完全独立的，可以单独开发和使用。责任链可能是一个非常强大的工具，有助于使应用程序更加灵活，耦合性更低。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="c836" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">想用就用吧</h1><ul class=""><li id="07d7" class="na nb it lb b lc nc lf nd li ne lm nf lq ng lu nh ni nj nk bi translated">将发送方和接收方分离。</li><li id="92da" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">对数据处理或验证使用动态规则。</li><li id="bdf6" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">以特定的顺序处理请求。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="bcc1" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">优势</h1><ul class=""><li id="16b5" class="na nb it lb b lc nc lf nd li ne lm nf lq ng lu nh ni nj nk bi translated">控制处理顺序。如果一些简单的规则没有得到满足，我们可以很快失败，并避免更复杂的检查。</li><li id="35a8" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">分离每个处理者的责任更容易(单一责任原则)。</li><li id="74a5" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">在不修改现有规则的情况下添加新规则更容易(开放/封闭原则)。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="f333" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">不足之处</h1><ul class=""><li id="b9fe" class="na nb it lb b lc nc lf nd li ne lm nf lq ng lu nh ni nj nk bi translated">它会使应用程序过于复杂。它不应与简单逻辑或单个处理程序一起使用。</li><li id="5f5c" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">在某些情况下，调试可能会更加困难。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="2c88" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">源代码</h1><p id="90cd" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">完整的源代码和其他一些模式可以在这里找到:</p><div class="nt nu gp gr nv nw"><a href="https://github.com/jkapuscik2/design-patterns-php" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">jkapuscik 2/设计-模式-php</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">这个项目是一组在现实世界中使用不同设计模式的简单例子。每个人都有一个…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="d53d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想了解一些更有用的设计模式，您可以在以下文章中找到它们:</p><ul class=""><li id="7c53" class="na nb it lb b lc ld lf lg li ol lm om lq on lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/getting-started-with-design-patterns-in-php-4d451ccdfb71" rel="noopener">工厂法</a></li><li id="40e5" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/creational-design-patterns-in-php-db365d3245ce" rel="noopener">创作模式</a></li><li id="e98c" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/observer-pattern-in-php-2ba240f89fb2" rel="noopener">观察者</a></li><li id="31d7" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/iterator-pattern-in-php-b7624f6bdbcf" rel="noopener">迭代器</a></li><li id="d6cd" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/state-strategy-design-patterns-by-example-f57ebd7b6211" rel="noopener">状态&amp;策略</a></li><li id="018b" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/template-method-pattern-in-php-6116fd7e8ccc?source=friends_link&amp;sk=ac4c483446bd5a5323c09a662bd54116" rel="noopener">模板方法</a></li><li id="215c" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/swlh/flyweight-design-pattern-in-php-edcda0486fb0?source=friends_link&amp;sk=a0fa3083d5afd7e41af8a4f7a1df05f1" rel="noopener">飞锤</a></li><li id="03c1" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/better-programming/proxy-design-pattern-and-how-to-use-it-acd0f11e5330" rel="noopener">代理</a></li><li id="8cb0" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/better-programming/decorator-c04fae63dfff" rel="noopener">装饰工</a></li><li id="37ec" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/better-programming/dependency-injection-8f09a93ec995" rel="noopener">依赖注入</a></li><li id="98c1" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/swlh/composite-908878748d0e" rel="noopener">复合</a></li><li id="e915" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/swlh/building-cloud-storage-application-with-adapter-design-pattern-8b0105a1bda7" rel="noopener">适配器</a></li><li id="247d" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-is-facade-design-pattern-67cb09ce35d4" rel="noopener">立面</a></li><li id="8797" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-is-bridge-design-pattern-89bfa581fbd3" rel="noopener">桥梁</a></li><li id="c1cb" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/what-is-visitor-design-pattern-8451fb75876" rel="noopener">访客</a></li><li id="01f8" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/what-is-cqrs-command-design-pattern-5d400fd9f93a" rel="noopener">命令</a></li><li id="0324" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/what-is-null-object-design-pattern-f3b4d3d28636" rel="noopener">空对象</a></li><li id="73c1" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/what-is-the-fluent-interface-design-pattern-2797645b2a2e" rel="noopener">流畅的界面</a></li><li id="31c0" class="na nb it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><a class="ae ky" href="https://medium.com/@j.kapuscik2/what-is-the-specification-design-pattern-4051dd9e71c3" rel="noopener">规格</a></li></ul></div></div>    
</body>
</html>