<html>
<head>
<title>The Good and Bad Sides of Redux-form</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">叠字的好与坏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/good-and-bad-sides-of-redux-form-7a105a3c5b29?source=collection_archive---------2-----------------------#2019-10-01">https://betterprogramming.pub/good-and-bad-sides-of-redux-form-7a105a3c5b29?source=collection_archive---------2-----------------------#2019-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dd30" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">验证变得简单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/949032d98587e37c0938b1370b944260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfjvR5gGFIQAluxjBMBq-Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·施诺布里奇在<a class="ae ky" href="https://unsplash.com/s/photos/computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="078d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我面临创建一个表单时，我想知道如何实现它。我可以通过在状态中存储数据来创建输入。但是，当我们不得不处理验证时，我们应该怎么办呢？</p><p id="67e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个很好的观点。我听说过一些像<code class="fe lv lw lx ly b">redux-form</code>这样的图书馆。Redux-form使用<code class="fe lv lw lx ly b">Redux</code>来存储输入值。有点奇怪。我开始怀疑，为了将输入值保存到应用程序状态中，这样做是否值得。然而，<code class="fe lv lw lx ly b">redux-form</code>的基本实现很简单。经过深思熟虑，我决定使用它。</p><p id="bf3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Redux-form</code>使用Redux存储输入值和<a class="ae ky" href="https://reactjs.org/docs/higher-order-components.html" rel="noopener ugc nofollow" target="_blank">高阶分量</a>。React form组件通过以下方式与您的Redux store连接:</p><ul class=""><li id="eac7" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">Redux Reducer:<code class="fe lv lw lx ly b">formReducer</code>—告诉如何根据来自应用程序的更改来更新Redux存储的函数</li><li id="7397" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">react HOC<code class="fe lv lw lx ly b">reduxForm()</code>—接受配置对象并返回新函数的函数</li><li id="439b" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">&lt;Field /&gt;</code>组件——位于包装好的<code class="fe lv lw lx ly b">form</code>组件内部的组件。</li></ul><p id="83a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我展示一下我们如何使用<code class="fe lv lw lx ly b">redux-form</code>:</p><p id="0c00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，您应该安装<code class="fe lv lw lx ly b">redux-form</code>、<code class="fe lv lw lx ly b">redux</code>和<code class="fe lv lw lx ly b">react-redux</code>:</p><pre class="kj kk kl km gt mn ly mo mp aw mq bi"><span id="6161" class="mr ms it ly b gy mt mu l mv mw">npm install redux react-redux redux-form --save</span></pre><p id="9556" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该将<code class="fe lv lw lx ly b">formReducer</code>传递给你的商店来处理来自表单组件的动作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="07fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以在Redux中存储表单值。接下来，我们应该创建一个使用<code class="fe lv lw lx ly b">redux-form</code>的表单，并将其命名为<code class="fe lv lw lx ly b">UserForm.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="d05a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该在我们的<code class="fe lv lw lx ly b">UserForm</code>中添加<code class="fe lv lw lx ly b">Field</code>组件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="f319" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">&lt;Field /&gt;</code>组件将每个输入连接到存储并创建一个<code class="fe lv lw lx ly b">&lt;input/&gt;</code>元素。还会通过<code class="fe lv lw lx ly b">value</code>、<code class="fe lv lw lx ly b">onChange</code>、<code class="fe lv lw lx ly b">onBlur</code>等附加道具。所以我们可以使用这个表单组件。一看就很容易。</p><p id="b6e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们应该改进并使用表单验证。让我们为redux-form创建<code class="fe lv lw lx ly b">formValidations.js</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="8c56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们有一个简单的required输入验证。此外，我们可以为任何输入创建许多验证。如果我们有一个复杂的组件给<code class="fe lv lw lx ly b">Field</code>呢？在这种情况下，我们应该为任何情况创建一个<code class="fe lv lw lx ly b">FormItem.js</code>组件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="9499" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只创建了一个输入组件。另一方面，您可以开发您想要的各种组件(<code class="fe lv lw lx ly b">renderTextarea</code>、<code class="fe lv lw lx ly b">renderSelect</code>等)。).有时我们的项目中有<code class="fe lv lw lx ly b">horizontal</code>和<code class="fe lv lw lx ly b">vertical</code>表单。在这种情况下，我们可以用一个神奇的<code class="fe lv lw lx ly b">render</code>函数来实现它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="c0e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要显示验证错误:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="cad5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们的<code class="fe lv lw lx ly b">UserForm.js</code>将是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="286d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它绝对是易于阅读和可重复使用的。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="4079" class="ng ms it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">好的方面</h1><h2 id="cbf8" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">易于开发</strong></h2><p id="b1a0" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">正如我上面提到的，您应该只使用Redux-form字段并用HOC包装您的表单。就是这样。你的替身已经准备好了。</p><p id="04da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们可以为表单字段开发输入组件并重用它们。</p><h2 id="64ac" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">验证</strong></h2><p id="f830" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">Redux-form是一个非常棒的验证库。您可以简单地为不同的情况开发许多验证。因此，它提供了验证功能来一次验证表单中的所有值。您还可以为每个字段或FieldArray提供单独的值验证函数。此外，您可以只为应用程序定义一次验证函数，并根据需要在表单中重用它们。很舒服。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="850f" class="ng ms it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated"><strong class="ak">坏边</strong></h1><h2 id="a2c1" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">在Redux中存储表单状态</strong></h2><p id="5ccf" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">第一个问题:Redux是什么？根据它的文档，Redux是JavaScript应用程序的可预测状态容器。换句话说，Redux帮助你存储和管理全球app数据。我们可以以可伸缩的方式将模型逻辑从视图中分离出来。</p><p id="5152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的情况下，我们在表单上使用受控输入组件，我们的表单应该立即提供反馈，因为您需要向用户显示更改。</p><p id="a018" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如丹·阿布拉莫夫所说:</p><blockquote class="on oo op"><p id="caac" class="kz la oq lb b lc ld ju le lf lg jx lh or lj lk ll os ln lo lp ot lr ls lt lu im bi translated">对短暂的状态使用React，这种状态对应用程序没有全局影响，并且不会以复杂的方式变异。例如，某个UI元素中的切换、表单输入状态。对全局重要的或以复杂方式变化的状态使用Redux。例如，缓存的用户或帖子草稿。</p></blockquote><p id="f5a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于全局应用数据，我们应该使用Redux。我不确定对临时表单数据使用Redux。当您键入时，您必须存储和修改每个击键，并且每当一个字段被触摸、为空或包含不正确的值时，您必须跟踪所有的字段值。看起来很奇怪。您可能会问自己，“我应该在Redux中存储所有表单状态吗？”</p><h2 id="3878" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">性能</strong></h2><p id="a8b4" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">性能是发展中最重要的一点。但是当使用Redux时，每个小的表单状态更新都要经历一个完整的Redux周期。每一次击键都要花费我们重新渲染整个应用程序的成本。太费时间了。它将用户界面冻结了几毫秒，这对用户来说完全是显而易见的。当然，如果你不喜欢牺牲你的应用程序的性能，这是一个大问题。</p><p id="250d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的表单有一个更复杂的模型或多步向导，那么在redux-form存储中管理它会困难得多。</p><h2 id="ecd3" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">可用性</strong></h2><p id="e3ce" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">考虑以下示例计算:</p><pre class="kj kk kl km gt mn ly mo mp aw mq bi"><span id="1510" class="mr ms it ly b gy mt mu l mv mw">const total = price + tips;</span></pre><p id="fd3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，价格和小费值存储在redux中。你必须从redux-form获得价格和小费，并进行计算。之后用dispatch更改redux中的合计。很不舒服。此外，如果您想动态地更改redux-form中的字段值或类型，您将会有很大的困难。</p><h2 id="5b1b" class="mr ms it bd nh nx ny dn nl nz oa dp np li ob oc nr lm od oe nt lq of og nv oh bi translated"><strong class="ak">问题</strong></h2><p id="7389" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">Redux-form在GitHub中还有进一步的问题。让我展示给你看:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/24defce7006ce2b64052cb28cd011679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QH_z9CwZZLZHPvGbDtUVYA.png"/></div></div></figure><p id="56f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个图书馆有441期开放的期刊，其中许多是旧的。太悲伤了。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="992a" class="ng ms it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated"><strong class="ak">结论</strong></h1><p id="52a7" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">Redux-form是一个非常好的处理简单表单和验证的库。看起来Redux-form只是为了验证而创建的。可惜，生活没那么容易。当你有复杂的表单时，它们会变得太复杂，你会在表现上遇到麻烦。但是我们有很多处理表单的库。我想在下一篇文章中与您分享来自 libs的<a class="ae ky" href="https://itnext.io/is-react-hook-form-the-future-57c6f94a2665" rel="noopener ugc nofollow" target="_blank"> React Hook。这真是一个伟大的解放。去吧。</a></p><p id="f349" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有用。</p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><h1 id="b3b5" class="ng ms it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">资源</h1><ul class=""><li id="2cb5" class="lz ma it lb b lc oi lf oj li ov lm ow lq ox lu me mf mg mh bi translated"><a class="ae ky" href="https://matwrites.com/redux-form-is-dead/" rel="noopener ugc nofollow" target="_blank"> Redux-form已死</a></li><li id="b25d" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://goshakkk.name/should-i-put-form-state-into-redux/" rel="noopener ugc nofollow" target="_blank">是否应该将表单状态存储在Redux中？</a></li><li id="54d4" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://redux-form.com/8.2.2/" rel="noopener ugc nofollow" target="_blank">还原形式</a></li><li id="9b09" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/@ron.dadon/stop-using-redux-to-handle-form-state-a953e43818da" rel="noopener">停止使用Redux处理表单状态</a></li><li id="4faf" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://www.gistia.com/beginners-guide-redux/" rel="noopener ugc nofollow" target="_blank">Redux初学者指南</a></li></ul></div></div>    
</body>
</html>