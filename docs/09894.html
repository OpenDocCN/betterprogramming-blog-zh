<html>
<head>
<title>7 Advanced Usages of TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript的7种高级用法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/7-advanced-usages-of-typescript-f9abb0dd64ff?source=collection_archive---------1-----------------------#2021-10-27">https://betterprogramming.pub/7-advanced-usages-of-typescript-f9abb0dd64ff?source=collection_archive---------1-----------------------#2021-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="acfd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">您是否编写了大量冗余类型的代码？以下是一些高级功能。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1e042439716e58a53572b78fb3e0e9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_C2B0atVHIlHbjPXvwT5Ew.png"/></div></div></figure><p id="bba5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不管你相不相信，仍然有一些高级开发人员不知道TypeScript。如果你不知道它是什么，先看看官方入门。</p><p id="3e93" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文主要介绍TypeScript的高级用法。</p><h1 id="9434" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">无商标消费品</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="ed14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe ml mm mn mo b">any</code> <strong class="kw iu">，</strong> <em class="mp">并不是一个好的做法，要不惜一切代价避免。在大多数情况下，泛型是有益的。看看上面的片段。您可以将<code class="fe ml mm mn mo b">User</code>转换为响应，其类型如下所示:</em></p><pre class="kj kk kl km gt mq mo mr ms aw mt bi"><span id="c65b" class="mu ls it mo b gy mv mw l mx my">{<br/>  item?: {<br/>    id: string<br/>  };<br/>  items?: {<br/>    id: string<br/>  }[];<br/>}</span></pre><h1 id="5994" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Keyof类型运算符</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="ae1d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了<code class="fe ml mm mn mo b">keyof</code>，你就不必为<code class="fe ml mm mn mo b">onChange</code>中的<code class="fe ml mm mn mo b">key</code>使用一个<a class="ae lq" href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#union-types" rel="noopener ugc nofollow" target="_blank">联管节类型</a>。<code class="fe ml mm mn mo b">expiryDateTime</code>还将检查密钥是否存在。</p><p id="21c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你试着做这样的事情:</p><pre class="kj kk kl km gt mq mo mr ms aw mt bi"><span id="c1e3" class="mu ls it mo b gy mv mw l mx my">type Foo = { bar: number } &amp; ExpiryDateTime</span><span id="6740" class="mu ls it mo b gy mz mw l mx my">const onChange = (<br/>  key: keyof Foo,<br/>  val: number<br/>): void =&gt; {<br/>  expiryDateTime[key] = val<br/>}</span></pre><p id="5729" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ml mm mn mo b">expiryDateTime</code>下面会有一条红线告诉你<code class="fe ml mm mn mo b">Property 'bar' does not exist on type 'ExpiryDateTime'</code>。如果用<code class="fe ml mm mn mo b">string</code>代替<code class="fe ml mm mn mo b">key</code>，也会出现同样的错误</p><p id="6921" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ml mm mn mo b">keyof</code>在重构时帮你。如果你使用联合类型，那么你需要做双重工作。</p><h1 id="1aad" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Typeof类型运算符</h1><p id="55c6" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated"><code class="fe ml mm mn mo b">typeof</code>允许你从变量中提取类型。与JavaScript的<code class="fe ml mm mn mo b">typeof</code>不同，TypeScript的<code class="fe ml mm mn mo b">typeof</code>允许在一个类型中使用，以将其作为一个类型引用，例如:</p><pre class="kj kk kl km gt mq mo mr ms aw mt bi"><span id="946c" class="mu ls it mo b gy mv mw l mx my">let foo = "bar";<br/>let name: typeof foo; // string</span></pre><p id="a92c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我知道这太简单和多余了。让我们试一个复杂的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="3fa5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们对<code class="fe ml mm mn mo b">getHisOrHer</code>返回类型进行更改，那么<code class="fe ml mm mn mo b">HisOrHer</code>的类型也会随之更改，这是一次性的工作。</p><h1 id="6fe2" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">条件类型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="cd02" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你已经陷入如此尴尬的境地了吗？那么，有一个解决条件类型的方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="abaa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个概念类似于JavaScript的三元运算符<code class="fe ml mm mn mo b">condition ? true : false</code></p><p id="3c74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ml mm mn mo b">s</code>传递了<code class="fe ml mm mn mo b">string</code>作为参数，所以它将使用类型<code class="fe ml mm mn mo b">StringId</code>，而n传递了<code class="fe ml mm mn mo b">number</code>，它将返回<code class="fe ml mm mn mo b">NumberId</code></p><p id="cf55" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可惜你不能有第三种或者更多的选择。</p><h1 id="e4aa" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">映射类型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c7fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在某些情况下，您将需要一个动态键来支持您的类型，如上面的代码片段。您将产品名称作为对象键，但是所有的值都是相同的。使用映射类型，您不必为每个产品名称创建一个类型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="a3e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">更复杂的来了。假设您需要两个变量，一个用于颜色值，另一个用于开关。如果您添加更多颜色，此功能可以减少产生错误的机会。</p><h2 id="937a" class="mu ls it bd lt nf ng dn lx nh ni dp mb ld nj nk md lh nl nm mf ll nn no mh np bi translated">映射修改器</h2><p id="08a5" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">做好准备。我将向您展示更复杂的映射类型的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c0f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以使用<code class="fe ml mm mn mo b">-</code>作为前缀来删除修饰符，或者使用<code class="fe ml mm mn mo b">+</code>来添加修饰符。在代码片段中，<code class="fe ml mm mn mo b">toMutable</code>删除了<code class="fe ml mm mn mo b">readonly</code>修饰符。</p><h2 id="6174" class="mu ls it bd lt nf ng dn lx nh ni dp mb ld nj nk md lh nl nm mf ll nn no mh np bi translated">通过<code class="fe ml mm mn mo b">as</code>重新映射按键</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="5777" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ml mm mn mo b">Capitalize</code>是一个字符串操作类型，还有几个更可用的:</p><ul class=""><li id="e416" class="nq nr it kw b kx ky la lb ld ns lh nt ll nu lp nv nw nx ny bi translated">大写—将第一个字符转换为大写</li><li id="5a93" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated">不大写—将第一个字符转换为小写</li><li id="4380" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated">大写—将第一个字符转换为大写</li><li id="e532" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated">大写—将所有字符转换为大写</li><li id="75c3" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated">小写—将所有字符转换为小写</li></ul><h1 id="6788" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">模板文字类型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="8354" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个特性与JavaScript的模板文字中的概念相同。它在字符串文字的基础上构建类型。</p><h1 id="0f26" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">实用类型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="2b7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后但同样重要的是，<strong class="kw iu">实用程序类型:</strong></p><ul class=""><li id="65b8" class="nq nr it kw b kx ky la lb ld ns lh nt ll nu lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Pick&lt;T, Keys&gt;</code> —从类型中选择<code class="fe ml mm mn mo b">key</code>的属性</li><li id="d599" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Omit&lt;T, Keys&gt;</code> —与<code class="fe ml mm mn mo b">Pick</code>相反，取除<code class="fe ml mm mn mo b">Keys</code>以外的所有属性</li><li id="3577" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Partial&lt;T&gt; </code> —类似于<code class="fe ml mm mn mo b">?</code>又名<code class="fe ml mm mn mo b">optional</code>，但是你不需要将里面的所有属性都设置为可选的，因为你可能只需要变量或函数中的部分属性。</li><li id="69c8" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Required&lt;T&gt;</code> —与<code class="fe ml mm mn mo b">Partial&lt;T&gt;</code>相反，这将要求所有属性包括<code class="fe ml mm mn mo b">optional</code>属性</li><li id="8804" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Readonly&lt;T&gt;</code> —整个属性是不可变的，并且是只读的</li><li id="a5d1" class="nq nr it kw b kx nz la oa ld ob lh oc ll od lp nv nw nx ny bi translated"><code class="fe ml mm mn mo b">Record&lt;Key, T&gt; </code> —我不建议在TypeScript中使用<code class="fe ml mm mn mo b">object</code>类型，你会经常得到<code class="fe ml mm mn mo b">TS2339: Property 'x' does not exist on type 'object'</code>。我总是用<code class="fe ml mm mn mo b">Record&lt;Key, T&gt;</code>作为替代。</li></ul></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="11c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如你所看到的，大多数功能可以相互结合，充分利用它。</p><p id="e51e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">无论谁和我一样有过这样的挣扎，我希望这篇文章能简化你的工作。本文不包括所有的高级特性；例如，我选择了常用的功能。如果你想知道更多，请查阅官方文档。</p><h1 id="99b9" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">奖励—基于Intellij的IDE</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol mk l"/></div></figure><p id="7935" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你试图将一个JavaScript代码库迁移到TypeScript代码库或者重构一个某人爱用的代码库<code class="fe ml mm mn mo b">any</code>时，这个特性就是你的救星。</p><h1 id="dd67" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">参考</h1><ul class=""><li id="f947" class="nq nr it kw b kx na la nb ld om lh on ll oo lp nv nw nx ny bi translated"><a class="ae lq" href="https://www.typescriptlang.org/docs/" rel="noopener ugc nofollow" target="_blank">打字正式文件</a></li></ul></div></div>    
</body>
</html>