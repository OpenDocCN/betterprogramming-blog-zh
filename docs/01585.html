<html>
<head>
<title>How To Flatten a Dictionary With Nested Lists and Dictionaries in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中展平带有嵌套列表和字典的字典</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-flatten-a-dictionary-with-nested-lists-and-dictionaries-in-python-524fd236365?source=collection_archive---------4-----------------------#2019-09-26">https://betterprogramming.pub/how-to-flatten-a-dictionary-with-nested-lists-and-dictionaries-in-python-524fd236365?source=collection_archive---------4-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab45" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习用自定义分隔符拼合字典，以容纳嵌套列表和字典</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6476244553797b5bac048ecad503b407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZasithM0ujDjEq9wkEZSMA.png"/></div></div></figure><p id="a83c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您是否想过如何将多层数据结构转换成表格格式？这是一个将字典扁平化的函数，可以容纳嵌套列表和字典。</p><p id="b486" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不包括元组和其他数据类型，因为这主要在操作JSON数据时使用。该函数允许自定义分隔符，并将保留术语的顺序。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="352a" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">起始结构</h1><p id="ebfa" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">我们的函数需要递归才能正常工作。递归是调用自己的过程。</p><p id="79ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，我们将需要使用<code class="fe mu mv mw mx b">collections</code>库来创建一个<code class="fe mu mv mw mx b">OrderedDict</code>来保持术语的顺序。这是我们函数的框架:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="f538" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意包含了一个<code class="fe mu mv mw mx b">sep</code>参数，如果没有指定自定义分隔符，该参数将默认为下划线。</p><p id="e382" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mu mv mw mx b">obj</code>变量用于构建我们的扁平字典，并将在每次递归结束时添加。</p><p id="c3cc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们的<code class="fe mu mv mw mx b">recurse()</code>函数中，<code class="fe mu mv mw mx b">parent_key</code>变量将用于传递当前的键，允许连接先前的键和新的键。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="d22d" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">概述recurse()函数</h1><p id="c1c6" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">因为我们坚持使用JSON兼容的数据，所以有三种可能的数据类型:列表/数组、字典/对象和原始值。</p><p id="d63c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">设置好这三个场景，<code class="fe mu mv mw mx b">recurse()</code>功能就初步成型了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="c900" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意在第11行，我们写到<code class="fe mu mv mw mx b">obj</code>。只有当数据类型是原语，而不是列表或字典时，我们才会写入展平的对象。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="e667" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">完成flatten()函数</h1><p id="ff7a" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">充实函数的其余部分，列表和字典的<code class="fe mu mv mw mx b">parent_key</code>有所不同，因为列表需要索引。如果<code class="fe mu mv mw mx b">parent_key</code>为空，则只传递当前索引或当前键。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="7dc1" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">测试功能</h1><p id="2f52" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">以下是一些示例数据，包括嵌套列表、字典和值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="d3d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当使用上面的数据调用我们的<code class="fe mu mv mw mx b">flatten()</code>函数时，下面是使用<code class="fe mu mv mw mx b">pprint()</code>干净地格式化输出的结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="1d6a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，嵌套数据结构被标识为原始键，通过分隔符与新键连接在一起。对于嵌套列表，还包括索引。</p><p id="bd68" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于在一个地方的全部功能和测试执行，检查这个<a class="ae na" href="https://gist.github.com/188df03ec6286ad3a0f30b67cc0b8428" rel="noopener ugc nofollow" target="_blank">要点</a>。</p></div></div>    
</body>
</html>