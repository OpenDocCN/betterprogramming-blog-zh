<html>
<head>
<title>How to Deploy H2O Wave App on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Heroku上部署H2O Wave App</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-deploy-h2o-wave-app-on-heroku-2abe2240731c?source=collection_archive---------13-----------------------#2022-07-01">https://betterprogramming.pub/how-to-deploy-h2o-wave-app-on-heroku-2abe2240731c?source=collection_archive---------13-----------------------#2022-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d4ae" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用<strong class="ak">“Heroku Git”</strong>方法在Heroku上部署H2O Wave应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b3fd0482dd13506977577b4fb180e8dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q40Iu_qozeHzAE5iHgBTaw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PC:作者</p></figure><p id="77b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> H2O波</strong>是一个开源的python开发框架，用于开发具有复杂可视化的实时交互式web应用。它的特别之处在于，您不需要事先了解任何前端技术。H2O wave的创建是为了克服数据科学家、机器学习工程师、研究人员&amp;以及其他正在努力通过漂亮的仪表盘或网络应用程序展示自己辛勤工作的人的障碍。如果你擅长Python或R，那么你可以像其他任何使用H2O wave的web开发者一样快速构建你的web应用。<a class="ae lu" href="https://wave.h2o.ai/" rel="noopener ugc nofollow" target="_blank">看到这里，用H2O波弄脏你的手。</a></p><p id="1c58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Heroku是一个基于容器的云PaaS，它帮助开发者部署、管理和扩展他们的web应用。Heroku提供了一个<strong class="la iu">“Free and Hobby”</strong>包，可用于部署非商业web应用，如概念证明、MVP和个人项目。要了解更多关于Heroku的信息，请点击这里。</p><p id="47b6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这两个惊人的产品可以帮助我们许多人建立和分享/演示我们的网络应用程序。有三种不同的方式可以在Heroku上部署应用程序。今天让我向你展示如何使用<code class="fe lv lw lx ly b">Heroku Git</code>来部署你的wave应用。我们会看到，</p><ol class=""><li id="a0c0" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">先决条件</li><li id="d518" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">在本地构建和测试你的wave应用</li><li id="b18c" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">准备您的Wave应用程序的代码库，以便在Heroku中部署</li><li id="3a7e" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">部署和共享</li></ol><h2 id="7d11" class="mn mo it bd mp mq mr dn ms mt mu dp mv lh mw mx my ll mz na nb lp nc nd ne nf bi translated">先决条件</h2><p id="03c6" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">要部署您需要的wave应用程序，</p><ol class=""><li id="2df2" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated">Heroku免费帐户，如果你没有一个<a class="ae lu" href="https://signup.heroku.com/dc" rel="noopener ugc nofollow" target="_blank">创建它</a>。</li><li id="f2eb" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">Git CLI，很可能每个开发者都有，如果你没有安装它的话。</li><li id="04de" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">Heroku CLI，<a class="ae lu" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank">参考此处安装</a>。</li><li id="cc00" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated">H2O Wave应用程序，如果你有自己的应用程序，请继续使用它，<a class="ae lu" href="https://github.com/Mathanraj-Sharma/wave-heroku-demo" rel="noopener ugc nofollow" target="_blank">或者在这里随意使用我的演示应用程序</a>。</li></ol><h2 id="a1ee" class="mn mo it bd mp mq mr dn ms mt mu dp mv lh mw mx my ll mz na nb lp nc nd ne nf bi translated">在本地构建和测试你的wave应用</h2><p id="40eb" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">希望您已经检查了所有先决条件，让我们开始行动吧。</p><p id="50c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，让我们检查我们的应用程序是否在本地工作。这里我将使用我创建的演示应用程序。如果你有自己的应用程序，跳过下一步，并确认它按预期工作。</p><ul class=""><li id="8d89" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated">克隆演示应用程序</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="7dde" class="mn mo it ly b gy nq nr l ns nt">$ git clone <a class="ae lu" href="https://github.com/Mathanraj-Sharma/wave-heroku-demo.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Mathanraj-Sharma/wave-heroku-demo.git</a><br/>$ cd wave-heroku-demo<br/>$ tree</span></pre><p id="a324" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你应该能够看到下面的应用程序回购文件结构</p><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="af31" class="mn mo it ly b gy nq nr l ns nt">.<br/>├── LICENSE<br/>├── Makefile<br/>├── Procfile<br/>├── README.md<br/>├── demo_app<br/>│   ├── __init__.py<br/>│   └── app.py<br/>├── requirements.txt<br/>├── runtime.txt<br/>└── static<br/>    └── h2o_logo.svg</span><span id="dbf8" class="mn mo it ly b gy nu nr l ns nt">2 directories, 9 files</span></pre><ul class=""><li id="1a86" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated">在本地检查应用程序，运行</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="248e" class="mn mo it ly b gy nq nr l ns nt"># to setup virutal environment with app dependencies<br/>$ make setup</span><span id="f4dc" class="mn mo it ly b gy nu nr l ns nt">--------------</span><span id="c7ae" class="mn mo it ly b gy nu nr l ns nt"># start the app in no-reload mode<br/>$ .venv/bin/wave --no-reload demo_app/app.py</span><span id="201f" class="mn mo it ly b gy nu nr l ns nt">OR simply you can use my make target<br/>$ make run</span></pre><p id="2053" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这个日志中你可以看到应用程序开始运行良好</p><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="68c1" class="mn mo it ly b gy nq nr l ns nt">./.venv/bin/wave run --no-reload demo_app/app.py<br/>params: []2022/07/01 05:44:23 #<br/>2022/07/01 05:44:23 # ┌────────────────┐ H2O Wave<br/>2022/07/01 05:44:23 # │  ┐┌┐┐┌─┐┌ ┌┌─┐ │ 0.22.0 20220531173625<br/>2022/07/01 05:44:23 # │  └┘└┘└─└└─┘└── │ © 2021 H2O.ai, Inc.<br/>2022/07/01 05:44:23 # └────────────────┘<br/>2022/07/01 05:44:23 # ┌──────────────────────────────────────┐<br/>2022/07/01 05:44:23 # │  Running at <a class="ae lu" href="http://localhost:10101/" rel="noopener ugc nofollow" target="_blank">http://localhost:10101/</a>  │<br/>2022/07/01 05:44:23 # └──────────────────────────────────────┘<br/>2022/07/01 05:44:23 # {"address":":10101","base-url":"/","t":"listen","web-dir":"/Users/mathanraj/Desktop/contribs/wave-heroku-demo/.venv/www"}<br/>INFO:     Started server process [2959]<br/>INFO:     Waiting for application startup.<br/>2022/07/01 05:44:23 # {"host":"<a class="ae lu" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000</a>","route":"/","t":"app_add"}<br/>INFO:     Application startup complete.<br/>INFO:     Uvicorn running on <a class="ae lu" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000</a> (Press CTRL+C to quit)</span></pre><p id="3c12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你去<a class="ae lu" href="http://localhost:10101/" rel="noopener ugc nofollow" target="_blank">http://localhost:10101/</a>你可以看到这个应用在工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/8461a8885dc1314f854a9d116f1a1994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*21GUYYWOTv70p3mKUkBS4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PC:作者</p></figure><h2 id="b43c" class="mn mo it bd mp mq mr dn ms mt mu dp mv lh mw mx my ll mz na nb lp nc nd ne nf bi translated">准备您的Wave应用程序的代码库，以便在Heroku中部署</h2><p id="a145" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">为了使用<code class="fe lv lw lx ly b">Heroku Git</code>在Heroku上部署你的wave应用程序，你需要三个文件。</p><ul class=""><li id="7aa3" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated"><code class="fe lv lw lx ly b">runtime.txt</code>:这个文件将被用来告诉Heroku你想在哪个python版本上运行你的应用。它将只包含您需要的python版本。<code class="fe lv lw lx ly b">python-3.8.13</code></li><li id="59ce" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt nl mf mg mh bi translated"><code class="fe lv lw lx ly b">requirements.txt</code>:它包含成功运行应用程序所需的所有依赖项。当我们部署我们的应用程序时，Heroku的python依赖管理器将寻找这个文件来为你的应用程序设置运行时环境。你可以看看我的演示报告中的样本文件来了解这个文件的内容。</li><li id="249b" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt nl mf mg mh bi translated"><code class="fe lv lw lx ly b">Procfile</code>:这是一个特殊的文件，用来声明启动你的应用需要执行的命令。为了成功启动你的wave应用，你需要在你的<code class="fe lv lw lx ly b">Procfile</code>中有这个<code class="fe lv lw lx ly b">web</code>过程</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="04a1" class="mn mo it ly b gy nq nr l ns nt">web: WEB_CONCURRENCY=1 H2O_WAVE_ADDRESS="http://127.0.0.1:${PORT}" H2O_WAVE_LISTEN=":${PORT}" wave run --no-reload demo_app/app.py</span></pre><p id="31ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们花几分钟时间来理解这个命令的作用。</p><p id="eb08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lv lw lx ly b">wave run -no-realod demo_app/app.py</code>是我们平时用来启动wave app的命令。</p><p id="4ecf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lv lw lx ly b">H2O_WAVE_LISTEN</code>是用来告诉wave服务器应该监听哪个端口的环境变量。默认值为<code class="fe lv lw lx ly b">10101</code>。</p><p id="5264" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lv lw lx ly b">H2O_WAVE_ADDRESS</code>是一个环境变量，我们用它来告诉wave app哪个是wave服务器的公共主机/端口。默认值为<code class="fe lv lw lx ly b">http://127.0.0.1:10101</code>。</p><p id="356a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们在Heroku上部署一个app时，它会在运行时随机指定一个端口号。该值可通过<code class="fe lv lw lx ly b">PORT</code>环境变量获得。因此，当我们部署应用程序时，我们的服务器应该绑定到指定的端口地址&amp;,我们的应用程序应该通过该端口寻找我们的服务器。这就是为什么我们设置这两个环境变量。</p><p id="470f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一个变量是<code class="fe lv lw lx ly b">WEB_CONCURRENCY</code>，我们设置它告诉我们的服务器只启动我们应用程序的一个实例。</p><p id="eaab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://github.com/h2oai/wave/blob/master/website/docs/configuration.md" rel="noopener ugc nofollow" target="_blank">在此了解更多关于环境变量的信息。</a></p><p id="f135" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是我们部署一个基本的wave应用程序所需的全部内容，<a class="ae lu" href="https://devcenter.heroku.com/articles/procfile" rel="noopener ugc nofollow" target="_blank">你可以根据自己的需要使用proc file</a>。</p><p id="e1a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">部署&amp;共享</strong></p><p id="f9d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有设置让我们开始部署我们的应用程序</p><ul class=""><li id="a908" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated">打开一个终端，进入wave app的repo，运行下面的命令，在heroku上创建一个app，接收你的源代码。</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="3965" class="mn mo it ly b gy nq nr l ns nt">$ heroku apps:create wave-heroku-demo</span><span id="5552" class="mn mo it ly b gy nu nr l ns nt">Creating ⬢ wave-heroku-demo... done<br/><a class="ae lu" href="https://wave-heroku-demo.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://wave-heroku-demo.herokuapp.com/</a> | <a class="ae lu" href="https://git.heroku.com/wave-heroku-demo.git" rel="noopener ugc nofollow" target="_blank">https://git.heroku.com/wave-heroku-demo.git</a></span></pre><p id="e010" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当应用程序名称已被使用时，它会询问另一个名称。请使用您选择的名称继续前进。</p><p id="6a07" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该命令将在heroku上为您的应用程序创建一个git repo，并将在您的本地项目上添加一个名为<code class="fe lv lw lx ly b">heroku</code>的git remote。</p><ul class=""><li id="9edb" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated">接下来将你的源代码推送到你创建的Heroku应用程序中</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="aea4" class="mn mo it ly b gy nq nr l ns nt">$ git push heroku main</span><span id="56d0" class="mn mo it ly b gy nu nr l ns nt">Enumerating objects: 17, done.<br/>Counting objects: 100% (17/17), done.<br/>Delta compression using up to 8 threads<br/>Compressing objects: 100% (13/13), done.<br/>Writing objects: 100% (17/17), 9.79 KiB | 668.00 KiB/s, done.<br/>Total 17 (delta 1), reused 0 (delta 0), pack-reused 0<br/>remote: Compressing source files... done.<br/>remote: Building source:<br/>remote:<br/>remote: -----&gt; Building on the Heroku-20 stack<br/>remote: -----&gt; Determining which buildpack to use for this app<br/>remote: -----&gt; Python app detected<br/>remote: -----&gt; Using Python version specified in runtime.txt<br/>remote: -----&gt; Installing python-3.8.13<br/>remote: -----&gt; Installing pip 22.1.2, setuptools 60.10.0 and wheel 0.37.1<br/>remote: -----&gt; Installing SQLite3<br/>remote: -----&gt; Installing requirements with pip<br/>...<br/>...</span><span id="2eaa" class="mn mo it ly b gy nu nr l ns nt">...<br/>remote: Verifying deploy... done.<br/>To <a class="ae lu" href="https://git.heroku.com/wave-heroku-demo.git" rel="noopener ugc nofollow" target="_blank">https://git.heroku.com/wave-heroku-demo.git</a><br/> * [new branch]      main -&gt; main</span></pre><p id="48c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">应用程序现已部署。确保至少有一个应用程序实例正在运行</p><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="cc86" class="mn mo it ly b gy nq nr l ns nt">$ heroku ps:scale web=1</span></pre><ul class=""><li id="e2f9" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated">在浏览器上打开你的应用</li></ul><pre class="kj kk kl km gt nm ly nn no aw np bi"><span id="982f" class="mn mo it ly b gy nq nr l ns nt">$ heroku open</span></pre><p id="3b6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将在您的浏览器上打开您的应用。或者，你可以去你的<a class="ae lu" href="https://dashboard.heroku.com/apps" rel="noopener ugc nofollow" target="_blank"> Heroku仪表板</a>打开你的应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/33e619ebcdc5824cfc580eab0870cdc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*FCfoOSNiJ5cy3SbN_TeGTQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PC:作者</p></figure><p id="529e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经看到了一个关于how波和Heroku的简短介绍，以及我们如何使用这两种令人敬畏的技术来克服在零前端知识的情况下构建复杂的web应用程序的障碍。希望这对你有帮助！</p><p id="f017" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">参考资料:</p><ul class=""><li id="9f2f" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt nl mf mg mh bi translated"><a class="ae lu" href="https://docs.h2o.ai/" rel="noopener ugc nofollow" target="_blank">了解更多关于Wave的信息</a></li><li id="1a0f" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt nl mf mg mh bi translated"><a class="ae lu" href="https://devcenter.heroku.com/articles/getting-started-with-python" rel="noopener ugc nofollow" target="_blank">在Heroku上部署python应用</a></li><li id="13fd" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt nl mf mg mh bi translated"><a class="ae lu" href="https://medium.com/@srini.x/deploy-your-wave-app-in-5-minutes-bd440d00917f" rel="noopener">使用Heroku Docker方法在Heroku上部署Wave App</a></li></ul></div></div>    
</body>
</html>