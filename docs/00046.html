<html>
<head>
<title>Find and Return the Ranges of All the Occurrences of a Given String in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中查找并返回给定字符串的所有出现的范围</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/find-and-return-the-ranges-of-all-the-occurrences-of-a-given-string-in-swift-2a2015907a0e?source=collection_archive---------8-----------------------#2017-07-28">https://betterprogramming.pub/find-and-return-the-ranges-of-all-the-occurrences-of-a-given-string-in-swift-2a2015907a0e?source=collection_archive---------8-----------------------#2017-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="481d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">串东西</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ed7c03f1e11015ec8f41ad631be1c74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rmdpxJA8osEUVQPu"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@wx1993?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Raychan </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure><p id="d89e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当讨论字符串模式匹配识别问题时，您脑海中首先想到的可能是Knuth-Morris-Pratt算法。不过，我想介绍一个基于<code class="fe ls lt lu lv b">range(of:options:range:locale:)</code>的更直观的方法，它是Swift标准库的一部分。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="8b30" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">多次返回第一个匹配项以收集所有匹配项</h1><p id="271b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">如果你查阅<a class="ae kv" href="https://developer.apple.com/documentation/foundation/nsstring/1417348-range" rel="noopener ugc nofollow" target="_blank">苹果开发者文档</a>，你会发现<code class="fe ls lt lu lv b">range(of:options:range:locale:)</code>函数的描述:</p><blockquote class="na"><p id="112a" class="nb nc iq bd nd ne nf ng nh ni nj lr dk translated">根据给定的选项，使用指定的区域设置(如果有)，在给定的字符串范围内查找并返回给定字符串的第一个匹配项的范围</p></blockquote><p id="de9b" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">是的，它只返回第一个匹配项。因此，为了实现我们的目的，我们需要构造一个<code class="fe ls lt lu lv b">while</code>循环来迭代接收器中给定字符串的所有出现。参考代码片段类似于下面的代码块。请注意，还添加了一个偏移量来减少每次迭代中的范围长度。因此，实际上，每个循环的位置基本上是基于前一次迭代的上限:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="9d25" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">将索引转换为范围</h1><p id="290b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">有时，返回所有索引不足以在文本编辑中执行查找并替换所有内容的操作。因此，一个<code class="fe ls lt lu lv b">transform</code>助手可以帮助生成一个<code class="fe ls lt lu lv b">range</code>数组，使得处理子字符串更加容易:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e76c" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">从Swift 4之前的范围创建NSRange</h1><p id="3075" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">如果你已经把你的Xcode迁移到9版了，Swift 4的Swift标准库提供了一个直接从<code class="fe ls lt lu lv b">Range&lt;String.Index&gt;</code>转换到<code class="fe ls lt lu lv b">NSRange</code>的方法。这绝对是许多开发人员期待的一个特性，因为有时当某些函数调用还没有完全迁移到原生Swift时，处理<code class="fe ls lt lu lv b">NSRange</code>仍然是不可避免的。下面是一个<code class="fe ls lt lu lv b">NSAttributedString</code>的例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="5e38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了更顺利地迁移到Swift的当前版本，我们可以实现一个语法兼容的功能，从<code class="fe ls lt lu lv b">Range</code>创建<code class="fe ls lt lu lv b">NSRange</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="f547" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">在操场上测试上面的功能</h1><p id="62d2" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">基本上，上面的代码包含了我们需要查找并返回给定字符串所有出现的范围的元素。让我们在下面的代码片段中测试并查看结果:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8307" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在操场上，日志控制台会是这样的:</p><pre class="kg kh ki kj gt nr lv ns nt aw nu bi"><span id="84ac" class="nv me iq lv b gy nw nx l ny nz">[Int] : [12, 31, 50, 69, 88]<br/>`Range` : playground<br/>`Range` : playground<br/>`Range` : playground<br/>`Range` : playground<br/>`Range` : playground<br/>`NSRange` : playground<br/>`NSRange` : playground<br/>`NSRange` : playground<br/>`NSRange` : playground<br/>`NSRange` : playground</span></pre></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="178b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="f2e7" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>