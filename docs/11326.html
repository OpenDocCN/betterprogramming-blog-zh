<html>
<head>
<title>CryptoKitties: Smart Contract Breakdown</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CryptoKitties:智能合同分解</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/cryptokitties-smart-contract-breakdown-2c3c250d33f6?source=collection_archive---------1-----------------------#2022-03-09">https://betterprogramming.pub/cryptokitties-smart-contract-breakdown-2c3c250d33f6?source=collection_archive---------1-----------------------#2022-03-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="88ba" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过对代码行进行分组来解释其功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/22019c215d04e7740125b7b8ce929c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a02agrkNCzS-h9GdNzkkAQ.png"/></div></div></figure><p id="9cf1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我对CryptoKitties项目一直很感兴趣。这是有史以来第一个流行的NFT游戏。但我不明白它的吸引力，为什么它会爆炸。我也从来没有完全理解游戏的动态。所以我决定最终了解这个游戏是关于什么的，以及它是如何在幕后实现的。</p><p id="538d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我很清楚NFT部分是作为ERC-721实现的。但我想了解繁殖是如何实现的。什么是保持链内和链外？随着我开始探索这个游戏，我了解到它有一个拍卖机制。这是如何实现的？</p><p id="48fc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">而人们实际上从这个东西中赚了多少？人们还在玩它吗？或者它已经被更成功的Axie Infinity完全取代了？</p><p id="613d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将回答所有这些问题，并分解CryptoKitties背后的智能合约。下面是这篇文章的提纲:</p><ul class=""><li id="d0f0" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">什么是CryptoKitties？</li><li id="3973" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">代码结构(核心、繁殖、拍卖)</li><li id="9847" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">密码猫的时间线</li><li id="6098" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">我对守则的看法</li></ul><h1 id="1a3d" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">什么是CryptoKitties——短游戏动力学</h1><p id="b673" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">一开始我<a class="ae my" href="https://twitter.com/nazar_ilamanov/status/1499868504685694984?s=20&amp;t=EKhVZEsy5AUsVoa_F0P6Hw" rel="noopener ugc nofollow" target="_blank">想让</a>做一个Axie Infinity(AI)的分解。但事实证明，人工智能并没有开源他们的大多数智能合同(SCs)。所以我转向CryptoKitties(CK)(它的合同是公开的)。这是一个简化版的人工智能，具有类似的游戏动态:</p><ul class=""><li id="babd" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">基于区块链的游戏</li><li id="c106" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">人们收集和交易小猫</li><li id="f8d7" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">可以繁殖两只小猫来得到一只新的小猫</li><li id="b14a" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">通过出售或出租猫咪来获得真正的ETH</li><li id="3372" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">育种工作以“基因”为基础。小猫咪混合了父母的基因</li><li id="768d" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">小猫没有性别</li><li id="4631" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">CK通过收取市场佣金(拍卖费)和铸造新猫咪来赚钱</li><li id="0996" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">要进入游戏，你需要购买一些小猫</li></ul><p id="5fbd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你感兴趣，这里有一个CK游戏的视频。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mz na l"/></div></figure><blockquote class="nb nc nd"><p id="f769" class="kr ks ne kt b ku kv jr kw kx ky ju kz nf lb lc ld ng lf lg lh nh lj lk ll lm ij bi translated">Axie Infinity的灵感来自CryptoKitties、Pokemon(用于战斗)和后来的Clash of Clans(用于土地)。<a class="ae my" href="https://www.notboring.co/p/infinity-revenue-infinity-possibilities?s=r" rel="noopener ugc nofollow" target="_blank">更多关于AI </a>的起源和商业方面。</p></blockquote><h1 id="66e9" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">代码结构</h1><p id="acbf" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">CK有3个智能合同:核心，育种和拍卖。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a3903ae86e12b546dc159d34c35066dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HgB6D9TNcULFEm1v49IpWg.png"/></div></div></figure><p id="1ac9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">源代码:</p><ul class=""><li id="9f49" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">核心与拍卖:</strong> <a class="ae my" href="https://etherscan.io/address/0x06012c8cf97bead5deae237070f9587f8e7a266d#code" rel="noopener ugc nofollow" target="_blank">以太扫描</a>，<a class="ae my" href="https://gist.github.com/yogin/b88b105d9b2e332a5b59a3fd29cac962" rel="noopener ugc nofollow" target="_blank">要诀</a></li><li id="7cf3" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><strong class="kt ir">育种:</strong>以太扫描<a class="ae my" href="https://etherscan.io/address/0xf97e0a5b616dffc913e72455fde9ea8bbe946a2b#code" rel="noopener ugc nofollow" target="_blank"> v1 </a>和<a class="ae my" href="https://etherscan.io/address/0xb77feddb7e627a78140a2a32cac65a49ed1dba8e#code" rel="noopener ugc nofollow" target="_blank"> v2 </a></li></ul><h2 id="9954" class="ni mc iq bd md nj nk dn mh nl nm dp ml la nn no mn le np nq mp li nr ns mr nt bi translated">核心合同</h2><p id="d27e" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">核心合同被分解成许多子合同:<code class="fe nu nv nw nx b">KittyBase</code>合同继承/扩展<code class="fe nu nv nw nx b">KittyAccessControl</code>合同，<code class="fe nu nv nw nx b">KittyOwnership</code>扩展<code class="fe nu nv nw nx b">KittyBase</code>等。<code class="fe nu nv nw nx b">KittyCore</code>什么都有。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cfa1e2a829baa3d11d3cb7c01cba805d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZXqIcYhiVdbpmYTlcnUBaw.png"/></div></div></figure><ul class=""><li id="52d8" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyAccessControl</code>:创建3个角色:CEO、CFO、首席运营官，并限制这些角色对某些功能的访问。CEO可以重新分配角色，更改指向兄弟合同的指针。CFO可以提取资金。首席运营官可以铸造新的小猫。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="3710" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyBase</code><strong class="kt ir">:</strong>kitties的数据结构；存储所有小猫和所有权信息；所有权的转移。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="1d7f" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyOwnership</code>:ERC-721接口的实现。我在我的<a class="ae my" href="https://ilamanov.medium.com/bored-ape-yacht-club-smart-contract-breakdown-6c254c774394" rel="noopener"> BAYC smart契约分解</a>中解释了ERC-721的实现。有兴趣就去看看。</li></ul><blockquote class="nb nc nd"><p id="57c3" class="kr ks ne kt b ku kv jr kw kx ky ju kz nf lb lc ld ng lf lg lh nh lj lk ll lm ij bi translated">你知道CryptoKitties <a class="ae my" href="https://github.com/ethereum/EIPs/issues/721" rel="noopener ugc nofollow" target="_blank">开创了</a> ERC-721标准并创造了术语NFT吗？</p></blockquote><ul class=""><li id="5d6b" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyBreeding</code>:将在“育种”部分说明。</li><li id="5a1e" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyAuction</code>:将在“拍卖”部分解释。</li><li id="a1f1" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">KittyMinting</code>:只能铸造50K只小猫——5K为促销小猫，其余为常规gen0小猫。(区别:promo可以在造币时转移到特定地址，常规gen0只能拍卖)。在铸造过程中可以指定任何基因。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="88f0" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b"><strong class="kt ir">KittyCore</strong></code> <strong class="kt ir"> : </strong>将一切联系在一起，添加支付/取款，并处理可升级性——将在本文后面讨论。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><blockquote class="nb nc nd"><p id="288f" class="kr ks ne kt b ku kv jr kw kx ky ju kz nf lb lc ld ng lf lg lh nh lj lk ll lm ij bi translated">以太坊101中的支付:<br/> -要接受支付，只需使用您的功能<code class="fe nu nv nw nx b">payable</code>。<code class="fe nu nv nw nx b">msg.value</code>变量包含已发送的金额<br/> -要向某个地址发送付款，只需使用<code class="fe nu nv nw nx b">address.send</code>。</p></blockquote><h1 id="4b73" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">饲养</h1><p id="00c5" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">育种逻辑在核心合同的<code class="fe nu nv nw nx b">KittyBreeding</code>子合同中实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="b985" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">首先，有一堆助手函数，如<code class="fe nu nv nw nx b">isReadyToBreed</code>、<code class="fe nu nv nw nx b">isSiringPermitted</code>、<code class="fe nu nv nw nx b">isValidMatingPair</code>等。</li><li id="a8e1" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">然后有两个功能实际上做育种。<code class="fe nu nv nw nx b">breedWith</code>开始繁殖过程，<code class="fe nu nv nw nx b">giveBirth</code>结束繁殖过程。<code class="fe nu nv nw nx b">giveBirth</code>只有在孕育期结束后，呼叫才会成功。</li></ul><h2 id="6fcd" class="ni mc iq bd md nj nk dn mh nl nm dp ml la nn no mn le np nq mp li nr ns mr nt bi translated">助产士和自动分娩</h2><p id="a2ab" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">我们可以假设<code class="fe nu nv nw nx b">breedWith</code>是有人发起育种时从CK前端调用的。但是<code class="fe nu nv nw nx b">giveBirth</code>是怎么叫的？Solidity中没有回调或<code class="fe nu nv nw nx b">cron</code>作业。所以以后需要有人叫<code class="fe nu nv nw nx b">giveBirth</code>。</p><p id="928e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是助产士的用武之地。CK有一个autoBirth守护进程网络，它在正确的时间调用<code class="fe nu nv nw nx b">giveBirth</code>。任何人都可以建立一个守护进程。</p><p id="a3d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是打电话<code class="fe nu nv nw nx b">giveBirth</code>费油。为什么恶魔会为别人付油钱？这就是<code class="fe nu nv nw nx b">autoBirthFee</code>的用武之地。当玩家开始繁殖时，他需要向CK支付<code class="fe nu nv nw nx b">autoBirthFee</code>(目前为0.04 ETH)。CK稍后会在调用<code class="fe nu nv nw nx b">giveBirth</code>时补偿守护进程。</p><h2 id="c3de" class="ni mc iq bd md nj nk dn mh nl nm dp ml la nn no mn le np nq mp li nr ns mr nt bi translated">超秘密遗传组合算法</h2><p id="ec3a" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">您可能注意到了<code class="fe nu nv nw nx b">giveBirth</code>函数调用<code class="fe nu nv nw nx b">mixGenes</code>函数来获取子基因。这个<code class="fe nu nv nw nx b">mixGenes</code>函数实际上是一个名为<code class="fe nu nv nw nx b">GeneScience</code>的兄弟契约的一部分(源代码:<a class="ae my" href="https://etherscan.io/address/0xf97e0a5b616dffc913e72455fde9ea8bbe946a2b#code" rel="noopener ugc nofollow" target="_blank"> v1 </a>和<a class="ae my" href="https://etherscan.io/address/0xb77feddb7e627a78140a2a32cac65a49ed1dba8e#code" rel="noopener ugc nofollow" target="_blank"> v2 </a>)。<code class="fe nu nv nw nx b">KittyBreeding</code>只是存储一个指向<code class="fe nu nv nw nx b">GeneScience</code>契约的指针。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7067fb67ece0692a06b244ce498574ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NcJzX1SKp9HVkLWx6eM9tQ.png"/></div></div></figure><p id="98a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最初，<code class="fe nu nv nw nx b">GeneScience</code>并没有开源到“<a class="ae my" href="https://www.cryptokitties.co/blog/post/learn-how-our-last-mystery-smart-contract-works/" rel="noopener ugc nofollow" target="_blank">刻意围绕CryptoKitties基因组</a>培养神秘感和发现。但是社区建立了工具来逆向工程基因科学算法。CK随后开源了它，甚至发布了稍加改进的第二个版本(<a class="ae my" href="https://www.cryptokitties.co/blog/post/learn-how-our-last-mystery-smart-contract-works/" rel="noopener ugc nofollow" target="_blank"> CK博客帖子</a>)。</p><blockquote class="nb nc nd"><p id="2a1b" class="kr ks ne kt b ku kv jr kw kx ky ju kz nf lb lc ld ng lf lg lh nh lj lk ll lm ij bi translated"><strong class="kt ir"/><code class="fe nu nv nw nx b"><strong class="kt ir">GeneScience</strong></code><strong class="kt ir">合同时间表:</strong>2017年11月发布v1，2019年1月开源，2019年2月发布v 2(已经开源)。</p></blockquote><p id="72c9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我不会覆盖<code class="fe nu nv nw nx b">GeneScience</code>代码，因为它太低级了。但我将强调几点。</p><p id="cc71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nu nv nw nx b">GeneScience</code>涉及大量的比特操作来混合母猫的基因。记住，基因是以256位数字的形式存储在<code class="fe nu nv nw nx b">Kitty struct</code>中的。这些比特被映射到决定小猫外貌的特征(或者CK喜欢说的属性)。</p><blockquote class="nb nc nd"><p id="80ab" class="kr ks ne kt b ku kv jr kw kx ky ju kz nf lb lc ld ng lf lg lh nh lj lk ll lm ij bi translated"><strong class="kt ir">随机性是如何产生的？<br/> </strong> Solidity没有随机数生成器，所以CK使用后代出生时的块号作为随机性的种子。这个块号很难操作，所以它应该有足够的随机性</p></blockquote><h1 id="8011" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">拍卖</h1><p id="16f3" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">CK的最终合同是拍卖。CK采用一种“<a class="ae my" href="https://en.wikipedia.org/wiki/Dutch_auction" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">时钟拍卖</strong> </a>”:你设定起止价格和持续时间。然后价格从起始价格到结束价格线性变化。谁先出价，谁就赢。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3d0c614156db724448ef3980965f59e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppEV23hGr6zEn_b080po-Q.png"/></div></div></figure><p id="e89f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是拍卖合同的结构及其与其他合同的关系:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f703fad1b854f41fa6fefab3fb674013.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxybvlCfYtP99NypvmfJow.png"/></div></div></figure><ul class=""><li id="6b39" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir"> ClockAuctionBase: </strong>跟踪现有的拍卖和出价功能</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="c521" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">clock action:</strong>只是<code class="fe nu nv nw nx b">ClockAuctionBase</code>上面的一个包装</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="f7e6" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">SiringClockAuction</code>和<code class="fe nu nv nw nx b">SaleClockAuction</code>:分别是出租你的小猫用于繁殖的拍卖和出售你的小猫的拍卖。这些需要分开，因为在一个成功的投标后采取的行动是非常不同的。</li><li id="dbb4" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">SaleClockAuction</code>除了跟踪最近5次拍卖的价格(用于为新生产的小猫设定最佳拍卖起始价格)之外，没有增加太多功能。</li><li id="76e7" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nu nv nw nx b">SiringClockAuction</code>是<code class="fe nu nv nw nx b">ClockAuction</code>合同的另一个包装器，只不过它将租来的小猫转让给主人，而不是投标人(投标人保留后代)。</li></ul><p id="c96e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它们与<code class="fe nu nv nw nx b">KittyAuction</code>分包合同中的核心合同相关联:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><p id="2844" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">总结拍卖:</strong>你为你的小猫创建了一个拍卖，它被转移到拍卖合同，并且创建了一个新的拍卖。每当有人出价成功时，要么小猫被转让给出价人(当它是出售拍卖时)，要么小猫被转让给你，但出价人保留后代(当它是拍卖时)。</p><h1 id="e1c6" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">密码猫的时间线</h1><p id="f6ee" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">我们看到了代码。但是代码是静态的，它没有告诉我们动态的画面。部署合同后发生了什么？</p><p id="90f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以在Etherscan 上查看该合同<a class="ae my" href="https://etherscan.io/address/0x06012c8cf97bead5deae237070f9587f8e7a266d" rel="noopener ugc nofollow" target="_blank">的全部交易历史。如果我们回到起点:</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/c18d077a5dae9e2e4728d5b3a5f231c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCMR3E7DM8oinT5Vt7h2bA@2x.png"/></div></div></figure><p id="7c97" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以看到该合同是在2017年11月23日部署的。然后，他们设置兄弟合同的地址，并设置CEO/CFO角色。然后他们创造了一群宣传猫(确切地说是3K)。</p><p id="6247" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，他们解除合同(这意味着大多数功能现在都可用)，行动开始了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/30af51ed176c1aec13af8f4763aff623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdIafDKG666pM7F7ZtS3yA@2x.png"/></div></div></figure><p id="9da8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是一段时间内的合同余额(来自<a class="ae my" href="https://etherscan.io/address/0x06012c8cf97bead5deae237070f9587f8e7a266d#analytics" rel="noopener ugc nofollow" target="_blank"> Etherscan analytics </a>):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/1957f2b127d06e3bd737e6dd96ef3918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGHQ5r26La0ePTdUa8W75g@2x.png"/></div></div><p class="oc od gj gh gi oe of bd b be z dk translated">蓝色:ETH天平(天平在左边)。黑色:美元余额(刻度在右侧)</p></figure><p id="ab0c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">急剧下降的是CK团队的退出。我们看到大多数行动发生在2017年11月至2018年11月。从<a class="ae my" href="https://www.cryptokitties.co/Technical-details" rel="noopener ugc nofollow" target="_blank"> CK时间线网站</a>来看，CK在2018年1月峰值时有25万用户。同样在2017年12月，CK占据了以太坊25%的流量。</p><p id="a5a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是交易频率图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/062c10d91e3272b6dcb30de9d4c84305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rRkaC9eZvaNaIHz1f1cU4g@2x.png"/></div></div></figure><p id="cbdb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">虽然从2018年11月到2019年7月仍有大量交易，但它们都是低价值的，因为该地区的余额相对持平。</p><h1 id="440e" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">我对守则的看法</h1><ul class=""><li id="7528" class="ln lo iq kt b ku mt kx mu la og le oh li oi lm ls lt lu lv bi translated">首先也是最重要的是，<strong class="kt ir">艺术并不存在于链上</strong>。基因保存在链上，但理想情况下，小猫的图像也将在链上生成(像艺术块)。</li><li id="1e5d" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><strong class="kt ir"> CK甚至没有把<em class="ne">链接</em>到作品链上</strong>。他们可以使用<code class="fe nu nv nw nx b">getMetadata</code>函数返回不可变图像的链接。相反，他们只是返回“你好，世界”🤷‍♂️.从<code class="fe nu nv nw nx b">tokenIds</code>到图像的映射发生在前端。因此，如果CK关闭他们的网站，你只会留下一个毫无意义的256位数字。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><ul class=""><li id="f060" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">可升级性不理想</strong>。可以通过在KittyCore合同中设置新地址来更新核心合同。在这种情况下，将会发出一个事件，由客户端决定是否监听该事件并切换到新的契约。旧的会永远停顿。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny na l"/></div></figure><p id="9d54" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在说积极的一面</p><ul class=""><li id="ca9d" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">良好的关注点分离:</strong>育种和拍卖与核心契约分离，以最大限度地减少bug。你可以在不破坏核心<strong class="kt ir">的情况下插入兄弟契约的更新版本。</strong></li><li id="1186" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><strong class="kt ir">清晰的代码和对可靠性的深刻理解</strong>。整个合同中有许多有用的注释。防范再入攻击并最大化气体效率:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/1c68aeaf411c8a1806dbc1c2953a3fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RByhOXHcZRssR17IT_G5LQ@2x.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/896e96d212f885eac10bfc5821e9bb3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqkNzwodSit8lMsRZ0EHUA@2x.png"/></div></div></figure><ul class=""><li id="b26d" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">良好的幽默感</strong>:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6b0ee0867483f15cc3c1b924910b0841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YYvndfsQtbPkcGqb9JErw.png"/></div></div></figure></div><div class="ab cl ol om hu on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="ij ik il im in"><p id="fba4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">CryptoKittes智能合约分解到此结束！我希望这有所帮助。如果你有任何问题，请在评论中告诉我。</p><p id="5369" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我正计划对流行的智能合约进行更多的分解，如<strong class="kt ir"> Aave </strong>和<strong class="kt ir"> Art Blocks，</strong>所以请在Medium或Twitter上关注我以获取更新。</p><p id="4aca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你还可以在<a class="ae my" href="https://www.solidnoob.com/" rel="noopener ugc nofollow" target="_blank">solidnoob.com</a>查看其他智能合同的细目表和更多Solidity noobs的资料。</p><pre class="kg kh ki kj gt os nx ot ou aw ov bi"><span id="affe" class="ni mc iq nx b gy ow ox l oy oz"><strong class="nx ir">Want to Connect?</strong></span><span id="f3d8" class="ni mc iq nx b gy pa ox l oy oz">Follow me on <a class="ae my" href="https://twitter.com/nazar_ilamanov" rel="noopener ugc nofollow" target="_blank">Twitter</a>.</span></pre></div></div>    
</body>
</html>