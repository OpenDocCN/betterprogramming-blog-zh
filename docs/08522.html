<html>
<head>
<title>Python Strings: A Character Might Not Be the Character You Thought</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python字符串:一个字符可能不是您想象的字符</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/python-strings-a-character-might-not-be-the-character-you-thought-ab320a402359?source=collection_archive---------9-----------------------#2021-05-10">https://betterprogramming.pub/python-strings-a-character-might-not-be-the-character-you-thought-ab320a402359?source=collection_archive---------9-----------------------#2021-05-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="56c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对Python字符串有更深的理解</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/31962eca8905187741790b58b460be6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7mUBuPvAWJH6snTN"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·温克勒</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c2bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文本信息是几乎每个应用程序中最常见的数据形式。在Python中，文本数据通常通过使用带有<code class="fe lv lw lx ly b">str</code>类的字符串来表示。使用Python一段时间的人应该对基本的字符串特性有很好的理解。其中一个特征是Python字符串是字符序列，这种说法是如此自然，以至于我们可能认为这是理所当然的。但是，您有没有想过字符串中的字符到底是什么意思？</p><p id="b138" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们先来看下面这个例子。想猜猜绳子<code class="fe lv lw lx ly b">text</code>的长度吗？</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="d783" class="md me it ly b gy mf mg l mh mi">text = 'è'<br/>print(len(text))</span></pre><p id="9834" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你在你的控制台上运行代码，你会发现<code class="fe lv lw lx ly b">'è'</code>的长度是2。这让你吃惊吗？</p><p id="41ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大概是的？如果您不确定结果，可以考虑通过传递字符串来创建一个list对象，如下所示。这个操作是合法的，因为字符串是字符的可迭代对象，list构造函数可以接受一个可迭代对象。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="b758" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; list('è')<br/>['e', '̀']</span></pre><p id="ca5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到文本字符串中有两个字符，它们形成了一个两项列表，如上所示。第二个字符看起来很有趣，因为它应用在第一个单引号的上面，而不是占据单引号之间的位置。想知道为什么会发生这种情况吗？我们继续吧。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="be3f" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">字符Unicode码位</h1><p id="739a" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">在讨论我们看到的代码之前，有必要知道Python字符串由字符组成，而这些字符实际上是Unicode字符，或者更准确地说，是代码点。</p><p id="ca2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不知道，Unicode是一种被广泛采用的表示和处理文本数据的标准。Unicode系统可以编码超过100，000个字符，几乎涵盖了所有的书面语言。一个Unicode字符通常被称为Unicode码位，它被表示为U+后跟四到六个十六进制值。</p><p id="9e03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中，当我们创建一个字符串时，可以直接使用Unicode码位。语法是我们使用<code class="fe lv lw lx ly b">'\u'</code>作为代码点值的前缀。观察下面的一些例子。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="8dfb" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; '\u0045'<br/>'E'<br/>&gt;&gt;&gt; '\u0065'<br/>'e'<br/>&gt;&gt;&gt; '\u2660'<br/>'♠'</span></pre><p id="b9a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，所有这些Unicode点都被正确地转换为它们所代表的相应字符。尽管这些字符串变量看起来不止一个字符，但是如果您检查它们的长度，您会发现事实并非如此。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="156e" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; len('\u0045')<br/>1<br/>&gt;&gt;&gt; len('\u0065')<br/>1<br/>&gt;&gt;&gt; len('\u2660')<br/>1</span></pre><p id="3cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，所有这些字符串的长度都是1。原因很简单:每个字符串只有一个Unicode码位，相当于一个字符。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="7fe5" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">特殊字符</h1><p id="b181" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">我们知道Python中有一些我们使用的特殊字符，它们通常有一个反斜杠前缀。例如，<code class="fe lv lw lx ly b">\t</code>代表水平标签，<code class="fe lv lw lx ly b">\n</code>代表新的一行。你有没有想过它们是否是单个字符(长度为一)？</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="c3b3" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; tab = "\t"<br/>&gt;&gt;&gt; len(tab)<br/>1<br/>&gt;&gt;&gt; newline = "\n"<br/>&gt;&gt;&gt; len(newline)<br/>1</span></pre><p id="68c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，它们都是单个字符。到目前为止，如果您了解Python字符串中的字符是Unicode字符，您可能会认为这些特殊字符应该有相应的Unicode码位。更重要的是，您可以预测它们是等价的，因为在幕后，它们都是Unicode码位。观察下面的效果。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="7425" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; "\u0009" == tab == "\t"<br/>True<br/>&gt;&gt;&gt; "\u000A" == newline == "\n"<br/>True</span></pre><p id="2d0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们应该理解，特殊字符的特殊之处在于，它们并不意味着它们看起来是什么(而不是带有字母<em class="nm"> t </em>或<em class="nm"> n </em>的反斜杠)。然而，特殊字符并不特别，因为它们和其他常规字符一样是Unicode码位。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="b01d" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">解决问题</h1><p id="256d" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">现在我们准备解决开始时提出的问题:为什么一个字符串<code class="fe lv lw lx ly b">'è'</code>的长度是2？</p><p id="0bc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个问题，我想你大概可以有一个很好的答案或者猜测。很可能是字符串<code class="fe lv lw lx ly b">'è'</code>有两个Unicode码位。</p><p id="cd28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">信不信由你，一个字符(从表面上看，比如<code class="fe lv lw lx ly b">'è'</code>)可以由两个基本的Unicode字符组成。为了找出底层的代码点，我们可以使用内置的<code class="fe lv lw lx ly b">ord</code>函数。该函数返回传递给该函数的Unicode字符的码位的整数值，如下所示。请注意，如上所述，字符串<code class="fe lv lw lx ly b">'è'</code>有两个字符，因此我们将对这两个字符分别运行函数。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3d3e" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; ord('è'[0])<br/>101<br/>&gt;&gt;&gt; ord('è'[1])<br/>768</span></pre><p id="f467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你查找任何在线Unicode表，你会发现这两个码位被命名为拉丁文小写字母E和组合重音符，它们对应的十六进制值分别是65和300。有了这些值，我们可以用Unicode码位重构字符串。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="6c9c" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; "\u0065\u0300"<br/>'è'<br/>&gt;&gt;&gt; 'è' == "\u0065\u0300"<br/>True</span></pre><p id="bda9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一个旁注，代码点结合重音符有点不寻常，因为它将在适用的地方结合它的前一个字符。为此，<code class="fe lv lw lx ly b">“\u0065\u0300”</code>恢复一个角色的样子。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2207" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">不要被外表所迷惑</h1><p id="8f4d" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">我们一直在使用字符串<code class="fe lv lw lx ly b">'è'</code>的例子。可能有些人会认为这是带有重音符的拉丁字母<em class="nm"> e </em>。虽然它们看起来是一样的，但是Python对它们的解释是不同的。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="fd8a" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; 'è' == 'è'<br/>False</span></pre><p id="442b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个结果应该不会让您感到惊讶，因为带有重音符的拉丁字母<em class="nm"> e </em>是一个单一的Unicode码位，如下所示。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="2d22" class="md me it ly b gy mf mg l mh mi">&gt;&gt;&gt; '\u00E8'<br/>'è'</span></pre><p id="9e3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将Python字符串理解为Unicode码位序列后，看到<code class="fe lv lw lx ly b">‘è’ == ‘è’</code>就不会奇怪了，因为前者有两个码位，而后者只有一个。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d176" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">结论</h1><p id="a0dd" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">在本文中，我们回顾的中心思想是Python字符串中的字符是Unicode码位。尽管它们看起来可能是一个或多个字符，但它们对基础Unicode码位的实际表示决定了它们是单个字符还是多个字符。</p></div></div>    
</body>
</html>