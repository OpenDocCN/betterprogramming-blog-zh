<html>
<head>
<title>Flutter: TabBar With Buttons as Tabs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Flutter:以按钮作为标签的标签栏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/flutter-tabbar-with-buttons-as-tabs-ios-style-4dff5ae6c055?source=collection_archive---------6-----------------------#2019-08-12">https://betterprogramming.pub/flutter-tabbar-with-buttons-as-tabs-ios-style-4dff5ae6c055?source=collection_archive---------6-----------------------#2019-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="66d5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">就像在IOS应用上看到的那样</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9b4c9b02d232dc029b7862b0dd0050a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tg_9t6oIYGLwSdO2DkFTLg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有两个不同活动标签的结果截图。</p></figure><p id="1ce2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当开发一个应用程序时，我需要一个带有按钮的标签栏。找了一圈，什么都没找到；默认的TabBar小部件没有这个选项，因此，我决定自己制作它。</p><p id="dd5e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(我对Flutter还比较陌生，所以请记住这一点🤓)</p><p id="2f3b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这种类型的TabBar在IOS应用中似乎很常见，但我用的是Android，所以我不确定。无论如何，下面是我想要完成的一个例子(带有按钮的TabBar:“电影”、“电视节目”和“体育”):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/13b62660261563dca8b725004ce3c51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*0PWikLwTOqcc1POZkRw1-g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Apple TV应用程序的屏幕截图。TabBar风格是我的目标。</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="67d9" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结果</h1><p id="b71b" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我能够实现这个结果，它具有我预想的行为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/fd5b96165e0e2122bc3aa17160f9e3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/1*bZkABqMAsrld3U6247wFIw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">开发的TabBar演示。</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="58ec" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">完整代码</strong></h1><p id="343a" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">这是完整的工作代码！你可以随意使用和修改它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="392d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">说明:</strong></p><p id="1b45" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好吧，我希望我能解释一下我是怎么做的。如果最后你还有一些问题，欢迎在下面评论。</p><p id="16f9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，一个人必须启动所有需要的变量和控制器，用于应用程序的动画和控制。选项卡的数量及其对应的图标也在这一部分中选择。</p><p id="b002" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一切都有注释，这样更容易理解。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="3c2f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于应用程序的主体，我使用了脚手架。在<code class="fe mz na nb nc b">appBar</code>、<em class="nd">、</em>中，我使用了一个简单的文本作为标题，在<code class="fe mz na nb nc b">body</code>中，一个<em class="nd">列</em>有两个孩子:一个<code class="fe mz na nb nc b">Container</code>对应于TabBar，另一个<code class="fe mz na nb nc b">Flexible</code>包含<code class="fe mz na nb nc b">TabBarView</code>(我们将显示不同视图的地方)。</p><p id="3d93" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在TabBar中，一个<code class="fe mz na nb nc b">ListView.builder</code>用于创建选项卡按钮。每个选项卡按钮都有自己的<code class="fe mz na nb nc b">key</code>，稍后用于获取每个按钮的位置。每个按钮内部由一个<code class="fe mz na nb nc b">AnimatedBuilder</code>和一个<code class="fe mz na nb nc b">FlatButton</code>构成。<code class="fe mz na nb nc b">AnimatedBuilder</code>允许按钮选择动画的淡入/淡出。</p><p id="66ef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当按下按钮时，会触发制表符更改和滚动动画，并设置当前索引。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="086a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是棘手的部分:处理动画。这非常具有挑战性，但我相信我能够创造出一些工作良好的东西，能够适应不同数量的标签、屏幕大小和方向。</p><p id="c4d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我来分解一下。从标签变化动画时触发的<code class="fe mz na nb nc b">listener</code>开始:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="6972" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">变量<code class="fe mz na nb nc b">_aniValue</code>将包含动画值。想象一下<code class="fe mz na nb nc b">TabViews</code>是多张纸，一张纸的宽度并排放置，这导致一个宽度为N的大矩形，其中N对应于标签的数量。从-0.5到0.5，我们有第一个选项卡，从0.5到1.5，我们有第二个，依此类推。例如，当我们从一个选项卡滑动到另一个选项卡时，我们将动画值从0更改为1，<em class="nd">即</em>，我们将从第一个选项卡滑动到第二个选项卡。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9a2413214390bb025c2a1ce0d8cb4be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Po3ostNwpNLnUaxZaI22dg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">刷卡的处理。</p></figure><p id="bc7f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在另一个函数中处理按钮点击，因此，我们必须确保它不是一个<code class="fe mz na nb nc b">buttonTap</code>。我们还检查前一个动画值和当前动画值之间的差值是否小于1。如果滑动速度太快，会出现一种奇怪的行为，动画值会跳到所需值的旁边。我知道，这很奇怪，但它发生了，以上确保了滑动动画不会跳转值。</p><p id="af76" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，为了确保点击按钮时按钮动画也发生:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="7dde" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">选项卡变化动画是由<code class="fe mz na nb nc b">_controller.animateTo(index)</code>在按钮<code class="fe mz na nb nc b">onPress</code>方法中触发的，因此，本节只触发按钮动画。按钮动画在<code class="fe mz na nb nc b">_setCurrentIndex()</code>内触发:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="9252" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一种方法用更新的索引设置新的<em class="nd"> </em> <code class="fe mz na nb nc b">State</code>，触发按钮的淡入/淡出以及滚动动画:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="8930" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果可能的话，如果我们有一个可滚动类型的TabBar，<em class="nd">即</em>，如果按钮的数量不适合屏幕宽度，TabBar会尝试将每个按钮居中。如果不需要滚动，就没有滚动。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a36c07eeef7f1f5ce3035c30d68b5470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/1*_DukqUtKOClti4EluuNyjw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按钮开关的操作。</p></figure><p id="2f20" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">代码首先检查按钮离屏幕中间有多远。如果它在左边，它会检查按钮的左边是否有足够的空间，这样它就可以滚动TabBar并使按钮居中。第一个选项卡按钮的左侧不会离开屏幕的左侧。如果按钮在中间屏幕的右边，也要做同样的事情，而且要确保最后一个标签按钮的右边不会离开屏幕的右边。</p><p id="b257" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是所有的人！我将在这里再举一个例子，说明TabBar如何处理更少的标签并对方向变化做出反应。我希望您会发现这很有用，并且可以节省一些工作和调试时间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/473422cb43584d0e2cb4af0db7b8564d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*mHfaQJA1GqAaEBRT9-eNmA.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">TabBar使用较少数量的选项卡，并对方向变化做出反应。</p></figure><p id="0184" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完整代码:</p><div class="nf ng gp gr nh ni"><a href="https://github.com/Afonsocraposo/TabBar-with-Button-Tabs-IOS-style-" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">afonscorposo/TabBar-带按钮标签-IOS风格-</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">在GitHub上创建一个帐户，为afonscoproso/TabBar-with Button-Tabs-IOS-style-development做贡献。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw kp ni"/></div></div></a></div><blockquote class="nx ny nz"><p id="54be" class="kv kw nd kx b ky kz jr la lb lc ju ld oa lf lg lh ob lj lk ll oc ln lo lp lq ij bi translated">我最近在2020年4月24日的<a class="ae od" href="https://pub.dev/" rel="noopener ugc nofollow" target="_blank">https://pub.dev/</a>上发布了这个项目:</p></blockquote><div class="nf ng gp gr nh ni"><a href="https://pub.dev/packages/buttons_tabbar" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">buttons_tabbar | Flutter包</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">开源的Flutter包，tabbar，其中每个标签指示器都是一个切换按钮。由Afonso Raposo制作。查看完整的…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">公共开发</p></div></div><div class="nr l"><div class="oe l nt nu nv nr nw kp ni"/></div></div></a></div></div></div>    
</body>
</html>