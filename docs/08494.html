<html>
<head>
<title>How To Use Miniconda With Python and JupyterLab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Miniconda与Python和JupyterLab结合使用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-miniconda-with-python-and-jupyterlab-5ce07845e818?source=collection_archive---------2-----------------------#2021-05-06">https://betterprogramming.pub/how-to-use-miniconda-with-python-and-jupyterlab-5ce07845e818?source=collection_archive---------2-----------------------#2021-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce2e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从头开始设置极简Python环境</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c132e20359683d6f9d2360b7bf834137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hoixyA2jRF7izlbG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">达里奥·沃尔夫在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8b86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Miniconda 是一个最小的conda安装程序，只包含Python、conda及其依赖项。Miniconda允许您通过安装成千上万个附加软件包中的附加软件包来创建定制的环境。您可以为每个项目创建单独的环境，并轻松地与其他人共享您的环境，以便于复制。使用conda，您可以在本地机器上创建一个环境，并无缝地将其复制到大型共享高性能计算机(HPC)上。</p><p id="4f47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将概述安装和使用Miniconda创建和管理定制环境、安装包以及将这些环境移动到远程计算机所需的一切。Miniconda让您处于控制之中，不会根据您的需要安装不必要的包，这可能会带来一个全面的Anaconda 安装。</p><h2 id="3297" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">目录</strong></h2><ul class=""><li id="40c1" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu mv mw mx my bi translated"><a class="ae ky" href="#6c8a" rel="noopener ugc nofollow">安装</a></li><li id="c634" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#0229" rel="noopener ugc nofollow">基础知识</a></li><li id="9cbc" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#5cd1" rel="noopener ugc nofollow">安装包</a></li><li id="679f" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#73e3" rel="noopener ugc nofollow">创建自定义环境</a></li><li id="2a17" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#3963" rel="noopener ugc nofollow">使用带有JupyterLab的环境</a></li><li id="35b8" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#1c6a" rel="noopener ugc nofollow">将环境迁移到新计算机上</a></li><li id="60a6" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">修复和清洁你的环境</li><li id="a55b" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#6ddc" rel="noopener ugc nofollow">修改condarc文件</a></li><li id="9566" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><a class="ae ky" href="#b1f7" rel="noopener ugc nofollow">最终想法</a></li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="6c8a" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">装置</h1><p id="aa1a" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">首先，<a class="ae ky" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank">为您的系统下载</a>Miniconda安装程序。使用<code class="fe nz oa ob oc b">wget</code>或<code class="fe nz oa ob oc b">cURL</code>复制安装程序脚本。下面是一个使用<code class="fe nz oa ob oc b">wget</code>将64位Linux安装程序复制到当前工作目录的例子。<code class="fe nz oa ob oc b">-O</code>标志将文件重命名为<code class="fe nz oa ob oc b">miniconda.sh</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/443b3b4f9fa82172e7f43c69c09f1c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P09V1li_K0Kd1Oieijq4pQ.png"/></div></div></figure><p id="92bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制完成后，运行安装程序脚本并按照屏幕上的说明进行操作。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="8345" class="lv lw it oc b gy oi oj l ok ol">bash miniconda.sh</span></pre><p id="686b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统将提示您:</p><ol class=""><li id="f5d8" class="mo mp it lb b lc ld lf lg li om lm on lq oo lu op mw mx my bi translated">接受许可条款。</li><li id="6915" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">选择安装位置。<br/> - <code class="fe nz oa ob oc b">$HOME</code>是默认位置，但是你可以选择任何位置。<br/> -如果您要在空间有限的<code class="fe nz oa ob oc b">$HOME</code>共享计算机上安装，您应该选择不同的位置。</li><li id="c924" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">初始化Miniconda。<br/> -【是】将更新你的<code class="fe nz oa ob oc b">.bashrc</code>文件中的<code class="fe nz oa ob oc b">$PATH</code>变量。我推荐这个选项。<br/> -【否】要求您手动更新<code class="fe nz oa ob oc b">$PATH</code>:<br/><code class="fe nz oa ob oc b">export PATH=”$HOME/miniconda/bin:$PATH”</code></li><li id="f9d9" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">重启您的终端或源文件<code class="fe nz oa ob oc b">.bashrc</code>以使更改生效。</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="0229" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">基础知识</h1><p id="9762" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在康达已经安装好了，我们可以开始探索了。第一个尝试的命令是<code class="fe nz oa ob oc b">conda info</code>。这将显示关于您的conda安装的信息，例如安装位置、环境所在的位置、您的conda版本以及大量其他信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/887cc8ddb9309c5382821cb7b1020ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6CVjraq2f-P0vk0ZtuZTA@2x.png"/></div></div></figure><p id="c9e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe nz oa ob oc b">conda info --envs</code>只显示您的环境。注意<code class="fe nz oa ob oc b">conda env list</code>达到了相同的结果。一开始，你只会看到<code class="fe nz oa ob oc b">base</code>环境。如果您没有首先激活环境或明确指定软件包的安装位置，这就是软件包的安装位置。</p><p id="db69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是两种环境下的输出示例:<code class="fe nz oa ob oc b">base</code>和<code class="fe nz oa ob oc b">test</code>。环境的名称在左边，位置在右边。<code class="fe nz oa ob oc b">*</code>表示当前活动的环境。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/806f16e3bce30b5f9f107140c863d798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDeNsoG7vx6Et-JHDeCGqg.png"/></div></div></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="5cd1" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">安装软件包</h1><p id="2be0" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">Miniconda极其简约，要求你安装你需要的包，而不仅仅是像<a class="ae ky" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>这样常用的包。您可以使用<code class="fe nz oa ob oc b">conda install</code>命令后跟软件包名称来安装软件包。</p><p id="9df9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是安装NumPy的方法:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="c549" class="lv lw it oc b gy oi oj l ok ol">conda install numpy</span></pre><p id="743f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在安装开始之前，它总是提示将安装哪些依赖项，以及将升级或降级哪些包。这让您知道是否要安装。</p><p id="6387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您不必一次安装一个软件包。相反，您可以一次指定多个包。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="b950" class="lv lw it oc b gy oi oj l ok ol">conda install xarray netcdf4</span></pre><p id="feaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">包从远程<a class="ae ky" href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html" rel="noopener ugc nofollow" target="_blank">通道</a>下载，这些通道是包含包的目录的URL。这很重要，因为不是所有的包都在默认通道中。您可以使用<code class="fe nz oa ob oc b">-c</code>标志指定不同的通道。在这个例子中，我从社区驱动的<a class="ae ky" href="https://conda-forge.org" rel="noopener ugc nofollow" target="_blank"> conda-forge </a>渠道安装NumPy。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="1d23" class="lv lw it oc b gy oi oj l ok ol">conda install numpy -n base -c conda-forge</span></pre><p id="ef61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nz oa ob oc b">-n</code>标志指定软件包将被安装在哪个环境中。如果不指定此标志，软件包将安装在活动环境中。但是，我认为在这里明确一点是个好主意。</p><h2 id="fe18" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">列出包</h2><p id="d67c" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">您可以列出当前安装的所有软件包，如下所示:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="a364" class="lv lw it oc b gy oi oj l ok ol">conda list</span></pre><h2 id="a657" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">取出包裹</h2><p id="98ae" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">移除软件包就像安装一样简单。下面是一个删除包的示例。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="1926" class="lv lw it oc b gy oi oj l ok ol">conda remove numpy -n base -c conda-forge</span></pre><p id="bbec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像安装一个包一样，我认为明确您要从哪个环境中移除包以及使用哪个通道是一个好主意。</p><h2 id="d01d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">安装或删除软件包时出错？</h2><p id="5310" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">如果您在安装软件包时收到错误，您可以尝试以下两种方法:</p><ol class=""><li id="3197" class="mo mp it lb b lc ld lf lg li om lm on lq oo lu op mw mx my bi translated">更新conda: <code class="fe nz oa ob oc b">conda update -n base -c defaults conda</code> <br/>注意使用<code class="fe nz oa ob oc b">-n</code>和<code class="fe nz oa ob oc b">-c</code>标志来指定环境和通道。</li><li id="ba9a" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">从不同的频道安装或移除。最好从您安装的频道中删除软件包。</li></ol><p id="d68d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">康达锻造公司通常拥有最新版本。您可以从conda-forge通道安装，如下所示:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="6e86" class="lv lw it oc b gy oi oj l ok ol">conda install numpy -n base -c conda-forge</span></pre><p id="23fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者像这样删除从conda-forge安装的包:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="0274" class="lv lw it oc b gy oi oj l ok ol">conda remove numpy -n base -c conda-forge</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="73e3" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">创建自定义环境</h1><p id="9acb" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">有些人喜欢为每个项目提供不同的环境，或者为特定的任务提供不同的环境。例如，可能一个专门用于机器学习，另一个专门用于使用<a class="ae ky" href="https://xesmf.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> xESMF </a>重新划分数据。</p><p id="f765" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用环境的另一种方式是拥有一个干净的基础环境和一个单独的开发环境，以确保在添加新包时没有冲突。</p><p id="cb20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论您如何使用环境，创建环境的方式都是一样的。下面是如何使用Python版创建一个名为myenv的新环境。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="4b56" class="lv lw it oc b gy oi oj l ok ol">conda create --name myenv python=3.7</span></pre><p id="6941" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">指定Python版本时注意<code class="fe nz oa ob oc b">=</code>与<code class="fe nz oa ob oc b">==</code>:</p><ul class=""><li id="36e7" class="mo mp it lb b lc ld lf lg li om lm on lq oo lu mv mw mx my bi translated"><code class="fe nz oa ob oc b">python=3.7</code>告诉conda使用Python 3.7树中的最新版本。例如，如果最新版本是Python 3.7.6，那么将安装该版本。</li><li id="a898" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated"><code class="fe nz oa ob oc b">python==3.7</code>告诉conda使用那个版本，Python 3.7。</li></ul><p id="90cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在任何想要使用环境的时候激活环境:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="7675" class="lv lw it oc b gy oi oj l ok ol">source activate myenv</span></pre><p id="e404" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以像以前一样安装软件包，并指定环境(<code class="fe nz oa ob oc b">-n</code>)和通道(<code class="fe nz oa ob oc b">-c</code>)。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="012c" class="lv lw it oc b gy oi oj l ok ol">conda install numpy -n myenv -c conda-forge</span></pre><p id="7f20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，您可以像这样停用环境:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="c17e" class="lv lw it oc b gy oi oj l ok ol">conda deactivate</span></pre><p id="5c9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想复制一个现有的环境，也许是为了测试一个新的包的行为，你可以在创建它的时候传递<code class="fe nz oa ob oc b">--clone</code>标志。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="d559" class="lv lw it oc b gy oi oj l ok ol">conda create --clone myenv --name myenv2</span></pre><p id="144a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把myenv中安装的所有包复制到myenv2中。请注意，这将复制包；它不共享它们。换句话说，删除其中一个环境不会影响另一个环境。</p><p id="4206" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">克隆基本环境与克隆任何其他环境是一样的。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="5f24" class="lv lw it oc b gy oi oj l ok ol">conda create --clone base --name baseclone</span></pre><p id="a45a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要删除一个环境，您可以这样做:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="623c" class="lv lw it oc b gy oi oj l ok ol">conda env remove --name baseclone</span></pre><p id="6312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将删除baseclone及其包含的包。</p><h2 id="7d5a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">列出环境</h2><p id="bbcd" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">记住，如果你忘记了你创建了哪些环境，你可以用<code class="fe nz oa ob oc b">conda env list</code>来显示它们。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="3963" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">使用带有JupyterLab的环境</h1><p id="ce6f" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">您不能立即使用带有<a class="ae ky" href="https://jupyter.org/documentation" rel="noopener ugc nofollow" target="_blank"> JupyterLab </a>的环境。这涉及到一点点设置。首先，您需要安装JupyterLab。你可以用<code class="fe nz oa ob oc b">conda install jupyterlab -c conda-forge</code>安装JupyterLab。</p><p id="b95c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后按照这些说明将环境转换成内核，这样您就可以在Jupyter笔记本中使用它。</p><ol class=""><li id="e26b" class="mo mp it lb b lc ld lf lg li om lm on lq oo lu op mw mx my bi translated">激活环境:<code class="fe nz oa ob oc b">source activate myEnv</code>。</li><li id="62ce" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">安装ipykernel: <code class="fe nz oa ob oc b">conda install ipykernel</code>。</li><li id="e303" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu op mw mx my bi translated">运行这个命令:<code class="fe nz oa ob oc b">python -m ipykernel install --user --name myEnv --display-name “my_environment”</code>。</li></ol><p id="d76b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，<code class="fe nz oa ob oc b">--name</code>指定了环境名，<code class="fe nz oa ob oc b">--display-name</code>是将在JupyterLab中显示的内核名。在您启动JupyterLab之后，您会看到<code class="fe nz oa ob oc b">my_envionrment</code>作为一个内核选项。选择此项将在myEnv环境中运行命令。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="5132" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">将环境移动到新计算机</h1><p id="5cb9" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">假设您有一个在笔记本电脑上工作的环境，您想将该环境转移到HPC上。您可以从一个<a class="ae ky" href="https://conda.io/projects/conda/en/latest/user-guide/concepts/environments.html#create-environment-file-by-hand" rel="noopener ugc nofollow" target="_blank">环境文件</a>中创建，而不是浪费时间手动安装每个包。</p><p id="68e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，您首先需要从笔记本电脑上的环境中创建您的<code class="fe nz oa ob oc b">environment.yml</code>文件:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="c53a" class="lv lw it oc b gy oi oj l ok ol">conda env export --name myEnv &gt; environment.yml</span></pre><p id="96ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会将<code class="fe nz oa ob oc b">myEnv</code>环境导出到一个名为<code class="fe nz oa ob oc b">environment.yml</code>的文件中。可以直接用name标志指定环境，也可以先激活环境，然后去掉<code class="fe nz oa ob oc b">--name myEnv</code>部分:<code class="fe nz oa ob oc b">conda env export&gt; environment.yml</code>。下面是一个<code class="fe nz oa ob oc b">environment.yml</code>文件的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/075b0c4ca369144c4218df6010d0940a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAacSkcdbseS29hkcFjO_g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">environment.yml文件示例</p></figure><p id="dd91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您可以使用<code class="fe nz oa ob oc b">scp</code>将<code class="fe nz oa ob oc b">environment.yml</code>文件移动到您的HPC。然后，在您安装conda之后，您可以从这样的文件创建您的新环境:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="56ee" class="lv lw it oc b gy oi oj l ok ol">conda env create --file environment.yml</span></pre><p id="c560" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将下载并安装所有的软件包及其依赖项。没有必要指定名称，因为它已经在<code class="fe nz oa ob oc b">environment.yml</code>中声明了。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="dca2" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">修复和清理您的环境</h1><h2 id="21af" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">恢复到以前的版本</h2><p id="255a" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">我们必须记住Python是免费和开源的，包是社区驱动的。有时当我们安装一个包时，它与已经安装的包并不匹配。值得庆幸的是，康达有记忆，我们可以恢复到我们的环境以前的版本。</p><p id="9ed6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将列出所有的修订和修改的内容。</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="61e4" class="lv lw it oc b gy oi oj l ok ol">conda list --revisions</span></pre><p id="e680" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用(版本)号，我们可以恢复到以前的版本，如下所示:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="1c28" class="lv lw it oc b gy oi oj l ok ol">conda install --revision 0</span></pre><p id="badc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在环境就像(rev 0)一样。</p><p id="0786" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是修订清单的一个例子。这将显示分别使用<code class="fe nz oa ob oc b">+ </code>和<code class="fe nz oa ob oc b">-</code>安装和移除的软件包。版本和频道变化用<code class="fe nz oa ob oc b">-&gt;</code>表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4b5acab0179187e12f31ec179d23b8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5SGIhGQcqZPgHKD16Tcew.png"/></div></div></figure><h2 id="26bf" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">删除缓存的包tarballs</h2><p id="d6d4" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">你创造的环境越多，你获得的tarballs就越多。你可以像这样去掉所有不需要的tarballs:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="24ad" class="lv lw it oc b gy oi oj l ok ol">conda clean --tarballs</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="6ddc" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">修改condarc文件</h1><p id="50b9" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在你已经知道如何使用conda，我想谈的最后一个主题是如何修改你的<code class="fe nz oa ob oc b">.condarc</code>文件。例如，如果您喜欢从特定的渠道下载，如conda-forge，这是很有用的。然后，您可以将conda-forge添加到要搜索的默认频道列表中。</p><p id="b86a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以将conda-forge频道添加到您的<code class="fe nz oa ob oc b">.condarc</code>文件中，如下所示:</p><pre class="kj kk kl km gt oe oc of og aw oh bi"><span id="41da" class="lv lw it oc b gy oi oj l ok ol">conda config --append channels conda-forge</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="b1f7" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">最后的想法</h1><p id="9076" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">本文提供了使用conda管理环境所需的大部分知识。每个命令都有比我讨论的更多的标志，这些标志可以在<a class="ae ky" href="https://docs.conda.io/projects/conda/en/latest/commands.html#conda-general-commands" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><p id="b398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文档还提供了一个方便的<a class="ae ky" href="https://docs.conda.io/projects/conda/en/latest/user-guide/cheatsheet.html?highlight=cheat%20sheet" rel="noopener ugc nofollow" target="_blank">备忘单</a>，它概述了一些常见的命令。</p><p id="d400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Miniconda的好处是能够在计算机之间移动环境。作为一个在多台机器上工作的人，我发现Miniconda可以无缝地移动环境。</p><p id="37d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了将环境转移到新计算机上，我还可以在共享项目时将环境文件转移给其他人。这确保了环境是稳定的，代码会像其他人期望的那样运行，这对于可再现性是非常重要的。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="c85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ou">感谢阅读和支持媒体作者</em></p><div class="ov ow gp gr ox oy"><a href="https://lukegloege.medium.com/membership" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">通过我的推荐链接加入Medium—Luke Gloege博士</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">lukegloege.medium.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ks oy"/></div></div></a></div></div></div>    
</body>
</html>