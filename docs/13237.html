<html>
<head>
<title>Localise Your Go App With Package Text</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用包文本本地化您的Go应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/localise-your-go-app-with-package-text-4a78a641fafc?source=collection_archive---------10-----------------------#2022-08-09">https://betterprogramming.pub/localise-your-go-app-with-package-text-4a78a641fafc?source=collection_archive---------10-----------------------#2022-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="085c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建您的应用程序，走向世界</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f54845c1dc7217856ff2636f91b7a5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ECBGXP8xwoTDMtlXMdcXnQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">作者图片</p></figure><p id="bd28" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从本质上说，本地化使一个应用程序能够到达多个全球市场。“本地化”是使软件适应最终用户的文化和语言的过程这包括设计和UX的变化，以吸引最终用户。这包括适当的文本翻译，甚至删除潜在的攻击性内容。</p><p id="a75e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，阿拉伯国家从右向左书写，而大多数西方国家从左向右书写。Go有一个本地化库；它是其子存储库的一部分。这个模块有一个路径<code class="fe ln lo lp lq b">golang.org/x/text</code>。在这篇文章中，我将它称为<code class="fe ln lo lp lq b">text</code>包。包<code class="fe ln lo lp lq b">text</code>使开发人员能够按照功能或面向对象编程模型添加本地化。它支持打印格式化字符串，这是一个游戏改变者。</p><p id="89d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它还能识别单个单词并翻译它们。在这篇文章中，我将详细介绍我实现本地化程序的方法。</p><h1 id="5c8b" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">基本示例</h1><p id="cbdd" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">对于我的用例，我将编写将英语翻译成法语的Go代码。作为两种语言的母语使用者，我理解机器翻译的文本有时会不连贯。这将是显而易见的，因为你读了这篇文章。下面是初始代码:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="1342" class="ms ls iq lq b gy mt mu l mv mw">package main</span><span id="2f74" class="ms ls iq lq b gy mx mu l mv mw">import (<br/> "golang.org/x/text/message"<br/> "golang.org/x/text/language"</span><span id="6449" class="ms ls iq lq b gy mx mu l mv mw">"fmt"<br/>)</span><span id="7ca8" class="ms ls iq lq b gy mx mu l mv mw">func main(){</span><span id="d9d3" class="ms ls iq lq b gy mx mu l mv mw">  message.SetString(<br/>    language.French,<br/>    "The %m car",<br/>    "La voiture %m",<br/>  )<br/>}</span></pre><p id="9592" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于这个例子，我采用功能方法来添加本地化。我调用message的<code class="fe ln lo lp lq b">SetString</code>函数来教程序如何翻译一个特定的字符串。动词<code class="fe ln lo lp lq b">%m</code>将显示翻译后的文本。如果你注意到动词<code class="fe ln lo lp lq b">%m</code>转换了法语翻译的位置。这说明了一个简单的句子在另一种语言中是如何重组的。我想要一个动词<code class="fe ln lo lp lq b">%m</code>来显示一种颜色，但是这个程序不知道法国的颜色。为了教授该程序，我将添加以下几行:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="048d" class="ms ls iq lq b gy mt mu l mv mw">message.SetString(<br/>  language.French,<br/>  "green",<br/>  "vert",<br/>)</span></pre><p id="822f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与我之前对<code class="fe ln lo lp lq b">SetString</code>的调用不同，我只添加了一个单词。这展示了这个包的威力，因为我不需要添加句子<code class="fe ln lo lp lq b">The %m car</code>的多个变体。为了显示本地化的文本，我将运行下面的代码:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="076f" class="ms ls iq lq b gy mt mu l mv mw">p := message.NewPrinter(language.French)<br/>fmt.Println( p.Sprintf("The %m car", "green") ) // prints La voiture vert<br/>fmt.Println( p.Sprintf("The %m car", "red")  ) // prints La voiture red</span></pre><p id="9fc1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是终端的输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/20d540585d6020ec8fd5d3461c08e538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*755zSc9IQxMel1uD.gif"/></div></figure><p id="39d0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您注意到第二行打印为<code class="fe ln lo lp lq b">La voiture red</code>。我还没有教程序翻译红色这个词。我还可以毫不费力地管理句子结构，这是这个软件包的另一个好处。这是基本的例子。这是一个复杂的问题。</p><h1 id="5c02" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">跟踪复数形式</h1><p id="cc3a" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">我经常构建和看到“错误生成文本”的程序例如，我曾经构建了一个警报组件，该组件的标题有时会显示为<code class="fe ln lo lp lq b">You have 1 notifications left</code>。这个句子不正确，因为notification是复数形式。<code class="fe ln lo lp lq b">text</code>有一个专门的特性，这将是我的下一个例子。代替调用<code class="fe ln lo lp lq b">SetString</code>，我将使用函数<code class="fe ln lo lp lq b">Set</code>来纠正上述的多数问题。这个例子不涉及任何翻译。下面是<code class="fe ln lo lp lq b">Set</code>的函数签名:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="58b1" class="ms ls iq lq b gy mt mu l mv mw">func Set(tag <a class="ae mz" href="https://pkg.go.dev/golang.org/x/text@v0.3.7/language" rel="noopener ugc nofollow" target="_blank">language</a>.<a class="ae mz" href="https://pkg.go.dev/golang.org/x/text@v0.3.7/language#Tag" rel="noopener ugc nofollow" target="_blank">Tag</a>, key <a class="ae mz" href="https://pkg.go.dev/builtin#string" rel="noopener ugc nofollow" target="_blank">string</a>, msg ...<a class="ae mz" href="https://pkg.go.dev/golang.org/x/text@v0.3.7/message/catalog" rel="noopener ugc nofollow" target="_blank">catalog</a>.<a class="ae mz" href="https://pkg.go.dev/golang.org/x/text@v0.3.7/message/catalog#Message" rel="noopener ugc nofollow" target="_blank">Message</a>) <a class="ae mz" href="https://pkg.go.dev/builtin#error" rel="noopener ugc nofollow" target="_blank">error</a></span></pre><p id="e20d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该函数与<code class="fe ln lo lp lq b">SetString</code>非常相似，除了<code class="fe ln lo lp lq b">msg</code>参数。这就是我如何告诉程序如何处理复数单词。这是初始代码:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="ee52" class="ms ls iq lq b gy mt mu l mv mw">package main</span><span id="e1b4" class="ms ls iq lq b gy mx mu l mv mw">import (<br/> "golang.org/x/text/message"<br/> "golang.org/x/text/feature/plural"<br/> "golang.org/x/text/language"</span><span id="efa6" class="ms ls iq lq b gy mx mu l mv mw">"fmt"<br/>)</span><span id="b430" class="ms ls iq lq b gy mx mu l mv mw">func main(){<br/> <br/>    message.Set(language.English, "You are %d minute(s) late.",<br/>    plural.Selectf(1, "",<br/>        plural.One, "You are 1 minute late.",<br/>        plural.Other, "You are %d minutes late."),<br/>    )</span><span id="cb08" class="ms ls iq lq b gy mx mu l mv mw">    p2 := message.NewPrinter(language.English)<br/>    fmt.Println( p2.Sprintf("You are %d minute(s) late.", 1 )  )<br/>    fmt.Println( p2.Sprintf("You are %d minute(s) late.", 5 )  )</span><span id="d66c" class="ms ls iq lq b gy mx mu l mv mw">}</span></pre><p id="fab7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您注意到上面，有一个名为<code class="fe ln lo lp lq b">Selectf</code>的包函数被调用。"<code class="fe ln lo lp lq b">Selectf</code>返回其选择器匹配的第一个事例。"在这种情况下，有两个选择器:</p><ul class=""><li id="e4c8" class="na nb iq kt b ku kv kx ky la nc le nd li ne lm nf ng nh ni bi translated"><code class="fe ln lo lp lq b">plural.One</code>表示所提供的整数为1的情况。</li><li id="f52d" class="na nb iq kt b ku nj kx nk la nl le nm li nn lm nf ng nh ni bi translated"><code class="fe ln lo lp lq b">plural.Other</code>用以表示任何其他整数值。</li></ul><p id="4a77" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是实际运行的代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/eb2564d7004a331d3f157cec74c3b8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*oHeQoEV6tXz77cgC.gif"/></div></figure><p id="f38a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是<code class="fe ln lo lp lq b">Selectf</code>的函数签名:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="9f87" class="ms ls iq lq b gy mt mu l mv mw">func Selectf(arg int, format string, cases ...interface{}) catalog.Message</span></pre><p id="a114" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在定义事例时，您将定义选择器，下面的参数将是该选择器的文本。例如，当传递整数<code class="fe ln lo lp lq b">1</code>时，添加文本将是<code class="fe ln lo lp lq b">Selectf(...,plural.One, "Format for one",...)</code></p><h1 id="cdf2" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">公用事业</h1><p id="adef" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">这是这个图书馆的锦上添花。它可以自动提取程序中的所有文本。这消除了手动查找每个应该本地化的文本的需要。它还有一个用本地化文本打印机自动替换所有fmt调用的命令。然而，该程序不支持Go 1.18，所以我不会在这篇文章中演示它。</p><h1 id="37f1" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">结论</h1><p id="3b29" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">在一个高度全球化的世界里，开发者必须本地化他们的应用程序以渗透特定的市场。本地化您的应用程序将确保运行您的程序的消费者理解它。包<code class="fe ln lo lp lq b">text</code>是Go团队的本地化实现。这个包最近一次发布是在2021年8月，迫使我去琢磨它的稳定性。</p><p id="44c5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">值得注意的是，包<code class="fe ln lo lp lq b">text</code>有开源的替代方案。这是我为一个有趣而强大的本地化包带来光明的尝试。还有其他方法来实现这个包。这是我对这个问题的看法。你可以在下面找到这个包的链接。</p><h1 id="6f46" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated"><strong class="ak">附加链接</strong></h1><p id="6bd3" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated"><a class="ae mz" href="https://www.lionbridge.com/blog/content-transformation/what-is-software-localization-and-who-needs-it/" rel="noopener ugc nofollow" target="_blank">https://www . lionbridge . com/blog/content-transformation/what-is-software-localization-and-who-needs-it</a></p><div class="no np gp gr nq nr"><a href="https://github.com/cheikhshift/medium_examples/tree/main/locale" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">medium _ examples/main cheikh shift/medium _ examples的区域设置</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">中型文章的代码示例。在GitHub上创建一个帐户，为cheikhshift/medium_examples开发做贡献。</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kl nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://pkg.go.dev/golang.org/x/text@v0.3.7/message#hdr-Translation_Pipeline" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">消息</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">包消息实现本地化字符串的格式化I/O，其功能类似于fmt的打印功能…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">pkg.go.dev</p></div></div></div></a></div></div></div>    
</body>
</html>