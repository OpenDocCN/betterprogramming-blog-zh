<html>
<head>
<title>React Custom Hooks With Real-Life Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用现实生活中的例子来反应定制钩子</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/react-custom-hooks-with-real-life-examples-c259139c3d71?source=collection_archive---------0-----------------------#2022-01-20">https://betterprogramming.pub/react-custom-hooks-with-real-life-examples-c259139c3d71?source=collection_archive---------0-----------------------#2022-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0c4b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用现实生活中的例子来反应定制钩子</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cc2553f32cb774ba1a431874580ef1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Je0MEavgPN2CjZYRwcdjGg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@scottwebb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">斯科特·韦伯</a>在<a class="ae kv" href="https://unsplash.com/s/photos/custom-hook?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="98c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React无处不在，钩子的使用已经成为新的“标准”。<br/>然而，不知何故,“定制挂钩”对React开发人员来说听起来仍然很吓人。<br/>所以这篇文章会帮助你认识到这一点都不可怕。相反，这很简单，它让我们的生活变得更容易，几分钟后你就可以在你的项目中构建一个有用的定制钩子。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="3c88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解释什么是自定义钩子的文章不在少数，但是行动胜于雄辩。<br/>在本文中，我将展示真实项目中的例子，并解释——我们客户的需求是什么，为什么我们认为使用定制挂钩是合适的，以及最重要的——我们做了什么<strong class="ky ir"/>？</p><p id="e232" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lz">本文假设您已经了解React中的钩子。<br/>如果你还没有时间学习—</em><a class="ae kv" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"><em class="lz">React</em></a><em class="lz">中的文档非常优秀。</em></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="ddfc" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">什么是定制挂钩？</h1><p id="a7e2" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">自定义钩子是函数。通常，它们以“使用”一词开始(重要的约定)。</p><blockquote class="mx my mz"><p id="079d" class="kw kx lz ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated">与React组件不同，自定义挂钩不需要有特定的签名。我们可以决定它接受什么作为参数，以及它应该返回什么(如果有的话)。换句话说，它就像一个普通的函数</p></blockquote><p id="cf79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自定义钩子允许我们以钩子的形式访问React生态系统，这意味着我们可以访问所有已知的钩子，如useState、useMemo、useEffect等。这个机制支持逻辑和视图的分离。</p><h1 id="b23f" class="ma mb iq bd mc md nd mf mg mh ne mj mk jw nf jx mm jz ng ka mo kc nh kd mq mr bi translated">你为什么要用它？</h1><blockquote class="mx my mz"><p id="0a5b" class="kw kx lz ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated">当我们想要在两个JavaScript函数之间共享逻辑时，我们将它提取到第三个函数中。组件和钩子都是函数，所以这对它们也适用！—反应文档。</p></blockquote><p id="4e23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设在开发过程中，您遇到了不得不使用<code class="fe ni nj nk nl b">useEffect</code>和<code class="fe ni nj nk nl b">useState</code>的情况。</p><p id="45c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">过了一段时间，您意识到您需要在另一个组件中使用相同的逻辑<code class="fe ni nj nk nl b">useEffect</code>和<code class="fe ni nj nk nl b">useState</code>。<br/>你可以复制代码，但是大概告诉自己一定有更好的方法，那么你会怎么做？定制吊钩进行救援<strong class="ky ir">😎</strong>。</p><p id="1d31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用定制挂钩有几个优点:</p><ul class=""><li id="7363" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated"><strong class="ky ir">可重用性</strong> —我们可以一次又一次的使用同一个钩子，不需要写两遍。</li><li id="6115" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><strong class="ky ir">干净的代码</strong> —将所有的组件逻辑提取到一个钩子中会提供一个更干净的代码库。</li><li id="206c" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><strong class="ky ir">可维护性</strong> —更容易维护。如果我们需要改变钩子的逻辑，我们只需要改变一次。</li><li id="8ecc" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">伟大的社区——很有可能有人已经创造出了你所想的那个钩子。网络上充斥着大量的定制钩子！你可以根据自己的需要找到一个挂钩，照原样使用它，甚至更好——你可以把它作为一个起点，让它变得棒极了！</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d4ae" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">让我们言归正传</h1><p id="907a" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">好吧，本，你说服我了。我知道定制钩子很酷也很有用，但是我在哪里可以使用它们，为什么？</p><p id="172b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以下面的例子来自真实的项目(在<a class="ae kv" href="https://webiks.com/" rel="noopener ugc nofollow" target="_blank"> Webiks </a>我们高度拥护和热爱React)。在每个例子中，我将描述需求，为什么我们决定将它实现为一个定制的钩子，以及代码本身。</p><h2 id="f70d" class="oa mb iq bd mc ob oc dn mg od oe dp mk lf of og mm lj oh oi mo ln oj ok mq ol bi translated">示例#1 — Enter/Esc按钮挂钩</h2><p id="5b5d" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在这个例子中，我们开发的app包含了很多<a class="ae kv" href="https://uxframework.pearson.com/c/modal" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">’</strong>模态<strong class="ky ir">’</strong></a>交互。大多数情态动词包含“同意”和“取消”按钮。要求是使用“Enter”键提交更改并关闭模式，类似于“同意”按钮的行为，使用“Esc”键放弃更改并关闭模式，类似于“取消”按钮的行为。</p><p id="9024" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道我们需要为按键添加事件监听器，并在按键时调用一个函数。我们也知道我们将在这个任务中使用<code class="fe ni nj nk nl b">useEffect</code>(因为我们需要注册一个监听器到组件挂载上的“DOM”又名“side <strong class="ky ir"> effect </strong>”,并在组件卸载时进行清理)，但是在20个不同的模态中添加2个useEffects并不是处理这个问题的正确方法。</p><p id="38ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们决定创建一个自定义挂钩— <code class="fe ni nj nk nl b">useEnterEscButtonsHook</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="c5ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个钩子中，我们传递确认和取消功能作为按下Esc和Enter按钮时使用的道具(注意<code class="fe ni nj nk nl b">handleCancel</code>和<code class="fe ni nj nk nl b">handleConfirm</code>与实际按钮(视图)无关，以确保<a class="ae kv" href="https://en.wikipedia.org/wiki/Separation_of_concerns" rel="noopener ugc nofollow" target="_blank">关注点分离</a>)。</p><p id="c996" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们用这个线性代码在每个模态中使用它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/4654fc8c0ce7043cb19aa73d52807ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnGkRa-JRNNNaceDudPjPA.png"/></div></div></figure><h2 id="1304" class="oa mb iq bd mc ob oc dn mg od oe dp mk lf of og mm lj oh oi mo ln oj ok mq ol bi translated"><strong class="ak">示例# 2——使用了反钩</strong></h2><p id="b15c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们的项目中有一个搜索输入组件，它在许多组件中被多次重用。每当用户键入一个字符时，它会显示一个建议列表来完成用户正在键入的单词(自动完成功能)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op on l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Gif由<a class="ae kv" href="https://tenor.com/users/cali7" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> cali7 </strong> </a> <strong class="ak"> </strong>上<strong class="ak">的男高音</strong></p></figure><p id="1b99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了显示这些建议，每当用户输入从服务器获取结果时，就会触发一个API调用。这可能会导致对服务器的许多不必要的调用，因为没有必要在每次按键时都触发API调用，我们可以在触发新的API调用之前使用超时。</p><p id="8ccc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要一种在调用API之前等待几毫秒的方法——我们知道需要像<a class="ae kv" href="https://rxjs.dev/api/operators/debounce" rel="noopener ugc nofollow" target="_blank">去抖</a>这样的东西。我们没有自己开发，而是在网上搜索并找到了<code class="fe ni nj nk nl b"><a class="ae kv" href="https://usehooks.com/useDebounce/" rel="noopener ugc nofollow" target="_blank">useDebounce</a></code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om on l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用反钩</p></figure><p id="9396" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">API调用的用法示例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/cce5ef372e4b9fd1b2b05932155a0415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4sE_LNRuW4mh09aJzWjaw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在实践中使用</p></figure><h2 id="b98b" class="oa mb iq bd mc ob oc dn mg od oe dp mk lf of og mm lj oh oi mo ln oj ok mq ol bi translated"><strong class="ak">示例#3 —使用WindowResize挂钩</strong></h2><p id="b481" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">开发过程中很多时候需要根据浏览器的屏幕大小来改变显示。</p><p id="efe7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要做到这一点，有必要倾听屏幕尺寸的变化，并做出相应的改变。</p><p id="e4b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种情况的例子是根据平板电脑或移动电话的尺寸改变显示器、改变显示器的结构以及隐藏某些屏幕尺寸中的元素等。</p><p id="d317" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为这个操作是重复的，我们想要一个方便和干净的方法来监听屏幕尺寸的变化。</p><p id="6d83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我们创造<code class="fe ni nj nk nl b">useWindowResize</code>的原因。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om on l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用WindowResize</p></figure><p id="c754" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这个钩子，我们可以监听浏览器窗口大小的任何变化。<br/>并据此得到准确的尺寸(<code class="fe ni nj nk nl b">height</code>和<code class="fe ni nj nk nl b">width</code>)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/8d7b968113736659b4ffaba99cb95ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*MyOrZqKJi0AZr84yub98NQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">useWindowResize用法</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="cea6" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="0de4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们解释了定制钩子，理解了使用定制钩子的好处，并展示了项目中的真实例子，解释了我们何时使用某些钩子。</p><p id="028a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经看到，创建定制钩子非常简单，有很多(开放的)来源，你可以从中获得灵感并使用已经存在的定制钩子(我在下面附上了更多的来源)。我真的希望你喜欢这篇文章，并从中吸取教训。感谢阅读。</p><p id="8554" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是时候去创建你自己的定制钩子了<strong class="ky ir">🚀</strong>！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1294" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">有用的链接</h1><ul class=""><li id="0dda" class="nm nn iq ky b kz ms lc mt lf os lj ot ln ou lr nr ns nt nu bi translated"><a class="ae kv" href="https://reactjs.org/docs/hooks-custom.html" rel="noopener ugc nofollow" target="_blank"> React文档— </a>自定义挂钩</li><li id="be0a" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">use Hooks——ui . dev定制钩子的好网站</li><li id="9a04" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">多棒的React挂钩 —惊人的资源库，包括文档、视频、教程和多棒的自定义React挂钩。</li><li id="c9a2" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><a class="ae kv" href="https://react-hooks.org/" rel="noopener ugc nofollow" target="_blank"> Rooks </a> — NPM套装，带有许多常见和特殊的定制挂钩。</li></ul></div></div>    
</body>
</html>