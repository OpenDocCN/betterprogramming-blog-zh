<html>
<head>
<title>6 Ways To Power Up Your Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">增强Python代码能力的6种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/6-ways-to-power-up-your-python-code-d2ac5307d7d0?source=collection_archive---------11-----------------------#2021-02-16">https://betterprogramming.pub/6-ways-to-power-up-your-python-code-d2ac5307d7d0?source=collection_archive---------11-----------------------#2021-02-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2f7c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">打磨你的蛇佬腔的实用技巧</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/48d2e3f35c2bfdc48fe246461ecf2d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S0EBOgzmX-eCADtMMIYeqw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://imgur.com/gallery/5at77" rel="noopener ugc nofollow" target="_blank"> Imgur </a>上<a class="ae kv" href="https://imgur.com/user/wrathletbirds" rel="noopener ugc nofollow" target="_blank"> wrathletbirds </a>拍摄的照片。</p></figure><p id="98fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为软件开发人员，我们努力编写能够很好地工作的代码。当然，这要求代码能够工作，但强调可维护性和清晰性的重要性。令人欣慰的是，开发人员并不是靠代码行来获得报酬的，这让我们能够专注于我们职业中真正重要的事情:为复杂的问题创造简单而优雅的解决方案。</p><p id="e632" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python是一种语言，如果使用得当，这种语言很容易做到。我认为它在编程新手中的受欢迎程度证明了这一事实。可读代码对于那些希望学习基础知识的人来说是容易理解的。</p><p id="c735" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一方面，Python不是一个特别严格的老师，很容易强化坏习惯。当我们还在学习的时候，这很好，功能比形式更重要——毕竟，我们必须先学会走，然后才能跑。然而，为了我们的开发伙伴和未来的自己，我们应该保持代码的整洁。能写一行为什么要写五行？<a class="ae kv" href="https://www.python.org/dev/peps/pep-0020/#the-zen-of-python" rel="noopener ugc nofollow" target="_blank">可读性计数</a>。</p><p id="a91c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文主要面向那些不熟悉Python最佳实践和速记语法的人。所描述的步骤很小也很简单，在阅读完本文后，它们可以——也应该——快速而轻松地应用于任何Python项目。</p><p id="1d0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始吧！</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="935d" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">1.使用列表理解</h1><p id="12dc" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">对列表的操作对于Python来说就像滑动对于蛇一样。也就是说，很普通！在下面的示例中，我们希望选择所有以B开头的名称，并在此过程中将它们转换为小写:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="f2d5" class="nc mb iq my b gy nd ne l nf ng">names = ["Alice", "Brian", "Betty", "Bob", "Christa"]<br/>b_names = []<br/>for name in names:<br/>   if name.startswith("B")<br/>      b_names.append(name.lower())</span></pre><p id="67d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这段代码当然完成了工作，但是很冗长。迭代、过滤和转换数据集合是如此常规，事实上，Python为我们提供了一些简洁的语法，可以在一条语句中实现这三项:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="cd6f" class="nc mb iq my b gy nd ne l nf ng">list = [<strong class="my ir">expression</strong> for <strong class="my ir">item</strong> in <strong class="my ir">iterable</strong> if <strong class="my ir">condition</strong>]</span></pre><p id="c9a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个<em class="ls">列表理解</em>允许我们从一个现有的列表中构建一个新的列表，通过迭代它的条目，对那些条件为<code class="fe nh ni nj my b">True</code>的条目应用一个表达式。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="2955" class="nc mb iq my b gy nd ne l nf ng">names = ["Alice", "Brian", "Betty", "Bob", "Christa"]<br/>b_names = [name.lower() for name in names if name.startswith("B")]</span></pre><p id="1726" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">瞧啊。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="b6c8" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">2.使用序列解包提取相关数据</h1><p id="292e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">当操作复合类型时，我们将不可避免地需要进入内部来获取数据。客户的详细信息，例如:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5d81" class="nc mb iq my b gy nd ne l nf ng">person = ("Bob", 22, "4 Adder Avenue")<br/>name = person[0]<br/>age = person[1]<br/>address = person[2]</span></pre><p id="1a1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">序列解包</em>允许我们通过一次将集合中的连续元素分配给多个变量，以一种更简洁的方式完成这项工作:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="3b52" class="nc mb iq my b gy nd ne l nf ng">person = ("Bob", 22, "4 Adder Avenue")<br/>name, age, address = person</span></pre><p id="26c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，这个例子相对简单。更多的时候，我们将会处理任意结构的数据类型:一个熊猫<a class="ae kv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">数据帧</a>，一个枕头<a class="ae kv" href="https://pillow.readthedocs.io/en/stable/reference/Image.html#the-image-class" rel="noopener ugc nofollow" target="_blank">图像</a>，或者一个PyQt <a class="ae kv" href="https://doc.qt.io/qtforpython/PySide6/QtWidgets/QWidget.html" rel="noopener ugc nofollow" target="_blank">小部件</a>。</p><p id="566b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在更复杂的场景中应用这种语法的一个简单方法是编写一个函数来封装特定于类型的获取逻辑，使用多个返回值将相关数据打包成一个元组。这允许我们在函数被调用时干净利落地解包回单个变量。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="244f" class="nc mb iq my b gy nd ne l nf ng">def get_user_info(user):<br/>   ... <br/>   return name, age, address</span><span id="84b3" class="nc mb iq my b gy nk ne l nf ng">user = get_active_user()<br/>name, age, address = get_user_info(user)</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6317" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">3.使用字典理解</h1><p id="5b91" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">记住前面的提示，我们可以将<em class="ls">字典理解</em>引入我们的代码:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="2702" class="nc mb iq my b gy nd ne l nf ng">other = {<strong class="my ir">key'</strong>: <strong class="my ir">value'</strong> for <strong class="my ir">key</strong>, <strong class="my ir">value</strong> in <strong class="my ir">dict.items()</strong> if <strong class="my ir">condition</strong>}</span></pre><p id="075d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nh ni nj my b">items()</code>方法返回一组键值对，我们可以对其进行解包和处理以构建一个新的键值对。与列表理解一样，我们可以通过可选条件过滤字典条目。剩下的那些由两个表达式(<code class="fe nh ni nj my b">key’</code>和<code class="fe nh ni nj my b">value’</code>)转换，产生我们的最终项目。</p><p id="9f60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该语法对于从嵌套字典中选择子属性非常有用:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="b5ad" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">4.更喜欢创建而不是删除</h1><p id="c6b2" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">数据通常在项目过程中更新(例如，从学校记录中删除成绩不佳的学生)。当需求如此呈现时，下面的代码可能看起来是最自然的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="7a70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，在Python中，为我们需要的数据构建新的结构通常比删除我们不需要的数据更干净。请注意，去掉成绩不好的人实际上与保留成绩好的人是一样的，使用我们掌握的理解语法，用更少的行就可以做到这一点:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d2cf" class="nc mb iq my b gy nd ne l nf ng">students = {"Alice": 90, "Bob": 81, "Charlie": 42}<br/>achievers = {<br/>   name: score for name, score in students.items() if score &gt;= 60<br/>}</span></pre><p id="7f0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法还通过保证变量无论何时何地被使用都保持相同的值，使得测试和推理我们的代码变得更加容易。完全<a class="ae kv" href="https://medium.com/r?url=https%3A%2F%2Fopensource.com%2Farticle%2F18%2F10%2Ffunctional-programming-python-immutable-data-structures" rel="noopener">不可改变的状态</a>是一个<em class="ls">整体</em>不过其他的蛇都可以。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="ce26" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">5.尽可能使用if-else赋值</h1><p id="456c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这个又短又甜。假设我们想根据一个布尔表达式的值给一个变量赋值。使用Python的<em class="ls">三元运算符，</em>我们可以执行<code class="fe nh ni nj my b">if-else</code>赋值，将一个冗长的五行:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="cf90" class="nc mb iq my b gy nd ne l nf ng">mood = ""<br/>if is_sunny(today):<br/>   mood = "Happy"<br/>else:<br/>   mood = "Sad"</span></pre><p id="3e06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">变成了一句俏皮话:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="9e83" class="nc mb iq my b gy nd ne l nf ng">mood = "Happy" if is_sunny(today) else "Sad"</span></pre><p id="ac42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，这只有在两种情况下都有值时才有效。只有当我们的条件是<code class="fe nh ni nj my b">True</code>时，我们才不能使用下面的代码来初始化变量:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d632" class="nc mb iq my b gy nd ne l nf ng">mood = "Happy" if is_sunny(today) # Results in a SyntaxError</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="7306" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">6.一起分配相关的上下文管理者</h1><p id="ceae" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">Python的<em class="ls">上下文管理器</em>让我们能够控制临时资源的生命周期，比如文件流。通常，必须同时维护多个管理器(例如，当组合来自几个文件的数据时)。这可能导致过度嵌套的代码:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="6945" class="nc mb iq my b gy nd ne l nf ng">with open(file1) as in1:<br/>   with open(file2) as in2:<br/>      with open(file3) as out:<br/>         out.write(in1.read() + in2.read())</span></pre><p id="cfd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个鲜为人知的技巧是Python允许一次分配多个管理器，这使得我们的代码更加简洁:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="4e84" class="nc mb iq my b gy nd ne l nf ng">with open(file1) as in1, open(file2) as in2, open(file3) as out:<br/>   out.write(in1.read() + in2.read())</span></pre><p id="7590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">长队可能很难跟上。因此，明智的做法是少用这一招。更好的做法是，只要我们真正需要上下文管理器，就把它们保留下来:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="45aa" class="nc mb iq my b gy nd ne l nf ng">with open(file1) as in1, open(file2) as in2:<br/>   contents = in1.read() + in2.read()<br/>with open(file3) as out:<br/>   out.write(contents)</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="063e" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">资源</h1><ul class=""><li id="9d59" class="nn no iq ky b kz ms lc mt lf np lj nq ln nr lr ns nt nu nv bi translated"><a class="ae kv" href="https://www.python.org/dev/peps/pep-0020/" rel="noopener ugc nofollow" target="_blank">蟒蛇之禅</a></li><li id="f882" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://docs.python.org/3/tutorial/datastructures.html" rel="noopener ugc nofollow" target="_blank">数据结构</a></li><li id="8788" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">熊猫数据帧类</a></li><li id="911b" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://pillow.readthedocs.io/en/stable/reference/Image.html#the-image-class" rel="noopener ugc nofollow" target="_blank">枕头图像模块</a></li><li id="f7d6" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://doc.qt.io/qtforpython/PySide6/QtWidgets/QWidget.html" rel="noopener ugc nofollow" target="_blank"> PyQt QWidget类</a></li><li id="2727" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://docs.python.org/3/howto/functional.html" rel="noopener ugc nofollow" target="_blank">功能编程指南</a></li><li id="988d" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://opensource.com/article/18/10/functional-programming-python-immutable-data-structures" rel="noopener ugc nofollow" target="_blank">Python中的函数式编程:不可变数据结构</a></li><li id="c8d9" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://book.pythontips.com/en/latest/ternary_operators.html" rel="noopener ugc nofollow" target="_blank">三元运算符</a></li><li id="16c8" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated"><a class="ae kv" href="https://book.pythontips.com/en/latest/context_managers.html" rel="noopener ugc nofollow" target="_blank">上下文管理器</a></li></ul></div></div>    
</body>
</html>