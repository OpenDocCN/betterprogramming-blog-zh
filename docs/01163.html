<html>
<head>
<title>Write Cleaner Reducers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">书写清洁减少器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/write-cleaner-reducers-1c433a94a166?source=collection_archive---------9-----------------------#2019-08-19">https://betterprogramming.pub/write-cleaner-reducers-1c433a94a166?source=collection_archive---------9-----------------------#2019-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="39c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建适用于任何JavaScript环境的更干净、更可读、无样板文件的reducers</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0fb386067be63b4df45eb70623c33c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qdqEWekIW_KHiu6P"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ayahya09?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿里·叶海亚</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="0ab6" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">介绍</h1><p id="281e" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">那么，什么是减速器呢？</p><p id="59bf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这是一个纯粹的函数，它接受当前状态和动作，并基于它们返回一个新状态。就是这样！</p><p id="ea2f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Redux库在React生态系统中极大地推广了reducers的概念，现在它几乎是考虑应用程序状态的标准方式。</p><p id="19f1" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在这篇文章中，我们将检查著名的计数器应用程序的例子和它的reducer，看看我们能做些什么来使它变得漂亮和整洁。最后，我们将看到在React应用程序中采用这些知识是多么容易。</p><p id="b93a" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这是我们的应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/afbc4ad1b1f12fa1b1016b7ff3c608b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-mBIhE41CPjgspR0eE5OfA.png"/></div></div></figure><p id="3ed2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">它包含一个状态，当前计数和两个动作，递增和递减。<strong class="ma iu"> </strong>典型的减速器可能是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="dd99" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这种方法有什么问题，我们如何改进它？</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="bd21" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">良好做法</h1><p id="08dc" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">首先，我们的动作类型(递增/递减)是硬编码的<strong class="ma iu"> </strong>字符串。拥有这些真的是一个坏主意，因为它很容易导致各种各样的错误和打字错误，使重构更加困难，等等。</p><p id="1745" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">第二，我们的默认情况返回相同的状态。为什么这样不好？如果我们的reducer被调用了一个未知的动作，这意味着有问题，我们应该得到通知。</p><p id="283c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这些问题的解决方案可能是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="29ac" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">不带开关/外壳的减速器</h1><p id="4539" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我们的reducer的另一个非常有用的改进是去掉switch/case语句。这样我们就可以有更多可读的、可测试的、优雅的代码。</p><p id="2202" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">下面是一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e402" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，我们可以让<code class="fe nc nd ne nf b">createReducer</code> <strong class="ma iu"> </strong>助手函数来为我们处理，而不是每次都手动创建我们的reducers。它应该以<code class="fe nc nd ne nf b">handlers </code>对象和<code class="fe nc nd ne nf b">initialState</code>作为参数，并产生reducer作为返回值。</p><p id="1d6f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">幸运的是，在前一个例子中，我们已经完成了所有繁重的工作，所以我们的代码现在应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a7e4" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">自动合并状态</h1><p id="5081" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">所以<code class="fe nc nd ne nf b">createReducer</code> <em class="ng"> </em>现在是<em class="ng"> </em>负责我们的减速器创建，在这个过程中，我们可以做得更多。一个特别好的特性是当前状态和下一个状态的合并。这样，我们就不必在所有的处理函数中手动合并状态。相反，我们只能返回我们想要应用的状态更改。</p><p id="516b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">合并状态对我们的计数器应用程序来说不是特别重要，因为它只有一个状态。但是在现实世界中，几乎总是需要将当前状态合并到下一个状态。如果我们不这样做，我们可能会丢失部分状态，从而改变状态的结构，这可能会导致意外的行为和错误。</p><p id="2fc0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们可以将当前和下一个状态传播到<code class="fe nc nd ne nf b">createReducer</code>函数中的一个新对象中，而不是在每个处理函数中手动合并。调整后，我们的代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8808" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">如何在React应用程序中应用</h1><p id="7b01" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">这里有一个React应用程序的工作示例，它利用这些技术制作一个漂亮、干净的缩减器，并使用<code class="fe nc nd ne nf b">useReducer</code>钩子应用它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh nb l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="ff04" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="9251" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">有了像<code class="fe nc nd ne nf b">createReducer</code> <strong class="ma iu"> </strong>函数这样的简单抽象，我们可以让我们的生活变得更容易，编写简单、可读、但功能强大的reducers。</p><p id="db30" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">感谢您的阅读。如果你有任何问题或反馈，请在评论中告诉我。</p></div></div>    
</body>
</html>