<html>
<head>
<title>Converting Localized iOS Files For Android Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Android项目转换本地化的iOS文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/converting-localized-ios-files-for-android-codebase-8f34ee8b34ba?source=collection_archive---------19-----------------------#2022-02-02">https://betterprogramming.pub/converting-localized-ios-files-for-android-codebase-8f34ee8b34ba?source=collection_archive---------19-----------------------#2022-02-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="63dc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让您的IDE来完成繁重的工作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/facc25cb8ecdbd77c4809399e8666073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HdzM8DV8n9CIBtoM"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@stillnes_in_motion?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">静止不动</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="4302" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">免责声明:</em>本文的目的不是给出自动转换此类文件的详尽规则，而是说明如何通过一些查找和替换技巧来节省时间。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="5174" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天从一个简单而又乏味的任务开始:我必须重用一组翻译的文本内容。从对应的iOS项目，我想迁移到Android。</p><p id="6da9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使像<a class="ae ky" href="https://phrase.com/" rel="noopener ugc nofollow" target="_blank">短语</a>这样的工具可以帮你解决这个问题，你可能也不想为这样的SaaS付费。此外，如果你没有提前选择使用其中的一个，你仍然会花费大量的时间在那里导入你的内容——尽管似乎存在一些上传工具。</p><p id="5dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就本文而言，我们假设您不想使用外部工具来管理您的翻译内容。</p><p id="2a1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名开发人员，您会想知道在不同的iOS之间管理它们的不同之处:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="6b3d" class="mi mj it me b gy mk ml l mm mn">Localizable.strings</span><span id="ca58" class="mi mj it me b gy mo ml l mm mn">//Comment<br/>“key_1” = “What a %@ task, don't you think?”;</span></pre><p id="1698" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和安卓系统:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="a8c4" class="mi mj it me b gy mk ml l mm mn">strings.xml</span><span id="b27b" class="mi mj it me b gy mo ml l mm mn">&lt;!-- Comment --&gt;<br/>&lt;string name="key_1"&gt;What a %s task, don\'t you think?&lt;/string&gt;</span></pre><p id="773c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们忽略文件类型(iOS的字符串，Android的XML)，我们很容易观察到一些差异。我有目的地使用了一个动态字符串参数——可以替换为<em class="lv">乏味的</em>或<em class="lv">令人兴奋的</em>，你告诉我！</p><p id="fb21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看我们需要改变什么，以及如何进行。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="8159" class="mp mj it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">使您的本地化文件符合Android标准</h1><p id="acb6" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">将这个iOS文件翻译到您的Android项目中会产生:</p><ul class=""><li id="5e0b" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">更改键及其关联值的语法</li><li id="8239" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">调整动态参数</li><li id="8b24" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">转义某些特殊字符(如<code class="fe nz oa ob me b">‘</code>)</li><li id="73f0" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">使注释XML可读</li></ul><p id="ba38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，这是你需要适应的一个例子。</p><p id="d348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先需要更改前缀和后缀，以便在XML文件中包含键及其值。</p><p id="5363" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于前缀，<code class="fe nz oa ob me b">“key_1” = “</code>变成了<code class="fe nz oa ob me b">&lt;string name=”key_1"&gt;</code></p><p id="a56d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于后缀，<code class="fe nz oa ob me b">”;</code>变成了<code class="fe nz oa ob me b">&lt;/string&gt;</code></p><p id="3112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">动态参数从<code class="fe nz oa ob me b">%@</code>变为<code class="fe nz oa ob me b">%s</code>。请注意，大多数其他动态类型(如整数、小数)共享相同的语法。另外，我简化了这个例子，只使用了一个动态参数。稍后会详细介绍。</p><p id="3762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Android Studio会抱怨<code class="fe nz oa ob me b">‘</code>等未转义的角色。IDE会告诉你用反斜杠<code class="fe nz oa ob me b">\</code>对其进行转义。</p><p id="276d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，如果您的iOS文件包含注释，您也需要转换它们，因为XML不处理它们的语法。于是<code class="fe nz oa ob me b">//Comment</code>变成了<code class="fe nz oa ob me b">&lt;!-- Comment --&gt;</code>。</p><p id="d677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一切都很好，但是我们只转换了文件中的一行……因为你可能有成千上万行要迁移，事情很快就会变得棘手。更不用说您的应用程序可能支持多种语言，因此您的迁移负载很容易失控。</p><p id="be3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能已经意识到我们可以通过一些脚本来实现自动化。你这么想是对的。但是，如果我告诉您，您需要的所有东西都已经打包在您用来开发应用程序的同一个IDE中，那会怎么样呢？</p><p id="7a31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我说的是任何IDE最常用的功能之一:查找和替换。但是我们需要使用正则表达式来引导它。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="155a" class="mp mj it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">使用正则表达式自动转换</h1><p id="0f10" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们已经描述了转换文件所需的所有步骤。我们只需要合适的工具来为所有文件内容应用这些更改。</p><p id="ef53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">写一个脚本(例如使用Python)会更有效率。但是，让我们假设您不熟悉脚本，并且您很高兴您的IDE完成这项工作。</p><p id="43ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的一些操作不需要使用正则表达式:</p><ul class=""><li id="407b" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">后缀</li><li id="6884" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">特殊人物<code class="fe nz oa ob me b">‘</code></li><li id="5217" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">参数语法</li></ul><p id="5a1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个简单的查找和替换将处理所有这些事件。</p><p id="26fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其余的包括动态内容，阻止我们简单地使用基本的查找和替换操作。我们需要正则表达式。您可以在Android Studio中的以下位置启用它们:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/b2bab5e5ce1a6f3813867d3275f0e4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ePQ-X9epc_oD44rhIAUYXA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Android Studio启用正则表达式</p></figure><p id="c2a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们需要找到正确的正则表达式来提取我们想要的内容，并了解IDE如何保存提取的输入的副本。</p><p id="d084" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于前缀，我们希望提取键名并用正确的语法影响它。一个键通常是一个单词，所以正则表达式可以像<code class="fe nz oa ob me b">“(\w+)” = “</code>一样简单。然后，我们用预期的语法<code class="fe nz oa ob me b">&lt;string name=”$1"&gt;</code>替换它，其中<code class="fe nz oa ob me b">$1</code>包含在前面的正则表达式中找到的匹配参数。Android Studio会提示您替换后的前缀将会是什么样子</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/fa7a15f491abd7a7cddae7ccf058762b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3in5toH2iv3aaKPAvHYvlQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的第一个带有Android Studio的正则表达式使前缀兼容</p></figure><p id="a25f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以安全地将其应用于所有前缀。</p><p id="ec6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，如果你碰巧有注释，用同样的逻辑转换它们。因为注释可能包含几个单词，所以您可能希望使用更灵活的正则表达式，比如<code class="fe nz oa ob me b">//(.*)</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/c9ca98fd4c0eee8fbd2d9b0e969b7962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vWzqkZMeq75A-L_gxvDlHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用另一个正则表达式转换注释</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="271d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你都准备好了！与通常的转换一样，它并没有涵盖所有的内容，而且您可能需要执行一些手动操作。</p><p id="aaa6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果你有几个相同值的参数，Android需要你给它们一个索引，而iOS不需要。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="fd21" class="mi mj it me b gy mk ml l mm mn">Localizable.strings</span><span id="15b3" class="mi mj it me b gy mo ml l mm mn">“key_2” = “%@ gave %d claps for this article”;</span></pre><p id="2a01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">会变成:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="f272" class="mi mj it me b gy mk ml l mm mn">strings.xml</span><span id="dc9e" class="mi mj it me b gy mo ml l mm mn">&lt;string name=“key_2”&gt;%1$@ gave %2$d claps for this article&lt;/string&gt;</span></pre><p id="6bad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然我将这种转换作为本文的一条红线，但我强烈建议您在执行像这样令人畏惧的任务时考虑这种强大的工具。你将节省大量的时间，更不用说你的理智了！</p></div></div>    
</body>
</html>