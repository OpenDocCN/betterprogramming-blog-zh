<html>
<head>
<title>Grocery Hacking: Automate Your Grocery Shopping Using the Robot Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">杂货店黑客:使用机器人框架自动化你的杂货店购物</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/grocery-hacking-automate-your-grocery-shopping-using-the-robot-framework-9444a553f8dc?source=collection_archive---------2-----------------------#2022-03-09">https://betterprogramming.pub/grocery-hacking-automate-your-grocery-shopping-using-the-robot-framework-9444a553f8dc?source=collection_archive---------2-----------------------#2022-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1953" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我使用机器人流程自动化(RPA)来自动化我的杂货店购物，以便我可以花更少的时间购物。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aa434a4caf78dc2427987dd848c4f3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yq3tWJEhyUvi3bW1HLSZCQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="aad2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我和我的家人很幸运地住在西雅图的一个社区，那里有7家超市，每家都在步行距离之内。所以，直到疫情袭击，我们希望尽量减少与他人的接触，我们才开始尝试杂货店送货。像许多其他人一样，我们开始在家工作，现在我们可以在任何时间接收送货，尝试一下杂货店送货似乎是一件显而易见的事情。</p><p id="5c51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当时，我们地区第一家提供送货服务的杂货店，不是亚马逊这样的大公司，是弗雷德·梅耶，通过与Instacart的合作。我们最初的体验非常好，我们认为额外支付总账单15%的送货费用是值得的，因为免接触送货更安全。我们每周使用Fred Meyer的送货服务约9个月，在此期间，我们了解到它有其缺点。我们发现，Fred Meyer的在线库存经常与实际库存不同步，这意味着我们可以轻松地收到替代品，或者商品会因为缺货而无法送达。送货后不得不亲自去商店取20%没有送达的商品，这变得非常令人沮丧。</p><p id="af22" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，在2021年年中，我们的常规前COVID超市Safeway开始提供送货服务。只要3.95美元的送货费，我们习惯的产品，以及大量的储蓄，这项服务似乎很有前途。的确如此——以至于我们在过去的9个月里一直在使用它，并计划继续使用这项服务。</p><p id="9fd5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">COVID仍然是一个很重要的东西，但我的大多数家人都接种了疫苗(我们仍在等待我2岁孩子的疫苗)，我们发现戴着口罩在通风良好的室内购物是一个可接受的风险。那么是什么让我们回来使用杂货店送货服务呢？便利性和成本。虽然和我的孩子一起去超市很有趣，因为我们可以买一大堆美味的食物，我们都是一群傻瓜，但对我的孩子来说，在一个大商店里保持45分钟的注意力也很难。这意味着他们会到处跑，将购物速度减慢到爬行速度(看到我在那里做了什么吗？).相反，我和妻子可以在周日晚上做一些膳食计划，订购食品杂货，然后让他们送货上门，只需3.95美元！</p><p id="c8a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有呢？Safeway送货司机是商店的员工，因此Safeway不会索要小费。有了像Instacart这样的竞争服务，你可以轻松地额外支付账单的10-20%作为小费和送货费。当你谈论一家大商店时，那就加起来了。此外，我们的Safeway购物实际上节省了大量的汽油费，这是一个很好的额外奖励！</p><p id="ca87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好了，已经有足够的背景知识了…让我们来谈谈在自动化之前我是如何购物的。</p><h1 id="281f" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">我过去是如何购物的</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/5b3cfb6ef8ae79cb663f9464b535a946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXmlH8JiUCmk3a_tanZtJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我以前是怎么去杂货店购物的。图片来源:作者</p></figure><p id="c107" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事情是这样的:</p><ol class=""><li id="fec4" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">在一周中，我和妻子(有时还有我们的孩子)会要求Alexa在我们的购物清单上添加一个项目。这很容易做到，只要你知道你会需要更多的东西，就把它添加到列表中。</li><li id="6600" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">然后有一个由Todoist提供的集成，将Alexa中的项目同步到Todoist。我们使用Todoist而不是Alexa应用程序来管理我们的列表，因为在Alexa的早期，我们发现我和妻子通过Todoist分享列表要容易得多。(这种情况可能不再存在，但Todoist对我们来说效果很好，而且是免费的，所以我们一直在使用它)。</li><li id="1e58" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">周日晚上，我和妻子坐下来做一些膳食计划，调查冰箱和橱柜，然后通过Alexa将物品添加到列表中。</li><li id="7988" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">我打开电脑，在不同的浏览器标签中加载了《陶斯特和Safeway.com》。</li><li id="37aa" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">然后我会一个接一个地检查待办事项列表中的项目。首先，我查看以前在Safeway上购买的商品，也就是<em class="nb">再次购买</em>商品，如果有匹配的，我就将该商品添加到我的购物车中。Safeway在回忆我购买的最后300件左右的物品方面做得很好，我的物品很有可能会在这个列表中。</li><li id="1486" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">如果我以前从未购买过该商品，或者我以前购买的商品缺货，我会使用Safeway搜索功能来搜索该商品，然后将其添加到购物车中。</li><li id="0961" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">我在待办事项列表上将该项目标记为已完成</li><li id="bd48" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">我查看了我的Safeway购物车，并安排了送货时间</li></ol><p id="2343" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">需要注意的是，步骤4-7的重复任务可能需要<strong class="la iu"> 30分钟</strong>。你可能会问<em class="nb">这怎么可能</em>？好吧，每个项目需要大约1分钟的时间来手工处理，我可以很容易地在我的清单上有30-40个项目。这部分是因为浏览Safeway网站有点慢。在许多场合，我都认为每周花30分钟去买食品杂货是一件令人沮丧的事情。毕竟，我通常会点同样的东西，而且购物不需要太多智慧。一定有更好的方法，对吗？</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="e752" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能会想:</p><blockquote class="nj"><p id="6946" class="nk nl it bd nm nn no np nq nr ns lt dk translated">好吧，但Alexa不是已经提供了一种购买产品的方式吗？当然，这就是亚马逊创造Alexa的原因？</p></blockquote><p id="1d69" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">事实上，确实如此！最近，Alexa应用程序开始允许你<a class="ae ny" href="https://www.amazon.com/fmc/m/20190164?almBrandId=QW1hem9uIEZyZXNo" rel="noopener ugc nofollow" target="_blank">购物清单</a>。您只需将商品添加到您的Alexa列表中，然后使用Alexa应用程序从新鲜或全食产品列表中进行选择:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/1e62a8a6b6e44d62fd09b703544ca38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--Zdr5JccIpuHC41l7rtHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Alexa的商店你的列表功能。图片来源:作者</p></figure><p id="4e18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个界面非常漂亮，但是有一个问题。我妻子说:</p><blockquote class="nj"><p id="60a7" class="nk nl it bd nm nn no np nq nr ns lt dk translated"><em class="oa">我已经想过抵制亚马逊，因为他们不是最有社会责任感的公司。我们已经在亚马逊上买得太多了，我们需要支持其他杂货店。</em></p></blockquote><p id="2c22" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">虽然我喜欢亚马逊的便利、速度和价格，但她是对的！所以，现在，我们将坚持在西夫韦购物。当然，Safeway(Albertsons的子公司)是美国五大连锁杂货店之一，但至少它不是亚马逊。</p><p id="6184" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我仍然想知道是Safeway还是亚马逊更便宜。因此，我在Safeway和Amazon Fresh的网站上建立了一个包含32种类似商品的购物车，对它们进行了快速成本比较。在此过程中，我发现他们对我的一篮子产品的定价大致相同，例如大约150美元:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/a88b78f9eef1c998caee8ed08a32b1e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8UahcfODkqGBrklaVYEyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Safeway vs亚马逊生鲜定价。图片来源:作者</p></figure><p id="b828" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">知道我们想继续使用Safeway进行杂货配送，使用Alexa进行购物清单，我开始考虑如何实现购物自动化？进入:机器人过程自动化(RPA)</p><h1 id="cc90" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">机器人过程自动化(RPA)</h1><p id="8cbe" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">如果您没有听说过，RPA只是一种自动化重复性任务的方式，通常由人用软件机器人来完成。这些通常是在图形用户界面(GUI)中完成的任务，如web浏览器、MS Excel、电子邮件客户端等</p><p id="8ac1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在过去几年里，我一直在随意阅读RPA，甚至向工作中的非技术领导同事推销它，当时他们正在寻找一种方法来自动化运营流程，而不会分散我们已经分散的工程师的注意力。对我来说，这似乎是一个完美的机会，可以让我投入其中，制作一个RPA机器人。</p><p id="663f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在做了一些快速调查后，我很快了解到有许多昂贵的专有RPA供应商，如UIPath和Automation Anywhere。我不怀疑这些系统的价值，因为它们最终可以降低您的劳动力成本。但是，也有一些开源解决方案，如<a class="ae ny" href="https://github.com/robotframework/robotframework" rel="noopener ugc nofollow" target="_blank">机器人框架</a>和<a class="ae ny" href="https://github.com/kelaberetiv/TagUI" rel="noopener ugc nofollow" target="_blank">塔圭</a>，作为开源的一个经常贡献者，我是开源的忠实粉丝。</p><p id="eb12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">目前，机器人框架拥有最多的GitHub明星，并得到广泛的社区支持。因此，我启动了一个机器人框架教程的快速入门<a class="ae ny" href="https://dev.to/thebadcoder/robot-framework-quick-start-ui-automation-4966" rel="noopener ugc nofollow" target="_blank">,发现构建一个可以导航网站的机器人非常简单。我发现机器人框架是Python之上的一层非常酷，因此，很容易将定制的Python代码插入到机器人中。而且，我发现特别酷的是，有</a><a class="ae ny" href="https://github.com/fkromer/awesome-robotframework#libraries" rel="noopener ugc nofollow" target="_blank">社区提供的各种类型的图书馆</a>。</p><h1 id="00f7" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">机器人的目标</h1><p id="2653" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">在我们进入我如何建造我的机器人之前，让我们讨论一下我的目标。作为一名软件工程师，我知道我可以编写一些代码，向Todoist和Safeway后端发出API请求。然而，这将回避我玩机器人框架的愿望。相反，我选择使用带有机器人框架的<a class="ae ny" href="https://robotframework.org/SeleniumLibrary/SeleniumLibrary.html" rel="noopener ugc nofollow" target="_blank"> SeleniumLibrary </a>，它允许我构建一个使用Selenium控制浏览器的机器人，这与我手动使用浏览器购物的方式非常相似。</p><p id="07d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">稍后，我将提到我在RPA中发现的一些陷阱，以及为什么在将来，我会选择制作基于API的bot而不是基于GUI的bot。事实上，Todoist似乎有一个受支持的<a class="ae ny" href="https://developer.todoist.com/" rel="noopener ugc nofollow" target="_blank">开发者API </a>。Safeway/Albertsons似乎没有开发者API，但是它的网站可以进行后端调用，因此你可以对后端API进行逆向工程。</p><p id="9b5e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我的另一个目标是通过不引入另一个数据存储来简化部署架构。换句话说，我希望我的机器人只使用Todoist和Safeway中的数据，而不必在单独的数据存储中存储任何东西。最终，我能够在不写下任何额外内容的情况下购物，那么为什么没有额外的数据库，机器人就不能工作呢？</p><h1 id="ff83" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">建造机器人</h1><p id="1f1f" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">在接下来的几节中，我将浏览我的机器人代码的摘录。请在github.com/redgeoff/grocery-shopping-bot<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot" rel="noopener ugc nofollow" target="_blank">下载完整的源代码</a></p><p id="3bde" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你是机器人框架新手，请通读<a class="ae ny" href="https://dev.to/thebadcoder/robot-framework-quick-start-ui-automation-4966" rel="noopener ugc nofollow" target="_blank">机器人框架快速入门:UI自动化教程</a>。</p><h2 id="75ad" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">可重用的关键字</h2><p id="bb2d" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">机器人框架将你典型的编程语言功能称为<em class="nb">关键字</em>。我们将定义一些关键字，这样我们就可以抽象出在浏览器中使用网站时会遇到的一些粗糙边缘。特别是，网站是异步加载许多元素的野兽，这意味着元素可能尚未可见或启用。机器人天生就比人快得多，所以如果你不小心，你的机器人很容易从UI中出错，因为还没有准备好或者因为其他竞争情况发生。当然，您可以在代码中插入<code class="fe ot ou ov ow b">Sleep</code>语句，模拟人类可能遇到的计时，但这是一种反模式，因为:</p><ol class=""><li id="4f62" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">添加<code class="fe ot ou ov ow b">Sleep</code>语句会让你的机器人慢很多</li><li id="bb37" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">根据网络、后端服务器，甚至您的计算能力，时间会有所不同。</li></ol><p id="90b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，我们将创建一些帮助器关键字，等待元素可见并被启用，甚至引入一个重试循环，以应对页面加载时间过长或出现意外错误的情况。</p><p id="49b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的第一个关键词是<code class="fe ot ou ov ow b">Wait Until Element Ready</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="88a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将定义<code class="fe ot ou ov ow b">Click Element When Ready</code>，它使用<code class="fe ot ou ov ow b">Wait Until Element Ready</code>，然后单击元素。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="7145" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使我们能够恢复同一个浏览器会话，这将有助于我们避免每次登录时都给我们发送电子邮件，我们将从<a class="ae ny" href="https://www.formulatedautomation.com/post/staying-logged-in-with-robot-framework-rpaframework-browser" rel="noopener ugc nofollow" target="_blank">这篇文章</a>中借用一个技巧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="dfdb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，使用<a class="ae ny" href="https://stackoverflow.com/questions/53761393/no-keyword-with-name-get-child-webelement-found-in-robot/53763716#53763716" rel="noopener ugc nofollow" target="_blank">这篇文章</a>中的技巧，我们将定义一种获取子元素的方法。这将帮助我们做一些事情，比如获取一个食品清单，然后提取嵌套的属性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="5a78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际的机器人有许多其他可重复使用的关键字，但是为了简洁起见，在本文中省略了它们。</p><p id="2f01" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在已经抽象了一些不太有趣的东西，让我们开始让机器人做它的事情吧！</p><h2 id="03f2" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">从Todoist获取列表</h2><p id="8598" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">我们希望机器人做的第一件事是登录Todoist，选择我们想要的列表，然后将列表保存到内存中。列出我们的项目的Todoist页面如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/111ea5ab5c429b0ad02b8b2094c8b2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9pW2W4z4dFpSF9M3Sh-HeQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">购物清单。图片来源:作者</p></figure><p id="0162" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了避免进行额外的登录和触发来自Todoist的电子邮件，我们将使该机器人只在我们尚未登录时登录。在测试过程中，当您需要多次运行脚本来查找在浏览器中导航网站所产生的所有竞争条件时，这尤其有用。当然，如果您愿意，您可以在脚本每次运行时登录(和注销)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="212b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您仔细观察一下<code class="fe ot ou ov ow b">Get Todoist List Items</code>关键字，您会发现我们使用XPath查询来获取所有带有<code class="fe ot ou ov ow b">task_list_item</code>类的<code class="fe ot ou ov ow b">li</code>元素。然后我们提取<code class="fe ot ou ov ow b">list_item</code>子元素，这样我们就可以得到项目<code class="fe ot ou ov ow b">name</code>和<code class="fe ot ou ov ow b">id</code>。(是的，这就是Todoist如何在他们的HTML中识别项目，如果你认为这看起来很脆弱…嗯，是的)</p><p id="b1eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot/blob/main/robot/todoist.robot" rel="noopener ugc nofollow" target="_blank"> todoist.robot </a>找到完整的代码。</p><h2 id="3021" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">再买一次</h2><p id="28c7" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">我们从Todoist获得商品后，下一步是将相应的商品添加到我们的Safeway购物车中。现在，我们可以转到Safeway搜索页面并搜索该商品，但搜索页面按最匹配的<em class="nb">排序，不允许您按最近购买的商品<em class="nb">排序。</em></em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/eb3a55726bed7b64f33d50541a409c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCf3WKoBgUVH26DWJjmH_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Safeway的搜索页面。图片来源:作者</p></figure><p id="05e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">问题是，有时我们购买商品只是因为其他商品缺货，尽管我们更喜欢缺货的商品。相反，我想首先优先考虑我们经常购买的物品。这样，我们总是试图先买到我们喜欢的商品，即使它在下次购物前没有存货。当然，作为一个人，我可以简单地从列表中选择我想要的，但机器人并不那么聪明。对于机器人，我们可以转到<em class="nb">再次购买</em>页面，并按<em class="nb">经常购买的</em>进行分类:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/f891dd573575b85851d76075063732a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCKWJaTiJW7R8ua4-AxUFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按频繁购买排序。图片来源:作者</p></figure><p id="7c72" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们的机器人将遍历从Todoist获得的商品列表，并在Safeway的<em class="nb">再次购买</em>列表中寻找第一个匹配。然后，它会将该商品添加到Safeway购物车中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="ff8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你注意到发生在<code class="fe ot ou ov ow b">Add To Cart</code>的趣事了吗？Safeway网站要求您将鼠标悬停在某个商品上，然后点击它，才能将其添加到购物车中。至于<code class="fe ot ou ov ow b">Wait Until Page Does Not Contain Element</code>，当商品被添加到购物车时，网站会闪烁一个装载图标，我们希望等到该图标不再显示，因为这确认了该商品在我们的购物车中。(专业提示:要检查Chrome中消失的元素，打开<em class="nb">源</em>标签，点击<em class="nb"> F8 </em>停止浏览器运行并保持图标显示)</p><p id="28cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以在<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot/blob/main/robot/safeway.robot" rel="noopener ugc nofollow" target="_blank"> safeway.robot </a>查看完整的Safeway机器人代码。</p><h2 id="dbb7" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">搜索之前未购买的商品</h2><p id="7ad0" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">如果你像我一样，并且你的大部分杂货店购物都包括同样的300件左右的商品，那么机器人只要从<em class="nb">再次购买</em>(最近购买)页面购物，就几乎完成了你的整个清单。清单上剩下的几样东西可能是你以前从未购买过的，例如，你正在尝试一种新的食谱，或者你的典型品牌缺货。</p><p id="1981" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有其他原因会让你在清单上留下剩余的项目:</p><ol class=""><li id="a5d3" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">Safeway截断长产品名称，例如<em class="nb">Signature Care Wipes Sensitive…</em></li><li id="1b40" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">列表中项目的格式可能不匹配，例如<em class="nb">nutri grain vs nutri-grain</em></li><li id="00c3" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">列表中的项目名称与Safeway项目名称不匹配。正如您所料，Safeway会将隐藏的关键字与每个产品关联起来。例如，您的清单上可能有<em class="nb">胡椒杰克奶酪</em>，但Safeway产品可能被称为<em class="nb">奶酪片胡椒杰克</em></li></ol><p id="6bd2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了处理这些情况，我们的机器人访问Safeway搜索页面，并简单地选择库存中的第一个商品添加到购物车中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><h2 id="c1f5" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">将待办事项标记为已完成</h2><p id="a58e" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">现在，我们的机器人创建了一个购物车，里面装着它能找到的所有物品。下一步是在我们的待办事项列表中将这些项目标记为已完成。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="2f07" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">等等，那些<code class="fe ot ou ov ow b">Sleep</code>声明是怎么回事？我们不应该避开他们吗？是的，但是Todoist似乎有某种速度限制。换句话说，如果我们的机器人太快，网站就会出错，因为人类不会那么快完成项目。在我的测试中，我发现当我在每批10件商品之间花2秒钟，然后等10秒钟时，我避免了这个速率限制。(你可能会再次说，<em class="nb">但是这个看起来很脆</em> …是的！😵‍💫)</p><h2 id="1b31" class="oh lv it bd lw oi oj dn ma ok ol dp me lh om on mg ll oo op mi lp oq or mk os bi translated">发送一封电子邮件，列出添加到购物车的商品</h2><p id="3318" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">我希望我的机器人做的最后一件事是发送一封电子邮件，列出所有添加到购物车的商品。该电子邮件应列出出现在我的Todoist列表和我的Safeway购物车中的商品名称。然后我就可以快速检查这封邮件，看看是否有什么地方不合适。我通常发现至少有几样东西看起来很时髦。</p><p id="ba7b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个罕见的原因是，Safeway的搜索可能会有一些问题。例如，如果你搜索<em class="nb">香蕉</em>，第一个结果是卷心菜:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/c89c1bb52723ecb64bca18d6b5eed0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGTDDbSo1TH9-QN_uUZQnw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">搜索“香蕉”，找到一棵卷心菜。图片来源:作者</p></figure><p id="7707" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一件可能发生的事情是，像<em class="nb">洋葱</em>这样的简单Todoist项目实际上可以匹配<em class="nb">再买</em>列表中的<em class="nb">葱</em>和<em class="nb">黄洋葱</em>。我想在未来改进这一点的一个方法是有一个<em class="nb">替换</em>列表，我可以用它来训练机器人，这样每当我说<em class="nb">洋葱</em>时，我指的就是<em class="nb">黄洋葱。然而，对于我的机器人的MVP来说，一封简单的电子邮件就足以让我对我的购物车进行一些手动调整:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/ac8c85240ba10dd927a1ac4ce35ddc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEtIykTZkioKe4RtRMyO7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杂货店购物机器人电子邮件示例。图片来源:作者</p></figure><p id="6c3e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">据我所知，用机器人框架发送电子邮件并不像你希望的那样开箱即用。Robocorp是一家非常酷的机器人框架机器人托管公司，它为<a class="ae ny" href="https://rpaframework.org/libraries/email_imapsmtp/" rel="noopener ugc nofollow" target="_blank">电子邮件</a>维护了一个RPA库，但我发现它与我用来在容器中运行我的机器人的<code class="fe ot ou ov ow b">ppodgorsek/robot-framework</code> Docker映像不匹配。此外，我很高兴在我的机器人中使用定制的Python脚本，并知道用Python发送电子邮件是微不足道的。所以，我简单地创建了一个自定义的<em class="nb"> Email.py </em>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="9af6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">并通过一个<code class="fe ot ou ov ow b">Send Email</code>关键字将其公开:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="65bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe ot ou ov ow b">Email.py</code>脚本连接到一个SMTP服务器并发送一封HTML电子邮件。我简单地设置了一个新的Gmail账户，并通过启用<a class="ae ny" href="https://kb.synology.com/en-global/SRM/tutorial/How_to_use_Gmail_SMTP_server_to_send_emails_for_SRM" rel="noopener ugc nofollow" target="_blank">允许不太安全的应用选项</a>来启用SMTP访问。</p><p id="a6c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:通过这种方式发送的电子邮件很可能会出现在您的垃圾邮件文件夹中，因此您可能需要创建一个过滤器来将它们排除在垃圾邮件文件夹之外。从一个合适的邮件主机发送非垃圾邮件是一个相当复杂的过程，超出了本文的范围。</p><h1 id="f1de" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">运行机器人</h1><p id="64ac" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">这里有一个演示如何运行该机器人的快速视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe oy l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杂货店购物机器人演示。视频鸣谢:作者</p></figure><p id="5776" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在本地运行bot，请遵循这里的步骤<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot#run-locally-without-docker" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="a51b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行bot后，您将看到一个<code class="fe ot ou ov ow b">output</code>目录被创建，它包含一些新的工件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/ada433fbcb09e101719e944b68ab0620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cp1j67uaVAj0y9K_0X3f_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出目录包含机器人框架日志。图片来源:作者</p></figure><p id="b326" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以打开<code class="fe ot ou ov ow b">log.html</code>来查看bot的详细日志，例如</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/db2c661a47f6bc75adb28092be87ffb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OczDHsl_zCEyXHQqWiY14Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机器人框架日志。图片来源:作者</p></figure><p id="7640" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该日志和嵌入的屏幕截图对解决任何问题都很有帮助。</p><h1 id="fb1c" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">有用的工具</h1><p id="0910" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">如果你是Visual Studio (VS)代码用户，我发现<a class="ae ny" href="https://marketplace.visualstudio.com/items?itemName=TomiTurtiainen.rf-intellisense" rel="noopener ugc nofollow" target="_blank">机器人框架Intellisense </a>扩展会非常有帮助。</p><p id="6893" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您还不熟悉浏览器控制台中的<em class="nb">检查</em>功能，我建议您尝试一下，因为它可以让您发现网页上元素的结构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/ab0d552ebfedaa2a22a24f066db68c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Qj5f3JNTZ0W7_XuhfFEDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查Firefox中的HTML元素。图片来源:作者</p></figure><p id="460d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能在上面的代码中注意到了，因为Todoist和Safeway的网站不是最容易访问的，所以这个机器人使用XPath来导航网站。例如，我们使用以下选项选择所有Todoist项目:</p><pre class="kj kk kl km gt pi ow pj pk aw pl bi"><span id="17c9" class="oh lv it ow b gy pm pn l po pp">Get WebElements    xpath=//li[contains(@class,'task_list_item')]</span></pre><p id="bd68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Chrome和Firefox的一个鲜为人知的特性是，您可以使用<code class="fe ot ou ov ow b">$x()</code>函数在控制台中测试XPath查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/707401830230415730c9c91cd8eaca70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Coa_6you7b00-CmzewGyjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Firefox中测试XPath查询。图片来源:作者</p></figure><h1 id="ce55" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">使用Docker在无头模式下运行bot</h1><p id="aabc" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">如果要在后台运行没有UI(无头)的bot怎么办？很简单，只要按照<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot/blob/main/README.md#run-locally-with-docker" rel="noopener ugc nofollow" target="_blank">的指示，用Docker </a>在本地运行即可。</p><p id="2535" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果要将bot部署到云上呢？我将在后面的帖子中详细介绍这一点，但现在，看看<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot#delpoy-to-aws" rel="noopener ugc nofollow" target="_blank"> Deploy to AWS </a>中的步骤，看看我如何以每月几便士的价格运行这个机器人。</p><h1 id="af40" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">可能的增强</h1><p id="69b8" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">这个机器人只是一个最小可行产品(MVP)。以下是我认为可以添加的一些内容，以使其更加有用:</p><ol class=""><li id="f6e0" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">如上所述，一个<em class="nb">替换</em>的列表可以用来用<em class="nb">黄洋葱</em>替换像<em class="nb">洋葱</em>这样它就不只是匹配<em class="nb">绿洋葱了。</em></li><li id="fb3a" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">假设机器人运行后，人类会对列表进行细微的调整，机器人应该可以从这些调整中学习。换句话说，如果机器人确定购买了一个<em class="nb">黄色洋葱</em>，当列表上的原始项目是<em class="nb">洋葱时，</em>它可以代表你将<code class="fe ot ou ov ow b">onion =&gt; yellow onion</code> <em class="nb"> </em>添加到<em class="nb">替换</em>列表中。</li><li id="c0af" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">可以使用关键字扩展，以便单个单词可以表示一篮子项目。例如，你的家人可能会吃很多水果，并希望<em class="nb">水果</em>关键字包括草莓、覆盆子和蓝莓。这个特性对于订购一盘菜的所有杂货也很有用。或许，这是作为<em class="nb">替换</em>列表的一部分实现的，即<code class="fe ot ou ov ow b">lasagne =&gt; ricotta, beef, eggs, ...</code></li><li id="8d12" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">支持项目计数。例如，<em class="nb"> 7根香蕉</em>会将7根香蕉加入购物车。目前，机器人只向购物车添加了一个香蕉，在机器人完成执行后，人必须手动增加数量。</li><li id="38fc" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">在Safeway的产品页面上，有时会有一个为特定产品剪贴优惠券的选项，也就是说，您可以在购买时节省一些钱。机器人应该为你做这件事。</li><li id="dc3f" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">如上图所示，Alexa的<em class="nb">购物清单</em>功能提供了一个用户界面，允许你从与购物清单上的项目匹配的顶级搜索结果列表中进行选择。在机器人运行后显示这样一个界面是有价值的，这样你就可以快速做出任何需要的调整。</li><li id="bcfc" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">该机器人可以分析你的购买习惯，并在你消费物品的速度足够快时，以及批量购买可以省钱时，推荐你批量购买某些物品。</li><li id="9ca3" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">使用机器学习，根据你对品牌、价格、味道和尺寸的现有偏好，推荐从未购买过的产品(新产品)。</li><li id="c6df" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">对其他杂货店的支持。现有的bot已经支持任何与Todoist集成的智能音箱，但它只支持杂货店Safeway。</li></ol><h1 id="c7f1" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">RPA是实现这个bot的最好方式吗？</h1><p id="25f4" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">大概不会。尽管玩机器人框架很有趣，但是通过浏览器使用框架导致了一个相当脆弱的解决方案。如果Todoist或Safeway决定改变他们的网站，这个机器人很可能会崩溃。</p><p id="a404" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我认为实现这种机器人的最佳方式是使用官方支持的开发者API，比如Todoist(或者Alexa)提供的API。主要原因是这个API是一个Todoist试图遵守的契约。或者，换句话说，这将大大降低Todoist引入一个会破坏机器人的变化的可能性。</p><p id="d055" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，Safeway似乎没有支持的开发者API。相反，你可以使用浏览器的<em class="nb">网络</em>标签来逆向工程他们的后端API。使用此API将显著改进bot，因为它将:</p><ol class=""><li id="5a3b" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">让它不那么依赖网站的表示层(HTML)。换句话说，网站的外观可能会改变，但只要后端API不变，机器人就不会崩溃。尽管Safeway没有正式公开开发者API，但他们可能有工程师团队在后端和前端工作，他们很可能会避免破坏API，因为这可能会导致他们的网站不稳定，并降低他们团队的速度。</li><li id="f9de" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">让它更快，因为浏览图形用户界面很慢。</li><li id="312c" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">减少bot消耗的资源量，因为进行RESTful API调用比运行浏览器消耗的资源少得多</li><li id="1730" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">当机器人比人类更快地导航GUI时，减少在浏览器中遇到竞态条件的可能性</li><li id="7cc7" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">避免使用弹出窗口的复杂性，弹出窗口可能会随时添加到GUI中，并且可能与机器人的主要目标没有什么关系</li></ol><h1 id="b1c0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">这个机器人为我工作得怎么样？</h1><p id="a962" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">我已经使用这个机器人几个星期了。我发现它能准确地为我清单上90%的物品建立一个购物车。然后我进去，通过Safeway移动应用程序对我的购物车做了一些小的调整，但总的来说，我已经将每周花在订购杂货上的时间从大约30分钟减少到了5分钟。所以，是的，它对我来说效果很好！</p><p id="345e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在AWS上以每月几分钱的价格托管机器人，甚至创建了一个自定义的Alexa技能来启动机器人。这意味着在我的Alexa列表完成后，我只需说o <em class="nb"> pen杂货店购物机器人</em>这个机器人就会施展它的魔法。在以后的文章中，我将深入研究这个部署是如何工作的，但是现在，你可以在这里<a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot/blob/main/README.md#delpoy-to-aws" rel="noopener ugc nofollow" target="_blank">使用它</a>。</p><pre class="kj kk kl km gt pi ow pj pk aw pl bi"><span id="fdda" class="oh lv it ow b gy pm pn l po pp"><strong class="ow iu">Enjoyed this article? </strong></span><span id="b980" class="oh lv it ow b gy pr pn l po pp">If this bot were turned into an easy-to-use service and supported your preferred grocery store and smart speaker, would you pay for it? Please consider taking 3 minutes to <a class="ae ny" href="https://docs.google.com/forms/d/e/1FAIpQLSeVdhAr3ucfz6YhLDKYeWUMTcJAB5woLiQqgjW80cYti9TdEw/viewform?usp=sf_link" rel="noopener ugc nofollow" target="_blank">answer these 3 quick questions</a></span></pre><p id="d482" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢你阅读这篇文章。</p><h1 id="17d5" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">资源</h1><p id="436c" class="pw-post-body-paragraph ky kz it la b lb oc ju ld le od jx lg lh oe lj lk ll of ln lo lp og lr ls lt im bi translated">以下是本文中提到的有用资源列表:</p><ol class=""><li id="952d" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated"><a class="ae ny" href="https://docs.google.com/forms/d/e/1FAIpQLSeVdhAr3ucfz6YhLDKYeWUMTcJAB5woLiQqgjW80cYti9TdEw/viewform?usp=sf_link" rel="noopener ugc nofollow" target="_blank">杂货店购物机器人调查</a></li><li id="4f6f" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae ny" href="https://github.com/redgeoff/grocery-shopping-bot" rel="noopener ugc nofollow" target="_blank">github.com/redgeoff/grocery-shopping-bot</a></li><li id="9001" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae ny" href="https://dev.to/thebadcoder/robot-framework-quick-start-ui-automation-4966" rel="noopener ugc nofollow" target="_blank">机器人框架快速入门:UI自动化教程</a></li><li id="a8bc" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae ny" href="https://github.com/robotframework/robotframework" rel="noopener ugc nofollow" target="_blank">github.com/robotframework/robotframework</a></li></ol></div></div>    
</body>
</html>