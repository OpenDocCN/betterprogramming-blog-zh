<html>
<head>
<title>How To Build a Static Site With Gatsby.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Gatsby.js构建静态站点</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-a-static-site-with-gatsby-js-fefa39810b25?source=collection_archive---------1-----------------------#2019-08-31">https://betterprogramming.pub/how-to-build-a-static-site-with-gatsby-js-fefa39810b25?source=collection_archive---------1-----------------------#2019-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d18b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Gatsby为博客文章创建一个带有分页的博客</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b74d160aa4ad612d1c363b5b4955fc19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNZJZGuyQBXrH3YU6c_BgA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@neonbrand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> NeONBRAND </a>在<a class="ae ky" href="https://unsplash.com/search/photos/blog?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d99c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想建立一个静态网站或博客，并且你知道网络开发，你有很多静态网站生成器的选择。</p><p id="70c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想用React来构建你的静态网站，<a class="ae ky" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>可能是一个适合你需求的选择。根据Gatsby网站，许多大公司都用它来建立自己的网站。</p><p id="e2e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将使用Gatsby构建一个小博客，为博客文章分页，并提供一个菜单让读者进行分类。一旦读者点击了某个类别的链接，他们就会进入一个页面，上面列出了所有贴有这些类别标签的文章。</p><p id="cbb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Gatsby可以从文件和网络资源(如API端点)中获取内容。内容通过<a class="ae ky" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>端点获取，您可以通过模板向其发送消息，以您想要的方式显示数据。</p><p id="15a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以构建显示不变内容的静态页面文件。您编写代码来获取内容，并用模板显示它们。</p><p id="9230" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，从您编写的代码中构建静态web页面。Gatsby的插件将提供您想要的功能。</p><p id="1470" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">建立一个静态网站或博客需要经过几道关卡。此外，您不能在Gatsby中使用大多数第三方React组件，因为它们是动态的。</p><p id="c519" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，命令行实用程序在Windows上存在区分大小写的路径问题，导致<code class="fe lv lw lx ly b">RelayParser: Encountered duplicate definitions for one or more documents</code>在项目文件夹的不同部分中出现重复的不区分大小写的文件路径。</p><p id="d488" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，Linux或Mac OS可能是使用Gatsby CLI的最佳选择。此外，必须在一个文件中进行多个页面查询，并且将它们通过管道传输到同一个文件中的模板。</p><p id="7410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">项目中的<code class="fe lv lw lx ly b">gatsby-node.js</code>是查询内容的地方。</p><p id="3f7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道了注意事项，我们可以开始建立我们的网站了。我们将建立一个有一些博客条目的博客。博客的布局是顶部的标题和页面其余部分的内容。</p><p id="e978" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将有一个模板来显示所有的博客条目，每个页面有五篇文章。此外，我们将有一个类别页面，显示带有给定标签的文章列表。我们将使用<a class="ae ky" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank">引导</a>进行造型。</p><p id="e5dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先通过运行<code class="fe lv lw lx ly b">npm install -g gatsby-cli</code>来安装Gatsby CLI。安装完成后，我们运行CLI程序为网站添加初始代码。我们运行<code class="fe lv lw lx ly b">gatsby new gatsby-blog</code>来建立一个新站点。</p><p id="dba4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们为Gatsby安装一些附加包来做一些事情，比如从markdown文件中获取内容和显示图像。</p><p id="ff08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过运行以下命令安装软件包:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="e81d" class="md me it ly b gy mf mg l mh mi">npm i @mdx-js/mdx @mdx-js/react bootstrap gatsby-image gatsby-paginate gatsby-plugin-manifest gatsby-plugin-mdx gatsby-plugin-offline gatsby-plugin-react-helmet gatsby-plugin-sharp gatsby-remark-images gatsby-source-filesystem gatsby-transformer-remark gatsby-transformer-sharp jquery lodash popper.js react-helmet</span></pre><p id="7675" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个列表中的主要包是用于显示图像的<code class="fe lv lw lx ly b">gatsby-image</code>，用于获取降价文件并在我们的模板中显示它们的<code class="fe lv lw lx ly b">gatsby-source-filesystem</code>。</p><p id="35b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">react-helmet</code>为我们的博客添加了一个<code class="fe lv lw lx ly b">head</code>标签，用于包含外部CSS和脚本文件。<code class="fe lv lw lx ly b">gatsby-transformer-remark</code>用于将markdown转换成HTML文本。<code class="fe lv lw lx ly b">gatsby-transformer-sharp</code>用于转换各种来源的图像，以显示在我们的网站上。</p><p id="5e4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">包安装完成后，我们就可以开始编写代码了。在<code class="fe lv lw lx ly b">components</code>文件夹中，我们首先处理<code class="fe lv lw lx ly b">header.js</code>。</p><p id="af88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在那里，我们放上:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="6c8c" class="md me it ly b gy mf mg l mh mi">import { Link } from "gatsby"<br/>import PropTypes from "prop-types"<br/>import React from "react"<br/>import { StaticQuery, graphql } from "gatsby"<br/>import _ from "lodash"<br/>import "./header.css"</span><span id="d0d3" class="md me it ly b gy mj mg l mh mi">const Header = ({ siteTitle }) =&gt; (<br/>  &lt;nav className="navbar navbar-expand-md bg-dark navbar-dark"&gt;<br/>    &lt;a className="navbar-brand" href="#"&gt;<br/>      {siteTitle}<br/>    &lt;/a&gt;</span><span id="4636" class="md me it ly b gy mj mg l mh mi">    &lt;button<br/>      className="navbar-toggler"<br/>      type="button"<br/>      data-toggle="collapse"<br/>      data-target="#collapsibleNavbar"<br/>    &gt;<br/>      &lt;span className="navbar-toggler-icon"&gt;&lt;/span&gt;<br/>    &lt;/button&gt;<br/>    &lt;div className="collapse navbar-collapse" id="collapsibleNavbar"&gt;<br/>      &lt;ul className="navbar-nav"&gt;<br/>        &lt;li className="nav-item"&gt;<br/>          &lt;Link to="blog/page/1" className="nav-link"&gt;<br/>            Home<br/>          &lt;/Link&gt;<br/>        &lt;/li&gt;<br/>        &lt;li className="nav-item dropdown"&gt;<br/>          &lt;a<br/>            className="nav-link dropdown-toggle"<br/>            href="#"<br/>            id="navbarDropdown"<br/>            role="button"<br/>            data-toggle="dropdown"<br/>            aria-haspopup="true"<br/>            aria-expanded="false"<br/>          &gt;<br/>            Categories<br/>          &lt;/a&gt;<br/>          &lt;div className="dropdown-menu" aria-labelledby="navbarDropdown"&gt;<br/>            &lt;StaticQuery<br/>              query={graphql`<br/>                query CategoryQuery {<br/>                  allMarkdownRemark(limit: 2000) {<br/>                    group(field: frontmatter___tags) {<br/>                      fieldValue<br/>                    }<br/>                  }<br/>                }<br/>              `}<br/>              render={data =&gt; {<br/>                return data.allMarkdownRemark.group.map(g =&gt; {<br/>                  return (<br/>                    &lt;Link<br/>                      to={`tags/${g.fieldValue}`}<br/>                      className="dropdown-item"<br/>                    &gt;<br/>                      {_.capitalize(g.fieldValue)}<br/>                    &lt;/Link&gt;<br/>                  )<br/>                })<br/>              }}<br/>            /&gt;<br/>          &lt;/div&gt;<br/>        &lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/div&gt;<br/>  &lt;/nav&gt;<br/>)</span><span id="8a35" class="md me it ly b gy mj mg l mh mi">Header.propTypes = {<br/>  siteTitle: PropTypes.string,<br/>}</span><span id="b274" class="md me it ly b gy mj mg l mh mi">Header.defaultProps = {<br/>  siteTitle: ``,<br/>}</span><span id="3610" class="md me it ly b gy mj mg l mh mi">export default Header</span></pre><p id="059e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将引导导航栏添加到我们的应用程序中。我们获取所有帖子的标签，并在导航栏的下拉列表中显示它们。</p><p id="6418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">header.css</code>中，我们把:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="4568" class="md me it ly b gy mf mg l mh mi">.navbar-brand {<br/>  font-size: 20px;<br/>  margin-top: -20px;<br/>}</span><span id="cb4b" class="md me it ly b gy mj mg l mh mi">nav.navbar {<br/>  padding-bottom: 0px;<br/>  height: 60px;<br/>}</span></pre><p id="dcc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更改导航栏的高度以及字体大小和边距。</p><p id="0df6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们为博客设计通用布局。我们在<code class="fe lv lw lx ly b">components</code>文件夹中创建一个名为<code class="fe lv lw lx ly b">layout.js</code>的文件，如果它还不存在，并添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3184" class="md me it ly b gy mf mg l mh mi">/**<br/> * Layout component that queries for data<br/> * with Gatsby's useStaticQuery component<br/> *<br/> * See: <a class="ae ky" href="https://www.gatsbyjs.org/docs/use-static-query/" rel="noopener ugc nofollow" target="_blank">https://www.gatsbyjs.org/docs/use-static-query/</a><br/> */</span><span id="39d6" class="md me it ly b gy mj mg l mh mi">import React from "react"<br/>import PropTypes from "prop-types"<br/>import { useStaticQuery, graphql } from "gatsby"<br/>import { Helmet } from "react-helmet"<br/>import Header from "./header"<br/>import "./layout.css"</span><span id="65b5" class="md me it ly b gy mj mg l mh mi">const Layout = ({ children }) =&gt; {<br/>  const data = useStaticQuery(graphql`<br/>    query SiteTitleQuery {<br/>      site {<br/>        siteMetadata {<br/>          title<br/>        }<br/>      }<br/>    }<br/>  `)</span><span id="c23b" class="md me it ly b gy mj mg l mh mi">  return (<br/>    &lt;&gt;<br/>      &lt;Helmet&gt;<br/>        &lt;title&gt;Gatsby Blog&lt;/title&gt;<br/>        &lt;script<br/>          src="<a class="ae ky" href="https://code.jquery.com/jquery-3.3.1.slim.min.js" rel="noopener ugc nofollow" target="_blank">https://code.jquery.com/jquery-3.3.1.slim.min.js</a>"<br/>          integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"<br/>          crossOrigin="anonymous"<br/>        &gt;&lt;/script&gt;<br/>        &lt;script<br/>          src="<a class="ae ky" href="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js</a>"<br/>          integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"<br/>          crossOrigin="anonymous"<br/>        &gt;&lt;/script&gt;<br/>        &lt;script<br/>          src="<a class="ae ky" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js</a>"<br/>          integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"<br/>          crossOrigin="anonymous"<br/>        &gt;&lt;/script&gt;<br/>        &lt;link<br/>          href="<a class="ae ky" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>          rel="stylesheet"<br/>          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"<br/>          crossOrigin="anonymous"<br/>        /&gt;<br/>      &lt;/Helmet&gt;<br/>      &lt;Header siteTitle={data.site.siteMetadata.title} /&gt;<br/>      &lt;div<br/>        style={{<br/>          margin: `0 auto`,<br/>          maxWidth: 960,<br/>          padding: `0px 1.0875rem 1.45rem`,<br/>          paddingTop: 0,<br/>        }}<br/>      &gt;<br/>        &lt;main&gt;{children}&lt;/main&gt;<br/>        &lt;footer&gt;<br/>          © {new Date().getFullYear()}, Built with<br/>          {` `}<br/>          &lt;a href="<a class="ae ky" href="https://www.gatsbyjs.org" rel="noopener ugc nofollow" target="_blank">https://www.gatsbyjs.org</a>"&gt;Gatsby&lt;/a&gt;<br/>        &lt;/footer&gt;<br/>      &lt;/div&gt;<br/>    &lt;/&gt;<br/>  )<br/>}</span><span id="4634" class="md me it ly b gy mj mg l mh mi">Layout.propTypes = {<br/>  children: PropTypes.node.isRequired,<br/>}</span><span id="995c" class="md me it ly b gy mj mg l mh mi">export default Layout</span></pre><p id="1ea3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个文件中，我们为HTML页面添加了<code class="fe lv lw lx ly b">head</code>标签。我们在<code class="fe lv lw lx ly b">Helmet</code>组件中包含了引导CSS和代码文件以及<a class="ae ky" href="https://jquery.com/" rel="noopener ugc nofollow" target="_blank"> jQuery </a>，它们将被转换成页面中的<code class="fe lv lw lx ly b">head</code>标签。</p><p id="31fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们添加我们的内容，在<code class="fe lv lw lx ly b">src</code>文件夹中创建一个<code class="fe lv lw lx ly b">markdown-pages</code>文件夹。然后，我们创建一些降价文件。</p><p id="00cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将以下文件添加到<code class="fe lv lw lx ly b">markdown-pages</code>文件夹中:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="2065" class="md me it ly b gy mf mg l mh mi">check-variable-number.md<br/>clone-array.md<br/>concat-array.md<br/>exponentiation.md<br/>get-length-obj.md<br/>repeat-string.md<br/>send-email.md</span></pre><p id="8643" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在<code class="fe lv lw lx ly b">check-variable-number.md</code>中，我们添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="4851" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/check-variable-number"<br/>date: "2019-05-04"<br/>title: "How to Check if a Variable is a Number"<br/>tags: ["number"]<br/>---</span><span id="d2d6" class="md me it ly b gy mj mg l mh mi">We can check if a variable is a number in multiple ways.</span><span id="d50a" class="md me it ly b gy mj mg l mh mi">## isNaN</span><span id="6092" class="md me it ly b gy mj mg l mh mi">We can check by calling `isNaN` with the variable as the argument. It also detects if a string’s content is a number. For example:</span><span id="9107" class="md me it ly b gy mj mg l mh mi">```<br/>isNaN(1) // false<br/>isNaN('1') // false<br/>isNaN('abc') // true<br/>```</span><span id="0021" class="md me it ly b gy mj mg l mh mi">**Note:** `isNaN(null)` is `true` .</span><span id="fe18" class="md me it ly b gy mj mg l mh mi">### typeof Operator</span><span id="3b35" class="md me it ly b gy mj mg l mh mi">We can use the `typeof` operator before a variable to check if it’s a number, like so:</span><span id="d964" class="md me it ly b gy mj mg l mh mi">```<br/>typeof 1 == 'number' // true<br/>typeof '1' == 'number' // false<br/>```</span><span id="a53b" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png</a>)</span></pre><p id="26e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">clone-array.md</code>中，我们添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="4f66" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/clone-array"<br/>date: "2019-05-04"<br/>title: "How to Clone Array in JavaScript"<br/>tags: ["array"]<br/>---</span><span id="a0e0" class="md me it ly b gy mj mg l mh mi">There are a few ways to clone an array in JavaScript,</span><span id="831b" class="md me it ly b gy mj mg l mh mi">### Object.assign</span><span id="f612" class="md me it ly b gy mj mg l mh mi">`Object.assign` allows us to make a shallow copy of any kind of object including arrays.</span><span id="29c9" class="md me it ly b gy mj mg l mh mi">For example:</span><span id="3c3d" class="md me it ly b gy mj mg l mh mi">&lt;pre&gt;const a = [1,2,3];<br/>const b = Object.assign([], a); // [1,2,3]&lt;/pre&gt;</span><span id="bdba" class="md me it ly b gy mj mg l mh mi">### Array.slice</span><span id="7547" class="md me it ly b gy mj mg l mh mi">The `Array.slice` function returns a copy of the original array.</span><span id="f9fa" class="md me it ly b gy mj mg l mh mi">For example:</span><span id="f8eb" class="md me it ly b gy mj mg l mh mi">&lt;pre&gt;const a = [1,2,3];<br/>const b = a.slice(0); // [1,2,3]&lt;/pre&gt;</span><span id="0c7c" class="md me it ly b gy mj mg l mh mi">### Array.from</span><span id="d6b7" class="md me it ly b gy mj mg l mh mi">The `Array.slice` function returns a copy of the original array. It takes array like objects like `Set` and it also takes an array as an argument.</span><span id="a457" class="md me it ly b gy mj mg l mh mi">&lt;pre&gt;const a = [1,2,3];<br/>const b = Array.from(a); // [1,2,3]&lt;/pre&gt;</span><span id="25dd" class="md me it ly b gy mj mg l mh mi">### Spread Operator</span><span id="a263" class="md me it ly b gy mj mg l mh mi">The fastest way to copy an array, which is available with ES6 or later, is the spread operator.</span><span id="5a1c" class="md me it ly b gy mj mg l mh mi">&lt;pre&gt;const a = [1,2,3];<br/>const b = [...a]; // [1,2,3]&lt;/pre&gt;</span><span id="aa4c" class="md me it ly b gy mj mg l mh mi">### JSON.parse and JSON.stringify</span><span id="88a6" class="md me it ly b gy mj mg l mh mi">This allows for deep copy of an array and only works if the objects in the array are plain objects. It can be used like this:</span><span id="ddd5" class="md me it ly b gy mj mg l mh mi">&lt;pre&gt;const a = [1,2,3];<br/>const b = JSON.parse(JSON.stringify(a)); // [1,2,3]&lt;/pre&gt;</span></pre><p id="a313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在<code class="fe lv lw lx ly b">concat-array.md</code>中，我们添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="a6af" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/concat-array"<br/>date: "2019-05-04"<br/>title: "How to Concatenate Array in JavaScript"<br/>tags: ["array"]<br/>---</span><span id="cd50" class="md me it ly b gy mj mg l mh mi">There are a few ways to concatenate arrays in JavaScript.</span><span id="f498" class="md me it ly b gy mj mg l mh mi">## Array.concat</span><span id="fae6" class="md me it ly b gy mj mg l mh mi">We can all `Array.concat` on an array to combine 2 arrays and return the new one. For example:</span><span id="a9a9" class="md me it ly b gy mj mg l mh mi">```<br/>const a = [1,2,3];<br/>const b = [4,5];<br/>const c = a.concat(b) // [1,2,3,4,5]<br/>```</span><span id="e2bf" class="md me it ly b gy mj mg l mh mi">## Array.push</span><span id="0019" class="md me it ly b gy mj mg l mh mi">We can push elements of one array into another.</span><span id="87e4" class="md me it ly b gy mj mg l mh mi">```<br/>const a = [1,2,3];<br/>const b = [4,5];<br/>let c = Object.assign([], a);<br/>for (let i = 0; i &lt; b.length; i++){<br/>  c.push(b[i]);<br/>}<br/>console.log(c); // [1,2,3,4,5]<br/>```</span><span id="6233" class="md me it ly b gy mj mg l mh mi">What we did is make a copy of `a` and assigned it to `c` , then pushed the elements of `b` by looping through it and adding them to the end of `c` .</span><span id="f49e" class="md me it ly b gy mj mg l mh mi">## Spread Operator</span><span id="c47d" class="md me it ly b gy mj mg l mh mi">With ES6 or later, we can use the spread operator to spread the items from another array into a new array by doing the following:</span><span id="080f" class="md me it ly b gy mj mg l mh mi">```<br/>const a = [1,2,3];<br/>const b = [4,5];<br/>const c = [...a, ...b];<br/>console.log(c); // [1,2,3,4,5]<br/>```</span><span id="724d" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png</a>)</span></pre><p id="b025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">exponentiation.md</code>中，我们添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="f64c" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/exponentiation"<br/>date: "2019-05-04"<br/>title: "How to do Exponentiation in JavaScript"<br/>tags: ["number"]<br/>---</span><span id="c93f" class="md me it ly b gy mj mg l mh mi">There are multiple to compute exponents with JavaScript.</span><span id="265e" class="md me it ly b gy mj mg l mh mi">The newest way is the exponentiation operator `**`, available with ES2016 or higher.</span><span id="56d4" class="md me it ly b gy mj mg l mh mi">For example, we can do this:</span><span id="8f10" class="md me it ly b gy mj mg l mh mi">```<br/>const a = 2 ** 3; // 8<br/>```</span><span id="1088" class="md me it ly b gy mj mg l mh mi">It is right associative, so `a ** b ** c` is equal to `a ** (b ** c)`. This works with all exponents.</span><span id="587e" class="md me it ly b gy mj mg l mh mi">For example:</span><span id="6b28" class="md me it ly b gy mj mg l mh mi">```<br/>const a = 2 ** (3 ** 4);<br/>const b = 2 ** 3 ** 4;<br/>a == b // true, both are 2.4178516392292583e+24<br/>```</span><span id="5987" class="md me it ly b gy mj mg l mh mi">Detail browser compatibility is available at [<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Browser_compatibility](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Browser_compatibility)" rel="noopener ugc nofollow" target="_blank">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Browser_compatibility](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Browser_compatibility)</a></span><span id="e9fa" class="md me it ly b gy mj mg l mh mi">We can also use the `Math.pow` function, like this:</span><span id="5fdd" class="md me it ly b gy mj mg l mh mi">```<br/>const a = Math.pow(2,3) // 8<br/>```</span><span id="976b" class="md me it ly b gy mj mg l mh mi">It takes 2 arguments, the first is the base and the second is the exponent. `Math.pow` works with all exponents.</span><span id="3e3e" class="md me it ly b gy mj mg l mh mi">`Math.pow` is compatible with all recent browsers.</span><span id="9939" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png</a>)</span></pre><p id="4269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">get-length-obj.md</code>中，我们加上:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="e3b8" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/get-length-obj"<br/>date: "2019-05-04"<br/>title: "How to Get the Length of An Object"<br/>tags: ["object"]<br/>---</span><span id="fa21" class="md me it ly b gy mj mg l mh mi">There are 2 ways to get the length of the list of keys of an object.</span><span id="8c05" class="md me it ly b gy mj mg l mh mi">## Object.keys</span><span id="d465" class="md me it ly b gy mj mg l mh mi">`Object.keys` gets the top level list of keys of an object and returns an array of them. For example:</span><span id="f2a7" class="md me it ly b gy mj mg l mh mi">```<br/>const a = {foo: 1, bar: 2};<br/>const length = Object.keys(a).length // 2<br/>```</span><span id="3fa6" class="md me it ly b gy mj mg l mh mi">## Object.getPropertyNames</span><span id="93e7" class="md me it ly b gy mj mg l mh mi">`Object.getPropertyNames` also gets a list of all top level of keys of an object and return them as an array. For example:</span><span id="f2ed" class="md me it ly b gy mj mg l mh mi">```<br/>const a = {foo: 1, bar: 2};<br/>const length = Object.`getOwnPropertyNames`(a).length // 2<br/>```</span><span id="2fa0" class="md me it ly b gy mj mg l mh mi">## for…in Loop</span><span id="fc3b" class="md me it ly b gy mj mg l mh mi">There is a special loop for looping through the keys of an object. You can do the following:</span><span id="9f4f" class="md me it ly b gy mj mg l mh mi">```<br/>const a = {foo: 1, bar: 2};<br/>let keysCount = 0;<br/>for (let key in a) {<br/>    keysCount++;<br/>}<br/>console.log(`keysCount) // 2<br/>```</span><span id="254a" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png</a>)</span></pre><p id="5b4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">repeat-strings.md</code>中，我们添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="211b" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/repeat-strings"<br/>date: "2019-05-04"<br/>title: "How to Repeat Strings with JavaScript"<br/>tags: ["string"]<br/>---</span><span id="f491" class="md me it ly b gy mj mg l mh mi">There are a few ways to repeat a string in JavaScript. JavaScript strings have a built in `repeat()` function. You can also use a loop to do the same thing.</span><span id="0f10" class="md me it ly b gy mj mg l mh mi">## String.repeat Function</span><span id="9815" class="md me it ly b gy mj mg l mh mi">To use the `repeat` function, you pass in the number of times you want to repeat the string as an argument. It returns a new string</span><span id="8cd5" class="md me it ly b gy mj mg l mh mi">For example:<br/>```<br/>const hello = "hello";<br/>const hello5 = A.repeat(5);<br/>console.log(hello5); // "hellohellohellohellohello"<br/>```</span><span id="316b" class="md me it ly b gy mj mg l mh mi">## Use a loop</span><span id="ac53" class="md me it ly b gy mj mg l mh mi">You can use `for` loop and `while` loop to do repeatedly concatenate strings.</span><span id="5139" class="md me it ly b gy mj mg l mh mi">Using a `for` loop, you can do:</span><span id="974d" class="md me it ly b gy mj mg l mh mi">```<br/>const hello = "hello";<br/>```</span><span id="968a" class="md me it ly b gy mj mg l mh mi">With a `while` loop, you can do:</span><span id="f04f" class="md me it ly b gy mj mg l mh mi">```<br/>const hello = "hello";<br/>```</span><span id="7668" class="md me it ly b gy mj mg l mh mi">They both involve increment indexes up to the maximum.</span><span id="4533" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*3X6EiKc-njoRpCB1AWnv3Q.png</a>)</span></pre><p id="290f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">send-email.md</code>中，我们加上:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="87af" class="md me it ly b gy mf mg l mh mi">---<br/>path: "/blog/send-email"<br/>date: "2019-05-04"<br/>title: "How to Send Email with SendGrid in Node.js Apps"<br/>tags: ["array"]<br/>---</span><span id="1471" class="md me it ly b gy mj mg l mh mi">SendGrid is a great service made by Twilio for sending emails. Rather than setting up your own email server for sending email with your apps, we use SendGrid to do the hard work for us. It also decrease the chance of email ending up in spam since it is a known trustworthy service.</span><span id="8b8a" class="md me it ly b gy mj mg l mh mi">It also has very easy to use libraries for various platforms for sending emails. Node.js is one of the platforms that are supported.</span><span id="b114" class="md me it ly b gy mj mg l mh mi">To send emails with SendGrid, install the SendGrid SDK package by running `npm i <a class="ae ky" href="http://twitter.com/sendgrid/mail" rel="noopener ugc nofollow" target="_blank">@sendgrid/mail</a>` . Then in your code, add `const sgMail = require(‘<a class="ae ky" href="http://twitter.com/sendgrid/mail" rel="noopener ugc nofollow" target="_blank">@sendgrid/mail</a>’);` to import the installed package.</span><span id="3e4b" class="md me it ly b gy mj mg l mh mi">Then in your code, you send email by:</span><span id="4fb0" class="md me it ly b gy mj mg l mh mi">```<br/>sgMail.setApiKey(process.env.SENDGRID_API_KEY);<br/>const msg = {<br/>  to: email,<br/>  from: '<a class="ae ky" href="mailto:email@example.com" rel="noopener ugc nofollow" target="_blank">email@example.com</a>',<br/>  subject: 'Example Email',<br/>  text: `<br/>    Dear user,  Here is your email.`,<br/>  html: `<br/>    &lt;p&gt;Dear user,&lt;/p&gt;&lt;/pre&gt;<br/>        Here is your email.&lt;/p&gt;`,<br/>};<br/>sgMail.send(msg);<br/>```</span><span id="f115" class="md me it ly b gy mj mg l mh mi">where `process.env.SENDGRID_API_KEY` is the SendGrid’s API, which should be stored as an environment variable since it is a secret.</span><span id="336d" class="md me it ly b gy mj mg l mh mi">Testing is easy since you don’t need to set up a local development email server.</span><span id="1f36" class="md me it ly b gy mj mg l mh mi">Sending email is this simple and easy with SendGrid API. It is also free if you send small amounts of email, which is a great benefit.</span><span id="3388" class="md me it ly b gy mj mg l mh mi">![](<a class="ae ky" href="https://cdn-images-1.medium.com/max/800/1*EdbfsnL3ABxWj2iVWmoIWA.png" rel="noopener">https://cdn-images-1.medium.com/max/800/1*EdbfsnL3ABxWj2iVWmoIWA.png</a>)</span></pre><p id="ae2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每个文件中，虚线之间是元数据。它们将从GraphQL查询中获得，并可以显示在我们的页面上，我们将显示它们。</p><p id="dd13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经处理了内容，我们可以处理静态页面了。我们通过添加顶部导航栏来改变默认的404页面。</p><p id="bf8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">404.js</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="a816" class="md me it ly b gy mf mg l mh mi">import React from "react"</span><span id="86e0" class="md me it ly b gy mj mg l mh mi">import Layout from "../components/layout"<br/>import SEO from "../components/seo"<br/>import Header from "../components/header";</span><span id="41a0" class="md me it ly b gy mj mg l mh mi">const NotFoundPage = () =&gt; (<br/>  &lt;Layout&gt;<br/>    &lt;SEO title="404: Not found" /&gt;<br/>    &lt;h1&gt;NOT FOUND&lt;/h1&gt;<br/>    &lt;p&gt;You just hit a route that doesn&amp;#39;t exist... the sadness.&lt;/p&gt;<br/>  &lt;/Layout&gt;<br/>)</span><span id="852b" class="md me it ly b gy mj mg l mh mi">export default NotFoundPage</span></pre><p id="0711" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">组件中的所有东西都将被应用到这个页面，包括导航条和引导样式。</p><p id="c418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">index.js</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="a9b3" class="md me it ly b gy mf mg l mh mi">import React from "react"</span><span id="2a2f" class="md me it ly b gy mj mg l mh mi">import Layout from "../components/layout"<br/>import SEO from "../components/seo"<br/>import { useEffect } from "react"<br/>import { navigate } from "gatsby"</span><span id="6033" class="md me it ly b gy mj mg l mh mi">const IndexPage = () =&gt; {<br/>  useEffect(() =&gt; {<br/>    navigate("/blog/page/1")<br/>  }, [])</span><span id="a460" class="md me it ly b gy mj mg l mh mi">  return (<br/>    &lt;Layout&gt;<br/>      &lt;SEO title="Home" /&gt;<br/>    &lt;/Layout&gt;<br/>  )<br/>}</span><span id="f64a" class="md me it ly b gy mj mg l mh mi">export default IndexPage</span></pre><p id="ca1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重定向到我们将创建的博客模板。</p><p id="d85b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们创建模板。我们在<code class="fe lv lw lx ly b">src</code>文件夹中创建一个<code class="fe lv lw lx ly b">templates</code>文件夹来存储我们的模板。</p><p id="8379" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在那里，创建<code class="fe lv lw lx ly b">blog-list-template.js</code>并添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="53bc" class="md me it ly b gy mf mg l mh mi">import React from "react"<br/>import { graphql, Link } from "gatsby"<br/>import Layout from "../components/layout"<br/>export default class BlogList extends React.Component {<br/>  constructor(props) {<br/>    super(props)<br/>    this.state = { pageNumArray: [1] }<br/>  }</span><span id="ad9a" class="md me it ly b gy mj mg l mh mi">  componentDidMount() {<br/>    this.setPageArray()<br/>  }</span><span id="e565" class="md me it ly b gy mj mg l mh mi">  componentWillReceiveProps() {<br/>    this.setPageArray()<br/>  }</span><span id="1b34" class="md me it ly b gy mj mg l mh mi">  setPageArray() {<br/>    const totalCount = this.props.data.allMarkdownRemark.totalCount<br/>    const postsPerPage = this.props.data.allMarkdownRemark.pageInfo.perPage<br/>    let pageNumArray = Array.from(<br/>      { length: Math.ceil(totalCount / postsPerPage) },<br/>      (v, i) =&gt; i + 1<br/>    )<br/>    this.setState({ pageNumArray })<br/>  }</span><span id="4c78" class="md me it ly b gy mj mg l mh mi">render() {<br/>    const posts = this.props.data.allMarkdownRemark.edges<br/>    const pathNames = this.props.location.pathname.split("/")<br/>    const page = pathNames[pathNames.length - 1]<br/>    return (<br/>      &lt;Layout&gt;<br/>        {posts.map(({ node }) =&gt; {<br/>          const title = node.frontmatter.title || node.fields.slug<br/>          return (<br/>            &lt;div key={node.fields.slug}&gt;<br/>              &lt;h1&gt;{title}&lt;/h1&gt;<br/>              &lt;b&gt;Date Posted: {node.frontmatter.date}&lt;/b&gt;<br/>              &lt;div dangerouslySetInnerHTML={{ __html: node.html }} /&gt;<br/>            &lt;/div&gt;<br/>          )<br/>        })}<br/>        &lt;nav aria-label="Page navigation example"&gt;<br/>          &lt;ul className="pagination"&gt;<br/>            {this.state.pageNumArray.map(p =&gt; (<br/>              &lt;li className={`page-item ${page == p ? "active" : ""}`} key={p}&gt;<br/>                &lt;Link className={`page-link`} to={`blog/page/${p}`}&gt;<br/>                  {p}<br/>                &lt;/Link&gt;<br/>              &lt;/li&gt;<br/>            ))}<br/>          &lt;/ul&gt;<br/>        &lt;/nav&gt;<br/>      &lt;/Layout&gt;<br/>    )<br/>  }<br/>}<br/>export const blogListQuery = graphql`<br/>  query blogListQuery($skip: Int!, $limit: Int!) {<br/>    allMarkdownRemark(<br/>      sort: { fields: [frontmatter___date], order: DESC }<br/>      limit: $limit<br/>      skip: $skip<br/>    ) {<br/>      edges {<br/>        node {<br/>          fields {<br/>            slug<br/>          }<br/>          frontmatter {<br/>            title<br/>            date<br/>          }<br/>          html<br/>        }<br/>      }<br/>      pageInfo {<br/>        perPage<br/>      }<br/>      totalCount<br/>    }<br/>  }<br/>`</span></pre><p id="7b33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，显示提供我们将在<code class="fe lv lw lx ly b">gatsby-node.js</code>中添加的查询的内容。</p><p id="a771" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">blogListQuery</code>通过运行查询并返回结果来过滤内容。然后，结果将显示在上面的组件中。</p><p id="3072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">setPageArray</code>函数通过获取总页数来获取页码，然后将其设置为组件状态，这样我们就可以链接到该页面，其呈现方式如下:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="8534" class="md me it ly b gy mf mg l mh mi">{this.state.pageNumArray.map(p =&gt; (<br/>   &lt;li className={`page-item ${page == p ? "active" : ""}`} key={p}&gt;<br/>     &lt;Link className={`page-link`} to={`blog/page/${p}`}&gt;<br/>     {p}<br/>     &lt;/Link&gt;<br/>   &lt;/li&gt;<br/>))}</span></pre><p id="55d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">博客帖子由以下人员呈现:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3fce" class="md me it ly b gy mf mg l mh mi">{posts.map(({ node }) =&gt; {<br/>  const title = node.frontmatter.title || node.fields.slug<br/>  return (<br/>    &lt;div key={node.fields.slug}&gt;<br/>      &lt;h1&gt;{title}&lt;/h1&gt;<br/>      &lt;b&gt;Date Posted: {node.frontmatter.date}&lt;/b&gt;<br/>      &lt;div dangerouslySetInnerHTML={{ __html: node.html }} /&gt;<br/>      &lt;/div&gt;<br/>  )<br/>})}</span></pre><p id="38a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Gatsby对HTML进行了净化，因此我们可以通过直接用<code class="fe lv lw lx ly b">dangerouslySetInnerHTML</code>设置它来显示它。接下来，我们制作一个模板来显示带有特定标签的帖子。</p><p id="e3c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们在<code class="fe lv lw lx ly b">templates</code>文件夹中创建<code class="fe lv lw lx ly b">tags.js</code>并添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="d14a" class="md me it ly b gy mf mg l mh mi">import React from "react"<br/>import PropTypes from "prop-types"<br/>import Layout from "../components/layout"<br/>import _ from "lodash"<br/>// Components<br/>import { Link, graphql } from "gatsby"</span><span id="830a" class="md me it ly b gy mj mg l mh mi">const Tags = ({ pageContext, data }) =&gt; {<br/>  const { tag } = pageContext<br/>  const { edges, totalCount } = data.allMarkdownRemark<br/>  const tagHeader = `${totalCount} post${<br/>    totalCount === 1 ? "" : "s"<br/>  } tagged with "${_.capitalize(tag)}"`</span><span id="9a4e" class="md me it ly b gy mj mg l mh mi">  return (<br/>    &lt;Layout&gt;<br/>      &lt;h1&gt;{tagHeader}&lt;/h1&gt;<br/>      {edges.map(({ node }) =&gt; {<br/>        const { slug } = node.fields<br/>        const { title, date } = node.frontmatter<br/>        return (<br/>          &lt;div key={slug}&gt;<br/>            &lt;h1&gt;{title}&lt;/h1&gt;<br/>            &lt;b&gt;Date Posted: {date}&lt;/b&gt;<br/>            &lt;div dangerouslySetInnerHTML={{ __html: node.html }} /&gt;<br/>          &lt;/div&gt;<br/>        )<br/>      })}<br/>    &lt;/Layout&gt;<br/>  )<br/>}</span><span id="b644" class="md me it ly b gy mj mg l mh mi">Tags.propTypes = {<br/>  pageContext: PropTypes.shape({<br/>    tag: PropTypes.string.isRequired,<br/>  }),<br/>  data: PropTypes.shape({<br/>    allMarkdownRemark: PropTypes.shape({<br/>      totalCount: PropTypes.number.isRequired,<br/>      edges: PropTypes.arrayOf(<br/>        PropTypes.shape({<br/>          node: PropTypes.shape({<br/>            frontmatter: PropTypes.shape({<br/>              title: PropTypes.string.isRequired,<br/>            }),<br/>            fields: PropTypes.shape({<br/>              slug: PropTypes.string.isRequired,<br/>            }),<br/>          }),<br/>        }).isRequired<br/>      ),<br/>    }),<br/>  }),<br/>}</span><span id="9b8e" class="md me it ly b gy mj mg l mh mi">export default Tags</span><span id="89e0" class="md me it ly b gy mj mg l mh mi">export const pageQuery = graphql`<br/>  query($tag: String) {<br/>    allMarkdownRemark(<br/>      limit: 2000<br/>      sort: { fields: [frontmatter___date], order: DESC }<br/>      filter: { frontmatter: { tags: { in: [$tag] } } }<br/>    ) {<br/>      totalCount<br/>      edges {<br/>        node {<br/>          fields {<br/>            slug<br/>          }<br/>          frontmatter {<br/>            title<br/>            date<br/>          }<br/>          html<br/>        }<br/>      }<br/>    }<br/>  }<br/>`</span></pre><p id="37a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其工作原理与<code class="fe lv lw lx ly b">blog-list-template.js</code>类似。底部的GraphQL查询获取用给定标签标记的文章，然后通过运行上面的组件代码显示它们。</p><p id="8311" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们页面的元数据在每个条目的<code class="fe lv lw lx ly b">frontmatter</code>对象中。</p><p id="37a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在<code class="fe lv lw lx ly b">gatsby-config.js</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3b1d" class="md me it ly b gy mf mg l mh mi">module.exports = {<br/>  siteMetadata: {<br/>    title: `Gatsby Blog`,<br/>    description: `Gatsby Blog`,<br/>    author: `<a class="ae ky" href="http://twitter.com/gatsbyjs" rel="noopener ugc nofollow" target="_blank">@gatsbyjs</a>`,<br/>  },<br/>  plugins: [<br/>    `gatsby-plugin-react-helmet`,<br/>    {<br/>      resolve: `gatsby-source-filesystem`,<br/>      options: {<br/>        name: `images`,<br/>        path: `${__dirname}/src/images`,<br/>      },<br/>    },<br/>    `gatsby-transformer-sharp`,<br/>    `gatsby-plugin-sharp`,<br/>    {<br/>      resolve: `gatsby-plugin-mdx`,<br/>      options: {<br/>        gatsbyRemarkPlugins: [<br/>          {<br/>            resolve: `gatsby-remark-images`,<br/>            options: {<br/>              maxWidth: 1200,<br/>            },<br/>          },<br/>        ],<br/>      },<br/>    },<br/>    {<br/>      resolve: `gatsby-plugin-manifest`,<br/>      options: {<br/>        name: `gatsby-starter-default`,<br/>        short_name: `starter`,<br/>        start_url: `/blog/page/1`,<br/>      },<br/>    },<br/>    // this (optional) plugin enables Progressive Web App + Offline functionality<br/>    // To learn more, visit: <a class="ae ky" href="https://gatsby.dev/offline" rel="noopener ugc nofollow" target="_blank">https://gatsby.dev/offline</a><br/>    // `gatsby-plugin-offline`,<br/>    {<br/>      resolve: `gatsby-source-filesystem`,<br/>      options: {<br/>        name: `markdown-pages`,<br/>        path: `${__dirname}/src/markdown-pages`,<br/>      },<br/>    },<br/>    `gatsby-plugin-react-helmet`,<br/>    {<br/>      resolve: `gatsby-transformer-remark`,<br/>      options: {<br/>        plugins: [<br/>          {<br/>            resolve: `gatsby-remark-images`,<br/>            options: {<br/>              // It's important to specify the maxWidth (in pixels) of<br/>              // the content container as this plugin uses this as the<br/>              // base for generating different widths of each image.<br/>              maxWidth: 590,<br/>            },<br/>          },<br/>        ],<br/>      },<br/>    },<br/>  ],<br/>}</span></pre><p id="eb93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以便我们安装的所有软件包都能运行。</p><p id="af45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在<code class="fe lv lw lx ly b">gatsby-node.js</code>中，我们将现有代码替换为:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="ca13" class="md me it ly b gy mf mg l mh mi">const _ = require("lodash")<br/>const path = require("path")<br/>const { createFilePath } = require("gatsby-source-filesystem")</span><span id="7ec0" class="md me it ly b gy mj mg l mh mi">exports.createPages = async ({ graphql, actions, reporter }) =&gt; {<br/>  const { createPage } = actions<br/>  const result = await graphql(<br/>    `<br/>      {<br/>        postRemark: allMarkdownRemark(<br/>          sort: { fields: [frontmatter___date], order: DESC }<br/>          limit: 1000<br/>        ) {<br/>          edges {<br/>            node {<br/>              fields {<br/>                slug<br/>              }<br/>            }<br/>          }<br/>        }<br/>        tagsGroup: allMarkdownRemark(limit: 2000) {<br/>          group(field: frontmatter___tags) {<br/>            fieldValue<br/>          }<br/>        }<br/>      }<br/>    `<br/>  )<br/>  if (result.errors) {<br/>    reporter.panicOnBuild(`Error while running GraphQL query.`)<br/>    return<br/>  }<br/>  // ...<br/>  // Create blog-list pages<br/>  const posts = result.data.postRemark.edges<br/>  const postsPerPage = 5<br/>  const numPages = Math.ceil(posts.length / postsPerPage)<br/>  Array.from({ length: numPages }).forEach((_, i) =&gt; {<br/>    createPage({<br/>      path: `/blog/page/${i + 1}`,<br/>      component: path.resolve("./src/templates/blog-list-template.js"),<br/>      context: {<br/>        limit: postsPerPage,<br/>        skip: i * postsPerPage,<br/>        numPages,<br/>        currentPage: i + 1,<br/>      },<br/>    })<br/>  })</span><span id="221d" class="md me it ly b gy mj mg l mh mi">const tags = result.data.tagsGroup.group<br/>  tags.forEach(tag =&gt; {<br/>    createPage({<br/>      path: `/tags/${_.kebabCase(tag.fieldValue)}/`,<br/>      component: path.resolve("./src/templates/tags.js"),<br/>      context: {<br/>        tag: tag.fieldValue,<br/>      },<br/>    })<br/>  })<br/>}<br/>exports.onCreateNode = ({ node, actions, getNode }) =&gt; {<br/>  const { createNodeField } = actions<br/>  if (node.internal.type === `MarkdownRemark`) {<br/>    const value = createFilePath({ node, getNode })<br/>    createNodeField({<br/>      name: `slug`,<br/>      node,<br/>      value,<br/>    })<br/>  }<br/>}</span></pre><p id="113b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的文件中，我们有一个获取所有帖子的查询，然后使用下面的<code class="fe lv lw lx ly b">postRemark</code>查询创建页面来分组显示它们:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="0868" class="md me it ly b gy mf mg l mh mi">postRemark: allMarkdownRemark(<br/>  sort: { fields: [frontmatter___date], order: DESC }<br/>    limit: 1000<br/>  ) {<br/>  edges {<br/>    node {<br/>      fields {<br/>        slug<br/>      }<br/>  }<br/>}</span></pre><p id="b121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用以下内容创建页面文件:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="6196" class="md me it ly b gy mf mg l mh mi">const posts = result.data.postRemark.edges<br/>  const postsPerPage = 5<br/>  const numPages = Math.ceil(posts.length / postsPerPage)<br/>  Array.from({ length: numPages }).forEach((_, i) =&gt; {<br/>    createPage({<br/>      path: `/blog/page/${i + 1}`,<br/>      component: path.resolve("./src/templates/blog-list-template.js"),<br/>      context: {<br/>        limit: postsPerPage,<br/>        skip: i * postsPerPage,<br/>        numPages,<br/>        currentPage: i + 1,<br/>      },<br/>    })<br/>  })</span></pre><p id="7fcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它查看返回的结果，并将结果条目通过管道传输到模板，以便在构建时生成页面。</p><p id="a526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的<code class="fe lv lw lx ly b">tagsGroup</code>查询:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3612" class="md me it ly b gy mf mg l mh mi">tagsGroup: allMarkdownRemark(limit: 2000) {<br/>    group(field: frontmatter___tags) {<br/>      fieldValue<br/>    }<br/>}</span></pre><p id="01b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">获取所有的标签，然后将标签传输到<code class="fe lv lw lx ly b">tags.js</code>模板中，在那里获取页面内容，并在构建期间创建页面，在每个页面上为给定的标签发布内容。</p><p id="577e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们准备运行<code class="fe lv lw lx ly b">gatsby build</code>来构建静态网站。文件应该建立在<code class="fe lv lw lx ly b">public</code>文件夹中。</p><p id="0e79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们安装一个HTTP服务器来服务构建的静态文件。我们将安装<code class="fe lv lw lx ly b">http-server</code> Node.js包。运行<code class="fe lv lw lx ly b">npm i -g http-server</code>。然后，运行<code class="fe lv lw lx ly b">http-server /path/to/gatsby-blog/public</code>。</p><p id="cec3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成所有这些后，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/025f34c7b0811f3ec2cebf9f36f92776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2pg1iDLwfv4m4JJ2pHIcg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/6412f6eb1dad2aa4f1323ef5a14d68fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rRmH28QznJaa8RPfVN5JnQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/32452daa3a08327d6c11c61b55b732b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukQ4DoxtAm60K8-j-MV8aw.png"/></div></div></figure></div></div>    
</body>
</html>