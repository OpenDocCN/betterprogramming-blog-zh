<html>
<head>
<title>To Compose, or Not to Compose, That is the Question</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创作，还是不创作，这是一个问题</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/to-compose-or-not-to-compose-that-is-the-question-fa616c270b5?source=collection_archive---------8-----------------------#2022-04-25">https://betterprogramming.pub/to-compose-or-not-to-compose-that-is-the-question-fa616c270b5?source=collection_archive---------8-----------------------#2022-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="80ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Android View系统vs Jetpack Compose — <em class="kf">制作动画时的快速对比</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/2bfb70f8904356150eb5558706bb8411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2YBrsAmXNm4tsXT4xWRxA.jpeg"/></div></div></figure><p id="11cc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">随着Jetpack Compose的另一个稳定版本的发布(woohoo！🎉)回到二月份，我们需要花点时间来欣赏谷歌<a class="lo lp ep" href="https://medium.com/u/be36e94a7e47?source=post_page-----fa616c270b5--------------------------------" rel="noopener" target="_blank">工程团队的巨大努力和决心。他们一直在从全球Android社区获取反馈，并不断为我们改进这个UI工具包。激动人心的时刻！</a></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi lq"><img src="../Images/21de5b57592e3ca325b883374aff63d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5hfAu8MUlBjf21CqE52YJw.png"/></div></div></figure><p id="f39f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我一直关注着Jetpack Compose库的开发，并尝试着使用它，即使我们中的极少数人可能还没有准备好认真对待它。</p><p id="24d0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我👶：</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/9e7f6961bccc5e5a6f113c4dc4dfc08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*IB_h9XWgC-qyVdYc"/></div></figure><p id="73cf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">团队:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ls"><img src="../Images/c6f91c03840ecfa3b6b80b7b427ae8ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A7vqrVIH7Z8iT3mF"/></div></div></figure><p id="46ac" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">关于Compose和它在短短几年内的发展有很多要说的。所以我决定分享一些我的想法，从这篇作为我的第一个技术博客开始(我:没有压力！👼).</p><p id="c0b0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">首先，我想我应该分享一个我的团队提出并讨论的具体用例。我们计划在应用程序中添加一个动画搜索栏，讨论是这样进行的:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi lt"><img src="../Images/c8f74c0f1bda422cbe7c48756855c07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ji1q3ckSuL6qL34P"/></div></div></figure><p id="5833" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">用现有的Android view系统开发它让我担心的是需要在相关的XML文件上重复代码，以使动画工作(解释如下)。当然，一定有更好的方法来做这件事。这引出了这个百万美元的问题:</p><blockquote class="lu"><p id="a94e" class="lv lw iq bd lx ly lz ma mb mc md ln dk translated"><em class="kf">写还是不写？</em></p></blockquote><p id="c2a1" class="pw-post-body-paragraph ks kt iq ku b kv me jr kx ky mf ju la lb mg ld le lf mh lh li lj mi ll lm ln ij bi translated">太戏剧化？为了测试我现在宣布的这个诽谤性的理论，我接下来做了以下事情。类似于我们的应用程序，我决定使用这两种技术创建一个<strong class="ku ir"> <em class="mj"> </em> </strong>动画搜索栏。</p><p id="686a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我创建了两个项目，一个使用Android view系统，另一个使用Jetpack Compose(都可以在GitHub上获得，链接如下)。以下是Android view系统的外观:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mk"><img src="../Images/53a9c91c0d04a4c08ac207efe80a7465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H9uXkPsVL9K-FGX-"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">GitHub:<a class="ae mp" href="https://github.com/Aimannab/SearchApp" rel="noopener ugc nofollow" target="_blank">https://github.com/Aimannab/SearchApp</a></p></figure><p id="3290" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例如，在我的SearchApp项目中，我为返回箭头创建了一个<code class="fe mq mr ms mt b"><strong class="ku ir">ImageButton</strong></code>:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="b55a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">看看我们如何在<code class="fe mq mr ms mt b"><strong class="ku ir">search_header_motion_scene.xml</strong></code>中复制<code class="fe mq mr ms mt b"><strong class="ku ir">search_header_back_arrow</strong></code>两次。我们知道我们将不得不为动画中的其他元素做同样的事情。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="2aed" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">对我来说，这并不理想，也一直困扰着我。当我研究如何在Compose中做同样的事情时，我没有失望！</p><p id="56f7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">那么，我如何在Compose中创建相同的过渡呢？我在<code class="fe mq mr ms mt b">ComposableSearchApp</code>项目中为后退按钮使用了<code class="fe mq mr ms mt b"><a class="ae mp" href="https://developer.android.com/jetpack/compose/animation" rel="noopener ugc nofollow" target="_blank"><strong class="ku ir">AnimatedVisibility</strong></a></code>，如下所示:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="df0f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">其中back button小部件只需创建一次，就可以根据需要多次重用。它看起来是这样的:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="3c3c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">搜索栏的状态也通过使用<code class="fe mq mr ms mt b"><strong class="ku ir">enum</strong></code>值以编程的方式处理，这给了我们更多的灵活性来随意调整动画:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="18e9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">就是这样！🙌</p><p id="7f5f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">那么，我看到了Jetpack Compose的哪些好处呢？</p><p id="4371" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">✅ <strong class="ku ir">更干净的代码</strong>:代码更干净、更短、结构更好。如果我想在SetupBackButton小部件中进行更改，我只需进行一次。与我们过去对XML所做的相反，在XML中，我们必须在创建/设置back按钮的所有地方进行相同的更改(<code class="fe mq mr ms mt b"><strong class="ku ir">main_activity.xml</strong></code>+start transition+end transition)。</p><p id="94cf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">✅ <strong class="ku ir">更快的编译</strong>:使用<code class="fe mq mr ms mt b"><a class="ae mp" href="https://developer.android.com/jetpack/compose/tooling" rel="noopener ugc nofollow" target="_blank"><strong class="ku ir">@Preview</strong></a></code> <a class="ae mp" href="https://developer.android.com/jetpack/compose/tooling" rel="noopener ugc nofollow" target="_blank"> </a>注释到你连接的设备或仿真器，代码执行起来更快。预览作为新活动部署在同一个项目应用程序中，因此它共享相同的上下文和权限，这意味着我们不必编写样板代码，例如，如果已经被授予权限，则需要请求权限。</p><p id="9753" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">✅ <strong class="ku ir">可重用性</strong>:在这里推销自己最大的好处就是可重用性和更快的开发。SetupBackButton小部件可以通过它自己的自定义动画在项目中重复使用任意多次。这意味着，您只需编写/创建一次小部件，并在应用程序的不同位置应用同一动画的不同版本。</p><p id="96c6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">💡<strong class="ku ir">实验</strong>:我唯一要记住的是<code class="fe mq mr ms mt b"><strong class="ku ir">AnimatedVisibility</strong></code>仍处于实验阶段，这意味着它可能会有所变化或被移除。</p><p id="9979" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">💡<strong class="ku ir">互动模式</strong>:我希望将来可以扩展玩动画，虽然我们有一个基本的工具，即<code class="fe mq mr ms mt b"><strong class="ku ir">Start Interactive Mode</strong></code>。这让您可以预览和测试手势，而不必每次都构建整个项目。它有一些限制，比如不能访问网络，不能访问文件，并且一些<code class="fe mq mr ms mt b">Context</code>API可能不完全可用。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/0845d5c3312171196a1037f37b2d8576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*44eH4G5Pd-kmL5cbGR6Lmg.png"/></div></figure><p id="2ed8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi">*******************************************************************</p><p id="d3c6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">更新(2022年5月):</strong></p><p id="a8d2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在Google I/O 2022上发布的Compose 1.2测试版中检验新的<a class="ae mp" href="https://developer.android.com/studio/preview/features#new_in_compose" rel="noopener ugc nofollow" target="_blank">工具支持</a>:</p><blockquote class="mx my mz"><p id="8c28" class="ks kt mj ku b kv kw jr kx ky kz ju la na lc ld le nb lg lh li nc lk ll lm ln ij bi translated"><strong class="ku ir">动画预览</strong>:如果你的动画是在一个可组合的预览中描述的，你现在可以使用<a class="ae mp" href="https://developer.android.com/jetpack/compose/tooling#animations" rel="noopener ugc nofollow" target="_blank">动画预览</a>来一次检查和协调所有的动画。您也可以冻结特定的动画。</p></blockquote><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nd"><img src="../Images/771515b0427e69f02eac17decf072b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2lLVGkmjmkuLetdEW0uARQ.gif"/></div></div></figure><p id="c8b5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi">*******************************************************************</p><p id="277c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">要更深入地了解如何使用Compose编排动画，可以通过下面的链接查看我的项目组件搜索。最后，它看起来是这样的:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mk"><img src="../Images/15e54d7b7b48d01d8acabf6f17ec3b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rcPCdbc5-BIMQW8Kk9_XKA.gif"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">GitHub:<a class="ae mp" href="https://github.com/Aimannab/ComposableSearchApp" rel="noopener ugc nofollow" target="_blank">https://github.com/Aimannab/ComposableSearchApp</a></p></figure><p id="5106" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果你想知道，我想通过添加如下渐变背景，使用Jetpack Compose开发的搜索栏更加突出(原因很明显):</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f91e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">瞧啊。</p><p id="7ea5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">尽量不要有偏见，但Jetpack Compose提供了这么多！这就像我们在生活中获得了第二次机会来纠正我们过去的错误。</p><p id="b438" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，这是一种全新的开发应用程序的方式，你必须学习。随着<a class="lo lp ep" href="https://medium.com/u/e1f26db83092?source=post_page-----fa616c270b5--------------------------------" rel="noopener" target="_blank"> Android开发者</a>社区在这个问题上如此活跃(尤其是在Twitter上)，我相信这是一个非常令人兴奋的使用Android技术的时代！</p><p id="65b5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我最期待的是有一天能够将整个应用无缝迁移到Jetpack Compose！</p></div></div>    
</body>
</html>