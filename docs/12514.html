<html>
<head>
<title>Here’s a Good Way to Do Live-reload in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这里有一个在Go中进行实时重新加载的好方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-good-way-to-do-live-reload-for-go-b3707eb47336?source=collection_archive---------2-----------------------#2022-06-10">https://betterprogramming.pub/a-good-way-to-do-live-reload-for-go-b3707eb47336?source=collection_archive---------2-----------------------#2022-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e01a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">只是你的项目中的“空气”</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5102c2ecca83c557550050b7f9af0b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhj_vJaw1klScdcz0giEIA.png"/></div></div></figure><p id="0bc0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你从Node.js进入Go世界，你可能会错过JavaScript、Angular、React、Vue等的一个重要特性。</p><p id="ecce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它们开发起来都很快，因为当你保存正在处理的文件时，它们会接受你的更改，当你使用express之类的东西时，也会发生同样的事情，有像<code class="fe ln lo lp lq b">nodemon</code>这样的工具可以让这项工作变得简单。</p><p id="0886" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在围棋中，有多种方法可以实现这一点。我要展示其中一个，我认为最好的一个。我还将向您描述如何只使用Go应用程序，或者使用docker-compose文件中的其他依赖项来实现这一点。</p><p id="b203" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种方法适用于go模块。此外，如果你用go get添加新的依赖项，应用程序也将被重新加载。</p><h1 id="ab17" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">目录</h1><p id="1f5b" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">本教程分为以下主题:</p><ul class=""><li id="54b8" class="mo mp iq kt b ku kv kx ky la mq le mr li ms lm mt mu mv mw bi translated">示例go应用程序(带有go模块)</li><li id="c220" class="mo mp iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated">实时重新加载单一应用程序</li><li id="2aeb" class="mo mp iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated">使用多个依赖项实时重新加载(docker-compose)</li></ul><h1 id="5490" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">示例应用程序</h1><p id="bdba" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">这个简单的应用程序由两个文件组成，<code class="fe ln lo lp lq b">main.go</code>和<code class="fe ln lo lp lq b">go.mod</code>，它只是在你每次按回车键时打印一个随机数<code class="fe ln lo lp lq b">uuid</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="e71c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个简单的程序每4秒生成一个新的UUID，并显示在控制台上，简单到不会分散我们对主要目标的注意力:实时重装。</p><h1 id="cf9d" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">实时重新加载—单个应用程序</h1><p id="a255" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">为了让这个应用程序能够实时重载(重新构建并在保存时重新运行)，我们需要安装<code class="fe ln lo lp lq b">Air</code>:</p><pre class="kg kh ki kj gt ne lq nf ng aw nh bi"><span id="5745" class="ni ls iq lq b gy nj nk l nl nm">go install github.com/cosmtrek/air@latest</span></pre><p id="76f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将直接从Air资源库安装它。之后，我们可以通过运行<code class="fe ln lo lp lq b">air -v</code>来测试安装。</p><p id="ba35" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，我们可以转到我们的应用程序目录，并使用以下内容对其进行初始化:</p><pre class="kg kh ki kj gt ne lq nf ng aw nh bi"><span id="41f9" class="ni ls iq lq b gy nj nk l nl nm">air init</span></pre><p id="32af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将创建一个带有默认值的文件<code class="fe ln lo lp lq b">.air.toml</code>。您可以查看并修改应用程序所需内容(构建命令、排除的文件夹等)。</p><p id="2378" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它看起来会像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="5764" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">初始化之后，我们就可以开始使用实时重载了:</p><pre class="kg kh ki kj gt ne lq nf ng aw nh bi"><span id="d3ad" class="ni ls iq lq b gy nj nk l nl nm">air</span></pre><p id="d1db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，如果我们对应用程序进行任何更改，它都会检测、编译并运行它。在这个例子中，我只是测试了改变每一代UUID等待的秒数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/771c8c90ed0207806d1b2ba13b0a58b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YAwIuYgFrgq0tQrFCOAclQ.png"/></div></div></figure><p id="597c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们也可以通过docker容器对其进行归档，无需安装air，只需使用air docker映像运行即可:</p><pre class="kg kh ki kj gt ne lq nf ng aw nh bi"><span id="3c6a" class="ni ls iq lq b gy nj nk l nl nm">docker run -it — rm \<br/>-w "/go/src/github.com/luisegr/go-live-reload-tutorial" \<br/>-v $(pwd):/go/src/github.com/luisegr/go-live-reload-tutorial \<br/>cosmtrek/air</span></pre><p id="626f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将导致相同的输出，并在更改时重新加载:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/f2139b5f34c495f723c80758e6660ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gP9zvdPf-Y5XJ74piaqRFw.png"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated">Air还会向您显示编译错误，并在您修复错误后重新构建应用程序</p></figure><h1 id="cb70" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">实时重新加载—多个依赖项</h1><p id="51bc" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">如果你正在用docker-compose运行你的开发环境，并且你正在使用其他的东西，比如<code class="fe ln lo lp lq b">postgres</code>、mongo、Redis等等。连同你的应用程序，你也可以利用空气为你的生活重新加载。</p><p id="99c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你只需要这样设置你的<code class="fe ln lo lp lq b">docker-compose.yml</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div><p class="np nq gj gh gi nr ns bd b be z dk translated">示例air docker合成，端口仅用于演示目的，不用于此应用程序</p></figure><p id="9b0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，您可以像往常一样运行您的应用程序:</p><pre class="kg kh ki kj gt ne lq nf ng aw nh bi"><span id="7e3c" class="ni ls iq lq b gy nj nk l nl nm">docker-compose up</span></pre><p id="13fb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您将看到输出，如果您仍然有实时重新加载功能:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/8c4f65982b94af288ce47c5c2cb9efd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCCSg1zPZbBBlNN_7XyXaw.png"/></div></div></figure><p id="e48e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望这对您有用，有关所有特性的更多详细信息，您可以查看Air资源库:</p><div class="nu nv gp gr nw nx"><a href="https://github.com/cosmtrek/air" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">github-cosm trek/air:☁️go应用程序的实时重新加载</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">当我开始在Go和gin框架中开发网站时，☁️ Live reload for Go apps，可惜gin…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kp nx"/></div></div></a></div></div></div>    
</body>
</html>