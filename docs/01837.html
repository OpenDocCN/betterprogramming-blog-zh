<html>
<head>
<title>Using UIReturnKeyType or inputAccessoryView in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中使用UIReturnKeyType或inputAccessoryView</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-uireturnkeytype-or-inputaccessoryview-in-swiftui-c140a24cd112?source=collection_archive---------7-----------------------#2019-10-16">https://betterprogramming.pub/using-uireturnkeytype-or-inputaccessoryview-in-swiftui-c140a24cd112?source=collection_archive---------7-----------------------#2019-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c21f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为开发人员融合SwiftUI和UIKit</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/63bc162f8396bd8589c33a84dec14aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQsEqRx5QHTONZ9UZ0YYTA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@maxcodes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Max Nelson </a>在<a class="ae kv" href="https://unsplash.com/s/photos/swift?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="cf29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的，创建和布局视图的概念是很容易的，它接受来自用户的输入(文本)，显示它，并使它可用于“幕后”的视图逻辑。</p><p id="4327" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在SwiftUI中，只需定义:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SwiftUI中文本字段的声明</p></figure><p id="bf6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，还没有API来定义SwiftUI中<code class="fe lu lv lw lx b">UIReturnKeyType</code>的行为或细节。在键盘顶部使用工具栏也是不可能的。</p><p id="9b8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应该解释一个解决方案:向开发人员提供混合SwiftUI和UIKit的可能性，并且在这个场景中是有意义的。</p><p id="aeaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决方案，用散文的<strong class="ky ir"> </strong>来说，就是创建一个新的XIB文件，包含一个<code class="fe lu lv lw lx b">TextField</code> as视图，分别定义它，并用一个自定义的<code class="fe lu lv lw lx b">UIViewController</code>来初始化它。</p><p id="1b6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们完成了UIKit部分，SwiftUI接管了。将创建一个新的SwiftUI文件，它包含一个定制的<code class="fe lu lv lw lx b">UIViewControllerRepresentable</code>，作为通往新世界的桥梁的一边。</p><p id="42db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它初始化并更新前面提到的<code class="fe lu lv lw lx b">UITextField</code>的<code class="fe lu lv lw lx b">UIViewController</code>。</p><p id="9855" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SwiftUI视图层次结构的集成是由SwiftUI视图完成的，它在<code class="fe lu lv lw lx b">body-field-var</code>中声明了我们的自定义<code class="fe lu lv lw lx b">UIViewControllerRepresentable</code>。</p><p id="e437" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已；添加一个SwiftUI预览，或者只是CMD+R(un it)，将会显示一个<code class="fe lu lv lw lx b">UITextField</code>，它已经在SwiftUI中进行了相应的配置。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="14fd" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">直升机视角</h1><p id="131b" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">我们在顶部看到了XIB盒子。这就是我们想要的视角，因为我们的文本字段需求(<code class="fe lu lv lw lx b">UIReturnKeyType</code>或<code class="fe lu lv lw lx b">inputAccessoryView</code>)就是我们开始的地方。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/188ceeab72a114b0c3565ac62321dc7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*YG6IjoCs3G50lkxHeSb89g.png"/></div></figure><p id="37a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">XIB由一个<code class="fe lu lv lw lx b">UIViewController</code>初始化。</p><p id="808c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lu lv lw lx b">UIViewController</code>由<code class="fe lu lv lw lx b">UIViewControllerRepresentable</code>创建。</p><p id="500b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，SwiftUI-view在其主体中声明了<code class="fe lu lv lw lx b">UIViewControllerRepresentable</code>。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="f77d" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">即插即用</h1><p id="ede3" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">下面，我们将讨论具有<code class="fe lu lv lw lx b">UIToolbar</code> ⁴.的<code class="fe lu lv lw lx b">UITextField</code>的实现<code class="fe lu lv lw lx b">UIReturnKeyType</code>可以在XIB(界面构建器)中配置，有点不起眼。</p><p id="0ba7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">文本字段将提供通知新的文本更改的可能性，并且如果键盘被取消，将提供一个回调。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="e4c8" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">代码或它没有发生</h1><p id="47f4" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">从上面的涂鸦可以看出，这个解决方案既不复杂也不费力。实际上是三个文件。</p><p id="e2f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">XIB文件很简单，我们省略了接口构建器，但是讨论了下一个组件:<code class="fe lu lv lw lx b">UIViewController</code>。它提供了两个API，一个文本绑定和一个闭包，在执行键盘工具栏中的<em class="nd"> done </em>按钮时调用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的UITextField的UIViewController</p></figure><p id="c219" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">XIB和<code class="fe lu lv lw lx b">UIViewController</code>就位后，任务基本完成。接下来将创建<code class="fe lu lv lw lx b">UIViewControllerRepresentable</code>和SwiftUI视图:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="8401" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">结论</h1><p id="c35a" class="pw-post-body-paragraph kw kx iq ky b kz mx jr lb lc my ju le lf mz lh li lj na ll lm ln nb lp lq lr ij bi translated">如果理解了UIKit和SwiftUI接口背后的“模式”,为后者中可能的限制提出解决方案就变得很自然了。</p><p id="be5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这让我想起了一般的跨平台开发，例如<a class="ae kv" href="https://dotnet.microsoft.com/apps/xamarin" rel="noopener ugc nofollow" target="_blank"> Xamarin </a> Forms⁵，在那里开发人员有时不得不接触本地API，并且不得不用这些本地实现来存根跨平台视图。</p><p id="047d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有人可能会说，对于iOS原生开发者来说，SwiftUI就像是C#/Xamarin开发者的“表单”部分。它是一组本地API之上的UI抽象；作者们在与开发者的需求竞争，以最终支持新世界中的所有原生API。</p><p id="4350" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终，在未来，当开发人员在没有SwiftUI的情况下编写和实现本机API时，他们可能会感到超出了他们的舒适区。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="f9ab" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">资源</h1><ol class=""><li id="d01d" class="ne nf iq ky b kz mx lc my lf ng lj nh ln ni lr nj nk nl nm bi translated"><a class="ae kv" href="https://developer.apple.com/tutorials/swiftui/interfacing-with-uikit" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/tutorials/swift ui/interfacing-with-ui kit</a></li><li id="8438" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><a class="ae kv" href="https://developer.apple.com/documentation/uikit/uiviewcontroller/1621359-init" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/documentation/ui kit/uiview controller/1621359-init</a></li><li id="a660" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><a class="ae kv" href="https://developer.apple.com/documentation/swiftui/uiviewcontrollerrepresentable" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/documentation/swift ui/uiviewcontrollerrepresentable</a></li><li id="8ac5" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><a class="ae kv" href="https://developer.apple.com/documentation/uikit/uitoolbar" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/documentation/uikit/uitoolbar</a></li><li id="fe17" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated"><a class="ae kv" href="https://dotnet.microsoft.com/apps/xamarin/xamarin-forms" rel="noopener ugc nofollow" target="_blank">https://dotnet.microsoft.com/apps/xamarin/xamarin-forms</a></li></ol></div></div>    
</body>
</html>