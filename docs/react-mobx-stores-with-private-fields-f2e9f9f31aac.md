# 用私有字段反应 MobX 存储

> 原文：<https://betterprogramming.pub/react-mobx-stores-with-private-fields-f2e9f9f31aac>

## 如果您不想显示您商店的所有字段，该怎么办？

![](img/311c37efa0cf41d6f9cd1e8153fe8987.png)

何塞·丰塔诺在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

MobX 存储是观察 React 变化的强大工具。能够对任何字段做出反应并设置任何字段，而无需使用 setter 方法的样板文件，这是轻而易举的事情。

但是，如果您不想暴露您的商店的所有字段，该怎么办呢？只需做一些更改，我们就可以成功隐藏您商店的一些字段。

# 非预期用例

考虑下面的例子(文章底部的 runnable CodeSandbox 示例！):

这个代码代表一个可以递增和递减的计数器。看起来棒极了！但是有一个问题可能会潜入您团队的代码库。如果有人直接访问并更改`count`怎么办？事实上，没有什么可以阻止你做以下事情:

由于商店允许修改所有字段，我们现在允许您的团队直接修改我们计数器的计数，尽管这是我们不允许的用例。

虽然这个例子很简单，但是很容易看出，在某些情况下，您希望隐藏存储的内部结构，只允许通过特定的功能进行访问和操作。

# 分离公共和私人领域

要分隔私有和公共存储字段，请使用以下模式:

在你的`useCounterStore`钩子中，你维护一个拥有你所有私有字段的私有商店和一个实际上从你的`useCounterStore`钩子返回的“面向公众”的商店。公共存储可以自由地访问和操作私有存储的字段，但是由于`count`是公共存储中的一个 getter 函数，您将无法成功地执行`count = 7`等。

现在，您已经成功地为您的商店*设置了一个健壮且易于使用的 API，而*的私有字段不会被意外修改！🎉

# 可运行的 CodeSandbox 示例

以上所有要点都可以作为下面的可运行 CodeSandbox 示例获得。

## 基本计数器存储

## 使用非预期用例的柜台商店

`Set directly`按钮在我们不想让它工作的时候工作。

## 带私有字段的柜台商店

`Set directly`按钮不起作用！