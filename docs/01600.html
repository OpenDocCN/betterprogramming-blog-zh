<html>
<head>
<title>Web Optimization: Increasing FPS by Disabling Hover Effect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网页优化:通过禁用悬停效果增加FPS</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/increase-website-fps-c80a8e4ef8ea?source=collection_archive---------19-----------------------#2019-09-26">https://betterprogramming.pub/increase-website-fps-c80a8e4ef8ea?source=collection_archive---------19-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3de6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当用户滚动时，下层浏览器重新绘制</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5890232ca5c451fa408c1aa792e89fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8u2Y3eLnpniluZex"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">YorKun Cheng 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种优化技术很容易理解和实现。因此，在这篇文章中，我将带你去公园散步，并向你展示另一种可以提高网站性能的方法，希望你从未听说过。</p><p id="07cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下技术很有用，因为它最小化了<a class="ae ky" href="https://medium.com/better-programming/web-performance-dom-reflow-76ac7c4d2d4f" rel="noopener"> DOM reflow/layout </a>和paint事件，从而提高了帧速率。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d72c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">当用户滚动时禁用悬停效果</h1><p id="9eb5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这里的目标是最小化浏览器回流和重绘事件，以提高帧速率。这是通过在用户滚动时从DOM中的所有元素中移除<code class="fe mz na nb nc b">hover</code>效果来实现的。</p><p id="8a7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我在我的下一个观点中详细说明为什么和在哪里这是有用的。假设您的页面上有这个CSS规则:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="5016" class="nh md it nc b gy ni nj l nk nl">.color-me:hover {<br/>  background-color: blue;<br/>}</span></pre><p id="fcae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当用户的光标悬停在它上面时，这个规则将被应用，不可避免地，当滚动页面时。然后，当元素的颜色发生变化时，它会在浏览器中触发一次重画，因此它会在具有类似CSS规则的每个其他元素上进行重画。</p><p id="1b6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Ryan Seddon 的精彩演示很好地解释了性能提升和优势。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6941" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">解药</h1><h2 id="bb78" class="nh md it bd me no np dn mi nq nr dp mm li ns nt mo lm nu nv mq lq nw nx ms ny bi translated">1.滚动事件监听器🖱</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz nn l"/></div></figure><p id="a722" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了提高网站的帧速率，我们会在<code class="fe mz na nb nc b">window</code>全局对象上附加一个<code class="fe mz na nb nc b">scroll</code>监听器。</p><p id="231e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当有一个滚动，我们清除之前的超时，并将<code class="fe mz na nb nc b">disable-hover</code>类添加到body元素，这样它就在整个树中生效了(虽然还没有…)。</p><p id="4858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们设置另一个超时，如果在500毫秒(<code class="fe mz na nb nc b">ENABLE_HOVER_DELAY</code>)内没有调用<code class="fe mz na nb nc b">scroll</code>事件，这个超时将删除<code class="fe mz na nb nc b">disable-hover</code>类。</p><p id="1aad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以尝试不同的<code class="fe mz na nb nc b">ENABLE_HOVER_DELAY</code>常量值，看看哪个最适合您的网站，但我发现500毫秒是最佳值。</p><h2 id="bc1e" class="nh md it bd me no np dn mi nq nr dp mm li ns nt mo lm nu nv mq lq nw nx ms ny bi translated">2.禁用所有指针事件的CSS规则</h2><p id="9f0d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，我们需要为我们的侦听器设置这个CSS规则，以便在滚动时对我们的网站产生实际影响。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1d8c" class="nh md it nc b gy ni nj l nk nl">.disable-hover,<br/>.disable-hover * {<br/>  pointer-events: none !important;<br/>}</span></pre><p id="6c2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述规则将忽略所有HTML元素上的所有指针事件。<br/>一般来说，当滚动<strong class="lb iu"> </strong>时，用户不能执行任何鼠标事件(点击、悬停、拖动),所以请确保您了解这一点的含义。</p><p id="4ac0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保你理解网站用户体验的变化，并且不伤害网站的实际设计或期望的功能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b140" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="ba66" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">就这样。这是一个快速简单的修复方法，你现在可以添加到你的网站上，通过提高滚动时的帧速率来优化速度。希望这对您有所帮助！</p></div></div>    
</body>
</html>