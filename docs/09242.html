<html>
<head>
<title>How To Turn Your Google Form Into a Telegram Bot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何把你的谷歌表单变成一个电报机器人</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-turn-your-google-form-into-a-telegram-bot-108ac382c58a?source=collection_archive---------4-----------------------#2021-08-02">https://betterprogramming.pub/how-to-turn-your-google-form-into-a-telegram-bot-108ac382c58a?source=collection_archive---------4-----------------------#2021-08-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f76a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">制作一个电报机器人，它会提出问题，并在谷歌表单中填写答案</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ea1f77878ab10d3713d08bf259e3209e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*atGn1Cm1Zsr2Q3V1OtTGfQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">就像工业机器人曾经承担日常工作一样，将一些谷歌表单转换成机器人有助于自动提交报告，从而让人类有更多时间来完成创造性任务。由<a class="ae ky" href="https://unsplash.com/@davidleveque?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">大卫·莱维克</a>在<a class="ae ky" href="https://unsplash.com/s/photos/industrial-robot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7f6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">案例是这样的:有一家公司要求其员工每天填写一份谷歌表格。对于必须每天执行的操作，该表单不是最友好的界面，因此大多数员工跳过它，在每个月底多次填写表单，这是不可接受的。所以我是这么做的。</p><p id="5faa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我做了一个电报机器人，每天向所有工人提问，然后把答案填入表格并提交。有些字段是自动填写的，比如提交日期和用户名。</p><h1 id="c394" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">发送HTTP请求</h1><p id="d068" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要自动化的表单看起来像<a class="ae ky" href="https://docs.google.com/forms/d/e/1FAIpQLScTYOs-Z7qggWYZoldE-pA7zWMHqh1svjLhtTVu7b_V4mwNkw/viewform" rel="noopener ugc nofollow" target="_blank">这个</a>。</p><p id="db69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们编写一个脚本，自动提交带有如下信息的表单:10/10雇员1的状态为2，注释为“自动提交”每次提交表单时，web浏览器都会向服务器发送一个HTTP请求。脚本必须发送这样的请求，而不是浏览器。</p><p id="e0dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要弄清楚表单中每个字段的id。为此，右键单击每个字段上的“inspect element ”,并查找如下所示的数字:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/579202b8499a77e8f22d8fa1e3d37b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*ktz0o_7gICjrcAbnkq8X8w.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">记住有两个数字，你需要第二个</p></figure><p id="ea16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以使用下面的代码发送请求了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">form_data字典中的键包含字段的id</p></figure><p id="4ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行脚本后，我们得到:<response>。这意味着请求被成功执行。现在是在请求中插入用户数据的时候了。</response></p><h1 id="6658" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建一个电报机器人</h1><h2 id="b58e" class="mv lw it bd lx mw mx dn mb my mz dp mf li na nb mh lm nc nd mj lq ne nf ml ng bi translated">入职</h2><p id="d519" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，我们需要处理好<code class="fe nh ni nj nk b">/start</code>命令，记住用户。首先，bot解析初始表单并获取所有可能的名称，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这段代码利用了这样一个事实，即表单中的所有名称都有两个单词</p></figure><p id="a6e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">得到名字后，我们向用户发送一条消息，要求他们从列表中选择自己的名字。这些名字会被记住并自动填写。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="54bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数<code class="fe nh ni nj nk b">insert_name()</code>用于在SQLite数据库中添加一行。每行包含一个电报id和一个用户名。当机器人收到一条消息时，它可以很容易地在给出电报id的数据库中查找名字。</p><h2 id="5792" class="mv lw it bd lx mw mx dn mb my mz dp mf li na nb mh lm nc nd mj lq ne nf ml ng bi translated">询问用户</h2><p id="ec8d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了创建ask消息，机器人首先解析表单以获得所有可能的状态，然后创建一个内嵌键盘将其嵌入到消息中，以便用户可以按下与他们今天的状态相对应的按钮。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c40d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在棘手的部分:评论部分是不必要的，所以我们需要问用户是否想添加评论。</p><p id="5f9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在获得响应后，我们首先需要确定是否会有注释，并将状态存储在一个全局字典中，以便能够从另一个函数中访问它，该函数在用户回答第二个问题后被调用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="99e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">insert_report</code>函数看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f6ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来很眼熟，不是吗？它与本文第一部分中的脚本相同，但是它使用用户的答案，而不是硬编码的答案。响应也根据用户是否想要添加评论而变化。</p><p id="b75f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每天，在同一时间，所有注册用户都应该收到这条消息，并有问题要回答。为了调度消息传递，我使用了<code class="fe nh ni nj nk b">aioschedule</code>库，它允许我在Python中异步调度作业。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7e47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">剩下的唯一一件事就是启动bot，我们将使用以下代码来完成:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="dea8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，就这样了！您可以在GitHub资源库中查看全部代码:</p><div class="nl nm gp gr nn no"><a href="https://github.com/Megachell/Google_form_bot" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd iu gy z fp nt fr fs nu fu fw is bi translated">GitHub-mega chell/Google _ form _ Bot:Bot自动定期提交Google表单。</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">机器人自动定期提交谷歌表格。-GitHub-mega chell/Google _ form _ Bot:Bot自动化期刊…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ks no"/></div></div></a></div></div></div>    
</body>
</html>