<html>
<head>
<title>Unicode and Character Sets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Unicode和字符集</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/unicode-and-character-sets-46ce89841b3?source=collection_archive---------14-----------------------#2020-10-27">https://betterprogramming.pub/unicode-and-character-sets-46ce89841b3?source=collection_archive---------14-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2d97" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Unicode系统、UTF、ASCII和编码的简要概述</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4a283857b2d64f314478eac6e490523c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4c2WvYK2A8W0B1wCdXeN3Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@kelvinyan" rel="noopener ugc nofollow" target="_blank"> Kelvin Yan </a>在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="ebd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">电脑有自己的语言。他们不懂人类语言(也许你说二进制他们就懂)，除了二进制他们什么都不懂。我们如何与他们交流？</p><p id="223f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我现在打字时，电脑不知道你看到的任何字符。我们来考虑一下<em class="ls"> M </em>这个人物。在最低层，<em class="ls"> M </em>使用0和1的序列存储:<code class="fe lt lu lv lw b">01001101</code>。在我们继续之前，让我们回忆一下两个基本定义:</p><p id="7961" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">位</strong> —最小的存储单位，只能存储0或1个<br/>字节<strong class="ky ir">字节</strong> —一个字节= 8位。就是这样。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="ae23" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">统一码</h1><p id="f7b3" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated"><a class="ae kv" href="http://unicode.org/standard/standard.html" rel="noopener ugc nofollow" target="_blank">Unicode标准</a>:</p><blockquote class="nb nc nd"><p id="acd9" class="kw kx ls ky b kz la jr lb lc ld ju le ne lg lh li nf lk ll lm ng lo lp lq lr ij bi translated">Unicode标准是一种字符编码系统，旨在支持世界范围内不同语言和现代技术领域的书面文本的交换、处理和显示。此外，它支持许多书面语言的经典和历史文本。</p></blockquote><p id="392c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，<strong class="ky ir"> Unicode给每个字符分配一个唯一的编号</strong>(称为代码点)，而不管平台、程序或其他什么。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="af35" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">字符集</h1><p id="4050" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">字符集是符号的固定集合。例如，أ到ي是代表阿拉伯字母的字符集。</p><p id="6f45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个例子是著名的ASCII表:一个七位字符代码，其中每个序列代表一个独特的字符。ASCII可以表示27 (= 128)个字符(包括不可打印的)，但可悲的是，它不能表示爱💔 😔、希伯来语、俄语、阿拉伯语字母以及更多有用的字符。但是为什么呢？</p><p id="6786" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为任何文件都必须经过编码/解码才能正确存储，所以您的计算机需要知道如何将您的语言书写系统的字符集转换为0和1的序列。这个过程叫做<em class="ls">字符编码。</em>你可以把它想象成一张桌子。为了让你对“表格”的含义有一个直观的认识，请看下图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/3996a0a8804c395c1e12948ee58a9522.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*bpgKHklDy9B-Mp3ldSNcJQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ASCII表</p></figure><p id="bde1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">一个</em>字符由65位十进制值表示(在7位二进制中是1000001)。所以现在的问题是，我们如何表示超出这个范围的字符？</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="a244" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">编码系统</h1><p id="d219" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">区分<em class="ls">字符集</em>和<em class="ls">编码系统</em>概念非常重要。第一个是您可以使用的一组字符，而后者是这些字符在内存中的存储方式(作为字节流)，因此对于一个给定的字符集可以有多种编码。</p><p id="0bbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就像ASCII方案一样，还有许多其他编码系统:</p><ul class=""><li id="3de4" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated"><strong class="ky ir"> UTF-8 </strong></li><li id="796b" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><strong class="ky ir"> UTF-16 </strong></li><li id="4769" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><strong class="ky ir"> UTF-32 </strong></li><li id="4281" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><strong class="ky ir"> EUC </strong></li></ul><p id="3847" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将讨论<strong class="ky ir"> UTF-X </strong>系统。</p><h2 id="70aa" class="nw mf iq bd mg nx ny dn mk nz oa dp mo lf ob oc mq lj od oe ms ln of og mu oh bi translated">UTF-32</h2><p id="c2f0" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">这个方案需要<strong class="ky ir"> 32位</strong>(四个字节)来编码任何字符。例如，为了用这个方案来表示<em class="ls">一个</em>字符码位，我们需要用32位二进制数写65:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="2af8" class="nw mf iq lw b gy om on l oo op">00000000 00000000 00000000 01000001</span></pre><p id="56d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果仔细观察，您会注意到在使用ASCII模式时，最右边的七位实际上是相同的。但是由于UTF-32是固定宽度的方案，我们必须附加三个额外的字节。也就是说，如果我们有两个只包含<em class="ls">和</em>字符的文件，一个是ASCII编码的，另一个是UTF-32编码的，它们的大小相应地是一个字节和四个字节。</p><p id="7e93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个方案对说英语的人来说并不好，因为现在只包含ASCII字符的文件，比如总大小为X字节的文件，将变成4倍字节的怪物，这是对内存的巨大浪费。</p><h2 id="dbc5" class="nw mf iq bd mg nx ny dn mk nz oa dp mo lf ob oc mq lj od oe ms ln of og mu oh bi translated">UTF-16 (+ LE &amp; BE)</h2><p id="8b6f" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">另一个UTF-16形式的解决方案出现了。您可能会认为，正如UTF-32使用固定宽度的32位来表示码位一样，UTF-16也是固定宽度的16位。不对！</p><p id="6eba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在UTF-16中，码位可以用<strong class="ky ir"> 16位</strong>或<strong class="ky ir"> 32位</strong>来表示。所以这个方案是一个<em class="ls">变长</em>编码系统。比UTF-32有什么优势？至少对于ASCII来说，文件的大小不会是原来的四倍(但仍然是两倍)，所以我们仍然不是ASCII向后兼容的。</p><p id="9e98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于七位足以表示一个字符，我们现在可以使用两个字节，而不是像UTF-32那样使用四个字节。</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="e147" class="nw mf iq lw b gy om on l oo op">00000000 01000001</span></pre><p id="f0ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你们中的一些人可能想知道为什么我们把字节附加在开头而不是结尾。既然我们知道需要两个字节，为什么我们不能翻转表示法，从右向左解释结果:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="eaa7" class="nw mf iq lw b gy om on l oo op">01000001 00000000</span></pre><p id="9330" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以。一些公司实际上使用这种编码。当计算机试图读取16位时，让我们试着模仿它。下面是一个简单的C程序，它按顺序分配八个整数:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="9dc5" class="nw mf iq lw b gy om on l oo op">int *p;<br/>p = (int *) malloc(8 * sizeof(int));</span></pre><p id="742d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">操作系统将返回第一个字节的地址。所以<code class="fe lt lu lv lw b">p</code>将指向第一个位置，通过递增它，我们将得到下一个字节。假设我们以这种形式存储数据(下面的两个框代表两个字节):</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="50aa" class="nw mf iq lw b gy om on l oo op">+---+---+<br/>| 0 | A |<br/>+---+---+</span></pre><p id="0b8b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，在开始读取之前，我们必须将指针向右移动，而如果我们有以下内容，它将立即被读取:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="3f99" class="nw mf iq lw b gy om on l oo op">+---+---+<br/>| A | 0 |<br/>+---+---+</span></pre><p id="2d74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二种格式叫做<em class="ls">大端</em> (BE)(数据存储在最高有效字节)，而后者叫做<em class="ls">小端</em> (LE)(最低有效字节)。</p><h2 id="d350" class="nw mf iq bd mg nx ny dn mk nz oa dp mo lf ob oc mq lj od oe ms ln of og mu oh bi translated">UTF-8</h2><p id="f4ea" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">你猜对了:在UTF-8中，码位可以用<strong class="ky ir"> 32 </strong>、<strong class="ky ir"> 16 </strong>、<strong class="ky ir"> 24、</strong>或<strong class="ky ir">八位</strong>来表示，和UTF-16系统一样，这也是一种变长编码系统。</p><p id="7c4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们可以用与使用ASCII编码系统相同的方式来表示<em class="ls"> A </em>:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="271d" class="nw mf iq lw b gy om on l oo op">01001101</span></pre></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="0561" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">操场</h1><p id="62ec" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">打开您最喜欢的文本编辑器(Vim)并创建一个包含<em class="ls"> A </em>字符的文件。让我们看看它的编码:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="fd7d" class="nw mf iq lw b gy om on l oo op">$ xxd -b test.txt<br/>0000000: 0100001 00001010</span></pre><p id="877e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个<code class="fe lt lu lv lw b">0000000</code>对于我们的分析并不重要；它表示偏移量。其后的字节是ASCII编码中<em class="ls"> A </em>字符的二进制表示(七位)。最后，最后一位是换行符的ASCII编码(通过检查ASCII表进行验证——寻找这个数字的十进制值)。现在让我们检查文件大小:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="8687" class="nw mf iq lw b gy om on l oo op">$ du -b test.txt | cut -f1<br/>2</span></pre><p id="fe9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！预期的两个字节(不要忘记自动添加的换行)。让我们继续玩——现在我们移除<em class="ls"> A </em>并插入δ字符:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="d328" class="nw mf iq lw b gy om on l oo op">$ file test.txt<br/>test.txt: UTF-8 Unicode text</span></pre><p id="7e4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在尺寸变了:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="4771" class="nw mf iq lw b gy om on l oo op">$ du -b test.txt | cut -f1<br/>3</span></pre><p id="eb24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么是<code class="fe lt lu lv lw b">3</code>？让我们看看文件的二进制转储:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="f978" class="nw mf iq lw b gy om on l oo op">$ xxd -b test.txt<br/>0000000: 11001110 10110100 00001010</span></pre><p id="8b5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们忽略代表换行符的最后一个字节，把注意力集中在δ字符的实际编码上:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="d50f" class="nw mf iq lw b gy om on l oo op">11001110 10110100</span></pre><p id="8329" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们回想一下，如果前三位是110，那么字符用两个字节编码。δ的二进制表示为:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="ae52" class="nw mf iq lw b gy om on l oo op">11001110 10110100</span></pre><p id="d2e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这正是我们得到的。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="9318" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">UTF-8对UTF-16</h1><p id="f2c3" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">UTF-8和UTF-16都是可变长度编码。UTF-8编码可能最少占用8位，而UTF-16编码最少需要16位。</p><p id="1b3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于基本的ASCII字符，UTF-8将每个字符仅使用一个字节，而UTF-16编码将使用两个字节(这使得UTF-8向后兼容ASCII)。</p><p id="be57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">Now let’s talk about cases where UTF-8 encoding takes more bytes than UTF-16. Consider the Chinese letter “語” — its UTF-8 encoding is:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="41a9" class="nw mf iq lw b gy om on l oo op">11101000 10101010 10011110</span></pre><p id="9f6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">而它的UTF-16编码更短:</p><pre class="kg kh ki kj gt oi lw oj ok aw ol bi"><span id="81c6" class="nw mf iq lw b gy om on l oo op">10001010 10011110</span></pre><p id="a86e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你觉得有用。</p></div></div>    
</body>
</html>