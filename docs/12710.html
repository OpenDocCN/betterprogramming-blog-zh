<html>
<head>
<title>Extending Apple’s WWDC 2017 Demo App With SceneKit and SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用SceneKit和SwiftUI扩展苹果的WWDC 2017演示应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/extending-apples-wwdc-2017-demo-app-with-scenekit-and-swiftui-e90168c07f25?source=collection_archive---------6-----------------------#2022-06-24">https://betterprogramming.pub/extending-apples-wwdc-2017-demo-app-with-scenekit-and-swiftui-e90168c07f25?source=collection_archive---------6-----------------------#2022-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9d53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">更新苹果SceneKit演示的第二次尝试</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/084014b32aaebf972929798a454e03c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*biTgZjZxxX0eDyuJFJFwCg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">WWDC 2017演示所基于的foxy2角色的快照</p></figure><p id="0769" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上周我发表了一篇关于使用SwiftUI重建苹果WWDC 2017 SceneKit演示的文章。你可以在这里找到<a class="ae lq" rel="noopener ugc nofollow" target="_blank" href="/rebuilding-apples-wwdc-2017-demo-app-with-scenekit-and-swiftui-77374c230e28">的论文</a>。</p><p id="eae4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在那篇文章中，我使用SwiftUI重新构建了游戏的控件，这是一个半成功的重建，但我犯了一个致命的错误。我将<code class="fe lr ls lt lu b">SCNSceneRendererDelegate</code>代码拆分成它自己的类。第二天我意识到了我的方法的错误，并且仍然希望它与主代码分开，我把它移到了它的扩展中。这就是答案。</p><blockquote class="lv lw lx"><p id="e734" class="ku kv ly kw b kx ky ju kz la lb jx lc lz le lf lg ma li lj lk mb lm ln lo lp im bi translated">注意代码不会在模拟器上运行。你需要使用一个真实的设备，最好是iPad。</p></blockquote><p id="8792" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">整个演示在很大程度上与苹果在WWDC2017上展示时一样，尽管我跳过了SpriteKit代码。此外，它现在使用基于SwiftUI的控件。今天和我一起完成更多更新和一些升级。</p><h2 id="508d" class="mc md it bd me mf mg dn mh mi mj dp mk ld ml mm mn lh mo mp mq ll mr ms mt mu bi translated">这个计划</h2><p id="d101" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">随着我的深入挖掘，我发现foxy2最初被称为小熊猫，至少这是该模型的名字——嗯，他们在2015年也用小熊猫做了一个很棒的演示。我计划借用一个敌人和你需要从所说的演示中收集魔法珍珠的想法。<br/>我还想修复我在foxy2中得到的一些警告——并把我使用的委托模式从组合中去掉，因为我怀疑我不需要它。</p><h2 id="507f" class="mc md it bd me mf mg dn mh mi mj dp mk ld ml mm mn lh mo mp mq ll mr ms mt mu bi translated">愿望清单</h2><p id="1723" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">邦。这里有一个更明确的列表，请记住，如果可能的话，我不想重新发明轮子。如果你对我还能做什么有任何想法，请在最后的评论中添加。</p><ul class=""><li id="33e4" class="na nb it kw b kx ky la lb ld nc lh nd ll ne lp nf ng nh ni bi translated">我希望有更多的敌人守卫监狱。我将使用现有的模型和foxy1演示中使用的模型。</li><li id="071d" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">我也想加入狐狸1的魔法珍珠，收集珍珠会给你更多的生命力。</li><li id="c617" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">我想加一个生命指标；此刻，你可以在熔岩地里奔跑而不会有任何后果；我想要一个指标，这样做太多会导致你无法完成游戏，一个生命的力量。</li><li id="c2aa" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">同样的，我想要一个生命指示器被敌人影响，所以他们靠得太近，你会失去生命力。</li><li id="931e" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">我需要一个游戏结束的信息，当你释放你的同事并用尽心脏时触发。</li><li id="6d5c" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">我想引入一个计时器，这样你做工作越快，你得到的分数就越好。</li><li id="c2a5" class="na nb it kw b kx nj la nk ld nl lh nm ll nn lp nf ng nh ni bi translated">谈话，分数，一个独立的最佳成绩显示会很好！我将使用SwiftUI来管理一个演示，因为我确信它将比<code class="fe lr ls lt lu b">GamePlayKit</code>框架更容易。</li></ul><h2 id="35a9" class="mc md it bd me mf mg dn mh mi mj dp mk ld ml mm mn lh mo mp mq ll mr ms mt mu bi translated">新的敌人和珍珠</h2><p id="a4ef" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">我首先介绍一些新的敌人，他们使用现有的模型来建立第三个敌人。经过一些尝试和错误，我设法这样做了，正如你在这个截图中看到的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/4739767d4e1596b0e234db58e59f6b08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwY4O7XEPec-SgepNtSUkQ.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">背景中多了一个敌人的快照，以前是两个，现在是三个</p></figure><p id="8f1a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它工作得相当好，但事实上，如果狐狸越来越近，两个敌人合并。因为我对第三个敌人的行为使用了和第二个一样的游戏组件，如果你杀死他们中的任何一个，他们都会爆炸。这两种行为都需要纠正。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="3303" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了避免这种行为/结果，我通过复制第一个组件创建了第二个追逐组件。一个解决我的问题的方法是，如果我攻击其中一个，两个敌人都会被消灭。<br/>然而——由于代码仍然是相同的，如果我逗留太久，两个敌人最终会相互重叠。<br/>我想我会试着和追逐者一起使用逃跑行为，但是把它做好开始看起来像第三个项目，所以我求助于改变第三个敌人的追逐变量，这在很大程度上解决了这个问题。</p><h2 id="c1b2" class="mc md it bd me mf mg dn mh mi mj dp mk ld ml mm mn lh mo mp mq ll mr ms mt mu bi translated">Foxy1资源</h2><p id="92ae" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">我下载了foxy1演示代码，修复了几个简单的胜利，并运行了它——它看起来也不错。然后我检查了资源，借了敌人和珍珠。我复制了*。scn文件和纹理，使用Xcode编辑器重新匹配这两个文件。</p><p id="ac9d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我用这段代码添加了新的资源。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="fb08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并将这段代码添加到<code class="fe lr ls lt lu b">GameController</code>中的collect方法中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="1adf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好了，说够了，也许是预演的时候了。这是一段前所未见的2017年WWDC风景展视频。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nu l"/></div></figure><p id="1aef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在视频中，我从捡起一颗珍珠开始。我在比赛开始时向左向右，然后爬下到场地。摄像机处于调试模式，这就是为什么它不跟着我。在竞技场中，旋转燃烧的状态是我从WWDC 2015展示中得到的第二个元素。除此之外，我穿过熔岩，释放了三只狐狸。</p><h2 id="f2a1" class="mc md it bd me mf mg dn mh mi mj dp mk ld ml mm mn lh mo mp mq ll mr ms mt mu bi translated">SwiftUI HUD变化</h2><p id="8c02" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">当然，SF符号提供了我需要的生命力的完美形象，我决定用这个代码给玩家16一个心脏。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="2182" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将通过一个简单的布尔值数组来管理图像，真值是一颗红心，假值是一颗失落的心的灰色轮廓。</p><p id="218e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我设置了一个基于Combine框架的订阅，使用一个简单的<code class="fe lr ls lt lu b">PassthroughSubject</code>来管理它们，当你收集到一颗珍珠时，它会发送“true ”,当你跑过熔岩或没有与守卫战斗时，它会发送false。价值观给你或多或少的心。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="f644" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我对dpad也不满意，你可以从第一个视频中看到。我正在努力工作，将按钮移动到顶部边缘-我尝试了几个想法，但最终确定了向前跳转按钮，而不是简单的垂直跳转。我也把攻击/旋转放在同一个按钮下。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6e2b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的下一个愿望是一个计时器；这很容易用SwiftUI中的一个简单定时器实现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8437" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">看起来不错；当然，它有一些微调要做，但现在就去是好的。这是一个展示最终构建的视频。当然，在你的愿望清单上还是有一些事情，也许在你的愿望清单上也有一些。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nu l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">最终视频</p></figure><p id="52e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在视频里，你看到我捡起四颗珍珠，杀死两个机器人，把我的三个同事从监狱里救出来；在经历了太多的岩浆跳跃后失去了一两颗心脏。</p><h1 id="0388" class="nw md it bd me nx ny nz mh oa ob oc mk jz od ka mn kc oe kd mq kf of kg mt og bi translated">结论</h1><p id="d7e7" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">不幸的是，代码中有一个声音问题；据我所知，它看起来是正确的？但是不管用。除此之外，它看起来很好；我希望你同意。</p><p id="4644" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将以此结束这篇论文。如果你认为我应该回到foxy1，用foxy2的资源更新它，并把它变成一个简单的游戏，请在评论中告诉我。</p><p id="424c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同时，在这里下载本文的完整代码。</p></div></div>    
</body>
</html>