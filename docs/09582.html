<html>
<head>
<title>Transforming Views in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中转换视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/transforming-views-in-swiftui-2cbb4e7b8b13?source=collection_archive---------11-----------------------#2021-09-13">https://betterprogramming.pub/transforming-views-in-swiftui-2cbb4e7b8b13?source=collection_archive---------11-----------------------#2021-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fd34" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在SwiftUI中使用线性代数的强大功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/725e588529ef5beb79264a7c096acb53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbZ4d3IzTmi46SzfihlJqw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@chrislawton?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克里斯·劳顿</a>在<a class="ae ky" href="https://unsplash.com/s/photos/transformations?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ea47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我必须承认，在我攻读计算机科学学位的第二年，我可以选修计算机图形学的课程。</p><p id="644d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那是1988年，因为我在计算机科学数学课的第一年成绩不好。当时这是一个很容易的决定，我选择了不同的选择。</p><p id="4607" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几十年后，我仍然被CS数学所困扰，所以也许是时候咬紧牙关做点什么了。加入我的旅程，尝试了解核心动画<code class="fe lv lw lx ly b">CATransform3DIdentity</code>如何工作，以及如何与SwiftUI一起使用。</p><p id="d46d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它从一个4x4矩阵开始，该矩阵具有一组“标准”值，代表您要在坐标空间内变换的对象。默认的坐标是这样的，所以没有变换。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="38cf" class="md me it ly b gy mf mg l mh mi">[ 1 0 0 0 ]<br/>[ 0 1 0 0 ]<br/>[ 0 0 1 0 ]<br/>[ 0 0 0 1 ]</span></pre><p id="39f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用一组预定义的名称来引用每个单元格，所以又是另一个矩阵。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="773c" class="md me it ly b gy mf mg l mh mi">[ m11, m12, m13, m14 ]<br/>[ m21, m22, m23, m24 ]<br/>[ m31, m32, m33, m34 ]<br/>[ m41, m42, m43, m44 ]</span></pre><p id="966e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在按照惯例，或者更准确地说是线性代数，改变不同框中的值决定了将要应用的变换。在矩阵中，你可以描述剪切、挤压、缩放或旋转，甚至是反射。它的效果取决于您在不同框中放置的值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/6fb39ff9bd725b5250cac533d05ac8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*PE_xeEavt2ChbsycBFwbLg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">快照取自CATransform3DTranslate网页</p></figure><p id="d5ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令人欣慰的是，将这些编写成代码要容易一些。如果你想引用矩阵的不同部分的名字，你可以这样做，尽管你不需要这样做。使用CA框架，您可以走一条更容易的路，使用方便的方法为您预加载它们。如果你想知道，这个页面来自<a class="ae ky" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/CoreAnimationBasics/CoreAnimationBasics.html#//apple_ref/doc/uid/TP40004514-CH2-SW3" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="b1f2" class="md me it bd mr ms mt dn mu mv mw dp mx li my mz na lm nb nc nd lq ne nf ng nh bi translated">案情摘要</h2><p id="ff3d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">但是等等——在我们进一步讨论之前，让我们先来区别一下SwiftUI代码。我想要一个上面有一个<code class="fe lv lw lx ly b">SFSymbol</code>的简单视图。这是一个符号，我想在按下按钮时显示或隐藏，这是我的代码。当我隐藏或显示它时，我想对形状做一些变换。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="64df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第13行是这段代码的关键代码，这个转换引用了一个我称为<code class="fe lv lw lx ly b">trans3</code>的翻译。现在，这段代码引用了一个<code class="fe lv lw lx ly b">AnyTransition</code>扩展，它定义了一个将扭曲和旋转我的视图的<code class="fe lv lw lx ly b">viewModifier</code>。它的代码看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d3fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它工作得很好，看起来也不错——我相信你会同意——并且确实想知道为什么我在核心动画中提到那些可怕的矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/678b35af43b5f9baaf8e81f7aea99119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ZjjHri0j_Z2ET_bpN1oxHA.gif"/></div></div></figure><p id="bd10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回答你的问题，这是因为这个动画，尽管它很好——是一个正在<em class="nq">平行</em>进行的转变。所以它同时在旋转和扭曲。</p><p id="10e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的客户需要视图在<em class="nq">系列</em>中进行变换，那么他们可能希望动画中途改变方向。要做到这一点，我们需要走一条不同的路——我们需要在SwiftUI框架内使用核心动画。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="d499" class="md me it bd mr ms mt dn mu mv mw dp mx li my mz na lm nb nc nd lq ne nf ng nh bi translated">核心动画</h2><p id="401c" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">回到数学和一些不同的方法。现在，核心动画使用我已经提到的矩阵和这些传统的方法。</p><ul class=""><li id="1251" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><code class="fe lv lw lx ly b">CATransform3DTranslate</code></li><li id="698d" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe lv lw lx ly b">CATransform3DRotate</code></li><li id="ab3e" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><code class="fe lv lw lx ly b">CATransform3DScale</code></li></ul><p id="59b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们将在我在本文开头概述的矩阵中预加载值。你还需要一个叫做<code class="fe lv lw lx ly b">CGAffineTransform</code>的方法。我们的目标是这样做:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/eda44bd3e1660614732334022815e905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6AIsHA3qq5wdwVBo1_WEFg.gif"/></div></div></figure><p id="dbb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看可能和其他动画一样，但事实并非如此。这一次，树叶不仅没有消失，而且在动画中途改变了方向。代码是什么样子的？</p><p id="110d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI代码或多或少是相同的，正如它在其中引用的<code class="fe lv lw lx ly b">AnyTransition</code>一样，但是由<code class="fe lv lw lx ly b">AnyTransition</code>模板代码调用的动画完全不同。该代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5a6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">动画运行时，pct变量表示动画完成的百分比，因此0表示无，1表示完成。我们用这个值来计算转弯的角度。巧妙的事情发生在<code class="fe lv lw lx ly b">CATransform3DIdentity</code>、<code class="fe lv lw lx ly b">CATransform3DTranslate</code>、<code class="fe lv lw lx ly b">CATransform3DRotate</code>和<code class="fe lv lw lx ly b">CGAffineTransform</code>调用中。</p><p id="d55e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们使用pct值来选择返回哪个<code class="fe lv lw lx ly b">CGAffineTransform</code>，这就是为什么动画中途改变方向。请注意，我将它配置为360度，但由于我中途更改了动画，所以它只能单向移动180度。</p><p id="c1ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还要注意，在我旋转之前，我使用<code class="fe lv lw lx ly b">CATransform3DTranslate</code>来移动<code class="fe lv lw lx ly b">SFSymbol</code>以确保它在中心旋转。我把符号的尺寸定为64磅，因此来回翻译了32磅。</p><p id="ca1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，我强烈怀疑这里面隐藏着更多的数学知识，如果你开始尝试并创造自己的组合，你会发现这是可行的组合。</p><p id="e5c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，这个技巧是两个动画，它们的路径会在某个点交叉。一个你可以轻松切换它们的点。这是SwiftUI的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="5e18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总而言之，这就把我们带到了这篇文章的结尾。感谢阅读。</p></div></div>    
</body>
</html>