<html>
<head>
<title>Useful JavaScript Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有用的JavaScript函数</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/javascript-useful-functions-2d9d3a9b603f?source=collection_archive---------10-----------------------#2020-04-12">https://betterprogramming.pub/javascript-useful-functions-2d9d3a9b603f?source=collection_archive---------10-----------------------#2020-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4fb8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">统一事件、去抖动和检测移动浏览器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a27e4431d9e7acb0f6b5ee67fa2402a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvaNuuGMVDesVbjYY_fdoQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sammoqadam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Sam Moqadam </a>在<a class="ae ky" href="https://unsplash.com/s/photos/free?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="e112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我每天分享<a class="ae ky" href="https://medium.com/@david.dalbusco/one-trick-a-day-d-34-469a0336a07e" rel="noopener">一招</a>直到原定的瑞士新冠肺炎隔离期结束的日期，2020年4月19日。离第一个里程碑还有七天。希望更好的日子就在前面。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="190a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>的多个应用程序和web组件中使用了几个JavaScript函数。</p><p id="3141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许这些对你的项目也有用？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="be64" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">统一鼠标和触摸事件</h1><p id="947b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果你通过鼠标或触摸设备来实现与用户交互有关的功能，那么它们的结果很有可能是相同的。</p><p id="a070" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，演示者可以使用我们的遥控器绘制演示文稿。为此，我们使用<code class="fe mz na nb nc b">canvas</code>并附加如下事件:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2e7d" class="nh md it nc b gy ni nj l nk nl">const canvas = document.querySelector('canvas');<br/><br/>canvas.addEventListener('mousedown', this.startEvent);<br/>canvas.addEventListener('touchstart', this.startEvent);</span></pre><p id="c5e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能注意到了，<code class="fe mz na nb nc b">mouse</code>和<code class="fe mz na nb nc b">touch</code>事件由相同的函数处理，这很好。但是，不幸的是，如果你想访问职位信息，例如，<code class="fe mz na nb nc b">clientX</code>或<code class="fe mz na nb nc b">clientY</code>，没有一点逻辑，他们就不能算出来。</p><p id="fd68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">的确，<code class="fe mz na nb nc b">touch</code>定位在对象的根处不可用，而是在数组<code class="fe mz na nb nc b">changedTouches</code>中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b0b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为什么我们使用一个名为<code class="fe mz na nb nc b">unifyEvents</code>的函数来获得定位，而不考虑设备。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="3ddc" class="nh md it nc b gy ni nj l nk nl">export function unifyEvent($event) {<br/>  return $event.changedTouches ? $event.changedTouches[0] : $event;<br/>}</span></pre><p id="8b05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以按如下方式使用:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="104d" class="nh md it nc b gy ni nj l nk nl">function startEvent($event) {<br/>  // TouchEvent and MouseEvent unified<br/>  console.log(unifyEvent($event).clientX);<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f88f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">去抖动</h1><p id="039e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我在<a class="ae ky" href="https://medium.com/better-programming/debounce-with-vanilla-javascript-or-rxjs-70f29c58ca80" rel="noopener">之前的文章</a>中讨论过这个主题<em class="no">用JavaScript </em>去抖动，但是如果你想在没有任何依赖的情况下给你的应用添加这样一个特性，这里有一个函数可以做到。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="229e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用户代理人</h1><p id="49f4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">今年早些时候，谷歌宣布决定在其Chrome浏览器中取消对用户代理字符串的支持。</p><p id="1dd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，应该明智地使用下面的方法，要知道它们将来会被取代。也就是说，这里有几个方便的函数可以帮助检测关于浏览器或设备类型的信息。</p><h2 id="dd81" class="nh md it bd me np nq dn mi nr ns dp mm li nt nu mo lm nv nw mq lq nx ny ms nz bi translated">isMobile</h2><p id="e685" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="http://detectmobilebrowsers.com" rel="noopener ugc nofollow" target="_blank">检测移动浏览器</a>提供了一个开源的移动设备列表，可用于测试我们的导航器，以检测用户是否正在移动设备上浏览或使用应用程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="ac1c" class="nh md it bd me np nq dn mi nr ns dp mm li nt nu mo lm nv nw mq lq nx ny ms nz bi translated">isIOS</h2><p id="97c2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了检测我们的用户是否正在使用苹果移动设备，我们可以根据关键字<code class="fe mz na nb nc b">iPad|iPhone|iPod</code>测试导航器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="a319" class="nh md it bd me np nq dn mi nr ns dp mm li nt nu mo lm nv nw mq lq nx ny ms nz bi translated">isIPad</h2><p id="c1a6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">同样，我们可以将查询减少到<code class="fe mz na nb nc b">iPad</code>来猜测用户是否在iPad上。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="083b" class="nh md it bd me np nq dn mi nr ns dp mm li nt nu mo lm nv nw mq lq nx ny ms nz bi translated">isFirefox</h2><p id="9790" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">同样，您可以检测客户端是否正在使用特定的浏览器。比如火狐。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a1d7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">全屏</h1><p id="508f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们的演示文稿可以在独立模式或全屏模式下编辑和浏览，这就是为什么我们必须检测这样的状态。</p><p id="f94b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将<code class="fe mz na nb nc b">window.innerHeight</code>与<code class="fe mz na nb nc b">screen.height</code>进行比较，如果两者相等，则浏览器处于全屏模式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7b73" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从HTML字符串中删除属性</h1><p id="eae8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">假设您的DOM包含一个元素，您希望借助JavaScript将其解析为一个<code class="fe mz na nb nc b">string</code>。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1b95" class="nh md it nc b gy ni nj l nk nl">&lt;div contentEditable="true" style="color: #ff0000"&gt;Red&lt;/div&gt;</span><span id="c112" class="nh md it nc b gy oa nj l nk nl">const div = document.querySelector('div').outerHTML;</span></pre><p id="84c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于某种原因，您可能无法接触或克隆DOM元素，但无论如何会对从<code class="fe mz na nb nc b">string</code>值中移除一个属性感兴趣。</p><p id="5184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分别，你会对这样一个结果感兴趣:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="36aa" class="nh md it nc b gy ni nj l nk nl">&lt;div style="color: #ff0000"&gt;Red&lt;/div&gt;</span></pre><p id="ce50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要清除或删除字符串中的属性，可以使用以下方便的RegExp:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1756" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，它搜索所有可能的属性并创建一个新的包含选择前后内容的<code class="fe mz na nb nc b">string</code>。</p><p id="e540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最喜欢的技巧是。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b029" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><p id="8b9d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">DeckDeckGo是开源的，你可以在我们的<a class="ae ky" href="https://github.com/deckgo/deckdeckgo/tree/master/utils" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>或者他们相关的<a class="ae ky" href="https://www.npmjs.com/search?q=%40deckdeckgo" rel="noopener ugc nofollow" target="_blank"> npm包</a>中找到上面的函数。</p><p id="e2d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，</p><p id="ffc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大卫</p></div></div>    
</body>
</html>