<html>
<head>
<title>7 Ways to Link SwiftUI Views to SpriteKit Scene</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将SwiftUI视图链接到SpriteKit场景的7种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/7-ways-to-link-swiftui-views-to-spritekit-scene-58180a57ab58?source=collection_archive---------10-----------------------#2021-08-03">https://betterprogramming.pub/7-ways-to-link-swiftui-views-to-spritekit-scene-58180a57ab58?source=collection_archive---------10-----------------------#2021-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be88" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看看用SwiftUI接口链接一个类的不同方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/adf9080022373fe08563de2d61f6b370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rJOYfv93Jvt-dlXc"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@tamanna_rumee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Tamanna Rumee </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="829a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在玩SpriteKit，突然想到这可能是一个很好的练习，提醒自己有多少种不同的方法可以将我的SwiftUI代码与我的SpriteKit场景/类链接起来。我不会以任何顺序、偏好或推荐来呈现这些；我按照它们或多或少出现在我脑海中的顺序展示它们。</p><h1 id="992a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">案情摘要</h1><p id="6d2e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我正在SwiftUI应用程序中运行SpriteKit场景，我希望能够使用SwiftUI元素(在本例中是一个按钮)直接控制sprite。和我一起看看我能做出多少种烹饪方法——来做到这一点。</p><p id="7b7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从基本代码开始。现在我把两个结构/类放在同一个文件中，尽管你可能希望把它们放在不同的文件中定义。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="31fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终目标是想出尽可能多的不同方法来做到这一点，蓝色文本<code class="fe mu mv mw mx b">jump</code>是一个SwiftUI按钮。兔子是我的SwiftUI界面所承载的场景中的一个<code class="fe mu mv mw mx b">SKSpriteNode</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/0170050cec7283a26718abc1baf1c51e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*J7TQPKeovCwaiMhN1EJDEg.gif"/></div></div></figure><p id="c3c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，列出的代码不会完全实现您在这里看到的内容，因为我们需要实现链接。</p><h1 id="51de" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">1.使用单件</h1><p id="7661" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">所以我的第一个想法是访问我的场景中的单例，然后在其中直接调用。我觉得是最短最快的实现。</p><p id="78b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经在<code class="fe mu mv mw mx b">GameScene</code>类中将shared定义为单例。缺点当然是我的<code class="fe mu mv mw mx b">GameScene</code>中的跳转方法需要每个人都可以访问，这可以说是糟糕的编码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="ecc0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">2.使用传递主题</h1><p id="d0e9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是我的第二个想法，老实说和第一个想法几乎一样，只是我通过Combine框架重定向了按钮。</p><p id="4504" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我能想到的主要优势是组织优势。如果我使用这种技术访问我所有的外部方法，那么我也许可以用一些预定义的规则来构造我的代码。遗憾的是<code class="fe mu mv mw mx b">jump()</code>当然仍然不是私有的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="ea30" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">3.可观察到的物体</h1><p id="8a45" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是一个经典的Combine + SwiftUI解决方案。它确实需要使用单例，而且可以说是迄今为止最干净的一种。</p><p id="5af1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最干净，因为在<code class="fe mu mv mw mx b">GameScene</code>和<code class="fe mu mv mw mx b">ContentView</code>之间没有直接连接。在其中，我定义了一个共享变量作为中间人类，用于触发<code class="fe mu mv mw mx b">jump()</code>方法的启动。</p><p id="6858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不利的一面是，我不认为这最终是非常可伸缩的，因为更新方法很快就会被启动变量淹没。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="58e8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.使用订阅</h1><p id="2319" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这也是一个经典的Combine+SwiftUI解决方案——虽然我在Stack Overflow之类的地方没怎么看到。</p><p id="2bf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我之所以怀疑，是因为这有点神秘，说实话，有点像“goto”语句。</p><p id="7afa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这里做的是在我的<code class="fe mu mv mw mx b">ContentView.swift</code>中订阅<code class="fe mu mv mw mx b">jointp</code>类中的runner。一个订阅，它在看到任何操作时运行jump方法。<code class="fe mu mv mw mx b">Jointp</code>这里又是一个中间人，有好有坏。</p><p id="0d1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我觉得这有点过时的原因是，没有规定说你在哪里设置订阅。</p><p id="87bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它在这里工作得很好，因为我需要在<code class="fe mu mv mw mx b">didMove</code>方法中这样做，但是理论上，我们可以在任何地方订阅，并创建一行从任何地方触发跳转方法——有点像goto。</p><p id="8a27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种解决方案有一个隐藏的优势；理论上，你可以取消订阅，并有效地禁用按钮。阅读这篇<a class="ae ky" href="https://medium.com/geekculture/cancelling-subscriptions-in-combine-illustrated-using-swiftui-60c786f8496c" rel="noopener">文章</a>来找出方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="deff" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.可变触发器</h1><p id="3caa" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个解决方案类似于第一个。在其中，我创建了一个变量，当它被访问时将执行我的<code class="fe mu mv mw mx b">jump()</code>方法。尝试建立一些团队规则来在代码中构建这类东西可能是个好主意。它比直接版本<strong class="lb iu"> </strong>好一点，因为你没有直接访问一个方法；你在访问一个变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="c4b9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">6.全球主题</h1><p id="4c47" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该解决方案与第二个解决方案<strong class="lb iu">非常相似，除了</strong> <code class="fe mu mv mw mx b">PassthroughSubject</code>是全局可见的。显然，这不是最好的选择，因为全局变量会在访问过程中造成混乱。</p><p id="690a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mu mv mw mx b">jump</code>也不是私有的。越想越觉得这其实是最差的方案:)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="320f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">7.安全订阅</h1><p id="9f50" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">正如我在开始时说的，这里没有真正的顺序，尽管通读Sundell的这篇文章，我发现我可以拆分出这个出版社。</p><p id="6588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这有一个很大的优势:不像以前的解决方案，我现在不能直接访问它。仅在<code class="fe mu mv mw mx b">jointp</code>类中通过fire方法授予访问权限。</p><p id="7077" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我仍在订阅，但我的代码比以前更安全了。说到防御性编码，您可以通过在fire方法本身中要求某种认证来进一步确保团队中的那些Tom、Dick和Harrys需要遵守规则。</p><p id="26f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，不利的一面是，即使没有认证，这也是迄今为止我展示的最多的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="42b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些都让我想到了这篇文章的结尾。</p><p id="2cdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开始的时候，我说过它没有任何顺序。但是事后看来，最后一种方法可能是最佳解决方案，尽管它也有最多的代码。当然，您必须想出一些规则来组织这些讨厌的订阅，但这可能是最具可伸缩性的，也可能是最安全的。</p><p id="f810" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你能像我研究和写这篇文章一样喜欢读这篇文章。</p><p id="6bc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持冷静；继续编码。</p></div></div>    
</body>
</html>