<html>
<head>
<title>Get Started With The Dynamic Island and Live Activities in iOS 16.1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS 16.1中的动态岛和直播活动入门</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/get-started-with-live-activities-and-the-dynamic-island-in-ios-16-f23d4f704128?source=collection_archive---------2-----------------------#2022-09-17">https://betterprogramming.pub/get-started-with-live-activities-and-the-dynamic-island-in-ios-16-f23d4f704128?source=collection_archive---------2-----------------------#2022-09-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="d353" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">给用户提供大量信息并不需要太多代码</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fa51bbb6d2a9ad4de0e7a754d8ce220e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JSZlm_sKyZB8JAUE"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@zunnu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Zunnoon Ahmed </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9fa7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">苹果的文档告诉你如何开始使用动态岛，它将围绕iPhone 14 Pro的新分离相机槽口的信息动画化。</p><p id="85a8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了构建这个项目，您至少需要运行Xcode版本14.1 beta。这个例子大部分来自于苹果的文档，但是这个例子给了你更多的控制发送到动态岛中的<code class="fe lw lx ly lz b">Activity</code>的数据。</p><p id="3468" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">有2个紧凑视图和4个扩展视图，如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ma"><img src="../Images/1b173365701256d6ba378ad5b8a2757f.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/1*E8vQrgBLAdHkTUbYnf3W4A.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者GIF</p></figure><p id="9be6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">创建一个新的iOS项目，并从左侧面板的项目导航器中选择项目本身。</p><p id="be9a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">单击项目设置的<em class="mb">信息</em>选项卡，将鼠标悬停在最后一个条目上，然后单击+按钮添加新属性。这个新属性应该叫做<code class="fe lw lx ly lz b">NSSupportsLiveActivities</code>，值应该是布尔类型，值应该是<code class="fe lw lx ly lz b">YES</code>。</p><p id="cdb9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">重要的是，这是在您的应用程序目标的<code class="fe lw lx ly lz b">info.plist</code>中，而不是它的任何扩展中。</p><h1 id="0dce" class="mc md iu bd me mf mg mh mi mj mk ml mm ka mn kb mo kd mp ke mq kg mr kh ms mt bi translated">我们开始吧</h1><p id="389d" class="pw-post-body-paragraph la lb iu lc b ld mu jv lf lg mv jy li lj mw ll lm ln mx lp lq lr my lt lu lv in bi translated">我将创建一个<code class="fe lw lx ly lz b">Form</code> <code class="fe lw lx ly lz b">Section</code>来控制未来我希望我的实时活动发生的时间。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="5008" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下一个视图显示了我希望用户能够改变的实时活动。动态岛的每个部分都将被赋予一个自定义的字符串，尽管我建议尽量保持简短，因为它们中的许多都被设计成小图标。</p><p id="ffe8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">表情符号会起作用😀</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="8a89" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这也改变了我的类型，使其符合<code class="fe lw lx ly lz b">ActivityAttributes</code>协议。我不再像<a class="ae kz" href="https://developer.apple.com/documentation/activitykit/displaying-live-data-with-live-activities" rel="noopener ugc nofollow" target="_blank">苹果的示例代码</a>那样存储关于披萨递送的数据，因为我真正关注的是什么文本将显示在动态岛上的什么位置。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="5c34" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是我在当前实时活动创建后用来显示它的内容。</p><p id="69e4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，我使用了一个名为<em class="mb">的<code class="fe lw lx ly lz b">Section</code>剩余时间</em>，它将一个<code class="fe lw lx ly lz b">timerInterval</code>传递给一个<code class="fe lw lx ly lz b">Text</code>。如果你不知道，这是一个新的简单的方法，只使用一个<code class="fe lw lx ly lz b">Text</code>和一个<code class="fe lw lx ly lz b">ClosedRange&lt;Date&gt;</code>来显示计时器。这个日期范围的创建将在稍后完成，但是如果您想要在动态岛或锁屏小部件中使用计时器，您可能需要使用它。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="7ec7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我将所有数据存储在我的<code class="fe lw lx ly lz b">ContentView</code>类型中，但是它还不符合<code class="fe lw lx ly lz b">View</code>协议。<code class="fe lw lx ly lz b">createActivity</code>函数使用新的<code class="fe lw lx ly lz b">MyActivityAttributes</code>类型创建一个带有用户选择的细节的<code class="fe lw lx ly lz b">Activity</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="0722" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在我要给<code class="fe lw lx ly lz b">View</code>协议添加一致性。</p><p id="9ce8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe lw lx ly lz b">createActivity</code>功能现在将被添加为<code class="fe lw lx ly lz b">Form</code>中<code class="fe lw lx ly lz b">Button</code>的动作，它将折叠具有<code class="fe lw lx ly lz b">Activity</code>设置的<code class="fe lw lx ly lz b">DisclosureGroup</code>，以便在<code class="fe lw lx ly lz b">ActivityDetailsView</code>中显示活动的详细信息。然后<code class="fe lw lx ly lz b">TimeSliders</code>和<code class="fe lw lx ly lz b">ActivityTextFields</code>将被隐藏，但如果需要，可以再次打开<code class="fe lw lx ly lz b">DisclosureGroup</code>以创建另一个<code class="fe lw lx ly lz b">Activity</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><h1 id="b079" class="mc md iu bd me mf mg mh mi mj mk ml mm ka mn kb mo kd mp ke mq kg mr kh ms mt bi translated">创建小部件</h1><p id="eb86" class="pw-post-body-paragraph la lb iu lc b ld mu jv lf lg mv jy li lj mw ll lm ln mx lp lq lr my lt lu lv in bi translated">现在我需要创建小部件。</p><p id="508b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">转到<em class="mb">文件&gt;新建&gt;目标……</em>并创建一个小部件扩展，我称之为我的<code class="fe lw lx ly lz b">DynamicIslandWidget</code>。</p><p id="8d38" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个例子很容易理解，我没有用一个合适的锁屏小部件。这个<code class="fe lw lx ly lz b">Text("N/A")</code>会显示在锁屏下方，不过你想怎么改都可以。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mz na l"/></div></figure><p id="74f2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，必须返回主屏幕才能看到最小化到动态岛的应用程序。</p><p id="2e58" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">轻按一次将再次打开应用程序，但长按它将打开扩展视图。</p><p id="fcc2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">显然，在这里传递比字符串更复杂的东西是可能的，但你可以选择你想在什么地方出现什么。</p><pre class="kk kl km kn gu nb lz nc nd aw ne bi"><span id="a15d" class="nf md iu lz b gz ng nh l ni nj"><strong class="lz iv">Want Daily Coding Tips like these?</strong></span><span id="d5a8" class="nf md iu lz b gz nk nh l ni nj">This is based on tips that previously appeared in my newsletter <a class="ae kz" href="https://typesafely.substack.com/" rel="noopener ugc nofollow" target="_blank">Type Safely</a>.</span></pre></div></div>    
</body>
</html>