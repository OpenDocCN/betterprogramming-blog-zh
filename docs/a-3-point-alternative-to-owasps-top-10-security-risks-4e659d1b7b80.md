# OWASP 十大安全风险的 3 点替代方案

> 原文：<https://betterprogramming.pub/a-3-point-alternative-to-owasps-top-10-security-risks-4e659d1b7b80>

## 确保您的应用安全的整体框架

![](img/9ac7dee048c87584f3be0a1587331e3d.png)

照片由[丹尼尔·林](https://unsplash.com/@daniellim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄

对于那些不知道的人来说， [OWASP 十大](https://owasp.org/www-project-top-ten/)是信息安全社区中经常提到的常见(web)应用程序安全问题的列表。如果你申请的是这个行业的职位，招聘启事上列出的要求之一通常是“熟悉 OWASP 十大标准”，你可以期待在面试中被问到这些问题。

我开始想写这篇文章，作为一个容易理解的入门读物，突出了前十名的清晰例子。在做研究和查看列表时，我发现我不一定同意他们对漏洞的分类和组织，并认为它可能会被简化和现代化。

具体来说，我看到了点 [#2](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication) 、 [#3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure) 、 [#5](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control) 、 [#6](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration) 之间的一些冗余；有些可能不值得拥有专门的位置，比如 [#4](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)) (XML 外部实体)；再加上一些看似缺失或被低估的东西。至少看起来有一些空间让我们对事情有不同的看法。

因此，我没有编写初级读本，而是以三个高级领域的形式制作了我自己版本的列表，每个领域下面都有一个特定威胁和缓解步骤的列表。

我相信这种方法是一种实际可行的方法，可以作为一个清单来确保自己的基础得到覆盖。即使你不会在工作面试中被问及列出他们的琐碎问题，他们也会帮助你给出一个更全面的答案，当被问到你的方法是什么时，你会如何获得一个网站。也许你可以这样打动你的面试官:“当然，我知道前十名，但是你听说过道的三名吗？”(工作头衔)。一个人可以做梦。

让我们来评估一些威胁。

# 1.恶意输入

![](img/e4f90d729511fe0316e12cda072e9935.png)

基拉·奥德·海德在 [Unsplash](https://unsplash.com/s/photos/present?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 拍摄的照片

## 这是什么？

这是一个广泛的类别—它涵盖了 OWASP [#1](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection) 、 [#4](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)) 、 [#7](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS)) 、 [#8](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A8-Insecure_Deserialization) ，加上一些额外的关注点。输入有多种形式(包括文字形式提交)，是用户与应用程序交互的主要方式。当涉及到 web 应用程序时，恶意用户输入(通常以代码注入或文件交互的形式)可能是最常被利用的攻击载体。

有许多类型的攻击都属于这一类，但它们都遵循相同的模式:未经整理的、意外的或错误处理的输入导致系统做了一些它不想做的事情，并产生负面结果。这里有一个常见问题的列表，可以作为进一步研究的起点(只需在谷歌上搜索感兴趣的条目):

## 简单攻击

提供给应用程序的明显部分的输入，如输入元素、表单和 URL 参数(GET 和 POST 变量)，其中包含恶意代码片段，这些代码片段随后会在目标系统上执行或由使用该服务的客户端执行。

*   **SQL 注入:**通过用户提供的输入来操纵数据库查询，以提取或篡改网站的数据库
*   **跨站点脚本(XSS)家族:**客户端代码(如 HTML 元素和 JavaScript)被添加到网站中，然后由访问者执行，通常是直接窃取他们的信息或欺骗他们放弃信息，或者代表他们触发操作

## 复杂攻击

这些很容易被忽略，因为剥削路径不太明显。攻击不是向站点提供简单的恶意输入，而是嵌入在标记、编码数据或其他更模糊的交互领域中。这些类型的攻击会导致底层系统的低级别危害，因为涉及的操作通常比简单的用户输入更可信，因此执行的代码可能具有很大的破坏性。

*   **(非)序列化:**在客户端和服务器之间或者服务之间传递的复杂(非原语)数据通常是序列化的(“打包”和“解包”)，以便于传输。因为数据，尤其是序列化形式的数据，对人类来说是不可读的，所以作为潜在的攻击媒介，它经常被忽视。恶意输入和指令可以隐藏在序列化数据中，然后在反序列化时处理和执行这些数据。
*   **XML/JSON 攻击:**和上面一点类似，XML 和 JSON(web 的语言)都可以被攻击者操纵来达到目的。这些格式的功能也可能以意想不到的方式被利用——它们不仅仅是愚蠢的数据包装器。OWASP 专门用了[一整点(#4)](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE)) 来讨论与 XML 相关的 XXE 攻击，我个人认为这是一个非常次要的问题，不一定值得专门讨论，但是作为一个整体，必须考虑这些类型的攻击。当心这些数据中可能隐藏的东西。

1.  **cookie、会话数据和 HTTP 头:**这些都是由客户端和服务器处理的输入形式，因此充当了一个额外的攻击媒介，尽管这是一个模糊且很少有成效的媒介。在解析过程中请记住这一点。

## 文件为中心的攻击

文件(和文件访问请求)是另一种可能对应用程序造成重大威胁的输入类型。滥用存储和检索功能会导致系统整体受损或内容泄露。

*   **目录遍历:**在一个提供文件检索的 app 中，尤其是从底层文件系统(而不是数据库)中，`filename`、`path`以及相关参数都是恶意输入的载体。如果您有一个从固定目录下载给定名称文件的脚本，提供`../../../../secret.txt`可能是攻击者访问他们不应该访问的东西的一种方式。一些错误配置的 web 服务器也可以在一般意义上暴露这种类型的威胁——也就是说，不特别涉及文件检索逻辑。
*   **上传脚本和文件:**如上所述，当攻击者有能力上传文件到服务器时，他们可能会将目标文件替换掉。或者，他们可以将恶意脚本(如 web shells)上传到 webroot 之上的位置，然后通过浏览器运行。注意那些扩展名和 MIME 类型！
*   **Zip bomb:** 一种恶意的 Zip 文件，它解压缩到几乎无限的大小，这可能导致拒绝服务和资源耗尽类型的攻击
*   **Zip slip:** 一种恶意的 Zip 文件，在解压缩过程中替换系统中其他位置的文件，其原理类似于目录横向攻击

## 如何防范恶意输入

跟我念:净化你的输入。净化*您的所有*输入。不要相信他们。变得偏执。戴上锡纸帽。

我已经给了你一个工作列表，研究特定的向量将会产生关于缓解的建议——只要确保你考虑了适用于你的系统的一切。站在黑客的角度，想想输入可能被滥用的方式，然后进行补偿。

重要的是要记住，传递给服务器的任何东西都被认为是用户输入，即使它在前端没有任何部分，而是在后台处理。眼不见不散—快速浏览一下网络面板就能发现大量潜在的攻击媒介，而这些媒介在实施防御安全时并不明显。

一旦你像一个过度热情的运输安全管理局工作人员一样筛选你的输入，是时候继续支撑你系统的下一个核心功能了。

# 2.访问控制不足

![](img/a81131e084cc33e39a3c65b701927827.png)

何塞·丰塔诺在 [Unsplash](https://unsplash.com/s/photos/lock?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

## 这是什么？

在网络上实现信任是一件困难而脆弱的事情——随着更多移动部件和系统的参与，这一挑战会越来越大。

在一个由 SaaS 产品、第三方 API、跨域流量、共享身份认证提供者以及混合设备和平台组成的生态系统中，有很大的空间在组合中遗漏身份认证检查或规则。您必须确保每个资源只能由应该访问它的人访问，并且通信通道本身也是安全的。本节大致涵盖了 OWASP [#2](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication) 、 [#3](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure) 、 [#5](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control) 和 [#6](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration) 。

## 标准和威胁

这都是关于用户如何被允许与你的系统交互。任何交互点，如果控制不当，都是信息泄露或未授权操作的潜在来源。

*   **协议安全性:**显而易见的东西——也是这一类别的先驱。需要使用现代 TLS 配置来保护通信。您的站点适当地将 HTTP 重定向到 HTTPS，没有 SSL-strip 类型攻击的空间。在适用的情况下，Cookies 应该使用`secure`标志。如果没有这一点，攻击者就可以拦截和操纵您的流量，而实施身份验证和访问控制的努力也将是徒劳的。
*   **认证和访问控制:**特定威胁来源的类别的核心概念。用户应该通过适当的规则集进行身份验证，资源应该受到保护——基本上，如果已建立的身份 *x* 请求资源 *y，*确定他们是否被允许访问它。这里的一个疏忽都可能导致信息泄露甚至更糟。
*   **缺乏服务器端检查:**攻击者可以在不使用您的客户端(web、移动等)的情况下调用您的服务器。这意味着 auth 和 AC 必须在服务器上完成。用户可能有权限更新他们的个人资料，但是如果他们将`{“admin”: true}`作为更新提交的一部分，即使客户端没有显示“admin”复选框，会发生什么？所有的端点和动作都需要被保护(和净化，即恶意输入),就像客户端不存在一样。
*   **抓取:**现代 API 在语义上非常一致，并且不依赖于晦涩的安全性。正因为如此，很容易有人写脚本请求`/record/1, /record/2, …`。如果攻击者能够猜测或推断出敏感信息的 URL，或者通过迭代/暴力手段获取这些信息，那么您就面临着信息泄露的风险。
*   **僵尸工具缓解:**暴力攻击、凭证填充攻击以及垃圾邮件的来源。在适当的地方使用验证码和 IP 黑名单，比如在登录和提交表单上。
*   **跨站点请求伪造(CSRF):** 假设您有一个端点`[https://example.com/user/1/delete](https://example.com/user/1/delete)`来删除一个用户——如果您的一个用户被诱骗通过另一个网站或其他来源点击该链接，会发生什么？任何可以以这种方式直接调用的操作都有被系统外的攻击者利用的风险。令牌化操作是缓解这一问题的一种方法。
*   **跨产地资源共享(CORS)和跨域攻击:**浏览器和 app 可以在幕后进行资源请求。当这些请求指向不同的站点(子域或域之间，指向 API 等)时。)，某些安全规则适用。这些规则的错误配置可能意味着当您的某个用户访问恶意站点时，该站点会使用您的用户权限自动触发对您自己站点的请求。这些规则很难配置，所以很容易让它们变得非常宽松——这是很危险的。它们应该尽可能地严格，同时仍然允许您的应用程序运行。如果你还没有实施`X-Frame-Options`，也要考虑一下。
*   **不必要的曝光:**任何不需要公开的都不应该公开。这可以包括管理面板、测试文件和文件夹、目录索引、`robots.txt`不可覆盖部分的条目、内部服务、测试或内部站点和子域等等。对于执行侦察的黑客来说，他们收集的信息、网站和资源越多越好。对任何面向公众但需要保持公开的敏感内部组件使用 IP 白名单和密码保护，并清除所有其他内容。

## 如何保护您的服务和资源

考虑上述问题后，问自己以下问题:

1.  应用程序的所有必要部分是否仅限于经过身份验证的用户？
2.  所有行动和资源是否都被适当地限制到适当的用户/角色/来源？
3.  您的端点是否独立于客户端逻辑受到保护？
4.  您的通信信道是否经过加密和防窃听保护，您的服务器是否强制执行正确的协议使用？
5.  你是否向公共互联网公开了你不应该公开的资源？

这是关于检查你的系统，找出差距，解决它们，然后重复。考虑一下，对于所有涉及的系统和资源，信息流是如何从协议层向上控制的。如果可能的话，实际模拟测试威胁，而不是查看代码和配置——有些事情可能与预期的有所不同。

要涵盖的内容很多，让你的系统无懈可击是一门艺术。你还必须考虑当一个项目被忽略，事情出错时会发生什么。

# 3.操作失败

![](img/1bfc60e73c9eb1a0d5c1722a5c222dda.png)

图片来自 [Pixabay@Pexels](https://www.pexels.com/photo/men-working-at-night-256219/)

## 它们是什么？

在*运营*的大伞下——开发运维、系统管理员、策略和程序——不良实践和缺乏覆盖可能导致灾难或使灾难变得更糟。每个移动部分及其(正确或不正确的)实现都是潜在的威胁源，组织实施的计划和实践有助于在需要时减轻和处理此类威胁。这是你为成功或失败做准备的地方。

## 威胁和关切

这将涵盖 OWASP [#9](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities) 和[# 10](https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A10-Insufficient_Logging%252526Monitoring)——如果你一直在跟踪，这是剩下的两个点。它还包括一些关于策略和实践的软性考虑，在讨论系统的安全性时，这些考虑往往是不充分的。被忽视的最佳实践对一个组织来说会发展成潜在的然后是积极的危险。

*   **依赖项计数:**你能列出你的产品使用的所有依赖项和技术吗？拥有一个高数量本身并没有好坏之分，但是我认为在可能和合理的情况下，应该将它们最小化。更重要的是，他们被识别出来，他们的风险通过安全镜头被考虑。例如，如果你使用的是 WordPress——一个无处不在的、有用的、定期锁定的 CMS——它(和它的插件)需要定期维护和保持安全。
*   **打补丁:**使用有已知漏洞的过期软件是最容易被入侵的方法之一。应用您的补丁！自动是首选，但是对于生产系统，如果您采用手动方法，不要让任何东西从缝隙中溜走。及时了解整个组织中正在使用的技术的最新安全公告。
*   **保护软件和服务:**缺乏防火墙/IDS/IPS 覆盖和访问控制给了黑客入侵您系统的额外机会。内部和公共系统应被隔离或置于隔离区(如果适用)，以防部分违规。锁定任何不需要公开的内容，保护需要公开的内容。
*   **日志记录:**缺乏适当的日志记录意味着两件事:无法检测潜在的威胁和恶意行为模式，以及无法对安全事件做出适当的响应。日志记录应该是健壮的、集中的、定期检查的，并且在需要帮助跟踪问题时可用。
*   **备份(和 RAID):** 一个明显的例子。您需要重要数据的一份拷贝，事实上是多份拷贝(遵循 3–2–1 规则)—否则，您将面临潜在的数据丢失，这对于组织来说可能是灾难性的。离线备份是必须的。做好物理灾难、硬件故障、意外删除、故意删除、损坏、[勒索软件和密码箱攻击](https://medium.com/@KevinDawe/how-to-protect-your-organization-from-the-growing-threat-of-ransomware-attacks-d2fd6588c92a)等等的准备。必须对备份进行例行验证，并练习恢复过程，以便在必要时做好准备。
*   **灾难恢复计划(DRP):** 您是否考虑过，如果您的办公室发生火灾，您的生产服务器遭到黑客攻击，您的数据库泄露给公众，或者您的所有系统在勒索软件攻击中被锁定，会发生什么情况？思考和讨论这些威胁有助于在它们发生之前减轻它们。有一个记录在案的计划意味着你能够在危机出现时快速有效地做出反应，因为时间是至关重要的。创建并定期维护此文档是组织安全的关键(并确保您可以在系统停机时访问它)。

## 做必要的事

保护系统，应用补丁程序，保存并监控备份和日志。制定政策以确保做到这一点。集思广益潜在的威胁和灾难，以帮助制定 DRP，并把它作为一个活的文件。发挥创造力——尽可能多地问“如果……会怎么样”的问题。此外，询问“使用[这项技术]安全吗？”以及“我们是否遵循了最佳实践？”出于习惯。

对于日常维护，如检查日志和应用补丁，只需使用重复的日历事件和共享的报告文档，就可以确保不会留下任何隐患。将责任分配给个人，并与他们一起跟进以确保事情得以完成。

尽职调查和周到的准备将为您的组织提供安全和安心。

# 概述

正如你所看到的，有很多基础要覆盖。概括来说，需要做三件事来确保应用的安全性:

1.  输入必须经过消毒和安全处理。
2.  必须适当实施和保护通信和资源访问。
3.  需要遵循操作技术系统的最佳实践。

这些被分解成上面记录的相关步骤和考虑事项。这绝不是一个详尽的列表，而是一个让您思考如何保护应用程序免受最常见威胁的框架。鉴于当今使用的技术的复杂性和相互作用，不可能涵盖系统可能被利用的所有潜在方式。

当保护您的应用程序时，特别要考虑您正在做的不是标准的事情，以及在这种不同中，您是否会面临任何独特的危险。

# 结论

回到 OWASP，我已经涵盖了前十名中的所有要点，以及一些其他方面。

我认为三个高层次的要点，每个要点下面都有重要的细节，相比之下可能是更容易记住和更实用的框架。

我确实相信，我提出的这种方式可以作为一种更全面的清单式方法，来实际保护应用程序，而不是简单地列出某些威胁。最后，我认为对于那些发现自己有责任保护应用程序/系统的人来说，这应该是一个有用的参考——这是根据我 10 多年来在这方面的经验写成的。

如果你喜欢这篇文章，我还在今年早些时候为组织制作了一个针对勒索软件的缓解指南。