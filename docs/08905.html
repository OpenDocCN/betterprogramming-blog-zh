<html>
<head>
<title>Code Readability or Performance: Which Is More Important?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码可读性和性能:哪个更重要？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/code-readability-vs-performance-25a9ca970aca?source=collection_archive---------6-----------------------#2021-06-24">https://betterprogramming.pub/code-readability-vs-performance-25a9ca970aca?source=collection_archive---------6-----------------------#2021-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="028c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对双方进行分析，以相应地确定优先顺序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/230f4caf9ab1ce19e666687f23afe0f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWejmdSOkfRHcIB-Pl2XQQ.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">由<a class="ae ku" href="https://unsplash.com/@ospanali" rel="noopener ugc nofollow" target="_blank"> ospanali </a>在<a class="ae ku" href="https://unsplash.com/photos/GUmRXc-vOxw" rel="noopener ugc nofollow" target="_blank"> unsplash </a>上生成的基础图像</p></figure><p id="85e3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">关于代码可读性相对于性能的重要性的讨论已经在互联网上流传了很长时间。但是，很难得出一个客观的答案。</p><p id="a787" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">所以让我们试着分析不同上下文中的可读性和性能，而不是试图找到一个客观的答案。</p><p id="b126" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">先说一个问题:这段代码可读吗？</p><pre class="kj kk kl km gt lr ls lt lu aw lv bi"><span id="c89a" class="lw lx it ls b gy ly lz l ma mb">- .... .. ... / .. ... / .-. . .- -.. .- -... .-.. .</span></pre><p id="1a2c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这实际上是<a class="ae ku" href="https://morsecode.world/international/translator.html" rel="noopener ugc nofollow" target="_blank">莫尔斯电码，翻译过来就是</a>“这是可读的！”你可能会说，如果你知道莫尔斯电码，这是可读的。现在，如果你不知道莫尔斯电码，把这个代码叫做不可读有意义吗？不完全是，因为它是可读的莫尔斯电码。</p><p id="d21e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在让我们把这个应用到软件中。你能快速浏览一下下面的代码吗？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="517c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这实际上是冒泡排序的一个实现。如果你知道冒泡排序是如何工作的，并且习惯于编写这样的算法，那么你可能很快就能看出来。但是，如果您以前从未看过冒泡排序算法，您可能需要一些时间来理解它。</p><p id="7955" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">仅仅因为不熟悉这个主题的人可能要花一些额外的时间来理解它，你会认为这段代码不可读吗？这个问题把我们带到了第一点。</p><p id="19b7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果上面的算法引起了你的兴趣，那么看看Vaidehi Joshi 对冒泡排序的详细解释和分析。我不久前读过这本书，认为这是一本有趣的读物。</p><div class="mg mh gp gr mi mj"><a href="https://medium.com/basecs/bubbling-up-with-bubble-sorts-3df5ac88e592" rel="noopener follow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd iu gy z fp mo fr fs mp fu fw is bi translated">冒泡排序</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">在编程社区中似乎有一个超越语言、库或框架的笑话——</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">medium.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx ko mj"/></div></div></a></div><h1 id="00ce" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">可读性与概念无关</h1><p id="6bd4" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">排序算法的实现很可能在语言的标准库中或者在提供算法的库中找到。如果您从事这样的项目，您将习惯于使用这样的代码，并且知道底层的概念。因此，这段代码对你来说是可读的。你不能仅仅因为不理解基本概念就认为某些代码不可读。</p><p id="9e90" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">是的，许多算法的代码很难理解，这些算法解决了特定领域的问题，因此被广泛应用。然而，这可以归因于这样一个事实，即与业务逻辑相比，这些算法通常涉及更多的数学和/或复杂的逻辑分支。</p><p id="20f2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一个算法总是可以使用适当的命名和其他编码实践来使自己更具可读性。此外，如果不先研究这些算法，就不能实现它们。你也不会试图在没有理解基础概念的情况下阅读复杂算法的代码。</p><p id="6e5a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">也就是说，如果上面的函数有一个注释来解释算法是什么，或者如果函数被恰当地命名，那么就更容易理解了。你可以谷歌一下，理解基本概念，然后回到代码上来。无论代码处理什么，这种可读性总是可以实现的。</p><h1 id="0903" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">可读性受个人偏好的影响</h1><p id="a4c5" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">一些开发人员发现<code class="fe nu nv nw ls b">for</code>循环具有可接受的可读性。另一方面，其他人更愿意阅读像<code class="fe nu nv nw ls b">filter</code>、<code class="fe nu nv nw ls b">map</code>和<code class="fe nu nv nw ls b">reduce</code>这样的方法。可读性的程度还取决于在<code class="fe nu nv nw ls b">for</code>循环中填充了多少逻辑，以及它是否会引发任何副作用。同样的论点也适用于其他概念，比如<code class="fe nu nv nw ls b">if — elseif</code>分支和guard子句。</p><p id="f043" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果你不知道保护条款或者想了解更多，这里有一篇卡洛斯·卡瓦列罗写的关于保护条款的文章。</p><div class="mg mh gp gr mi mj"><a rel="noopener  ugc nofollow" target="_blank" href="/refactoring-guard-clauses-2ceeaa1a9da"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd iu gy z fp mo fr fs mp fu fw is bi translated">重构:保护子句</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">成为更好的开发人员的技巧</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">better编程. pub</p></div></div><div class="ms l"><div class="nx l mu mv mw ms mx ko mj"/></div></div></a></div><p id="a9a0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这种可读性的程度实际上取决于开发产品的开发人员。然而，对于任何团队来说，达成共识并坚持一个标准都是非常有益的。因此，如果可能的话，团队应该坐下来，就可读性而言，就什么对团队来说是重要的，创建简单的指南。代码评审是一个很好的平台，它可以帮助团队确定什么样的可读性级别，并强制执行。</p><h1 id="a147" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">性能取决于环境</h1><p id="e825" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">当您开发web应用程序时，您将大部分时间用于实现业务逻辑。大多数业务逻辑是通过调用API和使用其他库提供的类来实现的。这些库的范围可以从HTTP服务器到数据库驱动程序甚至算法。这些底层库通常会提升性能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="ac85" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">相比之下，如果您正在创建或实现一个算法来解决一个众所周知的问题，这对许多应用程序都很有用，例如，遍历一个图，您通常会尝试找到一个快速的算法。应用程序开发人员也一直在动态地创建算法。然而，这些算法是特定于该应用的，并且通常不会一次处理大量数据。因此，只要遵循正确的编码实践，它们通常不会显著影响性能。</p><p id="b847" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">尽管如此，对于任何类型的算法，尤其是那些动态创建的算法，我们总是可以根据用例定义一个可接受的性能水平。</p><h1 id="3fc5" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">性能代码并不总是不可读的</h1><p id="d011" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">算法的性能也不直接依赖于可读性。一个算法的速度取决于它使用的逻辑和数据结构，而不一定取决于它是否可读。</p><p id="146b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">类似地，如果您的应用程序很慢，很可能您正在直接或间接地为手头的问题使用低效的算法或数据结构。在这些情况下，牺牲可读性并不能解决问题。</p><p id="cbe1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如:如果您的应用程序由于缓慢的数据库查询而变慢，解决方案是通过智能地放置索引或重新考虑数据之间的关系，使数据库使用更有效的算法和数据结构。在这样做的时候，可读性并没有发挥作用。</p><h1 id="29b3" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">可读代码不必牺牲性能</h1><p id="8eef" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">让我们考虑一个用户可以推荐其他用户注册的应用程序。如果您需要编写业务逻辑来从数据库中获取所有用户及其推荐人的姓名，您可以用许多不同的方式来完成。这里有两种方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="1586" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">大多数人会认为这两种选择都是可读的。但是，第二种方法比第一种方法可读性更好，性能也更高，尤其是在数据库定义了正确的索引的情况下。对于不了解SQL连接的人来说，它可能是不可读的，但是使用一个有用的语言特性不应该被贴上不可读的标签。</p><p id="f271" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个例子说明，正确熟悉您所使用的技术栈可以使代码既可读又有性能。每当遇到问题时，与其立即推出自己的解决方案或使用另一个第三方库，不如研究一下项目中使用的库和工具是否已经提供了解决问题的一些功能。</p><h1 id="f4c4" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">正确性最重要</h1><p id="d666" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">如果一个产品或特性的行为符合预期，那么它就是正确的。如果你的代码一点都不正确，那么它的可读性和性能都没有关系。</p><p id="312a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">有些产品的整个系统或部分系统都围绕着性能。在这些情况下，如果您的产品不符合预期的性能，那么它就不可能是正确的。因此，当性能与正确性联系在一起时，您需要首先考虑性能。</p><p id="dda6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如，如果你正在开发一个游戏，声称可以在奔腾4上以每秒60帧的速度运行，你应该专注于实现这个目标。您可以通过使用最快的算法和数据结构、创建新的算法和数据结构、优化现有代码，甚至牺牲一些特性来实现这一点。</p><h1 id="cdc1" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">知道何时优化什么</h1><p id="b156" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">如果不知道瓶颈在哪里，就不可能优化代码。当然，如果您知道哪里更可能出现常见的性能问题，那么您总是可以从一开始就编写性能代码。</p><p id="691b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一个很好的例子就是我们前面讨论的SQL例子。使用过SQL的人肯定知道在这种情况下需要使用join。在大多数情况下，如果您遵循良好的编码实践，那么您将不会产生任何性能问题。</p><p id="ff90" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">了解是否需要优化以及需要优化多少的最佳方法是在规划特性时定义预期的性能。当我们定义了性能预期时，我们可以首先尽我们最大的能力编写可读的代码，然后当且仅当它不满足性能需求时重构它。</p><p id="2cff" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果从产品的角度来看，性能确实需要一流，那么我们可以执行压力测试，以确定实现是否满足性能要求。</p><p id="8e2d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如，我们可以说，一个返回系统中所有用户列表的API必须在一秒钟内对当前生产中的数据量做出响应。或者，我们可以说API必须在一秒钟内返回两倍于现在生产中的数据的响应。</p><p id="2218" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">云提供商也提供了许多工具来为您衡量性能。这些都是很好的工具，可以检测出什么时候确实存在性能瓶颈，需要进行优化。如果您不想使用这些，那么您可以轻松地创建一个简单的解决方案来记录您的性能，并将其写入您的日志。之后，只需监控性能并调查性能何时开始下降。</p><p id="be60" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">即使您执行压力测试，也一定要使用这些工具。</p><h1 id="6d4b" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">在整个应用程序中，性能可能会有所不同</h1><p id="52cb" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">现代应用程序很复杂，有许多组件相互通信和工作。然而，并非所有这些组件都需要相同级别的性能。</p><p id="224f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们以一个购物应用程序为例。该应用程序包含产品目录、处理订单、处理支付、处理交付、分析数据和生成建议等部分。所有这些不同的组件不需要相同的性能水平。</p><p id="11e3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">数据分析和建议部分可能会处理大量数据，并且可能需要根据系统执行这些操作的频率来执行。大多数应用程序将这些组件作为后台作业在后台运行，因为即使这些组件很快，它们也必须处理大量数据。</p><p id="c694" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">类似地，产品目录很可能花费大部分时间等待来自数据库的产品并提供HTML文件。因此，只要您使用良好的编码实践，就不必太担心优化问题。底层web应用程序和数据库库提供的性能应该足够了。</p><h1 id="614d" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">编译器会为您优化</h1><p id="96ef" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">好的编译器总是会对你的代码进行优化。你不应该太担心一些小事，比如创建太多的变量和函数，比较不同操作符之间的性能等等。</p><h1 id="a143" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">可读代码总是更容易优化</h1><p id="1a87" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">可读代码更容易理解，因此如果需要也更容易优化。在保证满足系统需求的同时，尽最大努力写出可读的代码，真的没有太大的坏处。</p><p id="3341" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果已经编写了适当的测试，那么重构总是更容易，因为您可以运行测试来确保行为没有改变。此外，现代软件是通过互联网交付的，而不是通过软盘或光盘。因此，如果性能开始下降，通过推送更新可以更容易地修复bug。</p><h1 id="9090" class="my lx it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">结论</h1><p id="1fab" class="pw-post-body-paragraph kv kw it kx b ky np ju la lb nq jx ld le nr lg lh li ns lk ll lm nt lo lp lq im bi translated">对于代码可读性是否比性能更重要，很难给出一个客观的答案。可读性和性能的程度取决于应用程序的性质和要求。此外，这可能在应用程序的不同部分有所不同。因此，唯一能够做出正确、明智决策的人是开发应用程序的团队。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="7a9e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果你想了解更多关于代码可读性的知识，这里有一篇由RayRay 撰写的文章。本文中提到的要点适用于所有编程语言。</p><div class="mg mh gp gr mi mj"><a rel="noopener  ugc nofollow" target="_blank" href="/5-rules-to-improve-code-readability-83eda50ca780"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd iu gy z fp mo fr fs mp fu fw is bi translated">提高代码可读性的5条规则</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">代码可读性是你的应用程序的一个特性(即使你的用户看不到)</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">better编程. pub</p></div></div><div class="ms l"><div class="of l mu mv mw ms mx ko mj"/></div></div></a></div></div></div>    
</body>
</html>