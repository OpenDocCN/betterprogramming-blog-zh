<html>
<head>
<title>Making Notch-Friendly Apps for Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Android开发友好的应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/making-notch-friendly-apps-for-android-75776272be5c?source=collection_archive---------2-----------------------#2018-08-27">https://betterprogramming.pub/making-notch-friendly-apps-for-android-75776272be5c?source=collection_archive---------2-----------------------#2018-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="133c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何让你的应用支持带凹槽的边对边屏幕</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/44e11c6306b20f2aad9a3a72125caaa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKLEqbLFYcgMzjLCtfca7g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://android-developers.googleblog.com/2018/07/supporting-display-cutouts-on-edge-to.html" rel="noopener ugc nofollow" target="_blank"> <em class="kw">开槽手机:Essential PH-1(左)和华为P20(右)</em> </a></p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="kx ky l"/></div></figure><p id="4cbb" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">众所周知，随着iPhone X的发布，许多Android手机也纷纷效仿，采用边到边的设计，并在顶部留出摄像头和其他传感器。</p><p id="df43" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">截至2018年8月，共有16款设备具有剪切显示屏，今年晚些时候还会有更多。</p><p id="5e2b" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这导致设备具有:</p><ul class=""><li id="8524" class="lv lw iq lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">较小的挡板。</li><li id="3f03" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">更大的长宽比。</li><li id="c209" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">更加身临其境的体验。</li></ul><p id="4b41" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这可以让游戏、视频播放、照片/图库应用程序以及更多应用程序变得更加有趣！</p><p id="525c" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">但是有缺口的手机有一个问题:</p><p id="39ff" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">凹口占据了显示器顶部的很大高度，因此遮挡了其两侧的区域，使得屏幕的这些部分不可用。</p><p id="fc9e" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">令人欣慰的是，<a class="ae kv" href="https://www.android.com/versions/pie-9-0/" rel="noopener ugc nofollow" target="_blank"> Android Pie </a>拥有API，让开发者管理如何让他们的应用程序显示窗口内容，以利用凹槽两侧的屏幕空间。</p><p id="4517" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">您甚至可以检查缺口的位置，因此可以相应地渲染视图。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="4d2e" class="mq mr iq bd ms mt mu mv mw mx my mz na jw nb jx nc jz nd ka ne kc nf kd ng nh bi translated">问题是</h1><p id="e7dc" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">让我们借助一台运行Android Pie 9.0的Nexus 5X(配有模拟槽口)来深入研究这个问题。</p><p id="7e25" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">就本文的目的而言，该应用程序目前所做的只是显示一个全屏活动，当你点击中心的文本时，它就会变得身临其境，正如你在下面的演示中看到的那样；并且当你再次点击它时来回切换。</p><p id="ef8d" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这个演示应用程序的源代码可以在这里找到:</p><div class="nn no gp gr np nq"><a href="https://github.com/bapspatil/NotchFriendlyAppDemo" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">bapspatil/NotchFriendlyAppDemo</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">一个演示应用程序，展示如何让您的应用程序支持带凹槽的窄边框屏幕。—bapspatil/NotchFriendlyAppDemo</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe kp nq"/></div></div></a></div><p id="1b70" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">让我们来看看我们的应用程序的默认行为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/fc044a0621a13b3fe835aca80c060aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/1*sWnEvn58lUphHbuffU0AMw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模拟缺口Nexus 5X(肖像)</p></figure><p id="08f8" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">由于手机显示屏顶部中心的凹口，状态栏的尺寸会变得更大。因此，凹槽任何一部分的区域都没有被应用程序的窗口使用，使应用程序感觉不那么身临其境。</p><p id="101c" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">此外，当我们将应用程序全屏显示时，凹槽两侧的区域会变黑，并再次闲置。这叫<em class="og">信箱</em>，很浪费屏幕面积。</p><p id="8f5f" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这是默认行为，对开发人员和用户来说都是不可取的。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="4299" class="mq mr iq bd ms mt mu mv mw mx my mz na jw nb jx nc jz nd ka ne kc nf kd ng nh bi translated">解决方案</h1><p id="59ea" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">幸运的是，Android Pie 9.0中的API提供了一个简单的修复方法。</p><h2 id="3c21" class="oh mr iq bd ms oi oj dn mw ok ol dp na li om on nc lm oo op ne lq oq or ng os bi translated">第一步</h2><p id="d4f9" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">在你的<code class="fe ot ou ov ow b">res</code>目录下创建一个新的<code class="fe ot ou ov ow b">values-v28</code>文件夹，并将默认的<code class="fe ot ou ov ow b">styles.xml</code>文件复制到其中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/41e65620bf533866fc577e8459ae2cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*Uey4praiOkzSI8QKQffjNA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将styles.xml从值复制到值-v28</p></figure><h2 id="bbad" class="oh mr iq bd ms oi oj dn mw ok ol dp na li om on nc lm oo op ne lq oq or ng os bi translated">第二步</h2><p id="3108" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">在<code class="fe ot ou ov ow b">styles.xml</code>文件的<code class="fe ot ou ov ow b">values-v28</code>变体中，转到您的活动主题，或者创建一个新的主题(如果您一直在使用默认的主题),并设置该属性:</p><pre class="kg kh ki kj gt oy ow oz pa aw pb bi"><span id="4cae" class="oh mr iq ow b gy pc pd l pe pf">&lt;style name="ActivityTheme"&gt;<br/>  &lt;item name="android:windowLayoutInDisplayCutoutMode"&gt;<br/>    shortEdges<br/>  &lt;/item&gt;<br/>&lt;/style&gt;</span></pre><p id="f8a7" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">然后，瞧！这就是你要在你的应用程序中获得更身临其境的体验，并通过让应用程序的窗口呈现在凹槽的侧边区域来避免信箱区的所有工作。</p><p id="379b" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">结果如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/38e0d8b7918ab9af8540a60fa04b0ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/1*yTZQDMcbegWLoeVPGC6DJg.gif"/></div></figure></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="d2e8" class="mq mr iq bd ms mt mu mv mw mx my mz na jw nb jx nc jz nd ka ne kc nf kd ng nh bi translated">关于显示器剪切行为的更多信息</h1><p id="c83d" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">注意，<code class="fe ot ou ov ow b">windowLayoutInDisplayCutoutMode</code>可以有三个可能的值:</p><ul class=""><li id="61f0" class="lv lw iq lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe ot ou ov ow b">default</code>(或<code class="fe ot ou ov ow b">LAYOUT_IN_DISPLAY_CUTOUT_MODE_DEFAULT</code>)</li><li id="85b9" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ot ou ov ow b">shortEdges</code>(或<code class="fe ot ou ov ow b">LAYOUT_IN_DISPLAY_CUTOUT_MODE_SHORT_EDGES</code>)</li><li id="f0e7" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ot ou ov ow b">never</code>(或<code class="fe ot ou ov ow b">LAYOUT_IN_DISPLAY_CUTOUT_MODE_NEVER</code>)</li></ul><p id="8679" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><code class="fe ot ou ov ow b">default</code>值是默认选择的(很明显),我们已经看到了上面的演示。它:</p><ul class=""><li id="8e8a" class="lv lw iq lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使状态栏调整到槽口的高度。</li><li id="967d" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在纵向和横向模式下都产生信箱模式。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/fc044a0621a13b3fe835aca80c060aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/1*sWnEvn58lUphHbuffU0AMw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">默认模式</p></figure><p id="1cb7" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><code class="fe ot ou ov ow b">shortEdges</code>值使你的应用程序的窗口绘制在凹口的任一侧，使应用程序在全屏下更加身临其境。</p><p id="6e6b" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">它忽略了无法使用的凹口区域。不浪费屏幕空间！这在横向和纵向上都很完美。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/38e0d8b7918ab9af8540a60fa04b0ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/1*yTZQDMcbegWLoeVPGC6DJg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">短边模式</p></figure><p id="61a8" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><code class="fe ot ou ov ow b">never</code>值确保应用程序的窗口总是绘制在凹口下方，无论是在横向还是纵向模式下，都会受到信箱效应的影响，并完全遮住凹口两侧的区域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/51cfca681dd103dba87b9021f1f328b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/1*mNo02P5GqnyaIQFBB9SO-Q.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">永不模式</p></figure><p id="288f" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">如果您想在剪切区域中绘制元素，您可以使用由<code class="fe ot ou ov ow b"><a class="ae kv" href="https://developer.android.com/reference/android/view/WindowInsets" rel="noopener ugc nofollow" target="_blank">WindowInsets</a></code>类提供的<code class="fe ot ou ov ow b"><a class="ae kv" href="https://developer.android.com/reference/android/view/WindowInsets#getDisplayCutout()" rel="noopener ugc nofollow" target="_blank">getDisplayCutout()</a></code>。这让您可以检查应用程序窗口内的内容是否与显示器上的凹口重叠，如果重叠，您可以根据需要重新定位元素。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="429a" class="mq mr iq bd ms mt mu mv mw mx my mz na jw nb jx nc jz nd ka ne kc nf kd ng nh bi translated">如果我的设备没有凹槽，我该如何测试？</h1><p id="1f83" class="pw-post-body-paragraph kz la iq lb b lc ni jr le lf nj ju lh li nk lk ll lm nl lo lp lq nm ls lt lu ij bi translated">你只能在运行Android Pie 9.0的设备上测试你的notch友好应用。因此，如果你没有使用Pixel系列的手机，我建议你使用Android模拟器。</p><p id="79ac" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">启用手机上的<em class="og">开发者选项</em>并点击<em class="og">模拟一个带有剪切块的显示器</em>从四个选项中进行选择:</p><ul class=""><li id="2329" class="lv lw iq lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">没有。</li><li id="53c5" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">角落显示剪切块—模拟屏幕右上角的剪切块。</li><li id="5cbe" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">双显示剪切-这模拟两个剪切；一个在屏幕的顶部中心，另一个在屏幕的底部中心。</li><li id="98e9" class="lv lw iq lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">高显示剪切块<strong class="lb ir"> </strong> —模拟屏幕顶部中央的剪切块。</li></ul><p id="2bd5" class="pw-post-body-paragraph kz la iq lb b lc ld jr le lf lg ju lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我鼓励你利用Android Pie支持的友好的API，开始让你的应用程序更加友好。这就是这篇文章，感谢阅读！</p></div></div>    
</body>
</html>