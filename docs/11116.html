<html>
<head>
<title>NestJS with TypeORM and Postgres</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有TypeORM和Postgres的NestJS</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/nest-js-project-with-typeorm-and-postgres-ce6b5afac3be?source=collection_archive---------0-----------------------#2022-02-19">https://betterprogramming.pub/nest-js-project-with-typeorm-and-postgres-ce6b5afac3be?source=collection_archive---------0-----------------------#2022-02-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1fe4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用NestJS &amp; TypeORM创建可伸缩的应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d6c58b8d3dbca56fa73d682937207ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpKS64E5GU6jv8gBb1pEkQ.png"/></div></div></figure><p id="6b96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在今天的文章中，出于简单的原因，我想开发一个基于NestJS、TypeORM和Postgres的小项目，而不使用Docker。</p><p id="7ac7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，我已经在<a class="ae lq" href="https://github.com/hellokvn/medium-nest-typeorm-postgres-sample" rel="noopener ugc nofollow" target="_blank"> Github </a>上部署了这个项目。现在，我们开始吧！</p><h1 id="9c5e" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">先决条件</h1><p id="f1f3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">需要对Node.js、TypeScript和PostgreSQL有一个基本的了解，它们已经安装在您的机器上。我会选择<a class="ae lq" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>作为我的代码编辑器。你可以用你喜欢的任何东西。</p><h1 id="b664" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">我们开始吧</h1><p id="8cc5" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首先，我们需要创建PostgreSQL数据库。我知道，每个人都有不同的处理方式，有些人使用GUI，但我们将使用我们的终端。同样，您需要在您的机器上安装PostgreSQL。如果您安装了PostgreSQL，以下四个命令将在Linux、Mac和Windows机器上运行。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="1f80" class="mt ls it mp b gy mu mv l mw mx">$ psql postgres<br/>$ CREATE DATABASE nest_api;<br/>$ \l<br/>$ \q</span></pre><ul class=""><li id="c0cd" class="my mz it kw b kx ky la lb ld na lh nb ll nc lp nd ne nf ng bi translated">使用用户<code class="fe nh ni nj mp b">postgres</code>打开<code class="fe nh ni nj mp b">psql</code> CLI</li><li id="fa8e" class="my mz it kw b kx nk la nl ld nm lh nn ll no lp nd ne nf ng bi translated"><code class="fe nh ni nj mp b">CREATE DATABASE nest_api;</code>创建我们需要的数据库</li><li id="2c9d" class="my mz it kw b kx nk la nl ld nm lh nn ll no lp nd ne nf ng bi translated"><code class="fe nh ni nj mp b">\l</code>列出所有数据库</li><li id="cbe2" class="my mz it kw b kx nk la nl ld nm lh nn ll no lp nd ne nf ng bi translated">CLI退出</li></ul><p id="ad65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们成功地执行了所有四个命令之后，我的终端看起来应该是这样的。正如我们所见，数据库<code class="fe nh ni nj mp b">nest_api</code>被创建了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/7682edacf34b04d92c9527835d0215eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skSnkie4a6N3gfJJa1PkGQ.png"/></div></div></figure><h1 id="e553" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">NestJS应用程序</h1><p id="a293" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">还是继续NestJS吧！我们将安装NestJS CLI，因此打开您选择的终端并键入:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="e4bc" class="mt ls it mp b gy mu mv l mw mx">$ npm i -g @nestjs/cli</span></pre><p id="89bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们用它的CLI初始化一个新的NestJS项目。这可能需要一分钟。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="dede" class="mt ls it mp b gy mu mv l mw mx">$ nest new nest-postgres -p npm</span></pre><p id="653a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成该命令后，您可以在代码编辑器中打开您的项目。由于我使用Visual Studio代码，我将通过键入以下命令打开项目:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="a330" class="mt ls it mp b gy mu mv l mw mx">$ cd nest-postgres<br/>$ code .</span></pre><p id="4ae9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的项目在VSCode (Visual Studio代码)中是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/1e3127acc62b6096ed0079290cd3c94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZaWseE4B-EuX9vckVT7XXg.png"/></div></div></figure><p id="910e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下一步是可选的，但通常我会提交初始初始化，所以我要键入:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="58f9" class="mt ls it mp b gy mu mv l mw mx">$ git add .<br/>$ git commit -m "chore(): init nestjs"</span></pre><p id="2c5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们安装一些我们需要的依赖项。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="4fab" class="mt ls it mp b gy mu mv l mw mx">$ npm i @nestjs/config @nestjs/typeorm typeorm pg class-validator class-transformer<br/>$ npm i -D @types/node</span></pre><p id="830c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们开始编码。为了有一个清晰的项目结构，我们将创建一些文件夹。对于诸如环境文件或一般帮助文件之类的杂项文件，我通常会创建一个名为common的新文件夹。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="8870" class="mt ls it mp b gy mu mv l mw mx">$ mkdir src/shared &amp;&amp; mkdir src/shared/typeorm<br/>$ mkdir src/common &amp;&amp; mkdir src/common/envs &amp;&amp; mkdir src/common/helper</span></pre><p id="a7ec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，让我们创建一些文件。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="7769" class="mt ls it mp b gy mu mv l mw mx">$ touch src/shared/typeorm/typeorm.service.ts<br/>$ touch src/common/envs/.env<br/>$ touch src/common/envs/development.env<br/>$ touch src/common/helper/env.helper.ts</span></pre><p id="ed43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的项目树现在应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/ca2f356e4884d3a19206d0aa2955a799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nGQ9HJLnAMYAAkgX6VI-ow.png"/></div></div></figure><p id="931e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了将环境文件放在我们的<code class="fe nh ni nj mp b">dist/</code>文件夹中，我们需要向我们的<code class="fe nh ni nj mp b">nest-cli.json</code>添加一个编译器规则。</p><p id="ac19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以请将<code class="fe nh ni nj mp b">nest-cli.json</code>从</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">nest-cli.json</p></figure><p id="e31d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">nest-cli.json</p></figure><p id="090e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们修改我们的<code class="fe nh ni nj mp b">src/common/helper/env.helper.ts</code>文件，以便在稍后导入我们的ConfigModule时加载我们的环境文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/common/helper/env . helper . ts</p></figure><p id="56c9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个函数根据我们的<code class="fe nh ni nj mp b">NODE_ENV</code>返回环境文件的绝对路径。它基本上有两个回落。首先，如果没有设置<code class="fe nh ni nj mp b">NODE_ENV</code>，我们尝试获取<code class="fe nh ni nj mp b">development.env</code>文件的绝对路径，如果该文件不存在，它将返回<code class="fe nh ni nj mp b">.env</code>文件的绝对路径。</p><p id="070f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们继续给我们的环境文件添加一些生命。您可以在每个代码片段下面看到文件路径。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/comon/envs/。包封/包围（动词envelop的简写）</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/comon/envs/development.env</p></figure><blockquote class="nx ny nz"><p id="9da9" class="ku kv oa kw b kx ky ju kz la lb jx lc ob le lf lg oc li lj lk od lm ln lo lp im bi translated"><strong class="kw iu"> <em class="it">注意:</em> </strong> <em class="it">通常，出于安全原因，您不会将任何环境文件推送到您的Git存储库，除了一个示例。env文件，它向其他贡献者显示我们的环境文件的结构。这就是为什么我创建了一个. env文件。</em></p></blockquote><p id="c033" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们创建了环境文件和助手文件。现在我们可以在实际代码中实现它们。为此，我们需要添加我们在项目开始时安装的ConfigModule。</p><p id="bd3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/app.module.ts</code>从:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/app.module.ts</p></figure><p id="ce13" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/app.module.ts</p></figure><blockquote class="nx ny nz"><p id="750a" class="ku kv oa kw b kx ky ju kz la lb jx lc ob le lf lg oc li lj lk od lm ln lo lp im bi translated"><strong class="kw iu"> <em class="it">注意:</em> </strong> <em class="it">我们全局添加了</em> <code class="fe nh ni nj mp b"><em class="it">ConfigModule</em></code> <em class="it">。这意味着我们不必在每次需要访问</em> <code class="fe nh ni nj mp b"><em class="it">ConfigService</em></code> <em class="it">时都导入它。</em></p></blockquote><p id="9296" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nh ni nj mp b">ConfigModule</code>现在和环境文件都搞定了。让我们继续我们的TypeORM集成。记住，我们在<code class="fe nh ni nj mp b">src/shared/typeorm/</code>内部创建了一个名为<code class="fe nh ni nj mp b">typeorm.service.ts</code>的文件，让我们添加一些内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/shared/type ORM/type ORM . service . ts</p></figure><blockquote class="nx ny nz"><p id="41ef" class="ku kv oa kw b kx ky ju kz la lb jx lc ob le lf lg oc li lj lk od lm ln lo lp im bi translated"><em class="it">警告:如果属性synchronize为真，TypeORM将自动更新实体的任何更改。这是你永远不应该在生产中使用的东西！</em></p></blockquote><p id="5b96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里发生的是，我们注入我们的<code class="fe nh ni nj mp b">ConfigService</code>，然后基于那个<code class="fe nh ni nj mp b">ConfigService</code>，我们从我们的环境变量中提取数据库信息。</p><p id="3029" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们再次修改我们的<code class="fe nh ni nj mp b">src/app.module.ts</code>文件，将<code class="fe nh ni nj mp b">TypeOrmModule</code>和我们刚刚创建的<code class="fe nh ni nj mp b">typeorm.service.ts</code>文件添加在一起。</p><p id="a8c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/app.module.ts</code>从:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/app.module.ts</p></figure><p id="7e40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/app.module.ts</p></figure><p id="45c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们将简要修改我们的<code class="fe nh ni nj mp b">src/main.ts</code>文件。我们要做的是，在我们的引导函数中获取<code class="fe nh ni nj mp b">ConfigService</code>，在这里我们从活动环境文件中获取<code class="fe nh ni nj mp b">PORT</code>和<code class="fe nh ni nj mp b">BASE_URL</code>信息。此外，我们添加了一个<a class="ae lq" href="https://docs.nestjs.com/pipes#global-scoped-pipes" rel="noopener ugc nofollow" target="_blank">全局管道</a>来进行更好的验证。</p><p id="d8bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/main.ts</code>从:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="17b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="7385" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们应该能够毫无问题地运行我们的NestJS应用程序了。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="8cca" class="mt ls it mp b gy mu mv l mw mx">$ npm run start:dev</span></pre><p id="0af5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们控制台内部的输出应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/c82517d53ac183a6a4f8ea0cc40e820c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ryrKBExwDmfebJA0R751nQ.png"/></div></div></figure><blockquote class="nx ny nz"><p id="f156" class="ku kv oa kw b kx ky ju kz la lb jx lc ob le lf lg oc li lj lk od lm ln lo lp im bi translated"><strong class="kw iu"> <em class="it">注意:</em> </strong> <em class="it">如果遇到这个错误:</em>“无法连接数据库。”<em class="it">那么你的数据库信息是错误的。</em></p></blockquote><p id="d7b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在一切都正常了。让我们继续创建一个简单的用户模块和用户实体来演示我们如何在模块内部与TypeOR交互。</p><p id="a297" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了创建一个新模块，我们将再次使用NestJS的CLI。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="ce81" class="mt ls it mp b gy mu mv l mw mx"><em class="oa">$ nest g mo api<br/>$ nest g mo api/user &amp;&amp; nest g co api/user </em>--no-spec <em class="oa">&amp;&amp; nest g s api/user </em>--no-spec<br/>$ touch src/api/user/user.entity.ts<br/>$ touch src/api/user/user.dto.ts</span></pre><p id="a767" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的项目树现在应该看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/0cc80f27f00ab6b0eb465500d1d7ffad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEchEVbGKigFOqMNSzQX8A.png"/></div></div></figure><p id="4f03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们得到了<strong class="kw iu">用户模块</strong>，加上它的<strong class="kw iu">控制器</strong>、<strong class="kw iu">服务</strong>、<strong class="kw iu">实体</strong>，以及<strong class="kw iu"> DTO </strong>。让我们用内容填充它们，从<code class="fe nh ni nj mp b">src/api/user/user.entity.ts</code>文件开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/api/user/user.entity.ts</p></figure><blockquote class="nx ny nz"><p id="5bcd" class="ku kv oa kw b kx ky ju kz la lb jx lc ob le lf lg oc li lj lk od lm ln lo lp im bi translated"><strong class="kw iu"> <em class="it">注意:</em> </strong> <em class="it">如果您的</em> NestJS <em class="it">应用程序正在运行，TypeORM会在我们的数据库</em><strong class="kw iu"><em class="it">nest _ API</em></strong><em class="it">中创建一个名为user的新表，因为我们在我们的</em> <code class="fe nh ni nj mp b">src/shared/typeorm/typeorm.service.ts</code> <em class="it">配置文件中启用了synchronize属性。</em></p></blockquote><p id="1419" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们将向<code class="fe nh ni nj mp b">src/api/user/user.dto.ts</code>文件添加一些内容，以便稍后验证我们的POST请求。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/api/user/user.dto.ts</p></figure><p id="1906" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们需要在用户模块中提供我们的用户实体。</p><p id="dad5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/api/user/user.module.ts</code>从</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/API/用户/用户.模块. ts</p></figure><p id="0dbf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/API/用户/用户.模块. ts</p></figure><p id="ea29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们能够使用我们的用户实体。让我们将这个实体注入到我们的<code class="fe nh ni nj mp b">user.service.ts</code>文件中，同时添加两个方法来创建和获取用户。</p><p id="cedf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/api/user/user.service.ts</code>从</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/api/user/user.service.ts</p></figure><p id="813d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/api/user/user.service.ts</p></figure><p id="a57e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通常，我们可以检查用户是否已经存在，但是为了简单起见，我们今天将跳过这一步。让我们继续在用户控制器中使用这些方法。</p><p id="bd79" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请将<code class="fe nh ni nj mp b">src/api/user/user.controller.ts</code>从</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/API/user/user . controller . ts</p></figure><p id="9dda" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">src/API/user/user . controller . ts</p></figure><p id="11cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">实际上就是这样，我们已经完成了代码实现本身。如果您还没有运行我们的NestJS应用程序，让我们通过使用以下命令来实现:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="7376" class="mt ls it mp b gy mu mv l mw mx">$ npm run start:dev</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/a7b41d544006d5d40b8af49470098ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ToOqYfVPK0VeDT7SPNQJQg.png"/></div></div></figure><p id="9331" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们可以测试我们刚刚创建的两条路线。我们可以通过使用软件如<a class="ae lq" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">邮递员</a>来测试它，或者我们简单地运行CURL命令。</p><p id="3c53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">创建新用户</strong></p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="290b" class="mt ls it mp b gy mu mv l mw mx">$ curl -X POST http://localhost:3000/user -H "Content-Type: application/json" -d '{"name": "Elon Musk", "email": "elon@gmail.com"}'</span><span id="4b55" class="mt ls it mp b gy oh mv l mw mx"><strong class="mp iu">Server Response:</strong></span><span id="a553" class="mt ls it mp b gy oh mv l mw mx">{"name":"Elon Musk","email":"elon@gmail.com","id":1,"isDeleted":false,"createdAt":"2022-02-18T14:12:13.672Z","updatedAt":"2022-02-18T14:12:13.672Z"}</span></pre><p id="02a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们成功创建了一个新用户。现在，我们可以在浏览器中根据用户的身份提取用户信息。</p><p id="790a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">URL:<a class="ae lq" href="http://localhost:3000/user/1" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/user/1</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/718fe0fd52a9cf621b6109c85deb09f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wA-Tk_gsHp_UB8c368XY-A.png"/></div></div></figure><p id="bcb6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">别忘了，我已经在<a class="ae lq" href="https://github.com/hellokvn/medium-nest-typeorm-postgres-sample" rel="noopener ugc nofollow" target="_blank"> Github </a>上传了这个项目。</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="ce53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">想加入NestJS吗？观看NestJS创建者<a class="oq or ep" href="https://medium.com/u/f7cc8266ff67?source=post_page-----ce6b5afac3be--------------------------------" rel="noopener" target="_blank"> Kamil Mysliwiec </a>关于NestJS的演讲。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ns l"/></div></figure></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="77d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读我关于NestJS的文章。我希望，我能告诉你如何从TypeORM和PostgreSQL开始。</p><p id="a9ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">干杯！</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="06c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你喜欢读这个。如果你想支持我成为一名作家，考虑注册<a class="ae lq" href="https://medium.com/@hellokevinvogel/membership" rel="noopener">成为</a>中人。每月仅需5美元，您即可无限制地使用Medium。</p><p id="4cc3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">想支持我吗？<a class="ae lq" href="https://www.buymeacoffee.com/hellokevinvogel" rel="noopener ugc nofollow" target="_blank">请我喝杯咖啡。</a></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><h1 id="f39b" class="lr ls it bd lt lu ot lw lx ly ou ma mb jz ov ka md kc ow kd mf kf ox kg mh mi bi translated">阅读下一页</h1><div class="oy oz gp gr pa pb"><a href="https://blog.bitsrc.io/solid-principles-in-typescript-153e6923ffdb" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">打字稿中的坚实原则</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">TypeScript对用JavaScript编写干净的代码有着巨大的影响。但是总有办法…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">blog.bitsrc.io</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a href="https://blog.bitsrc.io/10-quick-typescript-one-liners-128a2721345" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">10种快速打字稿单行</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">能够提高工作效率的JavaScript / TypeScript一行程序</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">blog.bitsrc.io</p></div></div><div class="pk l"><div class="pq l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a href="https://blog.bitsrc.io/how-to-enable-cors-in-nest-js-90c1b6316289" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">如何在NestJS中启用CORS(2022年)</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">如何在NestJS中启用CORS的简要指南</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">blog.bitsrc.io</p></div></div><div class="pk l"><div class="pr l pm pn po pk pp ks pb"/></div></div></a></div></div></div>    
</body>
</html>