<html>
<head>
<title>Building a Restful API With ASP.NET, Web API, and SQL Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ASP.NET、Web API和SQL Server构建Restful API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-restful-api-with-asp-net-web-api-and-sql-server-ce7873d5b331?source=collection_archive---------0-----------------------#2018-11-06">https://betterprogramming.pub/building-a-restful-api-with-asp-net-web-api-and-sql-server-ce7873d5b331?source=collection_archive---------0-----------------------#2018-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f726" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用实体框架构建ASP.NET Web API并从SQL server中检索数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9d2a0dd0da37b9d0ed1cf47e3a9d7c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8I_9FmcbGjqT-cAZ9NTDQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿诺·弗朗西斯卡在<a class="ae ky" href="https://unsplash.com/@clark_fransa" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b9bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将演示如何使用实体框架构建ASP.NET Web API，并从SQL server中检索数据。</p><p id="e3ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我用的是Visual Studio 2017和Management Studio。这些是我们需要遵循的步骤:</p><ol class=""><li id="79c2" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#3a73" rel="noopener ugc nofollow">创建一个空白的Web API项目。</a></li><li id="716e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#b458" rel="noopener ugc nofollow">在模板选择窗口中选择Web API。</a></li><li id="0638" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#15ab" rel="noopener ugc nofollow">创建表格并将数据插入数据库表格。</a></li><li id="b3c9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#410c" rel="noopener ugc nofollow">添加一个web服务。</a></li><li id="0265" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#4cd6" rel="noopener ugc nofollow">添加一个ADO.NET实体数据模型。</a></li><li id="1d3e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#62d3" rel="noopener ugc nofollow">创建与SQL server的新连接。</a></li><li id="2871" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#9c76" rel="noopener ugc nofollow">从数据库生成实体。</a></li><li id="46af" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#9339" rel="noopener ugc nofollow">添加控制器。</a></li><li id="9f73" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">运行项目。</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3a73" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">创建一个空白的Web API项目</strong></h1><p id="258f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在这里，我将创建一个新项目。为此，我将遵循以下步骤:</p><p id="7624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文件→新建→项目，选择“ASP。NET Web应用程序(。NET Framework)”项目，如图<a class="ae ky" href="#9fe9" rel="noopener ugc nofollow">图1 </a>所示。</p><p id="65fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将我们的项目命名为“<strong class="lb iu">学生服务</strong>”，然后单击“确定”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/7e26b27137af9c5206383882fe8c6428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fr1f8cKl_WtoHAET-iElPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:新ASP.NET网络应用程序</p></figure><p id="b023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您将看到一个包含一些模板的窗口。创建API时，我们可以从这些模板中进行选择。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="b458" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">在模板选择窗口中选择Web API</h1><p id="8eb0" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在模板选择窗口中选择“<strong class="lb iu"> Web API </strong>”，如图<a class="ae ky" href="#c3e7" rel="noopener ugc nofollow">图2 </a>所示。确保认证设置为“<strong class="lb iu">无认证。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/479d12fa8351097cda18b02e28fca4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*fAk-u99IN-BeXirOHc3Vog.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2: Web API模板</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="15ab" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建一个表并将数据插入数据库表</h1><p id="bdd2" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们创建一个名为"<strong class="lb iu"> StudentDetails，</strong>"的数据库，并将我们的表命名为"<strong class="lb iu"> Student。</strong></p><p id="c087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们回到我们的Visual Studio项目。如您所见，我们已经成功创建了空的Web API项目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/3dddf0af87dff33ccab0788a0465463e.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*meC0Q8xksgrd_b-NfeHibA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3: Web API项目</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="410c" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">添加Web服务</strong></h1><p id="179b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">现在，我们将创建一个web服务，它将包含从SQL SERVER检索数据的ADO.NET实体数据模型。</p><p id="fe45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们添加一个新项目。为此，右键单击解决方案→添加→新项目。</p><p id="8d0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择类库(。NET标准)，我们姑且将其命名为“<strong class="lb iu"> StudentDataAccess。</strong></p><p id="7b7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">删除class1.cs文件，因为我们不需要这个自动生成的类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/757b021fbbfba3f02ee423c1d2af53a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*snIBOGJPBn0eH6rqpFApDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4: StudentDataAccess项目</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="4cd6" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">添加一个ADO.NET实体数据模型</strong></h1><p id="00aa" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">正如我之前提到的，我们必须创建一个包含实体数据模型的web服务。所以现在我们要给“<strong class="lb iu">StudentDataAccess”</strong>项目添加一个ADO.NET实体数据模型。</p><p id="47aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nr">注意:</em> </strong> <em class="nr">我去给“</em><strong class="lb iu"><em class="nr">【StudentDataAccess】</em></strong><em class="nr">项目添加一个ADO.NET实体数据模型的时候，ADO.NET数据模型不见了。</em></p><p id="6110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nr">我是这样克服这个问题的:工具→获取工具和功能→选择单个组件选项卡。请确保您选择了SQL Server数据工具、实体框架6工具组件。然后，修改改动，推出VS 2017。</em></p><p id="9faa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nr">如果选择类库(。NET Standard)模板。请确保选择类库(。NET Framework)模板。</em></p><p id="8be0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们添加ADO.NET数据实体模型。</p><p id="536a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">右键单击“StudentDataAcess”项目→添加→新建项目→ADO.NET实体数据模型。<strong class="lb iu"> </strong>将其命名为<strong class="lb iu">“studentdata model。”</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/1dcfb38bdbcfaab007b0435581dc90f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iCCj_ZF6ynYu3ocTndGSFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:ADO.NET实体数据模型</p></figure><p id="f83c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，将出现下面的屏幕。因此，我们将选择第一个选项，即“来自数据库的EF Designer”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0b745884812d9c460e3b7785f74f206c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*cGnwvdDpkS6qsrD0nKdA3A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:数据库中的EF设计器</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="47da" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建与SQL Server的新连接</h1><p id="edf7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">现在，我们将创建一个与SQL server的新连接，并将它引用到我们的数据库。</p><p id="c9dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单击“新建连接”按钮，选择“Microsoft SQL Server”作为数据源。然后，单击继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b8d8967c52332085d6638eaf90bf7725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*UDX8hCACObEfCQvsWbcfYQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:创建一个新的连接。</p></figure><p id="72e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您将看到一个连接属性窗口。</p><p id="b101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，选择您的服务器名称、正确的身份验证(Windows/SQL Server)以及检索数据所需的正确数据库。比如，“<strong class="lb iu"> StudentDetails。</strong>”</p><p id="beb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用“测试连接”按钮测试连接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f26f7b785ce9eddce716d6ab4996a921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*ynMOruj4sjDCuDY8raFCbA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:连接属性</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9c76" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">从数据库生成实体</strong></h1><p id="0ee7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">这里，实体框架将在“<strong class="lb iu">StudentDataAcess”</strong>类库项目的APP.config文件中看到一个名为“<strong class="lb iu"> StudentDetailsEntities </strong>的连接字符串。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/1fb7c66b1765629922eb9577c632ba9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*umjvICsocxfPXGOMJLfNWQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:学生详细信息</p></figure><p id="d610" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保在实体数据模型向导中选择了正确的数据库对象和设置。该模型将被创建为<strong class="lb iu">“StudentDetailsModel”</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/267fe866017ecf9490c3e76de3132ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*72Vk4qJX6E1ygdwz2Izgyw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10:选择正确的数据库对象和设置。</p></figure><p id="5cfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您可以看到"<strong class="lb iu"> StudentDetailsModel" </strong>已经成功创建。点击文件<strong class="lb iu">studentdetailsmodel . edmx .</strong>然后，你会看到学生实体及其属性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/df0c13770db838d3ac386f8a811b8194.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*N5h-6OX6kXMrebnf59h7ww.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11: StudentDetailsModel.edmx文件</p></figure><p id="efe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在App.config文件中看到连接字符串。这里的连接字符串是“<strong class="lb iu"> StudentDetailsEntities，</strong>”，它包含了“<strong class="lb iu">学生</strong>”表。</p><p id="a29c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须在我们的Web API项目中使用这个类库。</p><p id="390a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">右键单击<strong class="lb iu">学生服务项目中的引用。</strong></p><p id="9eea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，你会看到“<strong class="lb iu"> StudentDataAccess </strong>”类库项目。(在将StudentDataAcess项目作为对StudentServices项目的引用添加之前，先构建该项目。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/33db9b322b2d1143387b967c32849c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DpaYaUDmhq917oYxDqFD2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12:添加StudentDataAccess类库作为引用。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/82a7234a7f4b2ba53c0105c2cd9844c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*TddPdVnPWHjvFDkVFGLN-g.png"/></div></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9339" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">添加控制器</strong></h1><p id="e054" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">下一步是向我们的Web API项目添加一个控制器。因此，右键单击控制器文件夹，然后单击添加控制器。</p><p id="1269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于MVC和Web API控制器，您将获得不同的模板选项。让我们选择“Web API 2控制器—空”模板。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/cb7ca139f7dcad59bb2fd5edcfa4dec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrSOztsE3zyQwmfeA_VIDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图13:选择Web API 2控制器-空模板。</p></figure><p id="d499" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将控制器命名为"<strong class="lb iu"> StudentController。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/be6036b3c91a91edaed00ef358b33299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*GPuNRpyA-w5KaI4HZmdtoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图14:学生控制器。</p></figure><p id="fecd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经成功地创建了控制器，我们将添加一个命名空间StudentDataAccess作为我们的类库名称“StudentDataAccess”现在，在我们的控制器类中，我们将添加一个GET方法来响应GET HTTP动词。这将返回<a class="ae ky" href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.ienumerable-1?view=netframework-4.7.2" rel="noopener ugc nofollow" target="_blank"> IEnumerable对象</a>。</p><p id="38b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">双击文件Student.cs，然后您将看到与我们的Student选项卡中的列相对应的属性；e.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/27fdd1fad944c64f1e9882f6d54d5b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*LWMLDVE5p6BkEbW5Apnptw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图15: Student.cs</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5684" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">编写响应HTTP GET谓词的GET方法</h1><p id="1c2a" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">所以下一步，我们需要创建DbContext类的一个实例。可以看到StudentDataModel.context.cs文件。StudentDetailsEntities继承自DbContext类。</p><p id="aa52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是StudentDetailsEntities类，它为我们管理数据库和检索实体。因此，在我们的控制器类中，让我们使用StudentDetailsEntities。它将返回学生列表，如下所示:</p><ol class=""><li id="c735" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">退回所有员工。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c54f32be53716562fbddef8047606bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*vzWeLSGxoGbdhWeVprSeoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图16:学生控制器. cs控制器</p></figure><p id="6532" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.按ID返回特定的雇员</p><p id="7fe3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将这一行添加到控制器类中。这里，我们将返回类型更改为“Student ”,因为我们想要返回那个学生。我在每个学生ID中都使用了lambda表达式。该ID等于我们在GET参数中使用的ID。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/d20255b6c3cea5f92ddb9aa5128178c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*X5wD3o5EZ-83fAeDu_4aCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图17:从ID返回一个雇员</p></figure><p id="cc19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经完成了所有的实现，让我们试着构建并运行我们的项目。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="4886" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">运行项目</strong></h1><p id="4f7d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">现在，构建解决方案并运行应用程序。</p><p id="c383" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将得到如下错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/63c3d0d9d1b953784ba894a861b67d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6fdsWLkM7VSMv3fc1-9ZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图18:在配置文件中没有找到名为StudentDetailsEntities的连接字符串。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/87370a2b3468ce7e12d21e22873bc711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESwPJkCWcJMizYYGzYNt3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图19:错误</p></figure><p id="876f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你需要如何纠正这个问题。</p><p id="8076" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在App.config中有一个名为StudentDetailsEntities的连接字符串，但问题是StudentDetailsEntities在实体框架查找web.config时不在web.config中。</p><p id="644e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，从app.config文件中复制该连接字符串行，并粘贴到我们的web.config文件中。然后，重新加载应用程序。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="a550" class="ol mr it oh b gy om on l oo op">&lt;connectionStrings&gt;<br/>&lt;add name=”StudentDetailsEntities” connectionString="your connection string /&gt;<br/>&lt;/connectionStrings&gt;</span></pre><p id="9fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出将如下所示。</p><h2 id="22eb" class="ol mr it bd ms oq or dn mw os ot dp na li ou ov nc lm ow ox ne lq oy oz ng pa bi translated"><strong class="ak">显示所有学生</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/f68200915cad5f4fcb8621169f5765f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-nqJprRYKF-hqBrwpyP6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图20:学生详细信息(检索所有学生)。</p></figure><h2 id="b6a4" class="ol mr it bd ms oq or dn mw os ot dp na li ou ov nc lm ow ox ne lq oy oz ng pa bi translated"><strong class="ak">显示学生ID </strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/2283b70d3b352b9df6ebcece4fb07b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AV0YIsR7D1lXYAa1SMXLFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图21:检索学生的详细信息。</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="895f" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated"><strong class="ak">总结</strong></h1><p id="be35" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">现在，我们已经使用带有实体框架的ASP.NET Web API创建了restful API，并且我们已经从SQL server检索了数据。</p></div></div>    
</body>
</html>