<html>
<head>
<title>The Python ‘print()’ Function Is More Powerful Than You Think</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python的' print()'函数比您想象的更强大</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-python-print-function-is-more-powerful-than-you-think-db0afb358b79?source=collection_archive---------7-----------------------#2022-08-17">https://betterprogramming.pub/the-python-print-function-is-more-powerful-than-you-think-db0afb358b79?source=collection_archive---------7-----------------------#2022-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="987f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索分隔符、代码注入等等</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8515f74110bb5b43cefe18f614713167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N9D3VxErVcAufArb"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">埃斯特万·洛佩兹在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9509" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python编程语言非常适合初学者，这要归功于它简单的类似英语的语法和强大而直观的内置函数。您的第一行Python代码很可能是这样的:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="585a" class="ma mb it lw b gy mc md l me mf">print("Hello World")</span></pre><p id="2357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着您对这门语言越来越熟悉，您开始了解内置<code class="fe mg mh mi lw b">print()</code>函数的不同功能。作为Python开发人员，您获得的经验越多，您发现的边缘案例、技巧、奇特的语法和高级特性就越多。</p><p id="8b0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示<code class="fe mg mh mi lw b">print()</code>函数可以做什么，从它的基本功能开始，然后涵盖越来越多的高级用例以及有趣的技巧。</p><h1 id="b109" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">基本print()用法</h1><p id="29d4" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">使用<code class="fe mg mh mi lw b">print()</code>语句的最基本方式，也是最常见的方式是将一条消息(字符串或另一个对象)记录到控制台。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="18de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不出所料，控制台输出如下:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5d08" class="ma mb it lw b gy mc md l me mf">Hello World</span></pre><p id="c9c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们进入鲜为人知的功能。</p><h1 id="18e7" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">结束字符和分隔符</h1><p id="b1eb" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated"><code class="fe mg mh mi lw b">print()</code>函数还允许您用<code class="fe mg mh mi lw b">end</code>参数指定一个附加在字符串末尾的字符。例如，如果您想在主参数后打印序列<code class="fe mg mh mi lw b">"***"</code>，您可以这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="bd26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将输出以下文本(末尾没有换行符):</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2606" class="ma mb it lw b gy mc md l me mf">Hello World***</span></pre><p id="ed2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您希望从输出中排除换行符，以便在同一行上打印所有内容，您可以像这样设置<code class="fe mg mh mi lw b">end=''</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7095" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分隔符是Python <code class="fe mg mh mi lw b">print()</code>语句的另一个关键特性。首先，您可以使用同一个函数调用打印多个值，用逗号分隔它们:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="545f" class="ma mb it lw b gy mc md l me mf">Hello World</span></pre><p id="f93b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mg mh mi lw b">print()</code>函数隐式地设置它的参数<code class="fe mg mh mi lw b">sep=' '</code>，这样传递的参数在打印时用空格隔开。但是，您可以指定自己的字符串来分隔每个参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cb6d" class="ma mb it lw b gy mc md l me mf">Hello***World<br/>HelloWorld</span></pre><h2 id="5c68" class="ma mb it bd mk nh ni dn mo nj nk dp ms li nl nm mu lm nn no mw lq np nq my nr bi translated">自定义对象表示</h2><p id="2553" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在Python中打印复杂对象时，您通常会指定它们应该如何显示为字符串，而不是依赖默认的非描述行为:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0c5b" class="ma mb it lw b gy mc md l me mf">&lt;__main__.Entry object at 0x7fc3ddd5ffd0&gt;</span></pre><p id="ea29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，当你写一个类的时候，你可以覆盖<code class="fe mg mh mi lw b">__str__()</code>和<code class="fe mg mh mi lw b">__repr__()</code> <a class="ae ky" href="https://www.geeksforgeeks.org/dunder-magic-methods-python/" rel="noopener ugc nofollow" target="_blank"> dunder方法</a>，让Python知道它应该如何处理打印的对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a402" class="ma mb it lw b gy mc md l me mf">Entry: a=1</span></pre><p id="2e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我总是喜欢显式地设置<code class="fe mg mh mi lw b">__str__()</code>和<code class="fe mg mh mi lw b">__repr__()</code>，但是你不需要这样做。</p><h1 id="bb7d" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">使用print()写入文件</h1><p id="8118" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">你有没有想过<code class="fe mg mh mi lw b">print()</code>是如何知道在哪里输出给定的消息的？默认行为是将字符串写入<code class="fe mg mh mi lw b">sys.stdout</code>流，但是您可以用<code class="fe mg mh mi lw b">file</code>参数指定输出文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="d720" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码创建了一个名为“output.txt”的文件，并向其中写入了“Hello World”。这是可能的，因为<code class="fe mg mh mi lw b">print()</code>隐式地调用您传入的流的<code class="fe mg mh mi lw b">.write()</code>方法，所以这相当于</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f73b" class="ma mb it lw b gy mc md l me mf">f.write("Hello World\n")</span></pre><p id="ff8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这一点，您可以使用<code class="fe mg mh mi lw b">print()</code>函数创建一个初级记录器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="58b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，更好的办法是，您可以覆盖<code class="fe mg mh mi lw b">print()</code>函数，通过将每个打印语句记录到一个文件中来扩展它的功能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="aeb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种方法，您可以轻松地在文件中进行每个<code class="fe mg mh mi lw b">print()</code>调用，并自动将消息记录到文件中。然而，如果你喜欢那种东西，你最好使用<code class="fe mg mh mi lw b"><a class="ae ky" href="https://docs.python.org/3/library/logging.html" rel="noopener ugc nofollow" target="_blank">logging</a></code> <a class="ae ky" href="https://docs.python.org/3/library/logging.html" rel="noopener ugc nofollow" target="_blank">模块</a>。</p><h2 id="e2ec" class="ma mb it bd mk nh ni dn mo nj nk dp ms li nl nm mu lm nn no mw lq np nq my nr bi translated">通过打印到文件来执行代码</h2><p id="ffc2" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">如果您可以黑掉<code class="fe mg mh mi lw b">print()</code>函数，让它执行任意代码会怎么样？如果你还记得，我提到过<code class="fe mg mh mi lw b">print()</code>调用你传入的文件的<code class="fe mg mh mi lw b">.write()</code>方法。记住这一点，您可以用自己的代码覆盖或重写此方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0a1c" class="ma mb it lw b gy mc md l me mf">This is the payload.<br/>Payload function called with arguments: Hello World<br/>This is the payload.<br/>Payload function called with arguments</span></pre><p id="7778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您可以覆盖<code class="fe mg mh mi lw b">sys.stdout.write()</code>来触发任何默认<code class="fe mg mh mi lw b">print()</code>调用的有效负载函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0008" class="ma mb it lw b gy mc md l me mf">Executing payload<br/>Hello WorldExecuting payload</span></pre><p id="b7b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能已经注意到，Python调用了<code class="fe mg mh mi lw b">payload()</code>函数(因此也调用了<code class="fe mg mh mi lw b">.write()</code>方法)两次，所以您可能必须处理这个问题。</p><p id="d38d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种代码注入技术可能没有很多真实世界的用例，但是谁知道人们能想出什么呢？</p><h1 id="667f" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">第三方库代码注入</h1><p id="833b" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">虽然前面显示的代码注入不会造成任何伤害，但下一个示例可能会。如果您从事编程已经有一段时间了，那么您一定听说过使用第三方库会给您的源代码带来一些安全威胁。</p><p id="f87f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我将向您展示供应商如何包含由<code class="fe mg mh mi lw b">print()</code>函数触发的恶意代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="f57f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，你可以在你的程序中使用这个类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="280b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您可以在恶意模块中覆盖全局<code class="fe mg mh mi lw b">sys.stdout.write()</code>,这样每个<code class="fe mg mh mi lw b">print()</code>调用都会执行您的有效负载。</p><p id="9ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，你可能会说有人在看源代码时会立即注意到这些恶意的代码行。我有时会检查我自己使用的图书馆。将恶意代码隐藏在C扩展中怎么样？</p><p id="92c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与Python文件相比，Python开发人员不太可能从Python包中检查C源文件。另外，如果你在安装时在本地编译扩展，反病毒程序(如果你使用了的话)应该相信生成的二进制文件来自用户。或者说<a class="ae ky" href="https://en.wikipedia.org/wiki/Obfuscation_(software)" rel="noopener ugc nofollow" target="_blank">代码混淆</a>怎么样？</p><p id="0c40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">意识到软件开发人员有多脆弱是很有趣的。然后你得到一个反向的shell，用用户权限运行一个键盘记录器来获取admin/root密码，最后接管系统。</p><p id="a340" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然我不会具体展示如何实现这一点，但您可以看看这篇关于为Python编写C扩展的指南:</p><div class="ns nt gp gr nu nv"><a rel="noopener  ugc nofollow" target="_blank" href="/speed-up-your-python-codebases-with-c-extensions-94859875eb70"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">用C扩展加速你的Python代码库</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">给你的Python程序带来C语言的速度</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">better编程. pub</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><h1 id="cd57" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">结论</h1><p id="dd1d" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">总而言之，<code class="fe mg mh mi lw b">print()</code>函数比Python开发人员通常所知的功能多得多，从简单地打印到控制台，到写入文件，再到执行任意代码。毕竟，<code class="fe mg mh mi lw b">print()</code>功能只是一个工具，因此，你可以破解它来实现不同的目标。</p><blockquote class="ok"><p id="c53f" class="ol om it bd on oo op oq or os ot lu dk translated">画笔只是一根粘有刚毛的棍子。这取决于艺术家创造性地运用它。</p></blockquote><p id="cb40" class="pw-post-body-paragraph kz la it lb b lc ou ju le lf ov jx lh li ow lk ll lm ox lo lp lq oy ls lt lu im bi translated">我们能说一个拿着画笔的艺术家只是一个拿着棍子的黑客吗？</p><p id="c30b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。如果您知道任何其他关于<code class="fe mg mh mi lw b">print()</code>功能的实践或理论用例，请在评论中告诉我们。</p><p id="a642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="467c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想让你的Python代码更专业、更易维护，看看这个故事:</p><div class="ns nt gp gr nu nv"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-write-clearer-python-code-with-type-hints-330216291b7c"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">如何用类型提示编写更清晰的Python代码</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">通过使变量和函数更加自文档化来避免错误</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">better编程. pub</p></div></div><div class="oe l"><div class="oz l og oh oi oe oj ks nv"/></div></div></a></div></div></div>    
</body>
</html>