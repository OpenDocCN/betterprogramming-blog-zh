# 像写反应一样写 Vue

> 原文：<https://betterprogramming.pub/write-vue-like-you-write-react-545eafb60e6a>

## 在有状态组件中利用无状态解决方案

![](img/751ae86acda98f5b6239e2eee188f960.png)

使用 Vue 3 组合 API，您可以编写功能组件。也可以用 React，但是 React 有不同的模板:JSX。如果我们用 JSX 模板写 Vue 功能组件会怎么样？它们类似于反应功能组件吗？

让我们看看每个框架的功能组件是如何工作的，以及它们有多少相似/不同之处。我们将为此使用的组件是一个计数器，它对按钮上的点击进行计数。此外，它还接收一个限制参数—当达到该限制时，组件会通知其父组件。

我们将首先创建 React 组件，然后查看 Vue 的等效组件。

# 反应

React 需要一个普通的 JavaScript 函数返回一个 JSX 模板来创建一个组件。每当组件的状态改变时，该函数重新运行。您可以用`useState`方法创建这样的状态。状态变量是普通的 JavaScript 结构，在两次重新运行之间保存值。在状态变化之间，所有其他变量都会丢失。你可以在函数的顶部用一个`console.log`语句来测试它。

该组件有一个限制和一个可用于通知父组件的方法。每当当前值增加时，我们都要检查它。`useEffect`函数充当检查器，每当第二个参数中的依赖关系发生变化时，它就运行回调。

简而言之:React 组件是一个普通的函数，具有普通的 JavaScript 状态值，在每次状态改变时重新运行并返回 JSX。

# 某视频剪辑软件

Vue 中的普通函数等同于组件对象中的`setup`方法。`setup`方法也接收`props`作为输入参数，但是它返回一个返回 JSX 的函数，而不是 JSX。你可能想知道为什么…

原因是`setup`函数只运行一次，并且只有返回的函数在状态改变时运行。但是如果`setup`函数只运行一次，Vue 怎么检测变化呢？诀窍在于 Vue 的反应系统。`ref`函数将原始值包装在 JavaScript `Proxy`对象中。每个修改都通过这个代理运行，它通知 Vue 重新呈现那个组件。如果我们直接修改原始值，框架会忽略这个变化。

limit 和 notifier 函数作为函数参数出现，但是在 Vue 中我们没有使用析构。原因是`props`也是一个代理对象，如果我们析构它，我们就失去了它的反应性(如果它改变了，什么也不会发生)。为了检查值的变化，我们必须使用`useEffect`函数。与 React 相反，我们不必定义被监视的依赖项——Vue 会自动定义，因为它知道我们在回调中使用了哪些状态变量(`Proxies`)。

对于 Vue 开发人员来说，使用函数而不是事件来通知父节点可能并不常见。有人说这是 Vue 中的反模式，但为了让它尽可能接近反应，我选择了这种方式。

# 摘要

两种框架都可以创建具有单一功能的组件。Vue 功能组件是一个状态值包装在代理中的函数，它只运行一次，只有返回的函数重新运行并返回 JSX。React 功能组件是一个具有普通 Javascript 结构的状态值的函数，它在每次状态改变时重新运行，并直接返回 JSX。

区别在于每个框架解决反应性问题的方式。React 是无状态引用比较解决方案，Vue 是基于代理的有状态解决方案。

尝试用尽可能相似的方法在不同的框架中编写相同的组件是一个有趣的实验。我希望你也会觉得有趣。你也可以在我的 [Vue 3 Vite 游乐场](https://github.com/blacksonic/vue-3-playground)试一试。