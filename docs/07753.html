<html>
<head>
<title>5 Kotlin Extensions To Make Your Android Code More Expressive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个Kotlin扩展让你的Android代码更有表现力</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-kotlin-extensions-to-make-your-android-code-more-expressive-4c9243cb9466?source=collection_archive---------2-----------------------#2021-02-16">https://betterprogramming.pub/5-kotlin-extensions-to-make-your-android-code-more-expressive-4c9243cb9466?source=collection_archive---------2-----------------------#2021-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b97c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提取包参数，验证字符串，等等</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f5da8253ed3dbd35446356540e725656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7wBRYeSryL8YT5u_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">万尼亚·马蒂耶维奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="9c54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能已经阅读了大量关于Kotlin扩展的文章，但本文并不全是关于扩展的。这是为了让你的代码更有表现力，所以我把重点放在解释和包括我的顶级扩展上，这些扩展尽可能地保持代码的自然。</p><p id="650b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主要目标是学习如何通过使用扩展的概念，而不是复制粘贴代码片段，使您的代码以您自己的方式表达。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="50be" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="4ffc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Kotlin是一种现代的、富有表现力的语言，是为开发人员设计的。在我看来，好的Kotlin代码只不过是能够以自然、可读的方式表达自己的代码。</p><p id="696f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从Java切换到Kotlin对我来说在很多方面都是一个巨大的转变，但我要说这在每个方面都是最好的。你可以在<a class="ae ky" href="https://medium.com/better-programming/my-journey-from-java-to-kotlin-3bfcbcc6b734" rel="noopener">我之前的文章</a>中读到所有关于它的内容。</p><p id="05c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最喜欢Kotlin的一点是扩展的概念。作为一名移动Java开发人员，我从未考虑过向任何类添加定制功能的能力——尤其是第三方库中的类。但是当我听说扩展的概念时，我大吃一惊。对于Android开发人员来说，这个特性打开了许多代码增强的大门。</p><blockquote class="mz na nb"><p id="76bf" class="kz la nc lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated">Kotlin提供了用新功能扩展一个类的能力，而不必从该类继承或使用Decorator之类的设计模式。这是通过称为扩展的特殊声明来实现的。”— <a class="ae ky" href="https://kotlinlang.org/docs/extensions.html" rel="noopener ugc nofollow" target="_blank">科特林的文档</a></p></blockquote><p id="10bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解关于Kotlin扩展的更多信息，请阅读以下文章:</p><div class="ng nh gp gr ni nj"><a href="https://medium.com/better-programming/advanced-android-programming-with-kotlin-5e40b1be22bb" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">使用Kotlin进行高级Android编程</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">kot Lin-您应该使用的独有功能</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ks nj"/></div></div></a></div><p id="372f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用Kotlin扩展使代码更具表现力，并尽可能保持语言的自然性。</p><p id="4ff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">别再耽搁了，让我们开始吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3583" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.显示、隐藏和删除</h1><p id="264f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">移动开发人员的一个常见任务是隐藏和显示视图。如果使用Java，需要根据需求调用<code class="fe ny nz oa ob b">setVisibility</code>函数并传递<code class="fe ny nz oa ob b">View.VISIBILE</code>或<code class="fe ny nz oa ob b">View.GONE</code>。看一看:</p><pre class="kj kk kl km gt oc ob od oe aw of bi"><span id="af89" class="og md it ob b gy oh oi l oj ok">view.<strong class="ob iu">setVisibility</strong>(View.GONE)</span></pre><p id="3652" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码没有错。它工作了。但是使用<code class="fe ny nz oa ob b">set</code>和<code class="fe ny nz oa ob b">get</code>函数让它看起来更笨拙而不自然。Kotlin提供了一种无需使用<code class="fe ny nz oa ob b">set</code>和<code class="fe ny nz oa ob b">get</code>函数的现成方法来赋值。现在看起来是这样的:</p><pre class="kj kk kl km gt oc ob od oe aw of bi"><span id="b52c" class="og md it ob b gy oh oi l oj ok">view.visibility = View.GONE</span></pre><p id="585f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使是现在，因为赋值操作符，它看起来也不自然，所以我想，“为什么我不能使用扩展使它尽可能自然呢？”那时我开始使用以下扩展:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="6cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以如下所示使用它:</p><pre class="kj kk kl km gt oc ob od oe aw of bi"><span id="6a54" class="og md it ob b gy oh oi l oj ok">view.<strong class="ob iu">show()</strong><br/>view.<strong class="ob iu">hide()</strong> <br/>view.<strong class="ob iu">remove()</strong></span></pre><p id="b758" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在看起来更好——更自然。我很想优化它，所以如果你有任何建议，请留下评论。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="61de" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.确认</h1><p id="06ab" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在任何开发环境中，验证字符串都是至关重要的。回到2015年，当我开始我的职业生涯时，我看到一些应用程序在一些文本字段中显示<code class="fe ny nz oa ob b">null</code>。这是因为没有适当的验证。</p><p id="d0d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Kotlin之前，我会维护一个实用程序类，并包含一些静态函数来验证字符串。看看Java中一个简单的验证函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="9758" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本质上，数据类型只不过是类。所以我们可以使用Kotlin扩展来添加验证功能。例如，我创建了以下数据类型<code class="fe ny nz oa ob b">String</code>的Kotlin扩展来检查它是否有效:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="cac1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，对我来说，<code class="fe ny nz oa ob b">data.valid()</code>似乎比<code class="fe ny nz oa ob b">Utility.isStringNotNullOrEmpty(data)</code>更干净，可读性更强。调用数据类型的扩展函数似乎比触发一些实用函数更自然。下面是几个扩展，可以激励你编写自己的验证扩展:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ea89" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.提取束参数</h1><p id="76ee" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在Android中，我们通过一个包——一个键值对——在组件之间传递数据。通常，在从包中检索数据之前，我们必须检查一些事情。首先，我们应该检查我们要找的密钥是否在包中。然后我们需要检查它是否有有效值。通常，我们通过以下方式实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="a81f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这涉及到更多的手动代码，坦率地说，看起来并不美观。想象一下，如果有五个参数，代码看起来会有多乏味。正如我所说的，代码应该尽可能的自然，并且包含最少的手工工作。</p><p id="b5e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我使用了四个扩展函数:两个用于活动，两个用于片段。同样，每个组件一对，以获得非空值或可空值。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ba0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解像内联函数和具体化类型这样的高级特性，请阅读本系列文章<a class="ae ky" href="https://medium.com/better-programming/advanced-android-programming-with-kotlin-5e40b1be22bb" rel="noopener">。</a></p><p id="0339" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看如何使用上面的扩展:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="3d1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法有三个优点:</p><ol class=""><li id="67a1" class="on oo it lb b lc ld lf lg li op lm oq lq or lu os ot ou ov bi translated">干净，可读，最少的代码。</li><li id="2c20" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">空安全值。</li><li id="19f3" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">懒惰的执行。</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e167" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">4.资源扩展</h1><p id="72d7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在Android中，我们需要通过资源类访问项目级资源。这涉及到一些样板代码，每次我们想从资源文件中检索数据时，都需要手工编写这些代码。在没有任何扩展的情况下，检索颜色或drawable如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ceda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当试图检索任何资源时，您需要通过生成的R文件中的资源ID来访问它。ID的数据类型为<code class="fe ny nz oa ob b">Int</code>。因此，我们可以为每个资源类型编写integer类的扩展，并在调用站点使用它们来减少样板代码并使其可读:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a79f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">5.显示警告对话框、Toast或Snackbar</h1><p id="d8fd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当涉及到前端开发时，不管是什么平台，都会有需要向用户显示警告的时候。它可能是用于不重要的数据或警告对话框的toast，用于确认或显示一些错误。</p><p id="a572" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你想显示一个简单的祝酒辞时，你需要写的语句可能会很长。我甚至不打算进入警告对话框。这些是常见的任务。它们应该简洁并且易于实现。这就是为什么我使用下面的扩展使代码在调用点尽可能的简洁:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="ff84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编写这些扩展是一次性的工作。在呼叫站点查看这些分机的用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="4b87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">常见的任务应该尽可能容易实现、易读和自然。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9dd7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">奖金</h1><p id="b274" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要了解更多关于协同程序和Kotlin的其他高级特性，请阅读以下文章:</p><ul class=""><li id="1b31" class="on oo it lb b lc ld lf lg li op lm oq lq or lu pb ot ou ov bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/5-more-kotlin-extensions-for-android-developers-3857b1f16407">“面向Android开发者的5款Kotlin扩展”</a></li><li id="6a27" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu pb ot ou ov bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/5-powerful-kotlin-extensions-from-ktx-libraries-b10c50504df6">“来自KTX库的5个强大的Kotlin扩展”</a></li><li id="9a5d" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu pb ot ou ov bi translated"><a class="ae ky" href="https://medium.com/better-programming/advanced-android-programming-with-kotlin-5e40b1be22bb" rel="noopener">“使用Kotlin进行高级编程</a>”</li><li id="b613" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu pb ot ou ov bi translated"><a class="ae ky" href="https://medium.com/better-programming/kotlin-coroutines-from-basics-to-advanced-ad3eb1421006" rel="noopener">“科特林协程，从基础到高级</a>”</li><li id="f8de" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu pb ot ou ov bi translated"><a class="ae ky" href="https://medium.com/better-programming/asynchronous-data-loading-with-new-kotlin-flow-233f85ae1d8b" rel="noopener">“使用新Kotlin流进行异步数据加载</a>”</li><li id="e068" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu pb ot ou ov bi translated"><a class="ae ky" href="https://medium.com/better-programming/why-and-how-to-use-kotlins-native-serialization-library-c88c0f14f93d" rel="noopener">“为什么以及如何使用Kotlin的原生序列化库</a>”</li></ul><p id="9654" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读。</p></div></div>    
</body>
</html>