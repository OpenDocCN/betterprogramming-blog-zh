<html>
<head>
<title>This Library is 30 Times Faster Than Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个库比Scikit-Learn快30倍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/this-library-is-30-times-faster-than-scikit-learn-206d1818d76f?source=collection_archive---------10-----------------------#2022-01-17">https://betterprogramming.pub/this-library-is-30-times-faster-than-scikit-learn-206d1818d76f?source=collection_archive---------10-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="77c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">像喷气机一样燃烧，它被称为Snap。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b7cea70c9a73cc6e98e51644ddaf96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Az2IDCG6cojUEHBJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔恩·罗宾逊在<a class="ae ky" href="https://unsplash.com/s/photos/jet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="e851" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="b6b8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">机器学习可以帮助我们从自动化到发现隐藏的模式。为了实现这一点，在训练模型时，准确性是首要考虑的问题。</p><p id="e319" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是请记住，训练数据集可能会花费大量时间，尤其是当数据集包含大量观察值时。除了模型的性能之外，训练模型的速度也相当重要。</p><p id="23fb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前，<code class="fe ms mt mu mv b">scikit-learn</code>是应用机器学习模型的主要库。但是正如你所知道的，它在大数据集上很慢。谢天谢地，Snap可以帮助你让你的训练过程快得惊人。</p><p id="2410" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将向您展示如何使用Snap在大规模数据集上训练您的模型。而且我相信这个库很好用！如果你之前已经用过<code class="fe ms mt mu mv b">scikit-learn</code>，你会发现这是小菜一碟。事不宜迟，我们开始吧！</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="86ec" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">履行</h1><h2 id="8edf" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">数据源</h2><p id="fe4a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于数据源，我们将使用来自Kaggle的数据集。该数据集本身是基于一项名为信用卡欺诈检测的竞赛。</p><p id="6c45" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据集收集了2013年9月的所有信用卡交易。当时发生的交易超过28.4万笔，其中492笔被认为是欺诈交易。</p><p id="30b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了与金额相关的信息之外，数据集中没有用于维护隐私的有意义的信息。你可以通过链接<a class="ae ky" href="https://www.kaggle.com/mlg-ulb/creditcardfraud/data" rel="noopener ugc nofollow" target="_blank">找到更多关于数据集的信息。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/9b00d462d70f7619e32cbae4afb36589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZHbDNwIxuI6VGdd0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图为作者截图。</p></figure><p id="0d19" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要下载数据集，可以使用Kaggle API下载。但是要确保你有API密匙来连接API。下面是从Kaggle下载数据集的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="5a7a" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">准备数据</h2><p id="0a70" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们检索数据之后，下一步是将它加载到<code class="fe ms mt mu mv b">DataFrame</code>对象中。但是首先，让我们解压文件。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="f0d5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">之后，下一步是将数据集加载到我们的程序中。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="dd1b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，从数据集中获取输入(X)和输出(Y)。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="8c4a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，您可以将数据集拆分为两个数据集。这些是训练和测试数据集。要划分数据集，可以使用scikit-learn库中的train_test_split函数。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="aafd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了避免一个或多个特征占主导地位，我们需要归一化数据集。我们可以使用scikit-learn中的normalize函数。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="b788" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">训练模型</h2><p id="5adc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">准备好数据集后，下一步是训练模型。但是首先，让我向您展示如何使用scikit-learn库来训练模型。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5602" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">总之，建模过程看起来是这样的。首先，我们初始化模型，这是决策树模型。然后，我们用训练数据拟合模型。接下来，我们预测测试数据。最后，我们计算精度。</p><p id="d346" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从建模过程来看，我们有一个准确率为99.8%的模型。这是一个好结果。但如果我们看看训练时间，它需要29.77秒左右。它没有那么慢，但是我们可以使用Snap来加速它。</p><p id="2701" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们可以使用这个库之前，我们需要先安装它。您可以使用pip命令来实现这一点。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="8428" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们有了图书馆。下一步是实现代码。当您看到代码的样子时，您会感到惊讶。以下是使用Snap训练模型的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="6d1d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你能看出区别吗？几乎没有！嗯，打印出来的文字看起来不一样，但是请不要把重点放在那里。两个代码之间唯一的主要区别是导入部分。</p><p id="24ff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在第一个代码片段中，我们使用<code class="fe ms mt mu mv b">scikit-learn</code>导入模型。第二部分，我们使用Snap导入模型。代码的其余部分类似。</p><p id="1b2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在表演怎么样了？令人惊讶的是，该模型的准确性略高于基于scikit-learn的模型。该模型有99.9%的准确率。而模型只需要1.105秒左右。</p><p id="fb48" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这几乎比使用<code class="fe ms mt mu mv b">scikit-learn</code>库训练模型快30倍！多酷啊。！使用Snap，您可以比以往任何时候都更快地建立机器学习模型，尤其是在大规模数据集上。</p><blockquote class="nx"><p id="0e3d" class="ny nz it bd oa ob oc od oe of og mm dk translated">训练过程大约需要一秒钟。</p><p id="6d3e" class="ny nz it bd oa ob oc od oe of og mm dk translated">这比scikit-learn库快30倍！</p></blockquote></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="d728" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">结论</h1><p id="39e8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在您已经了解了Snap库。与其花大部分时间训练模型，不如使用Snap来节省训练时间。</p><p id="33f1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望这个库可以帮助您比以往更快地建立一个具有大规模数据集的模型，而不会影响模型的性能。</p><p id="6bc7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p><h2 id="32bc" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">参考</h2><div class="oh oi gp gr oj ok"><a href="https://www.zurich.ibm.com/snapml/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">IBM苏黎世研究院Snap ML</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">IBM Research - Zurich，Snap Machine learning，Library提供热门机器学习模型的高速训练…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">www.zurich.ibm.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ks ok"/></div></div></a></div><pre class="kj kk kl km gt oz mv pa pb aw pc bi"><span id="f39a" class="ni la it mv b gy pd pe l pf pg">Want to Connect?</span><span id="8060" class="ni la it mv b gy ph pe l pf pg">Reach me out on <a class="ae ky" href="https://www.linkedin.com/in/alghaniirfan/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>.</span></pre></div></div>    
</body>
</html>