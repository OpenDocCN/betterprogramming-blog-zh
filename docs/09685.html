<html>
<head>
<title>Minting NFTs Through API Using Truffle and Rinkeby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用松露和Rinkeby通过API制造NFT</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/minting-nfts-through-api-using-truffle-rinkeby-a67a0fa62b49?source=collection_archive---------5-----------------------#2021-09-27">https://betterprogramming.pub/minting-nfts-through-api-using-truffle-rinkeby-a67a0fa62b49?source=collection_archive---------5-----------------------#2021-09-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="305b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">知道铸造是怎么回事吗</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bb2c26c501ea41e25f9ea6fee93d10ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lry-5WkUqXlAm68G.PNG"/></div></div></figure><p id="40b3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是NFTs和DeFi的季节。如果你一直生活在岩石下，那么你需要使用以下链接阅读更多关于NFTs和DeFi的信息。</p><p id="c15c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在你已经理解了这些术语，让我们来理解非功能性测试是如何制作的。NFT市场无疑正在从少数铸币商转向内容创作者自己创造非功能性内容的工具和技术。</p><p id="0edb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是铸造NFT的关键步骤。</p><ol class=""><li id="ed35" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">你需要图像/艺术作品/剪辑上传到<a class="ae lw" href="https://ipfs.io/" rel="noopener ugc nofollow" target="_blank"> IPFS </a>。您可以使用任何允许您上传资产并将其固定的IPFS客户端，这将使任何人都可以通过链接访问该资产。我正在为IPFS使用<a class="ae lw" href="https://www.pinata.cloud/" rel="noopener ugc nofollow" target="_blank"> Pinata </a>云。</li><li id="fab0" class="ln lo iq kt b ku lx kx ly la lz le ma li mb lm ls lt lu lv bi translated">你需要在你的钱包里放一些测试乙醚。一旦你安装了Metamask Google Extension，使用Rinkeby水龙头<a class="ae lw" href="https://faucet.rinkeby.io/" rel="noopener ugc nofollow" target="_blank">加载测试ethers。另外，在你的Rinkeby testnet地址上加载一些</a><a class="ae lw" href="https://faucets.chain.link/rinkeby" rel="noopener ugc nofollow" target="_blank">链接</a>。</li></ol><p id="7151" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我在Patrick Collins的现有回购协议的基础上构建了这些API。在<a class="ae lw" href="https://github.com/PatrickAlphaC/dungeons-and-dragons-nft" rel="noopener ugc nofollow" target="_blank"> this GitHub链接</a>中查看回购。</p><p id="6027" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面的例子是关于给Rinkeby铸造一个“龙与地下城”的集合。它有以下关键步骤。</p><p id="b9d2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一步:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="9380" class="mh mi iq md b gy mj mk l ml mm">truffle migrate --reset --network rinkeby</span></pre><p id="e825" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第二步:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="8046" class="mh mi iq md b gy mj mk l ml mm">truffle exec scripts/fund-contract.js --network rinkeby</span></pre><p id="337f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第三步:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="7bfd" class="mh mi iq md b gy mj mk l ml mm">truffle exec scripts/generate-character.js --network rinkeby</span></pre><p id="c801" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第四步:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="e7ee" class="mh mi iq md b gy mj mk l ml mm">truffle exec scripts/get-character.js --network rinkeby</span></pre><p id="faa0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第五步:</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="51e0" class="mh mi iq md b gy mj mk l ml mm">truffle exec scripts/set-token-uri.js --network rinkeby</span></pre><p id="991f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤1和2处理设置Rinkeby连接，并将与NFT创建相关的合同迁移到Rinkeby Testnet。</p><p id="9c2a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤3、4和5包括对迁移的契约执行适当的功能以随机选择字符，并为铸造的NFT设置元数据URI。</p><p id="a0e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请通过上述回购的<code class="fe mn mo mp md b">README.md</code>了解其他设置细节。</p><p id="1bc5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个想法是构建一个NodeJS应用程序，它将使用上面讨论的步骤。我们可以让用户节点的<a class="ae lw" href="https://nodejs.org/api/child_process.html" rel="noopener ugc nofollow" target="_blank">子进程</a>在CLI上执行truffle命令。下面是一个在子流程调用中结束第一步的例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">执行子进程的示例代码</p></figure><p id="d4ab" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就像上面的示例一样，我们可以创建代码来执行上面提到的剩余步骤，以完成铸造过程。在执行这些步骤之前，我们需要创建所需的契约，并将其迁移到Rinkeby testnet。</p><p id="8c39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们还可以使用NodeJS中的文件操作来创建创建NFT所需的契约。我们使用NodeJS fs库对<code class="fe mn mo mp md b">template</code>契约进行动态修改，然后执行truffle命令来迁移契约。</p><p id="b3c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是创建合同的示例代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="9970" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将<code class="fe mn mo mp md b">sample.sol</code>复制到具有所需名称的<code class="fe mn mo mp md b">contracts</code>文件夹后，我们根据在express API调用中收到的请求，有选择地替换新创建的合同的内容。通过上述过程制作的NFT可以在opensea Rinkeby testnet gallery上查看。</p><p id="2389" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如上所述，在我们准备铸造之前，我们需要将图像/艺术品固定到IPFS。</p><p id="7bda" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以使用<a class="ae lw" href="https://www.pinata.cloud/" rel="noopener ugc nofollow" target="_blank"> Pinata </a>构建API来上传和固定图片到IPFS，还有其他方法。请仔细阅读他们的文档，确定上传和固定图像的API。</p><p id="990f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦图像成功上传，Pinata APIs返回CID，这是上传文件/图像的唯一标识符。</p><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="7da8" class="mh mi iq md b gy mj mk l ml mm"><a class="ae lw" href="https://ipfs.io/ipfs/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx?filename=filename.png" rel="noopener ugc nofollow" target="_blank">https://ipfs.io/ipfs/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx?filename=filename.png</a></span></pre><p id="1dd1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最终的URI看起来和上面的差不多。</p><p id="8bb0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">“XXX”是唯一CID所在的位置。在将JSON文件上传到IPFS之前，我们需要将图像URI嵌入到元数据JSON文件中。</p><p id="79b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请浏览地下城与龙GitHub repo中的元数据文件夹，了解更多关于元数据JSON文件应该是什么样子的细节。</p><p id="00c3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是使用Pinata将文件上传到IPFS的示例代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="dbec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">除此之外，您还可以使用Opensea API从Opensea中插入marketplace。下面是从Opensea获取NFT并在NFT画廊展示它们的示例ReactJS代码。</p><p id="5f99" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是从Opensea中提取新的NFT并显示为NFT画廊的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="c5ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种方法让我们更好地理解铸造NFT的过程。这绝对不是一个生产就绪的代码。为此，我们可能不得不拿出块菌，用<a class="ae lw" href="https://web3js.readthedocs.io/en/v1.5.2/" rel="noopener ugc nofollow" target="_blank"> web3js </a>来建造。</p><p id="3b82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">铸造快乐！！</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="3cb5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nd">原载于</em><a class="ae lw" href="http://dudistan.com/minting-nfts-through-api-using-truffle-rinkeby/" rel="noopener ugc nofollow" target="_blank"><em class="nd">http://dudistan.com</em></a></p></div></div>    
</body>
</html>