<html>
<head>
<title>How To Use the Linux Xargs Command To Create Powerful Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Linux Xargs命令创建强大的管道</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-the-linux-xargs-command-to-create-powerful-pipelines-a5d5d7067703?source=collection_archive---------5-----------------------#2021-04-05">https://betterprogramming.pub/how-to-use-the-linux-xargs-command-to-create-powerful-pipelines-a5d5d7067703?source=collection_archive---------5-----------------------#2021-04-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="7704" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">带有实例的xargs命令介绍</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/897e5c631d3bd63662e75401fec41fd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iT3Gk3gPvs3ZH-S-"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk">Photo by <a class="ae kz" href="https://unsplash.com/@guogete?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">小谢</a> on <a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a>.</p></figure><p id="ac95" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe lw lx ly lz b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/xargs.1.html" rel="noopener ugc nofollow" target="_blank">xargs</a></code>是一个Unix命令，用于从标准输入构建和执行命令。您可以将它与其他强大的Unix命令结合使用，如<code class="fe lw lx ly lz b">grep</code>、<code class="fe lw lx ly lz b">awk</code>等。，通过使用管道。简单地说，它将一个命令的输出作为另一个命令的输入进行传递。</p><p id="c4e0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它可以在大多数类似Unix的操作系统上运行。但是请注意，这个命令在macOS和Linux上的工作方式略有不同。本教程中的例子是在Ubuntu发行版上准备和测试的。</p><p id="84c8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，您将通过简单的例子深入了解<code class="fe lw lx ly lz b">xargs</code>的实际用例。</p><p id="293b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="ce35" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">常见用途</h1><p id="904d" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">首先，让我们看看<code class="fe lw lx ly lz b">xargs</code>命令本身是如何工作的。</p><p id="c297" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您尝试不带任何参数运行它，它将默认执行<code class="fe lw lx ly lz b">echo</code>命令。要获得输出，只需键入一些内容，然后按下键盘上的Ctrl+D:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="d41f" class="ni mi iu lz b gz nj nk l nl nm">$ xargs<br/>hello</span></pre><p id="0b96" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">结果是:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="75c4" class="ni mi iu lz b gz nj nk l nl nm">hello</span></pre><h2 id="c025" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">一次处理多个文件</h2><p id="e075" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">通常，<code class="fe lw lx ly lz b">xargs</code>与其他命令结合使用。为了向您介绍典型的用例，我需要一些测试文件。让我们直接使用<code class="fe lw lx ly lz b">xargs</code>命令来创建我们的虚拟数据。</p><p id="d1d6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要一次创建多个文件，结合使用<code class="fe lw lx ly lz b">xargs</code>和<code class="fe lw lx ly lz b">touch</code>命令:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="773c" class="ni mi iu lz b gz nj nk l nl nm">$ echo test1.log test2.log test3.log 1.txt 2.csv | xargs touch</span><span id="ab5b" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>1.txt  2.csv test1.log  test2.log  test3.log</span></pre><p id="3dc0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意，<code class="fe lw lx ly lz b">echo</code>命令的输出作为<code class="fe lw lx ly lz b">touch </code>命令的输入被传递。</p><h2 id="6c4e" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">查找文件并执行各种操作</h2><p id="00fb" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated"><code class="fe lw lx ly lz b">xargs</code>最常见的组合之一是与<code class="fe lw lx ly lz b">find</code>命令一起使用。当您想要执行重命名或删除多个文件等操作时，它会很有用。</p><p id="34c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">假设您想要查找并删除名称中包含<code class="fe lw lx ly lz b">test</code>的所有日志文件。让我们来玩虚拟数据:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="843b" class="ni mi iu lz b gz nj nk l nl nm">$ find . -type f -name "*test*.log" | xargs ls<br/>./test1.log  ./test2.log  ./test3.log</span><span id="6a47" class="ni mi iu lz b gz ny nk l nl nm">$ find . -type f -name "*test*.log" | xargs rm -f</span><span id="f335" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>1.txt  2.csv  3.test</span></pre><p id="8073" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如您所见，首先，我执行了<code class="fe lw lx ly lz b">ls</code>命令来检查我得到了哪些文件名。然后我运行<code class="fe lw lx ly lz b">rm -f</code>命令删除这些文件。</p><p id="dcb8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是，请记住，有些文件的名称中可能有空格。考虑下面的文件名:<code class="fe lw lx ly lz b">something with white space.log</code>。</p><p id="2b4b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们尝试使用前面的命令删除该文件:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="96c4" class="ni mi iu lz b gz nj nk l nl nm">$ ls<br/>1.txt   2.csv   3.test  'something with white space.log'</span><span id="9a20" class="ni mi iu lz b gz ny nk l nl nm">$ find . -type f -name "*.log" | xargs rm -f</span><span id="8897" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>1.txt   2.csv   3.test  'something with white space.log'</span></pre><p id="1398" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">不幸的是，我们没有得到预期的结果。那么，我们如何处理空白呢？使用<code class="fe lw lx ly lz b">find -print0</code>选项和<code class="fe lw lx ly lz b">xargs -0</code>选项:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="eaee" class="ni mi iu lz b gz nj nk l nl nm">$ find . -type f -name "*.log" -print0 | xargs -0 rm -rf</span><span id="a3aa" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>1.txt  2.csv  3.test</span></pre><p id="e363" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这样，<code class="fe lw lx ly lz b">-print0</code>用一个<code class="fe lw lx ly lz b">null </code>字符分隔文件名，这样包含空格或换行符的文件名就可以被<code class="fe lw lx ly lz b">xargs</code>正确解释。</p><h2 id="e57a" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">将它与grep命令结合使用，可以在多个文件中查找模式</h2><p id="58cc" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated"><code class="fe lw lx ly lz b">xargs</code>的另一个典型用法是与<code class="fe lw lx ly lz b">grep</code>命令一起使用。例如，让我们尝试通过扫描多个文件来找到字符串<code class="fe lw lx ly lz b">hello</code>:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="af04" class="ni mi iu lz b gz nj nk l nl nm">$ find . -type f | xargs grep 'hello'</span><span id="98da" class="ni mi iu lz b gz ny nk l nl nm">./1.txt:hello there<br/>./3.test:hello here</span></pre><h2 id="dd5c" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">从参数文件中读取输入</h2><p id="24e9" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">到目前为止，我们已经看到<code class="fe lw lx ly lz b">xargs</code>命令接受来自标准输入的输入。它还可以从文件中读取项目。为此，添加<code class="fe lw lx ly lz b">-a</code>选项，它代表<code class="fe lw lx ly lz b">— arg-file</code> <em class="nz">。</em></p><p id="0109" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我已经创建了一个名为<code class="fe lw lx ly lz b">files.txt</code>的输入文件:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="99f2" class="ni mi iu lz b gz nj nk l nl nm">$ cat files.txt <br/>3.test<br/>1.txt</span><span id="4630" class="ni mi iu lz b gz ny nk l nl nm">$ xargs -a files.txt ls -lart<br/>-rw-rw-r-- 1 kirshi kirshi 12 apr    2 21:27 1.txt<br/>-rw-rw-r-- 1 kirshi kirshi 19 apr    2 21:27 3.test</span></pre><p id="f72b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们刚刚对参数文件中列出的所有文件执行了<code class="fe lw lx ly lz b">ls -lart</code>命令。</p><h2 id="90be" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">提示用户确认</h2><p id="1765" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">有时当我们执行像<code class="fe lw lx ly lz b">rm -f</code>这样的破坏性操作时，我们可能会要求用户确认。<code class="fe lw lx ly lz b">-p</code>选项可以为我们做到这一点。代表<code class="fe lw lx ly lz b">— interactive</code> <strong class="lc iv"> </strong>并提示用户确认是/否。</p><p id="8401" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们来看看这个例子:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="5b6b" class="ni mi iu lz b gz nj nk l nl nm">$ xargs -p -a files.txt rm -f<br/>rm -f 3.test 1.txt ?...y</span><span id="5363" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>2.csv  files.txt</span></pre><p id="8d73" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它非常方便地显示将要执行的操作。如你所见，这些文件已经被删除了，因为当程序询问时，我输入了<code class="fe lw lx ly lz b">y</code>表示“是”。</p><h2 id="96cf" class="ni mi iu bd mj nn no dn mn np nq dp mr lj nr ns mt ln nt nu mv lr nv nw mx nx bi translated">逐行执行命令</h2><p id="1874" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">上面的操作删除了所有文件。如果我们想一个一个地检查和确认呢？以下是<code class="fe lw lx ly lz b">-n</code>选项(<code class="fe lw lx ly lz b">— max-args</code>)发挥作用的方式。</p><p id="f5ad" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">它需要一些您希望<code class="fe lw lx ly lz b">xargs</code>在每个命令行传递的参数。</p><p id="4caa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们再次运行删除命令—这一次，使用<code class="fe lw lx ly lz b">-n 1</code>:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="a7e7" class="ni mi iu lz b gz nj nk l nl nm">$ xargs -p -n1 -a files.txt rm -f<br/>rm -f 3.test ?...y<br/>rm -f 1.txt ?...n</span><span id="2cec" class="ni mi iu lz b gz ny nk l nl nm">$ ls<br/>1.txt  2.csv  files.txt</span></pre><p id="89fb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我在终端中输入了<code class="fe lw lx ly lz b">n</code>，所以保存了<code class="fe lw lx ly lz b">1.txt</code>文件。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="8846" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">摘要</h1><p id="bffa" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们已经看到了如何结合使用<code class="fe lw lx ly lz b">xargs</code>命令和其他命令来执行如下操作:</p><ul class=""><li id="1d71" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated">一次创建/操作多个文件</li><li id="4334" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated">基于模式查找文件并对每个文件执行操作</li><li id="d17c" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated">从参数文件中读取输入</li><li id="d413" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated">在执行命令之前提示用户进行确认</li></ul><p id="bf25" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些是一些最常用的情况，但是您可以使用这个命令做更多的事情。要探索其他特性，请阅读<a class="ae kz" href="https://man7.org/linux/man-pages/man1/xargs.1.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="abed" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你有一些喜欢的<code class="fe lw lx ly lz b">xargs</code>命令，欢迎在评论中分享。</p><p id="3dce" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您喜欢这篇文章，您可能也会喜欢我关于其他Unix技巧的文章:</p><div class="oo op gq gs oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/5-powerful-unix-commands-for-easier-troubleshooting-dd619d5e173a"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">5个强大的Unix命令，便于故障排除</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">一组经过验证的Unix命令，帮助您识别应用程序问题</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">better编程. pub</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf kt or"/></div></div></a></div><div class="oo op gq gs oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/lesser-known-but-powerful-unix-commands-to-polish-your-tech-skills-b2ceec3e078a"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">鲜为人知但功能强大的Unix命令来提高您的技术技能</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">带有简单示例的简便bash命令</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">better编程. pub</p></div></div><div class="pa l"><div class="pg l pc pd pe pa pf kt or"/></div></div></a></div><div class="oo op gq gs oq or"><a rel="noopener  ugc nofollow" target="_blank" href="/write-more-efficient-unix-scripts-with-heredoc-639719d0e660"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">用Heredoc编写更高效的Unix脚本</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">heredoc简介，让脚本更简洁</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">better编程. pub</p></div></div><div class="pa l"><div class="ph l pc pd pe pa pf kt or"/></div></div></a></div><p id="28c5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，下次再见！</p></div></div>    
</body>
</html>