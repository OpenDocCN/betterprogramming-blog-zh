<html>
<head>
<title>How to Embed a Monaco Editor in a React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React应用程序中嵌入摩纳哥编辑器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/embedding-a-monaco-editor-inside-react-app-37083cf829e9?source=collection_archive---------1-----------------------#2022-12-05">https://betterprogramming.pub/embedding-a-monaco-editor-inside-react-app-37083cf829e9?source=collection_archive---------1-----------------------#2022-12-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f618" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个支持78种语言的编辑器，具有语法高亮、自动完成、自动修正等功能。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8c9b5a009dd695975dc16510d1f10f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5Td8lDXwgLx-8Jyv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@setyaki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Setyaki Irham </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="661a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="f065" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/microsoft/monaco-editor" rel="noopener ugc nofollow" target="_blank"> Monaco编辑器</a>是微软提供的基于浏览器的代码编辑器。它在MIT许可证下获得许可，在Edge、Chrome、Firefox、Safari和Opera中受支持，但在移动浏览器或web框架中不受支持。Monaco编辑器为Visual Studio Code 提供了动力，这是一个针对Windows、Linux和macOS的有影响力的IDE。</p><p id="e244" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前，Monaco编辑器支持78种语言，具有语法突出显示、自动完成、自动更正和许多更高级的功能。它可以用来创建像Visual Studio代码一样复杂的IDE，或者作为在web应用程序中显示工具的代码。</p><p id="5278" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一个React app可以直接部署<code class="fe ms mt mu mv b">monaco-editor</code>，也可以导入一些React包装的包。有两个受欢迎的包，<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/suren-atoyan/monaco-react" rel="noopener ugc nofollow" target="_blank">@monaco-editor/react</a></code>和<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/react-monaco-editor/react-monaco-editor" rel="noopener ugc nofollow" target="_blank">react-monaco-editor</a></code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/cca4bc8dab1f9db376cbc0c84b3a8dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vehrgfF2Jv1fltFan6Xsig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="336c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">react-monaco-editor</code>上市六年，3036颗星。它得到了非常积极的管理。它需要webpack的改动，对于某些应用来说不方便，比如<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-in-depth-guide-for-create-react-app-5-cra-5-b94b03c233f2"> Create React App </a>。</p><p id="d2d5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">@monaco-editor/react</code>已经上市三年，首发2，162次。它得到了相当积极的管理。这个包的吸引力在于，除了安装包本身之外，它不需要任何改变。像Create React App这样的应用不需要弹出或重新布线。默认情况下，它使用CDN下载<code class="fe ms mt mu mv b">monaco-editor</code>。然而，将<code class="fe ms mt mu mv b">monaco-editor</code>作为<code class="fe ms mt mu mv b">npm</code>包导入可能需要额外的<code class="fe ms mt mu mv b">webpack</code>插件，比如<code class="fe ms mt mu mv b">monaco-editor-webpack-plugin</code>。</p><p id="faf5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这时，<code class="fe ms mt mu mv b">@monaco-editor/react</code>更受欢迎。我们将以此为基础，在Create React应用程序中嵌入一个摩纳哥编辑器。</p><h1 id="cacd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">依赖关系</strong>在@摩纳哥-编辑/react</h1><p id="2282" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe ms mt mu mv b">@monaco-editor/react</code>是React的摩纳哥编辑。它在React应用程序中使用<code class="fe ms mt mu mv b">monaco-editor</code>,而不需要为webpack、rollup、parcel或任何bundler设置插件或修改配置文件。</p><p id="f80e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">monaco编辑器提供了一个名为<code class="fe ms mt mu mv b">loader</code>的脚本，它提供了下载Monaco源代码的工具。名为<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/suren-atoyan/monaco-loader" rel="noopener ugc nofollow" target="_blank">@monaco-editor/loader</a></code>的库处理配置和加载部分。它还提供易于使用的API进行交互。在<code class="fe ms mt mu mv b">loader</code>的帮助下，嵌入一个摩纳哥编辑器只需要一行代码。</p><p id="c76f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是<code class="fe ms mt mu mv b">@monaco-editor/react</code>的<code class="fe ms mt mu mv b">package.json</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="6220" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第22行，它声明了一个依赖项<code class="fe ms mt mu mv b">@monaco-editor/loader</code>，它将被安装到<code class="fe ms mt mu mv b">node_modules</code>。</li><li id="7e62" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第14和15行，它声明了<code class="fe ms mt mu mv b">react</code>和<code class="fe ms mt mu mv b">react-dom</code>的<code class="fe ms mt mu mv b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/package-jsons-dependencies-in-depth-a1f0637a3129">peerDependencies</a></code>。一个<code class="fe ms mt mu mv b">peerDependency</code>声明了包的兼容版本。如果<code class="fe ms mt mu mv b">peerDependency</code>已经以正确的版本存在于<code class="fe ms mt mu mv b">node_modules</code>中，则不会发生任何事情。否则，安装会显示警告。</li><li id="e60a" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第13行，<code class="fe ms mt mu mv b">@monaco-editor/react</code>也被声明为<code class="fe ms mt mu mv b">peerDependency</code>。如果它不存在，安装将显示以下警告。</li></ul><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="c3d5" class="nr la it mv b be ns nt l nu nv">warning " &gt; @monaco-editor/react@4.4.6" has unmet peer dependency "monaco-editor@&gt;= 0.25.0 &lt; 1".</span></pre><p id="cbfa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">没有<code class="fe ms mt mu mv b">@monaco-editor/react</code>代码也能工作。但是没有<code class="fe ms mt mu mv b">monaco-editor</code>的<code class="fe ms mt mu mv b">TypeScript</code>定义它也能工作。如果你想把类型定义放在手边，需要安装<code class="fe ms mt mu mv b">monaco-editor</code>。</p><h1 id="1e6c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">设置工作环境</h1><p id="d353" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将在Create React应用程序中嵌入一个摩纳哥编辑器。以下命令创建一个React项目:</p><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="a430" class="nr la it mv b be ns nt l nw nv">% yarn create react-app react-monaco-editor<br/>% cd react-monaco-editor</span></pre><p id="3c32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们安装<code class="fe ms mt mu mv b">@monaco-editor/react</code>和<code class="fe ms mt mu mv b">monaco-editor</code>。</p><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="3317" class="nr la it mv b be ns nt l nw nv">% yarn add @monaco-editor/react monaco-editor</span></pre><p id="6db1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">安装后，这些包成为<code class="fe ms mt mu mv b">package.json</code>中<code class="fe ms mt mu mv b">dependencies</code>的一部分:</p><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="98fc" class="nr la it mv b be ns nt l nw nv">"dependencies": {<br/>  "@monaco-editor/react": "^4.4.6",<br/>  "monaco-editor": "^0.34.1"<br/>}</span></pre><p id="30ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">工作环境准备好了。</p><h1 id="92d9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在React应用程序中嵌入一个摩纳哥编辑器</h1><p id="1bd9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">事实上，如果导入行不算的话，使用Monaco编辑器只需要一行代码。</p><p id="e2f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是修改后的<code class="fe ms mt mu mv b">src/App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="7ebf" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第1行，<code class="fe ms mt mu mv b">Editor</code>是从<code class="fe ms mt mu mv b">'@monaco-editor/react'</code>进口的。</li><li id="b391" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第5行，创建了带有<code class="fe ms mt mu mv b">100%</code>视图高度(<code class="fe ms mt mu mv b">vh</code>)的摩纳哥编辑器。它指定<code class="fe ms mt mu mv b">language</code>是<code class="fe ms mt mu mv b">javascript</code>，而<code class="fe ms mt mu mv b">value</code>是<code class="fe ms mt mu mv b">console.log('Hello, World!');</code>。</li></ul><p id="f3d5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行<code class="fe ms mt mu mv b">yarn start</code>，摩纳哥编辑器嵌入React app，内容预定义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0a6f2307b18051a5a1d383a95265dd47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*bZfwCVf_5kPj0BF_RRGqKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="ecd9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">智能感知功能和支持语言</h1><p id="2449" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尝试删除上面编辑器中的一些字符，它显示一个验证消息:<code class="fe ms mt mu mv b">Unterminated string literal</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/4a1155a2df33e3fef9444a15e023e14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*CUAwr3DqnsUDMupgfT7OGg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b840" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是的，编辑器具有验证功能。</p><p id="89fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">IntelliSense</code>是各种代码编辑功能的总称，包括代码完成、参数信息、快速信息和成员列表。<code class="fe ms mt mu mv b">IntelliSense</code>Visual Studio代码中可用的特性在Monaco编辑器中也可用。开箱后，<code class="fe ms mt mu mv b">IntelliSense</code>准备好<code class="fe ms mt mu mv b">typescript</code>、<code class="fe ms mt mu mv b">javascript</code>、<code class="fe ms mt mu mv b">css</code>、<code class="fe ms mt mu mv b">less</code>、<code class="fe ms mt mu mv b">scss</code>、<code class="fe ms mt mu mv b">json</code>、<code class="fe ms mt mu mv b">html</code>。</p><p id="7afe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前，摩纳哥编辑器支持78种语言，这些语言是在<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/microsoft/monaco-editor/blob/main/src/basic-languages/monaco.contribution.ts" rel="noopener ugc nofollow" target="_blank">monaco.contribution.ts</a></code>输入的。随着时间的推移，这个列表还会继续增长。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="d5a7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摩纳哥编辑器选项</h1><p id="0807" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">默认编辑器可编辑行号。让我们提供一个更长的代码嵌入到<code class="fe ms mt mu mv b">src/App.js</code>中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="bb48" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第4-29行，<code class="fe ms mt mu mv b">value</code>被赋予了原始<code class="fe ms mt mu mv b">src/App.js</code>的内容。</li><li id="0323" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第32行，编辑器中显示<code class="fe ms mt mu mv b">value</code>。</li></ul><p id="f27b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行<code class="fe ms mt mu mv b">yarn start</code>，摩纳哥编辑器显示行号。如果您尝试修改代码，它是可编辑的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/e3bddc064c6d0c8f316320ca00035fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*MqvWcV2De0Vwav8P8XyQTA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="94b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">将道具<code class="fe ms mt mu mv b">options</code>添加到编辑器中。</p><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="7638" class="nr la it mv b be ns nt l nw nv">&lt;Editor<br/>  height="100vh"  <br/>  language="javascript"<br/>  value={value}<br/>  options={{ readOnly: true, lineNumbers: 'off' }}<br/>/&gt;</span></pre><p id="3e6d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">编辑器变成没有行号的只读。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/f239ec62bd506420dbe68cc8f87cb4d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*HdFiVLzkhmEAaQe53eWfcQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9245" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了<code class="fe ms mt mu mv b">readonly</code>和<code class="fe ms mt mu mv b">lineNumbers</code>，界面中还有很多选项，<code class="fe ms mt mu mv b">IEditorOptions</code>。</p><h1 id="6df4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">给摩纳哥的编辑拿一个文件</h1><p id="9aab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们在上面的<code class="fe ms mt mu mv b">src/App.js</code>中硬编码了<code class="fe ms mt mu mv b">value</code>，这不是一个好的做法。其中一个选择是使用文件上传器来动态加载文件。</p><p id="b4ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是修改后的<code class="fe ms mt mu mv b">src/App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="5b65" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第4–6行，使用<code class="fe ms mt mu mv b">&lt;input type="file"&gt;</code>定义组件<code class="fe ms mt mu mv b">FileUploader</code>，这是带有<code class="fe ms mt mu mv b">Choose File</code>按钮的文件选择字段，用于文件上传。选择文件后，触发<code class="fe ms mt mu mv b">onFileLoad</code>功能(第5行)至<code class="fe ms mt mu mv b">setFile</code>(第24行)。</li><li id="6723" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第9行，为所选文件创建状态<code class="fe ms mt mu mv b">file</code>。</li><li id="f05d" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第10行，为所选文件内容创建状态<code class="fe ms mt mu mv b">value</code>。</li><li id="83ab" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第12-20行，当<code class="fe ms mt mu mv b">file</code>改变时<code class="fe ms mt mu mv b">useEffect</code>被触发。它创建一个<code class="fe ms mt mu mv b">FileReader</code>(第14行)，读取文件内容(第18行)，然后<code class="fe ms mt mu mv b">setValue</code>读取文件内容(第16行)。</li><li id="35ea" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第24行，添加了<code class="fe ms mt mu mv b">FileUploader</code>。</li><li id="7334" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第25行，将编辑器的高度调整到<code class="fe ms mt mu mv b">90vh</code>。</li></ul><p id="6b42" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行<code class="fe ms mt mu mv b">yarn start</code>，点击<code class="fe ms mt mu mv b">Choose File</code>按钮，加载Create React App的<code class="fe ms mt mu mv b">src/index.js</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/482581f09d0b23a1151692170dc72169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XM7hUlVGJ_hoX-VzdBIGxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1d28" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">动态加载不是很整洁吗？</p><p id="a105" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">装载<code class="fe ms mt mu mv b">src/App.css</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/19ee7dd08f4eb283b635345c5102339d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vGAwHpDKE7Ugcowzo9NZUQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="40ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们看到相当多的语法错误。怎么了？</p><p id="4fa0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是因为我们对<code class="fe ms mt mu mv b">language</code>到<code class="fe ms mt mu mv b">javascript</code>进行了硬编码。需要根据加载文件的类型进行调整。<code class="fe ms mt mu mv b">file</code>有一个带文件扩展名的<code class="fe ms mt mu mv b">name</code>字段和一个<code class="fe ms mt mu mv b">type</code>字段。文件扩展名可以是<code class="fe ms mt mu mv b">'js'</code>、<code class="fe ms mt mu mv b">'css'</code>、<code class="fe ms mt mu mv b">'html'</code>、<code class="fe ms mt mu mv b">'json'</code>等。一个<code class="fe ms mt mu mv b">type</code>字段可以是<code class="fe ms mt mu mv b">"text/javascript"</code>、<code class="fe ms mt mu mv b">"text/css"</code>、<code class="fe ms mt mu mv b">"text/html"</code>、<code class="fe ms mt mu mv b">"text/json"</code>等。</p><p id="e11a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们使用文件扩展名来设置文件类型。下面是修改后的<code class="fe ms mt mu mv b">src/App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="98f6" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第11行，为所选择的语言创建状态<code class="fe ms mt mu mv b">language</code>，该状态在第34行使用。</li><li id="09c4" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第20–27行，评估文件扩展名以生成<code class="fe ms mt mu mv b">newLanguage</code>，它被用于<code class="fe ms mt mu mv b">setLanguage</code>(第27行)。</li></ul><p id="70f1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">再次加载<code class="fe ms mt mu mv b">src/App.css</code>，没有语法错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/196ed1a4d7ae76c27c0cf09abe65324d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aGbYnVc601kjmURJOG7lOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7d1a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">装载<code class="fe ms mt mu mv b">public/index.html</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/78552f0aeb63bb8bb0230e250fc57f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*va3yyYg5pkZnN5BbAvDuUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="191f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创造你自己的语言</h1><p id="839c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管Monaco编辑器支持多种语言，但您可能想要创建自己的语言。我们展示了一个如何做的例子。</p><p id="b835" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如我们提到的<code class="fe ms mt mu mv b">@monaco-editor/loader</code>处理配置和加载部分，<code class="fe ms mt mu mv b">loader.init()</code>处理整个初始化过程并返回<code class="fe ms mt mu mv b">monaco</code>的实例。<code class="fe ms mt mu mv b">Editor</code>组件使用这个工具——获得对<code class="fe ms mt mu mv b">monaco</code>的访问权并创建编辑器。</p><p id="a994" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面的例子改编自<a class="ae ky" href="https://microsoft.github.io/monaco-editor/playground.html#extending-language-services-custom-languages" rel="noopener ugc nofollow" target="_blank"> office网站</a>，它为日志文件中的特定内容打开颜色。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="ffe8" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第4–40行，它定义了一个函数来返回日志文件内容。</li><li id="b16f" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第43–119行，<code class="fe ms mt mu mv b">useEffect</code>调用<code class="fe ms mt mu mv b">loader.init()</code>来定义一种新语言<code class="fe ms mt mu mv b">mySpecialLanguage</code>。<br/>–在第46行，注册新语言。<br/>–在第49–58行，它基于正则表达式定义了四个记号:<code class="fe ms mt mu mv b">custom-error</code>(第52行)、<code class="fe ms mt mu mv b">custom-notice</code>(第53行)、<code class="fe ms mt mu mv b">custom-info</code>(第54行)和<code class="fe ms mt mu mv b">custom-date</code>(第55行)。<br/>–在第61–73行，它定义了包含语言规则的<code class="fe ms mt mu mv b">myCoolTheme</code>主题，<code class="fe ms mt mu mv b">custom-info</code>为灰色(<code class="fe ms mt mu mv b">#808080 </code>，第65行)，<code class="fe ms mt mu mv b">custom-error</code>为红色(<code class="fe ms mt mu mv b">#FF0000</code>，第<code class="fe ms mt mu mv b">bold</code>(第66行)，<code class="fe ms mt mu mv b">custom-notice</code>为橙色(<code class="fe ms mt mu mv b">#ffa500</code>，第67行)，<code class="fe ms mt mu mv b">custom-date</code>为绿色(<code class="fe ms mt mu mv b">#008800</code>，第68行)，默认颜色为黑色(<code class="fe ms mt mu mv b">#000000</code>，第71行)。<br/>–在第76–108行，它注册了一些自动完成快捷键，<code class="fe ms mt mu mv b">simpleText</code>(第79–83行)，<code class="fe ms mt mu mv b">testing</code>(第84–90行)，以及<code class="fe ms mt mu mv b">ifelse</code>(第91–104行)。<br/>–在第110–117行，它创建具有指定主题(<code class="fe ms mt mu mv b">myCoolTheme</code>，第113行)、值(<code class="fe ms mt mu mv b">getCode()</code>，第114行)和语言(<code class="fe ms mt mu mv b">mySpecialLanguage</code>，第115行)的编辑器。第111行的条件确保编辑器被添加一次。</li><li id="e496" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第121行，它创建了高度为<code class="fe ms mt mu mv b">100vh</code>的<code class="fe ms mt mu mv b">container</code>和<code class="fe ms mt mu mv b">div</code>。</li></ul><p id="4926" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行<code class="fe ms mt mu mv b">yarn start</code>，我们会在编辑器中看到彩色的日志文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/c2544853845d126e4bf72efa2e92a1ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FjLLAZZLDeJNSIKbU7hXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="38a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个例子注册了一些自动完成快捷键，<code class="fe ms mt mu mv b">simpleText</code>、<code class="fe ms mt mu mv b">testing</code>和<code class="fe ms mt mu mv b">ifelse</code>。以下视频展示了它的工作原理:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob my l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="4d4f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用Monaco编辑器区分文件</h1><p id="e899" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Monaco编辑器提供了比较两个文件的diff编辑器。用法很简单。</p><p id="13ba" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是修改后的<code class="fe ms mt mu mv b">src/App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><ul class=""><li id="6275" class="mz na it lt b lu mn lx mo ma nb me nc mi nd mm ne nf ng nh bi translated">在第1行，<code class="fe ms mt mu mv b">DiffEditor</code>从<code class="fe ms mt mu mv b">'@monaco-editor/react'</code>导入。</li><li id="5a59" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">在第5-9行，使用了<code class="fe ms mt mu mv b">DiffEditor</code>，并带有<code class="fe ms mt mu mv b">original</code>和<code class="fe ms mt mu mv b">modified</code>内容的道具。</li></ul><p id="41b7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行<code class="fe ms mt mu mv b">yarn start</code>，我们看到代码不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/30419fd1df9a52d16d1c4eac8c725fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5f3cdgVcCacmD61lsOq_2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="acd5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="ef6d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们在React应用程序中嵌入了一个摩纳哥编辑器。它支持几乎所有流行的语言，语法突出。对于<code class="fe ms mt mu mv b">typescript</code>、<code class="fe ms mt mu mv b">javascript</code>、<code class="fe ms mt mu mv b">css</code>、<code class="fe ms mt mu mv b">less</code>、<code class="fe ms mt mu mv b">scss</code>、<code class="fe ms mt mu mv b">json</code>、<code class="fe ms mt mu mv b">html</code>，提供<code class="fe ms mt mu mv b">IntelliSense</code>，包括代码完成、参数信息、快速信息、成员列表。此外，我们可以为附加功能创建自己的语言，例如颜色主题、自动完成和自动更正。</p><p id="3d55" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们已经展示了如何在<code class="fe ms mt mu mv b">Editor</code>中显示一个硬编码文件，在<code class="fe ms mt mu mv b">Editor</code>中显示一个动态加载文件，在<code class="fe ms mt mu mv b">DiffEditor</code>中显示两个文件的例子。</p><p id="a509" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您只需要语法突出显示，您可能想看一看<a class="ae ky" href="https://medium.com/javascript-in-plain-english/how-to-embed-a-prism-syntax-highlighter-in-react-apps-70eb263be5d" rel="noopener"> Prism </a>，这是一个轻量级的、健壮的JavaScript库，可以执行语法突出显示。</p><p id="e85e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读。</p><blockquote class="od oe of"><p id="1295" class="lr ls og lt b lu mn ju lw lx mo jx lz oh mp mc md oi mq mg mh oj mr mk ml mm im bi translated">感谢S . Sreeram和悉达多.钦塔帕利与我在摩纳哥编辑器上的合作。</p></blockquote><pre class="kj kk kl km gt nn mv no bn np nq bi"><span id="297a" class="nr la it mv b be ns nt l nu nv"><strong class="mv iu">Want to Connect?</strong><br/><br/>If you are interested, check out <a class="ae ky" href="https://jenniferfubook.medium.com/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">my directory of web development articles</a>.</span></pre></div></div>    
</body>
</html>