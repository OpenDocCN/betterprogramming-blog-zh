<html>
<head>
<title>JavaScript’s use strict — Trade In Your Sloppy Code for Strict Mode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript的使用是严格的——用松散的代码换取严格的模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/javascripts-use-strict-trade-in-your-sloppy-code-for-strict-mode-260218113048?source=collection_archive---------13-----------------------#2020-02-26">https://betterprogramming.pub/javascripts-use-strict-trade-in-your-sloppy-code-for-strict-mode-260218113048?source=collection_archive---------13-----------------------#2020-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9cc2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在虫子存在之前就把它们压扁</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6faf89e32f20c8de29d2c2d73dd2c29e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NAs6dOOKmTReJWUD.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@alicegrace?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">爱丽丝·迪特里希</a>在<a class="ae ky" href="https://unsplash.com/s/photos/mess?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="358b" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">草率模式</h1><p id="4ed7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">与Java或C#不同，JavaScript是一种松散类型的语言，这使它成为一种非常宽容的语言。JavaScript将尽最大努力弥补编写它的人所犯的大多数错误。</p><p id="63ac" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">从表面上看，这似乎是一件好事，但它可以允许一些规则弯曲，往往会导致意想不到的后果。这为默认的JavaScript环境赢得了<em class="mz">草率模式</em>的称号。*</p><p id="2f33" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这不是一个官方名称，但MDN确实有一个专门介绍这个术语的页面。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="71a5" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">为什么使用严格模式？</h1><p id="bc80" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">避免slop是使用严格模式的充分理由吗？只有你能决定，但是这就是为什么ECMA的医生认为开发者可能想要使用严格模式:</p><blockquote class="na nb nc"><p id="6453" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">他们这样做可能是出于安全考虑，避免他们认为容易出错的功能，获得增强的错误检查，或者出于他们选择的其他原因…严格变体还指定了额外的错误条件，在语言的非严格形式未指定为错误的情况下，必须通过引发错误异常来报告这些错误条件</p></blockquote><p id="b1dc" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">jQuery的创始人John Resig写道，严格模式非常有用，因为:</p><blockquote class="na nb nc"><p id="29e6" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">它捕捉一些常见的编码错误，抛出异常。</p><p id="9fee" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">当采取相对“不安全”的操作时(比如访问全局对象)，它会阻止或抛出错误。</p><p id="27e1" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">它禁用令人困惑或考虑不周的功能。</p></blockquote></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="920d" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">严格模式——马虎的替代方案</h1><p id="84e5" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">向后兼容性是JavaScript的一大优势。有一些20年前写的JS网站仍然运行良好！另一方面，这意味着改变语言语义会破坏数百万个网站。</p><p id="491c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这导致了一些JavaScript错误和失误成为语言的一部分(比如在JS中<code class="fe ng nh ni nj b">typeof null</code>是一个<a class="ae ky" href="https://2ality.com/2013/10/typeof-null.html" rel="noopener ugc nofollow" target="_blank">对象</a>)。</p><p id="a690" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">为了保持兼容性，必须小心地进行更改。在严格模式下，该特性是可选的，您可以手动选择加入。根据MDN，选择加入会改变JavaScript语义，如下所示:</p><blockquote class="na nb nc"><p id="73e4" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">1.通过将JavaScript静默错误改为抛出错误来消除这些错误。</p><p id="af19" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">2.修复了使JavaScript引擎难以执行优化的错误:严格模式代码有时可以比非严格模式的相同代码运行得更快。</p><p id="7c7b" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">3.禁止某些可能在ECMAScript未来版本中定义的语法。</p></blockquote><p id="737b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们来分解一下如何实现严格模式，以及它有什么改变。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="41c3" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">如何启用严格模式</h1><p id="8984" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">您可以将严格模式应用于整个文档或单个函数。要调用整个脚本的严格模式，在文档的第一行写字符串<code class="fe ng nh ni nj b">use strict</code>。</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="0a80" class="no lh it nj b gy np nq l nr ns">// apply strict mode to entire script<br/>'use strict';<br/>let x= "So this is strict mode. Neat.";</span></pre><p id="8c11" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe ng nh ni nj b">use strict</code>指令必须在文档的<strong class="ma iu">顶部</strong>声明。否则可能根本使不了，不管写到哪里。</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="a25c" class="no lh it nj b gy np nq l nr ns">function(str){<br/>  return something<br/>}; <br/>// strict mode will not apply to the above function</span><span id="5b5a" class="no lh it nj b gy nt nq l nr ns">"use strict";</span><span id="3842" class="no lh it nj b gy nt nq l nr ns">// though it has been invoked, strict mode is not enabled</span></pre><p id="dbc8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">唯一的例外是在单个函数中调用严格模式。</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="94a1" class="no lh it nj b gy np nq l nr ns">function amStrict(){<br/>"use strict";<br/>// your code<br/>}</span></pre><p id="2f77" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">严格模式的最后一个应用涉及到模块。ECMAScript 2015中引入了JavaScript模块，默认情况下，模块的内容应用了严格模式。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="b9f5" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">严格模式(具体)做什么？</h1><p id="e8de" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">有关严格模式应用的变更的详细列表，请参见<a class="ae ky" href="https://www.ecma-international.org/ecma-262/5.1/#sec-13.1" rel="noopener ugc nofollow" target="_blank"> ECMAScript文档</a>。由于这篇文章的篇幅有限，我将概述一些您可能会经历的最常见的变化。</p><h2 id="3264" class="no lh it bd li nu nv dn lm nw nx dp lq mh ny nz ls ml oa ob lu mp oc od lw oe bi translated">没有意外的全局变量</h2><p id="887f" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在普通的JavaScript中，如果你声明一个没有<code class="fe ng nh ni nj b">let</code>、<code class="fe ng nh ni nj b">const</code>或<code class="fe ng nh ni nj b">var</code>的变量，它会被自动声明为一个全局变量。严格模式可以防止这种情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/6783a800f051f15a35ee733a9691d4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y6w6zmJZVCOJAMg8.png"/></div></div></figure><h2 id="1489" class="no lh it bd li nu nv dn lm nw nx dp lq mh ny nz ls ml oa ob lu mp oc od lw oe bi translated">不可写的全局变量不能用作var/func名称</h2><blockquote class="na nb nc"><p id="ead7" class="ly lz mz ma b mb mu ju md me mv jx mg nd mw mj mk ne mx mn mo nf my mr ms mt im bi translated">“在普通代码中静默失败的赋值(对不可写的全局或属性的赋值…)将在严格模式下抛出。”——MDN</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/cc7588ddd78ba37b5047d54dcf707421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lDesFMyQLFHf0g4K.png"/></div></div></figure><h2 id="49a5" class="no lh it bd li nu nv dn lm nw nx dp lq mh ny nz ls ml oa ob lu mp oc od lw oe bi translated">不允许重复的参数</h2><p id="bf8c" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">普通JS允许函数重复参数名。非严格模式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/714fd61552968cc5cf6c299f1e6e99e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1KnL_38atUWRFdmL.png"/></div></div></figure><p id="bab2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这同样适用于严格模式下对象的重复属性。</p><h2 id="d034" class="no lh it bd li nu nv dn lm nw nx dp lq mh ny nz ls ml oa ob lu mp oc od lw oe bi translated">严格模式禁止八进制语法</h2><p id="9ebd" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">开发人员有时假设前导零没有意义，并在代码中将其用作对齐装置。严格模式将引发语法错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/fb41ed5691a19fdc911579a72eb989db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*65aogAnx_yYZ9lqB.png"/></div></div></figure><h2 id="9ba1" class="no lh it bd li nu nv dn lm nw nx dp lq mh ny nz ls ml oa ob lu mp oc od lw oe bi translated">尝试删除不可删除的属性将会引发错误</h2><p id="7087" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">通常，JavaScript在这些情况下什么也不做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/cee8dbdd0f8baee9acc49ff2e59675f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S6BTqvAst11et8Q2.png"/></div></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="dfdb" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">严格模式不是魔杖</h1><p id="ef97" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">使用严格模式时，需要考虑一些预防措施。所有主流的现代浏览器都支持严格模式，但仍有一些浏览器仅部分支持，甚至有少数完全不支持。</p><p id="93a2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">当编写你完全拥有的全新代码时，你可以假设从一开始就使用严格模式是安全的。这很聪明，强烈推荐。</p><p id="744d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">相反，试图在遗留代码上调用严格模式是不明智的，可能会导致灾难。更有可能的是，将会有无数的错误，甚至是在工作代码中，因为普通的JavaScript是非常宽容的，不遵循严格的约定也可以编写大量的工作代码。</p><p id="ed71" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">对您不拥有或维护的代码调用严格模式也是一个很大的问题</p><p id="58be" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">撇开预防措施不谈，严格模式是非常值得的！编写更多有意的代码总是有益的，并且将使您免于许多未来的麻烦。</p><p id="003d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">一如既往，感谢阅读。</p></div></div>    
</body>
</html>