<html>
<head>
<title>What’s New in Angular 13</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular 13的新功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-13-features-ef528a9ae16f?source=collection_archive---------0-----------------------#2021-11-04">https://betterprogramming.pub/angular-13-features-ef528a9ae16f?source=collection_archive---------0-----------------------#2021-11-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="39dc" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">100% Ivy，更好的组件API，不支持IE11，等等</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/c9b5384c31727c535450840d98f6242c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2ozXZBZnb_j52v2t6sQAw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@nebe3etogo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹尼尔·阿克谢诺夫</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的原始照片(作者编辑)</p></figure><p id="e8d8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">谷歌广受欢迎的基于TypeScript的网络框架的新版本自2020年11月3日起可用。</p><p id="357e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这篇文章将让你更接近Angular 13中最重要的新功能和突破性变化，并帮助你决定是否值得为你的项目进行更新。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="d343" class="mb mc iu lx b gz md me l mf mg"><strong class="lx iv">Table of Contents</strong></span><span id="3d60" class="mb mc iu lx b gz mh me l mf mg"><a class="ae kz" href="#8679" rel="noopener ugc nofollow">Goodbye View Engine — 100% Ivy</a><br/><a class="ae kz" href="#ba6a" rel="noopener ugc nofollow">Ergonomic APIs</a><br/><a class="ae kz" href="#a789" rel="noopener ugc nofollow">No More Support for IE11</a><br/><a class="ae kz" href="#736d" rel="noopener ugc nofollow">Update of Component API</a><br/><a class="ae kz" href="#5949" rel="noopener ugc nofollow">Improved Debugging and Test Times</a><br/><a class="ae kz" href="#dff9" rel="noopener ugc nofollow">New Type for Forms</a><br/><a class="ae kz" href="#b6ed" rel="noopener ugc nofollow">Router</a><br/><a class="ae kz" href="#7b1d" rel="noopener ugc nofollow">Accessibility (A11y)</a><br/><a class="ae kz" href="#1637" rel="noopener ugc nofollow">Other Changes</a><br/><a class="ae kz" href="#b2eb" rel="noopener ugc nofollow">Final Thought</a></span></pre></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><h1 id="8679" class="mp mc iu bd mq mr ms mt mu mv mw mx my ka mz kb na kd nb ke nc kg nd kh ne nf bi translated">再见视图引擎— 100%常春藤</h1><p id="5fbd" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">Angular从其版本8开始引入了下一代编译和渲染管道Ivy。Angular 9默认使用Ivy，同时保持对前身编译器和运行时视图引擎的支持。</p><p id="8b41" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">新版本的框架现在是百分之百的常青藤。</p><p id="36f9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了简化和更新Angular Package Format (APF ),现在删除了视图引擎特定的元数据和旧的输出格式，这将降低维护成本和Angular 13中代码库的复杂性。所有内部工具都预先转换为Ivy，以便顺利进行更改。</p><p id="331f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Ivy更加独立地编译各个组件，这缩短了开发时间。使用最新版本的APF构建的库不再需要使用<code class="fe nl nm nn lx b">ngcc</code> ( <a class="ae kz" href="https://v13.angular.io/guide/glossary#ngcc" rel="noopener ugc nofollow" target="_blank">角度兼容性编译器</a>)。这将为库开发人员提供更快的执行速度。</p><h1 id="ba6a" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">人体工程学API</h1><p id="3380" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">在Angular 13中，借助符合人体工程学的代码拆分API和组件级的粒度代码分解，加载时间得以缩短。</p><p id="557a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着速度极快的JavaScript捆绑器<a class="ae kz" href="https://esbuild.github.io/" rel="noopener ugc nofollow" target="_blank"> ESBuild </a>的引入，性能也得到了提高。ESBuild现在与<code class="fe nl nm nn lx b"><a class="ae kz" href="https://terser.org/" rel="noopener ugc nofollow" target="_blank">terser</a></code>一起工作来优化全局脚本并支持CSS sourcemaps，这实现了优化的全局CSS。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nt"><img src="../Images/ddfb5a15721faa5dbff6522fc667a44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q7AeCgjKAg7wvF_PCt7rjA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="nu">这个时候做一个制作捆绑10份的</em><a class="ae kz" href="https://github.com/mrdoob/three.js" rel="noopener ugc nofollow" target="_blank"><em class="nu">three . js</em></a><em class="nu">库从头开始使用默认设置，包括缩小图和源图。</em> ( <a class="ae kz" href="https://esbuild.github.io/" rel="noopener ugc nofollow" target="_blank">图像来源</a>)</p></figure><p id="13cb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">ESBuild还支持其他框架语言，如<a class="ae kz" href="https://elm-lang.org/" rel="noopener ugc nofollow" target="_blank"> Elm </a>、<a class="ae kz" href="https://svelte.dev/" rel="noopener ugc nofollow" target="_blank"> Svelte </a>和<a class="ae kz" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>。</p><h1 id="a789" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">不再支持IE11</h1><p id="224a" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">为了从本地web APIs和现代浏览器功能(如web动画和CSS变量)中受益，Angular团队删除了对Internet Explorer 11的支持。</p><p id="d804" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">由于没有IE专用的polyfills，并且不需要差异加载，因此这为应用程序提供了更小的包大小和更快的加载速度，并改善了用户体验。</p><p id="9c40" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这种突破性的变化肯定会影响到仍然使用IE 11并且尚未改用微软Edge或其他现代浏览器的权威机构或机构。</p><h1 id="736d" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">组件API的更新</h1><p id="2d49" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">由于对<code class="fe nl nm nn lx b">ViewContainerRef.createComponent</code> API的改进，现在您可以用更少的样板代码创建<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/angular-custom-autocomplete-7ffb479477e7">动态组件</a>。</p><p id="3bfa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是创建动态组件的老方法:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">角度12创建动态组件的方式</p></figure><p id="df64" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">而且有了Angular 13，就不需要用<code class="fe nl nm nn lx b">ComponentFactoryResolver</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nv nw l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">创建动态组件的角度13方法</p></figure><h1 id="5949" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">缩短了调试和测试时间</h1><p id="57d2" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated"><code class="fe nl nm nn lx b">TestBed</code>是角度应用程序和库的主要单元测试API。</p><p id="4b44" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了减少<code class="fe nl nm nn lx b">TestBed</code>中的测试时间，新版本发布了改进的测试API。框架现在可以设置和拆除测试环境，并在每次测试运行后自动学习DOM。这使得测试速度更快，占用内存更少，隔离性更好。</p><h1 id="dff9" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">表单的新类型</h1><p id="38e2" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">Angular 13引入了一种新的表单类型，这就是<code class="fe nl nm nn lx b">FormControlStatus</code>。它是表单控件所有可能的状态字符串的联合:</p><ul class=""><li id="63e0" class="nx ny iu lc b ld le lg lh lj nz ln oa lr ob lv oc od oe of bi translated">比如<code class="fe nl nm nn lx b">AbstractControl.status</code>的类型现在是<code class="fe nl nm nn lx b">FormControlStatus</code>而不是<code class="fe nl nm nn lx b">string</code>。</li><li id="2828" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">并且<code class="fe nl nm nn lx b">StatusChanges</code>的类型是<code class="fe nl nm nn lx b">Observable&lt;FormControlStatus&gt;</code>而不是<code class="fe nl nm nn lx b">Observable&lt;any&gt;</code>。</li></ul><h1 id="b6ed" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">路由器</h1><ul class=""><li id="a1b8" class="nx ny iu lc b ld ng lg nh lj ol ln om lr on lv oc od oe of bi translated">路由器有一个改进，当新的导航取消正在进行的导航时，它不会替换浏览器URL。</li><li id="3968" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">有一个建议是修复导航的不正确解析。当默认URL序列化程序像查询参数中的问号一样丢弃所有内容时，就会发生这种情况:<code class="fe nl nm nn lx b">/users?start=1?&amp;pages=15</code></li><li id="a07d" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">您可以将缺失的出口事件添加到<code class="fe nl nm nn lx b">RouterOutletContract</code>中，这在将来模块联合动态呈现组件时非常有用。</li></ul><h1 id="7b1d" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">可访问性(A11y)</h1><p id="7eb7" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">角形材料的可访问性(A11y)有所改进:所有材料设计组件(MDC)都经过检查，可获得更好的可访问性。</p><p id="f856" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，复选框和单选按钮现在有更大的触摸尺寸，其他组件有更好的高对比度模式。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oo"><img src="../Images/4064461ff974f4d1dee22bb49fc48dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/0*Rye_kXhY_t5gsacS"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">触摸目标大小的比较。右边的尺寸是新的尺寸。(<a class="ae kz" href="https://blog.angular.io/angular-v13-is-now-available-cce66f7bc296" rel="noopener ugc nofollow" target="_blank">图片来源</a>)</p></figure><h1 id="1637" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">其他变化</h1><ul class=""><li id="8c00" class="nx ny iu lc b ld ng lg nh lj ol ln om lr on lv oc od oe of bi translated">框架核心现在支持<a class="ae kz" href="https://levelup.gitconnected.com/features-in-the-new-typescript-release-e5ef6ebba750" rel="noopener ugc nofollow" target="_blank"> TypeScript版本4.4 </a>。</li><li id="1aa3" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated"><a class="ae kz" href="https://rxjs.dev/6-to-7-change-summary" rel="noopener ugc nofollow" target="_blank">现在支持反应式编程库RxJs(JavaScript的反应式扩展)的版本7 </a>。</li><li id="d7c8" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">内联字体加速了<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/web-vitals-guide-b56e28798e7f">第一个内容丰富的绘画(FCP) </a>，这可以提高网页性能。这就是为什么该团队现在引入了对内嵌Adobe字体的支持，就像他们在Angular 11中内嵌Google字体一样。</li><li id="23c0" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">我们可以动态地禁用或启用内置验证器，如<code class="fe nl nm nn lx b">min</code>、<code class="fe nl nm nn lx b">max</code>和<code class="fe nl nm nn lx b">minLength</code>。</li><li id="30fd" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">我们可以在<code class="fe nl nm nn lx b">ng_package</code>设置自定义条件。</li><li id="8026" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">错误消息有所改进，例如关于<a class="ae kz" href="https://github.com/angular/angular/pull/41356" rel="noopener ugc nofollow" target="_blank">平台浏览器</a>的“<em class="op">缺少动画触发器</em>的错误。</li><li id="ca9e" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">清除安全工作器中的<a class="ae kz" href="https://github.com/angular/angular/pull/43324" rel="noopener ugc nofollow" target="_blank">服务工作器</a>缓存。这确保了在将来的请求中不会提供破损或陈旧的内容。</li><li id="ff01" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">本地化API的改进。可以查看<code class="fe nl nm nn lx b"><a class="ae kz" href="https://angular.io/api/localize/init/$localize" rel="noopener ugc nofollow" target="_blank">$localize</a></code>的文档。</li></ul><h1 id="b2eb" class="mp mc iu bd mq mr no mt mu mv np mx my ka nq kb na kd nr ke nc kg ns kh ne nf bi translated">最后的想法</h1><p id="cd3a" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">Angular框架的新版本带来了令人兴奋的特性。如果您的需求不依赖于Internet Explorer 11，那么您有机会通过在项目中运行<code class="fe nl nm nn lx b">ng update</code>来更容易地更新到Angular 13。</p><p id="e863" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以在<a class="ae kz" href="https://github.com/angular/angular/releases" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到新版本的代码，也可以在这里找到宣布完整发布细节的博客:</p><div class="oq or gq gs os ot"><a href="https://blog.angular.io/angular-v13-is-now-available-cce66f7bc296" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd iv gz z fq oy fs ft oz fv fx it bi translated">Angular v13现已上市</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">我们带着全新发布的Angular v13回来与大家分享！这个最新版本带来了各种…</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">blog.angular.io</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph kt ot"/></div></div></a></div><p id="8163" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将来，<code class="fe nl nm nn lx b">NgModules</code>可能会是可选的，因为GitHub上有一个针对它的<a class="ae kz" href="https://github.com/angular/angular/discussions/43784" rel="noopener ugc nofollow" target="_blank"> RFC(征求意见)提案</a>。这种改变将允许开发人员创建独立的组件，并实现用于声明编译区域的替代API。</p></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><h2 id="aaa9" class="mb mc iu bd mq pi pj dn mu pk pl dp my lj pm pn na ln po pp nc lr pq pr ne ps bi translated">想联系作者？</h2><p id="4071" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">我为一群聪明、好奇的人写关于工程、技术和领导力的文章。<a class="ae kz" href="https://rakiabensassi.substack.com/" rel="noopener ugc nofollow" target="_blank">加入我的免费电子邮件简讯</a>获得独家访问权限。</p></div></div>    
</body>
</html>