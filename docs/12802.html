<html>
<head>
<title>The Essential Cargo Functions You Should Know To Use Rust</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Rust应该知道的基本货物功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/rust-what-is-cargo-783504c5b5bd?source=collection_archive---------3-----------------------#2022-07-03">https://betterprogramming.pub/rust-what-is-cargo-783504c5b5bd?source=collection_archive---------3-----------------------#2022-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1a15" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你的货物指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dcbf3b436342c5013a7184261faf44e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6yFw3Gft7yq4DdRW"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯·帕甘在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e736" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Cargo是Rust的一个构建系统和包管理器。比如Python中的<code class="fe ls lt lu lv b">pip</code>或者JavaScript中的<code class="fe ls lt lu lv b">npm</code>。</p><p id="30bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着，cargo是一个工具，使我们可以轻松下载外部板条箱或通过一行命令管理依赖关系。</p><p id="4c90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很多人对以下三个工具感到困惑。</p><ul class=""><li id="6a67" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated"><code class="fe ls lt lu lv b">rustup</code>:RUST编程语言系统的工具链安装程序。</li><li id="3f48" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">rsutc</code>:铁锈的编译器</li><li id="ed75" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated"><code class="fe ls lt lu lv b">cargo</code>:铁锈包的包经理</li></ul><p id="a5a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看看cargo有什么功能:</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="c219" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">版本</h1><p id="626f" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">该命令显示所安装货物的版本。以下三个命令显示了相同的结果。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="05e9" class="ns ms iq lv b gy nt nu l nv nw">$ cargo version<br/>cargo 1.59.0 (49d8809dc 2022-02-10)</span><span id="d028" class="ns ms iq lv b gy nx nu l nv nw">$ cargo --version<br/>cargo 1.59.0 (49d8809dc 2022-02-10)</span><span id="78c2" class="ns ms iq lv b gy nx nu l nv nw">$ cargo -V<br/>cargo 1.59.0 (49d8809dc 2022-02-10)</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="8036" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">新的</h1><p id="1357" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">该命令创建一个新的二进制或库rust包。</p><h2 id="9c62" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">二进制</h2><p id="5bf3" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">这个参数意味着创建一个可执行的二进制包。如果不指定包类型，cargo会默认创建一个二进制包。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="a2a5" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new "package-name" (--bin)</span></pre><p id="4468" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">括号</strong> <code class="fe ls lt lu lv b"><strong class="ky ir">()</strong></code> <strong class="ky ir">表示可选参数，非强制。</strong></p><h2 id="456a" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">新二进制示例</h2><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="b3c5" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new hello-cargo<br/>     Created binary (application) `hello-cargo` package</span><span id="dd32" class="ns ms iq lv b gy nx nu l nv nw">$ cargo new hello-cargo2 --bin<br/>     Created binary (application) `hello-cargo2` package</span></pre><h2 id="0417" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">-图书馆</h2><p id="5d72" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">此参数用于创建库项目。如果没有项目类型参数，如我所说，默认创建二进制包。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="ef54" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new "binary-name" --lib</span></pre><h2 id="c7cf" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">新库示例</h2><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="5921" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new hello-cargo3 --lib<br/>     Created library `hello-cargo3` package</span></pre><h1 id="ce9c" class="mr ms iq bd mt mu oj mw mx my ok na nb jw ol jx nd jz om ka nf kc on kd nh ni bi translated">-风投</h1><p id="6d96" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">cargo创建的包是一个git目录。如果不想使用vcs(版本控制系统)或者想改变git以外的东西，可以使用VCS参数。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="17e8" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new "package-name" --vsc "vcs-name"</span></pre><h2 id="6689" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">更改vcs示例</h2><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="46a6" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new hello-cargo4 --vcs git<br/>     Created binary (application) `hello-cargo4` package<br/>     <br/>$ cargo new hello-cargo5 --vcs none<br/>     Created binary (application) `hello-cargo5` package</span></pre><h2 id="cbc8" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">-名字</h2><p id="f56a" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">如果你想有一个不同于目录名的包名，你可以使用<code class="fe ls lt lu lv b">--name</code>参数。当然可以通过编辑<code class="fe ls lt lu lv b">Cargo.toml</code>来改变</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="919d" class="ns ms iq lv b gy nt nu l nv nw">$ cargo new "folder-name" --name "package-name"</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="230d" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">初始化</h1><p id="cffc" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">跟<code class="fe ls lt lu lv b">new</code>差不多。唯一的区别是<code class="fe ls lt lu lv b">new</code>创建一个新目录，而<code class="fe ls lt lu lv b">init</code>在现有目录中创建一个包。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="2af1" class="ns ms iq lv b gy nt nu l nv nw">$ mkdir hello-cargo6 </span><span id="9463" class="ns ms iq lv b gy nx nu l nv nw">$ cd hello-cargo6</span><span id="007e" class="ns ms iq lv b gy nx nu l nv nw">$ cargo init<br/>     Created binary (application) package</span></pre><h2 id="4eac" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">-名字</h2><p id="2759" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">这与<code class="fe ls lt lu lv b">cargo new --name</code>相同</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="7214" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">搜索</h1><p id="204c" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">鲁斯塔西亚人用板条箱分享他们的板条箱。比如Python中的PyPI</p><p id="f3dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">cargo search</code>命令可以搜索包含特定关键字的板条箱。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="6fd1" class="ns ms iq lv b gy nt nu l nv nw">cargo search "crate-name"</span></pre><h2 id="e228" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">搜索示例</h2><p id="43c0" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">例如，如果您想找到一个EXIF解析器，您可以通过命令<code class="fe ls lt lu lv b">cargo search exif</code>得到以下结果。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="77d5" class="ns ms iq lv b gy nt nu l nv nw">$ cargo search exif<br/>exif = "0.0.1"            # Rust wrapper for libexif<br/>kamadak-exif = "0.5.4"    # Exif parsing library written in pure Rust<br/>s.<br/>imagemeta = "0.1.0"       # Support for manipulating image metadata (exif, etc) in Rust.<br/>img-parts = "0.2.3"       # Low level crate for reading and writing Jpeg, Png and RIFF image containers<br/>exifmv = "0.1.3"          # Moves images into a folder hierarchy based on EXIF tags<br/>gexiv2-sys = "1.1.2"      # This library provides Rust FFI declarations for the gexiv2 library, which is a GObject-based wrapper …<br/>rexiv2 = "0.9.1"          # This library provides a Rust wrapper around the gexiv2 library, which is a GObject-based wrapper arou…<br/>... and 24 crates more (use --limit N to see more)</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="df33" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">安装</h1><p id="f1cb" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">您可以通过<code class="fe ls lt lu lv b">cargo install</code>命令轻松安装crates.io上的外部板条箱。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="6905" class="ns ms iq lv b gy nt nu l nv nw">cargo install "binary-name"</span></pre><h2 id="2c4b" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">安装示例</h2><p id="86a2" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">这是一个安装示例<code class="fe ls lt lu lv b">ripgrep</code> crate，它是一个使用Rust实现的grep库</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="75a4" class="ns ms iq lv b gy nt nu l nv nw">$ cargo install ripgrep<br/>    Updating crates.io index<br/>  Downloaded ripgrep v13.0.0<br/>  Downloaded 1 crate (272.1 KB) in 0.85s<br/>  Installing ripgrep v13.0.0<br/>  .<br/>  .<br/>  .<br/>    Finished release [optimized + debuginfo] target(s) in 32.99s<br/>  Installing C:\Users\d2h10s\.cargo\bin\rg.exe<br/>   Installed package `ripgrep v13.0.0` (executable `rg.exe`)</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="6a08" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">Cargo.toml</h1><p id="7c8c" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">新创建的包的树如下所示。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="0795" class="ns ms iq lv b gy nt nu l nv nw">.<br/>│  .gitignore<br/>│  Cargo.toml<br/>│<br/>└─src<br/>        main.rs</span></pre><p id="ea10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你总是可以看到<code class="fe ls lt lu lv b">Cargo.toml</code>文件。这是货物包装的设置文件，包含您定义的<code class="fe ls lt lu lv b">package name</code>、<code class="fe ls lt lu lv b">package version</code>、<code class="fe ls lt lu lv b">rust edition</code>等。</p><p id="885f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">[dependencies]</code> <strong class="ky ir"> <em class="oo"> </em> </strong>字段中，您可以描述您的包裹所依赖的板条箱。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="952d" class="ns ms iq lv b gy nt nu l nv nw">[package]<br/>name = "exif-fixer"<br/>version = "0.1.0"<br/>edition = "2021"</span><span id="d196" class="ns ms iq lv b gy nx nu l nv nw"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span><span id="d4f9" class="ns ms iq lv b gy nx nu l nv nw">[dependencies]</span></pre><h2 id="a88f" class="ns ms iq bd mt ny nz dn mx oa ob dp nb lf oc od nd lj oe of nf ln og oh nh oi bi translated">添加板条箱依赖性示例</h2><p id="113c" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">比如你要用<code class="fe ls lt lu lv b">kamadak-exif</code>板条箱，你得这么写。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="2117" class="ns ms iq lv b gy nt nu l nv nw">[package]<br/>name = "exif-fixer"<br/>version = "0.1.0"<br/>edition = "2021"</span><span id="8c04" class="ns ms iq lv b gy nx nu l nv nw"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span><span id="144c" class="ns ms iq lv b gy nx nu l nv nw">[dependencies]</span><span id="7a0b" class="ns ms iq lv b gy nx nu l nv nw">kamadak-exif = "0.5.4"<!-- --> </span></pre><p id="b01d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，当您运行<code class="fe ls lt lu lv b">cargo build</code>时，cargo会自动下载外部板条箱。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="7391" class="ns ms iq lv b gy nt nu l nv nw">$ cargo build<br/>    Updating crates.io index<br/>  Downloaded mutate_once v0.1.1<br/>  Downloaded kamadak-exif v0.5.4<br/>  Downloaded 2 crates (56.0 KB) in 0.48s<br/>   Compiling mutate_once v0.1.1<br/>   Compiling kamadak-exif v0.5.4<br/>   Compiling exif-fixer v0.1.0 (C:\Users\d2h10s\repository\exif-fixer)<br/>    Finished dev [unoptimized + debuginfo] target(s) in 3.06s</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="ebef" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">支票</h1><p id="3c66" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">有时，我们需要在不编译的情况下检查语法，然后使用<code class="fe ls lt lu lv b">cargo check</code>命令。</p><p id="f078" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个命令不编译和生成可执行的二进制文件。</p><p id="e69f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就<code class="fe ls lt lu lv b">check</code>语法快。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="3275" class="ns ms iq lv b gy nt nu l nv nw">$ cargo check<br/>    Checking mutate_once v0.1.1<br/>    Checking kamadak-exif v0.5.4<br/>    Checking exif-fixer v0.1.0 (C:\Users\d2h10s\repository\exif-fixer)<br/>    Finished dev [unoptimized + debuginfo] target(s) in 0.72s</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="94e5" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">建设</h1><p id="edd9" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">最后，你可以用<code class="fe ls lt lu lv b">cargo build</code>命令构建一个rust包。</p><blockquote class="op oq or"><p id="d9d1" class="kw kx oo ky b kz la jr lb lc ld ju le os lg lh li ot lk ll lm ou lo lp lq lr ij bi translated"><strong class="ky ir">构建是指创建一个可执行的二进制文件。</strong></p></blockquote><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="64e9" class="ns ms iq lv b gy nt nu l nv nw">$ cargo build<br/>    Finished dev [unoptimized + debuginfo] target(s) in 0.01s</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="bf72" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">奔跑</h1><p id="77de" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated"><code class="fe ls lt lu lv b">run</code>命令既能构建又能执行。当然，如果自上次构建以来代码没有改变，货物将只运行而不重建。</p><pre class="kg kh ki kj gt no lv np nq aw nr bi"><span id="1a5e" class="ns ms iq lv b gy nt nu l nv nw">$ cargo run<br/>    Finished dev [unoptimized + debuginfo] target(s) in 0.01s<br/>     Running `target\debug\hello-world.exe`<br/>Hello, world!</span></pre></div></div>    
</body>
</html>