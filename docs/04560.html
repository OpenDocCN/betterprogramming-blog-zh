<html>
<head>
<title>Build a User-Defined Function to Return a Color Based on a Value and Range</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个用户定义的函数来返回一个基于值和范围的颜色</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-user-defined-function-to-return-a-color-based-on-a-value-and-range-1f4838b29b2d?source=collection_archive---------9-----------------------#2020-04-21">https://betterprogramming.pub/build-a-user-defined-function-to-return-a-color-based-on-a-value-and-range-1f4838b29b2d?source=collection_archive---------9-----------------------#2020-04-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="04a6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及复习十六进制颜色代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/234b391ddd5a239d3d4596b69fddc309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CLL79-pF9ff8ffEG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@harshaldesai?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Harshal Desai </a>拍摄的照片。</p></figure><p id="67ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">被困在付费墙后面？点击</em> <a class="ae ky" href="https://medium.com/better-programming/build-a-user-defined-function-to-return-a-color-based-on-a-value-and-range-1f4838b29b2d?source=email-7df0f1b53a6c-1587492880281-layerCake.autoLayerCakeWriterNotification-------------------------79a54e6c_c059_4098_b363_772e866cc97c&amp;sk=e634f8ff1f2335da831a1def475080ad" rel="noopener"> <em class="lv">此处</em> </a> <em class="lv">阅读全文和我的朋友链接。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4d6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很多时候，您需要UI元素的颜色与值保持同步。例如，在预测员工流失时，用较红的字体或背景色表示较高的百分比，用较绿的字体/背景色表示较低的百分比，可能会更有效地传达信息。</p><p id="0714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">tkinter ，Python事实上的标准GUI包，让你可以随意处理很多东西，包括UI元素的颜色。但是，必须提供颜色，而且tkinter中没有动态着色选项。</p><p id="51b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们将构建一个有用的小用户定义函数(UDF ),该函数将根据提供的可能值范围、实际值和调色板的方向，从交通灯渐变调色板返回一个十六进制颜色。</p><p id="d776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要了解什么是十六进制颜色代码。</p><p id="7a91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">十六进制代码是一个格式为#RRGGBB的字符串，其中RR、GG和BB表示十六进制格式的红色、绿色和蓝色分量的强度。十进制颜色强度从0(最暗)到255(最亮)不等。当转换成十六进制时，这转换成00到FF的范围。因此，黑色的十六进制代码是#000000(表示所有三种成分都处于最大黑暗状态)。同样，对于白色来说，是#FFFFFF。对于纯红色、绿色和蓝色，代码分别为#FF0000、#00FF00和#0000FF。</p><p id="c307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以试着用谷歌的颜色选择器<a class="ae ky" href="https://www.google.com/search?q=color+picker" rel="noopener ugc nofollow" target="_blank">来了解它是如何处理黄色、棕色等复合色的。</a></p><p id="1498" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在来看代码。</p><p id="7e30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经创建了一个最小的tkinter UI，它由一个窗口中的标签组成:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="0e3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个程序后，您会看到下面的窗口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/c8561cac825edc85ba3d423db4353e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*_UjzEBr2BUXsgEDpEt3IPg.png"/></div></figure><p id="5824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以看到值为0，背景为灰色。因为我们没有提供背景颜色，所以它默认为灰色。</p><p id="6d68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要添加背景颜色，我们只需要使用<code class="fe mg mh mi mj b">bg </code>参数将它提供给<code class="fe mg mh mi mj b">Label</code>。让我们添加黑色:</p><pre class="kj kk kl km gt mk mj ml mm aw mn bi"><span id="d97e" class="mo mp it mj b gy mq mr l ms mt">pred = Label(mainframe, width=25, text=f"{value}%", bg='#000000', anchor='c',padx=5, font=('TkTextFont',12))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/ccb6d2b6d2c7a1b78fa80ff6e24be2c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*0lNfBOmM1sI36cyh-KB10w.png"/></div></figure><p id="a16f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将创建一个函数，根据值和调色板为标签提供颜色。</p><p id="b763" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，为了简单起见，让我们将我们的范围定义为0到100，0表示不好(红色)，100表示好(绿色)。50会是中性(黄色)。在这种情况下，不良、中性和良好的代码应为#ff0000、#ffff00和#00ff00。从0到50，红色为255 (ff)，绿色从0 (00)逐渐增加到255 (ff)。从50到100，红色从255降到0，绿色保持255。蓝色在两种情况下都保持为0。</p><p id="729c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以表示为:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="617d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个RGB代码现在需要转换成十六进制颜色代码。Python有一个内置的整数到十六进制的转换器。</p><p id="9be8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mg mh mi mj b">print(hex(0))</code>返回<code class="fe mg mh mi mj b">0x0</code>，其中<code class="fe mg mh mi mj b">0x</code>是标识数字基数的前缀。<code class="fe mg mh mi mj b">print(hex(255))</code>返回<code class="fe mg mh mi mj b">0xff</code>。我们只需要忽略前两个字符，用0右填充输出，使其长度为2。对所有三个RGB代码都这样做，得到的字符串以<code class="fe mg mh mi mj b">#</code>为前缀，将其识别为十六进制颜色代码。这个一行程序做到了:</p><pre class="kj kk kl km gt mk mj ml mm aw mn bi"><span id="9a54" class="mo mp it mj b gy mq mr l ms mt">"#%s%s%s" % tuple([hex(c)[2:].rjust(2, "0") for c in (r, g, b)])</span></pre><p id="830b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来测试一下这个逻辑！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="5275" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我修改了标签文本以显示值和十六进制代码。让我们看看0、25、50、75和100的标签是什么样子的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/86ccf28ece8ff1f1617a81227997d348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PM7xFgtSqC2B89vboOywow.png"/></div></div></figure><p id="a0a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完美！</p><p id="fd7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果我们需要改变方向呢？就是现在0是好的，100是坏的？我们只是互换了红色和绿色的值！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="a3da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用<code class="fe mg mh mi mj b">color = hexcolor(value, reverse=True)</code>运行相同的脚本，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/577ef66288cae7b7c132676e5182614d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMjs-PHSVtXvhi-jxg6mdw.png"/></div></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="1690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，自定义范围怎么样？比如0到500？我们将UDF修改如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="da74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用<code class="fe mg mh mi mj b">range = [0, 500]</code>运行脚本给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/4e162b24f371a8373a6e868ce4513ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Mb1XCitiWxQ-RNOxmRJrw.png"/></div></div></figure><p id="6d9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，一切顺利。[-100，500]怎么样？从值-100开始:</p><p id="6778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mg mh mi mj b">_tkinter.TclError: invalid color name “#ffx7f00”</code></p><p id="25d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，由于负值，颜色代码被计算为负值，从而导致无效的十六进制代码。</p><p id="2de8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要做的是确保该范围在UDF转换为正范围。这可以通过将最小值设置为0并将最大值设置为<code class="fe mg mh mi mj b">abs(range[1]-range[0])</code>来实现，这样范围大小保持不变。输入值也需要缩放为<code class="fe mg mh mi mj b">value-range[0]</code>。</p><p id="1ef8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的最终代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="3aac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在-100到500的范围内运行，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/bb61cd8cda15711800569c2edf6c7ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZjdbW0VLI4Ju01PSvpw_Q.png"/></div></div></figure><p id="78ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！一切按预期运行。</p><p id="8c74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个UDF可以用于任何希望用颜色来表示值的UI元素。实现可能不是最有效的，甚至可能有一个包或内置的Python函数已经这样做了。如果你知道任何这样的方法，请让我知道。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="e7ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Medium仍然不支持向印度以外的作者支付费用。如果你喜欢我的内容，你可以给我买杯咖啡:)</p><div class="my mz gp gr na nb"><a href="https://www.buymeacoffee.com/siddhantsadangi" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">Siddhant Sadangi正在Streamlit上创建python网络应用程序</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">嘿👋我刚刚在这里创建了一个页面。你现在可以给我买杯咖啡了！</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ks nb"/></div></div></a></div></div></div>    
</body>
</html>