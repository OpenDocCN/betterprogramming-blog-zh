<html>
<head>
<title>How To Reuse Code in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中重用代码</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-reuse-code-in-react-40637747125f?source=collection_archive---------7-----------------------#2022-02-10">https://betterprogramming.pub/how-to-reuse-code-in-react-40637747125f?source=collection_archive---------7-----------------------#2022-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="90c5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">帮助您以正确的方式共享React代码的技术</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/abca9a3b929dec37960098abc2e0efe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jEOacbJ4tAIDyjJTvVKKiA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由诺埃米·马卡维-卡特茨在<a class="ae kv" href="https://unsplash.com/photos/Zsiuja6HQCU" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图片</p></figure><p id="9e75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嗨！我是EPAM Systems的首席软件工程师，今天我想写下我关于在React项目中重用代码的想法和经验。</p><p id="47bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我正在做一个很酷的项目，有一个非常大的前端代码库，其中大部分是React。我每天都面临代码可重用性的问题，有一些技术我广泛而成功地使用了。这就是为什么我有权利在这个问题上咨询你。</p><p id="fb3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也许你已经从这篇文章中知道了一些或所有的技巧和原则。无论如何，我希望这能给你一些有用的信息，帮助你提高代码库的质量。</p><p id="298a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们走吧！</p><h1 id="1f50" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">一个对抗干和啊哈的故事</h1><p id="16f7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这个设计原则你应该已经知道了——不要重复了。对吗？这听起来绝对清晰合理:必须避免代码重复。但是界限在哪里呢？我们应该避免我们面临的每一个代码重复吗？共享和可重用的最小代码长度是多少？</p><p id="d848" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你知道，这是个棘手的问题。我建议你小心DRY原则，因为它会使你的代码根本不被支持。但是这里的问题是什么呢？</p><p id="f647" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你听说过美国心脏协会的设计原则吗？这个缩写代表避免草率的抽象。<a class="ae kv" href="https://kentcdodds.com/blog/aha-programming" rel="noopener ugc nofollow" target="_blank">肯特·c·多兹</a>有一篇关于这个原则的文章。简而言之，它警告你不要使用大量的抽象。但是什么是抽象呢？这是一段共享和可重用的代码，隐藏在统一的接口下，以防止代码重复！</p><p id="f560" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，你可能会问，真相在哪里？一方面你听说应该避免重复代码，另一方面你听说应该避免抽象(例如，共享代码)。要回答这个问题，我们需要深入探究…</p><h1 id="9b90" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">和谐干和啊哈的故事</h1><p id="eab6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这一节中，我们将寻找一个平衡点。因为这是关于可重用性和可支持性争论的主要问题。让我们从共享一段代码的绿灯开始。</p><p id="d6c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第一步:新功能。想象一下，你正在为你的项目开发一个新的“牛逼功能1”。作为该特性的一部分，您可以添加文件上传功能:这包括“FileDropArea”React组件和“FileUploader”助手类。在这种情况下，我们对实现细节不感兴趣——只是概念性的东西。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="2030" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很明显，在这一步中，共享任何代码都不是一个好主意。所以，我们可以继续了。</p><p id="1a67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二步:多一个新功能。</strong>过了一段时间，现在你正在开发“牛逼功能2”。和前面一样，这里也需要一个文件拖放区。你有什么行动！在大多数类似的情况下，人们会共享“文件放置区”组件。而且在我看来，是完全错误的！这是一个草率抽象的好例子——当你不知道所有可能的用例并试图共享一段代码时。</p><p id="87ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，在这种情况下该怎么办呢？请为“awesome-feature-2”复制一份文件拖放区组件。这个副本可能与最初的示例有一些不同，这是绝对可以的——在这一步，您不需要分享任何内容。</p><p id="8371" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步:还有一个新功能。</strong>又是一样的:新的“牛逼功能3 ”,带文件拖放区。我简单说一下。这是共享文件放置区的理想时刻。您需要为这个共享的React组件开发一个统一的API，并在包含该功能的所有特性中重用它。</p><p id="df75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你会如何组织它？这是我的建议。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h1 id="9b0d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">错误的抽象</h1><p id="b258" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在你可能会问如何识别草率的抽象并避免它们。你应该看看肯特·c·多兹的那篇文章。这是我的观点。</p><p id="521d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">避免抽象上的抽象。少说话，举有用的例子。假设我们有一个函数来检查用户是否属于某种类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="00ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个正确用法的例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="df3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个错误用法的例子，代表了抽象上的抽象。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="415f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，有些情况下我们需要抽象上的抽象。但是在大多数情况下，像<code class="fe mt mu mv mw b">getIsUserOfType</code>这样的底层函数不应该有这样的抽象。</p><p id="8aca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">控制重复代码</strong>。你应该知道如何以正确的方式复制代码。最有可能的是，在你的项目中有一个关于代码重复的明确政策是一个好主意。</p><p id="cc0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有两种类型的重复代码:</p><ul class=""><li id="95a6" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">为功能/应用程序提供灵活性的重复代码。</li><li id="4b71" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">等待被通用和共享的重复代码。</li></ul><h1 id="9b92" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何分享代码？</h1><p id="7dde" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我不想写很多关于React技术的文字来分享代码。为什么？只是因为这个话题的文章很多！有一些你应该注意的事项。</p><p id="a609" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">特设。</strong>在引入React挂钩之前，这是一个标准且使用最广泛的技术。还是有很多有用的libs曝光HOCs的。您也可以创建自己的自定义。但是可以考虑用钩子。</p><p id="2f98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">反应钩子。这是你可以用来重用代码的最好的东西。我现在广泛使用它。</strong></p><p id="d154" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">共享组件。</strong>最简单的选择。我们在“第3步:还有一个新特性”一节中看到了它。它与<a class="ae kv" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank">故事书</a>和<a class="ae kv" href="https://bit.dev/" rel="noopener ugc nofollow" target="_blank">比特</a>配合得非常好。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="1d84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！</p><p id="53e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在医院的两天里开始写这篇文章。它看起来更像是一套论文，你可以用它来深入研究，并根据自己的需要进行调整。希望这对你有帮助。</p><p id="f71b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们保持联系。</p></div></div>    
</body>
</html>