# 设计分布式系统的 4 个关键方面

> 原文：<https://betterprogramming.pub/4-key-aspects-for-designing-distributed-systems-dc8fec7b8c5b>

## 帮助您构建能够处理不断变化的需求并长期保持功能的系统的提示

![](img/95eb20fa7348f3783a620c58552a1902.png)

[简·侯伯](https://unsplash.com/@jan_huber?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍照

如果您曾经使用过分布式系统或简单的 web 应用程序，您可能会遇到一个或多个这样的概念。听起来都差不多，但指的都是完全不同的东西。让我们检查一下！

# 可靠性

分布式软件系统的可靠性是指它在不引起问题或停机的情况下处理意外事件或故障的能力。换句话说，它衡量系统的可靠性。

粗略地说，可靠性就像总是有一个备份计划——甚至为您的备份计划有一个备份计划。这个系统可以让事情顺利进行，即使事情变得不顺利。

## 为什么重要？

作为用户，我们通常希望东西是可靠的。如果一个元素，不管它是什么，在关键时刻可能失败或变得不可用，它可能会给我们带来一些不便。想象一辆车。如果我们不知道引擎是否会在我们需要搭车时开启，我们就不会信任它。软件也一样。如果用户失去信心，他们将停止使用它，这可能会损害创建它的人的声誉。

但是缺乏信任并不是唯一的问题。如果一个系统在关键时刻出现故障，它将损害依赖它的任何业务，这可能会产生经济或法律后果。

## 如何为其构建

作为一个系统架构师，你需要考虑到错误。各种各样的错误都会发生。硬件、软件、人为错误:如果你的系统寿命足够长，它将遭受所有这些。在他的书《设计数据密集型应用程序》中， [Martin Kleppmann](https://medium.com/u/13be457aed12?source=post_page-----dc8fec7b8c5b--------------------------------) 说他*通常更喜欢容忍错误而不是预防错误，除非在预防胜于治疗的情况下，因为不存在治疗*。

这是一个很好的经验法则——考虑故障将会发生，以及您的系统将如何对其做出反应。

在这里有帮助的工具是一个完整的测试套件，包括单元测试、集成和端到端测试。一个良好的监控系统，当指标表现异常时，它会触发自动警报；一个或几个类似生产的环境，具有真实数据，开发人员可以在其中安全地探索和破坏事物。

# 有效性

分布式软件系统的可用性指的是在任何给定的时间用户对它的可访问性。换句话说，它衡量系统启动和运行的频率，随时可以使用。

粗略地说，分布式软件系统的可用性就像一个好的聚会主持人——当你需要他们的时候，他们总是在那里，并且总是准备好让聚会开始。该系统可以随时准备就绪，随时为用户提供服务。

## 为什么重要？

这可能没那么重要，取决于您的用例。想到实体店；他们并不总是可用的。也许你的软件每天会运行几次，因为你在别处发布了一些数据。或者您可能正在汇总和聚集数据以生成每日报告。但是，高可用性对于任务关键型应用程序非常重要，或者用于停机可能会带来严重后果的行业，如医疗保健或金融行业。

## 如何为其构建

这高度依赖于您的系统基础设施。您计划在本地构建一切，还是依赖云提供商？如果在本地，您必须保持自己的服务器全天候运行，并保持良好的硬件冗余。

如果您转向云原生，提供商通常会为您处理大部分这些事情。我前阵子用 AWS 写了一些关于[高可用性架构](https://medium.com/aws-in-plain-english/road-to-aws-saa-high-availability-architecture-80d0579d0086)的东西。

# 可维护性

分布式软件系统的可维护性是指更新、修复或修改系统的容易程度。换句话说，它衡量系统在一段时间内的维护情况。

粗略地说，分布式软件系统的可维护性就像一辆可靠的旧车，易于操作，并且总是平稳运行。这是系统保持良好工作状态的能力，即使它已经老化，需要一些调整。

## 为什么重要？

你的系统的需求会随着时间而改变——这就是生活。如果你不指望它，你最终会设计出一个非常特殊的利基系统，这将是地狱般的延伸，如果你的系统不进化，它就会死亡。

## 如何为其构建

可悲的是，对此没有一个好的和独特的答案。一些众所周知的原则你可以应用到你的代码中，像[稳固](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)、[亲亲](https://en.wikipedia.org/wiki/KISS_principle)，或者 [YAGNI](https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it) ，赞美简单。

我发现 Python 的[禅很好地总结了如何编写代码:](https://peps.python.org/pep-0020/)

> 漂亮总比难看好。
> 显性比隐性好。
> 简单比复杂好。
> 复杂总比复杂好。
> 扁平比嵌套好。
> 稀疏胜于密集。
> 可读性很重要。特例不足以特殊到打破规则。
> 虽然实用性战胜了纯度。错误永远不会无声无息地过去。
> 除非明确消音。
> 面对暧昧，拒绝猜测的诱惑。应该有一种——最好只有一种——显而易见的方法。虽然这种方式一开始可能并不明显，除非你是荷兰人。
> 现在总比没有好。
> 虽然从来没有经常比现在*好。
> 如果实现很难解释，那就是个坏主意。
> 如果实现容易解释，可能是个好主意。
> 名称空间是一个非常棒的想法——让我们多做一些吧！

# 可量测性

分布式软件系统的可伸缩性是指它在不导致性能问题的情况下，处理用户或数据数量增加的能力。换句话说，它衡量系统适应不断变化的工作负载的能力。

大致来说，可伸缩性就像终极派对主持人(是的，我再次使用了相同的比喻，因为我喜欢它。告我)。不管来了多少客人，他们总能在餐桌旁找到一个座位，喝上一杯。无论人群有多大，这个系统都能满足需求。

## 为什么重要？

即使在工作负载增加的情况下，也能让系统继续平稳运行。想象一下，一个网站突然变得像病毒一样传播，并获得大量流量。如果它是不可扩展的，那么当许多用户试图同时访问它时，它可能会变得很慢或者没有响应，这将导致糟糕的用户体验。

## 如何为其构建

您需要做的第一步是定义您系统的负载是什么。这可能包括以下内容:

*   用户或并发用户的数量
*   每秒或每分钟的请求数
*   你托管的文件的大小，或者可能是文件大小和同时发布它们的用户数量的组合
*   完全不同的东西

第二步是定义什么是性能指标。同样，它可以是几个东西，尽管在 web 服务中，它通常是用户等待输出的时间的度量，也称为响应时间。

然后，你需要弄清楚负载增加的速度是快还是慢，是否会出现峰值。想想酒吧——星期二和星期六会同样拥挤吗？如果那个星期二是足球世界杯半决赛呢？

基于所有这些信息，您将能够决定，对于您的特定场景，在保持性能的目标下，是纵向扩展(纵向扩展，这意味着我需要我的机器更强大)还是横向扩展(横向扩展，大致可以理解为我的机器很好，但我需要更多机器)。请记住，这两种方法的混合也是可能的，而且以我的经验来看，更常见。

# 最后的想法

总之，在设计分布式系统或者任何种类的软件系统时，可维护性、可伸缩性、可靠性和可用性都是需要考虑的重要因素。关注这些关键方面可以确保我们的系统能够处理不断变化的需求，并随着时间的推移保持正常运行，同时提供良好的用户体验。

希望这篇介绍能让你更好地理解它们是什么以及它们为什么重要。

# 参考资料:

[1] [马丁·克莱普曼](https://medium.com/u/13be457aed12?source=post_page-----dc8fec7b8c5b--------------------------------)，[设计数据密集型应用:可靠、可扩展和可维护系统背后的伟大理念](https://www.oreilly.com/library/view/designing-data-intensive-applications/9781491903063/) (2017)，奥赖利