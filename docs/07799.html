<html>
<head>
<title>Visualize Charts Using Groupby and Aggregate Python Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Groupby和聚合Python函数可视化图表</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/visualize-charts-using-groupby-and-aggregate-python-functions-56454820a25c?source=collection_archive---------0-----------------------#2021-02-20">https://betterprogramming.pub/visualize-charts-using-groupby-and-aggregate-python-functions-56454820a25c?source=collection_archive---------0-----------------------#2021-02-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="21ac" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">图形可视化</h2><div class=""/><div class=""><h2 id="8afb" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">让我们制作吸引人的图表</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3a8ef8b632b421fdda70797536a8403a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d_75ZnqlkbmPsbi9"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@isaacmsmith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5eb0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">可视化是向用户展示结果的关键部分。这些图表帮助我们更好地理解数据，了解数据的过去、现在和未来。</p><p id="bd99" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python提供了一些有用的函数，我们可以利用这些函数将数据转换成图形表示。本文将展示我们如何有效地将Groupby &amp; Aggregate函数与matplotlib和seaborn函数结合使用，来制作数据的漂亮图形表示。</p><p id="92e1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在真正开始使用部分之前，我们先简单讨论一下这两个功能是什么。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="18d7" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">Groupby函数</h1><p id="5524" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">Groupby函数应用于数据集，并根据列值提供一组分组数据集。简单地说，如果任何列都有一组值，那么我们需要一个更小的数据集，其中每个更小的数据集都包含基于该列的每种类型的值。</p><p id="22f0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设我们有一个数据集，其中有一个名为“Region”的列，我们想要一组数据集，其中每个较小的数据集代表每个区域。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/9417c59d6ddbeecb23b955e0b9a11b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dilmAJXAfBmIIbC9zpO8sA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">演示数据集</p></figure><p id="3047" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以使用下面的代码:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="16e7" class="no mm it nk b gy np nq l nr ns"><strong class="nk jd">test=sales.groupby(by=["Region"])</strong></span></pre><p id="6704" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里，主数据集名称是sales，它有一个名为“Region”的列我们可以利用get_group函数来获取特定的组，如下所示:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="7ba1" class="no mm it nk b gy np nq l nr ns"><strong class="nk jd">test.get_group("East")</strong></span><span id="6805" class="no mm it nk b gy nt nq l nr ns"><strong class="nk jd">test.get_group("West")</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/52795424907b7aee71fa04f6ed2ee375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*B33NDpiqKAnOKPPLUPuxhw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于特定区域的较小数据集</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/d2a7deae63f19300735c0f8ade264a37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*iYL6vh6gkRrgfiGjigBGNA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于特定区域的较小数据集</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="e645" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">聚合函数</h1><p id="e89c" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">aggregate函数用于根据行聚合数据。它通常与Groupby函数一起用于分析每个组中的聚合数据。聚合函数有<code class="fe nw nx ny nk b">sum</code>、<code class="fe nw nx ny nk b">min</code>、<code class="fe nw nx ny nk b">max</code>、<code class="fe nw nx ny nk b">mean</code>、<code class="fe nw nx ny nk b">median</code>以及其他许多数学函数，我们可以利用它们进行多种聚合。</p><p id="2e67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设在我们的销售数据中，我们希望获得每个地区的平均销售额。在这里，我们可以如下使用聚合函数:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="3dba" class="no mm it nk b gy np nq l nr ns"><strong class="nk jd">gb_sales_demo=sales.groupby(by=["Region"]).aggregate({"Sales2016":"sum"})</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b95e3dba6f767e65155a9df49bcc0084.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*VZ0idPd7hQ1YlTDLe3sTxQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每个地区的平均销售额</p></figure><p id="126a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们使用这两个函数来制作有趣的图形。我们将使用matplotlib和seaborn根据我们创建的聚合数据来可视化图表。</p><p id="8434" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们先来看看我们将用于可视化的数据集。后续文章的数据集可以在<a class="ae lh" href="https://github.com/pranjalAI/Walmart-Store-Sales-Forecasting/blob/master/SalesData.csv" rel="noopener ugc nofollow" target="_blank">这里</a>找到。它是一个CSV文件，可以使用python中的pandas模块加载。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/ff7c21dd736c133fca51adde9112c917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gt94c-lBplUqDTS84tFrNw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">可视化演示数据集。</p></figure><h2 id="8b8f" class="no mm it bd mn ob oc dn mr od oe dp mv lr of og mx lv oh oi mz lz oj ok nb iz bi translated"><strong class="ak">使用柱状图对比2016年和2015年各地区的销售额。</strong></h2><p id="6548" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">为了创建这个图表，我们使用以下代码:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="095b" class="no mm it nk b gy np nq l nr ns">import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="1d56" class="no mm it nk b gy nt nq l nr ns"><strong class="nk jd">gb_sales=sales.groupby(by=["Region"]).aggregate({"Sales2015":"sum", "Sales2016":"sum"})<br/>res=gb_sales_demo.reset_index()<br/>res_wide=res.melt(id_vars="Region")</strong></span><span id="2b31" class="no mm it nk b gy nt nq l nr ns"><strong class="nk jd">plt.figure(figsize=(10,8))<br/>sns.barplot(x="Region", y="value",data=res_wide, hue="variable")<br/>plt.show()</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/d7f3c34ce1c892de9c352ebf88c35a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOgg_HEX_-4keY2lWfbu1Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">不同地区的图表(条形图)</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="f5e1" class="no mm it bd mn ob oc dn mr od oe dp mv lr of og mx lv oh oi mz lz oj ok nb iz bi translated"><strong class="ak">哪个地区对2016年的销售额贡献最大？</strong></h2><p id="a7ce" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">为了找到该区域，我们使用以下代码:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="ce87" class="no mm it nk b gy np nq l nr ns">import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="3a31" class="no mm it nk b gy nt nq l nr ns">gb_sales2=sales.groupby(by="Region")[["Sales2016"]].sum()<br/>res_2=gb_sales2.reset_index()</span><span id="30cd" class="no mm it nk b gy nt nq l nr ns">plt.pie(x="Sales2016",labels="Region", data=res_2, autopct="%.2f %%",colors=["r","g","b"])<br/>plt.xlabel("Sales 2016")<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/6e3ce9ddcee4f3aa793b83ade68d6558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*v35PzNVwLNdTGe0vrip8mw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">饼图直观显示每个地区的贡献</p></figure><h2 id="843f" class="no mm it bd mn ob oc dn mr od oe dp mv lr of og mx lv oh oi mz lz oj ok nb iz bi translated">比较2015年和2016年在地区和层级方面的总销售额</h2><p id="9a0b" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">为了找到这些层，我们使用以下代码:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/c145e4d7e8d6cf69fef06f1b3fd483a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkwgkoWTtLqDONFTH_rpTw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">了解我们的数据层</p></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="c288" class="no mm it nk b gy np nq l nr ns">gb_sales3=sales.groupby(by=["Region", "Tier"]).aggregate({"Sales2015":"sum", "Sales2016":"sum"})</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/27298e7be0b1b7069be0bb5e58b3b0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*lI59-qk2vDJERKk5ZVJjmw.png"/></div></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="b863" class="no mm it nk b gy np nq l nr ns">gb_res_3=gb_sales3.pivot_table(index="Region", columns="Tier", values=["Sales2015","Sales2016"])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/cd30544364feb48bd902e8af148a336e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gscVMXxjRFaeh1koN3LWzg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">转换到数据透视表后</p></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="12a5" class="no mm it nk b gy np nq l nr ns">plt.figure(figsize=(10,8))<br/>gb_res_3.plot.bar(figsize=(18,6))<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/2b5a37eca9093c260b104ca3432c301f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1b_yyMy3HB8EmZ-7nN_pw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">2015年和2016年的区域和层级销售额</p></figure><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="e8fd" class="no mm it nk b gy np nq l nr ns">plt.figure(figsize=(10,8))<br/>res_3.plot(kind="bar",stacked=True)<br/>plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/2fb826e86c1f57c33248567c33f2e5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vS996NxkoFOAFUf8CGu_Lg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">2015年和2016年各地区和层级的销售额(堆积图)</p></figure><h2 id="fc0c" class="no mm it bd mn ob oc dn mr od oe dp mv lr of og mx lv oh oi mz lz oj ok nb iz bi translated">根据2015年和2016年售出的产品数量，比较不同部门的高端产品</h2><p id="1d80" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">使用以下代码完成此任务:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="8d36" class="no mm it nk b gy np nq l nr ns">sales_tier_high=sales[sales.Tier=="High"]<br/>gb_div=sales_tier_high.groupby(by="Division").aggregate({"Units2015":"sum", "Units2016":"sum"})</span><span id="bcbf" class="no mm it nk b gy nt nq l nr ns">gb_div.plot.bar(figsize=(18,6))</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/bc9d330e86dee4620be163067285c6e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3aXHQYEDZOf22tc7qYRcg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">比较不同部门</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="bbfc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">文章到此为止。我希望您喜欢我们如何有效地利用seaborn和matplotlib的Groupby和aggregate函数来制作表示数据的有吸引力的图形。</p></div></div>    
</body>
</html>