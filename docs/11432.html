<html>
<head>
<title>Color Blending and Off-Screen Rendering in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的颜色混合和屏幕外渲染</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/color-blending-off-screen-rendering-in-swift-2ea2a88f6923?source=collection_archive---------3-----------------------#2022-03-19">https://betterprogramming.pub/color-blending-off-screen-rendering-in-swift-2ea2a88f6923?source=collection_archive---------3-----------------------#2022-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="66cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">提高旧款iPhones的性能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dde7595344d419f158dda5202d98257d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_oze_gBiBQwYWjFe8H4Pg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@rcsalbum?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">德巴斯RC Biswas </a>在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="3414" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于iPhones的强大功能，颜色混合和屏幕外渲染对于iOS开发来说都是一个不受重视的话题。</p><p id="0859" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一方面，它不仅是iOS采访的热门话题，而且如果你在旧iOS版本的列表中处理大量高分辨率图像，它可以提高滚动动画的速度，以在缓存任何项目之前最大限度地减少滚动期间的冻结，并在需要时显示它。我们来讨论一下这些话题是什么。</p><h2 id="33e5" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">颜色混合和屏幕外渲染</h2><p id="f0ab" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">当我们在iOS中创建新的UI元素如<code class="fe mq mr ms mt b">UIView</code>、<code class="fe mq mr ms mt b">UIImageView</code>时，它是通过CPU渲染的。作为iOS开发者，我们经常会遇到复杂的UI挑战。像改变阿尔法，阴影，预期元素的圆角半径。</p><p id="4fe0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在类似的情况下，它是通过当前设备的GPU而不是其CPU渲染的——取决于设备的功能，fps(每秒帧数)会下降。这就是iOS里的离屏渲染，混色。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="d890" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要在模拟器上启用混合层和屏幕外渲染，从菜单顶部选择<code class="fe mq mr ms mt b">Debug</code>，选择颜色混合层和颜色错位图像。让我们回到我们的例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e47c6b5517aee01917733871daa62b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*XVYsLxnawovhwYA82_qHKA.png"/></div></figure><p id="c278" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的示例中，我们有一个表视图来显示1000个项目及其在表视图的<code class="fe mq mr ms mt b">datasource</code>函数中的配置。</p><p id="0994" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分别设置当前图像视图的圆角半径和更改背景颜色以清除触发器的屏幕外渲染和颜色混合。</p><p id="f34e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为，在后台，我们设备的GPU负责绘制，当任何阴影落下时，设置现有UI元素的圆角半径。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="3665" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在模拟器中，输出是这样的。黄色代表离屏渲染，绿色和红色代表颜色混合。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/0a6c637091fa9e9efe2919482ffd1567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*TlyNnVjIwKBk7lbYBNB9og.png"/></div></figure><p id="e19d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了解决这些问题，让我们改变标签的背景颜色，通过改变为白色来防止标签的颜色混合<strong class="ky ir">。</strong>我们可以关闭颜色混合层选项，以便只在图像上进行屏幕外渲染。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d8ccd298785967e567df89815ec9b3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*h7MJELl0pKe4GoiN9Fojxg.png"/></div></figure><p id="00f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了防止在我们的图像视图上进行离屏渲染，让我们创建一个贝塞尔路径来绘制它，而不是设置图层拐角。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="8b7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要像这样更新舍入实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/4da39e15d940b0c609c6ade4ecd71a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*zWHjtrVt5EjQGTuYR7qGug.png"/></div></figure><p id="a34e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，屏幕外渲染黄色消失了。</p><p id="f6d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于圆角半径的实现，我们使用bezier路径来圆化现有的图像视图，以防止屏幕外渲染，并且我们防止使用alpha 0来设置标签的背景颜色。这两个实现都提高了我们的应用程序UI性能。</p><p id="45b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在仪器或其他工具中检查它。</p><p id="14f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>