<html>
<head>
<title>GitHub Flow vs. OneFlow: Which Git Workflow Works the Best for You?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitHub流与OneFlow:哪种Git工作流最适合你？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-simple-git-repository-strategy-93a0c7450f23?source=collection_archive---------0-----------------------#2022-04-23">https://betterprogramming.pub/a-simple-git-repository-strategy-93a0c7450f23?source=collection_archive---------0-----------------------#2022-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="282d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我在团队中使用的一个简单的Git存储库策略</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9d0d5906ea7d2a9133d9f26fc12317ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDd_LRmc9oVQif2n4Q14SA.png"/></div></div></figure><h1 id="a205" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="a6ad" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">多年来，我一直在使用大家所说的<a class="ae mf" href="https://nvie.com/posts/a-successful-git-branching-model/" rel="noopener ugc nofollow" target="_blank"> Git Flow </a>模型来组织代码分支、环境和部署。虽然这不是作者的本意，但我遇到的许多人对此已经变得相当教条。作者自己在2020年的“回顾”笔记中指出了这一点。</p><p id="3f56" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">接受教条的问题在于，当我们认为这是唯一可行的方法时，我们会停止寻找替代方案或可能的改进。</p><h1 id="865d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">问题</h1><p id="6be4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">尽管Git Flow对于它所创建的软件类型来说仍然非常有用。正如它的作者Vincent Driessen在2020年所说:<em class="ml">“如果(…)你正在构建明确版本化的软件，或者如果你需要在野外支持你的软件的多个版本，那么Git Flow可能仍然像过去10年对人们一样适合你的团队”</em>。</p><p id="40d8" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我领导的团队更专注于开发Web应用和API，Git流模型增加了不必要的复杂性。在大多数这些项目中，分支master和develop是高度冗余的，在分支之间产生了许多合并问题，并且产生了难以跟踪的意大利面条git历史。更不用说有多少团队甚至在此基础上增加了一个舞台分支。</p><p id="07ab" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果我们考虑当前的CI / CD实践，很明显所有这些额外的努力和问题都变成了不必要的文书工作，偷走了任何开发人员的快乐和生产力。</p><h1 id="9f0a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">我走过的路</h1><p id="ecb4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我对不断的合并冲突(以及由此产生的开发人员冲突)感到有些厌倦，并决定研究一下其他团队在做什么。</p><p id="52d2" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我从大的开始，惊讶地发现Google使用的是只有一个长期分支的mono库:master。对于真正的CI / CD，每次提交都是一次释放！</p><p id="e8e4" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">这让我质疑为什么我要使用如此复杂的模型。我第一次向我的一个团队提到这件事时，有一种“这不可能是真的！”“如果我们那样做，我们的产品就会一直坏掉！”。它让我意识到，我们创建步骤越来越多的复杂系统的主要原因是恐惧！许多项目没有必要的故障保险(自动测试、代码审查等)。</p><p id="0bd0" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">那时我开始做更多的调查，很多基于<a class="ae mf" href="https://www.endoflineblog.com/oneflow-a-git-branching-model-and-workflow" rel="noopener ugc nofollow" target="_blank"> OneFlow </a>模型的人决定找到一个适合大多数团队的中间地带。对于简单的项目，我使用的是<a class="ae mf" href="https://docs.github.com/en/get-started/quickstart/github-flow" rel="noopener ugc nofollow" target="_blank"> GitHub Flow </a>模型，有一个真正的CI / CD过程:只有一个主分支和为特性和bug修复创建的分支，在完成时直接合并到主分支。</p><p id="e01c" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">当团队越来越大，项目越来越复杂时(任何人？)，然后我应用我的简化版OneFlow模型，每周发布一次。这就是我在这里描述的模型。</p><h1 id="e57b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">单流模型</h1><p id="fdcc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当项目很复杂和/或公司/客户希望或需要对发布的内容有更大的控制权时，我会使用这种模型。这通常与以下一个或多个因素有关:</p><ul class=""><li id="e53c" class="mm mn iq ll b lm mg lp mh ls mo lw mp ma mq me mr ms mt mu bi translated">没有适当的自动化测试，并且依赖于QA团队(最常见的情况)的旧系统。</li><li id="9696" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">由于过去发生的事情，业务团队缺乏信任(通常与大型企业或缺乏经验、薪酬低的团队有关)。</li><li id="3c6c" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">如果出现问题，后果会非常严重的产品(例如银行、医院、军队等)。</li></ul><h2 id="3cae" class="na ks iq bd kt nb nc dn kx nd ne dp lb ls nf ng ld lw nh ni lf ma nj nk lh nl bi translated">分支</h2><p id="ead3" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">你可能不需要所有这些类型的分支，但主要的一点是，只有一个长寿的分支:主人。</p><ul class=""><li id="3044" class="mm mn iq ll b lm mg lp mh ls mo lw mp ma mq me mr ms mt mu bi translated"><code class="fe nm nn no np b">master</code>:唯一永恒的分支。主分支被认为是主要分支，应该总是处于发布就绪和生产就绪状态。</li><li id="81ab" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><code class="fe nm nn no np b">release/x.y.z</code>:准备推出的版本。一旦标记了版本，它就被发布。然后它被合并到主文件。</li><li id="0670" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><code class="fe nm nn no np b">feature/XYZ-1234:</code>链接到故事或任务单的功能。一旦完成，它就被合并到主文件中。</li><li id="b719" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><code class="fe nm nn no np b">bugfix/XYZ-1234</code>:链接到高、中、低或最低Bug单的修复。一旦完成，它就被合并到主文件中。</li><li id="5266" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><code class="fe nm nn no np b">hotfix/XYZ-1234</code>:链接到最高Bug票的修复。它取自带有最新版本标签的提交。一旦标记了版本，它就被发布。然后它被合并到主文件。</li></ul><h2 id="93ff" class="na ks iq bd kt nb nc dn kx nd ne dp lb ls nf ng ld lw nh ni lf ma nj nk lh nl bi translated">拉取请求</h2><p id="446c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在一个特性或者一个bug分支被合并到master之前，一个Pull请求必须由开发人员创建，并且只有当这个Pull请求被至少两个开发人员批准后，它才应该被合并。</p><p id="1023" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在合并之前对代码进行良好的测试是很重要的，这意味着具有高代码覆盖率的自动测试，并且依赖于团队，可能得到产品所有者和QA团队的批准。</p><h2 id="067d" class="na ks iq bd kt nb nc dn kx nd ne dp lb ls nf ng ld lw nh ni lf ma nj nk lh nl bi translated">环境</h2><p id="d9fa" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们有更少的分支机构并不意味着我们有更少的环境。根据您的团队是如何组织的，您可能需要或不需要所有这些环境。检查真正的需求。而是自动化整个过程。</p><ul class=""><li id="b173" class="mm mn iq ll b lm mg lp mh ls mo lw mp ma mq me mr ms mt mu bi translated"><strong class="ll ir">生产</strong>:现场环境，客户在这里使用产品。</li><li id="6f92" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><strong class="ll ir">准备</strong>:用于发布前QA测试的类似生产的环境。如果我们在做真正的CI / CD，就不需要这个了。</li><li id="9c37" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><strong class="ll ir">开发</strong>:当不可能或不希望在本地启动完整的环境时用于开发。一个很好的例子是前端开发人员想要使用一个刚刚开发的API端点。也可由QAs或POs用于特殊测试。</li><li id="8a49" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><strong class="ll ir">测试</strong>:用于运行自动测试。在每次提交时创建、运行和销毁。通常作为CI / CD流程的一部分。</li><li id="9dea" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated"><strong class="ll ir">特性</strong>:更大的特性，需要单独测试。可由PO用于验证。它会在需要时按需创建，并在不再需要时销毁。</li></ul><h1 id="9441" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">GitHub流量模型</h1><p id="7303" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当团队和/或项目很小时，我使用<a class="ae mf" href="https://docs.github.com/en/get-started/quickstart/github-flow" rel="noopener ugc nofollow" target="_blank"> Github流</a>模型。这意味着master上的每次合并都变成了一次发布，同时发生实时CI / CD。</p><p id="a37c" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">与上面的OneFlow模型相比，我消除了对发布分支的需求以及与之相关的版本标记复杂性。我仍然添加版本标签，但它们是直接在master上完成的。</p><p id="c1b1" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">每当你合并到master时，没有什么比在生产中直接发布某些东西的感觉更能唤醒你了。YOLO:)</p><h1 id="c52e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结果</h1><p id="6c18" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">那么，这对我和我的团队有什么作用呢？很好，我不得不说。每当我提出这个建议时，团队中总会有一些恐惧和抵制，但结果非常好:</p><ul class=""><li id="3d26" class="mm mn iq ll b lm mg lp mh ls mo lw mp ma mq me mr ms mt mu bi translated">更快乐的开发人员觉得他们可以更专注于开发，而不是官僚主义和问题。</li><li id="104c" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">合并冲突导致的个人冲突更少。</li><li id="af54" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">更少的人为错误(更少的机会合并到错误的分支并产生合并冲突)。</li><li id="5a69" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">对于DevOps团队来说，流程更容易自动化。</li><li id="1832" class="mm mn iq ll b lm mv lp mw ls mx lw my ma mz me mr ms mt mu bi translated">业务部门更容易理解流程。</li></ul><p id="d758" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">但它总是从与人们交谈开始，并展示替代方案的好处。然后邀请他们勇敢尝试。害怕是正常的，但不要让恐惧阻止你向对你和你的团队更好的方向前进。</p><p id="aa91" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">从OneFlow开始，每周或每两周发布一次。你在那里仍然是100%安全的，除非你决定，否则什么都不会被释放。随着你和你的团队在这个过程中获得信任，并越来越好地自动化，有一天你将能够决定使用GitHub Flow完全自动地发布你的一些产品。没必要着急。</p><h1 id="4a5f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">参考</h1><div class="nq nr gp gr ns nt"><a href="https://nvie.com/posts/a-successful-git-branching-model/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">一个成功的Git分支模型</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">这个模型是在10多年前的2010年构思的，当时Git刚刚诞生不久。在…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">nvie.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kp nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://www.endoflineblog.com/oneflow-a-git-branching-model-and-workflow" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">one flow-Git分支模型和工作流</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">在“GitFlow被认为是有害的”一文中，我概述了我成功使用的另一种Git版本控制工作流…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">www.endoflineblog.com</p></div></div><div class="oc l"><div class="oi l oe of og oc oh kp nt"/></div></div></a></div><div class="nq nr gp gr ns nt"><a href="https://docs.github.com/en/get-started/quickstart/github-flow" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">GitHub流- GitHub文档</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">GitHub flow是一个轻量级的、基于分支的工作流。GitHub流对每个人都有用，不仅仅是开发者。对于…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">docs.github.com</p></div></div><div class="oc l"><div class="oj l oe of og oc oh kp nt"/></div></div></a></div></div></div>    
</body>
</html>