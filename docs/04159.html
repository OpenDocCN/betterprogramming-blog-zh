<html>
<head>
<title>This Is Enough Shell Scripting to Make an Impressive Impact</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这些Shell脚本足以产生令人印象深刻的影响</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/this-is-enough-shell-scripting-to-make-an-impressive-impact-974709fab378?source=collection_archive---------9-----------------------#2020-03-26">https://betterprogramming.pub/this-is-enough-shell-scripting-to-make-an-impressive-impact-974709fab378?source=collection_archive---------9-----------------------#2020-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="397e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一小段代码可以走很长的路</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/da15168273b7fc2124ff1591d164ba93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o7cDHZ28Dv1q60fg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由mauricio Santos在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="350e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你见过寿司师傅用武士刀切鱼吗？是啊，我也是。它可能看起来很棒，但我们都同意这样的刀片不是将鱼变成晚餐的最佳工具。</p><p id="9729" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我喜欢Python，我已经用它做了很多大大小小的事情，但是如果编程语言是刀片，那么即使是像Python这样的高效语言对于小而琐碎的任务来说也会感到沉重和笨拙。</p><p id="de2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这样的任务，shell脚本可以强大得多，因为它提供的保证甚至比Python或JavaScript更少，但使您能够更快地自动化。</p><p id="e216" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能会问，“那么，具体是在什么时候？”。在我看来，这在以下情况下很有用:</p><ul class=""><li id="0bad" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">手头的任务相当小，您的自动化不需要防错。</li><li id="a8a5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如果自动化不工作，您仍然可以手动进行。那会花费你更多的时间，但也不是不可能的。</li><li id="f199" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">您可以根据终端中的几个命令来考虑您的任务</li></ul><p id="e965" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">shell脚本最棒的地方在于，您不需要知道太多就可以开始变得更有效率。通常情况下，你甚至不会启动文本编辑器。我将把重点放在你大部分时间实际需要的必需品上。</p><p id="a424" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a81d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">循环</h1><p id="8b62" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">您可以使用以下语法执行for循环:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5d4d" class="ns mr it no b gy nt nu l nv nw">$ for thing in 0 1 2 "string" 4; do echo $thing; done;<br/>0<br/>1<br/>2<br/>string<br/>4</span></pre><p id="7ce1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，美元符号意味着<code class="fe nx ny nz no b">thing</code>是一个变量——它本身不是一个符号。</p><p id="e6b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">知道这一点很好，但很少有用。您还可以生成更强大的数字序列。语法稍有不同:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="18af" class="ns mr it no b gy nt nu l nv nw">$ for number in {0..5}; do echo $number; done;<br/>0<br/>1<br/>2<br/>3<br/>4<br/>5</span></pre><p id="1a26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在一个文件上存储一个命令的输出，你只需要使用<code class="fe nx ny nz no b">&gt;&gt;</code>重定向操作符。<code class="fe nx ny nz no b">&gt;&gt;</code>将追加到文件中，而<code class="fe nx ny nz no b">&gt;</code>将用新内容替换旧文件。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0e00" class="ns mr it no b gy nt nu l nv nw">$ for number in {0..5}; do echo $number &gt;&gt; numbers.txt; done;</span></pre><p id="2591" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想看看它长什么样吗？你可以做<code class="fe nx ny nz no b">cat numbers.txt</code>或者只做<code class="fe nx ny nz no b">head numbers.txt</code>，如果太长了，你只想看一眼。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5874" class="ns mr it no b gy nt nu l nv nw">$ cat numbers.txt<br/>0<br/>1<br/>2<br/>3<br/>4<br/>5</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0453" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">命令替换和管道</h1><p id="ba86" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果不能利用终端中已经可用的各种命令，你将不会走得很远——更不用说可以用包管理器安装的东西，如<code class="fe nx ny nz no b">apt</code>或<code class="fe nx ny nz no b">brew</code>、<code class="fe nx ny nz no b">pacman</code>等。</p><p id="06b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在<code class="fe nx ny nz no b">for</code>循环中使用简单的<code class="fe nx ny nz no b">cat</code>,使用被称为命令替换的<code class="fe nx ny nz no b">$()</code>语法来迭代文件中的行。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d63e" class="ns mr it no b gy nt nu l nv nw">$ for number in $(cat numbers.txt); do echo $number; done;<br/>0<br/>1<br/>2<br/>3<br/>4<br/>5</span></pre><p id="e545" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://bash.cyberciti.biz/guide/Pipes" rel="noopener ugc nofollow" target="_blank">管道也是一个很好的工具</a>来做一些类似命令替换的事情，但是具有非常不同的语法，并且在底层的实现也有点不同。</p><p id="561a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们所做的是将一个命令的输出作为下一个命令的输入。让我们<code class="fe nx ny nz no b">cat</code>我们的数字，但将输出馈入<code class="fe nx ny nz no b">sort</code>，因此它们最终以<code class="fe nx ny nz no b">--reverse</code>的顺序输出:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="a614" class="ns mr it no b gy nt nu l nv nw">$ cat numbers.txt | sort --reverse<br/>5<br/>4<br/>3<br/>2<br/>1<br/>0</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="adab" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">不离开终端的黑客新闻</h1><p id="3b99" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">有一套程序可以完美地解决你想在终端中解决的任何问题，但是假设你需要从黑客新闻中获得最新的新闻。</p><p id="e07f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以用<code class="fe nx ny nz no b">curl</code>程序做请求。默认情况下，它输出响应正文:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d82d" class="ns mr it no b gy nt nu l nv nw">$ curl <a class="ae ky" href="https://google.com" rel="noopener ugc nofollow" target="_blank">https://google.com</a></span><span id="84a0" class="ns mr it no b gy oa nu l nv nw">&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv="content-type" content="text/html;charset=utf-8"&gt;<br/>&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;<br/>&lt;H1&gt;301 Moved&lt;/H1&gt;<br/>The document has moved<br/>&lt;A HREF="https://www.google.com/"&gt;here&lt;/A&gt;.<br/>&lt;/BODY&gt;&lt;/HTML&gt;</span></pre><p id="bc63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看来自HN的头条新闻。他们提供了一个我们可以使用的简洁的API，但是对于更大的请求，<code class="fe nx ny nz no b">curl</code>会显示一个进度条输出。让我们用<code class="fe nx ny nz no b">-s</code>选项删除它:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="4526" class="ns mr it no b gy nt nu l nv nw">$ curl -s <a class="ae ky" href="https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty" rel="noopener ugc nofollow" target="_blank">https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty</a></span><span id="cd83" class="ns mr it no b gy oa nu l nv nw">[ 22679905, 22679894, 22679888, 22679875, 22679867, 22679849, 22679845, 22679837, 22679828, 22679808, 22679788, 22679784, 22679776, 22679764, ..., 22675186 ]</span></pre><p id="621a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">酷！现在让我们用<a class="ae ky" href="https://stedolan.github.io/jq/manual/" rel="noopener ugc nofollow" target="_blank"/><code class="fe nx ny nz no b"><a class="ae ky" href="https://stedolan.github.io/jq/manual/" rel="noopener ugc nofollow" target="_blank">jq</a></code><a class="ae ky" href="https://stedolan.github.io/jq/manual/" rel="noopener ugc nofollow" target="_blank">程序</a>解析那个<code class="fe nx ny nz no b">json</code>数组。我们希望让它在新的一行中输出每个故事ID，就像我们在本文开始时对数字所做的那样:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="e189" class="ns mr it no b gy nt nu l nv nw">$ curl -s <a class="ae ky" href="https://hacker-news.firebaseio.com/v0/newstories.json?print=pretty" rel="noopener ugc nofollow" target="_blank">https://hacker-news.firebase...</a> | jq -r '.[]'<br/>22675852<br/>22675849<br/>22675842<br/>22675832<br/>22675831<br/>22675808<br/>22675805<br/>...</span></pre><p id="01a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧，我打赌你已经知道该怎么做了。让我们使用命令替换，并对此进行迭代！我还将导出一个变量，以便更好地显示在屏幕上:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="044c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们做一些更有趣的事情，通过使用ID来达到故事的终点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="773d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这些<code class="fe nx ny nz no b">echo</code>调用中的每一个，您都会看到类似下面的响应:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5741" class="ns mr it no b gy nt nu l nv nw">{ “by” : “smacktoward”, “descendants” : 0, “id” : 22680175, “score” : 1, “time” : 1585092547, “title” : “I had the symptoms. But did I have the coronavirus?”, “type” : “story”, “url” : “<a class="ae ky" href="https://www.nytimes.com/2020/03/24/opinion/coronavirus-testing.html" rel="noopener ugc nofollow" target="_blank">https://www.nytimes.com/2020/03/24/opinion/coronavirus-testing.html</a>" }</span></pre><p id="6aa2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们再次用<code class="fe nx ny nz no b">jq</code>解析它们，并以更容易阅读的方式只输出<code class="fe nx ny nz no b">title</code>和<code class="fe nx ny nz no b">link</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="f29a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">会输出这样的结果。为了几个概念和外部程序不算太寒酸吧？</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0259" class="ns mr it no b gy nt nu l nv nw">“Zig cc: A drop-in replacement for GCC/Clang”<br/><a class="ae ky" href="https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html" rel="noopener ugc nofollow" target="_blank">https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html</a><br/> —--<br/>“Dyson develops ventilators for NHS”<br/><a class="ae ky" href="https://www.bbc.com/news/technology-52021757" rel="noopener ugc nofollow" target="_blank">https://www.bbc.com/news/technology-52021757</a><br/> ---<br/>“Swift 5.2 Released”<br/><a class="ae ky" href="https://swift.org/blog/swift-5-2-released/" rel="noopener ugc nofollow" target="_blank">https://swift.org/blog/swift-5-2-released/</a><br/> ---<br/>“Little Snitch and the deprecation of kernel extensions”<br/><a class="ae ky" href="https://blog.obdev.at/little-snitch-and-the-deprecation-of-kernel-extensions/" rel="noopener ugc nofollow" target="_blank">https://blog.obdev.at/little-snitch-and-the-deprecation-of-kernel-extensions/</a><br/> ---<br/>“U.S. Retailers Plan to Stop Paying Rent to Offset Virus Closures”<br/><a class="ae ky" href="https://www.bloomberg.com/news/articles/2020-03-24/u-s-retailers-plan-to-stop-paying-rent-to-offset-virus-closures" rel="noopener ugc nofollow" target="_blank">https://www.bloomberg.com/news/articles/2020-03-24/u-s-retailers-plan-to-stop-paying-rent-to-offset-virus-closures</a></span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0467" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">包扎</h1><p id="fbe5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">Shell脚本并不是每项工作的最佳工具，但它肯定会让您作为技术专业人员的生活变得更加轻松。这也是让你与众不同的东西。</p><p id="9770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最棒的是这东西并不难。一旦你掌握了重要的20%的概念和参考资料，就足以完成很多工作了。</p><p id="5f79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果您想让您的shell脚本更上一层楼，我建议您学习以下内容:</p><ul class=""><li id="19e4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">If-elif-else逻辑以及<code class="fe nx ny nz no b">test</code>命令(又名<code class="fe nx ny nz no b">[</code>)。</li><li id="5d2c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nx ny nz no b">grep</code>命令，以及一点正则表达式(如果你还没有的话)。</li><li id="d211" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">内置的<code class="fe nx ny nz no b">set</code>用于调试脚本和修改整体行为。</li><li id="82a1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nx ny nz no b">cut</code>号的命令。</li><li id="0954" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nx ny nz no b">awk</code>命令。</li><li id="636e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nx ny nz no b">sed</code>命令。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="715f" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">资源</h1><ul class=""><li id="0c9a" class="lv lw it lb b lc ni lf nj li od lm oe lq of lu ma mb mc md bi translated"><a class="ae ky" href="https://github.com/HackerNews/API" rel="noopener ugc nofollow" target="_blank">https://github.com/HackerNews/API</a></li><li id="064b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://stedolan.github.io/jq/manual/" rel="noopener ugc nofollow" target="_blank">https://stedolan.github.io/jq/manual/</a></li><li id="ca77" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://www.tldp.org/LDP/abs/html/textproc.html" rel="noopener ugc nofollow" target="_blank">https://www.tldp.org/LDP/abs/html/textproc.html</a></li></ul></div></div>    
</body>
</html>