<html>
<head>
<title>Java Coding Style Automation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java编码风格自动化</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/java-coding-style-automation-b44b82cec010?source=collection_archive---------5-----------------------#2022-02-21">https://betterprogramming.pub/java-coding-style-automation-b44b82cec010?source=collection_archive---------5-----------------------#2022-02-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f84a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Oracle代码约定和Google Java风格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/894d0b5d8132a9df192834bda2fc7656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3spp3HR3tAUigxctaqh3w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="24d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">拥有统一的编码风格会带来许多好处，仅举几个例子:</p><ul class=""><li id="459a" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">提高软件可读性</li><li id="975b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">最大限度降低软件维护成本</li><li id="0fb1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">加速发展</li></ul><h1 id="4d14" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">编码风格选项</h1><p id="c92f" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在用Java进行开发时，有两种主要的编码风格。</p><ul class=""><li id="de79" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><a class="ae nf" href="https://www.oracle.com/java/technologies/javase/codeconventions-contents.html" rel="noopener ugc nofollow" target="_blank">甲骨文代码惯例</a></li><li id="080a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://google.github.io/styleguide/javaguide.html" rel="noopener ugc nofollow" target="_blank">谷歌Java风格指南</a></li></ul><p id="216b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们来对比一下这两个。</p><p id="e62a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">最后更新日期:</strong></p><ul class=""><li id="b6f4" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">Oracle代码约定:1999年4月20日。这意味着较新版本Java(如Java 8)不包含在编码约定中。</li><li id="3936" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">谷歌Java风格指南:2018年5月22日。</li></ul><p id="f418" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> IntelliJ插件:</strong></p><ul class=""><li id="74bf" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">Oracle代码约定:没有Oracle代码约定的官方插件。</li><li id="344b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">谷歌java风格指南:谷歌Java格式。</li></ul><p id="e3ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">检查样式:</strong></p><ul class=""><li id="4306" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">Oracle代码约定:<a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/sun_checks.xml" rel="noopener ugc nofollow" target="_blank">check style/sun _ checks . XML at master check style/check style</a>。</li><li id="efbd" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Google Java风格指南:<a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml" rel="noopener ugc nofollow" target="_blank">check Style/Google _ checks . XML at master check Style/check Style</a>。</li></ul><p id="1198" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每种风格都有自己的优点和缺点。我们将利用这两个选项来探索编码风格自动化。</p><p id="744f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">先试试Google Java风格吧。</p><h1 id="4312" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">开发期间自动化编码风格</h1><p id="9488" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在开发过程中，通过我们的IDE，我们可以做两件事来自动化编码风格，例如IntelliJ。</p><h1 id="d1ee" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">google-java格式插件</h1><h2 id="1bc2" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">装置</h2><p id="1e15" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">一个IntelliJ插件，重新格式化Java源代码以符合Google Java风格。安装很简单，文件→设置→插件，然后点击“市场”标签，搜索“谷歌-Java-格式”。安装后，会提示您重新启动IntelliJ。</p><h2 id="80f9" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">激活</h2><p id="6e31" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在您的IntelliJ重启后，您将被提示启用google-java-format插件。如果您错过了它，您可以随时进入文件→设置来搜索它，然后启用它。</p><h2 id="8173" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">格式化/重新格式化</h2><p id="d594" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">一旦启用，您现在可以格式化/重新格式化您的文件，甚至整个项目！两种做法:“ctrl + alt + L”，或者代码→重新格式化代码。让我们仔细看看如何使用键盘选项。</p><p id="0795" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打开你想要格式化/重新格式化的文件，使用键盘“ctrl + alt + L”，你会看到你的文件用谷歌java风格漂亮地格式化了！你可以对整个包甚至整个项目这样做，只需在IntelliJ中点击包文件夹，或项目根文件夹，使用键盘“ctrl + alt + L”，你会得到这个窗口的提示，前两个复选框是默认选中的，我也选中了“清理代码”，然后按“运行”来查看你的一堆文件得到重新格式化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/faf1c65bed860c139927aaf894b2e833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*pE6bYvSUS22LIx3lFx4p5w.png"/></div></figure><p id="60e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很好，现在现有的文件都被重新格式化了，我们如何确保新文件或现有文件中的修订块遵循相同的google Java风格？请继续阅读。</p><h1 id="7a63" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">保存操作插件</h1><p id="1f9b" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">这个插件是为了确保任何对文件的新更改在保存时都被格式化。它支持可配置的、类似Eclipse的保存操作，包括“优化导入”、“重新格式化代码”、“重新排列代码”、“编译文件”和一些针对Java的快速修复，如“添加/删除‘this’限定符”等。当文件在磁盘上同步(或保存)时，插件执行配置的动作。</p><h2 id="28c7" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">装置</h2><p id="cfa6" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">按照与google-java-format相似的步骤安装保存操作插件。</p><h2 id="aeb2" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">激活</h2><p id="8cfa" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">进入文件→设置，搜索“保存动作”，然后勾选几个复选框来激活保存动作或快捷方式，同时选择格式化动作。您甚至可以通过选中底部的复选框来应用快速修复。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e20d8be86ad7f7a1cbbe310a7ff0bda8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBKZ8hU8rYW544ry-EgW1A.png"/></div></div></figure><h2 id="1809" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">执行</h2><p id="4511" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在来看看它的实际效果。一旦你编辑完一个文件，按下键盘“ctrl + shift + S”来触发保存操作，你会看到你的代码格式很好！</p><h1 id="f715" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">使用Checkstyle在代码推送中实施编码样式</h1><p id="9527" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">为了完全实施编码风格，我们需要在构建/管道级别把关，以便在开发过程中捕捉任何丢失的格式或故障。要做到这一点，让我们探索Checkstyle。</p><h1 id="ad77" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">maven-检查样式-插件</h1><p id="d527" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">这个插件有两个预定义的配置:<a class="ae nf" href="https://checkstyle.sourceforge.io/sun_style.html" rel="noopener ugc nofollow" target="_blank"> Sun风格的</a>和<a class="ae nf" href="https://checkstyle.sourceforge.io/google_style.html" rel="noopener ugc nofollow" target="_blank"> Google风格的</a>。对于Google style，我们可以下载其内置的<a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml" rel="noopener ugc nofollow" target="_blank"> Google style xml文件</a>。我们可以将其重命名为checkstyle.xml，或者如果您的项目中已经有了该文件，则用新内容覆盖项目根目录下的checkstyle.xml。在根pom中添加以下maven插件。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="9a2c" class="ng mj it nv b gy nz oa l ob oc">&lt;plugin&gt;<br/>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>    &lt;artifactId&gt;maven-checkstyle-plugin&lt;/artifactId&gt;<br/>    &lt;version&gt;3.1.2&lt;/version&gt;<br/>    &lt;configuration&gt;<br/>        &lt;configLocation&gt;checkstyle.xml&lt;/configLocation&gt;<br/>        &lt;encoding&gt;UTF-8&lt;/encoding&gt;<br/>        &lt;consoleOutput&gt;true&lt;/consoleOutput&gt;<br/>        &lt;failsOnError&gt;true&lt;/failsOnError&gt;<br/>        &lt;linkXRef&gt;false&lt;/linkXRef&gt;<br/>    &lt;/configuration&gt;<br/>    &lt;executions&gt;<br/>        &lt;execution&gt;<br/>            &lt;id&gt;validate&lt;/id&gt;<br/>            &lt;phase&gt;validate&lt;/phase&gt;<br/>            &lt;goals&gt;<br/>                &lt;goal&gt;check&lt;/goal&gt;<br/>            &lt;/goals&gt;<br/>        &lt;/execution&gt;<br/>    &lt;/executions&gt;<br/>&lt;/plugin&gt;</span></pre><p id="0fdd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了上面的maven配置，如果我们运行<code class="fe od oe of nv b">mvn clean install</code>命令，插件将扫描文件中的违规，如果发现任何违规，它将使构建失败。</p><p id="d89f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些问题将在<code class="fe od oe of nv b">target/checkstyle-result.xml</code>文件中报告。按照<code class="fe od oe of nv b">target/checkstyle-result.xml</code>中的错误细节修复代码，重复<code class="fe od oe of nv b">mvn clean install </code>直到所有错误都被解决。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="63f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您不是Google Java风格的忠实粉丝，并且希望坚持良好的传统Oracle代码约定，请按照下面的步骤使用Oracle代码约定自动化您的项目编码风格。</p><h1 id="b078" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">开发期间自动化编码风格</h1><h1 id="52ab" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">检查样式-想法</h1><p id="85ef" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">这个插件在IDEA中提供了CheckStyle对Java文件的实时和按需扫描。</p><h2 id="a5cf" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">装置</h2><p id="1213" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在IntelliJ中导航到文件→设置→插件，然后点击“市场”标签，搜索“CheckStyle-IDEA”，安装它，你将被提示重新启动IntelliJ。</p><h1 id="c8f7" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">checkstyle.xml</h1><p id="852e" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">Checkstyle有一个我们可以利用的<a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/sun_checks.xml" rel="noopener ugc nofollow" target="_blank"> Sun/Oracle版本</a>。请随意修改开箱即用版本，因为有些规则有点过于严格，例如所有成员变量都需要指定javadoc。你可以把你认为限制性太强的部分注释掉。一旦完成，我们将把这个checkstyle.xml导入到IntelliJ中。导航到文件→设置→编辑器→代码样式→ Java，然后点击管理图标，见下面截图，导入方案→ CheckStyle配置，然后只需从你的根项目导航到checkstyle.xml，点击“应用”，然后“确定”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/aeae39713c958e58b8de7c0692276008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R69sOR2cvz5vbALqa3SwxQ.png"/></div></div></figure><h2 id="dd79" class="ng mj it bd mk nh ni dn mo nj nk dp ms lh nl nm mu ll nn no mw lp np nq my nr bi translated">格式化/重新格式化</h2><p id="d211" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">您现在可以格式化/重新格式化您的文件，甚至整个项目！两种做法:“ctrl + alt + L”，或者代码→重新格式化代码。</p><p id="aa29" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确保新文件或现有文件中的修订块遵守相同的Oracle代码惯例，请遵循上面列出的保存操作插件安装、激活和执行说明。</p><p id="6b5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要使用checkstyle在代码推送中实施编码风格，请确保用来自<a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/sun_checks.xml" rel="noopener ugc nofollow" target="_blank"> Sun/Oracle版本</a>的内容替换项目根的checkstyle.xml文件。</p><p id="aab7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">暂时就这样吧！无论您选择哪种编码风格，现在您都可以高枕无忧，享受自动化编码风格带来的美妙项目了！</p><p id="a008" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">编码快乐！手工制作快乐！</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h1 id="fa0e" class="mi mj it bd mk ml on mn mo mp oo mr ms jz op ka mu kc oq kd mw kf or kg my mz bi translated"><strong class="ak">参考文献</strong></h1><ul class=""><li id="26dd" class="lu lv it la b lb na le nb lh os ll ot lp ou lt lz ma mb mc bi translated"><a class="ae nf" href="https://www.oracle.com/java/technologies/javase/codeconventions-contents.html" rel="noopener ugc nofollow" target="_blank">Java编程语言的代码约定:内容</a></li><li id="295f" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://google.github.io/styleguide/javaguide.html" rel="noopener ugc nofollow" target="_blank">谷歌Java风格指南</a></li><li id="c80b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://codegym.cc/groups/posts/491-java-coding-conventions-which-ones-to-follow-and-why" rel="noopener ugc nofollow" target="_blank"> Java编码惯例。要遵循哪些，为什么</a></li><li id="63e9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://alanzeichick.com/2016/11/wheres-best-java-coding-style-guide-not-oracle.html" rel="noopener ugc nofollow" target="_blank">哪里有最好的Java编码风格指南？不在甲骨文—艾伦·蔡奇克</a></li><li id="d388" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">【Java的编码标准和编程最佳实践。(第1部分，共3部分)</li><li id="3d47" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://checkstyle.sourceforge.io/google_style.html" rel="noopener ugc nofollow" target="_blank">check Style——谷歌的风格</a></li><li id="aa77" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml" rel="noopener ugc nofollow" target="_blank">check style/Google _ checks . XML at master check style/check style</a></li><li id="188d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nf" href="https://stackoverflow.com/questions/946993/intellij-reformat-on-file-save" rel="noopener ugc nofollow" target="_blank"> Intellij在文件保存时重新格式化</a></li></ul></div></div>    
</body>
</html>