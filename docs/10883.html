<html>
<head>
<title>6 Reasons to use Feature Flags In Your Codebases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在代码库中使用特性标志的6个理由</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/6-reasons-to-use-feature-flags-e375ef0914c8?source=collection_archive---------21-----------------------#2022-02-01">https://betterprogramming.pub/6-reasons-to-use-feature-flags-e375ef0914c8?source=collection_archive---------21-----------------------#2022-02-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7e79" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">特性标志使部署压力更小，给您更多的控制，减少生产中的错误，并让您做出数据驱动的决策</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4de9c26e06db068474541e57bc986af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3j5zpALDrT66BtcO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">尼科·斯密特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="208b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多年来，特色旗帜一直是FAANG公司的秘密武器。它们让开发团队行动更快，减轻了开发运维和质量保证的负担，并使产品团队能够做出更好的数据驱动决策。</p><p id="b1e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，直到最近，由于构建和维护定制功能管理平台的复杂性，小型公司完全采用这种做法是不可行的。如今，各种规模的团队都有几个不错的选择。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/cdad259281a7102d7352c5290ad0d211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKQwMB4vwyzwfJFgFOu0sA.png"/></div></div></figure><p id="40db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文通篇使用了<a class="ae kv" href="https://github.com/growthbook/growthbook" rel="noopener ugc nofollow" target="_blank"> GrowthBook </a>，一个开源特性标志平台，作为示例，但是这里的技术同样适用于商业工具，如<a class="ae kv" href="https://launchdarkly.com/" rel="noopener ugc nofollow" target="_blank">Launch darky</a>和其他开源平台，如<a class="ae kv" href="https://github.com/Unleash/unleash" rel="noopener ugc nofollow" target="_blank"> Unleash </a>。</p><p id="b0d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，不再拖延，这里是你应该使用特性标志的6个理由。</p><h1 id="2bcd" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">1.现在部署，以后发布</h1><p id="7835" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在市场营销、客户服务和产品部门准备正式“发布”某个特性的时候，工程部门准备将该特性部署到产品中的情况很少见。这往往会导致两种情况。要么开发团队将完成的代码保存在一个分支中(因为它会变得陈旧并累积合并冲突)，要么在组织的其余部分准备好支持它之前就将其部署。</p><p id="ccdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二个选择，尽早部署，看起来没那么糟糕，但是在很多情况下，它最终会导致非常糟糕的用户体验。例如，客户服务团队可能还没有接受新功能的培训，最终可能会给用户提供不正确的信息。或者类似地，FAQ、文档或副本可能没有更新，这让客户感到沮丧。</p><p id="4b94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了特性标志，您可以两全其美。例如，使用GrowthBook，您可以将新代码包装在一个条件中:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="7a18" class="mv lu iq mr b gy mw mx l my mz">if (growthbook.feature("my-feature").on) { ... }</span></pre><p id="9d9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认情况下，特性是关闭的，所以您可以安全地将这些代码部署到生产环境中，没有人会看到它。然后，当您准备好实际发布它时，您可以从GrowthBook UI中打开该功能，而不需要部署新的代码。</p><h1 id="e256" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">2.生产用断路开关</h1><p id="3a3b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">每个工程师都有一个在生产过程中错误日志被填满的故事，而每个人都在努力找出问题所在。没有什么比在整个网站瘫痪时尝试调试和批判性思考更好的了。然后，一旦发现有问题的代码并推出修复程序，可能需要10多分钟来构建并推广到您的所有服务器。</p><p id="5fd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了特征标志，你就有了生产的终止开关。一旦你发现应用程序的哪个部分出了问题，你可以立即关闭它，而不需要通过正常的构建和部署过程。这仍然是一个令人害怕和紧张的情况，但已经不那么可怕了。特性标志为您赢得了进一步调试和进行适当修复的时间。与此同时，大多数用户甚至不会注意到在幕后发生了可怕的错误。</p><h1 id="8395" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">3.特征门控</h1><p id="996d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在许多情况下，您希望让某些用户可以使用某种体验，而其他用户则不能。例如，为付费用户提供高级功能。或者只有美国游客才能看到的7月4日特价。或者在上面的“终止开关”例子中，为您的开发团队保留一个调查bug的特性，但是为其他人关闭它。</p><p id="cbcc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">传统上，这是通过使用if/else分支和硬编码所有目标条件来实现的。这导致来自项目经理和营销团队的请求不断积压，您最终会得到这样的代码:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="4a49" class="mv lu iq mr b gy mw mx l my mz">if (date &lt; '2022-02-15' &amp;&amp; url.query.utm_source != 'email' &amp;&amp; ...)</span></pre><p id="41ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特性标志使得这个过程更加简单。开发人员只是在他们的代码中使用一个通用条件:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="00a7" class="mv lu iq mr b gy mw mx l my mz">if (growthbook.feature("my-feature").on) { ... }</span></pre><p id="d744" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后从GrowthBook用户界面远程控制特征的状态。要素有一个默认状态，外加一个或多个基于目标条件更改状态的覆盖规则。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/a78496ea03b7ea8e34d5cc4a7640bcf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VfWN_FVf_qLNPeSdJjXeSw.png"/></div></div></figure><p id="81c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些目标条件在GrowthBook SDK中进行本地评估，因此速度非常快，并且不会通过网络发送任何用户信息。这让项目经理和非技术人员可以自由活动，而不会打扰工程团队、污染代码或导致性能问题。</p><h1 id="6f1c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">4.远程配置</h1><p id="8278" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">能够打开或关闭某些东西是很好的，但它不够灵活，无法处理所有情况。例如，当有4个不同的模块版本时，您希望能够在它们之间切换，而不仅仅是开/关状态。这就是为什么GrowthBook和大多数其他功能标记系统都支持远程配置，即功能可以采用许多可能值中的一个。</p><p id="a763" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于开发人员来说，使用远程配置功能的代码非常相似。不是检查特性是否打开，而是获取特性的值，根据您的使用情况，该值可能是字符串、数字或更复杂的数据类型。</p><p id="6b1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nb nc nd mr b">moduleVersion = growthbook.feature("my-module").value</code></p><p id="3cc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">许多团队广泛使用远程配置，并对他们应用程序的每个方面进行参数化，从显示的搜索结果的数量，到他们主页上使用的图像，到他们注册按钮的颜色。这使他们能够在GrowthBook用户界面中修改应用配置，而无需进行新的部署。</p><h1 id="b4da" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">5.金丝雀部署</h1><p id="d90d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">向100%的用户一次性发布是很可怕的。做多少QA都没关系，有办法破，用户会找到的。对于canary部署，您首先让一小部分用户可以使用该特性，同时密切关注错误日志和指标。如果一切看起来都很好，你就逐渐把它展开到100%。</p><p id="18a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有功能标志，您通常会将应用程序的多个实例部署到生产环境中，并使用复杂的负载平衡器或DNS规则来控制流量。如果您有一个大型的专门的devops团队来构建和管理管道，这种方法很好，但是对于其他人来说，这种复杂性是不值得的。</p><p id="dd48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了特性标志，您无需额外工作就可以免费获得金丝雀部署！在GrowthBook UI中，你可以向一定比例的用户“展示”, SDK将使用随机抽样来决定谁将被包括在内，而不是强迫用户都获得相同的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/15c815ce409b1f868ddc05790712ded1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qI7rOAG2co1TBCXay-F9Bg.png"/></div></div></figure><h1 id="dca8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">6.A/B测试</h1><p id="faed" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">A/B测试在实践中非常类似于canary部署，但是目标略有不同。对于金丝雀部署，主要关注的是确保您不会破坏任何东西。A/B测试的目标是让事情变得更好。证明某样东西更好需要更多的统计精确性和纪律性:</p><ul class=""><li id="ab21" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">在变量之间平均分配流量(例如50/50 ),并在整个实验中保持一致</li><li id="28df" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">确保同一个用户总是看到相同的变化</li><li id="fb2d" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">跟踪每个用户在您的分析系统中看到了哪些变化</li><li id="721e" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">在整个应用程序中跟踪目标和转换事件</li><li id="a805" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">使用统计数据来确定获胜者</li></ul><p id="77a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，与canary部署类似，A/B测试免费提供特性标记。就像金丝雀部署一样，A/B测试是通过GrowthBook中的覆盖规则来控制的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/22936e74ebbcd9b6dd8efa5d2d6ddba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZcz92py7FJzJvqp-tyWtQ.png"/></div></div></figure><p id="a170" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你开始收集数据，你可以使用GrowthBook的高级统计引擎来查看你的实验结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/84eef484a2ab8b7b789a4bd0d5c6aaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9x_NBKF8S12ba1FtnxC4ww.png"/></div></div></figure><h1 id="8376" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="4752" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">希望现在你能明白为什么特性标志是顶级开发团队的秘密武器。这一简单的技术支持如此多的高级用例，并消除了巨大的压力来源。现在就开始使用以下任何工具的功能标志。</p><h1 id="179c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">资源</h1><p id="bc77" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="nv">开源:</em></p><ul class=""><li id="5965" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated"><a class="ae kv" href="https://github.com/growthbook/growthbook" rel="noopener ugc nofollow" target="_blank">成长书</a></li><li id="218a" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated"><a class="ae kv" href="https://github.com/Unleash/unleash" rel="noopener ugc nofollow" target="_blank">释放</a></li><li id="31c5" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated"><a class="ae kv" href="https://github.com/Flagsmith/flagsmith" rel="noopener ugc nofollow" target="_blank">铁匠</a></li></ul><p id="dbfd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nv">商业:</em></p><ul class=""><li id="88e9" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated"><a class="ae kv" href="https://launchdarkly.com/" rel="noopener ugc nofollow" target="_blank">发射黑暗</a></li><li id="aca9" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated"><a class="ae kv" href="https://www.split.io/" rel="noopener ugc nofollow" target="_blank"> Split.io </a></li></ul></div></div>    
</body>
</html>