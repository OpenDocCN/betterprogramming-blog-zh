<html>
<head>
<title>Start a Component Library with Storybook, Tailwind CSS, and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Storybook、Tailwind CSS和TypeScript启动组件库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/start-a-component-library-with-storybook-tailwind-css-and-typescript-ebaffc33d098?source=collection_archive---------4-----------------------#2020-04-02">https://betterprogramming.pub/start-a-component-library-with-storybook-tailwind-css-and-typescript-ebaffc33d098?source=collection_archive---------4-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3590" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为您的React项目更快地构建组件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73c0d4db3e162be6fbaa3d7ae2b3f4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_SVexMIXE88VmMVNxo0sKw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@balazsketyi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Balázs Kétyi </a>在<a class="ae ky" href="https://unsplash.com/@balazsketyi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="18b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看最后的<a class="ae ky" href="https://storybook-btn.netlify.com/" rel="noopener ugc nofollow" target="_blank">结果</a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f442" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是故事书？</h1><p id="a73b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Storybook是一个用于独立开发UI组件的工具——这意味着我们可以在主应用程序之外拥有组件，进行必要的更改，并在知道组件外观的情况下将其导入我们的应用程序。</p><p id="f61a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设计系统已经成为任何产品开发过程的一个重要部分，你可能已经在使用它了。这个系统为设计者和开发者提供了一个风格指南。您有许多具有不同模式和变化的UI组件。这是一个使用故事书的完美场景。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="480b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">顺风的优势</h1><p id="5324" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Tailwind CSS是一个高度可定制的低级CSS框架。</p><p id="9c25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它不像许多其他框架那样是一个UI工具包——它通过CSS类让你完全控制你的网站的外观。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="127e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置一个React应用程序并安装Tailwind</h1><p id="5139" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我将从零开始用Create React App做一个项目。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="518d" class="ne md it na b gy nf ng l nh ni">npx create-react-app storybook-ts --template typescript</span></pre><p id="04b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们安装依赖项。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="0b43" class="ne md it na b gy nf ng l nh ni">npm install tailwindcss postcss-cli autoprefixer</span></pre><p id="9418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用下面的代码在应用程序的根目录下创建一个名为<code class="fe nj nk nl na b">postcss.config.js</code>的新文件。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ede8" class="ne md it na b gy nf ng l nh ni">module.exports = {<br/>  plugins: [require('tailwindcss'), require('autoprefixer')],<br/>};</span></pre><p id="d2e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用PostCSS处理Tailwind，<code class="fe nj nk nl na b">autoprefixer</code>将解析CSS并添加供应商前缀以支持浏览器。</p><p id="cc01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，将这个脚本添加到<code class="fe nj nk nl na b">package.json</code>文件中。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ec05" class="ne md it na b gy nf ng l nh ni">{<br/>  "scripts": {<br/>    ...<br/>    "build:tailwind": "postcss src/scss/base.scss -o src/scss/tailwind.scss"<br/>  },<br/>  ...<br/>}</span></pre><p id="49dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nj nk nl na b">src</code>中创建一个新的<code class="fe nj nk nl na b">scss</code>文件夹。我会用Sass文件，因为我会用<code class="fe nj nk nl na b">base.scss</code>写更多的类，但是你可以用CSS。</p><p id="17be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你决定使用Sass，别忘了安装<code class="fe nj nk nl na b">node-sass</code>。</p><p id="a0b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用这个内容在<code class="fe nj nk nl na b">scss</code>文件夹中创建一个<code class="fe nj nk nl na b">base.scss</code>文件。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="6344" class="ne md it na b gy nf ng l nh ni">@tailwind base;<br/>@tailwind components;<br/>@tailwind utilities;</span></pre><p id="8a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在控制台上运行这个命令，将会生成顺风文件。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5a98" class="ne md it na b gy nf ng l nh ni">npm run build:tailwind</span></pre><p id="9dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将生成的顺风文件放入您的应用程序组件。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="bf13" class="ne md it na b gy nf ng l nh ni">// App.tsx</span><span id="679c" class="ne md it na b gy nm ng l nh ni">import './scss/tailwind.scss';</span></pre><p id="dcfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将使用Tailwind的默认配置——您可以根据自己的需要随意调整。运行命令<code class="fe nj nk nl na b">npx tailwind init</code>，将会生成一个顺风配置文件。您可以添加更适合您的值。这是顺风的默认<a class="ae ky" href="https://github.com/tailwindcss/tailwindcss/blob/master/stubs/defaultConfig.stub.js" rel="noopener ugc nofollow" target="_blank">配置</a>——作为参考。</p><p id="8636" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nj nk nl na b">src</code>内新建一个<code class="fe nj nk nl na b">components</code>文件夹，并添加一个<code class="fe nj nk nl na b">button.tsx</code>文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">button.tsx</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="794a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">让我们开始读故事书吧</h1><p id="e09c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了用Storybook处理TypeScript文件，我们需要扩展webpack配置。让我们在项目的根目录下创建一个名为<code class="fe nj nk nl na b">.storybook</code>的新文件夹，并在其中创建一个<code class="fe nj nk nl na b">main.js</code>文件。</p><p id="85b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是首先，让我们安装我们需要的依赖项。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7d53" class="ne md it na b gy nf ng l nh ni">npm install --save-dev @storybook/react @storybook/preset-create-react-app babel-loader react-docgen-typescript-loader @storybook/addon-actions @storybook/addon-info @storybook/addon-knobs @storybook/addon-notes @storybook/addons</span></pre><p id="90b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用插件为我们的故事提供高级功能。</p><p id="dc5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nj nk nl na b">main.js</code>文件上，添加以下代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创造我们的第一个故事。</p><p id="1e47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nj nk nl na b">src</code>中创建一个<code class="fe nj nk nl na b">stories</code>文件夹和一个名为<code class="fe nj nk nl na b">button.stories.tsx</code>的文件。我们要添加一些插件，直接从故事书里改变按钮的道具。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f4f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在<code class="fe nj nk nl na b">package.json</code>文件上添加一个脚本来运行Storybook。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="609c" class="ne md it na b gy nf ng l nh ni">{<br/>    "scripts": {<br/>        ...<br/>    "build:tailwind": "postcss src/scss/base.scss -o src/scss/tailwind.scss",<br/>    "storybook": "start-storybook -p 5000"<br/>  },<br/>  ...<br/>}</span></pre><p id="3473" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果我们运行<code class="fe nj nk nl na b">npm run storybook</code>，我们将看到类似这样的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/49c4c0685d9d68493231979685b8abcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*FrYnkUNreHh0xuxT-jR3NA.png"/></div></figure><p id="9831" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的纽扣，但没有款式。让我们通过创建一个新的<code class="fe nj nk nl na b">Layout</code>组件来解决这个问题。从现在开始，我们创建的所有文件都将放在<code class="fe nj nk nl na b">.storybook</code>文件夹中。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="0347" class="ne md it na b gy nf ng l nh ni">import React from 'react';<br/>import '../src/scss/tailwind.scss';<br/><br/>const Layout = ({ children }) =&gt; {<br/>  return (<br/>    &lt;div className="px-20 py-10"&gt;<br/>      {children}<br/>    &lt;/div&gt;<br/>  )<br/>}<br/><br/>export default Layout;</span></pre><p id="6731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个<code class="fe nj nk nl na b">preview.js</code>文件。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ba2c" class="ne md it na b gy nf ng l nh ni">import React from 'react';<br/>import { addDecorator } from '@storybook/react';<br/>import { withInfo } from '@storybook/addon-info';<br/>import Layout from './Layout';</span><span id="9a92" class="ne md it na b gy nm ng l nh ni">addDecorator(storyFn =&gt; &lt;Layout&gt;{storyFn()}&lt;/Layout&gt;);<br/>addDecorator(withInfo({<br/>  inline: true,<br/>  propTablesExclude: [Layout]<br/>}));</span></pre><p id="4db5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您再次运行Storybook，我们的故事现在看起来像这样。info插件生成源代码和一个Prop类型表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/074ac06b27151d2cfefef1e243f4c01f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RbD58jMiGWZwW4IWfuSE1g.png"/></div></div></figure><p id="4286" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意事项</strong>:</p><ul class=""><li id="675b" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">如果您在导入顺风文件时遇到问题，您需要在<code class="fe nj nk nl na b">main.js</code>上将<code class="fe nj nk nl na b">sass-loader</code>添加到webpack配置中。</li><li id="4200" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">如果您看不到任何适当类型，请检查您的组件文件。一定要像这样析构React导入或导入React。或者尽量不要对你的组件使用<code class="fe nj nk nl na b">export default</code>。</li></ul><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5222" class="ne md it na b gy nf ng l nh ni">import * as React from 'react'; </span><span id="4dee" class="ne md it na b gy nm ng l nh ni">import React, { FC } from 'react';</span><span id="c088" class="ne md it na b gy nm ng l nh ni">export const Button = () =&gt; {} //don't use export default.</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="25f4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">深色模式</h1><p id="7259" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们的应用程序看起来很棒，但你知道我们如何才能让它看起来更好吗？是的，在黑暗模式下。</p><p id="2a11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，创建一个<code class="fe nj nk nl na b">manager.js</code>文件，并添加以下代码。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b423" class="ne md it na b gy nf ng l nh ni">import { addons } from '@storybook/addons';<br/>import { themes } from '@storybook/theming';</span><span id="eac7" class="ne md it na b gy nm ng l nh ni">addons.setConfig({<br/>  theme: themes.dark,<br/>});</span></pre><p id="4178" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把黑暗主题添加到你的故事书应用程序中。</p><p id="46d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在之前的<code class="fe nj nk nl na b">preview.js</code>文件中，添加这个来改变信息的样式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="beb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们快成功了。但是现在道具类型表上的文本看起来不太好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/dae627675522a3a8502e9308fb8f5692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6R2YoPWbhN7HhSU4wegI6g.png"/></div></div></figure><p id="1886" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个<code class="fe nj nk nl na b">preview-body.html</code>文件，并添加以下代码。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c876" class="ne md it na b gy nf ng l nh ni">&lt;style&gt;<br/>  .info-table, .info-table td, .info-table th{ <br/>    color: #fff;<br/>  }<br/>&lt;/style&gt;</span></pre><p id="9078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再次运行Storybook。</p><p id="c323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你有了——story book在黑暗模式下启动并运行，有了你的顺风组件和TypeScript支持。</p><p id="3328" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查这个<a class="ae ky" href="https://github.com/elisealcala/storybook-tailwind-ts" rel="noopener ugc nofollow" target="_blank">回购</a>中的代码。</p></div></div>    
</body>
</html>