<html>
<head>
<title>Everything You Need to Know About PWAs — Workbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于PWAs，您需要了解的一切—工具箱</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/everything-you-need-to-know-about-pwas-workbox-de5755672fb3?source=collection_archive---------6-----------------------#2019-06-29">https://betterprogramming.pub/everything-you-need-to-know-about-pwas-workbox-de5755672fb3?source=collection_archive---------6-----------------------#2019-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="689e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Workbox是一个灵活的抽象集合，让我们可以更简单地完成困难的事情</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a69ee9d03776af486ce5ab1b206bdf9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vYDy9mmqlaj1meqfmEY8cA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PWA工具箱—<a class="ae ky" href="https://developers.google.com/web/tools/workbox/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/tools/workbox/</a></p></figure><p id="93a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为渐进式web应用程序添加预缓存、缓存策略、路由和后台同步非常复杂。</p><p id="37e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Workbox是一个灵活的抽象集合，让我们可以更简单地完成困难的事情。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">工具箱:灵活的PWA库(Chrome Dev Summit 2017)</p></figure><p id="5727" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，<a class="ae ky" href="https://developers.google.com/web/tools/workbox/" rel="noopener ugc nofollow" target="_blank"> Workbox </a>让我们可以轻松完成以下任务:</p><ul class=""><li id="0282" class="lx ly it lb b lc ld lf lg li lz lm ma lq mb lu mc md me mf bi translated">提供缓存优先的图像、HTML和CSS样式来提高web应用程序的性能。</li><li id="6752" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">自动缓存清理和更新。</li><li id="c490" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">运行时缓存。</li><li id="3e46" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">策略。</li><li id="f936" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">请求路由。</li><li id="4b2b" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">后台同步。</li></ul></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="35b1" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">工具箱入门</h1><p id="94e7" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">Workbox为我们提供了一个现成的方便的命令行工具。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="881a" class="nu mt it nq b gy nv nw l nx ny">yarn add <!-- -->workbox-cli</span></pre><p id="7c05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了CLI后，运行向导。输入应用程序的相对路径。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="19b4" class="nu mt it nq b gy nv nw l nx ny">npx workbox wizard</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/57d3f96d9181ad55c71ad8a69afdee59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_rRuG5yTQl57h3crmac-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行工具箱向导</p></figure><p id="e057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该会看到一个新文件<code class="fe oa ob oc nq b">workbox-config.js </code>出现在项目的根目录下。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od lw l"/></div></figure><p id="9c70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">配置文件定义了我们的根目录、要缓存的文件以及我们的<code class="fe oa ob oc nq b">sw.js</code>的位置。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="76f6" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">生成服务人员文件</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/7d6600cd83cbe1a2c2f15dd8d6ed90a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ffgAD1CAj0jbRQQYqi-eA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正在生成服务工作者文件</p></figure><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="991c" class="nu mt it nq b gy nv nw l nx ny">npx workbox generateSW workbox-config.js</span></pre><p id="35d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该会看到<code class="fe oa ob oc nq b">sw.js</code>文件出现，看起来可能像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od lw l"/></div></figure><p id="67fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个很长的文件，但基本上，它会安装<code class="fe oa ob oc nq b">workbox</code>并告诉浏览器要缓存哪些文件。</p><p id="7292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以删除<code class="fe oa ob oc nq b">service-worker.js</code>文件，并注册我们的新服务人员— <code class="fe oa ob oc nq b">sw.js</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od lw l"/></div></figure><p id="0c8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们重新启动并打开我们的浏览器，我们应该有离线支持，缓存和获取缓存资产现在启用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/98f99b60d933bd2f53112708a7921c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mRADvmN56_HjSDe13Qcr7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">工具箱PWA</p></figure><p id="fe1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击离线框，尝试刷新。如果您检查<code class="fe oa ob oc nq b">Cache Storage</code>选项卡，您应该会看到存储在缓存中的所有内容。<em class="og"> </em>魔法<em class="og">！</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/f0c967731f7040ac4c9fb10db1a0488e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFHd_DxcPDGl7k6dZBImpw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">工具箱预车</p></figure><p id="0d90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们不能修改生成的文件，因为一旦我们重新生成服务工作者文件，我们所做的任何更改都将被覆盖。</p><p id="4d8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想修改<code class="fe oa ob oc nq b">sw.js</code>，你可以这样做:</p><p id="2552" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用以下内容创建一个名为<code class="fe oa ob oc nq b">src-sw.js</code>的新文件。<code class="fe oa ob oc nq b">src-sw.js</code>文件的内容将被注入到<code class="fe oa ob oc nq b">sw.js</code>文件中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od lw l"/></div></figure><p id="2d23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">告诉原<code class="fe oa ob oc nq b">sw.js</code>文件<code class="fe oa ob oc nq b">src-sw.js</code>所在的位置。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od lw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/72c3f68fc12befe9dd35905e1c1fb0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tOf80NKQhOjHlU8umBMfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd oj">国投国投</strong>地产</p></figure><p id="34a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，运行命令:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="6960" class="nu mt it nq b gy nv nw l nx ny">npx workbox injectManifest</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/045f74e4256aa4ebe839b435f840e0f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OBCeaPbQKTA0tIjPtxqq0w.png"/></div></div></figure><p id="a46a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们应该看到<code class="fe oa ob oc nq b">console.log</code>出现在<code class="fe oa ob oc nq b">sw.js</code>文件中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/f90af5389dd014c3b104450028ca7b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ytu5AW5w0b3SdxoVvEgMqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将选项注入sw.js文件</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/d8a350cabecaf4877d4bff2a30a024d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4rHKz7NKyr4jKhWbLu6Rug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd oj">何时使用</strong> <a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-build" rel="noopener ugc nofollow" target="_blank"> <strong class="bd oj">注射清单</strong> </a></p></figure><p id="6aee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Workbox可以做更多的事情。请阅读文档以尝试不同的功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/042af3b5c64c194a5cf82e323817cdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*T1cfrldw4R2MPWXsobjLag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">工具箱完整文档—<a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-sw" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/tools/work box/modules/work box-SW</a></p></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="8d30" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">从这里去哪里？</h1><p id="dcb5" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我强烈推荐建筑材料。构建东西是迄今为止擅长做事情的最好方式，<a class="ae ky" href="https://medium.com/better-programming/the-secret-to-being-a-top-developer-is-building-things-heres-a-list-of-fun-apps-to-build-aac61ac0736c?source=---------2------------------" rel="noopener">这里有一个需要构建的有趣应用的列表</a>。</p><p id="692d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想深入了解渐进式web应用程序，我建议你通读一下“<a class="ae ky" href="https://amzn.to/2Yz7NuX" rel="noopener ugc nofollow" target="_blank"> <em class="og">构建渐进式Web应用程序:将本机的力量带入浏览器</em> </a>”这本书。</p><h1 id="fdcf" class="ms mt it bd mu mv on mx my mz oo nb nc jz op ka ne kc oq kd ng kf or kg ni nj bi translated">源代码</h1><p id="df5d" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">这是本章的<a class="ae ky" href="https://github.com/indreklasn/pwa-example/tree/part-3" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p><div class="os ot gp gr ou ov"><a href="https://github.com/indreklasn/pwa-example/tree/part-3" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">indreklasn/pwa-示例</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">通过在GitHub上创建帐户，为indreklasn/pwa-example开发做出贡献。</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">github.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div><p id="5500" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>