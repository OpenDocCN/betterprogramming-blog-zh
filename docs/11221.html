<html>
<head>
<title>How to Prepare a Design Review Like an Expert?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何像专家一样准备设计评审？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-prepare-a-design-review-like-an-expert-85d2ab85d7f5?source=collection_archive---------8-----------------------#2022-02-28">https://betterprogramming.pub/how-to-prepare-a-design-review-like-an-expert-85d2ab85d7f5?source=collection_archive---------8-----------------------#2022-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c068" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解优秀设计评审的三个主要项目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f49eea05a18a0a343867a614bf883842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7Ryt_IvNlgSGjBFg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/photos/DuHKoV44prg" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@ffstop" rel="noopener ugc nofollow" target="_blank"> Fotis Fotopoulos </a>拍摄</p></figure><p id="1b2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文将以后端开发为例，但是相同的概念可以应用于各个领域。</p><p id="6b6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在说明如何准备一份好的设计评审之前，我们先来介绍一下一份设计评审应该具备的内容。作为一名建筑师，我要告诉你我想看什么。</p><ol class=""><li id="f329" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><a class="ae kv" href="https://c4model.com/" rel="noopener ugc nofollow" target="_blank"> C4车型</a></li><li id="bf2d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-design-in-clean-architecture-way-part-2-8524e76f2720">用户故事和用例</a></li><li id="6831" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">设计决策</li></ol><p id="cba3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个架构师，我最想看到的是上面三项，不是代码流也不是数据库模式甚至也不是RESTful API spec。</p><p id="f311" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中最重要的是C4模式。</p><h1 id="e51c" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">C4模型</h1><p id="4878" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">为什么C4模式如此重要？在解释之前，让我们简单介绍一下C4模型。</p><p id="4b1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">C4模型包含四个C</p><ol class=""><li id="b5aa" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">上下文:这是系统的概述，描述了用户如何与整个系统交互。它将从用户的角度显示，因此不会显示系统的详细信息。</li><li id="4537" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">容器:这里的容器不是指docker那样的容器虚拟化。C4模型中的容器是指可以单独部署的实体，如API服务器、数据库、消息队列等。</li><li id="ae63" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">组件:组件是容器下的模块。它包含了领域驱动设计中模块之间的交互或者领域之间的关联。</li><li id="4e68" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">代码:最后是组件下的源代码。但是在描述架构的时候，我们不会展示代码的细节，能够描述对象之间的关系就足够了。</li></ol><p id="661e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据以上描述，C4模型的目的是解释系统内的相互作用和关系。从最大的单元——用户交互，到对象与对象之间的交互，这些交互帮助架构师获得整个系统的全貌，知道这样的交互是否合适。</p><p id="ac1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，从容器的角度来看，一个小的应用程序可能是这样的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/0a4aec7e69e82bbba8ff88fe936621c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*PEkVngC60vSac2xHYD-8zA.png"/></div></figure><p id="e287" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些开发人员可能认为这样的图太简单了，然而，这样简单的图足以让架构师发现可能的问题。</p><ol class=""><li id="20ea" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">可伸缩性:当用户数量增加时，API有什么办法处理吗？就算API能满足吞吐量，数据库呢？</li><li id="ec5c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">可靠性:当API崩溃时，是否存在SPOF(单点故障)的风险？</li><li id="2dab" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">效率:当数据量增加，数据库响应时间变慢，用户会有什么感受？</li></ol><p id="6b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种非功能性需求可以从关系图中进行分析。以上只是一些常见的非功能性需求，完整列表见<a class="ae kv" href="https://en.wikipedia.org/wiki/Non-functional_requirement" rel="noopener ugc nofollow" target="_blank"> wiki </a>。</p><p id="dad1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，以组件视角为例。一个简单的社交媒体可能如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/c01a10f216468ae83aba6688315a687e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVAlLR9vrguTtn3Ni5aaZA.png"/></div></div></figure><p id="2404" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也是一个非常直观的示意图。看起来它只是列出了各种模块。这样的图真的值吗？</p><p id="9600" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的。绝对的。</p><p id="638a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们评估一个架构的耦合程度时，我们通常使用<code class="fe nf ng nh ni b">instability</code>作为一个指标。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/2a7338754c2b30a31fb49e0696352f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*5z0QY1a4vuQL0fqUSBFtVQ.png"/></div></figure><p id="54f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b">Ce</code>指传出耦合的数量，<code class="fe nf ng nh ni b">Ca</code>指传入耦合的数量。越靠近<code class="fe nf ng nh ni b">0</code>模块越稳定，反之亦然。关于耦合，<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/temporal-coupling-in-code-e74899f7a48f">我有一篇文章</a>专门描述耦合的问题。</p><p id="8806" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个社交媒体，它的推荐模块的<code class="fe nf ng nh ni b">instability</code>是<code class="fe nf ng nh ni b">0.8</code>。这意味着推荐是不稳定的。只要修改了任何一个依赖模块，无论是接口还是行为，都会直接或间接地影响到推荐系统。</p><p id="60a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">建筑师通过这样一个简单的图来分析整个架构。基于不同的领域，不同的架构，会有完全不同的解耦方式。没有现有架构的完整视图，架构师只能提供一些无关紧要的评论。</p><h1 id="1bc0" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">用户故事和用例</h1><p id="5b4f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">如何写出好的用户故事和用例我在<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-design-in-clean-architecture-way-part-2-8524e76f2720">上一篇文章</a>中提到过。</p><p id="6c90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一节中，我只是重复上面的C4模型。事实上，用户故事也符合C4模型中的上下文。要有一个好的故事，有一种方法可以得出正确的上下文。</p><h1 id="55cc" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">设计决策</h1><p id="a703" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">设计决策是整个设计评审的核心。整个设计评审就是检查每个设计决策是否正确。前面提到的C4模型、用户故事和用例只是为了给整个审查提供背景信息，以便理解每个决策背后的意义和风险。</p><p id="b5e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是设计决策是什么呢？</p><p id="e30f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感觉是一个简单的词，但实际上很难感受到。所以我提供了一个简单的公式:</p><blockquote class="nk nl nm"><p id="cf80" class="kw kx nn ky b kz la jr lb lc ld ju le no lg lh li np lk ll lm nq lo lp lq lr ij bi translated"><em class="iq">为什么做</em> A <em class="iq">(而不是</em> B <em class="iq">)？</em></p></blockquote><p id="9941" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">举个例子，</p><ol class=""><li id="dbaa" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">为什么用MySQL而不用MongoDB？</li><li id="d4d4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为什么使用缓存？(而不是直接访问数据库)</li><li id="0343" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为什么使用同步restful API而不是异步CQRS？</li></ol><p id="d5f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面说的问题有点宽泛，我们继续缩小范围。</p><ol class=""><li id="263e" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">为什么我们希望推荐系统使用同步调用从post系统获取数据？</li><li id="8d78" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为什么这个功能要拆分成两个子功能？</li><li id="c0e5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为什么这行源代码要这样写？</li></ol><p id="c76c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你注意到了吗？这都是设计决策，从系统定位到每行代码的原因，除了在设计评审中，你可能不会被问及每行代码的原因。因此，应该提出什么样的决定来讨论？</p><p id="4817" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的观点是，C4模式的前三个目标值得讨论。通过写下C4模型，并列出每一行和每一块的目的和原因，架构师将能够在许多功能性和非功能性需求中识别潜在的问题和隐藏的风险。</p><p id="96be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至于最后的<strong class="ky ir"> C </strong>，代码，还是留给开发者在代码评审的时候去发现吧。</p><h1 id="33f0" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="db22" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">本文解释了优秀设计评审的三个主要项目。C4模型给建筑师一个更快的系统概览；然后是特性将解决的用户故事和用例，以便架构师理解功能需求是什么；最后是开发人员的设计决策，以便架构师知道每个决策背后的权衡。</p><p id="1a29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，大家都在同一页上。架构师可以提出他的建议，指出系统背后的风险，开发人员可以了解系统演进的方向和需要解决的问题。</p><p id="f265" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重要的是要记住提供足够的信息，以便架构师能够做出正确的建议，否则你只会得到空话。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="d107" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我以前的文章中，我实际上已经解释了不同的设计决策，希望这些分析能够让您意识到需要在哪里做出决策以及应该如何做出决策。</p><ul class=""><li id="e859" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ny ly lz ma bi translated">为什么我们需要定义回购？<a class="ae kv" href="https://medium.com/interviewnoodle/whats-difference-between-unit-test-and-integration-test-aae6ef13220" rel="noopener">依赖注入</a></li><li id="6317" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ny ly lz ma bi translated">为什么我们需要层次？<a class="ae kv" href="https://lazypro.medium.com/layered-architecture-clarification-e55b69d60e98" rel="noopener">分层架构</a></li><li id="edc8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ny ly lz ma bi translated">如何进化出一个系统？<a class="ae kv" href="https://medium.com/interviewnoodle/shift-from-monolith-to-cqrs-a34bab75617e" rel="noopener">从独石转向CQRS </a></li><li id="f514" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ny ly lz ma bi translated">怎么解耦？<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/temporal-coupling-in-code-e74899f7a48f">事件驱动架构</a></li></ul></div></div>    
</body>
</html>