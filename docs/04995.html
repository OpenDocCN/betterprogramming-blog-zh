<html>
<head>
<title>How to Run a Polkadot Validator on Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Kubernetes上运行Polkadot验证器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-polkadot-validator-on-kubernetes-3e694cb43841?source=collection_archive---------8-----------------------#2020-05-28">https://betterprogramming.pub/a-polkadot-validator-on-kubernetes-3e694cb43841?source=collection_archive---------8-----------------------#2020-05-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3930" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍polkadot-k8s</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/910a3b93eaa5da8da7aa0b56e2b87612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xIAnXEj1XSuJ2ZuA"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@samtillo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">谭伟</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure><p id="b8a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们正在介绍<a class="ae kv" href="https://github.com/midl-dev/polkadot-k8s" rel="noopener ugc nofollow" target="_blank"> polkadot-k8s </a>，这是一个开源项目，旨在一次性完成一个安全的<a class="ae kv" href="https://polkadot.network" rel="noopener ugc nofollow" target="_blank"> Polkadot </a>或<a class="ae kv" href="https://kusama.network" rel="noopener ugc nofollow" target="_blank">草间弥生</a>验证器设置。波尔卡多特是一个区块链，草间弥生是波尔卡多特的金丝雀网络。</p><p id="2303" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经使用这个模型成功地运行了草间弥生验证器两个月了。我们还在Kubernetes 经营一家<a class="ae kv" href="https://medium.com/@midl.dev/tezos-bakery-kubernetes-c0a2e9df1fc6" rel="noopener"> Tezos面包店。</a></p><p id="3c1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将展示如何在您的笔记本电脑上使用几个实用程序在Google Kubernetes引擎上部署一个验证器。一切都是自动化的，并在代码中指定。不需要编译任何Rust代码或安装任何启动脚本。</p><p id="a4ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这不是灵丹妙药！作为一名验证者需要细心和持续的关注，但是当您建立自己的操作时，您可能会发现这是一个很好的起点。</p><p id="90a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">波尔卡多/草间弥生代币有价值。为了避免资金损失，在网络互动中要谨慎判断。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="4f51" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">如何部署</h1><p id="e272" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">首先，熟悉Polkadot 中的<a class="ae kv" href="https://wiki.polkadot.network/docs/en/learn-staking" rel="noopener ugc nofollow" target="_blank">赌注概念，并通读关于如何</a><a class="ae kv" href="https://wiki.polkadot.network/docs/en/maintain-guides-how-to-validate-kusama" rel="noopener ugc nofollow" target="_blank">成为验证者</a>的指南。</p><p id="963c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个<a class="ae kv" href="https://cloud.google.com" rel="noopener ugc nofollow" target="_blank">谷歌云</a>账户。你将获得300美元的免费积分。这将让你免费试用本教程。</p><p id="8a64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，下载以下实用程序，并将其安装在您的计算机上:</p><ul class=""><li id="570c" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><a class="ae kv" href="https://cloud.google.com/sdk/" rel="noopener ugc nofollow" target="_blank">谷歌云SDK </a></li><li id="79b6" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">库贝克特尔</li><li id="cd84" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><a class="ae kv" href="https://www.terraform.io/downloads.html" rel="noopener ugc nofollow" target="_blank">地形</a></li></ul><p id="00a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">验证和创建本地应用程序凭据:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="e13c" class="np ma iq nl b gy nq nr l ns nt">gcloud auth login<br/>gcloud auth application-default login</span></pre><p id="30df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后克隆<a class="ae kv" href="https://github.com/midl-dev/polkadot-k8s" rel="noopener ugc nofollow" target="_blank"> polkadot-k8s存储库</a>并发出以下Terraform命令:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="bbb4" class="np ma iq nl b gy nq nr l ns nt">cd terrraform<br/>terraform init<br/>terraform plan -out plan.out</span></pre><p id="6d58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，Terraform会要求您填充一个变量列表:验证器的名称、遥测URL、链类型、绑定地址等。关于<a class="ae kv" href="https://github.com/midl-dev/polkadot-k8s#populate-terraform-variables" rel="noopener ugc nofollow" target="_blank">的完整列表和完整示例</a>，请参见自述文件。你也可以用你所有的变量预填充一个名为<code class="fe nu nv nw nl b">terraform.tfvars</code>的文件。</p><p id="2af9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="3240" class="np ma iq nl b gy nq nr l ns nt">terraform apply plan.out</span></pre><p id="d0ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是部署一切的一个命令。它将:</p><ul class=""><li id="bf27" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated">创建一个Kubernetes集群。</li><li id="1218" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">构建必要的容器。</li><li id="31dd" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">下载并解压一个<a class="ae kv" href="https://dotleap.com/how-to-import-a-pre-synced-kusama-database/" rel="noopener ugc nofollow" target="_blank">预同步的数据库</a>，如果你传递了一个URL，可以更快的恢复。</li><li id="4682" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">旋转哨兵和验证者节点。</li><li id="ac80" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">调出<a class="ae kv" href="https://medium.com/simply-vc/panic-for-polkadot-2a3a97f0e9cb" rel="noopener"> Polkadot紧急警报器</a>预先配置，当设置出现问题时，它会向您发送电报警报。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/e99c2d6fd4788023c22b89c56045b83e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRLCz_Lh20yWNxXXRr0jVA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">几分钟内从零到同步。</p></figure><h2 id="6465" class="np ma iq bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">连接到您的群集</h2><p id="c252" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">运行Terraform命令后，您的环境将配置为连接到新创建的集群。</p><p id="3f75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用<a class="ae kv" href="https://k9scli.io/" rel="noopener ugc nofollow" target="_blank"> K9s实用程序</a>来浏览您的集群、显示日志和转发端口。从以下内容开始:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="5938" class="np ma iq nl b gy nq nr l ns nt">k9s</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/bfe30fb8acba22f5ff49742f6db917a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQvfJgRRKSKaJfllFFIIHQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一个验证节点由两个哨兵保护。</p></figure><p id="d6f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以点击<code class="fe nu nv nw nl b">l</code>来浏览日志并查看您的节点同步:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/1fcdd43c81fba945debae6cabd74cc70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_P5fCMMEBhBZga4ZbZmBw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">验证器节点被配置为只与两个哨兵对等。</p></figure><p id="88c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以点击<code class="fe nu nv nw nl b">shift+f</code>在您的私有节点上启用端口转发，然后将本地和远程端口设置为9944 (WebSocket):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/6e6db19d287ed2c8316f9fac9426cec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4-FZulTBA0Loe_P7n7bCQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">WebSocket端口9944将可以在本地访问。</p></figure><p id="ba2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在你的网页浏览器中打开<a class="ae kv" href="https://polkadot.js.org/apps/#" rel="noopener ugc nofollow" target="_blank"> polkadot.js app </a>，点击页面左上方，选择“本地节点”作为你的端点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/e4511c9dba235b33023bc5fe9abb9b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8_GYVai5WCqlYehUFZ4nQ.png"/></div></div></figure><p id="2648" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您现在可以绑定您的点令牌并<a class="ae kv" href="https://wiki.polkadot.network/docs/en/maintain-guides-how-to-validate-kusama#generating-the-session-keys" rel="noopener ugc nofollow" target="_blank">注入您的会话密钥</a>。然后<a class="ae kv" href="https://wiki.polkadot.network/docs/en/maintain-guides-how-to-validate-kusama#validate" rel="noopener ugc nofollow" target="_blank">根据指南注册为验证者</a>。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8e35" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">为什么是Kubernetes？</h1><p id="7094" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在风险证明网络中进行验证并不是一劳永逸的。您需要了解协议的发展，并仔细监控您的基础设施。Kubernetes提供了一个强大的抽象层，帮助您关注真正重要的东西——运行时。它的架构使得软件的增量更新变得容易。它消除了所有“它在我的机器上工作”的问题。</p><p id="b8a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Kubernetes还抽象出了云提供商(AWS、GCP、Azure)之间的差异。它减少了摩擦，实现了有利于网络去中心化的多云策略。像<a class="ae kv" href="https://k3s.io/" rel="noopener ugc nofollow" target="_blank"> K3s </a>这样的项目使得在你自己的服务器上运行它成为可能。</p><p id="579b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">学习Kubernetes对于运行一个可伸缩的分布式风险证明基础设施来说是一项值得的投资。</p></div></div>    
</body>
</html>