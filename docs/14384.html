<html>
<head>
<title>Last one out, turn off the lights</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最后一个出去，关灯</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/last-one-out-turn-off-the-lights-9647c8b3f52d?source=collection_archive---------6-----------------------#2022-12-06">https://betterprogramming.pub/last-one-out-turn-off-the-lights-9647c8b3f52d?source=collection_archive---------6-----------------------#2022-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5c77" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak"> <em class="kf">如何为开发和测试环境自动提供云资源</em> </strong></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/ebaea3902fb3220f578f11dd416af155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RQgJV9uoTzUHkQwh"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">克里斯蒂安·杜博万在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c086" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在使信息和云技术更具可持续性的背景下，工具、技术和原则有很大的空间来实现云基础设施的最佳利用。</p><p id="de63" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">考虑到这一点，我曾有过这样一个简单的想法:当工程师、质量分析师等不需要开发和测试环境时。不在使用它们。因此，这篇文章的名字让我想到…如果我在办公室工作，并且是最后一个下班的人，我可能会被指示(逻辑上)关掉所有的灯。</p><p id="c9a1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">我为什么不打开和关闭我在下班时间或周末不会使用的云环境？</strong></p><p id="2f76" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Lambda saver是一个简单的实验，旨在实现这个用例(以及我对更多地了解“云”的具体细节的内在需求)。它是一个函数，可以被调用来根据特定的时间表打开和关闭开发和测试环境。</p><p id="aa2b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该解决方案基本上包括为上午9:00和下午6:00创建一个<a class="ae kw" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" rel="noopener ugc nofollow" target="_blank"> AWS EventBridge </a>规则。这将触发一个<a class="ae kw" href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>的执行，它将根据与这些计算实例相关联的标记相应地启动/停止开发和测试环境。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi lt"><img src="../Images/3b7c776c89a489a4b875e1f54cd16aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*65Z6rBsH78Gxbaxb"/></div></div></figure><p id="7882" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此解决方案抽象了一些细节，如事件规则的周期性、用于托管这些环境的底层基础架构和云服务、调用功能时这些实例的初始状态、用于识别它们的技术、生产路径和所用的测试策略，以及由于概念验证的实验性质而被忽略的其他内容。</p><p id="dc52" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">lambda代码本身已经嵌入了必要的标签，我希望通过这些标签来过滤这些环境。</p><p id="27e6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这种情况下，它们是<code class="fe lu lv lw lx b">Env=dev</code>和<code class="fe lu lv lw lx b">Env=test</code>。起初，我试图让lambda调用将标签作为有效负载的一部分包含在调用中，但是找不到一种可靠的方法来触发带有这样一个有效负载的lambda调用的预定事件。因此，我决定暂时将它们保留在代码库中，尽管这对于您想要过滤哪些标签造成了限制。</p><p id="fe0e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此外，还有其他方法来实现相同的功能。AWS实例调度器可能是一个非常好的选择。这还要求标记您的目标实例，并定义周期、计划以及其他资源。</p><p id="9b69" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">结论是，云效率低下通常表现为分散的小问题，这些小问题在我们的云账单中占了很大的比重(在碳排放方面也是如此)。</p><p id="6945" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以通过分析你当前的团队环境，挑战你自己关于<strong class="kz ir">为什么你以你现在的方式做你所做的事情的假设，开始以一种务实的方式解决这些问题。</strong>更多关于在跟进条目中发现低效的流程。</p><p id="1bc0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">像往常一样，代码可以在<a class="ae kw" href="https://github.com/dfratte/lambda-saver" rel="noopener ugc nofollow" target="_blank">这里</a>获得，欢迎所有的反馈和改进。</p></div></div>    
</body>
</html>