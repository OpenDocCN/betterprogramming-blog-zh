<html>
<head>
<title>Building a Spring Boot REST API — Part 2: Working With Controllers and Responses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建Spring Boot REST API —第2部分:使用控制器和响应</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-spring-boot-rest-api-part-ii-7ff1e4384b0b?source=collection_archive---------0-----------------------#2017-12-11">https://betterprogramming.pub/building-a-spring-boot-rest-api-part-ii-7ff1e4384b0b?source=collection_archive---------0-----------------------#2017-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fb37" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">扩展博客控制器以包含所需的功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2e13f2aa27d6621fd1354e3753e460e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jWCC5eyaeo6rOJ2c8y5Zg.png"/></div></div></figure><p id="98f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<a class="ae lq" href="https://medium.com/@salisuwy/building-a-spring-boot-rest-api-a-php-developers-view-part-i-6add2e794646" rel="noopener">之前的教程</a>中，我们用一个虚拟控制器建立了一个<a class="ae lq" href="https://spring.io/projects/spring-boot" rel="noopener ugc nofollow" target="_blank"> Spring Boot </a>应用程序。</p><p id="a267" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本教程中，我们将扩展“博客控制器”以包含所需的功能。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="766d" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">博客项目类别</h1><p id="1882" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">“博客控制器”的功能是保存、更新、删除和获取博客条目。因此，我们需要一个包含博客属性的博客条目类。这些属性应该与“博客表”中的列相对应。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/909c9540366fc3590c019233b4a75703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFml-u8EyXnYg3E5DeFlbA.png"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><ul class=""><li id="b335" class="my mz it kw b kx ky la lb ld na lh nb ll nc lp nd ne nf ng bi translated">该类还必须有一个默认的构造函数。注意我有两个，在这种情况下。</li><li id="dab0" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated">我还实现了一个<code class="fe nm nn no np b">toString()</code>方法来打印类内容。</li></ul></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0541" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">博客数据</h1><p id="efb6" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">理想情况下，个人博客文章将从数据库表中获取，类似于上面所示。</p><p id="8edf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这一点上，我们不会使用数据库。将创建一个模拟数据库功能的类，稍后用实际的实现替换它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f8eba0fc91b9c0443ef66d9b199623e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*BnWpQ_ItNUPhFJbxnFpCUQ.png"/></div></figure><ul class=""><li id="1a09" class="my mz it kw b kx ky la lb ld na lh nb ll nc lp nd ne nf ng bi translated">该类将包含一个硬编码的博客文章列表。</li><li id="4ec7" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated">该类必须是单例的，以便更改可以跨不同的HTTP请求持久化。</li></ul><p id="3989" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">单身什么？根据Wikipedia，singleton是面向对象编程中使用的一种设计模式，允许一个类只有一个实例。</p><p id="4027" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">换句话说，如果一个类是单例的，那么在整个应用程序生命周期中，你只能拥有这个类的一个实例。</p><p id="f0a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Java中，通过创建一个返回该类实例的静态方法来实现singleton。</p><p id="083c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">静态方法检查该类是否已经实例化并返回现有实例，否则它创建该类的新实例并返回它。</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="8c39" class="nv lz it np b gy nw nx l ny nz">private static BlogMockedData instance = null;<br/>public static BlogMockedData getInstance(){<br/>   if(instance == null){<br/>       instance = new BlogMockedData();<br/>   }<br/>   return instance;<br/>}</span></pre><p id="adf8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，每当我们需要一个<code class="fe nm nn no np b">BlogMockedData</code>的实例时，我们就像这样实例化它:</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="6d8a" class="nv lz it np b gy nw nx l ny nz">BlogMockedData blogMockedData = BlogMockedData.getInstance();</span></pre><p id="1b5b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不是这样的:</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="6a24" class="nv lz it np b gy nw nx l ny nz">BlogMockedData blogMockedData = new BlogMockedData();</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="a391" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，<code class="fe nm nn no np b">delete()</code>方法从<code class="fe nm nn no np b">for-loop</code>之外的博客列表中删除了该项，这是为了避免<code class="fe nm nn no np b">java.util.ConcurrentModificationException</code>。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="991c" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">休息端点</h1><p id="56c6" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在修改控制器以使用<code class="fe nm nn no np b">BlogMockedData</code>类之前，让我们先看看REST端点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/9013a2a3f6c207594aef3033e6c382ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lGfFkcgNAMPn5S1-H07JbQ.png"/></div></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="cc32" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">处理不同的请求类型</h1><p id="e558" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">用于处理不同HTTP请求类型的Spring Boot注释:</p><ul class=""><li id="1615" class="my mz it kw b kx ky la lb ld na lh nb ll nc lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@RequestMapping</code> —用于处理任何请求类型。</li><li id="732a" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@GetMapping</code> —用于获取请求。</li><li id="88a8" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@PostMapping</code> —用于发布请求。</li><li id="0bd4" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@PutMapping</code> —对于看跌请求。</li><li id="bf81" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@PatchMappin</code> g —用于补丁请求。</li><li id="735e" class="my mz it kw b kx nh la ni ld nj lh nk ll nl lp nd ne nf ng bi translated"><code class="fe nm nn no np b">@DeleteMapping</code> —用于删除请求。</li></ul><p id="1ac2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要发出POST请求，处理请求的方法将被注释如下:</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="bd27" class="nv lz it np b gy nw nx l ny nz">@RequestMapping(value = "path", method = RequestMethod.<em class="ob">POST</em>)<br/>public returnType methodName(){...}</span></pre><p id="a3c2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者像这样:</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="5fe7" class="nv lz it np b gy nw nx l ny nz">@PostMapping("path")<br/>public returnType methodName(){...}</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="8988" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">路径变量和请求参数</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/045a00770c18e78a0ffbe35a58c9b3be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*EPjZh8Y6Wm9eAZAcF_wnQw.png"/></div></figure><p id="617e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">路径变量是请求URL中的变量，用<code class="fe nm nn no np b">@PathVariable</code>标注，例如<code class="fe nm nn no np b">id</code>。</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="f30e" class="nv lz it np b gy nw nx l ny nz">@GetMapping("/blog/<strong class="np iu">{id}</strong>")<br/>public returnType methodName(<strong class="np iu">@PathVariable</strong> String <strong class="np iu">id</strong>)<br/>{<br/>  ......<br/>}</span></pre><p id="0172" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请求参数是请求URL中带有注释<code class="fe nm nn no np b">@RequestParam</code>的键值对，例如<code class="fe nm nn no np b">param1</code>和<code class="fe nm nn no np b">param2</code>。</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="74a0" class="nv lz it np b gy nw nx l ny nz">@GetMapping("/blog")<br/>public returnType methodName(<strong class="np iu">@RequestParam</strong> String <strong class="np iu">param1, @RequestParam</strong> String <strong class="np iu">param2</strong>)<br/>{<br/>  ......<br/>}</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="1181" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">请求正文</h1><p id="8b91" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">POST、PUT和DELETE请求可以包含一个称为“请求体”的有效负载。有效载荷包含可以存储或更新的数据。有效载荷通常是JSON格式的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/ee0e15140dd5b6d33d6632ac8d1db9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCp-9Zua2ufrjgY4xAoqDw.png"/></div></div></figure><p id="7b1c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请求体的注释是<code class="fe nm nn no np b">@RequestBody</code>。由于请求体是一个键-值对，将其声明为<code class="fe nm nn no np b">Map&lt;String, String&gt;</code>是明智的。</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="7ecd" class="nv lz it np b gy nw nx l ny nz">@PostMapping("/blog")<br/>public Blog create(@RequestBody Map&lt;String, String&gt; body){...}</span></pre><p id="7032" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要提取相应的键及其值:</p><pre class="kj kk kl km gt nr np ns nt aw nu bi"><span id="fab2" class="nv lz it np b gy nw nx l ny nz">String id = body.get("id");<br/>String title = body.get("title");<br/>String content = body.get("content");</span></pre></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="9a94" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">控制器</h1><p id="ac65" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">查看修改后的控制器，第11行是获得<code class="fe nm nn no np b">BlockMockedData</code>单例实例的地方。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="ac60" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">快速笔记</h1><p id="8a2d" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我采用这种方法是为了确保这些步骤解释清楚，并且您理解正在发生的事情。</p><p id="089f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<a class="ae lq" href="https://medium.com/@salisuwy/building-a-spring-boot-rest-api-part-iii-integrating-mysql-database-and-jpa-81391404046a" rel="noopener">下一篇教程</a>中，我们将重构代码并集成MySQL数据库。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="a2f8" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结果(截图)</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/7c352adcb3d28f4933b52eff99799ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lr5-ZT_gXFTTTUdJ-alBBQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/0a5f3f86fa40ed0bf1281bdd18f346e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CvPd5A04xgzt4akwLes-Q.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3d7112016357d31ae9e0d49c170f2110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PuKYlPiHz6mCHF7D7sWWSg.png"/></div></div><p class="oh oi gj gh gi oj ok bd b be z dk translated">REST请求和响应</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="5228" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">下一步是什么</h1><p id="2efe" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">点击阅读<a class="ae lq" href="https://medium.com/@salisuwy/building-a-spring-boot-rest-api-part-iii-integrating-mysql-database-and-jpa-81391404046a" rel="noopener">下一篇教程，其中我们添加了对MySQL数据库和Java持久API (JPA)的支持。</a></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="b52e" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">源代码</h1><p id="f304" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated"><a class="ae lq" href="https://github.com/salisuwy/building-spring-boot-resp-api-v2" rel="noopener ugc nofollow" target="_blank">你可以从GitHub </a>下载源代码。</p></div></div>    
</body>
</html>