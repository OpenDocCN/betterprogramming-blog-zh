# 从 Python 到 Kotlin:需要了解的 10 个语言特性

> 原文：<https://betterprogramming.pub/going-from-python-to-kotlin-10-language-features-to-know-8982b9d921e4>

## 科特林很有趣

*变更日志:【2022 年 12 月 30 日——使用 Medium 的新代码块进行语法高亮显示*

![](img/9399a06b86708c9b7391f4736356367e.png)

照片由[塔利亚·特兰](https://unsplash.com/@thaliatran?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

可变性？零安全？`val`和`var`？这些是我刚开始接触时对 Kotlin 有些陌生的特征。

在一年前接触 Kotlin(和 JavaScript)之前，我是用 Python 编程的。从 Python 过渡到 Kotlin(和 JavaScript)并不容易，因为 Python 中不存在一些特性(你需要时间来认识到这一点)。

所以在这篇文章中，我将与你分享我学到的 10 大语言特征(因为这是一个很好的数字)。

如果你正在学习 Kotlin，这篇文章将是一个很好的总结。

如果你对 Kotlin 不感兴趣，但对其他语言感兴趣，就浏览一下这篇文章。大多数现代编程语言都有我在这里列出的相同特性。

# 内容

1.  [静态类型检查](#3bca)
2.  [只读保护](#24aa)
3.  [集合中的可变性](#ba7f)
4.  [无效安全](#565b)
5.  [作为一等公民的职能](#7b3c)
6.  [采集方法流畅界面](#54aa)
7.  [扩展功能](#ab17)
8.  [特定领域语言](#abaf)
9.  [可读函数名](#9492)
10.  [开关语句](#3b16)

# 1.静态类型检查

计算机编程语言

```
def greet(name):
    print(f"Hello, {name}")
```

科特林

```
fun greet(name: String) {
    println("Hello, $name")
}
```

你知道那些有属性错误的错误吗？我们认为变量是一个特定的类型，但它不是。进入静态类型检查。

静态类型检查通过*类型注释*——程序员指定变量的正确类型——和*类型推断*来实现。下面的程序是一个反例:

```
name: str = 123
```

注意 Python 允许*逐步类型化*，也就是说你可以注释类型，但是在你运行程序的时候不会影响到你。

Python 采用动态类型检查——只有在程序运行时才检查类型。像 Kotlin 这样的语言实现了静态类型检查，在程序运行之前验证语言结构的兼容性。

这增加了一层安全性，以确保您的程序是正确的。

如果你想在你的程序中包含静态类型检查，可以看看 Google 的 [mypy](https://mypy.readthedocs.io/en/stable/) (来自 Python)或 [pytype](https://github.com/google/pytype) 。

> 🎁 ***这个语言特性提供了什么？*** *安全*
> 
> *💡* ***它是如何实现的？*** *编译时检查和类型注释*

# 2.只读保护

在 Python 中，变量可以被重新分配(**“变量隐藏”**)。如果我们无意中将一个值重新赋给了代码中其他地方的一个变量，这是有潜在危险的。

在 Kotlin 中，变量可以被重新分配*，如果你明确地打算这样做的话。这种保护由变量`val` ue 前的`val`或`var`关键字声明**为只读**。否则，这是一个`var`可行。*

```
number = 5
number = 999  # okay
```

科特林(瓦尔)

```
val number = 5
number = 999 // compile-time error
```

科特林(var)

```
var number = 5
number = 999 // okay
```

> 🎁这个语言特性提供了什么？
> *安全*
> 
> *💡* ***它是如何实现的？*** `***val***`**和***`***var***`**关键词*****

# ****3.集合中的可变性****

****Python 中很少讨论可变性(不过在官方文档[中有](https://docs.python.org/3/reference/datamodel.html))。****

****一个容器对象(或者一个值的集合)是**可变的** ，如果它的值可以改变。****

****以下面的 Python 字典为例:****

```
****data = {
    "name": "Ali"
}****
```

****您可以通过添加另一个键值对`data1["name"] = "Singapore"`来更改这个对象，这意味着`dict`数据结构是可变的。但是，如果我们想保护数据不被(无意地)修改呢？用 Python 的标准库是做不到的。****

****在 Kotlin 中，上面的例子与此类似，使用了*可变映射*数据结构(类似于 Python 的字典)****

****科特林****

```
****val data2 = mutableMapOf(
    "name" to "Ali"
)****
```

****这导致了`MutableMap`类型。在这里，你可以分配`data2["name"] = "Singapore"`。但是如果我们想保护数据不发生突变，我们需要使用只读数据类型，`Map`。****

****科特林****

```
****val data3 = mapOf(
    "name" to "Ali"
)****
```

****如果您尝试运行`data3["name"] = "Singapore"`，将会遇到编译时错误。****

> ****🎁 ***这个语言特性提供了什么？*** 安全****
> 
> *****💡* ***是如何实现的？*** *数据结构*****

# ****4.零安全****

****计算机编程语言****

```
****def greet(name: Optional[str]) -> str:
    ...****
```

****科特林****

```
****fun greet(name: String?) -> String {
    ...
}****
```

****有时我们希望一个变量能够包含`None`。这些被称为*可空类型*。在 Python 中，它们被称为`Optional`类型。****

****在 Kotlin 中，这种类型更简洁地表示为变量类型的后缀`?`。(Swift 和 TypeScript 也使用这种语法。)****

****表达可空类型有助于程序员跟踪可能为空的变量，并安全地访问或“解开”(Swift 术语)这些变量。静态类型检查检查空安全。****

****假设我们有一个带有`name`属性的`Person`对象:****

****计算机编程语言****

```
****if person is None:
    return ""
else:
    return f"hello, {person.name}"****
```

****科特林****

```
****return person?.let { "hello, ${it.name}" }: ""****
```

****注意`person`是如何被小心访问的(通过*安全调用*操作器`?.`)。****

> ****🎁这个语言特性提供了什么？
> *安全、简洁*****
> 
> *****💡* ***是如何实现的？*** *可空类型，安全调用* `*?.*` *，非空断言* `*!!*` *，猫王运算符* `*?:*` *等等，作用域函数类似* `*let*` *。*****

# ****5.作为一等公民的职能****

****在 Python 中，传递函数通常是不习惯的(“一等公民”)，尽管我在 Keras 中看到过一些类似的情况，您可以为想要打印出来的度量定义一个函数。****

****因为不地道，所以在这里用 Kotlin 为例和大家分享一下。****

****这里有一个人为的例子(如果你能想出一个更好的例子，请告诉我！)在这里我们打印一个统计摘要(定义为`metric`)，给出一个数字列表(`data`)。****

```
****fun printSummary(data: List<Float>,
                 metric: (List<Float>) -> Float) {
    val summary = metric(data)
    println(summary)
}****
```

****看到它的实际应用:****

```
****printSummary(myList) { x ->
    x.sum() / x.size
}****
```

****注意后面的 lambda 语法(为了区别)和匿名函数。****

> ****🎁 ***这个语言特性提供了什么？*** *灵活性、可读性、简洁性*****
> 
> *****💡* ***在科特林是如何实现的？*** *匿名函数、高阶函数、尾随 lambda 语法*****

# ****6.收集方法的流畅界面****

****在 Python 中，我们很少使用函数式编程动词，如集合的 map、reduce 和 filter(“**集合方法**”)，将它们链接在一起(“ **fluent 接口**”)。这是因为列表理解(和字典理解)和数组编程语法更习惯。****

****这意味着我们没有接触到这种语言特征。****

****假设您想通过给每个元素加 3 来转换一个列表`[1,2,3]`，并且只取偶数结果。****

****在假设的 Python 中，它看起来像这样:****

```
****my_list.map(lambda x: x+3).filter(lambda x: x%2==0)****
```

****在科特林，它看起来像这样****

```
****myList.map { x -> x+3 }.filter { x -> x%2==0 }****
```

****在我看来从左到右读起来不错。****

****请注意，下面是您在 Python 中如何做的，尽管不习惯(也不可读):****

```
****list(filter(lambda x: x%2==0, map(lambda x: x+3, my_list)))****
```

****请注意，下面是您在 Python 中如何做的，尽管不习惯(也不可读):****

> ****🎁这个语言特性提供了什么？
> *可读性*****
> 
> *****💡* ***在科特林是如何实现的？*** *通过集合类的方法实现的动词。*****

# ****7.扩展功能****

****您是否知道可以从标准库或导入库中向现有类添加函数？****

****假设您想获得自纪元以来的时间(Unix 时间)。这是它在假设的 Python 中的样子。我准备把`datetime`类改名为`Datetime`(没错，`datetime`就是一个类！):****

```
****from datetime import Datetime

def Datetime.get_epoch_now():
    return this.strtime("%s").toInt()****
```

****请注意我是如何不经意地“扩展”了`Datetime`类来包含一个名为`get_epoch_now`的新方法的。****

****在 Kotlin 中，扩展函数是一个很好的特性，因为它允许你把相关的方法放在一起。****

> ****🎁 ***这个语言功能提供了什么？*** *可读性*****
> 
> *****💡* ***在科特林是如何实现的？*** *通过类扩展*实现****

# ****8.特定领域语言****

****特定领域语言(DSL)是一种由程序员定义的语言，以便其他程序员可以使用它来实现他们的目标。****

****Python 没有这个。****

****下面的例子显示了一个看起来与通常的 Kotlin 不同的语法(看起来更像 JSON-ish)。但是这个语法是*有效的*。摘自 https://github.com/zsmb13/VillageDSL[。](https://github.com/zsmb13/VillageDSL)****

```
****val newVillage = village {
    house {
        person {
            name = "Emily"
            age = 31
        }
        person(name = "Hannah") {
            age = 27
        }
        person("Alex", 21)
    }
}****
```

****我认为这个语言特性是令人兴奋的，因为你可以在思考客户代码或使用它的人的同时，发挥创造力。****

> ****🎁 ***这个语言特性提供了什么？*** *灵活性、可读性*****
> 
> *****💡* ***在科特林是如何实现的？*** *类型安全生成器通过* `*infix*` *es 方法命名一个类*****

# ****9.可读的函数名****

****您知道可以用空格定义函数或方法名*吗😱？！*****

****Kotlin 允许这样做(用反勾括起来):****

```
****fun `do something`() {

   ...
}****
```

****你这样称呼它:****

```
****`do something`()****
```

****虽然这通常只是为了编写测试函数，但是这个特性是有益的，主要是因为测试名可能会很长。****

****谢谢你，机灵鬼，你想得真周到。****

> ****🎁这个语言特性提供了什么？
> *可读性*****
> 
> *****💡* ***在科特林是如何实现的？*** *测试函数名的反斜杠语法*****

# ****10.交换语句****

****switch 语句在类 C 语言中很常见。这就像多个 if-else 语句，但用词更少。****

****让我们看看在 Kotlin 中使用 *when 表达式*是如何做到这一点的:****

```
****when x {
    1 -> print("x == 1")
    2 -> print("x == 2")     
    else -> print("x is neither 1 nor 2")
}****
```

****注意 Python 3.10 有更强大的东西——结构模式匹配(见这里的[和](https://docs.python.org/3/whatsnew/3.10.html#pep-634-structural-pattern-matching))，它类似于 switch 语句，但也分析对象的类型(“模式”)。****

> ****🎁 ***这个语言特性提供了什么？*** *简洁，可读性*****
> 
> *****💡* ***在科特林是如何实现的？*** *通过* `*when*`实现****

# ****参考****

****[科特林官方文档](https://kotlinlang.org/docs/getting-started.html)****

****伙计们，现在就到这里吧！我希望你学到了一些东西。学习一门新的编程语言很有趣，因为你会接触到可能对你想要的有帮助的新模式。****