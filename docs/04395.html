<html>
<head>
<title>3 Tips to Write Better React Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更好的React组件的3个技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-tips-to-write-better-react-components-3a57a62139d9?source=collection_archive---------0-----------------------#2020-04-10">https://betterprogramming.pub/3-tips-to-write-better-react-components-3a57a62139d9?source=collection_archive---------0-----------------------#2020-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="333e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">更小、功能更多的组件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/25b915a97834c6a335bcdff543634e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6CT6Rzh6_sssYR2m50S5w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@priscilladupreez?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">普里西拉·杜·普里兹</a>在<a class="ae ky" href="https://unsplash.com/s/photos/read-black-and-white?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1a8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这个sprint中的任务之一是以一种非常复杂的形式实现一个新特性，带有动态问题和在它们之间跳转的逻辑。我估计这项任务需要五个小时。我需要做的唯一更改是在发送时添加一个额外的验证。</p><p id="c956" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看到我需要更新的组件之前，我一直是这么想的。这个组件有300多行代码，有一个巨大的JSX标记，大约有150行，逻辑…这个组件中有许多<code class="fe lv lw lx ly b">setState</code>和有许多依赖关系的<code class="fe lv lw lx ly b">useEffect</code>。</p><p id="c49c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我很惊讶，也很惭愧，因为我写了这段代码，但它变成了一个我完全不理解的庞然大物。你知道，就像那些你盯着屏幕15分钟的时候，想着:“这个功能到底是干什么用的？”</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0322" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">useReducer而不是useState</h1><p id="d499" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我提到这个组件有多个<code class="fe lv lw lx ly b">useState</code>，这很难理解，因为我必须查找所有的<code class="fe lv lw lx ly b">setState</code>才能知道组件的哪个部分更新了某个状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/b7842e2c02d58415df4d2ab7c7504c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJKQeQs9vcsBo5N7FmcLEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相当糟糕的代码</p></figure><p id="de1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我知道，看起来很糟。如果您最终得到这样的代码，您必须考虑进行重构。这些状态中有许多是相关的，所以我可以创建一个reducer来处理这个表单的可能场景。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/352a334a9c1507ac20cd8f6cdc1303b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BMOu1XaZgboGV-bZ-VjCmw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用减速器的更好方法</p></figure><p id="108e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也增加了你对这些减压器作用效果的了解。</p><p id="0144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你在行动中分离你的逻辑时，你意识到什么行动影响状态的某些领域。这使您可以更好地控制状态，实现新功能也更容易。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="edd1" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">分离逻辑</h1><p id="9d94" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在这个表单中，我需要从GraphQL上的一个API获取一些数据。我用了<a class="ae ky" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank">阿波罗</a>和<code class="fe lv lw lx ly b">@apollo/react-hooks</code>。</p><p id="206f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我得到数据时，我需要更新一个状态。我可以创建一个自定义挂钩，只返回我需要的状态，而不是在同一个组件中获取数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/d07c62e293e8e3a5e89201fe6f2ce413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sr7ex9paNF4bV-PBQhHiig.png"/></div></div></figure><p id="9639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我需要使用变异或添加额外的查询，我也可以在这个钩子中编写这个逻辑。</p><p id="3bea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议您遵循关注点分离<strong class="lb iu"> </strong>原则来获取数据。您可以为与数据相关的逻辑创建一个单独的文件，并只返回将在组件中呈现的状态。</p><p id="d533" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也适用于你的UI，在需要的时候创建一个表示组件会帮助你更好地理解你的应用程序是如何工作的。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0eab" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">把它分成小块</h1><p id="6a93" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我写的monster组件的UI有100多行代码。</p><p id="1f4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">div</code>之后还有<code class="fe lv lw lx ly b">div</code>，我花了两分钟多才弄明白我到底在做什么。在这个<code class="fe lv lw lx ly b">div</code>宇宙中，有条件渲染，我不得不向下滚动一段时间才能知道它在哪里结束。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/5dcdc6e79e4e46bcf30b29286cdff11e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwuRwzZI7Y3sYnasZekGeA.png"/></div></div></figure><p id="336e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看上面的代码。那个<code class="fe lv lw lx ly b">currentForm</code>布尔正在包装一大块JSX标记。如果我们把这个UI移到另一个组件中，可读性会更好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/7bd751a6cf38b2247b5c4f8eb71b0ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-A7IdyuNWvVTi3djsbuVRw.png"/></div></div></figure><p id="4c20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的是，我可以把这个大组件分成更小的组件，这样下一个看到这个代码的人就会知道所有东西的确切位置。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="c0cf" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="1a46" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">没有完美的代码编写方式，不同的团队遵循不同的模式，但是如果你和我看到代码时的感觉一样，它可能也需要重构。</p><p id="de94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住:</p><ul class=""><li id="c77e" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">如果您使用多个<code class="fe lv lw lx ly b">useState</code>，请尝试将其更改为<code class="fe lv lw lx ly b">useReducer</code>。你会更好地控制和更广泛地了解你的状态在每一个行动中发生了什么。</li><li id="2630" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">可以重用的独立逻辑。您可以为数据提取创建一个自定义挂钩，或者创建可以在应用程序的其他部分使用的util函数。</li><li id="2d4a" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">将你的组件分割成小块。将JSX标记提取到不同的组件中，以提高代码的可读性。</li></ul></div></div>    
</body>
</html>