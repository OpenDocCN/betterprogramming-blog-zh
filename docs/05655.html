<html>
<head>
<title>Choose the Right Kubernetes Hosting Solution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">选择合适的Kubernetes托管解决方案</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/choose-the-right-kubernetes-hosting-solution-a842878fc594?source=collection_archive---------9-----------------------#2020-07-24">https://betterprogramming.pub/choose-the-right-kubernetes-hosting-solution-a842878fc594?source=collection_archive---------9-----------------------#2020-07-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="36de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">选择Kubernetes平台时需要考虑的事项</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2211fb29fec3727861d7dba06d6f2b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCOBpevfigJ0COX_de0TBQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">汉斯-彼得·高斯特在Unsplash<a class="ae ky" href="https://unsplash.com/s/photos/confusion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a></p></figure><p id="502c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">容器战争已经结束，Kubernetes 是明显的赢家！当它是关于运行您的容器，明确的选择是Kubernetes，没有第二个想法。但人们不知道的是，Kubernetes是一种复杂的野兽，需要驯服。</p><p id="8387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在您决定自己安装、运行和管理Kubernetes之前，请三思。安装Kubernetes用于游戏或作为您的开发环境是一回事，但是当涉及到在生产中运行它时，您需要考虑Kubernetes的许多方面，这些方面可能会带来比解决方案更多的复杂性。</p><p id="d344" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要误解我。我并不是说Kubernetes不是正确的解决方案，它确实简化了容器的管理。它的确是革命性的，改变了我们看待It基础设施和应用的方式。但是，由于它的灵活性，您不希望自己对其进行微调，因为您的环境可能需要也可能不需要许多功能。</p><p id="c649" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最佳实践只是指导原则，事情会根据您的具体使用情况而变化。尽管如此，我还是要说，更加从头开始的安装，包括使用像<code class="fe lv lw lx ly b">kubeadm</code>这样的工具，比仅仅运行几个命令需要更多的配置。</p><p id="1c0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题在于人们向典型公司的领导层推销Kubernetes的方式。看起来我们可以在几个小时内运行一个集群，大多数管理层都认为管理起来很容易，但事实并非如此。</p><p id="deb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看，如果您运行一个自托管的Kubernetes解决方案，您需要注意哪些方面:</p><ul class=""><li id="3024" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><strong class="lb iu">高可用性</strong> —单个控制平面Kubernetes集群似乎很容易启动，但当您必须确保高可用性时，事情就变得复杂了。等等，Kubernetes不是默认高度可用吗？嗯，是也不是。是的，因为如果您有多个工作节点分布在数据中心，您可以确保您的容器的高可用性。不会，因为您还需要在多个数据中心运行冗余的控制平面节点，以防您失去托管控制平面节点的DC。同样，您还需要确保etcd集群的高可用性。</li><li id="45f2" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><strong class="lb iu">安全性</strong>—Kubernetes托管最容易被忽视和脆弱的方面是安全性。默认安装是一个更通用的设置，如果您想在生产中使用Kubernetes集群，您将需要进一步强化它。尽管市场上有一些工具可以在您的集群上运行一致性测试，但是如果您缺少有经验的Kubernetes管理员，并不是所有的建议都很容易实现。</li><li id="140f" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><strong class="lb iu">管理</strong> —仅仅设置和强化集群是不够的。您必须定期备份集群、修补集群并进行升级。你必须确保按时安装所有的安全补丁。不仅如此，您还必须查看与集群管理相关的日常BAU活动。如果你不把这些自动化，你会把自己置于一个重大的风险境地。</li><li id="ca91" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><strong class="lb iu">与核心服务的集成</strong> —您需要使用Kubernetes控制器将您的定制安装与您的云和虚拟机API集成，这些控制器与这些提供商进行交互，以便为您的容器应用程序(如负载平衡器和持久卷)提供基础架构。这意味着您将配置和细节(比如API密钥和秘密)存储在Kubernetes控制平面节点中，因此需要确保适当的安全性以防止误用。</li></ul><p id="6a84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，你需要在使用Kubernetes的花费和节省之间取得平衡。成本对你来说可能不是一个因素，但如果你花了很多预算支付昂贵的Kubernetes专业人员，你可能要考虑一些可行的选择，将你从所有这些头痛。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="59fa" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">Kubernetes解决方案</h1><p id="3c78" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">所以，现在明显的问题是，我应该选择什么解决方案？这取决于您的情况和您的定位，但让我们试着了解一些场景，这将有助于选择适合您的平台。</p><h1 id="a179" class="mu mv it bd mw mx nr mz na nb ns nd ne jz nt ka ng kc nu kd ni kf nv kg nk nl bi translated">你已经在云端运行了吗？</h1><p id="0f79" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果答案是肯定的，那么您应该考虑一个托管解决方案来满足您的需求。它不仅可以快速创建集群并在其上部署容器，还可以为您管理集群。这意味着云提供商会为您处理大部分管理活动，例如确保高可用性、某种程度的安全性、升级以及为您的集群安装操作系统补丁，而您甚至不会注意到这一切。</p><p id="5646" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好在云上使用托管解决方案，而不是运行自己的基于IaaS的解决方案，即使后者会给你同样的结果。你不仅会从财务角度受益，还会省去自己管理一切的大麻烦。</p><p id="3085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些最受欢迎的托管云Kubernetes解决方案如下:</p><ul class=""><li id="a4ce" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><a class="ae ky" href="https://cloud.google.com/kubernetes-engine" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">谷歌Kubernetes引擎</strong> </a> <strong class="lb iu"> </strong> —谷歌的这款产品是市场上最健壮的托管Kubernetes集群之一。您需要支付工作节点和0.10美元/集群/小时<strong class="lb iu"> </strong>的管理费。最棒的是，有了谷歌Anthos，你还可以在内部运行GKE。我稍后会谈到这一点。</li><li id="0e42" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://azure.microsoft.com/en-gb/services/kubernetes-service/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Azure Kubernetes服务</strong></a>——对于那些已经使用Azure的人来说，你完全可以选择AKS作为你的Kubernetes解决方案。AKS最好的部分是微软对运行你的集群不收取集群管理费。您只需为您使用的工作节点和网络资源付费。从长远来看，如果你想使用承诺使用折扣或已经是微软的合作伙伴，它们也很便宜。</li><li id="8060" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://aws.amazon.com/eks/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">亚马逊弹性Kubernetes服务</strong> </a> — AWS的弹性容器服务已经有一段时间了，但他们现在把赌注压在了Kubernetes上，EKS正在发生很大的变化。它的定价极具竞争力，收取0.10美元/集群/小时的管理费，外加工作节点和其他基础设施成本，类似于Google。</li></ul><p id="c008" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要被管理费压得喘不过气来，因为这比雇佣一个专业的Kubernetes管理员来为你管理集群要便宜。</p><p id="3ef5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不同的云中还有其他可用的Kubernetes解决方案，但我不会一一介绍，因为我们需要研究其他场景。</p><h1 id="9af7" class="mu mv it bd mw mx nr mz na nb ns nd ne jz nt ka ng kc nu kd ni kf nv kg nk nl bi translated">您是否在内部运行？</h1><p id="5d59" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">内部infra是Kubernetes景观中的二等公民。这并不是说Kubernetes不在本地运行，而是它不提供开箱即用的特性，而这些特性通常是在云上运行时才允许的。例如，它不能为您旋转负载平衡器服务，也不能在默认设置中要求动态、持久的卷。如果您有一个虚拟化的内部基础架构，则有适用于VMware和VSphere的控制器可以帮助您实现这一功能。然而，由于它们没有被广泛使用，它们需要熟练的资源来维护。</p><p id="40c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管我会建议尽可能迁移到云，但如果法规或安全原因限制了您，那么有许多现成的解决方案可供内部部署市场使用:</p><ul class=""><li id="27d6" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><a class="ae ky" href="https://cloud.google.com/anthos/gke" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Anthos上的谷歌Kubernetes引擎</strong> </a> — Anthos是谷歌提供的一个应用管理平台，你可以将其安装在你的内部基础设施上，将其转换成与云一致的环境。一旦你安装了Anthos，你就可以在上面运行GKE，就像在云上运行一样。</li><li id="a9e0" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://www.openshift.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">OpenShift</strong></a>—Red Hat的open shift是市场上最受欢迎的本地Kubernetes安装之一，它允许您保护开箱即用的容器化应用程序。OpenShift是为企业构建的，他们非常重视安全性，但却牺牲了灵活性。它们有点贵，主要面向企业。</li><li id="e9be" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://rancher.com/docs/rancher/v2.x/en/cluster-provisioning/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Rancher</strong></a>—Rancher是一款基于Kubernetes的管理解决方案，可帮助您通过单一控制平面管理内部和云中的Kubernetes应用。虽然您可以使用Rancher来管理您的云设置，但在内部站点中，您可以使用Rancher的Kubernetes引擎(RKE)。这是一个由牧场主管理的Kubernetes集群，它是通过牧场主UI而不是通过更复杂的方法创建的。您可以挑选标准功能，只需点击一个按钮就可以打开和关闭它们。</li></ul></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="dc53" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">结论</h1><p id="fbf0" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果你仍然选择DIY，确保你使用的工具如<code class="fe lv lw lx ly b">kubeadm</code>、<code class="fe lv lw lx ly b">kops</code>或Kubespray。它们确保您运行标准设置。您还应该查看确保生产就绪的各个方面，并为您的集群运行<a class="ae ky" href="https://medium.com/better-programming/how-to-validate-your-kubernetes-cluster-with-sonobuoy-c91b282908fe" rel="noopener">一致性</a>和<a class="ae ky" href="https://medium.com/better-programming/how-to-harden-your-kubernetes-cluster-with-kube-bench-fae71eb24d8" rel="noopener">安全性测试</a>，因为大多数问题都将包含在其中。</p><p id="a412" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望你喜欢这篇文章。</p></div></div>    
</body>
</html>