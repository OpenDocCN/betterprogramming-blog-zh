<html>
<head>
<title>Setup a Proxy for API Calls for Your Angular CLI App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Angular CLI应用程序的API调用设置代理</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/setup-a-proxy-for-api-calls-for-your-angular-cli-app-6566c02a8c4d?source=collection_archive---------0-----------------------#2018-04-13">https://betterprogramming.pub/setup-a-proxy-for-api-calls-for-your-angular-cli-app-6566c02a8c4d?source=collection_archive---------0-----------------------#2018-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="255a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Angular CLI和webpack-dev-server中配置服务器端代理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1565832aaed3779d4b17cd6eda6b1571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0CYHtzQOtOkb-HDZQhBgA.png"/></div></div></figure><p id="359d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们开发一个Angular app，需要一个后端来持久化数据，这个后端往往是在<code class="fe lq lr ls lt b">localhost</code>的另一个端口上服务的。比如前端Angular app的URL是<a class="ae lu" href="http://localhost:4200," rel="noopener ugc nofollow" target="_blank"><em class="lv">http://localhost:4200</em>，</a>而后端服务器的URL是<a class="ae lu" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank"><em class="lv">http://localhost:3000</em>。</a>在这种情况下，如果我们从前端应用程序向后端服务器发出HTTP请求，这是一个跨域请求，我们需要做一些额外的工作来实现它。有两种解决方案。我们可以使用CORS或者服务器端代理。在这篇文章中，我将讨论服务器端代理方法。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="95b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Angular CLI使用<code class="fe lq lr ls lt b">webpack-dev-server</code>作为开发服务器。<code class="fe lq lr ls lt b">webpack-dev-server</code>利用了强大的<code class="fe lq lr ls lt b">http-proxy-middleware</code>包，当我们有单独的API后端开发服务器时，它允许我们在同一个域上发送API请求。</p><p id="69ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，我们的API后端有以下API端点:</p><p id="758b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">GET <a class="ae lu" href="http://localhost:3000/api/books" rel="noopener ugc nofollow" target="_blank"><em class="lv">http://localhost:3000/api/books</em></a></code></p><p id="2670" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用带有<code class="fe lq lr ls lt b">webpack-dev-server</code>的服务器端代理后，如果我们的Angular应用程序在端口4200上提供服务，我们可以向下面的URL发出HTTP请求以到达相同的API端点:</p><p id="d635" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">GET <a class="ae lu" href="http://localhost:4200/api/books" rel="noopener ugc nofollow" target="_blank"><em class="lv">http://localhost:4200/api/books</em></a></code></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="bad7" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在尚未退出的Angular CLI应用程序上启用服务器端代理</h1><h2 id="b188" class="mv me it bd mf mw mx dn mj my mz dp mn ld na nb mp lh nc nd mr ll ne nf mt ng bi translated">第一步:</h2><p id="1880" class="pw-post-body-paragraph ku kv it kw b kx nh ju kz la ni jx lc ld nj lf lg lh nk lj lk ll nl ln lo lp im bi translated">在我们项目的<code class="fe lq lr ls lt b">package.json</code> <strong class="kw iu">旁边创建一个名为<code class="fe lq lr ls lt b">proxy.conf.json</code> <em class="lv"> </em>的文件。</strong></p><h2 id="4ebb" class="mv me it bd mf mw mx dn mj my mz dp mn ld na nb mp lh nc nd mr ll ne nf mt ng bi translated">第二步:</h2><p id="2101" class="pw-post-body-paragraph ku kv it kw b kx nh ju kz la ni jx lc ld nj lf lg lh nk lj lk ll nl ln lo lp im bi translated">向新创建的<code class="fe lq lr ls lt b">proxy.conf.json</code> <strong class="kw iu"> </strong>文件添加以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="c6b9" class="mv me it bd mf mw mx dn mj my mz dp mn ld na nb mp lh nc nd mr ll ne nf mt ng bi translated">第三步:</h2><p id="1d04" class="pw-post-body-paragraph ku kv it kw b kx nh ju kz la ni jx lc ld nj lf lg lh nk lj lk ll nl ln lo lp im bi translated">将<code class="fe lq lr ls lt b">package.json</code> <strong class="kw iu"> </strong>文件的启动脚本编辑为:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="8448" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">步骤4:重新启动<code class="fe lq lr ls lt b">npm start</code> <strong class="kw iu"> </strong>流程，使我们的更改生效。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="e9ec" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在已退出的Angular CLI应用程序上启用服务器端代理</h1><p id="d859" class="pw-post-body-paragraph ku kv it kw b kx nh ju kz la ni jx lc ld nj lf lg lh nk lj lk ll nl ln lo lp im bi translated">第一步:打开<code class="fe lq lr ls lt b">webpack.config.js</code>文件，定位<code class="fe lq lr ls lt b">devServer</code>部分；</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="fb36" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第二步:用以下内容替换<code class="fe lq lr ls lt b">devServer</code>部分:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="4a23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文描述了Angular CLI和<code class="fe lq lr ls lt b">webpack-dev-server</code>中服务器端代理的基本配置。如果你想了解更多，请访问他们的官方网站:</p><p id="3c11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">Angular CLI:</strong><a class="ae lu" href="https://github.com/angular/angular-cli/blob/master/docs/documentation/stories/proxy.md" rel="noopener ugc nofollow" target="_blank">T5】https://github . com/Angular/Angular-CLI/blob/master/docs/documentation/stories/proxy . MD</a></p><p id="bc1a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">web pack dev-server:<em class="lv"/></strong><a class="ae lu" href="https://webpack.js.org/configuration/dev-server/#devserver-proxy" rel="noopener ugc nofollow" target="_blank"><em class="lv">https://web pack . js . org/configuration/dev-server/# dev server-proxy</em></a></p><p id="3ae1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我的下一篇<a class="ae lu" href="https://medium.com/@spencerfeng/setup-reverse-proxy-for-api-calls-for-your-angular-application-with-node-js-62321f0defb5" rel="noopener">文章</a>中，我将讨论如何在Nginx服务器上为产品Angular应用程序的API调用设置反向代理。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="45b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你觉得这篇文章有帮助，请访问<a class="ae lu" href="https://www.youtube.com/channel/UCoQ7C3JajfBOIjp7yWDj8Yg" rel="noopener ugc nofollow" target="_blank">我的YouTube频道</a>，在那里你也可以找到一些有用的编程技巧。</p></div></div>    
</body>
</html>