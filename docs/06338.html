<html>
<head>
<title>The Quick Start Guide for Vue 3's Composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 3的组合API快速入门指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-quick-start-guide-for-vue-3s-composition-api-fc0913fa9d97?source=collection_archive---------11-----------------------#2020-09-22">https://betterprogramming.pub/the-quick-start-guide-for-vue-3s-composition-api-fc0913fa9d97?source=collection_archive---------11-----------------------#2020-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c32d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">等待终于结束了！Vue 3的海贼王已经发布了</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c362488ab46c06c4db49d23c6ca8bb12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrqJkWeH6GeZYz62gRXyqQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://news.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>。</p></figure><p id="1a2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以放手一搏，开始自信地摆弄组合API，以编写更好的可维护和可重用代码。</p><p id="0845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">组合API是这个版本的基本特性，有几篇很棒的文章解释了相对于“旧”选项API的<a class="ae ky" href="https://css-tricks.com/an-early-look-at-the-vue-3-composition-api-in-the-wild/" rel="noopener ugc nofollow" target="_blank">动机</a>和<a class="ae ky" href="https://auth0.com/blog/getting-started-with-vue-3-composition-api/" rel="noopener ugc nofollow" target="_blank">好处</a>。甚至还有一个关于这个话题的视频课程。</p><p id="1740" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本指南的目标读者是已经了解组合API并希望快速入门的开发人员。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="39ca" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">心态和心智模式</h1><p id="b134" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们直接进入代码示例之前，让我们回顾一下什么是组合API。</p><p id="11e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个纯粹的添加剂，并建议混合替代品。这个API是为逻辑组织、封装和代码重用而设计的，它提供了完整的TS支持。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b8ab" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置</h1><p id="6106" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">setup</code>函数是组件的入口点。在这里，您可以<em class="nd">组合</em>组件的功能，并向模板或呈现函数公开任何变量或方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="71d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mz na nb nc b">setup</code>函数在<code class="fe mz na nb nc b">beforeCreated</code>生命周期挂钩之前被调用，因此无法访问您通常所期望的<code class="fe mz na nb nc b">this</code>。</p><p id="37a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它接收<code class="fe mz na nb nc b">props</code>和<code class="fe mz na nb nc b">context</code>作为参数。</p><p id="78a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nd">注意:</em> <code class="fe mz na nb nc b"><em class="nd">props</em></code> <em class="nd">对象是反应性的，析构它会使其失去反应性。</em></p><p id="e619" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像常规函数一样，为了使它异步，您在方法声明前添加了<code class="fe mz na nb nc b">async</code>。这与新的<code class="fe mz na nb nc b">Suspense</code>特性配合得非常好，你可以在文档中读到更多关于<a class="ae ky" href="https://vuejsdevelopers.com/2020/07/13/vue-async-components-suspense/" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="b6cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在使用Vue的SFC，您可以利用语法上的sugar <a class="ae ky" href="https://github.com/vuejs/rfcs/blob/sfc-improvements/active-rfcs/0000-sfc-script-setup.md#using-setup-arguments" rel="noopener ugc nofollow" target="_blank"> RFC </a>并将变量暴露给模板，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f6f2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">反应</h1><p id="5039" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Vue 3中许多令人兴奋的事情之一是新的反应系统。它不仅被抽象成一个单独的包，而且还解决了在Vue 2中与数组或对象交互时的一些问题</p><h2 id="a59f" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated"><strong class="ak">状态</strong></h2><p id="2e05" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">既然我们已经理解了如何将变量从<code class="fe mz na nb nc b">setup</code>方法传递到模板，那么让我们看一下如何定义一个反应变量。</p><p id="9a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以前，使用选项API，您将在数据选项中定义它。现在你有两个选择:<code class="fe mz na nb nc b">ref</code>或者<code class="fe mz na nb nc b">reactive</code>。</p><p id="140f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两者都允许您创建对对象或原始数据的被动引用。</p><p id="bd73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于JavaScript的工作方式，像<code class="fe mz na nb nc b">string</code>、<code class="fe mz na nb nc b"> number</code>和<code class="fe mz na nb nc b">boolean</code>这样的原语类型是通过值传递的，而对象和数组是通过引用传递的——因此引入了<code class="fe mz na nb nc b">ref</code>。</p><p id="a944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相应地，您可以将<code class="fe mz na nb nc b">ref</code>用于图元，将<code class="fe mz na nb nc b">reactive</code>用于对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="74d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nd">注意:</em> <code class="fe mz na nb nc b"><em class="nd">refs</em></code> <em class="nd">总是被包裹在一个对象中，所以如果你想在你的</em> <code class="fe mz na nb nc b"><em class="nd">setup</em></code> <em class="nd">方法中访问值，你就得这样访问</em><code class="fe mz na nb nc b"><em class="nd">.value</em></code><em class="nd">:<br/></em><code class="fe mz na nb nc b"><em class="nd">firstName.value = 'Batman'</em></code><em class="nd">。</em></p><h2 id="6045" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">计算</h2><p id="b03b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这里变化不大。它如你所料的那样工作。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="4eb0" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated"><strong class="ak">观察者</strong></h2><p id="606c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">与Options API类似，您可以观察其他属性。</p><pre class="kj kk kl km gt ns nc nt nu aw nv bi"><span id="9369" class="ng md it nc b gy nw nx l ny nz">import { watch } from 'vue'</span><span id="c4e6" class="ng md it nc b gy oa nx l ny nz">watch([fooRef, barRef], ([foo, bar], [prevFoo, prevBar]) =&gt; {<br/>  /* react to change */<br/>})</span></pre><h2 id="e940" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated"><strong class="ak">方法</strong></h2><p id="c953" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了创建一个方法，您只需编写一个常规的JavaScript函数。只要确认你的<code class="fe mz na nb nc b">return</code>或<code class="fe mz na nb nc b">export</code>功能，如果你希望它在你的模板中可用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="d3a8" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">模板参考</h2><p id="76aa" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如前所述，没有<code class="fe mz na nb nc b">this</code>，因此您可能想知道如何访问<code class="fe mz na nb nc b">this.$refs</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="d8a1" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">生命周期挂钩</h2><p id="b2f0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可以通过调用<code class="fe mz na nb nc b">onMounted</code>和<code class="fe mz na nb nc b">onXXX</code>来访问除<code class="fe mz na nb nc b">created</code>和<code class="fe mz na nb nc b">beforeCreated</code>之外的所有生命周期挂钩。</p><pre class="kj kk kl km gt ns nc nt nu aw nv bi"><span id="d103" class="ng md it nc b gy nw nx l ny nz">import { onMounted, onUnmounted } from 'vue'</span><span id="ff45" class="ng md it nc b gy oa nx l ny nz">onMounted(() =&gt; { /* do stuff here */ }</span></pre><h2 id="a0b6" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">创建可组合的</h2><p id="f481" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们已经看到了如何使用新的组合API。让我们探索如何使用它来组成组件。</p><p id="5a03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想要在几个组件中重用鼠标值<em class="nd"> X </em>和<em class="nd"> Y </em>，我们可以编写一个简单的composable。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2ebe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以在组件中使用这个可组合的组件。</p><pre class="kj kk kl km gt ns nc nt nu aw nv bi"><span id="a675" class="ng md it nc b gy nw nx l ny nz">&lt;template&gt; {{ x }}, {{ y }} &lt;/template&gt;</span><span id="d1ee" class="ng md it nc b gy oa nx l ny nz">&lt;script setup&gt;<br/>import { useMousePosition } from './useMousePosition';</span><span id="b156" class="ng md it nc b gy oa nx l ny nz">export const { x, y } = useMousePosition();<br/>&lt;/script&gt;</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b775" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">实践和贡献</h1><p id="894e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们已经介绍了基础知识，您可以开始摆弄和创建一些composables。</p><p id="f3ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也是一个为开源做贡献的绝佳机会，因为还没有太多的组件。如果你想要一些灵感，你可以看看<a class="ae ky" href="https://github.com/streamich/react-use" rel="noopener ugc nofollow" target="_blank">react——使用</a>,将一些钩子移植到这个包中。</p><div class="ob oc gp gr od oe"><a href="https://github.com/antfu/vueuse" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">安特富/乌尤斯</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">基本Vue组合API的集合(受react-use启发)参考函数列表或文档了解更多…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">github.com</p></div></div><div class="on l"><div class="oo l op oq or on os ks oe"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f833" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">额外资源</h1><p id="82c8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">以下是关于Vue 3的组合API的有用资源列表:</p><ul class=""><li id="1ee4" class="ot ou it lb b lc ld lf lg li ov lm ow lq ox lu oy oz pa pb bi translated"><a class="ae ky" href="https://composition-api.vuejs.org/" rel="noopener ugc nofollow" target="_blank">公文</a></li><li id="8498" class="ot ou it lb b lc pc lf pd li pe lm pf lq pg lu oy oz pa pb bi translated"><a class="ae ky" href="https://levelup.gitconnected.com/developing-a-full-app-using-the-vue-3-composition-api-4fd9431f2136" rel="noopener ugc nofollow" target="_blank">用Composition API写的博客</a></li><li id="7d74" class="ot ou it lb b lc pc lf pd li pe lm pf lq pg lu oy oz pa pb bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=Jy6M1LHsh5c" rel="noopener ugc nofollow" target="_blank">视频解说</a></li><li id="887e" class="ot ou it lb b lc pc lf pd li pe lm pf lq pg lu oy oz pa pb bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=6D58SI9P-aU&amp;list=PLCxzy-hmQq9FnnpckFDeDtbpsUqxdheQn&amp;index=15" rel="noopener ugc nofollow" target="_blank">最佳实践模式视频</a></li></ul><p id="2cf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这个指南对你有所帮助。感谢阅读，享受Vue 3！</p></div></div>    
</body>
</html>