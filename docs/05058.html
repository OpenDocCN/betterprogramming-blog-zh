<html>
<head>
<title>Build a Simple Progress Bar You Can Add Anywhere in Your App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个简单的进度条，你可以把它添加到你的应用程序的任何地方</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-simple-progress-bar-you-can-add-anywhere-in-your-app-27330ef6dba7?source=collection_archive---------18-----------------------#2020-06-03">https://betterprogramming.pub/build-a-simple-progress-bar-you-can-add-anywhere-in-your-app-27330ef6dba7?source=collection_archive---------18-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca54" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在不到一分钟的时间内将进度条添加到任何屏幕上</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/44855928e4f23a9c10840130dc71cf8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Bc15V1XBXguHOCJkbx0HTg.gif"/></div></figure><p id="4dcd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如今，我们在许多应用程序中都可以看到进度条。在检查相关文章和代码时，我注意到许多人关注于如何创建进度条，但没有同样重视以通用或可重用的方式编写进度条，以便我们可以轻松地将其集成到任何屏幕中。</p><p id="3c04" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这里，我试图使一个进度条在任何屏幕上都易于使用。</p><p id="8d2a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，我们将创建一个进度条，然后，我们将看到如何使它成为一个通用组件。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="d018" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">进度条的创建</h1><p id="9f1e" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">为了创建进度条，我们需要一个协议，所以我声明如下:</p><h2 id="9dee" class="mq lu it bd lv mr ms dn lz mt mu dp md kz mv mw mf ld mx my mh lh mz na mj nb bi translated">为进度条声明协议</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/4988cc49070d9979eb2567abc24bf298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0FCO8C301kRbif8sQNR2BQ.png"/></div></div><p class="nh ni gj gh gi nj nk bd b be z dk translated">进度条协议</p></figure><p id="f225" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我知道你在想什么:这里真的需要吗？</p><p id="db50" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">答案是肯定的，我们很快就会知道为什么需要它。</p><h2 id="c6a5" class="mq lu it bd lv mr ms dn lz mt mu dp md kz mv mw mf ld mx my mh lh mz na mj nb bi translated">现在我们正在创建进度条</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2516" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">注意:</strong>在阅读其他关于进度条的文章时，我发现其中最好的一篇文章是Marina Sauca 解释了我们如何创建进度条。所以我使用了那些代码，并根据我们的要求做了必要的修改。</p><p id="9e13" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在故事的开始，我在这篇文章中说过，我们关注的是如何将进度条作为一个通用组件，可以很容易地在任何屏幕上使用，所以这里我跳过了进度条视图的解释。如果你有兴趣，<a class="ae nt" href="https://medium.com/flawless-app-stories/custom-progress-bars-dc1c1c111751" rel="noopener">阅读前面提到的文章</a>。</p><p id="7336" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在我们有了进度条，让我们继续我们的故事。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="b58b" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">这里，这个故事的主要部分开始了</h1><p id="e533" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">那么，我们如何使它通用并适用于所有屏幕呢？</p><p id="26c4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">简单:创建一个父视图控制器，并将其添加到那里。继承所有我们需要的屏幕。</p><p id="01ad" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">抱歉，我们不能这样做，因为在我们的应用程序中，我们有不同类型的屏幕，如<code class="fe nl nm nn no b">UIViewController</code>、<code class="fe nl nm nn no b">UITableViewController</code>和<code class="fe nl nm nn no b">UICollectionView</code>，所以没有父类可以添加这些。</p><p id="f85c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">好的，我们将在<code class="fe nl nm nn no b">UIViewController</code>上写一个扩展，在那里写代码并添加到视图中。</p><p id="9512" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">注:</strong>抱歉，如果在<code class="fe nl nm nn no b">tableView</code>和<code class="fe nl nm nn no b">collectionView</code>下方的<code class="fe nl nm nn no b">UITableViewController</code>和<code class="fe nl nm nn no b">UICollectionViewController</code>的原图中看到，不能更改<code class="fe nl nm nn no b">tableView</code>和<code class="fe nl nm nn no b">collectionView</code>的边框。因此，在这种情况下，您可以添加它，但它不会在所有情况下都可见。</p><p id="59ad" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">那么，我们应该如何以及在哪里添加这个进度条，使其可见并易于访问呢？</p><p id="3cf3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们要做的是当用户显示进度条方法时，我们将在视图上添加进度条。而当用户隐藏进度条方法时，那么我们就隐藏它。</p><p id="7059" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在我们有一个可以添加它的地方。另一个问题是在哪里写代码。</p><p id="d7e8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以我们在这里写了一个对<code class="fe nl nm nn no b">UIViewController</code>的扩展。</p><p id="68d7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">嘿，现在我们有了所有问题的答案，所以让我们写代码。</p><p id="0e37" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">注意:</strong> <em class="nu"> </em>在创建进度条视图之前，我们已经在协议上声明了它(是的，我们需要它)。在这里我解释一下为什么我们需要它。</p><p id="f9d2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们在<code class="fe nl nm nn no b">UIViewController</code>上编写扩展并采用相同的协议，这反过来又采用了<code class="fe nl nm nn no b">ProgressBarView</code>。通过这样做，我们将可以访问协议中声明的所有方法。你可以在下面看到扩展的框架:</p><pre class="kj kk kl km gt nv no nw nx aw ny bi"><span id="6196" class="mq lu it no b gy nz oa l ob oc">extension UIViewController : ProgressBarProtocol {<br/>    func showProgressBar() {<br/>        <br/>    }<br/>    <br/>    func hideProgressBar() {<br/>        <br/>    }<br/>    <br/>    func setProgressBarColors(barColor: UIColor, <br/>                         gradientColor: UIColor) {<br/>        <br/>    }<br/>}</span></pre><p id="19ca" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，我们需要<code class="fe nl nm nn no b">ProgressBar</code>对象。然后，我们可以显示、隐藏或改变它的颜色。</p><p id="5b8d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果我们尝试在扩展中声明一个变量，我们会得到这样的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi od"><img src="../Images/dc663f7c8c87e98682571d593a043784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dtGb4rcc5qq5ObAr3GWJoA.png"/></div></div></figure><p id="b875" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，我们该怎么办？</p><ul class=""><li id="739b" class="oe of it ks b kt ku kw kx kz og ld oh lh oi ll oj ok ol om bi translated">扩展不能包含存储属性，但是我们可以将其声明为closer。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi on"><img src="../Images/b62a0ff78924995edf0d807c167ca0a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qK-7ihH5--DDSgOHOg98uw.png"/></div></div></figure><p id="d39e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">是的，这编译成功。所以让我们添加所需的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oo"><img src="../Images/75617b0f81c8a3f698d49cee142e8b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBCM4XZcaIf_Lk4VKeUbfQ.png"/></div></div></figure><p id="527c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们一行一行地讨论上面的代码。</p><ul class=""><li id="9d6d" class="oe of it ks b kt ku kw kx kz og ld oh lh oi ll oj ok ol om bi translated">在第一种情况下，我们得到了t <code class="fe nl nm nn no b">opViewController</code>视图。</li><li id="415c" class="oe of it ks b kt op kw oq kz or ld os lh ot ll oj ok ol om bi translated">在第二个条件中，我们检查是否已经给<code class="fe nl nm nn no b">view</code>添加了一个<code class="fe nl nm nn no b">progressBar</code>。这里，我们避免为同一个屏幕创建新的对象。我们为此添加了约束。我们将<code class="fe nl nm nn no b">progressBar</code>高度设置为<code class="fe nl nm nn no b">3</code>。</li></ul><p id="381b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在是时候将代码添加到其他协议方法中了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ou"><img src="../Images/57d22039d81de61b80bc1bb48b287258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddp6fvTswHaJxsvN3Q0Umw.png"/></div></div></figure><p id="af9c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">正如你在上述所有方法中看到的，我们只是将方法调用传递给协议。由于协议的原因，这看起来更简单。(这里我们对<code class="fe nl nm nn no b">UIViewController</code>和<code class="fe nl nm nn no b">ProgressBar</code>使用相同的协议。)</p><p id="7a73" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这里，我考虑到我们在所有屏幕上都需要这个<code class="fe nl nm nn no b">ProgressBar</code>，所以我直接在<code class="fe nl nm nn no b">UIViewController</code>上写了一个扩展。如果我们在一些屏幕上需要它，我们需要在<code class="fe nl nm nn no b">ProgressBarProtocol</code>上写一个扩展，我们可以在需要的屏幕上采用这个协议。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h2 id="ba42" class="mq lu it bd lv mr ms dn lz mt mu dp md kz mv mw mf ld mx my mh lh mz na mj nb bi translated">是时候在我们的屏幕上使用代码了</h2><p id="6b47" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">正如你在<code class="fe nl nm nn no b">fetchImage()</code>方法代码中看到的，我们在API调用之前调用<code class="fe nl nm nn no b">showProgressBar()</code>方法，一旦我们得到它的响应，我们就调用<code class="fe nl nm nn no b">hideProgressBar()</code> <strong class="ks iu"> <em class="nu"> </em> </strong>方法。</p><p id="fdf4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你想让<code class="fe nl nm nn no b">progressBar</code>变成不同的颜色，那么你需要调用下面的方法:</p><pre class="kj kk kl km gt nv no nw nx aw ny bi"><span id="71c9" class="mq lu it no b gy nz oa l ob oc">setProgressBarColors(barColor: .red, gradientColor: .yellow)</span></pre><p id="382f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">等等，还有一件事。让我们在导航栏上添加一个进度条，这样就有了导航栏的一个实例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="e0d7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">感谢阅读！</p></div></div>    
</body>
</html>