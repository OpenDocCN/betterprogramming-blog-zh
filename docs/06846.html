<html>
<head>
<title>Why You Should Use Kubernetes and Docker Together</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么你应该一起使用Kubernetes和Docker</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-you-should-use-kubernetes-and-docker-together-4e43c13b2e26?source=collection_archive---------14-----------------------#2020-11-10">https://betterprogramming.pub/why-you-should-use-kubernetes-and-docker-together-4e43c13b2e26?source=collection_archive---------14-----------------------#2020-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="29ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这不是选择一个而不是另一个</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d2c9e19f68e1121f9fe7d65f4744c217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEYw4tafFpE_woQ78ws65A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="091d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我似乎总是遇到的一个问题是应该使用Docker还是Kubernetes。我认为有一个小小的误解，你必须使用其中一个。为什么不两个都用？我的意思是，Kubernetes不仅允许您使用现有的Docker容器和工作负载，而且还使您能够解决在扩展时遇到的一些复杂问题。</p><p id="7858" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了更好地回答这个问题，我们将从一个简单的云原生应用程序开始。让我们假设这个应用程序的前端是用Node.js支持的React编写的，我们使用Java进行数据库访问。对于访问外部API，也许我们将使用Python来允许我们服务rest端点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/19e7bf579ce684e84bc7ddf678e826cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkgIj0qzMRBBW3MwTMuGBw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="ee42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">部署此应用程序的纯Docker方法需要将应用程序移动到某个服务器堆栈。这个服务器堆栈将有硬件、操作系统(Ubuntu)和安装在该操作系统之上的Docker守护进程。这将使我们能够旋转集装箱。Docker提供了几个很棒的工具来处理我们的容器化应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/53bd115545e7c9e112b564ab4e0df26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1tq9T5nTQo3WPbbjV4HTpA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="4805" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，一旦我们使用这些应用程序并从中创建Docker容器，我们将进入命令部分。我们将执行<code class="fe lr ls lt lu b">docker build</code>、<code class="fe lr ls lt lu b">docker push</code>到注册表，SSH到堆栈，然后最后执行<code class="fe lr ls lt lu b">docker run</code>甚至<code class="fe lr ls lt lu b">docker-compose</code>来启动我们的容器。通过使用Docker和它提供的工具，简单的部署变得非常容易。</p><p id="a815" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们继续扩展各个部分，以利用Docker提供的所有资源。我们可以根据需要将它们向外扩展任意多次，但是在本文中，我们假设我们向外扩展了两次。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bb6fb4834e919ae823cac97732b61bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rEtd7Y1I1R2MTD_Rg6e_9g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="8975" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">想象一下，我们的应用程序开始获得更多的负载。越来越多的人点击它，我们最终需要扩大规模，以便能够提供更好的用户体验。DevOps工程师的第一反应将是创建新的硬件，并多次进行相同的部署，因为他们已经有了构建该堆栈的脚本。</p><p id="3277" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这可能会因为许多原因而失败。当您开始进行扩展时，DevOps工程师将不得不编写脚本来单独扩展组件(因为这是基于微服务的应用程序的优势之一)，并找到最有效的方式来响应负载。他们还必须尽可能高效地识别和解决用户体验问题。</p><p id="b69a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一个很好的例子可能是当你的开发团队必须创建一个新的微服务来支持一个新的需求。DevOps工程师将不得不找出在哪里将它们组合起来——特别是如果你已经有效地利用了硬件的话。</p><p id="0855" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是像Kubernetes这样的编排工具的用武之地。Kubernetes将允许您使用现有的Dockerized应用程序，但也编排它们，更有效地利用您的服务器和空间。在下图中，方框代表一个服务器堆栈。但是在Kubernetes的土地上，它们是工蜂节点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e5f695a95412d8b0c71ddcc0c8e1e146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwzLOE2Fm_NeT3f7iu0a6w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="7508" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将在这些工作节点的每一个上安装Kubernetes，中心节点是主节点。这个主节点连接到所有工作节点，并决定在哪里托管Docker容器，如何将它们组合在一起，甚至管理编排(即启动、停止、更新等)。).</p><p id="1b23" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我想简单介绍一下Kubernetes提供的三个主要优势。它们是部署，使开发更容易，并提供监控工具。正如所料，第一步将是部署。回到我们的应用程序架构，假设我们要部署React应用程序大约十次。所以我们会说我们需要十个实例，每个实例预计消耗大约128兆字节。当我们把它打包时，我们得到的是一个Kubernetes部署。请记住，您可以在部署之前向Docker容器添加更多参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/75a95ce5ce61bbe04ba47a8955fefc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YKH9npNcFR3nEBgNT7Ni4g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="9cfc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Kubernetes部署不是一次性的事情。它是与应用程序一起成长、一起生活、一起呼吸的东西——整个堆栈。如果React应用程序发生崩溃，Kubernetes将自动重启它，返回到我们第一次创建该部署时确定的状态。因此，部署总是在增长，并且总是与我们的应用程序共存。我相信您会同意我的观点，除了可伸缩性之外，这种部署更容易。</p><p id="c8f5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Kubernetes如何处理开发？一旦我们为每个单独的服务创建了部署并将其全部横向扩展，您会注意到我们有许多不同的微服务，它们具有不同的端点。例如，如果我们的前端需要访问数据库，可能会有十个不同的Java应用程序实例与数据库进行对话。在这种情况下，Kubernetes为我们横向扩展的所有微服务部署负载平衡。此外，它利用服务注册和发现功能，允许我们的应用程序使用称为Kubernetes服务的东西相互通信。因此，对于每一个部署，Kubernetes还将创建一个服务(比如服务A、B和C)。简而言之，这些应用程序现在只需使用这些服务名就可以相互通信。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6cc0a9eeb2aaa859a38db1b3de9f34eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96IJotFN3FA70r5nJB6gZQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="fea8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我最后想谈的是监控。Kubernetes有很多内置功能，允许您在简洁的UI中查看日志和CPU负载。这些都很酷，但事实是您可能希望在您的应用程序中看到这一点。开源社区已经开发了几个工具，让您对正在运行的应用程序进行自省。我考虑的主要是Istio。Istio本身是一个很大的主题，我将在以后的文章中讨论，但是现在，值得注意的是，当涉及到监控时，它很方便。</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><h1 id="819c" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">结论</h1><p id="4c4a" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">这不是在Kubernetes和Docker之间选择的问题。这是其中一个互相补充的例子。Kubernetes允许您利用现有的Docker工作负载，大规模运行它们，并处理真正的复杂性。</p><p id="d38d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Kubernetes是一个很好的入门工具，即使你正在开发一个小的应用程序，并打算在未来进行扩展。如果您已经在应用程序中利用了Docker和containers，那么将它们迁移到Kubernetes可以帮助您解决几乎每个应用程序在扩展时都会遇到的一些操作开销。</p></div></div>    
</body>
</html>