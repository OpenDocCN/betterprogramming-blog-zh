<html>
<head>
<title>How to use Ngx-Translate in Angular?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中使用Ngx-Translate？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/fantastic-translations-and-where-to-find-them-421ee46f59db?source=collection_archive---------5-----------------------#2019-12-07">https://betterprogramming.pub/fantastic-translations-and-where-to-find-them-421ee46f59db?source=collection_archive---------5-----------------------#2019-12-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5e52" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">精彩的翻译以及在哪里可以找到它们</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27a931ae80e7d2c33fb21f2509585126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzZtBeJ_rVNwEhjqiuBu3Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">全世界的人都说不同的语言</p></figure><h2 id="9c9f" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">如何使用静态翻译文件在Angular中设置翻译</h2><p id="18f4" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">如果你生活在一个说多种语言的国家，你不会想设计一个只针对一种语言的网站。</p><p id="cdb5" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">无论你是在经营一家企业还是像我一样创建一个网站，如果访问者必须努力翻译你的内容，他们很可能不会在你的网站上花太多时间。我想分享我在Angular中设置翻译的经验，并给出一些代码片段来使事情更清楚。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="c3f5" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">您应该首先在assets文件夹中创建一些语言文件。这些翻译以简单和特定的格式存储。首先，您编写密钥，然后提供正确的翻译值。我只给出了一个英文翻译文件<code class="fe na nb nc nd b">en.json</code>的例子，但是你可以随意添加。只为您的目标受众添加语言。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="1a55" class="ky kz it nd b gy ni nj l nk nl">{  <br/>  "<strong class="nd iu">current.language</strong>": "en",<br/>  "<strong class="nd iu">a.message</strong>": "My awesome message",<br/>  <strong class="nd iu"><em class="nm">...</em></strong><br/>}</span></pre><p id="88b5" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">嵌套键和值在技术上是可行的，但如果我是你，我不会这么做。我的第一个原因是，在编辑器中搜索关键字变得很困难。这也意味着不能再复制粘贴密钥；您仍然可以在像Intellij这样的优秀编辑器中复制引用。</p><p id="f71d" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">您还需要一个数据结构来表示项目中选择的语言。在我们的应用程序中，你总是有两种类型的语言:一种是当前活动的语言。下面的代码将允许我们简单地构造一个类似于<code class="fe na nb nc nd b"> Languages.from(current, supportedLanguages)</code>的语言对象。很方便，不是吗？</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="5fa8" class="ky kz it nd b gy ni nj l nk nl">export class <strong class="nd iu">Languages </strong>{<br/>  readonly <strong class="nd iu">current</strong>: string;<br/>  readonly <strong class="nd iu">other</strong>: string[];</span><span id="98a1" class="ky kz it nd b gy nn nj l nk nl">  private <strong class="nd iu"><em class="nm">constructor</em></strong>(currentLanguage: string,<br/>                      supportedLanguages: string[]) {<br/>    this.current = currentLanguage;<br/>    this.other = supportedLanguages.filter(supportedLanguage =&gt; supportedLanguage !== currentLanguage);<br/>  }</span><span id="7f13" class="ky kz it nd b gy nn nj l nk nl">  static <strong class="nd iu"><em class="nm">from</em></strong>(currentLanguage: string, supportedLanguages: string[]): Languages {<br/>    return new Languages(currentLanguage, supportedLanguages);<br/>  }<br/>}</span></pre><p id="0d6d" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">接下来你需要的是提供你的翻译服务。它根据请求接收任何语言的静态翻译。这意味着语言是“延迟加载”的——您不需要在页面加载时请求每一种语言，而是只请求初始语言和语言变化时的语言。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="7f45" class="ky kz it nd b gy ni nj l nk nl">@Injectable({<br/>  providedIn: 'root'<br/>})<br/>export class <strong class="nd iu">TranslationService </strong>{<br/>  <strong class="nd iu">constructor</strong>(private httpClient: HttpClient) {}</span><span id="8800" class="ky kz it nd b gy nn nj l nk nl">  <strong class="nd iu"><em class="nm">getTranslation</em></strong>(language: string): Observable&lt;TranslationKeyValues&gt;     {<br/>  return from(this.getLanguageTranslationsRequest(language));<br/>  }</span><span id="ac75" class="ky kz it nd b gy nn nj l nk nl">  private <strong class="nd iu"><em class="nm">getLanguageTranslationsRequest</em></strong>(language: string): Promise&lt;TranslationKeyValues&gt; {<br/>    return this.httpClient.get&lt;TranslationKeyValues&gt;(`assets/translation/${language}.json`).toPromise();<br/>  }<br/>}</span></pre><p id="b3a4" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">您可能想知道，它是如何获得特定的返回类型的？我定义了类型<code class="fe na nb nc nd b">TranslationKeyValues</code>，它只是键值的映射。这种数据类型只是语言文件翻译的表示。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="2149" class="ky kz it nd b gy ni nj l nk nl">export interface <strong class="nd iu">TranslationKeyValues </strong>{<br/>  [key: string]: string;<br/>}</span></pre><p id="3f11" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">现在您只需要用我们的值填充翻译模块。这可以通过实现我们自己的<code class="fe na nb nc nd b">CustomTranslateLoader</code>来轻松完成，T3实现了<code class="fe na nb nc nd b">TranslateLoader</code>接口。每当这个类需要新的翻译时，它就会调用我们的翻译服务。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="cc24" class="ky kz it nd b gy ni nj l nk nl">export class <strong class="nd iu">CustomTranslateLoader </strong>implements <strong class="nd iu">TranslateLoader </strong>{<br/>  private constructor(private <strong class="nd iu">translationService</strong>: TranslationService) {<br/>  }</span><span id="2ded" class="ky kz it nd b gy nn nj l nk nl">  static <strong class="nd iu"><em class="nm">of</em></strong>(translationService: TranslationService) {<br/>    return new CustomTranslateLoader(translationService);<br/>  }</span><span id="37dd" class="ky kz it nd b gy nn nj l nk nl">  <strong class="nd iu"><em class="nm">getTranslation</em></strong>(language: string): Observable&lt;TranslationKeyValues&gt; {<br/>    return this.translationService.getTranslation(language);<br/>  }<br/>}</span></pre><p id="6892" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">我已经将translate loader包装在导出的函数(工厂方法)中，但是您不必这样做。但是，在使用工厂的导出函数进行提前编译时，它是必需的。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="9d2c" class="ky kz it nd b gy ni nj l nk nl">export function <strong class="nd iu"><em class="nm">CustomTranslateLoaderFactory</em></strong>(translationService: TranslationService) {<br/>  return CustomTranslateLoader.of(translationService);<br/>}</span></pre><p id="3818" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">您现在可以在我们的<code class="fe na nb nc nd b">TranslationModule</code> <strong class="lw iu"> </strong>中提供一个自定义的<code class="fe na nb nc nd b">TranslateLoader</code> <strong class="lw iu"> </strong>使用工厂，其中有您之前定义的<code class="fe na nb nc nd b">TranslationService</code> <strong class="lw iu"> </strong>作为依赖项。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="5b9f" class="ky kz it nd b gy ni nj l nk nl">@NgModule({<br/>  imports: [<br/>    <strong class="nd iu">TranslateModule</strong>.forRoot({<br/>      loader: {<br/>        provide: <strong class="nd iu">TranslateLoader</strong>,<br/>        useFactory: <strong class="nd iu">CustomTranslateLoaderFactory</strong>,<br/>        deps: [<br/>          <strong class="nd iu">TranslationService</strong><br/>        ]<br/>      }<br/>    })<br/>  ],<br/>  providers: [<br/>    CookieService<br/>  ],<br/>  exports: [<br/>    <strong class="nd iu">TranslateModule</strong><br/>  ]<br/>})<br/>export class <strong class="nd iu">TranslationModule </strong>{</span><span id="ca17" class="ky kz it nd b gy nn nj l nk nl">}</span></pre><p id="56d5" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">为了改变你的语言，我做了一个简单的服务，允许切换。如果你喜欢，可以随意使用或更改它。现在一切就绪！您已经成功地在Angular中设置了您的翻译。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="c334" class="ky kz it nd b gy ni nj l nk nl">/* <br/>Just call this.languageService.updateCurrentLanguage(language); to switch language <br/>*/</span><span id="62ec" class="ky kz it nd b gy nn nj l nk nl">@Injectable({<br/>  providedIn: 'root'<br/>})<br/>export class LanguageService {<br/>  private readonly <strong class="nd iu">LANGUAGE_COOKIE </strong>= 'website.locale';<br/>  private <strong class="nd iu">languagesSubject</strong>: BehaviorSubject&lt;Languages&gt;;</span><span id="f219" class="ky kz it nd b gy nn nj l nk nl">  <strong class="nd iu"><em class="nm">constructor</em></strong>(private <strong class="nd iu">translateService</strong>: TranslateService, private <strong class="nd iu">cookieService</strong>: CookieService) {<br/>    const currentLanguage = cookieService.get(this.LANGUAGE_COOKIE) || this.translateService.getDefaultLanguage();<br/>    this.languagesSubject = new BehaviorSubject&lt;Languages&gt;(this.getLanguages(currentLanguage));<br/>    this.translateService.use(currentLanguage);<br/>  }</span><span id="fea8" class="ky kz it nd b gy nn nj l nk nl">  <strong class="nd iu"><em class="nm">getCurrentAndOtherLanguages$</em></strong>(): Observable&lt;Languages&gt; {<br/>    return this.languagesSubject.asObservable();<br/>  }</span><span id="55ed" class="ky kz it nd b gy nn nj l nk nl">  <strong class="nd iu"><em class="nm">updateCurrentLanguage</em></strong>(currentLanguage: string): void {<br/>    this.cookieService.set(this.LANGUAGE_COOKIE, currentLanguage);<br/>    this.translateService.use(currentLanguage);<br/>    this.languagesSubject.next(this.getLanguages(currentLanguage));<br/>  }</span><span id="de8b" class="ky kz it nd b gy nn nj l nk nl">  private <strong class="nd iu"><em class="nm">getLanguages</em></strong>(currentLanguage: string): Languages {<br/>    return Languages.from(currentLanguage, this.translateService.getSupportedLanguages());<br/>  }<br/>}</span></pre><p id="18b2" class="pw-post-body-paragraph lu lv it lw b lx mn ju lz ma mo jx mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">现在你可以在任何地方使用翻译服务，就像这样简单。您甚至可以在翻译中提供参数。当你改变语言时，最方便的部分开始了——翻译自动改变。关于如何使用翻译的更多信息，我推荐访问<strong class="lw iu"> ngx-translate </strong>的GitHub页面<a class="ae ms" href="https://github.com/ngx-translate/core" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="ad1e" class="ky kz it nd b gy ni nj l nk nl">&lt;div class="home"&gt;<br/>  &lt;p class="website"&gt;...&lt;/p&gt;<br/>  &lt;h1 class="a"&gt;{{'a.message' | <strong class="nd iu">translate</strong>}}&lt;/h1&gt;<br/>  &lt;p class="b"&gt;{{'b.message' | <strong class="nd iu">translate</strong>}}&lt;/p&gt;<br/>  &lt;p class="c"&gt;{{'c.message' | <strong class="nd iu">translate:param</strong>}}&lt;/p&gt;<br/>&lt;/div&gt;</span></pre></div></div>    
</body>
</html>