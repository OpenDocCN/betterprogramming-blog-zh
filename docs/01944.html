<html>
<head>
<title>Random vs. Deterministic Test Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机与确定性测试数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/random-vs-deterministic-test-data-607ec2a91b76?source=collection_archive---------13-----------------------#2019-10-24">https://betterprogramming.pub/random-vs-deterministic-test-data-607ec2a91b76?source=collection_archive---------13-----------------------#2019-10-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7540" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你应该在什么时候使用哪一种？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2458e500c6e754971814e5a923eff640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9fXJ0PTfQdFhi9Yg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迪伦·诺尔特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="4c55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，我和一位同事讨论了将你的测试数据随机化的好处，他指出，这样做，测试不再是确定性的，也就是说，它们有时可能会失败。</p><p id="67e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我来讲一个简单的例子。看一下下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="71fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果可以的话，应该为每个提供的文档调用一次<code class="fe lx ly lz ma b">saveAll</code>，<code class="fe lx ly lz ma b">fileService.save</code>。</p><p id="b17c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为“文档”的长度是随机的，所以测试是不确定的。</p><p id="c7e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当数组中正好有三个文档时，如果我的逻辑中的一个错误导致了一个错误，该怎么办？这意味着有时测试会失败，有时会通过。我的同事指出了这一点，他是绝对正确的。</p><p id="a4d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该为每种情况写一个测试吗？</p><p id="5ad9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设服务可以拥有最大数量的文档(假设20个)，这仍然意味着您需要20个测试来覆盖每个案例。</p><p id="ef9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最大100怎么办？你应该做100次测试吗？或者，你写一个1人的测试和一个100人的测试，假设中间的一切都可以工作？</p><p id="d424" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果正好有50个文档时失败了怎么办？如果我用随机数据运行测试，我没有测试每个组合，所以错误可能会漏网。</p><p id="63d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的同事认为复制测试很便宜，我甚至可以写一个循环来运行测试<em class="mb"> n </em>次，以确保我覆盖了所有可能发生的情况。对于这位同事，如果我把论点过于简单化了，我很抱歉。</p><p id="0e90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，这真的是最好的答案吗？我应该停在哪里？我还应该对文档本身进行随机化吗？</p><p id="628f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果是这样，我仍然在我的测试中引入了一个不确定的元素，每当文档标题包含一个6，或者文档大小是一个质数时，这都会导致失败…</p><p id="4158" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，我是轻率的。这样的错误永远不会真的出现。对吗？好吧，祝你好运为这样的bug编写一堆测试用例。</p><p id="8cd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是测试的目的是测试“足够”给你对代码的信心。</p><p id="9a69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果1000个确定性的几乎相同的测试为你做到了这一点而没有让你发疯，那么就去做吧。然而，我将继续在有意义的地方随机化我的测试数据，然后调用边缘案例。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="abcb" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">哪里不使用随机数据？</h1><p id="ce93" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">简而言之，如果随机测试数据要求我在测试中重复已经在我的实现中的逻辑，我会避免随机测试数据。</p><p id="e566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果我想通过随机化两个数字并将它们传递给<code class="fe lx ly lz ma b">add</code>方法来测试一个计算器类，我不会随机化这些数字。</p><p id="03f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么？因为要断言结果是正确的，我必须将它们相加，这正是<code class="fe lx ly lz ma b">add</code>方法所做的。</p><p id="f2a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，相反，我会自己确定答案，然后断言(1 +1) = 2，而不是断言“数字1+数字2 =数字1+数字2”。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="ce05" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="5248" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">编写足够多的测试来给你对代码的信心。明智一点——你不需要测试每一种组合。</p><p id="df44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你真的担心某个边缘情况会破坏东西，那么为那个情况写一个测试。如果您认为有一大堆这样的边缘情况，那么为所有这些情况编写一个测试。</p><p id="bb55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你认为有无限多的边缘情况，那么你的代码就有严重的问题。</p></div></div>    
</body>
</html>