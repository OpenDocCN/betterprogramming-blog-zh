<html>
<head>
<title>Passing Data to props.children in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将数据传递给props.children in React</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/passing-data-to-props-children-in-react-5399baea0356?source=collection_archive---------5-----------------------#2018-06-13">https://betterprogramming.pub/passing-data-to-props-children-in-react-5399baea0356?source=collection_archive---------5-----------------------#2018-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e8e5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本周，我在React中遇到了一个障碍</h2></div><h1 id="047d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">问题是</h1><p id="9f86" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">本周，我在React中遇到了一个障碍，我需要将数据从父组件传递到子组件。执行此操作的传统方式如下:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="97a9" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">上面假设了一些明确定义的<code class="fe mi mj mk ml b">ChildComponent,</code>，其中数据、状态和功能作为属性传递给组件。</p><p id="9708" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">然而，在现实世界中，将数据传递给孩子有时并不简单。考虑这个例子，其中使用<code class="fe mi mj mk ml b">this.props.children</code>定义和呈现子组件:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="d656" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">如何将数据和状态传递给每个子组件？</p><h1 id="a78c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">对救援做出反应</h1><p id="a091" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了解决上述问题，<a class="ae mm" href="https://reactjs.org/docs/react-api.html#cloneelement" rel="noopener ugc nofollow" target="_blank"> React.cloneElement顶层API </a>很方便。根据React文档，该函数被定义为:</p><pre class="lw lx ly lz gt mn ml mo mp aw mq bi"><span id="e5c0" class="mr kj it ml b gy ms mt l mu mv">React.cloneElement(<br/>  element,<br/>  [props],<br/>  [...children]<br/>)</span></pre><p id="688c" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">该函数将一个react组件作为第一个参数，在我们的例子中，它将是<code class="fe mi mj mk ml b">child</code>组件。第二个参数是一个对象，它包含我们想要绑定到孩子的任何附加道具，例如<code class="fe mi mj mk ml b">someData</code>、<code class="fe mi mj mk ml b">someState</code>和<code class="fe mi mj mk ml b">someFunction</code>，最后返回一个新元素。这几乎相当于:</p><pre class="lw lx ly lz gt mn ml mo mp aw mq bi"><span id="35c8" class="mr kj it ml b gy ms mt l mu mv">&lt;element.type {...element.props} {...props}&gt;<br/>    {children}<br/>&lt;/element.type&gt;</span></pre><p id="1f87" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">因此，在我们的场景中，<code class="fe mi mj mk ml b">cloneElement</code>函数的实现变成了:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="5b4a" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">我们正在创建一个数组，使用<code class="fe mi mj mk ml b">React.Children.map</code>和<code class="fe mi mj mk ml b">this.props.children</code>作为第一个参数。第二个参数是一个函数，提供对每个孩子的访问，这个函数是使用<code class="fe mi mj mk ml b">React.cloneElement</code>克隆的。在克隆过程中，包含<code class="fe mi mj mk ml b">someData</code>、<code class="fe mi mj mk ml b">someState</code>和<code class="fe mi mj mk ml b">someFunction</code>的附加道具作为对象传递给每个孩子。</p><h1 id="628c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">用例及示例代码</h1><p id="fc1b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您可能想知道为什么会出现这种情况。考虑尝试构建一个可重用的“手风琴”,如下所示:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="7dbf" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">“accordion”中的每个孩子都需要访问<code class="fe mi mj mk ml b">isActive</code>父状态，以了解哪个孩子当前是活动的。此外，单击子组件中的元素应该会触发父组件中的<code class="fe mi mj mk ml b">isActive </code>状态的变化。进行这种状态转换的函数也需要传递给孩子，即<code class="fe mi mj mk ml b">someFunction</code>。</p><h1 id="50a3" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">编辑:2019年11月30日</h1><p id="0493" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">正如评论中提到的，React自撰写这篇博客以来已经有所改进，因此可能有更好的方法将数据传递到组件层次结构中。有人在评论中建议<a class="ae mm" href="https://reactjs.org/docs/render-props.html" rel="noopener ugc nofollow" target="_blank"> renderProps </a>和使用<a class="ae mm" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React context </a>是更好的选择。</p><p id="4d39" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">我仍然认为这个解决方案足够好，如果你正在寻找快速的东西，但它可能不是最好的方法。</p><h1 id="becf" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="5aef" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">React是一个强大的库，使开发变得有趣和快速。它附带了许多API，这些API可能很难理解，但是希望您现在知道了一种改进开发的方法。</p><p id="857f" class="pw-post-body-paragraph la lb it lc b ld md ju lf lg me jx li lj mf ll lm ln mg lp lq lr mh lt lu lv im bi translated">如果你喜欢这个帖子，别忘了点赞推荐。</p><h1 id="dca4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">信用</h1><p id="35ec" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">丹尼尔·尤斯奇克— <a class="ae mm" href="https://codepen.io/Yuschick/post/react-passing-state-to-props-children-in-jsx" rel="noopener ugc nofollow" target="_blank">反应—把状态传给JSX的{道具.儿童}</a></p></div></div>    
</body>
</html>