<html>
<head>
<title>Start Writing Python Docstrings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始编写Python文档字符串</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-guide-to-python-docstrings-3d40340e824b?source=collection_archive---------5-----------------------#2020-01-23">https://betterprogramming.pub/the-guide-to-python-docstrings-3d40340e824b?source=collection_archive---------5-----------------------#2020-01-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2e75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">简化你的生活和任何试图阅读你的代码的人的生活</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/d28268cbf19e1acc61c6a1468d9c0f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*YbGv_XAHfEowvUitp7xFog.png"/></div></figure><p id="cdf1" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">每个人都写了很好的代码，但是需要在两个星期后进行复查，没有人知道为什么或者如何工作。我们每天都要处理糟糕的文档化代码。但事情不一定非要这样。</p><p id="6f52" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我再怎么强调编写可读代码的重要性也不为过，它等同于编写好的<em class="lm">文档字符串</em>。现在，在Python中，没有一种编写文档字符串的“完美”方式，因为没有一个单一的约定可以遵循。</p><p id="386a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了让您的生活更轻松，我将这个故事中历史最悠久的docstring约定合并在一起，并选择了<a class="ae ln" href="https://www.sphinx-doc.org/en/master/" rel="noopener ugc nofollow" target="_blank"> Sphinx </a>样式来详细阐述。Sphinx style是官方的Python文档标准，我更喜欢它的易用性。</p><p id="4167" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">无论如何，这个故事将给出docstrings的约定和实现的一般概念，这是向Python代码添加适当文档的良好开端。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="ab16" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是Docstring？</h1><p id="8950" class="pw-post-body-paragraph kq kr it ks b kt mn ju kv kw mo jx ky kz mp lb lc ld mq lf lg lh mr lj lk ll im bi translated">docstring是单行或多行字符串文字，由模块、类、方法或函数开头的三个单引号或双引号<code class="fe ms mt mu mv b">"""&lt;description&gt;"""</code>分隔，描述<em class="lm">该函数做什么</em>。</p><p id="2944" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当且仅当它是函数中的第一条语句时，它才能被Python字节码编译器识别，并通过<code class="fe ms mt mu mv b">__doc__</code>方法或<code class="fe ms mt mu mv b">help()</code>函数作为运行时对象属性被访问。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="d8e7" class="my lw it bd lx mz na dn mb nb nc dp mf kz nd ne mh ld nf ng mj lh nh ni ml nj bi translated">最佳实践</h2><ol class=""><li id="0f91" class="nk nl it ks b kt mn kw mo kz nm ld nn lh no ll np nq nr ns bi translated">所有的模块、类、方法和函数，包括包中的<code class="fe ms mt mu mv b">__init__</code>构造函数都应该有docstrings。</li><li id="fe93" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll np nq nr ns bi translated">描述是大写的，有句尾标点。</li><li id="9915" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll np nq nr ns bi translated">总是在文档字符串周围使用<code class="fe ms mt mu mv b">"""Triple double quotes."""</code>。</li><li id="7ad7" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll np nq nr ns bi translated">文档字符串是<em class="lm">而不是</em>后跟一个空行。</li></ol></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="cb95" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">单行文档字符串</h1><ol class=""><li id="ed08" class="nk nl it ks b kt mn kw mo kz nm ld nn lh no ll np nq nr ns bi translated">单行docstring将函数或方法的效果规定为<em class="lm">命令</em> <code class="fe ms mt mu mv b">"""Do this, return that"""</code>，而不是描述。</li><li id="5ab0" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll np nq nr ns bi translated">如果<em class="lm">不是</em>是一个“签名”<code class="fe ms mt mu mv b">function(a, b) -&gt; list </code>，重复函数/方法参数。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="a239" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">多行文档字符串</h1><p id="050f" class="pw-post-body-paragraph kq kr it ks b kt mn ju kv kw mo jx ky kz mp lb lc ld mq lf lg lh mr lj lk ll im bi translated">多行docstring也包含与单行docstring中相同的字符串文字行，但它后面是一个空行，以及函数参数和返回值的描述。</p><p id="0920" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">多行docstrings有多种约定，比如<a class="ae ln" href="https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html" rel="noopener ugc nofollow" target="_blank"> Google Format </a>和<a class="ae ln" href="https://numpydoc.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> NumPy Format </a>，但是最简单最传统的是<a class="ae ln" href="https://www.sphinx-doc.org/en/master/" rel="noopener ugc nofollow" target="_blank"> Sphinx style </a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="02da" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">斯芬克斯风格</h1><p id="28ce" class="pw-post-body-paragraph kq kr it ks b kt mn ju kv kw mo jx ky kz mp lb lc ld mq lf lg lh mr lj lk ll im bi translated">Sphinx style是官方的Python文档标准。这也是JetBrains的PyCharm (非常流行的IDE)默认使用的<a class="ae ln" href="https://www.jetbrains.com/pycharm/help/creating-documentation-comments.html" rel="noopener ugc nofollow" target="_blank">，在定义函数后输入三个引号，然后按enter键。</a></p><p id="94f9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Sphinx style使用一种轻量级标记语言的语法<a class="ae ln" href="https://docutils.sourceforge.io/rst.html" rel="noopener ugc nofollow" target="_blank"> reStructuredText (reST) </a>，旨在:</p><ol class=""><li id="0275" class="nk nl it ks b kt ku kw kx kz ny ld nz lh oa ll np nq nr ns bi translated">可由文档处理软件处理，如<a class="ae ln" href="https://docutils.sourceforge.io/" rel="noopener ugc nofollow" target="_blank"> Docutils </a>。</li><li id="3396" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll np nq nr ns bi translated">阅读和编写Python源代码的人类程序员容易读懂。如果你想深入了解这一点，可以看看这篇文章。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h2 id="6138" class="my lw it bd lx mz na dn mb nb nc dp mf kz nd ne mh ld nf ng mj lh nh ni ml nj bi translated">Sphinx语法</h2><p id="d4ee" class="pw-post-body-paragraph kq kr it ks b kt mn ju kv kw mo jx ky kz mp lb lc ld mq lf lg lh mr lj lk ll im bi translated">Sphinx使用大多数编程语言都使用的<code class="fe ms mt mu mv b">keyword(reserved word)</code>语法。最重要的关键字是:</p><ul class=""><li id="5df8" class="nk nl it ks b kt ku kw kx kz ny ld nz lh oa ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">param</code>和<code class="fe ms mt mu mv b">type</code>:参数值和变量类型。</li><li id="f6d6" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">return</code>和<code class="fe ms mt mu mv b">rtype</code>:返回值及其类型。</li><li id="09a6" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">:raises</code>:描述代码引发的任何错误。</li><li id="e962" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">.. seealso::</code>:延伸阅读。</li><li id="5226" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">.. notes::</code>:添加备注。</li><li id="3e51" class="nk nl it ks b kt nt kw nu kz nv ld nw lh nx ll ob nq nr ns bi translated"><code class="fe ms mt mu mv b">.. warning::</code>:添加警告。</li></ul><p id="73c2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">虽然这些关键字的顺序是不固定的，但是在整个项目中保持上述顺序是一个惯例。<code class="fe ms mt mu mv b">seealso</code>、<code class="fe ms mt mu mv b">notes</code>和<code class="fe ms mt mu mv b">warning</code>的条目是可选的。</p><p id="2453" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在本文中找到编写Sphinx docstrings <a class="ae ln" href="https://sphinx-rtd-tutorial.readthedocs.io/en/latest/docstrings.html" rel="noopener ugc nofollow" target="_blank">的更详细教程。例如，您可以用<code class="fe ms mt mu mv b">|</code>符号连接参数类型，如下所示:</a></p><pre class="kj kk kl km gt oc mv od oe aw of bi"><span id="4712" class="my lw it mv b gy og oh l oi oj">:param x: An integer, defaults to None<br/>:type x: int</span><span id="ba1c" class="my lw it mv b gy ok oh l oi oj">:param y: An integer or string<br/>:type y: int|string</span></pre><h2 id="7632" class="my lw it bd lx mz na dn mb nb nc dp mf kz nd ne mh ld nf ng mj lh nh ni ml nj bi translated">斯芬克斯布局</h2><p id="238c" class="pw-post-body-paragraph kq kr it ks b kt mn ju kv kw mo jx ky kz mp lb lc ld mq lf lg lh mr lj lk ll im bi translated">这个docstring的一般布局如下所示。</p><pre class="kj kk kl km gt oc mv od oe aw of bi"><span id="39d9" class="my lw it mv b gy og oh l oi oj"><em class="lm">"""&lt; Summary. &gt;</em></span><span id="5d6c" class="my lw it mv b gy ok oh l oi oj"><em class="lm">:param &lt;variable_name&gt;: &lt;variable_description&gt;, defaults to &lt;default_value&gt;</em><br/><em class="lm">:type &lt;variable_name&gt;: &lt;variable_type&gt;(, optional)<br/></em>&lt;other parameters and types&gt;</span><span id="f9c4" class="my lw it mv b gy ok oh l oi oj"><em class="lm">:raises &lt;error_type&gt;: &lt;error_description&gt;</em><br/>&lt;other exceptions&gt;</span><span id="e894" class="my lw it mv b gy ok oh l oi oj"><em class="lm">:rtype: &lt;return_type&gt;<br/>:return: &lt;return_description&gt;</em><br/><em class="lm">"""</em></span></pre><p id="bb4c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">差不多就是这样。</p><p id="1c04" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这些约定非常容易实现，对于内置函数、ide和代码段来说是机器可读的，并且是为人类程序员提供优秀文档和可读函数的唯一方法。即使几个月后？</p></div></div>    
</body>
</html>