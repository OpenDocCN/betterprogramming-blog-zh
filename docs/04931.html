<html>
<head>
<title>Build a Photo Booth App in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript构建一个照片亭应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/photo-booth-app-with-javascript-847d20c97ebd?source=collection_archive---------1-----------------------#2020-05-24">https://betterprogramming.pub/photo-booth-app-with-javascript-847d20c97ebd?source=collection_archive---------1-----------------------#2020-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec76" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们构建一个应用程序，使用你的计算机的摄像头来录制视频，添加背景，并让用户拍照</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f3910bca79f8f8d58a551fdf76db0e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8chj38d067wlrm-r0MISw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@annecy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Thibault Copleux </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="78a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我正在开发一个应用程序，它将访问设备的摄像头，记录视频流，添加背景，并允许用户截图和下载。背景操作仍在进行中，但截至目前，我已经能够实现视频流，截图和下载功能。</p><p id="3ab2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我给你<em class="lv">截图</em>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/5e1e4fe1b37810f366015e48de8c386d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*q7l_Af8Lzo8mYKZnTOS6NQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">震惊我的模特生涯还没开始。</p></figure><p id="0806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">左边是通过访问设备摄像头生成的视频流。右边是拍摄的截图。在初始化视频流之前，屏幕截图按钮是禁用的。一旦捕获到视频流，就可以截图了。一旦截图，就可以选择文件格式并下载。“清除”按钮会重新初始化所有内容，删除屏幕截图并结束当前视频流。</p><p id="f484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入研究一下，从HTML开始。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="f1da" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">超文本标记语言</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="e737" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序中有几个按钮。第一个是<code class="fe my mz na nb b">capture</code>，它负责提示用户访问他们的网络摄像头，然后初始化视频流。<code class="fe my mz na nb b">screenshot</code>执行获取视频截图的功能,(使用<code class="fe my mz na nb b">canvas</code>)将绘制截图并将其作为数据URL添加到<code class="fe my mz na nb b">img</code>标签的<code class="fe my mz na nb b">src</code>。</p><p id="97a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b">download</code>将捕获图像数据，创建锚标记，将<code class="fe my mz na nb b">img.src</code>分配给锚的<code class="fe my mz na nb b">href</code>，命名文件和扩展名，然后模拟触发下载的<code class="fe my mz na nb b">click</code>事件。<code class="fe my mz na nb b">clear</code>按钮触发重置UI并结束视频流的功能。</p><p id="a6e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将我们带到应用程序的下一部分:我们如何实际开始视频流？介绍<code class="fe my mz na nb b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream" rel="noopener ugc nofollow" target="_blank">MediaStream</a></code>界面。</p><p id="f372" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b">MediaStream</code>界面代表媒体内容流，由分解成<strong class="lb iu">轨道</strong>的数据组成。这些轨道是代表流中的单个媒体轨道的<code class="fe my mz na nb b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack" rel="noopener ugc nofollow" target="_blank">MediaStreamTrack</a></code>的实例。在我们的案例中，我们将使用视频轨道。下面是其中一个轨迹的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/148e73d9117c43bc3f11c1d974892b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*3ss6vqz-dhDYaP6PSMOMsQ.png"/></div></figure><p id="5672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些轨道是我们将访问视频流中的数据的地方。我们可以通过使用<code class="fe my mz na nb b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" rel="noopener ugc nofollow" target="_blank">navigator.mediaDevices.getUserMedia()</a></code>来获取这些数据。下面是一个例子。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="10e5" class="nh mf it nb b gy ni nj l nk nl">navigator.mediaDevices.getUserMedia({video: true})<br/>  .then(stream =&gt; {console.log('we got the stream!')})<br/>  .catch(err=&gt;alert('Error occurred: ' + err));</span></pre><p id="211c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能提示用户授权访问设备的摄像头。授权后，<code class="fe my mz na nb b">getUserMedia</code>创建的<code class="fe my mz na nb b">Promise</code>要么被解析(返回曲目)，要么被拒绝，由<code class="fe my mz na nb b">catch</code>处理。你可以在这里阅读更多关于为什么<code class="fe my mz na nb b">getUserMedia</code>可能会出错<a class="ae ky" href="https://blog.addpipe.com/common-getusermedia-errors/" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="ba07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们进入工作流程之前，这里是我们将在整个应用程序中初始化使用的变量。</p><p id="8a44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">img</strong></code>是我们的<code class="fe my mz na nb b">img</code>标签，当用户点击<code class="fe my mz na nb b">screenshot</code>按钮时，谁是将被分配视频帧的<code class="fe my mz na nb b">src</code>。</p><p id="40da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">video</strong></code>是我们的<code class="fe my mz na nb b">video</code>标签，它将包含我们的视频流。</p><p id="c69d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">prompt1</strong></code>和<code class="fe my mz na nb b"><strong class="lb iu">prompt2</strong></code>是提示，告诉用户下一步是什么。如果用户还没有开始视频捕捉，<code class="fe my mz na nb b">prompt1</code>会明显地告诉他们这样做。如果他们已经开始抓图，<code class="fe my mz na nb b">prompt2</code>会提示他们抓图。</p><p id="da50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">screenshot</strong></code> <strong class="lb iu"> </strong>是对视频流进行截图的按钮。</p><p id="a1c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">download</strong></code>是触发图像下载的按钮。</p><p id="2c89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">select</strong></code>是我们的<code class="fe my mz na nb b">select</code>标签，包含我们的文件格式选项。这个和代表<code class="fe my mz na nb b">select</code>标签的<code class="fe my mz na nb b"><strong class="lb iu">label</strong></code>将被隐藏，直到用户截屏。</p><p id="3c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">clear</strong></code> <strong class="lb iu"> </strong>是重置UI和停止流的按钮。</p><p id="c569" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">enable</strong></code>将决定应用程序是否可在设备上使用。</p><p id="6731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na nb b"><strong class="lb iu">canvas</strong></code>是我们将要创建并用来将视频流数据写入图像的<code class="fe my mz na nb b">canvas</code>元素。</p><p id="d555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<code class="fe my mz na nb b"><strong class="lb iu">format</strong></code>是用户为图像下载选择的文件格式。</p><p id="47e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过首先检查用户是否拥有带有函数<code class="fe my mz na nb b">hasGetUserMedia</code>的<code class="fe my mz na nb b">getUserMedia</code>来初始化我们的应用程序。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="cd29" class="nh mf it nb b gy ni nj l nk nl">const hasGetUserMedia = () =&gt; {<br/>  if (!navigator.mediaDevices &amp;&amp;<br/>!navigator.mediaDevices.getUserMedia){<br/>    alert('Unable to enable camera.')<br/>  } else {<br/>    enable = true<br/>  }<br/>}</span></pre><p id="e0c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能将检查用户的设备是否有<code class="fe my mz na nb b">mediaDevices</code>和<code class="fe my mz na nb b">getUserMedia</code>。如果是，我们将<code class="fe my mz na nb b">enable</code>设置为真。为真时，可以使用应用程序的其余功能，我们可以开始获取我们的DOM元素(将存储在上面提到的它们各自的变量中)，然后向它们添加我们的事件侦听器。第一个事件监听器是一个名为<code class="fe my mz na nb b">onCapture.</code>的<code class="fe my mz na nb b">onclick</code>函数</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="e7c9" class="nh mf it nb b gy ni nj l nk nl">const onCapture = () =&gt; {<br/>  navigator.mediaDevices.getUserMedia({video: true})<br/>  .then(stream =&gt; {<br/>    video.srcObject = stream<br/>    prompt1.style.display = 'none';<br/>    prompt2.style.display = 'block';<br/>    screenshot.disabled = false;<br/>    clear.disabled = false;<br/>  })<br/>  .catch(err=&gt;alert('Error occurred: ' + err));<br/>}</span></pre><p id="9105" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击<code class="fe my mz na nb b">capture</code>按钮，用户可以启动媒体流。这将执行<code class="fe my mz na nb b">getUserMedia</code>功能，允许我们捕获用户的视频流。我们将视频流分配给<code class="fe my mz na nb b">video</code>的<code class="fe my mz na nb b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/srcObject" rel="noopener ugc nofollow" target="_blank">srcObject</a></code>属性。<code class="fe my mz na nb b">srcObject</code>对<code class="fe my mz na nb b">video</code>的操作与<code class="fe my mz na nb b">src</code>相似，除了它允许<code class="fe my mz na nb b">video</code>元素使用<code class="fe my mz na nb b">MediaStream</code>作为其来源，而不是静态视频文件。</p><p id="8b19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们应该在应用程序的左侧看到网络摄像头的实时视频。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/234a2eca03d85433ac5c335d21e3ae49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6ZtVnV8WFPAPUHKhMrAyw.png"/></div></div></figure><p id="1edd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了视频流，我们可以继续下一个功能，<code class="fe my mz na nb b">onScreenshot</code>。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="e354" class="nh mf it nb b gy ni nj l nk nl">const onScreenshot = () =&gt; {<br/>  canvas.width = video.videoWidth;<br/>  canvas.height = video.videoHeight;<br/>  canvas.getContext('2d').drawImage(video, 0, 0);<br/>  prompt2.style.display = 'none'<br/>  img.src = canvas.toDataURL('image/png');<br/>  img.style.display = 'block'<br/>  download.disabled = false<br/>  select.style.visibility = 'visible'<br/>  label.style.visibility = 'visible'<br/>}</span></pre><p id="d4a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还不熟悉的话，可以用一个<code class="fe my mz na nb b">canvas</code>元素在网页上绘制图形。在我们的例子中，我们将绘制一幅图像。这是通过利用<code class="fe my mz na nb b">drawImage</code>来完成的。我们可以通过访问<code class="fe my mz na nb b">canvas</code>的二维绘图上下文来访问该功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e031a399f103f8dfe9d5a788b56a2586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*CxZkEEpM-eKd0aSZlMbeVw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这个gif我以前用过。我不感到羞耻。</p></figure><p id="1ec5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们通过<code class="fe my mz na nb b">drawImage</code>三个论证。首先是我们的<code class="fe my mz na nb b">video</code>元素。<code class="fe my mz na nb b">drawImage</code>将从该实例的视频中捕获帧，并将其绘制到<code class="fe my mz na nb b">canvas</code>元素上。接下来的两个参数是画布上的<code class="fe my mz na nb b">x</code>和<code class="fe my mz na nb b">y</code>坐标，我们将在那里放置我们的绘图。</p><p id="42fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们对两者都使用<code class="fe my mz na nb b">0</code>，因为我们希望图像占据整个画布。这样，它就尽可能接近视频的比例，因为我们将画布'<code class="fe my mz na nb b">height</code>和<code class="fe my mz na nb b">width</code>设置为等于<code class="fe my mz na nb b">video</code>。然后我们使用另一个名为<code class="fe my mz na nb b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL" rel="noopener ugc nofollow" target="_blank">toDataURL</a></code>的<code class="fe my mz na nb b">canvas</code>函数，它将返回一个数据URL，允许我们内嵌一个图像文件。该函数的其余部分有条件地显示或隐藏DOM上的其他元素，以移动UX。</p><p id="9068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们现在有了一个正在运行的视频流和一个绘制在我们的<code class="fe my mz na nb b">canvas</code>上的截图。下一部分将允许用户下载生成的图像。这里有一个如何做到这一点的完美例子<a class="ae ky" href="https://ourcodeworld.com/articles/read/189/how-to-create-a-file-and-generate-a-download-with-javascript-in-the-browser-without-a-server" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="8123" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建锚标记，给该标记的<code class="fe my mz na nb b">href</code>分配我们的<code class="fe my mz na nb b">img</code>的<code class="fe my mz na nb b">src</code>标记的值，然后给它的<code class="fe my mz na nb b">download</code>属性分配名称<code class="fe my mz na nb b">yourScreenshot</code>以及选择的<code class="fe my mz na nb b">format</code>。我们将anchor标签附加到DOM的主体，通过使用<code class="fe my mz na nb b">click()</code>模拟用户点击它，然后在使用后从DOM中移除该元素。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="d856" class="nh mf it nb b gy ni nj l nk nl">const onDownload = () =&gt; {<br/>  var download = document.createElement('a');<br/>  download.href = img.src<br/>  download.download = 'yourScreenshot' + format;<br/>  download.style.display = 'none';<br/>  document.body.appendChild(download);<br/>  download.click();<br/>  document.body.removeChild(download);<br/>};</span></pre><p id="94a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户现在可以初始化视频流，截取视频流的截图，并以他们选择的格式下载截图。这将我们带到应用程序的最后一部分:允许用户结束视频流并重置UI。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="2604" class="nh mf it nb b gy ni nj l nk nl">const clearAll = () =&gt; {<br/>  video.srcObject.getVideoTracks().forEach(track =&gt; track.stop())<br/>  document.getElementsByClassName('container')[0].removeChild(video);<br/>  video = document.createElement("video")<br/>  video.autoplay = true<br/>  document.getElementsByClassName('container')[0].insertBefore(video, prompt1)<br/>  if (img){<br/>    img.style.display = 'none'<br/>  }<br/>  screenshot.disabled = true;<br/>  download.disabled = true;<br/>  select.style.visibility = 'hidden';<br/>  label.style.display = 'none';<br/>  format = null;<br/>  prompt2.style.display = 'none';<br/>  prompt1.style.display = 'block';<br/>  clear.disabled = true;<br/>}</span></pre><p id="c4aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个功能的很多部分要么隐藏，要么根据应用程序的初始UI要求显示不同的元素，但有两个重要的部分。</p><pre class="kj kk kl km gt nd nb ne nf aw ng bi"><span id="a976" class="nh mf it nb b gy ni nj l nk nl">video.srcObject.getVideoTracks().forEach(track =&gt; track.stop())</span></pre><p id="ef2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一行非常重要，因为它结束了用户当前的媒体流。我们通过<code class="fe my mz na nb b">video</code>的<code class="fe my mz na nb b">srcObject</code>属性来访问函数<code class="fe my mz na nb b">getVideoTracks()</code>。这个函数返回一个<code class="fe my mz na nb b">MediaStreamTracks</code>数组，我们可以对其进行迭代，并<code class="fe my mz na nb b">stop</code>其…轨道中的每个轨道。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/b9a2a10d0f15acfb9d94ba16e80f15ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*C2zQmTJ8Pzf6mF5SBDdpew.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不管怎样，米歇尔，你才3岁。</p></figure><p id="8849" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个重要的部分是删除<code class="fe my mz na nb b">video</code>元素，创建一个新的元素，然后将它插入到DOM的原始位置。如果没有这个，视频将不会重置为它现在的初始化状态，它将在视频应该播放的地方呈现一个黑色方块。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/31f193bfd336ad2d3ede2f0990ad9956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nxkIvDD0TiHDz4J9WHqyYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">恶心。</p></figure><p id="ef3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过在应用程序的容器上使用<code class="fe my mz na nb b">removeChild(video)</code>来移除<code class="fe my mz na nb b">video</code>标签。然后我们可以使用<code class="fe my mz na nb b">document.createElement</code>来创建一个新的<code class="fe my mz na nb b">video</code>标签。我们将它的属性<code class="fe my mz na nb b">autoplay</code>指定为true，这样一旦视频流被拾取，视频将实时开始/显示。最后，我们使用<code class="fe my mz na nb b">insertBefore</code>并将新的<code class="fe my mz na nb b">video</code>标签作为第一个参数传递给它，将<code class="fe my mz na nb b">prompt1</code>作为第二个参数传递给它(因为在app容器中，原来的<code class="fe my mz na nb b">video</code>标签刚好在<code class="fe my mz na nb b">prompt1</code>之前)。</p><p id="b47a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">未来的功能包括允许用户添加背景和过滤器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/65c7f5a3df3a28ed8fa52b58fd2f677f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*0Litww4fFGVVe3-_vdL0OQ.gif"/></div></figure><p id="897f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！这款应用的源代码可以在<a class="ae ky" href="https://github.com/macro6461/simple-screenshot" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="4fce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://matt-croak.medium.com/membership" rel="noopener"> <em class="lv">在这里将你的免费中级会员升级为付费会员</em> </a> <em class="lv">每月只需5美元，你就可以拥有数千位作家的无限量无广告故事。这是一个附属链接，你的会员资格的一部分帮助我为我创造的内容获得奖励。谢谢大家！</em></p><h1 id="78ca" class="me mf it bd mg mh np mj mk ml nq mn mo jz nr ka mq kc ns kd ms kf nt kg mu mv bi translated">参考</h1><div class="nu nv gp gr nw nx"><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStream" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">媒体流</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">媒体流接口表示媒体内容的流。一个流由几个轨道组成，如视频或…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">developer.mozilla.org</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">MediaStreamTrack</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">MediaStreamTrack接口表示流中的单个媒体轨道；通常，这些是音频或视频…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">developer.mozilla.org</p></div></div><div class="og l"><div class="om l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">MediaDevices.getUserMedia()</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">媒体设备。getUserMedia()方法提示用户允许使用媒体输入，这将产生一个…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">developer.mozilla.org</p></div></div><div class="og l"><div class="on l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://blog.addpipe.com/common-getusermedia-errors/" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">常见的getUserMedia()错误</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">一旦您让getUserMedia()处理音频和视频约束，您马上就会遇到这样的问题:用户…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">blog.addpipe.com</p></div></div><div class="og l"><div class="oo l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://www.w3schools.com/tags/canvas_drawimage.asp" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">HTML canvas drawImage()方法</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">组织良好，易于理解的网站建设教程，有很多如何使用HTML，CSS，JavaScript的例子…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">www.w3schools.com</p></div></div><div class="og l"><div class="op l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">HTMLCanvasElement.toDataURL()</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">HTMLCanvasElement.toDataURL()方法返回一个数据URI，其中包含格式为…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">developer.mozilla.org</p></div></div><div class="og l"><div class="oq l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://ourcodeworld.com/articles/read/189/how-to-create-a-file-and-generate-a-download-with-javascript-in-the-browser-without-a-server" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">如何在浏览器中用Javascript创建文件和生成下载(没有服务器)</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">了解如何在浏览器中使用javascript生成文件并直接下载，而不使用任何服务器(本地…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">ourcodeworld.com</p></div></div><div class="og l"><div class="or l oi oj ok og ol ks nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://github.com/macro6461/simple-screenshot" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">macro 6461/简单-截图</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">在GitHub上创建一个帐户，为macro 6461/简单截图开发做出贡献。</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="os l oi oj ok og ol ks nx"/></div></div></a></div></div></div>    
</body>
</html>