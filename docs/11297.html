<html>
<head>
<title>4 Practices to Plan a Large-scale Data Migration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">规划大规模数据迁移的4种实践</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-practices-to-plan-a-large-scale-data-migration-8edd6c921aa5?source=collection_archive---------11-----------------------#2022-03-07">https://betterprogramming.pub/4-practices-to-plan-a-large-scale-data-migration-8edd6c921aa5?source=collection_archive---------11-----------------------#2022-03-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2b9b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我从迁移250亿条记录中学到了什么</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/01c678d1663287200b365baf1d656e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFP7LMm9D1nYu-Dz7sPc3Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯·布里格斯在<a class="ae ky" href="https://unsplash.com/s/photos/migration?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="41d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据迁移就是将数据从一个位置移动到另一个位置的过程。</p><p id="ef3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着业务的增长，数据迁移几乎是不可避免的。您可能需要更大的存储来支持数据增长。或者，由于不断发展的需求，您需要更改数据格式。</p><p id="4f3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近用Elasticsearch完成了一次数据迁移。总共有<em class="lv">250亿份文件</em>，整个过程差不多用了<em class="lv"> 14天</em>！</p><p id="c7c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然听起来很简单，但数据迁移并非易事。没有系统停机的平稳迁移有许多注意事项。</p><p id="d89c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将与你分享我在完成一次大规模数据迁移后所获得的知识。无论您的系统架构如何，您都可以遵循这些实践。我们开始吧！🏃</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7906" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">读写标志</h1><p id="a9a9" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在连续的实时系统中执行数据迁移之前，您需要考虑两个问题。</p><p id="6c50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一，您如何确保新位置的数据保持更新？此时，您的API仍在向旧存储写入数据。对已迁移数据的任何更新都将在新存储中丢失。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/6da8be885760bcb51048d6e82c1fe46e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--G-wNehpNdTautWj866jA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迁移第1行</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/a34ff59e224d019204315508e759cf18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySq6J6wIoCMWjUaeNxoDAw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新存储中的第1行未更新</p></figure><p id="4908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二，如何平稳地迁移API以使用新的存储？类似地，如果发生任何不好的事情，您需要将API回滚到旧的存储。新旧存储之间的平稳过渡<strong class="lb iu">是不停机迁移的关键。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/fddb5c18d3a099e717cb0568c297f605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5PfyYObnvJkABkz68YERyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不停机的过渡</p></figure><p id="5444" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解决这些问题，我们将引入一个<strong class="lb iu">读写标志</strong>。标志是在运行时打开或关闭某些功能的开关，不需要任何代码更改。</p><p id="1486" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的标志有4个值，每个值代表API与数据存储交互的一种特定方式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/10cadc4d4f25f78066769db4f7ff6d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Brt85r9k8u7B7xUydwpljA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迁移的四个阶段</p></figure><p id="7fe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开始时，API只与旧存储交互，这是默认行为。</p><p id="be0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您将标志切换到1时，API从旧的存储器读取数据，但是将数据写入两个存储器。向两个位置写入数据必须在数据迁移开始之前开始。这可确保新存储保持更新，旧存储保持正常工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/9e35b1737f068c22d6753f163f8d6771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08xwD8BzwhSbNorps6luQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“双写”</p></figure><p id="348b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦迁移结束，API就可以从新存储中读取数据。如果出现意外错误，您可以立即将标志切换回1。由于“双写”，旧存储仍然可用。</p><p id="99bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，当一切正常时，您可以切换您的API来完全使用新的存储。这标志着迁移的结束。</p><p id="e211" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意数据流是如何由一个开关动态控制的。在整个过程中，不需要任何代码更改或部署。在迁移开始之前，可以预先准备好所有相关的逻辑。</p><p id="fe52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在代码级别，我们可以使用读写标志轻松地执行条件检查。伪代码如下所示。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="ad84" class="nj me it nf b gy nk nl l nm nn">// 4 values of the flag</span><span id="6ba7" class="nj me it nf b gy no nl l nm nn">oldOnly = 0<br/>writeBoth = 1<br/>readNew = 2<br/>newOnly = 3</span><span id="4270" class="nj me it nf b gy no nl l nm nn">// helper functions for condition checks</span><span id="b6b4" class="nj me it nf b gy no nl l nm nn">function isReadNew(flag) {<br/>    return flag == readNew || flag == newOnly<br/>}</span><span id="91f9" class="nj me it nf b gy no nl l nm nn">func isWriteOld(flag) {<br/>    return flag != newOnly<br/>}</span><span id="75fa" class="nj me it nf b gy no nl l nm nn">func isWriteNew(flag) {<br/>    return flag != oldOnly<br/>}</span><span id="de41" class="nj me it nf b gy no nl l nm nn">// read logic</span><span id="5254" class="nj me it nf b gy no nl l nm nn">if isReadNew(flag) {<br/>    read_new()<br/>} else {<br/>    read_old()<br/>}</span><span id="eae1" class="nj me it nf b gy no nl l nm nn">// write logic</span><span id="de84" class="nj me it nf b gy no nl l nm nn">if isWriteOld(flag) {<br/>    write_old()<br/>}<br/>if isWriteNew(flag) {<br/>    write_new()<br/>}</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="3637" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">资源规划</h1><p id="8b2a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">“双写”的一个主要问题是，它实际上是数据存储系统的常规写流量的两倍<strong class="lb iu"/>。</p><p id="20b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您的系统，它可能无法承受这种额外的压力。迁移可能会增加正常API流量的延迟。在最坏的情况下，它可以完全扰乱系统，这对您的客户来说是个坏消息！</p><p id="5c67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是你需要做你的<strong class="lb iu">尽职调查</strong>的地方，以了解你的系统的容量。一种方法是执行<a class="ae ky" href="https://en.wikipedia.org/wiki/Stress_testing_(software)" rel="noopener ugc nofollow" target="_blank">压力测试</a>来估计您的数据系统可以支持的最大写入流量。</p><p id="e79e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，压力测试包括启动多个后台线程，并不断向系统发送并发请求。您可以将每个线程想象成一个无情的客户端。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/810ebfc56f21cdc5ffa318cbffb05b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P8vGsVwka3ofDVoJN498GA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">压力测试</p></figure><p id="1613" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不会深入讨论压力测试的细节，因为它值得另写一篇文章。我用一个名为<a class="ae ky" href="https://github.com/wg/wrk" rel="noopener ugc nofollow" target="_blank"> wrk </a>的工具和一个我自己写的Go脚本进行了压力测试。</p><p id="58d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你对压力测试结果有信心后，你可以开始问自己一些问题。</p><p id="bb1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的新数据存储应该在单独的物理机上吗？新旧数据存储可以在同一个群集中吗？它们可以在同一个数据库实例中吗？</p><p id="a2b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回答这些问题时，应该深入了解您正在使用的数据存储。不同的存储系统对高写入流量的反应不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/7bbe4ed8292f371c83ba5d9da92f0cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4hKXOKBIl_0CUtunNI19g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据存储系统的例子</p></figure><p id="c752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">了解数据迁移可能对您的系统产生的影响对于准备应对意外情况非常重要！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="e50a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">一致性检验</h1><p id="fcd0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">即使有读写标志和精细的资源规划，错误仍然可能发生！例如，由于网络问题，数据插入可能会超时。</p><blockquote class="nr ns nt"><p id="321f" class="kz la lv lb b lc ld ju le lf lg jx lh nu lj lk ll nv ln lo lp nw lr ls lt lu im bi translated">“任何可能出错的事情都会出错。”—墨菲定律</p></blockquote><p id="cbb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在将读写标志切换到2 (read new)之前，建议执行一次<strong class="lb iu">一致性检查</strong>。</p><p id="b880" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">顾名思义，一致性检查会比较新旧存储之间的数据。它把旧的存储视为真理的来源。如果存在不一致，检查将执行数据修复。</p><p id="0dd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的数据非常大，一致性检查应该使用自动化脚本来完成。根据您对错误的容忍度，您可以执行完全或抽样一致性检查。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8a883e525bc7a26ceeea1254977e846a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4LW3V1YKcbh_BFYcQVYFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一致性检验</p></figure><p id="2769" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查脚本还应该报告发现的不一致的百分比。如果它们高于您预期的阈值，您可能希望在将API切换为read new之前调查根本原因。</p><p id="f025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同时，数据修复可以同步或异步完成。</p><p id="da29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果是同步的，检查脚本将在发现不一致后立即应用修复。否则，脚本可以将修复程序推入队列，供工作人员应用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/5bfa58a7201febf0f4de9be238f88656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uu1EazcKA4boJJXN-oOpBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">同步定位</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/50fa6ebd8a41497e51ccfd2f5167c10d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p95vRmlODLgDc-lsMsG-Hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">异步修复</p></figure><p id="cf6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是修复方法重要吗？嗯，这要看情况…如果你想考虑一下，就在这里停下来😏</p><p id="057b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您的API正在同步地将数据写入新的存储。但是，您在一致性检查中选择了异步修复。</p><p id="4917" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">队列可能会经历短暂的延迟。当工作人员找到“补丁”时，存储器可能已经包含了来自API的更新。然后，工作人员将使用过时的“修复”覆盖更新的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/9259b3c8ea48c249659e677ff069ebd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*M90gj8JNFLs1EPWLyhq1lQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">异步修复中的延迟</p></figure><p id="a265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，同步修复就足够了，因为它很简单。</p><p id="367f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里我想强调的是，当数据开始在所有地方流动时，数据迁移是复杂的。你必须理解你的数据是如何表现的，否则你会被奇怪的不一致所震惊。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="5286" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">记录的重要性</h1><p id="71eb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果你已经编程一段时间了，你会同意系统日志是开发人员最好的朋友。在数据迁移中，我想强调两种类型的日志，它们将使您的生活轻松十倍。</p><h2 id="59d6" class="nj me it bd mf ob oc dn mj od oe dp mn li of og mp lm oh oi mr lq oj ok mt ol bi translated">错误日志</h2><p id="76c1" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">记住，错误随时可能发生，你需要为此做好准备。当出现错误时，您的迁移脚本应该出于调试目的将其注销。</p><p id="8681" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，与其依赖一致性检查来修复错误，我强烈建议您在错误发生时修复错误。</p><p id="6214" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果迁移需要14天，完整的数据检查也需要14天。如果你的项目急于完成，这可能是不可行的。</p><p id="4aca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是错误日志非常有用的地方。您可以通过检查日志中未正确迁移的数据来手动执行修复。如果您足够有想象力，您甚至可以使用脚本来解析日志并进行修复！</p><p id="dfb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这种做法，一致性检查将只是一种“保险”。最后进行抽样一致性检查会更快，而且绰绰有余。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/98d92203f1c608fec9e756da424feaf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXwk6AB0OGA9MqBhcC3iww.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/error-logs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@visuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">视觉</a>拍摄的照片</p></figure><h2 id="6a69" class="nj me it bd mf ob oc dn mj od oe dp mn li of og mp lm oh oi mr lq oj ok mt ol bi translated">进度日志</h2><p id="1047" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">迁移大量数据是一个痛苦的过程。最好能知道它什么时候结束，这样你就可以计划你的庆祝活动了！</p><p id="0a8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">玩笑归玩笑，了解您的迁移进度可以告诉您向您的数据系统引入了多少额外的写流量。另外，你需要对你的利益相关者和技术领导负责。</p><p id="2caa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我所做的是，我有一个后台线程，记录每分钟迁移的数据量。因为我知道数据的总量，所以我可以估计整个过程需要多少时间。</p><p id="cec9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，您必须仔细考虑理解迁移过程所需的信息。尽可能多地注销它们。一旦开始迁移，后悔错过日志就太晚了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d54a4f14bcd9e1ddd1ffb5bfe3c4e6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yctDEp8rYkyl5zqmiWBXAA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克·范·登博斯在<a class="ae ky" href="https://unsplash.com/s/photos/loading?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0a98" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最后的想法</h1><p id="1611" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">总之，我介绍了四种可以帮助您更好地设计和规划迁移项目的实践。你可以(也应该)根据自己的需要调整这些做法。</p><p id="79c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果数据量很小，这些实践中的一些是多余的。然而，当处理大量数据时，它们非常有用。</p><p id="b86d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想分享更多的信息，但是这篇文章太长了。请随意留下评论，这样我们可以交流思想，进行更多的讨论。在此之前，祝您的数据迁移好运！</p></div></div>    
</body>
</html>