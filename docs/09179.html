<html>
<head>
<title>How To Write Safe JavaScript and Avoid Mid-Function Returns</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何编写安全的JavaScript并避免函数中途返回</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-check-for-javascript-properties-without-mid-function-returns-46f39d09975b?source=collection_archive---------14-----------------------#2021-07-22">https://betterprogramming.pub/how-to-check-for-javascript-properties-without-mid-function-returns-46f39d09975b?source=collection_archive---------14-----------------------#2021-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c8a4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">假设积极的一面，同时抓住灾难</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/650a4755a98b6073bec998191de9c36e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZk0Zee2kLp0fis1eoF_Hg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Joan Gamell 在<a class="ae ky" href="https://unsplash.com/s/photos/javascript?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1ce5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您正在编写一个接受来自其他地方的数据的JavaScript程序——并且您想让它防弹。要让这个程序工作，你必须写一个特殊的函数，它接受一个对象作为参数。它接受的对象类型具有深度嵌套的属性，如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您的函数将不得不钻取这个教师对象，以获得它需要的值。</p></figure><p id="e9af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了防止由于遇到<code class="fe lx ly lz ma b">undefined</code>值而导致的错误，您需要检查这些属性是否存在。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="3644" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">使用中间函数返回向下钻取</h1><p id="3f17" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">假设您想编写一个函数，返回教师班级列表中的第一个班级。要实现这一点，您需要深入几个层次。处理这种情况的一种方法是使用中间函数返回，它让你在第一次出现问题时就退出程序。也就是说，使用它们是有代价的。考虑这个返回教师第一堂课的示例函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这些中间函数返回埋没了函数的用途。</p></figure><p id="9fbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个函数把mid-function returns发挥到极致，结果很可笑。大部分功能是检查每一个可能的问题。我从这个函数中得到的总体感觉是，一场大灾难在意料之中。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="9a80" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">紧急呼叫接线员进行救援</h1><p id="3e2b" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">幸运的是，我们可以通过AND ( <code class="fe lx ly lz ma b">&amp;&amp;</code>)操作符避免灾难优先的思维模式。这个操作符的好处是它让我们的程序从左到右检查条件——例如，我们可以在检查<code class="fe lx ly lz ma b">teacher.data</code>之前检查<code class="fe lx ly lz ma b">teacher</code>。请看下面:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">AND运算符让我们可以安全地查找嵌套值。</p></figure><p id="e1d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们首先处理正面案例<em class="nf"/>并仍然返回底部的<code class="fe lx ly lz ma b">null</code>，但前提是先前的努力失败。让我们来看看会发生什么:</p><ul class=""><li id="6254" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">如果没有<code class="fe lx ly lz ma b">teacher</code>对象，程序马上脱离<code class="fe lx ly lz ma b">if</code>状态，返回<code class="fe lx ly lz ma b">null</code>。</li><li id="d504" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">如果有一个<code class="fe lx ly lz ma b">teacher</code>没有<code class="fe lx ly lz ma b">data</code>属性，程序在第二次检查后中断并再次返回<code class="fe lx ly lz ma b">null</code>。</li><li id="1b68" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">如果老师有一个<code class="fe lx ly lz ma b">classes</code>属性，我们检查<code class="fe lx ly lz ma b">length</code>。</li><li id="cb53" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">如果<code class="fe lx ly lz ma b">classes</code>阵的<code class="fe lx ly lz ma b">length</code>在<code class="fe lx ly lz ma b">0</code>之上，那么我们就可以取回第一级！</li><li id="eda6" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">同样，只有当所有这些检查都失败时，我们才返回<code class="fe lx ly lz ma b">null</code>。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="52e5" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">优雅地检查</h1><p id="8ca2" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">使用OR ( <code class="fe lx ly lz ma b">||</code>)操作符还有一种更优雅的方式。考虑下面修改后的函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更紧凑的getFirstClass函数。</p></figure><p id="de19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们使用了<code class="fe lx ly lz ma b">||</code>操作符，这样我们只返回第一个类，如果它被定义的话。如果没有定义，我们可以返回<code class="fe lx ly lz ma b">null</code>。</p><p id="321d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在下面的代码笔中看到所有这些功能。随意叉和实验。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检索嵌套值的三种方法。</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="3cd3" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">检查第一个学生</h1><p id="6307" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">下面是一个更深入的函数，检查第一个班级中的第一个学生，而不使用中间函数返回。注意我们结合了前面例子中的方法，检查类对象的<code class="fe lx ly lz ma b">length</code>，然后对<code class="fe lx ly lz ma b">pupils</code>数组使用<code class="fe lx ly lz ma b">||</code>操作符。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有AND和OR运算符的getFirstPupil函数。</p></figure><p id="1180" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在下面的操作中看到这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用AND和or运算符检查第一个瞳孔。</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="91d8" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">最后的想法</h1><p id="50c0" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">对我来说，<code class="fe lx ly lz ma b">&amp;&amp;</code>操作符帮助我在编写函数时保持乐观。通过允许我渐进地深入一个对象，它让我在检查以确保必要的属性存在的同时假定最佳的结果——并在它们不存在时处理这种情况。</p><div class="nv nw gp gr nx ny"><a rel="noopener  ugc nofollow" target="_blank" href="/7-approaches-to-rewriting-javascript-from-my-early-days-c6ada526d55f"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">我早期用来重写JavaScript代码的7个技巧</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">3.移除过多的中间函数返回</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">betterprogramming.pu</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>