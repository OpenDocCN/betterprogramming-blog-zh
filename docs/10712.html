<html>
<head>
<title>Animations Inside a ScrollView With SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带SwiftUI的ScrollView中的动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/animations-inside-a-scrollview-with-swiftui-3b550c18a442?source=collection_archive---------7-----------------------#2022-01-24">https://betterprogramming.pub/animations-inside-a-scrollview-with-swiftui-3b550c18a442?source=collection_archive---------7-----------------------#2022-01-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d62" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">延迟播放动画，直到视图出现在屏幕上</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/689823a7ba26bf38060c656d807f5ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*161XA4-KH8yp9lwsNGthaA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带SwiftUI的ScrollView中的动画</p></figure><p id="43ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe lu lv lw lx b">ScrollViews</code>和<code class="fe lu lv lw lx b">Lists</code>中，嵌入式视图在显示在屏幕上之前被加载。<code class="fe lu lv lw lx b">onAppear</code>在视图出现在屏幕上之前触发。在播放动画之前，我们需要等待动画视图出现在屏幕上。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="7154" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">视图修改器</h1><p id="19c0" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">为了延迟我们的动画，我们将创建一个视图修改器来计算视图的位置，并在视图到达屏幕底部时触发动画播放。</p><p id="4bf0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在body函数中，使用<code class="fe lu lv lw lx b">GeometryReader</code>获得视图的全局位置。如果视图在屏幕外(滚动视图/列表的下方)，则内容将位于高于屏幕高度的位置。</p><p id="d816" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在代码中要做的是:</p><ul class=""><li id="244d" class="nc nd it la b lb lc le lf lh ne ll nf lp ng lt nh ni nj nk bi translated">将我们的内容嵌入到<code class="fe lu lv lw lx b">GeometryReader</code>中。</li><li id="bbce" class="nc nd it la b lb nl le nm lh nn ll no lp np lt nh ni nj nk bi translated">用GeometryReader创建一个变量来获得视图的全局<code class="fe lu lv lw lx b">midY</code>位置。</li><li id="f45a" class="nc nd it la b lb nl le nm lh nn ll no lp np lt nh ni nj nk bi translated">如果需要，创建一个变量来偏移视图的<code class="fe lu lv lw lx b">midY</code>位置。</li><li id="6a74" class="nc nd it la b lb nl le nm lh nn ll no lp np lt nh ni nj nk bi translated">使用我们创建的变量，使用if语句将屏幕高度与视图的<code class="fe lu lv lw lx b">midY</code>位置和偏移量进行比较。如果屏幕的高度等于或高于<code class="fe lu lv lw lx b">midY</code>位置(+偏移)，那么内容将出现，这将触发我们的动画开始。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="c68c" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">动画视图</h1><p id="a9cf" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">为了测试我们创建的视图修改器，我们可以创建一个带有两个动画元素的<code class="fe lu lv lw lx b">Text</code>视图；<code class="fe lu lv lw lx b">opacity</code>和<code class="fe lu lv lw lx b">y</code>位置。</p><p id="21a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为不透明度和y位置创建一个变量。使用<code class="fe lu lv lw lx b">opacity()</code>和<code class="fe lu lv lw lx b">offset()</code>修改器。</p><p id="3109" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">向修饰符传递它们的相对变量。在<code class="fe lu lv lw lx b">.onAppear()</code>中，使用<code class="fe lu lv lw lx b">withAnimation()</code>制作不透明度和y位置属性的值变化的动画。</p><p id="4908" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，添加一个<code class="fe lu lv lw lx b">modifier()</code>并将我们在上面创建的<code class="fe lu lv lw lx b">AnimationModifier</code>视图修改器传递给它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b176d69887aef6070488bb4911b0ebc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*guq1mAwlntipcJzuUNzuRQ.gif"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="d876" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">例子</h1><p id="3db1" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">这里是使用我们的<code class="fe lu lv lw lx b">AnimationModifier</code>视图修改器的其他动画例子。在下面的所有例子中，我不需要偏移任何视图的中间位置。</p><h2 id="e710" class="nt mg it bd mh nu nv dn ml nw nx dp mp lh ny nz mr ll oa ob mt lp oc od mv oe bi translated">动画条形图</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5332037bd9e63b42e015797d2f2c668a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*YraHyAR5WDO3C868oqrd2w.gif"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="204c" class="nt mg it bd mh nu nv dn ml nw nx dp mp lh ny nz mr ll oa ob mt lp oc od mv oe bi translated">动画圆圈</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d5357e801c3af8eae04d2ed826b4845c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*tKkFBOX182RPhS2-gcPxgQ.gif"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="7329" class="nt mg it bd mh nu nv dn ml nw nx dp mp lh ny nz mr ll oa ob mt lp oc od mv oe bi translated">动画框</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/cb5b89c0fea95d1df1014de5b0329cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*vgX3BOYPcNn4DC6QO-9Uhg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">滚动视图中的动画文本框</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="458b" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">内容视图</h1><p id="baf2" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">最后，我们可以在内容视图中添加所有的例子。添加一个滚动视图或列表，并在其中嵌入我们上面创建的所有动画视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/878d71b7cb07cdaac964a14e70d0119a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*R-tY0sbsmJJHSyaMS-_FjA.gif"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="b95a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本教程到此为止。感谢您的阅读！</p></div></div>    
</body>
</html>