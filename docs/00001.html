<html>
<head>
<title>Why and How To Use Docker for Development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么以及如何使用Docker进行开发</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-and-how-to-use-docker-for-development-a156c1de3b24?source=collection_archive---------0-----------------------#2015-04-28">https://betterprogramming.pub/why-and-how-to-use-docker-for-development-a156c1de3b24?source=collection_archive---------0-----------------------#2015-04-28</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="3edc" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">Docker不仅仅用于部署，它对于开发来说也很棒</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/73e454db0c7fff3c74b07eddbd7e5798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UBJ8qndf3mU3kHpOwhptEw.png"/></div></div></figure><p id="09a7" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们在<a class="ae lr" href="http://iron.io" rel="noopener ugc nofollow" target="_blank"> Iron.io </a>的<a class="ae lr" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>上进行了大量投资，在那里我们使用它来部署我们所有的API和应用程序，<a class="ae lr" href="http://blog.iron.io/2014/10/docker-in-production-what-weve-learned.html" rel="noopener ugc nofollow" target="_blank">在我们的IronWorker基础设施上运行其他人的代码</a>，为我们的用户进行本地测试，并交付我们新的<a class="ae lr" href="http://dev.iron.io/mq/3/" rel="noopener ugc nofollow" target="_blank"> IronMQ v3 </a>本地产品。我们还将它用于开发，下面是原因和方法。</p></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="15c1" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">为什么要使用Docker进行开发？</h1><p id="21de" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">以下是您可以/应该使用Docker进行开发的一些原因。</p><ul class=""><li id="3ef3" class="mw mx iu kx b ky kz lb lc le my li mz lm na lq nb nc nd ne bi translated">为您的整个团队提供一致的开发环境。所有开发人员都使用相同的操作系统、相同的系统库和相同的语言运行时，不管他们使用什么主机操作系统(甚至是Windows，如果你相信的话)。</li><li id="81c1" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">开发环境与生产环境完全相同。这意味着您可以部署它，它将“正常工作”。</li><li id="caf1" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">如果你在构建某个东西时遇到了困难(构建，我指的是编译)，在Docker内部构建它。这主要适用于使用MacOS和Windows的开发者。</li><li id="9962" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">你只需要Docker来开发。你不需要在你的机器上安装一堆语言环境。想运行一个Ruby脚本但是没有安装Ruby？在Ruby Docker映像中运行它。</li><li id="54db" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">您可以使用多种语言版本，而不必求助于针对您的语言的所有规避措施(<a class="ae lr" href="https://pypi.python.org/pypi/virtualenv" rel="noopener ugc nofollow" target="_blank"> python </a>、<a class="ae lr" href="https://github.com/yyuu/pyenv" rel="noopener ugc nofollow" target="_blank"> python </a>、<a class="ae lr" href="https://rvm.io/" rel="noopener ugc nofollow" target="_blank"> ruby </a>、<a class="ae lr" href="https://github.com/sstephenson/rbenv" rel="noopener ugc nofollow" target="_blank"> ruby </a>、<a class="ae lr" href="http://superuser.com/questions/135580/multiple-java-environment-on-the-same-linux-machine" rel="noopener ugc nofollow" target="_blank"> java </a>、<a class="ae lr" href="https://github.com/creationix/nvm" rel="noopener ugc nofollow" target="_blank"> node </a>)。想在Python 3中运行您的Python程序，但只安装了Python 2？使用Python 3 image运行它。想用Java 1.6而不是你机器上安装的1.7来编译你的Java程序吗？将其编译成Java 1.6 Docker映像。</li><li id="64ae" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">部署很容易。如果它在你的容器中运行，它也会在你的服务器上运行。只需将您的代码打包并使用相同的映像部署在服务器上，或者推送一个包含您的代码的新Docker映像并运行该新映像。</li><li id="44da" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">仍然可以像平常一样使用您最喜欢的编辑器/IDE。不需要在VirtualBox中运行VM，也不需要在shell中运行和开发，就可以在Linux机器上构建/运行。</li></ul></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="050a" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">如何使用Docker进行开发</h1><p id="1998" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">这与您通常为开发所做的事情没有太大的不同，除了两件事:</p><ol class=""><li id="4fb5" class="mw mx iu kx b ky kz lb lc le my li mz lm na lq nk nc nd ne bi translated">确保您的所有依赖项都在您的工作目录中，还有您的代码。</li><li id="68fc" class="mw mx iu kx b ky nf lb ng le nh li ni lm nj lq nk nc nd ne bi translated">将构建和运行命令更改为在Docker容器中运行。</li></ol><p id="7c23" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我将展示如何用几种不同的语言做到这一点，首先用Ruby做一个详细的解释，然后用其他语言快速浏览。</p></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h2 id="1be9" class="nl ma iu bd mb nm nn dn mf no np dp mj le nq nr ml li ns nt mn lm nu nv mp nw bi translated">红宝石</h2><p id="0925" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">让我们从一个非常简单的Hello World示例开始。你甚至不需要安装Ruby来运行它。</p><p id="d71e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">复制下面的代码，放到一个名为<em class="nx"> hello.rb </em>的文件中。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="90d1" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="77b5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">它应该打印“你好，鲁比！”。很简单。<strong class="kx iv">这真是一个神奇的命令，你几乎可以用它来做任何事情。</strong>现在，让我们添加一个依赖项，以展示如何销售您的依赖项，以便您可以在容器内轻松运行它，而不必将依赖项安装到容器中。将这个拷贝到一个名为<em class="nx"> Gemfile </em>的文件中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="53b3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">并将<em class="nx"> hello.rb </em>改为:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="fdf2" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果您运行<em class="nx"> bundle install </em>来安装gems，然后运行<em class="nx"> ruby hello.rb </em>，这将会工作——但是如果您在Docker容器中运行它，它将会失败，因为容器中没有安装<em class="nx"> iron_mq </em> gem。我们可以把它安装在容器中，但是你必须管理容器，记住容器的状态，以及在把你的代码部署到另一个服务器之前，你如何让它达到那个状态，等等。我喜欢短暂的容器。你最好出售你的依赖项，把你所有的代码和依赖项放在一个漂亮的小包装里。所以，让我们运行这个:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="12ad" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这将把您的依赖项安装到工作目录中，另外，如果有任何东西需要编译(本机扩展)，它们将构建在正确的架构上！</p><p id="4178" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在对<em class="nx"> hello.rb </em>的最后一个更改是使用这个新的包，注意顶部的require_relative行:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="0321" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在，让我们用新的依赖项再次运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="377f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">一切都好！在不同版本的Ruby上运行怎么样，比如Ruby 1.9？只是在不同的容器中运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h2 id="67ff" class="nl ma iu bd mb nm nn dn mf no np dp mj le nq nr ml li ns nt mn lm nu nv mp nw bi translated">网络应用</h2><p id="4fe3" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">如果您正在制作一个web应用程序，并且需要打开端口，只需将<em class="nx"> -p PORT:PORT </em>标志传递给<em class="nx"> docker run。这里有一个示例web应用程序可以试用。</em></p><p id="c767" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">将此内容复制到webapp.rb:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="14e3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">将<em class="nx">gem‘Sinatra’</em>添加到你的gem文件中，再次运行上面的<em class="nx">捆绑安装</em>命令。然后运行以下命令:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="705f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">并前往<a class="ae lr" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>查看。</p><p id="82c6" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">差不多就是这样！除了一些细微的差别，这些东西大部分都适用于每一种语言。下面还有一些语言示例，没有全部细节，这里是所有这些的<a class="ae lr" href="https://github.com/treeder/docker-for-development" rel="noopener ugc nofollow" target="_blank">完整源代码</a>。</p></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h2 id="7e15" class="nl ma iu bd mb nm nn dn mf no np dp mj le nq nr ml li ns nt mn lm nu nv mp nw bi translated">Java 语言(一种计算机语言，尤用于创建网站)</h2><p id="a3a7" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">与Ruby的例子类似，将依赖项(jar文件)放入工作目录，然后在容器中编译程序并运行它。<a class="ae lr" href="https://github.com/treeder/docker-for-development/tree/master/java" rel="noopener ugc nofollow" target="_blank">示例repo </a>具有该示例的依赖性。</p><p id="8e0c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">将此内容复制到Hello.java:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="1796" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在容器中编译它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="6bca" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在容器中运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h2 id="76be" class="nl ma iu bd mb nm nn dn mf no np dp mj le nq nr ml li ns nt mn lm nu nv mp nw bi translated">结节</h2><p id="093f" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">Node非常好，因为<em class="nx"> npm install </em>默认在工作目录中安装依赖项。首先，安装我们的依赖项:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="402b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在将程序复制到一个名为<code class="fe oa ob oc od b">hello.js</code>的文件中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="a729" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">并运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h2 id="75f7" class="nl ma iu bd mb nm nn dn mf no np dp mj le nq nr ml li ns nt mn lm nu nv mp nw bi translated">去</h2><p id="0b24" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">将这段代码复制到一个名为<code class="fe oa ob oc od b">hello.go</code>的文件中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="e636" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在运行下面几行来获取依赖项，构建并运行它:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="3c66" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">嘣。</p></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="83c3" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">最后一个提示</h1><p id="a099" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">在前面的所有示例中，容器在运行(— rm)标志后立即被删除。无论出于什么原因，也许你需要一段时间来建立一个依赖关系，比如RocksDB，你可以使用这个技巧来保存容器:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="af54" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这将在您第一次启动容器时运行docker，并在第一次运行后在现有容器上启动docker。</p><p id="60b7" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果你尝试了上面的任何一个例子，你可以看到它并没有改变你的开发过程太多，并且可以提供许多好处，如本文开头所列。显然，所有这些也适用于其他语言。试一试——很想听听你的想法。</p></div></div>    
</body>
</html>