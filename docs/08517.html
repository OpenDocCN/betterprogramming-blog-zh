<html>
<head>
<title>5 Times Python Made Me Say WTF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5次Python让我说WTF</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-times-python-made-me-say-wtf-38a36c2a551f?source=collection_archive---------4-----------------------#2021-05-10">https://betterprogramming.pub/5-times-python-made-me-say-wtf-38a36c2a551f?source=collection_archive---------4-----------------------#2021-05-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2069" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解一些有趣的Python怪事</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/17d4257f26ead675bb9ec38fbfd9b081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ducOMk1FQgUJR75DW3g4bA.jpeg"/></div></div></figure><p id="33a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Python是一种流行的编程语言。和其他优秀的编程语言一样，Python有时会让开发人员摸不着头脑。</p><p id="2d8e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">今天我用Python给大家展示五个“搞笑”的wtf。不，我不是在说虫子。</p><h1 id="30b6" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">1.有时两个相等的数字不相等</h1><p id="c5e3" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">让我们使用Python的<code class="fe mn mo mp mq b">is</code>操作符来比较两个相等的数字，看看会发生什么:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="abbd" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; a = 256<br/>&gt;&gt;&gt; b = 256<br/>&gt;&gt;&gt; a is b<br/>True</span><span id="93f1" class="mv lr it mq b gy na mx l my mz">&gt;&gt;&gt; a = 257<br/>&gt;&gt;&gt; b = 257<br/>&gt;&gt;&gt; a is b<br/>False</span></pre><h2 id="8b9c" class="mv lr it bd ls nb nc dn lw nd ne dp ma ld nf ng mc lh nh ni me ll nj nk mg nl bi translated">它是如何工作的</h2><p id="f3e0" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">首先，使用<code class="fe mn mo mp mq b">==</code>运算符检查两个变量是否相等。另一方面，<code class="fe mn mo mp mq b">is</code>操作符检查变量是否指向同一个对象。</p><p id="686d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">其次，Python在引擎盖下做了一些优化。一些常用的对象，例如小数字(介于-5和256之间)只分配一次。但是更大的数量是根据需要多次按需分配的。</p><p id="37d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有一个例子:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="cd84" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; x = 1000<br/>&gt;&gt;&gt; y = 1000<br/>&gt;&gt;&gt; z = 1000</span></pre><p id="5277" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数字<code class="fe mn mo mp mq b">1000</code>被分配三次，因此即使数字<code class="fe mn mo mp mq b">x</code>、<code class="fe mn mo mp mq b">y</code>和<code class="fe mn mo mp mq b">z</code>相等，它们都被分配了不同的<code class="fe mn mo mp mq b">1000</code>。然而，这里有另一个例子:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="ab6e" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; a = 255<br/>&gt;&gt;&gt; b = 255<br/>&gt;&gt;&gt; c = 255</span></pre><p id="35b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数字255只被分配了一次，所以“同一个<code class="fe mn mo mp mq b">255</code>”被使用了三次。这实际上是<code class="fe mn mo mp mq b">is</code>操作符感兴趣的，而不是值相等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/517c3bec4d40dea8c6163d3e053d6379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8S1DA4UvFNhUGdwuXAvlwA.jpeg"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">总是只有一个255，但是例如可以有多个1000。图片鸣谢:作者。</p></figure><p id="2c65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关键的一点是:不要用<code class="fe mn mo mp mq b">is</code>来比较数字，尽管它有时会起作用。</p><h1 id="f964" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">2.这是它不是什么</h1><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="b9e2" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; 'something' is not None<br/>True<br/>&gt;&gt;&gt; 'something' is (not None)<br/>False</span></pre><h2 id="066d" class="mv lr it bd ls nb nc dn lw nd ne dp ma ld nf ng mc lh nh ni me ll nj nk mg nl bi translated">它是如何工作的</h2><ul class=""><li id="bc51" class="nr ns it kw b kx mi la mj ld nt lh nu ll nv lp nw nx ny nz bi translated"><code class="fe mn mo mp mq b">is not</code>实际上是单个二元运算符。因此，其行为不同于单独使用<code class="fe mn mo mp mq b">is</code>和<code class="fe mn mo mp mq b">not</code>。</li><li id="c1fd" class="nr ns it kw b kx oa la ob ld oc lh od ll oe lp nw nx ny nz bi translated">如果比较的变量指向同一个对象，则<code class="fe mn mo mp mq b">is not</code>返回<code class="fe mn mo mp mq b">False</code>，否则返回<code class="fe mn mo mp mq b">True</code>。</li></ul><p id="f1f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了分解这个例子，<code class="fe mn mo mp mq b">(not None)</code>计算为<code class="fe mn mo mp mq b">True</code>，因为值<code class="fe mn mo mp mq b">None</code>在布尔意义上是<code class="fe mn mo mp mq b">False</code>。这样<code class="fe mn mo mp mq b">'something' is (not None)</code>就淡化为<code class="fe mn mo mp mq b">'something' is True</code>。</p><h1 id="9065" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">3.0.1+0.2的结果是什么？</h1><p id="f59d" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">我们来做一个简单的计算。这应该足够简单，不会引起任何问题，对吗？</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="d6a1" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; 0.1 + 0.2<br/>0.30000000000000004</span></pre><p id="cc59" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">哇…</p><h2 id="b201" class="mv lr it bd ls nb nc dn lw nd ne dp ma ld nf ng mc lh nh ni me ll nj nk mg nl bi translated">它是如何工作的</h2><p id="7291" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这在其他编程语言中也是一种常见的异常现象，有一个网站<a class="ae of" href="https://0.30000000000000004.com/" rel="noopener ugc nofollow" target="_blank">0.30000000000000004.com</a>详细解释了这是怎么回事。</p><p id="58e8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">简而言之，计算机可以按原样存储整数，但它们需要近似十进制值。</p><p id="086d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在一个由计算机完成所有数学运算的2进制数字系统中，<code class="fe mn mo mp mq b">1/10</code>和<code class="fe mn mo mp mq b">1/5</code> ( <code class="fe mn mo mp mq b">0.1</code>和<code class="fe mn mo mp mq b">0.2</code>)实际上是循环小数(类似于<code class="fe mn mo mp mq b">1/6</code>在10进制系统中循环小数<code class="fe mn mo mp mq b">0.166666…</code>)。</p><p id="0cbe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您的计算机使用循环小数进行计算时，由于近似值，结果可能会有剩余。当计算机最终将2进制的结果转换成10进制的结果时，可能的剩余部分继续进行。例子的结果是<code class="fe mn mo mp mq b">0.1 + 0.2 = 0.30000000000000004</code>。</p><h1 id="a92e" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">4.在链接中</h1><p id="1651" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">你知道这个表达式的结果是<code class="fe mn mo mp mq b">True</code>吗？</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="8b3f" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; "A" in "AA" in "AAA" in "AAAA"<br/>True</span></pre><h2 id="5fae" class="mv lr it bd ls nb nc dn lw nd ne dp ma ld nf ng mc lh nh ni me ll nj nk mg nl bi translated">它是如何工作的</h2><p id="be71" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">在Python中，可以通过设计来链接比较运算符。在上面的例子中，它看起来很可笑，也不是特别有用。但是，当您可以执行以下操作时，它会变得很方便:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="0735" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; 0 &lt; x &lt; 10</span></pre><p id="19f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">而不是:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="8da0" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; x &gt; 0 and x &lt; 10</span></pre><h1 id="e9f5" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">5.使用布尔运算进行数学运算</h1><p id="eda8" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">厌倦了用数字做数学吗？为什么不用布尔函数代替呢？在Python中，可以用布尔值进行计算。例如:</p><pre class="kj kk kl km gt mr mq ms mt aw mu bi"><span id="15dd" class="mv lr it mq b gy mw mx l my mz">&gt;&gt;&gt; (True + True) * (True + True + True)<br/>6</span></pre><p id="ccb6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这对应<code class="fe mn mo mp mq b">(1 + 1) * (1 + 1 + 1)</code>。</p><h2 id="00b5" class="mv lr it bd ls nb nc dn lw nd ne dp ma ld nf ng mc lh nh ni me ll nj nk mg nl bi translated">它是如何工作的</h2><p id="1af4" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">在早期，Python中没有<code class="fe mn mo mp mq b">True</code>也没有<code class="fe mn mo mp mq b">False</code>。而是分别使用了<code class="fe mn mo mp mq b">1</code>和<code class="fe mn mo mp mq b">0</code>。如今，布尔值<code class="fe mn mo mp mq b">True</code>和<code class="fe mn mo mp mq b">False</code>是存在的，但它们与整数<code class="fe mn mo mp mq b">0</code>和<code class="fe mn mo mp mq b">1</code>捆绑在一起。<a class="ae of" href="https://docs.python.org/3/reference/datamodel.html#:~:text=These%20represent%20the,returned%2C%20respectively" rel="noopener ugc nofollow" target="_blank"> Python 3文档</a>说明了一切:</p><blockquote class="og oh oi"><p id="2ce6" class="ku kv oj kw b kx ky ju kz la lb jx lc ok le lf lg ol li lj lk om lm ln lo lp im bi translated">Boolean类型是integer类型的一个子类型，在几乎所有上下文中，<strong class="kw iu"> Boolean值的行为分别类似于值0和1，例外情况是当转换为字符串时，分别返回字符串<code class="fe mn mo mp mq b">"False"</code>或<code class="fe mn mo mp mq b">"True"</code>。</strong></p></blockquote><h1 id="9dd4" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">结论</h1><p id="8edd" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">感谢阅读。希望你觉得好笑，有用！</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><h1 id="48e3" class="lq lr it bd ls lt ou lv lw lx ov lz ma jz ow ka mc kc ox kd me kf oy kg mg mh bi translated">你可能会发现这些文章很有见地</h1><div class="oz pa gp gr pb pc"><a rel="noopener  ugc nofollow" target="_blank" href="/10-useful-python-snippets-to-code-like-a-pro-e3d9a34e6145"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">10个有用的Python片段，让你像专业人士一样编写代码</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">我每天使用的有用的提示和技巧</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">better编程. pub</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener  ugc nofollow" target="_blank" href="/understand-python-decorators-in-3-minutes-ec48fdc8e2cf"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">3分钟了解Python Decorators</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">用decorators扩展方法和类的功能</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">better编程. pub</p></div></div><div class="pl l"><div class="pr l pn po pp pl pq ks pc"/></div></div></a></div></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><h1 id="f148" class="lq lr it bd ls lt ou lv lw lx ov lz ma jz ow ka mc kc ox kd me kf oy kg mg mh bi translated">资源</h1><div class="oz pa gp gr pb pc"><a href="https://docs.python.org/3" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">文件</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">欢迎光临！这是Python 3.9.5的文档。</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">docs.python.org</p></div></div></div></a></div><div class="oz pa gp gr pb pc"><a href="https://github.com/satwikkansal/wtfpython" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">satwikkansal/wtfpython</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk">Exploring and understanding Python through surprising snippets. Translations: Chinese 中文 | Vietnamese Tiếng Việt |…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">github.com</p></div></div><div class="pl l"><div class="ps l pn po pp pl pq ks pc"/></div></div></a></div></div></div>    
</body>
</html>