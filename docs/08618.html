<html>
<head>
<title>Turn Website Data Into Data Sets: A Beginner’s Guide to Python Web Scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将网站数据转化为数据集:Python网络抓取初学者指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/turn-website-data-into-datasets-a-beginners-guide-to-python-web-scraping-ac1ce99d73a1?source=collection_archive---------0-----------------------#2021-05-21">https://betterprogramming.pub/turn-website-data-into-datasets-a-beginners-guide-to-python-web-scraping-ac1ce99d73a1?source=collection_archive---------0-----------------------#2021-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="797a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以高度自动化的方式快速从网站中提取信息</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9819de858890c704a22f238ad005e296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QmnzLTHQIl_HEaVXC-4DsQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者插图(<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片用于虚构的列表图片)</p></figure><h1 id="40ed" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">概观</h1><h2 id="0b44" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">这篇文章的内容</h2><ul class=""><li id="5c9b" class="md me iq mf b mg mh mi mj lt mk lw ml lz mm mn mo mp mq mr bi translated">网络搜集的技术和法律考虑</li><li id="84c0" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">使用基于HTML的方法和Python漂亮的Soup库抓取基于搜索的平台的例子</li><li id="af61" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">抓取时处理数据异常和不一致的常用技术</li><li id="ee39" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">如何将讨论的例子转化为数据管道，使用亚马逊的云计算平台、<a class="ae kv" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a>和<a class="ae kv" href="http://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Airflow </a>定期收集数据</li></ul><h2 id="0e07" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">什么是网页抓取？</strong></h2><p id="f5e9" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">网络爬虫访问网站的底层代码并收集大量数据，这些数据随后被保存在本地文件或数据库中。它已经成为数据科学和商业中的一个既定学科:公司收集竞争对手的趋势，进行市场研究，并进行深入分析，所有这些都是基于可以公开访问的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ccdaf836e66e4a0a0cd5dcb78d852fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWKNocRWQFXhSgt3qCE3DQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网站的三层(作者插图)</p></figure><h2 id="d83b" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">web刮刀一般是如何工作的？</strong></h2><p id="0f18" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">有不同的方法来抓取网页。本文主要关注HTML刮刀，并在最后一节简要概述了其他方法。顾名思义，这些类型的抓取器使用网站的底层HTML代码来检索所需的信息。这种方法非正式地访问网站，这就是为什么需要使用带有定制逻辑的代码来解密所需数据。</p><h2 id="e14c" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">与API调用相比的差异</strong></h2><p id="623e" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">获取网站数据的另一种方法是利用称为<em class="nk"> API调用</em>的进程。API(应用程序编程接口)由网站所有者正式提供，允许请求特定信息，其中数据直接从数据库(或普通文件)访问。这通常需要网站所有者的许可，并且是高度安全的(例如，API密钥和令牌)。然而，API并不总是可用的，这就是为什么抓取具有很高的吸引力，但它也提出了合法性的问题。</p><h2 id="bd67" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">法律考虑</strong></h2><p id="bc8f" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">网络抓取可能会违反版权规范或网站所有者的服务条款，尤其是当它被用于竞争优势、意外收入或一般滥用目的(例如，在很短的时间间隔内发送请求)时。然而，收集公开可用的数据并用于1)私人消费、2)学术目的或3)其他无商业意图的情况，通常可以被认为是合法无害的。</p><p id="932e" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">如果数据1)受到登录或付费墙的保护，2)明确禁止网站所有者抓取，3)包含机密信息，或4)危及个人隐私，则必须避免任何类型的抓取活动。因此，请谨记始终以负责任的态度行事，并首先遵循合规原则。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="fc68" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">漂亮的Python汤设置</h1><p id="e186" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated"><a class="ae kv" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#" rel="noopener ugc nofollow" target="_blank">美汤</a>是一个Python库，通过访问底层HTML代码从网站收集数据。</p><p id="815c" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在您的终端中安装最新版本的Beautiful Soup:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="3f1b" class="lo kx iq od b gy oh oi l oj ok">$ pip install beautifulsoup4</span></pre><p id="1211" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">安装<code class="fe ol om on od b">requests</code> <em class="nk"> </em>能够调用网站(库发送HTTP请求):</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="94f7" class="lo kx iq od b gy oh oi l oj ok">$ pip install requests</span></pre><p id="a1f9" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在Python或Jupyter笔记本文件中，导入这些库:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="8ba5" class="lo kx iq od b gy oh oi l oj ok">from bs4 import BeautifulSoup<br/>import requests</span></pre><p id="14a5" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">以及一些用于数据处理和转换步骤的标准库:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="ddd4" class="lo kx iq od b gy oh oi l oj ok">import re<br/>from re import sub<br/>from decimal import Decimal<br/>import io<br/>from datetime import datetime<br/>import pandas as pd</span></pre></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="6df3" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">0.介绍</h1><p id="511e" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">假设我们想要抓取一个平台，其中包含公共可用的属性广告。我们希望获得以下信息:1)房产的价格，2)其地址，以及3)距离，4)车站名称，以及5)到最近的公共交通站的交通<em class="nk"> </em>类型，以找出房产价格在特定城市的公共交通站中是如何分布的。</p><p id="7150" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">例如，如果我们考虑离公交车站最近的50处房产，那么该车站的平均房价是多少？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d6d0d022fc65993bd737884a306ac2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DdtLBBvy7eOscSFXzDb5dA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分析思路(作者举例)</p></figure><p id="eb0e" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir">重要提示:</strong>我们明确避免使用特定的网站，因为我们不想在同一个网站推广跑步。这就是为什么本文中的代码是<strong class="mf ir">一般化的</strong>并且使用了一个带有<strong class="mf ir">虚拟HTML代码</strong>的<strong class="mf ir">虚拟网站</strong>。然而，示例代码与现实生活中的网站高度一致。</p><p id="dcb7" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">假设对属性的搜索请求将导致如下所示的结果页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/2a76268d205cef6ceb2d7ae4cd65e10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNOTEZj6kwQnOo5xBzYRrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">虚构的结果页面(作者使用<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片对虚构的列表进行说明)</p></figure><p id="7d54" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">一旦我们知道广告以何种布局和结构显示，我们需要提出一个抓取逻辑，允许我们从结果页面上的每个广告中获取所有需要的功能(例如，价格、地址、公共交通信息功能)。</p><p id="7d16" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">每当我遇到这类棘手的任务时，我会采取以下步骤:</p><ol class=""><li id="452a" class="md me iq mf b mg nl mi nm lt op lw oq lz or mn os mp mq mr bi translated"><strong class="mf ir">如何为一个特征获取一个数据点？<br/> </strong>(例如，从第一个广告中获取价格标签。)</li><li id="c790" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated"><strong class="mf ir">如何从整个页面中获取一个特征的所有数据点？<br/> </strong>(例如，获取页面上所有广告的价格标签。)</li><li id="b137" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated"><strong class="mf ir">如何在所有结果页面中获得一个特性的所有数据点？<br/> </strong>(例如，获取针对特定搜索请求显示的每个广告的价格标签。)</li><li id="ea30" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated"><strong class="mf ir">如果感兴趣的数据点在广告中并不总是适用，如何解决不一致的问题？<br/> </strong>(例如，有些广告的价格栏显示“应用价格”我们最终会得到一个由数字和字符串值组成的列，这在我们的例子中不允许进行现成的分析。当然，我们可以在进行分析时简单地排除字符串值。这一步只是为了演示如何从一开始就预期一个更干净的数据集，这在其他情况下可能更有价值。)</li><li id="0184" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated"><strong class="mf ir">如何更好地提取复杂信息？<br/> </strong>(例如，假设每个广告都包含公共交通信息，如“距离地铁站XY 0.5英里。”逻辑需要看起来像什么，以便我们可以以正确的格式直接存储这种混合信息:distance = [0.5]，transport_type = ["underground"]，station = ["name XY"])</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/087bd55c992887e8692fff32f179a125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCs9fMwGA4t-7JfhhJR5Uw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网页抓取框架(作者插图)</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="eab0" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">1.获取一个数据点的逻辑</h1><p id="d558" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated"><strong class="mf ir">重要提示:</strong>下面讨论的所有代码片段也可以在GitHub上我的<a class="ae kv" href="https://github.com/christopherkindl/web-scraper-template" rel="noopener ugc nofollow" target="_blank">库</a>中的一个完整的Jupyter笔记本文件中找到。</p><h2 id="f859" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">呼叫网站</strong></h2><p id="7a0b" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">首先，我们在Python脚本中复制我们在浏览器中完成的搜索请求:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="619a" class="lo kx iq od b gy oh oi l oj ok"># search area of interest<br/>url = 'https://www.website.com/london/page_size=25&amp;q=london&amp;pn=1'<br/><br/># make request with url provided and get html text<br/>html_text = requests.get(url).text<br/><br/># employ lxml as a parser to extract html code<br/>soup = BeautifulSoup(html_text, 'lxml')</span></pre><p id="12fa" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">变量<code class="fe ol om on od b">soup</code> <em class="nk"> </em>现在包含了结果页面的整个HTML源代码。</p><h2 id="1f1f" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">搜索特定于功能的HTML标签</h2><p id="a220" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">现在的技巧是找到可区分的HTML标签，或者是类，或者是id，它们指向感兴趣的特定信息点(例如，价格，见下图)。</p><p id="6de9" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">对于这一步，我们需要浏览器的帮助。一些流行的浏览器提供了一种直接获取特定元素的HTML信息的便捷方式。在Google Chrome中，您1)标记特定的功能字段，然后2)右键单击以获得检查元素的选项(或者简单地应用键盘快捷键Cmd + Shift + C)。然后在浏览器视图旁边打开源代码，您可以直接看到HTML信息。</p><p id="6a72" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在价格的例子中，使用HTML类<code class="fe ol om on od b">css-aaabbbccc</code>将返回信息<code class="fe ol om on od b">£550,000</code>，如浏览器视图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9875ebcf8289fd7423fc316672ae41a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3lJP-0q-QBd--tv3xvyOww.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">获取基于HTML类的数据点(虚构代码)(作者使用<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片进行说明)</p></figure><h2 id="5fae" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">理解HTML类和id属性</h2><p id="525a" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">CSS有时JavaScript使用HTML类和id来执行某些任务。这些属性主要用于引用CSS样式表中的类，以便以一致的方式显示数据(例如，以此格式在此位置显示价格标签)。</p><p id="c307" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">class和id的唯一区别是，id在一个页面中是唯一的，并且最多只能应用于一个元素，而class可以应用于多个元素。</p><p id="4790" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在上面的例子中，用于从一个广告中检索价格信息的HTML类也适用于从其他广告中检索价格(这符合类的主要目的)。请注意，HTML类也可以引用广告部分之外的价格标签(例如，与搜索请求无关但仍显示在结果页面上的特价商品)。然而，出于本文的目的，我们只关注房地产广告中的价格。</p><p id="8b39" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">这就是为什么我们首先定位广告，并且仅在特定于广告的源代码中搜索HTML类:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/e07c2343be32b2f61ebffd95e13d246e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYd27DkUYUn5Lo5Q_bd4rQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">可变价格的输出(图片由作者提供)</p></figure><p id="aa42" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在方法<code class="fe ol om on od b">find()</code>的末尾使用<code class="fe ol om on od b">.text</code>允许我们只返回浏览器中显示的纯文本。如果没有<code class="fe ol om on od b">.text</code>，它将返回该类引用的HTML行的完整源代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/39ae5b04dc2a6a951a705d00eb950f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIFbdocGhyUIlDztrRypNQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不使用的可变价格输出。文本(图片由作者提供)</p></figure><p id="d9b4" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir">重要提示:</strong>我们总是需要提供HTML元素，在本例中是<code class="fe ol om on od b">p</code>。另外，注意不要忘记属性名<code class="fe ol om on od b">class_</code>末尾的下划线。</p><h2 id="f9f0" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">获得具有相同逻辑的其他功能</h2><ol class=""><li id="3984" class="md me iq mf b mg mh mi mj lt mk lw ml lz mm mn os mp mq mr bi translated">检查感兴趣的特征</li><li id="1208" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated">识别相应的HTML类或id</li><li id="1a80" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn os mp mq mr bi translated">使用<code class="fe ol om on od b">find(...).text</code>解码源代码</li></ol><p id="dd45" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">例如，获取地址，HTML类可能如下所示:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="371f" class="lo kx iq od b gy oh oi l oj ok">(...)</span><span id="9bc6" class="lo kx iq od b gy ox oi l oj ok"># find address in ad<br/>address = ad.find('p', class_ =<strong class="od ir"> 'css-address-123456'</strong>).text</span><span id="45f0" class="lo kx iq od b gy ox oi l oj ok"># show address<br/>address</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/aba64273f1c87a176ab0d25486d29d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2XarCnioU9s4Q02e281eg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">变量地址的输出(图片由作者提供)</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="1917" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">2.从一个页面获取所有数据点的逻辑</h1><p id="2e68" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">为了检索所有广告的价格标签，我们应用方法<code class="fe ol om on od b">find.all()</code> <strong class="mf ir"> </strong>而不是<code class="fe ol om on od b">find()</code> <strong class="mf ir"> </strong>来捕捉广告:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="9a7e" class="lo kx iq od b gy oh oi l oj ok"># get all ads within one page<br/>ads = ad.<strong class="od ir">find_all</strong>('p', class_ = 'css-ad-wrapper-123456')</span></pre><p id="b2d9" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">变量<code class="fe ol om on od b">ads</code>现在包含了第一个结果页面中每个适用广告的HTML代码，作为一个列表列表。<em class="nk"> </em>这种存储格式非常有用，因为它允许通过<code class="fe ol om on od b">index</code>访问广告专用源代码:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="cfc8" class="lo kx iq od b gy oh oi l oj ok"># identify how many ads we have fetched<br/>len(ads)</span><span id="e7a2" class="lo kx iq od b gy ox oi l oj ok"># show source code of second ad<br/>print(ads[0])</span></pre><p id="3b56" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">对于最终代码，为了获得所有价格标签，我们使用一个<code class="fe ol om on od b">dictionary</code> <em class="nk"> </em>来收集数据，并通过应用一个<code class="fe ol om on od b">for-loop</code>来迭代广告:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="039a" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir">重要提示:</strong>加入<code class="fe ol om on od b">id</code>可以识别<code class="fe ol om on od b">dictionary</code>中的广告:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="219a" class="lo kx iq od b gy oh oi l oj ok"># show first ad<br/>map[1]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/da15b660b23c659e0f272101f3114dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hqCTRNdESCKqn2fAeFpXHw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">地图[1]的输出(图片由作者提供)</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="2569" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">3.从所有可用的结果页面获取数据点</h1><p id="d7c0" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">典型的基于搜索的平台有分页(点击按钮跳转到下一个结果页面)或无限滚动(滚动到底部以加载新的结果)来浏览所有可用的结果页面。</p><h2 id="241c" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">案例一。网站有分页</h2><p id="2313" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">搜索请求产生的URL通常包含关于当前页码的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/25b1f4b98cbee05ce100b5236f454591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEIFWoHtAGu1TNhP36J72Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">通过URL跳转到下一页(作者插图)</p></figure><p id="d80c" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">从上图可以看出，URL的结尾是指结果的页码。</p><p id="1053" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir">重要提示:</strong>URL中的页码通常从第二页开始可见。使用带有附加片段<code class="fe ol om on od b">&amp;pn=1</code>的基本URL来调用第一页仍然有效(在大多数情况下)。</p><p id="f128" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">在另一个之上应用另一个<em class="nk"> </em> <code class="fe ol om on od b">for-loop</code>允许我们迭代结果页面:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><h2 id="1e9a" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated">识别最后一个结果页面</h2><p id="cec8" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">您可能想知道如何识别最后一个结果页面。在大多数情况下，在到达最后一页后，任何比最后一页的实际数字大的请求都会把我们带回第一页。因此，使用非常大的数字来等待脚本完成是行不通的。过一会儿，它将开始收集重复的值。</p><p id="668c" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">为了解决这个问题，我们可以加入一个逻辑来检查分页按钮中的链接是否适用:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/8b51ef285a5d6363b82bc85758964fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7bvfG4ZRxDLfHRhcYSwcw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按逻辑停刮(作者插画)</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><h2 id="c486" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">案例二。网站有无限滚动</strong></h2><p id="6835" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">如果网站遵循无限滚动的方法，HTML scraper可能没有帮助，因为它需要到达页面底部来加载新的结果。这是HTML抓取器无法模拟的，需要更复杂的方法(例如，<a class="ae kv" href="https://stackoverflow.com/questions/21006940/how-to-load-all-entries-in-an-infinite-scroll-at-once-to-parse-the-html-in-pytho" rel="noopener ugc nofollow" target="_blank"> Selenium </a> —参见本文后面的替代抓取方法)。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="d5e4" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">4.解决信息不一致问题</h1><p id="2538" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">数据从来都不是正确的形式，尤其是在被收集的情况下。正如本文开头提到的，一种可能的情况是，我们看到的价格标签不代表数值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/8addf78908ba910751eec42163c73774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dc4RofaBZ1WUsMKnyZWFvA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">解决信息不一致的问题(作者使用<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片进行说明)</p></figure><p id="8924" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">如果我们想从一开始就避免噪声数据，我们可以采用以下解决方法:</p><ol class=""><li id="466d" class="md me iq mf b mg nl mi nm lt op lw oq lz or mn os mp mq mr bi translated"><strong class="mf ir">定义检测异常的功能</strong></li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="db5f" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 2。在数据采集循环中应用功能</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="121b" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 3。可选:动态数据清理</strong></p><p id="5161" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">您可能已经注意到，由于货币符号和逗号分隔符的存在，价格格式<code class="fe ol om on od b">£ XX,XXX,XXX</code>仍然表示一个字符串值。高效行动，边刮边清洁:</p><p id="adcf" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">定义功能:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="1883" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">将功能并入数据采集<code class="fe ol om on od b">for-loop</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="1436" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated"><strong class="ak"> 5。提取嵌套信息</strong></h1><p id="30f4" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">公共交通部分的特征混合在一起。对于分析，最好分别存储距离、车站名称和运输类型的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5a75e18569321fc3b4bfff4f6136762d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Zysk5nP_ZPl3_CTug3aBw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者插图(<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片用于虚构的列表图片)</p></figure><p id="d7ae" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 1。根据规则提取信息</strong></p><p id="f532" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">如上所示，关于公共交通的每条信息都以这种格式表示:“[数值]英里[站名]。”看看“miles”在这里是如何作为分隔符的，我们可以用它按照这个术语来拆分字符串。</p><p id="3b79" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">总是试图找出一个规则来提取信息，而不是通过最佳猜测来决定。我们可以将逻辑定义如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="9f02" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">最初，变量<code class="fe ol om on od b">transport</code>在一个列表中存储两个列表，因为有两个公共交通信息字符串(例如，“0.3英里斯隆广场”，“0.5英里南肯辛顿”)。我们使用<code class="fe ol om on od b">transport</code>的<code class="fe ol om on od b">len</code>作为索引值来遍历这些列表，并将每个字符串分成两个变量<code class="fe ol om on od b">distance</code>和<code class="fe ol om on od b">station</code>。</p><p id="705f" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 2。搜索附加HTML属性以解码视觉信息</strong></p><p id="854c" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">如果我们深入研究HTML代码，我们会发现一个HTML属性<code class="fe ol om on od b">testid</code>，它揭示了用于显示运输类型的图标的名称(例如，“underground _ station”——见上图)。这些信息作为元数据，不会显示在浏览器视图中。我们使用相应的HTML类<code class="fe ol om on od b">css-StyledIcon</code>来获取这一部分的完整源代码，并添加<code class="fe ol om on od b">testid</code>来提取信息:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="17fc" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">这个例子显示了深入挖掘源代码并注意那些可以揭示对优化web scraper有意义的信息的元数据是多么有用。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="7acf" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">6.转换为数据帧并导出为CSV格式</h1><p id="47fd" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">当抓取任务完成时，所有提取的数据都可以在字典的字典中访问。</p><p id="b9ea" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">为了更好地演示最终的转换步骤，我们先考虑一个广告。</p><p id="1796" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">字典中第一个广告的输出:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="29dd" class="lo kx iq od b gy oh oi l oj ok"># show data of first ad<br/>map[0]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/d797199413ac3955a76a09e4b38fb028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDnBuYYFYRsXj5GJOu6oWw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">地图[1]的输出(图片由作者提供)</p></figure><p id="0ec3" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 1。将字典转换为列表列表以去除嵌套信息</strong></p><p id="2c5b" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">我们将字典转换成列表的列表，这样每个类别只保存一个值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/e0f8dd4e8d0eb78b99f9b871f520ddef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEuzrxm2y0tmE8yIgFOlug.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作为创建数据框的预处理步骤的列表列表(图片由作者提供)</p></figure><p id="e65c" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">看看我们是如何去掉公共交通部分中的多个值，并为第二个公共交通数据点创建一个额外的条目的。这两个条目仍然可以通过我们继承的id <code class="fe ol om on od b">1</code>来识别。</p><p id="4bbe" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated"><strong class="mf ir"> 2。使用列表列表作为输入创建数据框</strong></p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="3a62" class="lo kx iq od b gy oh oi l oj ok">df = pd.DataFrame(<strong class="od ir">result</strong>, columns = ["ad_id", "price", "address",  <br/>                     "distance", "station", "transport_type"])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/6a5ed44a38edffe77ff9537cd6e2bf39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BPLLcF2kSEjXvX6y8PKaaA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用一个广告的最终格式(图片由作者提供)</p></figure><p id="c6a0" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">数据框可以导出为CSV格式，如下所示:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="fa26" class="lo kx iq od b gy oh oi l oj ok"># incorporate timestamp into filename and export as csv<br/>filename = 'test.csv'<br/>df.to_csv(filename)</span></pre><h2 id="2c08" class="lo kx iq bd ky lp lq dn lc lr ls dp lg lt lu lv li lw lx ly lk lz ma mb lm mc bi translated"><strong class="ak">将所有广告转换成数据帧的转换</strong></h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="2319" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">我们成功了！这是最后一步。您已经制造了第一台铲运机，可以进行测试了！</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="d7e8" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">7.HTML抓取的局限性和替代方法</h1><p id="4382" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">这个例子显示了HTML抓取对于标准情况是多么简单。对图书馆文献的广泛研究并不是真正必要的。相反，它需要创造性思维，而不是复杂的web开发经验。</p><p id="1ca3" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">然而，HTML刮刀也有downsides⁴:</p><ul class=""><li id="6376" class="md me iq mf b mg nl mi nm lt op lw oq lz or mn mo mp mq mr bi translated">只能访问在调用URL时直接加载的HTML代码中的信息。需要JavaScript和Ajax加载内容的网站将无法工作。</li><li id="8c70" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">由于网站更新(例如，新功能、网站重新设计)，HTML类或id可能会发生变化。</li><li id="297c" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">无法将用户内容传输到网站，如搜索词或登录信息(除了可以合并到URL中的搜索请求，如示例所示)。</li><li id="a840" class="md me iq mf b mg ms mi mt lt mu lw mv lz mw mn mo mp mq mr bi translated">如果请求对网站来说是异常的(例如，在短时间间隔内有非常多的请求)，则很容易被检测到。这是通过定义速率限制(例如，在特定时间内仅允许执行有限数量的动作)或其他指示符(例如，屏幕大小或浏览器类型)来防止的，以便识别真实用户。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5dd076954f1f6ed8108961a29f87fb88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_SMze43hr4OnSd9YrfkPA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">替代刮擦methods⁴概述(作者插图)</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="4bab" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated"><strong class="ak">了解如何将一个简单的网页抓取脚本转换成基于云的数据管道</strong></h1><p id="fe45" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">下一步，我们可以将这个脚本变成一个数据管道，自动触发抓取任务并将结果传输到数据库——一切都以基于云的方式进行。</p><p id="d0f0" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">第一步是为一个广告创建或标识一个完全唯一的id。例如，这将允许取回的广告被重新收集和匹配以运行历史价格分析。</p><p id="16c3" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">如何实现这一点，以及在云环境中部署数据管道需要哪些技术步骤，将在下一篇文章中讨论。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/644c0e63fc7346dc1252cca422f35880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MM8mdu0LXZI_dAtu96WxyQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用AWS和Airflow构建数据管道(作者使用<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>图片进行说明)</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="d9bd" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">GitHub知识库</h1><p id="fb23" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated"><a class="ae kv" href="https://github.com/christopherkindl/web-scraper-template" rel="noopener ugc nofollow" target="_blank">https://github.com/christopherkindl/web-scraper-template</a></p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="f8cf" class="kw kx iq bd ky kz nx lb lc ld ny lf lg jw nz jx li jz oa ka lk kc ob kd lm ln bi translated">参考</h1><p id="7045" class="pw-post-body-paragraph mx my iq mf b mg mh jr mz mi mj ju na lt nb nc nd lw ne nf ng lz nh ni nj mn ij bi translated">[1]:托尼·保罗。(2020).网络抓取合法吗？2021年指南<a class="ae kv" href="https://www.linkedin.com/pulse/web-scraping-legal-guide-2021-tony-paul/?trk=read_related_article-card_title" rel="noopener ugc nofollow" target="_blank">https://www . LinkedIn . com/pulse/we B- scraping-legal-guide-2021-Tony-Paul/？trk = read _ related _ article-card _ title</a>。检索于2021年5月10日。</p><p id="6fae" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">[2]:W3schools.com。(2021).https://www.w3schools.com/html/html_classes.asp的HTML类属性<a class="ae kv" href="https://www.w3schools.com/html/html_classes.asp" rel="noopener ugc nofollow" target="_blank"/>。检索于2021年5月10日。</p><p id="5b6f" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">[3]:GeeksforGeeks.org。(2021).HTML中id和class的区别？<a class="ae kv" href="https://www.geeksforgeeks.org/difference-between-an-id-and-class-in-html/#:~:text=Difference%20between%20id%20and%20class,can%20apply%20to%20multiple%20elements" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/Difference-between-an-id-and-class-in-html/#:~:text = Difference % 20 between % 20id % 20 and % 20 class，can % 20 apply % 20 to % 20 multiple % 20 elements</a>。检索于2021年5月10日。</p><p id="55c5" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">[4]: JonasCz。(2021).如何防止刮网<a class="ae kv" href="https://github.com/JonasCz/How-To-Prevent-Scraping" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/html/html_classes.asp</a>。检索于2021年5月10日。</p><p id="470f" class="pw-post-body-paragraph mx my iq mf b mg nl jr mz mi nm ju na lt nn nc nd lw no nf ng lz np ni nj mn ij bi translated">[5]:爱德华·罗伯茨。(2018).网页抓取是否违法？要看这个词是什么意思<a class="ae kv" href="https://github.com/JonasCz/How-To-Prevent-Scraping" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/html/html_classes.asp</a>。检索于2021年5月10日。</p></div></div>    
</body>
</html>