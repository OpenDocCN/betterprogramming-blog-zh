<html>
<head>
<title>Build a Python Web Application to Convert a Video to a Gif Using Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Python Web应用程序，使用Streamlit将视频转换为Gif</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-web-application-to-convert-a-video-to-a-gif-using-streamlit-2ab3b377eac1?source=collection_archive---------16-----------------------#2022-04-04">https://betterprogramming.pub/building-a-web-application-to-convert-a-video-to-a-gif-using-streamlit-2ab3b377eac1?source=collection_archive---------16-----------------------#2022-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b8fd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用MoviePy和Streamlit将视频转换为GIF的简单而有趣的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/be36664c66b43b656bb98c2dc1ba0d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7hFQx8Ch0NrKJTv2j9QOA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><p id="bb58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几个月前，我尝试了很多网站将视频转换成gif，但我没有找到任何令人满意的解决方案来编辑和转换视频，而不会变得疯狂。突然发现了MoviePy，一个专门做视频剪辑的python库。它允许执行许多基本的编辑操作，如视频剪切、拼接和更改fps。</p><p id="000b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同时，我想有一个直观的界面来创建一个gif文件，而不是每次修改和运行脚本。出于这个原因，我利用了Streamlit，这是一个神奇的工具，它允许使用Python创建应用程序，只需几行代码。</p><p id="6f30" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我将向您展示如何以有效的方式利用这个令人惊叹的Python库。</p><h1 id="7e08" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">什么是Streamlit？</h1><p id="4816" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">Streamlit是一个免费的开源框架，允许在几分钟内创建web应用。该平台的优势在于:</p><ul class=""><li id="befa" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">它简单易用</li><li id="9367" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">不需要前端经验</li><li id="9bc2" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">不需要HTML的知识</li><li id="b755" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">几行代码构建了一个漂亮的应用程序</li><li id="3026" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">它和Python库一起工作，比如pandas，Tensorflow，Pytorch</li></ul><p id="bcd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要深入了解，查看这篇帮助你掌握<a class="ae nf" href="https://towardsdatascience.com/coding-ml-tools-like-you-code-ml-models-ddba3357eace" rel="noopener" target="_blank"> Streamlit </a>基础知识的帖子。此外，Streamlit有一个华丽的<a class="ae nf" href="https://streamlit.io/gallery" rel="noopener ugc nofollow" target="_blank">图库</a>，里面有许多数据科学项目的应用示例。</p><h1 id="cb76" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">什么是MoviePy？</h1><p id="22cc" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">MoviePy是一个处理视频的Python模块。它允许编辑视频的有用功能，如:</p><ul class=""><li id="8158" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">subclip(start,end)</code>返回开始和结束时间之间的剪辑</li><li id="5156" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">resize(clip)</code>调整剪辑的<code class="fe ng nh ni nj b">width</code> <em class="nk">和</em> <code class="fe ng nh ni nj b">height</code>的大小</li><li id="c740" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">concatenate_clips([clip1,clip2,...])</code>把不同的片段放在一起</li><li id="5477" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">crop(clip,x1=None,x2=None,y1=None,y2=None,width=None,height=None)</code>返回函数中指定的剪辑的裁剪区域</li><li id="948d" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">write_gif(clip,fps=None)</code>将视频转换成GIF格式，其中fps是每秒的帧数</li></ul><p id="4db0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这只是这个库可以对视频做些什么的一小部分列表。查看<a class="ae nf" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank">官方网页</a>了解更多关于<code class="fe ng nh ni nj b">moviepy</code>的信息。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="7d8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">目录</strong></p><ol class=""><li id="5892" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt ns mx my mz bi translated"><strong class="la iu">先决条件</strong></li><li id="4b90" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt ns mx my mz bi translated"><strong class="la iu">转换器应用</strong></li><li id="a20b" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt ns mx my mz bi translated"><strong class="la iu">额外功能</strong></li></ol></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="3124" class="lu lv it bd lw lx nt lz ma mb nu md me jz nv ka mg kc nw kd mi kf nx kg mk ml bi translated">1.先决条件</h1><p id="bdb1" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在本教程中，我建议您使用Visual Studio代码作为IDE，因为它有一个直观的界面，通过安装扩展支持多种语言，并集成了一个终端。要开始使用Visual Studio代码，请查看本<a class="ae nf" href="https://code.visualstudio.com/docs/languages/python" rel="noopener ugc nofollow" target="_blank">指南</a>。一旦决定了要使用的代码编辑器并完成了安装，就该安装两个库了:</p><pre class="kj kk kl km gt ny nj nz oa aw ob bi"><span id="4229" class="oc lv it nj b gy od oe l of og">pip install streamlit<br/>pip install moviepy</span></pre><p id="62e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们尝试构建一个简单的app，打印“将视频转换为GIF”:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="f718" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如您所推断的，方法<code class="fe ng nh ni nj b">title</code>用于以标题格式显示文本。下一步是以如下方式在终端上运行代码:</p><pre class="kj kk kl km gt ny nj nz oa aw ob bi"><span id="09b8" class="oc lv it nj b gy od oe l of og">streamlit run &lt;filename.py&gt;</span></pre><p id="9350" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它返回本地URL和网络URL。点击这些链接中的一个，然后，应用程序将自动在浏览器的新标签中打开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/e3779f6881ad3ba8ef23a4875b0be36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ddav4eESgQyU6zwv1-67ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><p id="3b9e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Streamlit的另一个重要特性是由<a class="ae nf" href="https://docs.streamlit.io/library/api-reference/widgets" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">输入小部件</strong> </a>提供的，它允许您使用按钮、数字输入、滑块和其他选项在web应用程序中进行交互。例如，让我们从文件系统上传一个文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/bbecad9e1316fad632c29f648ba47293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-KxiwzkMybNGzChGs7ze9Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><h1 id="1df1" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">2.转换器应用程序</h1><p id="2941" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">目标是建立一个应用程序，简单地将mp4文件转换成GIF文件。为了处理视频，我们使用了用于视频编辑的python库<code class="fe ng nh ni nj b">MoviePy</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b6873903f7b544f1cbffc6615a9e3dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2NJBngDdGJcYVFzOdBA1xw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><ul class=""><li id="3735" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">我们通过在第13行指定<code class="fe ng nh ni nj b">st.sidebar</code>从侧边栏上传文件</li><li id="c74f" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">st.video</code>允许在第16行显示视频</li><li id="a35e" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">我们在第21行创建了一个带有moviepy的视频剪辑</li><li id="847f" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">函数<code class="fe ng nh ni nj b">cut_video()</code>在第22行被调用。它用于在预定的秒范围内剪切视频，在这个范围内，我们在输入小部件中指定数字。功能<code class="fe ng nh ni nj b">st.sidebar.number_input()</code>显示数字输入小工具，而<code class="fe ng nh ni nj b">subclip</code>在之前选择的两个极端之间剪切视频。</li><li id="4eed" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">write_gif</code>最后在第24行将mp4文件转换成GIF文件。</li><li id="5133" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><code class="fe ng nh ni nj b">st.download_button</code>显示按钮小部件，允许我们下载web应用程序获得的GIF文件。</li></ul><h1 id="101b" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">3.额外功能</h1><p id="0b93" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">该应用程序非常必要和简单。通过添加一个小部件来选择每秒帧数并显示获得的gif，可以实现进一步的改进:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/7e1608c43bc9f3a9e480e47b73c6b6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*H3PGfRTnDO2m1DRut6SJyw.gif"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><ul class=""><li id="49e6" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">在第33行，我们添加了另一个输入小部件来指定每秒的帧数。视频的帧数越少，视频的变化就越小。</li><li id="f6d2" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">在最后一行，我们调用函数<code class="fe ng nh ni nj b">download_gif</code>，它包含对获得的GIF的<code class="fe ng nh ni nj b">st.markdown</code>，以及下载按钮的前一个函数。</li></ul><h1 id="29f2" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">最后的想法</h1><p id="997e" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">恭喜你！将视频转换成GIF文件的web应用程序已经准备好了。正如我所承诺的，只用几行代码就可以做到这一点。它展示了Streamlit如何适用于为不同目的构建快速而简单的web应用程序，例如创建漂亮的仪表板、进行模型预测以及许多其他目的。GitHub代码在这里是<a class="ae nf" href="https://github.com/eugeniaring/Medium-Articles/tree/main/Web%20Apps/convert-video-to-gif-app" rel="noopener ugc nofollow" target="_blank"/>，而我部署的应用程序的链接在这里是<a class="ae nf" href="https://eugeniaring-streamlit-mp4-to-gif-convert-to-gif-x6bf07.streamlitapp.com/" rel="noopener ugc nofollow" target="_blank"/>。感谢阅读。祝您愉快！</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="7f44" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你喜欢我的文章吗？<a class="ae nf" href="https://eugenia-anello.medium.com/membership" rel="noopener"> <em class="nk">成为会员</em> </a> <em class="nk">每天无限获取数据科学新帖！这是一种间接的支持我的方式，不会给你带来任何额外的费用。如果您已经是会员，</em> <a class="ae nf" href="https://eugenia-anello.medium.com/subscribe" rel="noopener"> <em class="nk">订阅</em> </a> <em class="nk">每当我发布新的数据科学和python指南时，您都会收到电子邮件！</em></p></div></div>    
</body>
</html>