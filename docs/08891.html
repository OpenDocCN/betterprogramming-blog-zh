<html>
<head>
<title>How to Implement a WYSIWYG Editor in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中实现所见即所得编辑器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-implement-a-wysiwyg-editor-in-swiftui-c60236749943?source=collection_archive---------6-----------------------#2021-06-23">https://betterprogramming.pub/how-to-implement-a-wysiwyg-editor-in-swiftui-c60236749943?source=collection_archive---------6-----------------------#2021-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d59b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过结合UIKit和SwiftUI，在您的iOS应用程序中实现富文本编辑器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7e9c4edff950ab0e845a1ddd8773d074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xm6ZdaYIOW8rjiSZWBnPcg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@trommelkopf?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">史蒂夫·哈维</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="89bd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="0c16" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于我上一个SwiftUI项目，我想实现一个WYSIWYG编辑器。我已经开始在网上搜索，但没有在SwiftUI上找到合适的实现。网上连一个都没有！</p><p id="4b18" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我决定在SwiftUI上使用<code class="fe ms mt mu mv b"><a class="ae ky" href="https://developer.apple.com/documentation/swiftui/uiviewrepresentable" rel="noopener ugc nofollow" target="_blank">UIViewRepresentable</a></code>实现UIKit上最强的富文本编辑器库之一。幸运的是，在SwiftUI中为UIView创建自定义包装器并不难。</p><p id="242b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我选择工作的图书馆是凯撒·沃思的<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/cjwirth/RichEditorView" rel="noopener ugc nofollow" target="_blank">RichEditorView</a></code>。<code class="fe ms mt mu mv b">RichEditorView</code>是一个简单的、模块化的、用于富文本编辑的嵌入式UIView子类。</p><p id="8f26" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我将跳过安装部分—使用<a class="ae ky" href="https://github.com/cjwirth/RichEditorView#installation" rel="noopener ugc nofollow" target="_blank">此链接</a>中的说明来安装库。</p><h1 id="8a63" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第一步</h1><p id="5267" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，让我们创建一个名为RichTextEditor.swift的初始文件，并实现以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="13fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，我们已经导入了<code class="fe ms mt mu mv b">RichEditorView</code>库和SwiftUI。然后，我们实现了我们的协议所需的两个方法。</p><p id="f93a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还定义了一个存储HTML文本的变量<code class="fe ms mt mu mv b">@Binding</code>，可以在存储数据的属性(<code class="fe ms mt mu mv b">UIViewRepresentable</code>)和显示并更改数据的视图(<code class="fe ms mt mu mv b">SwiftUI View</code>)之间创建双向连接。</p><p id="1b31" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在创建<code class="fe ms mt mu mv b">UIView</code>对象并配置其初始状态的<code class="fe ms mt mu mv b">makeUIView</code>函数中，我们已经为存储的HTML文本分配了初始的<code class="fe ms mt mu mv b">RichEditorView</code>。</p><h1 id="2229" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤2(可选)</h1><p id="7ede" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">然后我们实现了我们的<code class="fe ms mt mu mv b">Coordinator</code>类。在这里，我不会深入探讨协调者，但首先你可以看看保罗·哈德森的这个很棒的教程。</p><p id="57a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="my">简而言之，SwiftUI的协调器旨在充当UIKit视图控制器的代表。请记住，“委托”是对其他地方发生的事件做出响应的对象。</em></p><p id="25fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们在这里使用了Coordinator类来访问<code class="fe ms mt mu mv b">RichEditorDelegate</code>的<code class="fe ms mt mu mv b">richEditorTookFocus</code> &amp; <code class="fe ms mt mu mv b">richEditorLostFocus</code>，并在我们的富文本编辑器开始/结束编辑时切换一个布尔值，这样我们就可以在SwiftUI视图中显示/隐藏一些视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d692" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们实现了嵌套的协调器类，但是它<em class="my">不需要</em>是嵌套类。然而，这是一个好主意，因为它巧妙地封装了功能。</p><h1 id="667c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第三步</h1><p id="3814" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这里，我们将添加工具栏，以便在用户开始编辑所见即所得编辑器时启用编辑选项。该库准备了一个名为<code class="fe ms mt mu mv b">RichEditorToolbar</code>的默认工具栏选项，可用于在编辑时显示在用户键盘的顶部:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/2b354168ca4f3a4c18d925d6b7f416b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWQupQlGykvyeqpaJ82sVQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe ms mt mu mv b">RichEditorToolbar example</code></p></figure><p id="4bd7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里我们从第36行到第38行添加了默认的工具栏代码。在第40行，我们将它分配给了编辑器的视图输入附件，因此它将显示在键盘的顶部。这里我们使用了工具栏的所有可用选项，但是您可以传递一个包含您想要的选项的数组(默认选项可以立即使用，例如<code class="fe ms mt mu mv b">RichEditorDefaultOption.bold</code>):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="bf37" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第四步</h1><p id="f737" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们的UIView表示已经完成，我们可以在SwiftUI视图中使用它了。如您所见，我们定义了两个<code class="fe ms mt mu mv b">@State</code>属性包装器，允许我们修改视图内部的值，并将它们传递给我们的<code class="fe ms mt mu mv b">RichTextEditor</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="03c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">全部完成！在模拟器中运行应用程序，您应该会看到如下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/61aa00ac013dceec103f7cf39ead3c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/1*XVKfArwyJv-qMi9ckH0QSQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终输出</p></figure><h1 id="ecdd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">包扎</h1><p id="79d5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当使用SwiftUI开发应用程序时，也缺少一些有用的视图或功能，但不要忘记，您可以随时使用<code class="fe ms mt mu mv b">UIViewRepresentable</code>或<code class="fe ms mt mu mv b">UIViewControllerRepresentable</code>的功能。此外，不要忘记苹果正在SwiftUI的每个新版本中添加如此多的新功能。</p><p id="2314" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读！我希望这有所帮助。如果你有任何问题，请随时回复。</p></div></div>    
</body>
</html>