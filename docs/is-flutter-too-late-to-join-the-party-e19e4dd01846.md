# 颤振是不是太晚了？

> 原文：<https://betterprogramming.pub/is-flutter-too-late-to-join-the-party-e19e4dd01846>

## 跨平台技术已经日薄西山了吗？

![](img/dd72b5c134d5d617c252fa16890de9e2.png)

由[大卫·蒙涅](https://unsplash.com/@davidmonje?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

让我们回到 2018 年 6 月 20 日。我们都年轻两岁，还没有人谈论全球疫情(这一部分特别好，尽管，我想我们当时没有意识到*有多好*)。

[Airbnb 宣布，他们将逐渐停止在应用程序中使用 React Native](https://medium.com/airbnb-engineering/sunsetting-react-native-1868ba28e30a)，转而全力打造原生体验。在那之前，他们是充分利用脸书移动开发框架的众多公司之一。一个月后， [Udacity 停止了对 React Native 的实验，并决定不再继续。](https://engineering.udacity.com/react-native-a-retrospective-from-the-mobile-engineering-team-at-udacity-89975d6a8102)

最近，本地开发一点也没有停滞。最近，苹果发布了广受好评的 SwiftUI，安卓也对其原生工具集进行了改进。因此，原生开发的情况从来没有这么好过，只是受到一个问题的阻碍，即编写应用程序`n` 次的行为，其中`n`是您希望您的应用程序运行的平台数量。

不难理解为什么会有这么多跨平台框架。为多个平台多次编写相同的应用程序似乎违反了软件开发的核心原则之一，即不要重复自己。但是用一种语言编写一个应用程序，并将其部署到多个目标，如 iOS 或 Android，总是会有妥协。在我们回到 [Flutter](https://flutter.dev/) 之前，让我们先来看看其中的一些技术。

## 一开始，有科尔多瓦

我知道 Cordova 最初是 PhoneGap，我也知道跨平台开发的概念可以追溯到 Java 以及更早的时候，但是您不想阅读一篇关于跨平台软件开发的完整的 20，000 字的文章(我也不想写)，所以 Cordova 似乎是一个不错的起点。

当 Cordova 在 2009 年首次发布时，网络正处于全盛时期。仅仅几年后，HTML5 发布了，当时的想法是，如果你知道 HTML 和 JavaScript，你就可以构建一个相当引人注目的手机应用程序。如果你是一个非常有才华的开发人员，并且了解你所针对的平台的细微差别，这将是真的。如果你的业务主要面向网络，而你需要一个手机应用程序，你难道不会利用你的网络开发者的现有知识来开发一个应用程序，而不是雇佣另一个 iOS 和 Android 开发者吗？

不幸的是，发布了很多看起来很糟糕或者表现很糟糕的应用。通过 Cordova 创建具有原生功能的微型网站是真正创造原生体验的拙劣替代品。一些应用程序甚至非常糟糕，用户可以选择应用程序中的文本(就像他们在一个普通的网页上一样)，或者捏放应用程序中不是为它设计的部分，等等。

随着时间的推移，我们有了其他先进的技术，如 Ionic，它也使用了 Cordova，并提供了一个更强大的框架来构建你的应用程序，但与在你的手机上托管一个可以访问本机组件的微型网站相关的核心问题占据了上风。除了可用性，最大的问题是 ***的性能。*** 在设备上使用 HTML 和 JavaScript 作为应用程序通常会导致性能低下。

> 如果你的业务主要面向网络，你需要一个手机应用程序，你会不会更愿意利用你的网络开发者的现有知识来开发一个应用程序，而不是雇佣另一个 iOS 和 Android 的开发者呢？

## 然后，有了 Xamarin

2013 年，Xamarin Native 出来了，不久之后，Xamarin Forms 也出来了。这对于那些已经掌握了 C#和 C #的知识和经验的人来说尤其诱人。因为他们现在也可以开发手机应用了。从理论上讲，这是一个巨大的成功。你可以使用 C#，一种成熟的高级语言，你可以在 XAML 设计你的用户界面。有一段时间，实际制作 Xamarin Forms 应用程序的高昂入门成本是一个障碍，但后来[微软收购了 Xamarin](https://blogs.microsoft.com/blog/2016/02/24/microsoft-to-acquire-xamarin-and-empower-more-developers-to-build-apps-on-any-device/) 并制作了它，这样任何人都可以开发一个成熟的企业应用程序，而无需支付许可费用。

理论上，这是一个不可思议的提议。听起来好像你只是按了一下开关，突然之间，每个懂 C#和一点 Windows 演示框架(WPF)或 UWP(通用 Windows 程序)的人都可以创建一个手机应用程序。更好的是，他们可以创建一个本地的手机应用程序——不使用 HTML 或 JavaScript。性能也会很好，因为应用程序本身将以接近本地的速度运行。

我敢肯定，许多人用 Xamarin 取得了令人难以置信的成功，即使如此，许多人今天仍在使用它。但以我的经验来看，Xamarin 也有自己的问题。性能还可以，但是在 XAML 设计 UI 并不是一次直观或愉快的经历。所有的默认控件都平淡无奇，近乎丑陋，如果你想改善它们的外观，你必须编写一个自定义的渲染器。

顾名思义，这些平台实现是基于平台的，所以如果你想要一个漂亮的渐变盒子或其他东西，你必须在 iOS、Android 甚至通用 Windows 上编写自定义渲染器。更糟糕的是，每个平台都有不同的语言，通过绑定库映射到 C#上。这意味着即使你找到了获得你想要的效果的方法，你也必须用 C#手动重写。这已经够糟了，但是如果你不知道 Swift 或 Kotlin，你最终会试图从一种你不知道的语言翻译成你知道的语言，这可能会有很差的结果。

> (Xamarin Forms)的表现还可以，但是在 XAML 设计 UI 并不是一个直观或愉快的体验。所有的默认控件都平淡无奇，近乎丑陋，如果你想改善它们的外观，你必须编写一个自定义的渲染器。

## 我们也有本土反应

我敢说，React Native 已经成为最流行的跨平台本机实现之一。它允许开发人员呈现本地视图，并让这些视图通过桥与跨平台 JavaScript 后端对话。我实际上并没有过多地使用 React Native。我不喜欢视图的声明方式，而且在我使用它的时候，JavaScript 是唯一受支持的语言，所以类型安全没有包括在内。后来，对打字稿的支持变成了 React Native，但我个人并不喜欢用 JSX 或 TSX 视图模板来布局我的应用程序。毫无疑问，React Native 拥有大量的开发人员，所以很明显，很多人更喜欢用 React Native 来创建他们的应用程序。

# 然后扑了过来

2018 年 12 月，Flutter 首次稳定发布。现在，让我们诚实面对自己。我不知道，可能有成千上万的开发人员已经知道了一个跨平台的框架，或者非常乐意使用本地实现。所以，实际上，在公众舆论的法庭上，颤振实际上是在一个非常糟糕的时间出现的。我为什么这么说？

## 人们已经对跨平台解决方案有了看法

有如此多的人使用跨平台解决方案，不可避免地会有很多关于已经存在的东西的意见。很多时候，这些意见都是负面的:它们很慢，它们不能正常工作，你必须牺牲太多才能获得可靠的体验。这些批评是正确的，并且在跨平台领域已经存在很长时间了。有了 Xamarin，我甚至体验过让我的应用程序在调试中完美工作，然后在我尝试发布版本时崩溃到桌面。我还在我的工作场所推动跨平台开发，被告知我们将开发一个原生应用程序。

## 人们已经选择了一个框架

如果有人愿意接受跨平台开发*可以*工作的想法，那么很有可能他们已经选择了他们喜欢的框架，并且目前正在使用它来构建他们的应用。为了让他们改变，情况必须是令人信服的。你为什么要放弃你已经熟悉的语言或框架呢？你要从*转移到*的东西会好得多。

> 有如此多的人使用跨平台解决方案，不可避免地会有很多关于已经存在的东西的意见。很多时候，这些观点都是负面的。

## 你不能带任何东西

要学扑，需要学[镖](https://dart.dev/)。你不能带着你的 JavaScript，C#，Kotlin，或者任何其他语言。Dart 与这些语言有很多共同之处，进行这种转移并不太难，但是开发人员学习 Dart 的理由必须令人信服。开发人员不是那种心血来潮学习新的深奥语言的人——他们意识到每种语言都需要时间来学习，甚至需要更多的时间来掌握。

## 它会持续很久吗？

在 Flutter 登陆之前，Dart 实际上是一种死语言。我知道谷歌的人在他们的一些应用程序中使用它，但事实是 TypeScript 是更受欢迎和广泛使用的语言。[2018 年被评为最难共事的语言](https://www.codementor.io/blog/worst-languages-to-learn-3phycr98zk)。显然，随着 Flutter 的流行，这种情况最近已经发生了变化，但谷歌也有一个杀死用户和开发者都喜欢的产品的习惯。因此，对 Flutter 是否会在两年后存在的担忧——知道谷歌的记录——是有道理的。

因此，我们已经看到了跨平台开发在过去几年中遇到的问题，也考虑了 Flutter 本身的一些潜在问题。还值得考虑吗？

# Flutter 如何堆叠？

所以，为了让 Flutter 在这场比赛中有一匹马，以下条件必须成立:

1.  它必须好到让你乐于学习一门全新的语言(Dart)。
2.  它必须在这一领域提供比现有参与者更多的东西。
3.  由于您放弃了多年的资源和技术文档来使用它(因为它出现的时间比它的同类产品短得多)，这种牺牲是值得的。
4.  你应该对它的未来充满信心。

我所能做的就是反思我自己的亲身经历，基本上就是我在来 Flutter 之前做了 Cordova，Ionic，Xamarin 形式的应用。所以我们来过一遍这几点。

## 值得学飞镖

我知道，我知道。学习一门新语言很难。对于我们这些已经有这么多语言在脑子里打转的开发人员来说就更难了，*对于那些除此之外还必须插入各种 shell 脚本语言的全栈人员来说就更难了。但我觉得值得学 Dart。我使用过 C#、TypeScript、JavaScript 等等，我觉得 Dart 是一种漂亮的、富有表现力的语言。*

Dart 在某种程度上比这一领域的许多其他玩家更容易使用，同时在某种程度上与他们一样强大，如果不是更强大的话。这篇文章并不适合讨论 Dart 操作符，但是 Dart 让我操作列表的方式比现在 C#中的任何方式都要先进好几年。

它还用一定程度的冗长来换取约定俗成。例如，您可以通过在字段前添加下划线来使其成为私有字段。无前缀字段是公共的。还有一些我很喜欢的小变化，比如去掉了`new`操作符。要创建一个新的对象，你只需要用需要的参数调用构造函数，就这样。这听起来像是一个简单的改变，但是它让你意识到`new`操作符是多余的，并没有给你写的代码增加任何东西。我发现 Dart 充满了这些语法上的惊喜，让编写代码变得更愉快、更快捷。

> 学习一门新语言很难。但我觉得值得学 Dart。

## 它有很多优点

在互联网上宣称一种语言或框架比另一种语言或框架“更好”可能不是最好的主意。这是开始吵架的好方法。在我个人看来，我发现 Flutter 比目前存在的任何其他跨平台解决方案都有更多的优势。我这样说是出于以下原因:

**对应用内视觉效果的出色控制**。因为 Flutter 直接渲染到屏幕上并控制屏幕的每个像素(很像游戏引擎)，所以您可以完全控制渲染到屏幕上的内容。同时，它还有一个`CustomPaint`类，可以让你在屏幕上画任何你想画的东西。当你考虑到 Flutter 支持 Android 和 iOS——然后是测试版——Web、Windows、macOS，以及更多其他平台时，这就变得非常惊人了。

事实上，我可以创建一个看起来“以某种方式”渲染的渐变，无论它在什么平台上执行，都是非常令人印象深刻的。它有助于在各种平台上获得大量身临其境的美妙体验。我只在 Flutter 中发现了无需编写特定于平台的代码就能在屏幕上呈现某些内容的能力。当然，该框架附带了一套令人难以置信的现成小部件，您可以随意使用这些小部件，但也可以深入细节，并在您需要非常特殊的外观或感觉时自己呈现一些自定义控件。

**本土表演。** Flutter 为其运行的 iOS 或 Android 设备开发了一款原生应用。结合谷歌让每个应用程序以 60FPS 运行的努力，这意味着应用程序使用起来非常流畅。甚至在 Flutter 呈现一个`ListView` 的方式中，意味着列表中的[项只有在它们被滚动到视图](https://flutter.dev/docs/cookbook/lists/long-lists)中时才被呈现，这保持了高水平的性能和设备上较低的内存使用量。你不需要做任何复杂的数学运算来判断列表项在设备上是否可见，Flutter 会帮你算出来。

**伟大的国家管理选择。当你在开发一个更大的应用程序时，不可避免地，你可能需要选择一个框架来构建，而不是仅仅依赖于原生框架给你的任何东西。在 Xamarin 上，这通常是模型视图视图模型(MVVM)的某种变体。在颤振中，通常是块状模式。在用 Xamarin Forms 设计了一个应用程序，然后用 Flutter 重写了同样的应用程序之后，我觉得 BLOC 比我在任何其他框架中使用过的任何东西都更具可扩展性，更易于使用，也更易于测试。**

**它获得了跨平台的平衡。**在 Xamarin 表单中，绝对一切都是 C#，甚至是特定于平台的渲染器实现。不要误解我，我知道 Xamarin 的很多观点是用 C#编写你的平台代码，用 C#编写你的应用程序的共享部分是有意义的。然而，用 C#编写特定于平台的位毫无意义，在我看来，只会使过程变得复杂。

我之所以有这种感觉，是因为在特定于平台的代码中使用什么“正确”的东西会很快变得令人困惑。例如，在 Android 上，你使用的是`List`还是`JavaList`？它们是不可互换的，如果你用错了，最好的情况是你会得到一个类型安全错误，最坏的情况是，你会给你的应用程序带来问题。

当您需要特定于平台的实现时，Flutter 使用平台通道来执行本机代码。因此，您的共享代码是用 Dart 编写的，但是特定于平台的内容是用该平台的本地语言编写的。与此同时，我发现值得一提的是，当我将我的应用程序从 Xamarin Forms 重写为 Flutter 时，我不再需要为某些渲染器等编写特定于平台的代码。到根本不需要它们。同样的任务是由 Flutter 中已有的技术来完成的。当你需要特定于平台的代码时，学习平台本地语言的想法可能有点难以接受，但这比试图通过任何类型的绑定库来使用相同的功能要好得多。

> **绑定库有什么问题？**
> 
> Xamarin 通过所谓的绑定库(binding library)在设备上公开本机功能，该库将本机 API 表面映射到其 C#等效物。这意味着，当您在寻找一种方法来完成您的特定任务时，您通常只会找到该平台的本地语言的结果，而很少会找到已经用 C#为您编写的结果。
> 
> 因此，这意味着您必须将任何功能从其母语(如 Kotlin、Objective-C 或 Swift)重写为 C#。作为一个对这些语言了解有限的跨平台开发人员，您也许最多可以修补 StackOverflow 上的现有修复，但是用不同的语言完全重写它们只是自找麻烦。
> 
> 在 Flutter 中，你可以将特定于平台的代码保留为其母语，根据你的喜好进行调整，然后通过“平台通道”调用它。这些本质上是从本地 Dart 代码到本地平台代码的桥梁。根据我的经验，对于特定于设备的实现来说，这是一种更好的方法。

> 当我把我的应用程序从 Xamarin Forms 重写为 Flutter 时，我不再需要为某些渲染器等编写特定于平台的代码。到根本不需要它们。

## 可用的技术信息数量惊人

每周(或大约每周)，在 Flutter YouTube 频道上，都会有一个新的[“本周小部件”](https://www.youtube.com/playlist?list=PLjxrf2q8roU23XGwz3Km7sQZFTdB996iG)视频，演示如何在 Flutter 中使用某个小部件。这听起来可能就像看着油漆变干一样迷人，但是一些小部件允许真正美丽的动画和交互方式，你可以很容易地在你的应用程序中应用。

像 Codemagic(CI/CD 提供商)这样的其他公司更进一步，也通过[提供其他领域的技术指南](https://blog.codemagic.io/)。以我的经验来看，现在有足够的技术信息来创建大多数应用程序，你可能不会遇到你自己独有的问题。

## 它会一直存在*

(*可能)

[Flutter 构成了谷歌下一代操作系统的 UI 组件，名为 Fuchsia](https://en.wikipedia.org/wiki/Google_Fuchsia) 。如果谷歌杀了 Flutter，他们也会杀了 Fuchsia 的 UI。没有用户界面就不能使用操作系统，所以除非谷歌想出一个全新的框架，让所有人都迁移到这个框架，或者发布一个只有外壳的操作系统，否则他们没有任何东西可以实际使用。所以，我的意思是，当然，谷歌可以杀死 Flutter，但我认为它比他们决定退出搜索引擎业务的可能性略小。如果他们这样做的话，他们实际上是在浪费大约十年的工作成果。

那么，用 Flutter 值得吗？是否值得学习一门全新的语言，放弃其他框架所拥有的其他可用资源，因为它们已经存在了更长时间，并且仅仅为了能够将 Flutter 用作手机应用程序的框架而放弃所有这些资源？在我看来，是的。的确如此。

# 这是一个时机问题

毫无疑问，Flutter 可能是在最糟糕的时候出现的，人们已经对跨平台开发工具包有了负面的看法，并且有这么多公司迁移回原生开发。但 Flutter 确实提供了一些真正独一无二的机会，就我个人而言，我对 Flutter 的持续扩张和发展感到非常兴奋。

我不认为像 Flutter 这样的跨平台框架已经日薄西山，我认为它们将在未来享受丰富的开发。我可能完全错了，但我愿意留下来看看 Flutter 在未来几年的发展方向。

如果你想尝试一下，老实说，这是最好的时机。在我看来，Flutter 目前也有一个比较好的社区，所以不管你有什么样的编码经验，人们通常都很乐于助人，提供很多信息。

玩得开心，享受这一路上的经历😊。