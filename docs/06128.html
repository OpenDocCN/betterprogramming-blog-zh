<html>
<head>
<title>Lazy Loading Images Made Easy in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript使延迟加载图像变得容易</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lazy-loading-images-made-easy-in-javascript-37b0ff91974c?source=collection_archive---------11-----------------------#2020-09-03">https://betterprogramming.pub/lazy-loading-images-made-easy-in-javascript-37b0ff91974c?source=collection_archive---------11-----------------------#2020-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d1f0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">表演</h2><div class=""/><div class=""><h2 id="e87a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用3行代码改进Angular、React或Vue.js应用程序中的图像加载</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/30e0d731dffe7e25f4a260d5389d519b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bgk_ZlrcL650x4Uv"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@titi_wanderer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Thong Vo </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="701e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">构建web应用程序时，我们总是在寻找最佳性能，以便不影响用户体验。</p><p id="93d3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在所有提高网站性能的技术中，图像的延迟加载允许我们推迟图像检索。事实上，根据图像的尺寸、压缩和质量，它可能会影响用户设备下载的包的大小。因此，推迟这些下载有几个好处:</p><ul class=""><li id="5875" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">束尺寸减小</li><li id="7ce0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">用户体验得到改善(捆绑包准备得更快)</li><li id="4108" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">受控的数据消耗(仅下载可见图像)</li></ul><p id="fd9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将引入一个HTML属性来延迟加载图像。为了更进一步，我将展示如何在具有三个主要JavaScript框架的更广泛的应用程序中使用该属性:Angular、React和Vue.js</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="b1f1" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated"><img/>的HTML属性</h1><p id="6083" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">就这么简单:一个名为<code class="fe nw nx ny nz b">loading</code>的单一属性。您可以在此处找到它的文档:</p><div class="oa ob gp gr oc od"><a href="https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading#:~:text=The%20loading%20attribute%20on,element" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">惰性装载</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">惰性加载是一种将资源识别为非阻塞(非关键)的策略，只在需要时加载这些资源。这是一个…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">developer.mozilla.org</p></div></div><div class="om l"><div class="on l oo op oq om or lb od"/></div></div></a></div><p id="3954" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe nw nx ny nz b">loading</code>属性接受三个值:</p><ul class=""><li id="7e64" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><code class="fe nw nx ny nz b">eager</code>:立即加载图像</li><li id="768e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><code class="fe nw nx ny nz b">lazy</code>:推迟图像的加载，直到滚动进度达到距视窗的<a class="ae lh" href="https://web.dev/native-lazy-loading/#distance-from-viewport-thresholds" rel="noopener ugc nofollow" target="_blank">计算距离</a></li><li id="edb0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><code class="fe nw nx ny nz b">auto</code>:应用浏览器提供的默认行为</li></ul><p id="9b4d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">怎么用？就在下面:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><h2 id="2384" class="ou na it bd nb ov ow dn nf ox oy dp nj lr oz pa nl lv pb pc nn lz pd pe np iz bi translated">警告</h2><p id="b4a0" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">但是，使用该属性时要小心。事实上，文档解释说这个特性只有在启用JavaScript时才可用；否则，会导致跟踪问题:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/9024a28a3d04709cfd66dde2a65dc455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4sioRx3jIsfytrV3NXwiQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-loading" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTML/Element/img # attr-loading</a></p></figure><p id="534a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">而且，这个特性标志并不是每个浏览器都启用的，甚至都不支持。幸运的是，<a class="ae lh" href="https://caniuse.com/" rel="noopener ugc nofollow" target="_blank">caniuse.com</a>非常得心应手:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/7ed2a66e34b39e8b7375ad04d6ef4b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x51LJhbg1HZ6n_Bv6oi4gg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://caniuse.com/#feat=loading-lazy-attr" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/#feat=loading-lazy-attr</a></p></figure><p id="a23b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于特定或最早的浏览器不支持该属性，我们可以使用多填充:</p><div class="oa ob gp gr oc od"><a href="https://github.com/mfranzke/loading-attribute-polyfill" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">制造商/加载-属性-聚合填充</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">快速、轻量级、无依赖性的普通JavaScript polyfill，用于本地延迟加载/棒极了…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="ph l oo op oq om or lb od"/></div></div></a></div><h2 id="1b68" class="ou na it bd nb ov ow dn nf ox oy dp nj lr oz pa nl lv pb pc nn lz pd pe np iz bi translated">正在加载属性</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/9d255cfa150423bbe1b94dddd5cb81ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PYYVghnLqVqpawkiodQC1Q.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:作者</p></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="2335" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">在更大范围内使用加载属性</h1><h2 id="d7dc" class="ou na it bd nb ov ow dn nf ox oy dp nj lr oz pa nl lv pb pc nn lz pd pe np iz bi translated">有角的</h2><p id="22ae" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">对于第一个版本，Angular提供了一个强大的方法来处理解决方案中的每一个<code class="fe nw nx ny nz b">&lt;img&gt;</code>行为:一个指令。</p><p id="16ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我不会抢<a class="pj pk ep" href="https://medium.com/u/b889ae02aa26?source=post_page-----37b0ff91974c--------------------------------" rel="noopener" target="_blank"> Netanel Basal </a>的工作，他在文章中描述了如何轻松实现任务:</p><div class="oa ob gp gr oc od"><a href="https://netbasal.com/lazy-load-images-in-angular-with-two-lines-of-code-beb13cd5a1c4" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">用两行代码惰性加载Angular中的图像</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">图像延迟加载延迟加载当前在视口中不可见的图像。这样的形象会…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">netbasal.com</p></div></div><div class="om l"><div class="pl l oo op oq om or lb od"/></div></div></a></div><h2 id="5400" class="ou na it bd nb ov ow dn nf ox oy dp nj lr oz pa nl lv pb pc nn lz pd pe np iz bi translated">反应</h2><p id="0758" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">由于React促进了组件的可重用性，我们将需要创建一个嵌套组件。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="f2c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果不支持<code class="fe nw nx ny nz b">loading</code>，我们可以使用<a class="ae lh" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">交叉点观察器API </a>。您可以在此处找到如何将其集成到React组件中:</p><div class="oa ob gp gr oc od"><a href="https://slashgear.github.io/creating-an-image-lazy-loading-component-with-react/#intersection-observer-for-the-win" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">用React创建图像延迟加载组件</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">在网络世界中，我们经常有复杂的页面结构。起初，所有部件在用户视口中都不可见…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">slashgear.github.io</p></div></div><div class="om l"><div class="pm l oo op oq om or lb od"/></div></div></a></div><h2 id="cd25" class="ou na it bd nb ov ow dn nf ox oy dp nj lr oz pa nl lv pb pc nn lz pd pe np iz bi translated">vue . j</h2><p id="1980" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">最后，Vue.js也通过使用一个指令来遵循Angular的步骤。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="3552" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管我在这里使用了TypeScript，但这并不是强制性的。如您所见，我们只是检查<code class="fe nw nx ny nz b">loading</code>属性是否可用(L6)。然后，如果支持，我们设置属性；否则，有必要使用<a class="ae lh" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">交叉点观察器API </a>。</p><p id="f1cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那么让我们全局注册该指令:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="cbbc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们可以使用带有<code class="fe nw nx ny nz b">v-img-lazy</code>属性的指令<code class="fe nw nx ny nz b">ImgLazyLoading</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="72bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与Angular不同，我们不能在选择器上应用指令。因此，我们需要为每个<code class="fe nw nx ny nz b">&lt;img&gt;</code>手动添加<code class="fe nw nx ny nz b">v-img-lazy</code>。幸运的是，ide具有“在整个解决方案中替换”的功能！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="3f3c" class="mz na it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">资源</h1><div class="oa ob gp gr oc od"><a href="https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading#:~:text=The%20loading%20attribute%20on,element" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">惰性装载</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">惰性加载是一种将资源识别为非阻塞(非关键)的策略，只在需要时加载这些资源。这是一个…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">developer.mozilla.org</p></div></div><div class="om l"><div class="on l oo op oq om or lb od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://netbasal.com/lazy-load-images-in-angular-with-two-lines-of-code-beb13cd5a1c4" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">用两行代码惰性加载Angular中的图像</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">图像延迟加载延迟加载当前在视口中不可见的图像。这样的形象会…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">netbasal.com</p></div></div><div class="om l"><div class="pl l oo op oq om or lb od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">交叉点观察器API</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">交叉点观察器API提供了一种异步观察目标元素交叉点变化的方法…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">developer.mozilla.org</p></div></div><div class="om l"><div class="pn l oo op oq om or lb od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#lazy-loading-attributes" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">HTML规范</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">← 2.4常用microsyntaxes目录- 2.7常用DOM接口→ 2.5.1术语一个字符串是一个有效的…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">html.spec.whatwg.org</p></div></div></div></a></div></div></div>    
</body>
</html>