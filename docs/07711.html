<html>
<head>
<title>Build a PDF Merger in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建PDF合并</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-pdf-merger-in-python-c582607a9d29?source=collection_archive---------10-----------------------#2021-02-11">https://betterprogramming.pub/build-a-pdf-merger-in-python-c582607a9d29?source=collection_archive---------10-----------------------#2021-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b01" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用一个简单的脚本合并多个PDF文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6dcd9fccbb3c7c3d1cbb62122056519f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_v6MvTI3RVhy-Mw0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@cgower?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Christopher Gower </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="4ca0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只是我吗？我喜欢尝试用Python写的又酷又有趣的东西。我写过的最有用的程序之一是PDF合并。灵感来自于需要同时将几个PDF组合在一起，而不覆盖任何现有的PDF资源。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7b69" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们自己做吧！</h1><p id="3a86" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了让我们的生活更容易，我将使用PyPDF2库。下面的GIF展示了使用<code class="fe mz na nb nc b">pip install PyPDF2</code>命令安装库的过程。PyPDF2库处理合并PDF文件的所有复杂工作。当然，我们会给我们的小程序增加一些技巧和华丽。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/8870904d9499f8c7a471317cf815975e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gwka4LheiXl5umQF.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者分享的屏幕。</p></figure><p id="6f61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该库附带了几个有用的工具，如PDF文件阅读器、编写器和合并器。首要任务是弄清楚我们将如何定位不同的PDF资源，并将它们作为参数传递给库。</p><p id="5ecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单起见，我将使用命令行向程序提供输入。从今以后，我将使用sys模块来接受资源的绝对文件路径。绝对文件路径，通常称为完整文件路径，本质上是文件在根目录中的精确位置。<code class="fe mz na nb nc b">sys.argv</code>函数将获取并返回命令行(终端)中输入的所有文件路径的列表。这是一个累积要合并的每个资源的位置的过程。</p><p id="5e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:在下面的代码中，我们将从索引<code class="fe mz na nb nc b">1</code>而不是<code class="fe mz na nb nc b">0</code>开始获取<code class="fe mz na nb nc b">sys.argv</code>的内容。为什么？<code class="fe mz na nb nc b">Sys.argv[0]</code>包含脚本的名称(如<code class="fe mz na nb nc b">pdfMerger.py</code>)。</p><p id="e704" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随后，我们必须从PyPDF2库中导入PDF文件合并。例如，从PyPDF2中，将<code class="fe mz na nb nc b">PdfFileMerger</code>导入为<code class="fe mz na nb nc b">pdfM</code>。</p><p id="57f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，我们必须在导入后实例化<code class="fe mz na nb nc b">pdfFileMerger</code>。比如<code class="fe mz na nb nc b">merger= pdfM()</code> <strong class="lb iu"> <em class="ne"> </em> </strong>既然我们把<code class="fe mz na nb nc b">pdfFileMerger</code>导入为<code class="fe mz na nb nc b">pdfM</code> <strong class="lb iu"> <em class="ne">。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="6b24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段是我们创建小型DIY PDF合并应用程序所需的全部内容。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e58c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">测试</h1><p id="0edb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将按照命令行中输入的顺序合并三个PDF文件。以下三幅图像将被放入单独的PDF文件中，然后合并成一个PDF文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/edbd78c188f5ddb14600fe5103565715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zWKAbL7bfD7qMwjC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@viennachanges?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Vienna Reyes </a>拍摄。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1ce8c67019b211a3ced9fb789d70b291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ebcce1Hf-tRRNMiz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@nicholasjio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">尼克·吉奥</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9daef7cdca058906d2a6368cb05ae233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5KGIailCaivr7aE4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@pankajpatel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pankaj Patel </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="a217" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的GIF演示了使用三个参数执行的应用程序——要合并的PDF文件的绝对文件路径。因此，系统会提示我们为新创建的文件提供一个名称。它将位于当前工作目录(即包含应用程序的文件夹)中。现在我们有了它:一个包含其他文件内容的文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/8978e32f5ab9b828ff73ad4c49345c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PjlyjVLNFqDqCMpb.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">演示应用程序</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/65f3033215965dce92d2a0311b6a2c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*otHhofux6Zfj1G0F.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">描述创建的PDF内容的屏幕截图。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1f68" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="8cf2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">哇！那是一个非常有用的应用，不是吗？</p><p id="9c75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">软件开发可能很有趣——当我们构建并欣赏自己的应用程序时更是如此。今天，我们构建了这个应用程序的一个极简版本，但是为什么要止步于此呢？我们总是可以创建自己的应用程序来满足我们个人的需求。</p><p id="d1ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如上一节所演示的，我们成功地将多个PDF文件合并成一个文件。通过这样做，我们不仅创建了一个有用的工具，而且满足了从本地机器合并多个PDF资源的需求。</p></div></div>    
</body>
</html>