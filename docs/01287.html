<html>
<head>
<title>How to Use Vee-Validate to Do Form Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Vee-Validate进行表单验证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-vee-validate-to-do-form-validation-e01e9c8b6ac6?source=collection_archive---------3-----------------------#2019-08-29">https://betterprogramming.pub/how-to-use-vee-validate-to-do-form-validation-e01e9c8b6ac6?source=collection_archive---------3-----------------------#2019-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f6ca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们做一些令人惊奇的表格</h2></div><p id="7d9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vue.js是构建前端web应用程序的一个很好的框架。它使用基于组件的架构，这使得组织代码变得容易。它允许您使用JavaScript提供的最新功能，这意味着编写代码来构建您的应用程序比以往任何时候都容易。它有很多插件，比如路由和流量存储，你可以在搭建应用时添加。</p><p id="06e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，缺少的一点是表单验证。这意味着我们必须找到自己的表单验证库来进行表单验证，或者自己编写表单验证代码。</p><p id="cace" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们选择使用一个库来做表单验证，<a class="ae le" href="https://baianat.github.io/vee-validate/" rel="noopener ugc nofollow" target="_blank"> Vee-Validate </a>是直接插入Vue.js表单代码来做表单验证的绝佳选择。Vee-Validate primary向Vue.js组件模板添加代码，以启用Vue.js表单的表单验证。它有多种输入的表单验证规则。因此，它是验证Vue.js表单的绝佳选择。</p><p id="fa2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个故事中，我们将使用Vue.js构建一个地址簿应用程序，它使用Vee-Validate来验证我们的输入。该表单允许我们添加和编辑我们的联系人；此外，我们可以获取和删除联系人。</p><p id="ef58" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要构建我们的应用程序，首先，我们需要快速设置一个后端。为此，我们使用一个名为JSON Server的Node.js包来运行我们的后端。在这里找到<a class="ae le" href="https://github.com/typicode/json-server" rel="noopener ugc nofollow" target="_blank">包的文档</a>。</p><p id="5dbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦这是运行，它为我们提供了从前端保存我们的联系条目的路线。</p><p id="5516" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要安装该软件包，请运行:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="c3ff" class="lo lp it lk b gy lq lr l ls lt">npm install -g json-server</span></pre><p id="0399" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将稍后运行此操作，以便保存我们的联系人。</p><p id="0d88" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以开始构建我们的应用程序了。为此，请通过运行以下命令来安装Vue CLI:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="d2fc" class="lo lp it lk b gy lq lr l ls lt">npm install -g @vue/cli</span></pre><p id="eb85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后运行以下命令创建应用程序:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="69c0" class="lo lp it lk b gy lq lr l ls lt">vue create vee-validate-address-book-app</span></pre><p id="473e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">vee-validate-address-book-app</code>是我们的应用程序名称。运行向导时，请确保您选择包括Vuex和Vue路由器，因为我们稍后会用到它们。接下来，我们必须安装一些库。我们需要一个HTTP客户端，一个让我们的应用程序看起来不错的材料设计库，以及Vee-Validate库。</p><p id="6d44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，运行<code class="fe lu lv lw lk b">npm i axios vee-validate vue-material</code>。Axios是我们用于与后端通信的HTTP客户端。Vue材料是我们的材料设计库。</p><p id="a14e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们创建嵌套在页面组件中的组件。为此，在我们的项目文件夹中创建一个<code class="fe lu lv lw lk b">components</code>文件夹，并在其中创建一个名为<code class="fe lu lv lw lk b">ContactForm.vue</code>的文件。</p><p id="0d39" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个文件中，我们放入:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="7135" class="lo lp it lk b gy lq lr l ls lt">&lt;template&gt;<br/>  &lt;div class="contact-form"&gt;<br/>    &lt;div class="center"&gt;<br/>      &lt;h1&gt;{{editing ? 'Edit': 'Add'}} Contact&lt;/h1&gt;<br/>    &lt;/div&gt;<br/>    &lt;form novalidate class="md-layout" <a class="ae le" href="http://twitter.com/submit" rel="noopener ugc nofollow" target="_blank">@submit</a>="save"&gt;<br/>      &lt;md-field :class="{ 'md-invalid': errors.has('firstName') }"&gt;<br/>        &lt;label for="firstName"&gt;First Name&lt;/label&gt;<br/>        &lt;md-input<br/>          name="firstName"<br/>          v-model="contact.firstName"<br/>          v-validate="'required'"<br/>          :disabled="sending"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.has('firstName')"&gt;First Name is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="1713" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="6008" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('lastName') }"&gt;<br/>        &lt;label for="lastName"&gt;Last Name&lt;/label&gt;<br/>        &lt;md-input<br/>          name="lastName"<br/>          v-model="contact.lastName"<br/>          :disabled="sending"<br/>          v-validate="'required'"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.has('lastName')"&gt;Last Name is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="2c40" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="7414" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('addressLineOne') }"&gt;<br/>        &lt;label for="addressLineOne"&gt;Address Line 1&lt;/label&gt;<br/>        &lt;md-input<br/>          name="addressLineOne"<br/>          v-model="contact.addressLineOne"<br/>          :disabled="sending"<br/>          v-validate="'required'"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.has('addressLineOne')"&gt;Address line 1 is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="09af" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="c81a" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('addressLineTwo') }"&gt;<br/>        &lt;label for="addressLineTwo"&gt;Address Line 2&lt;/label&gt;<br/>        &lt;md-input name="addressLineTwo" v-model="contact.addressLineTwo" :disabled="sending" /&gt;<br/>        &lt;span class="md-error" v-if="errors.has('addressLineTwo')"&gt;Address line 2 is required&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="ec07" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="ad10" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('city') }"&gt;<br/>        &lt;label for="city"&gt;City&lt;/label&gt;<br/>        &lt;md-input name="city" v-model="contact.city" :disabled="sending" v-validate="'required'" /&gt;<br/>        &lt;span class="md-error" v-if="errors.has('city')"&gt;City is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="e8d2" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="dad7" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('country') }"&gt;<br/>        &lt;label for="country"&gt;Country&lt;/label&gt;<br/>        &lt;md-select<br/>          name="country"<br/>          v-model="contact.country"<br/>          md-dense<br/>          :disabled="sending"<br/>          v-validate.continues="'required'"<br/>        &gt;<br/>          &lt;md-option :value="c" :key="c" v-for="c in countries"&gt;{{c}}&lt;/md-option&gt;<br/>        &lt;/md-select&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('country', 'required')"&gt;Country is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="aa8c" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="45e5" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('postalCode') }"&gt;<br/>        &lt;label for="postalCode"&gt;Postal Code&lt;/label&gt;<br/>        &lt;md-input<br/>          name="postalCode"<br/>          v-model="contact.postalCode"<br/>          :disabled="sending"<br/>          v-validate="{ required: true, regex: getPostalCodeRegex() }"<br/>        /&gt;<br/>        &lt;span<br/>          class="md-error"<br/>          v-if="errors.firstByRule('postalCode', 'required')"<br/>        &gt;Postal Code is required.&lt;/span&gt;<br/>        &lt;span<br/>          class="md-error"<br/>          v-if="errors.firstByRule('postalCode', 'regex')"<br/>        &gt;Postal Code is invalid.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="d0f3" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="759b" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('phone') }"&gt;<br/>        &lt;label for="phone"&gt;Phone&lt;/label&gt;<br/>        &lt;md-input<br/>          name="phone"<br/>          v-model="contact.phone"<br/>          :disabled="sending"<br/>          v-validate="{ required: true, regex: getPhoneRegex() }"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('phone', 'required')"&gt;Phone is required.&lt;/span&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('phone', 'regex')"&gt;Phone is invalid.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="e7e8" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="0020" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('gender') }"&gt;<br/>        &lt;label for="gender"&gt;Gender&lt;/label&gt;<br/>        &lt;md-select<br/>          name="gender"<br/>          v-model="contact.gender"<br/>          md-dense<br/>          :disabled="sending"<br/>          v-validate.continues="'required'"<br/>        &gt;<br/>          &lt;md-option value="male"&gt;Male&lt;/md-option&gt;<br/>          &lt;md-option value="female"&gt;Female&lt;/md-option&gt;<br/>        &lt;/md-select&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('gender', 'required')"&gt;Gender is required.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="6eeb" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;</span><span id="a833" class="lo lp it lk b gy lx lr l ls lt">&lt;md-field :class="{ 'md-invalid': errors.has('age') }"&gt;<br/>        &lt;label for="age"&gt;Age&lt;/label&gt;<br/>        &lt;md-input<br/>          type="number"<br/>          id="age"<br/>          name="age"<br/>          autocomplete="age"<br/>          v-model="contact.age"<br/>          :disabled="sending"<br/>          v-validate="'required|between:0,200'"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('age', 'required')"&gt;Age is required.&lt;/span&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('age', 'between')"&gt;Age must be 0 and 200.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="833b" class="lo lp it lk b gy lx lr l ls lt">&lt;br /&gt;<br/>      &lt;md-field :class="{ 'md-invalid': errors.has('email') }"&gt;<br/>        &lt;label for="email"&gt;Email&lt;/label&gt;<br/>        &lt;md-input<br/>          type="email"<br/>          name="email"<br/>          autocomplete="email"<br/>          v-model="contact.email"<br/>          :disabled="sending"<br/>          v-validate="'required|email'"<br/>        /&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('email', 'required')"&gt;Email is required.&lt;/span&gt;<br/>        &lt;span class="md-error" v-if="errors.firstByRule('email', 'email')"&gt;Email is invalid.&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="8e12" class="lo lp it lk b gy lx lr l ls lt">&lt;md-progress-bar md-mode="indeterminate" v-if="sending" /&gt;</span><span id="e195" class="lo lp it lk b gy lx lr l ls lt">&lt;md-button type="submit" class="md-raised"&gt;{{editing ? 'Edit':'Create'}} Contact&lt;/md-button&gt;<br/>    &lt;/form&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="ecf2" class="lo lp it lk b gy lx lr l ls lt">&lt;script&gt;<br/>import { COUNTRIES } from "@/helpers/exports";<br/>import { contactMixin } from "@/mixins/contactMixin";</span><span id="9666" class="lo lp it lk b gy lx lr l ls lt">export default {<br/>  name: "ContactForm",<br/>  mixins: [contactMixin],<br/>  props: {<br/>    editing: Boolean,<br/>    contactId: Number<br/>  },<br/>  computed: {<br/>    isFormDirty() {<br/>      return Object.keys(this.fields).some(key =&gt; this.fields[key].dirty);<br/>    },<br/>    contacts() {<br/>      return this.$store.state.contacts;<br/>    }<br/>  },<br/>  data() {<br/>    return {<br/>      sending: false,<br/>      contact: {},<br/>      countries: COUNTRIES.map(c =&gt; c.name)<br/>    };<br/>  },</span><span id="9137" class="lo lp it lk b gy lx lr l ls lt">  beforeMount() {<br/>    this.contact = this.contacts.find(c =&gt; c.id == this.contactId) || {};<br/>  },</span><span id="e041" class="lo lp it lk b gy lx lr l ls lt">  methods: {<br/>    async save(evt) {<br/>      evt.preventDefault();<br/>      try {<br/>        const result = await this.$validator.validateAll();<br/>        if (!result) {<br/>          return;<br/>        }<br/>        if (this.editing) {<br/>          await this.updateContact(this.contact, this.contactId);<br/>          await this.getAllContacts();<br/>          this.$emit("contactSaved");<br/>        } else {<br/>          await this.addContact(this.contact);<br/>          await this.getAllContacts();<br/>          this.$router.push("/");<br/>        }<br/>      } catch (ex) {<br/>        console.log(ex);<br/>      }<br/>    },</span><span id="aed5" class="lo lp it lk b gy lx lr l ls lt">  async getAllContacts() {<br/>      try {<br/>        const response = await this.getContacts();<br/>        this.$store.commit("setContacts", response.data);<br/>      } catch (ex) {<br/>        console.log(ex);<br/>      }<br/>    },</span><span id="bc2f" class="lo lp it lk b gy lx lr l ls lt">  getPostalCodeRegex() {<br/>      if (this.contact.country == "United States") {<br/>        return /^[0-9]{5}(?:-[0-9]{4})?$/;<br/>      } else if (this.contact.country == "Canada") {<br/>        return /^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/;<br/>      }<br/>      return /./;<br/>    },</span><span id="18f5" class="lo lp it lk b gy lx lr l ls lt">  getPhoneRegex() {<br/>      if (["United States", "Canada"].includes(this.contact.country)) {<br/>        return /^[2-9]\d{2}[2-9]\d{2}\d{4}$/;<br/>      }<br/>      return /./;<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="e7b5" class="lo lp it lk b gy lx lr l ls lt">&lt;!-- Add "scoped" attribute to limit CSS to this component only --&gt;<br/>&lt;style scoped lang="scss"&gt;<br/>.contact-form {<br/>  margin: 0 auto;<br/>  width: 90%;<br/>}<br/>&lt;/style&gt;</span></pre><p id="2e0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的文件中，我们有在地址簿中添加和更新联系人的联系人表单，其中Vee-Validate使用得最多。注意，在<code class="fe lu lv lw lk b">form</code>标签内的大多数输入控件中，我们有<code class="fe lu lv lw lk b">v-validate</code>属性。</p><p id="23d5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们指定控件接受哪种输入的地方。</p><p id="047b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">required</code>表示表格字段是必填的。</p><p id="c8fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">regex</code>表示我们根据指定的正则表达式进行验证。</p><p id="23d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这允许在没有可用的Vee-Validate内置规则的情况下，或者当您需要根据另一个字段的值以不同方式验证字段时，进行自定义表单验证。</p><p id="7696" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如对于一个电话号码，我们有这个函数:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="8578" class="lo lp it lk b gy lq lr l ls lt">getPhoneRegex() {<br/>  if (["United States", "Canada"].includes(this.contact.country)){<br/>    return /^[2-9]\d{2}[2-9]\d{2}\d{4}$/;<br/>  }<br/>  return /./;<br/>}</span></pre><p id="a4a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们进入美国或加拿大时，它允许我们验证该号码以查看它是否匹配北美电话格式。否则，我们让人们想进就进。</p><p id="e1cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，对于邮政编码，我们有:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="7708" class="lo lp it lk b gy lq lr l ls lt">getPostalCodeRegex() {<br/>  if (this.contact.country == "United States") {<br/>    return /^[0-9]{5}(?:-[0-9]{4})?$/;<br/>  } else if (this.contact.country == "Canada") {<br/>    return /^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/;<br/>  }<br/>  return /./;<br/>}</span></pre><p id="503c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这允许我们检查美国和加拿大的邮政编码。</p><p id="bb5d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了显示错误，我们可以检查表单字段是否存在错误，然后显示它们。例如，对于名字，我们有:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="e9dc" class="lo lp it lk b gy lq lr l ls lt">&lt;span class="md-error" v-if="errors.has('firstName')"&gt;First Name is required.&lt;/span&gt;</span></pre><p id="6b45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">errors.has(‘firstName’)</code>检查名字字段是否符合指定的验证标准。因为我们正在检查它是否被填充，所以只有一个可能的错误，所以我们可以在<code class="fe lu lv lw lk b">errors.has(‘firstName’)</code>返回<code class="fe lu lv lw lk b">true</code>时显示唯一的错误。</p><p id="ccbe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于更复杂的东西，比如电话号码，我们有:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="73e7" class="lo lp it lk b gy lq lr l ls lt">&lt;span class="md-error" v-if="errors.firstByRule('phone', 'required')"&gt;Phone is required.&lt;/span&gt;</span><span id="f2ed" class="lo lp it lk b gy lx lr l ls lt">&lt;span class="md-error" v-if="errors.firstByRule('phone', 'regex')"&gt;Phone is invalid.&lt;/span&gt;</span></pre><p id="17bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这允许我们分别检查每个验证规则。对于电话号码字段，我们必须检查它是否已填写，以及填写的内容是否具有有效的格式。<code class="fe lu lv lw lk b">errors.firstByRule</code>功能允许我们这样做。</p><p id="bc5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果该字段未填写，则<code class="fe lu lv lw lk b">errors.firstByRule(‘phone’, ‘required’)</code>返回<code class="fe lu lv lw lk b">true</code>，否则返回<code class="fe lu lv lw lk b">false</code>。</p><p id="326f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">errors.firstByRule(‘phone’, ‘regex’)</code>返回<code class="fe lu lv lw lk b">true</code>是电话号码格式填写不正确，否则返回<code class="fe lu lv lw lk b">false</code>。</p><p id="d0dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vee-Validate为您的组件提供了一个<code class="fe lu lv lw lk b">this.field</code>对象。因此，我们可以通过添加以下内容来检查字段是否是脏的，即它们是否被操作过:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="9bd8" class="lo lp it lk b gy lq lr l ls lt">Object.keys(this.fields).some(key =&gt; this.fields[key].dirty)</span></pre><p id="2b7c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个属性都是一个表单字段，<code class="fe lu lv lw lk b">this.fields</code>对象的每个属性都有一个<code class="fe lu lv lw lk b">dirty</code>属性，所以我们可以检查字段是否被操作。</p><p id="d440" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lu lv lw lk b">methods</code>对象的<code class="fe lu lv lw lk b">save</code>函数中，我们有:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="10f4" class="lo lp it lk b gy lq lr l ls lt">async save(evt) {<br/>  evt.preventDefault();<br/>  try {<br/>    const result = await this.$validator.validateAll();<br/>    if (!result) {<br/>      return;<br/>    }<br/>    if (this.editing) {<br/>      await this.updateContact(this.contact, this.contactId);<br/>      await this.getAllContacts();<br/>      this.$emit("contactSaved");<br/>    } else {<br/>      await this.addContact(this.contact);<br/>      await this.getAllContacts();<br/>      this.$router.push("/");<br/>    }<br/>  } catch (ex) {<br/>    console.log(ex);<br/>  }<br/>},</span></pre><p id="41d1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要<code class="fe lu lv lw lk b">evt.preventDefault()</code>来阻止表单以正常方式提交，即不调用下面的Ajax代码。</p><p id="69e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">this.$validator.validateAll()</code>验证表单。</p><p id="7342" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe lu lv lw lk b">this.$validator</code>是Vee-Validate提供的对象。</p><p id="b21d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它返回一个承诺，所以我们需要函数为<code class="fe lu lv lw lk b">async,</code>，在函数调用之前需要<code class="fe lu lv lw lk b">await</code>。</p><p id="f8d5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果<code class="fe lu lv lw lk b">result</code>是falsy，那么表单验证失败，所以我们运行<code class="fe lu lv lw lk b">return</code>来停止执行其余的函数。最后，如果表单域都有效，我们可以提交。由于这个表单用于添加和编辑联系人，我们必须检查我们正在做的是哪一个动作。如果我们编辑，然后我们打电话给<code class="fe lu lv lw lk b">await this.updateContact(this.contact, this.contactId);</code>更新我们的联系方式。否则，我们添加联系人，因此我们调用<code class="fe lu lv lw lk b">await this.addContact(this.contact);</code></p><p id="4b4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">无论是哪种情况，我们都调用<code class="fe lu lv lw lk b">await this.getAllContacts();</code>来刷新我们的联系人，并将他们放入商店。如果我们正在添加，那么我们将通过调用<code class="fe lu lv lw lk b">this.$router.push(“/”);</code>重定向到最后的主页。<code class="fe lu lv lw lk b">this.updateContact</code>、<code class="fe lu lv lw lk b">this.addContact</code>、<code class="fe lu lv lw lk b">this.getAllContacts</code>都来自我们马上要写的<code class="fe lu lv lw lk b">contactMixin</code>。</p><p id="33d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们编写一些助手代码。</p><p id="4187" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个名为<code class="fe lu lv lw lk b">helpers</code>的文件夹，并在其中创建一个名为<code class="fe lu lv lw lk b">export.js</code>的文件—放入以下内容:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="b818" class="lo lp it lk b gy lq lr l ls lt">export const COUNTRIES = [<br/>    { "name": "Afghanistan", "code": "AF" },<br/>    { "name": "Aland Islands", "code": "AX" },<br/>    { "name": "Albania", "code": "AL" },<br/>    { "name": "Algeria", "code": "DZ" },<br/>    { "name": "American Samoa", "code": "AS" },<br/>    { "name": "AndorrA", "code": "AD" },<br/>    { "name": "Angola", "code": "AO" },<br/>    { "name": "Anguilla", "code": "AI" },<br/>    { "name": "Antarctica", "code": "AQ" },<br/>    { "name": "Antigua and Barbuda", "code": "AG" },<br/>    { "name": "Argentina", "code": "AR" },<br/>    { "name": "Armenia", "code": "AM" },<br/>    { "name": "Aruba", "code": "AW" },<br/>    { "name": "Australia", "code": "AU" },<br/>    { "name": "Austria", "code": "AT" },<br/>    { "name": "Azerbaijan", "code": "AZ" },<br/>    { "name": "Bahamas", "code": "BS" },<br/>    { "name": "Bahrain", "code": "BH" },<br/>    { "name": "Bangladesh", "code": "BD" },<br/>    { "name": "Barbados", "code": "BB" },<br/>    { "name": "Belarus", "code": "BY" },<br/>    { "name": "Belgium", "code": "BE" },<br/>    { "name": "Belize", "code": "BZ" },<br/>    { "name": "Benin", "code": "BJ" },<br/>    { "name": "Bermuda", "code": "BM" },<br/>    { "name": "Bhutan", "code": "BT" },<br/>    { "name": "Bolivia", "code": "BO" },<br/>    { "name": "Bosnia and Herzegovina", "code": "BA" },<br/>    { "name": "Botswana", "code": "BW" },<br/>    { "name": "Bouvet Island", "code": "BV" },<br/>    { "name": "Brazil", "code": "BR" },<br/>    { "name": "British Indian Ocean Territory", "code": "IO" },<br/>    { "name": "Brunei Darussalam", "code": "BN" },<br/>    { "name": "Bulgaria", "code": "BG" },<br/>    { "name": "Burkina Faso", "code": "BF" },<br/>    { "name": "Burundi", "code": "BI" },<br/>    { "name": "Cambodia", "code": "KH" },<br/>    { "name": "Cameroon", "code": "CM" },<br/>    { "name": "Canada", "code": "CA" },<br/>    { "name": "Cape Verde", "code": "CV" },<br/>    { "name": "Cayman Islands", "code": "KY" },<br/>    { "name": "Central African Republic", "code": "CF" },<br/>    { "name": "Chad", "code": "TD" },<br/>    { "name": "Chile", "code": "CL" },<br/>    { "name": "China", "code": "CN" },<br/>    { "name": "Christmas Island", "code": "CX" },<br/>    { "name": "Cocos (Keeling) Islands", "code": "CC" },<br/>    { "name": "Colombia", "code": "CO" },<br/>    { "name": "Comoros", "code": "KM" },<br/>    { "name": "Congo", "code": "CG" },<br/>    { "name": "Congo, The Democratic Republic of the", "code": "CD" },<br/>    { "name": "Cook Islands", "code": "CK" },<br/>    { "name": "Costa Rica", "code": "CR" },<br/>    {<br/>        "name": "Cote D\"Ivoire", "code": "CI"<br/>    },<br/>    { "name": "Croatia", "code": "HR" },<br/>    { "name": "Cuba", "code": "CU" },<br/>    { "name": "Cyprus", "code": "CY" },<br/>    { "name": "Czech Republic", "code": "CZ" },<br/>    { "name": "Denmark", "code": "DK" },<br/>    { "name": "Djibouti", "code": "DJ" },<br/>    { "name": "Dominica", "code": "DM" },<br/>    { "name": "Dominican Republic", "code": "DO" },<br/>    { "name": "Ecuador", "code": "EC" },<br/>    { "name": "Egypt", "code": "EG" },<br/>    { "name": "El Salvador", "code": "SV" },<br/>    { "name": "Equatorial Guinea", "code": "GQ" },<br/>    { "name": "Eritrea", "code": "ER" },<br/>    { "name": "Estonia", "code": "EE" },<br/>    { "name": "Ethiopia", "code": "ET" },<br/>    { "name": "Falkland Islands (Malvinas)", "code": "FK" },<br/>    { "name": "Faroe Islands", "code": "FO" },<br/>    { "name": "Fiji", "code": "FJ" },<br/>    { "name": "Finland", "code": "FI" },<br/>    { "name": "France", "code": "FR" },<br/>    { "name": "French Guiana", "code": "GF" },<br/>    { "name": "French Polynesia", "code": "PF" },<br/>    { "name": "French Southern Territories", "code": "TF" },<br/>    { "name": "Gabon", "code": "GA" },<br/>    { "name": "Gambia", "code": "GM" },<br/>    { "name": "Georgia", "code": "GE" },<br/>    { "name": "Germany", "code": "DE" },<br/>    { "name": "Ghana", "code": "GH" },<br/>    { "name": "Gibraltar", "code": "GI" },<br/>    { "name": "Greece", "code": "GR" },<br/>    { "name": "Greenland", "code": "GL" },<br/>    { "name": "Grenada", "code": "GD" },<br/>    { "name": "Guadeloupe", "code": "GP" },<br/>    { "name": "Guam", "code": "GU" },<br/>    { "name": "Guatemala", "code": "GT" },<br/>    { "name": "Guernsey", "code": "GG" },<br/>    { "name": "Guinea", "code": "GN" },<br/>    { "name": "Guinea-Bissau", "code": "GW" },<br/>    { "name": "Guyana", "code": "GY" },<br/>    { "name": "Haiti", "code": "HT" },<br/>    { "name": "Heard Island and Mcdonald Islands", "code": "HM" },<br/>    { "name": "Holy See (Vatican City State)", "code": "VA" },<br/>    { "name": "Honduras", "code": "HN" },<br/>    { "name": "Hong Kong", "code": "HK" },<br/>    { "name": "Hungary", "code": "HU" },<br/>    { "name": "Iceland", "code": "IS" },<br/>    { "name": "India", "code": "IN" },<br/>    { "name": "Indonesia", "code": "ID" },<br/>    { "name": "Iran, Islamic Republic Of", "code": "IR" },<br/>    { "name": "Iraq", "code": "IQ" },<br/>    { "name": "Ireland", "code": "IE" },<br/>    { "name": "Isle of Man", "code": "IM" },<br/>    { "name": "Israel", "code": "IL" },<br/>    { "name": "Italy", "code": "IT" },<br/>    { "name": "Jamaica", "code": "JM" },<br/>    { "name": "Japan", "code": "JP" },<br/>    { "name": "Jersey", "code": "JE" },<br/>    { "name": "Jordan", "code": "JO" },<br/>    { "name": "Kazakhstan", "code": "KZ" },<br/>    { "name": "Kenya", "code": "KE" },<br/>    { "name": "Kiribati", "code": "KI" },<br/>    {<br/>        "name": "Korea, Democratic People\"S Republic of", "code": "KP"<br/>    },<br/>    { "name": "Korea, Republic of", "code": "KR" },<br/>    { "name": "Kuwait", "code": "KW" },<br/>    { "name": "Kyrgyzstan", "code": "KG" },<br/>    {<br/>        "name": "Lao People\"S Democratic Republic", "code": "LA"<br/>    },<br/>    { "name": "Latvia", "code": "LV" },<br/>    { "name": "Lebanon", "code": "LB" },<br/>    { "name": "Lesotho", "code": "LS" },<br/>    { "name": "Liberia", "code": "LR" },<br/>    { "name": "Libyan Arab Jamahiriya", "code": "LY" },<br/>    { "name": "Liechtenstein", "code": "LI" },<br/>    { "name": "Lithuania", "code": "LT" },<br/>    { "name": "Luxembourg", "code": "LU" },<br/>    { "name": "Macao", "code": "MO" },<br/>    { "name": "Macedonia, The Former Yugoslav Republic of", "code": "MK" },<br/>    { "name": "Madagascar", "code": "MG" },<br/>    { "name": "Malawi", "code": "MW" },<br/>    { "name": "Malaysia", "code": "MY" },<br/>    { "name": "Maldives", "code": "MV" },<br/>    { "name": "Mali", "code": "ML" },<br/>    { "name": "Malta", "code": "MT" },<br/>    { "name": "Marshall Islands", "code": "MH" },<br/>    { "name": "Martinique", "code": "MQ" },<br/>    { "name": "Mauritania", "code": "MR" },<br/>    { "name": "Mauritius", "code": "MU" },<br/>    { "name": "Mayotte", "code": "YT" },<br/>    { "name": "Mexico", "code": "MX" },<br/>    { "name": "Micronesia, Federated States of", "code": "FM" },<br/>    { "name": "Moldova, Republic of", "code": "MD" },<br/>    { "name": "Monaco", "code": "MC" },<br/>    { "name": "Mongolia", "code": "MN" },<br/>    { "name": "Montenegro", "code": "ME" },<br/>    { "name": "Montserrat", "code": "MS" },<br/>    { "name": "Morocco", "code": "MA" },<br/>    { "name": "Mozambique", "code": "MZ" },<br/>    { "name": "Myanmar", "code": "MM" },<br/>    { "name": "Namibia", "code": "NA" },<br/>    { "name": "Nauru", "code": "NR" },<br/>    { "name": "Nepal", "code": "NP" },<br/>    { "name": "Netherlands", "code": "NL" },<br/>    { "name": "Netherlands Antilles", "code": "AN" },<br/>    { "name": "New Caledonia", "code": "NC" },<br/>    { "name": "New Zealand", "code": "NZ" },<br/>    { "name": "Nicaragua", "code": "NI" },<br/>    { "name": "Niger", "code": "NE" },<br/>    { "name": "Nigeria", "code": "NG" },<br/>    { "name": "Niue", "code": "NU" },<br/>    { "name": "Norfolk Island", "code": "NF" },<br/>    { "name": "Northern Mariana Islands", "code": "MP" },<br/>    { "name": "Norway", "code": "NO" },<br/>    { "name": "Oman", "code": "OM" },<br/>    { "name": "Pakistan", "code": "PK" },<br/>    { "name": "Palau", "code": "PW" },<br/>    { "name": "Palestinian Territory, Occupied", "code": "PS" },<br/>    { "name": "Panama", "code": "PA" },<br/>    { "name": "Papua New Guinea", "code": "PG" },<br/>    { "name": "Paraguay", "code": "PY" },<br/>    { "name": "Peru", "code": "PE" },<br/>    { "name": "Philippines", "code": "PH" },<br/>    { "name": "Pitcairn", "code": "PN" },<br/>    { "name": "Poland", "code": "PL" },<br/>    { "name": "Portugal", "code": "PT" },<br/>    { "name": "Puerto Rico", "code": "PR" },<br/>    { "name": "Qatar", "code": "QA" },<br/>    { "name": "Reunion", "code": "RE" },<br/>    { "name": "Romania", "code": "RO" },<br/>    { "name": "Russian Federation", "code": "RU" },<br/>    { "name": "RWANDA", "code": "RW" },<br/>    { "name": "Saint Helena", "code": "SH" },<br/>    { "name": "Saint Kitts and Nevis", "code": "KN" },<br/>    { "name": "Saint Lucia", "code": "LC" },<br/>    { "name": "Saint Pierre and Miquelon", "code": "PM" },<br/>    { "name": "Saint Vincent and the Grenadines", "code": "VC" },<br/>    { "name": "Samoa", "code": "WS" },<br/>    { "name": "San Marino", "code": "SM" },<br/>    { "name": "Sao Tome and Principe", "code": "ST" },<br/>    { "name": "Saudi Arabia", "code": "SA" },<br/>    { "name": "Senegal", "code": "SN" },<br/>    { "name": "Serbia", "code": "RS" },<br/>    { "name": "Seychelles", "code": "SC" },<br/>    { "name": "Sierra Leone", "code": "SL" },<br/>    { "name": "Singapore", "code": "SG" },<br/>    { "name": "Slovakia", "code": "SK" },<br/>    { "name": "Slovenia", "code": "SI" },<br/>    { "name": "Solomon Islands", "code": "SB" },<br/>    { "name": "Somalia", "code": "SO" },<br/>    { "name": "South Africa", "code": "ZA" },<br/>    { "name": "South Georgia and the South Sandwich Islands", "code": "GS" },<br/>    { "name": "Spain", "code": "ES" },<br/>    { "name": "Sri Lanka", "code": "LK" },<br/>    { "name": "Sudan", "code": "SD" },<br/>    { "name": "Suriname", "code": "SR" },<br/>    { "name": "Svalbard and Jan Mayen", "code": "SJ" },<br/>    { "name": "Swaziland", "code": "SZ" },<br/>    { "name": "Sweden", "code": "SE" },<br/>    { "name": "Switzerland", "code": "CH" },<br/>    { "name": "Syrian Arab Republic", "code": "SY" },<br/>    { "name": "Taiwan, Province of China", "code": "TW" },<br/>    { "name": "Tajikistan", "code": "TJ" },<br/>    { "name": "Tanzania, United Republic of", "code": "TZ" },<br/>    { "name": "Thailand", "code": "TH" },<br/>    { "name": "Timor-Leste", "code": "TL" },<br/>    { "name": "Togo", "code": "TG" },<br/>    { "name": "Tokelau", "code": "TK" },<br/>    { "name": "Tonga", "code": "TO" },<br/>    { "name": "Trinidad and Tobago", "code": "TT" },<br/>    { "name": "Tunisia", "code": "TN" },<br/>    { "name": "Turkey", "code": "TR" },<br/>    { "name": "Turkmenistan", "code": "TM" },<br/>    { "name": "Turks and Caicos Islands", "code": "TC" },<br/>    { "name": "Tuvalu", "code": "TV" },<br/>    { "name": "Uganda", "code": "UG" },<br/>    { "name": "Ukraine", "code": "UA" },<br/>    { "name": "United Arab Emirates", "code": "AE" },<br/>    { "name": "United Kingdom", "code": "GB" },<br/>    { "name": "United States", "code": "US" },<br/>    { "name": "United States Minor Outlying Islands", "code": "UM" },<br/>    { "name": "Uruguay", "code": "UY" },<br/>    { "name": "Uzbekistan", "code": "UZ" },<br/>    { "name": "Vanuatu", "code": "VU" },<br/>    { "name": "Venezuela", "code": "VE" },<br/>    { "name": "Viet Nam", "code": "VN" },<br/>    { "name": "Virgin Islands, British", "code": "VG" },<br/>    { "name": "Virgin Islands, U.S.", "code": "VI" },<br/>    { "name": "Wallis and Futuna", "code": "WF" },<br/>    { "name": "Western Sahara", "code": "EH" },<br/>    { "name": "Yemen", "code": "YE" },<br/>    { "name": "Zambia", "code": "ZM" },<br/>    { "name": "Zimbabwe", "code": "ZW" }<br/>]</span></pre><p id="a6db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这提供了我们在<code class="fe lu lv lw lk b">ContactForm.vue</code>中引用的国家。</p><p id="3d13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们添加mixin，通过与后端通信来操纵我们的联系人。我们创建一个名为<code class="fe lu lv lw lk b">mixins</code>的文件夹，并在其中创建一个名为<code class="fe lu lv lw lk b">contactMixin.js</code>的文件。</p><p id="ecae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在文件中，我们放入:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="a46a" class="lo lp it lk b gy lq lr l ls lt">const axios = require('axios');<br/>const apiUrl = '<a class="ae le" href="http://localhost:3000'" rel="noopener ugc nofollow" target="_blank">http://localhost:3000'</a>;</span><span id="7415" class="lo lp it lk b gy lx lr l ls lt">export const contactMixin = {<br/>    methods: {<br/>        getContacts() {<br/>            return axios.get(`${apiUrl}/contacts`);<br/>        },</span><span id="d9ee" class="lo lp it lk b gy lx lr l ls lt">        addContact(data) {<br/>            return axios.post(`${apiUrl}/contacts`, data);<br/>        },</span><span id="e6ea" class="lo lp it lk b gy lx lr l ls lt">        updateContact(data, id) {<br/>            return axios.put(`${apiUrl}/contacts/${id}`, data);<br/>        },</span><span id="ddc3" class="lo lp it lk b gy lx lr l ls lt">        deleteContact(id) {<br/>            return axios.delete(`${apiUrl}/contacts/${id}`);<br/>        }<br/>    }<br/>}</span></pre><p id="d3fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将让我们通过把函数放在组件对象的<code class="fe lu lv lw lk b">mixins</code>数组中，把函数包含在我们包含或混合的组件对象的<code class="fe lu lv lw lk b">methods</code>对象中。</p><p id="501f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们添加我们的页面。为此，创建一个<code class="fe lu lv lw lk b">views</code>文件夹(如果它还不存在)并添加<code class="fe lu lv lw lk b">ContactFormPage.vue</code>。</p><p id="6e61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在那里，放上:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="8b0c" class="lo lp it lk b gy lq lr l ls lt">&lt;template&gt;<br/>  &lt;div class="about"&gt;<br/>    &lt;ContactForm :edit="false" /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="8a0e" class="lo lp it lk b gy lx lr l ls lt">&lt;script&gt;<br/>// @ is an alias to /src<br/>import ContactForm from "@/components/ContactForm.vue";</span><span id="edc4" class="lo lp it lk b gy lx lr l ls lt">export default {<br/>  name: "ContactFormPage",<br/>  components: {<br/>    ContactForm<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="3f19" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这只是显示了我们创建的<code class="fe lu lv lw lk b">ContactForm</code>组件。我们将<code class="fe lu lv lw lk b">:edit</code>属性设置为<code class="fe lu lv lw lk b">false</code>，这样它会添加我们的联系人，而不是编辑。</p><p id="c299" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们添加主页来显示联系人列表。在<code class="fe lu lv lw lk b">views</code>文件夹中，我们添加一个名为<code class="fe lu lv lw lk b">Home.vue</code>的文件，如果它不存在的话。我们在里面放了:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="96c8" class="lo lp it lk b gy lq lr l ls lt">&lt;template&gt;<br/>  &lt;div class="home"&gt;<br/>    &lt;div class="center"&gt;<br/>      &lt;h1&gt;Address Book Home&lt;/h1&gt;<br/>    &lt;/div&gt;<br/>    &lt;md-table&gt;<br/>      &lt;md-table-row&gt;<br/>        &lt;md-table-head md-numeric&gt;ID&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;First Name&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Last Name&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Address Line 1&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Address Line 2&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;City&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Country&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Postal Code&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Gender&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Age&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;Email&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;&lt;/md-table-head&gt;<br/>        &lt;md-table-head&gt;&lt;/md-table-head&gt;<br/>      &lt;/md-table-row&gt;</span><span id="9c5e" class="lo lp it lk b gy lx lr l ls lt">&lt;md-table-row v-for="c in contacts" :key="c.id"&gt;<br/>        &lt;md-table-cell md-numeric&gt;{{c.id}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.firstName}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.lastName}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.addressLineOne}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.addressLineTwo}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.city}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.country}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.postalCode}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.gender}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell md-numeric&gt;{{c.age}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;{{c.email}}&lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;<br/>          &lt;md-button class="md-primary" <a class="ae le" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="selectedContactId = c.id; showDialog = true"&gt;Edit&lt;/md-button&gt;<br/>        &lt;/md-table-cell&gt;<br/>        &lt;md-table-cell&gt;<br/>          &lt;md-button class="md-accent" <a class="ae le" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="removeContact(c.id)"&gt;Delete&lt;/md-button&gt;<br/>        &lt;/md-table-cell&gt;<br/>      &lt;/md-table-row&gt;<br/>    &lt;/md-table&gt;</span><span id="da6c" class="lo lp it lk b gy lx lr l ls lt">&lt;md-dialog :md-active.sync="showDialog"&gt;<br/>      &lt;md-dialog-content&gt;<br/>        &lt;ContactForm<br/>          :editing="true"<br/>          :contactId="selectedContactId"<br/>          <a class="ae le" href="http://twitter.com/contactSaved" rel="noopener ugc nofollow" target="_blank">@contactSaved</a>="selectedContactId = undefined; showDialog = false"<br/>        /&gt;<br/>      &lt;/md-dialog-content&gt;<br/>    &lt;/md-dialog&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="cc87" class="lo lp it lk b gy lx lr l ls lt">&lt;script&gt;<br/>import { contactMixin } from "@/mixins/contactMixin";<br/>import ContactForm from "@/components/ContactForm.vue";</span><span id="bb2c" class="lo lp it lk b gy lx lr l ls lt">export default {<br/>  name: "HomePage",<br/>  mixins: [contactMixin],<br/>  components: {<br/>    ContactForm<br/>  },<br/>  props: {<br/>    editing: Boolean,<br/>    id: Number<br/>  },<br/>  computed: {<br/>    contacts() {<br/>      return this.$store.state.contacts;<br/>    }<br/>  },<br/>  data() {<br/>    return {<br/>      showDialog: false,<br/>      selectedContactId: undefined<br/>    };<br/>  },</span><span id="fc4d" class="lo lp it lk b gy lx lr l ls lt">  beforeMount() {<br/>    this.getAllContacts();<br/>  },</span><span id="585a" class="lo lp it lk b gy lx lr l ls lt">  methods: {<br/>    async getAllContacts() {<br/>      try {<br/>        const response = await this.getContacts();<br/>        this.$store.commit("setContacts", response.data);<br/>      } catch (ex) {<br/>        console.log(ex);<br/>      }<br/>    },</span><span id="7c32" class="lo lp it lk b gy lx lr l ls lt">    async removeContact(id) {<br/>      try {<br/>        await this.deleteContact(id);<br/>        await this.getAllContacts();<br/>      } catch (ex) {<br/>        console.log(ex);<br/>      }<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="3297" class="lo lp it lk b gy lx lr l ls lt">&lt;style scoped&gt;<br/>.md-dialog-container {<br/>  padding: 20px;<br/>}</span><span id="62db" class="lo lp it lk b gy lx lr l ls lt">.md-content.md-table.md-theme-default {<br/>  width: 95%;<br/>  margin: 0 auto;<br/>}<br/>&lt;/style&gt;</span></pre><p id="2ec1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在页面加载期间，我们通过调用<code class="fe lu lv lw lk b">beforeMount</code>函数中的<code class="fe lu lv lw lk b">this.getAllContacts</code>函数来获取联系人。注意，我们的mixin中有<code class="fe lu lv lw lk b">this.getContacts</code>函数。Mixins允许我们重用代码。</p><p id="7b95" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">mixinx中的代码不能与组件中的<code class="fe lu lv lw lk b">methods</code>对象中的函数同名，因为mixin函数直接挂钩到了我们的<code class="fe lu lv lw lk b">methods,</code>，因为我们在Mixin代码中导出了一个带有<code class="fe lu lv lw lk b">methods</code>字段的对象。</p><p id="e768" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lu lv lw lk b">App.vue</code>中，我们通过添加以下内容来添加菜单和顶部栏:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="b925" class="lo lp it lk b gy lq lr l ls lt">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;md-toolbar class="md-accent"&gt;<br/>      &lt;md-button class="md-icon-button" <a class="ae le" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="showNavigation = true"&gt;<br/>        &lt;md-icon&gt;menu&lt;/md-icon&gt;<br/>      &lt;/md-button&gt;<br/>      &lt;h3 class="md-title"&gt;Vee Validate Address Book App&lt;/h3&gt;<br/>    &lt;/md-toolbar&gt;<br/>    &lt;md-drawer :md-active.sync="showNavigation" md-swipeable&gt;<br/>      &lt;md-toolbar class="md-transparent" md-elevation="0"&gt;<br/>        &lt;span class="md-title"&gt;Vee Validate Address Book App&lt;/span&gt;<br/>      &lt;/md-toolbar&gt;</span><span id="662f" class="lo lp it lk b gy lx lr l ls lt">&lt;md-list&gt;<br/>        &lt;md-list-item&gt;<br/>          &lt;router-link to="/"&gt;<br/>            &lt;span class="md-list-item-text"&gt;Home&lt;/span&gt;<br/>          &lt;/router-link&gt;<br/>        &lt;/md-list-item&gt;</span><span id="c0f6" class="lo lp it lk b gy lx lr l ls lt">&lt;md-list-item&gt;<br/>          &lt;router-link to="/contact"&gt;<br/>            &lt;span class="md-list-item-text"&gt;Add Contact&lt;/span&gt;<br/>          &lt;/router-link&gt;<br/>        &lt;/md-list-item&gt;<br/>      &lt;/md-list&gt;<br/>    &lt;/md-drawer&gt;</span><span id="506e" class="lo lp it lk b gy lx lr l ls lt">&lt;router-view /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="92bf" class="lo lp it lk b gy lx lr l ls lt">&lt;script&gt;<br/>export default {<br/>  name: "app",<br/>  data: () =&gt; {<br/>    return {<br/>      showNavigation: false<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="ae52" class="lo lp it lk b gy lx lr l ls lt">&lt;style lang="scss"&gt;<br/>.center {<br/>  text-align: center;<br/>}<br/>&lt;/style&gt;</span></pre><p id="d890" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lu lv lw lk b">main.js</code>中，我们添加了样板代码，将Vue材料和Vee-Validate包含在我们的应用中:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="3187" class="lo lp it lk b gy lq lr l ls lt">import Vue from 'vue'<br/>import App from './App.vue'<br/>import router from './router'<br/>import store from './store'<br/>import VueMaterial from 'vue-material'<br/>import 'vue-material/dist/vue-material.min.css'<br/>import VeeValidate from 'vee-validate';</span><span id="71f2" class="lo lp it lk b gy lx lr l ls lt">Vue.use(VeeValidate);<br/>Vue.use(VueMaterial);</span><span id="7ba3" class="lo lp it lk b gy lx lr l ls lt">Vue.config.productionTip = false</span><span id="ca0d" class="lo lp it lk b gy lx lr l ls lt">new Vue({<br/>  router,<br/>  store,<br/>  render: h =&gt; h(App)<br/>}).$mount('#app')</span></pre><p id="2f81" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lu lv lw lk b">router.js</code>中，我们添加了我们的路线，这样我们就可以看到我们的页面:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="9373" class="lo lp it lk b gy lq lr l ls lt">import Vue from 'vue'<br/>import Router from 'vue-router'<br/>import HomePage from './views/HomePage.vue'<br/>import ContactFormPage from './views/ContactFormPage.vue'</span><span id="8304" class="lo lp it lk b gy lx lr l ls lt">Vue.use(Router)</span><span id="f643" class="lo lp it lk b gy lx lr l ls lt">export default new Router({<br/>  mode: 'history',<br/>  base: process.env.BASE_URL,<br/>  routes: [<br/>    {<br/>      path: '/',<br/>      name: 'home',<br/>      component: HomePage<br/>    },<br/>    {<br/>      path: '/contact',<br/>      name: 'contact',<br/>      component: ContactFormPage<br/>    }<br/>  ]<br/>})</span></pre><p id="818e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lu lv lw lk b">store.js</code>中，我们把:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="0d66" class="lo lp it lk b gy lq lr l ls lt">import Vue from 'vue'<br/>import Vuex from 'vuex'</span><span id="6cff" class="lo lp it lk b gy lx lr l ls lt">Vue.use(Vuex)</span><span id="8393" class="lo lp it lk b gy lx lr l ls lt">export default new Vuex.Store({<br/>  state: {<br/>    contacts: []<br/>  },<br/>  mutations: {<br/>    setContacts(state, payload) {<br/>      state.contacts = payload;<br/>    }<br/>  },<br/>  actions: {</span><span id="f7a4" class="lo lp it lk b gy lx lr l ls lt">}<br/>})</span></pre><p id="1350" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将我们的联系人存储在所有组件都可以访问的地方。商店使用Vuex库，因此我们有一个<code class="fe lu lv lw lk b">this.$store</code>对象用<code class="fe lu lv lw lk b">this.$store.commit</code>函数调用我们的变异，并通过组件对象的<code class="fe lu lv lw lk b">computed</code>属性从商店获取最新数据，如下所示:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="9e07" class="lo lp it lk b gy lq lr l ls lt">contacts() {<br/>  return this.$store.state.contacts;<br/>}</span></pre><p id="1a8a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后在<code class="fe lu lv lw lk b">index.html</code>中，我们把:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="e37a" class="lo lp it lk b gy lq lr l ls lt">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;</span><span id="78b4" class="lo lp it lk b gy lx lr l ls lt">&lt;head&gt;<br/>  &lt;meta charset="utf-8"&gt;<br/>  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>  &lt;meta name="viewport" content="width=device-width,initial-scale=1.0"&gt;<br/>  &lt;link rel="icon" href="&lt;%= BASE_URL %&gt;favicon.ico"&gt;<br/>  &lt;link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,500,700,400italic|Material+Icons"&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae le" href="https://unpkg.com/vue-material/dist/vue-material.min.css" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/vue-material/dist/vue-material.min.css</a>"&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae le" href="https://unpkg.com/vue-material/dist/theme/default.css" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/vue-material/dist/theme/default.css</a>"&gt;<br/>  &lt;title&gt;Address Book App&lt;/title&gt;<br/>&lt;/head&gt;</span><span id="68c7" class="lo lp it lk b gy lx lr l ls lt">&lt;body&gt;<br/>  &lt;noscript&gt;<br/>    &lt;strong&gt;We're sorry but vee-validate-tutorial-app doesn't work properly without JavaScript enabled. Please enable it<br/>      to continue.&lt;/strong&gt;<br/>  &lt;/noscript&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>  &lt;!-- built files will be auto injected --&gt;<br/>&lt;/body&gt;</span><span id="868b" class="lo lp it lk b gy lx lr l ls lt">&lt;/html&gt;</span></pre><p id="c419" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将Roboto字体和材质图标添加到我们的应用程序中。</p><p id="5d5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经准备好启动我们的JSON服务器了。转到我们的项目文件夹并运行<code class="fe lu lv lw lk b">json-server — watch db.json</code>来启动服务器。它将允许我们在没有任何配置的情况下调用这些路由:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="1efe" class="lo lp it lk b gy lq lr l ls lt">GET    /contacts<br/>POST   /contacts<br/>PUT    /contacts/1<br/>DELETE /contacts/1</span></pre><p id="7975" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些都是我们需要的路线。数据将保存到我们所在文件夹的<code class="fe lu lv lw lk b">db.json</code>中，这应该是我们应用的项目文件夹。</p><p id="e8d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们有以下内容:</p><figure class="lf lg lh li gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi ly"><img src="../Images/0f19cfa7acabe46bb25b6170de88b489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZmnxeLwZnv3AYQlXq_i2w.png"/></div></div></figure><figure class="lf lg lh li gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mg"><img src="../Images/f25134e47deed2b3c4a5863bb179af59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2jwvfXXYxSWGOcNmfaIlg.png"/></div></div></figure><figure class="lf lg lh li gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mg"><img src="../Images/c25cdd29a22dd4675630a0a26f25a1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hABoMlByWXfyopfVptC80A.png"/></div></div></figure><figure class="lf lg lh li gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mh"><img src="../Images/bda8f5ab919dbf7a862c171fef3f2eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jMc_A_r1oB_P9iLgjF1dA.png"/></div></div></figure></div></div>    
</body>
</html>