<html>
<head>
<title>Want to Use a One-click Blockchain? Ganache Meets Azure Container Instances</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想用一键区块链？Ganache遇到Azure容器实例</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/want-to-use-a-one-click-blockchain-ganache-meets-azure-container-instances-3c9cf105172b?source=collection_archive---------1-----------------------#2022-07-23">https://betterprogramming.pub/want-to-use-a-one-click-blockchain-ganache-meets-azure-container-instances-3c9cf105172b?source=collection_archive---------1-----------------------#2022-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c193" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Azure容器实例托管Ganache</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1d006b70e95778b98bbb5a3f7aaa126c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7S-qgDBDT1PPuUyi"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@theshubhamdhage?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Shubham Dhage </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="366c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我开始学习更多关于Web3的知识时，我被介绍给了“一键式区块链”。</p><p id="4876" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这对当地发展大有裨益。我想找出一种方法，将它作为公关工作流程的一部分，与Azure Static Web Apps配合使用。Azure静态Web应用程序可以在公共关系期间为审查变更提供一个临时环境。</p><p id="693b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果应用程序是分布式应用程序(dApp)，要查看更改，您必须部署智能合同。在这里，我想使用<a class="ae ky" href="https://docs.microsoft.com/en-us/azure/container-instances/container-instances-overview" rel="noopener ugc nofollow" target="_blank"> Azure容器实例</a> (ACI)来托管Ganache的临时实例，以便在PR期间部署智能合约。</p><p id="8663" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我需要弄清楚如何部署ACI来托管来自trufflesuite/ganache的Ganache Docker映像。我将使用跨平台的Azure CLI和PowerShell。要创建ACI，我需要一个资源组。我可以创建一个新的资源组，或者将其存储在与SWA相同的资源组中。如果我想为ACI创建一个资源组，我可以使用以下命令:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="46ae" class="ma mb it lw b gy mc md l me mf">az group create --resource-group test-ganache --location centralus</span></pre><p id="249b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建资源组后，我使用以下命令部署ACI:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="70ae" class="ma mb it lw b gy mc md l me mf">$aci = az container create --resource-group test-ganache --name ganache --image trufflesuite/ganache:latest --ports 8545 --ip-address Public --output json | ConvertFrom-Json</span></pre><p id="e568" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的命令使用PowerShell将<code class="fe mg mh mi lw b">az container create</code>命令的JSON输出转换成PowerShell对象，并将其存储在<em class="mj"> $aci </em>中。我需要这个，这样我就可以访问ACI的IP地址。<code class="fe mg mh mi lw b">create</code>命令公开端口8545，这是Ganache使用的默认端口，并请求容器获得一个公共IP。</p><p id="4c0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我是在安装了geth的交互式PowerShell会话中运行这些命令的，所以我使用以下命令连接到这个区块链:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a16b" class="ma mb it lw b gy mc md l me mf">geth attach <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/%24(%24aci.ipAddress.ip):8545">http://$($aci.ipAddress.ip):8545</a></span></pre><p id="50a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我需要访问帐户地址或私钥，我可以查看容器的日志。为了获取启动时输出地址和密钥的容器的日志，我使用了以下命令:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="03e7" class="ma mb it lw b gy mc md l me mf">$logs = az container logs --container ganache --resource-group test-ganache --name ganache</span></pre><p id="8180" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出存储在<em class="mj"> $logs，</em>中，我使用下面的命令使用<code class="fe mg mh mi lw b">Select-String</code> CmdLet获取地址和私钥:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0918" class="ma mb it lw b gy mc md l me mf"># Get first address<br/>$address = ($logs | Select-String '\(0\) ([^\(]+) \(').Matches.Groups[1].Value </span><span id="a481" class="ma mb it lw b gy mk md l me mf"># Get first private key<br/>$key = ($logs | Select-String '\(0\) ([^\(]{64,})').Matches.Groups[1].Value</span></pre><p id="b4fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的命令获取第一个地址。如果我想要一个不同的帐户，我只需将正则表达式中的索引从0调整到所需的索引。例如，要获得第二个帐户，请将上面命令中的\(0\)更改为\(1\)。</p><p id="6a0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了清理我的ACI，我使用了以下命令:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="178b" class="ma mb it lw b gy mc md l me mf">az container delete --resource-group test-ganache --name ganache</span></pre><p id="6eb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果我想删除整个资源组，我可以使用以下命令:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="07a5" class="ma mb it lw b gy mc md l me mf">az group delete --resource-group test-ganache</span></pre><p id="47f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。下次见！</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="e90d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mj">最初发表于</em><a class="ae ky" href="https://www.donovanbrown.com/post/How-to-use-Azure-Container-Instances-to-host-Ganache" rel="noopener ugc nofollow" target="_blank"><em class="mj"/></a><em class="mj">。</em></p></div></div>    
</body>
</html>