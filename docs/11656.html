<html>
<head>
<title>How to Create a Realtime Chat App With Flutter and Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Flutter和Node.js创建实时聊天应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-realtime-chat-app-with-flutter-and-node-js-23530b596f00?source=collection_archive---------4-----------------------#2022-04-06">https://betterprogramming.pub/how-to-create-a-realtime-chat-app-with-flutter-and-node-js-23530b596f00?source=collection_archive---------4-----------------------#2022-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b174" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Flutter前端遇到Node.js后端</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d34c9c638a138130c73f79a7135dc94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2esnVG7GweR-itSne2UA4w.jpeg"/></div></div></figure><p id="d3ed" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇博客中，我们将看到如何制作一个以Node.js为后端，以Flutter为前端的实时聊天app。我们将使用套接字在设备之间进行通信。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="2826" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">Node.js(服务器端)</h2><p id="b627" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">让我们创建一个名为<code class="fe mv mw mx my b">chat_server</code>的新项目，并在终端中运行它。现在运行这个命令来启动项目:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="d8a3" class="lx ly it my b gy nd ne l nf ng">touch index.js &amp;&amp; npm init &amp;&amp; npm install ws &amp;&amp; npm install express</span></pre><p id="cfe0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将为您完全安装项目。完成后，在您最喜欢的IDE中打开项目，并打开您的<code class="fe mv mw mx my b">index.js</code>文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="882b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们的基本Websocket服务器，现在它并没有做太多事情。让我们现在改变这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c118" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将完全运行您的消息！现在这已经完成了，我们现在可以开始使用我们的Flutter聊天应用程序了。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="2d8e" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">颤动(客户端)</h2><p id="35b6" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我们现在已经完成了我们的后端，所以我们可以开始在颤振聊天应用程序。运行这个命令来启动我们新的颤振项目:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="2dc4" class="lx ly it my b gy nd ne l nf ng">flutter create chat_app &amp;&amp; cd chat_app &amp;&amp; flutter run</span></pre><p id="aef9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在你的IDE中打开这个项目，打开你的<code class="fe mv mw mx my b">pubspec.yaml</code>文件，我们将添加<code class="fe mv mw mx my b">web_socket_channel</code> <strong class="kw iu"> </strong>确保它看起来像这样:</p><pre class="kj kk kl km gt mz my na nb aw nc bi"><span id="2b73" class="lx ly it my b gy nd ne l nf ng">dependencies:<br/>  flutter:<br/>    sdk: flutter<br/>  cupertino_icons: ^1.0.2<br/>  <strong class="my iu">web_socket_channel</strong>: ^2.1.0 # Add this.<br/>  <strong class="my iu">sqflite</strong>: ^2.0.2 # And this.</span></pre><p id="48df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要开始我们的项目，请删除<code class="fe mv mw mx my b">lib/main.dart</code>中的所有内容，并确保插入以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="2439" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们创建一个名为<code class="fe mv mw mx my b">messages.dart</code>的新文件，我们将在其中存储消息。因为我们将在本地存储我们的消息，所以我们将首先为此创建一个函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="bd2f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">代码真多啊。这个函数的作用是检索我们数据库中的每一条信息。然后，它会检查消息是否已由您发送或接收。</p><p id="93e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果已经完成，那么最后我们将显示消息。现在我们将在<code class="fe mv mw mx my b">messages.dart</code>中创建另一个函数，它将向我们的服务器发送一条消息，并将一条新消息插入我们的数据库。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1eaa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个函数将存储我们将要发送的消息。至此，我们将创建一个页面来显示这些消息。</p><p id="8528" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将这个页面称为<code class="fe mv mw mx my b">chat_page.dart</code>，它看起来像这样。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="002c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，为了接收消息，我们想为此创建一个函数。我们将调用我们的函数<strong class="kw iu"> </strong> <code class="fe mv mw mx my b">getMessage()</code>这将把我们自己链接到服务器并监听任何消息。如果有消息，我们也会显示出来。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="222a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是全部，现在你完全创建了一个聊天应用程序。现在在两台本地设备上运行这个应用程序，看看它是否能工作。如果它不起作用，请让我知道，我会帮助你。感谢阅读。</p></div></div>    
</body>
</html>