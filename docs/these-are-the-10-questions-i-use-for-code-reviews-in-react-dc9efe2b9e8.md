# 这是我在 React 中用于代码评审的 10 个问题

> 原文：<https://betterprogramming.pub/these-are-the-10-questions-i-use-for-code-reviews-in-react-dc9efe2b9e8>

## 也是你创造自己的指南

![](img/9c94231578e0dd65c78ede934bca1dd8.png)

约翰·施诺布里奇在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

无论你是哪种类型的开发人员，在工程团队中工作时，评审是你日常职责的一部分。作为一名 React 开发人员也不例外。有很多资源会教你如何编写更好的 React 代码，但几乎没有任何文章、视频或教程会帮助你改进对 React 代码的审查。

尽管审查同事的代码是我们作为开发人员的重要职责，但这并不是很多开发人员所期望的责任。他们觉得读代码比写代码无聊，对你这个评审来说没有意义，你唯一做的事情就是看门的同事。

就我个人而言，我过去也有同样的观点，并且不太喜欢审查代码。但是在这个主题上花了很多时间，并作为 React 开发人员深入到不同的方面之后，我注意到这个问题归结为一个事实，即我不知道如何正确地审查 React 代码。

我的例行程序是打开 merge request (MR ),不需要任何策略地从头到尾通读所有代码，并对我注意到的任何内容添加评论。毫不奇怪地说，我不喜欢它，我提供的评论质量不高。

现在，我总是带着我将关注的特定计划和主题来回顾 React 代码。自从我开始这样做，回顾变得不那么无聊，随着时间的推移，我的回顾的质量提高了，这是我从同事那里得到的反馈。

我甚至可以说，我现在真的很喜欢审查我同事的代码。审查他们的代码为我提供了一种不同的方式来了解他们的编码风格，理解他们的代码，询问有关代码的问题，学习新的东西，最重要的是提供对他们工作的反馈，以提高整个代码库的质量。

本文分享了我在审查 React 代码时问自己的所有问题。如果你不确定如何评审 React 代码，或者不知道应该关注什么，那么这些问题将帮助你开始。以此为基础，你可以像我一样创建回顾清单，开始让回顾成为一个自觉的过程，为你的团队提供更有意义的回顾，甚至开始享受它。

# 1.这个代码有用吗？

审查任何代码最重要的方面是确保代码正常工作。这不一定是您可以在代码本身中轻松验证的事情。大多数时候，您将依赖持续集成(CI)或在本地自己检查代码。当以 MR 的形式提供给你时，代码也可以工作。

但是尽管如此，当通读这些代码时，质疑这些代码是否有效也无妨。在最坏的情况下，你会更好地理解代码。在最好的情况下，您会注意到代码提议者遗漏的一些细节，这些细节有助于提高质量。

# 2.我明白发生了什么吗？

通常，开发人员会像审查 linter 或其他静态分析工具一样审查 MR。他们将只关注代码的实现，并检查是否一切都正确实现了。问题是相应的静态分析工具可以更快、更有效、更可靠地做同样的事情。虽然关注细节是好的，但在不理解代码实际上做什么的情况下，这不应该是你的主要关注点。

无论是为了提供更有意义的反馈，还是为了预测未来的工作，您都必须首先了解 MR. When 与代码提议者一起思考并做静态分析工具不能做的事情。但要做到这一点，你首先需要了解 MR 中发生了什么。这涉及到一切，如上下文、目的和实现。

# 3.这段代码可读吗？

我们不应该只满足于有效的代码。这应该是最低要求，但不是决定性因素。最终，合并到代码库中并交付给用户的代码将不得不被维护。但与代码本身不同的是，创建代码的开发人员不会永远和它一起工作。几个月后，即使是创建者自己也很可能难以理解他们自己的代码。

因此，拥有可读的代码非常重要。拥有更多可读的代码意味着其他开发人员将来能够更容易地理解代码和执行维护相关的任务。具体的例子有[内容状态](https://www.chakshunyu.com/blog/how-to-write-readable-react-content-states/)、[内联条件呈现](https://www.chakshunyu.com/blog/react-readability-analysis-of-inline-conditional-rendering/)和[定制钩子](https://www.chakshunyu.com/blog/react-readability-analysis-of-implementing-custom-hooks/)，还有在哪里放置代码、组织以及变量和函数的命名。

但是可读性不仅仅局限于特定的代码模式或主题。它是关于所有的代码作为一个整体，以及开发人员将如何轻松地通过代码来理解它。最后，可读性对于工程团队来说是一项长期投资，在评审期间支付费用。

# 4.这个组件或者钩子是不是做的太多了？

软件开发中一个经典的反模式就是所谓的上帝对象。这指的是任何包含所有职责的编程实例，如对象、类或函数。它会知道的太多，做的太多，包含太多盘根错节的流。结果是一个难以维护、理解、重构、工作的实例，并且非常脆弱。

同样，我们应该在 React 开发中避免这种情况。特别是在 React 中，开发集中在可重用性、可扩展性和单一责任上，考虑这一点很重要。注意 React 组件和挂钩，尝试理解它们的用途，并验证它们是否做得太多。如果是这样，那么明智的做法是建议通过将其抽象成一个组件或钩子来解决这个问题，以防止代码库的质量下降。

# 5.这必须是一个组件或挂钩吗？

抽象不够的另一面，因此潜在地创造了一个上帝组件或钩子，也有抽象太多的另一面。让一切都成为组件或挂钩最终也会降低 React 代码库的质量。

在层与层之间有一个额外的组件会引入适当的钻取、特定于 React 的反模式，或者阻止推荐的组合模式。而为每一部分逻辑创建一个新的定制钩子会导致太多的抽象，使得代码库杂乱无章。

当审查时，你是代码的第一个读者，因此是经历这些后果的主要候选人。记住这一点，并不断问自己所选择的结构是否是必要的，可以让你在不实际接触代码的情况下为代码架构做出贡献。

# 6.这个 API 设计可以简化吗？

无论是函数参数，React 组件的道具，还是自定义的钩子参数，实现它们都不是一件容易的事情。最终，它是一种 API 设计形式。特别是使用 React props，很容易创建复杂而多余的 API。

如果你有两个布尔属性，目标是用户界面的相似部分，也许考虑枚举属性更好。如果你有两个总是一起用的道具，也许合二为一更好。如果某些属性只与基于枚举或布尔属性的某些分支相关，也许值得将组件拆分成多个组件。如果您要为单个项目传递一个数组和一个呈现函数，那么最好考虑呈现道具模式。如果你经常做道具练习，也许考虑一下构图模式是值得的。

所有这些都是在考虑 React props 的 API 设计时可以提出的建议的具体例子。但是它不仅仅局限于这些具体的例子或者一般的道具，它也可以应用于实用函数和定制钩子。最重要的是牢记在心，努力理解提议者的 API 设计，并据此提供反馈。

# 7.有测试吗？

这个问题听起来有点奇怪，因为通常你会期望有测试。我复习的时候考虑这个有什么意义？但事实上，你会对考试经常被遗忘和忽视感到失望。从长远来看，确保新特性、修复或代码得到测试将极大地帮助工程团队。

这不仅包括为新代码编写新测试，还包括在相关情况下更新旧测试。一般来说，至少有一个记录 MR 的目的和添加的代码的测试应该是最低要求。如果不是这种情况，它可以保证一个变更请求，这取决于团队如何处理这个问题。

# 8.这些测试有意义吗？

有些人认为有任何测试都比没有好，但我不太同意这种观点。虽然测试通常是确保代码库代码质量的第一步，但它也可能是非常具有欺骗性的一步。糟糕的测试会导致错误的安全感，发布实际上不起作用的代码，浪费时间和精力。

当代码提议者已经包含测试时，确保检查他们是否做了他们应该做的事情。设置、触发和验证。它们依赖于实现细节吗？设置是否正确？我们是否达到了一个合适的状态？所有不同的部分可以以非常不同的方式实现，但即使是最小的变化也会显著影响测试的可信度。

# 9.这个特性的可访问性怎么样？

web 开发不可或缺的一部分是我们的应用程序应该可以被任何类型的用户访问。不幸的是，并不是每个 web 应用程序都针对屏幕阅读器、使用键盘的控件或其他组进行了优化。

没有一个开发人员会知道如何为现有的所有功能实现适当的可访问性。作为评审者，记住这个主题，提醒提议者他们是否忘了实现它，提供资源，或者在必要时提出建议。

# 10.我们是否更新了适当的文档？

重构或更改现有代码时，最常被遗忘的孩子是文档。无论是代码注释、文档页面还是 READMEs，假设它们是最新的总是一种危险的行为。

如果你知道有官方文件、文档页面或评论需要更新，那么一定要在评论中提到它们。尤其是当代码提议者通常不在代码库的某个部分工作时，几乎不可能了解现有文档的每一个部分。但是让他们保持最新是一个团队的努力，包括你。

# 最后的想法

审查你同事的代码的一个最重要的方面是知道要注意什么，并使之成为一个有意识的过程。不幸的是，很多开发人员不这样做，这使得审查变得无聊、乏味和没有意义。

但是在现实中，审查可能完全相反，并且是确保代码质量的一种非常有效的方式。为了有助于这一点，本文提出了在审查 React 代码时应该问自己的十个问题。这将帮助你意识到要关注的主题，为自己建立一个复习计划，并提高你的复习质量。