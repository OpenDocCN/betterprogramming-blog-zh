<html>
<head>
<title>Getting Started With AWK — for Data Scientists and Engineers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWK入门—面向数据科学家和工程师</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/awk-tutorial-for-data-scientists-and-engineers-predictive-hacks-848548888dd7?source=collection_archive---------7-----------------------#2021-11-09">https://betterprogramming.pub/awk-tutorial-for-data-scientists-and-engineers-predictive-hacks-848548888dd7?source=collection_archive---------7-----------------------#2021-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a0b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过真实世界的例子利用AWK的力量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9ed6ab3cabd73b5fca039e3a0a8f5a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T4fSc15kUcbBpXwz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">康斯坦丁诺·卡斯卡尼斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class="kz la gp gr lb lc"><a href="https://jorgepit-14189.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">用我的推荐链接加入媒体-乔治皮皮斯</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">阅读乔治·皮皮斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">jorgepit-14189.medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq ks lc"/></div></div></a></div><p id="7046" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">AWK出现在1977年，是一种为文本处理设计的编程语言，主要用于数据处理。在数据科学和数据工程领域，AWK语言是一个很好的数据管理工具。在本帖中，我们将通过例子来尝试释放AWK的力量。</p><p id="61b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">出于演示的目的，我们将使用下面的简单文件，您可以跟着做！</p><p id="df03" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一个示例csv:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="950a" class="ms mt it mo b gy mu mv l mw mx">ID,Name,Dept,Gender<br/>1,George,DS,M<br/>2,Billy,DS,M<br/>3,Nick,IT,M<br/>4,George,IT,M<br/>5,Nikki,HR,F<br/>6,Claudia,HR,F<br/>7,Maria,Sales,F<br/>8,Jimmy,Sales,M<br/>9,Jane,Marketing,F<br/>10,George,DS,M</span></pre><h1 id="e19d" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">AWK的记录和字段</h1><p id="e1e4" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">AWK处理文本文件。默认的字段分隔符是空白，默认的记录分隔符是换行符<code class="fe nu nv nw mo b">\n</code>。但是，我们能够定义记录和字段。在我们提供一些具体的例子之前，让我们先关注一下最重要的内置变量:</p><ul class=""><li id="9a63" class="nx ny it lt b lu lv lx ly ma nz me oa mi ob mm oc od oe of bi translated"><code class="fe nu nv nw mo b">NR</code>:保存当前输入记录的数量</li><li id="3e2d" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated"><code class="fe nu nv nw mo b">NF</code>:保存当前记录的字段数</li><li id="0a28" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated"><code class="fe nu nv nw mo b">FS</code>:输入字段分隔符，默认为空格</li><li id="9833" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated"><code class="fe nu nv nw mo b">RS</code>:输入记录分隔符，默认为换行符</li><li id="1908" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated"><code class="fe nu nv nw mo b">OFS</code>:输出字段分隔符</li><li id="5f75" class="nx ny it lt b lu og lx oh ma oi me oj mi ok mm oc od oe of bi translated"><code class="fe nu nv nw mo b">ORS</code>:输出记录分隔符</li></ul><p id="e475" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通过下面的例子，您将对内置变量有一个清晰的了解。</p><h1 id="b6c5" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何返回文件的第一行</h1><p id="7336" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">当我们得到一个文件时，我们要做的第一件事是什么？简单地说，就是运行“head”命令来了解数据。让我们看看如何用AWK返回前5行。注意，我们使用NR选项(NR &lt;=5).</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="ace8" class="ms mt it mo b gy mu mv l mw mx">awk 'NR&lt;=5 {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/35c9165a87819ff799e7004f41a479ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OUHDaPtPkV3Jee1q.png"/></div></div></figure><p id="74d7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Let’s say what we want to return the 6th to 10th row, we can easily do it as follows:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="6374" class="ms mt it mo b gy mu mv l mw mx">awk 'NR&lt;=10 &amp;&amp; NR&gt;=6 {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/4ef9c08b50bc5cb5f2f9b3ba28a3205d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LQQhySetiL-c6l3h.png"/></div></div></figure><p id="23ef" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Finally, let’s say that we want to return the 6th to 10th row plus the header, which is the first row.</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="927c" class="ms mt it mo b gy mu mv l mw mx">awk '(NR&lt;=10 &amp;&amp; NR&gt;=6)||(NR==1) {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/c41608265e68097c799d4e12f62bc7e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZoQDRIKLILSLR6R-.png"/></div></div></figure><h1 id="97c1" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">How to Filter Rows</h1><p id="9950" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">We can easily filter lines based on some conditions. In the next example, we will return all the rows that contain the string  【T7】 .</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="1365" class="ms mt it mo b gy mu mv l mw mx">awk '/Sales/ {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/2a356bb98fdc288252120af6d4439141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WE8lBVCgZKMqjtj_.png"/></div></div></figure><p id="ac22" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Similarly, we can return all the rows that contain the “ <strong class="lt iu"> HR" </strong>或<strong class="lt iu"> "Sales" </strong>字符串。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="4d78" class="ms mt it mo b gy mu mv l mw mx">awk '/HR|Sales/ {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/f752b64c515c3bd08bdcd6d17c8fdadf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FC4dnPJGJWxb-H99.png"/></div></div></figure><p id="b6ce" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以使用其他正则表达式。例如，我们正在寻找包含后跟某物的<code class="fe nu nv nw mo b">Geo</code>字符串和后跟<code class="fe nu nv nw mo b">IT</code>的行:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="c30b" class="ms mt it mo b gy mu mv l mw mx">awk '/Geo.*IT/ {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/7aedc5a8046553ced478fe76b0c841e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t2aUuY2-bTB_OuTB.png"/></div></div></figure><p id="fc30" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">此外，我们可以返回不包含所需字符串的行。例如，我们希望返回不包含<code class="fe nu nv nw mo b">HR</code> <strong class="lt iu"> </strong>或<code class="fe nu nv nw mo b">Sales</code>的行。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="0fc8" class="ms mt it mo b gy mu mv l mw mx">awk '!/HR|Sales/ {print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/af6326d1b1303ac7ed24fc10a7b28ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5VIJ0gEB_xcb9Al2.png"/></div></div></figure><h1 id="43a4" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何选择列</h1><p id="01fb" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">我们可以学习的第一件事是如何在AWK选择列。但是在我们开始之前，让我们看看如何打印文件。命令是:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f567" class="ms mt it mo b gy mu mv l mw mx">awk '{print}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/d18cf304d35789a531f487b1bfd4609b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oOmixXYD5VqRNzjK.png"/></div></div></figure><p id="904b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请注意，我们可以通过运行以下命令来打印所有行:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="8193" class="ms mt it mo b gy mu mv l mw mx">awk '{print $0}' eg.csv</span></pre><p id="fa7e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我们想要返回特定的列，我们可以使用<code class="fe nu nv nw mo b">$</code>符号和所需列的编号。请注意，默认分隔符是“空白”，但是我们可以使用“F”选项或“FS”变量来更改它。假设我们要返回第2列和第4列。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="6a94" class="ms mt it mo b gy mu mv l mw mx">awk -F ',' '{print $2, $4}' eg.csv</span></pre><p id="9461" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">或者</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="4626" class="ms mt it mo b gy mu mv l mw mx">awk '{print $2, $4}' FS=',' eg.csv</span></pre><p id="784e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">或者</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="bb7f" class="ms mt it mo b gy mu mv l mw mx">awk 'BEGIN{FS=","} {print $2, $4}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/94b00a712790a4e10e3566c7a40eaccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X3lt9Sq39NULBrvj.png"/></div></div></figure><p id="328a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如您所见，我们成功地返回了所需的列。</p><p id="8ae7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">提示:除非是正则表达式，否则分隔符不必用引号括起来。最后，如果分隔符是制表符，可以用<code class="fe nu nv nw mo b">\t</code>指定。</p><h1 id="afae" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何根据列条件筛选行</h1><p id="4df3" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">我们已经看到了如何通过在一行中搜索一个字符串来过滤行，以及如何选择列。现在，我们可以看到如何根据特定列中的某些条件来筛选行。</p><p id="b6f3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">例如，假设我们想要所有<code class="fe nu nv nw mo b">department</code> <strong class="lt iu"> </strong>为<code class="fe nu nv nw mo b"><strong class="lt iu">DS</strong></code>的行。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f924" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$3=="DS" {print $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/3f8d10d6b0a0d536c046baec3fcfbb45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aL-WqgclsPM-zKpl.png"/></div></div></figure><p id="c5d8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请注意，部门是第三列。</p><p id="8d73" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设我们想要返回ID大于5的所有行。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="16a0" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$1&gt;5{print $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/629e85a2ce0ea7bcb582290243dc4ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5CBdEubo2nDqBs2X.png"/></div></div></figure><p id="f5f6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们还可以获得特定列包含子字符串的行。在这种情况下，我们需要使用“~”符号加上斜线“/”作为正则表达式。例如，让我们获取第二列中包含子字符串<code class="fe nu nv nw mo b">Ge</code> <strong class="lt iu"> </strong>的所有行。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="ab19" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$2~/Ge/{print $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/3fc22ec412811187510e34d36a7d625f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xxPjqvWTKPqmIWDU.png"/></div></div></figure><p id="6161" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我们需要反转表达式，即列名不包含子串<code class="fe nu nv nw mo b">Ge</code>的行，我们可以运行:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="eee1" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$2!~/Ge/{print $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/f2adb48b21eb2487593f16a653966eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*b7rxjdyT8jcTgAnX.png"/></div></div></figure><p id="6efe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，如果我们想要精确的匹配，比如获取名称为<code class="fe nu nv nw mo b">George</code>的所有行:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="a308" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$2=="George"{print $0}' eg.csv</span></pre><p id="9657" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于反转表达式是:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="0d3b" class="ms mt it mo b gy mu mv l mw mx">awk -F"," '$2!="George"{print $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/c865b0524c523be8febd9dfd1247c555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eHPbdrhWxjQcNMtm.png"/></div></div></figure><h1 id="9ef1" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何更改分隔符</h1><p id="660a" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">至少有两种不同的方法来改变文件的文件分隔符。假设我想将CSV文件转换成TSV文件。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="ae4f" class="ms mt it mo b gy mu mv l mw mx">awk -F "," '{print $1 "\t" $2 "\t" $3 "\t" $4}' eg.csv</span></pre><p id="f850" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">或者</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="970d" class="ms mt it mo b gy mu mv l mw mx">awk 'BEGIN{FS=",";OFS="\t"} {print $1, $2, $3, $4}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/de1804aabb56b3d926f11268257e51e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C5755J5enOQUfiBn.png"/></div></div></figure><p id="665e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们也可以保存TSV文件，如下所示:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="921c" class="ms mt it mo b gy mu mv l mw mx">awk 'BEGIN{FS=",";OFS="\t"} {print $1, $2, $3, $4}' eg.csv &gt; eg.tsv</span></pre><h1 id="2515" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何连接字段</h1><p id="ac7d" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">我们可以很容易地将字段与打印语句连接起来。假设我们想在<code class="fe nu nv nw mo b">Name</code> <strong class="lt iu"> </strong>和<code class="fe nu nv nw mo b">Gender</code>之间添加<code class="fe nu nv nw mo b">--&gt;</code>。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7f8d" class="ms mt it mo b gy mu mv l mw mx">awk -F "," '{print $2 "--&gt;" $4}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/16fa0ccc837a1822b4963988ddffe037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dZtbjILmj15i0tq3.png"/></div></div></figure><h1 id="b74e" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何按记录打印字段数</h1><p id="1a2e" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">正如我们前面提到的，我们可以指定字段分隔符。有了AWK，我们可以按行得到字段的数量。例如:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="2b09" class="ms mt it mo b gy mu mv l mw mx">awk -F "," '{print NF, $0}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/58677b688bc3c6bc817208cba6311d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rhKx9CeCBkCf-0PH.png"/></div></div></figure><p id="51b5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我们所看到的，由于我们有四个字段，我们得到了每条记录的<strong class="lt iu"> 4 </strong>。</p><h1 id="7fa8" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何计算文件的行数</h1><p id="f743" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">另一个非常常见的任务是获取文件的行数。在Unix中，我们可以如下得到它:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7cba" class="ms mt it mo b gy mu mv l mw mx">cat eg.csv | wc -l</span></pre><p id="0644" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用AWK，我们可以运行如下等效命令:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="a317" class="ms mt it mo b gy mu mv l mw mx">awk 'END {print NR}' eg.csv</span></pre><p id="cbdc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">毫不奇怪，在这两种情况下，我们都得到了<code class="fe nu nv nw mo b">11</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/fc7de2b0b3641c753381cba9704de767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mFil01Pfw25MR7tp.png"/></div></div></figure><h1 id="a6f1" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何得到一列的和</h1><p id="cf78" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">假设我们想得到ID列的总和。我们可以很容易地做到如下:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="7ee7" class="ms mt it mo b gy mu mv l mw mx">awk -F "," '{mysum+= $1} END {print mysum}' eg.csv</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/0758fdebc427b2cfe4fa77fab1ef26ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2HrAlTQjnx8x27Sd.png"/></div></div></figure><p id="6d07" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我们所见，我们得到了<code class="fe nu nv nw mo b">55 (=1+2+3+4+5+6+7+8+9+10)</code>。在上面的命令中，我们定义了一个名为<code class="fe nu nv nw mo b">mysum</code>的变量，其中我们为每一行添加第一列的相应记录(<strong class="lt iu"> $1 </strong>)。</p><h1 id="6cd2" class="my mt it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">如何连接多个CSV文件</h1><p id="0890" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">假设我们有许多相同格式的CSV文件，我们想<a class="ae ky" href="https://predictivehacks.com/?all-tips=how-to-concatenate-multiple-csv-files-in-linux" rel="noopener ugc nofollow" target="_blank">将它们合并成一个文件</a>，但是我们只想保留第一个文件的头！我们可以对AWK这样做:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="c18e" class="ms mt it mo b gy mu mv l mw mx">awk '(NR == 1) || (FNR &gt; 1)' my_file_*.csv &gt; merged.csv</span></pre><p id="66ba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">FNR指的是单个文件中已处理记录的数量，NR指的是所有文件，所以我们保留第一行，即文件头，忽略每个文件的第一行。</p><p id="1ae0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，如果您想删除所有文件的标题:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="f650" class="ms mt it mo b gy mu mv l mw mx">awk 'FNR &gt; 1' my_file_*.csv &gt; merged.csv</span></pre></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><h1 id="4b79" class="my mt it bd mz na ov nc nd ne ow ng nh jz ox ka nj kc oy kd nl kf oz kg nn no bi translated">结束语</h1><p id="bceb" class="pw-post-body-paragraph lr ls it lt b lu np ju lw lx nq jx lz ma nr mc md me ns mg mh mi nt mk ml mm im bi translated">我坚信，数据科学家和数据工程师应该具有相对较好的UNIX背景，以便主要用于文本处理和数据管道任务。对于数据清理任务来说，AWK是一个非常强大的工具，也是一个很好的技能。</p><p id="8cfb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">本教程的目标是向你介绍AWK世界。我们可以在AWK做很多其他的事情，如果你想了解更多，那么你唯一需要做的就是保持关注！</p></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><p id="bade" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><em class="pa">原载于</em><a class="ae ky" href="https://predictivehacks.com/awk-tutorial-for-data-scientists-and-engineers/" rel="noopener ugc nofollow" target="_blank"><em class="pa">https://predictivehacks.com</em></a><em class="pa">。</em></p></div></div>    
</body>
</html>