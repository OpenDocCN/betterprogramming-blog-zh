<html>
<head>
<title>How to Improve Code Quality With an Automatic Check in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过Go中的自动检查来提高代码质量</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-improve-code-quality-with-an-automatic-check-in-go-d18a5eb85f09?source=collection_archive---------5-----------------------#2020-03-09">https://betterprogramming.pub/how-to-improve-code-quality-with-an-automatic-check-in-go-d18a5eb85f09?source=collection_archive---------5-----------------------#2020-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eca1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用GoLand(或IntelliJ IDEA)在Go项目中进行静态代码分析的简单方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f76968319dc6bd4ea0ff525793f8833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jlDa3uXMKXYefGru.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/golangci/golangci-lint" rel="noopener ugc nofollow" target="_blank"> GolangCI-Lint </a></p></figure><p id="1b25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章将带您了解如何使用<a class="ae ky" href="https://www.jetbrains.com/go/" rel="noopener ugc nofollow" target="_blank"> GoLand </a>(或<a class="ae ky" href="https://www.jetbrains.com/ja-jp/idea/" rel="noopener ugc nofollow" target="_blank"> IntelliJ IDEA </a>)项目建立自动化代码检查。</p><p id="46d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Go中有一堆linter工具:</p><ul class=""><li id="6c9b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://golang.org/cmd/gofmt/" rel="noopener ugc nofollow" target="_blank">gofmt</a></code></li><li id="f350" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://github.com/mvdan/gofumpt" rel="noopener ugc nofollow" target="_blank">gofumpt</a></code></li><li id="60c2" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://godoc.org/golang.org/x/tools/cmd/goimports" rel="noopener ugc nofollow" target="_blank">goimports</a></code></li><li id="9590" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://github.com/mvdan/unindent" rel="noopener ugc nofollow" target="_blank">unindent</a></code></li><li id="1be3" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://github.com/kisielk/errcheck" rel="noopener ugc nofollow" target="_blank">errcheck</a></code></li><li id="9214" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b"><a class="ae ky" href="https://golang.org/cmd/vet/" rel="noopener ugc nofollow" target="_blank">go vet</a></code></li></ul><p id="e21b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都是格式化和检查代码的好工具。如果你想看看其他棉绒，你可以在<a class="ae ky" href="https://github.com/golangci/awesome-go-linters" rel="noopener ugc nofollow" target="_blank"> Awesome Go棉绒</a>看到它们。</p><p id="771a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要快速使用这些插件，您可以使用<a class="ae ky" href="https://github.com/golangci/golangci-lint" rel="noopener ugc nofollow" target="_blank"> GolangCI-Lint </a>，这是一个linters聚合器，允许您在一个设置中拥有多个linters。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="8c2d" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">属国</h1><p id="670c" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">这一部分的依赖关系如下:</p><ul class=""><li id="8e35" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">去1.16.9</li><li id="7a18" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">golangci-lint 1.42.1</li></ul></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c23f" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">安装文件监视器</h1><p id="1ea6" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">首先，我们将安装<a class="ae ky" href="https://plugins.jetbrains.com/plugin/7177-file-watchers" rel="noopener ugc nofollow" target="_blank">文件监视器</a>。文件观察者是一个插件，允许你在改变或保存文件时自动运行一个命令。这用于在IDE中运行linters。</p><p id="1409" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到插件，搜索文件监视器，并安装它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/274c6a9aa9a29dc6007c1baa7a576a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFpgMRh2NSzzXPgNaOb-fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文件观察者</p></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="313e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">安装GolangCI-Lint</h1><p id="3c51" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">为了安装GolangCI-Lint，我们将运行<a class="ae ky" href="https://github.com/golangci/golangci-lint#macos" rel="noopener ugc nofollow" target="_blank"> Brew </a>。</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="2988" class="nw mv it mh b gy nx ny l nz oa">brew install golangci/tap/golangci-lint<br/>brew upgrade golangci/tap/golangci-lint</span></pre><p id="67ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保版本:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="47c0" class="nw mv it mh b gy nx ny l nz oa">golangci-lint version</span><span id="a10f" class="nw mv it mh b gy ob ny l nz oa">golangci-lint has version 1.42.1</span></pre><p id="1b59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在GoLand中启用GolangCI-Lint。进入工具&gt;文件观察器&gt;+ &gt; golangci-lint:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/9117653cb8779d5aa334ad455841f25c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrw1a2pS037KMe-SyipglA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戈兰奇-林特</p></figure><p id="cf9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按如下方式填写，然后单击确定:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/362236c3e217637d191146d73b2e37a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDw2l1kfPL5dQ3satNQ8hQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戈兰奇-林特</p></figure><p id="1184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">arguments部分需要是<code class="fe me mf mg mh b">run --fix --fast $FileDir$</code>。</p><p id="2010" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，将<code class="fe me mf mg mh b">.golangci.yml</code>添加到您的项目中:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="022b" class="nw mv it mh b gy nx ny l nz oa"># <!-- -->.golangci.yml</span><span id="725c" class="nw mv it mh b gy ob ny l nz oa">linters:<br/>  disable-all: true</span><span id="7581" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span></pre><p id="9e5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">.golangci.yml</code>是一个配置文件，它允许您只在文件中配置特定于linters的选项，而不是在命令行中。默认情况下，GolangCI-Lint从当前工作目录的以下路径中搜索它:</p><ul class=""><li id="279e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe me mf mg mh b">.golangci.yml</code></li><li id="655f" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b">.golangci.toml</code></li><li id="145a" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><code class="fe me mf mg mh b">.golangci.json</code></li></ul><p id="bbca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，通过在这个文件中添加选项，您可以轻松地启用linters特性。</p><p id="a526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>默认情况下，GolangCI-Lint启用这些linters。</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="e35c" class="nw mv it mh b gy nx ny l nz oa">govet<br/>errcheck<br/>staticcheck<br/>unused<br/>gosimple<br/>structcheck<br/>varcheck<br/>ineffassign<br/>deadcode<br/>typecheck</span></pre><p id="648b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果想禁用它们，添加<code class="fe me mf mg mh b">linters: disable-all: true</code>。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0ad0" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">“黄金进口”</h1><p id="953d" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">接下来，我们将启用<code class="fe me mf mg mh b">goimports</code>。<code class="fe me mf mg mh b">goimports</code>修复导入行，添加缺失的行或删除未引用的行，它还以与<code class="fe me mf mg mh b">gofmt</code>相同的风格格式化代码。</p><p id="7b9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再来补充一下<code class="fe me mf mg mh b">.golangci.yml</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="6169" class="nw mv it mh b gy nx ny l nz oa"># <!-- -->.golangci.yml</span><span id="cff5" class="nw mv it mh b gy ob ny l nz oa">linters:<br/>  disable-all: true<br/><strong class="mh iu">  enable:<br/>    - goimports</strong></span><span id="5678" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span></pre><p id="3142" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来测试一下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/bce0750dfbac317ed2ef8c6429788b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/1*6Cpu7WvFAOJqd6Qivp_6NA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“黄金进口”</p></figure><p id="fe33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来效果不错。当您移除<code class="fe me mf mg mh b">fmt.Println()</code>时，<code class="fe me mf mg mh b">goimports</code>会自动删除导入，因为没有引用。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="596a" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">' golint '(已弃用)</h1><p id="9cd5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated"><code class="fe me mf mg mh b">golint</code>是Go源代码的linter工具，与<code class="fe me mf mg mh b">gofmt</code>不同。<code class="fe me mf mg mh b">gofmt</code>自动格式化代码，但是<code class="fe me mf mg mh b">golint</code>关心编码风格——所以它只是打印出一个警告。</p><p id="9891" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然<code class="fe me mf mg mh b">golint</code>是<a class="ae ky" href="https://github.com/golangci/golangci-lint/issues/1892" rel="noopener ugc nofollow" target="_blank">的复制品</a>，那么我们也可以使用<a class="ae ky" href="https://github.com/mgechev/revive" rel="noopener ugc nofollow" target="_blank"> revive </a>，它是Go的一个更快的处理器，运行与<code class="fe me mf mg mh b">golint</code>相同的规则。</p><p id="6c64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加到<code class="fe me mf mg mh b">.golangci.yml</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="d51d" class="nw mv it mh b gy nx ny l nz oa">linters:<br/>  disable-all: true<br/>  enable:<br/>    - goimports<br/><strong class="mh iu">    - revive</strong></span><span id="313b" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span></pre><p id="fb5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并将<a class="ae ky" href="https://github.com/mgechev/revive#recommended-configuration" rel="noopener ugc nofollow" target="_blank">推荐配置</a>添加到<code class="fe me mf mg mh b">.golangci.yml</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="33e6" class="nw mv it mh b gy nx ny l nz oa">linters:<br/>  disable-all: true<br/>  enable:<br/>    - goimports<br/>    - revive</span><span id="1288" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span><span id="5c59" class="nw mv it mh b gy ob ny l nz oa"><strong class="mh iu">linters-settings:<br/>  revive:<em class="of"><br/>    </em>rules:<br/>      - name: blank-imports<br/>      - name: context-as-argument<br/>      - name: context-keys-type<br/>      - name: dot-imports<br/>      - name: error-return<br/>      - name: error-strings<br/>      - name: error-naming<br/>      - name: exported<br/>      - name: if-return<br/>      - name: increment-decrement<br/>      - name: var-naming<br/>      - name: var-declaration<br/>      - name: package-comments<br/>      - name: range<br/>      - name: receiver-naming<br/>      - name: time-naming<br/>      - name: unexported-return<br/>      - name: indent-error-flow<br/>      - name: errorf<br/>      - name: empty-block<br/>      - name: superfluous-else<br/>      - name: unused-parameter<br/>      - name: unreachable-code<br/>      - name: redefines-builtin-id</strong></span></pre><p id="9e6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想禁用规则，像这样添加<code class="fe me mf mg mh b">disable: true</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="3ffe" class="nw mv it mh b gy nx ny l nz oa">linters-settings:<br/>  revive:<em class="of"><br/>    </em>rules:<br/>      - name: blank-imports<br/>      - name: context-as-argument<br/>      - name: context-keys-type<br/><strong class="mh iu">        disabled: true<br/></strong>      - name: ...</span></pre><p id="f910" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来测试一下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/b5932ac584f76ac07a62c3626d05c691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZ-bh2IBBw1-t6aQJWbdkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“复活”</p></figure><p id="09a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你创建函数时，<code class="fe me mf mg mh b">revive</code>会自动警告你没有关于它的注释。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="da4a" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">govet</h1><p id="89f6" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated"><code class="fe me mf mg mh b">govet</code>检查可疑的构造代码，例如<code class="fe me mf mg mh b">Printf</code>中变量的隐藏和错误的参数调用。</p><p id="3e50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再来补充一下<code class="fe me mf mg mh b">.golangci.yml</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="e9d6" class="nw mv it mh b gy nx ny l nz oa"># <!-- -->.golangci.yml</span><span id="3813" class="nw mv it mh b gy ob ny l nz oa">linters:<br/>  disable-all: true<br/>  enable:<br/>    - goimports<br/>    - golint<br/><strong class="mh iu">    - govet</strong></span><span id="3aa4" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span></pre><p id="ef1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想检查代码中变量的隐藏，添加<code class="fe me mf mg mh b">linters-settings</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="6029" class="nw mv it mh b gy nx ny l nz oa">linters:<br/>  disable-all: true<br/>  enable:<br/>    - goimports<br/>    - golint<br/>    - govet</span><span id="b6f0" class="nw mv it mh b gy ob ny l nz oa"><strong class="mh iu">linters-settings:<br/>  govet:<br/>    check-shadowing: true</strong></span><span id="afa6" class="nw mv it mh b gy ob ny l nz oa">issues:<br/>  exclude-use-default: false</span></pre><p id="3328" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不确定变量的隐藏，你可以查看“<a class="ae ky" href="http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html#vars_shadow" rel="noopener ugc nofollow" target="_blank"> 50个Go阴影:新Golang开发者的陷阱、陷阱和常见错误</a>”中的“意外变量隐藏”部分，这对Go新手非常有用。</p><p id="2599" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来测试一下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/7d26640782ed11b4df3a7e089f673a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEmuy7YRQ3z87OvNQUtToQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">变量的阴影</p></figure><p id="a44a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来不错。<code class="fe me mf mg mh b">govet</code>会警告你有可能导致运行时不必要错误的可疑代码。您可以在启动它之前编辑它并避免错误。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="196d" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">预提交</h1><p id="ba58" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果你在一个团队中工作，并且想要在提交之前通过运行linter来保持代码库的整洁，你可以使用<a class="ae ky" href="https://pre-commit.com/" rel="noopener ugc nofollow" target="_blank">预提交</a>来运行钩子。</p><p id="210e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们先安装预提交:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="30fc" class="nw mv it mh b gy nx ny l nz oa">brew install pre-commit</span></pre><p id="fd5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后像这样创建一个<code class="fe me mf mg mh b">.pre-commit-config.yaml</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="9751" class="nw mv it mh b gy nx ny l nz oa">repos:<br/>  - repo: https://github.com/golangci/golangci-lint<br/>    rev: v1.42.1<br/>    hooks:<br/>      - id: golangci-lint</span></pre><p id="61e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并运行<code class="fe me mf mg mh b">pre-commit install</code>以便设置git钩子脚本。</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="c728" class="nw mv it mh b gy nx ny l nz oa">pre-commit install</span></pre><p id="9992" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然您可以在提交之前检查您的更改是否有效。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/9751156b02b0c3f2e877ad8efd0852e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fIENdVTB_bYUjVm4WRfm0Q.png"/></div></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="1c44" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">创建安装文件</h1><p id="6d41" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">最后，为了让您的项目快速启动，让我们创建一个设置文件来简化上述过程。</p><p id="c80b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样创建<code class="fe me mf mg mh b">Makefile</code>:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="fd0c" class="nw mv it mh b gy nx ny l nz oa"># Set up tools<br/>.PHONY: install<br/>install:<br/>   brew install pre-commit<br/>   pre-commit --version<br/>   pre-commit install<br/>   go install github.com/golangci/golangci-lint/cmd/golangci-lint@v1.42.1</span></pre><p id="a9b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并运行命令:</p><pre class="kj kk kl km gt ns mh nt nu aw nv bi"><span id="bc0f" class="nw mv it mh b gy nx ny l nz oa">make install</span></pre><h1 id="cd18" class="mu mv it bd mw mx oj mz na nb ok nd ne jz ol ka ng kc om kd ni kf on kg nk nl bi translated">结论</h1><p id="79a5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">就是这样！你可以在GolangCI-Lint <a class="ae ky" href="https://github.com/golangci/golangci-lint#supported-linters" rel="noopener ugc nofollow" target="_blank">这里</a>看到支持的linters，也可以在这里找到示例配置文件<a class="ae ky" href="https://github.com/golangci/golangci-lint/blob/master/.golangci.example.yml" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="ed6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经介绍了如何通过在IDE中使用GolangCI-Lint自动检查和格式化来改进代码。正如我所说，Go中有很多有用的linter，此外，您可以创建自己的自定义linter，并在GolangCI-Lint中启用它们。</p><p id="a8d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这对你有所帮助。</p></div></div>    
</body>
</html>