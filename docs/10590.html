<html>
<head>
<title>3 Tips on API Responses for Backend Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">后端开发人员API响应的3个技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-tips-on-api-responses-for-backend-developers-8df31c23882e?source=collection_archive---------7-----------------------#2022-01-17">https://betterprogramming.pub/3-tips-on-api-responses-for-backend-developers-8df31c23882e?source=collection_archive---------7-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="31b3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于API响应，我希望我已经知道了什么</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6afad417fc32589aa7f916472725ec1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Fd1SsWvUllf_5mGC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加布里埃尔·海因策在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="bd3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我现在做全栈web开发者已经4年了，但是我还记得我早期的奋斗。尽管我认为前端开发并不容易，但我一直认为后端开发是我工作中最棘手的部分。</p><p id="b2fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">距离我编写第一个API已经有一段时间了，从那以后我学到了很多。具体来说，在成为后端开发人员之前，我希望知道如何产生完美的API响应。现在，是时候分享它们了，这样任何阅读本文的后端开发人员都可以从中受益。</p><p id="4dd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来深入研究这3个关于API响应的技巧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dbdc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">总是返回一个对象</h1><p id="ad38" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当构建返回单个值的API时，您可能会尝试直接序列化它，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始API响应</p></figure><p id="4a3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这实际上是一个有效的JSON响应，如下所示:</p><ul class=""><li id="e9eb" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">字符串(例如<code class="fe nk nl nm nn b">"Hello world"</code>)</li><li id="2369" class="nb nc it lb b lc no lf np li nq lm nr lq ns lu ng nh ni nj bi translated">一个数字(例如<code class="fe nk nl nm nn b">1</code>)</li><li id="2d6a" class="nb nc it lb b lc no lf np li nq lm nr lq ns lu ng nh ni nj bi translated">一个布尔值(如<code class="fe nk nl nm nn b">true</code>)</li><li id="8df1" class="nb nc it lb b lc no lf np li nq lm nr lq ns lu ng nh ni nj bi translated"><code class="fe nk nl nm nn b">null</code></li></ul><p id="79ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能希望这样做来保持API响应的干净和简单，但这实际上是一种糟糕的方法。我来解释一下原因。</p><p id="c50b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您需要让API返回多个值。这是一个相当常见的场景。毕竟，您无法知道您的API需要如何发展才能满足未来的需求。在这种情况下，您将被迫将API响应转换为对象，从而彻底改变API响应。</p><p id="fc37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，新的响应将是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新的API响应</p></figure><p id="8542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个小小的改变将迫使任何调用该API的开发人员相应地更新他们的代码。这是因为API最初返回的数组现在存储在<code class="fe nk nl nm nn b">result</code>字段中，这在旧的响应中没有出现。</p><p id="8a12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题在于原始的API响应，它应该总是一个对象。特别是，通过生成如下响应，当添加新字段时，开发人员不必更改他们的逻辑。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最初的API响应应该是怎样的</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cd9c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">除了JSON，还有其他数据格式</h1><p id="5151" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">JSON是您通常想要使用的数据格式。同时，你必须记住，HTTP头可以采用许多可能的MIME类型。<code class="fe nk nl nm nn b">application/json</code>不是唯一可用的。</p><p id="053f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体来说，可能会要求您检索一些数据并生成纯文本文件或结构化文件，如CSV文件。这确实发生在我身上，正如这篇文章中所描述的。</p><div class="nt nu gp gr nv nw"><a href="https://codeburst.io/returning-csv-content-from-an-api-in-spring-boot-63ea82bbcf0f" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">从Spring Boot的API返回CSV内容</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">通过直接返回CSV数据来避免转换开销</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">codeburst.io</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><p id="cfc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，您的方法可能是开发一个用JSON返回所需数据的API。然后，让调用者处理将其转换成所需格式的过程。虽然这种方法没有错误，但不是最好的方法。</p><p id="f325" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你不应该把数据检索过程和数据转换过程分开，只是为了让你的API更加标准。因为您可以直接返回以所需格式构造的数据，所以您应该开发一个自定义API来实现这一点。</p><p id="3a4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管与其他API相比，这个API可能看起来非常规，但它将直接满足您的需求。此外，将整个逻辑放在一个地方会更加优雅和易于维护。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f1f1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">不要省略<code class="fe nk nl nm nn b">null</code>值</h1><p id="f7ca" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如<a class="ae ky" href="https://www.ecma-international.org/publications-and-standards/standards/ecma-404/" rel="noopener ugc nofollow" target="_blank"> ECMA-404 </a>标准所述，<code class="fe nk nl nm nn b">null</code>是一个有效的JSON值。</p><blockquote class="ol om on"><p id="821c" class="kz la oo lb b lc ld ju le lf lg jx lh op lj lk ll oq ln lo lp or lr ls lt lu im bi translated">一个<em class="it">值</em>可以是双引号中的<em class="it">字符串</em>，或者是<em class="it">数字</em>，或真或假或空，或者是<em class="it">对象</em>或<em class="it">数组— </em> <a class="ae ky" href="https://www.json.org/json-en.html" rel="noopener ugc nofollow" target="_blank">引入JSON </a></p></blockquote><p id="7f75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开发人员通常倾向于从他们的回答中过滤掉所有的<code class="fe nk nl nm nn b">null</code>值，以使它们更简洁。这本身并没有错，尤其是当性能和网络使用是优先考虑的因素时。事实上，JSON越大，下载和解析它需要的时间就越多。</p><p id="7629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，从JSON响应中省略<code class="fe nk nl nm nn b">null</code>值不应该是首选方法。</p><p id="bd80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一，因为<code class="fe nk nl nm nn b">null</code>和缺失值在JSON中有两种不同的含义。第一个表示“无值”，第二个表示“无给定值”<em class="oo">。</em>具体来说，如果你熟悉JavaScript，这和<code class="fe nk nl nm nn b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null" rel="noopener ugc nofollow" target="_blank">null</a></code>和<code class="fe nk nl nm nn b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Glossary/undefined" rel="noopener ugc nofollow" target="_blank">undefined</a></code>的区别是一样的。差别是微妙的，但是能够区分这两种细微差别可能是至关重要的。</p><p id="0d19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二，返回一个响应，它的字段根据它们的值而变化，这很容易使调用API的开发人员感到困惑。原因是API的响应应该总是一致的。不遵守这一原则很容易导致失败，也使调试过程更加复杂。</p><p id="992f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三，缺少值会引入不必要的不确定性。调用API的开发人员可能会奇怪为什么省略了一些字段。因为弄清楚这是不是故意的可能不容易，这将导致不必要的怀疑。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b309" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="2e49" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为您的API找到正确的响应是很棘手的，这取决于您的需求。然而，有几个小贴士可以让你避免将来因为过去的错误决定而头疼。在这里，我们看了我认为的关于API响应的3个最重要的技巧，以我作为高级后端开发人员的经验为依据。我已经成功地使用它们很长时间了，我希望在编写我的第一个API之前就了解它们。</p><p id="454c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望我的故事对你有所帮助。如果有任何问题、意见或建议，请随时联系我。</p></div></div>    
</body>
</html>