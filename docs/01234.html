<html>
<head>
<title>How To Use Mixins in Your Vue.js Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在你的Vue.js应用中使用Mixins</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-mixins-in-you-vue-js-apps-b3cf6638cb03?source=collection_archive---------4-----------------------#2019-08-25">https://betterprogramming.pub/how-to-use-mixins-in-you-vue-js-apps-b3cf6638cb03?source=collection_archive---------4-----------------------#2019-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f23d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Mixins是可以直接集成到Vue.js组件中的代码片段</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/511fc5c1e406cb37834bc03e41edae3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QxcDo-ZGgoKmmOnGDgKa-A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@flpschi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">费利佩·斯基亚罗利</a>在<a class="ae ky" href="https://unsplash.com/search/photos/mix?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8663" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mixins是从一个<a class="ae ky" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>应用的其他部分分离出来的代码片段，可以合并到组件中。一旦它们被合并，它们就像组件中的其他功能一样工作。</p><p id="879e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它可以设置直接绑定到模板的变量，并将它们合并到Vue.js组件的组件主对象中。Mixins通过组件的<code class="fe lv lw lx ly b">mixins</code>字段合并到组件中。它需要一个数组<code class="fe lv lw lx ly b">mixins</code>。</p><p id="34d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将想要合并到<code class="fe lv lw lx ly b">mixin</code>对象中的组件对象的属性名，可以选择要合并到组件对象的哪个部分。</p><p id="da2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果你想用你的mixin给<code class="fe lv lw lx ly b">methods</code>属性添加一个函数，那么，在你的mixin中，你把这个函数放在你的mixin的<code class="fe lv lw lx ly b">methods</code>对象中。</p><p id="08e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一部分，我们将构建一个显示来自纽约时报API的数据的应用程序。你可以在<a class="ae ky" href="https://developer.nytimes.com/" rel="noopener ugc nofollow" target="_blank">https://developer.nytimes.com/</a>注册一个API密匙。之后，我们可以开始构建应用程序。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="8886" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">开始建造</h1><p id="8434" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">要开始构建应用程序，我们必须安装Vue CLI。我们通过运行以下命令来实现这一点:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="2996" class="nh mh it ly b gy ni nj l nk nl">npm install -g @vue/cli</span></pre><p id="2c95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行Vue CLI需要Node.js 8.9或更高版本。我没能让Vue CLI在Windows版本的Node.js上运行，Ubuntu帮我运行Vue CLI没有问题。</p><p id="0873" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，为了创建项目文件夹和文件，我们运行:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="d914" class="nh mh it ly b gy ni nj l nk nl">vue create vue-material-nyt-app</span></pre><p id="1963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在向导中，我们不使用默认选项，而是选择“手动选择功能”。然后，我们通过按空格键从选项列表中选择<a class="ae ky" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel </a>、<a class="ae ky" href="https://router.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Router </a>和<a class="ae ky" href="https://vuex.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vuex </a>。如果它们是绿色的，就意味着它们被选中了。</p><p id="a1d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们需要安装一些库。我们需要安装一个HTTP客户端，一个用于格式化日期的库，一个用于从对象生成<code class="fe lv lw lx ly b">GET</code>查询字符串，另一个用于表单验证。</p><p id="f2db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们需要安装<a class="ae ky" href="https://vuematerial.io/" rel="noopener ugc nofollow" target="_blank"> Vue素材</a>库本身。我们通过运行以下命令来实现这一点:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="d3c1" class="nh mh it ly b gy ni nj l nk nl">npm i axios moment querystring vee-validate vue-material</span></pre><p id="5b63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">axios</code>是我们的HTTP客户端，<code class="fe lv lw lx ly b">moment</code>是操作日期，<code class="fe lv lw lx ly b">querystring</code>是从对象生成查询字符串，<code class="fe lv lw lx ly b">vee-validate</code>是Vue.js做验证的附加包，<code class="fe lv lw lx ly b">vue-material</code>是我们的<a class="ae ky" href="https://material.io/design/" rel="noopener ugc nofollow" target="_blank">素材设计</a>库。</p><p id="894f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经安装了所有的库，我们可以开始构建我们的应用程序了。</p><p id="db10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们创建一些组件。在<code class="fe lv lw lx ly b">views</code>文件夹中，我们创建了<code class="fe lv lw lx ly b">Home.vue</code>和<code class="fe lv lw lx ly b">Search.vue</code>。这些是我们页面的代码文件。</p><p id="796d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建一个<code class="fe lv lw lx ly b">mixins</code>文件夹，创建一个名为<code class="fe lv lw lx ly b">nytMixin.js</code>的文件。Mixins是代码片段，可以直接合并到我们的Vue.js组件中，就像直接在组件中一样使用。</p><p id="396a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们添加一些过滤器。过滤器是从一件事映射到另一件事的Vue.js代码。</p><p id="af23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建一个<code class="fe lv lw lx ly b">filters</code>文件夹并添加<code class="fe lv lw lx ly b">capitalize.js</code>和<code class="fe lv lw lx ly b">formatDate.js</code>。然后，在<code class="fe lv lw lx ly b">components</code>文件夹中，我们创建一个名为<code class="fe lv lw lx ly b">SearchResults.vue</code>的文件。<code class="fe lv lw lx ly b">components</code>文件夹包含不是页面的Vue.js组件。</p><p id="e4e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使组件之间的数据传递更容易、更有组织，我们使用Vuex进行状态管理。</p><p id="68f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们在运行<code class="fe lv lw lx ly b">vue create</code>时选择了Vuex，所以在我们的项目文件夹中应该有一个<code class="fe lv lw lx ly b">store.js</code>。如果没有，就创建它。在<code class="fe lv lw lx ly b">store.js</code>中，我们输入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="6f5e" class="nh mh it ly b gy ni nj l nk nl">import Vue from 'vue'<br/>import Vuex from 'vuex'</span><span id="4ac0" class="nh mh it ly b gy nm nj l nk nl">Vue.use(Vuex)</span><span id="f8a7" class="nh mh it ly b gy nm nj l nk nl">export default new Vuex.Store({<br/>  state: {<br/>    searchResults: []<br/>  },<br/>  mutations: {<br/>    setSearchResults(state, payload) {<br/>      state.searchResults = payload;<br/>    }<br/>  },<br/>  actions: {</span><span id="9619" class="nh mh it ly b gy nm nj l nk nl">}<br/>})</span></pre><p id="b0d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">state</code>对象是存储状态的地方。对象是我们可以操纵自己状态的地方。</p><p id="08c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们在代码中调用<code class="fe lv lw lx ly b">this.$store.commit(“setSearchResults”, searchResults)</code>时，假设<code class="fe lv lw lx ly b">searchResults</code>被定义，那么<code class="fe lv lw lx ly b">state.searchResults</code>将被设置为<code class="fe lv lw lx ly b">searchResults</code>。然后我们可以使用<code class="fe lv lw lx ly b">this.$store.state.searchResults</code>得到结果。</p><p id="6398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要添加一些样板代码到我们的应用程序中。首先，我们添加我们的过滤器。在<code class="fe lv lw lx ly b">capitalize.js</code>中，我们把:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="5b99" class="nh mh it ly b gy ni nj l nk nl">export const capitalize = (str) =&gt; {<br/>    if (typeof str == 'string') {<br/>        if (str == 'realestate') {<br/>            return 'Real Estate';<br/>        }<br/>        if (str == 'sundayreview') {<br/>            return 'Sunday Review';<br/>        }</span><span id="9cae" class="nh mh it ly b gy nm nj l nk nl">if (str == 'tmagazine') {<br/>            return 'T Magazine';<br/>        }<br/>        return `${str[0].toUpperCase()}${str.slice(1)}`;<br/>    }<br/>}</span></pre><p id="1c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这使我们能够在<a class="ae ky" href="https://developer.nytimes.com/docs/top-stories-product/1/routes/%7Bsection%7D.json/get" rel="noopener ugc nofollow" target="_blank">头条新闻链接</a>中列出我们的纽约时报栏目名称。然后，在<code class="fe lv lw lx ly b">formatDate.js</code>中，为了将我们的日期格式化为人类可读的格式，我们输入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="ce8e" class="nh mh it ly b gy ni nj l nk nl">import * as moment from 'moment';</span><span id="42bd" class="nh mh it ly b gy nm nj l nk nl">export const formatDate = (date) =&gt; {<br/>    if (date) {<br/>        return moment(date).format('YYYY-MM-DD hh:mm A');<br/>    }<br/>}</span></pre><p id="2740" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">main.js</code>中，我们放入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="2c88" class="nh mh it ly b gy ni nj l nk nl">import Vue from 'vue'<br/>import App from './App.vue'<br/>import router from './router'<br/>import store from './store'<br/>import VueMaterial from 'vue-material';<br/>import VeeValidate from 'vee-validate';<br/>import 'vue-material/dist/vue-material.min.css'<br/>import 'vue-material/dist/theme/default.css'<br/>import { formatDate } from './filters/formatDate';<br/>import { capitalize } from './filters/capitalize';</span><span id="2419" class="nh mh it ly b gy nm nj l nk nl">Vue.config.productionTip = false;</span><span id="2fc9" class="nh mh it ly b gy nm nj l nk nl">Vue.use(VueMaterial);<br/>Vue.use(VeeValidate);<br/>Vue.filter('formatDate', formatDate);<br/>Vue.filter('capitalize', capitalize);</span><span id="bcb2" class="nh mh it ly b gy nm nj l nk nl">new Vue({<br/>  router,<br/>  store,<br/>  render: h =&gt; h(App)<br/>}).$mount('#app')</span></pre><p id="68b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意在上面的文件中，我们必须通过调用<code class="fe lv lw lx ly b">Vue.use</code>在Vue.js中注册我们使用的库，这样它们就可以在我们的应用模板中使用。</p><p id="a462" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在过滤器函数上调用<code class="fe lv lw lx ly b">Vue.filter</code>，这样我们就可以在模板中使用它们，方法是在变量的右边添加一个管道和过滤器名称。</p><p id="5374" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在<code class="fe lv lw lx ly b">router.js</code>中，当我们输入列出的URL时，我们可以进入页面，我们输入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="f254" class="nh mh it ly b gy ni nj l nk nl">import Vue from 'vue'<br/>import Router from 'vue-router'<br/>import Home from './views/Home.vue';<br/>import Search from './views/Search.vue';</span><span id="8e65" class="nh mh it ly b gy nm nj l nk nl">Vue.use(Router)</span><span id="25a7" class="nh mh it ly b gy nm nj l nk nl">export default new Router({<br/>  mode: 'history',<br/>  base: process.env.BASE_URL,<br/>  routes: [<br/>    {<br/>      path: '/',<br/>      name: 'home',<br/>      component: Home<br/>    },<br/>    {<br/>      path: '/search',<br/>      name: 'search',<br/>      component: Search<br/>    }<br/>  ]<br/>})</span></pre><p id="021f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">mode: ‘history’</code>意味着在基本URL和我们的路由之间不会有散列符号。如果我们部署我们的应用程序，我们需要配置我们的web服务器，以便所有请求都将被重定向到<code class="fe lv lw lx ly b">index.html</code>，这样我们在重新加载应用程序时就不会出错。</p><p id="7796" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在Apache中，我们做到了:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="388d" class="nh mh it ly b gy ni nj l nk nl">&lt;IfModule mod_rewrite.c&gt;<br/>  RewriteEngine On<br/>  RewriteBase /<br/>  RewriteRule ^index\.html$ - [L]<br/>  RewriteCond %{REQUEST_FILENAME} !-f<br/>  RewriteCond %{REQUEST_FILENAME} !-d<br/>  RewriteRule . /index.html [L]<br/>&lt;/IfModule&gt;</span></pre><p id="1332" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且，在<a class="ae ky" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank"> Nginx </a>中，我们把:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="ae9f" class="nh mh it ly b gy ni nj l nk nl">location / {<br/>  try_files $uri $uri/ /index.html;<br/>}</span></pre><p id="ad88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关如何在您的web服务器中执行相同操作的说明，请参阅您的web服务器的文档。</p><p id="8786" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们为组件编写代码。在<code class="fe lv lw lx ly b">SearchResult.vue</code>中，我们放入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="f8d5" class="nh mh it ly b gy ni nj l nk nl">&lt;template&gt;<br/>  &lt;div id="search-results"&gt;<br/>    &lt;md-card v-for="s in searchResults" :key="s.id"&gt;<br/>      &lt;md-card-header&gt;<br/>        &lt;div class="md-title title"&gt;{{s.headline.main}}&lt;/div&gt;<br/>      &lt;/md-card-header&gt;</span><span id="0609" class="nh mh it ly b gy nm nj l nk nl">&lt;md-card-content&gt;<br/>        &lt;md-list&gt;<br/>          &lt;md-list-item&gt;Date: {{s.pub_date | formatDate}}&lt;/md-list-item&gt;<br/>          &lt;md-list-item&gt;<br/>            &lt;a :href="s.web_url"&gt;Link&lt;/a&gt;<br/>          &lt;/md-list-item&gt;<br/>          &lt;md-list-item v-if="s.byline.original"&gt;{{s.byline.original}}&lt;/md-list-item&gt;<br/>          &lt;md-list-item&gt;{{s.lead_paragraph}}&lt;/md-list-item&gt;<br/>          &lt;md-list-item&gt;{{s.snippet}}&lt;/md-list-item&gt;<br/>        &lt;/md-list&gt;<br/>      &lt;/md-card-content&gt;<br/>    &lt;/md-card&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="54bd" class="nh mh it ly b gy nm nj l nk nl">&lt;script&gt;<br/>export default {<br/>  computed: {<br/>    searchResults() {<br/>      return this.$store.state.searchResults;<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="8128" class="nh mh it ly b gy nm nj l nk nl">&lt;style scoped&gt;<br/>.title {<br/>  margin: 0 15px !important;<br/>}</span><span id="9a99" class="nh mh it ly b gy nm nj l nk nl">#search-results {<br/>  margin: 0 auto;<br/>  width: 95vw;<br/>}</span><span id="8315" class="nh mh it ly b gy nm nj l nk nl">.md-title.title {<br/>  color: rgba(0, 0, 0, 0.87) !important;<br/>}<br/>&lt;/style&gt;</span></pre><p id="f366" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们从Vuex商店获取搜索结果并显示它的地方。</p><p id="2c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在应用程序的<code class="fe lv lw lx ly b">computed</code>属性的函数中返回<code class="fe lv lw lx ly b">this.$store.state.searchResults</code>，这样当商店的<code class="fe lv lw lx ly b">searchResults</code>状态更新时，搜索结果将自动刷新。</p><p id="d5bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">md-card</code>是一个卡片小部件，用于在一个框中显示数据。<code class="fe lv lw lx ly b">v-for</code>用于循环数组条目并显示所有内容。<code class="fe lv lw lx ly b">md-list</code>是一个列表小部件，用于在页面上整齐地显示列表中的项目。<code class="fe lv lw lx ly b">{{s.pub_date | formatDate}}</code>是我们应用<code class="fe lv lw lx ly b">formatDate</code>过滤器的地方。</p><p id="2094" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们写我们的<code class="fe lv lw lx ly b">mixin</code>。我们将在mixin中为HTTP调用添加代码。在<code class="fe lv lw lx ly b">nytMixin.js</code>中，我们把:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="8931" class="nh mh it ly b gy ni nj l nk nl">const axios = require('axios');<br/>const querystring = require('querystring');<br/>const apiUrl = '<a class="ae ky" href="https://api.nytimes.com/svc'" rel="noopener ugc nofollow" target="_blank">https://api.nytimes.com/svc'</a>;<br/>const apikey = 'your api key';</span><span id="3844" class="nh mh it ly b gy nm nj l nk nl">export const nytMixin = {<br/>    methods: {<br/>      getArticles(section) {<br/>            return axios.get(`${apiUrl}/topstories/v2/${section}.json?api-key=${apikey}`);<br/>      },</span><span id="901a" class="nh mh it ly b gy nm nj l nk nl">       searchArticles(data) {<br/>            let params = Object.assign({}, data);<br/>            params['api-key'] = apikey;<br/>            Object.keys(params).forEach(key =&gt; {<br/>                if (!params[key]) {<br/>                    delete params[key];<br/>                }<br/>            })<br/>            const queryString = querystring.stringify(params);<br/>            return axios.get(`${apiUrl}/search/v2/articlesearch.json?${queryString}`);<br/>       }<br/>    }<br/>}</span></pre><p id="aea0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们将函数放在对象的<code class="fe lv lw lx ly b">methods</code>属性中。这是因为我们希望将函数合并到组件的<code class="fe lv lw lx ly b">methods</code>属性中。</p><p id="8e09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一个对象在组件和mixin中有相同的名字，组件的对象将优先。</p><p id="79be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们返回对HTTP请求的承诺，以在每个函数中获取文章。在<code class="fe lv lw lx ly b">searchArticles</code>函数中，我们将传递给对象的消息传递到一个查询字符串中，我们将该字符串传递到我们的请求中。</p><p id="f01b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保将应用程序中的API键放入<code class="fe lv lw lx ly b">apiKey</code>常量中，并删除任何未定义的内容，使用:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="65d4" class="nh mh it ly b gy ni nj l nk nl">Object.keys(params).forEach(key =&gt; {<br/>  if (!params[key]) {<br/>     delete params[key];<br/>  }<br/>})</span></pre><p id="a0e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来在<code class="fe lv lw lx ly b">Home.vue</code>，我们把:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="df5c" class="nh mh it ly b gy ni nj l nk nl">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;div class="center"&gt;<br/>      &lt;h1&gt;{{selectedSection | capitalize}}&lt;/h1&gt;<br/>      &lt;br /&gt;<br/>      &lt;md-menu&gt;<br/>        &lt;md-button class="md-raised" md-menu-trigger&gt;Sections&lt;/md-button&gt;</span><span id="1046" class="nh mh it ly b gy nm nj l nk nl">&lt;md-menu-content&gt;<br/>          &lt;md-menu-item v-for="s in sections" :key="s" <a class="ae ky" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="selectSection(s)"&gt;{{s | capitalize}}&lt;/md-menu-item&gt;<br/>        &lt;/md-menu-content&gt;<br/>      &lt;/md-menu&gt;<br/>    &lt;/div&gt;<br/>    &lt;br /&gt;</span><span id="9eaf" class="nh mh it ly b gy nm nj l nk nl">&lt;md-card v-for="a in articles" :key="a.id"&gt;<br/>      &lt;md-card-header&gt;<br/>        &lt;div class="md-title title"&gt;{{a.title}}&lt;/div&gt;<br/>      &lt;/md-card-header&gt;</span><span id="58f4" class="nh mh it ly b gy nm nj l nk nl">&lt;md-card-content&gt;<br/>        &lt;md-list&gt;<br/>          &lt;md-list-item&gt;Date: {{a.published_date | formatDate}}&lt;/md-list-item&gt;<br/>          &lt;md-list-item&gt;<br/>            &lt;a :href="a.url"&gt;Link&lt;/a&gt;<br/>          &lt;/md-list-item&gt;<br/>          &lt;md-list-item v-if="a.byline"&gt;{{a.byline}}&lt;/md-list-item&gt;<br/>          &lt;md-list-item&gt;{{a.abstract}}&lt;/md-list-item&gt;<br/>        &lt;/md-list&gt;<br/>        &lt;img<br/>          v-if="a.multimedia[a.multimedia.length - 1]"<br/>          :src="a.multimedia[a.multimedia.length - 1].url"<br/>          :alt="a.multimedia[a.multimedia.length - 1].caption"<br/>          class="image"<br/>        /&gt;<br/>      &lt;/md-card-content&gt;<br/>    &lt;/md-card&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="0c53" class="nh mh it ly b gy nm nj l nk nl">&lt;script&gt;<br/>import { nytMixin } from "../mixins/nytMixin";</span><span id="7acc" class="nh mh it ly b gy nm nj l nk nl">export default {<br/>  name: "home",<br/>  mixins: [nytMixin],<br/>  computed: {},</span><span id="0dbc" class="nh mh it ly b gy nm nj l nk nl">data() {<br/>    return {<br/>      selectedSection: "home",<br/>      articles: [],<br/>      sections: `arts, automobiles, books, business, fashion, food, health,<br/>    home, insider, magazine, movies, national, nyregion, obituaries,<br/>    opinion, politics, realestate, science, sports, sundayreview,<br/>    technology, theater, tmagazine, travel, upshot, world`<br/>        .replace(/ /g, "")<br/>        .split(",")<br/>    };<br/>  },</span><span id="1b42" class="nh mh it ly b gy nm nj l nk nl">beforeMount() {<br/>    this.getNewsArticles(this.selectedSection);<br/>  },</span><span id="0611" class="nh mh it ly b gy nm nj l nk nl">methods: {<br/>    async getNewsArticles(section) {<br/>      const response = await this.getArticles(section);<br/>      this.articles = response.data.results;<br/>    },</span><span id="5a83" class="nh mh it ly b gy nm nj l nk nl">selectSection(section) {<br/>      this.selectedSection = section;<br/>      this.getNewsArticles(section);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="4722" class="nh mh it ly b gy nm nj l nk nl">&lt;style scoped&gt;<br/>.image {<br/>  width: 100%;<br/>}</span><span id="676e" class="nh mh it ly b gy nm nj l nk nl">.title {<br/>  color: rgba(0, 0, 0, 0.87) !important;<br/>  margin: 0 15px !important;<br/>}<br/>&lt;/style&gt;</span></pre><p id="e1a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该页面组件是我们获取所选部分文章的地方，默认为<code class="fe lv lw lx ly b">home</code>部分。我们还有一个菜单，通过添加以下内容来选择我们想要查看的部分:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="56e0" class="nh mh it ly b gy ni nj l nk nl">&lt;md-menu&gt;<br/>  &lt;md-button class="md-raised" md-menu-trigger&gt;Sections&lt;/md-button&gt;</span><span id="41af" class="nh mh it ly b gy nm nj l nk nl">&lt;md-menu-content&gt;<br/>     &lt;md-menu-item v-for="s in sections" :key="s" <a class="ae ky" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="selectSection(s)"&gt;{{s | capitalize}}<br/>     &lt;/md-menu-item&gt;<br/>  &lt;/md-menu-content&gt;<br/>&lt;/md-menu&gt;</span></pre><p id="0d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们在承诺代码中使用了<code class="fe lv lw lx ly b">async</code>和<code class="fe lv lw lx ly b">await</code>关键字，而不是<code class="fe lv lw lx ly b">then</code>。它要短得多，并且<code class="fe lv lw lx ly b">then</code>和<code class="fe lv lw lx ly b">await</code>与<code class="fe lv lw lx ly b">async</code>之间的功能是等效的。</p><p id="d150" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，它在Internet Explorer中不受支持。在<code class="fe lv lw lx ly b">beforeMount</code>块中，我们运行<code class="fe lv lw lx ly b">this.getNewsArticles</code>在页面加载时获取文章。</p><p id="0ef5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在<code class="fe lv lw lx ly b">Search.vue</code>中，我们放入:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="ceea" class="nh mh it ly b gy ni nj l nk nl">&lt;template&gt;<br/>  &lt;div&gt;<br/>    &lt;div class="center"&gt;<br/>      &lt;h1&gt;Search&lt;/h1&gt;<br/>    &lt;/div&gt;<br/>    &lt;form <a class="ae ky" href="http://twitter.com/submit" rel="noopener ugc nofollow" target="_blank">@submit</a>="search" novalidate&gt;<br/>      &lt;md-field :class="{ 'md-invalid': errors.has('keyword') }"&gt;<br/>        &lt;label for="keyword"&gt;Keyword&lt;/label&gt;<br/>        &lt;md-input type="text" name="keyword" v-model="searchData.keyword" v-validate="'required'"&gt;&lt;/md-input&gt;<br/>        &lt;span class="md-error" v-if="errors.has('keyword')"&gt;{{errors.first('keyword')}}&lt;/span&gt;<br/>      &lt;/md-field&gt;</span><span id="8b0d" class="nh mh it ly b gy nm nj l nk nl">&lt;div&gt;<br/>        &lt;md-datepicker v-model="searchData.beginDate" :md-disabled-dates="disabledDates"&gt;<br/>          &lt;label&gt;Begin Date&lt;/label&gt;<br/>        &lt;/md-datepicker&gt;<br/>      &lt;/div&gt;</span><span id="9cbd" class="nh mh it ly b gy nm nj l nk nl">&lt;div&gt;<br/>        &lt;md-datepicker v-model="searchData.endDate" :md-disabled-dates="disabledDates"&gt;<br/>          &lt;label&gt;End Date&lt;/label&gt;<br/>        &lt;/md-datepicker&gt;<br/>      &lt;/div&gt;</span><span id="a077" class="nh mh it ly b gy nm nj l nk nl">&lt;md-field&gt;<br/>        &lt;label for="movie"&gt;Sort By&lt;/label&gt;<br/>        &lt;md-select v-model="searchData.sort"&gt;<br/>          &lt;md-option value="newest"&gt;Newest&lt;/md-option&gt;<br/>          &lt;md-option value="oldest"&gt;Oldest&lt;/md-option&gt;<br/>          &lt;md-option value="relevance"&gt;Relevance&lt;/md-option&gt;<br/>        &lt;/md-select&gt;<br/>      &lt;/md-field&gt;</span><span id="fc26" class="nh mh it ly b gy nm nj l nk nl">&lt;md-button class="md-raised" type="submit"&gt;Search&lt;/md-button&gt;<br/>    &lt;/form&gt;<br/>    &lt;SearchResults /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="7743" class="nh mh it ly b gy nm nj l nk nl">&lt;script&gt;<br/>import { nytMixin } from "../mixins/nytMixin";<br/>import SearchResults from "@/components/SearchResults.vue";<br/>import * as moment from "moment";</span><span id="5a12" class="nh mh it ly b gy nm nj l nk nl">export default {<br/>  name: "search",<br/>  mixins: [nytMixin],<br/>  components: {<br/>    SearchResults<br/>  },<br/>  computed: {<br/>    isFormDirty() {<br/>      return Object.keys(this.fields).some(key =&gt; this.fields[key].dirty);<br/>    }<br/>  },<br/>  data: () =&gt; {<br/>    return {<br/>      searchData: {<br/>        sort: "newest"<br/>      },<br/>      disabledDates: date =&gt; {<br/>        return +date &gt;= +new Date();<br/>      }<br/>    };<br/>  },<br/>  methods: {<br/>    async search(evt) {<br/>      evt.preventDefault();<br/>      if (!this.isFormDirty || this.errors.items.length &gt; 0) {<br/>        return;<br/>      }<br/>      const data = {<br/>        q: this.searchData.keyword,<br/>        begin_date: moment(this.searchData.beginDate).format("YYYYMMDD"),<br/>        end_date: moment(this.searchData.endDate).format("YYYYMMDD"),<br/>        sort: this.searchData.sort<br/>      };<br/>      const response = await this.searchArticles(data);<br/>      this.$store.commit("setSearchResults", response.data.response.docs);<br/>    }<br/>  }<br/>};<br/>&lt;/script&gt;</span></pre><p id="2465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们用来搜索文章的表单。我们还有两个日期选择器来标记用户，以设置开始和结束日期。我们只将日期限制在今天和更早，以便搜索查询有意义。</p><p id="5982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个街区:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="50e6" class="nh mh it ly b gy ni nj l nk nl">&lt;md-field :class="{ 'md-invalid': errors.has('keyword') }"&gt;<br/>  &lt;label for="keyword"&gt;Keyword&lt;/label&gt;<br/>  &lt;md-input type="text" name="keyword" v-model="searchData.keyword" v-validate="'required'"&gt;&lt;/md-input&gt;<br/>  &lt;span class="md-error" v-if="errors.has('keyword')"&gt;{{errors.first('keyword')}}&lt;/span&gt;<br/>&lt;/md-field&gt;</span></pre><p id="0972" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe lv lw lx ly b">vee-validate</code>来检查所需的搜索关键字字段是否已填写。如果不是，它将显示一条错误消息并阻止查询继续进行。</p><p id="bf78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还将<code class="fe lv lw lx ly b">SearchResults</code>组件嵌套到<code class="fe lv lw lx ly b">Search</code>页面组件中，包括:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="9640" class="nh mh it ly b gy ni nj l nk nl">components: {<br/>  SearchResults<br/>}</span></pre><p id="8d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在模板中的<code class="fe lv lw lx ly b">script</code>标签和<code class="fe lv lw lx ly b">&lt;SearchResults /&gt;</code>之间。</p><p id="fa2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们通过在<code class="fe lv lw lx ly b">App.vue</code>中输入以下内容来添加顶部栏和菜单:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="f1b0" class="nh mh it ly b gy ni nj l nk nl">&lt;template&gt;<br/>  &lt;div id="app"&gt;<br/>    &lt;md-toolbar&gt;<br/>      &lt;md-button class="md-icon-button" <a class="ae ky" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="showNavigation = true"&gt;<br/>        &lt;md-icon&gt;menu&lt;/md-icon&gt;<br/>      &lt;/md-button&gt;<br/>      &lt;h3 class="md-title"&gt;New York Times App&lt;/h3&gt;<br/>    &lt;/md-toolbar&gt;<br/>    &lt;md-drawer :md-active.sync="showNavigation" md-swipeable&gt;<br/>      &lt;md-toolbar class="md-transparent" md-elevation="0"&gt;<br/>        &lt;span class="md-title"&gt;New York Times App&lt;/span&gt;<br/>      &lt;/md-toolbar&gt;</span><span id="7d2c" class="nh mh it ly b gy nm nj l nk nl">&lt;md-list&gt;<br/>        &lt;md-list-item&gt;<br/>          &lt;router-link to="/"&gt;<br/>            &lt;span class="md-list-item-text"&gt;Home&lt;/span&gt;<br/>          &lt;/router-link&gt;<br/>        &lt;/md-list-item&gt;</span><span id="920b" class="nh mh it ly b gy nm nj l nk nl">&lt;md-list-item&gt;<br/>          &lt;router-link to="/search"&gt;<br/>            &lt;span class="md-list-item-text"&gt;Search&lt;/span&gt;<br/>          &lt;/router-link&gt;<br/>        &lt;/md-list-item&gt;<br/>      &lt;/md-list&gt;<br/>    &lt;/md-drawer&gt;</span><span id="9a51" class="nh mh it ly b gy nm nj l nk nl">&lt;router-view /&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="0553" class="nh mh it ly b gy nm nj l nk nl">&lt;script&gt;<br/>export default {<br/>  name: "app",<br/>  data: () =&gt; {<br/>    return {<br/>      showNavigation: false<br/>    };<br/>  }<br/>};<br/>&lt;/script&gt;</span><span id="fecd" class="nh mh it ly b gy nm nj l nk nl">&lt;style&gt;<br/>.center {<br/>  text-align: center;<br/>}</span><span id="b78c" class="nh mh it ly b gy nm nj l nk nl">form {<br/>  width: 95vw;<br/>  margin: 0 auto;<br/>}</span><span id="6a7a" class="nh mh it ly b gy nm nj l nk nl">.md-toolbar.md-theme-default {<br/>  background: #009688 !important;<br/>  height: 60px;<br/>}</span><span id="2de2" class="nh mh it ly b gy nm nj l nk nl">.md-title,<br/>.md-toolbar.md-theme-default .md-icon {<br/>  color: #fff !important;<br/>}<br/>&lt;/style&gt;</span></pre><p id="d9cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想要一个带有左导航抽屉的顶栏，你必须精确地遵循上面的代码结构。</p><p id="3dff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">写完所有代码后，我们有以下代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/6460c255c88457eef881c4b5c5c8ebef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKnz1K5Tjvd0uAUzvxJqUg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/39764ce81dbcc8326f4c0914399e7e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtCTfLpQxXyB9eij8jpmLg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1940fc6f419d88b27b5aa3b2a33f4f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQt5F5z2R__LqLHhsIqgDA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/1c8bb4f86d26001b400d055b806318f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NeCEPzCgjai8nZz_m-Akag.png"/></div></div></figure></div></div>    
</body>
</html>