<html>
<head>
<title>Auto-Magic Dependency Management for Monorepo Projects Using Dependabot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Dependabot对Monorepo项目进行自动魔法依赖管理</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/auto-magic-dependency-management-for-monorepo-projects-using-dependabot-f5796f4d6c28?source=collection_archive---------18-----------------------#2020-01-07">https://betterprogramming.pub/auto-magic-dependency-management-for-monorepo-projects-using-dependabot-f5796f4d6c28?source=collection_archive---------18-----------------------#2020-01-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c92d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">忘掉过时的套餐，晚上睡得更香</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/710cd58daef5c82cd3937fff4135a889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zDxebIOnsGSCiIoxirCzBA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@olly?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">布鲁斯·马斯</a>从<a class="ae ky" href="https://www.pexels.com/photo/woman-in-grey-jacket-sits-on-bed-uses-grey-laptop-935743/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><p id="069b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着<a class="ae ky" href="https://dependabot.com/" rel="noopener ugc nofollow" target="_blank">dependent bot</a>加入GitHub，自动化依赖升级将成为惯例。</p><p id="aa22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">切断依赖管理可以为开发人员节省大量时间。</p><p id="ed9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，为一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Monorepo" rel="noopener ugc nofollow" target="_blank">单库</a>项目设置Dependabot是一个不小的问题。</p><p id="017d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将使用一个用<a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>、Express和<a class="ae ky" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>构建的跨平台应用程序作为例子，来演示如何为一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Monorepo" rel="noopener ugc nofollow" target="_blank"> monorepo </a>项目设置auto-magic dependency升级。</p><p id="20f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章中使用的代码来自:</p><div class="lv lw gp gr lx ly"><a href="https://github.com/tianhaoz95/iwfp" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">天昊95/iwfp</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">愿百分之五的原力与你同在。iwfp(我要百分之五)是一个帮助每个使用信用卡的人的工具…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3794" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">第一步。编写一个依赖机器人配置文件</h1><p id="efaf" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">默认情况下，Dependabot只会扫描项目的根目录。</p><p id="3c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了通知它要扫描多个工作区，我们需要将一个<a class="ae ky" href="https://dependabot.com/docs/config-file/" rel="noopener ugc nofollow" target="_blank">配置文件</a>放在我们项目的根目录下。</p><p id="1207" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">配置文件描述了:</p><ul class=""><li id="e884" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">工作区及其相对目录和注册表类型的列表。</li><li id="fff7" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">您希望如何升级它们，包括升级频率、批准者和标签等。</li></ul><p id="77b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的monorepo项目的示例配置文件，包含三个子项目(一个<a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>应用程序、一个<a class="ae ky" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>文档站点和一个Express后端服务器):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/cb84423644e8b3ea4511eb810e804a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V45MDGqCrAfbaVu0vJPeFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://github.com/tianhaoz95/iwfp/blob/master/.dependabot/config.yml" rel="noopener ugc nofollow" target="_blank">依赖机器人配置文件</a>来自<a class="ae ky" href="https://github.com/tianhaoz95/iwfp" rel="noopener ugc nofollow" target="_blank">天昊95/iwfp </a></p></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="88a8" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">第二步。用构建测试保护升级(可选)</h1><p id="b9d3" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">由于包会在版本之间引入破坏性的变化，我建议在合并之前建立一个构建测试来确保兼容性。</p><p id="dbdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是针对包兼容性问题的拉请求检查示例:</p><div class="kj kk kl km gt ab cb"><figure class="og kn oh oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/23e28294f9d4793daeed2d7c33c875ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*YXNmP6hDhj8mmzZX1Mvf-A.png"/></div></figure><figure class="og kn om oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/967081157d2ac62d6c88549ac99ac302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*iLj1K7-QmL77HSmw5Bc-oQ.png"/></div></figure></div><div class="ab cb"><figure class="og kn on oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/f848dc8833997ef6ca04a63e21afdb50.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*KM1ILbKaZglboFiIiOTQXA.png"/></div></figure><figure class="og kn oo oi oj ok ol paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/db2e269795e09478767e5d08885c98c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*ATDV0coV-nD9Dc1IMZYhUg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk op di oq or translated"><a class="ae ky" href="https://github.com/tianhaoz95/iwfp/blob/master/.github/workflows/merge.yml" rel="noopener ugc nofollow" target="_blank">示例工作流程</a>保护来自<a class="ae ky" href="https://github.com/tianhaoz95/iwfp" rel="noopener ugc nofollow" target="_blank">天昊95/iwfp </a>的拉动请求</p></figure></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="89fe" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">第三步。审查和批准自动升级请求</h1><p id="d395" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">有了上面的设置，现在Dependabot可以识别所有的子项目，它会在每次一个包发布一个新版本时打开一个pull请求。</p><p id="1436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是快速查看(绿色勾号是我们的兼容性检查):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/e1731e8b53c01c1c8e83658dd36c28f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ho_dx1uCPjaUDKW3EXT4Gg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://github.com/tianhaoz95/iwfp" rel="noopener ugc nofollow" target="_blank">天昊95/iwfp </a>的自动化依赖更新拉取请求示例</p></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="71bf" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">第四步。给自己冲杯咖啡(或任何你喜欢喝的东西)</h1><p id="2070" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>