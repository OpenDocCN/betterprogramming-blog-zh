<html>
<head>
<title>How to Use Geolocation in React Native With Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React Native With Hooks中使用地理定位</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-geolocation-in-react-native-hooks-aea06bf58263?source=collection_archive---------1-----------------------#2019-08-30">https://betterprogramming.pub/how-to-use-geolocation-in-react-native-hooks-aea06bf58263?source=collection_archive---------1-----------------------#2019-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dab4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">React Native中地理定位API的说明性介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/d71b40540842c6b0052014f39de1dddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*td6TDp__0_DVL54GDYHuKg.png"/></div></figure><p id="a378" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">要开始使用React Native中的地理位置API，您需要确保您已经使用<code class="fe lm ln lo lp b">react-native-cli</code>或<code class="fe lm ln lo lp b">expo-cli</code>创建了React Native项目。如果你还没有，你可以通过下面的操作使用<code class="fe lm ln lo lp b">react-native-cli</code>创建一个新的应用。</p><p id="e2b9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">通过npm安装React本机CLI:</p><p id="57f8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe lm ln lo lp b">npm i -g react-native-cli</code></p><p id="2335" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">创建新的React本机项目:</p><p id="7d58" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe lm ln lo lp b">react-native init geolocation-project</code></p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="dbd2" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">装置</h1><p id="808f" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">现在我们已经建立了React本地项目，我们需要安装React本地地理定位模块，并将其链接到我们的本地模块。以前，地理位置API是由React Native直接提供的，但后来它被转移到自己的npm包中。</p><p id="88fd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">安装:</p><p id="1885" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe lm ln lo lp b">npm i @react-native-community/geolocation -S</code></p><p id="3eb7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">链接(如果使用React本机CLI):</p><p id="1ced" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe lm ln lo lp b">react-native link @react-native-community/geolocation</code></p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="1600" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">使用API</h1><p id="d29f" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">地理定位API提供了两种方法，我们可以利用它们来检索设备的地理位置:<code class="fe lm ln lo lp b">getCurrentPosition</code>和<code class="fe lm ln lo lp b">watchPosition</code>。如果您只需要检索位置一次，并且不监听更新，那么您将需要使用<code class="fe lm ln lo lp b">getCurrentPosition</code>。</p><p id="ff3f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然而，如果你想订阅更新和收听位置的变化，你需要使用<code class="fe lm ln lo lp b">watchPosition</code>。</p><p id="99b3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们看看如何在react组件中使用这些方法的一些例子。</p><h2 id="c9ad" class="mv ly it bd lz mw mx dn md my mz dp mh kz na nb mj ld nc nd ml lh ne nf mn ng bi translated">获取当前位置</h2><p id="3034" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">这里有一个例子，说明我们如何使用<code class="fe lm ln lo lp b">getCurrentPosition</code>方法向用户显示当前的纬度和经度。这个示例还处理在尝试检索位置时可能出现的错误，您可以以最适合您的应用程序的方式调整这个逻辑。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="2d81" class="mv ly it bd lz mw mx dn md my mz dp mh kz na nb mj ld nc nd ml lh ne nf mn ng bi translated">观察位置</h2><p id="5a72" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">下面，我创建了一个<code class="fe lm ln lo lp b">useGeolocation</code>钩子，在组件挂载时使用<code class="fe lm ln lo lp b">watchPosition</code>方法设置订阅，然后在组件卸载时取消订阅。这个钩子将在当前位置改变时强制重新呈现，并在每次更新时返回更新后的位置。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="9fa8" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">配置权限</h1><h2 id="073e" class="mv ly it bd lz mw mx dn md my mz dp mh kz na nb mj ld nc nd ml lh ne nf mn ng bi translated">ios</h2><p id="fb58" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">你需要在你的<code class="fe lm ln lo lp b">Info.plist</code>中包含<code class="fe lm ln lo lp b">NSLocationWhenInUseUsageDescription</code>和<code class="fe lm ln lo lp b">NSLocationAlwaysAndWhenInUseUsageDescription</code>键，以便在使用应用程序时启用地理定位。</p><p id="575c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你需要在后台访问地理位置，你还需要在<code class="fe lm ln lo lp b">Info.plist</code>中包含<code class="fe lm ln lo lp b">NSLocationAlwaysUsageDescription</code>键，并在Xcode的<code class="fe lm ln lo lp b">Capabilities</code>标签中添加位置作为后台模式。</p><h2 id="dd36" class="mv ly it bd lz mw mx dn md my mz dp mh kz na nb mj ld nc nd ml lh ne nf mn ng bi translated">机器人</h2><p id="8ecb" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">您需要将以下内容添加到您的<code class="fe lm ln lo lp b">AndroidManifest.xml</code> : <code class="fe lm ln lo lp b">&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/&gt;</code></p><p id="52c4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">更多详情可以参考<a class="ae mu" href="https://github.com/react-native-community/react-native-geolocation/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">自述</a>。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="fc6c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">结论</h1><p id="7b5c" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">希望这篇文章能帮到你，让你知道如何在React Native中使用地理定位API。感谢您的阅读，祝您的项目好运。</p></div></div>    
</body>
</html>