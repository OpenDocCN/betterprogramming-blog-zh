<html>
<head>
<title>How to Call a REST Method From Powershell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从Powershell调用REST方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/call-a-rest-method-from-powershell-595c3eb59056?source=collection_archive---------8-----------------------#2022-05-07">https://betterprogramming.pub/call-a-rest-method-from-powershell-595c3eb59056?source=collection_archive---------8-----------------------#2022-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6fac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以口袋妖怪API为例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/24231f7fb5abfdfcf7f25c7a21bdd570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P1rOu6ZgsKLlbqJ7"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/high-angle-view-of-lying-down-on-grass-258330/" rel="noopener ugc nofollow" target="_blank">照片</a>来自Pexels的Pixabay</p></figure><p id="fd7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">免责声明:所有观点都是我自己的</em></p><p id="fdad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不久前，我写了一篇关于使用Powershell的便捷的<code class="fe lw lx ly lz b">Invoke-WebRequest</code>方法并绕过证书检查的文章，但是还有另一个有用的Powershell方法与调用web方法相关:<code class="fe lw lx ly lz b">Invoke-RestMethod</code></p><p id="0724" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的文档在这里是<a class="ae ky" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-restmethod?view=powershell-7.2" rel="noopener ugc nofollow" target="_blank"/>，但是它与<code class="fe lw lx ly lz b">Invoke-WebRequest</code>非常相似，不同之处在于它默认显示的内容。</p><p id="590d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看几个PokeAPI的例子。</p><p id="d94d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我在PokeAPI上运行<code class="fe lw lx ly lz b">Invoke-WebRequest</code>时:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="8b42" class="me mf it lz b gy mg mh l mi mj">Invoke-WebRequest <a class="ae ky" href="https://pokeapi.co/api/v2/pokemon/ditto" rel="noopener ugc nofollow" target="_blank">https://pokeapi.co/api/v2/pokemon/ditto</a></span></pre><p id="feba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我得到了一个响应，其中包含许多关于请求的信息，但是没有多少来自请求的信息</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/0d0317b4e9e3101e09a3a4e2d5aa1696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLlgJgKehyCYfAP_OhFW9g.png"/></div></div></figure><p id="9d90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以看到它嵌入在内容中，如果我不是太懒的话，我可以看到一个简单的方法把它提取出来并解析它。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="98b5" class="me mf it lz b gy mg mh l mi mj">(Invoke-WebRequest <a class="ae ky" href="https://pokeapi.co/api/v2/pokemon/ditto).Content" rel="noopener ugc nofollow" target="_blank">https://pokeapi.co/api/v2/pokemon/ditto).Content</a> | ConvertFrom-json</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/a9420a0cc3da8467031503d673555deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qPT976MNsGe7pkiuafUig.png"/></div></div></figure><p id="4b3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但我是一名程序员，我们天生懒惰。所以让我们用<code class="fe lw lx ly lz b">Invoke-RestMethod</code>做同样的事情</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="2a49" class="me mf it lz b gy mg mh l mi mj">Invoke-RestMethod <a class="ae ky" href="https://pokeapi.co/api/v2/pokemon/ditto" rel="noopener ugc nofollow" target="_blank">https://pokeapi.co/api/v2/pokemon/ditto</a></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/382c4d752d3a3283c04d3a32e8076292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0DLhD0lJCkRu4Uzd_EB4Q.png"/></div></div></figure><p id="bb52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我可以立即解析并获得所有内容。</p><p id="6cef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想继续使用结果做进一步的探索，如检索口袋妖怪物种的所有细节，这种表示法很方便:</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="3c99" class="me mf it lz b gy mg mh l mi mj">$pokemon = Invoke-RestMethod <a class="ae ky" href="https://pokeapi.co/api/v2/pokemon/ditto" rel="noopener ugc nofollow" target="_blank">https://pokeapi.co/api/v2/pokemon/ditto</a>;<br/>Invoke-RestMethod $pokemon.species.url;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/8c0303ba70ab6a448f1044e0e64e0f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*st6DOA_PttACUf0W0PNs7g.png"/></div></div></figure><p id="1aa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经知道了——用powershell调用rest方法。powershelling快乐！</p></div></div>    
</body>
</html>