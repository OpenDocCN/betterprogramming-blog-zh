<html>
<head>
<title>A Quick Way to Generate Go Tests in Visual Studio Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Visual Studio代码中快速生成Go测试的方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-quick-way-to-generate-go-tests-in-visual-studio-code-b7c675b88dac?source=collection_archive---------4-----------------------#2022-09-03">https://betterprogramming.pub/a-quick-way-to-generate-go-tests-in-visual-studio-code-b7c675b88dac?source=collection_archive---------4-----------------------#2022-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d3a8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">单击此处生成单元测试</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cca37fa2eb3fd95fa77bc11adcae7cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCvyie2pM0e6MWjPH8Tn8A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">TL；dr:点击这里。</p></figure><p id="588b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我刚刚学会了一种用Visual Studio代码(VSC)编写Go测试的快速方法。在与一位同事一起编程时，我注意到他在编辑器中右键单击某个地方后生成了一个测试的样板代码。这引起了我的注意，因为这是我第一次看到魔术。所以，搜索了一下，我发现了他是怎么做到的。在这篇短文中，我将描述这个过程。</p><p id="39f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建这个样板代码的工具叫做<code class="fe lu lv lw lx b">gotests</code>。它生成Go的<a class="ae ly" href="https://github.com/golang/go/wiki/TableDrivenTests" rel="noopener ugc nofollow" target="_blank">表驱动测试</a>，覆盖Go文件中的函数，或者从方法的签名中生成它们。要使用它，你可以从命令行安装并执行它，或者直接从VSC安装，因为它包含在VSC的Go插件中。让我们看看怎么做。</p><p id="b5f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设您有一个这样的Go源文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/16b8e6a81e343bcb150a54549f0db06f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*PUwjvPCN3URnz8WCQiPDVw.png"/></div></figure><p id="70a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它有一个结构<code class="fe lu lv lw lx b">Superhero</code>，一个映射<code class="fe lu lv lw lx b">nameToSuperheroName</code>来将超级英雄的真实姓名转换成它的别名，还有一个函数创建一个新的<code class="fe lu lv lw lx b">Superhero</code>并检查映射是否包含它的别名。要生成样板测试代码，右键单击函数的签名(这里写着<code class="fe lu lv lw lx b">NewSuperhero</code>)并选择“Go:Generate Unit Tests For Function”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/64eb626ba2f37d84c83d567786e9ef95.png" data-original-src="https://miro.medium.com/v2/format:webp/1*u_pmXEAbQQVtXEsZlSrJuw.png"/></div></figure><p id="dc66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击这里将创建一个测试文件，其中包含一个名为<code class="fe lu lv lw lx b">TestNewSuperheroe</code>的测试函数和您开始编写测试所需的框架代码。此测试代码遵循表驱动测试模式，这是一种涉及结构(“表”)的测试类型，该结构的字段包括测试的输入、预期输出和其他信息，如名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/5e63f3944b17d9a938d0e9473f5d492b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*bCmqAHVH74sjScXcNmrGow.png"/></div></figure><p id="1054" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要填写该表，您需要在第19行创建一个匿名结构列表。这个结构由一个<code class="fe lu lv lw lx b">name</code> <code class="fe lu lv lw lx b">string</code>组成，用于为测试指定一个名称，一个<code class="fe lu lv lw lx b">args</code> <code class="fe lu lv lw lx b">struct</code>由<code class="fe lu lv lw lx b">NewSuperheroefunction</code>的参数组成，以及<code class="fe lu lv lw lx b">want</code>，您期望<code class="fe lu lv lw lx b">NewSuperhero</code>输出的<code class="fe lu lv lw lx b">Superhero</code>对象。比如下面的截图有我的测试，我命名为<code class="fe lu lv lw lx b">Test Tony Stark</code>。我将使用这个测试来验证输入<code class="fe lu lv lw lx b">Tony</code>、<code class="fe lu lv lw lx b">Stark</code>和<code class="fe lu lv lw lx b">48</code>是否产生一个看起来如下的<code class="fe lu lv lw lx b">Superhero</code>对象:</p><pre class="kj kk kl km gt ma lx mb mc aw md bi"><span id="9d9a" class="me mf it lx b gy mg mh l mi mj">&amp;Superhero{<br/>    firstName:      "Tony",<br/>    lastName:       "Stark",<br/>    age:            48,<br/>    superheroeName: "Iron Man",<br/> }</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/5ec797b39559fe38dcf3401b351c86fe.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Sj9frF_tfgU4oeOIaPc7wg.png"/></div></figure><p id="c94b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意字段<code class="fe lu lv lw lx b">superheroeName</code>是<code class="fe lu lv lw lx b">Iron Man</code>，因为根据源文件中定义的映射，托尼·斯塔克的名字翻译成了钢铁侠。</p><p id="3742" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，如果我们想为一个文件可能具有的所有功能生成测试，该怎么办呢？例如，假设您添加了两个新方法，<code class="fe lu lv lw lx b">isAdult</code>和<code class="fe lu lv lw lx b">isAvenger</code>到我们的<code class="fe lu lv lw lx b">Superheroe</code>结构中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/9ce64b95b140785ff5644e03e2b347ed.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7mC06_mUgqqY__lJTfuFaA.png"/></div></figure><p id="a150" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们双击每个函数来生成它们的测试吗？不要！您可以通过打开VSC的<a class="ae ly" href="https://code.visualstudio.com/docs/getstarted/userinterface#_command-palette" rel="noopener ugc nofollow" target="_blank">命令面板</a>并选择“Go: Generate Unit Tests For File”选项来为源文件中的每个函数创建测试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/fcb3087c5af551d4470f80d0e0284e80.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gCB-81gbQPJ4fbrN98ltHg.png"/></div></figure><p id="f49f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样做会将以下代码添加到现有的测试文件中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lz"><img src="../Images/37c414503dc37899f5f5aa613d042d41.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QbZo8ierfNHyoeGOhbSQDw.png"/></div></figure><p id="2004" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这一点上来说，由您来完成您的测试，如果需要的话，修改样板代码来满足您的需求。测试愉快！</p></div></div>    
</body>
</html>