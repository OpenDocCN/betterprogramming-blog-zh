<html>
<head>
<title>How to Use Uniswap to Swap Tokens From a Custom Frontend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Uniswap从自定义前端交换令牌</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-uniswap-to-swap-tokens-from-a-custom-frontend-6e608dbaad22?source=collection_archive---------5-----------------------#2022-11-10">https://betterprogramming.pub/how-to-use-uniswap-to-swap-tokens-from-a-custom-frontend-6e608dbaad22?source=collection_archive---------5-----------------------#2022-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c6fe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们建立自己的dApp</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8c56d75473af83b682aa2196ecfcbc76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eeJUTEz1MmcrykE5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@dengxiangs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">钟登祥</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">构建自己的dApp，让你不用写一行代码就能交换各种令牌，这多酷啊？嗯，通过Uniswap SDK，您可以使用Uniswap的智能合约与您自己的自定义前端交换一大堆ERC20令牌。</p><p id="a771" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将构建一个React dApp，它可以让您将ETH替换为UNI。</p><p id="4a75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程重点介绍实际的逻辑，以及如何使用默认的用户代理CSS从用户界面连接到它。它不包含任何自定义样式。然而，我也创建了一个风格化版本的dApp。</p><p id="a66d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你对这是如何完成的感兴趣，请到页面底部我链接了资源库和实际网站的地方。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/f5686c3a4a049c21934211d9b370bd45.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*3mJs7CJ9qT9ki6G6TYUxMA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在后台使用Uniswap为UNI交换ETH</p></figure><p id="5e7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了遵循教程npm的基础知识，需要React，ethers.js和<code class="fe lt lu lv lw b">wagmi.sh</code>。</p><p id="1dde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要创建我们的React dApp。我们将为这个项目使用TypeScript。所以打开你的终端写下:</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="0ae7" class="mb mc iq lw b gy md me l mf mg">npx create-react-app uniswap-dapp --template typescript</span></pre><p id="d082" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，将目录更改为新创建的目录，并安装依赖项:</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="4c75" class="mb mc iq lw b gy md me l mf mg">cd uniswap-dapp<br/>npm install ethers wagmi @uniswap/v3-sdk @uniswap/sdk-core</span></pre><p id="0c48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在启动开发服务器。</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="8323" class="mb mc iq lw b gy md me l mf mg">npm start</span></pre><p id="c4fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的默认web浏览器应该会打开并显示臭名昭著的React屏幕。</p><p id="c0f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，在您最喜欢的代码编辑器中打开新创建的项目。从一个干净的设置开始，删除所有样板代码。删除文件<code class="fe lt lu lv lw b">index.css</code>和<code class="fe lt lu lv lw b">App.css</code>中的所有内容。删除<code class="fe lt lu lv lw b">logo.svg</code>文件，并删除<code class="fe lt lu lv lw b">App.tsx</code>文件中的大部分内容，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="74ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以开始了！</p><h1 id="69a4" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">钱包连接</h1><p id="022f" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我们将使用库<code class="fe lt lu lv lw b">wagmi.sh</code>实现到MetaMask的简单钱包连接。如果你已经知道如何用MetaMask和<code class="fe lt lu lv lw b">wagmi.sh</code>建立钱包连接，可以跳过这一节。</p><p id="f8b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了将我们的应用程序与以太坊节点连接起来，并能够从应用程序中的任何地方访问区块链相关的信息，我们必须用<code class="fe lt lu lv lw b">WagmiConfig</code>提供者包装我们的整个应用程序，并传递它的配置选项。转到<code class="fe lt lu lv lw b">App.tsx</code>，像这样修改文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="5264" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这次演示中，我们将使用Goerli测试网。我们还使用公共提供者，因为我们不必发送大量的事务。如果您的dApp超出了公共提供商的费率限制，您需要使用Alchemy或Infura等服务。</p><p id="723c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，我们就成功地连接到了以太坊节点，并且已经可以从区块链读取数据了。然而，为了进行交易和改变区块链状态，我们需要将我们的dApp连接到钱包。</p><p id="96e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在dApp的头部实现我们的钱包连接按钮和逻辑。在名为<code class="fe lt lu lv lw b">components</code>的新目录中创建一个新的<code class="fe lt lu lv lw b">Header</code>组件，内容如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="6401" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lt lu lv lw b">InjectedConnector</code>引用元掩码扩展，我们通过传递值设置为Goerli的id的<code class="fe lt lu lv lw b">chainId</code>属性来确保元掩码使用Goerli作为它的链。现在，我们应该能够通过页面上出现的这个漂亮按钮将MetaMask钱包连接到dApp:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/db3a6ddc2800513ce364c17d595be1b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIzqs4PiNQNCAUKEzQnioA.png"/></div></div></figure><p id="4033" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">成功连接后，按钮会变成当前连接的钱包地址。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/a651000b5782845cfb2e4721e39cf32a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Z5JBX-WvVu2epIiLZZhZQ.png"/></div></div></figure><h1 id="4483" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">获取现货价格</h1><p id="4cc3" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">既然钱包连接已经处理好了，我们可以关注本文的实际主题:如何使用Uniswap从您自己的定制前端交换令牌。我们将从在一个名为<code class="fe lt lu lv lw b">hooks</code>的新目录中创建一个名为<code class="fe lt lu lv lw b">useSwap</code>的新定制钩子开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="05db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了获取令牌价格，我们需要与包含该令牌对的池的契约进行交互。正如开始所说，我们将与ETH-UNI池进行交互。在内部，ETH被处理为封装以太网或简称WETH，因为Uniswap只能处理ERC20令牌，而ETH本身不是令牌，而是一种货币。所以我们要找的游泳池实际上是一个WETH-UNI游泳池。稍后我会更详细地解释这一点。现在，我们将获得对池合同的引用，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="7dbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们只阅读合同，不进行交易，所以使用提供者而不是签名者(有钱包连接的提供者)就足够了。</p><p id="f2b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们创建两个接口<code class="fe lt lu lv lw b">Immutables</code>和<code class="fe lt lu lv lw b">State</code>来模拟我们需要的链上池数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="99f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们创建了两个函数<code class="fe lt lu lv lw b">getPoolImmutables</code>和<code class="fe lt lu lv lw b">getPoolState</code>，它们执行实际的数据获取并返回对应于各自接口的数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="648b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至此，我们已经拥有了报价所需的所有区块链数据。</p><p id="1d25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在文件的顶部添加了两个常量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="955c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们可以实现<code class="fe lt lu lv lw b">getQuote</code>函数，该函数返回我们针对特定数量的ETH获得的UNI数量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4fd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数调用我们之前定义的另外两个函数，以获取当前的区块链数据。这里值得注意的是，池的<code class="fe lt lu lv lw b">token0</code>是UNI，池的token1是WETH。之后，Uniswap的<code class="fe lt lu lv lw b">Token</code>和<code class="fe lt lu lv lw b">Pool</code>类用返回的数据进行实例化。最后，我们通过将ETH的数量乘以UNI相对于ETH的价格得到报价。</p><p id="4708" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">把所有的部分放在一起，从组件返回<code class="fe lt lu lv lw b">getQuote</code>函数，你的文件应该看起来像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="39cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在可以开始构建调用函数并根据返回的报价进行更新的UI。创建一个名为<code class="fe lt lu lv lw b">SwapCard</code>的新组件，内容如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="3692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果您在ETH的输入字段中键入任何数字，如果您执行交换，您将获得的预期UNI数量将显示在第二个输入字段中。您的网站现在应该看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/46362fb17f3fc94b2efcb10098b217b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lN21c8p3ACCMMbCrqloxkw.png"/></div></div></figure><h1 id="d1e5" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">将ETH转化为WETH并批准支出</h1><p id="ec3d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">现在，在我们实际要求Uniswap v3路由器将我们的ETH交换到UNI之前，我们必须将我们的ETH转换为weh，并允许路由器合同代表我们使用weh。正如我前面提到的，实际上没有直接包含ETH的池。Uniswap只使用ERC20令牌，这就是为什么我们需要将我们的ETH转换为ERC20令牌，它表示ETH，即weh。</p><p id="40ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们首先创建一个名为<code class="fe lt lu lv lw b">useWETH.tsx</code>的新文件，它是一个定制的React钩子，就像<code class="fe lt lu lv lw b">useSwap</code>一样。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="3d77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们想要创建WETH令牌的契约实例。为此我们需要象征ABI。用以下内容创建一个名为<code class="fe lt lu lv lw b">abis</code>的新目录和一个名为<code class="fe lt lu lv lw b">WETH.json</code>的新文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1ed7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以直接从<a class="ae kv" href="https://goerli.etherscan.io/address/0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6#code" rel="noopener ugc nofollow" target="_blank">以太扫描</a>中复制ABI。</p><p id="e233" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们准备像这样实例化契约:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="ab10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在顶部添加了一个额外的常数，它代表WETH令牌的小数位数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="a19f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们创建一个名为<code class="fe lt lu lv lw b">deposit</code>的函数，它解析输入金额并调用WETH契约上的存款函数。在这个函数的帮助下，我们将本机ETH转换为wet令牌，然后我们可以使用这些令牌进行令牌交换。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="40fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们只需要再创建一个函数，我们已经具备了执行交换的所有先决条件。创建<code class="fe lt lu lv lw b">approve</code>函数。为了让Uniswap路由器合同访问我们的wet，它需要有这样做的权限。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="c456" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的<code class="fe lt lu lv lw b">approve</code>函数中，我们调用WETH契约的approve函数，并定义路由器可以访问多少令牌。</p><p id="d16d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经准备好编写交换的逻辑了。</p><h1 id="a4a7" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">执行交换</h1><p id="61e4" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">转到<code class="fe lt lu lv lw b">useSwap.tsx</code>文件并添加这个导入:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="414b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，将该常量添加到文件的顶部:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1076" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和下面这个已经存在的<code class="fe lt lu lv lw b">useProvider</code>挂钩:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="1cad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们将改变区块链的状态，所以我们需要一个签名者，而不是路由器合同的提供者。此外，我们导入了我们在<code class="fe lt lu lv lw b">useWETH</code>钩子中编写的函数。</p><p id="34b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在最后创建执行交换的<code class="fe lt lu lv lw b">swap</code>函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="0424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个函数接受ETH中需要交换的数量作为参数。然后，它使用我们之前定义的<code class="fe lt lu lv lw b">deposit</code>函数将ETH转换为WETH，并批准Uniswap v3路由器在<code class="fe lt lu lv lw b">approve</code>函数的帮助下访问WETH中的确切数量。</p><p id="cb40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，它使用<code class="fe lt lu lv lw b">getPoolImmutables</code>函数获取必要的池数据(令牌地址、费用),并构造一个params对象，该对象将作为参数传递给事务。</p><p id="f4fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们调用Uniswap路由器契约上的<code class="fe lt lu lv lw b">exactInputSingle</code>函数来执行交换。由于MetaMask无法估算此交易的燃气费，因此必须设置自定义燃气限制。</p><p id="c25c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您可以将交换函数添加到return语句中，您的文件应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="e42e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在转到<code class="fe lt lu lv lw b">SwapCard.tsx</code>组件，添加逻辑来保存状态中的输入值，并添加一个按钮来启动与所述数量的交换。您的文件现在应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="6f65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我还添加了一个行为，即只有连接了钱包，交换按钮才会被激活。</p><p id="5e32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在转到localhost:3000来测试它，因为现在一切都应该工作了。只要确保你在Goerli网络上有足够的ETH。</p><p id="621f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你需要更多的测试，去找一个Goerli <a class="ae kv" href="https://goerlifaucet.com/" rel="noopener ugc nofollow" target="_blank">水龙头</a>就像炼金术士的那个。此外，请记住，挖掘这3个事务可能需要一段时间，并且我们目前没有任何关于当前事务状态的用户反馈。</p><h1 id="a4a4" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">显示当前ETH和UNI余额</h1><p id="a8d5" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">为了直接看到你能交换多少ETH，并得到一些关于交换结果的反馈，显示当前余额是很好的。幸运的是，有了wagmi.sh，做到这一点非常容易。</p><p id="fc67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将该常量添加到<code class="fe lt lu lv lw b">SwapCard.tsx</code>文件的顶部:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="7ec1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，将其添加到<code class="fe lt lu lv lw b">useAccount</code>钩下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="8d37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">属性确保我们的余额总是最新的，方法是在每个新块之后检查余额是否改变。最后但同样重要的是，我们在模板中为这两个令牌添加了一点注释，比如ETH的这个:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="309e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在把所有的东西放在一起，你的文件应该看起来有点像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="0236" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的无样式dApp现在应该看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/d685597d472dedc5e59888fd158502b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlIKVoG2ozHujvntLe3w1Q.png"/></div></div></figure><p id="8307" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您现在尝试交换代币，您将会看到在成功交换后，两个代币的余额会相应改变。</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="c7ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">恭喜恭喜！！！</strong></p><p id="f7e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你成功地建造了一个dApp，它可以让你用ETH换UNI。在此基础上，你可以使它更漂亮，添加验证，用户反馈，更多的令牌等。可能性是无限的。</p><p id="4865" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程只关注交换令牌背后的逻辑。没有CSS，它看起来平淡无奇，这就是为什么我在本教程中为我们创建的dApp添加了样式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/152d6c5b2148534bb85c7b42489b554b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ErXCGRHd0mV6Xe90qxkb0A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">附加样式的教程逻辑(查看下面的链接)</p></figure><h1 id="d1bc" class="mj mc iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">源代码和演示</h1><ul class=""><li id="2f0c" class="nn no iq ky b kz na lc nb lf np lj nq ln nr lr ns nt nu nv bi translated">如果你想查看整个代码，请点击这里。</li><li id="725e" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">如果你想查看整个代码，包括样式和一些更多的添加和调整，请点击<a class="ae kv" href="https://github.com/JonWofr/uniswap-dapp-styled" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="eb1b" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">如果你想获得dApp的演示，包括风格和一些更多的添加和调整:我在Vercel <a class="ae kv" href="https://uniswap-dapp-styled.vercel.app/" rel="noopener ugc nofollow" target="_blank">这里</a>部署了它。</li></ul></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="62d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>