# 开发者应该(能够)不计后果

> 原文：<https://betterprogramming.pub/developers-should-be-a-little-bit-reckless-3d2521ad9641>

## 为什么你应该拥抱和计划混乱

![](img/d50b16479812ff1108a1a7a8b797e7ee.png)

里卡多·维亚纳在 [Unsplash](https://unsplash.com/s/photos/mess?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

任何软件项目都必须在构建新功能和使当前系统更具弹性、更易于维护之间做出权衡。

通常，管理层会推出新功能，在您知道之前，您最终会发现一个大泥球，由于随着时间的推移意外积累的复杂性，任何更改都需要很长时间。

复杂性会导致错误，很快，变化就会变得有风险。开发人员害怕运送除了琐碎的东西以外的任何东西。对代码库急需的改进过于复杂，因此无法完成。这是一个你不想陷入的恶性循环。

解决这个问题的关键是建立弹性系统。

弹性系统允许创新发生。如果服务在出错时不太可能崩溃，甚至性能不佳，那么与代码更改相关的风险就会降低，因此，新功能和重构会更容易发布，这样您就可以避免恶性循环。

有两种方法可以让软件开发更有弹性:把责任推给人或者依靠机器。

第一种方法要求开发人员遵循指导方针和程序，在合并新内容之前仔细检查所有内容。这会给他们带来很大的压力。

你自己可能也见过或经历过这种情况:有人避免做出大的改变，因为害怕打破某些东西并因此受到指责。

或者，您可以将 bug 和中断视为适当的系统所允许的事情。运送它的人不再负责。你的系统才是需要改变的。

良性循环和恶性循环是一个硬币的两面。当计算机负责确保服务正常运行时，情况变得更加令人羡慕。

随着对系统防止或修复错误的能力的信心增加，开发人员和公司中的其他人将变得更加鲁莽。

这是好事。有了安全网，你就可以大胆尝试新事物。它促进创新，提高改进的速度。

当然，它可能会时断时续，但总体弹性会因此增加。

# 抗脆弱系统

Nassim Taleb 在他的书 [*抗脆弱性*](https://www.penguinrandomhouse.com/books/176227/antifragile-by-nassim-nicholas-taleb/) 中发展了 [*抗脆弱性*](https://en.wikipedia.org/wiki/Antifragility) 的概念，认为它不同于弹性。抗脆弱系统*从冲击中获益*。

一个软件项目在其整个生命周期中是一个不断进化的生物。新的特性出现了，错误被引入了，其他的被修复了，代码被重构了。

从这个意义上说，我们应该致力于建立抗脆弱系统。也就是说，随着时间的推移，问题应该引导我们提高系统的弹性。

试图通过要求开发人员遵守纪律和一丝不苟来预先消除问题是对项目有害的，因为它不会导致从一开始就防止这些错误的改进。

拥抱混沌，建立抗脆弱系统。

# 我该如何开始？

如果项目是全新的，那就简单了。允许自己和他人鲁莽行事，不要责怪任何人，将生产中的问题视为学习经验，以提高应变能力。

但是那些已经存在的项目呢？它们可能很脆，任何停机时间都很昂贵。

在这种情况下，首先建立一个生产可能中断的所有方式的列表。回顾过去，看看是否有可能再次发生的问题。

这应该是一份活的文件，随着新问题的出现，新问题会不断出现。如果在代码审查期间发现了潜在的问题，也应该将它添加到文档中。

下一步是决定对你来说防止这些事情发生的最好方法是什么，并对它们进行优先排序。

如果你不知道优先考虑什么，试着给你清单上的每一项分配一个从 1 到 3 的值，表示严重程度——对公司的影响有多大，解决起来有多困难——以及可能性——发生的可能性。

两者的乘积决定了先处理哪一个。

最后，不要因为停机而责怪人们，而要用“事后诸葛亮”来解释为什么系统会让它发生，以及应该如何解决。

# 我如何避免(太多)混乱？

鲁莽会增加打破东西的可能性。即使它有助于向您指出需要解决的问题，也不应该发生太多。

在他们的[书](https://landing.google.com/sre/books/)(可免费获得)中，谷歌的 SRE 团队引入了*误差预算*的概念。最简单的形式是，超过一周的可接受的停机时间。章节 [*服务水平目标*](https://landing.google.com/sre/sre-book/chapters/service-level-objectives/) 特别有趣。

在误差预算被消耗后，除非紧急情况，否则应推迟生产变更。这样，你就限制了你带来的混乱。

同样值得注意的是， [Kubernetes](https://kubernetes.io/) 拥有[中断预算](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)可以用于此目的。

# 混沌工程

前面的部分是关于限制混乱，但是如果增加一点点呢？

除了发现一些你没有想到的新方法，它还可以帮助你为其他团队和客户设定期望。这可能有违直觉，但从商业角度来看，过于稳定的系统也不一定是好的。

如果出现持续几个小时的严重停机，会发生什么情况？如果其他团队和客户期望您的服务一直保持正常运行和响应，因为到目前为止一直如此，那么他们可能没有考虑到这种情况。这对他们意味着麻烦，推而广之，对你也意味着麻烦。

另一方面，如果他们认为您的服务有时不响应或者某些请求很慢，那么他们可能已经实现了缓存或更好的异常处理。

从相反的角度来看，你可能对你消费的服务有一些期望，但这些期望不会永远存在。故意减少或减慢第三方服务的包，可以迫使你的代码对他们那边的问题更有弹性。

[混沌工程](https://principlesofchaos.org)，是格雷格·奥泽尔在网飞工作时介绍的:

> “对系统进行实验的学科，目的是建立对系统承受生产中动荡条件能力的信心。”

混沌工程最著名的工具是 [ChaosMonkey](https://github.com/Netflix/chaosmonkey) ，它随机杀死你环境中的虚拟机和容器。

如果你是一个服务网格或类似的东西，你可能要考虑在网络中引入错误和延迟。例如， [Istio](https://istio.io/) 为[故障注入](https://istio.io/docs/tasks/traffic-management/fault-injection/)提供支持。

# 结论

为了保持势头和促进创新，开发人员应该自由探索新的领域，而不是强调打破东西。

由于自动化控制提供的安全网，他们应该被允许大胆和鲁莽。随着时间的推移，这种(有限的)混乱反过来使系统变得更加强大。

只有当所有相关人员都同意优先处理必要的工作以防止问题再次发生时，这种情况才会发生。

如果你喜欢这样的故事，考虑成为媒体会员和/或 T2 订阅者。