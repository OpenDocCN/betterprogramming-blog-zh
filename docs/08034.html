<html>
<head>
<title>How To Use Nodemon To Restart Your Node.js Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Nodemon重启Node.js应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/nodemon-e5d7b35ffc01?source=collection_archive---------6-----------------------#2021-03-17">https://betterprogramming.pub/nodemon-e5d7b35ffc01?source=collection_archive---------6-----------------------#2021-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5fd6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自动高效地重启您的网络应用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d936a1a4acaeac738db921ea8471e8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mGzMcxrYeYfYV4P0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@16bitspixelz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡米尔S </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="c0d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在开发任何Node.js应用程序，<a class="ae ky" href="https://nodemon.io/" rel="noopener ugc nofollow" target="_blank"> nodemon </a>是您武器库中的必备武器之一。了解如何安装和有效使用nodemon，以便在每次相关文件更改时自动重启Node.js应用程序。</p><p id="4694" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您想重启Node.js web服务器并节省大量开发时间吗？在本文中，我们将看到如何轻松地将nodemon用于任何Node.js应用程序。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="078c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">快速介绍</h1><p id="f9ec" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让nodemon监视您的文件更改就像让一只鹰监视它的猎物一样。每次保存文件时，Node.js服务器都会自动重启。</p><p id="358b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就连nodemon的广告语都写着“自动重装。”可能会让您感到惊讶的是，nodemon可以与Python、Ruby甚至Make等其他语言一起使用。超过150万个项目将Nodemon用作依赖项，因此它肯定是经过实战检验的。如果您没有使用nodemon进行开发，那么您就错过了。</p><p id="edbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续安装nodemon。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d0aa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何安装nodemon</h1><p id="6c83" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在安装nodemon之前，我们将使用一个示例应用程序来查看nodemon的运行情况。我们将使用我在我的<a class="ae ky" href="https://geshan.com.np/blog/2020/11/nodejs-mysql-tutorial/" rel="noopener ugc nofollow" target="_blank"> Node.js MySQL </a>教程中使用的<a class="ae ky" href="https://github.com/geshan/nodejs-mysql" rel="noopener ugc nofollow" target="_blank"> Node.js MySQL开源应用程序</a>。这是一个简单的quotes REST API，使用Node.js和Express.js与MySQL数据库进行通信。接下来，我们将在这个示例应用程序中安装nodemon。</p><p id="7068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像大多数npm模块一样，Nodemon有两种安装方式。</p><h2 id="d446" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">将nodemon作为全局依赖项安装</h2><p id="49f1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要将nodemon安装为全局NPM依赖项，我们可以运行以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="a36f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把nodemon作为一个全局依赖项安装。这也将使<code class="fe nn no np nq b">nodemon</code>命令在您运行它的任何路径上都可用。优点是不需要在每个Node.js项目中安装nodemon。</p><h2 id="49cd" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">将nodemon作为本地项目依赖项安装</h2><p id="0340" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要将nodemon安装为本地项目NPM依赖项，我们可以在我们想要的项目中执行以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="1d87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的示例项目，我们将运行上面的命令。运行它应该会向我们显示如下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/159f71eaf724c90eee1797b14afc8fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsWcF94n1u3PopbeMLEWKw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何将nodemon安装为本地开发依赖项</p></figure><p id="556f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们使用的<code class="fe nn no np nq b">--save-dev</code>，nodemon已经被添加到了<code class="fe nn no np nq b">package.json</code>文件的<code class="fe nn no np nq b">devDependencies</code>部分。类似地，相关的更改也被添加到了<code class="fe nn no np nq b">package-lock.json</code>文件中。如果你使用yarn，你可以运行<code class="fe nn no np nq b">yarn add nodemon --dev</code>来添加nodemon到你的<code class="fe nn no np nq b">devDependencies</code>。</p><p id="eadc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您在本地安装nodemon时，您将不能在任何地方访问<code class="fe nn no np nq b">nodemon</code>命令。如果在<code class="fe nn no np nq b">package.json</code>上下文之外运行nodemon，就会出现<code class="fe nn no np nq b">nodemon command not found</code>问题。为了解决这个问题，您可以全局安装nodemon。</p><p id="8fcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在<a class="ae ky" href="https://github.com/geshan/nodejs-mysql/pull/8/files" rel="noopener ugc nofollow" target="_blank">这个</a>拉请求中使用NPM来查看添加<code class="fe nn no np nq b">nodemon</code>作为开发依赖所涉及的更改。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5b8e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何使用nodemon</h1><p id="ca6e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使用nodemon，我们将在运行应用程序时用<code class="fe nn no np nq b">nodemon</code>命令替换<code class="fe nn no np nq b">node</code>命令。由于我们将nodemon作为本地依赖项安装，为了使事情变得更简单，我们将在<code class="fe nn no np nq b">package.json</code>中添加一个新脚本来运行带有nodemon的应用程序。我们可以在<code class="fe nn no np nq b">package.json</code>文件中添加新脚本，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="a16a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们可以使用命令<code class="fe nn no np nq b">npm run start:dev</code>运行应用程序，并点击<code class="fe nn no np nq b">http://localhost:3000/quotes</code>在浏览器上查看输出。因为我们用nodemon运行应用程序，如果我们更改任何文件并保存它，它将再次在nodemon之后重新运行命令。例如，我在<code class="fe nn no np nq b">src/services/quotes.js</code>中的一行上添加了一个<code class="fe nn no np nq b">,</code>并保存了文件，结果是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/1c45d583ebc07acb319a6623cd715ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCOTHjQNXkZpMPEbXjc4fg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何使用nodemon作为package.json脚本</p></figure><p id="8f81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，Express.js服务器按照预期在每次文件更改时重启。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9991" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">更多nodemon配置</h1><p id="10c1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以通过向<code class="fe nn no np nq b">nodemon</code>命令传递更多参数或添加一个<code class="fe nn no np nq b">nodemon.json</code>文件来添加更多配置。例如，如果你想让nodemon和Docker一起工作，你需要添加<code class="fe nn no np nq b">--legacy-watch</code>或者<code class="fe nn no np nq b">-L</code>，这样它就可以支持Chokidar轮询。你也可以用Docker 的例子来看看这个<a class="ae ky" href="https://geshan.com.np/blog/2020/11/nodejs-with-docker/#1.3-add-nodemon-to-monitor-changes-and-reload" rel="noopener ugc nofollow" target="_blank"> Node.js。</a></p><p id="09a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您甚至可以使用<code class="fe nn no np nq b">--delay</code>参数延迟nodemon的重启，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="f5d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将等待两秒钟，然后根据文件更改重新启动服务器。例如，如果您想观看<code class="fe nn no np nq b">.js</code>和<code class="fe nn no np nq b">.sql</code>文件，您可以使用以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="c955" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们想要做的，我们可以向一个<code class="fe nn no np nq b">nodemon.json</code>文件添加更多的配置。下面是一个<code class="fe nn no np nq b">nodemon.json</code>文件的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="d081" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的<code class="fe nn no np nq b">nodemon.json</code>将确保<code class="fe nn no np nq b">clear</code>命令在每次重启时运行，这将清除任何旧的控制台输出。同样，它也会在文件更改后2.5秒重新启动服务器。我们还可以添加其他配置，如文件扩展名或要忽略的文件。这些配置也可以放入<code class="fe nn no np nq b">package.json</code>文件中的<code class="fe nn no np nq b">nodemonConfig</code>索引下。<a class="ae ky" href="https://github.com/remy/nodemon/wiki/Sample-nodemon.json" rel="noopener ugc nofollow" target="_blank">看一下</a>node mon repo的另一个样本<code class="fe nn no np nq b">nodemon.json</code>文件。</p><p id="a352" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我强烈推荐阅读nodemon <a class="ae ky" href="https://github.com/remy/nodemon#nodemon" rel="noopener ugc nofollow" target="_blank">文档</a>。常见问题解答是一个很好的地方，可以找到你在nodemon中遇到的任何问题的答案。有涉及Docker，Windows，权限等的回答。</p><p id="c306" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在<a class="ae ky" href="https://github.com/geshan/nodejs-mysql/pull/9/files" rel="noopener ugc nofollow" target="_blank">这个</a>拉请求的示例配置文件中找到<code class="fe nn no np nq b">nodemon</code>命令。</p><p id="d28b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要更多关于nodemon使用的文档或帮助，如果nodemon安装在本地，您可以运行<code class="fe nn no np nq b">./node_modules/nodemon/bin/nodemon.js -h</code>。如果nodemon是全局安装的，您可以简单地执行<code class="fe nn no np nq b">nodemon -h</code>并查看帮助。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8ef8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="aad3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们已经看到nodemon对于Node.js开发来说是一个非常有用的工具。无论您是使用web服务器、命令行界面(CLI)还是任何其他工作负载，nodemon都会让您的生活变得更加轻松。</p><p id="c59b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Nodemon就像在每次文件更改时让某人为您重启服务器。它在编写web应用程序时非常方便，因为它消除了测试中的许多摩擦。</p><p id="211a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望您已经学会了如何使用nodemon自动重启Node.js应用程序。</p></div></div>    
</body>
</html>