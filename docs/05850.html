<html>
<head>
<title>How to Create a Self-Documenting Makefile</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建自我记录的Makefile</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-self-documenting-makefile-533ebf8f82e2?source=collection_archive---------11-----------------------#2020-08-11">https://betterprogramming.pub/how-to-create-a-self-documenting-makefile-533ebf8f82e2?source=collection_archive---------11-----------------------#2020-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0d80" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用您可以签入的命令别名加速您的开发操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/3ffb975b63bdf9842f9b541a7b6f91cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*zhLbdn42TXqiCfgV.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者插图</p></figure><p id="c302" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我最喜欢的完全不充分使用Makefile的方法？创建您可以签入的个性化、基于项目的存储库工作流命令别名。</p><p id="913b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Makefile能提高您的DevOps并让开发人员满意吗？如果从事您项目的新开发人员不是从复制和粘贴您的自述文件中的命令开始的，那该有多棒？如果不是:</p><pre class="kj kk kl km gt lq lr ls lt aw lu bi"><span id="9d2c" class="lv lw it lr b gy lx ly l lz ma">pip3 install pipenv<br/>pipenv shell --python 3.8<br/>pipenv install --dev<br/>npm install<br/>pre-commit install --install-hooks<br/># look up how to install Framework X...<br/># copy and paste from README...<br/>npm run serve</span></pre><p id="b7f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">…您只需键入:</p><pre class="kj kk kl km gt lq lr ls lt aw lu bi"><span id="c595" class="lv lw it lr b gy lx ly l lz ma">make start</span></pre><p id="82ad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">…然后开始工作？</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="c93c" class="mi lw it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">有所作为</h1><p id="c00f" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">我每天都使用<code class="fe ne nf ng lr b">make</code>来消除日常开发活动中的乏味，比如更新程序、安装依赖项和测试。为了用Makefile (GNU make)完成所有这些，我们使用了<a class="ae nh" href="https://www.gnu.org/software/make/manual/make.html#Rules" rel="noopener ugc nofollow" target="_blank"> Makefile规则</a>和<a class="ae nh" href="https://www.gnu.org/software/make/manual/make.html#Recipes" rel="noopener ugc nofollow" target="_blank">方法</a>。POSIX风格make也有类似的相似之处，比如<a class="ae nh" href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html#tag_20_76_13_04" rel="noopener ugc nofollow" target="_blank">目标规则</a>；这里有一篇关于兼容POSIX的Makefiles的文章。</p><p id="3152" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一些我们可以<code class="fe ne nf ng lr b">make</code>更容易(抱歉)的事情的例子:</p><pre class="kj kk kl km gt lq lr ls lt aw lu bi"><span id="6a81" class="lv lw it lr b gy lx ly l lz ma">update: ## Do apt upgrade and autoremove<br/>    sudo apt update &amp;&amp; sudo apt upgrade -y<br/>    sudo apt autoremove -y<br/><br/>env:<br/>    pip3 install pipenv<br/>    pipenv shell --python 3.8<br/><br/>install: ## Install or update dependencies<br/>    pipenv install --dev<br/>    npm install<br/>    pre-commit install --install-hooks<br/><br/>serve: ## Run the local development server<br/>    hugo serve --enableGitInfo --disableFastRender --environment development<br/><br/>initial: update env install serve ## Install tools and start development server</span></pre><p id="9ab0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们有一些命令行别名，您可以签入！好主意！如果你想知道奇怪的<code class="fe ne nf ng lr b">##</code>注释语法是怎么回事，它会变得更好。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="e5fc" class="mi lw it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">自我记录的Makefile</h1><p id="61c3" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">别名很棒——如果你不用不停地输入<code class="fe ne nf ng lr b">cat Makefile</code>就能记住它们是什么和它们做什么。自然，你需要一个<code class="fe ne nf ng lr b">help</code>命令:</p><pre class="kj kk kl km gt lq lr ls lt aw lu bi"><span id="640b" class="lv lw it lr b gy lx ly l lz ma">.PHONY: help<br/>help: ## Show this help<br/>    @egrep -h '\s##\s' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'</span></pre><p id="6a71" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过一点命令行技巧，这个<code class="fe ne nf ng lr b">egrep</code>命令获取<code class="fe ne nf ng lr b">MAKEFILE_LIST</code>的输出，对其进行排序，并使用<code class="fe ne nf ng lr b">awk</code>来查找遵循<code class="fe ne nf ng lr b">##</code>模式的字符串。然后它打印出一个有用的格式化版本的注释。</p><p id="2240" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将把它放在文件的顶部，这样它就是默认的目标。现在要查看我们所有方便的快捷方式和它们的功能，我们只需运行<code class="fe ne nf ng lr b">make</code>，或<code class="fe ne nf ng lr b">make help</code>:</p><pre class="kj kk kl km gt lq lr ls lt aw lu bi"><span id="a6ab" class="lv lw it lr b gy lx ly l lz ma">help                 Show this help<br/>initial              Install tools and start development server<br/>install              Install or update dependencies<br/>serve                Run the local development server<br/>update               Do apt upgrade and autoremove</span></pre><p id="9748" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们有了自己的个性化和特定于项目的CLI工具！</p><p id="7e44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用自文档化的Makefile来改进DevOps流程的可能性几乎是无限的。你可以用它来简化任何工作流程，并产生一些非常快乐的开发人员。</p></div></div>    
</body>
</html>