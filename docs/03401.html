<html>
<head>
<title>How To Display Medium Content on Your Site</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在你的网站上显示媒体内容</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-display-medium-content-on-your-site-6ae6adf8a304?source=collection_archive---------8-----------------------#2020-02-07">https://betterprogramming.pub/how-to-display-medium-content-on-your-site-6ae6adf8a304?source=collection_archive---------8-----------------------#2020-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0d1d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">今天就把你的中型作品加入你的个人网站吧</h2></div><p id="42c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你不能展示你写的这些精彩的故事，那还有什么意义呢？今天，我将向您展示如何将它们构建到您的网站中！下面是最终产品。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/fa3fd5fe58523c9c916b7eaaabe4274e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHT0fCABa2-3P7J1_cD0AA.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="cb63" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">目标</h1><p id="b410" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">构建一个React组件来显示您的媒体故事。</p><p id="78ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个过程与你想象的有点不同，但仍然非常简单。我们将向Medium允许公众访问的RSS提要发出一个API请求，将其转换为<code class="fe mu mv mw mx b">.json</code>，解析出我们需要的内容，并在我们的站点上显示出来。</p><p id="008b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们所有的内容都是公开的，所以不需要认证。此外，Medium没有构建API路由来访问单个故事(至少在撰写本文时是这样)，因此这是我们将采用的方法。</p><p id="bac4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我已经将它构建到我的个人文件夹中(我希望你也这样做)，但是为了本教程，我已经创建了一个新的React项目，只包含单个组件。</p><p id="77fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你对我如何设置我的环境有任何问题，我已经在<a class="ae my" href="https://medium.com/better-programming/my-react-dev-environment-setup-ded7cedb87a" rel="noopener">我的React开发环境设置</a>中一步一步地写出了如何复制我的开发环境(Visual Studio代码，React，git)。我的应用程序设置(reactstrap)是在<a class="ae my" href="https://medium.com/better-programming/easily-create-a-form-with-react-hooks-1cab17e2be0d" rel="noopener">开始时用React钩子轻松创建一个表单。</a></p><p id="5a4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的项目可以在这个<a class="ae my" href="https://github.com/ryangleason82/BlogComponent" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中看到。</p><p id="088b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们开始吧！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="c934" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">API请求</h1><p id="9912" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">为了访问我们需要的所有数据，我们将到达以下端点:</p><pre class="lf lg lh li gt mz mx na nb aw nc bi"><span id="f564" class="nd ly it mx b gy ne nf l ng nh"><a class="ae my" href="https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/${name}" rel="noopener ugc nofollow">https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/${name}</a> </span></pre><p id="eaa8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我知道这看起来有点乱。如果你正在寻找一个例子，这就是在<a class="ae my" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">邮递员</a>中的样子。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ni"><img src="../Images/6199ca1109baf20bcae82e89be48ef6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yau2_mgfjOfTLQKjFT8upg.png"/></div></div></figure><p id="223e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以看到我们正在使用<a class="ae my" href="https://rss2json.com/#rss_url=https%3A%2F%2Ftechcrunch.com%2Ffeed%2F" rel="noopener ugc nofollow" target="_blank"> rss2json </a>来将响应转换成我们可以使用的格式(<code class="fe mu mv mw mx b">.json</code>)。</p><p id="d778" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">点击“发送”，您应该会看到类似下图的内容。作为提醒，这将是一个有力的回应:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nj"><img src="../Images/3e1c73abf88dda39c18d17fa06cba210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1Y5H2EPRv1utjD86c48dg.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">来自邮递员的截图</p></figure><p id="89c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以看到与您的订阅源相关的所有信息，以及您的每个故事。</p><p id="3822" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae my" href="https://medium.com/better-programming/stand-up-a-node-js-rest-api-in-just-9-minutes-1a1f60fe5fc2" rel="noopener">仅用9分钟就立起一个node . js REST API</a>是我最近的一篇文章，所以这是最先出现的，因为它是按发布日期排序的。我发布到Medium的所有故事都会被退回。</p><p id="9839" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完美！现在我们已经有了数据，我们准备构建React组件。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="8d26" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">反应组分</h1><p id="6f72" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们首先要创建一个名为<code class="fe mu mv mw mx b">Blog.js</code>的空组件。这是我们的目录结构的样子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi no"><img src="../Images/af06844eb8f11105a089ee65722080ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*zl3jBCALj_ggsjXYz3no0A.png"/></div></figure><p id="863f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mu mv mw mx b">Blog.js</code>内部，我们将使用<code class="fe mu mv mw mx b">state</code>来存储我们的API响应。<code class="fe mu mv mw mx b">useState()</code>挂钩将帮助我们做到这一点。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="15f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我来告诉你。</p><p id="0815" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们将有两种不同的状态——一种存储API请求，另一种存储加载状态。当我们的API获取数据时，我们希望将<code class="fe mu mv mw mx b">isLoading</code>状态设置为<code class="fe mu mv mw mx b">true</code>。这将给<code class="fe mu mv mw mx b">fetch()</code>一些时间来发出请求并正确接收响应。</p><p id="09d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦API请求完成，我们得到了响应，我们希望将它设置为我们的<code class="fe mu mv mw mx b">mediumData</code>状态。数据将存储在一个数组中，其中每一篇文章都是该数组中的一个不同元素。</p><p id="d703" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想确保你已经成功地执行了你的请求，我建议加上一个<code class="fe mu mv mw mx b">console.log(mediumData)</code>。它还为您提供了正在处理的数据的可视化效果。</p><p id="eb93" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们将显示我们的数据！</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="9e62" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面我来解释。</p><p id="0b53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我只想显示我的提要中的前六篇文章。你可以通过使用<code class="fe mu mv mw mx b">slice()</code>方法把它变成你想要的任何数字，如下所示:</p><pre class="lf lg lh li gt mz mx na nb aw nc bi"><span id="86bd" class="nd ly it mx b gy ne nf l ng nh">const finalData = mediumData.slice(0, 6);</span></pre><p id="37fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您会注意到，当我们的数据被获取并且<code class="fe mu mv mw mx b">isLoading</code>状态被设置为<code class="fe mu mv mw mx b">true</code>时，“从介质获取数据！”显示在屏幕上。你可以用Spinner gif或者任何你想要的东西来代替它。这要感谢这里有用的<code class="fe mu mv mw mx b">JSX</code>:</p><pre class="lf lg lh li gt mz mx na nb aw nc bi"><span id="0e46" class="nd ly it mx b gy ne nf l ng nh">{isLoading &amp;&amp; &lt;p&gt;Fetching data from Medium!&lt;/p&gt;}</span></pre><p id="1625" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们<code class="fe mu mv mw mx b">.map</code>遍历数组的每个元素，取出缩略图、标题和出版日期。我们将这个信息放在一个反应陷阱<code class="fe mu mv mw mx b">Card</code>中。</p><p id="7760" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用了<code class="fe mu mv mw mx b">Moment</code>库以一种更方便读者的方式来格式化发布日期:</p><pre class="lf lg lh li gt mz mx na nb aw nc bi"><span id="2795" class="nd ly it mx b gy ne nf l ng nh">{moment(article.pubDate).format(“dddd, MMMM Do YYYY”)}</span></pre><p id="b958" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它获取一个看起来像<code class="fe mu mv mw mx b">2020–01–29 15:36:34</code>的日期，并将其转换为<code class="fe mu mv mw mx b">Wednesday, January 29th 2020</code>。非常容易。</p><p id="8622" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样！这是一种非常简单的方法，可以从源中提取关于媒体内容的信息，并在任何需要的地方显示。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="ffcb" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">更新</h1><p id="814c" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">因为这是我密切关注的事情，因为它是在我的个人网站上，我会在每次看到问题时发布更新。</p><p id="25de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2020年2月9日:我最近回复了对我的一个故事的评论，如下图所示。所以现在每次我从Medium中提取数据时，回复都被算作一篇文章。我只想显示我的实际文章，而不是回应。我们如何解决这个问题？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nr"><img src="../Images/ab116f096a93e165c9d42858a2aa6f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YOt75qhoCT3gtoA96xxpKQ.png"/></div></div></figure><p id="6683" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常容易。在创建新的切片数组之前，我们可以对其进行过滤。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2846139e8c285c32cde6a2c332c4ced5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*LtTeqPXa7Z1sxFJeHR97sw.png"/></div></figure><p id="2728" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您查看响应中的JSON对象，您会注意到categories数组是空的。对于每一篇发表的文章(我们想要的),数组中有5个元素。我们要做的就是过滤掉没有<code class="fe mu mv mw mx b">categories.length &gt; 0.</code>的数组元素</p><p id="b3c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是整个系列的外观:</p><pre class="lf lg lh li gt mz mx na nb aw nc bi"><span id="89f5" class="nd ly it mx b gy ne nf l ng nh">const newArray = mediumData<br/> .filter(article =&gt; article.categories.length &gt; 0)<br/> .slice(0, 6);</span></pre><h1 id="8152" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">回顾</h1><p id="151d" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">我们刚刚做了什么？</p><ul class=""><li id="9897" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">找到了包含所有文章信息的端点</li><li id="7ce0" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated">将信息从<code class="fe mu mv mw mx b">RSS</code>转换为<code class="fe mu mv mw mx b">JSON</code></li><li id="78ef" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated">使用<code class="fe mu mv mw mx b">useEffect()</code>钩子发出一个API请求</li><li id="ca57" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated">创建了一个可以在任何地方使用的简单组件</li></ul><p id="03d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你在你的网站上使用这个！如果你有任何问题、意见或顾虑，欢迎在评论区留言。</p></div></div>    
</body>
</html>