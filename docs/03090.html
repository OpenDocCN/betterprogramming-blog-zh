<html>
<head>
<title>Create a Tooltip Component Using React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React挂钩创建工具提示组件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-tooltip-component-using-react-hooks-cb9fd00a2ff0?source=collection_archive---------4-----------------------#2020-01-20">https://betterprogramming.pub/create-a-tooltip-component-using-react-hooks-cb9fd00a2ff0?source=collection_archive---------4-----------------------#2020-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ec7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从功能上给你的用户一些方便的信息</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4cf7eff802e8e1cffdb0c713d3ad9b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyF18KdQiO61Ui1ZDgmgvg.png"/></div></div></figure><p id="bef5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如今，每个用<a class="ae ln" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>编码的人都知道名为<a class="ae ln" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">钩子</a>的新发布特性。</p><p id="ac1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，我将带你使用这个特性创建一个简单的<strong class="kt ir">工具提示</strong>。</p><p id="e752" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里有一个来自存储库的屏幕截图，显示了我们将要实际构建的组件:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lo"><img src="../Images/d4b5a7524625bc5be0aba3befb25b260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEVl3GI4BBwFsjKVTr5YyA.png"/></div></div></figure><p id="63cd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有关更多详情，请点击以下链接:</p><p id="e001" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://3tmaan.github.io/react-hooks-tooltip/dist/index.html" rel="noopener ugc nofollow" target="_blank">https://3 tmaan . github . io/react-hooks-tooltip/dist/index . html</a></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="320f" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">组件结构</h1><p id="bbc6" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">工具提示通常用于在用户将鼠标指针移动到某个元素上时向用户提供一些信息。然而，在本教程中，我们将实现一个点击事件，我们将看到如何处理内的<strong class="kt ir">和</strong>外的<strong class="kt ir">点击。</strong></p><p id="3d20" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将创建的组件结构如下:</p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="5f4d" class="my lx iq mu b gy mz na l nb nc">&lt;Tooltip <strong class="mu ir">title</strong>="Tooltip on top" <strong class="mu ir">position</strong>="top"&gt;<br/>    <strong class="mu ir">&lt;button&gt;Tooltip on top&lt;/button&gt;</strong><br/>&lt;/Tooltip&gt;</span></pre><p id="646f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它会有<strong class="kt ir">三个道具:</strong>、<code class="fe nd ne nf mu b">position</code>，还有一个<strong class="kt ir">单胎— </strong> <code class="fe nd ne nf mu b">button</code>，如上图。子道具可以是任何东西，只要是<code class="fe nd ne nf mu b">orphan</code>。</p><ul class=""><li id="489e" class="ng nh iq kt b ku kv kx ky la ni le nj li nk lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">title</code>会按住工具提示的内容</li><li id="7bfa" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">position</code>将处理工具提示的不同位置(<code class="fe nd ne nf mu b">top</code> | <code class="fe nd ne nf mu b">right</code> | <code class="fe nd ne nf mu b">left</code> | <code class="fe nd ne nf mu b">bottom</code>)</li><li id="2e3d" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">button</code>将是可点击的元素，以显示额外的内容。</li></ul><p id="c2c8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们创建<code class="fe nd ne nf mu b">App</code>文件，我们将在其中导入并使用<code class="fe nd ne nf mu b">Tooltip</code>组件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="28d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将渲染我们的组件四次，以覆盖所有不同的位置，并看到他们的行动。</p><p id="9599" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上面的代码将无法工作，因为没有找到这样的工具提示文件，所以让我们创建它。</p><h1 id="56ce" class="lw lx iq bd ly lz nw mb mc md nx mf mg jw ny jx mi jz nz ka mk kc oa kd mm mn bi translated">组件逻辑</h1><p id="4568" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">让我们从React导入所需的<strong class="kt ir">钩子</strong></p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="6c47" class="my lx iq mu b gy mz na l nb nc">// Externals<br/>import React, { <strong class="mu ir">useEffect</strong>, <strong class="mu ir">useRef</strong>, <strong class="mu ir">useState</strong> } from 'react';</span></pre><ul class=""><li id="54ee" class="ng nh iq kt b ku kv kx ky la ni le nj li nk lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">useEffect</code>类似于<code class="fe nd ne nf mu b">componentDidMount</code>和<code class="fe nd ne nf mu b">componentDidUpdate</code></li><li id="ce91" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">useRef</code>向元素返回一个可变的<code class="fe nd ne nf mu b">ref</code>对象</li><li id="076f" class="ng nh iq kt b ku np kx nq la nr le ns li nt lm nl nm nn no bi translated"><code class="fe nd ne nf mu b">useState</code>返回一个<code class="fe nd ne nf mu b">stateful value</code>，和一个<code class="fe nd ne nf mu b">function</code>来更新它</li></ul><p id="e3e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后是组件逻辑:</p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="36b1" class="my lx iq mu b gy mz na l nb nc">const node = <strong class="mu ir">useRef</strong>();<br/>const [<strong class="mu ir">isVisible</strong>, <strong class="mu ir">setState</strong>] = <strong class="mu ir">useState</strong>(false);<br/>const <strong class="mu ir">handleClick</strong> = ({ target }) =&gt; {<br/>    if (node.current.contains(target)) {<br/>        // inside click<br/>        return;<br/>    }<br/>    // outside click<br/>    <strong class="mu ir">setState</strong>(false);<br/>};</span></pre><p id="7911" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里我们启动了负责每个元素的组件逻辑的不同方法，多亏了<code class="fe nd ne nf mu b">useRef()</code>，它返回了该元素的可变ref对象。<code class="fe nd ne nf mu b">handleClick()</code>将同时负责内的<strong class="kt ir">和</strong>外的<strong class="kt ir">为<strong class="kt ir">当前</strong>安装的元件点击。</strong></p><p id="f32e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了调用我们的<code class="fe nd ne nf mu b">handleClick()</code>，我们需要将它附加到一个<strong class="kt ir">事件监听器</strong>。因为我们使用了<strong class="kt ir">钩子</strong>，所以调用需要在<code class="fe nd ne nf mu b">useEffect()</code>内部，就像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d354" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nd ne nf mu b">useEffect()</code>方法处理<code class="fe nd ne nf mu b">componentDidMount()</code>和<code class="fe nd ne nf mu b">componentWillUnmount()</code>生命周期方法，所以当组件被卸载或从DOM中移除时，我们甚至可以<em class="ob">销毁</em>和<code class="fe nd ne nf mu b">event listener</code>。</p><p id="609a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们快完成了。现在是时候调用<em class="ob"> render方法了——换句话说，</em>我们将返回组件布局。</p><p id="125a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ob">我们没有使用基于类的组件，所以没有所谓的“渲染”方法，感谢</em> <strong class="kt ir"> <em class="ob">钩子</em> </strong> <em class="ob">。</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a92b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ob">请注意</em> <code class="fe nd ne nf mu b"><em class="ob">data-testid</em></code> <em class="ob">仅用于测试目的，您可能不需要。</em></p><p id="6df9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">工具提示的内容只有在<code class="fe nd ne nf mu b">isVisible</code>为<code class="fe nd ne nf mu b">true</code>时才可见，在外部点击时将被设置为<code class="fe nd ne nf mu b">false</code>。</p><p id="edc1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了使我们的组件更有弹性，让我们为我们的属性添加一个默认值，如果没有定义，它将被放在元素的右边。我们可以使用<code class="fe nd ne nf mu b"><a class="ae ln" href="https://reactjs.org/docs/typechecking-with-proptypes.html" rel="noopener ugc nofollow" target="_blank">propTypes</a></code>轻松实现。</p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="6c59" class="my lx iq mu b gy mz na l nb nc">Tooltip.defaultProps = {<br/>    position: 'right',<br/>};</span></pre><p id="331e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">说到<code class="fe nd ne nf mu b">propType</code> s和韧性，我们应该确保正确地检查我们的道具类型以避免意外。我们可以这样定义对象:</p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="3419" class="my lx iq mu b gy mz na l nb nc">const propTypes = <!-- -->{<br/>    <!-- -->title: PropTypes.string.isRequired,<br/>    position: PropTypes.string,<br/>    children: PropTypes.node.isRequired,<br/>};</span></pre><p id="d3f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">需要<code class="fe nd ne nf mu b">title</code>和<code class="fe nd ne nf mu b">children</code>的地方。</p><p id="68e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后但同样重要的是，我们可以从<strong class="kt ir">导出<code class="fe nd ne nf mu b">propTypes</code>和<code class="fe nd ne nf mu b">Tooltip</code>组件。</strong></p><pre class="kg kh ki kj gt mt mu mv mw aw mx bi"><span id="5580" class="my lx iq mu b gy mz na l nb nc">Tooltip.propTypes = propTypes;<br/><br/>export default Tooltip;</span></pre><p id="b0e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在这里看到整个文件<a class="ae ln" href="https://github.com/3tmaan/react-hooks-tooltip/blob/master/src/components/Tooltip/Tooltip.js" rel="noopener ugc nofollow" target="_blank">和</a></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="ffff" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">下一步是什么？</h1><p id="b3d6" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">我们可以通过添加更多的功能来进一步推动这个组件，比如添加一个嵌入的HTML 的可能性。此外，还可以应用不同的大小，或者在移动设备的模式中显示工具提示内容。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="5f2c" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">资源</h1><p id="4db4" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">回购链接:【https://github.com/3tmaan/react-hooks-tooltip】T3</p><p id="d61e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">实例:<br/><a class="ae ln" href="https://3tmaan.github.io/react-hooks-tooltip/dist/index.html" rel="noopener ugc nofollow" target="_blank">https://3 tmaan . github . io/react-hooks-tooltip/dist/index . html</a></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="40f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">祝编码愉快！</p></div></div>    
</body>
</html>