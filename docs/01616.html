<html>
<head>
<title>Why is 0.1 + 0.2 Not Equal to 0.3 in Most Programming Languages?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么大多数编程语言中0.1 + 0.2不等于0.3？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-is-0-1-0-2-not-equal-to-0-3-in-most-programming-languages-99432310d476?source=collection_archive---------0-----------------------#2019-09-30">https://betterprogramming.pub/why-is-0-1-0-2-not-equal-to-0-3-in-most-programming-languages-99432310d476?source=collection_archive---------0-----------------------#2019-09-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/4393fb17749c50265965d2c63af0cf99.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*omAen9uiC6H13SHRw5qVwQ.png"/></div></figure><p id="0eec" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">从小我们就被教导0.1 + 0.2等于0.3。然而，在令人困惑的计算世界中，事情的运作方式完全不同。</p><p id="5c8a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我最近开始用JavaScript编码，在阅读有关数据类型的内容时，我注意到0.1 + 0.2不等于0.3的奇怪行为。我求助于<a class="ae kv" href="https://stackoverflow.com/" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>，找到了几个有用的帖子。请看下面:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kw"><img src="../Images/077d3b659cbe3307dff30bc8edb59366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EgcTv7g3YqKD15-mxl5RA.png"/></div></div></figure><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lf"><img src="../Images/2cd219138f8dfdcc2d754e7231c02fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*hYVOekmH_4p2XgiU6c2trw.png"/></div></div><p class="lg lh gj gh gi li lj bd b be z dk translated">堆栈溢出参考图像</p></figure><p id="631d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在做了大量的研究和数学计算后，我得出结论，这不是一个错误。这就是数学:浮点运算。让我们更深入地了解幕后发生的事情。</p><p id="2f2e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">问题陈述:</strong>那<code class="fe lk ll lm ln b">0.1 + 0.2 = 0.30000000000000004</code>是怎么回事？</p><p id="7e69" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">好吧，如果你已经用Java或C语言编程过，你必须知道不同的数据类型用来存储值。我们在前面的讨论中要考虑的两种数据类型是<em class="lo"> integer </em>和<em class="lo"> float。</em></p><p id="cad7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">整数数据类型存储整数，而浮点数据类型存储小数。</p><p id="d28c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们继续之前，让我们理解一个小概念:为了计算的目的，数字是如何表示的？非常小和非常大的数字通常用科学记数法存储。它们表示为:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/d087d0a261214e1ea531edf244dfe2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/0*iQDY7iSJn5TZ9joD.png"/></div></figure><p id="2d73" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">此外，当一个数字用科学记数法书写时，如果在小数点前有一个非零的十进制数字，则该数字是规范化的。例如，科学记数法中的数字0.0005606经过标准化后将表示为:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/97612ebeb2be169f7d4b5a16496fb130.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*Mv3QdU4WkDneMOWGpr8Ymw.png"/></div></figure><p id="5884" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="lo">有效位</em>是不包含零的有效位数，而<em class="lo">基数</em>代表使用的基数系统——这里是十进制(10)。<em class="lo">指数</em>代表基点需要向左或向右移动的位数，以正确表示。</p><p id="87d8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在，浮点运算中有两种显示数字的方式:单精度和双精度。单精度使用32位，双精度使用64位进行浮点运算。</p><p id="7eec" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">与许多其他编程语言不同，JavaScript没有定义不同类型的数字数据类型，并且总是将数字存储为双精度浮点数，遵循国际<a class="ae kv" href="https://www.geeksforgeeks.org/ieee-standard-754-floating-point-numbers/" rel="noopener ugc nofollow" target="_blank"> IEEE 754标准</a>。</p><p id="1c20" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这种格式以64位存储数字，其中数字(分数)存储在0至51位，指数存储在52至62位，符号存储在63位。</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/fba22f7c5f0dea349e6b508eaccaac6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*imL6DhMjEkovKn1k78IKfQ.png"/></div><p class="lg lh gj gh gi li lj bd b be z dk translated">IEEE754双精度标准</p></figure><p id="9c35" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">让我们按照IEEE754标准用64位表示0.1。</p><p id="7348" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">第一步是将<code class="fe lk ll lm ln b">(0.1)base 10</code>转换成它的二进制等价物<code class="fe lk ll lm ln b">(base 2)</code>。<br/>为此，我们将从<code class="fe lk ll lm ln b">0.1</code>乘以<code class="fe lk ll lm ln b">2</code>开始，并分离出十进制之前的数字，以获得二进制等值。</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/8a6eacdf1c0faed52e3ee9625c009317.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*z_sj8Rfqx068U7AHoymx9w.png"/></div></figure><p id="d413" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在对64位重复这一过程时，我们将按升序排列它们，以获得我们的尾数，我们将根据双精度标准将其四舍五入为52位。</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lt"><img src="../Images/4f123647f9f70933bff8b1a853dc8db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JN46HCzRJly7YlqwybCoMQ.png"/></div></div><p class="lg lh gj gh gi li lj bd b be z dk translated">尾数</p></figure><p id="e74b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">以科学形式表示并四舍五入到前52位将得出:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lu"><img src="../Images/cae71b10de46b50d4c808954a7438e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLER7zKzNr7nD-SXoApRBw.png"/></div></div></figure><p id="3a42" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">尾数部分准备好了。现在，对于指数，我们将使用下面的计算:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/237f51ebc8e8abd6a5a676cf602a3ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*ozI1EwDXAdJc-hMHLYL5ig.png"/></div></figure><p id="5477" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这里，<code class="fe lk ll lm ln b">11</code>代表我们将用于64位指数表示的位数，而<code class="fe lk ll lm ln b">-4</code>代表来自科学记数法的指数。</p><p id="77c6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">数字0.1的最终表示是:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lw"><img src="../Images/20bdb92760333e7ed52b27bbf17a1222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fd8C4frGrb8oaegRkVw7cg.png"/></div></div></figure><p id="6f29" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">类似地，0.2可以表示为:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lx"><img src="../Images/6d6c90af18615f3d706d7e7243ed705a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ri9RCDE11ya5dOPRHBtEg.png"/></div></div></figure><p id="16b9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在使两者的指数相同后，将两者相加将得到:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ly"><img src="../Images/e8a90f42842537c4ba1762a0b50dd7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UcE_Li_QNaHELT84vDFtQ.png"/></div></div></figure><p id="744d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当用浮点表示时，这变成:</p><figure class="kx ky kz la gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lz"><img src="../Images/7d7da5ab6de1ad6186912c1c22cceab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iu3FdpO09mq1O_jL.png"/></div></div></figure><p id="3104" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这个用<code class="fe lk ll lm ln b">0.1 + 0.2</code>来表示。</p><p id="dad6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这正是获得<code class="fe lk ll lm ln b">0.1 + 0.2 = 0.30000000000000004</code>背后的原因。</p><p id="f155" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">感谢阅读。订阅我的<a class="ae kv" href="https://parulmalhotra.substack.com/?r=2cisn&amp;utm_campaign=pub&amp;utm_medium=web&amp;utm_source=copy" rel="noopener ugc nofollow" target="_blank">时事通讯</a>获取更多关于我学习和构建的东西的更新。</p></div></div>    
</body>
</html>