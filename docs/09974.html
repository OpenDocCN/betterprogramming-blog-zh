<html>
<head>
<title>Everything You Need to Know About Django Models in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于Python中的Django模型，您需要知道的一切</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/everything-you-need-to-know-about-django-models-in-python-2a44ed4293dd?source=collection_archive---------4-----------------------#2021-11-09">https://betterprogramming.pub/everything-you-need-to-know-about-django-models-in-python-2a44ed4293dd?source=collection_archive---------4-----------------------#2021-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1f29" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">Django模型综合指南</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cd3f463cafafc1c13123316c49517f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T4hzx7l38LTLyimv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">达伦·博克曼在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3fd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Django是一个用python编写的高级web框架。它用于构建复杂的数据库驱动的应用程序。Django使用MVT框架。MVT框架由以下部分组成:</p><ul class=""><li id="2fdb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">模型</li><li id="5d2e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">视角</li><li id="578c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">模板</li></ul><p id="9d5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将介绍关于Django模型的所有知识，在本教程结束时，您将能够</p><ul class=""><li id="efec" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">创建Django项目</li><li id="5c83" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用模型表示Django中的对象。</li></ul><h1 id="cabe" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">设置Django项目</strong></h1><p id="6d60" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们将从创建一个新的Django项目开始。我们的项目将是一个电影数据库系统。</p><p id="823e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个目录并放入cd。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0c76" class="nl mk it nh b gy nm nn l no np">$ mkdir movie_db</span><span id="d03d" class="nl mk it nh b gy nq nn l no np">$ cd movie_db</span></pre><p id="3298" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建虚拟环境:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3216" class="nl mk it nh b gy nm nn l no np">$ python3.8 -m venv env</span></pre><p id="0f07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">激活虚拟环境:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a0be" class="nl mk it nh b gy nm nn l no np">$ source env/bin/activate</span></pre><p id="3ac6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在虚拟环境中安装Django:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2413" class="nl mk it nh b gy nm nn l no np">(env)$ pip install Django</span></pre><p id="a63e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个名为<code class="fe nr ns nt nh b">django_movie</code>的新Django项目</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a57b" class="nl mk it nh b gy nm nn l no np">(env)$ django-admin startproject django_movie .</span></pre><p id="3d98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建Django应用程序:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="1546" class="nl mk it nh b gy nm nn l no np">(myenv)$ django-admin startapp movie_library</span></pre><p id="31d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述命令将创建以下文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/dbfa8d5d00f820dd7b3c60d4f94df0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qm2TnnYW91PzAbCwkRQV5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电影_图书馆</p></figure><p id="6704" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将该应用添加到<code class="fe nr ns nt nh b">settings.py</code>中的<code class="fe nr ns nt nh b">INSTALLED_APPS</code>列表中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="6092" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">车型</strong></h1><p id="5b4e" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">模型代表django应用程序中的对象。对于我们的应用，我们需要问自己；</p><ul class=""><li id="a082" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">创建电影数据库系统需要什么信息</li><li id="759b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">应该存储什么样的信息？</li><li id="716f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">信息应该如何存储？</li></ul><p id="c1dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些问题将让我们了解我们的数据会是什么样子。从上面的问题中，我们现在知道了一部电影应该有一个电影名称、类型、发行年份、年龄等级、平均等级等等。</p><p id="6035" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据上面的信息，我们可以开始编写我们的模型。当我们创建应用程序movie_library时，django已经为我们提供了一个名为<code class="fe nr ns nt nh b">models.py</code>的文件，其起始代码如下:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="d445" class="nl mk it nh b gy nm nn l no np">#movie_library/models.py</span><span id="0dc4" class="nl mk it nh b gy nq nn l no np">from django.db import models</span><span id="4f06" class="nl mk it nh b gy nq nn l no np"># Create your models here.</span></pre><p id="6397" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建一个模型，我们编写一个继承自模型父类<code class="fe nr ns nt nh b">django.db.models</code>的类。模型模块。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a81c" class="nl mk it nh b gy nm nn l no np">class Movie(models.Model):</span><span id="f440" class="nl mk it nh b gy nq nn l no np">    pass</span></pre><h1 id="a124" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">模型字段类型</strong></h1><p id="4b59" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在我们的例子中，模型的每个属性(<code class="fe nr ns nt nh b">movie_name</code>、<code class="fe nr ns nt nh b">genre</code>、<code class="fe nr ns nt nh b">year_of_release</code>、<code class="fe nr ns nt nh b">age_rating</code>、<code class="fe nr ns nt nh b">average_rating</code>)代表一个数据库字段。例如，属性movie_name将有一个<code class="fe nr ns nt nh b">CharField</code>:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="7949" class="nl mk it nh b gy nm nn l no np">class Movie(models.Model):</span><span id="69b2" class="nl mk it nh b gy nq nn l no np">    movie_name = models.CharField()</span></pre><p id="9581" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">字段标题的类型是<code class="fe nr ns nt nh b">models.CharField</code>——这意味着该字段将包含字母数字字符串。</p><h1 id="8d47" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">模型字段选项</strong></h1><p id="8492" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">模型字段也接受一组特定的字段参数。例如，我们上面定义的<code class="fe nr ns nt nh b">CharField</code>带有一个参数<code class="fe nr ns nt nh b">max_length</code>，它决定了输入到数据库中的值的长度。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="36d2" class="nl mk it nh b gy nm nn l no np">class Movie(models.Model):</span><span id="1eb2" class="nl mk it nh b gy nq nn l no np">   movie_name = models.CharField(max_length= 100)</span></pre><h2 id="6461" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">油田</h2><p id="88e4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">UUID字段是用于存储通用唯一标识符的字段。它使用Python的<code class="fe nr ns nt nh b"><a class="ae ky" href="https://docs.python.org/3/library/uuid.html#uuid.UUID" rel="noopener ugc nofollow" target="_blank">UUID</a> </code>类。对于<code class="fe nr ns nt nh b">primary_key</code>，通用唯一标识符是<code class="fe nr ns nt nh b">AutoField</code>的绝佳替代物。</p><p id="7371" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们将使用<code class="fe nr ns nt nh b">UUID</code>来定义一个唯一的主键，并将其设置为不可编辑。</p><p id="eeeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe nr ns nt nh b">models.py</code>文件，在电影类的主体中添加<code class="fe nr ns nt nh b">id</code>字段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="17bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nh b">editable</code>是另一个字段选项，这意味着该字段将不会在管理中显示。</p><p id="04b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电影的名字将是第二个字符串字段。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a6f4" class="nl mk it nh b gy nm nn l no np">class Movie(models.Model):</span><span id="9b15" class="nl mk it nh b gy nq nn l no np">    id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)</span><span id="bbbb" class="nl mk it nh b gy nq nn l no np">    movie_name = models.CharField(max_length= 100)</span></pre><ul class=""><li id="0d4c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">max _ length = 100表示该字段中值的最大长度为100个字符。</li></ul><p id="61bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nh b">CharField</code>的其他自变量是<code class="fe nr ns nt nh b">null</code>和<code class="fe nr ns nt nh b">blank</code>。<code class="fe nr ns nt nh b">Null</code>表示一个字段可以没有信息；默认值为false。<code class="fe nr ns nt nh b">Blank</code>表示一个字段不取任何值，甚至不取null，默认为False。</p><p id="244b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，对于<code class="fe nr ns nt nh b">movie_name</code>字段，我们可以将其更新如下:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b97a" class="nl mk it nh b gy nm nn l no np">movie_name = models.CharField(max_length= 100, blank=False)</span></pre><h2 id="c2b8" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">型号选择</strong></h2><p id="4bc0" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Django中的选择限制了字段可以接受的输入。例如，我们知道电影有许多类型，所以我们必须选择一个包含这些电影类型的框，而不是标准的文本字段。</p><p id="81a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元组使用键、值对创建选择，其中键是模型上的实际值集，值是人类可读的名称。添加流派字段，这将是一个<code class="fe nr ns nt nh b">CharField</code>，并接受选择作为流派选择。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="d6eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加<code class="fe nr ns nt nh b">year_of _release</code>字段，它是一个<code class="fe nr ns nt nh b">DateField</code>。不要忘记导入顶部的<code class="fe nr ns nt nh b">datetime</code>模块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5c80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，添加<code class="fe nr ns nt nh b">rating</code>。美国电影协会电影分级系统有以下分级:</p><ul class=""><li id="6227" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">G —普通观众</li><li id="08a4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">PG-13:父母强烈警告，一些内容可能不适合13岁以下的儿童。</li><li id="55d5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">r-受限</li><li id="87dd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">NC-17 —仅限成人</li><li id="dcb3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">PG —建议家长指导</li></ul><p id="d32d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">评级字段也将接受选择。创建一个包含不同电影分级的元组，如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="b6cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后添加将元组作为参数的<code class="fe nr ns nt nh b">age_rating</code>字段。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0e5c" class="nl mk it nh b gy nm nn l no np">age_rating = models.CharField(max_length= 5, choices = AGE_RATING, default = "GENERAL AUDIENCE")</span></pre><p id="c014" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，添加一个<code class="fe nr ns nt nh b">average_rating</code>，这是一个<code class="fe nr ns nt nh b">FloatField</code></p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="5b3e" class="nl mk it nh b gy nm nn l no np">average_rating = models.FloatField()</span></pre><p id="0281" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们希望评级范围从1.0到10.0，我们将在字段中放置验证器，这将确保该值小于或等于10.0。第一个进口<code class="fe nr ns nt nh b">MaxValueValidator</code>和<code class="fe nr ns nt nh b">MinValueValidator</code>在最上面。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="87d5" class="nl mk it nh b gy nm nn l no np">from django.core.validators import MaxValueValidator, MinValueValidator</span></pre><p id="13a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后更新<code class="fe nr ns nt nh b">average_rating</code>字段，以包含所需的值范围。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3309" class="nl mk it nh b gy nm nn l no np">average_rating = models.FloatField(</span><span id="8d46" class="nl mk it nh b gy nq nn l no np">validators=[MinValueValidator(0.0), MaxValueValidator(10.0)],</span><span id="80fc" class="nl mk it nh b gy nq nn l no np">)</span></pre><p id="39be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他常用字段有:</p><ul class=""><li id="66ab" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">TextField</code>用于存储冗长的字符串</li><li id="66cf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">IntegerField</code>用于存储整数值</li><li id="db2c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">DateTimeField</code>用于存储日期/时间信息</li><li id="43ed" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">EmailField</code>用于存储电子邮件地址。</li><li id="35f2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">FileField</code>用于上传文件</li><li id="5661" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">ImageField</code>用于上传图片</li><li id="5301" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">ForeignKey</code>指定与另一个模型的一对多关系。</li><li id="8aa3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nr ns nt nh b">ManyToManyField</code>用于建立模型之间的多对多关系。</li></ul><p id="0959" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在已经完成了模型字段。</p><h2 id="ed7a" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">迁徙</strong></h2><p id="a321" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们刚刚对我们的模型进行了更改，但是数据库还不知道这些更改。因此，我们需要执行迁移。</p><p id="2411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是运行<code class="fe nr ns nt nh b">makemigrations</code>命令，该命令创建一个文件，其中包含数据库创建所需模式所需的必要指令。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="f417" class="nl mk it nh b gy nm nn l no np">$ python3.8 manage.py makemigrations<br/>Migrations for 'movie_library':<br/>  movie_library/migrations/0001_initial.py<br/>    - Create model Movie</span></pre><p id="0fab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是<code class="fe nr ns nt nh b">migrate</code>命令，它为我们的模型创建数据库表。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0111" class="nl mk it nh b gy nm nn l no np">Operations to perform:<br/>  Apply all migrations: admin, auth, contenttypes, movie_library, sessions<br/>Running migrations:<br/>  Applying contenttypes.0001_initial... OK<br/>  Applying auth.0001_initial... OK<br/>  Applying admin.0001_initial... OK<br/>  Applying admin.0002_logentry_remove_auto_add... OK<br/>  Applying admin.0003_logentry_add_action_flag_choices... OK<br/>  Applying contenttypes.0002_remove_content_type_name... OK<br/>  Applying auth.0002_alter_permission_name_max_length... OK<br/>  Applying auth.0003_alter_user_email_max_length... OK<br/>  Applying auth.0004_alter_user_username_opts... OK<br/>  Applying auth.0005_alter_user_last_login_null... OK<br/>  Applying auth.0006_require_contenttypes_0002... OK<br/>  Applying auth.0007_alter_validators_add_error_messages... OK<br/>  Applying auth.0008_alter_user_username_max_length... OK<br/>  Applying auth.0009_alter_user_last_name_max_length... OK<br/>  Applying auth.0010_alter_group_name_max_length... OK<br/>  Applying auth.0011_update_proxy_permissions... OK<br/>  Applying auth.0012_alter_user_first_name_max_length... OK<br/>  Applying movie_library.0001_initial... OK<br/>  Applying sessions.0001_initial... OK</span></pre><h2 id="07f4" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">在管理中注册模型</strong></h2><p id="a882" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了与字段交互，我们在<code class="fe nr ns nt nh b">admin.py </code>中创建并注册了<code class="fe nr ns nt nh b">Movie</code>模型，如下所示。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8350" class="nl mk it nh b gy nm nn l no np">from django.contrib import admin</span><span id="98af" class="nl mk it nh b gy nq nn l no np"># Register your models here.</span><span id="6a1d" class="nl mk it nh b gy nq nn l no np">from .models import Movie</span><span id="a00c" class="nl mk it nh b gy nq nn l no np">admin.site.register(Movie)</span></pre><p id="0292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建超级用户:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="c457" class="nl mk it nh b gy nm nn l no np">$ python3.8 manage.py createsuperuser</span></pre><p id="a442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行服务器</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="50a0" class="nl mk it nh b gy nm nn l no np">$ python3.8 manage.py runserver</span></pre><p id="e5c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导航到<a class="ae ky" href="http://127.0.0.1:8000//admin" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000//admin</a>，使用超级用户凭证登录。我们来补充一些数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/47ecf5c8c8745ca1129010f011c626d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KoJyp9wX9QJ2sz3wGpMAw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加新的电影实例</p></figure><p id="e464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你在上面所看到的，字段按照我们的预期显示,<code class="fe nr ns nt nh b">genre</code>和<code class="fe nr ns nt nh b">age_rating</code>有多种选择，并且<code class="fe nr ns nt nh b">average_rating</code>验证按预期工作。</p><h2 id="aba6" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">冗长的名称</strong></h2><p id="bb8d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">详细名称是字段标签中使用的字段的可读名称。如果没有指定详细名称，Django将使用字段的属性名称自动创建它。它会将下划线转换成空格。</p><p id="1a0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，由于我们没有在字段中包含任何冗长的名称，因此在管理中看到的<code class="fe nr ns nt nh b">movie_name</code>将是<code class="fe nr ns nt nh b">Movie name</code>。</p><h1 id="50d9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">方法</strong></h1><p id="7a86" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">模型也可以有方法。</p><h2 id="26b9" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><code class="fe nr ns nt nh b"><strong class="ak">Str</strong></code>法<strong class="ak">法</strong></h2><p id="bcb2" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">当您进入管理页面查看电影实例时，它们看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/939edb3cfca5e689c461a4a5c8b0dec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DrFMZeCLTjlpyRxMs1L_lQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电影对象</p></figure><p id="d307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个Django模型都应该定义一个标准的python类方法<code class="fe nr ns nt nh b">__str__()</code>，为每个对象返回一个人类可读的字符串。每当引用模型实例时，它将使用人类可读的字符串。</p><p id="a9fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电影通常用片名和电影上映年份来表示；因此，我们的<code class="fe nr ns nt nh b">__str__</code>方法将以下面的格式返回电影实例。</p><p id="eb93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nh b">title — year_of_release</code></p><p id="5eeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在电影模型中，创建一个<code class="fe nr ns nt nh b">__str__ </code>方法，返回用连字符连接的<code class="fe nr ns nt nh b">instance’s .title </code>和<code class="fe nr ns nt nh b">.year </code>，如下所示:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="6f37" class="nl mk it nh b gy nm nn l no np">def __str__(self):</span><span id="7489" class="nl mk it nh b gy nq nn l no np">    return self.movie_name + "-" + self.year_of_release.strftime('%Y')</span></pre><p id="118f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当您在管理站点上查看电影条目时，您应该会看到它们以人类可读的方式进行了格式化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/d2fbbcab3b4f828e4b374b3a6aad024a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZxWNp1h890FHjxnxUjK1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">__str__方法</p></figure><h2 id="a030" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak"> get_absolute_url() </strong></h2><p id="c987" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">方法<code class="fe nr ns nt nh b">get_absolute_url()</code>用于指引用户到特定路径的方法；这降低了用户重新提交数据的机会。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2a3f" class="nl mk it nh b gy nm nn l no np">from django.urls import reverse<br/>def get_absolute_url(self):</span><span id="b6c7" class="nl mk it nh b gy nq nn l no np">    return reverse('movie_detail' , args= [str(Self.id)])</span></pre><p id="8407" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的方法在创建新的电影实例后返回详细视图url。</p><h2 id="68d5" class="nl mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">模型元数据</strong></h2><p id="eb10" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">元数据是应用于模型的非字段属性，它用于执行以下功能:</p><ul class=""><li id="9329" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">为数据库提供一个表名。</li><li id="fcfa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">订购实例</li><li id="fdba" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">创建人类可读的名称</li></ul><p id="a576" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要向模型添加元数据，我们需要在模型的类定义中添加另一个名为<code class="fe nr ns nt nh b">Meta</code>的类。</p><p id="8212" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元数据中的排序功能将按字母顺序对字符字段进行排序，而日期字段将按时间顺序进行排序。</p><p id="0aa5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们根据上映年份为<code class="fe nr ns nt nh b">ordering</code>电影的电影模型添加元数据。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0383" class="nl mk it nh b gy nm nn l no np">class Meta:</span><span id="e7db" class="nl mk it nh b gy nq nn l no np">    ordering = ["-year_of_release"]</span></pre><p id="8254" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也可以放个前缀(-)颠倒排序顺序，如上图；这将显示基于最近发行日期的所有电影。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/fd0db0b23717f62ccd210921ada6a737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvwTOZsK4M3wDdkP8l3n1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">排序</p></figure><p id="9331" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nh b">models.py </code>的完整代码如下所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">models.py</p></figure><h1 id="54fe" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">结论</strong></h1><p id="7c23" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本教程中，我们学习了如何开发构建模型所需的数据。</p><p id="e21b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还学习了如何在电影数据库系统中定义和实现模型。</p><blockquote class="oi oj ok"><p id="b158" class="kz la ol lb b lc ld ju le lf lg jx lh om lj lk ll on ln lo lp oo lr ls lt lu im bi translated">嘿，朋友，如果你想阅读更多的教程，可以考虑注册成为一名灵媒来支持我的工作。每月只需5美元，你就可以无限制地使用Medium。</p></blockquote></div></div>    
</body>
</html>