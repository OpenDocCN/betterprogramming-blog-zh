<html>
<head>
<title>27 Simple Bash Scripting Tips for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的27个简单Bash脚本技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/27-simple-bash-scripting-tips-for-beginners-d6764c977546?source=collection_archive---------0-----------------------#2021-02-10">https://betterprogramming.pub/27-simple-bash-scripting-tips-for-beginners-d6764c977546?source=collection_archive---------0-----------------------#2021-02-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="06c5" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">不要害怕Bash脚本。看完这些提示会更容易</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/5324cf118c9d32d6cc2cf7aa679304e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3zk9XX13VDYIoi1t2hFPw.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来自<a class="ae kz" href="https://www.pexels.com/search/shell/" rel="noopener ugc nofollow" target="_blank">像素</a>的自由图像</p></figure><p id="f0c3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[更新于2021年2月18日。代码更改为要点并添加了链接]</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="fd85" class="mb mc iu lx b gz md me l mf mg"><strong class="lx iv">Table of Contents</strong><br/><a class="ae kz" href="#0d60" rel="noopener ugc nofollow">Introduction</a><br/><a class="ae kz" href="#d44f" rel="noopener ugc nofollow">1. Clean Structure</a><br/><a class="ae kz" href="#fb47" rel="noopener ugc nofollow">2. Install ShellCheck on Your Editor</a><br/><a class="ae kz" href="#2e81" rel="noopener ugc nofollow">3. Usage Function</a><br/><a class="ae kz" href="#5b5d" rel="noopener ugc nofollow">4. Error Messages</a><br/><a class="ae kz" href="#f159" rel="noopener ugc nofollow">5. Function Comments</a><br/><a class="ae kz" href="#6a6f" rel="noopener ugc nofollow">6. How To Concatenate String Variables</a><br/><a class="ae kz" href="#ed8f" rel="noopener ugc nofollow">7. How To Set a Debug Mode</a><br/>  ∘ <a class="ae kz" href="#6d59" rel="noopener ugc nofollow">Other useful set options</a><br/><a class="ae kz" href="#1adf" rel="noopener ugc nofollow">8. How To Slice Strings</a><br/><a class="ae kz" href="#ce56" rel="noopener ugc nofollow">9. How To Make Sure Users Use a Correct Bash Version</a><br/><a class="ae kz" href="#e5bd" rel="noopener ugc nofollow">10. How To Transform a String Case</a><br/><a class="ae kz" href="#191a" rel="noopener ugc nofollow">11. Ternary Operator-Like Statement</a><br/><a class="ae kz" href="#b44d" rel="noopener ugc nofollow">12. How To Find the Length of a String and an Array</a><br/><a class="ae kz" href="#886b" rel="noopener ugc nofollow">13. How To Unset Variables</a><br/><a class="ae kz" href="#675e" rel="noopener ugc nofollow">14. How To Set a Default Value</a><br/><a class="ae kz" href="#be80" rel="noopener ugc nofollow">15. How To Determine Your Bash Script Name</a><br/><a class="ae kz" href="#b2ef" rel="noopener ugc nofollow">16. How To Make a Variable Constant</a><br/><a class="ae kz" href="#cfb5" rel="noopener ugc nofollow">17. How To Find OSs</a><br/><a class="ae kz" href="#dde7" rel="noopener ugc nofollow">18. How To Determine Which HTTP Get Tool the System Has Installed</a><br/><a class="ae kz" href="#e8e8" rel="noopener ugc nofollow">19. How To Determine Which Python the System Has Installed</a><br/><a class="ae kz" href="#01ab" rel="noopener ugc nofollow">20. Parameter expansion: How to Find the Script Name and Directory</a><br/><a class="ae kz" href="#e3e9" rel="noopener ugc nofollow">21. How To Make Status Messages</a><br/><a class="ae kz" href="#4f97" rel="noopener ugc nofollow">22. How To Set Locale</a><br/><a class="ae kz" href="#2cb0" rel="noopener ugc nofollow">23. Type Hinting in Bash?</a><br/><a class="ae kz" href="#11e9" rel="noopener ugc nofollow">24. Store Exit Status in a Variable</a><br/><a class="ae kz" href="#7715" rel="noopener ugc nofollow">25. Using Trap for Unexpected Termination</a><br/><a class="ae kz" href="#e226" rel="noopener ugc nofollow">26. Don’t Reinvent the Wheel</a><br/><a class="ae kz" href="#ad55" rel="noopener ugc nofollow">27. Subshell and Exit Status</a><br/><a class="ae kz" href="#b647" rel="noopener ugc nofollow">Conclusion</a><br/><a class="ae kz" href="#a86a" rel="noopener ugc nofollow">Newsletter</a><br/><a class="ae kz" href="#8137" rel="noopener ugc nofollow">References</a></span></pre><h1 id="0d60" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">介绍</h1><p id="825d" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">在学习了Bash脚本的<a class="ae kz" href="https://medium.com/better-programming/the-ultimate-programmers-guide-to-bash-scripting-2d11d4e6e978" rel="noopener">基础之后，您可以使用这些实践让您的Bash脚本看起来更专业。这里是Bash脚本初学者的27个技巧。</a></p><h1 id="d44f" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">1.干净的结构</h1><p id="e10f" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">你的剧本必须以一声巨响开始，并描述剧本的目的。一些如何使用你的脚本的例子会对用户有所帮助。如果有必要，解释一下参数。</p><p id="870e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先声明所有的全局变量，然后在全局变量之后声明所有的函数。在函数中使用局部变量，并将主体写在函数之后。在函数、<code class="fe nd ne nf lx b">if</code>语句和脚本末尾使用明确的退出状态代码。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><h1 id="fb47" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">2.在编辑器上安装ShellCheck</h1><p id="83ea" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated"><a class="ae kz" href="https://github.com/koalaman/shellcheck#installing" rel="noopener ugc nofollow" target="_blank"> ShellCheck </a>是一个shell脚本静态分析工具。通过在你的编辑器上安装ShellCheck，你可以避免许多初学者的陷阱。安装后，您可以在您的终端上运行它。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="d53b" class="mb mc iu lx b gz md me l mf mg"><strong class="lx iv">$</strong> shellcheck my_awesome_script</span></pre><p id="f127" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">也可以安装在<a class="ae kz" href="https://marketplace.visualstudio.com/items?itemName=timonwong.shellcheck" rel="noopener ugc nofollow" target="_blank"> VS代码</a>上。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ni"><img src="../Images/3dc7dd9f26ff9420ef9b3811439ee340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*oJsk9bMbDBcv-0mhrtr7YQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">VSCode ShellCheck扩展</p></figure><p id="2335" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您有兴趣查看ShellCheck错误代码列表，请查看此<a class="ae kz" href="https://gist.github.com/shinokada/edbe46d08d688933f3765ec573bf7d74" rel="noopener ugc nofollow" target="_blank">要点</a>。</p><h1 id="2e81" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">3.使用功能</h1><p id="9fa8" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">如果您的脚本使用位置参数，请添加一个函数来解释用户如何以及哪些用户可以使用这些参数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="893e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">$0</code>输出脚本名称。在上述情况下，当用户使用<code class="fe nd ne nf lx b">h</code>或除<code class="fe nd ne nf lx b">f</code>、<code class="fe nd ne nf lx b">d</code>或<code class="fe nd ne nf lx b">t</code>之外的任何字母时，将调用<code class="fe nd ne nf lx b">usage</code>功能。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个</p></figure><p id="54e9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面的脚本检查参数的数量是否是两个。如果不是，则显示<code class="fe nd ne nf lx b">usage</code>。</p><p id="f8f7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用Bash Heredoc:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><h1 id="5b5d" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">4.错误消息</h1><p id="7e17" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">谷歌的<a class="ae kz" href="https://google.github.io/styleguide/shellguide.html" rel="noopener ugc nofollow" target="_blank">外壳风格指南</a>推荐了一个打印消息和其他状态信息的功能。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="9ada" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该指南建议所有错误消息都应该发送到<code class="fe nd ne nf lx b">STDERR</code>，因为这样可以更容易地将正常状态与实际问题区分开来。</p><h1 id="f159" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">5.函数注释</h1><p id="3859" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">所有函数都应该有注释，包括描述、全局变量、参数、输出和返回值(如果适用)。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><h1 id="6a6f" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">6.如何连接字符串变量</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nj"><img src="../Images/9bc2358829942a79cea5bdc79628b11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LxnXvdB914CsGNak"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alina Grubnyak </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ec4f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在Bash脚本中，可以用不同的方式连接字符串。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/UjVPyWi" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><p id="ce07" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，在给变量赋值时，等号前后没有空格。第一个使用<code class="fe nd ne nf lx b">+=</code>符号将第二个值连接到第一个值。第二个使用双引号，变量之间有一个空格。最后一个使用了花括号，因为变量<code class="fe nd ne nf lx b">foo</code>后面紧跟着一个字符。</p><h1 id="ed8f" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">7.如何设置调试模式</h1><p id="7337" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">使用<code class="fe nd ne nf lx b">set -x</code>。正在设置的选项是<code class="fe nd ne nf lx b">-x</code>或<code class="fe nd ne nf lx b">xtrace</code>。这将在代码运行之前显示给定代码行的扩展命令和变量。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/zv4uevy" rel="noopener ugc nofollow" target="_blank">在网上试试这个。</a></p></figure><p id="8801" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出是脚本执行的详细跟踪。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="a6ef" class="mb mc iu lx b gz md me l mf mg">+ foo=Bash<br/>+ '[' Bash == Bash ']'<br/>+ echo Bash<br/>Bash</span></pre><p id="85c7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">很容易看出脚本是如何运行和赋值的。</p><h2 id="6d59" class="mb mc iu bd mi nk nl dn mm nm nn dp mq lj no np ms ln nq nr mu lr ns nt mw nu bi translated">其他有用的set选项</h2><p id="74d4" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated"><code class="fe nd ne nf lx b">set -e</code>如果命令以非零状态退出，则立即退出。</p><p id="343d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">set -u</code>替换时将未设置的变量视为错误。</p><p id="5e03" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">set -C</code>不允许覆盖现有的常规文件。</p><p id="70f9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以你可以在你脚本的开头使用<code class="fe nd ne nf lx b">set -Ceu</code>。</p><p id="e91d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用<code class="fe nd ne nf lx b">help set</code>查找关于<code class="fe nd ne nf lx b">set</code>的更多信息。</p><h1 id="1adf" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">8.如何分割字符串</h1><p id="07dd" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">您可以使用<code class="fe nd ne nf lx b">cut -cstart-end</code>对字符串进行切片。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/NaXkJNN" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><p id="a4c0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一个将字符串从第一个字母分割到第三个字母。第二个从第二个到第四个切片。最后一个切掉了第五个字母。</p><p id="9668" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">参数扩展执行子串提取，<code class="fe nd ne nf lx b">${s:off-set-index:length}</code>:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="9bba" class="mb mc iu lx b gz md me l mf mg">#!/usr/bin/env bash</span><span id="efbd" class="mb mc iu lx b gz nv me l mf mg">s="abcdefg"<br/>echo ${s:0:3}<br/>echo ${s:1:3}<br/>echo ${s:4:1}<br/># output<br/># abc<br/># bcd<br/># e</span></pre><p id="35ec" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">偏移量从零开始。</p><h1 id="ce56" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">9.如何确保用户使用正确的Bash版本</h1><p id="2dca" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">以下脚本确保用户使用Bash或更高版本。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="5acc" class="mb mc iu lx b gz md me l mf mg">if ((BASH_VERSINFO[0] &lt; 4)); then<br/>    printf '%s\n' "Error: This requires Bash v4.0 or higher. You have version $BASH_VERSION." 1&gt;&amp;2<br/>    exit 2<br/>fi</span></pre><h1 id="e5bd" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">10.如何转换字符串大小写</h1><p id="907c" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">当您读取用户输入时，输入可以是小写或大写。对于低于版本4的Bash，可以使用带有<code class="fe nd ne nf lx b">[:lower:]</code>和<code class="fe nd ne nf lx b">[:upper:]</code>的<code class="fe nd ne nf lx b">tr</code>命令将其改为大写。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/0PX7hOQ" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><p id="0c4b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，我们设置了选项<code class="fe nd ne nf lx b">-x</code>用于调试。</p><p id="9e35" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第4行:读取用户输入。</p><p id="e0f6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第5行:Pipes，<code class="fe nd ne nf lx b">|</code>，让您使用一个命令的输出作为另一个命令的输入。我们<code class="fe nd ne nf lx b">cut</code>第一个字母，然后把它从小写转换成大写。您可以互换小写和大写的位置，从大写转换为小写。</p><p id="6189" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在Bash 4+中，可以使用大小写修改操作符。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/XscZ7jN" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><p id="83f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用这些大小写修改运算符，您可以创建函数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/01T1ITM" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><h1 id="191a" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">11.三元类运算符语句</h1><p id="4a09" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">Bash没有三元运算符，但是您可以对简单的变量赋值做类似的事情。</p><p id="f320" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以写一个<code class="fe nd ne nf lx b">if</code>语句:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="fa72" class="mb mc iu lx b gz md me l mf mg">if <strong class="lx iv">[</strong> $foo -ge $bar <strong class="lx iv">]</strong>; then<br/>  baz="Smile!"<br/>else<br/>  baz="Sleep!"<br/>fi</span></pre><p id="9f53" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将<code class="fe nd ne nf lx b">&amp;&amp;</code>和<code class="fe nd ne nf lx b">||</code>一起使用，我们可以创建一个类似于三元语句的语句:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="e2ce" class="mb mc iu lx b gz md me l mf mg">[ $foo -ge $bar ] &amp;&amp; baz="Smile!" || baz="Sleep!"</span></pre><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/XOQEwsp" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><h1 id="b44d" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">12.如何找到字符串和数组的长度</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nw"><img src="../Images/f2b1f593dc225181e875daab73314145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SYq_Je0W-zy47tsA"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">弗勒在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a32f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">${#string}</code>返回字符串长度，同样<code class="fe nd ne nf lx b">${#array[@]}</code>返回数组长度。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://tech.io/snippet/EMgXLsG" rel="noopener ugc nofollow" target="_blank">在线试试这个</a></p></figure><h1 id="886b" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">13.如何取消设置变量</h1><p id="4ceb" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">取消设置变量可以确保您没有使用预定义的变量。</p><p id="87ab" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在脚本的开头:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="198f" class="mb mc iu lx b gz md me l mf mg">#!/usr/bin/env bash</span><span id="9cbc" class="mb mc iu lx b gz nv me l mf mg">unset var1 var2 var3<br/>var1=some_value<br/>...</span></pre><h1 id="675e" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">14.如何设置默认值</h1><p id="5c8d" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">如果未设置<code class="fe nd ne nf lx b">foo</code>，则<code class="fe nd ne nf lx b">${foo-$DEFAULT}</code>和<code class="fe nd ne nf lx b">${foo=$DEFAULT}</code>评估为<code class="fe nd ne nf lx b">$DEFAULT</code>。</p><p id="c2c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果<code class="fe nd ne nf lx b">foo</code>未置位或为空，则<code class="fe nd ne nf lx b">${foo:-$DEFAULT}</code>和<code class="fe nd ne nf lx b">${foo:=$DEFAULT}</code>评估为<code class="fe nd ne nf lx b">$DEFAULT</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="83b5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果<code class="fe nd ne nf lx b">foo</code> <strong class="lc iv">设置为</strong>，则<code class="fe nd ne nf lx b">${foo+$OTHER}</code>和<code class="fe nd ne nf lx b">${foo:+OTHER}</code>计算为<code class="fe nd ne nf lx b">$OTHER</code>，否则为空字符串。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h1 id="be80" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">15.如何确定您的Bash脚本名称</h1><p id="f4d0" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">通过将所有Bash脚本添加到<code class="fe nd ne nf lx b">~/bin</code>目录并将其路径添加到终端配置文件、<code class="fe nd ne nf lx b">~/.bashrc</code>或<code class="fe nd ne nf lx b">~/.zshrc</code>，您可以从任何目录运行它们。但是在设置脚本名之前，最好不要在其他地方使用脚本名。使用<code class="fe nd ne nf lx b">type</code>或<code class="fe nd ne nf lx b">which</code>命令进行检查。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="5cc0" class="mb mc iu lx b gz md me l mf mg"><strong class="lx iv">$</strong> type my_script<br/>my_script not found<br/><strong class="lx iv">$</strong> which which<br/>which: shell built-in command</span></pre><p id="5f19" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">没有带<code class="fe nd ne nf lx b">my_script</code>的脚本名称，但是<code class="fe nd ne nf lx b">which</code>已经被占用。</p><h1 id="b2ef" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">16.如何使变量成为常数</h1><p id="1bd2" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated"><code class="fe nd ne nf lx b">readonly</code>将变量和函数设为只读。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="89a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第3行:设置一个只读变量。<br/>第5行:试图覆盖只读变量。但这会返回一个错误，“第5行:MAX: readonly变量”。</p><p id="277c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="4fde" class="mb mc iu lx b gz md me l mf mg">10<br/>/Users/shinokada/bin/ex6: line 5: MAX: readonly variable<br/>10</span></pre><p id="daee" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以输出<code class="fe nd ne nf lx b">readonly</code>变量:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h1 id="cfb5" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">17.如何找到OSs</h1><p id="fce2" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">不同的操作系统有不同的命令。比如Linux用<code class="fe nd ne nf lx b"><a class="ae kz" href="https://linux.die.net/man/1/readlink" rel="noopener ugc nofollow" target="_blank">readlink</a></code>，macOS用<code class="fe nd ne nf lx b">greadlink</code>。</p><p id="4e6a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面的例子相当简单，但是它找到了用户的操作系统并应用了正确的命令。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="d5e8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="0cce" class="mb mc iu lx b gz md me l mf mg">Your script path is /Users/shinokada/bin<br/>Your OS is mac</span></pre><h1 id="dde7" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">18.如何确定系统安装了哪个HTTP Get工具</h1><p id="f686" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">您的Bash脚本可能会使用HTTP <code class="fe nd ne nf lx b">GET</code>工具。不同的系统使用不同的工具。可以是<code class="fe nd ne nf lx b">curl</code>、<code class="fe nd ne nf lx b">wget</code>、<code class="fe nd ne nf lx b">http</code>、<code class="fe nd ne nf lx b">fetch</code>，也可以是别的。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="aa0b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">&amp;&gt;/dev/null</code>将标准输出流和标准误差流重定向至<code class="fe nd ne nf lx b">/dev/null</code>。和<code class="fe nd ne nf lx b">&gt;/dev/null 2&gt;&amp;1</code>一样。</p><p id="1c30" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">command -v</code>显示特定命令的可执行文件或别名定义的路径。</p><h1 id="e8e8" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">19.如何确定系统安装了哪个Python</h1><p id="33dd" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">同样，如果您的脚本使用Python，您可以找到系统Python:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><h1 id="01ab" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">20.参数扩展:如何找到脚本名和目录</h1><p id="891d" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">使用<code class="fe nd ne nf lx b">${parameter##*/}</code>获取文件名，使用<code class="fe nd ne nf lx b">${parameter%/*}</code>获取目录路径。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="68e8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此<a class="ae kz" href="https://tech.io/snippet/I94IWEk" rel="noopener ugc nofollow" target="_blank"> Tech.io页面</a>解释了如何使用<code class="fe nd ne nf lx b">${parameter%word}</code>、<code class="fe nd ne nf lx b">${parameter%%word}</code>、<code class="fe nd ne nf lx b">${parameter#word}</code>、<code class="fe nd ne nf lx b">${parameter##word}</code>。</p><p id="4581" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您也可以使用<code class="fe nd ne nf lx b">basename "$0"</code>来获取文件名。</p><p id="0930" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以找到Bash脚本目录:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="22e0" class="mb mc iu lx b gz md me l mf mg">#!/usr/bin/env bash</span><span id="5a91" class="mb mc iu lx b gz nv me l mf mg">c=$0<br/>echo "${c%/*}"</span></pre><p id="9675" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">产出:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="2ee9" class="mb mc iu lx b gz md me l mf mg">/Users/shinokada/bin</span></pre><h1 id="e3e9" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">21.如何制作状态消息</h1><p id="84c4" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">你可能想告诉用户你的脚本在做什么。</p><p id="8cce" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你想输出状态信息，你应该从程序名开始。使用<code class="fe nd ne nf lx b">$(basename "$0")</code>获取程序名称。应使用<code class="fe nd ne nf lx b">echo ... 1&gt;&amp;2</code>将消息写在标准错误上。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="1233" class="mb mc iu lx b gz md me l mf mg">#!/usr/bin/env bash</span><span id="45b8" class="mb mc iu lx b gz nv me l mf mg">progname=$(basename "$0")<br/>...<br/>echo "$progname: Running this and that" 1&gt;&amp;2</span></pre><h1 id="4f97" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">22.如何设置区域设置</h1><p id="9ce9" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">您可以找到您的语言环境:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="6c7f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">并非所有的程序员都使用相同的语言环境。来自法国的程序员可能会使用<code class="fe nd ne nf lx b">fr_CH.UTF-8</code>；来自英国的极客可能在用<code class="fe nd ne nf lx b">en_GB.UTF-8</code>。为了确保用户使用正确的语言环境，您可以使用<code class="fe nd ne nf lx b">LC_ALL</code>来设置语言环境:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="0926" class="mb mc iu lx b gz md me l mf mg">LC_ALL="en_US.UTF-8"</span></pre><h1 id="2cb0" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">23.Bash中的类型提示？</h1><p id="671f" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">Bash脚本没有类型提示，但是您可以使用<code class="fe nd ne nf lx b">declare</code>来创建变量索引数组、关联数组或整数。使用<code class="fe nd ne nf lx b">help declare</code>可以找到<code class="fe nd ne nf lx b">declare</code>选项。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="9251" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">可以用<code class="fe nd ne nf lx b">+</code>代替<code class="fe nd ne nf lx b">—</code>关闭属性。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="91fe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们在第3行将<code class="fe nd ne nf lx b">var1</code>声明为一个整数。如果您试图将其更改为字符串，就会得到一个错误(第5行)。但是您可以将其更改为另一个整数(第7行)。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="1528" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，当您在函数中使用<code class="fe nd ne nf lx b">declare</code>时，变量变成了一个局部变量，您不能在函数外部访问它。</p><h1 id="11e9" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">24.将退出状态存储在变量中</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/069b9bf91d19726c5a8e502a022aced2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x0uU2y1ZqzKEESiB"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@belart84?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Artem Beliaikin </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="52e1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">不要在<code class="fe nd ne nf lx b">if</code>语句中使用<code class="fe nd ne nf lx b">$?</code>:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="48d1" class="mb mc iu lx b gz md me l mf mg">mkdir /tmp/tmp_dir<br/>if [ $? = 0 ]; then<br/>  # do something<br/>fi</span></pre><p id="dca1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将退出状态存储在变量中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="37b7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面存储了检查文件是否存在以及是否为目录的退出状态。</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="641b" class="mb mc iu lx b gz md me l mf mg">test -d /tmp/tmp_dir<br/>test_es=$?<br/>if [[ ${test_es} -ne 0 ]]; then  <br/>    echo "No dir found. Exiting script!" &gt;&amp;2<br/>    exit 1<br/>fi</span></pre><h1 id="7715" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">25.使用陷阱进行意外终止</h1><p id="d67e" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">用户可以在脚本运行时使用<code class="fe nd ne nf lx b">Ctrl-c</code>终止它。如果您的脚本正在修改一个目录或文件，您需要将它恢复到原始状态。命令<code class="fe nd ne nf lx b">trap</code>就是针对这种情况的。</p><p id="e0cf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当用户使用<code class="fe nd ne nf lx b">Ctrl-c</code>时，会产生一个信号<code class="fe nd ne nf lx b">SIGINT</code>。当用户终止一个进程时，它产生一个信号<code class="fe nd ne nf lx b">SIGTERM</code>。您可以使用以下命令列出所有信号:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="35ea" class="mb mc iu lx b gz md me l mf mg"># Linux, from terminal<br/><strong class="lx iv">$</strong> trap --list<br/># macOS, from a script<br/>trap --list</span></pre><p id="93a3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以在man7.org上找到标准信号。</p><p id="aec8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nd ne nf lx b">trap</code>命令具有<code class="fe nd ne nf lx b">trap "do something" signal_to_trap</code>的形式。如果你的清理代码很长，你可以创建一个函数。</p><p id="2460" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们捕获<code class="fe nd ne nf lx b">Ctrl-c</code>信号:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="d71d" class="mb mc iu lx b gz md me l mf mg">tempfile=/tmp/myfile<br/>cleanup(){<br/>    rm -f $tempfile<br/>}<br/>trap cleanup SIGINT</span></pre><p id="5996" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">阅读更多关于<a class="ae kz" href="https://www.linuxjournal.com/content/bash-trap-command" rel="noopener ugc nofollow" target="_blank">陷阱命令</a>的信息。</p><h1 id="e226" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">26.不要多此一举</h1><p id="a546" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">如果你的目标是学习，那么你可以重新发明轮子，但是如果不是，使用来自<a class="ae kz" href="https://github.com/dylanaraps/pure-bash-bible" rel="noopener ugc nofollow" target="_blank"> pure-bash-bible </a>的片段。pure-bash-bible也是一个很好的学习场所。您可以在脚本中使用许多函数。这些脚本包括字符串、数组、循环、文件处理、文件路径等等。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/30da10c07f5705c4967f182d40a38563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*DaB8PsOPhM6Wz1xQF9hhsw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://github.com/dylanaraps/pure-bash-bible#change-a-string-to-lowercase" rel="noopener ugc nofollow" target="_blank">纯巴什圣经</a></p></figure><h1 id="ad55" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">27.子外壳和退出状态</h1><p id="95e1" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">你能找出下列代码的区别吗？</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ng nh l"/></div></figure><p id="7349" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一个返回:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="9f1d" class="mb mc iu lx b gz md me l mf mg">/Users/myname/bin/ex5: line 34: no_func1: command not found<br/>there is nothing<br/>1</span></pre><p id="ebd4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第二个返回:</p><pre class="kk kl km kn gu lw lx ly lz aw ma bi"><span id="4173" class="mb mc iu lx b gz md me l mf mg">/Users/myname/bin/ex5: line 34: no_func2: command not found<br/>there is nothing</span></pre><p id="ce45" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">区别在于括号和大括号。括号使命令在子shell中运行，大括号使命令组合在一起，但不在子shell中。</p><p id="9863" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为大括号不创建子shell，<code class="fe nd ne nf lx b">exit</code>退出主shell进程，所以它永远不会到达运行<code class="fe nd ne nf lx b">echo $?</code>的地方。</p><h1 id="b647" class="mh mc iu bd mi mj mk ml mm mn mo mp mq ka mr kb ms kd mt ke mu kg mv kh mw mx bi translated">结论</h1><p id="989a" class="pw-post-body-paragraph la lb iu lc b ld my jv lf lg mz jy li lj na ll lm ln nb lp lq lr nc lt lu lv in bi translated">这是您可以在下一个Bash脚本项目中使用的27个Bash脚本技巧。它们中的许多都很容易采用，并且使您的Bash脚本看起来更专业。</p><p id="f994" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">编码快乐！</p></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><p id="0971" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">通过</strong> <a class="ae kz" href="https://blog.codewithshin.com/membership" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">成为</strong> </a> <strong class="lc iv">会员，可以完全访问媒体上的每一个故事。</strong></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj og"><img src="../Images/0be3ee559fee844cb75615290e4a8b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*DjTM9iFtVc2wlcWcOms7VQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://blog.codewithshin.com/subscribe" rel="noopener ugc nofollow" target="_blank">https://blog.codewithshin.com/subscribe</a></p></figure></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><h1 id="8137" class="mh mc iu bd mi mj oh ml mm mn oi mp mq ka oj kb ms kd ok ke mu kg ol kh mw mx bi translated">参考</h1><ul class=""><li id="0449" class="om on iu lc b ld my lg mz lj oo ln op lr oq lv or os ot ou bi translated"><a class="ae kz" href="https://tldp.org/LDP/abs/html/special-chars.html" rel="noopener ugc nofollow" target="_blank">https://tldp.org/LDP/abs/html/special-chars.html</a></li><li id="032e" class="om on iu lc b ld ov lg ow lj ox ln oy lr oz lv or os ot ou bi translated"><a class="ae kz" href="https://tldp.org/LDP/abs/html/parameter-substitution.html#PARAMSUBREF" rel="noopener ugc nofollow" target="_blank">https://tldp . org/LDP/ABS/html/parameter-substitution . html # PARAMSUBREF</a></li></ul></div><div class="ab cl nz oa hy ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu pa"><a href="https://medium.com/better-programming/the-ultimate-programmers-guide-to-bash-scripting-2d11d4e6e978" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd iv gz z fq pf fs ft pg fv fx it bi translated">Bash脚本编程的终极程序员指南</h2><div class="ph l"><h3 class="bd b gz z fq pf fs ft pg fv fx dk translated">深入探究Bash脚本，帮助您自动化任务</h3></div><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">medium.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po kt pa"/></div></div></a></div><div class="pp pq gq gs pr pa"><a href="https://medium.com/better-programming/13-fantastic-learning-tools-and-resources-for-bash-scripting-51a6de98015c" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd iv gz z fq pf fs ft pg fv fx it bi translated">13个精彩的Bash脚本学习工具和资源</h2><div class="ph l"><h3 class="bd b gz z fq pf fs ft pg fv fx dk translated">您将每天使用的替代Bash脚本工具</h3></div><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">medium.com</p></div></div><div class="pj l"><div class="ps l pl pm pn pj po kt pa"/></div></div></a></div><div class="pp pq gq gs pr pa"><a href="https://towardsdatascience.com/comparing-sh-bash-ksh-and-zsh-speed-82a72bbc20ed" rel="noopener follow" target="_blank"><div class="pb ab fp"><div class="pc ab pd cl cj pe"><h2 class="bd iv gz z fq pf fs ft pg fv fx it bi translated">比较上海、巴什、KSH和ZSH的速度</h2><div class="ph l"><h3 class="bd b gz z fq pf fs ft pg fv fx dk translated">获胜者去…击鼓</h3></div><div class="pi l"><p class="bd b dl z fq pf fs ft pg fv fx dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pt l pl pm pn pj po kt pa"/></div></div></a></div></div></div>    
</body>
</html>