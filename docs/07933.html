<html>
<head>
<title>Vue + Django: Using .vue Files and the Vue CLI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue + Django:使用中。vue文件和Vue CLI</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/vue-django-using-vue-files-and-the-vue-cli-d6dd8c9145eb?source=collection_archive---------2-----------------------#2021-03-08">https://betterprogramming.pub/vue-django-using-vue-files-and-the-vue-cli-d6dd8c9145eb?source=collection_archive---------2-----------------------#2021-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bad8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建一个运行在Django上的全栈网站</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ed9b2e0370f8a24b402de94cd7de6430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3x4gHfpDbWrI_aI-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@imandrewpons?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安德鲁·庞斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="385b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Django项目中开始使用Vue.js非常简单。</p><p id="abf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你只想构建几个简单的Vue组件，并把它们放到你的Django应用程序中，你可以用简单的方法——内联。我写了一整篇Vue + Django教程来演示这种方法:</p><div class="lv lw gp gr lx ly"><a href="https://levelup.gitconnected.com/vue-django-getting-started-88d3f4c2ba62" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Vue + Django:入门</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">将Vue添加到Django应用程序非常简单！</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="a62d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是内联JavaScript/CSS是有限的，这种方法只能让你到此为止。我通过用Vue和Django开发应用程序亲身体会到了这一点。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3460" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">Django可以很好地使用Vue CLI和Webpack</h1><p id="6d18" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">为了充分利用Vue，你可能需要使用Vue命令行界面和<code class="fe nr ns nt nu b">.vue</code>文件。这些工具使您能够创建易于重用的组件，并使用webpack将JavaScript依赖项构建到您的项目中。但是它们也要求您编译和提供动态JavaScript资产，使部署变得复杂。</p><p id="0e33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，Django有很好的工具来使用和部署静态文件，我们可以将它们与Vue CLI配对来非常容易地部署全功能的Vue应用程序。这需要一点点的配置，但下面是我如何让我的应用程序工作。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="b3c0" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">有经验的开发者:想跳过阅读看代码？</h1><p id="5b18" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">乐意帮忙:</p><div class="lv lw gp gr lx ly"><a href="https://github.com/bennett39/vue-cli-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Bennett 39/vue-CLI-教程</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">在GitHub上创建一个帐户，为bennett39/vue-cli教程开发做出贡献。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="nv l mj mk ml mh mm ks ly"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="cdf6" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">您需要知道的:Vue CLI如何工作</h1><p id="3dc3" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated"><a class="ae ky" href="https://cli.vuejs.org" rel="noopener ugc nofollow" target="_blank"> Vue CLI </a>是启动全功能Vue项目的绝佳工具。它帮助您引导复杂Vue应用程序所需的所有配置。</p><p id="77f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CLI在幕后使用<a class="ae ky" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> webpack </a>将JavaScript资产编译成一个完整构建的应用程序，其中包含所有可用的依赖项。</p><ul class=""><li id="7360" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated">当您使用yarn(或npm)运行<code class="fe nr ns nt nu b">yarn serve</code>时，您是在告诉webpack编译必要的资产，然后启动一个web服务器来监听这些文件中的更改并重新编译结果。</li><li id="5e2f" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">当你使用yarn(或npm)运行<code class="fe nr ns nt nu b">yarn build</code>时，webpack会编译所有资产的优化版本，并将生产代码写入一个输出目录(通常是类似<code class="fe nr ns nt nu b">dist/</code>的东西)。</li></ul><p id="1e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Webpack编译您的依赖项并为您构建它们，这样您就可以拥有多文件、复杂的JavaScript应用程序。这里要意识到的关键事情是，webpack实际上可以在我们告诉它的任何地方编写应用程序的编译版本。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3bf9" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">喜欢你在这里读到的吗？</h1><p id="e650" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我免费与我的电子邮件列表分享我最好的内容。</p><p id="0834" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加入我的电子邮件系列中的500名其他开发人员。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="95b1" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">让Vue CLI与Django一起工作</h1><p id="26be" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">为了让Vue CLI(和<code class="fe nr ns nt nu b">.vue</code>文件)在Django内部工作，我们只需要告诉webpack把它的输出写到Django知道的某个地方。</p><p id="94ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将JavaScript资产写入Django可以通过其<code class="fe nr ns nt nu b"><a class="ae ky" href="https://docs.djangoproject.com/en/3.1/ref/settings/#staticfiles-dirs" rel="noopener ugc nofollow" target="_blank">STATICFILES_DIRS</a></code> <a class="ae ky" href="https://docs.djangoproject.com/en/3.1/ref/settings/#staticfiles-dirs" rel="noopener ugc nofollow" target="_blank">设置</a>检测到的目录，那么Django将像其他文件一样提供这些文件。</p><p id="1072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于Django本身可以检测静态文件中的变化，我们可以在使用<code class="fe nr ns nt nu b">yarn serve</code>的同时使用<code class="fe nr ns nt nu b">python manage.py runserver</code>来动态获取开发过程中web应用程序中的任何变化。</p><p id="901c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到了部署的时候，我们只需要<code class="fe nr ns nt nu b">yarn build</code>Vue应用程序，然后运行<code class="fe nr ns nt nu b">python manage.py collectstatic</code>来确保所有的生产文件对Django都可用。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3805" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">装上电线</h1><p id="9eab" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果它看起来太容易是真的，那是因为它实际上相对简单。通过Django使用Vue CLI有六个步骤:</p><ol class=""><li id="b2af" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ok oc od oe bi translated">在Django内部启动一个Vue CLI项目。</li><li id="b007" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">在Django模板中使用Vue应用程序/组件。</li><li id="41b3" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">设置Django静态文件。</li><li id="48c6" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">配置Vue来构建Django静态文件的资产。</li><li id="e351" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">在开发中，用<code class="fe nr ns nt nu b">manage.py</code>运行Django，用<code class="fe nr ns nt nu b">yarn serve</code>运行Vue。</li><li id="034a" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">对于部署，构建Vue，然后使用Django的<code class="fe nr ns nt nu b">collectstatic</code>。</li></ol><p id="aace" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">听起来够简单吗？让我们开始吧。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7d31" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">1.在Django项目中启动一个Vue CLI项目</h1><p id="5001" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我假设您已经有了一个Django项目，它看起来像这样:</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="9e06" class="op mv it nu b gy oq or l os ot">.<br/>|-myproject<br/>| |-asgi.py<br/>| |-__init__.py<br/>| |-settings.py<br/>| |-urls.py<br/>| |-wsgi.py<br/>|-myapp<br/>| |-migrations<br/>| | |-__init__.py<br/>| |-models.py<br/>| |-__init__.py<br/>| |-apps.py<br/>| |-admin.py<br/>| |-tests.py<br/>| |-views.py<br/>|-manage.py</span></pre><p id="30c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还没有Django项目，这里有一个我制作的关于如何开始一个项目的视频(只是用了不同的项目名称):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何开始使用Django</p></figure><p id="fc02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要添加Vue，您需要<a class="ae ky" href="https://cli.vuejs.org/guide/installation.html" rel="noopener ugc nofollow" target="_blank">安装Vue CLI </a>并<a class="ae ky" href="https://cli.vuejs.org/guide/creating-a-project.html#vue-create" rel="noopener ugc nofollow" target="_blank">在您的项目的基本目录中创建一个新的Vue项目</a>(其中<code class="fe nr ns nt nu b">manage.py</code>是):</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="f52c" class="op mv it nu b gy oq or l os ot">vue create vueapp</span></pre><p id="9132" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后选择您的配置设置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/0d12999be781af5e5139da31937999e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7iygi7jdiC8ijaAs"/></div></div></figure><p id="be25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将使用Vue 2，因为Vue 3还没有完全发布和支持。</p><p id="f38e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来:</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="37c9" class="op mv it nu b gy oq or l os ot">cd vueapp/<br/>yarn serve</span></pre><p id="124d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查您的安装，请转到<a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080/ </a>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/241af35d4aef1e61c04100e35e9bfda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8t-AD57oivMvGSxc"/></div></div></figure><h2 id="c772" class="op mv it bd mw oy oz dn na pa pb dp ne li pc pd ng lm pe pf ni lq pg ph nk pi bi translated">它是如何工作的？</h2><p id="d8bb" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">好吧，让我们弄清楚它是如何工作的。看一看<code class="fe nr ns nt nu b">vueapp/src/main.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><p id="8739" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，Vue在任何找到ID为<code class="fe nr ns nt nu b">#app</code>的元素的地方创建/挂载一个Vue实例。这意味着如果我们可以让Vue加载Django模板，我们应该只需要<code class="fe nr ns nt nu b">&lt;div id=”app”&gt;</code>就可以让Vue在页面上初始化。</p><p id="0017" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以在Django模板中使用Vue组件！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="f792" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">2.创建一个测试Django模板</h1><p id="496a" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">您可能已经有了一个Django模板，希望Vue加载到这个模板中。如果是这样，那太好了。你可以用这个。</p><p id="dfad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单明了，我将在一开始创建的Django应用程序<code class="fe nr ns nt nu b">myapp/</code>中创建一个新模板(和视图/URL)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><p id="c96e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是模板。现在让我们再做一些更新，这样它就有了一个URL和视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><p id="b380" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应该可以了。现在导航到<a class="ae ky" href="http://127.0.0.1:8000/vue-test" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/vue-test</a>，您将看到我们的测试模板正在加载，但还没有加载Vue部分！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/a3bcc8d5dc5888cb729fe5955b088053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/0*EXTOBP_MOpQ5Abu5"/></div></figure><p id="e46c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将Vue安装到页面上的<code class="fe nr ns nt nu b">#app</code>元素上！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="6a0f" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">3.建立姜戈的静态文件</h1><p id="2f1c" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我们需要的第一件事是Vue文件在构建后有一个存放的地方。我们需要姜戈知道那个地方。</p><p id="dc27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的应用程序中根本没有设置静态文件，你可以<a class="ae ky" href="https://docs.djangoproject.com/en/3.1/howto/static-files/" rel="noopener ugc nofollow" target="_blank">遵循Django文档</a>来确保你的设置是正确的。如果你是从零开始学习本教程，它们应该是正确的。</p><p id="665d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，Vue文件不一定绑定到特定的Django应用程序，所以我们希望在项目根目录下为静态文件创建一个通用位置。</p><ol class=""><li id="762f" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ok oc od oe bi translated">在项目根目录(<code class="fe nr ns nt nu b">manage.py</code>所在的位置)，创建一个名为<code class="fe nr ns nt nu b">static/</code>的新文件夹，它将保存我们从Vue构建的所有文件。</li><li id="2652" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">在<code class="fe nr ns nt nu b">myproject/settings.py</code>中，我们需要更新<code class="fe nr ns nt nu b">staticfiles</code>设置，以便Django知道这个新目录。这些设置通常在文件的最底部。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><p id="d35e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们让<code class="fe nr ns nt nu b">STATIC_ROOT</code>指向我们项目中一个新的不存在的文件夹:<code class="fe nr ns nt nu b">var/static_root/</code>。Django会为我们创建并管理这个文件夹。到了部署的时候，这个文件夹会很重要。</p><p id="15db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您完成更改后，请进行测试！</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="fda0" class="op mv it nu b gy oq or l os ot">$ python manage.py collectstatic</span><span id="8c6f" class="op mv it nu b gy pl or l os ot">131 static files copied to ‘/Users/bennettgarner/Repos/vue-cli-tutorial/myproject/var/static_root’.</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c91d" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">4.在配置中指向Vue项目的构建目录</h1><p id="fbd5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">好了，Django现在正在收集和服务我们的静态文件，一旦Vue文件被编译好，我们就有地方放它们了。我们只需要告诉Vue把它们放在哪里。</p><p id="7c3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过创建一个文件来覆盖Vue的默认配置:<code class="fe nr ns nt nu b">vueapp/vue.config.js</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="5eb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pm">注意(2022–04–20):如果您使用的是较新版本的Vue/webpack，上述配置可能无法按预期工作！我收到读者反馈，上面的</em> <code class="fe nr ns nt nu b"><em class="pm">devServer</em></code> <em class="pm">部分需要更改… </em></p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="0e22" class="op mv it nu b gy oq or l os ot">devServer: {<br/>  devMiddleware: {<br/>    // see <a class="ae ky" href="https://github.com/webpack/webpack-dev-server/issues/2958" rel="noopener ugc nofollow" target="_blank">https://github.com/webpack/webpack-dev-server/issues/2958</a><br/>    writeToDisk: true, <br/>  }<br/>},</span></pre><p id="4542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我没有测试过这种变化，但听起来很合理，似乎应该行得通！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="3047" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是怎么回事？</p><ul class=""><li id="ef0b" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated">告诉Vue一旦它在互联网上，在哪里寻找它的其他文件。基本上，我的其他文件将生活在什么网址。Django把它们都放在<code class="fe nr ns nt nu b">STATIC_URL</code>和输出目录的路径后面。</li><li id="7f95" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><code class="fe nr ns nt nu b">outputDir</code>告诉Vue在文件系统中的什么地方写它的文件。这是一个大文件，在这里我将它指向<code class="fe nr ns nt nu b">static/</code>(我们刚刚添加到<code class="fe nr ns nt nu b">STATICFILES_DIRS</code>)加上一个命名空间路径，以确保Vue文件不会与其他文件混淆。</li><li id="7861" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">默认情况下，Vue会对文件名进行哈希处理，这样我们就可以确保拥有最新的版本(而不是文件的缓存旧版本)。然而，这破坏了Django预测和跟踪文件名变化的能力。相反，我们可以在Django中使用<code class="fe nr ns nt nu b"><a class="ae ky" href="https://docs.djangoproject.com/en/3.1/ref/contrib/staticfiles/#django.contrib.staticfiles.storage.ManifestStaticFilesStorage" rel="noopener ugc nofollow" target="_blank">ManifestStaticfilesStorage</a></code>来完成同样的任务。</li><li id="4fda" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">运行时编译器是打开的，因为我们正在用webpack做棘手的事情，我想要完整的构建。如果您的项目不需要此设置也可以删除它。它将使您的部署重量减轻30%。<a class="ae ky" href="https://vuejs.org/v2/guide/installation.html#Runtime-Compiler-vs-Runtime-only" rel="noopener ugc nofollow" target="_blank">阅读Vue文档中的运行时编译器</a>。</li><li id="7dea" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">我们在开发模式下写入磁盘，这样Django就可以获取这些文件，而不是在Vue中动态编译。</li></ul><p id="f697" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">试试吧！</p><ol class=""><li id="4b31" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ok oc od oe bi translated"><code class="fe nr ns nt nu b">cd vueapp/</code></li><li id="ecf2" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated"><code class="fe nr ns nt nu b">yarn serve</code></li><li id="c0ae" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">用<code class="fe nr ns nt nu b">ctl+c</code>取消服务器。</li><li id="9d8c" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated"><code class="fe nr ns nt nu b">ls ../static/src/vue/dist/</code></li></ol><p id="a4eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到我们所有的Vue文件都构建到了Django应用程序的静态目录中！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="ce92" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">5.用manage.py在开发中运行Django</h1><p id="3e98" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">现在我们只需要将静态Vue文件添加到我们之前制作的模板中。编辑<code class="fe nr ns nt nu b">myapp/templates/myapp/vue-test.html</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj ov l"/></div></figure><p id="542e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望Vue文件在页面的其余部分已经加载之后再加载，所以它们在底部。</p><p id="cf61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试一下！</p><ol class=""><li id="a312" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ok oc od oe bi translated">在项目根:<code class="fe nr ns nt nu b">python manage.py runserver</code></li><li id="a095" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">打开一个新的终端选项卡，并转到<code class="fe nr ns nt nu b">vueapp/</code>运行<code class="fe nr ns nt nu b">yarn serve</code>。</li><li id="f32c" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">转到<a class="ae ky" href="http://127.0.0.1:8000/vue-test" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/vue-test</a>。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/177766b4701f3984ddabe8dcac04cb99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VEXZhYgEN7Wqexpj"/></div></div></figure><p id="971d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们做到了！这就是Django模板中正确呈现的<code class="fe nr ns nt nu b">.vue</code>文件组件！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="e321" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">6.为部署构建Vue + collectstatic</h1><p id="4b3f" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">部署时，您会希望:</p><ol class=""><li id="3a8c" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ok oc od oe bi translated">启用<code class="fe nr ns nt nu b"><a class="ae ky" href="https://docs.djangoproject.com/en/3.1/ref/contrib/staticfiles/#django.contrib.staticfiles.storage.ManifestStaticFilesStorage" rel="noopener ugc nofollow" target="_blank">ManifestStaticfilesStorage</a></code>来帮助版本控制和缓存破坏。</li><li id="b462" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">把你的代码按原样推上GitHub/GitLab或者你用的任何东西。</li><li id="29ba" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ok oc od oe bi translated">作为部署命令的一部分，<code class="fe nr ns nt nu b">yarn build</code>和<code class="fe nr ns nt nu b">python manage.py collectstatic</code>。</li></ol></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c6d0" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">Vue CLI和。Django的vue文件</h1><p id="af8e" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">稍微配置一下，Vue和Django就能很好的配合了！</p><p id="c978" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以使用示例应用程序并对组件进行编辑，就像对任何其他Vue项目一样。Django会注意Vue正在写的文件，然后将它们作为静态资产。</p><h2 id="c33d" class="op mv it bd mw oy oz dn na pa pb dp ne li pc pd ng lm pe pf ni lq pg ph nk pi bi translated">最后提醒</h2><p id="2098" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">不要忘记:Vue在页面上寻找一个<code class="fe nr ns nt nu b">#app</code>元素，所以你在任何想要使用Vue的地方都需要它。</p><p id="0bc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，在任何想要使用Vue的页面上，您都需要脚本标签。这里的最佳实践是用所有这些信息在Django 中创建一个部分<a class="ae ky" href="https://docs.djangoproject.com/en/3.1/ref/templates/language/#template-inheritance" rel="noopener ugc nofollow" target="_blank">基础模板，然后您可以为自己的页面扩展这些信息。</a></p><p id="15f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！恭喜你，你在Django上运行了一个全栈网站！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="cffe" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">关于班尼特</h1><p id="a3f1" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我是一名用Python和JavaScript构建东西的web开发人员。</p><p id="fedb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想要我关于web开发和成为更好的程序员的最佳内容吗？</p><p id="3835" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在邮件列表中分享我最喜欢的建议——没有垃圾邮件，没有推销内容，只有有用的内容。</p><p id="1338" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://sunny-architect-5371.ck.page/0a60026a5d" rel="noopener ugc nofollow" target="_blank">加入我的电子邮件系列中的其他500名开发人员。</a></p></div></div>    
</body>
</html>