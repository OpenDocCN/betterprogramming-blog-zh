<html>
<head>
<title>A Look at Remix React Framework: The Full Stack Developer’s Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Remix React框架一览:全栈开发者指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/end-to-end-guide-to-remix-a-full-stack-web-framework-8dc56eb6a9c7?source=collection_archive---------0-----------------------#2022-03-16">https://betterprogramming.pub/end-to-end-guide-to-remix-a-full-stack-web-framework-8dc56eb6a9c7?source=collection_archive---------0-----------------------#2022-03-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="281f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">介绍新的web框架，帮助您更快、更干净地构建</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c6248bc6a0e6cb115637fcc5198fa579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*20Bl_e49VN2ZFTzo"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@krysamon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Krys Amon </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7d65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Remix 是一个全栈式的web框架，它专注于用户界面，并通过web基础来提供快速、灵活、有弹性的用户体验。它包括esbuild、React路由器、服务器端渲染、生产服务器和后端优化。</p><p id="75ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自从2021年10月正式发布以来，Remix已经成为一个被广泛采用的React框架。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/a385d4afc12fbaf9f09b7616c013a8a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wKz-scrqflTGEPrB2LBbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b938" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混音有很多优点:</p><ul class=""><li id="8e28" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">它使用速度极快的JavaScript/CSS捆绑器和迷你器<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/bundle-up-a-javascript-project-using-esbuild-b2c824ba0d39"> esbuild </a>编译。</li><li id="efba" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">它在服务器端使用渐进式增强。只有必要的JavaScript、JSON和CSS内容被发送到浏览器。</li><li id="8b36" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">它执行动态服务器端渲染。</li><li id="3f41" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">它知道何时重新提取变异的数据，因为Remix监督整个工作流程。</li><li id="bad9" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">它包括带有React路由器、服务器端渲染、生产服务器和后端优化的端到端解决方案。</li></ul><h1 id="99fc" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">设置混音</h1><p id="b62a" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">运行以下命令来安装Remix:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0905" class="nm ml it ni b gy nn no l np nq">% npx create-remix<br/>? Where would you like to create your app? remix-app<br/>? What type of app do you want to create? Just the basics<br/>? Where do you want to deploy? Choose Remix if you're unsure; it's easy to change deployment targets. Remix App Server<br/>? TypeScript or JavaScript? JavaScript<br/>? Do you want me to run `npm install`? Yes</span></pre><p id="f024" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在安装过程中有几个选择。</p><ul class=""><li id="3922" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">Remix框架安装在文件夹<code class="fe nr ns nt ni b">remix-app</code>中。</li><li id="f5ad" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">app的类型是<code class="fe nr ns nt ni b">Just the basics</code>。</li><li id="eed6" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">有许多服务器可供选择。选项有<code class="fe nr ns nt ni b">Remix App Server</code>、<code class="fe nr ns nt ni b">Express Server</code>、<code class="fe nr ns nt ni b">Architect (AWS Lambda)</code>、<code class="fe nr ns nt ni b">Fly.io</code>、<code class="fe nr ns nt ni b">Netlify</code>、<code class="fe nr ns nt ni b">Vercel</code>和<code class="fe nr ns nt ni b">Cloudflare Pages</code>。我们使用默认的<code class="fe nr ns nt ni b">Remix App Server</code>，这是一个基于Express的全功能Node.js服务器。</li><li id="a140" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">在TypeScript和JavaScript之间也有一个选择。在本文中，选择JavaScript。</li></ul><p id="550d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装完成后，文件夹<code class="fe nr ns nt ni b">remix-app</code>如下所示:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="523d" class="nm ml it ni b gy nn no l np nq">remix-app<br/>├── README.md<br/>├── app<br/>│   ├── entry.client.jsx<br/>│   ├── entry.server.jsx<br/>│   ├── root.jsx<br/>│   └── routes<br/>│       └── index.jsx<br/>├── node_modules<br/>├── package.json<br/>├── package-lock.json<br/>├── public<br/>│   └── favicon.ico<br/>├── .eslintrc.js<br/>├── .gitignore<br/>├── remix.config.js<br/>└── jsconfig.json</span></pre><ul class=""><li id="a0cd" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app</code>:是包含Remix app代码的目录。</li><li id="fba8" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app/entry.client.jsx</code>:浏览器要加载的进入码。相当于<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-in-depth-guide-for-create-react-app-5-cra-5-b94b03c233f2">创建React App </a>的<code class="fe nr ns nt ni b">index.js</code>。此外，它融合了React代码(第4行)，完成了我们在文章<a class="ae ky" href="https://javascript.plainenglish.io/a-hands-on-guide-for-a-server-side-rendering-react-18-app-4e630aae274c" rel="noopener ugc nofollow" target="_blank">中描述的<a class="ae ky" href="https://gist.github.com/JenniferFuBook/e3ac4022445bd9fdfeb4d03c5e92d058#file-indexhydrate-js" rel="noopener ugc nofollow" target="_blank"> index.js </a>服务器端渲染React应用的实践指南</a>中所做的工作。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="d772" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app/entry.server.jsx</code>:当请求到达服务器时，它是JavaScript的第一部分。Remix只加载必要的数据，但是开发人员需要处理响应。该文件用于将React应用程序呈现为字符串/流，该字符串/流作为响应发送给客户端。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="c339" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app/root.jsx</code>:它是应用程序的根组件。这相当于创建了React App的<code class="fe nr ns nt ni b">App.js</code>。<code class="fe nr ns nt ni b">&lt;LiveReload /&gt;</code>(第27行)显式编码，推荐开发。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="c11f" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app/routes</code>:它是托管所有路由的目录。</li><li id="6291" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt ni b">app/routes/index.jsx</code>:默认调用的是索引路由。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><ul class=""><li id="6774" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt ni b">public</code>:这是存放静态资产和产品构建的目录。</li><li id="37e9" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt ni b">public/favicon.ico</code>:浏览器标签和书签显示的混音图标。</li><li id="af36" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt ni b">remix.config.js</code>:是Remix配置文件。</li><li id="a3da" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt ni b">jsconfig.js</code>:JavaScript配置文件。</li></ul><p id="63f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用程序可以在开发模式下执行:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="fd57" class="nm ml it ni b gy nn no l np nq">npm run dev</span></pre><p id="c227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它也可以在生产模式下执行:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="6a72" class="nm ml it ni b gy nn no l np nq">npm run build<br/>npm start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/7fcb7aeb6dc81aa5faf01a5b15073a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*WM5HO28jbUDHHejhzXSg8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fe08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开箱即用，我们有React路由器、服务器端渲染和生产服务器。</p><h1 id="b1f3" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">混合路线</h1><p id="aa2d" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">上面的官方例子有外部网站的静态链接。重写<code class="fe nr ns nt ni b">app/routes/index.jsx</code>以链接到内部页面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第9行是到路线的链接，<code class="fe nr ns nt ni b">"/one"</code>。</p><p id="268b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第12行是到路线的链接，<code class="fe nr ns nt ni b">"/two"</code>。</p><p id="9d67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页面看起来很好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/0ebd174a0129461993f817d9f026968a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*zK2epTI_wIgj2Q_6JgYDMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，单击任何一个链接都会显示404错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/f3cf815b3df2d600fd43d63717e4b1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*8xEq4DL5cYTcAaLhtjuB0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="30bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Remix路由器使用文件系统来定义页面路由。有两种方法可以解决这个问题。推荐的方法是将路由目录中的缺失页实现为索引文件，即<code class="fe nr ns nt ni b">app/routes/one/index.jsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="40ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在页面工作了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/ddefb6e2f1384831de3ec6990a8202de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*NwKb2jcn4y9nEkRyfX7Exw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9e04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二种方法是将文件命名为路径，即<code class="fe nr ns nt ni b">app/routes/two.jsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="419f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是页面:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/3ff29e34c6f9dd6f9bf07497cfd3e819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*zCUZD2nrSNDOODPOQbprzQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c93f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Remix路由器支持<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/a-step-by-step-guide-on-react-router-6-8964c10af364#71a9-41181d1f934"> React路由器</a>，包括嵌套路由和动态参数。</p><h1 id="87c4" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">再混合装载机</h1><p id="3dd0" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在Remix中，大部分路由都是由API和UI组件组成的。API与后端交互，而UI组件显示在浏览器中。Remix APIs简化并优化了与后端的交互，包括如何将数据放入组件以及何时执行数据突变。</p><p id="9508" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt ni b">loader</code>函数是一个特殊的API。它被导出以便在渲染之前在服务器上调用。它通常从后端获取数据。</p><p id="96ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，UI组件通过钩子<code class="fe nr ns nt ni b">useLoaderData</code>使用加载的数据呈现页面。</p><p id="3fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们写过一篇文章，<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/set-up-and-use-mysql-in-create-react-app-environment-22a4c7dc077f">在Create React App环境中设置和使用MySQL</a>。让我们看看在Remix环境中设置和使用MySQL是多么容易。</p><p id="642d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置<code class="fe nr ns nt ni b">mysql</code> ( <code class="fe nr ns nt ni b">mysql2</code>工作方式类似)，用于MySQL协议的JavaScript客户端:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="3b4c" class="nm ml it ni b gy nn no l np nq">npm i mysql</span></pre><p id="33ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt ni b">mysql</code>成为<code class="fe nr ns nt ni b">package.json</code>中<code class="fe nr ns nt ni b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/package-jsons-dependencies-in-depth-a1f0637a3129">dependencies</a></code>的一部分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="90a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<code class="fe nr ns nt ni b">app/routes/index.jsx</code>修改如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="4357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第4–9行定义了用户配置。</p><p id="50e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第11–13行使用用户配置创建MySQL连接。第12行启用多个语句，默认情况下禁用这些语句以避免可能的SQL注入攻击。</p><p id="9961" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第15–25行定义了<code class="fe nr ns nt ni b">loader</code>函数，它连接到数据库来查询学生表(第16行)。如果有错误，承诺被解析到<code class="fe nr ns nt ni b">null</code>(第19行)。否则，返回MySQL表的第一行(第22行)，假设至少有一行。</p><p id="c9a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第28行调用<code class="fe nr ns nt ni b">useLoaderData</code>来检索加载的数据，这些数据呈现在第33行。</p><p id="034b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不需要重新启动服务器。<code class="fe nr ns nt ni b">npm run dev</code>类似于<code class="fe nr ns nt ni b">nodemon</code>，自动监控代码变更，并重建变更。</p><p id="1aac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，浏览器控制台上有一个错误:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a87d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">多么神秘的错误信息！</p><p id="6cc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当服务器端依赖项被捆绑在客户端脚本中时，会出现此错误。</p><p id="6c14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让Remix在服务器和浏览器环境中运行应用程序，应用程序模块和第三方依赖项需要小心模块副作用。Remix编译器会自动从浏览器包中删除服务器代码。在上面的代码中，第11–13行创建MySQL连接，这是服务器代码。<code class="fe nr ns nt ni b">loader</code>消失了，但是<code class="fe nr ns nt ni b">mysql</code>依赖关系保留了下来。浏览器无法正确处理<code class="fe nr ns nt ni b">mysql</code>模块。</p><p id="bacf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要解决这个问题，只需将代码和用户配置一起移动到<code class="fe nr ns nt ni b">loader</code>函数中，就可以消除副作用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b5a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在可以用了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/9be8bc9f977d813a6f0ed2e671ce7189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*AOXOGofM-mQwjMR-TURIVg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7479" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，我们要在每次调用<code class="fe nr ns nt ni b">loader</code>函数时创建一个MySQL连接吗？</p><p id="b1c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的方法是在<code class="fe nr ns nt ni b">app/entry.server.jsx</code>(第30–32行)中创建一个MySQL连接:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5424" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，<code class="fe nr ns nt ni b">app/routes/index.jsx</code>简单地导入<code class="fe nr ns nt ni b">connection</code>(第2行):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="d3cf" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">混合动作</h1><p id="7a07" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated"><code class="fe nr ns nt ni b">&lt;Form&gt;</code>组件是一种执行数据突变的声明性方式:创建、更新和删除数据。Remix的<code class="fe nr ns nt ni b">Form</code>是一个增强的HTML表单组件。route不使用React事件处理程序，比如<code class="fe nr ns nt ni b">onClick</code>，而是导出表单提交时调用的<code class="fe nr ns nt ni b">action</code>函数。<code class="fe nr ns nt ni b">useState</code>不需要维护字段值。</p><p id="a620" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于<code class="fe nr ns nt ni b">loader</code>函数，还有<code class="fe nr ns nt ni b">action</code>函数，在表单提交时调用。与钩子<code class="fe nr ns nt ni b">userLoaderData</code>类似，<code class="fe nr ns nt ni b">action</code>函数也有一个钩子<code class="fe nr ns nt ni b">useActionData</code>，它捕获<code class="fe nr ns nt ni b">action</code>函数返回的数据。</p><p id="2e04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe nr ns nt ni b">action</code>和<code class="fe nr ns nt ni b">useActionData</code>来构建具有修改学生成绩能力的示例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/f5f2c89ac2d74bd1271790882d8a9d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*4sOxZYvZtbFfHtQCvAFAEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0aec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是改编的<code class="fe nr ns nt ni b">app/routes/index.jsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="ba3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第17–33行定义了<code class="fe nr ns nt ni b">action</code>函数，该函数读取表单提交数据(第18–19行)并连接到数据库以更新学生表(第22行)。如果有错误，承诺被解析为错误消息(第26行)。否则，它返回一个成功的消息(第28行)。</p><p id="e307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第37行调用<code class="fe nr ns nt ni b">useActionData</code>来检索动作结果，该结果呈现在第50行。</p><p id="d573" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第44–49行添加了<code class="fe nr ns nt ni b">Form</code>组件。</p><p id="0e1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存更改，并在输入字段中输入<code class="fe nr ns nt ni b">4</code>。点击enter后，该值被发送到<code class="fe nr ns nt ni b">action</code>以更新数据库。Remix检测到数据突变，并调用<code class="fe nr ns nt ni b">loader</code>来检索要显示的最新值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/94d0e7ba42c5b3121bbbdf985664a384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*Qta52PtbKwklnAogTGMLrw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="96b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果输入无效，将显示错误消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/8ed2ceefcb985dcf0a8d25e5a49d28fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*VgiuaXY0YtZtBPfleD7_Pg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4c2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt ni b">Remix App Server</code>和后端之间的流程是无缝的。不需要样板代码。</p><h1 id="862f" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">结论</h1><p id="8eba" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">我们已经经历了如何使用混音。它有很多优点，最引人注目的是速度——在浏览器中加载页面很快，开发端到端应用程序也很快。Remix是一个全栈Web框架，包括esbuild、React路由器、服务器端渲染、生产服务器和后端优化。</p><p id="164f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经在许多文章中讨论了这些特性。有了Remix，它们都是可用的，没有样板文件。</p><p id="7d60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混音有什么缺点吗？</p><p id="4e5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，混音还是新的。错误报告需要改进。例如，如果我们想要一个服务器在一个被占用的端口上，它不会报告错误或建议一个不同的端口。当它报告错误时，一些错误消息过于隐晦。</p><p id="5bef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管怎样，Remix已经成为一个被广泛采用的React框架。</p><p id="0024" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。我希望这有所帮助。如果你有兴趣，可以看看<a class="ae ky" href="https://jenniferfubook.medium.com/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">我的其他媒体文章</a>。</p></div></div>    
</body>
</html>