<html>
<head>
<title>Create Forms in React Without Stress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在没有压力的情况下创建表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-forms-in-react-without-stress-115e02053185?source=collection_archive---------0-----------------------#2022-08-30">https://betterprogramming.pub/create-forms-in-react-without-stress-115e02053185?source=collection_archive---------0-----------------------#2022-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c87c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">管理验证、错误、修改字段列表等的简单方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a7f2f7e5030c7897e6183be5516c5df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DKbh4xJzKcTdZOrr"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">泰勒·尼克斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="cdf7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">老实说，有很多方法可以管理表单的状态。如今我们有很多选择。<a class="ae kv" href="https://formik.org/" rel="noopener ugc nofollow" target="_blank"> Formik </a>、<a class="ae kv" href="https://react-hook-form.com/" rel="noopener ugc nofollow" target="_blank"> React钩子形态</a>、<a class="ae kv" href="https://final-form.org/react" rel="noopener ugc nofollow" target="_blank"> React最终形态</a>最受欢迎。</p><p id="ec4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哦，你可以做你自己的钩子。这里最具挑战性的部分是为你的项目选择正确的选项。</p><h1 id="8f8e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">我的故事</h1><p id="aaf2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">几年前，我在React中研究管理表单，寻找对我来说最好的解决方案。我想找到一种简单而漂亮的方法来管理验证和错误，保存已访问字段的列表，等等。</p><p id="144f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么它做了什么？我创建了我的自定义挂钩！</p><p id="4db1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的，我喜欢编码，我喜欢创造我的解决方案。这是一个简单的钩子，使用下面的<code class="fe mp mq mr ms b"><a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank">userReducer</a></code>来管理表单的状态。表单中的每次击键都会更新更改(我们都知道反应行为是正常的)。</p><p id="db15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在那里没有任何花哨的验证，数据只在提交时检查，一切都很好，但是…</p><h1 id="87f3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">问题</h1><p id="d49e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">性能！开始的时候我没有感觉到。我以多种形式使用我的钩子，一切都很棒，但我的形式在增长；我有很大的嵌套对象，所以我不得不用<code class="fe mp mq mr ms b"><a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html#usememo" rel="noopener ugc nofollow" target="_blank">useMemo</a></code>、<code class="fe mp mq mr ms b"><a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html#usecallback" rel="noopener ugc nofollow" target="_blank">useCalback</a></code>和正确的构图做些手脚，这很有帮助，但是…</p><p id="6f90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我意识到我的解决方案太简单了。我需要更多。我想快速检测表单中是否有任何更改，哪些字段发生了更改，等等。我也许可以改进我的钩子，让它更“聪明”，但这将花费我更多的努力和时间。如果没有现成的解决方案，那很好，但事实并非如此。</p><p id="3260" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要误解我。我说的不是基本形式，也就是有一两个输入框和一个按钮的形式。没有任何图书馆你也能轻松生活。</p><p id="3bbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我明白我不想浪费时间去解决这些问题；我只是想找到一个能做所有这些事情的库，并且不应该在表单的每一个变化上引起重新渲染。</p><p id="5db0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我开始学习现有的解决方案。</p><h1 id="c461" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">寻找答案</h1><p id="14bb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">那一刻，最受欢迎的是福米克。如果我们现在看官方文档，可以看到它仍然是推荐的方式之一。</p><blockquote class="mt mu mv"><p id="bf51" class="kw kx mw ky b kz la jr lb lc ld ju le mx lg lh li my lk ll lm mz lo lp lq lr ij bi translated">如果您正在寻找一个完整的解决方案，包括验证、跟踪访问过的字段以及处理表单提交，Formik是一个受欢迎的选择。然而，它是建立在受控组件和管理状态的相同原则上的——所以不要忘记学习它们。</p></blockquote><p id="ebef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是正如我之前提到的，我不想每次修改时都重新提交表单。在阅读文档和实验之后，我选择了React钩子形式。</p><h1 id="8701" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">为什么反应钩子形态？</h1><ol class=""><li id="c341" class="na nb iq ky b kz mk lc ml lf nc lj nd ln ne lr nf ng nh ni bi translated">使用useRef可以提高性能。你可以在<a class="ae kv" href="https://react-hook-form.com/" rel="noopener ugc nofollow" target="_blank">官方文件</a>中读到。</li><li id="1c5a" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">您可以使用Yup进行验证。</li><li id="bbcd" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">有很多例子的优秀文档。</li><li id="71b5" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">您可以从react-hook-form注册不受控制的组件或使用Controller controlled，这允许您使用来自像<a class="ae kv" href="https://mui.com/" rel="noopener ugc nofollow" target="_blank"> MatetialUi </a>、<a class="ae kv" href="https://ant.design/components/table/" rel="noopener ugc nofollow" target="_blank"> AntTd </a>、<a class="ae kv" href="https://developer.microsoft.com/en-us/fluentui" rel="noopener ugc nofollow" target="_blank"> FluentUI </a>等库的组件。</li><li id="6b19" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">库使用了<code class="fe mp mq mr ms b"><a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html#usecontext" rel="noopener ugc nofollow" target="_blank">useContext</a></code>钩子，所以你可以将方法传递给嵌套很深的子对象。</li><li id="7d5d" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">如果你对钩子感到舒服，RHF语法会看起来非常熟悉和容易理解。</li></ol><p id="68ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我开始使用这个库并使用<a class="ae kv" href="https://reactjs.org/blog/2018/09/10/introducing-the-react-profiler.html" rel="noopener ugc nofollow" target="_blank"> React Profiler </a>看到它时，我感觉到了不同。了解组件重新呈现的频率和原因会很有帮助。有时它可以帮助解决性能问题。</p><h1 id="725a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用Yup</h1><p id="787b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我之前提到过我需要管理验证，所以我使用了Yup。这是一种验证数据的奇妙方式，因为您可以独立使用它，也可以与其他库一起使用它来管理状态。</p><p id="79fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用yup定义验证很容易；你有许多不同的类型，你可以描述依赖关系和你的验证规则。在我的例子中，我填写了“姓氏”，当字段的标题值为“测试”时，这是必需的。看看这个例子，你会发现使用Yup是多么简单:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><h1 id="f880" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用React挂钩形式</h1><p id="1a78" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用库(如FluentUI、MaterialUI或其他库)中的组件有助于选择使用受控组件。是的，我不想使用它们，但是React Hook Form允许我使用受控组件，最大限度地减少渲染。不幸的是，我不能不受控制地使用一些FluentUI组件，所以RHF帮助优化性能真是太棒了。</p><p id="b2c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好的，但是如何使用这个库呢？</p><p id="469e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要安装两个包:<code class="fe mp mq mr ms b"> npm install react-hook-form yup</code>。我们可以传递默认值，并说明我们希望多长时间验证一次表单。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="a120" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们需要决定我们将使用什么类型的组件。我们有两个选择:</p><ol class=""><li id="3a2c" class="na nb iq ky b kz la lc ld lf nq lj nr ln ns lr nf ng nh ni bi translated">记录不受控制的组件</li><li id="9c84" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">对受控组件使用名为<code class="fe mp mq mr ms b">Controller</code>的包装器</li></ol><p id="24f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于第二个选项，您需要用来自RHF的<code class="fe mp mq mr ms b">Controller</code>来包装您的组件。这是我在FluentUI库中使用<code class="fe mp mq mr ms b">TextField</code>的例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="4b80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最好的是，如果我们需要的话，我们可以将两种选择结合起来，在一种形式中使用这两种方式。以下是我的受控组件示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6aac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是最终的结果——快速而简单。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/1f730a397ec7128113e42c931c1b1415.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*A1VxqdJuvmfpPb1i7Cb0cQ.png"/></div></figure></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="e12f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是用React Hook Form和Yep管理表单状态的全部内容。我希望这些库也能帮助你。</p></div></div>    
</body>
</html>