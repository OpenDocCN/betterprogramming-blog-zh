<html>
<head>
<title>Make a CLI in 50 Lines of Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用50行Python代码创建一个CLI</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/make-a-cli-in-50-lines-of-python-code-158c378eb4bd?source=collection_archive---------10-----------------------#2021-02-12">https://betterprogramming.pub/make-a-cli-in-50-lines-of-python-code-158c378eb4bd?source=collection_archive---------10-----------------------#2021-02-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="3023" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">创建命令组、标志等</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/84f549050bf76cc04093cc1ca758f69a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofXEwaqv4C9IPhSg_JSUtw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者照片。</p></figure><p id="32da" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">今天，我们将创建一个用Python构建的简单CLI(命令行界面)。更具体地说，我们将使用一个叫做<code class="fe lv lw lx ly b">click</code>的流行Python包，它允许我们加速这个过程。什么是CLI？它是一个在你的终端内部做一些事情的工具。使用CLI工具，可能性是无限的。</p><p id="edd2" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated"><code class="fe lv lw lx ly b">click</code>内置了许多特性，所以我将只介绍基本特性来帮助您入门。如果你有兴趣深入研究<code class="fe lv lw lx ly b">click</code>提供的更复杂的特性，请查看<a class="ae lz" href="https://click.palletsprojects.com/en/7.x/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="3cff" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">1.安装点击</h1><p id="789b" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">本教程假设您知道如何使用Python。如果你不知道如何使用Python，我建议在继续学习本教程之前先学习基础知识。</p><p id="5a62" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在开始之前，我们需要安装<code class="fe lv lw lx ly b">click</code>。你可以通过运行下面的命令来安装<code class="fe lv lw lx ly b">click</code>:</p><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="2316" class="ni mi iu ly b gz nj nk l nl nm">pip install click<br/>OR<br/>pip3 install click</span></pre><p id="7eec" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我在我的环境上运行<code class="fe lv lw lx ly b">pipenv install click</code>，因为我使用的是虚拟环境，但是如果你没有使用虚拟环境，上面的命令会做同样的事情。请记住，本文中的所有gif都将使用<code class="fe lv lw lx ly b">pipenv run</code>来执行命令，因为我使用的是虚拟环境。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nn"><img src="../Images/f94a1d1f137eedeff6985284c4b8f8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/1*gY2YEeCY1Ac3ULR4uPJEiA.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在你的机器上点击安装</p></figure><p id="be23" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">运行该命令后，您的环境中应该已经安装了<code class="fe lv lw lx ly b">click</code>。现在我们准备开始编码了。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="9727" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">2.设置文件</h1><p id="36a2" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">像大多数Python脚本一样，我们需要某种将要运行的主脚本。我将创建一个<code class="fe lv lw lx ly b">main.py</code>文件。所以继续创建一个文件。该文件的内容应该如下:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="d3a5" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果您在终端中运行<code class="fe lv lw lx ly b">python main.py</code>(确保您在同一个目录中)，您将看到如下内容:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nn"><img src="../Images/6b429be1257e613e24d6cd052e7013ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/1*ly9Vg2d3v6Xkjz0DilI53Q.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">运行脚本</p></figure><p id="1ffa" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这实际上只是一个Python脚本。<code class="fe lv lw lx ly b">click</code>的功能还没用过。在下一节中，我们将通过引入某些特性来使它变得更加令人兴奋。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="a342" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">3.创建命令组</h1><p id="ded8" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">现在我们已经建立并运行了我们的文件，我们将开始探索<code class="fe lv lw lx ly b">click</code>的特性。我们将首先创建一个命令组。命令组是我们创建绑定到单个脚本/标签的多个命令的一种方式。这里有一个例子:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="8cc2" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在上面的代码片段中，我们创建了一个名为<code class="fe lv lw lx ly b">main</code>的新组，它允许我们将多个函数/命令绑定到该组。这使我们可以将多个命令附加到一个脚本中，这样可以:</p><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="8594" class="ni mi iu ly b gz nj nk l nl nm">python main.py</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/14cd3da98f913432365433cb66468cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*f1P2OgWa9ucxkVpkh3n-TQ.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">与小组一起运行脚本</p></figure><p id="035f" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">请注意，当我们不带任何参数运行脚本时，它现在会提示我们不同的可用命令——在本例中，是我们创建的两个函数。要调用特定的命令，您可以运行如下命令:</p><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="aa13" class="ni mi iu ly b gz nj nk l nl nm">python main.py hello<br/>OR<br/>python main.py world</span></pre><p id="1314" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果你想创建一个新的命令，那么就创建一个新的函数吧！运行这两个命令中的任何一个都将执行每个函数中的代码。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/9699fb7e884b847292fc35b715fb164b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*Y6ipnw49nD4Tr7XvoyXdDw.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在主组中运行每个单独的命令</p></figure><p id="6639" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">您可以通过为不同的目的创建不同的组来利用这一特性。您可以有一组特定于它们的命令，或者您可以有一个巨大的脚本，其中包含您希望放在一个组中的所有不同的命令。选择取决于您以及您希望如何构建该工具。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="9408" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">4.为命令创建标志/选项</h1><p id="f1f4" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">我们将讨论的下一个特性对于CLI世界来说非常重要。许多CLI工具允许根据您的需要选择不同的选项。例如，<code class="fe lv lw lx ly b">ls</code>列出了当前目录下的所有文件。但是，如果我们输入<code class="fe lv lw lx ly b">ls -l</code>，它会以长格式列出它们，显示目录中每个项目的更多信息。这就是T4所说的选择。</p><p id="fffc" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">要在<code class="fe lv lw lx ly b">click</code>中创建一个选项，我们只需要给函数添加一个注释/装饰，如下所示:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="5ee8" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这个选项变成了函数的一个参数，可以做任何你想做的事情。在这种情况下，我们只是根据用户在终端中输入的内容循环<em class="nr"> N </em>次。如果用户没有输入任何标志，那么缺省值将决定这个函数的值。</p><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="b853" class="ni mi iu ly b gz nj nk l nl nm">python main.py hello<br/>OR<br/>python main.py hello -n 20</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/7a8890b90646f5cc58a80d58e82bf4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*21qu6QSUVIUY2mkMpc4ObA.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用添加的标志运行hello命令</p></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="03d2" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">5.记录您的命令</h1><p id="1434" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">既然我们已经探索了<code class="fe lv lw lx ly b">click</code>的基本特性，我想讨论的最后一件事就是添加文档。大多数CLI都在程序中内置了文档，帮助用户理解每个命令和标志/选项的作用。<code class="fe lv lw lx ly b">click</code>的美妙之处在于它可以毫不费力地格式化并显示给用户。你所需要知道的就是把你的帮助信息放在哪里。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="no np l"/></div></figure><p id="0f67" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">请注意帮助消息的位置。命令级帮助消息作为函数注释创建，标志/选项帮助消息放在<code class="fe lv lw lx ly b">click.option()</code>注释的属性内。要查看您的帮助信息，输入<code class="fe lv lw lx ly b">--help</code>将显示您上传的信息。</p><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="2f16" class="ni mi iu ly b gz nj nk l nl nm">python main.py --help</span></pre><p id="6b37" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">像这样显示命令级帮助消息:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/483a7f29b3b51b00e3407f8d55b198ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*AN3i-ArRnhXOS1nzDcFIjg.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">命令级帮助消息</p></figure><pre class="kk kl km kn gu ne ly nf ng aw nh bi"><span id="4f0a" class="ni mi iu ly b gz nj nk l nl nm">python main.py hello --help</span></pre><p id="aa56" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">显示命令的标志/选项帮助消息，如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/2d2606c399d79e0f91ff40ee5ce62e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*ssGNoWmFsg9rE3p2bj4mPw.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">标志/选项级帮助消息</p></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="1f30" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">结论</h1><p id="1693" class="pw-post-body-paragraph kz la iu lb b lc mz jv le lf na jy lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">本教程向您介绍了如何使用Python制作CLI的基础知识。其他的包都允许你这么做，但是我感觉<code class="fe lv lw lx ly b">click</code>用起来很简单，也很有效。</p><p id="f905" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果你想部署你的代码，我<a class="ae lz" href="https://medium.com/better-programming/publishing-your-python-packages-to-pypi-e48c169f4f09" rel="noopener">写了一篇文章</a>，讲述了如何打包和部署代码到<code class="fe lv lw lx ly b">pip</code>。这将允许您与世界各地的其他人共享您的CLI。</p><p id="6fe0" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果你有任何问题或希望有一个讨论，随时评论！</p><p id="3b62" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">完整的源代码可以在GitHub 上找到<a class="ae lz" href="https://github.com/ericjaychi/sample-python-cli" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="5813" class="pw-post-body-paragraph kz la iu lb b lc ld jv le lf lg jy lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">编码快乐！</p></div></div>    
</body>
</html>