<html>
<head>
<title>Analyzing Autonomous Art NFT Smart Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解析自主艺术NFT智能合约</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/analyzing-autonomous-art-nft-smart-contract-aa4547b31eb3?source=collection_archive---------5-----------------------#2022-03-04">https://betterprogramming.pub/analyzing-autonomous-art-nft-smart-contract-aa4547b31eb3?source=collection_archive---------5-----------------------#2022-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="edf0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">解码智能合同02</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b89d531811ed4548401756c7acbbf5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bs-lCr4Dl6Nqzt-06TW1qA.jpeg"/></div></div></figure><p id="a418" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><a class="ae ln" href="https://autonomous.graphics/" rel="noopener ugc nofollow" target="_blank">自主艺术</a>是由<a class="ae ln" href="https://en.wikipedia.org/wiki/Moxie_Marlinspike" rel="noopener ugc nofollow" target="_blank">莫邪·马林斯派克</a>创建的NFT项目。它允许用户通过视觉贡献集体创造和铸造NFT，并通过分享随后的铸造费来赚钱。这是一个非常成功的实验。按照<a class="ae ln" href="https://www.instagram.com/p/CaAhIv2vX-Y/" rel="noopener ugc nofollow" target="_blank">莫邪自己的话说</a>:</p><blockquote class="lo lp lq"><p id="ec45" class="kr ks lr kt b ku kv jr kw kx ky ju kz ls lb lc ld lt lf lg lh lu lj lk ll lm ij bi translated">我的自治图形NFT本来应该是一个笑话，但现在它已经投入了150万美元，而且它的字面广告牌漂浮在迈阿密海滩附近的水中。</p></blockquote><p id="b2ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，我将解释自治艺术的智能契约。这篇文章是初学者友好的，所以可以随意跳过任何部分。如果你很了解这个项目，并且熟悉NFT，你可能想导航到“按功能解释”部分。</p><h1 id="3f40" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">目标受众是谁？</h1><p id="155b" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">如果你刚到NFT，想学习如何自己开发一个NFT智能合同，这篇文章很适合你。如果你对NFT背后的技术是如何工作的感到好奇，这篇文章也会有所帮助。</p><h1 id="4914" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">先决条件</h1><p id="ab27" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">如果你了解ERC-721并有编码经验，你可以跳过这一节。否则，不如了解以下内容。</p><ul class=""><li id="77fe" class="ms mt iq kt b ku kv kx ky la mu le mv li mw lm mx my mz na bi translated">NFT概念:理解什么是NFT很重要，是什么让它不可替代。要了解更多，你可以阅读我以前的文章:<a class="ae ln" rel="noopener ugc nofollow" target="_blank" href="/nft-beginner-tutorial-pepsi-nft-smart-contract-explained-962721b7361a">分析百事NFT智能合同</a>(具体来说，合同部分的<strong class="kt ir"> NFT)。</strong></li><li id="9bf2" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated"><strong class="kt ir">坚固性</strong>:大部分NFT合约使用<a class="ae ln" href="https://docs.soliditylang.org/en/latest/" rel="noopener ugc nofollow" target="_blank">坚固性</a>。有一个基本的了解可以帮助你理解合同代码。<a class="ae ln" href="https://docs.soliditylang.org/en/latest/" rel="noopener ugc nofollow" target="_blank">公文</a>是一个很好的学习起点。</li><li id="fab2" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated"><strong class="kt ir"> ERC-721 </strong>:自治艺术NFT利用由Open Zeppelin实现的ERC-721智能合约。ERC-721标准提供了NFT的基本功能，包括转账、检查账户余额、造币等。这是一个很好的概述:<a class="ae ln" href="https://ethereum.org/en/developers/docs/standards/tokens/erc-721/" rel="noopener ugc nofollow" target="_blank"> ERC-721不可替代令牌标准</a>。</li></ul><h1 id="a8a3" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">什么是自主艺术？</h1><p id="3145" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">在深入合同之前，我们先了解一下这个项目是如何运作的。有两个方面:(1)如何集体创作艺术？(2)经济如何运转？</p><h2 id="e35e" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">(1)如何集体创作艺术？</h2><p id="e5ed" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">你可以在<a class="ae ln" href="https://autonomous.graphics/" rel="noopener ugc nofollow" target="_blank">自主艺术网站</a>上找到集体创作的作品。到目前为止，已经有633位用户在这幅数码画上留下了他们的印记。你可以在之前的图片上做一个视觉上的贡献(比如添加一个形状，指定一种颜色)，然后把它做成一个NFT。下面的视频展示了这件艺术品的演变过程。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><p class="nu nv gj gh gi nw nx bd b be z dk translated">自主艺术史</p></figure><h2 id="2057" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">(2)经济如何运转？</h2><p id="f3fe" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">要铸造一个NFT，你必须支付一个随着时间推移而上涨的价格。这笔资金将平均分配给所有以前的捐助者。你会以同样的方式赚钱，由于所有后续薄荷。</p><p id="fc81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可能很难理解这个项目。如果你想了解更多，请到<a class="ae ln" href="https://autonomous.graphics/" rel="noopener ugc nofollow" target="_blank">自主艺术网站</a>进行尝试或留下评论。</p><h1 id="8ae8" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">准备工作</h1><p id="00f1" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">首先，让我们找到最相关的合同代码。</p><h2 id="84c5" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">在哪里可以找到合同代码？</h2><p id="b5d3" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">智能合约地址为<code class="fe ny nz oa ob b">0x3a56AB63c7ef4f07fe353bEb132e0Fd5AD270Ca0</code>，其代码在此<a class="ae ln" href="https://etherscan.io/address/0x3a56ab63c7ef4f07fe353beb132e0fd5ad270ca0#code" rel="noopener ugc nofollow" target="_blank">以太扫描页面</a>的‘合约’部分。</p><h2 id="b858" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">哪个合同？</h2><p id="0dab" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">以太扫描页面上有13个合同。但是，我们只需要看第一个，<code class="fe ny nz oa ob b">CollectiveCanvas.sol</code>。其他合同是来自Hardhat和OpenZeppelin的开源模板，我们不会讨论。</p><p id="106a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在我的<a class="ae ln" href="https://gist.github.com/sicongzhao/9c65f3f116599bcad36c34c14e161306" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到<code class="fe ny nz oa ob b">CollectiveCanvas.sol</code>。</p><h1 id="8cb3" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">合同结构</h1><p id="1a32" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">接下来，我们来看看合同的结构。</p><p id="5ac7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这份合同乍看起来可能很复杂，但它组织得很好。图1显示了这个契约的结构。这种结构适用于几乎所有智能合同。如果您已经熟悉了，您可能想跳到下一部分，在那里我们将讨论这个智能合约的功能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/4c3fe6d2b160aaeebec1e4c96258440e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dVDpJHWYV_HdZ87xHecMA.png"/></div></div><p class="nu nv gj gh gi nw nx bd b be z dk translated">图1自治艺术NFT契约的结构</p></figure><ul class=""><li id="2219" class="ms mt iq kt b ku kv kx ky la mu le mv li mw lm mx my mz na bi translated"><strong class="kt ir"> SPDX许可证标识符</strong>(第1行)表示其他人如何使用该代码。SPDX许可证的完整列表。</li><li id="84db" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated"><strong class="kt ir"> Solidity版本</strong>(第2行)让编译器正确翻译代码，然后EVM就能理解了。在本合同中，<code class="fe ny nz oa ob b">^0.8.0</code>表示0.8.0或更高版本，但不高于0.9.0。</li><li id="14d5" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated"><strong class="kt ir"> Import dependencies </strong>(第4 - 9行)然后契约使用ERC-721契约作为其蓝图，并且还添加了base64编码之类的功能。</li><li id="e638" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated">自治艺术是由状态变量、构造器和函数组成的NFT契约。我将在下一节按功能来解释。</li></ul><h1 id="8ba0" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">按功能解释</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/d3dfc637b4a8e9d46734862972710fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ZYPq4paaA9m1GzU_WEhwQ.png"/></div></div><p class="nu nv gj gh gi nw nx bd b be z dk translated">图2合同的功能</p></figure><p id="bd5c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有6个主要功能。让我们调查一下！</p><h2 id="8129" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">1.链上元数据</h2><p id="d282" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">该契约存储链上的元数据，这保证了NFT的信息被安全地存储，并且只要区块链本身不被破坏，这些信息就是不可变的。这种解决方案比依赖任何外部存储更可靠。</p><p id="13f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可能会问链上解决方案是否更好，为什么项目要在IPFS上存储元数据？一个很棒的问题。答案是，存储信息可能是一项成本高昂的操作。根据这个消息来源的说法，存储1kB的数据大约要花费0.02 ETH(54美元)。很疯狂，对吧？</p><p id="6e52" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个项目为链上存储使用了两个技巧:(1) SVG格式图像(2) base64编码。</p><p id="5f0f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> (1) SVG格式图片:</strong> SVG代表可缩放矢量图形。它是一种描述矢量图形的语言。要画一个圆，只需要下面的字符串。尝试在这个<a class="ae ln" href="https://www.svgviewer.dev/" rel="noopener ugc nofollow" target="_blank"> SVG查看器</a>中跳过它，看看它看起来怎么样。</p><pre class="kg kh ki kj gt oe ob of og aw oh bi"><span id="6e07" class="ng lw iq ob b gy oi oj l ok ol">&lt;svg viewBox="0 0 200 200" ae ln" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg"&gt;<br/>  &lt;circle cx="100" cy="100" r="100"/&gt;<br/>&lt;/svg&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/84fb422b00074266c037d5da53aaa0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*aBJnd5PpxTwRms-DraS7fQ.jpeg"/></div><p class="nu nv gj gh gi nw nx bd b be z dk translated">图3 . SVG图像</p></figure><p id="bb99" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以JPG或PNG格式存储相同的圆形图像将产生3或4 kB的文件大小，这将花费大约200美元的汽油费。</p><p id="2bce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> (2) Base64编码</strong>本质上是将(结构化)数据编码成字符串的一种方式。例如，使用<a class="ae ln" href="https://www.utilities-online.info/base64" rel="noopener ugc nofollow" target="_blank">一个在线Base64编码器</a>，SVG代码可以编码如下:</p><pre class="kg kh ki kj gt oe ob of og aw oh bi"><span id="92be" class="ng lw iq ob b gy oi oj l ok ol">PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIvPgo8L3N2Zz4=</span></pre><p id="c27e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，如果我们在它前面加上一个字符串<code class="fe ny nz oa ob b">data:image/svg+xml;base64,</code>，我们的浏览器将能够理解整个字符串并显示圆形图像。尝试将下面的字符串复制粘贴到浏览器的地址栏中，看看会发生什么！</p><pre class="kg kh ki kj gt oe ob of og aw oh bi"><span id="8c3c" class="ng lw iq ob b gy oi oj l ok ol">data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAwIDIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIvPgo8L3N2Zz4=</span></pre><p id="071c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">图4显示了我的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/7d54eedd403df77d51596f60c9f3ce0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpmaSO74pkgJSzuR2I6n7A.png"/></div></div><p class="nu nv gj gh gi nw nx bd b be z dk translated">图4浏览器中的Base64编码SVG字符串</p></figure><p id="80c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们可以将图像编码成字符串，这同样适用于JSON格式的元数据。为此，首先，使用Base64编码JSON数据。然后，在它前面加上<code class="fe ny nz oa ob b">data:application/json;base64,</code>。</p><p id="6ab5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是提供链上元数据的合同函数，给定一个<code class="fe ny nz oa ob b">tokenId</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nt l"/></div></figure><p id="dd45" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它首先检查令牌是否存在，然后从函数<code class="fe ny nz oa ob b">_encodeSvgUriAtTokenId</code>中检索Base64编码的SVG图像字符串。第6行编码组合并将元数据JSON字符串编码成Base64格式。最后，在前面加上字符串<code class="fe ny nz oa ob b">data:application/json;base64,</code>，链上元数据就生成了！</p><h2 id="f4db" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">2.SVG处理</h2><p id="0a06" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">下面的代码处理SVG。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nt l"/></div></figure><p id="fbd9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是集体艺术，有很多贡献者。为了重建艺术品的每个历史状态，每个贡献都单独存储在variable _layers数组中。例如，如果我将上面的圆添加到艺术作品中，并将其铸造为NFT，则此字符串<code class="fe ny nz oa ob b">&lt;circle cx=”100" cy=”100" r=”100"/&gt;</code>将作为其最后一个元素添加到<code class="fe ny nz oa ob b">_layers</code>中。另外，<code class="fe ny nz oa ob b">_layers</code>里的圈串索引和我的NFT tokenId是一样的。</p><p id="256d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">给定一个<code class="fe ny nz oa ob b">tokenId</code>，函数<code class="fe ny nz oa ob b">_encodeSvgAtTokenId</code>通过从头开始迭代<code class="fe ny nz oa ob b">_layers</code>到tokenId值索引，并将每个元素添加到SVG字符串，来重构历史状态。</p><p id="54d0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">函数<code class="fe ny nz oa ob b">_encodeSvgUriAtTokenId</code>将SVG字符串编码为Base64格式，然后为其添加字符串<code class="fe ny nz oa ob b">data:image/svg+xml;base64,</code>以实现浏览器兼容性。</p><p id="1918" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我的学习中，我对使用SVG来存储和重建艺术品的历史状态感到惊讶。太有创意了！</p><p id="51f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们没有涵盖所有内容。在将每个SVG元素添加到<code class="fe ny nz oa ob b">_layers</code>之前，有一个函数<code class="fe ny nz oa ob b">_validateLayer</code>检查每个SVG元素的有效性，特别是SVG语法。我没有研究这个函数，因为知道它的存在似乎就足以理解这个智能契约。</p><h2 id="fed8" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">3.价格计算</h2><p id="618f" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">恭喜你！你刚刚学到了这个聪明契约中最难的部分。后面的部分会更容易。</p><p id="e33d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如上所述，NFT的价格随着代币的数量而上升。下面的代码证明了设计的合理性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nt l"/></div></figure><p id="7167" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只需补充两点:(1)层的长度等于前面讨论的铸造NFT代币的数量。(2)在构造函数中将basePrice设置为0.024 ETH。</p><h2 id="11f0" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">4.铸造</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nt l"/></div></figure><p id="b387" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里没有什么疯狂的，只是两个要求:(1)交易足以覆盖NFT价格，(SVG代码是有效的。然后创建NFT并将元数据保存在映射状态变量<code class="fe ny nz oa ob b">_tokenMetadata</code>中。</p><h2 id="ca8a" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">5.值分布</h2><p id="4cfc" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">这个NFT项目走红的原因之一是价值分配机制。作为代币持有者，你可以通过分享后续的铸币费来赚很多钱。我们来深究一下吧！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nt l"/></div></figure><p id="dd8e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">函数<code class="fe ny nz oa ob b">balanceOfToken</code>计算你的NFT拥有的余额。它迭代后续的铸币，计算你的份额，并将这些值相加，得出你拥有的总资金。然后用提取部分减去该值，得出可提取余额。</p><p id="bd9d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">功能<code class="fe ny nz oa ob b">withdraw</code>允许NFT所有者转移余额，并更新存储在<code class="fe ny nz oa ob b">_tokenMetadata</code>中的提取金额。</p><h2 id="b960" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated">6.其他人</h2><p id="3f81" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">还有其他的效用函数来设置底价或计算这个项目中累积的总资金。这些函数非常标准且易于理解。虽然我不会在本文中涉及它们，但如果您有任何问题，请随时发表评论！</p><h1 id="c31a" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结束了</h1><p id="60f8" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">你有它！我希望你觉得这个教程很有帮助，也很有趣。如果您有任何问题或建议，请随时发表评论。我也乐于接受建议。如果你知道一个有趣的项目，想让我看看，告诉我！</p><pre class="kg kh ki kj gt oe ob of og aw oh bi"><span id="8e92" class="ng lw iq ob b gy oi oj l ok ol"><strong class="ob ir">Want to Connect?</strong></span><span id="7567" class="ng lw iq ob b gy op oj l ok ol">Please feel free to reach out (<a class="ae ln" href="https://www.linkedin.com/in/zhaosicong/" rel="noopener ugc nofollow" target="_blank">my LinkedIn</a>) if you have any questions, feedback, or even just a random chat.</span></pre><h2 id="cc11" class="ng lw iq bd lx nh ni dn mb nj nk dp mf la nl nm mh le nn no mj li np nq ml nr bi translated"><strong class="ak">其他教程</strong></h2><ul class=""><li id="7496" class="ms mt iq kt b ku mn kx mo la oq le or li os lm mx my mz na bi translated"><a class="ae ln" rel="noopener ugc nofollow" target="_blank" href="/nft-beginner-tutorial-pepsi-nft-smart-contract-explained-962721b7361a">分析百事NFT智能合同</a></li><li id="6972" class="ms mt iq kt b ku nb kx nc la nd le ne li nf lm mx my mz na bi translated"><a class="ae ln" href="https://medium.com/@luo9137/analyzing-paks-merge-smart-contract-7e437b66077c" rel="noopener">分析巴基斯坦的“合并”智能合同</a></li></ul></div></div>    
</body>
</html>