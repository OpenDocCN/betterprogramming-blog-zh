<html>
<head>
<title>AES 256 Encryption/Decryption with OpenSSL using Bash Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Bash脚本通过OpenSSL进行AES 256加密/解密</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/aes-256-encryption-decryption-with-openssl-using-bash-script-94cf3b8125ba?source=collection_archive---------1-----------------------#2022-08-10">https://betterprogramming.pub/aes-256-encryption-decryption-with-openssl-using-bash-script-94cf3b8125ba?source=collection_archive---------1-----------------------#2022-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="68ba" class="pw-subtitle-paragraph jo ip iq bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated"><em class="jn">使用OpenSSL工具加密一个文件中的数据，然后解密成另一个文件</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/7d9c72219d61ca1fdd0b68ac19bf5bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3vTY10XGencIEwcV"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><em class="jn">照片由</em> <a class="ae kw" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> <em class="jn">飞:D </em> </a> <em class="jn">上</em> <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> <em class="jn">下</em> </a></p></figure><p id="ff7a" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文结束时，您将了解到:</p><ul class=""><li id="9283" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">如何创建您的第一个bash脚本</li><li id="3061" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">如何从命令行输入读取数据</li><li id="cb9a" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">使用OpenSSL工具的AES 256加密/解密</li><li id="1ca7" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">将数据读写到文件中</li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="a2d2" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">注意</h2><p id="5c02" class="pw-post-body-paragraph kx ky iq kz b la nh js lc ld ni jv lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">可以使用命令<code class="fe nm nn no np b">./&lt;filename.sh&gt;</code>通过终端运行<code class="fe nm nn no np b">.sh</code></p><p id="e62a" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果您在运行<code class="fe nm nn no np b">.sh</code>文件时遇到权限被拒绝的错误，您可以通过使用下面的终端命令授予文件权限来修复它。</p><pre class="kh ki kj kk gt nq np nr ns aw nt bi"><span id="a2a1" class="mo mp iq np b gy nu nv l nw nx"><strong class="np ir">sudo chmod +x samplescript.sh</strong></span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="58d1" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">创建Bash文件</h2><p id="553c" class="pw-post-body-paragraph kx ky iq kz b la nh js lc ld ni jv lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">我们将为这个项目设置一个专用文件夹，因为我们需要创建一个加密文件以及一个解密文件。我将创建一个名为<code class="fe nm nn no np b">Shell Encryption</code>的文件夹。现在，这将是我们工作的主要目录。</p><p id="b5a6" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将在这个文件夹中创建一个<code class="fe nm nn no np b">.sh</code>文件。我将在整个故事中使用Atom <strong class="kz ir"> </strong> IDE来开发这个bash脚本。</p><p id="0818" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将简单地创建一个新文件，并将其命名为<code class="fe nm nn no np b">Encryption.sh</code>加密是我选择的文件名，您可以选择任何您想要的名称，只是文件的扩展名必须是<code class="fe nm nn no np b">.sh</code></p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="7b00" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">读取命令行输入</h2><p id="e48f" class="pw-post-body-paragraph kx ky iq kz b la nh js lc ld ni jv lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">这里有两种选择，一种是加密我们拥有的可读数据，然后解密这些数据。</p><p id="7943" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，我们将让用户选择是否要进行加密或解密操作。</p><p id="3440" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为此，我们将打印并列出选项供用户选择。下面是我们将如何设置列表选项:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="93ff" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这里我们将创建一个函数，它将打印终端中的所有选项，然后读取用户输入并执行相应的操作。<br/>我们<code class="fe nm nn no np b">echo</code>向用户提问，用选项号来选择。1用于加密，2用于解密，3用于退出。</p><p id="3171" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">接下来，我们将读取来自用户的输入，并运行一个开关案例，其中我们针对所做的选项选择执行相应的操作。</p><p id="7b99" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们还将编写一个可以用来获取<code class="fe nm nn no np b">PassKey</code>用户输入的函数。相同的<code class="fe nm nn no np b">PassKey</code>将用于加密和解密数据。</p><p id="d808" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了获取<code class="fe nm nn no np b">PassKey</code>，我们将使用<code class="fe nm nn no np b">read</code>编写一个简单的函数，如下面的代码片段所示。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="93ea" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们已经收到了来自用户输入的<code class="fe nm nn no np b">PassKey</code>。我们需要将它保存到一个变量中。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="b56c" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">所以我们将把<code class="fe nm nn no np b">PassKey</code>作为函数返回来传递，然后从调用者那里访问它，如下所示:</p><pre class="kh ki kj kk gt nq np nr ns aw nt bi"><span id="b76d" class="mo mp iq np b gy nu nv l nw nx">fetchPasskey PASSKEY</span></pre><p id="5d2f" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe nm nn no np b">PASSKEY</code>将保存输入的密钥值。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="f445" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">创建加密和解密函数</h2><p id="a180" class="pw-post-body-paragraph kx ky iq kz b la nh js lc ld ni jv lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">我们将使用OpenSSL工具包进行加密和解密。OpenSSL是一个众所周知的Linux加密工具包。OpenSSL是免费的，它有巨大的功能，并且很容易在Bash脚本中使用。</p><p id="fe1f" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> OpenSSL </strong>使用标准输入和标准输出，它支持广泛的参数，比如命令行开关、环境变量、命名管道、文件描述符和文件。关于OpenSSL的更多信息，你可以访问这里的<a class="ae kw" href="https://www.openssl.org/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="5896" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们在这里写了两个函数，一个用于<code class="fe nm nn no np b">Encrypting</code>，一个用于<code class="fe nm nn no np b">Decrypting</code>，如下所示。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="3c66" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第一个函数<code class="fe nm nn no np b">encryptData</code>我们在第一行中所做的是获取函数参数实参并将其赋给<code class="fe nm nn no np b">passkey</code>。<code class="fe nm nn no np b">"${1}"</code>仅代表功能参数中的第1项。</p><blockquote class="oa ob oc"><p id="3a85" class="kx ky od kz b la lb js lc ld le jv lf oe lh li lj of ll lm ln og lp lq lr ls ij bi translated"><code class="fe nm nn no np b"><strong class="kz ir"><em class="iq">-in</em></strong></code> <strong class="kz ir"> <em class="iq"> </em> </strong> <em class="iq">代表输入文件名<br/></em><code class="fe nm nn no np b"><strong class="kz ir"><em class="iq">-out</em></strong></code><strong class="kz ir"><em class="iq"/></strong><em class="iq">代表输出文件名</em><strong class="kz ir"><em class="iq"><br/></em></strong><code class="fe nm nn no np b"><strong class="kz ir"><em class="iq">-e</em></strong></code><strong class="kz ir"><em class="iq"/></strong><em class="iq">加密输入数据<br/></em><code class="fe nm nn no np b"><strong class="kz ir"><em class="iq">-d</em></strong></code><strong class="kz ir"><em class="iq"/></strong><em class="iq">解密输入数据<br/> </em>这里的参数应该像 <code class="fe nm nn no np b"><em class="iq">pass:&lt;Passkey&gt;</em></code>一样被提及</p></blockquote><p id="97eb" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe nm nn no np b">decryptData</code>函数与<code class="fe nm nn no np b">encryptData</code>函数相同，但我们将给出<code class="fe nm nn no np b">-e</code>而不是<code class="fe nm nn no np b">-d</code> <br/>，我们只需指定输入文件，输出文件将自动创建。这里我们已经提到了所有的输入文件和输出文件:</p><pre class="kh ki kj kk gt nq np nr ns aw nt bi"><span id="f403" class="mo mp iq np b gy nu nv l nw nx">PrimaryDataFile<!-- --> <br/>EncryptedDataFile<!-- --> <br/>DecryptedDataFile</span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="999c" class="oh mp iq bd mq oi oj ok mt ol om on mw jx oo jy mz ka op kb nc kd oq ke nf or bi translated">让我们测试一下</h1><p id="8cb3" class="pw-post-body-paragraph kx ky iq kz b la nh js lc ld ni jv lf lg nj li lj lk nk lm ln lo nl lq lr ls ij bi translated">在测试我们所写的内容之前，我们必须创建一个文件并向其中输入一些数据。这里我们将通过给它一个类型或扩展名来创建一个新文件。</p><p id="e503" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将其命名为<code class="fe nm nn no np b">PrimaryDataFile</code>，因为这是我们在encrypt <code class="fe nm nn no np b">openssl</code>中提供的输入文件名。</p><p id="83f7" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将在<code class="fe nm nn no np b">PrimaryDataFile</code>上输入一些数据。在这里，我简单地添加了一个文本<code class="fe nm nn no np b">NIKILICIOUS</code>。该文本将被加密，稍后解密。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi os"><img src="../Images/87ba6b02d2dfabe3502b358d02861360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sCVurLqh9Gt97BMij7au2A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">主数据文件</p></figure><p id="db8f" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将通过运行以下命令来运行bash脚本。<br/> <code class="fe nm nn no np b">./Encryption.sh</code></p><p id="b275" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">运行bash脚本后。我们将选择加密选项，并给出一个<code class="fe nm nn no np b">Passkey</code> = 12345。参考下面的截图。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ot"><img src="../Images/3ce043d9bf2809833f25706d64f3817a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_f8zov7GJr7bg6DHeJWMDA.png"/></div></div></figure><p id="4b76" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">按下enter键后，您可以看到数据<code class="fe nm nn no np b">NIKILICIOUS</code>将被加密并保存在名为<code class="fe nm nn no np b">EncryptedDataFile</code>的文件中。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ou"><img src="../Images/bcdc3b2af3994538f28da8be8e4120b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MvwSocIgCNdPery4N9XbuQ.png"/></div></div></figure><p id="9778" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们将解密<code class="fe nm nn no np b">EncryptedDataFile</code>中的加密数据。为此，我们将再次运行bash脚本并选择选项2。</p><p id="e815" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">之后，我们将给出与加密<code class="fe nm nn no np b">12345</code>时相同的密钥值。之后，解密后的值将被存储在<code class="fe nm nn no np b">DecryptedDataFile</code>中。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ov"><img src="../Images/0c1ebdc6bf7e97fbaeb1d6f7afd07b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uxjt5HJsG1U2TuH2X2f-fA.png"/></div></div></figure><p id="4903" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">是啊！！我们已经使用bash脚本成功地完成了加密和解密。我们可以通过在加密过程中添加一个加载器来使外观和感觉更好，这将在下一个故事中介绍。</p><p id="2021" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您可以在下面找到Github链接:</p><div class="ow ox gp gr oy oz"><a href="https://github.com/Nikilicious09/AES256OpenSSL" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ir gy z fp pe fr fs pf fu fw ip bi translated">GitHub-nikilicious 09/AES 256 OpenSSL</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">github.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn kq oz"/></div></div></a></div></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="cf8e" class="pw-post-body-paragraph kx ky iq kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我希望您已经理解了我们如何轻松地创建一个bash脚本来加密和解密数据。</p></div></div>    
</body>
</html>