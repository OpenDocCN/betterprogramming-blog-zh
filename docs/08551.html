<html>
<head>
<title>3 Ways To Access Python Dictionary Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">访问Python字典值的3种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-ways-to-access-python-dictionary-values-e353d0830931?source=collection_archive---------4-----------------------#2021-05-13">https://betterprogramming.pub/3-ways-to-access-python-dictionary-values-e353d0830931?source=collection_archive---------4-----------------------#2021-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="55eb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用Python所提供的灵活性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ecbfe796faa07b43088a3f9338cf438c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I8J3frbbFp6B70JZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sigmund </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="8e39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">字典是我最喜欢的Python数据类型之一。主要原因是它们存储键值对。本质上，它们可以用来保存两类信息，并以匹配的顺序保存相关的项目。</p><p id="50c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，假设我们有下面的字典来存储一些学生的成绩:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dcbe" class="ma mb it lw b gy mc md l me mf">grades = {"Anne": 98, "John": 95, "Bella": 97}</span></pre><p id="0fd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个字典包含以下两组信息:学生(姓名作为关键字)和成绩。此外，每个学生都与自己的年级相关联。</p><p id="ed7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有多种方法可以检索存储在字典中的值。在这篇文章中，我们将谈论它们。更重要的是，我们将讨论最佳实践。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="7fdf" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">下标符号</h1><p id="cf20" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">获取学生成绩的第一种方法是使用下标表示法，如下所示:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="397c" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades["Anne"]<br/>98<br/>&gt;&gt;&gt; grades["John"]<br/>95</span></pre><p id="0854" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法的主要优点是非常简单。如果您在其他语言中使用过字典或类似字典的数据结构，比如JavaScript、Kotlin或Swift，那么您可能对这种方法非常熟悉。因此，当您需要访问字典中的条目时，使用这种方法是非常自然的。</p><p id="9f53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，有一个潜在的问题，如下所示:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7864" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades["Zoe"]<br/>Traceback (most recent call last):<br/>  File "&lt;input&gt;", line 1, in &lt;module&gt;<br/>KeyError: 'Zoe'</span></pre><p id="889b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您试图访问字典中不存在的键时，您会遇到<code class="fe nj nk nl lw b">KeyError</code>异常。当它没有被处理时，你的程序会崩溃。</p><p id="dccf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最佳实践:对你创建的字典或者那些你对关键字有把握的字典使用下标符号。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="0645" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">get方法</h1><p id="0932" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">考虑到下标符号的上述问题，有些人可能尝试了以下解决方案:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="16ec" class="ma mb it lw b gy mc md l me mf">name_to_check = "some name"<br/>if name_to_check in grades:<br/>    grade = grades[name_to_check]<br/>else:<br/>    grade = "A default value"</span></pre><p id="e7ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个解决方案当然有助于避免<code class="fe nj nk nl lw b">KeyError</code>异常，但是有点麻烦。在这种情况下，更好的解决方案是使用字典的<code class="fe nj nk nl lw b">get</code>方法。为了使用<code class="fe nj nk nl lw b">get</code>方法，我们指定了键的名称和一个缺省值，如果这个键不在字典中的话。</p><p id="9751" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码片段展示了一些使用<code class="fe nj nk nl lw b">get</code>的例子:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0b07" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades.get("Anne")<br/>98<br/>&gt;&gt;&gt; grades.get("Zoe", 0)<br/>0<br/>&gt;&gt;&gt; grades.get("Zoe")<br/>None (None is automatically hidden in an interactive console)</span></pre><p id="1204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，当指定的键不在字典中时，<code class="fe nj nk nl lw b">get</code>方法确实提供了不引发<code class="fe nj nk nl lw b">KeyError</code>异常的优势。更重要的是，它允许您在键不存在时设置一个合适的默认值。理论上，无论何时从字典中检索值，都可以使用<code class="fe nj nk nl lw b">get</code>方法，但我更喜欢尽可能使用下标符号，因为我觉得它们可读性更强。</p><p id="91c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在某些情况下,<code class="fe nj nk nl lw b">get</code>方法会非常方便。其中一个场景是当我需要处理函数定义中的变量关键字参数时。假设您正在构建一个Python包，它具有以下API函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a938" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，这个函数非常灵活，除了两个位置参数之外，还支持许多不同的关键字参数。为了清楚起见，我不想在函数定义中列出所有这些关键字参数。毕竟，当API用户忽略这些关键字参数时，我知道我想要设置什么默认值。</p><p id="8024" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">最佳实践:对您不能直接控制的字典使用</em> <code class="fe nj nk nl lw b"><em class="nm">get</em></code> <em class="nm">方法，比如在API函数调用中使用的字典。您将知道在这些情况下什么默认值是合适的。</em></p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="57bf" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">setdefault方法</h1><p id="8ba8" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">当人们谈论<code class="fe nj nk nl lw b">get</code>方法的替代方案时，有些人可能会提到<code class="fe nj nk nl lw b">setdefault</code>方法。这个方法非常类似于<code class="fe nj nk nl lw b">get</code>方法，因为它也接受两个参数:键(必需的)和默认值(可选的)作为后备。当关键字不在字典中时，将返回回退值，而当关键字在字典中时，将返回关键字的值。请注意以下特征:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e766" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades.setdefault("Anne")<br/>98<br/>&gt;&gt;&gt; grades.setdefault("Danny", 0)<br/>0<br/>&gt;&gt;&gt; grades.setdefault("Ashley")<br/>None (None is automatically hidden in an interactive console)</span></pre><p id="d84e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段向您展示了<code class="fe nj nk nl lw b">setdefault</code>方法的行为类似于<code class="fe nj nk nl lw b">get</code>方法的行为。然而，<code class="fe nj nk nl lw b">setdefault</code>与<code class="fe nj nk nl lw b">get</code>的不同之处在于，当您调用<code class="fe nj nk nl lw b">setdefault</code>时，当键不在字典中时，会发生一个额外的操作(<code class="fe nj nk nl lw b">dict[key] = default_value</code>)。观察下面的效果:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4e78" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades<br/>{'Anne': 98, 'John': 95, 'Bella': 97, 'Danny': 0, 'Ashley': None}</span></pre><p id="d602" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们之前用键<code class="fe nj nk nl lw b">“Anne”</code>、<code class="fe nj nk nl lw b">“Danny”</code>和<code class="fe nj nk nl lw b">“Ashley”</code>调用了<code class="fe nj nk nl lw b">setdefault</code>。因为<code class="fe nj nk nl lw b">“Danny”</code>和<code class="fe nj nk nl lw b">“Ashley”</code>在我们调用它们时不在字典中，所以下面两个操作在幕后发生:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d24e" class="ma mb it lw b gy mc md l me mf">grades["Danny"] = 0<br/>grades["Ashley"] = None</span></pre><p id="6a18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，我不推荐使用<code class="fe nj nk nl lw b">setdefault</code>方法。不仅名字容易混淆——我们通常不期望通过调用涉及设置值的方法来返回东西——而且还有一个许多人可能不知道的隐式操作(即，如果键不存在，则设置默认值)。</p><p id="8a37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">最佳实践:避免使用</em> <code class="fe nj nk nl lw b"><em class="nm">setdefault</em></code> <em class="nm">方法。很少需要。</em></p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="2f0c" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">默认选项</h1><p id="e2b2" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在前面的章节中，我们关注了适用于<code class="fe nj nk nl lw b">dict</code>类的解决方案。然而，除了<code class="fe nj nk nl lw b">dict</code>类，还有另一种叫做<code class="fe nj nk nl lw b">defaultdict</code>的字典类型，它是<code class="fe nj nk nl lw b">dict</code>的子类。它在<code class="fe nj nk nl lw b">collections</code>模块中可用。一个例子可以帮助我们理解这个类:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9f16" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; from collections import defaultdict<br/>&gt;&gt;&gt; grades_default = defaultdict(int, grades)<br/>&gt;&gt;&gt; grades_default<br/>defaultdict(&lt;class 'int'&gt;, {'Anne': 98, 'John': 95, 'Bella': 97, 'Danny': 0, 'Ashley': None})</span></pre><p id="f7a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与<code class="fe nj nk nl lw b">dict</code>类构造函数不同，<code class="fe nj nk nl lw b">defaultdict</code>有一个名为<code class="fe nj nk nl lw b">default_factory</code>的参数，这是一个零参数函数，当您访问一个不在字典中的键时会调用这个函数。在我们的示例中，当学生不在字典中时，当您访问学生的成绩时，调用<code class="fe nj nk nl lw b">int</code>来创建零成绩(因为<code class="fe nj nk nl lw b">int()</code>计算为零)。请注意以下特征:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6ea5" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades_default["Lily"]<br/>0</span></pre><p id="dae5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要注意的一点是，<code class="fe nj nk nl lw b">defaultdict</code>的操作类似于<code class="fe nj nk nl lw b">setdefault</code>方法，因为由<code class="fe nj nk nl lw b">default_factory</code>创建的值将被设置为字典中没有的键。例如，在访问<code class="fe nj nk nl lw b">“Lily”</code>的等级后，字典得到更新，如下所示:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cc43" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; grades_default<br/>defaultdict(&lt;class 'int'&gt;, {'Anne': 98, 'John': 95, 'Bella': 97, 'Danny': 0, 'Ashley': None, 'Lily': 0})</span></pre><p id="17ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于<code class="fe nj nk nl lw b">setdefault</code>方法和<code class="fe nj nk nl lw b">defaultdict</code>类之间的相似性，它们可以有以下相似的用法。假设我们想要创建一个dictionary对象，该对象使用学生姓名的首字母作为键，而具有相同首字母的姓名与每个键对应:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9fa6" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu"># Use the setdefault with a dict object</strong><br/>students_by_initial0 = {}<br/>for name in grades.keys():<br/>    group = students_by_initial0.setdefault(name[0], [])<br/>    group.append(name)</span></pre><p id="5952" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段使用了带有<code class="fe nj nk nl lw b">dict</code>对象的<code class="fe nj nk nl lw b">setdefault</code>方法。让我们看看如何用<code class="fe nj nk nl lw b">defaultdict</code>类实现同样的功能:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2bb0" class="ma mb it lw b gy mc md l me mf"># Use the defaultdict class<br/>students_by_initial1 = defaultdict(list)<br/>for name in grades.keys():<br/>    students_by_initial1[name[0]].append(name)</span></pre><p id="222e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以想象，如果相同的功能由一个常规的<code class="fe nj nk nl lw b">dict</code>类实现，中间有一个检查键是否存在的步骤，那么它会更复杂，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="6e1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">最佳实践:当您必须迭代地访问dictionary对象的条目时，使用</em> <code class="fe nj nk nl lw b"><em class="nm">defaultdict</em></code> <em class="nm">类，例如本例中的分组。此外，当缺少一个键时，您应该知道正确的默认值。否则，可以使用</em> <code class="fe nj nk nl lw b"><em class="nm">dict</em></code> <em class="nm">类型。</em></p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="1ebd" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="4e22" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在本文中，我们回顾了访问字典中的值的不同方法，特别关注处理字典中可能不存在键的情况。本质上，这些方法都有自己的使用场景。因此，选择最佳方案实际上取决于您的用例。</p></div></div>    
</body>
</html>