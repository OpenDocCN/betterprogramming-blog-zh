<html>
<head>
<title>React Native and Firebase: Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native和Firebase:身份验证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/react-native-firebase-authentication-7652e1d2c8a2?source=collection_archive---------0-----------------------#2018-04-12">https://betterprogramming.pub/react-native-firebase-authentication-7652e1d2c8a2?source=collection_archive---------0-----------------------#2018-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8bf0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何设置React本机应用程序以使用Firebase</h2></div><p id="532e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也可以作为egghead.io上的视频课程！</p><p id="37ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">使用Firebase对用户进行身份验证</strong></p><p id="d9fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://next.egghead.io/lessons/react-authenticate-a-user-in-react-with-firebase" rel="noopener ugc nofollow" target="_blank">https://next . egghead . io/lessons/react-authenticate-a-user-in-react-with-fire base</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/896af1ce84a53efb54cb301bc3ec2419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkRiGW99Gvu_ebN0Eg54Cg.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@smartphotocourses?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Smart </a>在<a class="ae le" href="https://unsplash.com/s/photos/guide?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="f23a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗨！我是法拉兹。这里有一个快速指南，可以让我们在<a class="ae le" href="https://facebook.github.io/react-native/" rel="noopener ugc nofollow" target="_blank"> React Native </a>中使用<a class="ae le" href="https://firebase.google.com/products/auth" rel="noopener ugc nofollow" target="_blank"> Firebase的认证</a>！</p><p id="6dde" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Firebase提供了许多伟大的产品，让我们能够快速开发移动应用程序；<a class="ae le" href="https://firebase.google.com/docs/database" rel="noopener ugc nofollow" target="_blank">实时数据库</a>、认证、<a class="ae le" href="https://firebase.google.com/docs/firestore" rel="noopener ugc nofollow" target="_blank">云Firestore </a>、<a class="ae le" href="https://firebase.google.com/docs/functions" rel="noopener ugc nofollow" target="_blank">云功能</a>、<a class="ae le" href="https://firebase.google.com/products/crashlytics" rel="noopener ugc nofollow" target="_blank">crash lytics</a>……不一而足。</p><p id="d799" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用电子邮件和密码构建一个简单的身份验证流程。</p><p id="0ccf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们所需要的是一种将Firebase SDK与React原生应用一起使用的方法……感谢创造了<code class="fe lv lw lx ly b">react-native-firebase</code>的<a class="ae le" href="https://github.com/invertase" rel="noopener ugc nofollow" target="_blank">转化酶</a>的可爱的人们，我们已经做到了！这是一个非常棒的开源项目，用于将React本地应用程序与Firebase链接起来。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="9b6e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">设置我们的应用程序</h1><p id="566d" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">既然我们是从零开始，我们可以继续使用react-native-firebase 提供的<a class="ae le" href="https://github.com/invertase/react-native-firebase-starter" rel="noopener ugc nofollow" target="_blank">基本入门套件。</a></p><p id="c459" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(如果你已经有一个现有的应用程序，你可以前往<a class="ae le" href="https://rnfirebase.io" rel="noopener ugc nofollow" target="_blank"> React Native Firebase </a>并遵循手册安装说明。)</p><p id="c28b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">继续按照他们的说明(他们很棒)来启动和运行我们的应用程序，然后在您准备好之后再回来。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="f59f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在Firebase中启用电子邮件和密码验证</h1><p id="a31b" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">按照上面链接的说明操作后，您应该准备好开始了。</p><p id="2eee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我们将要建造的东西的示意图:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b168dc7fc48383af6a205220daebf6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*mJpDhhE-fOLnPzQhpKin4w.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">我们正在建造的流程图</p></figure><p id="71ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了允许用户使用电子邮件和密码组合，我们需要在Firebase控制台中启用这个提供者。</p><p id="c334" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要做到这一点，直接进入您的Firebase项目→身份验证→登录方法。点击<code class="fe lv lw lx ly b">Email/Password</code>并设置为<code class="fe lv lw lx ly b">enabled</code>并保存。您的仪表板应该如下所示:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ne"><img src="../Images/410a390e50f6b0c79346cf1b92d0949d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZMLm2ZinAhpzJemmmh3jQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">启用电子邮件和密码验证</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0b4d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">创建屏幕</h1><p id="e62e" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">如果我们看一下我们的图表，你可以看到我们有四个屏幕:<code class="fe lv lw lx ly b">Loading</code>、<code class="fe lv lw lx ly b">SignUp</code>、<code class="fe lv lw lx ly b">Login</code>和<code class="fe lv lw lx ly b">Main</code>。</p><p id="093e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个<code class="fe lv lw lx ly b">Loading</code>屏幕显示，直到我们确定用户的身份验证状态；一个<code class="fe lv lw lx ly b">SignUp</code>屏幕，用户可以在其中创建帐户；一个<code class="fe lv lw lx ly b">Login</code>屏幕，现有用户可以在其中登录；以及一个<code class="fe lv lw lx ly b">Main</code>屏幕，我们的应用程序只向经过身份验证的用户显示。</p><p id="11bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<code class="fe lv lw lx ly b">react-navigation</code>为我们的应用导航，所以让我们设置我们的导航器并创建我们的屏幕。</p><pre class="lg lh li lj gt nf ly ng nh aw ni bi"><span id="1c55" class="nj mh it ly b gy nk nl l nm nn">yarn add react-navigation</span></pre><p id="183c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们创建我们的屏幕。</p><h2 id="c16c" class="nj mh it bd mi no np dn mm nq nr dp mq kr ns nt ms kv nu nv mu kz nw nx mw ny bi translated"><code class="fe lv lw lx ly b">Loading.js</code></h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="33eb" class="nj mh it bd mi no np dn mm nq nr dp mq kr ns nt ms kv nu nv mu kz nw nx mw ny bi translated"><code class="fe lv lw lx ly b">SignUp.js</code></h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="4b14" class="nj mh it bd mi no np dn mm nq nr dp mq kr ns nt ms kv nu nv mu kz nw nx mw ny bi translated"><strong class="ak"> Login.js </strong></h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="eb6b" class="nj mh it bd mi no np dn mm nq nr dp mq kr ns nt ms kv nu nv mu kz nw nx mw ny bi translated"><strong class="ak"> Main.js </strong></h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="a212" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经创建了所有的屏幕，让我们在<code class="fe lv lw lx ly b">App.js</code>文件中连接导航。</p><h2 id="b7aa" class="nj mh it bd mi no np dn mm nq nr dp mq kr ns nt ms kv nu nv mu kz nw nx mw ny bi translated"><strong class="ak"> App.js </strong></h2><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="cfc9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们启动我们的应用程序，您应该会看到我们的<code class="fe lv lw lx ly b">Loading</code>屏幕和永远旋转的<code class="fe lv lw lx ly b">ActivityIndicator</code>。这是我们所期望的，因为我们需要确定用户是否经过身份验证，以确定将他们路由到哪里。</p><p id="db58" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果用户通过验证，将他们发送到<code class="fe lv lw lx ly b">Main</code>屏幕。否则，将它们发送到<code class="fe lv lw lx ly b">SignUp</code>屏幕。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4c0f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">确定用户是否通过身份验证</h1><p id="30a6" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">我们可以使用Firebase来确定用户的身份验证状态。让我们在<code class="fe lv lw lx ly b">Loading</code>屏幕上添加一项检查，以确定用户是否登录。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="b2ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用Firebase的<code class="fe lv lw lx ly b">onAuthStateChanged</code>监听器来获取用户的当前身份验证状态。如果它们被认证，我们就把它们发送到<code class="fe lv lw lx ly b">Main</code>屏幕。否则，我们将它们发送到<code class="fe lv lw lx ly b">SignUp</code>屏幕。</p><p id="fe50" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，由于我们没有登录，您应该会短暂地看到<code class="fe lv lw lx ly b">Loading</code>屏幕，然后转到<code class="fe lv lw lx ly b">SignUp</code>屏幕。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="9e04" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">注册用户</strong></h1><p id="63fb" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">我们需要创建一个新用户，这样我们就可以让他们登录了！让我们前往<code class="fe lv lw lx ly b">SignUp</code>屏幕，连接我们的<code class="fe lv lw lx ly b">handleSignUp</code>方法。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="96e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当用户提交表单时，我们使用<code class="fe lv lw lx ly b">createUserWithEmailAndPassword</code>，然后将他们导航到<code class="fe lv lw lx ly b">Main</code>屏幕。如果有错误，我们会捕捉并显示它。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b9eb" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在主屏幕上显示当前用户</h1><p id="7ca1" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">在我们当前的实现中，如果用户登录，我们将只能看到<code class="fe lv lw lx ly b">Main</code>屏幕。我们需要从Firebase获取<code class="fe lv lw lx ly b">currentUser</code>，这样我们就可以显示他们的电子邮件。让我们更新我们的<code class="fe lv lw lx ly b">Main</code>屏幕来处理这个问题。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0cb6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，当我们看到<code class="fe lv lw lx ly b">Main</code>屏幕时，我们应该会看到用户的电子邮件地址。如果我们刷新应用程序，我们应该会自动转到<code class="fe lv lw lx ly b">Main</code>屏幕，因为我们已经通过了身份验证。</p><p id="2268" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后一步是，我们应该能够登录一个用户后，我们已经创建了一个帐户！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3f98" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在中记录已存在的用户</h1><p id="181f" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">最后冲刺！让我们更新我们的<code class="fe lv lw lx ly b">Login</code>屏幕，以便我们可以使用现有帐户登录。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0814" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太棒了。</p><p id="81f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在有了一个用React Native和Firebase设置的简单身份验证流程。如果你想访问完整的源代码，我已经把它上传到了GitHub。</p><p id="988b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读！</p></div></div>    
</body>
</html>