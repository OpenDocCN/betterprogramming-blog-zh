<html>
<head>
<title>Map a JSON File to Enum in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Java将JSON文件映射到Enum</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/map-a-json-file-to-enum-in-java-d399bac0759d?source=collection_archive---------3-----------------------#2019-08-16">https://betterprogramming.pub/map-a-json-file-to-enum-in-java-d399bac0759d?source=collection_archive---------3-----------------------#2019-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="59a9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以瑞士奶酪为例的循序渐进教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/047080cfc336fa3ad4b951f739cb3c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qSYqGVlUNNhJgsYDxenv9A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更多关于法国AOP的信息请见<a class="ae ky" href="https://www.myswitzerland.com/en-ch/experiences/food-wine/le-gruyere-aop/" rel="noopener ugc nofollow" target="_blank">MySwitzerland.com</a></p></figure><p id="2ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近为一个回访客户启动了一个新的Java项目。我的首要任务之一是实现一个新特性，目标是使用JSON属性文件使应用程序可全局配置。</p><p id="d7aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我发现由此产生的解决方案相对方便，所以我想我会在一篇新的博客文章中分享它。此外，由于到目前为止我还没有写过任何Java博客，我觉得这很有挑战性，也很有趣。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="98b2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="e57e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我们将:</p><ol class=""><li id="1fd9" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">创建新项目。</li><li id="a891" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">读取JSON文件和属性。</li><li id="42ad" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">创建枚举。</li><li id="3197" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">将属性映射到泛型枚举。</li></ol><p id="3a01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:如果你已经有了一个项目，你显然可以跳过第一章的目标是创建一个项目。同样，如果您不想使用<a class="ae ky" href="https://maven.apache.org/" rel="noopener ugc nofollow" target="_blank"> Maven </a>，也可以跳过它，按照您的设置要求包含我们将要使用的库。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0a79" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建新项目</h1><p id="f996" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">首先，我们将使用<a class="ae ky" href="https://maven.apache.org" rel="noopener ugc nofollow" target="_blank"> Maven </a>初学者工具包创建一个新项目。为此，在终端中运行以下命令:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c9d7" class="ns md it no b gy nt nu l nv nw">$ mvn archetype:generate -DgroupId=com.jsontoenum.app -DartifactId=json-to-enum -DarchetypeArtifactId=maven-archetype-quickstart -DarchetypeVersion=1.4 -DinteractiveMode=false</span></pre><p id="3aad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切顺利，您现在应该能够正确无误地进入目录来编译项目了:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="9a11" class="ns md it no b gy nt nu l nv nw">$ cd json-to-enum/ &amp;&amp; mvn package</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dce9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">读取JSON文件和属性</h1><p id="7e5c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">起初，我实现了一个快速定制的解决方案，但是我对结果一点也不满意。这就是为什么我试图在网上寻找现成的解决方案，找到了不可思议的开源库，<a class="ae ky" href="https://github.com/lightbend/config" rel="noopener ugc nofollow" target="_blank"><em class="nx">com . types safe . config</em></a>。</p><p id="378e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它利用了读取JSON文件和访问其属性的所有工作，没有依赖性，甚至与Java 8兼容。</p><p id="0393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至少这一次，用谷歌搜索解决方案是个好主意。</p><p id="1dd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用这个库，让我们将这个库的新依赖项添加到我们的<code class="fe ny nz oa no b">pom.xml</code>:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f18a" class="ns md it no b gy nt nu l nv nw">&lt;dependency&gt;<br/>    &lt;groupId&gt;com.typesafe&lt;/groupId&gt;<br/>    &lt;artifactId&gt;config&lt;/artifactId&gt;<br/>    &lt;version&gt;1.3.4&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="4e49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们还应该将下面的<code class="fe ny nz oa no b">&lt;resources/&gt;</code>和<code class="fe ny nz oa no b">&lt;plugins/&gt;</code>目标添加到我们的<code class="fe ny nz oa no b">&lt;build/&gt;</code>中，以便能够加载JSON文件(我们将要创建的)并将我们刚刚引用的依赖项打包到我们的JAR文件中。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c66c" class="ns md it no b gy nt nu l nv nw">&lt;resources&gt;<br/>  &lt;resource&gt;<br/>    &lt;directory&gt;src/resources&lt;/directory&gt;<br/>  &lt;/resource&gt;<br/>&lt;/resources&gt;<br/><br/>&lt;plugins&gt;<br/>  &lt;plugin&gt;<br/>    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;<br/>    &lt;version&gt;3.2.0&lt;/version&gt;<br/>    &lt;executions&gt;<br/>      &lt;execution&gt;<br/>        &lt;phase&gt;package&lt;/phase&gt;<br/>        &lt;goals&gt;<br/>          &lt;goal&gt;shade&lt;/goal&gt;<br/>        &lt;/goals&gt;<br/>      &lt;/execution&gt;<br/>    &lt;/executions&gt;<br/>  &lt;/plugin&gt;<br/>&lt;/plugins&gt;</span></pre><p id="66cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们大楼终于建好了。我们现在可以继续下一步，创建我们的JSON属性文件。</p><p id="1fde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，配置库会尝试加载一个名为<code class="fe ny nz oa no b">application.json</code>的文件作为属性的源。</p><p id="ce59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，让我们保持简单，使用预定义的名称在新文件夹<code class="fe ny nz oa no b">src/resources/</code>中创建这个新文件，包含以下JSON内容:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c67e" class="ns md it no b gy nt nu l nv nw">{<br/>  "swiss": {<br/>    "cheese": "gruyere"<br/>  }<br/>}</span></pre><p id="6a39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">万事俱备，该编码了。</p><p id="b6a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以修改我们的应用程序(文件夹<code class="fe ny nz oa no b">src/main/java/com/jsontoenum/app</code>中的<code class="fe ny nz oa no b">App.java</code>)来初始化和加载JSON文件的属性，并打印出我们最喜欢的奶酪类型的名称。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="6ec2" class="ns md it no b gy nt nu l nv nw">package com.jsontoenum.app;<br/><br/>import com.typesafe.config.Config;<br/>import com.typesafe.config.ConfigFactory;<br/><br/>public class App {<br/>   public static void main(String[] args) {<br/>       // Load and init the configuration library<br/>      final Config conf = ConfigFactory.<em class="nx">load</em>();<br/><br/>      // Get the value of the JSON property<br/>      final String cheese = conf.getString("swiss.cheese");<br/><br/>      System.<em class="nx">out</em>.println(String.<em class="nx">format</em>("I like %s 🧀", cheese));<br/>   }<br/>}</span></pre><p id="036e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们编译所有内容，并在终端中使用以下命令行运行我们的项目，以测试我们的实现:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="fe51" class="ns md it no b gy nt nu l nv nw">$ mvn package &amp;&amp; java -cp target/json-to-enum-1.0-SNAPSHOT.jar com.jsontoenum.app.App</span></pre><p id="5164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切正常，您的控制台输出应该在堆栈跟踪的末尾显示以下内容:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="a40d" class="ns md it no b gy nt nu l nv nw">[INFO] -------------------------------------------------------------<br/>[INFO] BUILD SUCCESS<br/>[INFO] -------------------------------------------------------------<br/>[INFO] Total time:  2.179 s<br/>[INFO] Finished at: 2019-08-16T15:04:35+02:00<br/>[INFO] -------------------------------------------------------------<br/>I like gruyere 🧀</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7a37" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建枚举</h1><p id="8136" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">即使能够读取JSON属性已经很酷了，但在开发我的指定特性时，我很快意识到，如果应用程序应该相应地有不同的行为，那么将属性映射到enum可能是强制性的。</p><p id="716a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，瑞士生产不止一种奶酪。</p><p id="bf86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，作为我们的下一步，我们可以在文件夹<code class="fe ny nz oa no b">src/main/java/com/jsontoenum/app/</code>中创建一个enum，它可以列出该国法语区的一些奶酪:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8486" class="ns md it no b gy nt nu l nv nw">package com.jsontoenum.app;<br/><br/>public enum Cheese {<br/><br/>   <em class="nx">GRUYERE</em>,<br/>   <em class="nx">TETE_DE_MOINE</em>,<br/>   <em class="nx">CHAUX_DABEL</em>,<br/>   <em class="nx">RACLETTE</em>,<br/>   <em class="nx">VACHERIN</em>,<br/>   <em class="nx">TOMME<br/><br/></em>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9f64" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">将属性映射到通用枚举</h1><p id="8c87" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我们使用奶酪作为演示，但显然，瑞士出口许多其他产品，如巧克力和手表。</p><p id="e912" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我正在开发的应用程序不仅仅包含一个枚举。这就是为什么我们不仅添加了一个方法来解析单一类型枚举的属性，而且在我们的应用程序中将其声明为泛型(<code class="fe ny nz oa no b">App.java</code>)。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8f94" class="ns md it no b gy nt nu l nv nw">private static &lt;E extends Enum&lt;E&gt;&gt; E getEnumProperty(final Config conf, final String key, final Class&lt;E&gt; myClass) {<br/>    // If no config loaded<br/>    if (conf == null) {<br/>        return null;<br/>    }<br/><br/>    // If the config doesn't contains the key<br/>    if (!conf.hasPath(key)) {<br/>        return null;<br/>    }<br/><br/>    // As previously, load the key value<br/>    final String keyValue = conf.getString(key);<br/><br/>    // Does the property has a value<br/>    if (keyValue == null || keyValue.isEmpty()) {<br/>        return null;<br/>    }<br/><br/>    // Map the property to the ENUM<br/>    return Enum.<em class="nx">valueOf</em>(myClass, keyValue.toUpperCase());<br/>}</span></pre><p id="3c92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，对于最后的测试，让我们通过加载enum来增强我们的<code class="fe ny nz oa no b">main</code>方法，并测试它来显示奶酪是否是我们最喜欢的:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="bec3" class="ns md it no b gy nt nu l nv nw">public static void main(String[] args) {<br/>    // Load and init the configuration library<br/>   final Config conf = ConfigFactory.<em class="nx">load</em>();<br/><br/>   // Get the value of the JSON property<br/>   final Cheese cheese =<br/>                <em class="nx">getEnumProperty</em>(conf, "swiss.cheese", Cheese.class);<br/><br/>   if (Cheese.<em class="nx">GRUYERE</em>.equals(cheese)) {<br/>       System.<em class="nx">out</em>.println(String.<em class="nx">format</em>("I really like %s 🧀", cheese));<br/>   } else {<br/>       System.<em class="nx">out</em>.println(String.<em class="nx">format</em>("%s is ok", cheese));<br/>   }<br/>}</span></pre><p id="a791" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧，就是这样，不多不少。</p><p id="aedd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以尝试使用前面的命令行运行我们的项目，如果一切按计划进行，输出应该如下所示:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="b86b" class="ns md it no b gy nt nu l nv nw">[INFO] -------------------------------------------------------------<br/>[INFO] BUILD SUCCESS<br/>[INFO] -------------------------------------------------------------<br/>[INFO] Total time:  2.437 s<br/>[INFO] Finished at: 2019-08-16T15:43:42+02:00<br/>[INFO] -------------------------------------------------------------<br/>I really like GRUYERE 🧀</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="707d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">蛋糕上的樱桃🍒🎂</h1><p id="b70f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果你想避免创建自己的项目和复制上述代码的麻烦，我已经在网上发布了该项目，请便。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d367" class="ns md it no b gy nt nu l nv nw">$ git clone https://github.com/peterpeterparker/json-to-enum.git</span></pre><p id="7278" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到无限和更远🚀</p><p id="3e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大卫</p></div></div>    
</body>
</html>