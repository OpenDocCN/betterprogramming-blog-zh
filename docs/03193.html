<html>
<head>
<title>Transform Data in Pure Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用纯Python转换数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/transform-data-in-pure-python-6d82e0ee3544?source=collection_archive---------18-----------------------#2020-01-27">https://betterprogramming.pub/transform-data-in-pure-python-6d82e0ee3544?source=collection_archive---------18-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="32e3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不需要外部库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/01809e585cc49be2aa4aafbe6f962e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y-yj3iI9UQHfUMur"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="cd90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开发人员经常选择Python来编写数据转换。凭借其庞大的第三方软件包生态系统，功能可以快速集成。</p><p id="c06a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在处理大数据时，像<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>、<a class="ae ky" href="https://spark.apache.org/docs/latest/api/python/index.html" rel="noopener ugc nofollow" target="_blank"> PySpark </a>、<a class="ae ky" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>、<a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和<a class="ae ky" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>这样的库允许您快速操作和转换数据。</p><p id="57ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果您有少量数据，几百条记录，甚至一千条记录，该怎么办呢？需要使用外部库吗？</p><p id="8909" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并非所有时候，Python都有简单的内置方法来帮助转换数据。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6e59" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">列出理解</h1><p id="728f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">列表理解是一个很好的内置特性，具有简洁的数据转换语法。</p><p id="9d56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有列表理解，假设您想要生成一个5行5列的数据结构，您将需要使用如下的<code class="fe mz na nb nc b">for</code>循环。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2dfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是六行代码，不算太糟。如果你能在一行中做同样的事情会怎么样？</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="7294" class="nj md it nc b gy nk nl l nm nn">[[randint(0, 10) for y in range(5)] for x in range(5)]</span></pre><p id="8a3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面这一行要简洁得多，它消除了收集和添加条目到列表中的需要。实际上有两种理解:</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="cd35" class="nj md it nc b gy nk nl l nm nn"># Collects rows<br/>[&lt;row&gt; for x in range(5)]</span><span id="84ee" class="nj md it nc b gy no nl l nm nn"># Builds each row<br/>[randint(0, 10) for y in range(5)]</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="925d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">过滤数据</h1><p id="03c3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">上面的代码是一个转换数据的例子。它将两个范围语句转换成一个5x5的数据矩阵。列表理解也可以使用条件来进一步转换数据。</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="ef39" class="nj md it nc b gy nk nl l nm nn"># Select columns 0, 1, 3<br/>[[column for x, column in enumerate(row) if x in (0, 1, 3)] for row in data]</span></pre><p id="f1d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的行从每行中选择第0、1和3列，并构建一个新的矩阵。再一次，它实际上是两个列表理解。</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="e3cb" class="nj md it nc b gy nk nl l nm nn"># Row iterator<br/>[&lt;row&gt; for row in data]</span><span id="6734" class="nj md it nc b gy no nl l nm nn"># Transforms row<br/>[[column for x, column in enumerate(row) if x in (0, 1, 3)]</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8e95" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">词典释义</h1><p id="4d2a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">字典也可以用理解来构造。以下逻辑将创建基于列的数据视图，键是列号，值是列值。</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="5252" class="nj md it nc b gy nk nl l nm nn"># Assumes all rows have the same number of columns<br/>columns = {i: [row[i] for row in data] for i in range(len(data[0]))}</span></pre><p id="b6b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个例子像前面的例子一样遍历一个列表，但是它增加了一个新的变化。每次迭代都构建一个键值对，而不是只有一个表达式。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0c10" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">运行示例</h1><p id="a22a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">以下是所讨论功能的完整示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例代码</p></figure><p id="a7d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将生成以下输出:</p><pre class="kj kk kl km gt nf nc ng nh aw ni bi"><span id="9393" class="nj md it nc b gy nk nl l nm nn">Row view:<br/>[[1, 2, 4, 7, 8],<br/> [1, 0, 0, 5, 2],<br/> [0, 0, 2, 3, 12],<br/> [1, 0, 0, 5, 14],<br/> [1, 1, 1, 7, 3]]</span><span id="2781" class="nj md it nc b gy no nl l nm nn">Column view:<br/>{0: [1, 1, 0, 1, 1],<br/> 1: [2, 0, 0, 0, 1],<br/> 2: [4, 0, 2, 0, 1],<br/> 3: [7, 5, 3, 5, 7],<br/> 4: [8, 2, 12, 14, 3]}</span><span id="7039" class="nj md it nc b gy no nl l nm nn">Stats:<br/>Column 0, min=0.00, max=1.00, mean=0.80, stdev=0.45<br/>Column 1, min=0.00, max=2.00, mean=0.60, stdev=0.89<br/>Column 2, min=0.00, max=4.00, mean=1.40, stdev=1.67<br/>Column 3, min=3.00, max=7.00, mean=5.40, stdev=1.67<br/>Column 4, min=2.00, max=14.00, mean=7.80, stdev=5.31</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ce28" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="9a2d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python已经内置了很多语言。</p><p id="36e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用pandas和NumPy这样的库，所有讨论的功能都变得非常简单。但是，如果您有一个小项目和/或希望限制对第三方的依赖，这并不总是必要的。</p><p id="6f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用纯Python也是个不错的选择。</p></div></div>    
</body>
</html>