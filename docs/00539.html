<html>
<head>
<title>Swift — Creating a Dynamic Popover Card View</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift —创建动态Popover卡视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swift-create-a-dynamic-popover-card-view-d6f274be0c6b?source=collection_archive---------1-----------------------#2019-06-07">https://betterprogramming.pub/swift-create-a-dynamic-popover-card-view-d6f274be0c6b?source=collection_archive---------1-----------------------#2019-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="797c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在你的iOS应用中实现可拖动的弹出窗口</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/120c6efaf1f33a6558dcf68526cbe0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-R300vZIumTff5_JU7l16Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">IOS语音备忘录应用</p></figure><p id="6a17" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">iOS 12中的很多系统应用，比如语音备忘录，都包含了可拖动的弹出式视图。这些视图允许用户扩展或隐藏前景中的信息，同时模糊背景中的信息。在iOS 12中，没有内置的框架来支持这些视图，尽管它们在系统应用程序中很常见。然而，一旦实现，这些视图不仅易于使用，而且对于一个完美的iOS应用程序是必不可少的。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/676a2d5f2ea5e83986826f73199ec843.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/1*l3fMxXEZtDM4omAbKWp2Vg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">弹出视图</p></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="f57a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置视图</h1><p id="71f8" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">首先，创建一个新的XIB视图和名为CardViewController的UIViewController，这可以通过在创建新的视图控制器时选择“同时创建XIB文件”来实现。这些将用于设置卡片视图的故事板和代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/420a42aabda6a7a9a243666de54b1118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7e1eh-TYQILEFC52nKDUA.png"/></div></div></figure><p id="2396" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">CardViewController视图大小需要设置为freeform，这样它就可以在不继承IOS设备属性的情况下作为独立视图调整大小。文件所有者类也被设置为CardViewController，并且文件所有者视图被连接到UIView。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/532a3728fdb73c45f9b40f70956e2701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzfxq5yXVd7X2TNcni5qQg.jpeg"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/67b5d0f955e3f609a4d5a1d3478a20c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*zWcGkk5XKw3qCkqTK7H7ag.png"/></div></figure><p id="6356" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该视图是用连接到ViewController的HandleView设置的，并将用于调整视图的大小。出于所需目的，可以将任何其他对象添加到视图中。在我们的示例中，将使用两个盒子来演示弹出器:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/839632145efdd0dbda6f8ab8eb1a1718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NC84_0dEpUA2SV46W_VkA.png"/></div></div></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="0a3e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置主视图控制器</h1><p id="0886" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">在主ViewController类中，设置了卡片视图，并使用一个枚举在卡片视图的折叠和展开状态之间切换。卡片的下一个状态由next state变量决定，这将用于展开或折叠卡片。设置的其他属性和变量包括CardViewController、UIVisualEffectsView和UIViewPropertyAnimator数组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="4476" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，在主视图控制器中设置XIB视图，使用视图的高度确定开始和结束卡片的高度。子视图以编程方式添加到视图的底部，并添加视觉效果视图。</p><p id="8584" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击和平移手势识别器被添加到CardViewController的句柄区域。点击手势的功能是识别手柄何时被触摸，并在需要时通知卡片激活。平移手势识别器检测被拖动的手柄区域，并相应地将卡片动画调整为扩展的卡片大小的一部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="c552" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">设置动画</h1><p id="98e9" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">popover视图使用UIViewPropertyAnimator进行动态动画。其工作原理是使用平移手势识别器来确定弹出框完成了多少，并将其转换为百分比，以便动画可以根据弹出框完成的程度进行更新。通过使用点击识别器，当释放时，弹出框会吸附到位。该动画将线性动画用于弹出效果，将弯曲动画用于弹出的圆角。使用的代码可以在下面或者GitHub库中看到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="0f8c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">开源代码库</h1><div class="nc nd gp gr ne nf"><a href="https://github.com/henry-goodwin/Popover-View" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">亨利-古德温/波普沃-观点</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">在GitHub上创建一个帐户，为henry-goodwin/Popover-View开发做出贡献。</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">github.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt kp nf"/></div></div></a></div></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="a256" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">资源</h1><div class="nc nd gp gr ne nf"><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_pan_gestures" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">处理平移手势</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">每当用户在屏幕上移动一个或多个手指时，都会出现平移手势。屏幕边缘平移手势是一种…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">developer.apple.com</p></div></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_tap_gestures" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">处理点击手势| Apple开发者文档</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">点击手势检测一个或多个手指短暂触摸屏幕。这些手势所涉及的手指不得…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">developer.apple.com</p></div></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">UIViewPropertyAnimator</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">声明一个UIViewPropertyAnimator对象可以让你动态的修改视图和动态的修改你的动画…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">developer.apple.com</p></div></div></div></a></div></div></div>    
</body>
</html>