<html>
<head>
<title>Build a SwiftUI watchOS Weather App for an Existing iOS Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为现有的iOS应用程序构建SwiftUI watchOS天气应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/adding-a-watch-app-to-your-existing-ios-application-xcode-13-d229dd9422c5?source=collection_archive---------2-----------------------#2021-12-27">https://betterprogramming.pub/adding-a-watch-app-to-your-existing-ios-application-xcode-13-d229dd9422c5?source=collection_archive---------2-----------------------#2021-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="acae" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将watchOS目标添加到现有iOS项目中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bafd7c6b6b786b01d5bdf26c3c8a0b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e0pZGBM7lVdHa6T1"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@raagesh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Raagesh C </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9e4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该演示将继续建立在之前的<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/simple-weather-app-with-swiftui-ac41200a9d4d">文章</a>中创建的应用之上。</p><p id="0f21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一部分，我们将:</p><ul class=""><li id="e1e7" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在我们现有的iOS项目中创建一个新的watchOS目标。</li><li id="4045" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在手表上运行现有的应用程序</li><li id="3fbf" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">使用iPhone和手表模拟器在Xcode上启动并运行应用程序</li></ul><p id="c1d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和以前一样，我在这个演示中使用Xcode13.2。</p><h1 id="780c" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">向现有iOS项目添加watchOS目标</h1><p id="b049" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我们将从第1部分的<a class="ae kv" href="https://medium.com/@bahalek/simple-weather-app-with-swiftui-ac41200a9d4d" rel="noopener">处开始。所以在Xcode中打开你的项目。</a></p><p id="f4e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要将WatchOS目标添加到项目中:</p><ol class=""><li id="c4fb" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nd ly lz ma bi translated">选择文件-&gt;新建-&gt;目标</li><li id="8f79" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nd ly lz ma bi translated">在“模板”窗口中，从WatchOS标签中选择“iOS应用程序的观察应用程序”,然后点按“下一步”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/c5f6c1b4795047f2ffaa3675aa593f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ko1hS3sXSnNyN-4nmSax9g.png"/></div></div></figure><p id="c9a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.选择产品名称，然后单击“完成”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/7adfc8473f3032aaefd9c6c8cf5112ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUUn7GESz_cmrEiXk54aGQ.png"/></div></div></figure><p id="8ed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.在下一个询问您是否要激活WatchApp复杂功能方案的弹出窗口中，请随意选择“取消”,因为我们不会在本教程中使用它。</p><p id="6369" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成这些步骤后，您应该得到下面的项目结构和添加的新文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/a47fe0c58d20524bf27eb237fcb478d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XVtxxx-wZVJmJBXaKMbdmg.png"/></div></div></figure><h1 id="20bd" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">在手表上运行您的应用</h1><p id="7622" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">从手表应用目标中删除<code class="fe nf ng nh ni b">WeatherAppApp.swift</code>和<code class="fe nf ng nh ni b">ContentView.swift</code>文件，因为我们将重用iOS应用中的文件。</p><p id="ed91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了能够在两个目标之间共享文件，选择<code class="fe nf ng nh ni b">WeatherAppApp.swift</code>、<code class="fe nf ng nh ni b">ContentView.swift</code>、<code class="fe nf ng nh ni b">WeatherModel.swift</code>、<code class="fe nf ng nh ni b">WeatherAPIClient.swift</code>，并从文件检查器选项卡将它们添加到<code class="fe nf ng nh ni b">WeatherWatchApp</code> WatchKit扩展中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/c71364f9bba4d411cb69ac0d42ae5a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AEGQp_CMY8ER-QL6YE1Bmw.png"/></div></div></figure><p id="ede4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你运行新创建的<code class="fe nf ng nh ni b">WeatherWatchApp</code>方案，你会看到Xcode会自动将一个电话模拟器附加到你的手表模拟器上。</p><p id="8644" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想将手表连接到特定的模拟器，您可以通过“窗口-&gt;设备和模拟器”来完成。</p><p id="211f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择您喜欢的模拟器，点击配对手表窗格上的+图标，添加手表模拟器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/f5a93a6a6ca24e1a21a5da8feb14d854.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iPy9z-VeJXx5DJNcTmNh7A.png"/></div></div></figure><p id="8f40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您不想在运行手表应用程序时总是启动手机模拟器，请选择您的手表应用程序扩展目标，并在“通用设置”中选择“支持在不安装iOS应用程序的情况下运行”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/b54a7ca6e4bad769a933b8c8b217859b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1OOniDqG4StUfN66Foz7w.png"/></div></div></figure><p id="7d7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你现在运行<code class="fe nf ng nh ni b">WeatherWatchApp</code>方案，你会看到它只在手表模拟器上启动，而不会在手机模拟器上安装应用。</p><p id="7901" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，您会看到您将进入默认屏幕<em class="nk">(下图中)</em>，因为该应用程序尚未启用位置权限。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/8d4b957c6834904e31b55660f5b3c703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2oOV_zDq73wX99tMnYCBjA.png"/></div></div></figure><p id="a995" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要启用watch应用程序的位置权限，请将与iOS应用程序目标相同的位置跟踪权限添加到watch应用程序扩展目标，如下所示，下次运行应用程序时，您应该会看到应用程序要求您启用位置服务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/97f21e133bc8bec47cd5405c1f9ed863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5yfq6oXmvXjZuibBE--Dw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/e77ab83ef67a0bae5dd9b19f9f865e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGorS0zXRC2VKdelhbvDGg.png"/></div></div></figure><p id="6db6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了确保UI适合手表，更新<code class="fe nf ng nh ni b">ContentView.swift</code>文件以将主<code class="fe nf ng nh ni b">VStack</code>包装在<code class="fe nf ng nh ni b">ScrollView</code>中，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/347181f8b12e78e071c89ae5158bc9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJ8E-_ev9AurP2TJe1gDrg.png"/></div></div></figure><h1 id="116a" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="20af" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">现在你有了一个既能在Apple watch上运行又能在iPhone上运行的应用程序。</p><p id="339d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" href="https://medium.com/@bahalek/sending-data-between-watchos-and-ios-apps-cf924e21b3c2" rel="noopener">下一部分</a>中，我将介绍如何建立手表连接，以便在iPhone和手表之间来回发送数据，从而更新用户界面并显示通知。</p><p id="28ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">编码快乐！</p></div></div>    
</body>
</html>