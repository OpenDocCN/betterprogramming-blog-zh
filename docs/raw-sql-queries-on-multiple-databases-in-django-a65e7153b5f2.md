# 如何在 Django 的多个数据库上执行原始 SQL 查询

> 原文：<https://betterprogramming.pub/raw-sql-queries-on-multiple-databases-in-django-a65e7153b5f2>

## 建立到多个现有数据库的连接，执行 SQL 查询，无需 Django 模型和迁移

![](img/a5063f55f56579fa2d800b39749a44e7.png)

尝试将我的 Django 应用程序与预先存在的数据库一起使用有点困难。没有模型和序列化器的 Django 有点难以想象。但是有时，如果我们需要通过排除 Django ORM 和 serializer 功能来创建一个具有多个现有数据库的 Django 项目，我们可以定义原始 SQL 查询来从数据库中获取和插入数据。

多数据库配置和原始 SQL 查询实现的基本步骤如下。

# 在 Django 设置文件中定义数据库连接

首先，我们需要在 Django 设置文件中定义数据库配置，如代码所示。这里，我在本地连接了两个多个 Postgres 数据库。您可以使用数据库配置定义现有数据库；您不需要运行迁移或创建模型。

# 连接到多个数据库并返回数据帧作为响应的函数

现在，在数据库连接之后，我们使用 Django 内置函数导入数据库连接，并为每个数据库创建一个游标。游标用于直接执行原始 SQL 查询，从数据库中提取数据。我执行了原始 SQL 查询，并将该数据转换为 [panda 的](https://pandas.pydata.org/pandas-docs/stable/reference/frame.html)数据框，以便将数据转换为所需的格式。

这里，我为两个数据库定义了两个游标。有两个独立的函数，因此返回数据框是来自不同数据库的 API 响应，如游标中定义的那样。

# **结论**

我们在 Django 设置文件中定义了数据库连接。我们用不同的游标连接数据库，并在这些连接上执行原始 SQL 查询。查询结果随后被转换为 pandas 数据框，因此可以轻松地操作数据并将其转换为所需的响应格式。

我希望这篇文章对你有所帮助。感谢阅读！