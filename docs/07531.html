<html>
<head>
<title>A Complete Alexa Skill to Play Multi-Track Audio From YouTube Videos</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个完整的Alexa技能，从YouTube视频播放多轨音频</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-complete-alexa-skill-to-play-multi-track-audio-from-youtube-videos-9518d5219aa?source=collection_archive---------9-----------------------#2021-01-25">https://betterprogramming.pub/a-complete-alexa-skill-to-play-multi-track-audio-from-youtube-videos-9518d5219aa?source=collection_archive---------9-----------------------#2021-01-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0834" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从YouTube到您的Alexa Echo播放、暂停、继续、下一个、上一个和循环播放音频</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6dda129c7a2cd8289a4da53a9d791fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xB0C2D6lgtI0A_CBzJ98nQ.jpeg"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="51d9" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">介绍</h1><p id="bbd9" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">在我之前的<a class="ae mp" href="https://medium.com/better-programming/how-to-play-youtube-audio-from-your-alexa-e2d4fb8b5ce9" rel="noopener">文章</a>中，我创建了一个定制的Alexa技能，可以从YouTube视频中播放一个音轨到你的Alexa Echo中。在这篇文章中，我将展示如何将单音轨技能增强到一个完整的音频播放器，以播放、停止、恢复、跳过、循环和播放YouTube上的下一个相关音轨。</p><p id="7117" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果你还没有体验过这种单曲技巧，我建议你先阅读上一篇文章，然后再阅读这个增强版。</p><p id="500c" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">注意:记住这个技能不会在亚马逊商店发布，只能在开发模式下使用。这不是亚马逊认可的技能，只能用于教育目的。</p><p id="eb29" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在本文的结尾，您可以找到完整的源代码和测试脚本。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="88e9" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">技能流</h1><p id="0749" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我将使用一个类似于单音轨技能的流程，为音频播放器控制添加状态管理和额外的意图。会话状态存储在AWS DynamoDB中，跟踪播放列表和设置，允许用户暂停、继续、向前跳、向后跳和启用循环。</p><p id="65ec" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">这是要开发的自定义技能流程:</p><ul class=""><li id="932a" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">当技能启动时，它会检查是否已经有一个打开的会话。</li><li id="5b7b" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">如果有一个打开的会话，它将询问用户是否想要继续播放。</li><li id="a3ca" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">如果没有当前会话，它将播放欢迎消息，并期望视频查询名称来搜索音频文件。</li><li id="854a" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">用户可以随时要求播放视频。</li><li id="cfea" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">YouTube轨道音频将开始播放。</li><li id="d7e8" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">曲目结束时，将播放下一段相关音频。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/582759dfc013da6cc0ac788eaba26d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsaV1mEKWuliM7zp6m0rmg.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">Alexa技能流程—欢迎</p></figure><p id="da56" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">当音频播放时，用户可以给Alexa附加命令:</p><ul class=""><li id="90b1" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><strong class="lv iu">暂停</strong>音频<strong class="lv iu">恢复</strong>再次开始播放</li><li id="9c94" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><strong class="lv iu">播放下一首</strong>播放下一首相关音频，<strong class="lv iu">播放上一首</strong>播放上一首曲目</li><li id="8d47" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">打开<strong class="lv iu">循环打开</strong>重复音频，关闭<strong class="lv iu">循环关闭</strong>禁用重复(默认选择)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/57170f08985b244528020b9e6d98df0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEgS83AYQroIpUdcHRsfVA.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">Alexa技能流程—音频播放器命令</p></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="0268" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">我们开始吧</h1><p id="f739" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">起点是上一篇文章中的单声道音频技巧。您可以克隆git repo或派生它。</p><p id="b448" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">请注意，我希望您已经按照上一篇文章中的描述设置了AWS帐户和环境。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="52ce" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">交互模型</h1><p id="565b" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我将在交互模型文件中添加技能的新意图。</p><p id="c86a" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">交互模型的名称为<code class="fe np nq nr ns b">&lt;locale&gt;.json</code>，例如<code class="fe np nq nr ns b">en-GB.json</code></p><p id="a8fb" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">注意:我的Alexa配置的是en-GB。根据您的配置更新您的文件名，例如en-US或其他。</p><p id="e8df" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">打开<strong class="lv iu"> </strong> <code class="fe np nq nr ns b">iteractionModels/en-GB.json</code>文件。与任何JSON文件一样，要密切注意格式。</p><p id="3ec8" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">添加音频技能所需的新意图:</p><ul class=""><li id="15f4" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.LoopOnIntent</code></li><li id="0e3e" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.LoopOffIntent</code></li><li id="228d" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.PreviousIntent</code></li><li id="7465" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.StartOverIntent</code></li><li id="57ae" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.YesIntent</code></li><li id="f5f7" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.NoIntent</code></li><li id="dbe4" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">AMAZON.NextIntent</code></li></ul><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="82e6" class="nx lc it ns b gy ny nz l oa ob"><br/>{<br/>"name": "AMAZON.LoopOnIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.LoopOffIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.PreviousIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.StartOverIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.YesIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.NoIntent",<br/>"slots": [],<br/>"samples": []<br/>},<br/>{<br/>"name": "AMAZON.NextIntent",<br/>"slots": [],<br/>"samples": []<br/>}</span></pre><p id="43ce" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">关于内置意图的其他信息可在此处找到:</p><div class="oc od gp gr oe of"><a href="https://developer.amazon.com/en-US/docs/alexa/custom-skills/standard-built-in-intents.html" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">tech doc-模板</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Alexa内置设备开发带有Alexa语音服务的Alexa内置设备</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">developer.amazon.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="a563" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">技能代码</h1><p id="22db" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">现在我们准备在Node.js中发展我们的技能。</p><p id="ea01" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">打开<code class="fe np nq nr ns b">lambda/index.js</code>。</p><h2 id="8072" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">属性管理</h2><p id="bb61" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">为了跟踪属性，我使用拦截器将回放信息和回放设置存储在AWS DynamoDB中。</p><p id="648e" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">使用<a class="ae mp" href="https://ask-sdk-for-nodejs.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> ASK SDK </a>，你可以很容易地将你的技能信息保存到Amazon DynamoDB中。您的技能可以回忆和更新这些信息。<a class="ae mp" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>是一个无服务器的键值对和文档数据库。一旦您配置好它并建立了一个表，您就可以通过SDK轻松地在DynamoDB表中写入和读取信息。</p><h2 id="e0cf" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">请求和响应拦截器</h2><p id="a8f9" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">ASK SDK提供了请求和响应拦截器函数，这些函数在意图处理函数执行前后立即被处理。您可以使用这些拦截器函数来调用适用于多个传入请求或传出响应的公共逻辑。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/49afe8554df0c53e54618e1e843649ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HGHXhESHrdz4EgD1.jpg"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">来自<a class="ae mp" href="https://developer.amazon.com/blogs/alexa/post/75ee61df-8365-44bb-b28f-e708000891ad/how-to-use-interceptors-to-simplify-handler-code-and-cache-product-and-purchase-information-in-monetized-alexa-skills" rel="noopener ugc nofollow" target="_blank"> Alexa博客文章</a></p></figure><h2 id="38a1" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">保存和加载属性</h2><p id="3299" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated"><strong class="lv iu">请求拦截器</strong>在为传入请求选择的处理程序执行之前立即被调用。我使用响应拦截器来保存属性。</p><p id="50b1" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">响应拦截器在所选请求处理程序执行后立即被调用。我使用一个请求拦截器来加载属性。</p><p id="99e0" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在<code class="fe np nq nr ns b">index.js</code>中创建以下方法。</p><p id="478f" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果用户第一次调用该技能，则会创建一个预置结构</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">加载和保存拦截器</p></figure><h2 id="fb20" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">连接到DynamoDB</h2><p id="d15f" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">要从您的技能连接到DynamoDB表，请使用您的<code class="fe np nq nr ns b">SkillBuilder</code>上的<code class="fe np nq nr ns b">withTableName</code>函数指定您想要连接的表名。<code class="fe np nq nr ns b">withAutoCreateTable(true)</code>将确保表被创建。</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="d9b7" class="nx lc it ns b gy ny nz l oa ob">const skillBuilder = Alexa.SkillBuilders.standard();</span><span id="84fd" class="nx lc it ns b gy pi nz l oa ob">exports.handler = skillBuilder<br/>    .addRequestHandlers(<br/>        // ... handlers below<br/>    )<br/> <!-- -->.addRequestInterceptors(LoadPersistentAttributesRequestInterceptor)     .addResponseInterceptors(SavePersistentAttributesResponseInterceptor)<br/>.addErrorHandlers(ErrorHandler)<br/>.withAutoCreateTable(true)<br/>.withTableName(constants.config.dynamoDBTableName)<br/>.lambda();</span></pre><h2 id="db4f" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">常数</h2><p id="9dc5" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">为了存储常量，在<code class="fe np nq nr ns b">lambda</code>文件夹中创建一个文件<code class="fe np nq nr ns b">constants.js </code>。</p><p id="e57f" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">为YouTube搜索服务添加技能ID、DynamoDB表名和分页大小。</p><p id="3e58" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">项目文件夹中有技能ID:<code class="fe np nq nr ns b">.ask/ask-states.json</code></p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="fbe0" class="nx lc it ns b gy ny nz l oa ob">/* CONSTANTS */</span><span id="da65" class="nx lc it ns b gy pi nz l oa ob">exports.config = {<br/>    appId: "your app Id",<br/>    dynamoDBTableName: "alexa-skill-heytube-playback",<br/>    pageSize: 10<br/>};</span></pre><h2 id="44dd" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">助手</h2><p id="87b9" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">让我们定义一些助手函数，使我们的代码在<code class="fe np nq nr ns b">index.js</code>中更加整洁。</p><ul class=""><li id="3a6a" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">getPlaybackInfo</code>:从属性管理器返回回放信息</li><li id="c9f7" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">getPlaybackSetting</code>:从属性管理器返回回放设置</li><li id="5aaa" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">getToken</code>:返回用于播放音频的令牌</li><li id="a612" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">getIndex</code>:音频播放列表的当前索引</li><li id="a404" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">setNextIndex</code>:设置音频播放列表的下一个索引</li><li id="b16e" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">getOffsetMilliseconds</code>:返回当前音频的偏移量</li><li id="e895" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">canThrowCard</code>:播放设备是否可以出牌</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">助手方法</p></figure><h2 id="d53f" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">意图处理程序</h2><p id="9c36" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">让我们编辑标准意图处理程序:</p><ul class=""><li id="4571" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">他的方法将处理我们技能的发射。</li></ul><p id="8581" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过说来唤起:</p><blockquote class="pj"><p id="6d26" class="pk pl it bd pm pn po pp pq pr ps mo dk translated"><em class="pt">“Alexa，打开嘿管”</em></p></blockquote><p id="bdcc" class="pw-post-body-paragraph lt lu it lv b lw pu ju ly lz pv jx mb mc pw me mf mg px mi mj mk py mm mn mo im bi translated"><code class="fe np nq nr ns b">Launch</code>方法检索回放信息，检查是否有打开的回放会话。如果有，它会询问用户是想继续播放还是从头开始播放。如果没有会话，它将为用户播放请求音轨的欢迎消息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">LaunchRequestHandler</p></figure><ul class=""><li id="4f03" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">StartPlaybackHandler</code> : <strong class="lv iu"> </strong>该方法将启动处理YouTube视频搜索的回放。它接收视频查询并调用控制器助手进行搜索。控制器使代码更加简洁，下面将进一步描述。</li></ul><p id="25c7" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过说来唤起:</p><blockquote class="pj"><p id="c7ae" class="pk pl it bd pm pn po pp pq pr ps mo dk translated"><em class="pt">《Alexa，打白蛇》</em></p><p id="2eee" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">“Alexa，问嘿管玩白蛇”</p></blockquote><figure class="pz qa qb qc qd kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">开始播放处理程序</p></figure><ul class=""><li id="b8d9" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">YesIntentHandler</code>和<code class="fe np nq nr ns b">NoIntentHandler</code> : <code class="fe np nq nr ns b">Yes</code>和<code class="fe np nq nr ns b">No</code>处理程序将管理来自欢迎消息的响应。</li></ul><p id="2225" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果<code class="fe np nq nr ns b">Yes</code>，Alexa将从属性管理器中存储的偏移量开始恢复播放音频。</p><p id="c171" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果<code class="fe np nq nr ns b">No</code>，Alexa将重新开始音频，将偏移重置为零。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">是和否意图处理程序</p></figure><ul class=""><li id="0a50" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">ResumePlaybackIntentHandler</code> <strong class="lv iu"> : </strong>从存储在属性管理器中的偏移量开始恢复播放音频。</li><li id="db31" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">StartOverPlaybackIntentHandler</code> <strong class="lv iu"> : </strong>重新开始播放同一首音轨。</li></ul><p id="1076" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过在音频播放期间说出以下内容来调用:</p><blockquote class="pj"><p id="151e" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">“Alexa，继续玩”</p><p id="e9b8" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">Alexa，从音频开始</p></blockquote><figure class="pz qa qb qc qd kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">恢复并重新开始意图处理程序</p></figure><ul class=""><li id="3cd6" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">NextPlaybackIntentHandler</code> <strong class="lv iu"> : </strong>播放播放列表中存储的下一个相关音频。</li><li id="9ab7" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PreviousPlaybackIntentHandler</code>:播放播放列表的上一段音频。</li></ul><p id="cb84" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过在音频播放期间说出以下内容来调用:</p><blockquote class="pj"><p id="af4c" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">" Alexa，下一个玩"</p><p id="2c0d" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">Alexa，播放上一个</p></blockquote><figure class="pz qa qb qc qd kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">下一个和上一个意图处理程序</p></figure><ul class=""><li id="aff7" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">HelpIntentHandler</code> <strong class="lv iu"> : </strong>播放帮助音频信息。</li><li id="9b37" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PauseAndStopIntentHandler</code>:暂停/停止播放音频。</li></ul><p id="0f28" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过在音频播放期间说出以下内容来调用:</p><blockquote class="pj"><p id="1ff3" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">“阿利克夏，帮帮我”</p><p id="715e" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">“Alexa，暂停”或“Alexa，停止”</p></blockquote><figure class="pz qa qb qc qd kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">帮助和暂停意图处理程序</p></figure><ul class=""><li id="0373" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">LoopOnIntentHandler</code> <strong class="lv iu"> : </strong>启用循环功能重复音轨。</li><li id="d942" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">LoopOffIntentHandler</code>:禁用循环功能，重复播放音轨。</li></ul><p id="af82" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">循环标志是存储在回放设置中的布尔值。处理程序会将其设置为<code class="fe np nq nr ns b">true</code>或<code class="fe np nq nr ns b">false</code>。</p><p id="5c31" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">通过在音频播放期间说出以下内容来调用:</p><blockquote class="pj"><p id="b8b6" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">Alexa，循环播放</p><p id="87cf" class="pk pl it bd pm pn po pp pq pr ps mo dk translated">Alexa，循环关闭</p></blockquote><figure class="pz qa qb qc qd kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">循环打开和循环关闭意图处理程序</p></figure><h2 id="8a88" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">处理音频播放器事件</h2><p id="5fa7" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">Alexa语音服务(AVS)包括一个<a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html" rel="noopener ugc nofollow" target="_blank">音频播放器接口</a>，用于管理、控制和报告流媒体音频内容。</p><p id="60b6" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">当播放开始时，你的设备会向Alexa发送一系列生命周期事件。这些事件通知Alexa播放已经开始，请求下一个流，并向AVS和音乐服务提供商提供进度报告信息。</p><p id="6e4d" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">我将为以下与我们的技能相关的事件添加一个处理程序:</p><ul class=""><li id="2348" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PlaybackStarted</code>:回放开始时，设备向AVS发送一个<code class="fe np nq nr ns b"><a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html#playbackstarted" rel="noopener ugc nofollow" target="_blank">PlaybackStarted</a></code>事件。</li><li id="a136" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PlaybackNearlyFinished</code>:当您的设备准备好缓冲/下载播放队列中的下一个流时，发送<code class="fe np nq nr ns b"><a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html#playbacknearlyfinished" rel="noopener ugc nofollow" target="_blank">PlaybackNearlyFinished</a></code>事件。</li><li id="cf5b" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PlaybackFinished</code>:当你的设备播放完一个流时，发送<code class="fe np nq nr ns b"><a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html#playbackfinished" rel="noopener ugc nofollow" target="_blank">PlaybackFinished</a></code>事件。</li><li id="9505" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PlaybackStopped</code>:如果你的设备收到<code class="fe np nq nr ns b">Stop</code>指令并停止播放，发送<code class="fe np nq nr ns b"><a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html#playbackstopped" rel="noopener ugc nofollow" target="_blank">PlaybackStopped</a></code>事件。</li><li id="3105" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated"><code class="fe np nq nr ns b">PlaybackFailed</code>:如果回放流出错，发送<code class="fe np nq nr ns b"><a class="ae mp" href="https://developer.amazon.com/en-US/docs/alexa/alexa-voice-service/audioplayer.html#playbackstopped" rel="noopener ugc nofollow" target="_blank">PlaybackFailed</a></code>事件。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">AudioPlayerEventHandler</p></figure><h2 id="7142" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">控制器</h2><p id="75a5" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">控制器由处理程序调用，将执行搜索、播放、停止、播放下一个和播放上一个的操作。</p><p id="53b7" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">每个动作将设置适当的属性，并向Alexa设备提供响应指令。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">控制器</p></figure><h2 id="6e5a" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">YouTube界面</h2><p id="a08d" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">为了与YouTube APIs接口，我使用了npm中的两个库。</p><p id="6264" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated"><strong class="lv iu">搜索</strong></p><p id="329e" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">为了搜索YouTube视频，我正在使用npm包<code class="fe np nq nr ns b"><a class="ae mp" href="https://www.npmjs.com/package/youtube-search" rel="noopener ugc nofollow" target="_blank">yt</a>-list</code>。</p><p id="b772" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">让我们安装它。在你的lambda文件夹中，输入<code class="fe np nq nr ns b">$ npm i --save yt-list</code>。</p><p id="5904" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在文件顶部添加导入:</p><p id="fa1e" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated"><code class="fe np nq nr ns b">const ytlist = require("yt-list");</code></p><p id="1785" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated"><strong class="lv iu">播放音频</strong></p><p id="5fa4" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">为了播放音频流，我使用了另一个npm包，<code class="fe np nq nr ns b"><a class="ae mp" href="https://www.npmjs.com/package/ytdl-core" rel="noopener ugc nofollow" target="_blank">ytdl-core</a></code>。让我们安装它。</p><p id="48c7" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在你的lambda文件夹中，输入<code class="fe np nq nr ns b">$ npm i --save ytdl-core</code>。</p><p id="aeca" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在文件顶部添加导入:</p><p id="0988" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated"><code class="fe np nq nr ns b">const ytdl = require("ytdl-core");</code></p><p id="95d9" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">两种方法如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">从YouTube搜索并获取音频</p></figure><p id="e1b8" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">Alexa音频需要低质量，所以需要音频格式。</p><h2 id="9983" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">技能建设者</h2><p id="9fa8" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">最后，让我们向<code class="fe np nq nr ns b">SkillBuild</code>添加请求处理程序、拦截器、错误处理程序和lambda表创建。</p><p id="bb11" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">技能生成器是您技能的入口点，路由所有请求和响应:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pg ph l"/></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">技能建设者</p></figure><p id="c0f3" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">代码完成！现在让我们部署和测试技能。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qe"><img src="../Images/36aad7a04e1c9c0efcd9efafc1669100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bcu4Bd5xG-zDXAhV.jpeg"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="d6e5" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">发挥你的技能</h1><p id="c377" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">使用ASK CLI快速部署您的技能，而无需进入控制台。</p><p id="fcd0" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">去你的技能文件夹根，输入:<code class="fe np nq nr ns b">$ ask deploy</code>。</p><h2 id="c371" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">向lambda函数添加DynamoDB权限</h2><p id="5e17" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">部署后，您需要将DynamoDB权限添加到为执行您的函数而创建的IAM角色中:</p><ul class=""><li id="1abe" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">连接到AWS控制台。</li><li id="bd4d" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">转到IAM部分。</li><li id="cd62" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">选择为执行lambda函数而创建的角色(如果没有更改默认名称，该角色将被命名为“ask-lambda-HeyTube”)。</li><li id="cd56" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">单击附加策略。</li><li id="8189" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">找到并选择“AmazonDynamoDBFullAccessPolicy”角色，然后单击“附加策略”。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qf"><img src="../Images/9a4818d7756c4108bb77a9fce25c780e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDhzptg_dEsFi05I-_830A.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">IAM —附加DynamoDB策略</p></figure><p id="ddc9" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">附加DynamoDB策略后，进入你的技能文件夹根目录，再次输入<code class="fe np nq nr ns b">$ ask deploy</code>。</p><p id="a524" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">这一次您的部署应该会成功。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qg"><img src="../Images/3fb1ade2fded82a592177df9416e8910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RWlT2Y8PuGNG9PPOqFkQ2g.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">询问部署</p></figure><p id="7cc9" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果你的技能没有被部署，请参阅我以前的文章，在这篇文章中，我有一些与部署你的技能相关的常见问题。</p><p id="1093" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">验证您的部署:</p><ul class=""><li id="7856" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">登录AWS控制台→ Lambda</li></ul><p id="ed46" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在创建lambda函数时验证您的新技能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qh"><img src="../Images/5ae731be782e7199113f7434ee8c433e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9nwWMIOf2vJz4ANZ.png"/></div></div></figure><p id="314b" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">登录到Alexa开发者控制台，验证你的新技能已经创建。可以点击查看详情，但我不建议通过控制台编辑任何字段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/5d453acbb08c664f80cf643829ddc1c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sCl9nlRa01ajEXAg.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="e83b" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">上次配置</h1><p id="40d8" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">如果您还没有这样做:</p><ul class=""><li id="d8da" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">添加您的环境变量，<code class="fe np nq nr ns b">YOUTUBE_API_KEY</code>，<strong class="lv iu"> </strong>，其值是Google developers控制台中的键。</li><li id="1479" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">在基本设置中将您的服务超时增加到15秒。</li></ul><p id="71ca" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">详细内容包含在我之前的文章中。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="a932" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">测试你的技能</h1><p id="0ec0" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">要从命令行测试您的技能，运行<code class="fe np nq nr ns b">ask dialog</code>并指定您的技能所支持的语言环境:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="a37f" class="nx lc it ns b gy ny nz l oa ob">$ ask dialog --locale en-GB</span></pre><p id="1c4c" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">要从命令行测试您的技能，运行<code class="fe np nq nr ns b">ask dialog</code>并指定您的技能支持的语言环境:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="0194" class="nx lc it ns b gy ny nz l oa ob">$ ask dialog --locale en-GB</span></pre><p id="1cd2" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">该命令打开一个交互式终端，您可以在其中模拟与Alexa的多回合对话:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qh"><img src="../Images/3412c73db548d504371ac5af977449f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-aob2joq-aYGz6k9.png"/></div></div></figure><p id="3f37" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">打开你的技能，模拟一个对话:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="50b3" class="nx lc it ns b gy ny nz l oa ob"><strong class="ns iu">User  &gt; Alexa open hey tube</strong><br/>Alexa &gt; Welcome to Hey Tube. ask to play a video to start listening.<br/><strong class="ns iu">User  &gt; play Whitesnake<br/></strong>Alexa &gt; Playing  Whitesnake - Here I Go Again '87 (Official Music Video)<br/><strong class="ns iu">User  &gt; .quit</strong></span></pre><p id="1d45" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">第一项测试已经完成。如果你有一个Alexa设备，你可以在你的Alexa中测试这段对话——你应该会得到相同的结果，并听到白蛇乐队的一首很棒的歌。</p><p id="5f86" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">你可以对你的技能做任何改变并重新部署。</p><p id="1947" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">您可以通过使用一个预格式化的<code class="fe np nq nr ns b">.json</code>文件来自动重放，以节省测试时间。</p><p id="a160" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">使用<code class="fe np nq nr ns b">.record</code>创建一个可重复的JSON测试文件:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="6527" class="nx lc it ns b gy ny nz l oa ob">User  &gt; .record</span></pre><p id="87f1" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">我创造了<code class="fe np nq nr ns b">happyPath.json</code>作为例子:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="dfc3" class="nx lc it ns b gy ny nz l oa ob">$ ask dialog --locale en-GB --replay happyPath.json</span></pre><p id="0b3e" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">你也可以通过Alexa开发者控制台进行测试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qh"><img src="../Images/b3b413bf4791b3098ad9aa350729b8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kKwHeEq5Fhro6bne.png"/></div></div></figure><h2 id="d9d9" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">预约测试</h2><p id="dfb9" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我还包括了一些预定的测试。</p><p id="8965" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">根据其<a class="ae mp" href="https://bespoken.io/#:~:text=Bespoken%20is%20the%20world%20leader,saving%20you%20time%20and%20money" rel="noopener ugc nofollow" target="_blank">网站</a>的说法，“Bespoken是人工智能驱动的语音和聊天体验测试、培训和监控领域的世界领导者。”</p><div class="oc od gp gr oe of"><a href="https://bespoken.io/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">Bespoken |用于测试和监控语音应用的工具和资源</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">WE CAN Bespoken是人工智能驱动的语音和聊天体验测试、培训和监控领域的全球领导者。我们…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">bespoken.io</p></div></div><div class="oo l"><div class="qj l oq or os oo ot ks of"/></div></div></a></div><p id="2182" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">如果您还没有，请先安装它:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="2c4d" class="nx lc it ns b gy ny nz l oa ob">npm install bespoken-tools -g</span></pre><p id="e8bb" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在此处完成设置说明:</p><div class="oc od gp gr oe of"><a href="https://read.bespoken.io/unit-testing/getting-started/#setup" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">开始|预订文档</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">用Bespoken对你的Alexa技能和谷歌动作进行单元测试很容易。这是正在运行的测试的样本…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">read.bespoken.io</p></div></div><div class="oo l"><div class="qk l oq or os oo ot ks of"/></div></div></a></div><p id="6e07" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">在您的根文件夹中:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="427a" class="nx lc it ns b gy ny nz l oa ob">$ bst test</span></pre><p id="061e" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">它将运行列在<strong class="lv iu"> </strong> <code class="fe np nq nr ns b">test/intents.test.yml</code>文件夹中的意图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ql"><img src="../Images/9bf9920dbffe720fb535337d1c323920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHbilrpzA1qe10vFG5h6_g.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">预约测试的输出</p></figure><h2 id="ae10" class="nx lc it bd ld ou ov dn lh ow ox dp ll mc oy oz ln mg pa pb lp mk pc pd lr pe bi translated">Echosim测试</h2><p id="eb15" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">另一个测试选项是使用Echoism Alexa模拟器。连接您的帐户并测试您的技能。</p><div class="oc od gp gr oe of"><a href="https://echosim.io/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">Alexa技能测试工具</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Echosim.io是一个面向开发人员的在线社区工具，它模拟了Amazon Echo的外观和感觉。</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">echosim.io</p></div></div><div class="oo l"><div class="qm l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="f575" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">完整的源代码</h1><p id="3104" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">完整的源代码可以在我的GitHub中找到:</p><div class="oc od gp gr oe of"><a href="https://github.com/mlomboglia/alexa-skill-heytube" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">姆隆波利亚/阿莱克莎-斯奇尔-海图</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">建立一个Alexa技能来播放YouTube视频中的音频完整说明可在我的媒体帖子中找到:如何播放…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="qn l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="9729" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">参考</h1><div class="oc od gp gr oe of"><a href="https://github.com/alexa/skill-sample-nodejs-audio-player" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">Alexa/技能-样本-节点-音频-播放器</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">这个项目演示了使用Alexa音频播放器的技能。多流文件夹包含一个示例技能…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="qo l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="3578" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">可能的改进</h1><p id="934f" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">以下是这项技能未来可能的改进:</p><ul class=""><li id="31e2" class="mv mw it lv b lw mq lz mr mc mx mg my mk mz mo na nb nc nd bi translated">改进了失败的YouTube音频的错误处理</li><li id="b089" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">处理YouTube播放列表</li><li id="6c55" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">处理私人音频</li><li id="fd0d" class="mv mw it lv b lw ne lz nf mc ng mg nh mk ni mo na nb nc nd bi translated">亚马逊Echo Show设备的显示处理</li></ul><p id="525b" class="pw-post-body-paragraph lt lu it lv b lw mq ju ly lz mr jx mb mc ms me mf mg mt mi mj mk mu mm mn mo im bi translated">编码快乐！</p></div></div>    
</body>
</html>