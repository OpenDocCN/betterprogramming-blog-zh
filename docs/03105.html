<html>
<head>
<title>Extract Keywords Using spaCy in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用spaCy提取关键字</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/extract-keywords-using-spacy-in-python-4a8415478fbf?source=collection_archive---------3-----------------------#2020-01-21">https://betterprogramming.pub/extract-keywords-using-spacy-in-python-4a8415478fbf?source=collection_archive---------3-----------------------#2020-01-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2340" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从一篇文章中找到热门关键词并生成标签</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3070a0a4b34aa661d845ec71daac3a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lzFP2TPZ2wImksloqHxa7w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/s/photos/scrabble?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@emilep?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">émile Perron</a>拍摄</p></figure><p id="41e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，你将学习如何从一大块文本中提取最重要的关键词——一篇文章、一篇学术论文，甚至是一条简短的推文。你可以自由地使用它来生成标签，计算句子的重要性等等。</p><p id="f272" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我将使用一个名为spaCy的工业级自然语言处理模块。我以前用spaCy 做过一个关于<a class="ae ky" href="https://medium.com/better-programming/the-beginners-guide-to-similarity-matching-using-spacy-782fc2922f7c" rel="noopener">相似性匹配的教程——你可以随意看看。本教程分为三个部分:</a></p><ul class=""><li id="5f22" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">设置</li><li id="465f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">履行</li><li id="3f10" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">结论</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2ee7" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">1.设置</h1><p id="03f7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们将通过pip安装来安装空间模块。下载语言模型时，创建符号链接需要管理权限。在管理员模式下打开终端。强烈建议在运行以下命令之前创建一个虚拟环境:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="419b" class="ns mr it no b gy nt nu l nv nw">pip install -U spacy</span></pre><p id="bdbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是下载您选择的语言模型。在本教程中，我将使用大的英语模型。请随时查看<a class="ae ky" href="https://spacy.io/usage/models" rel="noopener ugc nofollow" target="_blank">官网，了解可用型号的完整列表</a>。</p><h2 id="46a6" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">en_core_web_lg(大)</h2><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="2a2d" class="ns mr it no b gy nt nu l nv nw">python -m spacy download en_core_web_lg</span></pre><p id="81a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型的文件大小约为800MB。如果您想尝试一下，请下载语言模型的较小版本。</p><h2 id="ea95" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">en_core_web_md(中型)</h2><p id="e0c5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">中型型号要小得多，只有100MB。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="2bec" class="ns mr it no b gy nt nu l nv nw">python -m spacy download en_core_web_md</span></pre><h2 id="4df8" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">en_core_web_sm(小型)</h2><p id="54a0" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">最小的英语语言模型应该只需要一会儿就可以下载，因为它大约有11MB。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f3ed" class="ns mr it no b gy nt nu l nv nw">python -m spacy download en_core_web_sm</span></pre><p id="83f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，运行以下命令检查spaCy是否正常工作。它还显示了已安装的型号。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0808" class="ns mr it no b gy nt nu l nv nw">python -m spacy validate</span></pre><p id="2157" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们转到下一节，开始用Python写一些代码。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3f2d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">2.履行</h1><h2 id="b7a2" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">导入</h2><p id="9514" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">首先，我们需要在文件的顶部添加一个导入声明。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8713" class="ns mr it no b gy nt nu l nv nw">import spacy</span></pre><p id="0a6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了空间，我们还需要以下进口。<code class="fe oi oj ok no b">Counter</code>将用于根据频率对关键字进行计数和排序，而<code class="fe oi oj ok no b">punctuation</code>包含最常用的标点符号。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c2b3" class="ns mr it no b gy nt nu l nv nw">from collections import Counter<br/>from string import punctuation</span></pre><h2 id="939c" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">负载空间模型</h2><p id="48ee" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们可以通过下面的命令轻松地加载刚刚安装的模型。根据您安装的型号的名称修改字符串。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="2fa6" class="ns mr it no b gy nt nu l nv nw">nlp = spacy.load("en_core_web_lg")</span></pre><p id="65cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您遇到无法加载模型的问题，即使已经安装了模型，您也可以用不同的方式加载模型。让我们直接导入模块，您可以使用它来加载模型。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1040" class="ns mr it no b gy nt nu l nv nw">import en_core_web_lg</span><span id="f7dc" class="ns mr it no b gy ol nu l nv nw">nlp = en_core_web_lg.load()</span></pre><h2 id="6453" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">热门词汇功能</h2><p id="d7f4" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们将在函数中编写关键字提取代码。这要方便得多，当我们需要从一大块文本中提取关键词时，我们可以很容易地调用它。它接受一个字符串作为输入参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="ba7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">包含我们想要提取的词性标签的列表。在本教程中，我将只使用<code class="fe oi oj ok no b">PROPN</code>(专有名词)<code class="fe oi oj ok no b">ADJ</code>(形容词)和<code class="fe oi oj ok no b">NOUN</code>(名词)。如果您想提取另一个词性标签，如动词，请根据您的要求扩展列表。</p><p id="b676" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok no b">#2</code>将输入文本转换成小写，并通过我们之前加载的spacy模型对其进行标记。将返回一个处理过的<code class="fe oi oj ok no b">Doc</code>对象。该对象包含基于标记化过程的<code class="fe oi oj ok no b">Token</code>对象。</p><p id="ef24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok no b">#3</code>循环遍历每个标记，确定标记化的文本是否是停用词或标点符号的一部分。忽略此标记，如果是，则继续下一个标记。</p><p id="009b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok no b">#4</code>如果标记化文本的词性标签是我们之前指定的，则存储结果。</p><p id="2f50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok no b">#5</code>以字符串列表的形式返回结果。</p><p id="1c2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用您选择的简单文本来测试一下。我使用以下输入文本:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="7490" class="ns mr it no b gy nt nu l nv nw">output = get_hotwords('''Welcome to Medium! Medium is a publishing platform where people can read important, insightful stories on the topics that matter most to them and share ideas with the world.''')</span><span id="76f1" class="ns mr it no b gy ol nu l nv nw">print(output)</span></pre><p id="5d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行该函数后，我获得了以下结果。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="448b" class="ns mr it no b gy nt nu l nv nw">['welcome', 'medium', 'medium', 'publishing', 'platform', 'people', 'important', 'insightful', 'stories', 'topics', 'ideas', 'world']</span></pre><h2 id="185f" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">删除重复项目</h2><p id="d61f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">请注意，如果我们刚刚编写的函数在输入文本中包含相同的重要关键字，它就会包含重复项。在这种情况下，关键字<code class="fe oi oj ok no b">medium</code>重复两次。您可以通过<code class="fe oi oj ok no b">set</code>功能轻松移除它:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5809" class="ns mr it no b gy nt nu l nv nw">output = set(get_hotwords('''Welcome to Medium! Medium is a publishing platform where people can read important, insightful stories on the topics that matter most to them and share ideas with the world.'''))</span><span id="8d5e" class="ns mr it no b gy ol nu l nv nw">print(output)</span></pre><p id="2b8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该能够获得以下输出:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f240" class="ns mr it no b gy nt nu l nv nw">{'medium', 'ideas', 'publishing', 'important', 'stories', 'people', 'insightful', 'platform', 'world', 'topics', 'welcome'}</span></pre><h2 id="6736" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">从关键字生成标签</h2><p id="37f4" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">通过在每个关键字的开头附加散列符号，可以很容易地从关键字生成散列标签。最简单的方法是使用列表理解法。您需要用空格将结果列表连接起来，以生成一个hashtag字符串:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8b4e" class="ns mr it no b gy nt nu l nv nw">output = set(get_hotwords('''Welcome to Medium! Medium is a publishing platform where people can read important, insightful stories on the topics that matter most to them and share ideas with the world.'''))</span><span id="e838" class="ns mr it no b gy ol nu l nv nw">hashtags = [('#' + x) for x in output]<br/>print(' '.join(hashtags))</span></pre><p id="d98d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您运行它时，将显示以下结果:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="e745" class="ns mr it no b gy nt nu l nv nw">#medium #ideas #publishing #important #stories #people #insightful #platform #world #topics #welcome</span></pre><h2 id="2bea" class="ns mr it bd ms nx ny dn mw nz oa dp na li ob oc nc lm od oe ne lq of og ng oh bi translated">按频率排序</h2><p id="62e5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">可能存在关键字的顺序基于频率的情况。在这种情况下，您需要根据关键词出现的频率对它们进行排序——使用<code class="fe oi oj ok no b">Counter</code>模块来排序并获取最频繁出现的关键词。<code class="fe oi oj ok no b">Counter</code>模块有一个<code class="fe oi oj ok no b">most_common</code>函数，它接受一个整数作为输入参数。记住，必须去掉<code class="fe oi oj ok no b">set</code>函数，才能保留每个关键字的出现频率。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="de02" class="ns mr it no b gy nt nu l nv nw">output = get_hotwords('''Welcome to Medium! Medium is a publishing platform where people can read important, insightful stories on the topics that matter most to them and share ideas with the world.''')</span><span id="3c5f" class="ns mr it no b gy ol nu l nv nw">hashtags = [('#' + x[0]) for x in Counter(output).most_common(5)]</span><span id="1f4c" class="ns mr it no b gy ol nu l nv nw">print(' '.join(hashtags))</span></pre><p id="4139" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这些情况下，最常见的五个标签如下:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="2285" class="ns mr it no b gy nt nu l nv nw">#medium #welcome #publishing #platform #people</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0576" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">3.结论</h1><p id="130d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们回顾一下今天所学的内容。我们通过pip安装开始安装<code class="fe oi oj ok no b">spaCy</code>模块。然后我们下载了一个预先训练好的语言模型。在这种情况下，我下载了英文模型的大版本。</p><p id="5a72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们编写了一些简单的代码来实现我们自己的关键字提取器。我们定义了自己的<code class="fe oi oj ok no b">hotword</code>函数，它接受一个输入字符串并输出一列关键字。我们使用Python内置的<code class="fe oi oj ok no b">set</code>函数从结果中删除重复项。列表理解对于在每个关键字前面附加散列符号来创建hashtags字符串非常有帮助。最后，我们探索了<code class="fe oi oj ok no b">Counter</code>模块中的<code class="fe oi oj ok no b">most_common</code>函数，根据频率对关键词进行排序。</p><p id="6b32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢你的阅读，我希望在下一篇文章中见到你！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="ea7c" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">参考</h1><ol class=""><li id="1316" class="lv lw it lb b lc ni lf nj li oo lm op lq oq lu or mb mc md bi translated"><a class="ae ky" href="https://medium.com/better-programming/the-beginners-guide-to-similarity-matching-using-spacy-782fc2922f7c" rel="noopener">https://medium . com/better-programming/the-beginners-guide-to-similarity-matching-using-spacy-782 fc 2922 f7c</a></li><li id="77d2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu or mb mc md bi translated"><a class="ae ky" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">https://spacy.io/</a></li><li id="0341" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu or mb mc md bi translated"><a class="ae ky" href="https://github.com/explosion/spaCy" rel="noopener ugc nofollow" target="_blank">https://github.com/explosion/spaCy</a></li></ol></div></div>    
</body>
</html>