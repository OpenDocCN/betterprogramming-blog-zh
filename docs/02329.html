<html>
<head>
<title>MLDataTable: The Panda For iOS Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ml datatable:iOS开发者的熊猫</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/mldatatable-the-panda-for-ios-developers-251aa9a09eb1?source=collection_archive---------12-----------------------#2019-11-22">https://betterprogramming.pub/mldatatable-the-panda-for-ios-developers-251aa9a09eb1?source=collection_archive---------12-----------------------#2019-11-22</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="7408" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">利用强大的Create ML数据结构点燃您心中的数据科学家</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fa10ef181fc2debde0edf7c24d2a1d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D45txEqR7zbOYXN7"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">埃里克·麦克林在Unsplash<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">上的照片</a></p></figure><p id="5824" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">数据处理、处理、清理和整形在机器学习中起着至关重要的作用。Panda是一个强大的python包，是数据科学家用来对数据集执行转换的最受欢迎的库之一。</p><p id="f2bb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">尽管有一个简单的语法，熊猫需要一个陡峭的学习曲线。更重要的是，因为有大量的功能可用于各种用例，并且需要时间来掌握所有的功能。苹果公司通过CreateML旨在弥合机器学习和应用程序开发之间的差距，以允许移动开发者培训和部署设备上机器学习的模型。</p><p id="6b6b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Create ML是一个易于使用的界面，通过使用预先构建的模板和算法来训练不同类型的模型，它的引入在某种程度上改变了游戏规则。随着<code class="fe lw lx ly lz b">MLDataTable</code>的发布，苹果努力让移动开发者更容易处理数据，提供了一种类似电子表格的数据结构，与Pandas相比，学习曲线更容易。</p><h1 id="4518" class="ma mb iu bd mc md me mf mg mh mi mj mk ka ml kb mm kd mn ke mo kg mp kh mq mr bi translated">MLDataTable —在引擎盖下</h1><p id="d14a" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated"><a class="ae kz" href="https://developer.apple.com/documentation/createml/mldatatable" rel="noopener ugc nofollow" target="_blank"> MLDataTable </a>是一个管理表格数据的有用数据结构。它拥有熊猫图书馆的大部分功能，因此成为iOS和macOS开发者的熊猫。</p><p id="36c0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了用于解析JSON和CSV数据集之外，MLDataTable还用于以下创建ML模型模板:</p><ul class=""><li id="9969" class="mx my iu lc b ld le lg lh lj mz ln na lr nb lv nc nd ne nf bi translated"><a class="ae kz" href="https://developer.apple.com/documentation/createml/mlregressor" rel="noopener ugc nofollow" target="_blank"> MLRegressor </a></li><li id="cc4b" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated"><a class="ae kz" href="https://developer.apple.com/documentation/createml/mlclassifier" rel="noopener ugc nofollow" target="_blank"> MLClassifier </a></li><li id="5392" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated"><a class="ae kz" href="https://developer.apple.com/documentation/createml/mltextclassifier" rel="noopener ugc nofollow" target="_blank"> MLTextClassifier </a>和<a class="ae kz" href="https://developer.apple.com/documentation/createml/mlwordtagger" rel="noopener ugc nofollow" target="_blank"> MLWordTagger </a></li><li id="5afb" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated"><a class="ae kz" href="https://developer.apple.com/documentation/createml/mlrecommender" rel="noopener ugc nofollow" target="_blank">ml推荐器</a></li></ul></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h2 id="5572" class="ns mb iu bd mc nt nu dn mg nv nw dp mk lj nx ny mm ln nz oa mo lr ob oc mq od bi translated">我们的目标</h2><p id="341c" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">在接下来的几节中，我们将探索MLDataTable提供的使数据操作变得简单有趣的功能，特别是对于移动开发人员。</p></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="8e57" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">读取和解析文件</h1><p id="7a82" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">大多数数据集都是JSON或CSV文件格式。有了MLDataTable，通过使用Create ML将这样的文件解析成表格形式变得快速而简单。首先，您需要在Xcode和<code class="fe lw lx ly lz b">import CreateML</code>中创建一个macOS游乐场:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="380a" class="ns mb iu lz b gz on oo l op oq">import CreateML<br/>import CreateMLUI</span><span id="eb63" class="ns mb iu lz b gz or oo l op oq">var data = try MLDataTable(contentsOf: URL(fileURLWithPath: "path/to/your/file/movie_metadata.csv"))</span></pre><p id="f1f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在操场上运行上述代码时，您可以在操场预览中查看表格数据，如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj os"><img src="../Images/3afdc8f9e0795daf7030168f25dcec33.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*dQ7tUx1lhIX3cMqdfIrFOA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">我们已经使用了来自Kaggle的<a class="ae kz" href="https://www.kaggle.com/carolzhangdc/imdb-5000-movie-dataset/kernels" rel="noopener ugc nofollow" target="_blank"> IMDB数据集</a></p></figure><p id="996a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要获得列名和类型，只需使用getter属性<code class="fe lw lx ly lz b">columnNames</code>和<code class="fe lw lx ly lz b">columnTypes</code>。</p><p id="f462" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此外，我们可以在<code class="fe lw lx ly lz b">MLDataTable</code>初始化器中设置我们自己的解析选项。通过<code class="fe lw lx ly lz b">skipRows</code>、<code class="fe lw lx ly lz b">selectColumns</code>、<code class="fe lw lx ly lz b">maxRows</code>等选项，我们可以将数据从文件过滤到我们的表中。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ot ou l"/></div></figure></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="1ad9" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">字典到数据集</h1><p id="97a3" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">列名和数据值的字典(符合<code class="fe lw lx ly lz b">MLDataValueConvertible</code>协议)也可以转换成<code class="fe lw lx ly lz b">MLDataTable</code>。下面的代码创建了一个由三行两列组成的虚拟电影数据集:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="ac6d" class="ns mb iu lz b gz on oo l op oq">let movieData: [String: MLDataValueConvertible] = [</span><span id="8299" class="ns mb iu lz b gz or oo l op oq">"Title": ["Titanic", "Shutter Island", "Warriors"],<br/>"Director": ["James Cameron", "Martin Scorsese", "Gavin O'Connor"]</span><span id="f527" class="ns mb iu lz b gz or oo l op oq">]</span><span id="901b" class="ns mb iu lz b gz or oo l op oq">var movieTable = try MLDataTable(dictionary: movieData)</span></pre></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="a8c0" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">派生新的数据表</h1><p id="5749" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">MLDataTable可以被拆分、合并或转换，以生成一个全新的数据表。</p><h2 id="ebe8" class="ns mb iu bd mc nt nu dn mg nv nw dp mk lj nx ny mm ln nz oa mo lr ob oc mq od bi translated">拆分和排序表格</h2><p id="d40e" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">以下代码用于将<code class="fe lw lx ly lz b">MLDataTable</code>分成训练和测试数据集，用于模型训练和评估:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="ddbf" class="ns mb iu lz b gz on oo l op oq">let (trainingData, testingData) = data.randomSplit(by: 0.8, seed: 5)</span></pre><p id="dd39" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">MLDataTable可以按特定列排序，以产生新的ml datatable:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="ce04" class="ns mb iu lz b gz on oo l op oq">data = data.sort(columnNamed: "director_name")</span></pre><h2 id="3e3a" class="ns mb iu bd mc nt nu dn mg nv nw dp mk lj nx ny mm ln nz oa mo lr ob oc mq od bi translated">合并两个表格</h2><p id="b1b0" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">像推荐系统中的数据集经常需要这样。为此，我们可以使用:</p><ul class=""><li id="0914" class="mx my iu lc b ld le lg lh lj mz ln na lr nb lv nc nd ne nf bi translated"><code class="fe lw lx ly lz b">func append(contentsOf: MLDataTable)</code> —在当前<code class="fe lw lx ly lz b">MLDataTable</code>的末尾添加一个新表格</li><li id="08e4" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated"><code class="fe lw lx ly lz b">func join(with: MLDataTable, on columnsNamed: [], type: .inner)</code> —根据匹配的列合并行。如果columnNames设置为空，则假定连接中的所有列。</li></ul></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="404d" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">CRUD操作</h1><p id="f95a" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">在数据处理中，执行诸如添加、删除、更新列和数据之类的操作是一个相当常见的用例。为此，MLDataTable为我们提供了以下函数。</p><h2 id="7d74" class="ns mb iu bd mc nt nu dn mg nv nw dp mk lj nx ny mm ln nz oa mo lr ob oc mq od bi translated">添加、删除、重命名列</h2><p id="3234" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">要向MLDataTable添加一列，只需追加由行值组成的<code class="fe lw lx ly lz b">MLDataColumn</code>。以下代码使用一个新列将电影字典扩展到我们之前创建的MLDataTable数据集:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="8cfd" class="ns mb iu lz b gz on oo l op oq">var movieTable = try MLDataTable(dictionary: movieData)</span><span id="428c" class="ns mb iu lz b gz or oo l op oq">let genreColumn = MLDataColumn(["Drama", "Thriller", "Drama"])</span><span id="157d" class="ns mb iu lz b gz or oo l op oq">movieTable.addColumn(genreColumn, named: "Genre")</span></pre><p id="a2a9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要删除一个列，我们只需调用带有列名字符串的<code class="fe lw lx ly lz b">MLDataTable</code>实例上的<code class="fe lw lx ly lz b">removeColumn</code>方法。</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="f7e9" class="ns mb iu lz b gz on oo l op oq">movieTable.removeColumn(named: “Genre”)</span></pre><p id="3392" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要将现有列重命名为新名称，只需调用MLDataTable实例上的<code class="fe lw lx ly lz b">func renameColumn(named: String, to: String)</code>函数。</p><h2 id="0cd3" class="ns mb iu bd mc nt nu dn mg nv nw dp mk lj nx ny mm ln nz oa mo lr ob oc mq od bi translated">删除重复的行，填充缺失的列</h2><p id="cc4d" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">虽然Panda提供了诸如<code class="fe lw lx ly lz b">fillna()</code>和<code class="fe lw lx ly lz b">drop_duplicates</code>之类的函数来填充缺失的列值，并根据某一组条件删除重复的行，但是MLDataTable具有以下等效方法:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="79c5" class="ns mb iu lz b gz on oo l op oq">movieTable.dropDuplicates()</span><span id="05d8" class="ns mb iu lz b gz or oo l op oq">movieTable.fillMissing(columnNamed: "Title", with: MLDataValue.string("NA"))</span></pre><p id="9005" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe lw lx ly lz b">dropDuplicates</code>函数删除重复项并返回一个包含所有重复行的<code class="fe lw lx ly lz b">MLDataTable</code>。此外，函数<code class="fe lw lx ly lz b">dropMissing</code>用于删除缺少值的行。</p><blockquote class="ov ow ox"><p id="0c3c" class="la lb oy lc b ld le jv lf lg lh jy li oz lk ll lm pa lo lp lq pb ls lt lu lv in bi translated">要将一列转换成一个新列，我们可以使用map函数，该函数允许以线程安全的方式更新所有行。</p></blockquote></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="aa2a" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">数据可视化和导出</h1><p id="4b7e" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">使用MLDataTable实例上的<code class="fe lw lx ly lz b">show()</code>函数，我们可以在我们的操场上以可视化方式查看表格数据，如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pc"><img src="../Images/2864a06886c5ab5a134bee60c5fdbd98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttQA_0wT1MyVzNdutyNsgQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">目前，它显示MLDataTable的第一列的可视化效果。</p></figure><p id="c620" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，可以使用<code class="fe lw lx ly lz b">write</code>函数将MLDataTable导出为CSV或JSON文件。许多创建ML应用程序模板需要CSV格式，因此以下函数相当重要:</p><pre class="kk kl km kn gu oj lz ok ol aw om bi"><span id="d10d" class="ns mb iu lz b gz on oo l op oq">try trainingData.writeCSV(to: URL(fileURLWithPath: "path/file.csv"))</span></pre></div><div class="ab cl nl nm hy nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="in io ip iq ir"><h1 id="cf42" class="ma mb iu bd mc md oe mf mg mh of mj mk ka og kb mm kd oh ke mo kg oi kh mq mr bi translated">结论</h1><p id="3842" class="pw-post-body-paragraph la lb iu lc b ld ms jv lf lg mt jy li lj mu ll lm ln mv lp lq lr mw lt lu lv in bi translated">因此，我们已经探索了MLDataTable的不同用例，并看到了对于希望加入机器学习潮流的移动开发人员来说，使用这个令人敬畏的Create ML结构是多么容易。</p><p id="075c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这篇文章中分享MLDataTable的重要性的想法是在我创作另一个<a class="ae kz" href="https://towardsdatascience.com/classifying-movie-reviews-with-natural-language-framework-12dfe2fc3308" rel="noopener" target="_blank">故事</a>时产生的。如果时间旅行是可能的，我会重写这段代码，使用MLDataTable代替Pandas进行数据集导入和导出来创建ML。</p><p id="c69a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这一次到此为止。我希望你喜欢阅读。</p></div></div>    
</body>
</html>