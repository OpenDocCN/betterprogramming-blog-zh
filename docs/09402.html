<html>
<head>
<title>4 Steps To Dockerize Your Node.js Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Node.js应用程序分类的4个步骤</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-steps-to-dockerize-your-node-js-apps-c70037da1099?source=collection_archive---------7-----------------------#2021-08-19">https://betterprogramming.pub/4-steps-to-dockerize-your-node-js-apps-c70037da1099?source=collection_archive---------7-----------------------#2021-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e06b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Node.js应用程序快速归档指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7fee55426abd576bc76a772d364d4f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ssmo57XqCM9AICLz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@felix_tch?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">菲利克斯·奇弗金</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="95ea" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是码头集装箱？</h1><p id="13b8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">容器是软件的一个单元，它帮助我们紧凑地打包代码和依赖关系。这样做的主要优势在于，它有助于我们的应用在各种环境中高效可靠地运行。</p><p id="7d9a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我们打包代码和依赖项时，会创建一个Docker映像。这个映像包含了我们的应用程序运行所需的一切，包括系统工具和库。</p><p id="2c28" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我们构建并运行这些映像时，它们就变成了Docker容器。再次强调，这样做的巨大优势是帮助我们的软件以完全相同的方式运行，无论您使用的是什么操作系统——是Linux还是Windows等。Docker容器帮助我们提供的这种一致性至关重要，尤其是在为生产部署应用程序时。</p><p id="d7fc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最近，容器化应用程序在很大程度上取代了通过虚拟机(VM)运行应用程序的传统方法。虚拟机需要底层操作系统的完整副本才能运行，您可以想象系统的库、工具等的总体副本需要多少空间。会消耗！</p><p id="8f84" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想了解更多，Preethi Kasireddy 已经写了一篇关于Docker、容器和VMs <a class="ae ky" href="https://medium.com/free-code-camp/a-beginner-friendly-introduction-to-containers-vms-and-docker-79a9e3e119b" rel="noopener">的精彩、详细、易懂的文章。一定要去看看！</a></p><h1 id="0ea8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第一步。启动一个简单的Node.js应用程序</h1><p id="d4d5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们在Node.js上创建一个简单的样板应用程序。要了解有关express-generator的更多信息，请访问此<a class="ae ky" href="https://expressjs.com/en/starter/generator.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="37a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">打开终端，创建一个目录文件夹(如my-app)并使用下面的命令来启动我们的应用程序。请注意，这需要Node.js 8.2.0或更高版本才能工作。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="731d" class="mz la it mv b gy na nb l nc nd">npx express-generator</span></pre><p id="8ca0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">就这样，我们将有一个功能性的Node.js，基于Express的应用程序准备运行。要测试它，运行<code class="fe ne nf ng mv b">npm run start</code>。</p><p id="e036" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，访问localhost:3000，它应该给出“欢迎使用Express”消息。</p><h1 id="f784" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第二步。添加Dockerfile文件</h1><p id="9e87" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">接下来，我们将向我们的存储库添加一个docker文件。创建一个名为<code class="fe ne nf ng mv b">Dockerfile</code>的新文件，并向其中添加以下内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="ced7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Dockerfile文件非常简单明了。在代码序列中，我们是:</p><ol class=""><li id="9567" class="nj nk it lt b lu mn lx mo ma nl me nm mi nn mm no np nq nr bi translated"><code class="fe ne nf ng mv b">FROM node:14.17.0</code>:使用Node.js 14.17.0镜像。您可以修改版本以使用适合您的应用程序，或者只使用<code class="fe ne nf ng mv b">node:latest</code>获得最新版本。这将从Docker Hub中选取一个图像，Docker Hub是Docker图像的全球存储库。我们选择的图像基于Ubuntu操作系统。</li><li id="6031" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">我们用<code class="fe ne nf ng mv b">mkdir</code>命令在路径<code class="fe ne nf ng mv b">/usr/src/app</code>下创建一个工作目录(如果它还不存在的话)。这有助于我们设置在下面的命令中将会发生什么。</li><li id="2fac" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">我们将所有必需的包文件，即<code class="fe ne nf ng mv b">package.json</code>和<code class="fe ne nf ng mv b">package-lock.json</code>，复制到工作目录，并在容器中安装依赖项。</li><li id="5b62" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">我们将剩余的源文件复制到工作目录中。</li><li id="f29d" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">我们构建应用程序，并通过打开容器上的端口<code class="fe ne nf ng mv b">3000</code>来公开它。</li><li id="33ea" class="nj nk it lt b lu ns lx nt ma nu me nv mi nw mm no np nq nr bi translated">我们使用命令<code class="fe ne nf ng mv b">npm start</code>运行应用程序。您可以将其更改为<code class="fe ne nf ng mv b">npm run dev</code>或任何适合您在<code class="fe ne nf ng mv b">package.json</code>中定义的脚本的名称。</li></ol><p id="ba7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意:</strong>如果您使用<code class="fe ne nf ng mv b">yarn</code>而不是<code class="fe ne nf ng mv b">npm</code>，只需更新各自的命令(例如用<code class="fe ne nf ng mv b">yarn install</code>而不是<code class="fe ne nf ng mv b">npm install</code>)。</p><p id="4dd4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们也添加一个<code class="fe ne nf ng mv b">.dockerignore</code>文件，这样我们在<code class="fe ne nf ng mv b">.node_modules</code>文件夹中的模块依赖关系就不会被复制。我们将在容器本身上安装这些依赖项。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="6fb4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第三步。添加Docker合成文件</h1><p id="c9d8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Docker Compose是一个运行多容器应用程序的工具。我们可以添加这个来协调我们的应用程序和Docker引擎。</p><p id="6027" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们将下面的代码片段作为<code class="fe ne nf ng mv b">docker-compose.yml</code>添加到项目目录的根目录下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="36c9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第四步。运行应用程序</h1><p id="4ce2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要运行该应用程序，我们在项目目录的根目录下使用以下命令:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="86fc" class="mz la it mv b gy na nb l nc nd">docker-compose up -d --build</span></pre><p id="934f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该命令构建映像，并以分离模式(即在后台)将其作为容器启动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/71f7767b6fb480817bdaa565ed682add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0by2PRvvrFad7puVakBsg.png"/></div></div></figure><p id="accf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要查看正在运行的容器，请使用:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="e9a5" class="mz la it mv b gy na nb l nc nd">docker ps -a</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/938e72995078296843d3557c618380ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RH8CR6zijoPzwvHxwZ_Zcg.png"/></div></div></figure><p id="0fca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要查看容器的码头，请使用:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="7e97" class="mz la it mv b gy na nb l nc nd">docker logs -f &lt;container_id&gt;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/dbc4f18e10322ad6a5a27362574671e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Iv-LxhKAhJQV1KGF1_Utg.png"/></div></div></figure><h1 id="b1ab" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="4926" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这就对了。Node.js应用程序归档的简单四步指南。</p><p id="d564" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，您可能想知道如何配置Nginx反向代理和SSL(例如使用Let's Encrypt)。菲利普在这里写了一篇关于T21的文章。</p><p id="065f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Docker在打包你的应用和服务时非常强大和有用。尝试使用上述步骤来部署您的下一个应用程序，并在下面留下您的评论！</p><p id="eca9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">码头作业快乐！</p></div></div>    
</body>
</html>