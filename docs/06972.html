<html>
<head>
<title>How to Validate Complex Passwords in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中验证复杂密码</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-validate-complex-passwords-in-swiftui-b982cd326912?source=collection_archive---------2-----------------------#2020-11-23">https://betterprogramming.pub/how-to-validate-complex-passwords-in-swiftui-b982cd326912?source=collection_archive---------2-----------------------#2020-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6e23" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">联合起来救援</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/af1905078c72939cf4466e6de52b91e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F5KdEXJbb2XS5pyg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="7075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们仍然需要密码。强密码。</p><p id="1703" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">强密码意味着复杂的验证。</p><p id="7577" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">银行信息、家庭照片、电子邮件等。当敏感数据在墙后时，未经授权的访问是一个主要问题。因此，您比以往任何时候都更需要创建强而复杂的密码，并且还需要对它们进行验证。</p><p id="be79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将学习如何使用SwiftUI和Combine创建一个优秀的验证系统，以及其构建背后的主要原则。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4dbc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是验证系统？</h1><p id="5746" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">验证系统允许应用程序评估用户输入流，并根据一些规则决定该数据是否有效。</p><p id="57a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Face ID、触控ID等。这些令人印象深刻的技术改善了我们保护数据的方式。但是，即使在使用它们时，有时我们的业务逻辑也要求用户输入手动密码。而且密码必须很强。而强通常意味着复杂。</p><p id="48fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果用户不清楚如何使用复杂的密码，创建复杂的密码可能会很棘手。</p><p id="cdd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于这个原因，需要一个复杂的验证系统——它必须满足一些要求，使其安全并易于管理。</p><p id="8068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住这一点，让我们定义验证系统背后的主要原则。</p><h2 id="3ba4" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">真理的单一来源</h2><p id="2286" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">验证必须依赖于单个位置。<em class="nl">为什么？</em>如果在不止一个地方定义了验证，那么当你在几个屏幕上验证字段时，可能会在应用程序中产生错误和差异。</p><p id="d6d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nl">注意:虽然服务器端的验证是必须的，但是客户端的双重检查验证也很好，因为它可以更快、更好地响应内联验证。</em></p><h2 id="0a13" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">动态且可扩展</h2><p id="9ad5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">验证规则的定义可能会随着应用程序版本的变化而变化，因此在使验证适应任何新的业务需求时，一个灵活的系统可能会有所不同。</p><h2 id="6981" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">连续输入验证</h2><p id="b0fe" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">验证必须对用户输入的每个输入做出反应。反应性对于让用户理解输入内容的对错很重要。</p><h2 id="50a1" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">有用的输出</h2><p id="c465" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一个没有明确结果的验证是<em class="nl">无用的</em>。该系统必须提供一个结果显示给用户，它必须适应用户界面，以提供有用的信息。一些例子如下:</p><ul class=""><li id="39e9" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">总体进度:进度表示，让用户知道完成任务的剩余工作量。</li><li id="6776" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">验证状态:<em class="nl">验证成功还是失败？表格有效吗？</em>状态输出允许界面适当更新，给用户提供清晰的反馈。</li><li id="d421" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">详细信息:当处理复杂的数据或具体的业务需求时，显示详细的中间信息来指导用户完成整个过程可能会很有趣。</li><li id="b414" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">错误消息或指导:如果出现错误，用户需要知道下一步做什么以及如何解决问题。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cbe2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">密码验证</h1><p id="168b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦我们清楚地定义了我们的价值观，就该建立我们的密码验证系统了。</p><p id="cb62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，与验证相关的代码必须封装在一个外包装中。这个包将从一个<code class="fe oa ob oc od b">ViewModel</code>调用，它处理视图的业务逻辑，并与视图严格分离。</p><h2 id="318f" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">视图模型</h2><p id="1f5c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本例中，您创建了一个包含密码输入值的视图模型。<code class="fe oa ob oc od b">password</code>作为来自视图的输入。它在一个<code class="fe oa ob oc od b">ObservableObject</code>中被声明为<code class="fe oa ob oc od b">@Published</code>，所以这个变量的每一个变化都会触发验证流:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4973" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">验证规则</h1><p id="89fb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于此示例，要创建有效的密码，字符串必须满足以下要求:</p><ul class=""><li id="ed60" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">密码不得为空。</li><li id="2304" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">密码必须超过三个字符。</li><li id="1c04" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">密码必须至少有一个符号。</li><li id="8d0b" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">密码必须至少有一个大写字母。</li></ul><p id="fc18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的代码中，验证由三个相互关联的结构进行:</p><ul class=""><li id="4e77" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><code class="fe oa ob oc od b">Field</code>:需要验证的字段。根据评估的领域，要求可能会有所不同。</li><li id="e1ea" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe oa ob oc od b">ValidationState</code> : <strong class="lb iu"> </strong>验证的结果状态。当验证被处理时，它返回一个结果，表明它是如何进行的。</li><li id="fa38" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe oa ob oc od b">ValidationType</code>:定义显式案例的验证需求类型。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="c118" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">验证检查</h2><p id="664a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦定义了需求，下一步就是实现一个解决方案来检查需求的实现。在这种情况下，名为<code class="fe oa ob oc od b">fulfills(string)</code>的方法使用不同的验证规则来评估输入字符串(取决于类型)。</p><p id="fe7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nl">注意:在</em> <code class="fe oa ob oc od b"><em class="nl">init</em></code> <em class="nl">方法中可以看到，</em> <code class="fe oa ob oc od b"><em class="nl">state</em></code> <em class="nl">是使用</em> <code class="fe oa ob oc od b"><em class="nl">fulfills</em></code> <em class="nl">方法的结果设置的。这样，实现在结构之外是隐藏的。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="23cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于<code class="fe oa ob oc od b">hasSymbols</code>和<code class="fe oa ob oc od b">hasUppercasedLetters</code>评估，需要两个正则表达式(RegEx) <code class="fe oa ob oc od b">String</code>扩展:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1493" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">输入流</h1><p id="9160" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">SwiftUI的很大一部分依赖于Combine。正如<a class="ae ky" href="https://developer.apple.com/documentation/combine" rel="noopener ugc nofollow" target="_blank">苹果的文档所述</a>:</p><blockquote class="og"><p id="8bf9" class="oh oi it bd oj ok ol om on oo op lu dk translated">“Combine框架提供了一个声明性的Swift API，用于随时处理值。这些值可以表示多种异步事件。</p></blockquote><p id="c86e" class="pw-post-body-paragraph kz la it lb b lc oq ju le lf or jx lh li os lk ll lm ot lo lp lq ou ls lt lu im bi translated">有关联合收割机的更多信息，请遵循官方的<a class="ae ky" href="https://developer.apple.com/documentation/combine/receiving-and-handling-events-with-combine" rel="noopener ugc nofollow" target="_blank">文档指南</a>。</p><p id="aa23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Combine允许您接收连续的输入流(用户输入)，映射这个流，并生成一个结果。在这种情况下，<code class="fe oa ob oc od b">ViewModel</code>中涉及的过程如下:</p><p id="d4d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.<code class="fe oa ob oc od b"> @Published var password</code>将接收用户在视图中输入的连续流。</p><p id="3023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.这个密码输入将与<code class="fe oa ob oc od b">passwordPublisher</code>发布者相关联。该发布者将流式传输要处理的内容。</p><p id="2bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.在这种情况下，密码字符串将用于根据需要创建尽可能多的验证。这些验证包含评估给定字符串所需的所有信息。</p><p id="51aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.对于这种特殊情况，我们提供两种不同的输出:</p><ul class=""><li id="556e" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">原始<code class="fe oa ob oc od b">validations</code>值将用于显示中间进度反馈。在这种情况下，将显示验证列表及其更新状态。</li><li id="8252" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">一个<code class="fe oa ob oc od b">isValid</code>布尔值:<code class="fe oa ob oc od b">validations</code>数组被组合产生一个布尔值，该值指示该值是否有效。</li></ul><p id="a5bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.<strong class="lb iu"> </strong>该值将被设置为<code class="fe oa ob oc od b">isValid</code>，这将触发视图的更新。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2f48" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">验证输出</h1><p id="5df5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">既然字符串已经过验证，就该向视图返回一些有用的输出了。</p><p id="7be9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您已经向<code class="fe oa ob oc od b">isValid</code>返回了一个布尔值，但是关于验证失败时会发生什么的更多细节可能会对用户理解下一步该键入什么有用。</p><p id="524a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为<code class="fe oa ob oc od b">ValidationType</code>的一部分，一个<code class="fe oa ob oc od b">message(fieldName: String)</code>返回一个适当的错误信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="93e4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用户界面和最终结果</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/692ea8dd0a0765247773348996a3540d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ejhUirDjwopCvbMj-1i_mw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终用户界面Pablo Blanco</p></figure><p id="e48b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦验证系统完成，我们可以在SwiftUI视图中使用它。可以通过访问<code class="fe oa ob oc od b">userViewModel</code>属性来使用它。</p><p id="f22e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们显示一个包含三个主要元素的视图:</p><ul class=""><li id="bf5e" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">密码输入文本字段可以在位于右侧的眼睛按钮上的安全/标准点击之间切换。</li><li id="0e84" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">验证列表，指示每个验证的当前状态，以便向用户提供即时反馈。</li><li id="cf39" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">验证完成后，将启用提交按钮。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="80f2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="190e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Combine和SwiftUI是以简单的方式创建类似这些评估的复杂操作的优秀工具。</p><p id="7ace" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过遵循一些关于如何构建系统的基本原则，并注意所提供的输入和输出，评估复杂的密码变得简单明了！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c783" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从这里去哪里</h1><p id="0093" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您已经创建了一个基本的(但是强大的)验证系统。重大改进可能包括:</p><ul class=""><li id="81e0" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">异步评估(即将输入发送到服务器进行检查)。</li><li id="749f" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">意味着两次或更多次输入的验证(例如，两次要求输入密码)。</li></ul></div></div>    
</body>
</html>