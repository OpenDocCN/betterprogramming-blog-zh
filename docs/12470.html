<html>
<head>
<title>Creating a Slider Captcha to Prevent Bots From Sending Contact Requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个滑动验证码来阻止机器人发送联系请求</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-slider-captcha-to-prevent-bots-from-sending-contact-requests-e77d32ce1094?source=collection_archive---------17-----------------------#2022-06-07">https://betterprogramming.pub/creating-a-slider-captcha-to-prevent-bots-from-sending-contact-requests-e77d32ce1094?source=collection_archive---------17-----------------------#2022-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab04" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个简单的JavaScript和PHP解决方案来消除垃圾邮件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a80cffad7e5b6ca1a988d274fe064c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZpKYyIM3rzVlk82A9h6IA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建一个滑块验证码，并将其添加到我的网站，以消除通过联系形式的垃圾邮件。图片作者。</p></figure><p id="002f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很长一段时间以来，我一直通过网站上的联系方式收到非常烦人的垃圾邮件。提交联系请求只需要解一个简单的数学方程，但这并不十分有效。垃圾邮件发送者甚至懒得访问带有联系表单的页面。相反，他们计算出需要哪个POST请求，然后尝试随机数，直到他们猜出正确的解决方案。</p><p id="ba6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，在每天删除多封垃圾邮件几个月后，我决定做点什么来对抗它，并创建了一个滑动验证码来减少垃圾邮件。</p><h1 id="db76" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">验证码类型</h1><p id="0e07" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">你可以找到许多不同类型的验证码。首先，有扭曲的单词或字符的验证码，这可能会阻止机器人，也可能不会阻止机器人，但对大多数人来说，它们也很难解决。还有一种是“点击所有有摩托车的图片”,还有一种是你只需要点击一个复选框,“算法”就会判断出你是不是人。</p><p id="a46f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这两种情况都需要使用第三方解决方案，我会尽可能减少第三方工具的使用。</p><p id="8249" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">似乎最容易创建(也最不容易解决)的验证码类型是滑动验证码，你必须将图像中的拼图滑动到正确的位置。</p><h1 id="e855" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">创建滑块验证码</h1><p id="721b" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">滑块验证码是一个有两个主要元素的弹出窗口:带有滑动拼图块的图像和它下面的滑块。我想让验证码尽可能容易使用，所以所有必需的元素都是在JavaScript类中动态创建的，不需要定义HTML元素。</p><p id="b9f3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于图像和滑动拼图块，我使用了画布元素，因为它可以有效地重新绘制，而且我喜欢画布。虽然有默认的HTML滑块，但它们看起来很糟糕，所以我创建了一个自定义滑块元素，它只是另一个div中的一个div。内部div，即滑块旋钮，需要三个事件监听器，分别用于<code class="fe mr ms mt mu b">mousedown</code>、<code class="fe mr ms mt mu b">mousemove</code>和<code class="fe mr ms mt mu b">mouseup</code>。</p><p id="e199" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最有趣的一个是<code class="fe mr ms mt mu b">mousemove</code>，我们需要计算出鼠标被点击后移动的距离，并使用这个偏移量来移动滑块和拼图块。当释放鼠标按钮(<code class="fe mr ms mt mu b">mouseup</code>)时，我们必须检查拼图块是否在正确的位置，如果是，触发滑块验证码类的<code class="fe mr ms mt mu b">onsuccess</code>回调，否则触发<code class="fe mr ms mt mu b">onfail</code>。</p><p id="6014" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是slider captcha类的完整代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/caf4c39a8440bd2f3c4b4d4a9460a630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UPHiPHhM2GO3bLiv.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="my">滑块验证码在起作用。图片作者。</em></p></figure><h1 id="271f" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">使用验证码防止垃圾邮件</h1><p id="a3d6" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">如前所述，我的旧联系表单的最大问题之一是垃圾邮件发送者可以通过发送帖子请求而不访问页面来创建垃圾邮件。这是我想在新的基于验证码的解决方案中避免的事情。为此，使用PHP在服务器上创建两个随机位置值，并存储在会话中。这些位置然后被用于初始化滑块验证码。当它被正确求解时，值被添加到表单中并被提交。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">当提交联系表单时，初始化并显示滑动验证码。</p></figure><p id="5748" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在服务器上，我们没有办法验证验证码的正确性。我们看到的只是一个POST请求，它可能是通过解决captcha发送的，也可能来自垃圾邮件发送者的脚本。但是，我们可以通过检查会话变量是否存在以及POST值是否与它们匹配来检查联系人页面是否被访问过。这使得猜测POST请求的正确值变得非常不可能。两个值的误差为0.0001，有1，000，000种可能性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在服务器端检查滑块验证码。</p></figure><h1 id="a885" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">效果如何？</h1><p id="b060" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">不幸的是，验证码并不完美。市面上的大多数解决方案都可以自动解决，即使其中一个现在无法解决，几个月后也不会。当你谷歌滑动条验证码时，首先出现的结果是自动解决它们的<a class="ae mz" href="https://scraperbox.com/blog/solving-a-geetest-slider-captcha-with-puppeteer" rel="noopener ugc nofollow" target="_blank">方法</a>。</p><p id="febc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着我简单的自制解决方案也可以用一个脚本来规避。然而，与使用流行的第三方验证码相比，我的自定义解决方案具有优势。垃圾邮件发送者使用的脚本可能会破解市场领导者的验证码。</p><p id="77f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，能够解决一个流行的滑块验证码的同一个脚本不太可能也能解决我的。我的几乎肯定更容易打破，但它至少需要一点点的工作来做。</p><p id="4c25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">客观上，它不值得，因为我是唯一一个使用它的人。然而，也没有理由对我的旧解决方案进行逆向工程，所以我再次收到垃圾邮件可能只是时间问题。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><p id="2542" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我每天通过网站上的联系方式收到大量垃圾邮件，因为旧的基于数学的验证码无效。相反，我用JavaScript创建了一个新的slider captcha，并使用PHP会话来防止垃圾邮件发送者猜测POST请求。</p><p id="7416" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我肯定垃圾邮件发送者会在某个时候绕过新的解决方案，但至少现在，我没有从我的网站收到任何垃圾邮件联系请求。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><p id="0ecf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nh">最初发布于</em><a class="ae mz" href="https://pingpoli.de/slider-captcha" rel="noopener ugc nofollow" target="_blank"><em class="nh">https://ping poli . de</em></a><em class="nh">。</em></p></div></div>    
</body>
</html>