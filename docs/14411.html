<html>
<head>
<title>How ChatGPT’s Coding Skills Got Me Drunk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ChatGPT的编码技巧如何让我沉醉</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-chatgpt-got-me-drunk-614d72d37f6f?source=collection_archive---------0-----------------------#2022-12-12">https://betterprogramming.pub/how-chatgpt-got-me-drunk-614d72d37f6f?source=collection_archive---------0-----------------------#2022-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="945c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ChatGPT帮我搜集了鸡尾酒网站，创建了一个通用的饮料指数。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eec4e81f5f3e216d12d862c6d9210ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3An51deANnt3LXaaC_EwA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这张图片显然是由DALL-E生成的。</p></figure><p id="1504" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最近，我成了调制鸡尾酒的爱好者。在得到金钱可以买到的最好的设备和酒后，我意识到对我来说最大的障碍是鸡尾酒配方。我想要一个平台，在那里我可以输入我家里的配料，输出的将是我可以制作的鸡尾酒列表。有几个应用程序可以做到这一点，但它们的种类有限，除非你为应用程序付费。因为除了鸡尾酒，我唯一更喜欢的是免费的鸡尾酒，所以我在寻找一种替代品。</p><p id="ed52" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">大约在<a class="ae ls" href="https://openai.com/blog/chatgpt/" rel="noopener ugc nofollow" target="_blank"> ChatGPT </a>发布一周后，它已经成了我最好的朋友。也会是我的酒友吗？我意识到网上有很多食谱，我只需要正确地索引它们。ChatGPT能为我自己建立一个索引它们的工具吗？</p><p id="cbd8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">TLDR——是的，<a class="ae ls" href="https://github.com/galbash/drinkindex" rel="noopener ugc nofollow" target="_blank">这里是GitHub回购</a>。甚至还有ChatGPT生成的READMEs。</p><h1 id="e40e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">这个计划</h1><p id="5d26" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我决定试一试。我想使用ChatGPT构建一个简单的系统，从web上检索鸡尾酒。该解决方案包括两个部分:</p><ol class=""><li id="e386" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated">Crawler —获取要爬行的域并将看似鸡尾酒配方的URL输出到队列的过程。它还递归地跟踪页面上的其他URL来搜索其他包含食谱的页面。这似乎是一个足够简单的任务，让ChatGPT自己编写代码</li><li id="09dd" class="mq mr iq kx b ky mz lb na le nb li nc lm nd lq mv mw mx my bi translated">索引器(indexer)—该组件用于获取URL，确定页面是否包含鸡尾酒配方，并将其存储在数据库中。问题是，有鸡尾酒配方的博客是高度非结构化的，在到达重点之前有很多不必要的文字。ChatGPT能帮我理出这个乱七八糟的东西吗？</li></ol><p id="0b9e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了计划，我开始着手建设。我从建立架构开始，必须决定使用什么队列。ChatGPT前来救援:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/6d29751c7351fa8ecd096afe430237ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SImAI--Q7aO9VIDVq70jXA.png"/></div></div></figure><p id="965c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在回顾了它的建议之后，我决定使用RabbitMQ，因为我有一些使用它的经验。我请ChatGPT为我奠定基础:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/d3eb07682b5d69b614e3621b2c253218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZ5ihyWXW75FyICp6ITr2g.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/2fad53beaffe586f79b164d9b086dc9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVFlPI9fOX6YwjxmccqP2g.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/a714356ef0b1338260c7456b282c97fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9x4f1rJSeSP_vmqwoDPH_Q.png"/></div></div></figure><p id="9bc0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">随着项目的建立，ChatGTP的下一步是开发爬虫。</p><h1 id="46ba" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">爬虫</h1><p id="511d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我请ChatGPT为我做这项工作，好家伙，它做到了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/903ec5b33ba529d7e6c7fb6a79f3e1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0W0g09GWkCbva2m9Wvt8og.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/b58b514463508bb6680cf25d4d4f7a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXJZSRoup2Gb5VLI0AAWEg.jpeg"/></div></div></figure><p id="fb23" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我运行这个程序时，我遇到了两个问题。首先，被访问的URL没有被缓存，因为几乎所有的页面都链接到了主页，我们最终陷入了一个无限循环。我让ChatGPT来处理这个问题，它正确地修改了代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/56e709bdc541c0d73e140a9116244d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGEAyMrYF6uHchIoJpdlsw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/e5addac77b1e828a269354757b79f97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*t8n9IsX83fzpcKLE2bwF3A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">遗憾的是，我无法以更好的分辨率重现这一响应。</p></figure><p id="1468" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第二个问题是它也开始爬行其他域——例如，对于包含视频的页面，爬虫也开始爬行youtube。我要求ChatGTP也解决这个问题，它答应了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/19d1c0cec64bd7fa73ac12b82ce29873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jWL2q_uYnuBuBX8pJN9PeA.jpeg"/></div></div></figure><p id="e2d5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就这样了！爬虫已经准备好了，下一步是编写索引器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/1da6e8ff0990a6b62475999684426d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjxsZxmQU1dmDDIUDm9j3g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">爬虫输出。在识别食谱时有一些错误——下一步将处理这些错误。</p></figure><h1 id="faf8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">索引器</h1><p id="142e" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">正如我之前提到的，解析网页内容以识别它是否描述了鸡尾酒配方是一项挑战。这是一个鸡尾酒配方网页的例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/f00bffa5481f211bb19ca8b5a38b4b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8HhsrXMHmUn_5gkrSAXFQ.png"/></div></div></figure><p id="ab2f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">处理所有不同的用例来解析页面和提取成分几乎是不可能的。再一次——ChatGPT来拯救我们！</p><p id="dd57" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我偶然发现了ChatGPT API 的<a class="ae ls" href="https://github.com/acheong08/ChatGPT" rel="noopener ugc nofollow" target="_blank">非官方python实现，并决定在我的索引器中使用它。想法很简单，使用一个精心制作的提示，我应该能够使用ChatGPT从鸡尾酒页面提取配料。由于ChatGPT无法访问互联网，它无法编写这部分代码，但它确实帮助了我编写通用组件。以下是我使用的代码:</a></p><pre class="kg kh ki kj gt nk nl nm bn nn no bi"><span id="baaf" class="np lu iq nl b be nq nr l ns nt">import pika<br/>import time<br/>import sys<br/>import requests<br/>from bs4 import BeautifulSoup<br/>from revChatGPT.revChatGPT import Chatbot<br/>from db import CocktailRecipe, Ingredient, session<br/>import traceback<br/><br/>print(sys.argv)<br/>config = {<br/>    "session_token": sys.argv[1],<br/>    "cf_clearance": sys.argv[2],<br/>    "user_agent": sys.argv[3]<br/>}<br/><br/>chatbot = Chatbot(config, conversation_id=None)<br/><br/># connect to RabbitMQ<br/>connection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))<br/>channel = connection.channel()<br/><br/># create a queue to consume messages from, if it does not already exist<br/>channel.queue_declare(queue='drink_urls', durable=True)<br/><br/>QUESTION = """<br/>    From the following text below, please understand if it is an article<br/>    describing a cocktail recipe. If it is, output the following: The first<br/>    line should be: "&lt;cocktail name&gt;: &lt;ranking&gt;". If the ranking doesn't exist<br/>    output "-". use only lowercase letters and the generic name of the cocktail<br/>    , without mentioning brands. the following lines contain the ingredients:<br/>    each line should contain one ingredient and it's amount in the format<br/>    "&lt;ingredient&gt;: &lt;amount&gt;". The ingredient part (before the semicolon)<br/>    should contain only the ingredient name, not the amount. If it is not a<br/>    cocktail recepie, output only the word "no". Output the ingredients in <br/>    their generic name, and don't include a brand. For example, instead of <br/>    "bacardi white rum" output "white rum". All of the output should be lower<br/>    cased, don't capitalize any word. The text is: %s"""<br/><br/># define a callback function to process incoming messages<br/>def process_message(ch, method, properties, body):<br/>    time.sleep(5)<br/>    try:<br/>        print(body)<br/>        page = requests.get(body)<br/>        soup = BeautifulSoup(page.content, "html.parser")<br/>        <br/>        response = chatbot.get_chat_response(QUESTION % soup.text, output="text")['message']<br/>        if response == "no":<br/>            print("not a cocktail")<br/>            return<br/>        print(response)<br/>    except Exception:<br/>        print(traceback.format_exc())<br/><br/># consume messages from the queue, using the callback function to process them<br/>channel.basic_consume(queue='drink_urls', on_message_callback=process_message, auto_ack=True)<br/><br/># start consuming messages<br/>channel.start_consuming()</span></pre><p id="0cf4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这非常有效。ChatGPT很好地理解了一个页面是否包含鸡尾酒配方，如果包含，输出几乎总是正确的格式。我曾经认为用Python编码是显而易见的，但是从来没有<em class="lr">接近过。</em></p><p id="a85b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我只需要将它存储在数据库中。我让ChatGPT为我创建数据库:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/6721f0e53887cb1cb6ef658d3e742051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HEckQ8kk3gG5pSfTyZ90WA.png"/></div></div></figure><p id="6d84" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我给了它一个自己生成的样本输入，并让它编写将信息插入数据库的代码。它提供的最初实现是使用<code class="fe nu nv nw nl b">psycopg2</code>。我让它使用<code class="fe nu nv nw nl b">SQLAlchemy</code>,因为我发现使用ORM更容易:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/7a1857c926f2f385e0a245e3ccae3b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*sbBMj6boKgCLbTQdGF8oxA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/2ede1617200101d4b786e9a96b9d6bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WpzhmmKrUrRZxYSEKdVJQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">注意，ChatGPT也为我编写了响应的解析逻辑</p></figure><p id="6aef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我将这段代码集成到索引器中，终于有了我梦想中的鸡尾酒数据库！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/774be1562683de3d6a90ae41130b267c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8klY8oRMRaQTN_aVy2I8A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">索引器进程的输出示例</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/631ba04a7a6e74e381b35cd3385b0735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHXclg-M6f6EvfNu9R22Mw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我的鸡尾酒数据库视图</p></figure><p id="8ef8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我将使用ChatGPT来帮助我创建一个API和UI来浏览鸡尾酒数据库，并选择我今天想要制作的鸡尾酒。</p><h1 id="c299" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="f2bb" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">整个项目从头到尾花了我大约3个小时。ChatGPT加速我开发过程的能力让我大吃一惊。最大的胜利是ChatGPT提供的文本解析，这是我自己做不到的，ChatGPT使它变得简单了。</p><p id="facc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，任务越复杂，ChatGPT正确完成任务的几率就会急剧下降。当与ChatGPT配对时，开发人员的工作仍然是将工作分解成足够小的任务，至少目前是这样。</p><p id="a085" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我很期待接下来会发生什么！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/86a0160ff1e4a0ead2cc13e0f443e802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYqO5UZeFqPu3b4VG_8kSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我要求ChatGPT重写结论。谁做得更好？</p></figure><p id="127c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">DrinkIndex第二部出来了！点击这里查看。</p></div></div>    
</body>
</html>