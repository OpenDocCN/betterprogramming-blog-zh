<html>
<head>
<title>NPM Package: Zero to Hero</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NPM套餐:从零到英雄</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/npm-package-from-zero-to-hero-5a2e73fa1394?source=collection_archive---------15-----------------------#2019-07-31">https://betterprogramming.pub/npm-package-from-zero-to-hero-5a2e73fa1394?source=collection_archive---------15-----------------------#2019-07-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b2d3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为React.js创建一个NPM包</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/898d7f15171034f5f285496b46e477d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zsHeug0WFqHbgpIMSE6yGg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@geralt" rel="noopener ugc nofollow" target="_blank"> Gerd Altmann </a>在<a class="ae ky" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><h1 id="e673" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="11ca" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本教程中，我们将使用create-react-app为React创建一个NPM包，然后使用Travis和Heroku配置CI/CD。</p><p id="9b2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将创建最简单的包:Hello World。本文并不是向您展示如何为您的包编写代码，而是演示如何发布您的NPM包、编写测试和配置CI/CD。</p><h1 id="6471" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">开始一个项目</strong></h1><p id="bbc7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们需要使用<a class="ae ky" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>创建一个项目。这是基于<a class="ae ky" href="https://github.com/facebook/react" rel="noopener ugc nofollow" target="_blank"> React </a>库启动应用程序的最佳方式。根据<a class="ae ky" href="https://facebook.github.io/create-react-app/" rel="noopener ugc nofollow" target="_blank">文档</a>，引擎盖下create-react-app使用<a class="ae ky" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> Webpack </a>、<a class="ae ky" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel </a>、<a class="ae ky" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> EsLint </a>等项目。您不需要学习和配置许多构建工具。您可以只使用一个命令来创建自己的React应用程序，但是如果您想要高级配置，您可以从Create React App直接编辑它们的配置文件。</p><p id="d3cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在创建包之前，让我们打开终端并转到存储项目的文件夹。然后，我们将创建我们的<a class="ae ky" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>包:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0113" class="na la it mv b gy nb nc l nd ne">npx create-react-app react-salute<br/>cd react-salute<br/>npm start</span></pre><p id="c8a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以打开<a class="ae ky" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>查看我们的app了。</p><p id="8946" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">运行这些命令会创建一个名为<code class="fe ms mt mu mv b">react-salute</code>的React应用程序。这是生成初始项目结构和安装可传递依赖项的地方:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="babe" class="na la it mv b gy nb nc l nd ne">react-salute<br/>├── README.md<br/>├── node_modules<br/>├── package.json<br/>├── .gitignore<br/>├── public<br/>│   ├── favicon.ico<br/>│   ├── index.html<br/>│   └── manifest.json<br/>└── src<br/>    ├── App.css<br/>    ├── App.js<br/>    ├── App.test.js<br/>    ├── index.css<br/>    ├── index.js<br/>    ├── logo.svg<br/>    └── serviceWorker.js</span></pre><p id="ae58" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，没有复杂的文件夹结构，也不需要配置。一切都很简单。</p><h1 id="6316" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">建造图书馆</strong></h1><p id="f189" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们使用一个<code class="fe ms mt mu mv b">src</code>文件夹作为我们包中的主文件夹。这是我们存储源代码、示例和测试的地方。</p><p id="f786" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，让我们创建一个文件夹<code class="fe ms mt mu mv b">src/lib</code>并将包含以下内容的<code class="fe ms mt mu mv b">index.js </code>文件放入其中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">src/lib/索引. js</p></figure><blockquote class="nh ni nj"><p id="469f" class="lr ls nk lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">尽管有<code class="fe ms mt mu mv b"><em class="it">examples</em></code>和<code class="fe ms mt mu mv b"><em class="it">__tests__</em></code>文件夹，<code class="fe ms mt mu mv b"><em class="it">lib</em></code>文件夹将被用来上传到NPM。</p></blockquote><p id="4e8f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">干得好！我们已经创建了一个告诉我们<code class="fe ms mt mu mv b">Salute React!</code>的组件，在这里我们可以通过向组件传递<code class="fe ms mt mu mv b">name</code>参数来更改<code class="fe ms mt mu mv b">React</code>单词。该代码将被编译并发布到NPM。</p><p id="8fd0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我们需要一些本地检查组件的方法。为此，我们创建一个文件夹<code class="fe ms mt mu mv b">/src/examples</code>和一个<code class="fe ms mt mu mv b">index.js</code>文件，内容如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">src/examples/index.js</p></figure><p id="f196" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">很简单——我们导入我们的库并创建两个使用它的例子。</p><p id="5d7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，为了让事情顺利进行，让我们修复<code class="fe ms mt mu mv b">/src/index.js</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">src/index.js</p></figure><p id="f415" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要查看结果，让我们运行<code class="fe ms mt mu mv b">npm start</code>并在浏览器中转到<a class="ae ky" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>。</p><p id="f643" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">起作用了。太好了！</p><blockquote class="nh ni nj"><p id="6c15" class="lr ls nk lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">我们可以从<code class="fe ms mt mu mv b">/src</code>目录中删除<code class="fe ms mt mu mv b">App.css, App.js, App.test.js, index.css, logo.svg, serviceWorker.js</code>。</p></blockquote><p id="34e5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们继续下一步，为我们的包创建一些测试。</p><h1 id="dfeb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">测试</h1><p id="e73d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本章中，我们将遵循create-react-app <a class="ae ky" href="https://facebook.github.io/create-react-app/docs/running-tests" rel="noopener ugc nofollow" target="_blank">测试文档</a>。</p><p id="0482" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了测试我们的包，我们将使用<a class="ae ky" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a> + <a class="ae ky" href="https://airbnb.io/enzyme/" rel="noopener ugc nofollow" target="_blank"> Enzyme </a>。</p><p id="8127" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk">酵素支持</em> <a class="ae ky" href="https://airbnb.io/enzyme/docs/api/mount.html" rel="noopener ugc nofollow" target="_blank"> <em class="nk">与</em> </a> <code class="fe ms mt mu mv b"><a class="ae ky" href="https://airbnb.io/enzyme/docs/api/mount.html" rel="noopener ugc nofollow" target="_blank"><em class="nk">mount()</em></a></code> <em class="nk">全渲染，还可以用它来测试状态变化和组件生命周期。</em></p><p id="9727" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们安装<code class="fe ms mt mu mv b">enzyme</code>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="dccb" class="na la it mv b gy nb nc l nd ne">npm install --save-dev enzyme enzyme-adapter-react-16</span></pre><p id="fa9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk">从Enzyme 3开始，您将需要安装Enzyme以及与您正在使用的React版本相对应的适配器。</em></p><p id="c52e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk"> Create React应用程序使用Jest作为它的测试运行程序，所以它已经安装了</em> d。</p><p id="a7b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">适配器也需要在我们的全局设置文件中进行配置。为此，我们用以下代码创建一个<code class="fe ms mt mu mv b">src/setupTests.js</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe ms mt mu mv b">src/setupTests.js</code></p></figure><p id="3ad9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当运行<code class="fe ms mt mu mv b">npm test</code>命令时，Jest将查找具有以下任何流行命名约定的测试文件:</p><ul class=""><li id="cb85" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">__tests__</code>文件夹中带有<code class="fe ms mt mu mv b">.js</code>后缀的文件。</li><li id="4837" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">后缀为<code class="fe ms mt mu mv b">.test.js</code>的文件。</li><li id="81dc" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated">带有<code class="fe ms mt mu mv b">.spec.js</code>后缀的文件。</li></ul><p id="35a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">.test.js</code> / <code class="fe ms mt mu mv b">.spec.js</code>文件(或<code class="fe ms mt mu mv b">__tests__</code>文件夹)可以位于<code class="fe ms mt mu mv b">src</code>顶层文件夹下的任意深度。</p><p id="483e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以编写测试了。将<code class="fe ms mt mu mv b">index.js</code>文件放入<code class="fe ms mt mu mv b">src/__tests__</code>文件夹，内容如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">src/__tests__/index.js</p></figure><blockquote class="nh ni nj"><p id="22e4" class="lr ls nk lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">我们已经创建了三个测试用例。第一种情况检查默认消息<code class="fe ms mt mu mv b">Salute React!</code>。第二个检查消息是否通过<code class="fe ms mt mu mv b">name</code>。最后一个检查<code class="fe ms mt mu mv b">name</code>参数变化。</p></blockquote><p id="887b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的测试准备好了，让我们运行它们:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9c0b" class="na la it mv b gy nb nc l nd ne">npm test</span></pre><p id="4012" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们应该在控制台中看到类似这样的内容:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="18a3" class="na la it mv b gy nb nc l nd ne">PASS  src/__tests__/index.js<br/>  &lt;ReactSalute /&gt;<br/>    ✓ Check default message (7ms)<br/>    ✓ Check message passed through props (1ms)<br/>    ✓ Check reset props (32ms)</span><span id="6c17" class="na la it mv b gy oc nc l nd ne">Test Suites: 1 passed, 1 total<br/>Tests:       3 passed, 3 total<br/>Snapshots:   0 total<br/>Time:        2.598s<br/>Ran all test suites.</span><span id="8dcd" class="na la it mv b gy oc nc l nd ne">Watch Usage: Press w to show more.</span></pre><p id="f5bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">测试已经通过，我们可以继续前进。</p><h1 id="3226" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">出版</h1><p id="2802" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们需要做的第一件事是准备我们的NPM方案——或者更具体地说，是编译它。为此，我们安装了<code class="fe ms mt mu mv b">babel-cli</code>,这样我们就可以使用CLI编译我们的项目:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9312" class="na la it mv b gy nb nc l nd ne">npm install --save-dev @babel/cli</span></pre><p id="f8b6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于我们使用了 <code class="fe ms mt mu mv b"><em class="nk">create-react-app</em></code> <em class="nk">，所有其他的babel的依赖项都已经安装好了——我们不需要担心它们。</em></p><p id="990e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们需要告诉<code class="fe ms mt mu mv b">babel</code>如何正确处理我们的代码。为此，我们使用<code class="fe ms mt mu mv b">presets</code>。让我们用以下内容创建一个<code class="fe ms mt mu mv b">.babelrc</code>文件:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0b8d" class="na la it mv b gy nb nc l nd ne">{ "presets": ["react-app"] }</span></pre><p id="a78a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如你所见，我们只指定了一个预置:<code class="fe ms mt mu mv b">react-app</code>。这在开发react应用程序时是必需的。</p><p id="3a08" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了让我们能够从任何平台发布我们的包，我们需要安装<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/kentcdodds/cross-env" rel="noopener ugc nofollow" target="_blank">cross-env</a></code>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0659" class="na la it mv b gy nb nc l nd ne">npm install --save-dev cross-env</span></pre><p id="e83f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后我们将以下命令添加到<code class="fe ms mt mu mv b">package.json</code>中的<code class="fe ms mt mu mv b">scripts</code>部分:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="96a4" class="na la it mv b gy nb nc l nd ne">"scripts": {<br/>  ...<br/>  "prepublishOnly": "cross-env NODE_ENV=production babel src/lib --out-dir dist"<br/>},</span></pre><p id="288c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">prepublishOnly</code> —在包装准备和包装之前运行，仅在<code class="fe ms mt mu mv b">npm publish</code>运行。在我们的例子中，我们指定告诉<code class="fe ms mt mu mv b">babel</code>将代码编译到一个<code class="fe ms mt mu mv b">dist</code>文件夹中，该文件夹将被推送到NPM。</p><p id="d75e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们定制我们的包。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3796" class="na la it mv b gy nb nc l nd ne">"name": "react-salute",<br/>"version": "0.0.1",<br/>"main": "./dist/index.js",<br/>"keywords": [<br/>  "react",<br/>  "salute",<br/>  "react-salute",<br/>  "hello",<br/>  "world",<br/>  "prop-types"<br/>],<br/>"repository": {<br/>  "type": "git",<br/>  "url": "https://github.com/fedoryakubovich/react-salute"<br/>},<br/>"author": {<br/>  "name": "Fedor Yakubovich",<br/>  "url": "https://github.com/fedoryakubovich"<br/>},<br/>"bugs": {<br/>  "url": "https://github.com/fedoryakubovich/react-salute/issues"<br/>},<br/>"files": [<br/>  "dist/index.js",<br/>  "README.md",<br/>  "LICENSE",<br/>  "package.json"<br/>],<br/>"license": "MIT"<br/>...</span></pre><p id="2965" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk">让我们来分析一下它是如何工作的:</em></p><ul class=""><li id="6644" class="no np it lt b lu mn lx mo ma nq me nr mi ns mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">name</code> —我们包裹的名称。发布到<code class="fe ms mt mu mv b">npm</code>时的必填字段。在我们的例子中是<code class="fe ms mt mu mv b">react-salute</code>。</li><li id="f246" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">version</code> —我们包的版本。发布到<code class="fe ms mt mu mv b">npm</code>时的必填字段。我们每次发布自己的包，版本一定要和之前的不一样，不然就会出错。</li><li id="2976" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">main</code> —主字段是模块ID，它是程序的主要入口点。在我们的例子中是<code class="fe ms mt mu mv b">/dist/index.js</code>。</li><li id="4dff" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">keywords</code> —一个字符串数组，当您的包在<em class="nk"> npm搜索</em>中列出时，人们会发现它。</li><li id="73ea" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">repository</code> —链接到源代码。</li><li id="2072" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">author</code>—链接到作者的个人资料。</li><li id="0732" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">bugs</code>—项目问题跟踪器的URL和/或问题应报告到的电子邮件地址。</li><li id="ebeb" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">files</code> —一些特殊的文件和目录也被包含或排除，不管它们是否存在于<code class="fe ms mt mu mv b">files</code>数组中。</li><li id="bb3d" class="no np it lt b lu nx lx ny ma nz me oa mi ob mm nt nu nv nw bi translated"><code class="fe ms mt mu mv b">license</code> —包的许可。</li></ul><blockquote class="nh ni nj"><p id="aa4d" class="lr ls nk lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">我们必须从<code class="fe ms mt mu mv b">package.json</code>中删除private: true。否则，NPM将拒绝出版它。</p></blockquote><p id="c529" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk">你可以在下面可用的链接上看到</em> <code class="fe ms mt mu mv b"><em class="nk">package.json</em></code> <em class="nk">的高级设置:</em><a class="ae ky" href="https://docs.npmjs.com/files/package.json" rel="noopener ugc nofollow" target="_blank"><em class="nk">https://docs.npmjs.com/files/package.json</em></a><em class="nk">。</em></p><p id="88bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我们需要将我们的包发布到NPM。我们必须在https://www.npmjs.com/网站上注册。所以，如果你还没有注册，让我们开始吧！</p><p id="a4c9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注册后，输入以下命令，并在系统询问时输入您的帐户数据:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0828" class="na la it mv b gy nb nc l nd ne">npm login</span></pre><p id="bc11" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个命令告诉你PC上安装的<code class="fe ms mt mu mv b">npm</code>你是谁，你将代表谁发布你的包。</p><p id="53a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们通过运行以下命令来发布我们的包:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="73de" class="na la it mv b gy nb nc l nd ne">npm publish</span></pre><p id="0c1b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">太好了，我们已经发布了我们的包！</p><h1 id="f8da" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">配置Travis CI</h1><p id="12b6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这一章中，我们不会停下来解释持续集成。如果您不熟悉这一概念，尤其是Travis CI，请在这里阅读<a class="ae ky" href="https://docs.travis-ci.com/user/for-beginners/" rel="noopener ugc nofollow" target="_blank">核心概念</a>。不会花你太多时间。</p><p id="7cdd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们必须在https://travis-ci.com/注册。我们只需要把我们的GitHub账户和Travis CI联系起来。</p><blockquote class="nh ni nj"><p id="fcf3" class="lr ls nk lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">我们将使用<a class="ae ky" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>来存储我们的包，因为只有GitHub与Travis CI集成。</p></blockquote><p id="243c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注册之后，我们需要将Travis的配置文件添加到项目的根目录中。让我们用以下内容创建一个<code class="fe ms mt mu mv b">.travis.yml</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe ms mt mu mv b">src/.travis.yml</code></p></figure><p id="ba94" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这里，我们已经描述了应该在我们的项目中使用哪个Travis环境以及运行哪个命令。<code class="fe ms mt mu mv b">npm test</code>命令是在<code class="fe ms mt mu mv b">package.json</code>中指定的——如果我们想使用不同的命令进行测试，我们必须改变我们的<code class="fe ms mt mu mv b">.travis.yml</code>。</p><p id="f0fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们需要将我们的更改推送到GitHub，这应该会在我们的Travis中启动任务。如果它没有启动，我们可以转到我们的<a class="ae ky" href="https://travis-ci.com/dashboard" rel="noopener ugc nofollow" target="_blank">仪表板</a>，找到<code class="fe ms mt mu mv b">react-salute</code>存储库，并从右侧的下拉列表中选择<em class="nk">触发构建</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/dc315b3ecbfb6d0e352db1b3be4fa840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V0t5Cp8uj1on0GRpbhwKEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Travis —触发构建</p></figure><p id="5c01" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">构建完成后，我们应该会看到类似这样的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2efb5ca4371b874679c74915211821b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNyTiCjWGYKmWkbDLLd5vg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Travis —构建结果</p></figure><p id="7ea1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这意味着我们的测试通过了。我们可以进入最后一章了！</p><h1 id="f215" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">配置Heroku</h1><p id="6313" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>是一个云平台，帮助您构建、交付、监控和扩展应用。他们说:“<em class="nk">我们是从创意到URL的最快途径</em>”对于我们的例子，我们将使用Heroku作为免费的托管服务。</p><p id="af0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先我们需要在Heroku上注册。我们可以通过链接<a class="ae ky" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">https://signup.heroku.com/</a>来做到这一点。然后我们创建一个项目。要创建一个，我们需要转到<a class="ae ky" href="https://dashboard.heroku.com/apps" rel="noopener ugc nofollow" target="_blank">仪表板</a>并点击<code class="fe ms mt mu mv b"><em class="nk">New-&gt;Create new app</em></code> <em class="nk">。</em>接下来，<em class="nk"> </em>我们需要输入项目的名称——在我们的例子中是react-salute，并选择我们的应用程序所在的服务器所在的地区——在我们的例子中是欧洲。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/69f5984bb5426ba9ec92eceaa7c1a840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQyiVI5zWJPQdq2wl7wxzA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Heroku —创建新应用程序</p></figure><p id="9ae2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">提交<em class="nk">创建应用</em>按钮后，我们将被重定向到项目部署设置页面。在<em class="nk">部署方法</em>设置中，选择<em class="nk"> GitHub </em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/4ed90ac2bbabeb1218b14c247a416487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6bJEExQftwQ9jk5a8sZZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="oh"> Heroku —部署方法(步骤1) </em></p></figure><p id="6e31" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在Connected to GitHub设置中，我们可以选择将Heroku项目链接到哪个项目。我们选择<code class="fe ms mt mu mv b">react-salute</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/3082456adbeb1bbe91f17d327ab334a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFFKYmETzcU90eqGyv2jZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="oh"> Heroku —部署方法(步骤2) </em></p></figure><p id="a7e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我们设置<em class="nk">自动部署</em>。在这里，我们选择哪个分支将执行自动部署。我们选择<code class="fe ms mt mu mv b">master</code>分支。</p><p id="2327" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，让我们选中<em class="nk">在部署</em>复选框之前等待CI通过。这意味着Heroku将等待Travis CI成功工作。</p><p id="7a9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，让我们检查<em class="nk">启用自动部署</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/2745a7a4e4b8f4ef0ce78028fd6f9fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADBWIVyzCN1olCkpvKZ15w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Heroku —自动部署</p></figure><p id="fef5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们从D <em class="nk">电子显示</em>选项卡移到<em class="nk">设置</em>选项卡。</p><p id="844c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在构建包配置中，点击<em class="nk">添加构建包</em>按钮。在打开的模态窗口中，在Buildpack URL字段中输入以下地址:<a class="ae ky" href="https://github.com/mars/create-react-app-buildpack" rel="noopener ugc nofollow" target="_blank">https://github.com/mars/create-react-app-buildpack</a>。</p><p id="a14a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们保存我们的更改。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/e4486e60c6cd22924b08710634449c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oBNv5xz4n_xzr5ul4_3cg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Heroku —添加构建包</p></figure><p id="3bd7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nk"/><a class="ae ky" href="https://github.com/mars/create-react-app-buildpack" rel="noopener ugc nofollow" target="_blank"><em class="nk">create-react-app-build pack</em></a><em class="nk">是heroku buildpack，部署用create-react-app生成的React.js web应用。buildpack通过内置的捆绑器自动部署，并通过</em><a class="ae ky" href="http://nginx.org/en/" rel="noopener ugc nofollow" target="_blank"><em class="nk">Nginx</em></a><em class="nk">提供服务。</em></p><p id="c145" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们配置好Heroku之后，我们进入Github帐户，将我们的工作分支(开发)与master合并。合并后，Travis CI将启动并运行我们的测试。测试成功通过后，Heroku将开始构建。成功完成构建后，我们就可以享受结果了。我们可以在<em class="nk">域和证书</em>设置中的<em class="nk">设置</em>选项卡中看到我们的包的URL。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/f57dbe51dc9afab3a054b988a2d026c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8x9__y2y4XWlGNuxUyuow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Heroku —域和证书</p></figure><p id="1be8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们打开<a class="ae ky" href="https://react-salute.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://react-salute.herokuapp.com/</a>。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="2286" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本教程中，我们创建了最简单的NPM包，为它编写了测试，并为连续交付配置了Travis CI和Heroku。</p><p id="6932" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以此信息为基础，创建更复杂、更有用的NPM软件包，并免费提供它们的实例。</p><p id="eefe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">点击查看GitHub回购<a class="ae ky" href="https://github.com/fedoryakubovich/react-salute" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="07e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望这篇文章对你和你未来的项目有用。</p></div></div>    
</body>
</html>