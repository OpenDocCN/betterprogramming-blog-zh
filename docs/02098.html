<html>
<head>
<title>Implement a Search Bar in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中实现一个搜索栏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/implement-searchbar-in-swiftui-556a204e1970?source=collection_archive---------4-----------------------#2019-11-06">https://betterprogramming.pub/implement-searchbar-in-swiftui-556a204e1970?source=collection_archive---------4-----------------------#2019-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ef18" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">搜索您的数据，找到您真正需要的东西</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/03bf759e2b10688e8bd17a526a703459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*VppzU9oTWC0Mj72ZDHQMbQ.gif"/></div></figure><h1 id="e158" class="kn ko iq bd kp kq kr ks kt ku kv kw kx jw ky jx kz jz la ka lb kc lc kd ld le bi translated">步骤1:如何创建您的SwiftUI项目</h1><p id="945f" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在Xcode中，进入文件→新建→项目→单视图App →下一步→选择用户界面→ SwiftUI →下一步→选择你想要的项目位置→完成。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="24f1" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">步骤2: ContentView.swift</h1><p id="140d" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">默认的<code class="fe mn mo mp mq b">SwiftUI(ContentView)</code> <strong class="lh ir"> </strong>文件会出现以下代码:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="d755" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">import</strong> SwiftUI</span><span id="deee" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView: View {<strong class="mq ir">var</strong> body: <strong class="mq ir">some</strong> View {<br/>    Text(”Hello World!”)<br/>  }<br/>}</span><span id="456b" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView_Previews: PreviewProvider {<strong class="mq ir">  <br/>  static</strong> <strong class="mq ir">var</strong> previews: <strong class="mq ir">some</strong> View {<br/>     ContentView()<br/>   }<br/>}</span></pre><p id="716d" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">在右边，您可以看到UI的预览。</p><p id="980e" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">如果你看不到预览，进入调整编辑器选项，选择画布(或按下<code class="fe mn mo mp mq b">option+CMD+enter</code> ) <em class="ng">。</em> <strong class="lh ir"> <em class="ng"> </em> </strong>之后，确保画布正在显示UI预览。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/87ddc64c256f9afa029ecd4307851e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*MV4dJ7nctOToYoh7.png"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="2e4d" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">步骤3:创建用户界面</h1><p id="972e" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<code class="fe mn mo mp mq b">ContentView</code>体内，我们将做以下事情:</p><ol class=""><li id="de36" class="ni nj iq lh b li nb ll nc lo nk ls nl lw nm ma nn no np nq bi translated">初始化字符串数组变量</li><li id="0dd5" class="ni nj iq lh b li nr ll ns lo nt ls nu lw nv ma nn no np nq bi translated">定义<code class="fe mn mo mp mq b">NavigationView</code>并命名<code class="fe mn mo mp mq b">navigationBarTitle</code></li><li id="d6cc" class="ni nj iq lh b li nr ll ns lo nt ls nu lw nv ma nn no np nq bi translated">在<code class="fe mn mo mp mq b">NavigationView</code>中定义列表</li><li id="7e0d" class="ni nj iq lh b li nr ll ns lo nt ls nu lw nv ma nn no np nq bi translated">该列表将显示一个包含字符串数组中的名称的文本</li></ol><p id="492e" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">所以我们的代码看起来会像这样:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="5f39" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">import</strong> SwiftUI</span><span id="8cec" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView: View {</span><span id="85f4" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">let</strong> names = [“Raju”, “Ghanshyam”, “Baburao Ganpatrao Apte”,             “Anuradha”, “Kabira”, “Chaman Jhinga”, “Devi Prasad”, “Khadak    Singh”]</span><span id="53cc" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">var</strong> body: <strong class="mq ir">some</strong> View {<br/>      NavigationView{<br/>         List {<br/>            ForEach(<strong class="mq ir">self</strong>.names, id: \.<strong class="mq ir">self</strong>) { name <strong class="mq ir">in<br/>               </strong>Text(name)<br/>            }<br/>       }<br/>       .navigationBarTitle(Text(“Search Bar”))<br/>    }<br/>  }<br/>}</span><span id="6503" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView_Previews: PreviewProvider {<br/>   <strong class="mq ir">static</strong> <strong class="mq ir">var</strong> previews: <strong class="mq ir">some</strong> View {<br/>      ContentView()<br/>   }<br/>}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1d5e4e913084b93bc8d979376753f56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*YjTIPzoTjvSal13LKd8SpA.png"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="c754" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">步骤4:创建搜索栏</h1><p id="1469" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在的问题是:你打算如何展示一个<code class="fe mn mo mp mq b">UISearchBar</code>？</p><p id="f30d" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">所以为了显示一个<code class="fe mn mo mp mq b">UISearchBar</code>，我们将使用<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>协议。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="94db" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">struct</strong> SearchBar : UIViewRepresentable {</span><span id="8bdf" class="mv ko iq mq b gy na mx l my mz">}</span></pre><p id="b33b" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">现在，我们必须实现协议方法，它们是<code class="fe mn mo mp mq b">updateUIViewController</code>、<code class="fe mn mo mp mq b">makeCoordinator</code>和<code class="fe mn mo mp mq b">makeUIViewController</code>。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="1edc" class="mv ko iq mq b gy mw mx l my mz">//Update UIViewcontrolleer Method<br/><strong class="mq ir">func</strong> updateUIViewController(<strong class="mq ir">_</strong> uiViewController:<br/>UIImagePickerController, <br/>context: UIViewControllerRepresentableContext&lt;SearchBar&gt;) <br/>{<br/>  <br/>}</span><span id="0af1" class="mv ko iq mq b gy na mx l my mz">//Make Coordinator which will commnicate with the Search bar<br/><strong class="mq ir">func</strong> makeCoordinator(){</span><span id="5762" class="mv ko iq mq b gy na mx l my mz">}</span><span id="c188" class="mv ko iq mq b gy na mx l my mz">// Create UIViewController which we will display inside the View of the UIViewControllerRepresentable<br/><strong class="mq ir">func</strong> makeUIViewController(context: UIViewControllerRepresentableContext&lt;SearchBar&gt;)<br/>{</span><span id="6cfc" class="mv ko iq mq b gy na mx l my mz">}</span></pre><p id="940d" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">因为我们已经实现了协议<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>的所有方法，所以让我们在<code class="fe mn mo mp mq b">makeUIViewController</code>方法中创建一个<code class="fe mn mo mp mq b">UISearchBar</code>。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="b940" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">func</strong> makeUIView(context: UIViewRepresentableContext&lt;SearchBar&gt;) -&gt; UISearchBar {</span><span id="759b" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">let</strong> searchBar = UISearchBar(frame: .zero)<br/>searchBar.delegate = context.coordinator<br/><strong class="mq ir">return</strong> searchBar</span><span id="3e44" class="mv ko iq mq b gy na mx l my mz">}</span></pre></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="51b6" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">步骤5:创建UI搜索栏协调器</h1><p id="f343" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们必须创建一个协调器，它可以在<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>和<code class="fe mn mo mp mq b">UISearchBar</code>委托方法之间进行通信。</p><p id="3345" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">所以我们将创建一个新的类，<code class="fe mn mo mp mq b">Cordinator</code>，它将实现协议<code class="fe mn mo mp mq b">NSOBject</code>和<code class="fe mn mo mp mq b">UISearchBarDelegate</code>，并将实现这些协议所需的方法。</p><p id="2726" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">协调器看起来会像这样:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="d55f" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">class</strong> Cordinator : NSObject, UISearchBarDelegate {</span><span id="182f" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">func</strong> searchBar(<strong class="mq ir">_</strong> searchBar: UISearchBar, <br/>                  textDidChange searchText: String) <br/>   {<br/>      // Pass searchText value to the content view<br/>   }</span><span id="fa29" class="mv ko iq mq b gy na mx l my mz">}</span></pre><p id="575b" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">现在，如果用户输入任何东西，我们必须通知我们的<code class="fe mn mo mp mq b">ContentView</code>来显示过滤后的结果。</p><p id="6244" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">为此，我们将使用<code class="fe mn mo mp mq b">@Binding</code>和<code class="fe mn mo mp mq b">@State</code>的概念。我们将创建一个名为<code class="fe mn mo mp mq b">text</code>的<code class="fe mn mo mp mq b">Binding</code>变量，所以现在我们的<code class="fe mn mo mp mq b">ImagePickerCordinator</code>将如下所示:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="127b" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">class</strong> Cordinator : NSObject, UISearchBarDelegate {</span><span id="9236" class="mv ko iq mq b gy na mx l my mz">@Binding <strong class="mq ir">var</strong> text : String</span><span id="42ff" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">init</strong>(text : Binding&lt;String&gt;) <br/>   {<br/>      _text = text<br/>   }</span><span id="4e72" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">func</strong> searchBar(<strong class="mq ir">_</strong> searchBar: UISearchBar, <br/>                  textDidChange searchText: String) <br/>   {<br/>      text = searchText<br/>   }</span><span id="9761" class="mv ko iq mq b gy na mx l my mz">}</span></pre><p id="0af2" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">既然我们的协调器已经准备好进行通信，让我们对<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code> <code class="fe mn mo mp mq b">makeCoordinator()</code>函数进行修改。</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="0223" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">func</strong> makeCoordinator() -&gt; SearchBar.Cordinator {<br/>   <strong class="mq ir">return</strong> Cordinator(text: $text)<br/>}</span></pre><p id="87f4" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">为了传入<code class="fe mn mo mp mq b">binding</code>变量，我们将在<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>中创建这个变量。现在,<code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>文件看起来像这样:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="1b20" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">import</strong> SwiftUI</span><span id="a80e" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> SearchBar : UIViewRepresentable {<br/>   @Binding <strong class="mq ir">var</strong> text : String<br/>   <br/>   <strong class="mq ir">func</strong> searchBar(<strong class="mq ir">_</strong> searchBar: UISearchBar, <br/>                  textDidChange searchText: String) {<br/>      text = searchText<br/>   }<br/>}</span><span id="d2fe" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">func</strong> makeCoordinator() -&gt; SearchBar.Cordinator {<br/>      <strong class="mq ir">return</strong> Cordinator(text: $text)<br/>   }</span><span id="082c" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">func</strong> makeUIView(context: UIViewRepresentableContext&lt;SearchBar&gt;) <br/>   -&gt; UISearchBar {<br/>   <br/>      <strong class="mq ir">let</strong> searchBar = UISearchBar(frame: .zero)<br/>      searchBar.delegate = context.coordinator<br/>      <strong class="mq ir">return</strong> searchBar<br/>   }</span><span id="8d0c" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">func</strong> updateUIView(<strong class="mq ir">_</strong> uiView: UISearchBar, <br/>                context: UIViewRepresentableContext&lt;SearchBar&gt;) {<br/>       uiView.text = text<br/>    }<br/>}</span></pre></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="2521" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">步骤7:在ContentView中实现UISearchBar</h1><p id="e91c" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<code class="fe mn mo mp mq b">contentView</code>内部，我们只需要创建<code class="fe mn mo mp mq b">@State</code>变量，命名为<code class="fe mn mo mp mq b">searchTerm</code>，类型为<code class="fe mn mo mp mq b">String</code>。</p><p id="1228" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">每当<code class="fe mn mo mp mq b">searchTerm</code>变量值更新时，我们必须过滤列表。为此，我们将对<code class="fe mn mo mp mq b">String array</code>使用默认的<code class="fe mn mo mp mq b">filter</code>方法。</p><p id="6493" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">我们要在列表里面调用<code class="fe mn mo mp mq b">SearchBar</code><code class="fe mn mo mp mq b">UIViewControllerRepresentable</code>；在调用<code class="fe mn mo mp mq b">SearchBar</code>时，我们必须传递绑定变量。就这样——我们准备好了。</p><p id="5aa6" class="pw-post-body-paragraph lf lg iq lh b li nb jr lk ll nc ju ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">所以我们的<code class="fe mn mo mp mq b">ContentView</code>代码看起来像这样:</p><pre class="kg kh ki kj gt mr mq ms mt aw mu bi"><span id="dd3a" class="mv ko iq mq b gy mw mx l my mz"><strong class="mq ir">import</strong> SwiftUI</span><span id="9b90" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView: View {</span><span id="0db5" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">let</strong> names = [“Raju”, “Ghanshyam”, “Baburao Ganpatrao Apte”,   “Anuradha”, “Kabira”, “Chaman Jhinga”, “Devi Prasad”, “Khadak Singh”]</span><span id="39e4" class="mv ko iq mq b gy na mx l my mz">@State <strong class="mq ir">private</strong> <strong class="mq ir">var</strong> searchTerm : String = “”</span><span id="a6cb" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">var</strong> body: <strong class="mq ir">some</strong> View {<br/>      NavigationView{<br/>         List {<br/>            SearchBar(text: $searchTerm)<br/>            <br/>            ForEach(<strong class="mq ir">self</strong>.names.filter{<br/>              <strong class="mq ir">self</strong>.searchTerm.isEmpty ? <strong class="mq ir">true</strong> :    $0.localizedStandardContains(<strong class="mq ir">self</strong>.searchTerm)<br/>}, id: \.<strong class="mq ir">self</strong>) { name <strong class="mq ir">in<br/>   </strong>Text(name)<br/>              }<br/>         }<br/>          .navigationBarTitle(Text(“Search Bar”))</span><span id="704f" class="mv ko iq mq b gy na mx l my mz">}<br/>    }<br/>}</span><span id="62da" class="mv ko iq mq b gy na mx l my mz"><strong class="mq ir">struct</strong> ContentView_Previews: PreviewProvider {<br/>   <strong class="mq ir">static</strong> <strong class="mq ir">var</strong> previews: <strong class="mq ir">some</strong> View {<br/>      ContentView()<br/>   }<br/>}</span></pre></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="9b46" class="kn ko iq bd kp kq mi ks kt ku mj kw kx jw mk jx kz jz ml ka lb kc mm kd ld le bi translated">资源</h1><p id="dca4" class="pw-post-body-paragraph lf lg iq lh b li lj jr lk ll lm ju ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可以在<a class="ae nx" href="https://github.com/rathodmayur93/SearchBarSwiftUI" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到这个项目。</p></div></div>    
</body>
</html>