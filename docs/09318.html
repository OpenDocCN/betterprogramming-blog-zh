<html>
<head>
<title>Build a Serverless App With Netlify and JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Netlify和JavaScript构建一个无服务器应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-serverless-app-with-netlify-and-javascript-ed3879cd94f3?source=collection_archive---------11-----------------------#2021-08-10">https://betterprogramming.pub/build-a-serverless-app-with-netlify-and-javascript-ed3879cd94f3?source=collection_archive---------11-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="653b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">网络无服务器功能入门</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/55d37da8e11909d0a25f9b92bef5627f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OQCy3XPUy3QqqJAz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://unsplash.com/@flo_stk" rel="noopener ugc nofollow" target="_blank">弗洛里安·斯特丘克</a>在Unsplash.com<a class="ae ky" href="http://unsplash.com" rel="noopener ugc nofollow" target="_blank">上</a></p></figure><p id="5e52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将了解以下内容:</p><ul class=""><li id="aa12" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">什么是无服务器，何时使用</li><li id="3a5a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">哪些提供商支持它</li><li id="a6ce" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用Netlify设置项目</li><li id="c95d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用Netlify的无服务器功能构建示例应用程序的方法</li><li id="f38a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">部署</li></ul><h1 id="7697" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">什么是无服务器，何时使用？</h1><p id="280d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">看到“无服务器”这个词，您可能会认为您的代码不需要服务器来运行。但现实中，事实并非如此。毕竟，否则你的程序将如何执行？</p><p id="4408" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.manning.com/books/serverless-applications-with-node-js" rel="noopener ugc nofollow" target="_blank">斯洛博丹·斯托扬诺维奇在他的书</a>中通过把它比作洗衣机来解释无服务器。一般来说，人们每周只使用洗衣机五到十五个小时。然而，它坐在厨房里啜饮电力，即使没有人使用它。出于这个原因，一些人最终使用自助洗衣店。在这里，你只需为洗衣服的时间付费。</p><p id="d4d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您的服务器也有可能处于空闲状态，等待请求。即使它很少收到任何流量，它仍然花费你一大笔费用。在这种情况下，只为服务器处理请求的时间付费不是很好吗？</p><p id="a1f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是无服务器的用武之地。这是一种基于按使用付费的方式在云上运行项目的方法。最精彩的部分？你只需要专注于编写你的代码。不需要担心托管环境或底层操作系统。您的云提供商将为您处理一切。这在很大程度上减轻了压力。</p><h1 id="9304" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">哪些提供商支持它？</h1><p id="903c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">几乎所有的云托管提供商都允许你构建无服务器应用。<a class="ae ky" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>、<a class="ae ky" href="https://cloud.google.com/functions/" rel="noopener ugc nofollow" target="_blank"> Google Cloud Functions </a>和<a class="ae ky" href="https://www.netlify.com/products/functions/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>就是显著的例子。</p><p id="e2b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将使用Netlify创建一个无服务器函数。它将接受一个网站链接作为参数，并使用Mozilla的可读性API为您提供该网站的内容。因为它将位于web服务器上，所以我们可以使用API端点来调用它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/3fc6535fc2d5e11a8b2b4ed4ca25aa83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nh4ZbiEWn4FSyOq8HYp7Rw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本文的结果</p></figure><p id="2c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h1 id="64c0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">项目设置</h1><h2 id="94b6" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">克隆模板库</h2><p id="2ca5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://github.com/netlify/explorers-up-and-running-with-serverless-functions/tree/main" rel="noopener ugc nofollow" target="_blank"> Netlify的启动和运行库</a>作为这个程序的基础。点击“使用此模板”克隆它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/600c94e18d7c7c2d468ea03874561f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KeFDEUH87XglfnzH8U-xHg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“使用此模板”</p></figure><p id="bf1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后GitHub会让你给你的应用命名。当您为其指定名称后，单击“从该模板创建存储库”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/e7702e2dd8ae424bff862c58969e7c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhHSyfXF-ht6L0kk09GJmA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单击“从模板创建存储库”</p></figure><p id="b526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！您现在已经构建了一个项目。现在我们需要把它的代码下载到我们的机器上。</p><p id="22cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这样做之前，我们需要告诉Git我们项目的位置。单击“代码”以获取此存储库的URL。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/4058acc9c389099f64d25714beed4f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GXBShvXhYW8UaITmXkrL7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“代码”获取网址</p></figure><p id="5266" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在您的计算机上运行以下终端命令:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="2833" class="nh mk it nx b gy ob oc l od oe">git clone &lt;url&gt;  #url is your project location</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/e131869985af48ad46bf1305b85bd276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJmEtdq3OtZSm-g7jf1VgA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克隆到本地机器</p></figure><h2 id="c822" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">获取Netlify-CLI</h2><p id="82a0" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">第二步，我们现在需要安装Netlify的终端工具。为此，运行以下终端命令:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="5100" class="nh mk it nx b gy ob oc l od oe">npm install netflify-cli -g</span></pre><p id="0441" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，使用<code class="fe og oh oi nx b">ntl login</code>命令登录:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="92f4" class="nh mk it nx b gy ob oc l od oe">ntl login</span></pre><p id="c866" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您完成登录过程之后，我们需要告诉Netlify用这个存储库构建一个网站。在项目文件夹中运行bash指令:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="d35d" class="nh mk it nx b gy ob oc l od oe">ntl init #run in project repo</span></pre><p id="11fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保您选择了以下选项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/0a3f0760704a6cfc56026f27c680730a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tirMrBqpKqqwoms1fp9ycw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">选择这些选项</p></figure><p id="af56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们测试一下我们的配置。像这样运行您的web应用程序:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="1502" class="nh mk it nx b gy ob oc l od oe">ntl dev</span></pre><p id="94cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将启动我们的web服务器用于开发目的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/89a287d9f9c3d74b7d9eec02c5d6d672.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*r37IV0WtQxbyoOr9oqW8XA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">终端命令的输出</p></figure><p id="0f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着我们的配置是有效的！按下键盘上的<code class="fe og oh oi nx b">CTRL + C</code>键杀死服务器。</p><h2 id="6845" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">项目结构</h2><p id="1e63" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在你的<code class="fe og oh oi nx b">netlify/functions</code>文件夹中，创建以下文件:</p><ul class=""><li id="d085" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe og oh oi nx b">reader.js</code>:函数的入口点。</li><li id="9c5f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe og oh oi nx b">utils/readerUtils</code>:顾名思义，它将保存应用程序逻辑和其他助手方法。</li></ul><p id="8b43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您的项目目录应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/7e1415b9f6a2520588a182b189ed2261.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*tS5BP10lrWXTzHCtVywUxQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目结构</p></figure><p id="4ae1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是编码的时候了！</p><h1 id="fb02" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">构建我们的应用</h1><h2 id="ddb8" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">依赖项的安装</h2><p id="8b51" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于我们的应用程序，我们需要以下模块:</p><ul class=""><li id="414b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe og oh oi nx b">@mozilla/readability</code>:该包将从所需页面中提取文本内容。</li><li id="17a4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe og oh oi nx b">got</code>:获取网站的HTML代码。</li><li id="0315" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe og oh oi nx b">dompurify</code>和<code class="fe og oh oi nx b">jsdom</code>:从页面源代码中移除恶意JavaScript。因此，这阻止了XSS的攻击。</li></ul><p id="bf14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获取这些依赖项，请运行以下命令:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="03fd" class="nh mk it nx b gy ob oc l od oe">npm init -y #initialize NPM for our project<br/>npm install @mozilla/readability got dompurify jsdom</span></pre><h2 id="6842" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">解析网站</h2><p id="5b83" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本节中，我们将创建一个函数，告诉Node.js从所需的web页面中提取主要内容。</p><p id="615d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到您的<code class="fe og oh oi nx b">netlify/functions/utils/readerUtils.js</code>文件。这里，从编写以下代码开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><ul class=""><li id="03bd" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第5行:将我们的<code class="fe og oh oi nx b">JSDOM</code>实例传递给<code class="fe og oh oi nx b">DOMPurify</code>。我们将用它来净化传入的HTML代码。</li></ul><p id="9d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，继续在该文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="7962" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这段代码中可以得出一些推论:</p><ul class=""><li id="7922" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第2行:从期望的站点获取源代码。</li><li id="3464" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第5–13行:如果网站可读，解析网站并清理HTML代码。最后，将<code class="fe og oh oi nx b">title</code>字段和净化后的HTML作为响应发送给客户端。</li><li id="3083" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第14–15行:否则，告诉客户端发生了错误。</li></ul><h2 id="e493" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">验证输入</h2><p id="2682" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这里，我们将编写一个执行验证检查的方法，该方法将指示用户是否输入了有效的URL。</p><p id="4ce5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，在<code class="fe og oh oi nx b">readerUtils.js</code>中编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><ul class=""><li id="89cb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第2–10行:创建一个简单的regex模式，检查输入是否为URL格式。</li><li id="cf86" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第11行:用正则表达式匹配用户输入。如果输入的字符串是URL，该函数将返回<code class="fe og oh oi nx b">true</code>。</li></ul><h2 id="c833" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">发送解析的数据</h2><p id="6ae5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">现在我们已经验证并解析了用户想要的网页，剩下的工作就是向客户端发送响应。</p><p id="ffb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe og oh oi nx b">readerUtils.js</code>中追加以下块:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="5640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一点一点地解构这段代码:</p><ul class=""><li id="13f6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第2行:首先检查用户是否输入了有效的URL。</li><li id="0910" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第3行:运行<code class="fe og oh oi nx b">parseURL</code>方法。这里，我们使用对象析构来提取<code class="fe og oh oi nx b">title</code>、<code class="fe og oh oi nx b">html</code>和<code class="fe og oh oi nx b">error</code>字段。</li><li id="e5e0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第4–14行:如果流程成功，发送<code class="fe og oh oi nx b">title</code>和<code class="fe og oh oi nx b">html</code>字段作为响应。</li><li id="fe1a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第22行:导出<code class="fe og oh oi nx b">sendData</code>方法。这意味着我们现在可以在我们的项目中使用它。</li></ul><h2 id="dc43" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">将实用程序与我们的应用程序联系起来</h2><p id="2558" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们现在完成了与实用程序相关的代码。现在让我们将这些函数与我们的API联系起来。</p><p id="09c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe og oh oi nx b">reader.js</code>中写入以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><ul class=""><li id="8a18" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3行:当用户执行<code class="fe og oh oi nx b">reader</code>方法时，这个处理程序中的所有代码都将运行。</li><li id="ec55" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第4行:获取请求的有效负载体。</li><li id="c45b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第5行:调用<code class="fe og oh oi nx b">sendData</code>方法。我们将使用<code class="fe og oh oi nx b">site</code>属性作为它的参数。我们将结果存储在<code class="fe og oh oi nx b">data</code>变量中。</li><li id="fdea" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第11行:发送<code class="fe og oh oi nx b">data</code>作为对客户端的响应。</li></ul><h2 id="982c" class="nh mk it bd ml ni nj dn mp nk nl dp mt li nm nn mv lm no np mx lq nq nr mz ns bi translated">测试</h2><p id="ccbb" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在发布我们的API之前，让我们检查一下是否一切正常。要在本地运行API，请运行以下命令:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="5056" class="nh mk it nx b gy ob oc l od oe">ntl dev</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/d759dbf9012d6b01501dc7d61f371726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x62BGdR_aF_jzwb_Zb9KvQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">命令的输出</p></figure><p id="962e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">终端中的输出会告诉您函数服务器的位置。在我的例子中，它运行在端口<code class="fe og oh oi nx b">41365</code>上。</p><p id="0879" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要向您的API发出请求，您必须使用以下语法:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="9d2e" class="nh mk it nx b gy ob oc l od oe">localhost:{PORT}/.netlify/functions/{FUNCTION_NAME}</span></pre><p id="e67d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的情况是<code class="fe og oh oi nx b">localhost:41365/.netlify/functions/reader</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/82cbd9601f85c9088240e230d09d1d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVYyfgOOrNsgo_K4US5MrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">请求的结果</p></figure><p id="100f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！我们的代码有效。在本文的下一部分，您将学习如何向公众部署您的API。</p><h1 id="62d4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">部署</h1><p id="45e7" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">感谢Netlify，更新网站很容易。就像这样把你的代码推给GitHub:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="9c7c" class="nh mk it nx b gy ob oc l od oe">git add . #add to staging<br/>git commit -m "All complete"  <br/>git push origin main #push all code to GitHub repo</span></pre><p id="b894" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将通知Netlify更新您的代码并将其发布到服务器。</p><p id="6eaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在回到Netlify的主页，选择你的网站:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/65cd29d284f2327f8441022b823536ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RemFNJh5155idzBNqmgjOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击你的网站名称</p></figure><p id="66ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，点击“功能”这将列出与网站相关的功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/4319bb55b4639cf1a4664fb5eea8863a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aThFQe_jspz8-oikrOzewQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“功能”</p></figure><p id="9309" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择您的函数名。我的情况是<code class="fe og oh oi nx b">reader</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/5938df3870284f4e28e3be52e1bd4fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxCruUiS7KuTQL_9JRStWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击你的函数名</p></figure><p id="cb20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将给你一个API端点来调用你的方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/59d4fc0a62430ab6c943d6dc9f1d8989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6rF3cwuoBZO0vURzZ861w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">此方法的API端点</p></figure><p id="737e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们运行它！</p><p id="b1df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用API客户机调用API端点，看看是否一切正常。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0e13e356cae10fed95e2ef348d3c76ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auCcjFRzDOHHTGgzbZo1bQ.png"/></div></div></figure><p id="2eee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你。现在，您已经用Netlify构建了一个可用的无服务器功能。</p><h1 id="3456" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">更多资源</h1><p id="2efc" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><a class="ae ky" href="https://github.com/HussainArif12/serverless-reader-tutorial" rel="noopener ugc nofollow" target="_blank">这里是这个项目</a>的GitHub库</p><ul class=""><li id="7495" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://explorers.netlify.com/learn/up-and-running-with-serverless-functions" rel="noopener ugc nofollow" target="_blank">启动并运行无服务器功能— Netlify </a></li><li id="a491" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="http://youtube.com/watch?v=n_KASTN0gUE" rel="noopener ugc nofollow" target="_blank">创建您的第一个网络无服务器功能——Ania kubów</a></li><li id="dfde" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://levelup.gitconnected.com/create-a-bookmark-manager-app-using-faunadb-and-netlify-serverless-functions-7d4365652692" rel="noopener ugc nofollow" target="_blank">使用FaunaDB和Netlify无服务器函数创建书签管理器应用</a> - <a class="ov ow ep" href="https://medium.com/u/24d03d066e6c?source=post_page-----ed3879cd94f3--------------------------------" rel="noopener" target="_blank"> Yogesh Chavan </a></li><li id="9bdf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/4-steps-to-get-started-with-serverless-functions-on-netlify-a6942bf071ca">从Netlify上的无服务器开始</a>—<a class="ov ow ep" href="https://medium.com/u/2d2dc3be7649?source=post_page-----ed3879cd94f3--------------------------------" rel="noopener" target="_blank">ray ray开发</a></li></ul><h1 id="74ab" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="f9b6" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">毫无疑问，无服务器架构已经成为最近的热门话题。如果您的应用程序有突发流量，无服务器功能非常适合您。</p><p id="99aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你仍然对这种类型的建筑持怀疑态度，<a class="ov ow ep" href="https://medium.com/u/5bdf5a3385cd?source=post_page-----ed3879cd94f3--------------------------------" rel="noopener" target="_blank">安娜·盖勒</a> <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/why-many-engineers-dont-understand-the-real-use-of-serverless-df2300766aa9">在她的文章</a>中回应了这些批评。</p><p id="7751" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读！祝您愉快！</p></div></div>    
</body>
</html>