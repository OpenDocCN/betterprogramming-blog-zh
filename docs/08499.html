<html>
<head>
<title>How To Do Lighter Web Scraping With Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js做更轻量级的网页抓取</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-do-lighter-web-scraping-with-node-js-651737fb2c4?source=collection_archive---------7-----------------------#2021-05-06">https://betterprogramming.pub/how-to-do-lighter-web-scraping-with-node-js-651737fb2c4?source=collection_archive---------7-----------------------#2021-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d94d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Node.js进行web抓取的另一种方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/63e124bfe1cb62a061fcb62d82e39738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZSS3YAzpa-i6Tzgd7KImPQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@kikesalazarn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Kike Salazar N </a>在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄。</p></figure><p id="2a69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你搜索“使用Node.js进行网络搜集”，关于<a class="ae kv" href="https://developers.google.com/web/tools/puppeteer" rel="noopener ugc nofollow" target="_blank">木偶师</a>的文章可能会出现。对于复杂的网络抓取来说，这是一个非常棒的库，因为使用Puppeteer时，你实际上是在自动化浏览器。也就是说，我认为对于简单的网络抓取工作来说，这可能是大材小用。</p><p id="2699" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将研究如何在不使用Puppeteer的情况下从web中抓取数据。</p><blockquote class="ls lt lu"><p id="6827" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">本文原载于我的博客这里:<a class="ae kv" href="https://www.christiandimas.com/lighter-web-scraping-using-nodejs/" rel="noopener ugc nofollow" target="_blank">https://www . christiandimas . com/lighter-web-scraping-using-nodejs/</a></p></blockquote></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="d973" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">入门指南</h1><p id="3913" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">为此，我们需要解决两个问题:</p><ul class=""><li id="48da" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">怎样才能获取网站的HTML代码？</li><li id="9376" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">我们如何从HTML代码中获得我们需要的实际数据？</li></ul><p id="fd01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开始编码吧！首先，通过运行以下命令来搭建一个新的节点项目:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="b614" class="nw mh iq ns b gy nx ny l nz oa">yarn init -y</span></pre><p id="6e30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经有了一个可以使用的项目，让我们安装一些依赖项:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="f2fa" class="nw mh iq ns b gy nx ny l nz oa">yarn install axios cheerio</span></pre><h2 id="7d57" class="nw mh iq bd mi ob oc dn mm od oe dp mq lf of og ms lj oh oi mu ln oj ok mw ol bi translated">Axios</h2><p id="9b39" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">您可能对这个包很熟悉，因为它是一个非常流行的用于处理HTTP请求的包。现在，我们通常使用它来与API交互，并以JSON的形式获得结果，但是我们可以调整一个设置，使响应以HTML而不是JSON的形式出现。</p><h2 id="8d5b" class="nw mh iq bd mi ob oc dn mm od oe dp mq lf of og ms lj oh oi mu ln oj ok mw ol bi translated">再见</h2><p id="a608" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">从<a class="ae kv" href="https://www.npmjs.com/package/cheerio" rel="noopener ugc nofollow" target="_blank"> npm包的描述</a>来看，这是一个“专门为服务器设计的核心jQuery的快速、灵活的&amp;精益实现。”我认为这解释得很好。基本上，有了这个包，我们可以在服务器上运行jQuery命令。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="d94e" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">建造铲运机</h1><p id="8649" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://books.toscrape.com/" rel="noopener ugc nofollow" target="_blank">书籍来测试</a>刮刀。首先，在项目文件夹根目录下创建一个名为<code class="fe om on oo ns b">index.js</code>的文件。我们将使用这个文件来构建我们的刮刀。</p><p id="faed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从网站上的书单中，我们会抓取一些东西:</p><ul class=""><li id="80f6" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">标题</li><li id="f47d" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">价格</li><li id="a4cf" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">封面图像</li><li id="258d" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">评级</li><li id="4b90" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">有效性</li><li id="5b0e" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">统一资源定位器</li></ul><p id="9e07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始编码吧！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="88fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们导入<code class="fe om on oo ns b">axios</code>和<code class="fe om on oo ns b">cheerio</code>，然后创建一个名为<code class="fe om on oo ns b">scrape</code>的异步函数。</p><p id="6b0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们使用<code class="fe om on oo ns b">axios</code>从网站获取HTML代码，并将其加载到<code class="fe om on oo ns b">cheerio</code>中，这样我们就可以查询数据了。我们会这样做:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="7e2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检查网站后，我们可以看到图书列表是这样的。这将有助于我们获得数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/5670566258cf3ad56ac3413fd80c3c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9-QF9L1s--hmSqd2.png"/></div></div></figure><p id="8693" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这些信息，让我们首先抓住书籍元素。我们可以这样使用cheerio:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="4029" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，我们拿到书了。现在是先抓简单数据的时候了。我们可以在元素中直接看到它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="78c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后，我们还可以抓取稍微复杂一点的数据(例如<code class="fe om on oo ns b">rating</code>、<code class="fe om on oo ns b">availability</code>、<code class="fe om on oo ns b">url</code>):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="64f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，对于<code class="fe om on oo ns b">rating</code>，我们可以获取<code class="fe om on oo ns b">p</code>元素并检查该类，因为它包含了该书有多少评级(例如<code class="fe om on oo ns b">three</code>)。接下来，对于可用性，我们只需检查是否有类为<code class="fe om on oo ns b">.instock.availability</code>的div。我们查询这两个类，以确保<code class="fe om on oo ns b">.instock</code>类确实是为了可用性，而<code class="fe om on oo ns b">.availability</code>有<code class="fe om on oo ns b">.instock</code>类来表明它是可用的。</p><p id="efb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">全部完成！完整的代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="e234" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="7c5c" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我认为这是做网页抓取最简单的方法。也就是说，这样做有一些优点和缺点。</p><h2 id="beb9" class="nw mh iq bd mi ob oc dn mm od oe dp mq lf of og ms lj oh oi mu ln oj ok mw ol bi translated">赞成的意见</h2><ul class=""><li id="41e8" class="nd ne iq ky b kz my lc mz lf os lj ot ln ou lr ni nj nk nl bi translated">构建更简单</li><li id="85db" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">需要的资源更少(像Puppeteer这样的库需要安装Chromium才能运行)</li><li id="7b77" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">更小的包装尺寸</li></ul><h2 id="6021" class="nw mh iq bd mi ob oc dn mm od oe dp mq lf of og ms lj oh oi mu ln oj ok mw ol bi translated">骗局</h2><ul class=""><li id="46b9" class="nd ne iq ky b kz my lc mz lf os lj ot ln ou lr ni nj nk nl bi translated">无法抓取需要导航的网站(登录、滚动等。)</li><li id="c633" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">无法获取页面的屏幕截图</li></ul><p id="c810" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后还是要看你想刮什么网站，想得到什么数据。如果你想从一个复杂的网站上获得一些东西，那么就使用像木偶师这样的东西！它有一个强大的API，你可以与一个复杂的网站互动。但是如果你需要简单的东西，那么<code class="fe om on oo ns b">axios</code>和<code class="fe om on oo ns b">cheerio</code>可能是更好的选择。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="e95e" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">资源</h1><p id="3aeb" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">以下是我在本教程中提到的所有内容的一些资源:</p><ul class=""><li id="cb90" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">阿希奥斯:<a class="ae kv" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank">https://github.com/axios/axios</a></li><li id="6564" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">https://github.com/cheeriojs/cheerio</li><li id="16c0" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">木偶师:<a class="ae kv" href="https://github.com/puppeteer/puppeteer" rel="noopener ugc nofollow" target="_blank">https://github.com/puppeteer/puppeteer</a></li></ul></div></div>    
</body>
</html>