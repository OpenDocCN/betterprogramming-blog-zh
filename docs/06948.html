<html>
<head>
<title>Natural Language Processing in the Browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">浏览器中的自然语言处理</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/natural-language-processing-in-the-browser-8ca5fdf2488b?source=collection_archive---------5-----------------------#2020-11-19">https://betterprogramming.pub/natural-language-processing-in-the-browser-8ca5fdf2488b?source=collection_archive---------5-----------------------#2020-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cecc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何为你的网站建立一个无服务器的NLP聊天机器人</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a28d23de44653d821b8f88fbc60662bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-jYECtYbLdX_c7GRz_DTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="b775" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以为自己的网站建立一个聊天机器人，而不依赖于第三方服务，如<a class="ae lu" href="https://cloud.google.com/dialogflow/docs" rel="noopener ugc nofollow" target="_blank"> Dialogflow </a>或<a class="ae lu" href="https://www.ibm.com/watson" rel="noopener ugc nofollow" target="_blank"> Watson </a>，也不需要服务器。我将向你展示如何建立一个聊天机器人，将完全运行在浏览器中。</p><p id="411a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将假设您对JavaScript有所了解，并对自然语言处理的工作原理有所了解。不需要高深的知识或者机器学习经验。</p><p id="57fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果有人告诉你，在使用JavaScript的浏览器中进行机器学习是疯狂的，那么不要听那个，因为很快你自己就会更清楚。</p><p id="4dc2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的代码将基于<a class="ae lu" href="https://github.com/axa-group/nlp.js" rel="noopener ugc nofollow" target="_blank"> NLP.js </a>版本4。<a class="ae lu" href="https://github.com/axa-group/nlp.js" rel="noopener ugc nofollow" target="_blank"> NLP </a>是一个用JavaScript编写的自然语言处理开源库。该项目将允许您直接在浏览器中从语料库中训练NLP，并添加一个挂钩到任何意图，以编程方式改变答案。</p><p id="a3ef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最终的项目可以在我的GitHub资源库中找到:<a class="ae lu" href="https://github.com/MeetMartin/nlpjs-web" rel="noopener ugc nofollow" target="_blank">https://github.com/MeetMartin/nlpjs-web</a>。你可以下载它，打开index.html，然后玩最后的聊天机器人。</p><p id="96cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在每个真正的开发者都应该有一些人工智能的经验，还有什么比用你自己开发的东西和你的计算机说话更科幻的呢？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="11dd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安装软件包</h1><p id="c36b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">在任何文件夹中创建新的npm项目并安装NLP包:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="868e" class="ne md it na b gy nf ng l nh ni">npm i -D @nlpjs/core @nlpjs/lang-en-min @nlpjs/nlp @nlpjs/request-rn@nlpjs/request-rn</span></pre><p id="d573" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还需要<a class="ae lu" href="https://github.com/browserify/browserify#usage" rel="noopener ugc nofollow" target="_blank">browser verify</a>和<a class="ae lu" href="https://terser.org/docs/cli-usage" rel="noopener ugc nofollow" target="_blank"> terser </a>来构建供浏览器使用的NLP:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9292" class="ne md it na b gy nf ng l nh ni">npm i -D browserify terser</span></pre><p id="cb49" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">享受新项目和新安装的软件包的味道。你应得的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e4fa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">构建NLP</h1><p id="54dd" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">第一步是使用browserify和terser构建NLP。为此，我们只需要在buildable.js中创建一个基本的设置:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="b6b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只使用了NLP的核心和一个小的英语包。要构建所有东西，只需在您的<code class="fe nl nm nn na b">package.json</code>中添加一个构建命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="8f8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在运行构建:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="92a5" class="ne md it na b gy nf ng l nh ni">npm run build</span></pre><p id="fb08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您最终应该得到只有大约137 KB的<code class="fe nl nm nn na b">./dist/bundle.js</code>。值得注意的是，NLP有一个令人印象深刻的支持语言列表。然而，只有英语有针对浏览器的优化版本。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="36dd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在浏览器中训练NLP</h1><p id="22bd" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在我们已经创建了我们的包，我们可以在浏览器中训练我们的NLP。创建此<code class="fe nl nm nn na b">index.html</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2dc4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的功能<code class="fe nl nm nn na b">setupNLP</code>负责图书馆的设置和培训。语料库是一个JSON文件，它以这种格式为我们的聊天机器人定义对话:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="8b5b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="no"> intent </em>是一个会话节点的唯一标识符，它的名字应该代表聊天机器人所反应的用户的意图。<em class="no">话语</em>是用户可以说什么来触发意图的一组训练示例。<em class="no">答案</em>是聊天机器人将从中随机选择的一组回答。</p><p id="ab9c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了训练我们的聊天机器人，我们从图书馆的示例中借用了更大的语料库:<a class="ae lu" href="https://raw.githubusercontent.com/jesus-seijas-sp/nlpjs-examples/master/01.quickstart/02.filecorpus/corpus-en.json" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Jesus-seijas-sp/nlpjs-examples/master/01 . quick start/02 . file corpus/corpus-en . JSON</a>。但是对于您的用例，请随意创建您自己的语料库。请记住，库期望从某个URL读取语料库。</p><p id="9455" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当您在浏览器中打开<code class="fe nl nm nn na b">index.html</code>时，您应该会看到一个简单的聊天表单，它还没有做任何事情。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/23b33fe45cebdfdde82e5486c40dceca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jcgI1OlIsUD8VcGVzxAiYw.png"/></div></div></figure><p id="37c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，如果您打开浏览器控制台，您已经可以看到成功的培训输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/b6dbe0474adac0523cf3d9f96d315e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GddApxHIsJ5K4AzzjEIiOw.png"/></div></div></figure><p id="3c64" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练速度非常快，可以让你的聊天机器人在浏览器中使用训练好的模型。这是一种更有效的方法，因为语料库文件比生成的模型小得多。</p><p id="3006" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练你的第一个机器学习代码感觉很棒。你刚刚成为一个传奇，成为这个星球上少数几个可以说:“是的，我曾经训练过一个人工智能，这没什么大不了的。”</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="81e5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">聊天机器人HTML</h1><p id="573b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在，我们将使聊天机器人的形式工作。通过添加<code class="fe nl nm nn na b">onChatSubmit</code>功能扩展您的<code class="fe nl nm nn na b">index.html</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="50ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在您可以玩您的新聊天机器人了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/67d2cec913967837b1dd03df95d10c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uxgIOaFQgJD-w3NEFL_UgQ.png"/></div></div></figure><p id="2942" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">浏览您的语料库或<a class="ae lu" href="https://raw.githubusercontent.com/jesus-seijas-sp/nlpjs-examples/master/01.quickstart/02.filecorpus/corpus-en.json" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Jesus-seijas-sp/nlpjs-examples/master/01 . quick start/02 . file corpus/corpus-en . JSON</a>上的语料库，了解支持哪些对话主题。</p><p id="7293" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，你可以在酒吧里向你的朋友展示这个东西，很容易获得他们的赞赏，因为现在你是一个真正的黑客了。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fbfa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">向意图添加挂钩</h1><p id="4080" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">您可能希望您的聊天机器人能够为每个意图调用一些额外的代码，或者用一些API调用替换一些意图的答案。让我们将<code class="fe nl nm nn na b">index.html</code>扩展到它的最终版本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="a256" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的<code class="fe nl nm nn na b">setupNLP</code>中，我们添加了一行:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4abe" class="ne md it na b gy nf ng l nh ni">nlp.onIntent = onIntent;</span></pre><p id="0c1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们创建了<code class="fe nl nm nn na b">onIntent</code>函数。请注意，<code class="fe nl nm nn na b">onIntent</code>将响应对象记录到您的控制台中，用于每个意图。它还通过用基于用户当前时间的答案替换其输出，为<code class="fe nl nm nn na b">greetings.hello</code>的意图增加了逻辑。对我来说，现在是下午:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/6668412a5bf8345e74a7b89f1add4339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mIHjtgl0fjEYs2xJaolgw.png"/></div></div></figure><p id="5822" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这不是很棒吗？如果你觉得已经准备好创建自己的人工智能创业公司，击掌吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4b15" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">已知限制</h1><p id="5269" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">请注意，NLP.js的浏览器版本不支持一些常见的自然语言处理功能，例如完整库中可用的命名实体或实体提取。</p><p id="9402" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一个库，NLP.js目前也不支持故事或后续意图。这些是当前chatbot编排开发的一部分，但在撰写本文时，该功能仍处于试验阶段。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e83d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安全和隐私考虑</h1><p id="8286" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">当使用这个解决方案时，请记住，所有访问您网站的人都可以在浏览器中看到整个语料库及其功能。这也让任何人都能够简单地下载你的语料库，操纵它，或者使用它。确保你的机器人不会暴露任何私人信息。</p><p id="c035" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用纯浏览器解决方案有一定的优势，但也失去了一些机会，因为您仍然需要一些后端解决方案，以便能够记录用户使用您的聊天机器人谈论的内容。同时，如果你记录整个对话，请考虑隐私问题，尤其是在GDPR这样的立法环境下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/9d8f3017f9594738ee530862e0fbff5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*Pa9v-te7XFT1cFZc.jpeg"/></div></figure><h1 id="8a3a" class="mc md it bd me mf nu mh mi mj nv ml mm jz nw ka mo kc nx kd mq kf ny kg ms mt bi translated">关于作者</h1><p id="8bc7" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated"><strong class="la iu">马丁·诺瓦克</strong>T7<a class="ae lu" href="https://www.meet-martin.com/" rel="noopener ugc nofollow" target="_blank">www.meet-martin.com</a></p><p id="1306" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">马丁是一位经验丰富的管理者，拥有领导国际团队的丰富经验，也是<a class="ae lu" href="https://www.7urtle.com/" rel="noopener ugc nofollow" target="_blank"> @7urtle/lambda </a>函数式编程库的创始人。</p></div></div>    
</body>
</html>