<html>
<head>
<title>6 Steps to Create a Multi-Version React Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建多版本React应用程序的6个步骤</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/6-steps-to-create-a-multi-version-react-application-1c3e5b5df7e9?source=collection_archive---------4-----------------------#2020-08-17">https://betterprogramming.pub/6-steps-to-create-a-multi-version-react-application-1c3e5b5df7e9?source=collection_archive---------4-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="70b9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">React 17具有延迟加载和深度集成React多个版本的能力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8109d463167708b9da540f11dc35567f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X2Iyvc_5IuczGTEz.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="7148" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">React团队表示，React 17中没有新功能，但<code class="fe lu lv lw lx b">react@17.0.1</code>自带了延迟加载和深度集成React多个版本的功能。这个<em class="ly">无功能</em>比任何功能都大，这是一个允许现代新应用与现有遗留应用共存的范例的垫脚石。</p><p id="b358" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种混合方法是一个逃生出口，而不是标准。使用React的单个版本是最佳实践，它消除了许多复杂性，并使您免于下载多个包。然而，在有遗留代码的环境中，这仍然是一个强大的替代方案。</p><p id="8ea8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae lz" href="https://medium.com/better-programming/5-steps-to-turn-a-random-react-application-into-a-micro-frontend-946718c147e7" rel="noopener">将随机React应用转变为微前端的5个步骤</a>中，我们绘制了上面的架构图，该图启动了多个React应用，旧的和新的，它们作为一个应用一起工作。这听起来像是类似问题的不同选择吗？</p><p id="ae75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的例子是受<code class="fe lu lv lw lx b"><a class="ae lz" href="https://github.com/reactjs/react-gradual-upgrade-demo/" rel="noopener ugc nofollow" target="_blank">Demo of Gradual React Upgrades</a></code>的启发。我们将称之为<code class="fe lu lv lw lx b">The Demo</code>。</p><p id="d312" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据我们的试验，创建多版本React应用程序有六个步骤。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="4439" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤1:将新代码移动到Src/Modern目录</h1><p id="eb04" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">和往常一样，我们从<a class="ae lz" href="https://medium.com/better-programming/10-fun-facts-about-create-react-app-eb7124aa3785" rel="noopener"> Create React App </a>开始。</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="00a9" class="ni mi it lx b gy nj nk l nl nm">npx create-react-app my-app<br/>cd my-app<br/>npm start</span></pre><p id="30c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们要将多个React应用程序放入同一个存储库中，所以我们需要设置名称空间。这是目录结构。</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="b7ed" class="ni mi it lx b gy nj nk l nl nm">src<br/> ├─ modern // new code: React 17<br/> ├─ legacy // legacy code: React 16.3.1 - could be lower version<br/> └─ shared // shared code - common source</span></pre><p id="eeaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们把<code class="fe lu lv lw lx b">src</code>的所有东西都搬到了<code class="fe lu lv lw lx b">src/modern</code>。</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="929b" class="ni mi it lx b gy nj nk l nl nm">$ ls<br/>App.css          index.css        App.js           <br/>index.js         serviceWorker.js. App.test.js      <br/>logo.svg         setupTests.js</span></pre><p id="1bef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另外，将<code class="fe lu lv lw lx b">package.json</code>复制到<code class="fe lu lv lw lx b">src/modern</code>，并做一些修改:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5daa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第2行，将其更改为一个合适的名称。保留所有的<a class="ae lz" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">依赖关系</a>，并删除剩余的部分。</p><p id="806b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在9号线和10号线，React版本已经升级到<code class="fe lu lv lw lx b">17.0.1</code>。</p><p id="1eeb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">react-scripts</code>包从依赖列表中删除。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="a583" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤2:将遗留代码移动到src/遗留目录</h1><p id="7a7d" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">遗留代码放在<code class="fe lu lv lw lx b">src/legacy</code>下。</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="2526" class="ni mi it lx b gy nj nk l nl nm">$ ls<br/>App.css          index.css        App.js           <br/>index.js         serviceWorker.js. App.test.js      <br/>logo.svg         setupTests.js</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="fdeb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第2行，将其更改为一个合适的名称。保留所有依赖项并删除其余部分。</p><p id="e7e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第9行和第10行，React版本已保持为<code class="fe lu lv lw lx b">16.13.1</code>。</p><p id="008a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从依赖列表中删除了<code class="fe lu lv lw lx b">react-scripts</code>包。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="6074" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤3:更改根package.json</h1><p id="6619" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">下面这个词根<code class="fe lu lv lw lx b">package.json</code>是从<code class="fe lu lv lw lx b">The Demo</code>复制改编而来的。之前移除的部分被放回这里，还有更多东西。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="3673" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第2行，将其更改为一个合适的名称。</p><p id="9841" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第5 - 7行是依赖项，包括构建依赖项(<code class="fe lu lv lw lx b">react-scripts</code>)和可能的反应不可知库(<code class="fe lu lv lw lx b">The Demo</code>中的<code class="fe lu lv lw lx b">redux</code>)。</p><p id="f70c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第38 - 41行是复制文件(<code class="fe lu lv lw lx b">cpx</code>)和并行/顺序运行工具(<code class="fe lu lv lw lx b">npm-run-all</code>)的一些帮助实用程序。</p><p id="7778" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些实用程序在<code class="fe lu lv lw lx b">scripts</code>(第8 - 22行)中使用，它将<code class="fe lu lv lw lx b">shared</code>文件复制到<code class="fe lu lv lw lx b">modern</code>和<code class="fe lu lv lw lx b">legacy</code>目录中，并安装、构建和监视它们。如果您想创建一个不同的目录结构，这些脚本需要进行调整。</p><p id="638c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第23 - 25行用于<code class="fe lu lv lw lx b">eslintConfig</code>。</p><p id="e97c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第26 - 37行用于<code class="fe lu lv lw lx b">browserslist</code>。</p><p id="faff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行<code class="fe lu lv lw lx b">install i</code>。它产生<code class="fe lu lv lw lx b">src/modern/node_modules</code>和<code class="fe lu lv lw lx b">src/modern/node_modules</code>。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="15e8" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤4:设置环境文件</h1><p id="8cd5" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">由于<a class="ae lz" href="https://medium.com/better-programming/10-useful-plugins-for-visual-studio-code-6ab62c0b14ee" rel="noopener"> VSCode </a>开始显示5K变化，eslint显示<code class="fe lu lv lw lx b">node_modules</code>错误，我们需要设置几个环境文件。</p><p id="d431" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">配置<code class="fe lu lv lw lx b">.env</code>启用eslint进行静态代码分析:</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="5c7a" class="ni mi it lx b gy nj nk l nl nm">EXTEND_ESLINT=true</span></pre><p id="f0a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">配置<code class="fe lu lv lw lx b">.eslintignore</code>忽略这些目录的eslint错误:</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="41e2" class="ni mi it lx b gy nj nk l nl nm">node_modules<br/>build<br/>src/*/shared</span></pre><p id="ff19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">配置<code class="fe lu lv lw lx b">.gitignore</code>以排除这些目录/文件进行源代码控制:</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="4669" class="ni mi it lx b gy nj nk l nl nm">node_modules<br/>build<br/>.DS_Store<br/>src/*/shared</span></pre><p id="8793" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在它显示了32个文件的变化。情况良好。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="49bf" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤5:设置src/index.js</h1><p id="520c" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">我们调用<code class="fe lu lv lw lx b">npm start</code>，得到如下错误:</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="b267" class="ni mi it lx b gy nj nk l nl nm">Could not find a required file.<br/>  Name: index.js<br/>  Searched in: /Users/fuje/app/react-app4/src</span></pre><p id="80b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好的，我们需要设置<code class="fe lu lv lw lx b">src/index.js</code>，它指向<code class="fe lu lv lw lx b">src/modern/index.js</code>。</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="38dc" class="ni mi it lx b gy nj nk l nl nm">import './modern/index';</span></pre><p id="24c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用<code class="fe lu lv lw lx b">npm start</code>再试一次。我们看到这个熟悉的Create React应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/7f3c2ebd13f47bef78ec163d6d5076f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5CK9EliDOnI7XQVp45CJKQ.png"/></div></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="b95c" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">步骤6:在旧应用和新应用之间搭建一座桥梁</h1><p id="cc39" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">我们有一个版本的React running。因为目标是混合旧应用和新应用，所以旧应用需要加载到新应用中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="1c69" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第5行，遗留应用程序是延迟加载的，它在第22 - 24行使用。</p><p id="37dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第13行的文本被修改，以显示它来自modern应用程序。</p><p id="4512" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行<code class="fe lu lv lw lx b">npm start</code>，我们看到现代应用与传统应用一起运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/e4b1bb71f7a1631c7bd0874cbb47ee5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-N-V1JkpcIAnijYBa2MqA.png"/></div></div></figure><p id="b392" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，一切顺利。</p><p id="2fcf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在<code class="fe lu lv lw lx b">src/legacy/App.js</code>中加入<code class="fe lu lv lw lx b">useState</code>钩子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="368a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第22-24行创建了一个被点击的按钮。</p><p id="0c33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们会遇到以下错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/9a91469a8a26f4e373ad7c3f4f707841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6qTxN2ZCY4keAxtzg59_A.png"/></div></div></figure><p id="660c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">哦，发生什么事了？</p><p id="d2fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">需要在传统应用程序和新应用程序之间架起一座桥梁。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="0743" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">6号线不调用<code class="fe lu lv lw lx b">React.lazy</code>，而是调用<code class="fe lu lv lw lx b">src/modern/lazyLegacyRoot.js</code>内部定义的<code class="fe lu lv lw lx b">lazyLegacyRoot</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f5e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是桥的一端。在第17-19行，它从遗留代码中动态导入<code class="fe lu lv lw lx b">createLegacyRoot</code>。然后调用两个<code class="fe lu lv lw lx b">useLayoutEffect</code>(第25-33行用于创建，第36-40行用于更新)用新版本React重新呈现代码。</p><p id="4e3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">useLayoutEffect</code>的签名与<code class="fe lu lv lw lx b">useEffect</code>相同，但在所有DOM突变后同步触发。在浏览器有机会绘制之前，安排在<code class="fe lu lv lw lx b">useLayoutEffect</code>中的更新将被同步刷新。</p><p id="5089" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看桥的另一端:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="22f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第8-10行定义了一种呈现方法。</p><p id="bb6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第11-13行定义了卸载的方法。</p><p id="5ecb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过桥梁的两端，我们使多版本React应用程序正常工作:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/4dbfabab8a2b55689b89cd428974960e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Azo0ciPsgjiWcO_M3pknrQ.png"/></div></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="6763" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">演示</h1><p id="743a" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated"><code class="fe lu lv lw lx b">The demo</code>可以下载并运行:</p><pre class="kj kk kl km gt ne lx nf ng aw nh bi"><span id="9b0f" class="ni mi it lx b gy nj nk l nl nm">git clone https://github.com/reactjs/react-gradual-upgrade-demo.git<br/>cd react-gradual-upgrade-demo<br/>npm i<br/>npm start</span></pre><p id="56ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它包括两条路线:</p><ul class=""><li id="3923" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">回家的路线:它只显示新的应用程序。可见组件由React 17渲染。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d5c63be2f7d5d48d48ec21be79d38528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JUD1GzdVKH46Ld9k57rXFg.png"/></div></div></figure><ul class=""><li id="565c" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">关于路线:它显示了一个混合了新旧应用程序的用户界面。虚线外的组件由React 17渲染，虚线内的组件由React 16.8.6渲染。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/2ab501b537cad837184b3703301e6e0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OfHWaLRjqVoc7S0vkHNxig.png"/></div></div></figure><p id="89b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">The demo</code>比我们这里描述的例子更高级。它展示了如何共享一个主题作为一个全局上下文，以及如何在应用程序之间共享一个Redux store(用于counter)。它还共享<code class="fe lu lv lw lx b">useTime</code>挂钩和时钟显示。值得下载<code class="fe lu lv lw lx b">The demo</code>深入了解一下。</p><p id="5253" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尝试我们总结的六个步骤来创建您自己的多版本React应用程序。React 17提供了延迟加载和React多个版本深度集成的能力。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="d1c4" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="376b" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">反应17号来了。它改变<a class="ae lz" href="https://medium.com/better-programming/whats-the-difference-between-synthetic-react-events-and-javascript-events-ba7dbc742294" rel="noopener">合成反应事件</a>，以及其他一些特性。阅读<a class="ae lz" href="https://reactjs.org/blog/2020/08/10/react-v17-rc.html" rel="noopener ugc nofollow" target="_blank">这篇</a>了解更多信息。</p><p id="d5b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">React 17是一个主要版本。我们需要做出反应17，以获得在未来不那么快行动的能力。酷吗？</p><p id="acf2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。我希望这有所帮助。你可以在这里看到我的其他媒体出版物<a class="ae lz" href="https://medium.com/@jenniferfubook/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener"/>。</p></div></div>    
</body>
</html>