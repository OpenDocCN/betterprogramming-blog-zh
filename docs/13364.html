<html>
<head>
<title>Here’s a Lovely Dress to Understand API Gateway With Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这里有一件可爱的衣服，可以和Golang一起了解API Gateway</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lovely-dress-to-understand-api-gateway-with-golang-660effb560a1?source=collection_archive---------0-----------------------#2022-08-21">https://betterprogramming.pub/lovely-dress-to-understand-api-gateway-with-golang-660effb560a1?source=collection_archive---------0-----------------------#2022-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a6c7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们学习API网关</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/141b6bc996c461739f2fafae49510ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Bgvbw7KUBG3_vrTrTHUNQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图:梦露风格的地鼠</p></figure><p id="8416" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">哇，这么可爱的裙子！在网上冲浪时，如果我们以前搜索过，几乎不可能看不到漂亮衣服的广告。然而，当我们点击这些服装广告时会发生什么呢？我们被引导到购物网站，看到这件衣服的所有细节。这些细节是来自同一个服务，还是被聚合并发送给我们？今天，我将讨论第二个选项，即API网关。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h1 id="5f61" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">什么是API网关？</h1><p id="2f8a" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">API网关通过将来自客户端的所有API调用路由到适当的微服务来处理它们，并调用这些微服务和聚集结果。API网关对其客户端隐藏内部API。如果微服务中有任何故障，API网关可以通过返回缓存或默认数据来屏蔽它们。它简化了客户端实现和微服务应用，因为它是来自客户端的每个请求的入口点。</p><h1 id="3f9e" class="ly lz iq bd ma mb mv md me mf mw mh mi jw mx jx mk jz my ka mm kc mz kd mo mp bi translated">项目概述</h1><p id="a51c" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">我们的客户点击我们可爱的裙子，查看更多细节。当他们点击它，他们可以看到它的id，名称，描述，股票和价格。但是，没有这样的服务可以提供所有这些细节。这些细节来自不同的服务。我们需要汇总这些信息，并将其发送给我们的客户。我们需要一个英雄来做这件事。在这一点上，API网关显露出来。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/807a67055ff2c90beb70aa48cbf0437f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzOJbI8D4slsX2SpLeXq7w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图:整体架构</p></figure><p id="1863" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当客户想看我们漂亮的衣服时，他们向网关发送一个请求，网关有<code class="fe nb nc nd ne b">products/:id</code>端点。为了汇总所有这些细节，网关向我们的后端微服务发送一个请求，这些服务具有不同的端点。如果没有网关，我们的客户端应该已经向这些微服务发送了请求。</p><h1 id="99f5" class="ly lz iq bd ma mb mv md me mf mw mh mi jw mx jx mk jz my ka mm kc mz kd mo mp bi translated">深入API网关</h1><p id="59bc" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">我们的英雄应该进行三次API调用来聚合这些信息。从效率的角度来看，同时运行尽可能多的调用<strong class="kx ir">和</strong>会更加明智。她想回应所有要求查看礼服细节的顾客。虽然她不能同时出现在每个地方，但她可以飞得很快来收集所有的数据。她需要减少总等待时间。这就是为什么我们要帮助她。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="c606" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们有不止一个goroutine，因为我们有三个API调用。我们的英雄很忙，所以她需要知道她的工作什么时候完成。因此，我们等待三个goroutines完成，然后将聚合数据发送给客户端。</p><h1 id="6fe3" class="ly lz iq bd ma mb mv md me mf mw mh mi jw mx jx mk jz my ka mm kc mz kd mo mp bi translated">奖金:BFF</h1><p id="4e30" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">假设您同时拥有移动服务和web服务，这意味着您有不同的用户界面，并且您知道移动体验的本质通常与桌面web体验截然不同。您喜欢为每种客户端提供一个API，还是为每个客户端提供一个API？</p><p id="552b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们所说的差异化是什么意思？移动设备需要更少的呼叫来获得更好的电池寿命，并且在与台式机进行比较时需要显示不同的数据。因此，两种用户界面都需要由具有独特功能的不同API来支持，而不是由一个通用API来支持。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/dafe21b90bca867414cb351006cb0bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*89Kq9cdG7JDf7wircj7AeQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图:BFF概念摘自山姆·纽曼的文章</p></figure><p id="2c2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你以前可能听说过下游和上游服务。这些术语用于描述相关服务请求链的方向。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/a8037dc1afda7a8fe99ca0e4b14b034d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3indJb9SgXn5S0JRuC0MxA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图:客户端在服务器的下游；服务器在客户端的上游</p></figure><p id="e58d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下游服务发起请求并接收响应。</p><p id="7d78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上游服务接收请求并返回响应。</p><p id="cd5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于BFF的更多细节，你可以阅读<a class="ae nj" href="https://samnewman.io/patterns/architectural/bff/#general" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><h1 id="adb1" class="ly lz iq bd ma mb mv md me mf mw mh mi jw mx jx mk jz my ka mm kc mz kd mo mp bi translated"><strong class="ak">源代码</strong></h1><p id="6382" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">【https://github.com/dilaragorum/lovely-dress-go T4】</p><p id="4c62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">谢谢你读到这里。我试图保持我的项目简单，以专注于主要概念，即API网关。如果你有任何建议和反馈，我会很高兴。</p><p id="a505" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是我之前文章的链接:</p><ul class=""><li id="3137" class="nk nl iq kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated"><a class="ae nj" href="https://medium.com/better-programming/build-basic-real-time-competition-app-with-go-96c2ca0d35bf" rel="noopener"> <em class="nt">用Go </em> </a>搭建一个基本的实时比赛App</li><li id="8f5d" class="nk nl iq kx b ky nu lb nv le nw li nx lm ny lq np nq nr ns bi translated"><a class="ae nj" href="https://medium.com/better-programming/lets-build-a-movie-api-with-clean-architecture-ef1f555b563d" rel="noopener"> <em class="nt">让我们使用Go </em> </a>构建一个具有分离分层架构的电影API</li><li id="4029" class="nk nl iq kx b ky nu lb nv le nw li nx lm ny lq np nq nr ns bi translated"><a class="ae nj" href="https://medium.com/towardsdev/golang-beginner-unit-testing-tutorial-98d700d40679" rel="noopener"> <em class="nt"> GoLang初学单元测试教程</em> </a></li></ul></div></div>    
</body>
</html>