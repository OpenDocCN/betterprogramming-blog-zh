<html>
<head>
<title>Everything I Discovered About GraphQL and Apollo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我发现的关于GraphQL和阿波罗的一切</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/everything-i-discovered-about-graphql-and-apollo-e774d1e11638?source=collection_archive---------12-----------------------#2020-08-17">https://betterprogramming.pub/everything-i-discovered-about-graphql-and-apollo-e774d1e11638?source=collection_archive---------12-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1cd4" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">开发者体验</h2><div class=""/><div class=""><h2 id="62e2" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">一路上我学到了什么</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1a96c83ca7e6e1a7ff485d7e99842ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOQZxhcvQjPkG6ewVccxSg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/s/photos/abstract?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lh" href="https://unsplash.com/@aplaceforcreation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">图板</a>拍照</p></figure><p id="1d9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在前端开发的早期，从Web APIs获取数据是一个非常无聊的过程。事实上，数据模型被冻结了，这意味着您面临以下情况之一:</p><ul class=""><li id="f9eb" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">数据模型对于您的用例来说太丰富了。</li><li id="f503" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">一些数据丢失了。</li><li id="c84b" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">您需要链接请求以获得预期的数据结构。</li></ul><p id="8427" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了克服这些情况(并减轻前端开发人员的任务)，GraphQL应运而生。它提供了一种从后端获取数据的新方法。GraphQL没有处理冻结的数据结构，而是提供了一种查询语言，允许我们只获取我们需要的东西。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ms"><img src="../Images/149f6b1bfae7213808b94e50ed298556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*q0zVKRlfEXheh3gj"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@federize?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">费德里科·贝卡里</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="f06b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我不会解释GraphQL如何工作或如何设置它——Medium上有许多关于GraphQL及其web和移动应用程序客户端Apollo的有意义的文章，您可以在这里找到文档:</p><div class="mt mu gp gr mv mw"><a href="https://graphql.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">GraphQL:一种API查询语言。</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">学习准则社区规范行为准则基金会景观学习准则社区规范行为准则基金会…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">graphql.org</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk lb mw"/></div></div></a></div><p id="79e4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">还有这里:</p><div class="mt mu gp gr mv mw"><a href="https://www.apollographql.com/docs/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">文档主页</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">欢迎光临！👋Apollo是一个构建数据图的平台，一个无缝连接您的…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.apollographql.com</p></div></div><div class="nf l"><div class="nl l nh ni nj nf nk lb mw"/></div></div></a></div></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="cf57" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将分享我在使用GraphQL和Apollo来简化开发并使Apollo相关代码可重用时发现的一些技巧。</p><p id="e14c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="nt">免责声明:</em> </strong> <em class="nt">大部分代码片段关注Vue.js和Vue Apollo。无论如何，在我介绍概念和提示时，我猜想它们可以应用于GraphQL和Apollo支持的任何其他JavaScript框架。</em></p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="d84c" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">首先要做的是…</h1><h2 id="f1c1" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">GraphQL</h2><p id="bacc" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">正如我前面所说，GraphQL是一种新技术，它改变了后端和前端开发人员之间的关系。</p><p id="a7a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以前，两个团队都必须定义一个契约接口来确保正确的实现。有时，由于对对象复杂性或类型的误解，可能会出现延迟。</p><p id="2a07" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">多亏了GraphQL，后端可以提供前端可能需要的所有数据。然后，由他们来“挑选”构建界面所需的属性。</p><p id="77d5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，GraphQL提供了一个web接口(名为graph QL)来测试查询和突变(如果你不明白我写的是什么，请参考<a class="ae lh" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank">文档</a>)。这是一个聪明的工具，可以让前端写请求，浏览文档和打字。</p><div class="mt mu gp gr mv mw"><a href="https://github.com/graphql/graphiql" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">图表ql/图表QL</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">寻找图形文档？:这是monorepo的根源！完整的图形文档位于…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">github.com</p></div></div><div class="nf l"><div class="pc l nh ni nj nf nk lb mw"/></div></div></a></div><h2 id="c675" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">一种查询语言</h2><p id="2f61" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">使用GraphQL意味着理解和掌握工具包中包含的查询语言。这不是一个小问题，它基于一个<em class="nt">对象嵌套</em>语法。</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="5c92" class="om nv it pe b gy pi pj l pk pl">query GetProductInfo {<br/>  product {<br/>    id<br/>    name<br/>    price<br/>  }<br/>}</span></pre><p id="e85c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当查询对象看似简单时，对于突变来说就不是这样了。变异更新/插入新数据，可能带有一些参数。</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="0ce9" class="om nv it pe b gy pi pj l pk pl">mutation ($label: String!) {<br/>  addTag(label: $label) {<br/>    id<br/>    label<br/>  }<br/>}</span></pre><p id="6de4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里，一个参数用它在L1上的类型来指定。然后，用在第二行。方括号<code class="fe pm pn po pe b">id</code>和<code class="fe pm pn po pe b">label</code>之间的结束内容定义了返回对象的结构，即插入的结果。</p><h2 id="01c7" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">阿波罗</h2><p id="250f" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">Apollo是用于与GraphQL通信的客户端。无论你开发的是web还是手机app，Apollo都能支持。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/d85dadd0db02da8dbd102e20cdb6107a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1PB4iYNgIEPhzyGC4KFCQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.apollographql.com/docs/intro/platform/" rel="noopener ugc nofollow" target="_blank">https://www.apollographql.com/docs/intro/platform/</a></p></figure><p id="7b90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Apollo支持多种平台:</p><ul class=""><li id="2a0c" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">JavaScript: <a class="ae lh" href="https://www.apollographql.com/docs/angular/" rel="noopener ugc nofollow" target="_blank">角度</a>，<a class="ae lh" href="https://www.apollographql.com/docs/react/" rel="noopener ugc nofollow" target="_blank">反应</a>，<a class="ae lh" href="https://github.com/Akryum/vue-apollo" rel="noopener ugc nofollow" target="_blank"> Vue </a>，<a class="ae lh" href="https://www.apollographql.com/docs/angular/recipes/meteor/" rel="noopener ugc nofollow" target="_blank">流星</a>，<a class="ae lh" href="https://github.com/bgentry/ember-apollo-client" rel="noopener ugc nofollow" target="_blank">余烬</a>，<a class="ae lh" href="https://github.com/aruntk/polymer-apollo" rel="noopener ugc nofollow" target="_blank">聚合物</a></li><li id="5969" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">原生手机:<a class="ae lh" href="https://www.apollographql.com/docs/ios/" rel="noopener ugc nofollow" target="_blank">原生iOS带Swift </a>，<a class="ae lh" href="https://github.com/apollographql/apollo-android" rel="noopener ugc nofollow" target="_blank">原生安卓带Java </a></li></ul><p id="7527" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其配置允许定义具体的方面，如:<a class="ae lh" href="https://www.apollographql.com/docs/react/api/core/ApolloClient/#apolloclient-functions" rel="noopener ugc nofollow" target="_blank">缓存-网络策略</a>、<a class="ae lh" href="https://www.apollographql.com/docs/react/networking/advanced-http-networking/" rel="noopener ugc nofollow" target="_blank">管道</a>(此处涉及)、<a class="ae lh" href="https://www.apollographql.com/docs/react/performance/server-side-rendering/" rel="noopener ugc nofollow" target="_blank">服务器端渲染</a> ( <a class="ae lh" href="https://apollo.vuejs.org/guide/ssr.html" rel="noopener ugc nofollow" target="_blank"> Vue.js版本</a>)、<a class="ae lh" href="https://www.apollographql.com/docs/react/local-state/local-state-management/" rel="noopener ugc nofollow" target="_blank">本地状态</a> ( <a class="ae lh" href="https://apollo.vuejs.org/guide/local-state.html" rel="noopener ugc nofollow" target="_blank"> Vue.js版本</a>)、<a class="ae lh" href="https://www.apollographql.com/docs/react/performance/performance/" rel="noopener ugc nofollow" target="_blank">性能</a>、<a class="ae lh" href="https://www.apollographql.com/docs/react/data/error-handling/" rel="noopener ugc nofollow" target="_blank">错误处理</a>(此处涉及)或国际化(此处涉及)。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="35f5" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">使查询可重用</h1><h2 id="52c9" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">ES6来救援了！</h2><p id="2e05" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">它们是创建Apollo查询(也称为GraphQL文档)的许多方法。最常见的是使用<code class="fe pm pn po pe b">graphql-tag</code> <strong class="lk jd"> </strong>解析器。</p><div class="mt mu gp gr mv mw"><a href="https://github.com/apollographql/graphql-tag" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">apollographql/graphql-tag</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">解析GraphQL查询的JavaScript模板文字标记- apollographql/graphql-tag</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">github.com</p></div></div><div class="nf l"><div class="pq l nh ni nj nf nk lb mw"/></div></div></a></div><p id="d2e2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，查询将如下所示:</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="4664" class="om nv it pe b gy pi pj l pk pl">import gql from 'graphql-tag'</span><span id="dadc" class="om nv it pe b gy pr pj l pk pl">const hello query = gql`query sayHello {<br/>  hello<br/>}`</span></pre><p id="bbd5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="nt">将此类查询存储在一个专门的文件夹中是一个好习惯，例如</em> <code class="fe pm pn po pe b"><em class="nt">~/api/apollo-queries</em></code> <em class="nt">并在一个特定的文件中按特征将它们分开:您将收集关于</em> <code class="fe pm pn po pe b"><em class="nt">user</em></code> <em class="nt">、</em> <code class="fe pm pn po pe b"><em class="nt">product</em></code> <em class="nt">或</em> <code class="fe pm pn po pe b"><em class="nt">contract</em></code> <em class="nt">关注点的查询。</em></p><p id="e653" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可能知道GraphQL文档有几个<a class="ae lh" href="https://apollo.vuejs.org/api/smart-query.html#options" rel="noopener ugc nofollow" target="_blank">属性</a>:</p><ul class=""><li id="a9a6" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><code class="fe pm pn po pe b">query</code>:带有<code class="fe pm pn po pe b">gql</code>解析器的查询本身。</li><li id="42d2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><code class="fe pm pn po pe b">variables</code>:如果需要传递一些参数。</li><li id="8e8e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><code class="fe pm pn po pe b">update</code>:用于格式化查询响应或计算额外操作的回调函数。</li></ul><p id="2451" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">后一个属性是我们创建可重用查询的切入点。实际上，对于一个简单的查询，您可能想要执行不同的操作。</p><p id="0530" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ES6的析构赋值和扩展操作符特性是在多个地方重用单个查询的强大工具。这里有一些例子。</p><h2 id="3810" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated"><strong class="ak"> <em class="ps">变量不同</em> </strong></h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><h2 id="d745" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated"><code class="fe pm pn po pe b"><strong class="ak">Update</strong></code> <strong class="ak"> <em class="ps">回调不同于</em> </strong></h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><h2 id="ba0d" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated"><strong class="ak"> <em class="ps">重用查询商店更新</em> </strong></h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><h2 id="e5ef" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">条件和参数化查询</h2><p id="b987" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">正如Vue Apollo文档的<a class="ae lh" href="https://apollo.vuejs.org/guide/apollo/queries.html#reactive-query-definition" rel="noopener ugc nofollow" target="_blank">部分</a>所描述的，我们可以创建条件查询——也就是反应式查询定义——这样我们就可以对变量进行查询。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Apollo查询中的反应式查询模板</p></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Apollo查询中的反应变量</p></figure><p id="fe90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，您可以在查询模板中插入任何您想要的代码，因为<code class="fe pm pn po pe b">gql</code>解析器只是一个字符串插值。所以，你可以很容易地写出这个突变:</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="fadb" class="om nv it pe b gy pi pj l pk pl">gql`<br/>  mutation UpdateBirthdate ($bd: String!) {<br/>    updateBirthdate(input: {<br/>      birthDate: ${'"' + moment($bd).format('YYYY-MM-DD') + '"'}<br/>    }){<br/>      ok<br/>    }<br/>  }<br/>`</span></pre><p id="4d81" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不是<em class="nt">干净</em>的做法，但是有时候省时省力。在将输入发送到变异之前，最好对输入进行<em class="nt">净化。</em></p><p id="4e09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://momentjs.com/docs/" rel="noopener ugc nofollow" target="_blank"> Moment.js </a>是一个处理日期时间的js库。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="6a3a" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">上下文化GraphQL查询</h1><h2 id="8f07" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">命名您的查询</h2><p id="030a" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">如果检查查询GraphQL服务器时发送的HTTP请求，可以看到一个<code class="fe pm pn po pe b">operationName</code>属性:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pv"><img src="../Images/afb44ee25a7aa14e60166645e875b6f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EfFILT21JauilcP3hFO4tw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:作者</p></figure><p id="34ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">给Apollo查询添加一个名字似乎毫无意义，但是在调试时或者如果你想跟踪REST APIs调用时，它会非常有用。事实上，在我的公司中，我们希望跟踪这些对性能和服务器效率的请求。</p><p id="9720" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">命名查询非常简单方便:</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="9920" class="om nv it pe b gy pi pj l pk pl">query <strong class="pe jd">GetProductInfo</strong> { <br/>  product { <br/>    id<br/>    name<br/>    price<br/>  }<br/>}</span></pre><h2 id="991c" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">国际化</h2><p id="275a" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">国际化(或i18n)是关于适应你的应用程序中的语言和文化。然而，为每种语言提供翻译可能会很烦人——这会加重软件包的负担，并且需要更新。</p><p id="9952" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您知道GraphQL服务器能够支持国际化得益于一个查询参数吗？它只需要在服务器端做一些修改。</p><p id="81e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">关于前端，必须进行额外的配置。它包括在Apollo客户机的<code class="fe pm pn po pe b">HttpLink</code>设置中指定一个管道——这并不难:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><p id="bba9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="nt">你可以在管道中进行连锁操作，更多细节</em> <a class="ae lh" href="https://www.apollographql.com/docs/react/api/link/introduction/#composing-a-link-chain" rel="noopener ugc nofollow" target="_blank"> <em class="nt">这里</em> </a> <em class="nt">。</em></p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="6e6b" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">改善编码体验</h1><p id="ea1d" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">您可能已经注意到GraphQL查询响应包含一个<code class="fe pm pn po pe b">__typename</code>属性:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pw"><img src="../Images/5ab75264063b1c4c87ab7a899d6c30a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GpZ15U9Gu1-If7vesw49lQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:作者</p></figure><p id="073e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当在变异中使用相同的对象时，将出现以下错误:</p><pre class="ks kt ku kv gt pd pe pf pg aw ph bi"><span id="5f60" class="om nv it pe b gy pi pj l pk pl">"Variable "$data" got invalid value {<br/>  "__typename": "UserSchema",<br/>  //...<br/>  "phone": "06 07 08 09 11"<br/>}.<br/><strong class="pe jd">In field "__typename": Unknown field</strong>."</span></pre><p id="538b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">事实上,<code class="fe pm pn po pe b">__typename</code>属性仍然存在，为了使变异生效，必须将其删除。深入研究<code class="fe pm pn po pe b">InMemoryCache</code> <a class="ae lh" href="https://www.apollographql.com/docs/react/caching/cache-configuration/#configuration-options" rel="noopener ugc nofollow" target="_blank">文档</a>，我们可以从查询响应中删除该属性:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><h2 id="67f7" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">订购查询</h2><p id="9424" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">在代码的某些地方，必须同时启动几个查询。有时，根据查询的响应，我们想要启动一个新的查询或跳过一个请求。</p><p id="c58f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">幸运的是，阿波罗提供了一种减轻这些任务的方法！事实上，在<code class="fe pm pn po pe b">query</code>对象上，存在一个<code class="fe pm pn po pe b">skip</code>属性:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Vue实现订购Apollo查询</p></figure><p id="4689" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一方面，要跳过请求:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">跳过请求的Vue实现</p></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="d950" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">类型脚本支持</h1><p id="cd13" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">Vue Apollo不直接支持Typescript。但是，您可以添加一些类型，并在代码中集成一些Typescript功能来解决任何问题。</p><p id="ee31" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">代码生成器用于根据GraphQL模式生成类型。就我个人而言，我没有使用其中的一个，所以如果你有兴趣，请参考:</p><div class="mt mu gp gr mv mw"><a href="https://github.com/dotansimha/graphql-code-generator" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">dotansimha/graphql代码生成器</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">graphql-code-generator.com graph QL Codegen 1.0在这里！GraphQL代码生成器是一个工具，生成代码了…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">github.com</p></div></div><div class="nf l"><div class="px l nh ni nj nf nk lb mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://www.leighhalliday.com/generating-types-apollo" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">在Apollo中从GraphQL模式生成TypeScript类型</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">GraphQL是一种类型化语言，那么为什么要在我们的TypeScript代码中重新定义所有的类型呢</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.leighhalliday.com</p></div></div><div class="nf l"><div class="py l nh ni nj nf nk lb mw"/></div></div></a></div></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="c781" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">改善用户体验</h1><h2 id="8198" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">使用装载状态</h2><p id="e4bb" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">由于服务器的响应时间是不确定的，我们必须警告用户有东西正在处理。目前的趋势是使用<a class="ae lh" href="https://uxdesign.cc/what-you-should-know-about-skeleton-screens-a820c45a571a" rel="noopener" target="_blank">骨架</a>:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pz"><img src="../Images/2605965a7ee0d0a9450e7335a151c35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7X-VIi8HVEPSZlByL_F-fA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">骨架示例(来源:作者)</p></figure><p id="26d3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">GraphQL查询对象在处理加载状态管理时对开发人员非常友好。的确，它提供了一个布尔<a class="ae lh" href="https://apollo.vuejs.org/guide/apollo/queries.html#loading-state" rel="noopener ugc nofollow" target="_blank">属性</a>T4。因此，我们可以在模板中使用它:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用加载属性的Vue模板实现</p></figure><h2 id="4e1c" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">使用Apollo Store缩短响应时间</h2><p id="80a0" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">阿波罗商店就像一个缓存。它节省了HTTP请求，并允许我们几乎立即获得数据。如果使用<code class="fe pm pn po pe b">cache-and-network</code>策略(默认情况下)，Apollo客户机将首先从存储中获取数据，如果数据丢失，则从GraphQL服务器上获取数据。</p><p id="5bf7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我推荐使用阿波罗客户端开发工具Chrome扩展来轻松操作和调试阿波罗商店。</p><div class="mt mu gp gr mv mw"><a href="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">Apollo客户端开发工具</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">Chrome开发者控制台中Apollo客户端的GraphQL调试工具。</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">chrome.google.com</p></div></div><div class="nf l"><div class="qa l nh ni nj nf nk lb mw"/></div></div></a></div><p id="260c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果在后端正确实现了突变，它们将在响应中返回更新的资源。这种行为允许更新Apollo商店，所以当你在你的应用程序中导航到其他地方时，数据将已经可用——你不需要做其他查询。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure><h2 id="f357" class="om nv it bd nw on oo dn oa op oq dp oe lr or os og lv ot ou oi lz ov ow ok iz bi translated">错误处理</h2><p id="29d9" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">在应用程序上导航时，可能会出现各种错误。无论它们是来自内部服务器错误还是网络故障，都必须得到处理。</p><p id="5800" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是在Apollo提供者级别管理的。这里，我们在会话令牌(cookie)丢失的情况下处理网络错误:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pt pu l"/></div></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="4f33" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">最后的话</h1><p id="7f6c" class="pw-post-body-paragraph li lj it lk b ll ox kd ln lo oy kg lq lr oz lt lu lv pa lx ly lz pb mb mc md im bi translated">毫无疑问:GraphQL超级强大。它简化了后端和前端团队之间的编码体验和交互。但是，它也有一些缺点，尤其是在处理类型脚本支持时。此外，根据您的数据模型和您希望构建页面的方式，对查询进行排序并不容易，而且可能会变得更加复杂。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="a4bd" class="nu nv it bd nw nx ny nz oa ob oc od oe ki of kj og kl oh km oi ko oj kp ok ol bi translated">资源</h1><div class="mt mu gp gr mv mw"><a href="https://graphql.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">GraphQL:一种API查询语言。</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">学习准则社区规范行为准则基金会景观学习准则社区规范行为准则基金会…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">graphql.org</p></div></div><div class="nf l"><div class="qb l nh ni nj nf nk lb mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://www.apollographql.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">阿波罗图表</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">Apollo数据图平台——将API、微服务和数据库统一到一个数据图中，您可以使用GraphQL进行查询</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.apollographql.com</p></div></div><div class="nf l"><div class="qc l nh ni nj nf nk lb mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://apollo.vuejs.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">阿波罗万岁</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">🚀将GraphQL集成到您的Vue.js应用中！开始→不要考虑更新UI或重新提取查询…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">apollo.vuejs.org</p></div></div><div class="nf l"><div class="qd l nh ni nj nf nk lb mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://www.apollographql.com/docs/react/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">阿波罗客户端简介</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">将Apollo GraphQL客户端与React一起使用的指南</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.apollographql.com</p></div></div><div class="nf l"><div class="qe l nh ni nj nf nk lb mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://www.leighhalliday.com/generating-types-apollo" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd jd gy z fp nb fr fs nc fu fw jc bi translated">在Apollo中从GraphQL模式生成TypeScript类型</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">GraphQL是一种类型化语言，那么为什么要在我们的TypeScript代码中重新定义所有的类型呢</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.leighhalliday.com</p></div></div><div class="nf l"><div class="py l nh ni nj nf nk lb mw"/></div></div></a></div></div></div>    
</body>
</html>