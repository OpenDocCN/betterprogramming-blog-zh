<html>
<head>
<title>Apache Kafka — Resiliency, Fault Tolerance, &amp; High Availability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Kafka —弹性、容错和高可用性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/apache-kafka-resiliency-fault-tolerance-high-availability-8ab1c35c8823?source=collection_archive---------1-----------------------#2019-08-20">https://betterprogramming.pub/apache-kafka-resiliency-fault-tolerance-high-availability-8ab1c35c8823?source=collection_archive---------1-----------------------#2019-08-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5a42" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解Apache Kafka的弹性、容错和高可用性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/670ca61bf82d02b137a729cfe063b08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiMufWTN88ANEzikKo8bVg.png"/></div></div></figure><p id="f048" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Apache Kafka是一个分布式系统，分布式系统会出现多种类型的故障。一些经典案例包括:</p><ol class=""><li id="f2c6" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">代理停止工作，变得无响应，并且无法访问</li><li id="f3bb" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">数据存储在磁盘上，某个场景会导致磁盘出现故障，然后无法访问数据</li><li id="9cbe" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">假设一个集群中有多个代理。每个代理都是多个分区的领导者。如果其中一个代理出现故障或无法访问，将会导致数据丢失。</li></ol><p id="a9bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些是动物园管理员前来救援的场景。当ZooKeeper意识到其中一个代理关闭时，它会执行以下操作:</p><ol class=""><li id="04d8" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">它将找到另一个代理来代替失败的代理</li><li id="96ee" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">它将更新用于生产者和消费者工作分配的元数据，以确保系统继续运行</li></ol><p id="ac4b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦ZooKeeper执行了上述两个步骤，消息的发布和消费将照常继续。这里的挑战是失败的代理包含一些数据。除非做好准备将数据复制到其他地方，否则会出现数据丢失的情况。</p><p id="b74c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Kafka提供了一个配置属性来处理这个场景— <em class="me">复制因子</em>。该属性确保所有数据都存储在多个代理中。即使在上面列出的故障的情况下，复制因子也将确保没有数据丢失的风险。</p><p id="5879" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一个需要注意的重要事情是，必须确定复制因子的数量。例如，如果复制因子设置为5，则意味着数据在5个代理上复制。因此，即使在五分之四的经纪人倒下的情况下，也不会有数据丢失。</p><p id="a7aa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里需要理解的另一个术语是同步副本或ISR中的<em class="me">。当副本集完全同步时，即ISR等于复制因子，这意味着每个主题和主题内的每个分区都处于健康状态。</em></p><p id="7651" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">让我们在下面的视频中看看阿帕奇卡夫卡是如何展示这些特征的- </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="6533" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">上面视频教程的步骤列在</strong>下面</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mh mg l"/></div></figure><p id="cbaf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">参考文献</strong>—</p><p id="eda3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae mi" href="https://kafka.apache.org/" rel="noopener ugc nofollow" target="_blank">https://kafka.apache.org/</a></p></div></div>    
</body>
</html>