<html>
<head>
<title>Custom Snackbars in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android中的自定义零食条</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/custom-snackbars-in-android-5cb90af2728e?source=collection_archive---------0-----------------------#2019-12-27">https://betterprogramming.pub/custom-snackbars-in-android-5cb90af2728e?source=collection_archive---------0-----------------------#2019-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3382" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Android显示浮动信息的新方式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3077c5608b4b7b602d14ab058d85d087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qANBdMGD66RuXgzYtTJ19g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本·赫尔希在Unsplash<a class="ae ky" href="https://unsplash.com/s/photos/marquee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">上的照片</a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="729d" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">引入和集成</h1><p id="268e" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">是时候告别Android中美好的旧祝酒词了，欢迎被称为Snackbars的下一代祝酒词。</p><p id="6bd8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Snackbar是下一代toast视图，比您想象的有更多的定制选项。</p><p id="c424" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Snackbar是在材料设计中引入的。它可通过设计支持库获得。但是，随着Android开发从支持库转向AndroidX，Snackbar将通过材料设计库提供给我们。</p><p id="5c59" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">通过在<code class="fe mz na nb nc b">build.gradle</code>文件中添加下面一行来集成材料设计库，我们可以在我们的AndroidX项目中有一个Snackbar。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="c33b" class="nh lh it nc b gy ni nj l nk nl">implementation 'com.google.android.material:material:1.0.0'</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="f009" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">小吃店的力量</h1><p id="73e2" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">与toast消息不同，我们可以让click listeners显示Snackbar中的视图，通过这些视图我们可以执行定制的操作或关闭Snackbar。从UX的角度来看，Snackbar进入了协调器布局的下一个层次。除此之外，我们还可以创建定制的Snackbar。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="d478" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">小挫折</h1><p id="7d31" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">但是所有伟大的事情都是有代价的。这里的代价是，我们应该有一个观点来联系小吃店。我们可以在任何需要的地方显示toast消息，但要显示Snackbar，它应该与上下文和活动布局中的一个视图实例相关联。</p><p id="fe4d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">除此之外，只有当相关视图显示在屏幕上时，Snackbar才会显示。让我解释清楚:如果您在名为Activity1的屏幕上显示Snackbar和相关视图，那么如果您取消Activity1，Snackbar也会隐藏，即使时间没有结束。我认为这种做法在大多数情况下是合理的。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8c80" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">简单的小吃和一些策略</h1><p id="7a5d" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">显示Snackbar就像显示toast消息一样简单。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单小吃店</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/7ba172da4174c65070306eaf71255ca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxRlZvoGBKISdUgk6EDO3g.png"/></div></div></figure><p id="44b5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">与toast视图不同，我们还可以自定义默认Snackbar的颜色，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有自定义背景色的默认Snackbar</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/273f27383b2e5b3e0a322852eaa54942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0Cn6wi712G4lkOfzyBr5Q.png"/></div></div></figure><p id="1a0e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在是时候给Snackbar添加一个简单的动作按钮了。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有自定义背景和操作按钮的Snackbar</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/7245bcc4ca05125b69f47525d42b41b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpagmChVdh86bQIJu1hMlg.png"/></div></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="5f8a" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">用于错误和成功消息的自定义Snackbar</h1><p id="a14e" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">假设您需要一个错误图标和红色背景来显示错误消息，需要一个绿色背景的成功图标来显示成功消息。</p><p id="54d8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">为此，我们首先需要创建一个XML布局文件，以merge作为根标签。假设现在我们需要一个图标在左边，消息在中间，动作标签在右边。让我们看看如何创建它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="4de0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">下一步是创建一个定制的Snackbar类，它扩展了约束布局和<code class="fe mz na nb nc b">ContentViewCallback</code>来让我们知道Snackbar的存在。我们来看看怎么做。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="013e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，展开自定义视图。我发现通过XML来扩展自定义视图更好，这样我可以很容易地自定义它的属性，甚至创建一个样式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="11db" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">下一步是创建一个扩展<code class="fe mz na nb nc b">BaseTransientBottomBar</code>的类来创建Snackbar equal行为。如果你看到默认的Snackbar类也是由<code class="fe mz na nb nc b">BaseTransientBottomBa</code>扩展的。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1b23" class="nh lh it nc b gy ni nj l nk nl">public final class Snackbar extends BaseTransientBottomBar&lt;Snackbar&gt; {</span></pre><p id="8d8c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在我们在companion对象中创建一个函数，并传递显示<code class="fe mz na nb nc b">SimpleCustomSnackbar</code>所需的字段。</p><p id="4560" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这些参数是:</p><ol class=""><li id="b1b9" class="np nq it ma b mb mu me mv mh nr ml ns mp nt mt nu nv nw nx bi translated"><strong class="ma iu">视图</strong>:当前组件布局中关联Snackbar的视图</li><li id="54bf" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated"><strong class="ma iu">消息:</strong>要在Snackbar中显示的消息</li><li id="0ac3" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated"><strong class="ma iu">持续时间</strong> : Snackbar有三个默认的持续时间，我们可以在这里使用</li><li id="51e7" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated"><strong class="ma iu"> click-listener </strong>:这个参数可以为空，因为我们创建了一个监听器，并且只在需要实现定制功能时才发送函数</li><li id="e3af" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated">图标:你想在消息左边显示的任何图标，如果为空，将不显示任何图标</li><li id="71cc" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated">一个<strong class="ma iu">动作标签</strong>:显示在动作视图消息右侧的标签。</li><li id="252c" class="np nq it ma b mb ny me nz mh oa ml ob mp oc mt nu nv nw nx bi translated"><strong class="ma iu">背景色</strong>:整个Snackbar的背景色</li></ol><p id="7fed" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在来看看<code class="fe mz na nb nc b">SimpleCustomSnackbar</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="edbf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这里我们使用了一个kotlin扩展函数<code class="fe mz na nb nc b">findSuitableParent</code>来查找与Snackbar关联的最佳视图，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="432b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">让我们看看它是如何工作的。</p><p id="ffaf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">用<code class="fe mz na nb nc b">SimpleCustomSnackbar</code>显示错误信息，代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义错误Snackbar</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/c60029b0fac3a78b852e884007bbf1ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaOF-CCZuY73d6q1qbfztA.png"/></div></div></figure><p id="8ad2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在让我们看看Snackbar将会如何成功。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义成功零食条</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/cc5a723b98e9d910c98be80642a0d9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwLegY3B3TO0ofqrnFJGzg.png"/></div></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="4b6c" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="8e11" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我们在这里做的定制是非常基本的。使用本文中的策略，我们可以根据应用程序的功能创建更加定制化的Snackbars。例如，我为一个食品配送应用程序创建了一个定制的snackbar，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/ca9c191266dfd6e656c1f098dc2af7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96zy1TcBRptxAuy0x6ZQyw.png"/></div></div></figure><p id="77cd" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">干杯！</p><p id="5aba" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>