# 使用类型提示改进 Python 项目

> 原文：<https://betterprogramming.pub/improving-your-python-projects-with-type-hints-63cbdb16d97c>

## 知道如何使用静态类型检查和类型注释最佳实践

![](img/2ffb2c0c1433b18e18983b4daf227c00.png)

照片由 [Artturi Jalli](https://unsplash.com/@artturijalli?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

类型检查是任何现代编程语言最重要的特性之一；这就是 TypeScript 诞生的原因。一般来说，类型检查不仅使代码库更容易扩展和使用，而且它还能快速、可靠和自动地检测许多编程错误。

在 Python 3.5 中首次引入的**类型提示**是 Python 开发人员向变量和函数标注类型的主要方式。

> **类型提示—** 顾名思义，不在解释器级别执行任何类型检查。它们是为开发人员、ide、linters、类型检查人员等而设计的。

用技术术语来说， **Python 有动态类型检查**，因此类型在运行时是已知的，而在编译时是未知的(像 C#这样的静态类型检查语言就是这种情况)。尽管如此，值得一提的是，Python 社区已经黑出了一个 Python 解释器的[变种](http://mypy-lang.org/)，它执行静态类型检查。

在本文中，我们将探讨如何将 Python 的类型检查整合到我们的代码库中，以减少与项目单元集成时的摩擦。

# 类型提示语法

Python 支持语言所支持的基本变量类型`str`、`int`、`float`、`bool`、**、`None`的类型注释。它还附带一个`typing`图书馆电池；这个类型库为我们提供了使用更多特殊类型的方法。**

## 注释变量

要在 Python 中指明变量的类型，只需添加一个冒号加空格，后跟类型(str，int，List[]，等等。)，就在变量名后面。

## 注释函数

变量的变量注释语法也适用于函数参数。然而，为了指示返回类型，我们添加了一个箭头“-> ”,后跟它的类型。

# 使用特殊类型

现在，我们已经熟悉了类型注释语法，让我们来熟悉更复杂的类型。

## 任何的

类型为`Any`的变量不受约束。所以，这样的变量兼容所有其他类型(int，str，`List`等)，所有其他类型都兼容这些。

## 逐字的

文字用于向类型检查器指示变量或函数的值等于指定的值之一。

在上面的例子中，性别将是性别文字声明中的值之一——“男性”、“女性”或“不一致”。

## 联盟

有时，一个变量可能有跨越两个类型声明的属性。变量也可能有两种类型。

## TypedDict

字典是 Python 中最简单的数据结构形式之一，是该语言中最常用的变量类型之一。

使用`TypedDict`可以极大地提高代码的可读性，尤其是在一个大项目中，在很多地方有很多声明；记录下*发生了什么*发生了什么*当你缩放时*变得紧张。

## 无回报

`NoReturn`类型类似于其他编程语言中的`void`。它用于声明一个函数没有任何返回。

## 最后的

这是一个类型构造，用于指示变量不能在子类中被重新赋值或覆盖。

# 在 Python 中使用静态类型检查

Python 的解释器我默认不强制类型检查。然而，Python 解释器的一个变体——`mypy`已经被创建来在解释器级别上执行类型检查。

你可以用两种方式使用`mypy`:

1.  下载`mypy`命令行并使用它来运行您的 Python 脚本。
2.  安装 VSCode 和 PyCharm 上可用的`mypy`扩展。

# 类型注释最佳实践

## 1.使用`Any`

只有当我们不知道返回变量或函数参数的确切类型时，才应该使用`Any`类型；当使用没有类型注释的第三方库，或者使用没有类型注释的模块时，可能会出现这种情况。

## 2.启用静态类型检查

如果类型检查是动态的，那么它在防止错误和指导开发人员方面的好处就不会那么明显。如果你不是`mypy`命令行的粉丝，你也可以把它安装成 VSCode 或者 PyCharm 扩展。

## 3.对固定长度数组使用元组

元组作为记录有双重用途。因此，当数组中有已知数量的项时，尤其是当它们不都是同一类型时，该变量更适合元组类型。

## 4.函数返回类型

函数应该做一件事并且只做一件事，因此它们应该有一个确定的类型。

```
**Want to Connect?**Get weekly articles and coding tricks by [subscribing to my newsletter](https://tomisin.dev/subscribe).
```