<html>
<head>
<title>My Experience After Using Kotlin Multiplatform in Production Apps for a Year</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我在生产应用中使用Kotlin多平台一年后的体验</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/experience-using-kmp-in-production-apps-for-a-year-2474406d99d4?source=collection_archive---------2-----------------------#2022-07-11">https://betterprogramming.pub/experience-using-kmp-in-production-apps-for-a-year-2474406d99d4?source=collection_archive---------2-----------------------#2022-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="52b8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用kickstarter项目好东西帮你开始</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b4420dd5d3e7555a87dfd7c549a883aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HccUGUuqxDx6mCKS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@gift_habeshaw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Gift Habeshaw </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="c7a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在生产应用、Android和iOS中使用Kotlin多平台(KMP)大约一年后，以下是我们的一些统计数据:</p><ul class=""><li id="abad" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">250多万MAU</li><li id="a855" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">非常稳定。无崩溃会话:&gt; 99.75 %</li><li id="76b5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">超过70%的代码重用。</li><li id="7310" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">24个移动设备(14个Android + 10个iOS)</li><li id="dbdb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">Kotlin当前版本:1.6.21</li></ul><p id="c94b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里看一下我们用来保持高开发速度的过程！</p><h1 id="b7ba" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">将KMP存储库与您的应用程序存储库分开。</h1><ul class=""><li id="fd55" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">更好地将通用模块与特定平台应用程序存储库(android、ios、web、后端应用程序等)分离开来。</li><li id="2126" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这将使通用的KMP工具、插件、库等远离现有的/新的应用程序。</li><li id="5bd7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这使得现有/新的应用程序可以轻松地将通用代码作为第三方库进行即插即用，而不是在特定于平台的应用程序库中设置通用KMP工具、插件、库、集成等。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/a4fecda8f245851ceebde3664b099d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*mpSYx5Bk5Y3Hv5ad38LUHQ.png"/></div></figure><h1 id="1794" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">将通用KMP代码作为库发布。</h1><ul class=""><li id="d892" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">你可以通过maven共享普通的KMP代码作为android和ios应用的库。</li><li id="1144" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">Publishing将把通用的KMP代码输出到所有目标(android、ios、js等)中，maven将托管工件。</li><li id="466a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">主机应用程序将从maven加载它们自己的平台工件，就像我们在Gradle中通过maven加载第三方库一样。</li><li id="de81" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">对于本地开发，maven有一个本地存储库，它托管在同一台机器上，只需一个Gradle命令就可以在同一台机器上的项目之间轻松共享工件:<code class="fe ne nf ng nh b">publishToMavenLocal</code></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/cc35037d0807f3fd3a3ae8099ab2af81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*5qrTtpc5gREWsS-p6EuGhg.png"/></div></figure><p id="b366" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">提示</strong>:</p><ul class=""><li id="7a4a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">您可以使用GitLab让它变得非常简单，因为它有一个现成的maven存储库。因此git存储库和maven包可以从一个GitLab存储库中访问。</li><li id="351a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">通过在“KMP资源库”中添加远程maven配置，您可以直接使用gradle <code class="fe ne nf ng nh b">publish</code>任务在maven上构建和推送工件。</li><li id="ffb9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在应用程序存储库方面，需要相同的maven配置来从maven中提取库。</li><li id="be21" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">示例:Maven配置将在此处添加<a class="ae kv" href="https://github.com/har5hit/PokeDex-KMP/blob/master/plugins/publish.gradle" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><h1 id="4266" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">研究Kotlin本地(K/N)规则并创建PoC。</h1><ul class=""><li id="de87" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">KMP最糟糕的地方是，任何人都可以像在android中编写Kotlin一样编写通用的KMP代码，它将在Android中完美运行。</li><li id="a7c2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这是最糟糕的，因为它会在iOS中崩溃，由于Kotlin的本地规则，如多线程中对象的冻结等，所以应该进行PoC，以了解什么是可能的，什么是不可以的，以便在通用代码中制定开发指南和规则。例如:<code class="fe ne nf ng nh b">InvalidMutabilityException</code></li><li id="c4ef" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">从<a class="ae kv" href="https://kotlinlang.org/docs/multiplatform-mobile-concurrency-overview.html" rel="noopener ugc nofollow" target="_blank">这里</a>了解规则。创建一个指南列表，以便其他开发人员在开发任何新的/现有的KMP功能时可以遵循它们。</li></ul><h1 id="c76d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">很少使用expect-actual。依赖于接口。</h1><ul class=""><li id="2cc6" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated"><strong class="ky ir"> Expect-actual </strong>给出了一种创建特定于平台的访问的非常简单的方法，但是它有一些限制，比如相同的构造函数签名。</li><li id="462b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在支持新的平台依赖性方面存在可扩展性问题。例如:一个新的平台可能需要一些不同的构造函数依赖关系。</li><li id="b212" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">另外，您只需要从Kotlin文件中生成<code class="fe ne nf ng nh b">actual class</code>。</li></ul><pre class="kg kh ki kj gt nj nh nk nl aw nm bi"><span id="61ea" class="nn mh iq nh b gy no np l nq nr"><em class="ns">// commonMain<br/></em><strong class="nh ir">expect class </strong>NetworkGateway(debug: Boolean) {<br/>    <strong class="nh ir">val </strong>client: HttpClient<br/>}</span><span id="5928" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// androidMain<br/></em><strong class="nh ir">actual class </strong>NetworkGateway <strong class="nh ir">actual constructor</strong>(debug: Boolean) {<br/>    <strong class="nh ir">actual val client</strong>: HttpClient = <em class="ns">TODO</em>(<strong class="nh ir">"Not yet implemented"</strong>)<br/>}</span><span id="c193" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// iosMain<br/></em><strong class="nh ir">actual class </strong>NetworkGateway <strong class="nh ir">actual constructor</strong>(debug: Boolean) {<br/>    <strong class="nh ir">actual val client</strong>: HttpClient = <em class="ns">TODO</em>(<strong class="nh ir">"Not yet implemented"</strong>)<br/>}</span></pre><ul class=""><li id="805a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">相反，使用抽象将使您能够用任何特定于平台的构造函数自由地创建实现。</li><li id="6297" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">您可以用任何特定于平台的语言实现<code class="fe ne nf ng nh b">interface</code>,比如iOS版Swift。因此，您也可以从平台端发送依赖关系。</li><li id="a0cc" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">因此，您可以更自由地传递实现接口的现有平台依赖性，并通过DI传递到通用KMP代码。</li></ul><pre class="kg kh ki kj gt nj nh nk nl aw nm bi"><span id="bf6c" class="nn mh iq nh b gy no np l nq nr"><em class="ns">// commonMain<br/></em><strong class="nh ir">interface </strong>INetworkGateway{<br/>    <strong class="nh ir">val client</strong>: HttpClient<br/>}</span><span id="3ce3" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// androidMain or from Android App Repository.<br/></em><strong class="nh ir">class </strong>AndroidNetworkGateway(<br/>    debug: Boolean,<br/>    interceptors: List&lt;Interceptor&gt;,<br/>    networkInterceptor: List&lt;Interceptor&gt;<br/>) : INetworkGateway {<br/>    <strong class="nh ir">override val client</strong>: HttpClient = <em class="ns">TODO</em>(<strong class="nh ir">"Not yet implemented"</strong>)<br/>}<br/><br/><em class="ns">// iosMain<br/></em><strong class="nh ir">class </strong>IOSNetworkGateway(<br/>    debug: Boolean<br/>) : INetworkGateway {<br/>    <strong class="nh ir">override val client</strong>: HttpClient = <em class="ns">TODO</em>(<strong class="nh ir">"Not yet implemented"</strong>)<strong class="nh ir"><br/></strong>}</span></pre><h1 id="e44d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">编写大量的单元测试</h1><ul class=""><li id="804b" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">即使遵守了K/N规则，也总有遗漏某些规则或某些条件的空间，所以要有容纳它们的计划。</li><li id="5045" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">假设一个常见的功能已经在android上推出，并且在将其集成到iOS中时，出现了一个问题，需要修复代码。</li><li id="427d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">现在，该修复将在下一个KMP图书馆版本中影响android和iOS。因此，为了将影响最小化，如果在我们对K/N做了任何更改之后单元测试已经存在，我们可以确保在更新代码以遵守iOS规则时不会破坏任何现有的流程。</li><li id="8397" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">为iOS编写集成测试会好得多，因为它会为K/N规则崩溃创建一个回归套件。</li></ul><h1 id="f750" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">使用您单独的KMP存储库中的android和ios模块作为测试主机。</h1><ul class=""><li id="a266" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">在本地发布一个公共代码，并将其包含在实际的应用程序存储库中进行集成测试和重建，会降低您的速度。</li><li id="5ff2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">因此，如果您需要测试它E2E，那么您可以连接测试主机模块中的共享代码，这些模块已经在新的KMP项目中制作，并在本地/远程发布之前使用它们来测试任何集成。</li><li id="f843" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这将更快地工作，甚至调试问题。</li></ul><h1 id="30ab" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">在不同文件中保存通用的KMP和特定于平台的依赖关系。</h1><ul class=""><li id="3139" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">您可以创建一个通用依赖文件和不同的平台依赖文件。</li><li id="a126" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">例如:<code class="fe ne nf ng nh b"><a class="ae kv" href="https://github.com/har5hit/PokeDex-KMP/blob/master/buildSrc/src/main/kotlin/Dependencies.kt" rel="noopener ugc nofollow" target="_blank">CommonDependencies</a></code>、<code class="fe ne nf ng nh b"><a class="ae kv" href="https://github.com/har5hit/PokeDex-KMP/blob/master/buildSrc/src/main/kotlin/AndroidDependencies.kt" rel="noopener ugc nofollow" target="_blank">AndroidDependencies</a></code>等。</li><li id="31d0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这使您可以在KMP存储库和平台应用存储库上保持通用平台第三方库同步。</li></ul><h1 id="fb9f" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">改进iOS的崩溃日志记录</h1><ul class=""><li id="71b5" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">默认情况下，在Crashlytics上报告的iOS应用程序中常见KMP代码的崩溃不会有任何重要的崩溃原因/痕迹，这将使其对调试原因无用。</li></ul><p id="86e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如<code class="fe ne nf ng nh b">InvalidMutabilityException</code> <strong class="ky ir"> </strong>在<code class="fe ne nf ng nh b">var loading1: Boolean</code>的崩溃日志</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/fbaabec3e82362bb6a5dffc60ffc7f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X9t2ZGaWlLqjXepsXyO15A.png"/></div></div></figure><ul class=""><li id="e98b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">上面没有任何关于崩溃的有用信息。</li><li id="b6ee" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们可以在iOS端使用<a class="ae kv" href="https://github.com/touchlab/Kermit" rel="noopener ugc nofollow" target="_blank"> Kermit </a>来解决这个问题。它将从Kotlin端捕获大量关于崩溃的重要信息，这些信息可用于调试。</li></ul><p id="cc79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用Kermit后，与上面的崩溃示例相同，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/693ab1592dee0f108505abc2d0346e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uzFYSweGLlRT1nD33DpEkA.png"/></div></div></figure><p id="ab74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个例外在标题中清晰可见，并且<code class="fe ne nf ng nh b">index 7</code>明确了崩溃发生的位置，即<code class="fe ne nf ng nh b">line 94</code>。总体信息对于理解和修复崩溃是有用的。(注意:日志上说<strong class="ky ir">非致命</strong>是不正确的。)</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="06b1" class="mg mh iq bd mi mj oc ml mm mn od mp mq jw oe jx ms jz of ka mu kc og kd mw mx bi translated">我们用来避免K/N崩溃的一些准则:</h1><ul class=""><li id="c4e8" class="ls lt iq ky b kz my lc mz lf na lj nb ln nc lr lx ly lz ma bi translated">不要在公共代码中对较大的作用域使用<code class="fe ne nf ng nh b"><em class="ns">var</em></code>。用<code class="fe ne nf ng nh b">MutableStateFlow</code>代替。例如，对于类范围的变量。所以不言而喻，多用<code class="fe ne nf ng nh b"><em class="ns">val</em></code>。避免:<code class="fe ne nf ng nh b">InvalidMutabilityException</code> <strong class="ky ir"> </strong>(因为变量可能会被一个类中的不同线程变异)</li></ul><pre class="kg kh ki kj gt nj nh nk nl aw nm bi"><span id="94a6" class="nn mh iq nh b gy no np l nq nr"><em class="ns">// Don't<br/></em><strong class="nh ir">class </strong>PersonViewModel{<br/>    <strong class="nh ir">private var </strong>loading:Boolean = <strong class="nh ir">false</strong><em class="ns"><br/></em>}</span><span id="9dd3" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// Do<br/></em><strong class="nh ir">class </strong>PersonViewModel{<br/><em class="ns">    </em><strong class="nh ir">private val </strong>loading = <em class="ns">MutableStateFlow</em>(<strong class="nh ir">false</strong>)<em class="ns"><br/></em>}</span></pre><ul class=""><li id="e033" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">即使在使用<code class="fe ne nf ng nh b"><em class="ns">val</em></code> <em class="ns">的情况下，</em>也要确保它是最终的。</li></ul><pre class="kg kh ki kj gt nj nh nk nl aw nm bi"><span id="2303" class="nn mh iq nh b gy no np l nq nr"><em class="ns">// Don't</em><strong class="nh ir"><br/>abstract class </strong>BaseView() {<br/>    <strong class="nh ir">abstract val screenName</strong>: String     <br/>    <strong class="nh ir">val title </strong>= <strong class="nh ir">"$screenName Screen"    </strong><em class="ns">//</em><strong class="nh ir"><em class="ns">screenName</em></strong><em class="ns"> is not final<br/></em>}</span><span id="73a5" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// Do</em><br/><strong class="nh ir">abstract class </strong>BaseView(<strong class="nh ir">val screenName</strong>: String) {<br/>    <strong class="nh ir">val title </strong>= <strong class="nh ir">"$screenName Screen"    </strong><em class="ns">//</em><strong class="nh ir"><em class="ns">screenName</em></strong><em class="ns"> is final<br/></em>}</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/5be716af335e9a8cb224a5555f3ee6bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DL98veBEsuFdjl1e5iWNvw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">甚至IDE都会给出警告。</p></figure><ul class=""><li id="e2cc" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">声明所有类变量后使用<code class="fe ne nf ng nh b">init {}</code>块。这是为了避免任何人在<code class="fe ne nf ng nh b">init</code>中创建协程，这将使整个类实例冻结，并导致在它之后声明的加载字段上抛出异常。</li></ul><pre class="kg kh ki kj gt nj nh nk nl aw nm bi"><span id="26de" class="nn mh iq nh b gy no np l nq nr"><em class="ns">// Don't</em><strong class="nh ir"><br/>class </strong>PersonViewModel{<br/>    <br/>    <strong class="nh ir">init </strong>{<br/><br/>    }<em class="ns"><br/><br/>    </em><strong class="nh ir">private val loading </strong>= <em class="ns">MutableStateFlow</em>(<strong class="nh ir">false</strong>)<br/>    <br/>}</span><span id="840d" class="nn mh iq nh b gy nt np l nq nr"><em class="ns">// Do</em><br/><strong class="nh ir">class </strong>PersonViewModel{<br/>    <br/>    <strong class="nh ir">private val loading </strong>= <em class="ns">MutableStateFlow</em>(<strong class="nh ir">false</strong>)<br/>    <br/>    <strong class="nh ir">init </strong>{<br/><br/>    }<br/>}</span></pre><ul class=""><li id="fbc2" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">实际<a class="ae kv" href="https://github.com/har5hit/PokeDex-KMP/blob/master/feature_pokemon_list/src/commonMain/kotlin/com/justadeveloper96/pokedex_kmp/feature_pokemon_list/presentation/pokemon_list/viewmodel/PokemonListViewModel.kt" rel="noopener ugc nofollow" target="_blank">视图模型</a>供参考。</li></ul><p id="9db7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在平台应用程序中创建DI文件，让宿主应用程序能够根据需要自由灵活地传递不同的依赖实现。用例可以是:</p><ul class=""><li id="a0d0" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">将平台应用中现有的<code class="fe ne nf ng nh b">UserRepository</code>传递给通用KMP代码，而不是在通用代码中从头开始创建。</li><li id="3453" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在KMP存储库和平台存储库中，一个依赖项可以有多种实现。因此，可以根据需要在平台级别进行切换或A/B。</li></ul></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="95fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下存储库用于博客参考。此外，如果您需要KMP项目模板作为参考、快速入门或试用，您也可以查看:</p><div class="oi oj gp gr ok ol"><a href="https://github.com/har5hit/PokeDex-KMP" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">GitHub - har5hit/PokeDex-KMP:使用Kotlin多平台的PokeDex</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">这是一个演示程序，使用Kotlin Multiplatform (KMP)演示了Android和iOS应用程序中的代码重用。一些…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz kp ol"/></div></div></a></div><p id="4d03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢大家！</p></div></div>    
</body>
</html>