<html>
<head>
<title>Want to Create REST APIs Without Any Server? Go Serverless</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">想要在没有任何服务器的情况下创建REST APIs？无服务器运行</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-rest-apis-without-any-server-a4059f8ab443?source=collection_archive---------3-----------------------#2022-01-06">https://betterprogramming.pub/create-rest-apis-without-any-server-a4059f8ab443?source=collection_archive---------3-----------------------#2022-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c585" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用DynamoDB、AWS Lambda、API gateway和无服务器框架构建一个API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8e70b9c4662768493dde47c96225ac7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YxZqPLZqAUi3_YvK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@opeleye?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔丹·欧宝</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以你有了创建一个API的想法，但是考虑如何管理服务器、数据库和安全性？那么这是给你的一篇文章。</p><p id="a28e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将讨论如何创建自己的API，而不必担心任何服务器。</p><p id="0b89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案是无服务器。</p><p id="5f10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器是一种基于云的开发模式，你不需要拥有任何服务器，而是使用可以独立使用的服务。在本教程中，我们将使用AWS服务来创建我们自己的REST API。</p><blockquote class="lv lw lx"><p id="58da" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">我们不会在这篇文章中写任何代码，因为这是一篇让你熟悉如何在没有任何服务器的情况下设计API的文章。</p></blockquote><p id="4c82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来的事情，在构建API的时候会需要我们。</p><ul class=""><li id="1db0" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated"><strong class="lb iu">数据库:</strong>你的API将从你的数据库返回数据给API消费者。</li><li id="0e2f" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">一个API端点:</strong>消费者将使用这个端点来调用您的API并获得响应。</li></ul><p id="2c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，我们现在来谈谈酷的东西。</p><h1 id="ea93" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">数据库ˌ资料库</h1><p id="1ee6" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们将使用DynamoDb来存储我们的数据。DynamoDb是一个非常强大的NoSQL数据库，无论数据库有多大，它都能在几毫秒内提供数据。</p><p id="2f1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到您的AWS控制台，搜索DynamoDb并创建一个新表，但是等等，在创建一个新表时有一些事情需要知道。在dynamoDb中，我们需要为表指定一些键。在Dynamo DB中，一个表主要有两个键。</p><ul class=""><li id="7bd0" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated"><strong class="lb iu">分区键:</strong>这是您的散列键，在表中是唯一的。该键将用于获取该键的任何数据。</li><li id="1072" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated"><strong class="lb iu">排序键:</strong>这是一个键，它将帮助您通过在表上运行查询来获取数据。</li></ul><p id="1179" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个新的dynamoDb表</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/7d9111a23f2e9eb61b68fc9b62f4508f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83P02hBxJ3587G5eijH5nA.png"/></div></div></figure><p id="059e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建一个包含2个字段的简单表格。猫名和猫像网址。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/0c2a99d7d4491227568882d9cd1bc795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2N8EDr1FfC34a90p4X3oA.png"/></div></div></figure><p id="2be2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以保留其余的默认设置，然后单击“创建表格”</p><p id="cd1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了一个数据库表。让我们给这张桌子增加一些项目。现在，我将手动添加一些项目，我们将在AWS lambda中查询这些项目。</p><p id="8c46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看，当有人调用我们的API时，我们将在哪里运行我们的代码。</p><h1 id="9c9c" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">自动气象站λ</h1><p id="ac50" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们将使用AWS Lambda为API编写代码。Lambda是AWS的一个强大工具，它在一个文件中有一个函数，你可以在这个函数中编写你的代码。</p><p id="f3f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用AWS lambda的好处是它非常便宜。AWS给你的lambda提供了大约100万个免费的API调用，它会被快速执行，因为<em class="ly">在运行你的lambda代码时，AWS会给它分配资源并执行代码。</em>如果您使用Python编写代码，您可以使用<code class="fe np nq nr ns b">boto3</code>库直接连接dynamoDb并在其上执行CRUD操作。</p><p id="c7ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到AWS控制台中的AWS Lambda服务，然后单击“创建函数”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/3dfb11e46c0cecf6b950120d9532c461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeEFZssPu4GORsgAYmtNCw.png"/></div></div></figure><p id="2bbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用默认设置并点击<code class="fe np nq nr ns b">Create</code>功能。现在将以下代码添加到lambda函数中:</p><pre class="kj kk kl km gt nu ns nv nw aw nx bi"><span id="e3fe" class="ny mr it ns b gy nz oa l ob oc">import json<br/>import boto3<br/>from boto3.dynamodb.conditions import Key</span><span id="3a8a" class="ny mr it ns b gy od oa l ob oc">def lambda_handler(event, context):<br/>    dynamodb = boto3.resource('dynamodb')<br/>    <br/>    table = dynamodb.Table('cats')     <br/>    <br/>    resp = table.query(<br/>        KeyConditionExpression=Key('cat_name').eq("HelloCat1")<br/>    )<br/>    return {<br/>        'statusCode': 200,<br/>        'body': json.dumps(resp)<br/>    }</span></pre><p id="ec05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将连接到dynamo DB并获取名为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/dcfa659634d6fe9c7c2d509f1e4564f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT8DCtXwXnocBF4alDGMUQ.png"/></div></div></figure><p id="dfc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单击deploy，然后单击Test，您应该能够看到lambda函数的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/6d32a7052a2d0024e7542b1dcf4aaacf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1j-ZhB_HFohVrt2qsCXXw.png"/></div></div></figure><p id="0217" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，我们在lambda函数中获得了dynamoDb表的结果。</p><p id="f141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经准备好了数据库和代码，但是我们如何向外界公开我们编写的lambda函数呢？</p><h1 id="241d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">API网关</h1><p id="0dd5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">AWS提供了一个名为API Gateway的服务，向外界公开资源。</p><p id="c432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在AWS控制台中搜索API Gateway，你会看到一个创建新资源的选项(这就是我们所说的API端点)。创建资源后，您可以配置来执行lambda函数。</p><p id="1c06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API gateway将获得API请求体，将调用lambda函数，并将获得响应并发送回客户端。您还可以配置其他一些东西，比如如何在API网关中处理请求头或响应代码。</p><p id="ae30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建API资源后，AWS会给你一个URL作为API端点。</p><p id="1f85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建API。转到API网关AWS服务:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/fca8c5d3abf7b34cd664ec28e34759af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9jPsGiCrAjOQlz0dzeKJWA.png"/></div></div></figure><p id="c8bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择REST API:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/01ff0f721d0ae441826a571913c09604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdl6LoQ4uKNgPvNxTGYMBw.png"/></div></div></figure><p id="5f3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">提供详细信息，然后单击创建API:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/0627829551b2fa91cd1f7fdbb17e36cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxspjDhxl0UF-ykCMCe3oA.png"/></div></div></figure><p id="c435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择Lambda函数，然后单击保存。这将创建一个触发Lambda函数的端点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3ac1faa81527145396ec1f1472e4ca16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSBkE0punbmVpChN7VMAbA.png"/></div></div></figure><p id="df53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">允许调用lambda函数的权限:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/0f1bb3b4ae3cef42d2178b43bf109c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kIO_T6kn90kb-rvTUpoH9g.png"/></div></div></figure><p id="27d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建API后，单击Actions选项并选择Deploy API，这将部署您的API:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/62dfdd02b48233bd36fb9f448a5fab9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Di5Cpynq9lI3T0T124zf7w.png"/></div></div></figure><p id="13f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">部署API之后，您应该能够看到调用URL，这个URL将是您的API端点。是时候测试我们的API了，去邮递员那里吧</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/986f320ab6e16496ae7c97127c128f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iprScV0nQ7S7d8pRCcW9-A.png"/></div></div></figure><p id="2d27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">沃拉。！您已经准备好了REST API。</p><blockquote class="lv lw lx"><p id="ac4b" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">关注我的<a class="ae ky" href="https://www.instagram.com/manoj_ahi/" rel="noopener ugc nofollow" target="_blank"> Meta </a></p></blockquote></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="1bc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有用。感谢阅读。如果你喜欢这篇文章，请考虑关注我:)</p></div></div>    
</body>
</html>