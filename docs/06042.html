<html>
<head>
<title>How to Create an Interactive Bottom Sheet in Swift 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Swift 5中创建交互式底部表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-an-interactive-bottom-sheet-in-swift-5-adadaad79e72?source=collection_archive---------1-----------------------#2020-08-28">https://betterprogramming.pub/how-to-create-an-interactive-bottom-sheet-in-swift-5-adadaad79e72?source=collection_archive---------1-----------------------#2020-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1a9d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用容器和子视图控制器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c80e4f16049cfe11b355d83178e9b7dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3ml31QopeLcGBxYF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿米尔马赫迪·卡泽姆内贾德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cdf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习如何创建一个可重用的UI元素——底层表单。</p><p id="e493" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程结束时，您将有一个完成的组件，您可以轻松地复制并粘贴到您的应用程序中，并根据您的需要使用。</p><p id="8ba7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们将要建造的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/75b61e7baa66f8d91b705937d40b0a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/1*xCzayGN9-OdCItlz7ruNdQ.gif"/></div></figure><p id="04eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，完成本教程后，您将掌握以下内容:</p><ul class=""><li id="bf09" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">容器和子视图控制器——离遵循可伸缩的MVC架构方法更近了一步</li><li id="b3ee" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe mk ml mm mn b">UIPanGestureRecognizer</code> —使用方便的手势并利用其<code class="fe mk ml mm mn b">velocity</code>和<code class="fe mk ml mm mn b">translation</code>属性</li><li id="f700" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">约束动画-平滑移动任何UI元素</li></ul><p id="9ef5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将在文章末尾找到该项目的完整源代码。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="ed94" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">我们开始吧</h1><p id="3e60" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">首先，我们需要创建一个通用的<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>，它将包含一个内容视图控制器和一个底部表单视图控制器作为子控件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="87a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所见，<code class="fe mk ml mm mn b">Content</code>和<code class="fe mk ml mm mn b">BottomSheet</code>类型都必须是<code class="fe mk ml mm mn b">UIViewController</code> s，这意味着我们将能够指定任何自定义<code class="fe mk ml mm mn b">UIViewController</code>为<code class="fe mk ml mm mn b">Content</code>或<code class="fe mk ml mm mn b">BottomSheet</code>。当我们在一个例子中开始使用<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>时，您将会看到这一点。</p><p id="8772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经将<code class="fe mk ml mm mn b">Content</code>和<code class="fe mk ml mm mn b">BottomSheet</code>视图控制器作为子视图，让我们添加一些必需的属性。在这一步中，我们将创建两个:</p><ul class=""><li id="68bc" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">一个<code class="fe mk ml mm mn b">BottomSheetConfiguration</code>结构，它将表示底部工作表的总高度和初始偏移量</li><li id="d5e6" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">一个<code class="fe mk ml mm mn b">BottomSheetState</code>枚举，用于管理底部工作表的状态。它有<code class="fe mk ml mm mn b">.initial</code>和<code class="fe mk ml mm mn b">.full</code>两种情况:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="8c87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们更新了初始化器，将<code class="fe mk ml mm mn b">BottomSheetConfiguration</code>作为参数包含进来。</p><p id="e0d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们转到处理交互和动画的属性。添加<code class="fe mk ml mm mn b">panGesture</code>和<code class="fe mk ml mm mn b">topConstraint</code>属性如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="f753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">底部的工作表视图控制器将在屏幕上移动，所以我们需要得到它的视图的顶部约束。由于这个原因，我们有了<code class="fe mk ml mm mn b">topConstraint</code>属性，我们将重复地改变它并相应地制作动画。</p><p id="2542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们将<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>与<code class="fe mk ml mm mn b">UIGestureRecognizerDelegate</code>保持一致。这允许我们添加方法<code class="fe mk ml mm mn b">gestureRecognizer(_:shouldRecognizeSimultaneouslyWith:)</code>，在其中我们返回<code class="fe mk ml mm mn b">true</code>。</p><p id="e2da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这在您有一个<code class="fe mk ml mm mn b">UITableView</code>或任何其他滚动视图放在底部表单内的情况下很有用。如果我们没有添加这个方法，我们的<code class="fe mk ml mm mn b">UIPanGestureRecognizer</code>会在<code class="fe mk ml mm mn b">UIScrollView</code>子类上执行手势时停止工作。</p><p id="1a96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们将子视图控制器添加到容器中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="c050" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是所有步骤的明细:</p><ol class=""><li id="f8a4" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu nu mc md me bi translated">使用<code class="fe mk ml mm mn b">addChild()</code>方法将<code class="fe mk ml mm mn b">contentViewController</code>和<code class="fe mk ml mm mn b">bottomSheetViewController</code>添加到容器中。</li><li id="7afc" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">将<code class="fe mk ml mm mn b">contentViewController</code>和<code class="fe mk ml mm mn b">bottomSheetViewController</code>的根视图添加到容器的根视图。</li><li id="f096" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">将<code class="fe mk ml mm mn b">panGesture</code>添加到<code class="fe mk ml mm mn b">bottomSheetViewController</code>的根视图中。</li><li id="5364" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">应用<code class="fe mk ml mm mn b">translatesAutoresizingMaskIntoConstraint = false</code>。这是必需的，因为我们使用约束以编程方式创建UI。</li><li id="5a7a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">为<code class="fe mk ml mm mn b">contentViewController</code>的视图设置约束。</li><li id="585c" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">调用<code class="fe mk ml mm mn b">didMove(to:)</code>方法通知<code class="fe mk ml mm mn b">contentViewController</code>它已经被添加到父对象中。父级是<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>。</li><li id="c5ce" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">将底部板材的顶部约束设置为与容器视图的<code class="fe mk ml mm mn b">bottomAnchor</code>对齐。我们还添加了一个<code class="fe mk ml mm mn b">BottomSheetConfiguration</code>的偏移量，让底部的工作表在屏幕底部看得见一点。</li><li id="d456" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">设置所有底部图纸的约束并激活它们。</li><li id="13a8" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">调用<code class="fe mk ml mm mn b">bottomSheetViewController</code>上的<code class="fe mk ml mm mn b">didMove(to:)</code>方法，通知它已被添加到<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>中。</li></ol><p id="1301" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们完成了容器及其子容器的设置。现在让我们使用<code class="fe mk ml mm mn b">panGesture</code>来处理交互性。</p><p id="85cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将<code class="fe mk ml mm mn b">panGesture</code>与其动作联系起来:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="503e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将添加两个方法:</p><ul class=""><li id="f09a" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe mk ml mm mn b">showBottomSheet(animated:)</code> —将底部料板移动到其最大高度，并将<code class="fe mk ml mm mn b">BottomSheetState</code>设置为<code class="fe mk ml mm mn b">.full</code>。如果<code class="fe mk ml mm mn b">animated</code>设置为<code class="fe mk ml mm mn b">true</code>，则动画执行动作。</li><li id="6be9" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe mk ml mm mn b">hideBottomSheet(animated:)</code> —同样，该方法将底部板材移动到其初始点，并将<code class="fe mk ml mm mn b">BottomSheetState</code>设置为<code class="fe mk ml mm mn b">.initial</code>。如果设置动画，它会执行一个很好的弹簧动画。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="7c9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码显示了如何动画约束。这些是步骤:</p><ul class=""><li id="8977" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">改变约束的<code class="fe mk ml mm mn b">constant</code>。</li><li id="8f90" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">在动画块中运行<code class="fe mk ml mm mn b">self.view.layoutIfNeeded()</code>。请注意，您必须调用您想要制作动画的视图的<em class="nv">超级视图</em>上的<code class="fe mk ml mm mn b">layoutIfNeeded()</code>。在我们的例子中，这个超级视图是<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>的根视图。</li></ul><p id="2fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在，我们可以通过编程来移动和隐藏底部的工作表。是时候直接用<code class="fe mk ml mm mn b">UIPanGestureRecognizer</code>的动作工作了。</p><p id="6ca8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们想要实现的行为:</p><ul class=""><li id="f3ad" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">用手指上下移动底板。</li><li id="b07f" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">当我们停止移动它时，考虑当前<code class="fe mk ml mm mn b">BottomSheetState</code>、<code class="fe mk ml mm mn b">translation</code>和<code class="fe mk ml mm mn b">velocity</code>在<code class="fe mk ml mm mn b">y</code>方向上的移动。如果<code class="fe mk ml mm mn b">state</code>是<code class="fe mk ml mm mn b">.full</code>，检查底部料板是否平移了其高度的至少一半。如果这是<code class="fe mk ml mm mn b">true</code>，我们运行<code class="fe mk ml mm mn b">hideBottomSheet(animated:)</code>方法。否则，我们把它恢复到最大高度。此外，我们需要检查<code class="fe mk ml mm mn b">velocity</code>的大小是否大于1000。如果这给我们<code class="fe mk ml mm mn b">true</code>，隐藏底部表。在其他情况下，将其恢复到最大高度。同样，如果<code class="fe mk ml mm mn b">state</code>是<code class="fe mk ml mm mn b">.initial</code>，检查<code class="fe mk ml mm mn b">translation</code>和<code class="fe mk ml mm mn b">velocity</code>的大小并做出相应反应。</li></ul><p id="c8c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我保证，一切都会变得更有意义。让我们从获得<code class="fe mk ml mm mn b">y</code>方向的<code class="fe mk ml mm mn b">translation</code>大小和<code class="fe mk ml mm mn b">velocity</code>开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d01a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们为手势的当前状态创建一个<code class="fe mk ml mm mn b">switch</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="0d3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，我们处理<code class="fe mk ml mm mn b">UIGestureRecognizer</code>的<code class="fe mk ml mm mn b">.began</code>、<code class="fe mk ml mm mn b">.changed</code>、<code class="fe mk ml mm mn b">.ended</code>和<code class="fe mk ml mm mn b">.failed</code>状态。在它们中的每一个(我们将<code class="fe mk ml mm mn b">.began </code>和<code class="fe mk ml mm mn b">.changed</code>分组)中，我们提供了一个基于当前<code class="fe mk ml mm mn b">BottomSheetState</code>的<code class="fe mk ml mm mn b">if else</code>语句。</p><p id="6171" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们现在处理每一个案例。首先，我们从分组的<code class="fe mk ml mm mn b">.began</code>和<code class="fe mk ml mm mn b">.failed</code>案例开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="6c1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是上述步骤的分解。如果<code class="fe mk ml mm mn b">BottomSheetState</code>是<code class="fe mk ml mm mn b">.full</code>:</p><ol class=""><li id="5b93" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu nu mc md me bi translated">断言用户向下滚动。底部板材已经处于其最大高度；不允许向上滚动。</li><li id="0e26" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">改变<code class="fe mk ml mm mn b">topConstraint</code>的<code class="fe mk ml mm mn b">constant</code>以匹配用户手指的当前位置。例如，如果底部工作表的总高度是500点，用户滚动了100点，我们从500减去100，得到400点。所以我们将常量设置为-400 <em class="nv">，</em>，因为这是从容器视图底部的偏移量。</li><li id="fae3" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">更新根视图以显示约束的更改。</li></ol><p id="11f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当<code class="fe mk ml mm mn b">BottomSheetState</code>为<code class="fe mk ml mm mn b">.initial</code>时:</p><p id="f06e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.使用<code class="fe mk ml mm mn b">BottomSheetConfiguration</code>的<code class="fe mk ml mm mn b">initialOffset</code>和<code class="fe mk ml mm mn b">translation</code>的大小计算新的常数。例如，如果初始偏移量是80点，而用户滚动了200点，则我们获得280点。这意味着我们需要将底板放置在距离容器底部280度的地方。</p><p id="940c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.断言用户向上滚动。因为底部的工作表位于其初始点，所以不允许向下滚动。</p><p id="97b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.断言<code class="fe mk ml mm mn b">newConstant</code>的大小小于底板的全高。这是为了防止底板移动超过其最大高度点。</p><p id="4a16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.设置结果常数。</p><p id="aacf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">8.更新根视图以显示约束的更改。</p><p id="e522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mk ml mm mn b">.began</code>和<code class="fe mk ml mm mn b">.changed</code>状态完成后，现在我们需要处理<code class="fe mk ml mm mn b">.ended</code>情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="c96e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果<code class="fe mk ml mm mn b">BottomSheetState</code>是<code class="fe mk ml mm mn b">.full</code>当用户停止移动底部板材时:</p><ol class=""><li id="0e96" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu nu mc md me bi translated">检查用户是否试图向上移动底部纸张。如果这是真的，底部表应该保持显示。</li><li id="2476" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">如果用户移动底层超过其最大高度的一半，或者<code class="fe mk ml mm mn b">y</code>速度高于1000，那么我们隐藏底层。</li><li id="f920" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu nu mc md me bi translated">在所有其他情况下，保留显示的工作表。</li></ol><p id="4d79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，如果<code class="fe mk ml mm mn b">BottomSheetState</code>是<code class="fe mk ml mm mn b">.initial</code>:</p><p id="f5f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.检查用户是否移动了底板至少其最大高度的一半，或者<code class="fe mk ml mm mn b">y</code>速度小于-1000。</p><p id="beaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.如果这是真的，显示底部的工作表。</p><p id="680d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.否则，隐藏底部工作表。</p><p id="2085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要处理最后一种情况，<code class="fe mk ml mm mn b">.failed</code>，如果<code class="fe mk ml mm mn b">UIPanGestureRecognizer</code>在此过程中失败:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次的逻辑非常简单。如果最新的<code class="fe mk ml mm mn b">BottomSheetState</code>是<code class="fe mk ml mm mn b">.full</code>，将料板返回到其最大高度点。否则，隐藏底部工作表。</p><p id="48cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！我们终于实现了一个可重用的类。我们现在能够随时有效地使用它。让我们快速地在一个简单的例子中使用它。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="8b83" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">用法示例</h1><p id="2469" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">创建名为<code class="fe mk ml mm mn b">WelcomeContainerViewController</code>的<code class="fe mk ml mm mn b">BottomSheetContainerViewController</code>的子类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="71da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们拥有一个显示内容视图控制器和底部表单视图控制器的全功能容器所需要的。</p><p id="483f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，我们有作为内容视图控制器的<code class="fe mk ml mm mn b">HelloViewController</code>和作为底部表单视图控制器的<code class="fe mk ml mm mn b">MyCustomViewController</code>。</p><p id="c449" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mk ml mm mn b">HelloViewController</code>仅显示灰色视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4cd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mk ml mm mn b">MyCustomViewController</code>有一个白色背景、圆角和阴影的视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="b66f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们如何初始化<code class="fe mk ml mm mn b">AppDelegate.swift</code>文件中的<code class="fe mk ml mm mn b">WelcomeContainerViewController</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="1302" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！我们仅用200行代码就成功实现了一个通用的底部表单容器视图控制器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/75b61e7baa66f8d91b705937d40b0a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/1*xCzayGN9-OdCItlz7ruNdQ.gif"/></div></figure><p id="a68a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您已经看到了使用容器和子视图控制器使它们尽可能薄是多么方便。</p><p id="527f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也已经掌握了<code class="fe mk ml mm mn b">UIGestureRecognizer</code>，现在您可以使用这些知识来实现更复杂的UI元素和交互。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="00ea" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">资源</h1><p id="0b65" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">包含实现和示例的项目源代码可以在GitHub上找到:<a class="ae ky" href="https://github.com/zafarivaev/BottomSheet" rel="noopener ugc nofollow" target="_blank"> zafarivaev/BottomSheet </a>。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="d3d1" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">包扎</h1><p id="f955" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">对其他UI相关的文章感兴趣？看看下面这些故事:</p><ul class=""><li id="63bf" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-is-a-uibezierpath-in-swift-3e024af92e3d?source=friends_link&amp;sk=93481485f5e05bd4e630d56a0072e4d6" rel="noopener">Swift中的UIBezierPath是什么？</a></li><li id="b119" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-are-keyframe-animations-in-swift-5-55eaf04f7637?source=friends_link&amp;sk=d8bf73274bcc78ca2847dbd519a9bcf1" rel="noopener">Swift 5中有哪些关键帧动画？</a></li><li id="5cb7" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-are-ibdesignable-and-ibinspectable-in-swift-1e3440797d9?source=friends_link&amp;sk=4968a3a7927984811c1048b0b38f3501" rel="noopener">Swift中的@IBDesignable和@IBInspectable是什么？</a></li></ul><p id="81ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>