<html>
<head>
<title>Adventures in TypeScript Declaration Files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打字稿声明文件中的冒险</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/adventures-in-typescript-declaration-files-46e6b540b2d?source=collection_archive---------13-----------------------#2020-03-05">https://betterprogramming.pub/adventures-in-typescript-declaration-files-46e6b540b2d?source=collection_archive---------13-----------------------#2020-03-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e4e5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">允许其他开发人员使用NPM包的类型而不必编写自己的类型的文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/545c7ed90f29ffd72f44d9b996e1c7c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2UKJhhtFZ9pnNh7J"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@r3dmax?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔纳森派</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="00eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我目前正在使用Express和React进行一个项目，以练习我的打字稿和笑话。我正在使用<a class="ae ky" href="https://screeningapidocs.cityofnewyork.us/overview" rel="noopener ugc nofollow" target="_blank"> NYC Benefits Screening API </a>，在为我的API请求编写类型和接口的过程中，我想，“哇，如果我可以与其他可能想要使用这个API的人共享我的类型，那该多好啊？”</p><p id="9279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过一些研究，我知道我应该写一个类型声明文件，并把它放在NPM的一个包中。在这篇文章中，我将描述我的工作流程，并讨论如何编写一个文件，并将其发布在NPM包中。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="82d1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">类型脚本声明文件</h1><p id="6a10" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">声明文件将所有类型和声明保存在一个单独的有组织的文档中，以保持代码的模块化。这些文件允许其他开发人员使用NPM包的类型，而不必编写自己的类型。有时NPM包附带声明文件和如何使用它们的说明，但是如果你的包没有附带类型呢？</p><p id="790d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入<a class="ae ky" href="https://github.com/DefinitelyTyped/DefinitelyTyped" rel="noopener ugc nofollow" target="_blank">明确键入</a>。DefinitelyTyped允许开发人员为没有类型的包请求和贡献类型。它是完全开源的，为开发者提供了资源和指南来共同处理类型声明文件，还有一个发布管道。您可以使用<a class="ae ky" href="http://microsoft.github.io/TypeSearch/" rel="noopener ugc nofollow" target="_blank">类型搜索</a>来搜索您的包中已经编写的类型。</p><p id="0e36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类型通常可以在您的<code class="fe mz na nb nc b">node_modules</code>文件夹中的<code class="fe mz na nb nc b">@types</code>文件夹中找到。即使您以前从未使用过TypeScript，如果您查看您的一个旧项目，您可能会发现这个文件夹中有您的一些NPM模块的类型。</p><p id="6aa5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，如果您仍然不能为您的包找到类型，您将需要决定使用一个不同的包，或者更有趣的方法是编写您自己的类型声明文件！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/c66ad04841dbcf9934dfb75f56919a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*61_L5LGWBE3Xoz73-obhWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这是一大堆问题！</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7a4b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">你的第一份申报文件</h1><p id="fb01" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">稍等一会儿！在您开始为一个包编写类型之前，您应该首先对您的包进行一些测试和研究，以确保您理解它是如何工作的。如果你是一个打字新手或者软件包很复杂，为它编写类型可能会很困难。一个让你的脚(或手，就此而言)沾湿的好方法可能是接受对一些已经写好的明确类型化的文件的一些拉请求。</p><p id="7fae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个可能的途径是为轻量级API的请求创建一个更简单的包或声明文件。在我的例子中，NPM上没有对应于纽约福利筛选API的包，所以我只需要找到如何发布我的类型供其他人使用。</p><p id="94bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TypeScript有一些制作声明文件的<a class="ae ky" href="https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html" rel="noopener ugc nofollow" target="_blank">指南</a>，包括模板和最佳实践。我强烈建议在尝试编写声明文件之前通读这一节。每个声明文件都是不同的，但是集成声明的两种主要方式是通过模块和通过全局名称空间。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5498" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">导出您的类型</h1><p id="e6af" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果你正在为一个已经存在的包创建一个声明文件，你将希望根据这个包来实现你的类型。大多数包都是模块化的，但是可能有一些仍然使用全局范围。TypeScript建议使用模块化样式，以避免污染全局命名空间。因为我的API没有相关的包，所以我将发布一个模块化路由的NPM包。</p><p id="77fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:如果您正在为现有的包添加类型，您应该编写测试或者使用您正在键入的包中提供的测试，以确保您的类型编写正确！</p><p id="355a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的是TypeScript网站上提供的一个模板，所以我的文件中的第一行是类型所对应的包和作者信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/91e65759383483460e9e2da8f41ddc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_YwzBtXEjSWELJGFtACWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我的类型文件的信息，使用来自TypeScript网站的模板。</p></figure><p id="cc54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了导出文件中的类型，我们可以简单地在所有类型/接口前面写<code class="fe mz na nb nc b">export</code>。但是，如果您有大量的类型或组织成不同部分的类型，您应该将它们放在一个命名空间下。命名空间允许我们导入一个名称下的所有类型，而不是分别导入所有类型。它还有助于避免与不同包或自定义类型中的其他类型发生命名冲突。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/17200db59ec4e5cfc191d6d915c87803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G01Io-EiY1q_RMmygpBYwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">命名空间NYCBSA下的一组类型。</p></figure><p id="01e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望能够使用名称空间导入或者单独导入每种类型，所以我只是复制了我的类型(没有名称空间声明),在它们前面的文件底部有<code class="fe mz na nb nc b">export</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/e7046c6a8e20f77865c087eaa1627bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QsleXS7gQZ1fQaojRx82ig.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="59a1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">制作NPM套餐</h1><p id="1e30" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一个NPM包很容易发布，但是你首先要测试你的包以确保它能工作。我测试我的包的方式是<code class="fe mz na nb nc b">npm pack.</code>这个命令将你的包捆绑到一个可以使用命令<code class="fe mz na nb nc b">npm install &lt;tarball-destination.tgz&gt;</code>安装的档案中。</p><p id="fc20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦确保在本地安装软件包后可以正确导入类型，就可以继续发布软件包了。</p><h2 id="f59a" class="nh md it bd me ni nj dn mi nk nl dp mm li nm nn mo lm no np mq lq nq nr ms ns bi translated">出版</h2><p id="6dd8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在您考虑发布之前，您应该写一个自述文件，以便让人们知道您的软件包是做什么的以及如何使用它。你还应该确保你的<code class="fe mz na nb nc b">package.json</code>中的所有信息都是正确的。(许可证、描述、作者、依赖关系等。).一旦你得到了，你就需要在NPM上做一个帐户。使用<code class="fe mz na nb nc b">npm login</code>在命令行上登录后，您可以使用<code class="fe mz na nb nc b">npm publish</code>公开发布您的包。你可以<a class="ae ky" href="https://www.npmjs.com/package/nycbsa_types" rel="noopener ugc nofollow" target="_blank">检查</a>这个例子的包。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9504" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><ul class=""><li id="386e" class="nt nu it lb b lc mu lf mv li nv lm nw lq nx lu ny nz oa ob bi translated"><a class="ae ky" href="https://docs.npmjs.com/creating-and-publishing-unscoped-public-packages" rel="noopener ugc nofollow" target="_blank">https://docs . npmjs . com/creating-and-publishing-unscoped-public-packages</a></li><li id="969e" class="nt nu it lb b lc oc lf od li oe lm of lq og lu ny nz oa ob bi translated"><a class="ae ky" href="http://blog.wolksoftware.com/contributing-to-definitelytyped" rel="noopener ugc nofollow" target="_blank">http://blog . wolk software . com/contributed-to-definitely typed</a></li></ul><div class="oh oi gp gr oj ok"><a href="https://medium.com/razroo/what-are-declaration-files-in-typescript-476c1c06f353" rel="noopener follow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">Typescript中的声明文件是什么？</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">角度:全色域版</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">medium.com</p></div></div></div></a></div><div class="oh oi gp gr oj ok"><a href="https://github.com/cjthompson/typescript-examples" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">CJ Thompson/typescript-示例</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">关于如何为npm模块编写声明文件的TypeScript示例-CJ Thompson/TypeScript-示例</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">github.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ks ok"/></div></div></a></div><div class="oh oi gp gr oj ok"><a href="https://dev.to/vcarl/testing-npm-packages-before-publishing-h7o" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">发布前测试npm包</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">当开发一个npm包时，你必须确认它实际上可以被使用。这是…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">开发到</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy ks ok"/></div></div></a></div></div></div>    
</body>
</html>