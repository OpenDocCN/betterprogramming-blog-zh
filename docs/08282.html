<html>
<head>
<title>Clearing Up the Confusing Closures Concept in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">澄清Swift中令人困惑的闭包概念</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/clearing-up-the-confusing-closures-concept-in-swift-c5b7ad2dd0ab?source=collection_archive---------8-----------------------#2021-04-13">https://betterprogramming.pub/clearing-up-the-confusing-closures-concept-in-swift-c5b7ad2dd0ab?source=collection_archive---------8-----------------------#2021-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9fd9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过例子理解闭包</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8d3d98f855e424fc151b9d7a4b734e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JIgGMHzge0mi4OUX"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">micha Kubalczyk在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="145a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">闭包在程序员的日常生活中非常重要。它们表示一些可以赋给变量的代码块。此外，这段代码可以传递给一个函数，并用作一个应该在函数的另一个动作之后执行的动作。</p><p id="ef3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在看起来可能有点混乱，但是我会试着在这篇文章里把一切都讲清楚。</p><p id="9fe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事不宜迟，让我们看看闭包的语法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="15fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是闭包最简单的例子。如您所见，我们创建了一个名为<code class="fe lu lv lw lx b">greetings</code>的常量变量，并将其分配给花括号中的消息。在最后一行，闭包被称为。通过调用<code class="fe lu lv lw lx b">birthday()</code>来执行。你已经注意到花括号和闭包之间的联系了吗？如果是这样，恭喜你！您刚刚学习了闭包的基本概念。</p><p id="4a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们看看闭包的最完整形式，并一步一步地简化它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><ul class=""><li id="96ef" class="ly lz iq ky b kz la lc ld lf ma lj mb ln mc lr md me mf mg bi translated"><code class="fe lu lv lw lx b">(String) -&gt; ( )</code> —我们用一个<code class="fe lu lv lw lx b">String</code>参数指定闭包的类型，并等待它不返回任何内容。<code class="fe lu lv lw lx b">(String) -&gt; ( )</code>相当于<code class="fe lu lv lw lx b">(String) -&gt; Void</code>。</li><li id="df8e" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated"><code class="fe lu lv lw lx b">(name: String) -&gt; ( )</code> —我们做了相同的闭包类型规范，除了我们给<code class="fe lu lv lw lx b">name</code>作为我们要传递的参数。</li><li id="8304" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated">关键字<code class="fe lu lv lw lx b">in</code>作为参数和闭包体之间的边界。所以在<code class="fe lu lv lw lx b">in</code>关键字之后，我们可以写闭包的一些动作。</li><li id="ac1f" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated">在<code class="fe lu lv lw lx b">greetings(“Mike”)</code>中，我们传递一个<code class="fe lu lv lw lx b">name</code>的<code class="fe lu lv lw lx b">String</code>。</li></ul><p id="664e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出:</p><pre class="kg kh ki kj gt mm lx mn mo aw mp bi"><span id="c6c1" class="mq mr iq lx b gy ms mt l mu mv">Hello, Mike!</span></pre><p id="1a44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们说过在第一个例子中指定闭包类型做了两次，所以我们可以很容易地省略其中一个规范:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="aa4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实上，我们也可以去掉参数的<code class="fe lu lv lw lx b">name</code>规范，只使用<code class="fe lu lv lw lx b">$0 </code>简写！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="356d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有没有注意到我们也没有使用<code class="fe lu lv lw lx b">in</code>关键字？这是因为我们还没有写任何参数名。这里的<code class="fe lu lv lw lx b">$0</code>是指<code class="fe lu lv lw lx b">String</code>参数。</p><p id="a0dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有几个语法注释的例子:</p><ul class=""><li id="921b" class="ly lz iq ky b kz la lc ld lf ma lj mb ln mc lr md me mf mg bi translated"><code class="fe lu lv lw lx b">(String, String) -&gt; ()</code>:<code class="fe lu lv lw lx b">string</code>的两个参数不返回任何值。</li><li id="f86d" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated"><code class="fe lu lv lw lx b">(Int, Int) -&gt; (Double)</code>:返回<code class="fe lu lv lw lx b">double</code>的<code class="fe lu lv lw lx b">int</code>的两个参数。</li></ul></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="3dde" class="nd mr iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">分类方法</h1><p id="b399" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">让我们来看一个内置的Swift闭包(<code class="fe lu lv lw lx b">sorted</code>)，它为您排序一些数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="656d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">记住:能够使代码简短是好的，但是让你的代码对其他人来说可读性更好就更好了！</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="fe4f" class="nd mr iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">关闭类型</h1><p id="d9bf" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">在Swift中，我们有不同类型的闭包，比如<code class="fe lu lv lw lx b">trailing</code>、<code class="fe lu lv lw lx b">escaping</code>、<code class="fe lu lv lw lx b">autoclosure</code>和<code class="fe lu lv lw lx b">autoclosure escaping</code>。</p><h2 id="1eb9" class="mq mr iq bd ne oa ob dn ni oc od dp nm lf oe of no lj og oh nq ln oi oj ns ok bi translated">尾随闭包</h2><p id="9408" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">当闭包是函数中的最后一个参数时，闭包可以写在函数的括号之外，参数的标签可以省略。这被称为拖尾函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="9186" class="mq mr iq bd ne oa ob dn ni oc od dp nm lf oe of no lj og oh nq ln oi oj ns ok bi translated">转义闭包</h2><p id="a8a2" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">函数返回后执行时，闭包被调用到<code class="fe lu lv lw lx b">escape</code>。你只需要在参数类型前声明<code class="fe lu lv lw lx b">@escaping</code>关键字来指出闭包是允许转义的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="4768" class="mq mr iq bd ne oa ob dn ni oc od dp nm lf oe of no lj og oh nq ln oi oj ns ok bi translated">自动关闭</h2><p id="6a3b" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated"><code class="fe lu lv lw lx b">Autoclosure</code>在功能返回前自动执行<em class="nz">。为了使用它，您需要在参数类型之前声明<code class="fe lu lv lw lx b">@autoclosure</code>关键字:</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="9146" class="mq mr iq bd ne oa ob dn ni oc od dp nm lf oe of no lj og oh nq ln oi oj ns ok bi translated">自动关闭逃逸</h2><p id="c769" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">您可能已经理解了，<code class="fe lu lv lw lx b">autoclosure escaping</code>是两个闭包的共生。如果你想让一个自动闭包被允许从一个函数中转义，使用<code class="fe lu lv lw lx b">@autoclosure</code>和<code class="fe lu lv lw lx b">@escaping</code>属性:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="efb8" class="nd mr iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">包扎</h1><p id="546e" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">闭包非常重要，是Swift的基本功能。我希望这篇文章能让您更好地理解它们是什么以及如何使用它们。</p><p id="3f43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对其他相关话题感兴趣？欢迎访问我的其他相关文章:</p><ul class=""><li id="d2aa" class="ly lz iq ky b kz la lc ld lf ma lj mb ln mc lr md me mf mg bi translated"><a class="ae kv" href="https://medium.com/cleansoftware/beginners-guide-to-using-optionals-in-swift-5-f40caae4edb7" rel="noopener">Swift 5中使用选项的指南</a></li><li id="f8e7" class="ly lz iq ky b kz mh lc mi lf mj lj mk ln ml lr md me mf mg bi translated"><a class="ae kv" href="https://levelup.gitconnected.com/demystifying-struct-class-and-enum-in-swift-5-43dde089e96a" rel="noopener ugc nofollow" target="_blank">揭开Swift 5中的结构、类和枚举的神秘面纱</a></li></ul><p id="53c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有任何批评、问题或建议，欢迎在下面的评论区发表！</p><p id="3ba2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>