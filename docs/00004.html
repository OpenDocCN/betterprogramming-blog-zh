<html>
<head>
<title>Creating UIViews Programmatically in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中以编程方式创建UIViews</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-uiviews-programmatically-in-swift-55f5d14502ae?source=collection_archive---------0-----------------------#2016-06-09">https://betterprogramming.pub/creating-uiviews-programmatically-in-swift-55f5d14502ae?source=collection_archive---------0-----------------------#2016-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="369a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用视图约束，使用PureLayout</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a0fd8a146c5f21f4894a57ee9da6d2b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeYZXY-q_jGsCoQusMvhqQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈尔·盖特伍德在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="7798" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">期待什么</h1><ul class=""><li id="bf19" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">了解iOS屏幕</li><li id="5027" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">视图层次结构</li><li id="8aa7" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">何时以编程方式构建视图</li><li id="975e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">如何组织你的代码(MVC模式)</li><li id="e94e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">构建自定义类(UIView)</li><li id="8a6c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">一个例子是Twitter iOS应用程序</li><li id="b442" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">！海量视图控制器</li><li id="b23a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">设置我们的约束(PureLayout)</li></ul><h1 id="450f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">了解iOS屏幕</h1><p id="a35e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">任何iOS应用都有很多视图。这些视图需要指定四个值来显示:<strong class="lt iu"> x，y，宽度，高度</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/26ad66fea3571d3cacfe09191c05ecf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*8dhM5DeQUo0K7kGb0KutlQ.png"/></div></figure><p id="c4c5" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">构建这些视图有三种不同的方式:<a class="ae ky" href="https://developer.apple.com/library/ios/recipes/xcode_help-IB_storyboard/Chapters/AboutStoryboards.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">故事板</strong> </a>，<a class="ae ky" href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">笔尖</strong> <strong class="lt iu">文件</strong> </a>和<strong class="lt iu">程序化</strong>。</p><p id="e85b" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">iOS sdk (UIKit)中有一个框架，包括一组标准子类，从简单的按钮到复杂的表格，还有许多其他视图对象。例如，<a class="ae ky" href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UILabel_Class/index.html#//apple_ref/occ/cl/UILabel" rel="noopener ugc nofollow" target="_blank"> UILabel </a>对象绘制文本字符串，而<a class="ae ky" href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIImageView_Class/index.html#//apple_ref/occ/cl/UIImageView" rel="noopener ugc nofollow" target="_blank"> UIImageView </a>对象绘制图像。</p><p id="7ecf" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">视图可以嵌入其他视图，并创建复杂的可视化层次结构。这在被嵌入的视图(称为<strong class="lt iu">子视图</strong>)和进行嵌入的父视图(称为<strong class="lt iu">超级视图</strong>)之间创建了父子关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/a9210ec82fa831bcf63a7c7620a7c666.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*nitdWIXLUR0In05sZCOVpQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">视图层次结构</p></figure><h1 id="4b99" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">视图层次结构</h1><p id="0424" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">视图的组织既影响应用程序的视觉外观，也影响应用程序如何响应变化和事件。例如，视图层次结构中的父子关系决定了哪些对象可以处理特定的触摸事件。类似地，父子关系定义了每个视图如何响应界面方向的变化。</p><h1 id="9dfc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">何时以编程方式构建视图</h1><h2 id="f47e" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">当您有以下情况时，使用自定义代码通常是个好主意:</h2><ul class=""><li id="8c76" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">动态布局</li><li id="ad09" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">具有效果、圆角、阴影等的视图。</li><li id="b6cf" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">任何使用故事板很复杂的情况。</li></ul><h1 id="e926" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何组织你的代码(MVC模式)</h1><p id="3390" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">模型-视图-控制器可能是最常用的设计模式。当开始iOS开发时，经常会遇到<em class="nu">大量视图控制器问题</em>:视图控制器经常变得太大，包含各种功能，变得很难修改或重构。</p><p id="15a4" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">通过遵循这种模式，我们可以确保项目中每个类都是控制器、模型或视图。这将使我们更容易以编程方式创建所有视图，而不会创建一个意大利面条怪物。显然，我们可以有其他组和类，但应用程序的核心包含在这三个类别中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/37d91d0747152d2c1b2353295234fa11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*EShr8Q8bjpshCBiWRPxRHw.png"/></div></figure><h2 id="3a89" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">入门指南</h2><p id="08eb" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">当开始一个新项目时，Xcode用故事板初始化它。为了创建我们的自定义视图，我们需要放弃故事板。</p><p id="3aec" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">接下来，创建两个文件:<em class="nu"> ProfileView </em>作为<strong class="lt iu"> View </strong>类别下的<strong class="lt iu"> UIView </strong>类，以及<em class="nu"> ProfileViewController </em>作为<strong class="lt iu"> UIViewController </strong>类在<strong class="lt iu"> Controller </strong>类别下。</p><h1 id="1dca" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">自动布局</h1><p id="ac34" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">自动布局将确定屏幕中每个视图的<strong class="lt iu">框架</strong>，因此每个视图都应该有一个<strong class="lt iu">约束</strong>来帮助确定其<strong class="lt iu">宽度</strong>、<strong class="lt iu">高度</strong>、<strong class="lt iu"> x </strong>和<strong class="lt iu"> y </strong>位置。从头开始编写自动布局代码并不容易——pure Layout为自动布局提供了一个功能齐全且开发人员友好的界面。</p><p id="1531" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">在我们继续之前，让我们将PureLayout添加到我们的项目中。将PureLayout添加到您的Swift项目中有多种方式。我使用的是<a class="ae ky" href="https://cocoapods.org" rel="noopener ugc nofollow" target="_blank"> cocoapods </a>，一个用于Swift和Objective-C项目的依赖管理器。它需要一个名为Podfile的文件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="2952" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">接下来运行下面的命令来安装依赖项，在本例中是PureLayout:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="5f00" class="ni la it nz b gy od oe l of og">pod install</span></pre><p id="888b" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">该命令将创建一个以<strong class="lt iu"> .xcworkspace结尾的新项目文件。</strong>现在，这是我们将在Xcode中打开的文件，以继续开发应用程序。</p><h1 id="8018" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">构建自定义类</h1><p id="17a0" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">在我们的<em class="nu"> ProfileView.swift </em>文件中，您将看到UIView类实现的模板，如下所示:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="1766" class="ni la it nz b gy od oe l of og">import UIKit</span><span id="3a69" class="ni la it nz b gy oh oe l of og">class ProfileView: UIView {</span><span id="2b9f" class="ni la it nz b gy oh oe l of og">}</span></pre><p id="d4a0" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">我们需要初始化我们的类。初始化器在Swift中很重要，如果你愿意，你可以在这里读到更多。现在你需要知道的是有主初始化器，它们负责初始化一个类的所有属性。下面是一个典型实施的示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="7b02" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">由于我们是在<strong class="lt iu"> UIView </strong>子类中添加约束，我们应该覆盖<strong class="lt iu"><em class="nu">update constraints</em></strong><em class="nu"/>方法。在对象的生存期内，可以多次调用此方法。为了避免重复的约束，你应该保留一个标志(<strong class="lt iu"><em class="nu">shouldsetuptraints</em></strong>)，让你知道你已经完成了初始约束设置。我们必须在实施结束时调用<strong class="lt iu">超级</strong>。(如果在更改约束之前调用super，可能会崩溃)</p><h2 id="1f3c" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">例子</h2><p id="94da" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">假设我们想要重新创建Twitter iOS应用程序的侧面视图。在下图中，你可以看到一个标题视图，有横幅图像，个人资料图像，用户信息等。屏幕底部是包含所有推文的表格和一个标签栏。所有标有紫色的元素都是UIView的子类(UIButtons、UILabels、UIImageViews等)。我们将重点放在标题视图上，在下图中用橙色框起来。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/99043033268b279ddf70071a8c815da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*S-IdPM4sM7Z5SxKQsiE-QQ.png"/></div></figure><p id="95a8" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">更具体地说，我们将取出下图中的这三个元素来说明我们的示例。横幅和个人资料图像为<code class="fe oj ok ol nz b">UIImageViews</code> <strong class="lt iu">、</strong>，按钮部分为<code class="fe oj ok ol nz b">UISegmentedControl</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/4bf8bb4f73443a9f784e652ed494765e.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*oDmHNcrN4opF0G_6Oz04pw.png"/></div></div></figure><p id="b6b5" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">首先，我们需要在我们的<code class="fe oj ok ol nz b">ProfileView </code>类中声明三个对象:<code class="fe oj ok ol nz b">bannerView</code>、<code class="fe oj ok ol nz b">profileView </code>和<code class="fe oj ok ol nz b">segmentedControl</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="0963" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">然后，在<strong class="lt iu"> <em class="nu"> init </em> </strong>:方法中，我们为每个对象设置属性:背景颜色、边框颜色，以及基本上整个外观设置。每个对象都需要首先初始化。用等于零的帧初始化它们—自动布局稍后会处理它。</p><p id="06b8" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">为了将每个对象的子视图添加到我们的视图(ProfileView)中，我们使用了<code class="fe oj ok ol nz b">addSubview:</code>方法。这将指定的视图放在其他视图的顶部。整个事情看起来会是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h1 id="c30c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">设置我们的约束(PureLayout)</h1><h2 id="f9bd" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">布局约束</h2><p id="3b93" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">布局约束是对视图之间的属性和关系的描述。<code class="fe oj ok ol nz b"><strong class="lt iu">NSLayoutConstraint</strong> </code>类用于创建约束。</p><p id="7bc5" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">有几种类型的约束:</p><ul class=""><li id="a04b" class="lr ls it lt b lu nc lw nd ly on ma oo mc op me mf mg mh mi bi translated">尺寸限制— <em class="nu">图像宽度应为200像素</em></li><li id="365a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">对齐限制— <em class="nu">标签应在屏幕上垂直居中</em></li><li id="3c8e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">间距约束— <em class="nu">两个对象之间的间距</em></li></ul><h2 id="1694" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">属性</h2><p id="430f" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">PureLayout定义了用于创建自动布局约束的视图属性。其中一些如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/703d3b5abb1539414a464cd6818bb517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*woJtSfLbTlolYvfYNA5tjA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://github.com/PureLayout/PureLayout" rel="noopener ugc nofollow" target="_blank">https://github.com/PureLayout/PureLayout</a></p></figure><h2 id="12f2" class="ni la it bd lb nj nk dn lf nl nm dp lj ly nn no ll ma np nq ln mc nr ns lp nt bi translated">开始钉东西！</h2><p id="e6b0" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">我们基本上在屏幕上扔了三个矩形。现在我们需要将它们排列成我们的Twitter个人资料:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/82018a36346b60bd1da54586d84c9456.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*sPZ50rGQljFMYB-qWOQJqQ.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h1 id="4431" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">！海量视图控制器</h1><p id="4187" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">我们已经完成了我们的ProfileView，现在我们从我们的控制器(<code class="fe oj ok ol nz b">ProfileViewController</code>)调用它。Xcode已经用<code class="fe oj ok ol nz b">viewDidLoad:</code>方法创建了一个控制器模板。这是在呈现控制器之前被调用一次的方法。此时，我们创建了一个<code class="fe oj ok ol nz b">profileView,</code>的实例，如下所示。应该就是这样！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="b23d" class="pw-post-body-paragraph mo mp it lt b lu nc ju mq lw nd jx mr ly ne mt mu ma nf mw mx mc ng mz na me im bi translated">(<em class="nu">免责声明</em> : <em class="nu">此处显示的代码主要用于说明自动布局的目的。您可能需要在其他地方添加其他行来完成一个全功能项目)</em></p><ul class=""><li id="a44e" class="lr ls it lt b lu nc lw nd ly on ma oo mc op me mf mg mh mi bi translated"><a class="ae ky" href="http://www.fullstacknights.com/fsn/videos/2016/03/29/fullstack-nights-v3-videos/" rel="noopener ugc nofollow" target="_blank"> <em class="nu">全栈之夜</em> </a> <em class="nu">西班牙语视频。</em></li></ul></div></div>    
</body>
</html>