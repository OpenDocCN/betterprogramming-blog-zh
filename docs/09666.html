<html>
<head>
<title>Creating Confetti Particle Effects Using SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SwiftUI创建五彩纸屑粒子效果</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-confetti-particle-effects-using-swiftui-afda4240de6b?source=collection_archive---------4-----------------------#2021-09-23">https://betterprogramming.pub/creating-confetti-particle-effects-using-swiftui-afda4240de6b?source=collection_archive---------4-----------------------#2021-09-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6f8d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向您的SwiftUI应用程序添加焰火和五彩纸屑</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b1d737b92ef187ce224e1e7719fcfda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1HOarnU14XFQ_5zGq9wMg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="728e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，创建一个类型为<code class="fe lu lv lw lx b">GeometryEffect</code>的结构。</p><p id="60f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要为粒子定义时间、速度和方向。使速度变量成为20到200之间的随机数。如果你尝试一个小的数值范围(例如10 … 30)，粒子的爆炸将会被更好的控制并且不那么剧烈。</p><div class="kj kk kl km gt ab cb"><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/07fa1168daa74315613e9b5138cc9959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*bjQo2FR7gnF95gmd4Gb0Ew.png"/></div></figure><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/b13586af2acfc407daf863dc2527a764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*V6D-ot7uaEs_gDhAmBQdhg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk me di mf mg translated">左侧速度范围在20–30之间，右侧速度范围在20–100之间</p></figure></div><p id="4e4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于方向，使用-pi和pi之间的值。这个范围会给我们一个完整的圆。</p><p id="0339" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你将数值范围在0到π之间改变，粒子将以半圆的形状向下移动。如果您现在将数字范围更改为-pi到0之间，将会产生相反的效果。</p><div class="kj kk kl km gt ab cb"><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/6edd464633be8d2369e1a984347da098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*yeElP-FJXICl0v6hjyhtCg.gif"/></div></figure><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/07d8c05032ef2349698b8db39c5cd446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*GeYSH-0F0uxsGmZ1FaTcwg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk me di mf mg translated">左边的方向范围在0-pi和右边的范围-pi-0之间</p></figure></div><p id="63dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe lu lv lw lx b">animatableData</code>增加时间值。<code class="fe lu lv lw lx b">animatableData</code>是一个特殊的变量，不要重命名，否则动画将无法工作。如果你移除<code class="fe lu lv lw lx b">animatableData</code>，你将有粒子固定在随机的地方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/40ea2fb8809592004611898323d01a88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*qXC54aG9uuy9TANnNGHr4w.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">没有时间动画的粒子</p></figure><p id="4177" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过执行<code class="fe lu lv lw lx b">effectValue</code>功能符合<code class="fe lu lv lw lx b">GeometryEffect</code>协议。</p><p id="fa0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要计算出所有粒子的平移/位置。使用速度、时间以及方向的余弦和正弦值计算平移。仿射变换矩阵用于转换您在图形环境中绘制的对象。</p><p id="9cbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用我们的翻译创建一个<code class="fe lu lv lw lx b">CGAffineTransform</code>，然后用我们创建的<code class="fe lu lv lw lx b">CGAffineTransform</code>返回一个<code class="fe lu lv lw lx b">ProjectionTransform</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="72a0" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">粒子修改器</h1><p id="51d7" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">创建一个视图修改器，通过循环复制其内容。下面你可以看到我选择循环到80，但是你可以根据你想要多少个粒子来增加或减少这个数字。</p><p id="99ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">添加要应用于粒子的修改器。但最重要的是，添加自定义几何效果的<code class="fe lu lv lw lx b">.modifier()</code>，我们创建了上面的<code class="fe lu lv lw lx b">.scaleEffect()</code>和下面的<code class="fe lu lv lw lx b">opacity()</code>。</p><p id="b616" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，在嵌入内容循环的<code class="fe lu lv lw lx b">ZStack</code>上添加<code class="fe lu lv lw lx b">onAppear()</code>。在内部，动画显示时间和比例的值。对于不透明度，我们希望它在动画结束时淡出。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="2c6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">查看下面的图像，看看将持续时间值从5更改为15会如何影响粒子的大小和不透明度。</p><div class="kj kk kl km gt ab cb"><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/423c8c868a2aa981a17fbeac2c755e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*MEjcCmWkCBl8tm5-qKQD3Q.gif"/></div></figure><figure class="ly kn lz ma mb mc md paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/6280626d03f13954a6f458bfa665fb18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*EReA7RzfeHEzAzmUdOd1Fw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk me di mf mg translated">持续时间值左边是5，右边是15</p></figure></div><h1 id="710d" class="mr ms it bd mt mu no mw mx my np na nb jz nq ka nd kc nr kd nf kf ns kg nh ni bi translated">内容视图</h1><p id="e736" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">在类型为<code class="fe lu lv lw lx b">View</code>的结构中，将<code class="fe lu lv lw lx b">ParticleModifier</code>添加到您想要的任何形状或图像中！</p><p id="2a6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面，我用圆形来表示粒子的形状。我还为它的位置添加了一个偏移量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/ee13b535d6124ae5b30d499e6007a1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*MWs76bYGtxbtTEZsqC5wMw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内容视图—圆圈()粒子</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="c665" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就结束了。感谢阅读。</p></div></div>    
</body>
</html>