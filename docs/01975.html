<html>
<head>
<title>Checking for the User’s First Launch in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检查用户在Swift中的首次启动</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/checking-for-the-users-first-launch-in-swift-df02a1feb472?source=collection_archive---------6-----------------------#2019-10-28">https://betterprogramming.pub/checking-for-the-users-first-launch-in-swift-df02a1feb472?source=collection_archive---------6-----------------------#2019-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="041a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在第一次启动时运行特定的操作，之后在每次启动时运行不同的操作</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/12b443ce33b1c07338ab5b8e62372694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7sUCcSVdH29hrDCIaABvSA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">首次发射时的“首次”;之后的每次发射都是“秒+”</p></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="ceb0" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">介绍</h1><p id="3b90" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">在你掌握了保存数据的能力之后，无论是使用<code class="fe mq mr ms mt b">iCloud</code>还是为了安全起见使用<code class="fe mq mr ms mt b">UserDefaults</code>，你都需要能够加载数据。虽然单击按钮是加载数据的一种简单方式，但您不希望每次用户需要应用程序的最新数据时都单击按钮。</p><p id="9600" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">就像我上面说的，你可能会认为使用按钮是加载用户数据的最简单的方式，但是能够检测应用程序的当前会话是否是第一次启动并不像人们想象的那么困难。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="e7de" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">什么是首次启动检查，它们有什么用处？</h1><p id="15f7" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">对于不同类型的应用程序，能够检查当前应用程序会话是否是第一次启动是非常重要的。最重要的一点是你的应用程序是否需要登录。当用户第一次启动你的应用时，你宁愿让他们去登录页面，而不是你的应用的主页，对吗？然后你需要能够检查这是否是他们第一次使用这个应用程序。</p><p id="e96e" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">另一个使用它的好时机是，如果你的应用程序要求用户在第一次启动时选择某些设置，那么以后每次启动时你都需要加载这些设置。实现这样的事情最简单的方法是使用一个老的、可信赖的朋友:<code class="fe mq mr ms mt b">UserDefaults</code>。让我们开始吧。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="13fd" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">要求</h1><ul class=""><li id="f8d3" class="mz na iq lw b lx ly ma mb md nb mh nc ml nd mp ne nf ng nh bi translated">Xcode 10</li><li id="430b" class="mz na iq lw b lx ni ma nj md nk mh nl ml nm mp ne nf ng nh bi translated">Swift 4(及更高版本)</li></ul><p id="dc87" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">我假设你对<code class="fe mq mr ms mt b">UserDefaults</code>的工作原理有一点了解，如果你没有，<a class="ae nn" href="https://medium.com/better-programming/data-persistence-userdefaults-b8503f93ff14?source=your_stories_page---------------------------" rel="noopener">可以看看我的文章</a>关于它们是如何工作的。在我看来，<code class="fe mq mr ms mt b">UserDefaults</code>是最有用的框架之一。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="6c0f" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">入门指南</h1><p id="27b6" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">和往常一样，首先要做的是创建一个新的Xcode项目。</p><p id="08d0" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">我们将为本教程选择一个单视图应用程序(完整的项目可以在本文末尾找到)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/d9cac3f5d5b682b1578907aa853a2fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fpsBI4OQZ0Ox0cutesk6Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">为此项目选择单视图应用程序</p></figure><p id="1b42" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">接下来，随便你给它起什么名字——对于这个项目，我将把它命名为<code class="fe mq mr ms mt b">CheckForFirstTimeLaunchDemo</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/e8752104b72102123b4b46d3ea7c8d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtONVPUyFtEvvGCrj1pKoQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">命名为<code class="fe mq mr ms mt b">CheckForFirstTimeLaunchDemo</code></p></figure><p id="9203" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">点击“下一步”,并将其保存在您记得的地方。现在让我们开始运行一些简单的代码。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="3205" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">代码</h1><p id="59f2" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">对于本文，我选择不做任何UI工作。我这样做是因为从技术上来说，它不需要任何东西——另外，它可以让人们更好地理解，当你的应用加载时，你不需要像按钮这样的UI元素来加载数据。</p><p id="911c" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">首先，我们将进入<code class="fe mq mr ms mt b">ViewController.swift</code>并将光标置于<code class="fe mq mr ms mt b">ViewDidLoad</code>方法中。完成后，让它看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/ec1cf384e72d0129e05d0d82dd6accad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPmuYDqhwo2tlNsCo6HB4A.png"/></div></div></figure><p id="166b" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第5行:这只是将变量<code class="fe mq mr ms mt b">defaults</code>设置为<code class="fe mq mr ms mt b">UserDefaults.standard</code>。</p><p id="6122" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第10行:这是一切的开始。它只是一个<code class="fe mq mr ms mt b">if-statement</code>，检查键<code class="fe mq mr ms mt b">“First Launch”</code>是否被设置为<code class="fe mq mr ms mt b">defaults</code>内部的<code class="fe mq mr ms mt b">true</code>。现在，如果<em class="nq">是</em>第一次启动，则键<code class="fe mq mr ms mt b">“First Launch”</code>不会被设置为任何值，因此if语句将输出一个<code class="fe mq mr ms mt b">false</code>读数。</p><p id="bef1" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第21行:如果它是假的，在应用程序第一次启动时，它将到达<code class="fe mq mr ms mt b">if-statement</code>的<code class="fe mq mr ms mt b">else</code>部分。在这一行下面，你应该放置你想在应用程序第一次启动时运行的代码。第21行所做的就是将<code class="fe mq mr ms mt b">“First”</code>打印到调试区。</p><p id="90ad" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第25行:这里是大部分神奇的事情发生的地方:一旦应用程序第一次运行，<code class="fe mq mr ms mt b">“First Launch”</code>没有被设置为任何东西，所以它默认为<code class="fe mq mr ms mt b">false</code>。但是在第一次发射发生后，我们希望“第一次发射”是<code class="fe mq mr ms mt b">true</code>，表示第一次发射已经发生。这样，当第10行中的<code class="fe mq mr ms mt b">if-statement</code>再次运行时，<code class="fe mq mr ms mt b">else</code>部分将不会运行——除非用户删除该应用并重新安装。</p><p id="d7b7" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第12行:这将把<code class="fe mq mr ms mt b">“Second+”</code>输出到调试区，表示在第一次启动后正在运行的代码。</p><p id="af28" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第16行:该行与第25行完全相同，但在<code class="fe mq mr ms mt b">if-statement</code>的不同部分。从技术上讲，我们不需要这个，但它让我感觉更好。</p><p id="b331" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">代码到此为止。有点TL；对这一行的dr解释应该是:把你想在第一次启动时运行的代码放在第21行和第25行之间。在第12行和第16行之间，把你想运行的任何东西放到之后的每次启动中，你就可以运行了！</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="3a56" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">运行应用程序</h1><p id="3409" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">你现在要做的就是运行将应用程序部署到iPhone模拟器的方案(如果是第一次将应用程序运行到模拟器，可能需要几分钟)。</p><p id="19be" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">第一次在模拟器或真实设备上启动应用程序时，调试区域应该显示<code class="fe mq mr ms mt b">“First.”</code></p><p id="8ccc" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">之后，进入多任务模式，关闭应用程序。</p><p id="15ca" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">完成之后，只需在Xcode中再次运行该方案(这样您就可以获得调试输出)，现在您应该会看到打印出的<code class="fe mq mr ms mt b">“Second+”</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/12b443ce33b1c07338ab5b8e62372694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7sUCcSVdH29hrDCIaABvSA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">运行应用程序两次，以确保一切正常</p></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="d80b" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">结论</h1><p id="a2f0" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">能够检查当前应用的会话是否是第一次启动，这并不是很难实现。有了我们的朋友<code class="fe mq mr ms mt b">UserDefaults</code>，你可以在短短几分钟内设置你的应用程序，每次打开它时自动加载数据。</p><p id="ad4d" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">能够做到这一点增加了另一层可用性，任何用户都会非常欣赏你的应用程序。现在，他们不必手动获取更新的数据。如果你正在创建一个需要登录的应用程序，这也将大有帮助。</p><p id="8721" class="pw-post-body-paragraph lu lv iq lw b lx mu jr lz ma mv ju mc md mw mf mg mh mx mj mk ml my mn mo mp ij bi translated">用户界面越简单越好。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="38e5" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">项目文件</h1><p id="8cce" class="pw-post-body-paragraph lu lv iq lw b lx ly jr lz ma mb ju mc md me mf mg mh mi mj mk ml mm mn mo mp ij bi translated">这里是本教程的<a class="ae nn" href="https://github.com/ewalk40/CheckForFirstTimeLaunchDemo" rel="noopener ugc nofollow" target="_blank"> GitHub </a>项目的链接。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/ewalk40/CheckForFirstTimeLaunchDemo" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">ewalk 40/checkforfirst timelaunch demo</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kp nu"/></div></div></a></div></div></div>    
</body>
</html>