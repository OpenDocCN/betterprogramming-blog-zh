<html>
<head>
<title>My PHP Application Is Getting Really Popular, Now What?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的PHP应用程序越来越受欢迎，现在呢？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/my-php-application-is-getting-really-popular-now-what-68160c42f90?source=collection_archive---------13-----------------------#2019-11-25">https://betterprogramming.pub/my-php-application-is-getting-really-popular-now-what-68160c42f90?source=collection_archive---------13-----------------------#2019-11-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d9a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何水平缩放PHP应用程序的概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/54b06944ad14ad4c581a52fc6c26c7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4jCok7lThHeEWQYfmYm6A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@mariamolinero?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">玛利亚·莫利内罗</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片——放大</p></figure><p id="0f09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我的经验，PHP受到了很多人的讨厌。如此憎恨以至于我几乎不敢说我喜欢这门语言。版本7解决了很多问题，我特别喜欢增加的类型检查功能。</p><p id="dff7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而且，如果你使用流行的<a class="ae ky" href="https://laravel.com/" rel="noopener ugc nofollow" target="_blank"> Laravel框架</a>，PHP所有丑陋的部分都会被隐藏起来，你可以使用Laravel为你提供的漂亮的库。</p><p id="f711" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我谈论PHP时，经常出现的一个论点是可伸缩性。似乎有一种观念认为PHP应用程序不可伸缩。</p><p id="5104" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示扩展PHP应用程序需要什么。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a9b1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">垂直缩放</h1><p id="9c0d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">到目前为止，扩展应用程序最简单的方法是购买更好的服务器。添加更多的CPU和内存将会加快你的网站，但这是有代价的，因为购买高端服务器是昂贵的。</p><p id="c215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，很难用这种方式动态地扩展应用程序。假设您晚上几乎没有用户，而白天有大约一百万用户，那么您有一个非常昂贵的服务器，而您只使用一半的时间。</p><p id="8d19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种缩放方法称为<em class="mz">垂直缩放</em>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="368c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">水平缩放</h1><p id="1174" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">几乎所有的大型web应用程序都使用<em class="mz">水平缩放</em>。这意味着增加更多的服务器来扩展网站，而不是购买更好的服务器。</p><p id="d01d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，有一个负载平衡器将用户重定向到其中一个应用服务器。</p><p id="98a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将数据库与应用服务器分开是很重要的。这样，每个应用服务器都可以访问同一个数据库。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/8e5e179a66fa36c8990475effead8c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*Cn2TUi3bZ1eDTDn1EHmxPA.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a772" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">PHP会话</h1><p id="9a0f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">但是这种方法有一个问题。服务器必须是无状态的。</p><p id="9943" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PHP使用会话来跟踪用户的状态。如果用户在<code class="fe nb nc nd ne b">Server 01</code>登录，那么服务器知道用户已经登录。但是如果负载均衡器向<code class="fe nb nc nd ne b">Server 02</code>发送下一个请求，那么这个服务器将不会知道用户已经登录。</p><h2 id="d51a" class="nf md it bd me ng nh dn mi ni nj dp mm li nk nl mo lm nm nn mq lq no np ms nq bi translated">解决方案1。将会话存储在数据库中</h2><p id="3f0d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可以配置PHP会话以将会话数据存储在数据库中。</p><p id="9706" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这意味着对于每个请求，必须进行数据库查询。这很难扩展，因为数据库通常是大型web应用程序的性能瓶颈。</p><h2 id="d747" class="nf md it bd me ng nh dn mi ni nj dp mm li nk nl mo lm nm nn mq lq no np ms nq bi translated">解决方案2。将会话存储在Redis服务器中</h2><p id="d44c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> Redis </a>是一个速度极快的内存键值数据存储。您可以设置一个Redis服务器来存储所有PHP会话数据。查看<a class="ae ky" href="https://joshtronic.com/2013/06/20/redis-as-a-php-session-handler/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>，获得如何做到这一点的实用指南。</p><h2 id="4aad" class="nf md it bd me ng nh dn mi ni nj dp mm li nk nl mo lm nm nn mq lq no np ms nq bi translated">解决方案3。将你的应用分离成后端和前端</h2><p id="cbce" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可以选择根本不使用PHP会话。很多网站都有一个无状态API作为后端，并使用JSON web令牌作为认证系统。</p><p id="5e57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，这是最具伸缩性的解决方案，因为所有的会话管理都是在客户端完成的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="31f0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">添加更多数据库</h1><p id="2b1d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">大多数应用程序执行的读查询比写查询多。您可以使用这些信息通过添加只读数据库来扩展您的数据库。</p><p id="ce44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了保持数据一致，这些只读数据库与单个<em class="mz">只写</em>数据库同步。</p><p id="c4a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要添加更多的<em class="mz">只写</em>数据库，您就进入了数据库分片的领域，这非常复杂，我不建议您自己动手。如果你想了解更多关于分片的知识，请查看这篇文章。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ca43" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">处理上传的文件</h1><p id="756d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果用户上传文件到<code class="fe nb nc nd ne b">Server 01</code>，那么<code class="fe nb nc nd ne b">Server 02</code>也需要知道文件已经上传。</p><p id="c2d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个解决方案可能是使用<a class="ae ky" href="https://www.gluster.org/" rel="noopener ugc nofollow" target="_blank"> Gluster </a>。Gluster会自动同步网络中多个节点上的文件系统。</p><p id="2056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个解决方案是创建一个单一的对象存储服务器，这个服务器的唯一目的是存储静态文件。另外，您可以创建多个对象存储服务器，并使用Gluster来保持它们的同步！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5c5f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">云计算</h1><p id="6482" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">成功地扩展web应用程序需要做大量的工作。这就是为什么大多数公司转向云计算来扩展他们的应用程序。</p><p id="bd38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了<a class="ae ky" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云</a>平台，你可以将谷歌云数据库作为你的数据库服务器。使用<a class="ae ky" href="https://cloud.google.com/run/" rel="noopener ugc nofollow" target="_blank">云运行</a>来托管您的应用服务器。创建一个<a class="ae ky" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank">谷歌存储</a>桶来存放静态文件。使用Google Cloud <a class="ae ky" href="https://firebase.google.com/docs/firestore" rel="noopener ugc nofollow" target="_blank"> Firestore </a>作为键值会话服务器。</p><p id="2b95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">神奇的是，谷歌云平台会自动<em class="mz">动态缩放</em>你的应用。不需要你做任何工作！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f796" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="be1f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">希望本文很好地概述了扩展web应用程序所需的不同组件。最简单的方法是使用云提供商，让他们为您处理扩展！</p><p id="ef04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，自己设置组件肯定会很有趣。</p></div></div>    
</body>
</html>