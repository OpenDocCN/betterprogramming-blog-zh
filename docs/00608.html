<html>
<head>
<title>Using Xcode Previews With Existing Views Without Using SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在现有视图中使用Xcode预览，而不使用SwiftUI</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-xcode-previews-with-existing-views-without-using-swiftui-a8dae93ecd23?source=collection_archive---------2-----------------------#2019-06-18">https://betterprogramming.pub/using-xcode-previews-with-existing-views-without-using-swiftui-a8dae93ecd23?source=collection_archive---------2-----------------------#2019-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="76de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Xcode 11中使用Xcode预览的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7d72e2ed1e4c64126a78457fe6b6cb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HKnyfy5Osup4caWyY-RoQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约书亚·阿拉贡在<a class="ae ky" href="https://unsplash.com/@goshua13" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="15dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Xcode预览已添加到Xcode 11中，它们允许您快速预览视图的当前状态。虽然你可能认为你需要使用SwiftUI来利用这个伟大的新特性，但这不是真的！无论您使用自定义的<code class="fe lv lw lx ly b">UIView</code>还是自定义的<code class="fe lv lw lx ly b">UIViewController</code>，它们都支持在新画布中预览。这很棒，因为这个新特性允许你更快地迭代和实现设计。</p><p id="ebff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lz">注意:您需要Xcode 11和MacOS Catalina才能使用Xcode预览。</em></p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="a0ca" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">我们即将预览的SwiftLee视图控制器</h1><p id="8e04" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">在下面的例子中，我们有一个非常简单的<code class="fe lv lw lx ly b">SwiftLeeViewController</code>，它在一个<code class="fe lv lw lx ly b">UIImageView</code>中显示了SwiftLee标志。视图控制器是从界面构建器中设置的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/7a1684f7c10ae378e7cc50b7aabf83ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OrIQs2s9X1r1_se8.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示SwiftLee徽标的简单视图控制器。</p></figure><p id="ef8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">视图控制器的代码为空:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="0021" class="nj mi it ly b gy nk nl l nm nn">final class SwiftLeeViewController: UIViewController {<br/><br/>}</span></pre></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="4792" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">支持旧版本iOS时使用Xcode预览</h1><p id="14f7" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">WWDC很棒，但一个很大的缺点是，在你放弃iOS 12之前，你可能不会使用很多新功能。然而，Xcode预览不一定是这样的功能！</p><p id="a865" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">诀窍在于开发时将OS部署目标设置为iOS 13。这允许画布生成预览，就像SwiftUI一样。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="0280" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">但是我如何使用这些只有iOS 13及以上版本才有的协议呢？</h1><p id="68a9" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">为此，我们可以利用<code class="fe lv lw lx ly b">canImport</code>,以及可用性API。</p><p id="cc21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了添加对我们的<code class="fe lv lw lx ly b">SwiftLeeViewController</code>的支持，我们必须添加以下代码:</p><pre class="kj kk kl km gt nf ly ng nh aw ni bi"><span id="7769" class="nj mi it ly b gy nk nl l nm nn">#if canImport(SwiftUI) &amp;&amp; DEBUG<br/>import SwiftUI<br/>struct SwiftLeeViewRepresentable: UIViewRepresentable {<br/>    func makeUIView(context: Context) -&gt; UIView {<br/>        return UIStoryboard(name: "Main", bundle: Bundle.main).instantiateInitialViewController()!.view<br/>    }<br/>    <br/>    func updateUIView(_ view: UIView, context: Context) {<br/>        <br/>    }<br/>}<br/><br/>@available(iOS 13.0, *)<br/>struct SwiftLeeViewController_Preview: PreviewProvider {<br/>    static var previews: some View {<br/>        SwiftLeeViewRepresentable()<br/>    }<br/>}<br/>#endif</span></pre><p id="7f3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来分析一下。</p><p id="7282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从<code class="fe lv lw lx ly b">canImport</code>开始，它确保我们的项目仍然为没有最新Xcode版本的开发人员构建。他们可能还不能导入SwiftUI框架。</p><p id="1893" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们只为我们的调试配置导入SwiftUI框架，所以我们永远不会在发布的代码中导入该框架。</p><p id="fb0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">SwiftLeeViewRepresentable</code>是我们的包装器，它将我们的<code class="fe lv lw lx ly b">UIView</code>转换成SwiftUI <code class="fe lv lw lx ly b">View</code>。在<code class="fe lv lw lx ly b">makeUIView</code>方法中，我们基本上实例化了我们的视图控制器。此方法可用于实例化任何视图，包括自定义视图或从代码创建的视图控制器。</p><p id="1c57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们以实现<code class="fe lv lw lx ly b">PreviewProvider</code>协议的<code class="fe lv lw lx ly b">SwiftLeeViewController_Preview</code>结束。这将自动启用Xcode中的预览画布，它将实际显示预览。我们只需返回<code class="fe lv lw lx ly b">SwiftLeeViewRepresentable</code>实例就可以完成这项工作。我们还使用<code class="fe lv lw lx ly b">@available</code>代码来确保如果我们为调试配置改回OS版本，我们的代码仍然可以构建。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/71a9d4ac5d098a1b1413e1e7f56ded0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4y5cD-WhNMFgxU55.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有UIKit视图的Xcode预览</p></figure><p id="8c9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你唯一需要做的就是在开发的时候把你的项目设置切换到iOS 13.0。一旦你的用户界面完成，你可以切换回你支持的最低iOS版本。最好的办法是为您的发布版本设置这个版本。例如，当您支持iOS 11及更高版本时:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/78d7f5430a36dac3c4b23d562792fd95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Osng82V9JEPEMyBm.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Xcode中的操作系统版本设置</p></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="24ae" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="d80a" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">虽然工作流程要求您切换操作系统版本，但它允许您使用Xcode预览。这可以提高开发速度，并允许您在放弃iOS 12支持之前开始使用Xcode预览。</p></div></div>    
</body>
</html>