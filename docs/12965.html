<html>
<head>
<title>Embed a Unity Game in an iOS App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS应用程序中嵌入Unity游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/embed-a-unity-game-in-ios-app-7c2bd4cddb6f?source=collection_archive---------1-----------------------#2022-07-15">https://betterprogramming.pub/embed-a-unity-game-in-ios-app-7c2bd4cddb6f?source=collection_archive---------1-----------------------#2022-07-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f361" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">连接导出的Unity项目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e2fd8f8adf118ea9b183ac5870ccb230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YIQSpMCeR58DNCI3IewqMQ.jpeg"/></div></div></figure><p id="ed36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最近我遇到了一个任务，我必须将Unity AR模块嵌入到现有的iOS应用程序中。</p><p id="16a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">阅读Unity的文档后发现，自v2019.3以来，Unity通过其<a class="ae ln" href="https://unity.com/features/unity-as-a-library" rel="noopener ugc nofollow" target="_blank"> Unity as a Library </a>功能提供了从原生iOS或Android应用程序加载和卸载Unity游戏的支持。</p><p id="1102" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">尽管文档本身非常全面，但仍有一些地方遗漏了，这就是为什么我做了这个演练，让我们开始吧。</p><h1 id="b106" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">创建一个iOS项目</h1><p id="7f45" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">首先，在工作区中创建一个空的iOS项目。一个简单的方法是首先创建一个空的Xcode项目，然后转到<code class="fe ml mm mn mo b">File → Save As Workspace</code>。让我们将项目和工作空间都命名为<code class="fe ml mm mn mo b">SwiftUnity</code>。</p><p id="8b31" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">重要提示:确保您选择<code class="fe ml mm mn mo b">Storyboard</code>作为界面，即使您想使用SwiftUI，这些步骤也是必需的，因为它们是Unity集成工作的关键。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/52d5326542714077776dc80b8917eacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSGobOPpqifbY_rq6BKwog.png"/></div></div></figure><p id="c9a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请注意，如果您想进行SwiftUI项目，那么不要忘记将最低iOS部署目标设置为13.0。</p><h1 id="5be7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">设置Unity项目</strong></h1><p id="a813" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">因为我们在这里主要关注iOS，所以我不会深入解释Unity，而只会关注我们将从iOS应用程序中卸载Unity模块的部分。</p><p id="6911" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，我们需要遵循的一个重要步骤是在我们想要从Unity返回到我们的iOS应用程序的部分调用<code class="fe ml mm mn mo b"><a class="ae ln" href="https://docs.unity3d.com/ScriptReference/Application.Unload.html" rel="noopener ugc nofollow" target="_blank">Application.Unload()</a></code>。</p><p id="a1de" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">基本上，这个函数不会完全破坏unity实例，而是在内存中保留一些空间，这样，如果用户想要多次打开Unity模块，就不需要完全加载Unity模块，而是利用现有的保留内存。</p><p id="61bf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在假设在Unity模块中，您已经在想要关闭它的地方放置了一个退出点，并且该退出点与Unity模块中的某个按钮相关联。所以简单的调用<code class="fe ml mm mn mo b"><a class="ae ln" href="https://docs.unity3d.com/ScriptReference/Application.Unload.html" rel="noopener ugc nofollow" target="_blank">Application.Unload()</a></code>如下图所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="bb7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，一旦你完成以上步骤，打开Unity项目，进入<strong class="kt ir"> </strong>文件→构建设置。在这里，您需要将平台从PC、Mac &amp; Linux Standalone更改为iOS，然后单击切换平台按钮。你需要等待Unity重新编译。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/45d148bfb01ce76cf6d52032c87944fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWWvKyHvJTUxjqJWPJrNQg.png"/></div></div></figure><p id="1baa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">是时候将我们的Unity项目导出为iOS项目了。您不需要更改任何设置，只需单击Build。您将在名为<code class="fe ml mm mn mo b">UnityBuild</code>的文件夹中导出Unity项目。所以现在你的文件夹结构应该是这样的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/714abd6efa8094aef306ef47577a86ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvkWM7S2aHTDoDjs9-iS-Q.png"/></div></div></figure><h1 id="6df7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">在iOS中嵌入Unity</h1><p id="8ba2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">现在，当我们将导出的Unity项目与我们的iOS应用程序连接时，有趣的部分开始了。打开<code class="fe ml mm mn mo b">swiftUnity.xcworkspace</code>，它目前只包含<code class="fe ml mm mn mo b">SwiftUnity</code>项目。</p><p id="e530" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在Finder中，找到<code class="fe ml mm mn mo b">UnityExport</code>项目，将<br/> <code class="fe ml mm mn mo b">Unity-iPhone.xcodeproj</code>文件拖拽到工作区。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/6a57ef724db2b05ab5a08e3791240cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h14lW4EyG-scNXHbxb8zRw.png"/></div></div></figure><p id="2689" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在<code class="fe ml mm mn mo b">swiftUnity.xcodeproj</code>和<code class="fe ml mm mn mo b">Unity-iPhone.xcodeproj</code>都属于同一个工作空间。接下来，点击<code class="fe ml mm mn mo b">swiftUnity</code>项目并选择swiftUnity目标。</p><p id="17f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从常规菜单中，向下滚动到框架、库和嵌入式内容部分。单击+按钮添加一个新框架。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/61f3c1ef364c3bffdf48d13ade68e09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74jGUKBZYRjf9USzno_4DQ.png"/></div></div></figure><p id="193c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从列表中选择<code class="fe ml mm mn mo b">UnityFramework.framework</code>并将其添加到项目中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/024e73c450cf022749543fa1e80cea59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sC-dRPuwOZQpesa5UG9Chg.png"/></div></div></figure><p id="0ace" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，选择<code class="fe ml mm mn mo b">Unity-iPhone</code> <strong class="kt ir"> </strong>项目中的<code class="fe ml mm mn mo b">Data</code>文件夹。在右边的面板中，你会看到一个<strong class="kt ir"> </strong>的“目标成员”部分。您需要勾选<code class="fe ml mm mn mo b">UnityFramework</code>旁边的复选框。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/3ce4814496c7987cd459eba25ce0e197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2oFBuoKx5PqKC1W9Kpdvqw.png"/></div></div></figure><p id="056c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，打开<code class="fe ml mm mn mo b">Info.plist</code>并移除<code class="fe ml mm mn mo b">Application Scene Manifest</code>入口。这将暂时中断应用程序，但我们将在稍后的<code class="fe ml mm mn mo b">AppDelegate</code>中解决它。如果您跳过这一步，那么一旦unity实例启动，您将无法返回到您的iOS应用程序(调用<code class="fe ml mm mn mo b">Application.Unload()</code>)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/f5046e066477a543b167159ba1c65e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5w2GkVCBQ_AkXbCKgXAqA.png"/></div></div></figure><p id="7acb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在在<code class="fe ml mm mn mo b">swiftUnity</code> <strong class="kt ir"> </strong>中创建一个swift文件，命名为Unity。将以下代码添加到该文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="2f89" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">打开<code class="fe ml mm mn mo b">AppDelegate.swift</code>并移除所有与场景相关的功能。我们还需要在这里传递对Unity的主应用程序窗口引用，因为这是我们卸载Unity游戏后将返回的窗口。</p><p id="d829" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">经过这些修改后，您的<code class="fe ml mm mn mo b">AppDelegate</code>应该是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="1f3c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，在您现有的Xcode项目中，转到您想要打开unity模块的部分，在我的情况下，我将简单地在故事板上放置一个按钮，并打开unity模块以打开它的<code class="fe ml mm mn mo b">IBAction</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="fab7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这样，现在是运行和测试应用程序的时候了。</p><p id="5e83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">常见问题:如果Xcode在完成上述所有步骤后仍无法构建项目，并给出错误提示<em class="my">“没有这样的模块unity framework”</em>，那么只需从上面选择<code class="fe ml mm mn mo b">UnityFramework</code>并按下<code class="fe ml mm mn mo b">⌘+B</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/ee9bf1dc592925d745e3ba554d3a80bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ogzTuWDAQnHcdEYOU8QRFw.png"/></div></div></figure><p id="bca4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦完成，然后选择<code class="fe ml mm mn mo b">Unity-iPhone</code>并做同样的事情，最后选择回你的iOS项目，即<code class="fe ml mm mn mo b">swiftUnity</code>在我们的情况下，并运行该项目。</p><p id="3e4c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">另一个需要记住的重要事项是在真实设备上运行项目，而不是在模拟器上。</p><h1 id="9bc7" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">最后外观</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/b14acc76ccc6960f50bacf4844ee9759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1aDbwI2FaCK94M3bDIatjw.gif"/></div></div></figure></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ni"><a href="https://github.com/mh-ahmediqbal/embed-unity" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">GitHub-MH-Ahmed Iqbal/embed-unity:如何在iOS应用中嵌入unity的演练</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">我们如何在iOS应用中嵌入unity的演练。为了更好地理解，请点击下面的链接</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw kp ni"/></div></div></a></div></div></div>    
</body>
</html>