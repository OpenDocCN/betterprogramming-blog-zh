<html>
<head>
<title>Build Facebook-Like Placeholder Loaders in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Native中构建类似脸书的占位符加载器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-facebook-like-placeholder-loaders-in-react-native-674a5498ca7f?source=collection_archive---------2-----------------------#2020-02-19">https://betterprogramming.pub/build-facebook-like-placeholder-loaders-in-react-native-674a5498ca7f?source=collection_archive---------2-----------------------#2020-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e354" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用rn-placeholder在React本机应用程序中使用占位符加载器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fdd4722fbc2d69136a897b78e9fb51d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o39sgHEEyVGwq3KT4dBpvg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="20db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">良好的用户体验是一款优秀应用与普通应用的区别。用户希望他们的应用程序非常快，因为没有人喜欢等待。在构建移动应用程序时，我们经常使用加载器、进度条和加载指示器来告诉用户某件事情正在发生或正在加载。</p><p id="8a18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最新的趋势是将占位符/框架屏幕显示为加载器。这种使用占位符的模式改善了用户在等待加载时的感知体验。你可能在脸书和网飞这样的应用中见过这种加载器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/453f59373f4a8b1a9f387432ade55e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*Pc-gJnoAYxQW75r9cjIoPg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网飞装载机应用程序</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6d54" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">React Native中的加载程序</h1><p id="f116" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在大多数情况下，使用好的ol' <code class="fe mx my mz na b"><a class="ae kv" href="https://facebook.github.io/react-native/docs/activityindicator" rel="noopener ugc nofollow" target="_blank">ActivityIndicator</a></code>和<a class="ae kv" href="https://facebook.github.io/react-native/" rel="noopener ugc nofollow" target="_blank"> React Native </a>模态就足够了。然而，作为一个用户和开发者，我发现它们太平凡和过时了。</p><p id="94f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了让这些加载器变得有趣，我创建了一个React原生包，它使用Airbnb的<a class="ae kv" href="https://airbnb.io/lottie/" rel="noopener ugc nofollow" target="_blank"> Lottie </a>和<code class="fe mx my mz na b"><a class="ae kv" href="https://facebook.github.io/react-native/docs/modal#docsNav" rel="noopener ugc nofollow" target="_blank">Modals</a></code>来创建漂亮的动画加载器。如果你想了解更多关于如何使用它的信息，请阅读这篇文章。</p><p id="09dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将学习如何使用<code class="fe mx my mz na b"><a class="ae kv" href="https://github.com/mfrachet/rn-placeholder" rel="noopener ugc nofollow" target="_blank">rn-placeholder</a></code>库实现占位符屏幕。我们还将使用<a class="ae kv" href="https://developers.google.com/books" rel="noopener ugc nofollow" target="_blank"> Google Books API </a>来获取一些图书数据。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="4790" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">先决条件</h1><p id="8053" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">要学习本教程，请确保您在本地开发环境中安装了以下软件，并且能够访问下面提到的服务:</p><ul class=""><li id="28b5" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated"><a class="ae kv" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a> ( &gt; =8.x.x)安装了npm/Yarn。</li><li id="0668" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">世博景观 ( &gt; =3.0.4)</li></ul><p id="990d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有一段时间没有更新<code class="fe mx my mz na b">expo-cli</code>，请确保更新，因为<code class="fe mx my mz na b">expo</code>版本很快就会过时。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="9d69" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">入门指南</h1><p id="a95a" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">让我们使用expo-cli建立一个新的Expo项目。</p><pre class="kg kh ki kj gt np na nq nr aw ns bi"><span id="080d" class="nt mb iq na b gy nu nv l nw nx">$ expo init placeholderLoading</span></pre><ol class=""><li id="5a9f" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ny nh ni nj bi translated">选择空白模板，点击<code class="fe mx my mz na b">Enter</code>。</li><li id="555e" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ny nh ni nj bi translated">然后它会要求你命名项目，输入<code class="fe mx my mz na b">PlaceholderLoading</code>并再次点击<code class="fe mx my mz na b">Enter</code>。</li><li id="5535" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ny nh ni nj bi translated">最后，它会要求您按下<code class="fe mx my mz na b">Y</code>来安装与<code class="fe mx my mz na b">yarn</code>的依赖关系，或者按下<code class="fe mx my mz na b">n</code>来安装与<code class="fe mx my mz na b">npm</code>的依赖关系。按下<code class="fe mx my mz na b">y</code>。</li></ol><p id="d681" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将使用expo-cli创建一个新的React本机应用程序。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="5e20" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">运行应用程序并安装依赖项</h1><p id="8f88" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">进入我们刚刚创建的项目目录:</p><pre class="kg kh ki kj gt np na nq nr aw ns bi"><span id="fb08" class="nt mb iq na b gy nu nv l nw nx">$ cd placeholderLoading</span></pre><p id="9399" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行项目类型:</p><pre class="kg kh ki kj gt np na nq nr aw ns bi"><span id="b768" class="nt mb iq na b gy nu nv l nw nx">$ yarn start</span></pre><p id="31c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按<code class="fe mx my mz na b">i</code>运行iOS模拟器。这将自动运行iOS模拟器，即使它没有打开。</p><p id="03d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按<code class="fe mx my mz na b">a</code>运行Android模拟器。注意，在输入<code class="fe mx my mz na b">a</code>之前，模拟器必须已经安装并启动，否则它将在终端中抛出一个错误。</p><p id="87c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以从App Store安装<code class="fe mx my mz na b">expo</code>应用程序，然后扫描二维码，在您的设备中运行该应用程序。</p><p id="6bed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，安装<code class="fe mx my mz na b">rn-placeholder</code>和<code class="fe mx my mz na b">react-native-responsive-dimensions</code>包。</p><pre class="kg kh ki kj gt np na nq nr aw ns bi"><span id="0201" class="nt mb iq na b gy nu nv l nw nx">$ yarn add rn-placeholder react-native-responsive-dimensions</span></pre><p id="5732" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在呈现我们的文本或媒体内容之前，<code class="fe mx my mz na b">rn-placeholder</code>将帮助我们显示一些占位符。</p><p id="85db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且，<code class="fe mx my mz na b">react-native-responsive-dimensions</code>将为我们提供一个响应高度和宽度，它将根据设备的屏幕大小自动调整。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="d221" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">创建组件</h1><p id="36fd" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在我们将创建两个组件，<code class="fe mx my mz na b">BookCardComponent</code>和<code class="fe mx my mz na b">BookCardPlaceholderComponent</code>。</p><p id="ef3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是<code class="fe mx my mz na b">BookCardComponent</code>的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">BookCardComponent</p></figure><p id="8ece" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mx my mz na b">BookCardPlaceholderComponent</code>的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="41f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最初将呈现<code class="fe mx my mz na b">BookCardPlaceholderComponent</code>,直到我们从Google Books API接收数据，在接收数据后，我们将使用<code class="fe mx my mz na b">BookCardComponent</code>来呈现图书数据。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="c1f9" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">更新App.js</h1><p id="a51f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们将在本教程中使用React <a class="ae kv" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">钩子</a>,但是你可以很容易地将其转换成类。</p><p id="1541" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将以下代码添加到您的<code class="fe mx my mz na b">App.js</code>中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="dd64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们使用<code class="fe mx my mz na b">useState</code>钩子设置一些初始状态。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="3183" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mx my mz na b">books</code>状态中，我们将更新从API接收到的所有书籍，对于初始状态，我们创建了一个由十个空对象组成的数组。</p><p id="ca1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还初始化了<code class="fe mx my mz na b">isDataFetched</code>状态，并将其初始值设置为<code class="fe mx my mz na b">false</code>。它将用于跟踪从API接收的数据的状态。当我们接收到数据并完成数据操作后，我们将使用<code class="fe mx my mz na b">setDataFetched</code>将其值设置为<code class="fe mx my mz na b">true</code>。</p><p id="74af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一步，我们将使用<code class="fe mx my mz na b">useEffect</code>钩子来调用Google Books API，并用收到的数据更新我们各自的状态。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="9e78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在返回时，我们将利用<code class="fe mx my mz na b">isDataFetched</code>状态有条件地呈现组件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="2518" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mx my mz na b">renderX()</code>中，我们将返回一个<code class="fe mx my mz na b">FlatList</code>，它将使用<code class="fe mx my mz na b">renderBookComponent</code>呈现图书列表。</p><p id="edc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mx my mz na b">renderPlaceholders()</code>中，我们将使用贴图功能渲染<code class="fe mx my mz na b">BookCardPlaceholder</code>。这是用户在数据获取期间将看到的内容。</p><p id="5144" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以在取数据时，<code class="fe mx my mz na b">BookCardPlaceholder</code>会被渲染，当数据取成功后，<code class="fe mx my mz na b">FlatList</code>会渲染<code class="fe mx my mz na b">BookCardComponent</code>。</p><p id="60a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是最终应用程序的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/170acacff4a9a3999f143c973e568895.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*0XKsTwYZi0eIU5101DWCqw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">占位符加载器</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6a38" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="6c36" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们已经成功创建了一个React原生应用程序，它使用<code class="fe mx my mz na b">rn-placeholder</code>在数据获取期间将占位符显示为加载器，就像脸书、网飞和其他流行的应用程序一样。</p><p id="baad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这只是占位符屏幕作为加载器的一个简单实现。您可以根据自己的需求或应用程序主题自定义这些占位符组件。</p><ul class=""><li id="5e14" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">在GitHub repo 中找到源代码<a class="ae kv" href="https://github.com/vikrantnegi/react-native-placeholder-loading" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="2c67" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">我还创建了一个开源的图书搜索React原生应用程序，其中我使用了这些占位符组件作为加载器。在GitHub 上随意看看它的源代码<a class="ae kv" href="https://github.com/vikrantnegi/RN-Book-Search" rel="noopener ugc nofollow" target="_blank">。</a></li></ul></div></div>    
</body>
</html>