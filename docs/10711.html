<html>
<head>
<title>5 Tips to Solve Common Pitfalls With React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native解决常见问题的5个技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-tips-to-solve-common-pitfalls-with-react-native-fcf66772b4b7?source=collection_archive---------6-----------------------#2022-01-24">https://betterprogramming.pub/5-tips-to-solve-common-pitfalls-with-react-native-fcf66772b4b7?source=collection_archive---------6-----------------------#2022-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="93f6" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">对本地发展作出反应</h2><div class=""/><div class=""><h2 id="b6f5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用React Native构建移动应用时遇到的常见问题以及我如何解决这些问题</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4c4c1ff7ffff303973fdee378ff403ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1LypqXflttE33gyb2s2dA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">使用React Native解决常见问题的5个技巧</p></figure><p id="7be2" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">近年来，移动开发的世界已经扩大，从Android和Swift开发人员的专利发展到Javascript的快节奏世界，混合框架如Ionic或原生框架如React Native。</p><blockquote class="ma mb mc"><p id="4542" class="le lf md lg b lh li ka lj lk ll kd lm me lo lp lq mf ls lt lu mg lw lx ly lz ij bi translated">React Native是由Meta Platforms，Inc .创建的开源UI软件框架。它通过使开发人员能够使用React框架和本机平台功能，用于开发适用于Android、Android TV、iOS、macOS、tvOS、Web、Windows和UWP的应用程序。</p></blockquote><p id="795a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">使用React Native时，您可能会遇到难以解决或找到答案的问题，主要是因为React Native社区和生态系统没有React或Vue等其他Javascript社区大。</p><p id="5df6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在本文中，您将从我的经验中学到我是如何解决一些常见的React原生问题或实现一些棘手的特性的。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="b778" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">1.苹果连接商店截图</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/f4c5166c32a434175d2bb0fa6689e78b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nvD-bvyAAGdBYr4DdOfIBg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Apple Store审核流程</p></figure><p id="d658" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当使用React Native构建应用程序时，您可能会使用模拟器来测试您的应用程序，而不是物理设备。</p><p id="227f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">像我一样，你可能会惊讶于使用Xcode Simulator为App Store创建大小和密度合适的截图有多么困难。</p><p id="899b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在Google Play中，这个过程很简单，上传你在任何模拟器中制作的截图都很棒，但对于苹果商店，我无法获得正确的尺寸。</p><p id="a5bd" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于6.5英寸的iPhone，他们要求要么是<code class="fe nh ni nj nk b">2688x1242</code>要么是<code class="fe nh ni nj nk b">2778x1284</code>。我尝试了各种选项和设备模拟器来实现这一点…但没有成功。最后，我在这里找到了正确答案<a class="ae nl" href="https://stackoverflow.com/a/58461416" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="b2d1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是你必须做的:</p><ul class=""><li id="5cd2" class="nm nn iq lg b lh li lk ll ln no lr np lv nq lz nr ns nt nu bi translated">将模拟器设置为物理大小:窗口&gt;物理大小(快捷键:command + 1)</li><li id="7cce" class="nm nn iq lg b lh nv lk nw ln nx lr ny lv nz lz nr ns nt nu bi translated">设置高质量图形:调试&gt;图形质量覆盖&gt;高质量</li><li id="f43b" class="nm nn iq lg b lh nv lk nw ln nx lr ny lv nz lz nr ns nt nu bi translated">对于6.5英寸的iPhone，请使用任何专业版iPhone。我用了11 Pro</li><li id="8045" class="nm nn iq lg b lh nv lk nw ln nx lr ny lv nz lz nr ns nt nu bi translated">对于5.5英寸的iPhone，请使用iPhone 8+模拟器。</li><li id="2157" class="nm nn iq lg b lh nv lk nw ln nx lr ny lv nz lz nr ns nt nu bi translated">对于Ipad Pro(第三代/第二代)，请使用模拟器iPad Pro (12.9英寸) (第三代)</li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="64cc" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">2.字体的问题</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/a6c90aa1082d6608f3ea81d49957eb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fjob-rbx4eX2UbyV"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae nl" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae nl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="ff3d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">默认情况下，React Native使用每个平台的标准字体，这意味着Android的“Roboto”和iOS的“San Francisco”。然而，设计师通常喜欢使用不同的字体来适应应用程序的整体设计。</p><p id="69b4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你运气好，字体是谷歌字体，那就太好了！你可以使用包<a class="ae nl" href="https://github.com/expo/google-fonts" rel="noopener ugc nofollow" target="_blank"> expo-google-fonts </a>。</p><p id="377e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">安装包之后，<code class="fe nh ni nj nk b">expo install expo-google-fonts</code>，你要做的就是:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="f2d9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这里，我们导入字体，并确保在启动应用程序之前加载它们，然后您可以像这样轻松地在样式表中使用它:</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="3fb2" class="oh mp iq nk b gy oi oj l ok ol">fontFamily: 'Lato_400Regular'</span></pre><p id="1d58" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我在使用<code class="fe nh ni nj nk b">expo-google-fonts</code>时遇到的一个问题是，当我错误地导入整个项目时，它加载了所有的字体，而不仅仅是拉托字体，就像这样:</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="4f63" class="oh mp iq nk b gy oi oj l ok ol">import { Lato_400Regular } from '@expo-google-fonts/dev';</span></pre><p id="4635" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这在web-view或Android模拟器上没有问题，但对于iPhones来说，它会试图一次加载所有字体，并且会因为内存限制而导致应用程序崩溃。</p><p id="31bc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，请确保只导入您需要的字体，如下所示:</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="4974" class="oh mp iq nk b gy oi oj l ok ol">import { Lato_400Regular } from '@expo-google-fonts/lato';</span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="4c22" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">3.移动设备上的本地存储和Cookies</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/2e7c18e352eb2fb8d439aaccd5c74f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1yeNkbWISGDc3P3m"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae nl" href="https://unsplash.com/@starvingartistfoodphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯蒂娜·布兰科</a>在<a class="ae nl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="10a6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于有前端编程背景，我习惯于滥用cookies和本地存储来做几乎任何事情。</p><p id="0a1e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">需要保存一些用户信息以备后用？饼干！这个几乎不变的请求怎么办…我可以在哪里缓存它？本地存储！</p><p id="4f8c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">所以在这里，我认为这是理所当然的，并将用于授权的不记名令牌和用户信息对象添加到本地存储中。只有当我开始在模拟器中测试时，我才意识到令牌没有被持久化，并且我用一个空的承载字符串来发出每个请求。</p><p id="34e5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">快速的互联网搜索让我找到了在这种情况下最常用的包:<a class="ae nl" href="https://github.com/react-native-async-storage/async-storage" rel="noopener ugc nofollow" target="_blank">react-native-async-storage/async-storage</a>。</p><p id="3569" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">安装完这个包后，<code class="fe nh ni nj nk b">expo install <a class="ae nl" href="https://github.com/react-native-async-storage/async-storage" rel="noopener ugc nofollow" target="_blank">react-native-async-storage/async-storage</a></code>使用它就像普通的本地存储一样简单。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="ad6f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">密切关注<code class="fe nh ni nj nk b">JSON.stringify()</code>和<code class="fe nh ni nj nk b">JSON.parse()</code>功能。如果你试图将JSON而不是字符串传递给<code class="fe nh ni nj nk b">AsyncStorage.setItem()</code>函数，你的应用程序仍然可以在网络上运行，甚至可以在模拟器上运行，但是它会破坏你的应用程序。</p><p id="b8d7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">调试这个问题可能会很麻烦，所以快速检查默认的stringify和parse可能会成为一种很好的做法，可以让您在将来免受痛苦。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="222e" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">4.呈现HTML</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/d025486a625f698aa91d6bdc0d880f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cMxYFIQV44nFZUB0TgbKrQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">HTML示例</p></figure><p id="6370" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你可以在你的应用程序中硬编码文本，但是当你想改变文本时，你必须为你的应用程序创建新的版本，并再次提交到应用程序商店。</p><p id="3223" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">更糟糕的是，一些用户可能会禁用你的应用程序的自动更新，并且永远不会获得新版本。为了克服这一点，你应该总是通过API发送不常用的文本。</p><p id="c250" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是，即使您通过一些请求发送文本，动态内容又如何呢？如果你有描述丰富的文章或内容怎么办？在你的后端，你可能有一个丰富的文本编辑器，所以你可以添加标题和格式化你的文本，但在应用程序中，你需要一种方法来呈现HTML到本地视图。</p><p id="04eb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为此，你可以使用<a class="ae nl" href="https://github.com/meliorence/react-native-render-html" rel="noopener ugc nofollow" target="_blank"> react-native-render-html </a>。一个iOS/Android纯javascript react-native组件，将您的HTML呈现为100%原生视图。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="d847" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">使用它非常简单。它还有一个注入你字体的道具叫做<code class="fe nh ni nj nk b">systemFonts</code>，如上图。</p><p id="4b0b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">属性可以用来设计HTML内容的样式。<a class="ae nl" href="https://codesandbox.io/s/thirsty-payne-j5ect?file=/src/App.js" rel="noopener ugc nofollow" target="_blank">这里有一个简短的演示</a>来看看它的实际效果。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="5879" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">5.短路评估(&amp;&amp;)</h1><p id="d523" class="pw-post-body-paragraph le lf iq lg b lh oo ka lj lk op kd lm ln oq lp lq lr or lt lu lv os lx ly lz ij bi translated">我在React生态系统中犯的一个错误是在渲染组件时过度依赖&amp;&amp;操作符。</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="38cf" class="oh mp iq nk b gy oi oj l ok ol">{isFetching &amp;&amp; &lt;Loading /&gt;}</span></pre><p id="055d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这种方法非常有效，直到我犯了一个错误，使用非布尔值作为第一个操作数，就像这样:</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="8932" class="oh mp iq nk b gy oi oj l ok ol">{users.length &amp;&amp; &lt;User /&gt;}</span></pre><p id="70ef" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这在normal React中工作得很好，在项目的web视图中完全没有中断，更糟糕的是，它还在Android和iOS的模拟器上工作。</p><p id="34b4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是在生产中，每当用户使用这种逻辑输入视图时，应用程序就会崩溃，并显示以下错误:</p><pre class="kp kq kr ks gt od nk oe of aw og bi"><span id="3f3b" class="oh mp iq nk b gy oi oj l ok ol">Error: Text strings must be rendered within a &lt;Text&gt; component.</span></pre><p id="e58b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这是有意义的，如果你的<code class="fe nh ni nj nk b">users</code>数组大于0，React Native想要渲染数字，因为它不在<code class="fe nh ni nj nk b">&lt;Text&gt;</code>组件中，它会破坏应用程序。</p><p id="f892" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我建议在使用逻辑运算符<code class="fe nh ni nj nk b">&amp;&amp;</code>来简化呈现时要小心，尤其是在处理非字符串值时。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="fb88" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，React Native社区正在成长，有很多好的软件包可以帮助你。</p><p id="74dc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是它还没有达到Javascript的名气水平，这可以从可用资源的数量上看出来。</p><p id="bfb5" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我真诚地希望这篇文章能够帮助有抱负的React本地开发人员解决他们的困难，或者说服React生态系统的工程师们尝试并构建几个移动应用程序。</p></div></div>    
</body>
</html>