# 用元组优化你的 Python 程序

> 原文：<https://betterprogramming.pub/optimize-your-python-programs-with-tuples-704f176c956d>

## Python 中列表与元组的对比研究。哪个效率更高，什么时候用？

![](img/cdaba6d0a0efd7fc55ddc855f3a692f0.png)

照片由[斯潘塞·戴维斯](https://unsplash.com/@spencerdavis?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

尽管 Python 因其简单而成为最受欢迎的编程语言之一，但它也因相对缓慢和低效而闻名。它灵活的规则允许你轻松地编写出令人印象深刻的软件，但是同样的灵活性也会导致你编写出非常低效的代码。

特别是，Python 的语法没有强制任何编码风格，也没有对解决特定问题的方法施加任何限制。此外，Python 开发人员通常不会学习底层优化，因为一切都被抽象掉了。

在 Python 中存储一组数据最常见的方式是使用列表。

这在构建原型时或者如果那些列表在程序运行时只被访问几次时是可以的。另一方面，如果在关键函数中使用错误的项集合类型，您的代码会变得不必要的慢。

# Python 对象大小

正如你们大多数人可能知道的，在 Python 中一切都是作为对象的。这意味着您不能像在 c 等低级语言中那样处理原始数据类型，正因为如此，Python 对象占用的内存比它们保存的值多。

控制台输出:

```
0:            24 bytes
1:            28 bytes
1.0:          24 bytes
555555555555: 32 bytes
```

如您所见，它们的大小比它们存储的实际值大得多。这是因为 Python 对象还包含对提供类型功能的方法和其他属性的引用。

回到列表，它们还为您提供了与它们交互的方法和操作符。这些属性显然会占用一些空间，但是在大多数情况下，它们中的大多数都不会被访问。例如，如果您不需要在程序中修改列表，就没有必要包含这样做的方法。在这种情况下，您还不如使用不可变的集合类型。

# 元组有什么不同？

Python 元组本质上是列表，但它们是不可变的。这意味着您不能更改元组的元素，添加或删除任何元素。如果您尝试为一个项目分配不同的值，您会得到一个错误:

```
>>> t = (1,2,3)
>>> t[0] = 4TypeError: 'tuple' object does not support item assignment
```

元组对象不实现改变它们的方法，所以它们实际上需要更少的内存来存储。下面是列表和元组在大小方面的快速比较:

控制台输出:

```
Empty list:   72 bytes
Filled list: 112 bytesEmpty tuple:  56 bytes
Filled tuple: 96 bytes
```

如您所见，元组占用的内存比列表少得多。准确地说，空列表比元组多需要 16 个字节。此外，如果要向集合中添加任何新元素，Python 可能会分配比严格必要的内存更多的内存，以避免调整大小。

# 速度性能优势

与列表相比，元组不仅在内存需求方面更有效，而且还提供了速度优势。事实上，他们的访问时间比他们的对手快得多。

控制台输出:

```
Lists average: 0.0020666594509384595 seconds
Tuples average: 0.0014251830289140344 seconds
Tuples are on average 1.4501 (~69%) times faster than lists
```

正如您所看到的，性能提升非常显著。现在，想象一下，如果您必须每秒多次访问您的集合的元素，您将节省多少时间。

# 元组的用例

现在很清楚，元组比列表更有性能。只要你事先知道集合在程序运行时不会改变，就应该用它们来代替列表。以下是元组的一些真实用例:

*   常数分组表。因为常量永远不会改变，所以将它们存储在不可变的数据结构中是有意义的。

*   不可变的复合对象。如果你不打算改变一个对象的列表属性，你也可以用一个元组来代替它。

*   临时只读集合。如果一个集合只被迭代一次，并且没有发生变化，那么最好使用元组。

# 结论

总而言之，Python 是一种非常灵活的语言，提供了各种各样的工具。问题是，它没有实施好的实践，导致开发人员在效率方面陷入坏习惯。

主要的要点是，尽可能在列表中使用元组，以避免不必要的内存和运行时开销。

> 生活中没有放之四海而皆准的方法。归根结底，就是使用正确的工具完成正确的工作。

我希望你喜欢这篇文章。如果您对程序的进一步优化感兴趣，我强烈建议您查看我关于 Python 的 C 扩展的文章:

[](/speed-up-your-python-codebases-with-c-extensions-94859875eb70) [## 用 C 扩展加速你的 Python 代码库

### 给你的 Python 程序带来 C 语言的速度

better 编程. pub](/speed-up-your-python-codebases-with-c-extensions-94859875eb70) 

感谢阅读！