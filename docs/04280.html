<html>
<head>
<title>Undoing in Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Git中撤消</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/undoing-in-git-39e4404c0e92?source=collection_archive---------14-----------------------#2020-04-02">https://betterprogramming.pub/undoing-in-git-39e4404c0e92?source=collection_archive---------14-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d68c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何改正你的错误</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/291cf523c0387ec147c9a4d1fd6b0fd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aiI_EUnCEd5wqMrN"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@dlanor_s?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">德拉诺尔S </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="9f27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们总是强调<a class="ae ky" href="https://www.w3docs.com/learn-git.html" rel="noopener ugc nofollow" target="_blank"> Git </a>为你提供的无数机会，今天的文章也不例外。Git以其撤销几乎所有事情的超级神奇能力而闻名！你可能还记得成千上万个悲伤的案例，在这些案例中，你合并了，然后意识到你并不是有意这样做的。即使你认为误合并是人生最大的失败，也要深呼吸，把文章读完。</p><p id="97cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，Git中没有传统的撤销命令。撤销是通过其他一些命令完成的，这将是本文的主题。我们将涵盖五大撤销案例，帮助你改正错误，继续前进！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0b62" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">撤销Git添加</strong></h1><p id="562c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Git社区中最常见的问题之一是“如何在提交前撤销<code class="fe mz na nb nc b">git add</code>”您可以撤消单个文件或所有更改。</p><p id="201c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这需要一个超级简单的解决方案。要撤销单个文件，只需调用<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-reset.html" rel="noopener ugc nofollow" target="_blank">git reset</a></code>命令:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2571" class="nh md it nc b gy ni nj l nk nl">git reset &lt;file&gt;</span></pre><p id="a1eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要撤消所有更改，请运行以下命令:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="d1de" class="nh md it nc b gy ni nj l nk nl">git reset</span></pre><p id="d7c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你提交得太早而忘记添加更多的文件，撤销是不可避免的。在这种情况下，使用<code class="fe mz na nb nc b">amend</code>命令进行更改、暂存并再次提交。查看<a class="ae ky" href="https://www.w3docs.com/snippets/git/how-to-undo-git-add.html" rel="noopener ugc nofollow" target="_blank">如何撤销Git Add </a>片段，了解修改是如何完成的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a117" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">如何撤销Git合并</strong></h1><p id="3024" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">合并会让你陷入不必要的境地。但是正如我们已经告诉你的，你可以很容易地改正你的错误！让我们想象一个场景，其中您已经提交了您的更改，并意识到您必须撤销该合并。</p><p id="41e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">又来了一个撤销型命令——<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-revert.html" rel="noopener ugc nofollow" target="_blank">git revert</a></code>。首先使用<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-checkout.html" rel="noopener ugc nofollow" target="_blank">git checkout</a></code>检查主文件:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="f53d" class="nh md it nc b gy ni nj l nk nl">git checkout master</span></pre><p id="db24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是运行<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-log.html" rel="noopener ugc nofollow" target="_blank">git log</a></code>来获取合并提交的ID:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="a99b" class="nh md it nc b gy ni nj l nk nl">git log</span></pre><p id="bba6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后通过如下操作恢复提交:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2dfe" class="nh md it nc b gy ni nj l nk nl">git revert -m 1 &lt;merge-commit&gt;</span></pre><p id="b231" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您命令Git使用<code class="fe mz na nb nc b"> -m 1</code>恢复到主分支合并提交的第一个父级。例如，<code class="fe mz na nb nc b">-m 2 </code>将使Git恢复到最初合并的第一个父级。</p><p id="9ba9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，请阅读这个代码片段来了解<a class="ae ky" href="https://www.w3docs.com/snippets/git/how-to-undo-git-merge.html" rel="noopener ugc nofollow" target="_blank">如何撤销未推送的Git合并</a>。</p><p id="95ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Git还建议<a class="ae ky" href="https://www.w3docs.com/snippets/git/how-to-preview-a-merge-in-git.html" rel="noopener ugc nofollow" target="_blank">预览opportunity </a>，以防你想知道当你合并分支时会发生什么。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cc6e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">如何撤销Git复位</strong></h1><p id="db18" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这里，我们建议一个超短的方法来解开<code class="fe mz na nb nc b">git reset</code>:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="a202" class="nh md it nc b gy ni nj l nk nl">git reset ‘HEAD@{1}’</span></pre><p id="6165" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以运行<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-reflog.html" rel="noopener ugc nofollow" target="_blank">git reflog</a></code>命令来查看所有引用更新的日志(例如，检出、重置、提交、合并):</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="9b85" class="nh md it nc b gy ni nj l nk nl">git reflog</span></pre><p id="51e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看一个简单的用例。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="26e1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">撤销Git中最近的提交</strong></h1><p id="73a3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有几种方法可以解开<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-commit.html" rel="noopener ugc nofollow" target="_blank">git commit</a></code>。让我们逐一考虑一下。</p><p id="6eab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mz na nb nc b">git reset</code>命令可用于撤销您的更改:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="5ca3" class="nh md it nc b gy ni nj l nk nl">git reset — soft HEAD~x (or git reset — soft commit hash).</span><span id="5020" class="nh md it nc b gy nm nj l nk nl">git reset — soft HEAD~x</span></pre><p id="4255" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">键入一个数字而不是<code class="fe mz na nb nc b">~x</code>。例如，如果指定<code class="fe mz na nb nc b">~4</code>，该命令将影响倒数第四个提交。如果不指定任何数字，<code class="fe mz na nb nc b">git reset — soft HEAD</code>将改变最近一次提交。</p><p id="4dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您使用<code class="fe mz na nb nc b">git reset — soft HEAD</code>命令时，您只需撤销最后一次提交，但是您所做的更改将被存储在您的工作树和索引中。所以<code class="fe mz na nb nc b">git commit</code>将会创建一个提交，其中包含与您之前“撤销”的提交相同的更改。</p><p id="5f8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种方法是<code class="fe mz na nb nc b">git revert HEAD~x</code> ( <code class="fe mz na nb nc b">git reset — hard commit hash</code>)命令，该命令恢复由<code class="fe mz na nb nc b">HEAD</code>中最后一次提交指定的更改，并使用恢复的更改创建新的提交:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="e3e3" class="nh md it nc b gy ni nj l nk nl">git revert HEAD ~x</span></pre><p id="1c02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用公共共享存储库时，这种方法是最好的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3097" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">撤销Git重置基础</strong></h1><p id="6beb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">假设您已经在本地<a class="ae ky" href="https://www.w3docs.com/learn-git/git-branch.html" rel="noopener ugc nofollow" target="_blank"> git分支</a>上执行了<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.w3docs.com/learn-git/git-rebase.html" rel="noopener ugc nofollow" target="_blank">git rebase</a></code>命令，并将其推送到远程。然后你意识到这不是你所期望的，现在你必须撤销它。</p><p id="6f9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最简单的方法是通过运行以下命令找到分支的head commit:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="91d1" class="nh md it nc b gy ni nj l nk nl">git reflog</span></pre><p id="e9d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，需要使用<code class="fe mz na nb nc b">git reset</code>重置当前分支。确保在运行带有<code class="fe mz na nb nc b">— hard</code>选项的<code class="fe mz na nb nc b">git reset</code>命令之前，如下所示:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2d91" class="nh md it nc b gy ni nj l nk nl">git reset — hard HEAD@{5}</span></pre><p id="bbef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，老犯是<code class="fe mz na nb nc b">HEAD5</code>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ca72" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="ce87" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这就是如何撤销Git中最常用的命令。虽然没有传统的撤销命令，但其他git命令可以帮助您撤销误操作。</p><p id="ce91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看更多的<a class="ae ky" href="https://www.w3docs.com/learn-git.html" rel="noopener ugc nofollow" target="_blank"> git命令</a>和<a class="ae ky" href="https://www.w3docs.com/snippets/git.html" rel="noopener ugc nofollow" target="_blank">片段</a>，进入git世界探索新想法！</p></div></div>    
</body>
</html>