<html>
<head>
<title>Enhance Your React App With Undo and Reset Abilities</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用撤销和重置功能增强React应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/enhance-your-react-app-with-undo-and-reset-abilities-cee6f37af0d9?source=collection_archive---------2-----------------------#2019-06-24">https://betterprogramming.pub/enhance-your-react-app-with-undo-and-reset-abilities-cee6f37af0d9?source=collection_archive---------2-----------------------#2019-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="672e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">增强用户能力</h2><div class=""/><div class=""><h2 id="31f6" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">现在是让React做大事的时候了</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/458ab8f9b0c4824addf62f6d11cf4961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PWmh-8RBXvVMSEQgUHoxcQ.jpeg"/></div></div></figure><p id="d78f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">你有没有开发过出错时希望有<em class="lz">撤销</em>功能的东西？那么<em class="lz">复位</em>呢？</p><p id="52f6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">幸运的是，我们使用的软件中总是有撤销或重置功能。我说的是<a class="ae ma" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> vscode </a>中的<em class="lz"> ctrl + z </em>，或者，90年代常见的，表单中的<em class="lz"> reset </em>按钮。</p><p id="c97a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">很容易理解为什么我们需要它们，因为人类总是会犯错。无论是书面文章中的打字错误还是用词错误，我们都需要用某种方式来弥补。不过，当你想到这一点时，几乎在任何地方都有方法可以撤销某些事情。铅笔有橡皮，电话有被拆开的功能，用户可以选择重设密码，可擦笔可以擦掉墨水——这样的例子不胜枚举。</p><p id="3503" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">但是作为一个应用程序的开发者，如何实现撤销或重置功能呢？你从哪里开始？你应该从哪里寻求建议？</p><p id="95fa" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">好了，别再看了，因为我在这里向您展示如何用<em class="lz">撤销</em>和<em class="lz">重置</em>功能来增强您的应用程序！在这篇文章中，你会发现实现起来并不难，到最后，<em class="lz">你就可以自己添加了。</em></p><p id="c993" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们将建立的是一个用户界面，用户可以通过名字添加他们的朋友，并指定他们朋友的性别。当朋友被插入时，卡片将被附加到显示朋友注册信息的屏幕上。此外，如果他们的朋友是女性，它会显示一条<em class="lz">热粉色</em>的边界线，而男性会显示一条<em class="lz">蓝绿色</em>的边界线。如果用户在注册好友时出错，他或她可以选择<em class="lz">撤销</em>该动作，或者<em class="lz">将整个界面复位</em>回到其开始状态。最后，他们将能够改变他们的界面主题，从亮模式到暗模式，反之亦然。</p><p id="af67" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">下面是它的样子(注意:在这篇文章的结尾有一个例子，在这个例子中，这个过程更进一步):</p><h2 id="f894" class="mb mc it bd md me mf dn mg mh mi dp mj lm mk ml mm lq mn mo mp lu mq mr ms iz bi translated">灯光模式</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/f047fab358d4ba78dd1b1f3c122811ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*vLCXOLS3kvum4TpR99cNOw.jpeg"/></div></figure><h2 id="d3f4" class="mb mc it bd md me mf dn mg mh mi dp mj lm mk ml mm lq mn mo mp lu mq mr ms iz bi translated">黑暗模式</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b65bd12a8c146c74c7194e0c2eaae0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*Z1uq9NWjDlJTc6F4.jpg"/></div></figure><p id="3fd1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">事不宜迟，我们开始吧！</p><p id="bbd8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在本教程中，我们将使用<code class="fe mv mw mx my b">create-react-app</code>快速生成一个React项目。</p><p id="5382" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">(如果你想从GitHub获得一份库的副本，点击<a class="ae ma" href="https://github.com/jsmanifest/undo-reset" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="ad4e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">继续使用下面的命令创建一个项目。对于本教程，我将称我们的项目为<code class="fe mv mw mx my b">undo-reset</code>。</p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="b61c" class="mb mc it my b gy nd ne l nf ng">npx create-react-app undo-reset</span></pre><p id="50c1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">完成后，进入目录:</p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="6b09" class="mb mc it my b gy nd ne l nf ng">cd undo-reset</span></pre><p id="f258" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在主条目<code class="fe mv mw mx my b">src/index.js</code>中，我们将对其进行一些清理:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f09a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">起始款式可在<code class="fe mv mw mx my b">src/styles.css</code>中找到，包括:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="20b0" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在创造<code class="fe mv mw mx my b">src/App.js</code>。这将呈现我们将在整个教程中构建的所有组件:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8277" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因为我们让用户添加他们的朋友并指定他们的姓名和性别，所以我们定义了几个React钩子来保存输入值，我们还将定义更新它们的方法。</p><p id="696f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">然后，我们将实现钩子将自己附加到的元素和输入字段:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="4db8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/styles.css</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="0c51" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我不喜欢在我的教程中使用超级简单的界面——毕竟，我确实<em class="lz">重视你花在阅读我的帖子上的时间——所以我在样式上花了一些心思，让你不会感到无聊。</em></p><p id="e4ab" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">接下来，我们需要一个稳固的地方来放置撤销和重置逻辑，因此我们将创建一个自定义钩子来处理状态更新:</p><p id="6b88" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="31b3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">上面的<code class="fe mv mw mx my b">onSubmit</code>将被传递到我们之前定义的<code class="fe mv mw mx my b">form</code>中，这将有助于在用户提交好友时将他们添加到好友列表中:</p><p id="f36b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="d46a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这里需要注意的是<code class="fe mv mw mx my b">onSubmit</code>被赋予了字段参数作为参数。如果我们回头看看我们的<code class="fe mv mw mx my b">onSubmit</code>处理器，它不是一个<a class="ae ma" href="https://codeburst.io/here-are-7-ways-higher-order-functions-can-improve-your-life-a392aa6b29d2" rel="noopener" target="_blank">高阶函数</a>。这意味着它将在组件挂载时被立即调用，因此我们需要将<code class="fe mv mw mx my b">onSubmit</code>处理程序转换成一个高阶函数来绕过它，并赋予它接收字段值的能力:</p><p id="2548" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="139a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">到目前为止，我们有这个:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nj"><img src="../Images/8ead51e9ec2f3be00596ce8c1ca60098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e6WwSt-R2-T02QCH.gif"/></div></div></figure><p id="8e10" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">接下来，我们将开始实现逻辑。但是首先，我们需要定义<em class="lz">状态结构</em>:</p><p id="bc6e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="9b32" class="mb mc it my b gy nd ne l nf ng">const initialState = {<br/>  friends: [],<br/>  history: [],<br/>}</span></pre><p id="22e6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">本教程最重要的部分是<code class="fe mv mw mx my b">history</code>。当用户提交一个动作时，我们将捕获应用程序的状态，并将其安全地存储在一个地方，我们可以在以后引用它来撤销用户的动作。这个<em class="lz"/>就是<code class="fe mv mw mx my b">state.history</code>，只有我们自定义的钩子需要知道。然而，它也可以在用户界面中使用有趣的功能，比如允许用户通过网格查看他们以前的操作，并选择返回到哪一个。这是一个方便的小功能，让你的用户惊叹不已！(<strong class="lf jd">编辑</strong>:我在文章末尾提供了一个例子——在<em class="lz">奖金</em>部分的下面)</p><p id="1d3b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">接下来，我们将在reducer中添加开关案例，以便我们的状态可以实际更新:</p><p id="1bc3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="51e6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">当我们<code class="fe mv mw mx my b">dispatch</code>一个类型为<code class="fe mv mw mx my b"><em class="lz">‘</em>add-friend<em class="lz">’</em></code>的动作时，我们继续将这个新朋友添加到列表中。但用户不知道的是，我们在默默地保存他们之前的编辑。我们捕获了应用程序的最新状态，并将其保存在<code class="fe mv mw mx my b">history</code>数组中。这样，如果用户想回到以前的状态，我们可以做到！</p><p id="f4b6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因为我们使用的是React hook API，所以我们不能忘记从React导入它。我们还需要在自定义钩子中定义<code class="fe mv mw mx my b">useReducer</code>实现，这样我们就可以获得API来发送信号以更新我们的本地状态:</p><p id="fe00" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="233a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在我们已经获得了API，让我们将它们整合到需要它的地方:</p><p id="9eb4" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c8e7" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">到目前为止，我们的定制钩子是这样的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a6a5" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">接下来，我们需要呈现插入到<code class="fe mv mw mx my b">state.friends</code>中的朋友列表，以便用户可以在界面中看到他们:</p><p id="203b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="76ca" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果你想知道这条奇怪的线在做什么:</p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="edff" class="mb mc it my b gy nd ne l nf ng">&lt;img src={gender === 'Female' ? female : male} alt="" /&gt;</span></pre><p id="f54f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">实际上，我只是提供了自己的图像来呈现在<code class="fe mv mw mx my b">img</code>元素上，以便在界面中轻松区分女性和男性——出于演示目的。如果您需要它们的副本，那些正在克隆存储库的人将能够在<code class="fe mv mw mx my b"><em class="lz">src/images</em></code>目录中看到它们:)</p><p id="4054" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们在<code class="fe mv mw mx my b">App.js</code>的顶部导入女性/男性图像，在<code class="fe mv mw mx my b">App</code>组件的正上方，我们将定义一个<code class="fe mv mw mx my b">FriendBox</code>组件，当用户将它们添加到列表中时，该组件将负责呈现一个<code class="fe mv mw mx my b">friend</code>框:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="80b7" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了从视觉角度进一步区分女性和男性，我额外添加了基本风格来代表每种风格:</p><p id="0bcc" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/styles.css</code></p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="b2ad" class="mb mc it my b gy nd ne l nf ng">.teal-border {<br/>  border: 1px solid #467b8f;<br/>}</span><span id="b93e" class="mb mc it my b gy nk ne l nf ng">.hotpink-border {<br/>  border: 1px solid #c1247d;<br/>}</span></pre><p id="3627" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是我们目前对<code class="fe mv mw mx my b">App.js</code>文件的了解:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="fbb6" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这里的盒子使用的样式有:</p><p id="6862" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/styles.css</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="dbc0" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">哦，真倒霉！我们忘记做的一件事是引入<code class="fe mv mw mx my b">undo</code>方法，这样我们可以在接口中使用它！继续从<code class="fe mv mw mx my b">useApp</code>中取出并将其放在<code class="fe mv mw mx my b">Undo</code>按钮上:</p><p id="6c1c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="05af" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，当用户点击<code class="fe mv mw mx my b">Undo</code>按钮时，他们最后的动作应该被恢复！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ec4143aa75936141e7c50579e62f4336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*N8e2Y2W4AVdFQLfk.gif"/></div></figure><p id="7023" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">一切都在按计划进行。用户能够将他们的朋友添加到列表中，在界面中轻松区分哪些是女性，哪些是男性，并撤销他们之前的提交。</p><p id="2d6b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您是否注意到在<code class="fe mv mw mx my b">App</code>组件中现在有了一个<code class="fe mv mw mx my b">resetValues</code>方法，它被作为第二个参数传递给<code class="fe mv mw mx my b"><em class="lz">onSubmit</em></code>？用户可能会觉得有点奇怪的一件事是，在他们提交朋友后，他们的输入没有被清除。那里还需要同样的名字吗？除非他们有两三个同名的朋友，否则他们肯定会按下退格键，自己清除掉。但是我们作为开发者有能力让他们的生活变得更简单，所以这就是为什么我们实现了一个<code class="fe mv mw mx my b">resetValues</code>。</p><p id="2701" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">话虽如此，它应该被声明为<code class="fe mv mw mx my b">onSubmit</code>的第二个参数，因为我们将它作为UI组件中的第二个参数传入:</p><p id="e2f1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="13f3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们的撤销功能现在应该可以100%正常工作了，但是我还会做得更复杂一点，因为<code class="fe mv mw mx my b">undo</code>可以兼容任何东西。</p><p id="aec1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因此，我们将让用户为界面声明一个主题颜色，这样他们就不会对白色感到厌倦:</p><p id="3843" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="7c73" class="mb mc it my b gy nd ne l nf ng">const initialState = {<br/>  friends: [],<br/>  history: [],<br/>  theme: 'light',<br/>}</span></pre><p id="ffdf" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="b5ea" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">此外，我声明了一个<code class="fe mv mw mx my b">insertToHistory</code>实用程序来为我们带来额外的好处，以防我们将来为state参数传递一个奇怪的值，您可能已经注意到了:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="eff3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我想补充一点，随着你的应用变得越来越大越来越复杂，提前思考是一个非常重要的习惯。</p><p id="8f85" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在继续主题实现，我们将定义一个用户界面组件可以利用的自定义方法:</p><p id="782f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="dab8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">将主题组件和方法应用于界面:</p><p id="4f55" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="6b35" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因为我们添加了主题改变特性，所以添加一些条件样式来适应改变可能是个好主意，对吗？</p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="563b" class="mb mc it my b gy nd ne l nf ng">&lt;div className={cx({<br/>    'theme-light': theme === 'light',<br/>    'theme-dark': theme === 'dark',<br/>  })}</span><span id="18ae" class="mb mc it my b gy nk ne l nf ng"><em class="lz">// ...rest of the component</em></span></pre><p id="649f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是它的风格:</p><p id="445e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/styles.css</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="6f45" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">厉害！下面是我们的界面现在能做的！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/1f09db89294159e2f6f7c40ffe43ce49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/0*_N6BNqO5rxuHasQA.gif"/></div></figure><p id="5156" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为自己走到这一步鼓掌吧！</p><p id="3187" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">不过我们先不要庆祝，因为这篇文章的标题还提到了界面的重置特性。</p><p id="3971" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，让我们通过在我们现有的减速器上定义开关箱来实现这一点:</p><p id="7bf9" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1cb1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">当然，这意味着接下来必须定义一种方法，向减速器发送状态变化的信号。别忘了在钩子的末端归还它！</p><p id="1693" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/useApp.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="4e91" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">从UI组件中的挂钩析构它:</p><p id="3e0d" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="80fc" class="mb mc it my b gy nd ne l nf ng">const { onSubmit, friends, undo, theme, onThemeChange, reset } = useApp()</span></pre><p id="dc8e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="81fe" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">最后但同样重要的是，用于这些动作的样式使它们水平对齐:</p><p id="5ce8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/styles.css</code></p><pre class="ks kt ku kv gt mz my na nb aw nc bi"><span id="15bf" class="mb mc it my b gy nd ne l nf ng">.undo-actions {<br/>  display: flex;<br/>  align-items: center;<br/>}</span><span id="274a" class="mb mc it my b gy nk ne l nf ng">.undo-actions &gt; div {<br/>  margin: auto 3px;<br/>}</span></pre><p id="b4a8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/44443a55b2dd565c700facdad5a5bad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/1*f_hqrevtWBg-PIOs8cmR1w.gif"/></div></figure><p id="b146" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">难道你不喜欢界面重置也被撤销所捕获吗？</p><p id="7e2c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果您选择下载并克隆存储库，您将看到如下所示的细微修改:</p><p id="dae8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe mv mw mx my b">src/App.js</code></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1569" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是相同的代码，除了我通过将组件分离到它们自己的文件中来组织它，使它更具可读性和可维护性。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="d58b" class="nu mc it bd md nv nw nx mg ny nz oa mj ki ob kj mm kl oc km mp ko od kp ms oe bi translated">奖金</h1><p id="7101" class="pw-post-body-paragraph ld le it lf b lg of kd li lj og kg ll lm oh lo lp lq oi ls lt lu oj lw lx ly im bi translated">在本教程开始的时候，我提到了一个可以向用户显示的界面——如果需要，用户可以选择应用程序的状态。下面是一个使用中的例子:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/ea54f67c495da08d569417b8a9975959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T_7-pN8el1l2ifmZ.gif"/></div></div></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="4cce" class="nu mc it bd md nv nw nx mg ny nz oa mj ki ob kj mm kl oc km mp ko od kp ms oe bi translated">结论</h1><p id="07ac" class="pw-post-body-paragraph ld le it lf b lg of kd li lj og kg ll lm oh lo lp lq oi ls lt lu oj lw lx ly im bi translated">让我们面对现实，撤销事情对我们非常有用，因为我们人类从未停止犯错。我希望这意味着你发现这真的很有用！</p><p id="23a5" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">下次再见，如果你以后想从我这里读到更多，可以关注我！</p></div></div>    
</body>
</html>