<html>
<head>
<title>Build, Test, and Deploy a Flask Application (Part 6)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建、测试和部署Flask应用程序(第6部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-test-and-deploy-a-flask-application-part-6-952a1b29a02a?source=collection_archive---------3-----------------------#2019-12-28">https://betterprogramming.pub/build-test-and-deploy-a-flask-application-part-6-952a1b29a02a?source=collection_archive---------3-----------------------#2019-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a179" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">审查制度</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e1465f7395149430301be6beada3159e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BoddCOt6ZNZ2sPra"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@clintadair?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克林特·王茂林</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="7b0c" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">关于本教程的元信息</h1><h2 id="605d" class="lv le iq bd lf lw lx dn lj ly lz dp ln ma mb mc lp md me mf lr mg mh mi lt mj bi translated">学习目标</h2><ul class=""><li id="5536" class="mk ml iq mm b mn mo mp mq ma mr md ms mg mt mu mv mw mx my bi translated">持久存储的四个基本功能—创建、读取、更新和删除(CRUD)。</li></ul><p id="00d0" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">注:本教程是<a class="ae kv" href="https://medium.com/@neohao/learn-flask-in-a-scientific-way-baf4d8055f6e" rel="noopener"> <em class="no">系列</em> </a> <em class="no">科学学烧瓶的一部分。</em></p><h2 id="913a" class="lv le iq bd lf lw lx dn lj ly lz dp ln ma mb mc lp md me mf lr mg mh mi lt mj bi translated">源代码</h2><ul class=""><li id="a679" class="mk ml iq mm b mn mo mp mq ma mr md ms mg mt mu mv mw mx my bi translated">本教程的源代码可以在<a class="ae kv" href="https://github.com/Neo-Hao/mean-review-collector" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获取。</li><li id="5f43" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated">该演示可在<a class="ae kv" href="https://pacific-fortress-91193.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">该网站</a>上获得。</li><li id="6d0a" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated">仅涵盖本教程的版本可以在GitHub 上访问<a class="ae kv" href="https://github.com/Neo-Hao/mean-review-collector" rel="noopener ugc nofollow" target="_blank">。</a></li></ul></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4596" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">计划</h1><p id="f497" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">在本教程中，我们将开发和测试web应用程序的审阅系统组件。</p><p id="b395" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">本质上，这个组件将允许任何人查看所有用户添加的所有平均评论，并允许向应用程序注册帐户的用户创建、编辑和删除他们自己的评论。</p><p id="93c4" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">主页汇总了所有用户的所有评论，并按时间降序排列:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/c21e8f70ea60e8e5b204000493020386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RrtPfEbXc4CLswxYkbpAiQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">主页</p></figure><p id="55b0" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">用户控制面板仅聚合特定用户的评论，并允许用户创建、编辑和删除自己的评论:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/188ab54c2e274297222f813ceb21e3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6aQCrwF7dYeFIi7hlhvtIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用户仪表板</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="6194" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">create, read, update, and delete</h1><p id="d4f4" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">我们的系统旨在让用户分享他们收到的稿件的平均评论，因此每个用户都应该能够在登录我们的应用程序时创建、编辑和删除评论。</p><h2 id="f832" class="lv le iq bd lf lw lx dn lj ly lz dp ln ma mb mc lp md me mf lr mg mh mi lt mj bi translated">创造</h2><p id="5ab4" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">我们希望用户在单独的页面上写一篇新的评论，并将新添加的评论存储到数据库中，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/4efb96429004c5ad6b57937b3cdbabca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvaQ_ok2S_HfNVAkpWCiOA.png"/></div></div></figure><p id="72b5" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">为了实现这一点，我们需要首先更新我们的数据库。我们需要另一个表,( 1)保存评论的数据,( 2)将每个评论链接到发布评论的用户:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="46dc" class="lv le iq oa b gy oe of l og oh"># schema.sql</span><span id="f842" class="lv le iq oa b gy oi of l og oh">DROP TABLE IF EXISTS review;<br/>CREATE TABLE review (<br/>  id INTEGER PRIMARY KEY AUTOINCREMENT,<br/>  created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,<br/>  author_id INTEGER NOT NULL,<br/>  content TEXT NOT NULL,<br/>  FOREIGN KEY (author_id) REFERENCES user (id)<br/>);</span></pre><p id="bf9e" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">在审阅表中，<code class="fe oj ok ol oa b">author_id</code>列引用用户表中的<code class="fe oj ok ol oa b">id</code>列。在此基础上，我们可以继续为用户撰写新评论的页面准备<code class="fe oj ok ol oa b">create.html</code>模板:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="7bef" class="lv le iq oa b gy oe of l og oh"># templates/review/create.html</span><span id="3cb4" class="lv le iq oa b gy oi of l og oh">{% extends 'base.html' %}<br/>{% block header %}<br/>&lt;div class="container"&gt;<br/>  &lt;h1&gt;{% block title %}Write a new review{% endblock %}&lt;/h1&gt;<br/>&lt;/div&gt;<br/>{% endblock %}</span><span id="a28e" class="lv le iq oa b gy oi of l og oh">{% block content %}<br/>&lt;div class="container"&gt;<br/>  &lt;form method="post"&gt;<br/>    &lt;div class="form-group"&gt;<br/>      &lt;label for="exampleFormControlTextarea1"&gt;Your review:&lt;/label&gt;<br/>      &lt;textarea class="form-control" rows="3" name="review-text"&gt;   <br/>      &lt;/textarea&gt;<br/>    &lt;/div&gt;<br/>    &lt;button class="btn btn-primary" type="submit"&gt;Submit&lt;/button&gt;<br/>  &lt;/form&gt;<br/>&lt;/div&gt;<br/>{% endblock %}</span></pre><p id="934c" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">基于这个模板，我们可以在<code class="fe oj ok ol oa b">review.py</code>中准备一个新的blueprint函数来处理这个表单:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="e0ef" class="lv le iq oa b gy oe of l og oh"># review.py</span><span id="c60c" class="lv le iq oa b gy oi of l og oh">@bp.route('/create', methods=('GET', 'POST'))<br/>@login_required<br/>def create():<br/>  if request.method == 'POST':<br/>    text = request.form['review-text']<br/>    text = text.strip()<br/>    db = get_db()<br/>    error = None</span><span id="97ea" class="lv le iq oa b gy oi of l og oh">if not text:<br/>    error = 'You didn\'t add any new reviews.'<br/>  if error is None:<br/>    db.execute(<br/>      'INSERT INTO review (author_id, content) VALUES (?, ?)',   <br/>      (g.user['id'], text)<br/>    )<br/>    db.commit()<br/>    return redirect(url_for('review.dashboard'))</span><span id="1dd3" class="lv le iq oa b gy oi of l og oh">flash(error)</span><span id="a957" class="lv le iq oa b gy oi of l og oh">return render_template('review/create.html')</span></pre><h2 id="f74b" class="lv le iq bd lf lw lx dn lj ly lz dp ln ma mb mc lp md me mf lr mg mh mi lt mj bi translated">阅读</h2><p id="d2d4" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">当您启动应用程序、登录并添加一个新的评论时，很自然地会期望新添加的评论会聚集在主页和用户仪表板上。</p><p id="963f" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">为此，我们需要更新主页模板的代码，将静态文本替换为:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="84e1" class="lv le iq oa b gy oe of l og oh"># templates/review/home.html</span><span id="99e8" class="lv le iq oa b gy oi of l og oh">...<br/>{% for review in reviews %}<br/>  &lt;blockquote class="blockquote"&gt;<br/>    &lt;p class="mb-0"&gt;{{ review['content'] }}&lt;/p&gt;<br/>      &lt;footer class="blockquote-footer"&gt;<br/>        From @{{ review['username'].split("@")[0] }}<br/>      &lt;/footer&gt;<br/>  &lt;/blockquote&gt;<br/>{% endfor %}<br/>...</span></pre><p id="80e0" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">此外，我们需要更新home函数:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="cb18" class="lv le iq oa b gy oe of l og oh"># review.py</span><span id="0ef0" class="lv le iq oa b gy oi of l og oh">@bp.route('/')<br/>def home():<br/>    db = get_db()<br/>    reviews = db.execute(<br/>        'SELECT r.id, created, author_id, content, username'<br/>        ' FROM review r JOIN user u ON r.author_id = u.id'<br/>        ' ORDER BY created DESC'<br/>    ).fetchall()<br/>    return render_template('review/home.html', reviews=reviews)</span></pre><p id="7108" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">类似地，我们需要更新仪表板功能的代码。仪表板功能仅选择并显示给定用户撰写的评论。</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="63ed" class="lv le iq oa b gy oe of l og oh"># review.py</span><span id="7df4" class="lv le iq oa b gy oi of l og oh">@bp.route('/dashboard')<br/>@login_required<br/>def dashboard():<br/>  db = get_db()<br/>  reviews = db.execute(<br/>        'SELECT r.id, created, author_id, content, username'<br/>        ' FROM review r JOIN user u ON r.author_id = u.id'<br/><strong class="oa ir">        ' WHERE author_id = ?'</strong><br/>        ' ORDER BY created DESC',<br/><strong class="oa ir">        (g.user['id'],)</strong><br/>  ).fetchall()</span><span id="8fcf" class="lv le iq oa b gy oi of l og oh">return render_template('review/dashboard.html', reviews=reviews)</span></pre><p id="c327" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">dashboard模板使用作为哈希表传递给模板的<code class="fe oj ok ol oa b">review</code>，并将键<code class="fe oj ok ol oa b">id</code>对应的值插入到<em class="no">编辑</em>和<em class="no">删除</em>的链接中，这样用户就可以实际编辑和删除评论。</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="5cc0" class="lv le iq oa b gy oe of l og oh"># templates/review/dashboard.html</span><span id="3232" class="lv le iq oa b gy oi of l og oh">&lt;p class="lead"&gt;Here are your reviews:&lt;/p&gt;<br/>{% for review in reviews %}<br/>  &lt;blockquote class="blockquote"&gt;<br/>    &lt;p class="mb-0"&gt;{{ review['content'] }}&lt;/p&gt;<br/>    &lt;footer class="blockquote-footer"&gt;<br/>      From @{{ review['username'].split("@")[0] }}<br/>      &lt;a href="<br/>             <strong class="oa ir">{{ url_for('review.edit', id=review['id']) }}</strong>"&gt;Edit&lt;/a&gt;<br/>      &lt;a href="<br/>         <strong class="oa ir">{{ url_for('review.delete', id=review['id']) }}</strong>"&gt;Delete&lt;/a&gt;<br/>    &lt;/footer&gt;<br/>  &lt;/blockquote&gt;<br/>{% endfor %}</span></pre><h2 id="6cfc" class="lv le iq bd lf lw lx dn lj ly lz dp ln ma mb mc lp md me mf lr mg mh mi lt mj bi translated">更新和删除</h2><p id="816d" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">用户应该能够在一个单独的页面上编辑他们给定的评论<code class="fe oj ok ol oa b">edit.html</code>。</p><p id="be2f" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">这个页面和<code class="fe oj ok ol oa b">create.html</code>很像，所以编辑页面<code class="fe oj ok ol oa b">edit.html</code>的代码应该和<code class="fe oj ok ol oa b">create.html</code>几乎一模一样。但是，由于这是编辑，用户应该能够看到评论的原始内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/94ac36c492d405aa2151f9f4054dac47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LDMjFAnJY2kKXH_5VTzugg.png"/></div></div></figure><p id="d6e2" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">我们通过将<code class="fe oj ok ol oa b">review['content']</code>传递给编辑表单来实现这一点:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="685d" class="lv le iq oa b gy oe of l og oh"># templates/review/edit.html</span><span id="d832" class="lv le iq oa b gy oi of l og oh">{% extends 'base.html' %}<br/>{% block header %}<br/>&lt;div class="container"&gt;<br/>  &lt;h1&gt;{% block title %}Update your review{% endblock %}&lt;/h1&gt;<br/>&lt;/div&gt;<br/>{% endblock %}</span><span id="117e" class="lv le iq oa b gy oi of l og oh">{% block content %}<br/>&lt;div class="container"&gt;<br/>  &lt;form method="post"&gt;<br/>    &lt;div class="form-group"&gt;<br/>      &lt;label for="exampleFormControlTextarea1"&gt;<br/>        Your Mean Review:<br/>      &lt;/label&gt;<br/>      &lt;textarea class="form-control" <br/>       id="exampleFormControlTextarea1" rows="3" name="review-text"&gt;<br/><strong class="oa ir">        {{ review['content'] }}</strong><br/>      &lt;/textarea&gt;<br/>    &lt;/div&gt;<br/>    &lt;button class="btn btn-primary" type="submit"&gt;Submit&lt;/button&gt;<br/>  &lt;/form&gt;<br/>&lt;/div&gt;<br/>{% endblock %}</span></pre><p id="c503" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">至于编辑和删除功能，两者都需要检索评论。因此，我们可以将此作为一个独立的方法<code class="fe oj ok ol oa b">get_review</code>:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="48a0" class="lv le iq oa b gy oe of l og oh"># review.py</span><span id="4362" class="lv le iq oa b gy oi of l og oh">def get_review(id):<br/>  db = get_db()<br/>  review = db.execute(<br/>        'SELECT r.id, created, author_id, content, username'<br/>        ' FROM review r JOIN user u ON r.author_id = u.id'<br/>        ' WHERE r.id = ?',<br/>        (id,)<br/>  ).fetchone()</span><span id="e50b" class="lv le iq oa b gy oi of l og oh">  if review is None:<br/>    abort(404, "Review id {0} doesn't exist.".format(id))</span><span id="f7e3" class="lv le iq oa b gy oi of l og oh">  if review['author_id'] != g.user['id']:<br/>    abort(403)</span><span id="4f31" class="lv le iq oa b gy oi of l og oh">  return review</span></pre><p id="1684" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">编辑和删除功能都可以使用该功能:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="9cd2" class="lv le iq oa b gy oe of l og oh"># review.py</span><span id="5b41" class="lv le iq oa b gy oi of l og oh">@bp.route('/edit/&lt;int:id&gt;', methods=('GET', 'POST'))<br/>@login_required<br/>def edit(id):<br/>  review = get_review(id)</span><span id="3a65" class="lv le iq oa b gy oi of l og oh">  if request.method == 'POST':<br/>    text = request.form['review-text']<br/>    text = text.strip()<br/>        db = get_db()<br/>        error = None</span><span id="9296" class="lv le iq oa b gy oi of l og oh">  if not text:<br/>    error = 'You can\'t update the review to nothing.'<br/>    if error is None:<br/>    db.execute(<br/>      'UPDATE review SET content = ?'<br/>      ' WHERE id = ?',<br/>      (text, id)<br/>    )<br/>    db.commit()<br/>    return redirect(url_for('review.dashboard'))</span><span id="c0d1" class="lv le iq oa b gy oi of l og oh">  flash(error)<br/>  return render_template('review/edit.html', review=review)</span><span id="f04c" class="lv le iq oa b gy oi of l og oh">@bp.route('/delete/&lt;int:id&gt;', methods=('GET', 'POST'))<br/>@login_required<br/>def delete(id):<br/>  get_review(id)<br/>  db = get_db()<br/>  db.execute('DELETE FROM review WHERE id = ?', (id,))<br/>  db.commit()<br/>  return redirect(url_for('review.dashboard'))</span></pre><p id="4ce9" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">值得注意的是，评论ID被传递给这两个函数，它们的路由将URL格式化为<code class="fe oj ok ol oa b">domain_name/function/review_id</code>，像<code class="fe oj ok ol oa b">/edit/1</code>或<code class="fe oj ok ol oa b">/delete/2</code>。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="25de" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">测试</h1><p id="f088" class="pw-post-body-paragraph mz na iq mm b mn mo jr nc mp mq ju ne ma nu ng nh md nv nj nk mg nw nm nn mu ij bi translated">CRUD的测试相对简单。例如，<code class="fe oj ok ol oa b">test_create</code>功能将是:</p><pre class="kg kh ki kj gt nz oa ob oc aw od bi"><span id="707a" class="lv le iq oa b gy oe of l og oh">def test_create(client, auth, app):<br/>  count_prior = 0<br/>  count_after = 0</span><span id="a871" class="lv le iq oa b gy oi of l og oh">  with app.app_context():<br/>    db = get_db()<br/>    count_prior = db.execute(<br/>        'SELECT COUNT(id) FROM review').fetchone()[0]</span><span id="be32" class="lv le iq oa b gy oi of l og oh">  auth.login()<br/>    assert client.get('/create').status_code == 200<br/>    client.post('/create', <br/>      data={'review-text': 'this is a mean review'})</span><span id="94f3" class="lv le iq oa b gy oi of l og oh">  with app.app_context():<br/>    db = get_db()<br/>    count_after = db.execute(<br/>      'SELECT COUNT(id) FROM review').fetchone()[0]</span><span id="f4f9" class="lv le iq oa b gy oi of l og oh">  assert count_prior + 1 == count_after</span></pre><p id="fafb" class="pw-post-body-paragraph mz na iq mm b mn nb jr nc mp nd ju ne ma nf ng nh md ni nj nk mg nl nm nn mu ij bi translated">除了CRUD上的测试，我们可能需要测试<code class="fe oj ok ol oa b">login_required</code>是否如这些页面上预期的那样工作，以及是否只有评论的作者可以编辑他们的评论。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="7e62" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">教程列表</h1><ul class=""><li id="d8fc" class="mk ml iq mm b mn mo mp mq ma mr md ms mg mt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-mini-flask-application-1d9ca6c45115" rel="noopener">构建并测试一个迷你烧瓶应用程序</a></li><li id="e240" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/better-programming/build-test-and-deploy-an-interactive-flask-application-part-i-templates-53a7b0cbe760" rel="noopener">构建、测试和部署Flask应用程序:第1部分—模板</a></li><li id="ada3" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/better-programming/build-test-and-deploy-a-flask-application-part-2-53f2c8df3ebc" rel="noopener">构建、测试和部署Flask应用程序:第2部分——认证</a></li><li id="78c5" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-flask-application-part-3-3a2abfe4be21" rel="noopener">构建、测试和部署Flask应用程序:第3部分——应用程序工厂和蓝图</a></li><li id="c985" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-flask-application-part-4-5aa4f079fadb" rel="noopener">构建、测试和部署Flask应用程序:第4部分——重构测试</a></li><li id="0517" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-flask-application-part-5-4a3c0bc36b8e" rel="noopener">构建、测试和部署Flask应用程序:第5部分—认证(续)</a></li><li id="0eca" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-flask-application-part-6-952a1b29a02a" rel="noopener">构建、测试和部署Flask应用程序:第6部分——评审系统</a></li><li id="733d" class="mk ml iq mm b mn np mp nq ma nr md ns mg nt mu mv mw mx my bi translated"><a class="ae kv" href="https://medium.com/@neohao/build-test-and-deploy-a-flask-application-part-7-60dde9080330" rel="noopener">构建、测试和部署Flask应用程序:第7部分——部署</a></li></ul></div></div>    
</body>
</html>