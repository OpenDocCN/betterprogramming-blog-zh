<html>
<head>
<title>Design and Implement Tic Tac Toe With Real-time Database With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React实时数据库设计和实现井字游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/design-tic-tac-toe-with-realtime-database-in-react-code-attached-535409d7f9f?source=collection_archive---------9-----------------------#2022-06-13">https://betterprogramming.pub/design-tic-tac-toe-with-realtime-database-in-react-code-attached-535409d7f9f?source=collection_archive---------9-----------------------#2022-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="de44" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">部署在网络上</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f4b576eed937ab26d4c8a367a46a2575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*KaFx_cxATARjKtVXx1h0dg.png"/></div></figure><p id="220f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在本文中，我们将介绍如何设计井字游戏，将它与实时数据库绑定，实现逻辑并部署它，最终与您的朋友一起玩。</p><h1 id="4a92" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">先决条件</h1><ul class=""><li id="12fe" class="mb mc iq kp b kq md kt me kw mf la mg le mh li mi mj mk ml bi translated">Javascript(因为它是一个网络应用程序)</li><li id="bccb" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mi mj mk ml bi translated">反应(主要是功能组件)</li><li id="30ca" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mi mj mk ml bi translated">ReduxToolkit(状态管理)</li><li id="9a19" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mi mj mk ml bi translated">Firebase(作为我们的数据库)</li><li id="8555" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mi mj mk ml bi translated">材质用户界面(渲染组件)</li><li id="ce8b" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mi mj mk ml bi translated">版本控制系统</li></ul><h1 id="176d" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated"><strong class="ak">理解设计</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/bae4c06331ddf4945da4dc7734ebb792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMbR8v5wyQKsshkAXsonwA.jpeg"/></div></div></figure><p id="134c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">设计井字游戏时，有几件事需要注意。</p><ol class=""><li id="b76e" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mz mj mk ml bi translated">这是一个双人游戏，所以游戏不会面临并发请求。基本上是互斥的。</li><li id="8988" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mz mj mk ml bi translated">只有在玩家玩了在<code class="fe na nb nc nd b">Player B</code> <strong class="kp ir"> </strong>正在玩的时候<code class="fe na nb nc nd b">Player A</code>不能赢的回合之后，结果才会出现。</li><li id="20b9" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mz mj mk ml bi translated">只有4种方法可以让你赢:水平，垂直，左对角线，右对角线</li></ol><h1 id="84b8" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">数据库模式</h1><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="3af2" class="ni lk iq nd b gy nj nk l nl nm">{<br/> player1: String,<br/> player2: String,<br/> board: String[N][N],<br/> turn: String,<br/> gameOver: Boolean,<br/> chancesLeft: Integer == N<br/>}</span><span id="71b7" class="ni lk iq nd b gy nn nk l nl nm">This is how our db schema is going to look like. Getting onto the details<br/>- player1 is a string field that represents the name of 1st player.<br/>- player1 is a string field that represents the name of 1st player.<br/>- board is N X N matrix representing current state of the game.<br/>- turn as discussed in while designing point 1 is our mutex.<br/>- Game over and chances left are used to decide the flow of game.</span></pre><p id="0044" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们说游戏结束有两种情况:</p><ol class=""><li id="f855" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mz mj mk ml bi translated">其中一个玩家赢了。</li><li id="aa43" class="mb mc iq kp b kq mm kt mn kw mo la mp le mq li mz mj mk ml bi translated">剩下的机会是零。(画)</li></ol><p id="e1df" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果玩家满足以下任何一个条件，他就应该赢得游戏。</p><ul class=""><li id="8923" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mi mj mk ml bi translated">水平地</li></ul><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="3c26" class="ni lk iq nd b gy nj nk l nl nm"> let count = 0<br/> for(let i = 0; i&lt; size; i++){<br/> if(arr[i][col] === symbol)<br/> count++;<br/> }</span><span id="c3f9" class="ni lk iq nd b gy nn nk l nl nm"> if(count === size)<br/>  return true;</span></pre><ul class=""><li id="7934" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mi mj mk ml bi translated">垂直地</li></ul><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="3ef3" class="ni lk iq nd b gy nj nk l nl nm">count = 0<br/> for(let i = 0; i &lt; size; i++){<br/> if(arr[row][i] === symbol)<br/> count++;<br/> }<br/> <br/> if(count === size)<br/> return true;</span></pre><ul class=""><li id="7e70" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mi mj mk ml bi translated">左对角线</li></ul><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="ede7" class="ni lk iq nd b gy nj nk l nl nm">let count = 0<br/> for(let i = 0; i &lt; size; i++){<br/> if(arr[i][i] === symbol)<br/> count++;<br/> }</span><span id="513d" class="ni lk iq nd b gy nn nk l nl nm"><br/>if(count === size)<br/> return true;<br/></span></pre><ul class=""><li id="fe21" class="mb mc iq kp b kq kr kt ku kw mw la mx le my li mi mj mk ml bi translated">右对角线</li></ul><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="0c59" class="ni lk iq nd b gy nj nk l nl nm">count = 0;<br/> for(let i = 0; i&lt; size; i++){<br/> if(arr[i][size -i — 1] === symbol)<br/> count++;<br/> }</span><span id="2109" class="ni lk iq nd b gy nn nk l nl nm">if(count === size)<br/> return true;<br/></span></pre><h1 id="8b4a" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated"><strong class="ak">配置数据库</strong></h1><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="e087" class="ni lk iq nd b gy nj nk l nl nm">const firebaseConfig = {<br/> apiKey: process.env.REACT_APP_API_KEY,<br/> authDomain: process.env.REACT_APP_AUTH_DOMAIN,<br/> projectId: process.env.REACT_APP_PROJECT_ID,<br/> storageBucket: process.env.REACT_APP_STORAGE_BUCKET,<br/> messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,<br/> appId: process.env.REACT_APP_APP_ID,<br/> measurementId: process.env.REACT_APP_MEASUREMENT_ID<br/> };</span><span id="1550" class="ni lk iq nd b gy nn nk l nl nm">const app = initializeApp(firebaseConfig);<br/>const db = getFirestore(app);</span><span id="23d4" class="ni lk iq nd b gy nn nk l nl nm">export default db;</span></pre><p id="c10c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在你可以使用这个<code class="fe na nb nc nd b"><strong class="kp ir">db</strong></code>实例给你的firestore打电话。</p><blockquote class="no np nq"><p id="9bcf" class="kn ko nr kp b kq kr jr ks kt ku ju kv ns kx ky kz nt lb lc ld nu lf lg lh li ij bi translated">注意:仍然担心如何将firebase添加到您的项目中。在此按照步骤<a class="ae nv" href="https://firebase.google.com/docs/web/setup#add-sdk-and-initialize)" rel="noopener ugc nofollow" target="_blank">进行</a></p></blockquote><h1 id="4615" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated"><strong class="ak">创建房间</strong></h1><p id="4271" class="pw-post-body-paragraph kn ko iq kp b kq md jr ks kt me ju kv kw nw ky kz la nx lc ld le ny lg lh li ij bi translated">创建一个房间是游戏最重要的方面之一。房间代码需要对每一对玩家都是唯一的。这个房间代码的另一个方面是，这个房间代码也将作为您的<code class="fe na nb nc nd b">document</code>在firebase集合中服务，其他订户用户将会收听它。</p><p id="6f5a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这些步骤是:</p><p id="5e88" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">1.通过选择一个随机数创建一个5位数的唯一密钥</p><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="d72b" class="ni lk iq nd b gy nj nk l nl nm">const getRandom = () =&gt; Math.floor(Math.random()*90000) + 10000;</span></pre><p id="1b57" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><em class="nr"> 2。通过勾选</em>防止碰撞发生</p><h1 id="b86b" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated"><strong class="ak">如何实时制作？</strong></h1><p id="e68a" class="pw-post-body-paragraph kn ko iq kp b kq md jr ks kt me ju kv kw nw ky kz la nx lc ld le ny lg lh li ij bi translated">Firestore SDK提供了一个名为<code class="fe na nb nc nd b">onSnapshot</code>的API来监听实时更新。更多关于它的<a class="ae nv" href="https://firebase.google.com/docs/firestore/query-data/listen" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="kg kh ki kj gt ne nd nf ng aw nh bi"><span id="d7d3" class="ni lk iq nd b gy nj nk l nl nm">onSnapshot(docRef, (doc) =&gt; {<br/> // doc.data() will give you latest changes in the db <br/> Your code goes here….<br/> });</span></pre><p id="f728" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">那么下一步是什么？</p><p id="aef4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">差不多就是这样。这些是整个项目中最困难的部分。<br/>也许是时候开始编码并做必要的改变了。</p><h1 id="1944" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated"><strong class="ak">想要现场演示吗？</strong></h1><p id="fa59" class="pw-post-body-paragraph kn ko iq kp b kq md jr ks kt me ju kv kw nw ky kz la nx lc ld le ny lg lh li ij bi translated">是啊当然！我已经在网上部署了这个游戏。</p><p id="5b31" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">还是，卡住了？需要参考资料来自己构建吗？</p><p id="55e3" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这是我的<a class="ae nv" href="https://github.com/pritambarua/tic-tac-toe" rel="noopener ugc nofollow" target="_blank">回购</a>的链接。我已经公开了。欢迎所有评论。</p></div></div>    
</body>
</html>