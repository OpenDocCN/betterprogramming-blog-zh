<html>
<head>
<title>Why I Prefer to Use the Parameter Object Pattern in Angular Pipes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我喜欢在角形管道中使用参数对象模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-i-prefer-to-use-the-parameter-object-pattern-in-angular-pipes-7fd999060cb5?source=collection_archive---------0-----------------------#2021-09-05">https://betterprogramming.pub/why-i-prefer-to-use-the-parameter-object-pattern-in-angular-pipes-7fd999060cb5?source=collection_archive---------0-----------------------#2021-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1318" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">而不是直接传递参数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9d620be7d258efe67ae34f5488f43b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNRmZb0AOl9FUYCfp-X6AA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@realaxer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> T K </a>在<a class="ae ky" href="https://unsplash.com/s/photos/pipe?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="fc2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我喜欢使用参数对象模式来减少传递给函数或方法的参数数量。我第一次从<a class="ae ky" href="https://www.amazon.ca/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882" rel="noopener ugc nofollow" target="_blank">干净代码:敏捷软件工艺手册</a>中了解到这种模式。干净的代码甚至暗示三个或更多的参数对于一个函数来说太多了。</p><p id="c634" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，如果有三个以上的参数，在将它们传递给函数之前，将这些参数封装到一个对象中是有意义的。</p><p id="b89b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将首先剖析我们通常如何实现一个直接传递参数的角形管道。然后，我们将介绍如何使用参数对象模式来实现它。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1abb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">一个例子-战斗机剖面管</h1><p id="d9e8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将在整篇博文中使用这个例子。例如，给定一个具有以下数据的MMA战斗机剖面:</p><ul class=""><li id="5180" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">姓名:Khabib Nurmagomedov</li><li id="ea0a" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">重量:155磅</li><li id="ed5e" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">身高:158厘米</li><li id="96ca" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">胜数:29</li><li id="da03" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">损失:0</li></ul><p id="2029" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们正在实现一个角度管道，将上述数据格式化为单行文本:</p><p id="7244" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Khabib Nurmagomedov，155磅，178厘米，29胜0负</p><p id="95f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将把这个管道称为— <code class="fe nn no np nq b">fighterProfile</code>。让我们看一下例子。</p><h1 id="888d" class="mc md it bd me mf nr mh mi mj ns ml mm jz nt ka mo kc nu kd mq kf nv kg ms mt bi translated">使用参数</h1><p id="b7cf" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果我们使用参数，让我们从管道的转换方法开始。我们将<code class="fe nn no np nq b">name</code>作为第一个参数，随后的参数将是<code class="fe nn no np nq b">weight</code>、<code class="fe nn no np nq b">height</code>、<code class="fe nn no np nq b">wins</code>和<code class="fe nn no np nq b">losses</code>。<code class="fe nn no np nq b">format</code>方法将一个字符串附加到数字参数上，如<code class="fe nn no np nq b">height</code>、<code class="fe nn no np nq b">weight</code>、<code class="fe nn no np nq b">wins</code>和<code class="fe nn no np nq b">losses</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">战斗机剖面管上的斯塔克布利兹由作者。</p></figure><h2 id="d221" class="ny md it bd me nz oa dn mi ob oc dp mm li od oe mo lm of og mq lq oh oi ms oj bi translated">单人战斗机剖面图</h2><p id="3404" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使用上面的<code class="fe nn no np nq b">fighterProfile</code>管道，我们将参数直接传递给我们的模板，如下所示。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="d92a" class="ny md it nq b gy oo op l oq or">{{ 'Khabib Nurmagomedov' | fighterProfile: 29: 0: 155: 178 }}</span></pre><p id="838e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出将是:</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="6e2a" class="ny md it nq b gy oo op l oq or">Khabib Nurmagomedov, 155 lbs, 178 cm, 29 wins, 0 losses</span></pre><h2 id="1885" class="ny md it bd me nz oa dn mi ob oc dp mm li od oe mo lm of og mq lq oh oi ms oj bi translated">一系列战斗机简介</h2><p id="48c2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在让我们来看一个更真实的例子，一组战斗机的外形如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在Stackblitz上的一系列战斗机简介。</p></figure><p id="34e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的示例代码中，我将<code class="fe nn no np nq b">legacyFighterProfiles</code> <em class="os"> </em>保存在一个单独的文件中。所以我们需要先把它赋给组件的属性。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="397c" class="ny md it nq b gy oo op l oq or">this.legacyFightersList = legacyFighterProfiles;</span></pre><p id="a811" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将遍历<code class="fe nn no np nq b">legacyFighterProfilesList</code>并为每个战斗机剖面应用管道。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="62a7" class="ny md it nq b gy oo op l oq or">&lt;ul&gt;<br/>      &lt;li *ngFor="let fighter of legacyFightersList"&gt;<br/>        {{ fighter.bio.name | fighterProfile:<br/>        fighter.mmaRecord.wins:<br/>        fighter.mmaRecord.losses:<br/>        fighter.bio.weight:<br/>        fighter.bio.height }}<br/>      &lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="f395" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码应该输出:</p><ul class=""><li id="3b0d" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">康纳·麦格雷戈，22胜6负，155磅，175厘米</li><li id="e586" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">哈比比，29胜0负，155磅，178厘米</li><li id="8c9b" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">达斯汀·普瓦里耶，28胜6负，155磅，175厘米</li></ul><p id="127f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在StackBlitz中找到完整的运行示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在Stackblitz上运行代码。</p></figure><h1 id="4a82" class="mc md it bd me mf nr mh mi mj ns ml mm jz nt ka mo kc nu kd mq kf nv kg ms mt bi translated">使用接口的参数对象模式</h1><p id="cdd3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果我们想使用参数对象模式，我们必须将整个战斗机配置文件作为单个参数传递。不像在我们之前的例子中，每个战斗机配置文件属性都是它的参数。我们将从声明我们的<code class="fe nn no np nq b">FighterProfile</code>接口开始。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="110f" class="ny md it nq b gy oo op l oq or">export interface FighterProfile {<br/>  name: string;<br/>  weight: number;<br/>  height: number;<br/>  wins: number;<br/>  losses: number;<br/>}</span></pre><p id="a1fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的pipe类中的<code class="fe nn no np nq b">transform</code>方法将接受一个<code class="fe nn no np nq b">fighterProfile</code>参数并返回格式化的字符串。格式方法将一个字符串附加到我们的<code class="fe nn no np nq b">fighterProfile</code>接口的数值字段中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">战斗机剖面管上的斯塔克布利兹由作者。</p></figure><h2 id="6161" class="ny md it bd me nz oa dn mi ob oc dp mm li od oe mo lm of og mq lq oh oi ms oj bi translated">单人战斗机剖面图</h2><p id="6c80" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使用这个<code class="fe nn no np nq b">fighterProfile</code>管道，我们可以用<code class="fe nn no np nq b">FighterProfile</code>类型初始化一个属性。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="bb16" class="ny md it nq b gy oo op l oq or">this.singleProfile = {<br/> name: 'Khabib Nurmagomedov',<br/> wins: 29,<br/> losses: 0,<br/> weight: 155,<br/> height: 178<br/>};</span></pre><p id="d225" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的模板中，我们将把<code class="fe nn no np nq b">singleProfile</code>属性作为单个参数传递给我们的<code class="fe nn no np nq b">fighterProfile</code>管道。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="1e34" class="ny md it nq b gy oo op l oq or">{{ singleProfile | fighterProfile }}</span></pre><p id="bfc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的输出将是:</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="cfd9" class="ny md it nq b gy oo op l oq or">Khabib Nurmagomedov, 155 lbs, 178 cm, 29 wins, 0 losses</span></pre><h2 id="6b8a" class="ny md it bd me nz oa dn mi ob oc dp mm li od oe mo lm of og mq lq oh oi ms oj bi translated">一系列战斗机简介</h2><p id="5046" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将使用上一个例子中的同一个数组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在StackBlitz上的一系列战斗机简介。</p></figure><p id="b46a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先创建一个方法，将fighter profile字段转换成<code class="fe nn no np nq b">FighterProfile</code>类型。该方法将接受一个<code class="fe nn no np nq b">legacyFighterProfile</code> <em class="os"> </em>参数。它将使用一些<code class="fe nn no np nq b">legacyFighterProfile</code> <em class="os"> </em>字段来返回<code class="fe nn no np nq b">FighterProfile</code>类型。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="0eb8" class="ny md it nq b gy oo op l oq or">fighterProfile(legacyFighterProfile: LegacyFighterProfile): FighterProfile {<br/>    return {<br/>      name: legacyFighterProfile.bio.name,<br/>      weight: legacyFighterProfile.bio.weight,<br/>      height: legacyFighterProfile.bio.height,<br/>      wins: legacyFighterProfile.mmaRecord.wins,<br/>      losses: legacyFighterProfile.mmaRecord.losses<br/>    } as FighterProfile;<br/>}</span></pre><p id="0e5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在我们的模板中使用这个管道，将<code class="fe nn no np nq b">legacyFighterProfiles</code>值赋给我们组件的<code class="fe nn no np nq b">legacyFightersList</code>属性。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="0627" class="ny md it nq b gy oo op l oq or">this.legacyFightersList = legacyFighterProfiles;</span></pre><p id="03e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后遍历模板中的列表。将管道应用于每个<code class="fe nn no np nq b">fighterProfile</code>数组元素。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="27f0" class="ny md it nq b gy oo op l oq or">&lt;ul&gt;<br/>      &lt;li *ngFor="let fighter of legacyFightersList"&gt;<br/>        {{ fighterProfile(fighter) | fighterProfile}}<br/>      &lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="746d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这比使用参数更具可读性。然而，由于<a class="ae ky" href="https://blog.angular-university.io/how-does-angular-2-change-detection-really-work/" rel="noopener ugc nofollow" target="_blank">角度变化检测如何工作</a>，这将不必要地调用<code class="fe nn no np nq b">fighterProfile()</code> <em class="os"> </em>方法很多次，而不是应该调用的<em class="os">。</em></p><p id="df08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的解决方案是去掉<code class="fe nn no np nq b">fighterProfile()</code>方法，直接在模板中声明<code class="fe nn no np nq b">FighterProfile</code> <em class="os"> </em>对象<em class="os"> </em>。我们不需要额外调用组件的方法:</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="e302" class="ny md it nq b gy oo op l oq or">&lt;ul&gt;<br/>    &lt;li *ngFor="let fighter of legacyFightersList"&gt;<br/>        {{<br/>        { name: fighter.bio.name,<br/>        wins: fighter.mmaRecord.wins,<br/>        losses: fighter.mmaRecord.losses,<br/>        weight: fighter.bio.weight,<br/>        height: fighter.bio.height } | fighterProfile }}<br/>    &lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="eff9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在StackBlitz中找到完整的运行示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在Stackblitz上运行代码。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9bb3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="1987" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们的例子中去掉了我们的<code class="fe nn no np nq b">fighterProfile()</code>方法之后，看起来我们实现了parameter对象模式，就像在模板中使用参数一样。</p><p id="0716" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，参数对象模式实现的可读性稍强一些。因为我们很清楚要传递给管道的参数是什么，也就是说，我们知道是否要传递<code class="fe nn no np nq b">weight</code>、<code class="fe nn no np nq b">height</code>、<code class="fe nn no np nq b">wins</code>和<code class="fe nn no np nq b">losses</code>值。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="562d" class="ny md it nq b gy oo op l oq or">{       <br/>        name: fighter.bio.name,<br/>        wins: fighter.mmaRecord.wins,<br/>        losses: fighter.mmaRecord.losses,<br/>        weight: fighter.bio.weight,<br/>        height: fighter.bio.height <br/>}  | fighterProfile</span></pre><p id="a7ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你和直接传递参数相比。用冒号来传递这么多参数感觉不自然。不像前面的例子那么容易理解。</p><pre class="kj kk kl km gt ok nq ol om aw on bi"><span id="cb20" class="ny md it nq b gy oo op l oq or">fighter.bio.name | fighterProfile:<br/>        fighter.mmaRecord.wins:<br/>        fighter.mmaRecord.losses:<br/>        fighter.bio.weight:<br/>        fighter.bio.height</span></pre><p id="92d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p></div></div>    
</body>
</html>