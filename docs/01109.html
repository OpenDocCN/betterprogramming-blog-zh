<html>
<head>
<title>A Beginner’s Guide to the Gmail API and Its Documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Gmail API及其文档的初学者指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-beginners-guide-to-the-google-gmail-api-and-its-documentation-c73495deff08?source=collection_archive---------0-----------------------#2019-08-15">https://betterprogramming.pub/a-beginners-guide-to-the-google-gmail-api-and-its-documentation-c73495deff08?source=collection_archive---------0-----------------------#2019-08-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0772" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们在Gmail的基础上构建一些很酷的东西吧！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/aa2eef638049bdbbb7cb649a47ba67a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6Ulat2s3zZ3x3uD6AilRA.png"/></div></div></figure><p id="acf2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">编程的一个关键部分是与不同的应用程序编程接口(API)进行通信的能力。如果你访问<a class="ae ln" href="https://cloud.google.com/monitoring/api/apis-explorer" rel="noopener ugc nofollow" target="_blank">谷歌应用编程接口浏览器</a>，你会发现一个巨大的应用编程接口库，包括他们所有知名的应用程序，如Gmail、Drive和Calendar。简单地说，API允许您通过HTTP请求向服务获取或发送数据。</p><p id="4f0e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些API的用法和文档一开始可能有点复杂，但是一旦你学会了，你就能把你的知识应用到大多数Google应用程序中。</p><p id="80f7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我决定写一本如何使用和理解Gmail API的初学者指南。该指南是基于文档的，这意味着您将学习寻找什么以及如何阅读它，而不仅仅是复制代码。由于大多数其他Google API参考文档都是相似的，一旦你知道如何真正阅读这些文档，你就会发现适应它们要容易得多。这将允许你写自己的代码，并真正理解你在做什么。</p><p id="299c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本指南中使用了Python 3，但是在其他语言中的用法应该也很相似。</p><h1 id="eb51" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">快速入门</h1><p id="2705" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">谷歌通常会提供一个快速入门指南来简化授权。本指南将使用快速入门指南中的授权，这意味着它会有一些限制，但对于我们的目的来说已经足够了。获得API密匙的另一种方法是创建一个新项目，这有点复杂。</p><p id="b521" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Python快速入门指南可以通过这个链接访问<a class="ae ln" href="https://developers.google.com/gmail/api/quickstart/python" rel="noopener ugc nofollow" target="_blank">，但是我会继续给你展示这里的一切是如何完成的。</a></p><p id="31d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是快速入门的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/74677c2e99809cbfaf187b13233e52d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZM4CSq5j9b7kNr7ZCnhGwQ.png"/></div></div></figure><h1 id="07e6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">打开Gmail API</h1><p id="3cfa" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">第一步是启用API并下载在我们的项目中使用的凭证。按下“启用Gmail API”<em class="mm"/>按钮，我们将打开一个新窗口，显示我们的凭据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/d8ee2ca380e3e63f0c0ea835379bb9a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdsZCQWFkIXWjdbrq5-DHg.png"/></div></div></figure><p id="a155" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将显示我们的客户ID和客户密码<em class="mm"> </em>。选择要下载的客户端配置。将保存一个文件，名为<code class="fe mo mp mq mr b">credentials.json</code>。我们将把它保存到代码所在的文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/97f666545c3a992e6002f9583ecccd80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*4Ve-ijpUOxE6J1Y9ThepdA.png"/></div></figure><h1 id="de00" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">安装库</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/a7384013883ad918daa55c0af2c8510d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPmZbjJSEtQGtw84EdMAcg.png"/></div></div></figure><p id="e088" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">安装所需的库是通过Google提供的一个简单的pip命令完成的。我也把它贴在了下面。我建议在虚拟环境中做这件事。但是，这不在本指南中介绍。</p><pre class="kg kh ki kj gt mu mr mv mw aw mx bi"><span id="326e" class="my lp iq mr b gy mz na l nb nc">pip install — upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</span></pre><h1 id="41bd" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">首次运行—允许访问</h1><p id="cb4d" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在我们继续遵循指南之前，我们需要允许我们的脚本访问Gmail API。让我们从制作实际的脚本开始。</p><p id="b189" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建一个<em class="mm">。项目目录中的py </em>文件(与带有<code class="fe mo mp mq mr b">credentials.json</code>的目录相同)。为了方便起见，姑且称之为<code class="fe mo mp mq mr b">gmail.py</code>。</p><p id="d3f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将示例代码从Python快速入门复制到<code class="fe mo mp mq mr b">gmail.py</code> <em class="mm"> </em>文件中。暂时忽略代码，稍后我们将深入研究它。我们只需要在第一次运行时允许访问——它也将为以后的所有运行保存。</p><p id="8133" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">像平常一样运行这个文件，你就可以在网络浏览器中登录你的谷歌账户了。</p><pre class="kg kh ki kj gt mu mr mv mw aw mx bi"><span id="e15c" class="my lp iq mr b gy mz na l nb nc">python gmail.py</span></pre><p id="735f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">登录您的帐户。将显示一条警告，说明该应用程序未经验证。由于我们使用快速入门方法，我们的应用程序尚未通过验证。现在只需点击图片上显示的链接继续并允许访问。</p><div class="kg kh ki kj gt ab cb"><figure class="nd kk ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/46c22211459892ea5b7e4b058068e0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*G-MWaFDYhIQ1573iRCGwtg.png"/></div></figure><figure class="nd kk nj nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b3d9bb77735589d3db7bbe73692f158e.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*bS5oC8evV6jqKNFtwnTmvw.png"/></div></figure><figure class="nd kk nk nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6cb123830b8536b8c4a328c58d2936ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*2wqor9ubBbVY1eevIOdddQ.png"/></div></figure></div><h1 id="bd7b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">理解代码</h1><p id="c6a6" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">示例代码一开始可能看起来让人不知所措，但是我将把它分成更小的部分以保持简单。到最后，你会发现其实并没有那么难。</p><h2 id="eca7" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">进口和范围</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/d7136cd7816e99bff338dd17059d9d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DaHBPVvcjHKHZcCKePZ6ww.png"/></div></div></figure><p id="232b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与任何其他Python脚本一样，我们将从导入开始。大多数导入都是用<code class="fe mo mp mq mr b">credentials.json</code>文件进行授权的。所有这些都是默认提供的，所以我们不需要做任何改变。</p><p id="3f26" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，范围是最重要的部分。这个变量稍后会被修改，但是现在，我们将满足于提供的默认范围。</p><p id="9480" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是说，它将允许我们从<code class="fe mo mp mq mr b">gmail.readonly</code>范围访问数据。还有更多的范围，这允许我们对Gmail API进行一系列的操作和请求。其他一些请求需要其他作用域。</p><p id="de69" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">稍后，我们将添加另一个作用域来使用其他功能。</p><h2 id="5595" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">凭证</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/dcef294bb44b59cb5658f4e76efa20e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_d1IOUoZlQpTSGrCtJ8hsA.png"/></div></div></figure><p id="eccb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">授权可能是对脚本的最高级部分。我们现在不会深入讨论这个问题，因为它已经被配置为开箱即用。</p><p id="e5c8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是获取您从<code class="fe mo mp mq mr b">credentials.json</code>下载的凭证的部分。首先，它寻找一个<code class="fe mo mp mq mr b">token.pickle</code>文件。这是在您第一次允许访问您的帐户时创建的文件。如果文件已经存在，它会从中获取凭证，这意味着您不必多次允许访问。</p><p id="9fcc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果<code class="fe mo mp mq mr b">token.pickle</code>文件不存在，它会从您的<code class="fe mo mp mq mr b">credentials.json</code>文件加载凭证。这需要您允许通过web浏览器访问，就像您之前所做的那样。</p><p id="89a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这两种情况下，凭证都保存在<code class="fe mo mp mq mr b">creds</code>变量中以备后用。</p><h2 id="713a" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak"> API </strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/b262ffe42bd3449e245a781eddf35257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FGXnbjWbRSYwinAkXhavDg.png"/></div></div></figure><p id="ff5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是脚本有趣的部分:从Gmail API获取数据的部分。如你所见，它实际上并没有那么先进。这是我们将深入探讨的部分。</p><p id="39dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mo mp mq mr b">service</code>是使用之前导入的<code class="fe mo mp mq mr b">build</code>函数构建的。我们之前得到的凭证作为参数传递给它。</p><p id="e66a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后使用<code class="fe mo mp mq mr b">service</code>获取授权账户的所有Gmail标签。数据被保存到<code class="fe mo mp mq mr b">results</code>变量。</p><p id="3fed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后一行将所有标签保存到<code class="fe mo mp mq mr b">labels</code>变量中。它们被格式化为列表，因此如果列表为空，则指定默认值(<code class="fe mo mp mq mr b">[]</code>)。</p><p id="6ae8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本指南的下一部分将查看文档来理解这一点。</p><h2 id="d978" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">结果</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/6b4d66cb890944793a7f6fc31f247304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2mDGxSl5GlFyvJ_6pJyeA.png"/></div></div></figure><p id="0181" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，打印标签名称(如果有)。</p><h1 id="313e" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">理解文档</h1><p id="7438" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">这就是快速入门示例代码。但是，不看文档没有太大意义。这一部分将向您展示如何真正理解代码中所写的内容，以及如何使用文档来编写自己的代码。</p><p id="f104" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，让我们转到“参考”<strong class="kt ir"> </strong>选项卡来访问文档。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/b5e2330016d56068bc2ae80f2c1ba5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*cKX-uX8EnrqbFIhZhJ91Lg.png"/></div></figure><p id="dfcd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">左侧显示了一个大的摘要菜单。它包含了很多信息，但在接下来的步骤中会非常有用。</p><p id="db39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们使用标签时，让我们选择<code class="fe mo mp mq mr b">Users.labels</code>部分和<code class="fe mo mp mq mr b">Overview</code>部分来获得一些关于标签的基本信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/7d11e35bfa15d752eafcaf26e1e78b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*L-0XnE0WLYAXeGioiY1vig.png"/></div></figure><p id="ad0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">迎接我们的是这个屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/02f59043813ce7705b36f83de419e453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4bfXKfw7KX1W_GkZJwj3vw.png"/></div></div></figure><p id="5f1a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">说明方法列表以及标签的<em class="mm">资源表示</em> <strong class="kt ir"> </strong>位于页面末尾的文本。信息通常以JSON的形式发送，像Python中的字典一样处理。</p><p id="da6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是我们获取的每个标签包含的信息。如果我们继续向下滚动，应该会看到一个表，其中提供了字典中每个属性的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/7b1051127cf3751b313909300592de3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YXrKqRLQdCmMyCFkX2Olw.png"/></div></div></figure><p id="9321" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我突出显示了名称部分，因为我们以前使用过它。我们在之前打印标签时访问了标签的<code class="fe mo mp mq mr b">name</code>。像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/5474c8376e049cd197c8aeb474435dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSISXp-VSOnfK3I1iI5OdQ.png"/></div></div></figure><p id="f420" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这种情况下，<code class="fe mo mp mq mr b">label</code>是一个字典，我们访问其中的<code class="fe mo mp mq mr b">name</code>属性。我们可以访问上面提到的任何其他属性，但是现在，<code class="fe mo mp mq mr b">name</code>就可以了。</p><p id="aee4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">需要注意的是<code class="fe mo mp mq mr b">name</code>是一个字符串，但是有些值可能是整数。在文档中很容易找到。</p><p id="fee2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们继续向下滚动到页面的底部，我们会看到所有的方法。提供了每种方法的简短描述，以及指向文档的超链接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/803911511d99f2cc9593966c14bd4f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fiTsokRfDRgpO9JpcgEbw.png"/></div></div></figure><p id="93d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">根据你想做的事情，你会使用不同的方法。快速入门示例使用<code class="fe mo mp mq mr b">list</code>方法获取Gmail帐户上的所有标签。如果我们想要创建一个新标签，我们将使用<code class="fe mo mp mq mr b">create</code>方法，我们将在后面实际执行。</p><p id="04fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们回到顶部，看看左边的概述，您会看到每个方法都有自己的菜单按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7a1e48b04e346bfcd197adc8a6245df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*-L0nw6sol46cDfw5CfOJhA.png"/></div></figure><h2 id="c9ed" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">列表方法</strong></h2><p id="6fcb" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">让我们仔细看看列表方法，我们以前通过点击菜单栏上的<code class="fe mo mp mq mr b">list</code>来使用它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/83dc4b8aa47a7d2ec930345d9b92360a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNvvhombnBYy1EfrZGvMOQ.png"/></div></div></figure><p id="edad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这提供了很多有用的信息。首先，向标签URL发送一个HTTP GET请求来获取所有标签:</p><pre class="kg kh ki kj gt mu mr mv mw aw mx bi"><span id="840f" class="my lp iq mr b gy mz na l nb nc">https://www.googleapis.com/gmail/v1/users/userId/labels</span></pre><p id="a166" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，我们可以使用Python中的<code class="fe mo mp mq mr b">requests</code>库来手动完成这项工作。然而，在本指南中，我们将使用提供的Google库。</p><p id="1b8b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">需要授权，但我们之前已经处理了这部分。</p><p id="40c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，同样重要的是，我们可以传递给<code class="fe mo mp mq mr b">list</code>方法的参数。如你所见，<code class="fe mo mp mq mr b">userId</code>是我们唯一能通过的。</p><p id="decc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mo mp mq mr b">userId</code>是代表用户电子邮件地址的字符串。值<code class="fe mo mp mq mr b">me</code>可以替代地用于指示被认证的用户。我们实际上在示例代码中使用了<code class="fe mo mp mq mr b">me</code>值。</p><p id="cb0e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将很快对此进行深入研究，但是首先，我们将通读<code class="fe mo mp mq mr b">list</code>方法文档的其他部分。</p><h2 id="b5b4" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">授权和范围</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/0e86609c77e6e760da42b82b6151f088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtM3AI9S7ROYG7-dFy1yuA.png"/></div></div></figure><p id="90a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">范围可能听起来很熟悉，这是因为我们之前简单地提到过它。要访问<code class="fe mo mp mq mr b">list</code>方法，至少需要一个提供的作用域。</p><p id="23f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如您所见，我们已经在代码的顶部添加了<code class="fe mo mp mq mr b">gmail.readonly</code>范围。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/a0a246a16c9f8574f8da42f6965560b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QiNaL9tlnQUZGV03vhK3tw.png"/></div></div></figure><h2 id="d4fc" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated"><strong class="ak">响应</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/5489215f401e77744c005867ca842a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ScFzWLx1vzS73TBLVkDUg.png"/></div></div></figure><p id="5bea" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后一部分向我们展示了成功的请求将返回什么:JSON格式的主体。所有标签存储为列表，可通过<code class="fe mo mp mq mr b">labels</code>键访问。基本上是这样:</p><pre class="kg kh ki kj gt mu mr mv mw aw mx bi"><span id="0496" class="my lp iq mr b gy mz na l nb nc">list_of_labels = response["labels"]</span></pre><p id="695f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就像在Python中使用普通字典一样。</p><h1 id="20e1" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">提出列表请求</h1><p id="5553" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">现在我们已经从文档中收集了更多的信息，让我们回头看看代码的API部分。</p><p id="3497" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，<code class="fe mo mp mq mr b">service</code>是用我们的凭证打造的。这只是用于发出请求的基础(使用我们之前看到的方法)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/822b9426364a3f9288c1dfcc224ea9c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_MsWsepVs5Y51nPLlDqnw.png"/></div></div></figure><p id="e0e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，我们实际上使用list方法通过这段代码发出请求。一旦我们浏览了文档，现在看起来可能会更熟悉一些。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/56b257341d483500d6960a38a103bcec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91CEaMVUGVNuAnxWns-pVQ.png"/></div></div></figure><p id="92ec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了更容易地向您展示语法是如何构建的，我用颜色编码了代码和菜单，以向您展示API是如何工作的。</p><div class="kg kh ki kj gt ab cb"><figure class="nd kk oh nf ng nh ni paragraph-image"><img src="../Images/b45ed571b5d401d2662c5b3a4d024a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*W_C0IJhZpD8fsUIPOZvQ0Q.png"/></figure><figure class="nd kk oi nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/059b8d31db2a1d16157601bd26f730a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1632/format:webp/1*yWPFL2hijRc_ms7Wg_vUgw.png"/></div></figure></div><p id="19da" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们从<code class="fe mo mp mq mr b">service</code>变量开始。通过简单地遵循树状结构，一个方法接一个方法，我们将最终到达列表方法。</p><p id="e356" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们更仔细地看看<code class="fe mo mp mq mr b">list</code>方法，尤其是我们熟悉的<code class="fe mo mp mq mr b">userId</code>参数，它将<code class="fe mo mp mq mr b">me</code>作为参数传递。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/bdce704df76e2fef2ca78910138aaf37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KojfZwqfQdWnNnJEI2yVNw.png"/></div></div></figure><p id="d1ca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们向上滚动到<code class="fe mo mp mq mr b">list</code>方法文档的顶部，我们会看到我们之前谈到的参数的概要。指定了<code class="fe mo mp mq mr b">userId</code>参数，以防我们不知道它是什么。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/7737ffb337a46bff6c5b8c4ca7583f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chQYaFuL3HKx57PNTXrOQA.png"/></div></div></figure><p id="bd81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们只是将它作为参数传递给代码中的<code class="fe mo mp mq mr b">list</code>方法。</p><p id="7bbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能还记得，根据文档的响应部分，请求应该返回一个字典。我们将它存储在<code class="fe mo mp mq mr b">results</code>变量中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/5489215f401e77744c005867ca842a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ScFzWLx1vzS73TBLVkDUg.png"/></div></div></figure><p id="38f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了访问标签，我们使用字典的<code class="fe mo mp mq mr b">.get</code>方法。我们传递的第一个参数是我们想要得到的东西的名称(<code class="fe mo mp mq mr b">labels</code>)，第二个参数是如果它没有找到任何具有该名称的东西，我们得到的返回。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/5cea3cbe6f0ef71e8422a848f0a459b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RHuCGcDTHA9hseyiNH-rw.png"/></div></div></figure><p id="c2f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果没有名为<code class="fe mo mp mq mr b">labels</code>的键，将返回一个空列表。</p><p id="8b0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是阅读文档的基本方式，也是<code class="fe mo mp mq mr b">list</code>方法的工作方式。让我们试着按照API文档从头开始做些别的事情。</p><h1 id="e0dc" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">创建新标签</h1><p id="7942" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">让我们利用新发现的知识，做一些新的事情，从零开始(几乎)。</p><p id="53b3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从文档中删除所有与API相关的代码。只保留导入、范围和凭证处理。我们将尝试通过API创建一个新标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f0669872cf4fae7d65ab2f05dc5d48c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*N0qMsmZcIJGvxrZ-z3JaEw.png"/></div></figure><p id="fe9a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们转到标签的概述页面。向下滚动到方法，看看我们需要使用哪一个来创建我们自己的方法。</p><div class="kg kh ki kj gt ab cb"><figure class="nd kk ol nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a32596e0cd1c2f0045733646e17f735e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1678/format:webp/1*Wxk5gAfa3DMuE7sNHE_J6g.png"/></div></figure><figure class="nd kk om nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/ff1996ab4bfa1e6071c5e7628ef78848.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*46D2EVnXysPTradWR9Qonw.png"/></div></figure></div><p id="70d1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能已经注意到，我们将使用一个名为<code class="fe mo mp mq mr b">create</code>的方法。去那个方法的文档看看我们需要什么。</p><p id="9e7c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从授权和范围开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/4d0b173b8ae11a586fd0d1511ad737b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUKVTjr-6qcJa56xk3CEdw.png"/></div></div></figure><p id="b804" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如您所见，我们至少需要三个现有范围中的一个。然而，我们的代码中没有任何一个。让我们添加<code class="fe mo mp mq mr b">gmail.labels</code>范围。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/39a2f12351af28f9f7c46c94f793de44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nqtecorR_PVjfMnc0j7og.png"/></div></div></figure><p id="837c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mo mp mq mr b">SCOPES</code>变量接受一个列表，这意味着我们可以简单地用逗号分隔来添加新的范围。</p><p id="cf49" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于旧的授权存储在<code class="fe mo mp mq mr b">token.pickle</code>文件中(只要该文件存在就用于授权)，我们需要删除它并用新的范围重新创建它。</p><p id="9127" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用<code class="fe mo mp mq mr b">python gmail.py</code>再次运行Python应用程序进行重新授权，但是，可以看到一个微小的变化:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/3ba9eece48e9ca408cd7a2956bcd1830.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*ds0-62GI7iv5MqduIsYKyg.png"/></div></figure><p id="245a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">添加了新的依赖项。由于瑞典语的原因，你可能不理解，但它基本上说的是“处理标签”所以新的作用域给我们的应用程序增加了一个新的依赖项。</p><h2 id="7bbd" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated">代码</h2><p id="d8e3" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">如果我们看一下<code class="fe mo mp mq mr b">create</code>方法文档的顶部，我们可以看到它与<code class="fe mo mp mq mr b">list</code>方法非常相似。它需要授权，发出HTTP POST请求，并且需要一个<code class="fe mo mp mq mr b">userId</code>参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/4661d230ba128cba1b6f715f8ec108f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lRRp4YiL4av0dNzJ4Gb3RQ.png"/></div></div></figure><p id="d419" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是我们需要在请求中传递实际的标签。如果我们向下滚动到请求体，我们将看到如何做到这一点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/b1108e6e5d7c2de11cc445ab77235f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cf-bScqmtyapkFk9qQutyA.png"/></div></div></figure><p id="f7f6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的请求正文中，应该有一个至少具有以下属性的标签来创建标签:</p><ul class=""><li id="e305" class="or os iq kt b ku kv kx ky la ot le ou li ov lm ow ox oy oz bi translated">标签可视性</li><li id="dc2e" class="or os iq kt b ku pa kx pb la pc le pd li pe lm ow ox oy oz bi translated">邮件列表可见性</li><li id="4e91" class="or os iq kt b ku pa kx pb la pc le pd li pe lm ow ox oy oz bi translated">名字</li></ul><p id="682a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以在文档中了解它们应该属于哪种类型，以及它们是什么。</p><p id="df9c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就像我们在字典中接收数据一样，数据应该作为字典发送。</p><h2 id="2122" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated">创建标签</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/d6e55377edbaf14a90cc7d78001c152b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7NYvPMJnEvrerP45au8RQ.png"/></div></div></figure><p id="d130" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一个创建标签的简单函数。它需要一个名称和另外两个可选参数。如果没有指定，<code class="fe mo mp mq mr b">show</code>和<code class="fe mo mp mq mr b">labelShow</code>将被默认使用。</p><p id="2fb3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">标签被创建为字典，然后被返回。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/c15707f43733576e6d3c20a787e9ca67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVo9q8H4Ttqjyw-On-rWWQ.png"/></div></div></figure><p id="4704" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要创建名为<code class="fe mo mp mq mr b">Test</code>的标签，我们将使用上面的语法。</p><h2 id="8c44" class="my lp iq bd lq nl nm dn lu nn no dp ly la np nq ma le nr ns mc li nt nu me nv bi translated">向API发出请求</h2><p id="b3e9" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">是时候向API发出实际请求，并将我们的标签传递到我们的Gmail帐户了。让我们遵循和上次一样的程序。</p><p id="e2cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我用颜色标记了到<code class="fe mo mp mq mr b">create</code>方法的路径。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/da8290781b2625301574b49f930177c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*ZDrK7YXkrOQEmZ4wnA3Bgg.png"/></div></figure><p id="0eb9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与我们上次的API调用相比，我们没有太大的变化。我们从之前创建的<code class="fe mo mp mq mr b">service</code>开始，添加每个方法，直到到达<code class="fe mo mp mq mr b">create</code>方法。然而，我们在这方面还没有完全完成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/d7bcc052d2c08ee0e8d553e9a68577c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4AvizoiMDFJ21bVKDOkIQ.png"/></div></div></figure><p id="1098" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们滚动到文档的参数<strong class="kt ir"> </strong>部分，我们会看到我们需要将<code class="fe mo mp mq mr b">userId</code>作为参数传递，就像我们的最后一个调用一样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/7737ffb337a46bff6c5b8c4ca7583f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chQYaFuL3HKx57PNTXrOQA.png"/></div></div></figure><p id="2264" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们再次使用<code class="fe mo mp mq mr b">me</code>，就像文档建议的那样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/3455a0447e1939bc7f68dd0f433e23d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*shmtm6JubEoLe8c7SMs0Zg.png"/></div></div></figure><p id="3139" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们仍然缺少一些东西:实际的标签。我们还需要在请求中传递标签。让我们再次向下滚动到请求正文。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/1be5851e42a532caf2f5fa6ac8c6abab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Auhg-AF_hvawmH2T-rte6w.png"/></div></div></figure><p id="a279" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们已经创建了具有所有必需属性的标签，所以我们需要在请求体中传递它。这可以通过简单地向名为<code class="fe mo mp mq mr b">body</code>的<code class="fe mo mp mq mr b">create</code>方法添加另一个参数来实现。</p><p id="04a0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们在其中传递我们的<code class="fe mo mp mq mr b">label</code>对象。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/884f69ee9445b5417d50695d9a034df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLcsDZFcRFP6UtyMwhPl2A.png"/></div></div></figure><p id="790d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">实际的调用已经完成，但是为了添加一些错误检查，让我们将它包装到一个try/except语句中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/3cdc29bd191c17c13cbe7eb19766fb5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mr1KQMjm0ltujEAow6eA5g.png"/></div></div></figure><p id="f64d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果出现问题，错误消息将会打印在我们的控制台上。如果一切按计划进行，将打印出<code class="fe mo mp mq mr b">Label created</code>(并且标签将被创建)。</p><p id="8f0b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，让我们回头看看我们为创建新的API请求而创建的代码部分:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/87d0ce41b040615033353243273580d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*csDxXfIBHowGghU2BG-DUw.png"/></div></div></figure><p id="5b33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">API处理实际上并不困难。实际的获取并不需要很多行代码——棘手的部分是授权，我们甚至不需要自己处理。</p><p id="02dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我们用<code class="fe mo mp mq mr b">python gmail.py</code>保存并运行代码，我们的Gmail帐户中应该会创建一个新标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/2ce45a5bcc7fd2ce2a5a89e1559dba13.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*esN51KWw8J7-nkiZJXkhzw.png"/></div></figure><h1 id="8c46" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated"><strong class="ak">搞定！</strong></h1><p id="c2da" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">我们成功地从零开始对Gmail进行了API调用，并创建了自己的标签。同样的基本原则也适用于Gmail API和其他Google APIs中的大多数其他方法。</p><p id="51a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请随意尝试提出其他要求，以便掌握诀窍。最好的学习方法是练习。一旦你开始理解文档，创建你自己的调用并不困难。</p><p id="c42e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">尝试创建自己的邮件草稿，或者基于查询获取所有收件箱邮件——所有内容都在文档中指定。</p><p id="6ad8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你想看看我们例子的最终结果，我已经在GitHub上提供了<a class="ae ln" href="https://github.com/banjoanton/gmail-api-guide/blob/master/gmail.py" rel="noopener ugc nofollow" target="_blank">的完整代码</a>。祝你的项目好运，编码愉快！</p></div></div>    
</body>
</html>