<html>
<head>
<title>Git Gud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">吉特古德</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/git-gud-dbe567c05e2a?source=collection_archive---------15-----------------------#2022-06-08">https://betterprogramming.pub/git-gud-dbe567c05e2a?source=collection_archive---------15-----------------------#2022-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3878" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建高性能git命令</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dd05e163a0768542cb2079502e6c3438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*go63AMUT6HdRCTEF"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@synkevych?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">罗曼·辛克维奇·🇺🇦</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="95e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经历缓慢的加工？本文最初是在规模越来越大的monorepo的成长过程中撰写的，在mono repo中，git命令可能需要10秒以上才能执行。对于做大量上下文切换的开发人员，以及有许多贡献者的回购——这就增加了。</p><p id="db61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有很多前言。如果您只是在寻找改进，请随意向下滚动到“好的，那么，我如何获得gud？”部分。</p><h1 id="30fc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">见过慢回购吗？</h1><p id="56af" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="mp">在完全安装的5.9GB回购上测试</em></p><h2 id="e6e2" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">第一次尝试(git状态)</h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="bc0e" class="mq lt iq nd b gy nh ni l nj nk">It took 10.88 seconds to enumerate untracked files. ‘status -uno’ may speed it up, but you have to be careful not to forget to add new files yourself (see ‘git help status’).</span><span id="88e2" class="mq lt iq nd b gy nl ni l nj nk">nothing to commit, working tree clean</span><span id="ef65" class="mq lt iq nd b gy nl ni l nj nk">git status 0.45s user<strong class="nd ir"> </strong>2.25s system 24% cpu <strong class="nd ir">11.109 total</strong></span></pre><h2 id="0884" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">第二次尝试(git gc) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="0745" class="mq lt iq nd b gy nh ni l nj nk">It took 6.87 seconds to...</span><span id="de52" class="mq lt iq nd b gy nl ni l nj nk">git status 0.41s user 1.99s system 33% cpu <strong class="nd ir">7.137 total</strong></span></pre><h2 id="ac46" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">第三次尝试(git gc - aggressive) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="3385" class="mq lt iq nd b gy nh ni l nj nk">It took 3.55 seconds to...</span><span id="bf99" class="mq lt iq nd b gy nl ni l nj nk">git status 0.42s user 2.10s system 69% cpu <strong class="nd ir">3.658 total</strong></span></pre><h2 id="d399" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">第四次尝试(git状态-uno) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="24a1" class="mq lt iq nd b gy nh ni l nj nk">nothing to commit (use -u to show untracked files)</span><span id="ce89" class="mq lt iq nd b gy nl ni l nj nk">git status -uno 0.06s user 0.56s system 556% cpu <strong class="nd ir">0.112 total</strong></span></pre><h2 id="1a74" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">第五次尝试(fsmonitor-watchman) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="69fe" class="mq lt iq nd b gy nh ni l nj nk">nothing to commit, working tree clean</span><span id="d096" class="mq lt iq nd b gy nl ni l nj nk">git status 0.31s user 1.02s system 92% cpu <strong class="nd ir">1.435 total</strong></span></pre><h1 id="a7e5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">git基础知识一览</h1><h2 id="0025" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git克隆</strong></h2><p id="ffcc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="mp"> O(n) </em>其中“n”包括历史上的每一次提交，这意味着它包括曾经提交给存储库的每一个文件——即使当前已被删除。它还包括分支引用的每个提交，这可能包括标准“干净”回购检出中不存在的附加文件。</p><p id="6f9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些可以分别用<code class="fe nm nn no nd b">--depth</code>和<code class="fe nm nn no nd b">--branch</code>调谐。但是这些克隆标志可能仅在用户不需要历史和/或不需要检验不同分支的某些情况下有用。</p><p id="9e14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢一位同事在这一部分提供支持信息！</p><h2 id="4566" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git状态</strong></h2><p id="cb94" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">居然跑了两次<code class="fe nm nn no nd b">git diff</code><em class="mp">。一次将HEAD与staging area进行比较，另一次将staging与您的工作树进行比较。</em></p><p id="fb24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据官方文件，<code class="fe nm nn no nd b">git diff</code>可以使用以下四种算法中的任意一种:<code class="fe nm nn no nd b">--diff-algorithm={patience|minimal|histogram|myers}</code>。默认是Myers diff算法，它在理论上的<em class="mp"> O(ND) </em>时间和空间中运行，其中N =输入长度，D =编辑距离。它的预期运行时间是<code class="fe nm nn no nd b">O(N+D²)</code>。不可怕，但是运行时间在大型回购中会被严重放大。</p><p id="4724" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://blog.jcoglan.com/2017/02/12/the-myers-diff-algorithm-part-1/" rel="noopener ugc nofollow" target="_blank">Myers diff算法:第1部分—If工作原理</a></p><h2 id="5acc" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git添加</strong></h2><p id="a240" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">将您的工作树添加到暂存区，必须快速进行<em class="mp"> O(n) </em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/eef2d447d83769b8cf7790225efff8e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ezazSotSCekpOM-56aUT8A.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">你的git zoomin</p></figure><p id="69d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">指定路径<code class="fe nm nn no nd b">git add &lt;path&gt;/*</code>而不是<code class="fe nm nn no nd b">git add --all</code>显然更快</p><h2 id="1036" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git提交</strong></h2><p id="cea5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">像<code class="fe nm nn no nd b">git add</code>一样，提交应该很快，但是当你的repo有一个5种语言的格式化程序，2个类型检查器，和清理脚本捆绑在一起成为预提交钩子膨胀软件时，提交就会陷入困境。<em class="mp">阿(</em> ∞ⁿ <em class="mp"> ) </em></p><p id="3e35" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果<code class="fe nm nn no nd b">git commit</code>出问题了，你也可以运行<code class="fe nm nn no nd b">git commit -n</code>来跳过提交钩子</p><h2 id="9039" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git推/拉</strong></h2><p id="9743" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">取决于你的isp的感受。当尝试基于您的首选策略进行重置/合并时，Pull也会进行区分。</p><h2 id="00c9" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> git rebase/merge </strong></h2><p id="e07b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Rebase和merge具有类似的效果，并且编写方式类似。合并策略选项:<code class="fe nm nn no nd b">--strategy={ort|resolve|recursive|octopus|ours|subtree}</code>。当拉一个分支时，默认的合并策略是<code class="fe nm nn no nd b">ort</code>(表面上是递归的孪生兄弟)，当处理2+头时是<code class="fe nm nn no nd b">octopus</code>。注<code class="fe nm nn no nd b">ort</code>在2021年第三季度取代了旧的默认<code class="fe nm nn no nd b">recursive</code>方法。在引擎盖下，<code class="fe nm nn no nd b">ort</code>和<code class="fe nm nn no nd b">recursive</code>也用默认的myer diffing算法调用<code class="fe nm nn no nd b">git diff</code>，这就是为什么它也可能很慢。</p><p id="a70d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://git-scm.com/docs/git-merge#_merge_strategies" rel="noopener ugc nofollow" target="_blank"> git合并策略</a></p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><blockquote class="nx ny nz"><p id="8ed3" class="kw kx mp ky b kz la jr lb lc ld ju le oa lg lh li ob lk ll lm oc lo lp lq lr ij bi translated">TL；dr，任何需要读写你的索引的操作都会对你的索引执行一次<strong class="ky ir">完整的</strong>读写，不管你实际更改了多少个文件。</p></blockquote><p id="32b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有时暂存区/索引被称为缓存。</p><h1 id="3a77" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">统计，为了好玩📈</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/fc3393a97da461984aefa0d55911f87c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ChDQGGfNwCfc9nxUD_c2g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">monorepo示例</p></figure><p id="d492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">典型主动回购大小:<strong class="ky ir"> 5.9gb </strong>(安装后)<br/>全新克隆回购大小:<strong class="ky ir"> 3.0gb </strong></p><p id="5b7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nm nn no nd b">.git</code>大小(一致):<strong class="ky ir"> 2.4gb </strong>。拆开它进一步揭示了一个<strong class="ky ir"> 2.3gb </strong> <code class="fe nm nn no nd b">.git/objects/pack</code>，它充当回购历史的数据库。</p><h1 id="924a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">好吧，那么，我怎么得到gud？🧐</h1><h2 id="c02e" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 1。启用fsmonitor-watchman </strong></h2><p id="ad41" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://dropbox.tech/application/speeding-up-a-git-monorepo-at-dropbox-with--200-lines-of-code" rel="noopener ugc nofollow" target="_blank">用&lt; 200行代码加速Dropbox上的Git mono repo—Dropbox</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/36319e0f594f83682de28fefa5daa120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tga9GBcrUPuH93zrpIMf3A.png"/></div></div></figure><p id="221e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe nm nn no nd b"><a class="ae kv" href="https://github.com/git/git/blob/master/templates/hooks--fsmonitor-watchman.sample" rel="noopener ugc nofollow" target="_blank">git/hooks — fsmonitor-watchman.sample</a></code>启用(已经在您的repo中！)</p><p id="2bfe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.<code class="fe nm nn no nd b">cp .git/hooks/fsmonitor-watchman.sample .git/hooks/fsmonitor-watchman</code> <br/> 2。<code class="fe nm nn no nd b">git config core.fsmonitor .git/hooks/fsmonitor-watchman<br/></code> 3。<code class="fe nm nn no nd b">git update-index --fsmonitor</code></p><p id="6ee1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意事项:</p><ul class=""><li id="1683" class="of og iq ky b kz la lc ld lf oh lj oi ln oj lr ok ol om on bi translated">你需要安装<a class="ae kv" href="https://facebook.github.io/watchman/docs/install.html" rel="noopener ugc nofollow" target="_blank">看守人</a></li><li id="a49a" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ok ol om on bi translated">如果你在<em class="mp"> 3/22/2020 </em>之前克隆了你的回购，或者你的git是&lt; <em class="mp"> v2.26 </em>，那么你有一个过时的<code class="fe nm nn no nd b">fsmonitor-watchman.sample</code>文件。您可以从源代码中复制更新的版本，或者更新<code class="fe nm nn no nd b">git</code>然后<code class="fe nm nn no nd b">git init</code>一个空的repo来获得它。</li><li id="f36f" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ok ol om on bi translated">锈实现<a class="ae kv" href="https://github.com/jgavris/rs-git-fsmonitor" rel="noopener ugc nofollow" target="_blank">https://github.com/jgavris/rs-git-fsmonitor</a>更快</li></ul><h2 id="f110" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 2。使用未跟踪缓存</strong></h2><p id="4421" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://git-scm.com/docs/git-update-index" rel="noopener ugc nofollow" target="_blank">https://git-scm.com/docs/git-update-index</a></p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="323e" class="mq lt iq nd b gy nh ni l nj nk">git update-index --test-untracked-cache</span></pre><p id="4a56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果返回OK，运行:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="1470" class="mq lt iq nd b gy nh ni l nj nk">git config core.untrackedCache true &amp;&amp; git update-index --untracked-cache</span></pre><h2 id="91d3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 3。使用分割索引</strong></h2><p id="4cc5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://git-scm.com/docs/git-update-index" rel="noopener ugc nofollow" target="_blank">https://git-scm.com/docs/git-update-index</a></p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="f9e3" class="mq lt iq nd b gy nh ni l nj nk">git config core.splitIndex true &amp;&amp; git update-index --split-index</span></pre><h2 id="89f3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 4。增加虚拟节点缓存大小</strong></h2><p id="f863" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://chromium.googlesource.com" rel="noopener ugc nofollow" target="_blank">https://chromium.googlesource.com</a></p><p id="4213" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认的内核虚拟节点大小是<code class="fe nm nn no nd b">kern.maxvnodes</code> : <em class="mp"> 263168 (257 * 1024) </em>。要为您的会话增加，请运行:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="f60a" class="mq lt iq nd b gy nh ni l nj nk">sudo sysctl kern.maxvnodes=$((512*1024))</span></pre><p id="7c6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该设置将在重新启动时重置，启动参数可以通过以下方式永久设置:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="7db6" class="mq lt iq nd b gy nh ni l nj nk">echo kern.maxvnodes=$((512*1024)) | sudo tee -a /etc/sysctl.conf</span></pre><h2 id="67f4" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 5。使用git状态-uno </strong></h2><p id="a400" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:<a class="ae kv" href="https://git-scm.com/docs/git-status" rel="noopener ugc nofollow" target="_blank">https://git-scm.com/docs/git-status</a></p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="3eab" class="mq lt iq nd b gy nh ni l nj nk">git status -uno</span></pre><p id="b8ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">警告:<code class="fe nm nn no nd b">-uno</code>不会显示未跟踪的文件，这意味着新创建的文件不会显示。</p><h2 id="3948" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 6。将git gc整合到您的工作流程中</strong></h2><p id="7836" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">来源:https://git-scm.com/docs/git-gc<a class="ae kv" href="https://git-scm.com/docs/git-gc" rel="noopener ugc nofollow" target="_blank"/></p><p id="5111" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按递增顺序排列(子集):</p><ol class=""><li id="95e7" class="of og iq ky b kz la lc ld lf oh lj oi ln oj lr ot ol om on bi translated"><code class="fe nm nn no nd b">git prune</code></li><li id="b9de" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ot ol om on bi translated"><code class="fe nm nn no nd b">git gc</code></li><li id="5ce8" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ot ol om on bi translated"><code class="fe nm nn no nd b">git gc --aggressive</code></li><li id="f707" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ot ol om on bi translated"><code class="fe nm nn no nd b">git gc --aggressive --prune=now</code></li></ol><h2 id="6e06" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">7 .<strong class="ak">。自动删除旧分支</strong></h2><div class="ou ov gp gr ow ox"><a href="https://github.com/not-an-aardvark/git-delete-squashed" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">GitHub-not-an-aardvark/git-Delete-squashed:删除已经被压扁合并的分支…</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">这是一个删除所有已经被“挤压合并”到master中的git分支的工具。这很有用，如果你…</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl kp ox"/></div></div></a></div><p id="ab7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自创造者:</p><p id="6728" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个删除所有已经被“挤压合并”到master中的git分支的工具。</p><p id="7e0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您处理的项目将分支压缩为主分支，这将非常有用。在您的分支被压缩和合并后，您可以使用此工具清理本地分支。</p><h2 id="0334" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 8。手动删除旧分支</strong></h2><p id="80d6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要做到这一点，请跟随这个<a class="ae kv" href="https://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-locally-and-remotely" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>帖子的顶部答案:</p><p id="1d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">删除远程和本地分支</strong></p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="de57" class="mq lt iq nd b gy nh ni l nj nk">git push -d &lt;remote_name&gt; &lt;branchname&gt;<br/>git branch -d &lt;branchname&gt;</span></pre><p id="cb9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，在大多数情况下，远程名称是origin。在这种情况下，您必须像这样使用命令。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="2916" class="mq lt iq nd b gy nh ni l nj nk">git push -d origin &lt;branch_name&gt;</span></pre><p id="f811" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">删除本地分支<br/> </strong>使用以下方法之一删除本地分支:</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="d50d" class="mq lt iq nd b gy nh ni l nj nk">git branch -d &lt;branch_name&gt;<br/>git branch -D &lt;branch_name&gt;</span></pre><h2 id="f45e" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 9。切换到Linux </strong></h2><p id="d8a6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">根据dropbox的文章，速度提高了5到10倍</p><h1 id="4fe6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">快了多少？🚀</h1><p id="e98a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用<a class="ae kv" href="https://github.com/sharkdp/hyperfine" rel="noopener ugc nofollow" target="_blank"> hyperfine </a>测试git状态的结果，有3次预热操作，min 30在没有任何插件的基础bash终端上运行。</p><p id="424d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个科学但不科学的测试中我:</p><ul class=""><li id="4eeb" class="of og iq ky b kz la lc ld lf oh lj oi ln oj lr ok ol om on bi translated">在上面的统计信息部分运行了<strong class="ky ir">示例清理回购3.0gb </strong></li><li id="b91b" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ok ol om on bi translated">用了一个<strong class="ky ir"> 2019 16寸Macbook Pro </strong>(英特尔芯片，可能是最低配置)</li><li id="8c6c" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ok ol om on bi translated">用在后台运行的intellij、slack和chrome模拟了一般的开发人员</li></ul><h2 id="fbec" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 0。控制git状态:</strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="b734" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">1.487 s </strong>± 0.045 s [User: 324.1 ms, System: 1470.8 ms]<br/>Range (min … max): 1.408 s … 1.587 s 30 runs</span></pre><h2 id="b8ea" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 1。监督-看守人(9.28%): </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="bda4" class="mq lt iq nd b gy nh ni l nj nk">perl (6.99%)<br/>Time (mean ± σ): <strong class="nd ir">1.383 s ✅ </strong>± 0.061 s [User: 293.8 ms, System: 976.0 ms]<br/>Range (min … max): 1.326 s … 1.645 s 30 runs</span><span id="f4d0" class="mq lt iq nd b gy nl ni l nj nk">rust (9.28%)<br/>Time (mean ± σ): <strong class="nd ir">1.349 s ✅</strong>± 0.036 s [User: 275.2 ms, System: 968.9 ms]<br/>Range (min … max): 1.309 s … 1.457 s 30 runs</span></pre><h2 id="025c" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 2。未跟踪缓存(5.85%) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="e5df" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">1.400 s ✅</strong>± 0.042 s [User: 311.9 ms, System: 1414.0 ms]<br/>Range (min … max): 1.340 s … 1.527 s 30 runs</span></pre><h2 id="de44" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 3。分割指数(5.98%) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="3c8a" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">1.398 s ✅</strong>± 0.072 s [User: 305.8 ms, System: 1404.7 ms]<br/>Range (min … max): 1.323 s … 1.666 s 30 runs</span></pre><h2 id="4250" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 4。增加虚拟节点缓存大小(2.96%) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="01fb" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">1.443 s 👌</strong> ± 0.069 s [User: 316.3 ms, System: 1439.3 ms]<br/>Range (min … max): 1.315 s … 1.562 s 30 runs</span></pre><h2 id="21fa" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak"> 5。git状态-uno (96.1%) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="be6f" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">57.1 ms</strong> <strong class="nd ir">✅</strong> ± 1.0 ms [User: 49.0 ms, System: 431.7 ms]<br/>Range (min … max): 55.2 ms … 59.5 ms 50 runs</span></pre><h2 id="3727" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">1–4。全部* (86.14%) </strong></h2><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="03b6" class="mq lt iq nd b gy nh ni l nj nk">Time (mean ± σ): <strong class="nd ir">206.1 ms ✅</strong>±100.0 ms [User: 126.9 ms, System: 43.4 ms]<br/>Range (min … max): 181.4 ms … 735.3 ms 30 runs</span></pre><p id="cc74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mp">*上次测试和这次测试之间我走开看了一集火影忍者，所以这里可能发生了什么诡异的事情。不确定是否可以信任这个数据点tbh。</em></p><h1 id="e973" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结束语</h1><p id="f333" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">正如我提到的，这是我一年多前在2021年5月左右写的私人笔记。从那以后，我不再从事回购业务，也不再关注单一回购的现状。也许有更好的版本控制工具，特别是如果开发环境正在转向云基础设施，如GitHub代码空间，在那里机器能力不再是一个问题。</p><p id="94bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的，我曾与FB的Mercurial和salesforce的Perforce一起工作过，我对它们都没有太大的异议。我选择相信那里的工程师已经把它们束缚到了极限。这篇文章或多或少是写给那些在早期就选择了git，并且没有改变版本控制或回购结构的创业公司和公司的。</p><p id="83ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想到的一些其他改进是，如果您出于任何原因在管道中使用版本控制来区分，那么在CI/CD中启用这一点。您还可以在onboarding eng中包含这些现成的改进，并使用一个脚本来自动执行这些建议。如果你有一个集中管理的开发工具发行版，你也可以用它来更新你所有的开发机器。</p><p id="d8d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将感谢任何建议，见解，或评论！</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="631a" class="mq lt iq nd b gy nh ni l nj nk"><strong class="nd ir">Want to Connect?</strong></span><span id="4580" class="mq lt iq nd b gy nl ni l nj nk">You can reach out on my <a class="ae kv" href="https://www.danielho.xyz/" rel="noopener ugc nofollow" target="_blank">site</a> or <a class="ae kv" href="https://twitter.com/donutdho" rel="noopener ugc nofollow" target="_blank">Twitter</a> :)</span></pre></div></div>    
</body>
</html>