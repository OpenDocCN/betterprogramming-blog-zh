<html>
<head>
<title>Building Your First Website with Flask — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Flask构建你的第一个网站——第3部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-your-first-website-with-flask-part-3-99df7d589078?source=collection_archive---------5-----------------------#2019-08-29">https://betterprogramming.pub/building-your-first-website-with-flask-part-3-99df7d589078?source=collection_archive---------5-----------------------#2019-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fe81" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">跟踪会话和表单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/abcda612704841467a80da5511699f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhVB49WMeyR7Qrx8kV9Zuw.png"/></div></div></figure><p id="ecb3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">欢迎来到我们的第三部分，来建立你的第一个Flask网站。我们已经意识到我们可能会在这之后开发更多的部分——所以不要担心，期待第4和第5部分吧！我们已经意识到，我们也想包括插入和提取数据库，以及把一个适当的网站与我们所学的一切！</p><p id="8923" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里阅读第1和第2部分:</p><div class="lq lr gp gr ls lt"><a href="https://medium.com/better-programming/building-your-first-website-with-flask-part-1-903a8b44e806" rel="noopener follow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">用Flask构建你的第一个网站——第1部分</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">Hello World and beyond</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">medium.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh ks lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a href="https://medium.com/better-programming/building-your-first-website-with-flask-part-2-6324721be2ae" rel="noopener follow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">用Flask构建你的第一个网站——第2部分</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">HTML模板、页面链接和CSS</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">medium.com</p></div></div><div class="mc l"><div class="mi l me mf mg mc mh ks lt"/></div></div></a></div><p id="0545" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我们将着眼于改善用户与简单Flask网站交互的两个重要方面。我们将涵盖:</p><p id="6ee0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">会话跟踪</p><p id="542d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用表单在Flask中发布信息</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="c0f1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">会话跟踪</h1><p id="533d" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">本系列的前两部分集中在基础上:创建基本网页<a class="ae nn" href="https://medium.com/better-programming/building-your-first-website-with-flask-part-1-903a8b44e806" rel="noopener"/>和HTML模板<a class="ae nn" href="https://www.theseattledataguy.com/building-your-first-website-with-flask%e2%80%8a-%e2%80%8apart-2/#page-content" rel="noopener ugc nofollow" target="_blank"/>。让我们开始做一些更有趣的事情。</p><p id="edee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想制作一个包含经常性用户输入的页面，你需要以某种方式跟踪每个用户的状态。这将允许数据在用户在web应用程序上的整个会话过程中被存储。存储的数据作为<em class="no">【记忆】</em>保存之前发生的任何事情。</p><p id="a879" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了跟踪之前的数据，使用<em class="no">“session”</em>提供了链接到特定用户最近会话的临时存储。与cookies不同，“会话”数据存储在服务器上。会话是用户登录到服务器和注销之间的时间间隔。</p><p id="533b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Flask中，客户端数据的<em class="no"/>【session】作为cookie存储在浏览器上。Flask的一个非常有用的特性是可以导入会话。它使用session对象的过程类似于链接到每个网站用户的字典。此外，会话对象可以存储与用户相关的数据，这些数据即使在浏览器崩溃或页面刷新后仍然存在。</p><p id="7323" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以下是所需的设置:</p><p id="05ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在Python脚本之上，导入会话。此外，在创建应用程序的过程中，您应该在注释(#)后增加两行:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="b335" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:在实际应用中(比如你想让你的网站上线)，建议使用一个不为所有人所知的密钥——会话数据可能包含用户的私人信息，通过cookie的访问将利用用户会话的所有数据。这些信息落入坏人之手可能不会有好结果。</p><p id="4d97" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这种情况下，创建简单的Flask网站，使用上面的内容就可以了。所以，<em class="no">千万不要</em>用它来存储敏感数据。如果你想了解更多关于<em class="no">【秘钥】</em>在烧瓶中的用法，这里有<a class="ae nn" href="https://stackoverflow.com/questions/34902378/where-do-i-get-a-secret-key-for-flask/34903502" rel="noopener ugc nofollow" target="_blank">的详细描述。</a></p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="31aa" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用会话对象执行类似Python字典的操作</h1><p id="5962" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">接下来，您可以让会话对象像python中的字典一样执行。这个特性是Flask的另一个优点，因为它的功能类似于常规的<a class="ae nn" href="https://docs.python.org/3/tutorial/datastructures.html" rel="noopener ugc nofollow" target="_blank"> Python字典</a>。</p><p id="f7a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一个例子，它的特点是每次页面被重新加载(在这个例子中，是主页)时，计数达到15。它会删除自己，并在15次计数后重新开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="49fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以下是执行代码后的输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/f26e2b94928a5f574479c100b327ea07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6NhIWY-KYpbtxxBXlv75ZQ.png"/></div></div></figure><p id="c96a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">紧接着，在浏览器中输入localhost:5000。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/e76681bb85ff700548d6b527c92ac5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RwOcCkosLlDicUB990rPpQ.png"/></div></div></figure><p id="fa4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要在你的浏览器上看到这个，进入开发者工具(例如，Chrome:进入更多工具中的开发者工具)并选择<em class="no">“应用程序窗口”</em></p><p id="e2a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后选择<em class="no">“cookie”</em>，这将显示您的<em class="no">“会话”</em>数据，这些数据保存在您的浏览器cookie中，但已加密。使用之前创建的<em class="no">“密钥”</em>打开加密。</p><p id="d403" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">服务器处理cookie并使用密钥解密它。它还可以修改和读取cookies中的信息。使用Flask的独特方法，一个用户的会话不会影响任何其他用户。</p><p id="39d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以通过使用匿名窗口测试URL来进一步确认:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/2afd5981d93d202cc031ae404a69d63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6mJmALoq3jJ3Ve-qlSDag.png"/></div></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5a53" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用Session统计每个页码的结果</h1><p id="dc8c" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">下面是使用会话的web应用程序的另一个实例。这一次，我们使用session对route收到的每个页码的结果进行计数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="c8bb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦在命令提示符下执行了代码，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/4a7baaed86caf2659c3ac32bdfb69003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QzxWp8NL_uzZGFIIOSDzDw.png"/></div></div></figure><p id="1da0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您的第一个输出将是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/50dbf79733ad5dcf77bff59c09cf4292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuRRy_s6w6U7_a63ogFchQ.png"/></div></div></figure><p id="9c3a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在浏览器中输入localhost:5000/15，并不断刷新页面。</p><p id="cd6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你会注意到产量增加了15。</p><p id="79a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">改变URL末尾的数字会看到它增加了那个数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/cd9a46daa40e5ba0af12e1522071b312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7vI-dhRTQAM0sIBzmRy8A.png"/></div></div></figure><p id="3f49" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这两个例子都可以让你在用户浏览你的站点时跟踪他们。</p><p id="4e65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，手动将数据输入到url中并不是我们向网站传递数据的方式！相反，我们应该使用表单。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="73bf" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用表单在Flask中发布信息</h1><p id="b0c1" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">为了在Flask中处理web表单，Flask提供了一个名为<a class="ae nn" href="http://wtforms.simplecodes.com/docs/0.6/fields.html#basic-fields" rel="noopener ugc nofollow" target="_blank"> Flask-WTF扩展</a>的扩展。这个扩展很好地与Flask集成在一起。Flask生态系统具有更多的扩展，这些扩展是Flask解决各种问题的能力的重要组成部分。Flask扩展是使用Python中的常规pip安装的。首先，让我们安装Flask-WTF:</p><p id="f1fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nx ny nz oa b">pip install flask-wtf</code></p><h1 id="85a4" class="mq mr it bd ms mt ob mv mw mx oc mz na jz od ka nc kc oe kd ne kf of kg ng nh bi translated">用户登录表单</h1><p id="fcb9" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">Flask-WTF扩展使用Python类表示web表单。form-class将表单字段定义为类变量。让我们从创建一个名为“<em class="no">appforms . py”</em>的新python脚本开始，它将允许我们设置一个用户登录表单:</p><ul class=""><li id="38bb" class="og oh it kw b kx ky la lb ld oi lh oj ll ok lp ol om on oo bi translated">要求用户提供用户名和密码。</li><li id="df82" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">包括<em class="no">“记住我”</em>复选框，以及</li><li id="fdaf" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated"><em class="no">“登录”按钮。</em></li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="98cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Flask-WTF的所有符号都在<em class="no"> flask_wtf下。</em>上述代码中需要注意的其他事项包括:</p><ul class=""><li id="8ca3" class="og oh it kw b kx ky la lb ld oi lh oj ll ok lp ol om on oo bi translated">FlaskForm基类是从<em class="no"> flask_wtf </em>导入的。</li><li id="7cfe" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">四个类用于表示各种字段类型(全部从<em class="no"> WTForms </em>包中导入)</li><li id="114e" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">为单个字段创建对象，作为<em class="no"> LoginForm </em>类中的类变量。</li><li id="2374" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">描述或标签作为第一个参数添加到每个字段中。</li></ul><p id="b55b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">应用于某些字段的可选验证器参数为它们提供了验证行为。<em class="no">data required</em><em class="no">validator</em>检查提交字段是否为空。还有更多可用的验证器类型。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="8d9d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">表单模板</h1><p id="dd68" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">下一步是将表单添加到HTML模板中，这将有助于高效地定义来自<em class="no"> appforms.py </em>的字段。将它们呈现为HTML会使任务相对简单。下面，我们来创建两个模板，一个基础模板和一个登录模板，分别叫做【Formlogin.html】的<em class="no">和<em class="no">的Formlogin.html: </em></em></p><p id="1c75" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是Formbase.html的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="868e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于第二个模板，我们通过模板继承重用了FormBase.html的<em class="no">模板。模板继承是jinja2的另一个优秀特性。extends语句有助于完成应用程序的这一部分。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><ul class=""><li id="7f22" class="og oh it kw b kx ky la lb ld oi lh oj ll ok lp ol om on oo bi translated">这个<em class="no">Formlogin.html</em>模板期望一个从<em class="no"> LoginForm </em>类实例化的表单对象作为参数给出，您可以看到它被引用为form。</li><li id="3da5" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated"><em class="no"> novalidate </em>属性不对表单域进行验证。使用<em class="no"> novalidate </em>是完全可选的，但是设置它是有用的，因为它允许服务器端测试验证。</li></ul><p id="5a9a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此时，您可以运行代码<em class="no"> python appforms.py </em>，并通过在地址栏中键入<a class="ae nn" href="http://localhost:5000/login" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/log in</a>在浏览器上查看应用程序运行时的表单。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/41c1fbbe1019b482506f8cdfe3c057ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QsBUiUGN2g-C94goZtwwSw.png"/></div></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5b1e" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">接收表单数据并增强字段验证</h1><p id="1d89" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">运行代码后，按提交按钮会导致一个<em class="no">“方法不允许”</em>错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/318efab1a62d23bb4d9aac8a3e8c44aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ci76HAgxaJ1DvWHlguUVzA.png"/></div></div></figure><p id="a377" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该错误是因为作为登录视图函数的<em class="no"> "appforms.py" </em>可以显示表单，但是它还没有逻辑来处理提交的数据。将字段验证器附加到表单字段可以避免无效数据被确认。该应用程序处理无效数据的方法是重新加载表单页面，以允许用户输入正确的数据。</p><p id="4efd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您试图将无效数据提交到表单中，您会注意到类似的验证机制。下一个任务试图通过添加指示验证失败的错误消息来增强用户体验。表单验证器已经产生了这些描述性的错误消息，所以缺少的部分是添加一些逻辑模板来帮助显示它们。下面是登录模板<em class="no"> (main.py) </em>，在用户名和密码字段中添加了字段验证消息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="3ce6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个版本在route decorator中使用了一个方法参数。它只是告诉Flask函数接受GET和POST请求，仅取代默认的GET请求。</p><ul class=""><li id="9c0d" class="og oh it kw b kx ky la lb ld oi lh oj ll ok lp ol om on oo bi translated"><em class="no">form . validate _ on _ submit()</em>方法完成所有的表单处理工作。每当用户按下submit按钮时，这个函数收集所有附加的数据并运行validators字段。如果正确，它将返回True，表示数据是有效的，可以被处理。</li></ul><p id="1e55" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面提供了对上述代码模板的额外更新(<em class="no">formhelpers.html</em>和<em class="no">index.html)</em></p><p id="40d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">formhelpers.hmtl</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="ce57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">运行这段代码并转到localhost，看起来会像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/8b99978e5c7b5768fc50d89726ac23a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*7WR3x7d-Lgi79-fclczWlw.png"/></div></figure><p id="57f3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">提交后:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/a88834c295ff20b1c5f9f5c5db466064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezgcGl_O51ZysweJM7nrqQ.png"/></div></div></figure><p id="751c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一般规则是，任何附加的字段验证器都会在<em class="no"> &lt;字段名称&gt;的形式下添加错误消息。</em>错误。运行代码而不提交任何字段的数据会返回一条简单的错误消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/c138b737916aaed57615f86c98bd46a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rRAvEC6ffCerXrK7IWXwbg.png"/></div></div></figure><p id="ce2a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">代码提供了另一个运行应用程序和查看表单如何工作的绝佳时机。请确保您尝试提交用户名或密码的空表单字段，以便了解DataRequired验证程序如何中止提交过程。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="23f1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建带有单个字段的简单表单</h1><p id="2cba" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">使用WTForms和一个表单验证模块，让我们创建一个包含单个字段的简单表单。该任务需要一个包含单个请求姓名字段的表单。首先，让我们创建一个新文件<em class="no">“single input . py”</em>并添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8b8b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建完python脚本后，我们创建一个模板<em class="no"> "form.html" </em>保存在<em class="no"> "templates" </em>目录下:</p><p id="b138" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">form.html代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="43a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe nx ny nz oa b">python SingleInp.py</code>在命令提示符下运行代码，并在浏览器中输入<a class="ae nn" href="http://127.0.0.1:5000" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:5000</a>/form。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/663673b85a0d21b5cdf0a51bf357e84d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y8b9UXY9SYGwYz1kboMYZg.png"/></div></div></figure><p id="a695" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您输入Ben作为用户名并提交，输出将是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/34c1baa59a4743a313cc3fa542199a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvgYblvDTrS9QjQCLX1ZgQ.png"/></div></div></figure><p id="d6ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">输入姓名后，页面会发送包含您姓名的欢迎消息。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="1243" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="ee77" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">跟踪用户取得的进展和Flask中表单的使用非常有用。使用正确的扩展，你的Flask网站体验会变得更好。通过更多的实践，您可以探索Flask下可用的其他验证方法、扩展和模板技术。现在，让我们保持简单，专注于下一个任务。像添加Flask表单这样的简单模块，可以使你的网站更加健壮，并提供更好的用户体验。</p></div></div>    
</body>
</html>