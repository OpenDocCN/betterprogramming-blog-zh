<html>
<head>
<title>Charles Setup for Emulator (Android) and Simulator (iOS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟器(Android)和模拟器(iOS)的Charles设置</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/charles-setup-for-emulator-android-simulator-ios-94d3e21598f1?source=collection_archive---------0-----------------------#2019-10-19">https://betterprogramming.pub/charles-setup-for-emulator-android-simulator-ios-94d3e21598f1?source=collection_archive---------0-----------------------#2019-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bb66" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">诊断您的移动应用的网络流量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1f11d7c39efea8e29d5483cd7b4ed949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zIL5r_7Ii60bxFJo-TL05g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com/@hush52" rel="noopener ugc nofollow" target="_blank">嘘奈杜</a>在<a class="ae ky" href="https://unsplash.com/photos/yo01Z-9HQAw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="0fd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为物理设备和仿真器或模拟器设置<a class="ae ky" href="https://www.charlesproxy.com/" rel="noopener ugc nofollow" target="_blank"> Charles </a>有时并不完全相同。使用仿真器或模拟器有时很方便，因为您不需要带着真实的设备进行测试。</p><p id="21a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">万一你不知道<a class="ae ky" href="https://www.charlesproxy.com/" rel="noopener ugc nofollow" target="_blank">查尔斯</a>是什么，它是一个网络代理工具。换句话说，它可以用来拦截网络连接(在我们的例子中，来自设备)，以允许查看、重定向、修改和调试。它对于本地服务器测试也非常有用。</p><p id="b20a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常忘记其中一个平台，所以我记录了iOS和Android，以便为两者提供一站式的参考。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="73d2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在启动仿真器或模拟器之前</h1><p id="a9fc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最好是在启动模拟器之前确保Charles已经启动。我不确定这是否总是必要的，但这是一个好的步骤。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f941" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Android模拟器</h1><p id="580d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">以前连接Android模拟器都是通过命令行完成的。今天好像不再管用了。目前使用的方法是匹配实际设备的功能。</p><p id="b1cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但在此之前，你必须确保你的模拟器启动连接到互联网。有时这是不可能的，由于我不知道的原因。因此，解决这个问题的方法是根据下面的博客。(仅在您的仿真器无法连接到互联网时使用。)</p><div class="mz na gp gr nb nc"><a href="https://medium.com/@elye.project/making-android-emulator-connect-to-internet-e7b622a00f09" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">让Android模拟器连接到互联网</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">你曾经因为你的Android模拟器不能连接到互联网而感到沮丧吗？放弃了尝试，只是用…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><h2 id="674c" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">设置代理IP</h2><p id="dc5e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">通过互联网连接启动模拟器后，您需要找到本地IP地址。在Charles中通过查找<em class="od">帮助→本地IP地址</em>来完成此操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/99c80426c943a301d140942cea51f301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WIH6Wrc9ZbVOBWfSvHef-g.png"/></div></div></figure><p id="df1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，在你的模拟器中，进入Wifi设置，长按<code class="fe of og oh oi b">AndroidWifi</code>，在这里你将进入<code class="fe of og oh oi b">Modify network</code>设置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4dbade0e105038b3fa4d966824ec2b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*_0YU-Z1wz6KZLEGP_YUtZw.png"/></div></figure><p id="831f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<em class="od">修改</em>中，点击<code class="fe of og oh oi b">Advanced options</code>展开对话框。然后，在<code class="fe of og oh oi b">Proxy host</code>和<code class="fe of og oh oi b">Proxy port</code>中输入IP地址(通常是8888)。然后，点击<em class="od">保存</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2f2ebb48a46f78873098b9a0f693ee42.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*MIiFTj-iCq9Z5lBcjjmkBQ.png"/></div></figure><h2 id="f6a6" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">证书安装</h2><p id="c8c0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有时(事实上，大多数时候)，我们需要安装认证来查看安全网络。为此，请访问Chrome浏览器和<code class="fe of og oh oi b">chls.pro/ssl</code>的地址。</p><p id="b382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果Charles已经连接上，您应该会收到下载或替换您的证书的询问。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2e15f698e4209147967300f3a98af7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*ZbT4EmypYGbjw1DUSPaH9g.png"/></div></figure><p id="a2a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下载完成后，会要求您安装它。之后，你可以用任何你喜欢的名字保存它。</p><p id="ba62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，您的设备至少需要有一个“pin”安全设置才能做到这一点。如果没有，系统会提示您在那里进行设置。</p><h2 id="a5a0" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">Android SDK API 30更新(Android 11)</h2><p id="386b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">安装程序中对Android SDK API 30的新要求如下。</p><div class="mz na gp gr nb nc"><a href="https://medium.com/mobile-app-development-publication/setup-charles-proxy-for-android-sdk-api-30-onwards-2e3eab4231aa" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">为Android SDK API 30及以上版本设置Charles代理</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">在Android 11上安装Charles CA Cert的额外步骤</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="om l nn no np nl nq ks nc"/></div></div></a></div><h2 id="1cd5" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">解决纷争</h2><p id="0a0f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您无法连接到Charles，请尝试以下方法:</p><ul class=""><li id="0b51" class="on oo it lb b lc ld lf lg li op lm oq lq or lu os ot ou ov bi translated">在使用Charles设置代理之前，请确保您的设备已接入互联网。</li><li id="ab6d" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">关闭蜂窝网络，只打开设备的Wifi网络。</li><li id="be94" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">检查查尔斯的<code class="fe of og oh oi b">macOS Proxy</code>设置是否为<code class="fe of og oh oi b">OFF</code>。您可以通过查看Charles的<em class="od">代理→ macOS代理</em>进行检查。(注意这一步和iOS相反。)</li><li id="694f" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">检查您是否有过期的证书。如果你既过期又没过期，那就不行。你必须删除过期的。要进行检查，请转至<em class="od">设置→安全→加密和凭证→可信凭证→用户(选项卡)</em></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a56e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">iOS模拟器</h1><p id="2c4d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在iOS中，模拟器代理的设置不同于实际设备，并且更简单。您不需要显式键入代理地址，让Charles为您完成。</p><h2 id="0e0a" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">将Charles连接到模拟器</h2><p id="5cbe" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">启动模拟器后，在Charles中，进入<em class="od">帮助→ SSL代理→在iOS模拟器中安装Charles根证书</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/18adf777262f1683764e306662add105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*337bUBxcHc4Mdzq-4tv9Lg.png"/></div></div></figure><p id="875a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，你会得到下面的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/c151782bcf8cf1950b08b77e113cc93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGxxiCi9aeajRrwWc10ydw.png"/></div></div></figure><p id="1c89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步很重要，把<code class="fe of og oh oi b">ON</code>变成你的<code class="fe of og oh oi b">macOS Proxy</code>。这可以通过Charles <em class="od">代理→ macOS代理来实现。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/95a7e94036faa3fda4befe11e38303c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*SY2BSKhWZE8udcMyLntrpw.png"/></div></figure><h2 id="9b6c" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">证书安装</h2><p id="3ed1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有时(事实上，大多数时候)，我们需要安装认证来查看安全网络。前往Safari浏览器和<code class="fe of og oh oi b">chls.pro/ssl</code>的地址。</p><p id="3670" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果Charles已经连接上了，您应该得到如下的下载配置文件的请求。允许它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/714c19d0caaa79402364950b6a53c965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*G1P6H3j1W01sz0gHcIIP4Q.png"/></div></figure><p id="51c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您会收到以下消息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/9878e1ae684e635b4bcc1655b1ad0e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*8_BmFwrnXDaH7kahPrx1IQ.png"/></div></figure><p id="a484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，进入你的模拟器的<em class="od">设置→常规→配置</em>，你会得到类似下图的东西。点击它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/4032f2011b82d53cdfb41dd1cca42d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*CMrqxVAVl4LrsKJf7SB9bw.png"/></div></figure><p id="1c9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，点击安装。您将设置如下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/7bdd942adfae175ae6e72cbe56ab1e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*VRaYnSn_Bw4uPSgVS9hi5g.png"/></div></figure><p id="f6a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一步之后，还有一步要走。</p><p id="1b5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入<em class="od">设置→常规→关于→证书信任设置</em>。然后查找您刚刚安装的证书并打开它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/e02aedf495a852814c3dfbaf6d856db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*wpTOFPexAVA22Q9n7Rp5lQ.png"/></div></figure><p id="9993" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样。</p><h2 id="1e63" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">解决纷争</h2><p id="855e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您无法联系到Charles，请尝试以下方法:</p><ul class=""><li id="bde7" class="on oo it lb b lc ld lf lg li op lm oq lq or lu os ot ou ov bi translated">在使用Charles设置代理之前，请确保您的设备已接入互联网。</li><li id="9ef0" class="on oo it lb b lc ow lf ox li oy lm oz lq pa lu os ot ou ov bi translated">检查查尔斯的<code class="fe of og oh oi b">macOS Proxy</code>设置是否为<code class="fe of og oh oi b">ON</code>。你可以通过查理斯<em class="od">代理→ macOS代理</em>来检查。(注意这一步和安卓相反)</li></ul><p id="2eea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:如果在使用Charles后，你发现你的电脑不能访问互联网，一定要检查Charles的<code class="fe of og oh oi b">macOS Proxy</code>设置是<em class="od">而不是</em> <code class="fe of og oh oi b">ON</code>。你可以在Charles <em class="od"> Proxy → macOS Proxy </em>中查看。</p><p id="943c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p></div></div>    
</body>
</html>