<html>
<head>
<title>Setting Up a Next.js Project With TypeScript, Sass, and Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TypeScript、Sass和Jest设置Next.js项目</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/setting-up-a-next-js-project-with-typescript-sass-and-jest-d9b2d3bfb34a?source=collection_archive---------4-----------------------#2019-07-11">https://betterprogramming.pub/setting-up-a-next-js-project-with-typescript-sass-and-jest-d9b2d3bfb34a?source=collection_archive---------4-----------------------#2019-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2036756d58e42e676e65bb6e4ce0e951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ut0nFN0PJmL2QqzTN8J4sA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@goran_ivos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Goran Ivos </a>在<a class="ae kc" href="https://unsplash.com/search/photos/code-program?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="685b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank">下一个</a>。js是一个React框架，用于构建生产就绪的网站，具有许多特性，如SSR、静态导出、零设置要求等等。</p><p id="9dc1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个故事是一个更大的故事的第一部分，在这里我们学习如何使用<a class="ae kc" href="https://www.prisma.io/" rel="noopener ugc nofollow" target="_blank"> Prisma </a>创建一个待办事项应用程序。</p><p id="69e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我选择Next.js的原因是它有很大的灵活性。您可以轻松地添加许多不同的附加组件(<a class="ae kc" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>、<a class="ae kc" href="https://sass-lang.com/" rel="noopener ugc nofollow" target="_blank"> Sass </a>，服务器端开发)，只需最少的配置麻烦，并使应用程序在服务器端呈现时仍能运行良好。</p><p id="fc4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以轻松创建前端应用程序，并将其转换为全栈应用程序。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="aab1" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">我们开始吧</h1><p id="c742" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我们需要做的第一件事是创建一个名为<code class="fe ml mm mn mo b">todo-projectname</code>的项目文件夹，并用<a class="ae kc" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>打开它。</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="0235" class="mx lj iq mo b gy my mz l na nb">mkdir todo-<strong class="mo ir">projectname</strong></span></pre><p id="7745" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们安装<code class="fe ml mm mn mo b">react</code>、<code class="fe ml mm mn mo b">react-dom</code>和<code class="fe ml mm mn mo b">next</code>。</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="90b1" class="mx lj iq mo b gy my mz l na nb">npm init -y</span><span id="e359" class="mx lj iq mo b gy nc mz l na nb">npm install -save react react-dom next</span></pre><p id="c029" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要创建一个pages文件夹来运行页面。</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="5480" class="mx lj iq mo b gy my mz l na nb">mkdir pages</span></pre><p id="b389" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是尝试创建我们的第一页。在这个文件夹中，创建<code class="fe ml mm mn mo b">index.js</code>文件并复制下面的代码。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="3052" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是时候测试我们的第一个Next.js页面了。在控制台上运行以下命令:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="f493" class="mx lj iq mo b gy my mz l na nb">npm run dev</span></pre><p id="a31c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在你的浏览器上加载以下内容<code class="fe ml mm mn mo b"><a class="ae kc" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>，你应该能看到我们的Hello World。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="21c5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">添加TypeScript支持</h1><p id="c629" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">这些最初的步骤只是为了设置我们的环境。</p><p id="c3b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们接下来要做的是添加TypeScript。为此，我们必须添加一些文件，并对样板文件进行一些更改。</p><p id="b579" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在根文件夹中，创建名为<code class="fe ml mm mn mo b">next.config.js</code>的文件。</p><p id="82e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您需要在项目中安装一个支持TypeScript的包。</p><p id="2af6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在控制台上，运行以下命令:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="5716" class="mx lj iq mo b gy my mz l na nb">npm install --save @zeit/next-typescript</span></pre><p id="e24d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在该文件中，复制以下代码:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="9864" class="mx lj iq mo b gy my mz l na nb">const withTypescript = require('@zeit/next-typescript')</span><span id="9c20" class="mx lj iq mo b gy nc mz l na nb">module.exports = withTypescript()</span></pre><p id="5645" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在根文件夹中创建一个<code class="fe ml mm mn mo b">.babelrc</code>文件，并添加以下配置代码:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0ac4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，我们根本不需要添加<code class="fe ml mm mn mo b">tsconfig</code>，因为我们已经添加了<code class="fe ml mm mn mo b">.babelrc</code>。</p><p id="22e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将用我们的TypeScript实现替换<code class="fe ml mm mn mo b">index.jsx</code>:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="46af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将得到相同的输出，但是这次它将是一个更大胆的(因为我们使用H1) Hello World！</p><p id="7e58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您现在有了一个基于类型脚本的Next.js样板文件。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="a786" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">添加Sass</h1><p id="ed14" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">如果您想创建使用Sass的组件，我们可以用Next.js轻松做到这一点。</p><p id="59ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们需要安装另一个包。使用我们的控制台，我们可以通过运行以下命令来做到这一点:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="51df" class="mx lj iq mo b gy my mz l na nb">npm install --save @zeit/<!-- -->next-sass</span></pre><p id="e9a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们需要在我们的<code class="fe ml mm mn mo b">next.config.js</code>内部做一些改变。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="03b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也将不得不修改我们的<code class="fe ml mm mn mo b">index.tsx</code>文件，使我们的H1蓝色。</p><p id="fd2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们将进行以下两项更改，如下所示:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e9b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要在文件夹的路径中添加<code class="fe ml mm mn mo b">index.scss</code>:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="9f6e" class="mx lj iq mo b gy my mz l na nb">.example {</span><span id="db92" class="mx lj iq mo b gy nc mz l na nb">  color: blue;</span><span id="da23" class="mx lj iq mo b gy nc mz l na nb">}</span></pre><p id="63ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，每次对<code class="fe ml mm mn mo b">next.config.js</code>进行更改时，都需要重启服务器。使用<code class="fe ml mm mn mo b">CTRL+ C</code>重启，然后再次运行<code class="fe ml mm mn mo b">npm run dev</code>。</p><p id="4740" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你现在应该可以在你的H1上看到蓝色了。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="4028" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用Jest添加测试</h1><p id="f4d5" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">下一步是添加Jest测试。你可以按照<a class="ae kc" href="https://medium.com/@miiny" rel="noopener"> Miin </a>的文章中的说明去做。</p><p id="df92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的项目中，我们需要做一些改变。一些配置不再工作，我不得不添加一些修改来解决这个问题。</p><p id="190d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要安装以下软件包:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="77b0" class="mx lj iq mo b gy my mz l na nb">npm install --save-dev jest babel-jest babel-core babel-preset-env babel-preset-react</span></pre><p id="543c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后改变我们的<code class="fe ml mm mn mo b">package.json</code>来添加测试脚本:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="9300" class="mx lj iq mo b gy my mz l na nb">"scripts": { <br/>      "test": "jest", <br/>      "test:watch": "jest — watch", <br/>      "test:coverage": "jest — coverage"<br/>},</span></pre><p id="af8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，让我们安装<a class="ae kc" href="https://airbnb.io/enzyme/" rel="noopener ugc nofollow" target="_blank">酶</a>测试库:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="b606" class="mx lj iq mo b gy my mz l na nb">npm install --save-dev enzyme enzyme-adapter-react-16</span></pre><p id="9aa0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们选择用TypeScript编写，我们还需要安装:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="c80f" class="mx lj iq mo b gy my mz l na nb">npm install --save-dev typescript ts-jest <!-- -->@types/enzyme<!-- --> <!-- -->@types/enzyme-adapter-react-16<!-- --> <!-- -->@types/jest</span></pre><p id="eca1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，对于Jest，我们还需要为Jest设置一个配置文件，为TypeScript和Jest设置一个配置文件。</p><p id="576f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ml mm mn mo b">jest.tsconfig.json</code>:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="757d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和<code class="fe ml mm mn mo b">jest.config.js</code>:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="71aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您需要对<code class="fe ml mm mn mo b">package.json</code>文件进行一些更改——添加以下内容:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2080" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，您需要创建一个名为<code class="fe ml mm mn mo b">__mocks__</code>的文件夹，并在其中添加两个文件:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="0010" class="mx lj iq mo b gy my mz l na nb">//__mocks__/fileMock.js</span><span id="9fda" class="mx lj iq mo b gy nc mz l na nb">module.exports = 'test-file-stub';</span></pre><p id="4ab8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且:</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="abbe" class="mx lj iq mo b gy my mz l na nb">//__mocks__/stylesMock.js</span><span id="e1ac" class="mx lj iq mo b gy nc mz l na nb">module.exports = {};</span></pre><p id="dce1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们需要将<code class="fe ml mm mn mo b">enzyme.js</code>文件添加到我们的文件夹的根目录中，并添加以下代码。</p><p id="89e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其他一些例子中，我看到它被添加到每个测试的顶部，但是通过下面的操作，它将被包括在内，而不必添加它。</p><pre class="mp mq mr ms gt mt mo mu mv aw mw bi"><span id="2210" class="mx lj iq mo b gy my mz l na nb">const Adapter = require('enzyme-adapter-react-16')</span><span id="a744" class="mx lj iq mo b gy nc mz l na nb">require('enzyme').configure({adapter: new Adapter()})</span></pre><p id="ab59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在创建一个<code class="fe ml mm mn mo b">__tests__</code>文件夹，并添加下面的示例测试文件<code class="fe ml mm mn mo b">index.spec.tsx</code>。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cd84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以在终端上使用以下命令运行测试:</p><p id="cb0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe ml mm mn mo b">npm run test</code></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/65b19e803cf769cf7fe6695d4e71ca37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5TsicjPzz9zyvwxpKPFMg.png"/></div></div></figure><p id="08ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它成功了，太棒了！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="3eb0" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">完全回购</h1><p id="a27e" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">你可以在这里找到完整的回购协议:</p><div class="ng nh gp gr ni nj"><a href="https://github.com/arismarko/nexttsboiler" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">aris Marko/nextts锅炉</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">使用Next.js、TypeScript、Sass和Jest - arismarko/nexttsboiler的样板文件</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jw nj"/></div></div></a></div><p id="eff6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>