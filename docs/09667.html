<html>
<head>
<title>Implementing SwiftUI Canvas in iOS 15</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS 15中实现SwiftUI Canvas</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/implementing-swiftui-canvas-view-in-ios-15-b7909eac207?source=collection_archive---------5-----------------------#2021-09-23">https://betterprogramming.pub/implementing-swiftui-canvas-view-in-ios-15-b7909eac207?source=collection_archive---------5-----------------------#2021-09-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="613d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看看如何在SwiftUI中使用新的画布视图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd16464375065837c4b4f07ed065b84a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2sqaq5EZmCdAHl-Cw9AkWA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">展示SwiftUI 3.0中新的Apple Canvas视图的动画GIF</p></figure><p id="0b31" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不幸的是，SwiftUI仍然有点未完成——至少与其老大哥UIKit相比。尽管这是iOS15的第三个版本，但它仍然缺少一些重要的视图。</p><p id="710d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我觉得，苹果剩下的主要挑战之一是如何尽可能无痛地完成过渡。没有人想重写UI/UX代码——公司当然负担不起。他们需要一种方法来重用他们已经拥有的尽可能多的代码，但是没有随之而来的UIKit包袱。</p><p id="cdfe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除此之外，SwiftUI是一个非常新的范例，调整了开发人员以前掌握的一些控件。因此，尽管他们在最近的WWDC 21大会上没有说太多，但在我看来，苹果正在尝试涵盖一些中间地带。中间地带有一个新的视角叫做画布。某种程度上的妥协。</p><p id="3cb1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它在WWDC 21上被展示为一种更有效的绘画方式。就CPU而言，它可能更高效，但看着它，我不禁认为它在代码迁移方面也更高效，本机支持核心图形原语，这是你以前在SwiftUI中无法轻易做到的——需要在<code class="fe lu lv lw lx b">UIImages</code>和<code class="fe lu lv lw lx b">Images</code>之间转换有点痛苦。</p><h1 id="118f" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">什么是SwiftUI画布视图？</h1><p id="e8ac" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">画布视图有点像SwiftUI中的SpriteKit视图。它们之所以相似，是因为它们在某种程度上自成一体。</p><p id="bdf6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你不能<strong class="la iu">，</strong>例如，将手势附加到画布视图中的元素，它是一个单独的对象(当然，你可以将手势作为一个整体添加到画布视图中)。但是，与以前的现状相比，它们提供了一个主要优势:它们绘制视图的效率要高得多。更重要的是，它们原生支持所有核心图形绘制图元。这意味着您可以将代码移植给他们，只需对您的新SwiftUI界面进行最小的更改。请和我一起参观一下新的Canvas指令，构建您在本文标题中看到的绿色时钟。</p><h1 id="7f8f" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">在画布上绘制形状</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/43053f88740d75cae25ab40a22a473f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZd5hoos3rKVw2Cd1bCyOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI画布视图上绘制形状</p></figure><p id="9ad0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我先画一个钟的形状，一个简单的圆。也可能是一个方形的钟，你在渲染圆形和方形时得到的两个基本形状。是的，它是红色的，但是不透明度降低了——所以它是一种褪色的红色。黑线是您在下面的代码中看到的<code class="fe lu lv lw lx b">setLineDash</code>函数。长度以弧度为单位(不，这不是很方便用户使用)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="6f2a" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">在画布上混合形状颜色</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/205b81f9d40e1dd14732ccf08f8ea8d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pw0hoSU7HQnz9yKvVi3lDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI画布视图上混合形状</p></figure><p id="ff39" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，为了完成这张图片，我需要一个边框，我决定绿色也是一个很好的颜色，所以我把它和我的红色时钟混合在一起，添加了一个边框。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="42fc" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">在画布上绘制文本</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/efed09553552316cf8b8bc1f319ea80b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVN5xWN6bgVxeDMfQ0SoIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI画布视图上绘制文本</p></figure><p id="186e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，虽然严格来说不需要，但我想包含一个用render添加一些文本的例子，所以我在SwiftUI画布中添加了一个单词。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="13a8" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">在画布上绘制图像</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/505bbab4db6a478cc57e7a1aa4623ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hDnf6X-crW_UCy4Qa7qfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI画布视图上绘制图像。忍者形象由<a class="ae my" href="https://thenounproject.com/ian821/" rel="noopener ugc nofollow" target="_blank">伊恩·兰斯利</a></p></figure><p id="240e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，同样为了完整起见，我添加了一张我从<code class="fe lu lv lw lx b"><a class="ae my" href="https://thenounproject.com" rel="noopener ugc nofollow" target="_blank">thenounproject</a></code>中找到的图片。我再次将它融入画面，这样就不会太过强烈。虽然你确实丢失了一些文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="2ca2" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">在你的画布上画线</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/edab1e053b80ca05787922b963c855ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZNL9z2EL0ii5AxebbTNhQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI画布视图上画线</p></figure><p id="0b5a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我在画布上添加了双手，只需从图像中心向外画两条线。注意这是另外两个独立的画布对象。他们需要被分开，因为我想让他们单独的动画。还要注意，我改变了<code class="fe lu lv lw lx b">zIndex</code>以确保它们总是出现在时钟图像的上方，并在这里稍微旋转了一下，这样你可以更好地看到它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="6c0f" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">赋予它生命</h1><p id="2e20" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">这是既成事实——我在钟面上加了四个主要数字；然后通过创建两个计时器并将其链接到代码来制作动画，以便随着时间的推移将包含线条的图像旋转360度，这就是您在本文开头看到的移动图像。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="ae54" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有这些都让我想到了这篇文章的结尾。我希望你喜欢读它，就像我喜欢写它一样。</p></div></div>    
</body>
</html>