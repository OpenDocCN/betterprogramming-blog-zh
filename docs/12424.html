<html>
<head>
<title>How to Use Selenium to Simulate Manual Actions for Website Tests in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Selenium在Python中模拟网站测试的手动操作</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-selenium-to-simulate-manual-actions-c00aecbfbd45?source=collection_archive---------8-----------------------#2022-06-05">https://betterprogramming.pub/how-to-use-selenium-to-simulate-manual-actions-c00aecbfbd45?source=collection_archive---------8-----------------------#2022-06-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="32fa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">几分钟内学会基本的网站测试自动化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab7fcfa7f6768c65c2a48f701d8a4bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VYaO4N-NNLhUpkPw.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由皮沙贝的<a class="ae ky" href="https://pixabay.com/photos/turn-on-switch-off-energy-power-2933016/" rel="noopener ugc nofollow" target="_blank">杰拉德</a>拍摄。</p></figure><p id="d3a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.selenium.dev/" rel="noopener ugc nofollow" target="_blank"> Selenium </a>是一款常用于在浏览器中自动化网站测试的工具。可以用Selenium模拟各种手动动作。在本帖中，我们将介绍一些在网站测试或网页抓取中常用的手动操作。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7f4f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">准备</h1><p id="fefc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在开始之前，我们需要安装Selenium和一些依赖项。为了达到最佳实践，我们应该将库安装在一个虚拟环境中。推荐使用<a class="ae ky" href="https://medium.com/codex/how-to-create-virtual-environments-with-venv-and-conda-in-python-31814c0a8ec2" rel="noopener"> <em class="mz"> conda </em> </a>来管理环境，因为我们可以在每个环境中安装特定版本的Python。</p><p id="524e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用最新版本的Selenium，最好也使用最新版本的Python。我们还将安装iPython库，以便更方便地运行交互式Python代码。您可以在iPython中复制并粘贴下面所示的Python代码来查看结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c444" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尤其是有了<a class="ae ky" href="https://pypi.org/project/webdriver-manager/" rel="noopener ugc nofollow" target="_blank"><em class="mz">web driver-manager</em></a>，我们不需要像以前那样下载管理浏览器驱动，省了我们不少力气。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f79a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何开一个驱动，开一个网站？</h1><p id="1c84" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">启动驱动程序现在简单多了，因为我们不需要单独管理浏览器驱动程序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7e38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将自动下载并使用<code class="fe nc nd ne nf b">webdriver</code>，在本例中为<code class="fe nc nd ne nf b">chromedriver</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="af13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以用驱动程序打开一个网站:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="0307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常我们会为了测试而最大化窗口，但是你也可以用<a class="ae ky" href="https://www.selenium.dev/documentation/webdriver/browser/windows/#set-window-size" rel="noopener ugc nofollow" target="_blank"> set_window_size </a>方法将其设置为一个特定的大小。</p><p id="c6e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以对网站进行截屏，以确保它被正确打开和显示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0b88" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何点击一个元素？</h1><p id="a664" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以点击各种元素，如链接、按钮、单选按钮等。让我们点击<a class="ae ky" href="https://quotes.toscrape.com/" rel="noopener ugc nofollow" target="_blank">quotes.toscrape.com</a>主页上的“登录”链接。我们需要首先找到链接的XPath。</p><p id="d521" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不知道如何获得一个web元素的XPath，<a class="ae ky" href="https://lynn-kwong.medium.com/simple-web-scraping-using-requests-beautiful-soup-and-lxml-in-python-4f5903c67db2" rel="noopener">这篇文章</a>会有所帮助。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="36fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择XPath有多种方法。您的方法可以不同于这里使用的方法，只要它能够正确定位元素。登录页面将如下打开:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6c3458e2f28bc05b6b63efba95622e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*6-2TElcL4sgkpVI1eJcNsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7dcf" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何在文本框中输入文本？</h1><p id="ac4f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以通过<code class="fe nc nd ne nf b">send_keys</code>的方法在这个页面输入一个假的用户名和密码。任何文本都可以，因为它只是一个演示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/5d8fe8c1481fa1e5f9158bbfb3d473ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*EvpF_NVd_ZNdV6EYCpflTQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="3360" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以单击“登录”按钮，如上一步所示。或者，我们可以发送一个“输入”键，其效果与单击相同:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="fad4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们“登录”了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/19dff1aa295aa57badcc0551cabcf7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*FsLVgYdDrsTzjfbK_9kLaA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1cc0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何将视图滚动到一个元素？</h1><p id="691e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于一些JavaScript框架，元素的内容(或相关内容)只有在滚动到视图时才会显示。为此，我们需要执行一些脚本。让我们将视图滚动到“下一步”按钮:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1bb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在视图滚动到“下一步”按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/1f95da291b4e403037281dd17a305293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvNxe1QawmbyKVf-JKThUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a05f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何在新标签页中打开链接？</h1><p id="3daa" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这是一个比较棘手的问题，因为大多数在线参考都是针对Java代码的，而针对Python的参考大多已经过时了。要在新标签页中打开一个链接，我们需要使用<code class="fe nc nd ne nf b">ActionChains</code>，它模拟CTRL + CLICK:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="eda4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在“登录”页面在一个新选项卡中打开:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/278902ec43c6937ddc2166304c2071e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NA4m3kJ5v6wKoLPxJ2UrCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="d816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，如果您已登录，您需要先注销才能在新选项卡中打开登录链接。此外，您仍将停留在原来的选项卡上。现在让我们切换到带有Selenium的新选项卡。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e2fe" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何用Selenium切换到新标签页？</h1><p id="c96e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有时一个链接会在一个新的标签页中打开。然而，驱动程序不会直接切换到新的选项卡，我们需要显式地这样做。为此，我们需要获取窗口处理程序并切换到其中一个新标签页:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="711e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们切换到新选项卡，现在可以处理该选项卡的网页中显示的元素:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/385f73eca51aa1fecd9c518f61cb8f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tyedgIsq8IqfTyg90AW5Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="48db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们介绍了一些在网站测试或网页抓取中常用的手动操作。希望对你的工作也有帮助。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1d72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关文章:</p><ul class=""><li id="a304" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><a class="ae ky" href="https://lynn-kwong.medium.com/how-to-scrape-javascript-webpages-using-selenium-in-python-21d56731bb1f" rel="noopener">如何在Python中使用Selenium抓取JavaScript网页</a></li></ul></div></div>    
</body>
</html>