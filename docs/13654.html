<html>
<head>
<title>How to Call Any API From a Solidity Smart Contract, Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从Solidity智能契约中调用任何API，第2部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-call-any-api-from-a-solidity-smart-contract-part-2-6552b6e2e174?source=collection_archive---------8-----------------------#2022-09-14">https://betterprogramming.pub/how-to-call-any-api-from-a-solidity-smart-contract-part-2-6552b6e2e174?source=collection_archive---------8-----------------------#2022-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e2db" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">制定和部署请求者契约，以从Airnode请求数据</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3c4df55dd3197073921dbde896f5df0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*crNHRAgjWh9LoIFX"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的GuerrillaBuzz Crypto PR拍摄</p></figure><p id="4b79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是本教程的第二部分，我们将部署请求者契约并从Airnode请求数据。点击这里查看第一部<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-call-any-api-from-a-solidity-smart-contract-part-i-d1d2f34461b6"/>。</p><p id="b5ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第一部分中，我们通过ChainAPI成功地集成和部署了一个Airnode。现在，我们将编写一个简单的请求者契约来调用和读取Airnode中的数据。</p><p id="7b73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开始之前，请确保您在系统上设置了<a class="ae kv" href="https://github.com/api3dao/airnode" rel="noopener ugc nofollow" target="_blank"> Airnode Monorepo </a>。按照自述文件安装并构建所有依赖项和软件包，以便能够访问Airnode CLI。</p><p id="6203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">克隆Airnode Monorepo。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="367c" class="lx ly iq lt b gy lz ma l mb mc">$ git clone <a class="ae kv" href="https://github.com/api3dao/airnode.git" rel="noopener ugc nofollow" target="_blank">https://github.com/api3dao/airnode.git</a> .</span></pre><p id="f30b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要安装依赖项，</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="dde9" class="lx ly iq lt b gy lz ma l mb mc">$ yarn run bootstrap</span></pre><p id="c95b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了构建所有的包，</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="8764" class="lx ly iq lt b gy lz ma l mb mc">$ yarn run build</span></pre></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="3a24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mk">air node是第一方oracle，它将链外API数据推送到您的链内合同。它向链上的</em> <a class="ae kv" href="https://docs.api3.org/airnode/v0.8/concepts/" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> RRP协议契约</em></a><em class="mk">(</em><a class="ae kv" href="https://docs.api3.org/airnode/v0.8/concepts/#airnoderrpv0-sol" rel="noopener ugc nofollow" target="_blank"><em class="mk">airnoderrpv 0 . sol</em></a><em class="mk">)发出请求，将请求添加到事件日志中。然后，离线Airnode访问事件日志，获取API数据并对请求者执行回调。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/36648b928a7533e8e2ff6a59a596c05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JDASappLaTk5nA9p.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://docs.api3.org/airnode/v0.8/grp-developers/" rel="noopener ugc nofollow" target="_blank">https://docs.api3.org/airnode/v0.8/grp-developers/</a></p></figure><p id="d2f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://docs.api3.org/airnode/v0.8/grp-developers/call-an-airnode.html" rel="noopener ugc nofollow" target="_blank"> <em class="mk">请求方</em> </a> <em class="mk"> </em>是触发Airnode请求的契约。为此，请求者需要得到赞助，并使用匹配的赞助者钱包进行请求。</p><p id="d492" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请求者然后调用协议契约，该协议契约发出一个带有请求参数的区块链事件。Airnode监听由<em class="mk"> AirnodeRrpV0 </em>契约发出的事件。在下一个运行周期中，Airnode从发出的事件中获取请求参数。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><h1 id="f163" class="mm ly iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">编码请求者. sol</h1><p id="4523" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">请求者契约将有两个主要功能，<code class="fe ni nj nk lt b">makeRequest()</code>和<code class="fe ni nj nk lt b">fulfill()</code>。<code class="fe ni nj nk lt b">makeRequest()</code>函数将调用<a class="ae kv" href="https://docs.api3.org/airnode/v0.8/concepts/#airnoderrpv0-sol" rel="noopener ugc nofollow" target="_blank"> AirnodeRrpV0.sol </a>协议契约的<code class="fe ni nj nk lt b">makeFullRequest()</code>函数，该函数将请求添加到其存储器中。目标离链<a class="ae kv" href="https://docs.api3.org/airnode/v0.8/concepts/airnode.html" rel="noopener ugc nofollow" target="_blank"> Airnode </a>从AirnodeRrpV0.sol的存储中收集请求，并使用AirnodeRrpV0.sol的<code class="fe ni nj nk lt b">fulFill()</code>函数进行响应</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h1 id="0f89" class="mm ly iq bd mn mo nn mq mr ms no mu mv jw np jx mx jz nq ka mz kc nr kd nb nc bi translated">请求参数</h1><p id="3e9a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated"><code class="fe ni nj nk lt b">makeRequest()</code>函数期望下面的参数产生一个有效的请求。</p><ul class=""><li id="c5b8" class="ns nt iq ky b kz la lc ld lf nu lj nv ln nw lr nx ny nz oa bi translated"><code class="fe ni nj nk lt b">airnode</code>(地址)和<code class="fe ni nj nk lt b">endpointId</code>指定端点。</li><li id="27a8" class="ns nt iq ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ni nj nk lt b">sponsor</code>和<code class="fe ni nj nk lt b">sponsorWallet</code>(地址)指定将使用哪个钱包来完成请求。</li><li id="f621" class="ns nt iq ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ni nj nk lt b">parameters</code>指定API和<a class="ae kv" href="https://docs.api3.org/ois/v1.1/ois.html#_5-4-reservedparameters" rel="noopener ugc nofollow" target="_blank">保留参数</a>(参见<a class="ae kv" href="https://docs.api3.org/airnode/v0.8/reference/specifications/airnode-abi-specifications.html" rel="noopener ugc nofollow" target="_blank"> Airnode ABI规范</a>了解这些如何编码)我们将使用<code class="fe ni nj nk lt b">@airnode-abi</code>库对参数进行离线编码。</li></ul><h1 id="8297" class="mm ly iq bd mn mo nn mq mr ms no mu mv jw np jx mx jz nq ka mz kc nr kd nb nc bi translated">响应参数</h1><p id="4356" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">对<em class="mk">请求者</em>的回调包含两个参数:</p><ul class=""><li id="d975" class="ns nt iq ky b kz la lc ld lf nu lj nv ln nw lr nx ny nz oa bi translated"><code class="fe ni nj nk lt b"><strong class="ky ir">requestId</strong></code>:发出请求时第一次获取，并在此处作为参考传递，以标识响应所针对的请求。</li><li id="a77d" class="ns nt iq ky b kz ob lc oc lf od lj oe ln of lr nx ny nz oa bi translated"><code class="fe ni nj nk lt b"><strong class="ky ir">data</strong></code>:如果响应成功，这是已被编码的请求数据，除其他响应数据外，还包含一个<a class="ae kv" href="https://docs.api3.org/ois/v1.1/reserved-parameters.html#timestamp-encoded-to-uint256-on-chain" rel="noopener ugc nofollow" target="_blank">时间戳</a>。使用来自<code class="fe ni nj nk lt b">abi</code>对象的函数<code class="fe ni nj nk lt b">decode()</code>对其进行解码。</li></ul><h1 id="8f7f" class="mm ly iq bd mn mo nn mq mr ms no mu mv jw np jx mx jz nq ka mz kc nr kd nb nc bi translated">编制合同</h1><p id="2290" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">为了部署请求者契约，我们将使用<a class="ae kv" href="https://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank"> Remix IDE </a>。这是一个在线IDE，允许为EVM兼容的区块链开发、部署和管理智能合同。</p><p id="1c21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">制作一个合同并粘贴到<a class="ae kv" href="https://github.com/vanshwassan/AirnodeTutorials/blob/master/Contracts/Requester.sol" rel="noopener ugc nofollow" target="_blank"> Requester.sol </a>代码中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/8d007c3afeb27fb05bb3fa846a861f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iOh6xK45pBF8MX9YvXBt1A.png"/></div></div></figure><p id="2d4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在点击仪表板右侧的compile，编译智能合约。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/b56040da45d26159eee97eb7d4537baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*A0SBboW_fTyAC45ws65O2Q.png"/></div></figure><p id="f3af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经准备好部署我们的请求者了。</p><h1 id="a23b" class="mm ly iq bd mn mo nn mq mr ms no mu mv jw np jx mx jz nq ka mz kc nr kd nb nc bi translated">部署请求者</h1><p id="f5b4" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">由于我们将在Polygon Mumbai Testnet上部署合同，请确保您的钱包中有足够的MATIC来部署请求者，然后稍后再为<code class="fe ni nj nk lt b">sponsorWallet</code>提供资金。你可以从孟买的水龙头那里得到一些。</p><p id="bef9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开始部署和运行事务，并选择Environment下的Injected Provider-meta mask选项。连接您的元掩码。确保你在孟买测试网上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/23634f580ddb93880db9dd3a2e422542.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*h34LOQkc5WIAt5l_cWbJ-A.png"/></div></figure><p id="249b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ni nj nk lt b">_rrpAddress</code>是主<em class="mk">气节点。</em>RRP合同已经在链上部署。您可以在这里查看您的具体链条<a class="ae kv" href="https://docs.api3.org/airnode/v0.8/reference/airnode-addresses.html#airnoderrpv0" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9b88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">填写<code class="fe ni nj nk lt b">_rrpAddress</code>并点击部署。确认元掩码上的事务，并等待它部署请求者契约。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/42d5ae402bb634d864a02b12fe606e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*WMB8sP2JDG6XF4XrrTFWog.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">确保你在多边形孟买测试网上</p></figure><h1 id="f130" class="mm ly iq bd mn mo nn mq mr ms no mu mv jw np jx mx jz nq ka mz kc nr kd nb nc bi translated">呼叫请求者</h1><p id="c91f" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">当您的合同被部署后，转到“部署和运行事务”,并单击“已部署的合同”下您的请求者的下拉列表。</p><p id="150a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在选择<code class="fe ni nj nk lt b">makeRequest</code>下拉菜单，查看向Airnode发出完整请求所需传递的所有参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f61537213390fb1c69caeb0871acfbb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*3uaFU21-HM1n8EZVXKxU4A.png"/></div></figure><p id="f870" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，您需要传入您的<code class="fe ni nj nk lt b">airnode</code> (Airnode地址)、<code class="fe ni nj nk lt b">endpointID</code>、<code class="fe ni nj nk lt b">sponsor</code>(请求者本身)、<code class="fe ni nj nk lt b">sponsorWallet</code>和<code class="fe ni nj nk lt b">parameters</code>，以便调用<code class="fe ni nj nk lt b">makeRequest()</code>函数。</p><p id="dda7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在部署Airnode时获得的输出目录下的<code class="fe ni nj nk lt b">receipt.json</code>中找到<code class="fe ni nj nk lt b">airnode</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/3f4ebccb05651a665f4f1711f69a2c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-k9a8EhOFqTbusum7DxMPA.png"/></div></div></figure><p id="d680" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ni nj nk lt b">endpointID</code>可以在<code class="fe ni nj nk lt b">config.json</code>文件下找到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/055b582506cf659bf4cf687a6b33e34b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ha0EzXURgRHKFK74vnLvPA.png"/></div></div></figure><p id="6623" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要通过将进行实际调用的Airnode CLI命令派生出<code class="fe ni nj nk lt b">sponsorWallet</code>。我们还需要一些现金来支付油费。</p><p id="f5a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在设置了Airnode CLI并安装和构建了所有的依赖项和包之后，运行以下命令来派生您的<code class="fe ni nj nk lt b">sponsorWallet</code>:</p><h2 id="d557" class="lx ly iq bd mn on oo dn mr op oq dp mv lf or os mx lj ot ou mz ln ov ow nb ox bi translated">Linux:</h2><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="a1bf" class="lx ly iq lt b gy lz ma l mb mc">npx @api3/airnode-admin derive-sponsor-wallet-address \<br/>  --airnode-xpub xpub6CUGRUo... \<br/>  --airnode-address 0xe1...dF05s \<br/>  --sponsor-address 0xF4...dDyu9</span></pre><h2 id="502f" class="lx ly iq bd mn on oo dn mr op oq dp mv lf or os mx lj ot ou mz ln ov ow nb ox bi translated">窗口:</h2><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="7927" class="lx ly iq lt b gy lz ma l mb mc">npx @api3/airnode-admin derive-sponsor-wallet-address ^<br/>  --airnode-xpub xpub6CUGRUo... ^<br/>  --airnode-address 0xe1...dF05s ^<br/>  --sponsor-address 0xF4...dDyu9</span></pre><p id="906c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的<code class="fe ni nj nk lt b">airnode-address</code>和<code class="fe ni nj nk lt b">airnode-xpub</code>(<em class="mk">air node的</em>扩展公钥)可以在同一个<code class="fe ni nj nk lt b">receipt.json.</code>中找到。<code class="fe ni nj nk lt b">sponsor-address</code>将是请求者契约本身的地址(您刚刚部署的那个)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/07ab06c4b83a2f8dde745f2ebb799eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tl_4usi_XHOZSH65lrdJew.png"/></div></div></figure><p id="d10a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行命令获得您的<code class="fe ni nj nk lt b">sponsorWallet</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/86f1bb8f498af43d6752e23df683564e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cMWyikM8lIAxGk6YEGtd-g.png"/></div></div></figure><p id="5803" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为<code class="fe ni nj nk lt b">sponsorWallet</code>提供一些测试工具。</p><p id="7e4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在发送之前，参数需要在<code class="fe ni nj nk lt b">bytes32</code>中编码。我们将使用<code class="fe ni nj nk lt b">@airnode-abi</code>库对参数进行离线编码，然后将其发送给请求者。</p><p id="d4eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以通过克隆本教程的库来设置它。</p><p id="2ed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行以下命令来获得您的编码<code class="fe ni nj nk lt b">parameters</code>:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="7508" class="lx ly iq lt b gy lz ma l mb mc">node .\src\encodeParams.js</span></pre><p id="8413" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您已经拥有了运行<code class="fe ni nj nk lt b">makeRequest</code>功能所需的所有参数。填写所有字段，然后单击Transact。</p><p id="156a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mk">注意:这里的</em> <code class="fe ni nj nk lt b"><em class="mk">sponsor</em></code> <em class="mk">将是您刚刚部署的请求者契约的地址。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/9d7c881f33be45b042bf671e6f02dbc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*buQhbSCE-pq9hAibHbIOmA.png"/></div></figure><p id="65d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击transact，在MetaMask上确认事务，然后等待事务完成。</p><p id="192b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你可以前往https://mumbai.polygonscan.com查看你的新交易。</p><p id="1399" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mk">您可能需要等待一段时间，因为Airnode调用AirnodeRrpV0.sol中的</em> <code class="fe ni nj nk lt b"><em class="mk">fulfill()</em></code> <em class="mk">函数，该函数将使用函数</em> <code class="fe ni nj nk lt b"><em class="mk">fulfillFunctionId</em></code> <em class="mk">回调</em> <code class="fe ni nj nk lt b"><em class="mk">fulfillAddress</em></code> <em class="mk">处的请求者契约，以交付</em> <code class="fe ni nj nk lt b"><em class="mk">data</em></code> <em class="mk">。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/b068c9aaa7ed02fdf11a6190a296f6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NnNht40SsIYsKEkNW45DvA.png"/></div></div></figure><p id="c23c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们可以看到最新的<em class="mk">完成</em>交易。</p><p id="cb6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在回到Remix上，在日志下检查最近的交易。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/2a2f338ef1a0ed2d7c85078cd4d722a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Km2hDmwINDqShb1PlnXXug.png"/></div></div></figure><p id="af75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你也可以在多边形孟买区块浏览器的日志下找到你的<code class="fe ni nj nk lt b">requestId</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/b8249a5b736a3af3c3c57be9be35a097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ula12KPb0Ykl1NjhhD3z_A.png"/></div></div></figure><p id="a2c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">复制您的<code class="fe ni nj nk lt b">requestId</code>并粘贴到<code class="fe ni nj nk lt b">fulfilledData</code>方法下以解码响应。单击call，您将看到API响应。在这里，我们请求特斯拉的股票价格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/cbad82fd434f7dd5444f87bd4d55b6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*dgVH5M1HlJb-AAwfTao9Hw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/0df97b92943044a739f11c1403ea881a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZ3OgEd9QKtVnPql1hifXA.png"/></div></div></figure><p id="a919" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您已经成功地部署了一个Airnode，并与请求者签订了一个从其中读取数据的合同。你也可以参考<a class="ae kv" href="https://github.com/vanshwassan/AirnodeTutorials" rel="noopener ugc nofollow" target="_blank">这个报告</a>中我在本教程中使用的所有代码。</p><p id="a865" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="462e" class="lx ly iq lt b gy lz ma l mb mc"><strong class="lt ir">Any questions? </strong></span><span id="0cac" class="lx ly iq lt b gy pg ma l mb mc">Check out <a class="ae kv" href="https://discord.com/invite/qnRrcfnm5W" rel="noopener ugc nofollow" target="_blank"><strong class="lt ir">API3’s Discord Server</strong></a> and drop your queries there!</span></pre></div></div>    
</body>
</html>