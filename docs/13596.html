<html>
<head>
<title>Fine-tuning GPT-3 Using Python to Create a Virtual Mental Health Assistant Bot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微调GPT-3使用Python创建一个虚拟精神健康助理机器人</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-finetune-gpt-3-finetuning-our-virtual-mental-health-assistant-641c1f3b1ef3?source=collection_archive---------0-----------------------#2022-09-11">https://betterprogramming.pub/how-to-finetune-gpt-3-finetuning-our-virtual-mental-health-assistant-641c1f3b1ef3?source=collection_archive---------0-----------------------#2022-09-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="96a9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过学习微调GPT-3建立自己的ChatGPT治疗师</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e7db8233edc2c01930b8acdc5fc66b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6H-9UUWquwDSYZnP"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">刘玉英在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c3ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">又见面了！在我的<a class="ae kv" href="https://medium.com/@amagastya.com/how-to-integrate-dialogflow-with-gpt-3-creating-a-personal-virtual-mental-health-assistant-from-fee7d363993a" rel="noopener">上一篇文章</a>中，我概述了通过创建一个虚拟精神健康助手来整合GPT-3和Dialogflow所需的步骤。在这个项目中，我们将通过学习如何微调我们的GPT-3模型来完善我们创建的精神健康聊天机器人。</p><h1 id="93a3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">但是首先，什么是微调？</h1><p id="c1e0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">微调是训练大型语言模型(LLM)来识别特定输入和输出模式的过程，可以应用于任何定制的NLP任务。🥥简而言之，finetuning允许我们将自定义数据集与LLM相匹配，这样模型就可以将其输出推广到我们的特定任务中。</p><h1 id="6d57" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">为什么要微调？</h1><p id="d692" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">摘自官方<a class="ae kv" href="https://beta.openai.com/docs/guides/fine-tuning" rel="noopener ugc nofollow" target="_blank">文档</a>，微调通过提供以下功能让您从GPT-3型号中获得更多:</p><ul class=""><li id="5d85" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">比即时设计质量更高的结果</li><li id="e7d1" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">能够针对一个提示中无法容纳的更多示例进行培训</li><li id="9ed6" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">由于更短的提示，象征性的节省</li><li id="e92f" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">更低延迟的请求</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/7063cfcf364d0440bcd662eceeafe459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h401m7ejErqW-Pxn6BsZVQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">微调明显优于只有即时设计的模型</p></figure><p id="4ee5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">概括地说，微调包括以下步骤:</p><h2 id="4c88" class="nf lt iq bd lu ng nh dn ly ni nj dp mc lf nk nl me lj nm nn mg ln no np mi nq bi translated">1.准备培训数据</h2><p id="8d1a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">GPT-3期望你的微调数据集是一个特定的JSONL文件格式，看起来像这样</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="2d70" class="nw lt iq ns b be nx ny l nz oa">{"prompt": "&lt;prompt text&gt;", "completion": "&lt;ideal generated text&gt;"}<br/>{"prompt": "&lt;prompt text&gt;", "completion": "&lt;ideal generated text&gt;"}<br/>{"prompt": "&lt;prompt text&gt;", "completion": "&lt;ideal generated text&gt;"}</span></pre><p id="0834" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非常简单——每一行都由一个“提示”和一个“完成”组成，这是为特定提示生成的理想文本。</p><p id="11b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在准备和上传数据进行微调之前，第一步是收集数据集。对于我们的心理健康助理，我在Kaggle上发现了这个非常方便的数据集——聊天机器人的<a class="ae kv" href="https://www.kaggle.com/datasets/narendrageek/mental-health-faq-for-chatbot" rel="noopener ugc nofollow" target="_blank">抑郁症数据。按照作者的说法，这些数据可以用来训练机器人来帮助患有抑郁症的人，这正是我们的用例！</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/ee711e0f040d3280c894959dc77d6e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lur-M1VBRW4tmVOgJZ4ow.png"/></div></div></figure><p id="26ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些数据是YAML的一个文件，里面有大约50段关于抑郁症的对话。看起来第一行带双破折号的是用户的问题，后面几行是机器人对用户的回答。让我们在Colab笔记本中进一步探索它。</p><p id="d312" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">探索笔记本可以在<a class="ae kv" href="https://colab.research.google.com/drive/154FWlYVGbvLoYiSWCCeNy5XskskUzRQ3?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="6bab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从Kaggle下载数据集，并将其复制到Google drive文件夹中。导入<code class="fe oc od oe ns b">yaml</code>包来阅读我们的。yml文件，并使用<code class="fe oc od oe ns b">yaml.safe_load()</code>将其转换成JSON对象。</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="a760" class="nw lt iq ns b be nx ny l nz oa">import yaml</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="bd78" class="nw lt iq ns b be nx ny l nz oa">with open('/content/gdrive/MyDrive/depression-data/depression.yml', 'r') as file:<br/>data = yaml.safe_load(file)</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="6809" class="nw lt iq ns b be nx ny l nz oa">data</span></pre><p id="3d41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，让我们按照要求的格式准备数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="f7fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码首先遍历我们的depression数据，拆分第一行作为提示，并连接其余的行作为完成。它还从提示和补全中删除不需要的特殊字符。这产生了正确的数据格式，我们可以用它来微调GPT-3。</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="8e33" class="nw lt iq ns b be nx ny l nz oa">{'prompt': 'What Is Depression?', 'completion': 'Depression is a common and serious medical illness that negatively affects how you feel, the way you think and how you act. Fortunately,it is also treatable. Depression causes feelings of sadness and/or a loss of interest in activities you once enjoyed. It can lead to a variety of emotional and physical problems and can decrease your ability to function at work and at home.'},<br/>{'prompt': 'I feel i have let my parents down', 'completion': 'No matter what,your parents will always be proud of you and will love you. You will feel much better if you share your feelings with them.'}</span></pre><p id="6f02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看几行，我们可以看到补全根据用户的查询提供了一些有帮助的响应，这正是我们需要我们的模型来处理的，以便给有需要的用户实际的答复。</p><p id="f063" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，让我们下载我们的数据作为一个<code class="fe oc od oe ns b">JSONL</code>文件，并将其移动到我们的Colab笔记本项目目录。</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="83e0" class="nw lt iq ns b be nx ny l nz oa">from google.colab import files</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="113e" class="nw lt iq ns b be nx ny l nz oa">with open('depression.jsonl', 'w') as outfile:</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="e39d" class="nw lt iq ns b be nx ny l nz oa">for i in output:</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="29b1" class="nw lt iq ns b be nx ny l nz oa">json.dump(i, outfile)</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="32b2" class="nw lt iq ns b be nx ny l nz oa">outfile.write('\n')</span></pre><pre class="of nr ns nt bn nu nv bi"><span id="f079" class="nw lt iq ns b be nx ny l nz oa">files.download('depression.jsonl')</span></pre><p id="143e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了微调数据集，让我们准备文件，以便可以上传它来微调模型。注意——open ai提供了一个有用的CLI(命令行界面)工具来准备我们的数据。它可以轻松地将CSV、TSV、XLSX、JSON <strong class="ky ir">、T4转换成正确的JSONL格式<strong class="ky ir">。</strong></strong></p><p id="3ed5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要开始，在笔记本单元中或从您的项目终端，只需使用以下命令安装开放AI python依赖项-</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="2b07" class="nw lt iq ns b be nx ny l nz oa">!pip install openai</span></pre><p id="0e7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，要准备微调数据，运行命令-</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="13e3" class="nw lt iq ns b be nx ny l nz oa">!openai tools fine_tunes.prepare_data -f '/content/gdrive/MyDrive/depression-data/depression.jsonl'</span></pre><p id="3bf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请确保在'-f '后面替换您的特定文件路径。在添加一些建议的更改后，此命令将准备您的最终微调数据集。现在，您可以对所有推荐的操作都接受“是”,因为这将有助于提高模型性能——</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/8e3f0763cab3df7990c2604bfc5ff896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpzEAo7ZTFJhgpUpSvw_Jg.png"/></div></div></figure><p id="6d05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重要注意事项—接受第一个建议操作的“是”要求您在推理期间在提示后添加分隔符“--&gt; ”,否则模型将只是继续提示，而不是预测完成。</p><p id="41bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下载的最终文件将以“prepared”作为后缀，然后可以上传并用于微调模型。</p><p id="a46d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我们的finetune任务只有51个样本。为了获得更好的精度，Open AI建议至少有150–200个finetune示例，因为模型精度随着训练样本的数量线性增加。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/b1643a089273f14ad0b23d7ad0559a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lmmfWna-5tkXYA3xfrJvPQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/fine-tune-gpt3-for-quality-results-3f91f1ab44ea">参考Albarqawi对GPT-3进行微调以获得高质量的结果</a></p></figure><h2 id="5393" class="nf lt iq bd lu ng nh dn ly ni nj dp mc lf nk nl me lj nm nn mg ln no np mi nq bi translated">2.训练新的微调模型</h2><p id="8855" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们已经准备好了数据，是时候对GPT 3号进行微调了！⚙️:我们有三种主要的方法来微调这个模型</p><p id="a0d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">(I)手动使用OpenAI CLI，(ii)以编程方式使用OpenAI包，以及(iii)通过finetune API端点。</p><p id="dbad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本教程，我将使用OpenAI CLI，因为它最容易上手。若要微调模型，请运行下面的命令，其中“-m”后的值将用于训练特定的GPT-3模型。由于我想训练最有能力的模型，我选择了“达芬奇”，这也是最昂贵的使用。</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="794b" class="nw lt iq ns b be nx ny l nz oa">!openai api fine_tunes.create -t "/content/gdrive/MyDrive/depression-data/depression_prepared.jsonl" -m davinci</span></pre><p id="2ce6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您尝试运行它，您可能会得到类似“没有提供API键”的错误。那是因为我们还没有链接我们的API键。为此，只需在CLI中将一个环境变量设置为您的秘密API密钥，方法是运行-</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="ec70" class="nw lt iq ns b be nx ny l nz oa">!set OPENAI_API_KEY=&lt;YOUR-API-KEY&gt;</span></pre><p id="e7a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者在笔记本上运行下面的单元格-</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="512a" class="nw lt iq ns b be nx ny l nz oa">os.environ['OPENAI_API_KEY'] = "&lt;YOUR-API-KEY&gt;"</span></pre><p id="a305" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在再次运行前面的finetune命令，瞧！—您的GPT-3微调作业现已成功创建。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/aebdea5626fec5206da0077aa056d2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtZITP2UcWMDzo3_yx5_jA.png"/></div></div></figure><p id="53d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">CLI还将向您显示相关的微调成本、您的队列位置和培训周期。一旦完成，你自己的微调GPT-3模型现在可以进行推理了！</p><h2 id="375a" class="nf lt iq bd lu ng nh dn ly ni nj dp mc lf nk nl me lj nm nn mg ln no np mi nq bi translated">3.使用你的微调模型</h2><p id="7627" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了使用新创建的微调模型，我们可以首先在开放的人工智能操场上测试它。前往操场，选择你的微调模型，模型下，微调。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fc9fa2453de40d57039843625c168bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*woJvDL2MW2rGzFi9LzsP1Q.png"/></div></figure><p id="e52e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从这里，我们可以测试一些提示，看看我们微调后的模型表现如何。</p><h1 id="a95e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">提示</h1><p id="fcc0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在我之前的帖子中，我们对这个模型给出了以下提示，这个模型本身表现得相当好—</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="7157" class="nw lt iq ns b be nx ny l nz oa">The following is a conversation with an AI assistant that can have meaningful conversations with users. The assistant is helpful, empathic, and friendly. Its objective is to make the user feel better by feeling heard. With each response, the AI assisstant prompts the user to continue the conversation in a natural way</span></pre><p id="9581" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它工作得很好，但是在一些额外的提示工程之后，我决定增加一些信息。首先，我给了我的人工智能治疗助手一个角色——乔伊。(Apt，呃？😏)</p><p id="648b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我给JOY添加了一些个性特征，最后指定了JOY的核心目标函数——通过感觉被听到来帮助用户感觉更好。我最后使用的提示是—</p><pre class="kg kh ki kj gt nr ns nt bn nu nv bi"><span id="1e6e" class="nw lt iq ns b be nx ny l nz oa">The following is a conversation with a therapist and a user. The therapist is JOY, who uses compassionate listening to have helpful and meaningful conversations with users. JOY is empathic and friendly. JOY's objective is to help the user feel better by feeling heard. With each response, JOY offers follow-up questions to encourage openness and continues the conversation in a natural way.</span></pre><h1 id="b4cc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结果呢</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/7eea85e62c180d60ceebc6c685c6a0e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezPWUU7iFWhE-PxF2iLp0w.png"/></div></div></figure><p id="f136" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你在上面看到的，结果是成功的。JOY能够运用类似人类的特质，比如富有同情心的倾听和同情，并且能够正确地为用户的问题提供有用的解决方案！</p><p id="cd91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意——JOY仍然不能在长时间的对话中交谈，它需要在与用户的长时间对话中进行微调，以获得更好的上下文和结果。</p><p id="23de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦您对输出结果感到满意，我们就可以将其部署到我们的应用程序中。需要更改的只是模型的名称，它将被我们新训练的模型替换。我们现在可以在我们的应用程序中以编程方式使用微调后的模型。只需在OpenAI游乐场中点击“显示代码”即可复制代码。</p><h1 id="9bc4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">把所有的放在一起</h1><p id="172c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">既然我们的微调模型已经可以使用了，让我们将它与我们的Dialogflow代理集成起来。为此，我们需要更新之前的webhook实现代码并部署它。</p><p id="79e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://medium.com/@amagastya.com/how-to-integrate-dialogflow-with-gpt-3-creating-a-personal-virtual-mental-health-assistant-from-fee7d363993a" rel="noopener">上次</a>，我们使用Node.js和<a class="ae kv" href="http://repl.it" rel="noopener ugc nofollow" target="_blank"> Repl.it </a>作为我们的web服务器，但是为了稍微混合一下，这次让我们使用python Flask服务器🐍。一旦更新，我们的webhook端点应该看起来类似于<a class="ae kv" href="https://github.com/amoghagastya/gpt3-finetune-py-webhook/blob/main/main.py" rel="noopener ugc nofollow" target="_blank"> this </a>。现在，开始部署我们的webhook实现服务器。</p><p id="8831" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们继续之前，让我们为Heroku的自由等级的死亡默哀片刻💀。Heroku是一个简单易用的平台，可以部署你的任何网络应用。既然它不再提供免费计划，我们将需要一个替代方案来快速免费部署我们的应用程序——进入<a class="ae kv" href="https://railway.app" rel="noopener ugc nofollow" target="_blank"> Railway。App </a>！</p><p id="bf75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mp"> Railway </em>是一个云平台，你可以在这里轻松托管和部署你的任何应用。他们提供了一个慷慨的免费层，并拥有极快的部署速度。确保首先将您的本地回购推送到Github，以便可以部署它。登录您的铁路帐户，进入仪表板后，添加一个新项目。然后选择从Github上传，选择你的git回购，就这样了！您的应用程序现已上线。(确保在Dialogflow代理中更新Webhook URL)</p><h1 id="8591" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">输出</h1><div class="kg kh ki kj gt ab cb"><figure class="on kk oo op oq or os paragraph-image"><img src="../Images/00abe359799165ea54a56cadf3b75399.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*Rg6mKyF8eSKW3L35OGkpBw.png"/></figure><figure class="on kk oo op oq or os paragraph-image"><img src="../Images/a53c229bad9398f4ff8a90472a0a5431.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*TByrlJb90b7ytyG3NRZ8Sg.png"/><p class="kr ks gj gh gi kt ku bd b be z dk ot di ou ov translated">从训练数据来看，模型表现出富有同情心的倾听</p></figure></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/7f0376e32c4b871e11c7e1bff06f0d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*w4eg3k413qju2-j_00WDwQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">请注意，该模型还发现了偏差，如标点错误和训练数据的不一致。</p></figure><p id="6253" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里测试一下微调后的心理健康助手——<a class="ae kv" href="https://amagastya.com/gpt3" rel="noopener ugc nofollow" target="_blank">amagastya.com/gpt3</a></p><p id="8032" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别大声喊出来<a class="ae kv" href="https://www.youtube.com/c/DavidShapiroAutomator" rel="noopener ugc nofollow" target="_blank">大卫夏皮罗</a>！请务必查看他的令人敬畏的公共GPT-3 Finetunes回购，以获得更容易使用的数据—<a class="ae kv" href="https://github.com/daveshap/GPT3_Finetunes" rel="noopener ugc nofollow" target="_blank">https://github.com/daveshap/GPT3_Finetunes</a></p><h1 id="ecd3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="472e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">事实证明，微调GPT-3和其他LLM是特定领域任务的完美解决方案，通常可以将性能提高许多倍。该模型在挑选训练数据中指定的模式方面极其有效，并且即使在训练数据最少的情况下也表现良好。</p><p id="88de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们目前看到的，随着LLM变得更大、更容易访问和开源，我们可以预计微调在自然语言处理中无处不在，因为它有可能解决任何NLP任务。</p><p id="11e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你喜欢学习如何微调GPT-3和你的虚拟助理。下一集见。</p><p id="7105" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在LinkedIn上关注我，地址:<a class="ae kv" href="https://www.linkedin.com/in/amoghagastya/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/amoghagastya/</a>，在<a class="ae kv" href="https://amagastya.com" rel="noopener ugc nofollow" target="_blank">https://amagastya.com</a>随时联系</p></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><p id="85dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也读-</p><div class="pe pf gp gr pg ph"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-give-your-chatbot-the-power-of-neural-search-with-openai-ebcff5194170"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ir gy z fp pm fr fs pn fu fw ip bi translated">使用GPT 3优化你的聊天机器人的对话智能</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">用OpenAI赋予你的聊天机器人神经搜索的能力</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">better编程. pub</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv kp ph"/></div></div></a></div><div class="pe pf gp gr pg ph"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-integrate-dialogflow-with-gpt-3-creating-a-personal-virtual-mental-health-assistant-from-fee7d363993a"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ir gy z fp pm fr fs pn fu fw ip bi translated">如何将Dialogflow与GPT-3集成</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">从头开始创建虚拟精神健康助手</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">better编程. pub</p></div></div><div class="pq l"><div class="pw l ps pt pu pq pv kp ph"/></div></div></a></div></div></div>    
</body>
</html>