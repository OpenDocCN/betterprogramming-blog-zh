<html>
<head>
<title>An Example Micro Front End With Kong</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以孔为例微前端</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/example-micro-front-end-with-kong-ed001d601c0a?source=collection_archive---------7-----------------------#2020-01-17">https://betterprogramming.pub/example-micro-front-end-with-kong-ed001d601c0a?source=collection_archive---------7-----------------------#2020-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8a57" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建微前端不必复杂——孔的一个应用实例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6bc48931a9baae61258eb83bb2379e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vN_0rYWetewNJwazEv02DQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@fellowferdi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">费迪南·斯托尔</a>在<a class="ae ky" href="https://unsplash.com/s/photos/micro-front-end?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="4a1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一块的代码可以在GitHub 上找到<a class="ae ky" href="https://github.com/HarryEMartland/kong-micro-front-end" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="336d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">微前端(MFE)概述</h1><p id="274d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="https://micro-frontends.org/" rel="noopener ugc nofollow" target="_blank">micro-frontends.org</a>是理解MFEs的一个很好的资源。对于这个示例应用程序来说，主要目标不是让一个整体服务于一个应用程序的所有页面。我们编写小的服务，每个服务处理一件事情。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7c4d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">按指定路线发送</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完整的源代码可以在<a class="ae ky" href="https://github.com/HarryEMartland/kong-micro-front-end" rel="noopener ugc nofollow" target="_blank">这里找到</a></p></figure><p id="957b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于您的应用程序被分成许多小的服务，您需要一种方法将请求路由到正确的服务。对于这个示例项目来说，Kong可能有些过了，但它允许在实际系统中使用复杂的路由规则。本质上，它充当服务的反向代理，这些服务将为特定的路由生成内容。</p><p id="754a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，我们将<code class="fe nb nc nd ne b">/</code>路由到<code class="fe nb nc nd ne b">book-list</code>服务，并将匹配<code class="fe nb nc nd ne b">/book/\d+</code>的路由到<code class="fe nb nc nd ne b">book-detail</code>服务。Kong接受路径路由规则的正则表达式，允许配置是特定的，查找以<code class="fe nb nc nd ne b">/book/</code>开始的请求，然后使用正则表达式<code class="fe nb nc nd ne b">\d+</code>(至少一个数字)查找图书id。这使得以<code class="fe nb nc nd ne b">/book/</code>开始但不以数字结束的路由为将来的服务开放。</p><p id="0400" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我第一次建立孔的时候，我确实经历了一些困惑。默认情况下，Kong不在路径上代理，因此<code class="fe nb nc nd ne b">/book/\d+</code>正确地代理到了<code class="fe nb nc nd ne b">book-detail</code>服务。然而，<code class="fe nb nc nd ne b">book-detail</code>服务返回了一个<code class="fe nb nc nd ne b">404</code>，因为它将请求视为<code class="fe nb nc nd ne b">/</code>。添加<code class="fe nb nc nd ne b">strip_path</code>参数后，一切正常。在某些情况下，不代理路由可能是有用的，例如，长的入站URL可能对下游服务隐藏。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="51c3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">体系结构</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/826d4cc29eb477ba096784dbe5deca65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTnpYgywgHiWYXwbi8itZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内置<a class="ae ky" href="https://github.com/mermaid-js/mermaid" rel="noopener ugc nofollow" target="_blank">美人鱼JS </a></p></figure><p id="1a11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序有两个页面——一个列出书籍，另一个显示给定书籍的详细信息。这些页面由两个服务处理，<code class="fe nb nc nd ne b">book-list</code>和<code class="fe nb nc nd ne b">book-detail</code>。关于书籍的数据由<code class="fe nb nc nd ne b">book-api</code>提供，它有两个端点，一个返回书籍名称和ID的列表，另一个返回给定ID的书籍详细信息。两个页面的底部都有一个页脚，页脚的HTML由<code class="fe nb nc nd ne b">footer</code>服务提供。页面服务向<code class="fe nb nc nd ne b">footer</code>发出HTTP请求，后者返回部分HTML，然后可以嵌入页面。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="31c2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">提高</h1><p id="2612" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">就目前的情况来看，这个演示相当基础。我的计划是为页面内容和路由增加基本的实验。我还想添加一些服务，将请求元数据添加到页面微服务的请求中。这两个特性都需要为Kong编写Lua插件。</p><p id="21ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kubernetes是目前部署应用程序的标准方式。我们应该能够像使用k8s资源声明应用程序定义一样声明我们的应用程序路由配置。这允许我们将所有的配置保存在我们的应用程序附近，并且在版本控制中。</p><p id="fedd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过在GitHub上查看<a class="ae ky" href="https://github.com/HarryEMartland/kong-micro-front-end" rel="noopener ugc nofollow" target="_blank">这个回购</a>来玩这个设置。</p></div></div>    
</body>
</html>