<html>
<head>
<title>Apache Mesos. What’s That?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">阿帕奇Mesos。那是什么？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/apache-mesos-whats-that-75a1cd8a4b6c?source=collection_archive---------6-----------------------#2021-07-06">https://betterprogramming.pub/apache-mesos-whats-that-75a1cd8a4b6c?source=collection_archive---------6-----------------------#2021-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="74ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据中心的操作系统</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/132d63375e354c62945f75d12ed5730f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bcHx9rT3SjPhZ_osRlGxdw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自维基百科的Apache Mesos标志</p></figure><p id="a78c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">众所周知，互联网在今天非常流行——每天都有数百万人使用。这意味着开发在线服务和应用程序的公司需要数十、数百甚至数千台服务器来处理大量的流量。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="28db" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">服务器和数据中心</h1><p id="a2d8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">必须对服务器进行管理和监控，以确保它们按预期运行。但是管理和监控服务器可能是一件令人头疼的事情，尤其是当它们变得越来越多的时候。</p><p id="664e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管理充满服务器的整个数据中心基础架构怎么样？这肯定会成为一场真正的噩梦。</p><p id="ece2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，数据中心的常见做法是将多台物理和/或虚拟服务器组合在一起。这些服务器组被称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Computer_cluster" rel="noopener ugc nofollow" target="_blank">集群</a>。通过形成集群，数据中心为应用程序提供了更大规模运行的可能性。此外，那些运行在多台机器上的应用程序被称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Distributed_computing" rel="noopener ugc nofollow" target="_blank">分布式应用程序</a>。</p><p id="a227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">集群之间运行不同的应用程序是很常见的。因此，当需要增加计算能力时，需要将机器从一个集群转移到另一个集群。将机器从一个集群转移到另一个集群的过程也不好玩。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="de40" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">阿帕奇Mesos</h1><h2 id="9489" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">概观</h2><p id="61e6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Apache Mesos 是一个开源、分布式、高可用性和容错的集群管理器，最初由加州大学伯克利分校开发。</p><p id="6bcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与Kubernetes 类似，Apache Mesos提供了一种开发分布式应用程序的简单方法。</p><p id="2c49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos为数据中心内的一组给定服务器提供CPU、内存和磁盘资源抽象。它可以很容易地让数据中心表现得像一台巨大的机器。</p><p id="13ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos是一个抽象层，它抽象了虚拟机和物理机。</p><p id="1624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos的基本思想是在一群机器前充当<a class="ae ky" href="https://en.wikipedia.org/wiki/Facade_pattern" rel="noopener ugc nofollow" target="_blank">门面</a>。这样一组由Mesos管理的机器被称为<em class="nl"> Mesos集群</em>。因此，您可以直接联系Mesos，它将为您管理您的工作负载，而不是联系特定的服务器来部署工作负载。</p><p id="a0da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不同的分布式系统和应用程序——例如Spark和Jenkins——可以通过与Mesos的交互轻松地消耗集群资源。</p><p id="a641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，在Mesos中，分布式应用也被称为<em class="nl">框架</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/d3404be3df3f24be63eadc44170cc29e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hh0Ym-tc2uOX9gFyPF8dow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单的Mesos概念图由<a class="ae ky" href="https://www.amazon.com/Mesos-Action-Roger-Ignazio/dp/1617292923" rel="noopener ugc nofollow" target="_blank"> Mesos在行动</a>书</p></figure><h2 id="01ab" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">概念</h2><p id="6219" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Mesos是围绕被称为<em class="nl">资源提供</em>、<em class="nl">双层调度</em>和<em class="nl">资源隔离</em>的概念构建的。</p><p id="5e92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">资源提供</strong>是对Mesos集群中给定机器的当前可用CPU、内存和存储资源的描述。</p><p id="5665" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">双层调度</strong>是一种调度机制，由两个不同层次的调度组成。第一级调度由Mesos控制器的分配模块或调度算法完成，它为给定的框架提供资源。资源以集群可用资源百分比的形式提供给框架。第二层调度是由框架的内部调度器完成的，它调度给定的用户任务。这个概念类似于<a class="ae ky" href="https://en.wikipedia.org/wiki/Green_threads" rel="noopener ugc nofollow" target="_blank"> <em class="nl">绿色螺纹</em> </a>的概念。内部调度器由框架本身实现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/6d501a93406954de9a55e4ddad8f4a35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jbqZym2qeHu4qsl-.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Golang中的绿色线程概念由<a class="ae ky" href="https://osmh.dev/posts/goroutines-under-the-hood" rel="noopener ugc nofollow" target="_blank"> Osamh Aloqaily </a></p></figure><p id="fe1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常方便的是，分配模块是一个可插拔的组件。它可以被更适合特定场景的自定义资源共享算法所取代。分配模块的默认调度算法是主导资源公平算法，其目的是最大化所有用户的最小主导份额。它非常适合大多数用例。</p><blockquote class="no np nq"><p id="9988" class="kz la nl lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">“简而言之，DRF寻求在所有用户中最大化最小支配份额。例如，如果用户A运行CPU密集型任务，而用户B运行内存密集型任务，DRF会尝试使用户A的CPU份额与用户B的内存份额相等。在单一资源的情况下，DRF降低到该资源的最大-最小公平性— <a class="ae ky" href="https://www.amazon.com/Mesos-Action-Roger-Ignazio/dp/1617292923" rel="noopener ugc nofollow" target="_blank">我的世界在行动</a>罗杰·伊格纳齐奥</p></blockquote><p id="0f58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">资源隔离</strong>是一种为进程提供虚拟空间的机制，保护它们免受恶意逃逸和闯入同一主机或共享基础设施上的其他进程的企图。使用这种隔离技术，物理基础设施可以确保多个进程可以在同一基础设施上运行，而不会对彼此产生任何负面影响。这允许多个应用程序在一台机器上并行运行。Mesos通过使用Docker容器或Linux cgroups为应用程序提供了一种在隔离环境中运行的方式。</p><p id="8569" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些特征使得Mesos的行为完全像一个操作系统——一个旨在管理机器集群的操作系统。正如操作系统为进程运行提供了一个隔离的虚拟空间一样，Mesos为其应用程序提供了隔离。此外，就像操作系统有一个调度程序为进程提供必要的CPU使用时间一样，Mesos有一个调度算法为正在运行的应用程序提供适当的集群资源。最后，正如操作系统为进程交互设置公共基础设施和公共API一样，Mesos提供了一组应用程序可以利用的公共API。</p><h2 id="89fd" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">体系结构</h2><p id="3be8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">像大多数其他集群管理器一样，Mesos由<em class="nl">控制器</em>和<em class="nl">代理</em>机器组成。</p><p id="14b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">代理机器</strong>是运行Mesos代理守护进程的机器。这个代理守护进程定期测量它们当前运行的机器的资源，并将这些测量结果以<strong class="lb iu">资源提供</strong>的形式发送给Mesos控制器。因此，Mesos控制器确切地知道集群有多少可用资源。随后，这些可用的资源被分配给需要消耗集群资源的不同应用程序。</p><p id="630e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">控制器机器</strong>是运行分配模块的机器。该组件从代理机器收集资源供应，并决定哪个集群资源进入哪个框架。当有多个Mesos控制器时，有一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Leader_election" rel="noopener ugc nofollow" target="_blank">领导者选举</a>过程，将其中一个控制器提升为领导者，而所有其他控制器都被标记为追随者。只有主Mesos控制器运行，而从控制器处于待机模式。如果领导者Mesos控制器由于某种原因失败并终止，其中一个追随者成为领导者并代替失败的领导者继续运行。这说明了Mesos的<a class="ae ky" href="https://mesos.readthedocs.io/en/0.24.1/high-availability/" rel="noopener ugc nofollow" target="_blank">高可用性</a>模式。</p><p id="d719" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">另一方面，框架</strong>是消耗集群资源的实际分布式应用。它们负责调度和执行任务，因此它们由两个组件组成:调度器和执行器。调度器负责接受或拒绝资源提供。基于框架必须执行的任务的数量和大小来接受或拒绝资源提议。另一方面，执行器是在Mesos代理上启动的进程，负责在Mesos代理上运行框架的任务。</p><h2 id="aa4d" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">Mesos在行动</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/ee5c48f9d5d2f97c94698da782c570a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*syqu01eQ9b15BAaIzQnVxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.amazon.com/Mesos-Action-Roger-Ignazio/dp/1617292923" rel="noopener ugc nofollow" target="_blank"> Mesos in Action </a> book的双层排班图</p></figure><p id="4c35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上图中，我们可以看到所有提到的概念:资源提供、双层调度、资源隔离、代理和控制器机器以及框架。</p><p id="c059" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步——首先，我们看到代理机器向控制器机器发送一个资源提议。</p><p id="6fa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二步——之后，控制器机器的资源分配模块选择一个框架来提供这些资源。基于所选框架是否有一些作业要执行，可以接受或拒绝所提供的资源。</p><p id="bac0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三步——假设选择的框架没有任何要执行的任务；因此，资源提议被拒绝。在资源提供被拒绝之后，Mesos控制器分配模块将这些资源提供给另一个框架。</p><p id="fd70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第四步——现在让我们假设框架接收了一个必须执行的任务。在这种情况下，框架等待来自Mesos控制器的满足工作负载的资源提议。</p><p id="687e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤五——在接收到合适的资源提议时，框架的调度器接受该资源提议，并在可用的Mesos代理上调度一个或多个任务。在Mesos代理上，这些任务在一个容器化的环境中运行，以便在所有其他正在运行的任务之间提供隔离。</p><h2 id="16be" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">何时使用Mesos</h2><p id="50a5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如今，几乎每个软件公司都必须满足大规模运行的要求。</p><p id="86db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos集群有助于更高效地扩展和运行数据中心。</p><p id="6db6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos最适合大型系统，它是为实现最大冗余而设计的。</p><p id="c770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有Hadoop、Kafka等现有工作负载，建议使用Mesos。它为您提供了一个框架，让您可以将这些工作负载相互交错。</p><p id="618d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常稳定的平台，但是对于10到20台机器的小规模系统来说太复杂了。这就是为什么Mesos通常被推荐，并且最适合使用多云和多区域集群的公司，如Airbnb、网飞、Twitter或优步。</p><p id="0ba7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好是，Mesos应该只运行无状态的应用程序，这些应用程序可以很容易地关闭或启动，而不会产生负面影响。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="80b3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="5e24" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Apache Mesos被命名为“您数据中心的操作系统”。这充分说明了Mesos可以带来的强大功能和便利。</p><p id="1d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mesos可以极大地优化集群资源的使用，同时为分布式系统的开发提供便利和支持。这对大型组织非常有利。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="acb1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><div class="nv nw gp gr nx ny"><a href="https://mesos.apache.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">阿帕奇Mesos</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">线性可扩展性行业经验证，可轻松扩展至10，000个节点。高可用性容错复制…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">mesos.apache.org</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a href="https://www.amazon.com/Mesos-Action-Roger-Ignazio/dp/1617292923" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Mesos在行动</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">亚马逊网站:Mesos in Action (9781617292927):伊格纳西奥，罗杰:书籍</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.amazon.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>