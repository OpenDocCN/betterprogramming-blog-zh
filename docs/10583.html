<html>
<head>
<title>A Complete Guide to Building Ethereum dApps: Front-end and Back-end</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊dApps构建完全指南:前端和后端</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-complete-guide-to-build-ethereum-dapps-front-end-and-back-end-6fa44b66554b?source=collection_archive---------0-----------------------#2022-01-17">https://betterprogramming.pub/a-complete-guide-to-build-ethereum-dapps-front-end-and-back-end-6fa44b66554b?source=collection_archive---------0-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6c0f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">面向全栈开发人员的端到端dApp教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/230bb5f7b383e20baebcee7f489a8ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2llFLagpuhjLocEV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯利·西克玛在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="f2c8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是DApp？</h1><p id="556c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">DApp是一个大部分或完全分散的应用程序。</p><p id="786c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">考虑可能被分散的应用程序的所有可能的方面:</p><ul class=""><li id="7b86" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">后端软件(应用程序逻辑)</li><li id="695c" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">前端软件</li><li id="bfcb" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">数据存储</li><li id="cd92" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">消息通信</li><li id="f5af" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">名字解析</li></ul><p id="8f05" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中的每一个都可以是某种程度上集中的或某种程度上分散的。例如，前端可以开发为运行在中央服务器上的web应用程序，或者运行在您的设备上的移动应用程序。后端和存储可以在私有服务器和专有数据库上，或者您可以使用智能合同和P2P存储。</p><p id="72fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">创建DApp有许多典型的集中式架构无法提供的优势:</p><p id="8611" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">弹性</strong>:因为业务逻辑由智能合约控制，DApp后端将完全在区块链平台上分布和管理。与部署在集中式服务器上的应用程序不同，DApp没有停机时间，只要平台还在运行，它就可以继续使用。</p><p id="e4d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">透明性:DApp的链上特性允许每个人检查代码并更加确定它的功能。与DApp的任何交互都将永远存储在区块链中。</p><p id="2156" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">审查阻力</strong>:只要用户能够访问以太坊节点(如有必要，运行一个)，用户将始终能够与DApp交互，而不受任何集中控制的干扰。一旦代码部署到网络上，任何服务提供商，甚至是智能合约的所有者，都不能更改代码。</p><p id="81f8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在以太坊生态系统中，就像今天这样，很少有真正去中心化的应用程序——大多数仍然依赖于集中的服务和服务器来完成部分操作。在未来，我们期望任何DApp的每一部分都有可能以完全分散的方式运作。</p><h1 id="1745" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">后端(智能合同)</h1><p id="ba02" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在DApp中，智能合约用于存储业务逻辑(程序代码)和应用程序的相关状态。您可以将智能合约看作是常规应用程序中服务器端(也称为“后端”)组件的替代品。当然，这过于简单化了。一个主要的区别是，在智能契约中执行的任何计算都是非常昂贵的，因此应该尽可能保持最小。因此，确定应用程序的哪些方面需要一个可信的、分散的执行平台非常重要。</p><p id="0ba2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以太坊智能合约允许您构建这样的架构，在该架构中，智能合约网络相互调用和传递数据，在它们运行时读取和写入它们自己的状态变量，它们的复杂性仅受阻塞气体限制的限制。在您部署了智能合约之后，您的业务逻辑很可能在将来被许多其他开发人员使用。</p><p id="28b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">智能合约体系结构设计的一个主要考虑因素是，一旦部署了智能合约，就无法更改其代码。如果使用可访问的自毁操作码对其进行编程，则可以将其删除，但是除了完全删除之外，不能以任何方式对代码进行更改。</p><p id="8823" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">智能合约架构设计的第二个主要考虑因素是DApp规模。部署和使用一份真正大型的整体智能合同可能会耗费大量的天然气。因此，一些应用程序可能选择离线计算和外部数据源。但是，请记住，让DApp的核心业务逻辑依赖于外部数据(例如，来自中央服务器的数据)意味着您的用户将不得不信任这些外部资源。</p><h1 id="1497" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">前端(网络用户界面)</h1><p id="832a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">dApp的业务逻辑要求开发者理解EVM和Solidity等新语言，与之不同的是，dApp的客户端界面可以使用标准的web技术(HTML、CSS、JavaScript等)。).这允许传统的web开发人员使用熟悉的工具、库和框架。与以太坊的交互，比如签署消息、发送交易和管理密钥，通常是通过web浏览器，经由诸如MetaMask的扩展来进行的。</p><p id="ed22" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然也可以创建移动dApp，但是目前几乎没有资源来帮助创建移动dApp前端，这主要是因为缺少可以充当具有密钥管理功能的轻型客户端的移动客户端。</p><p id="9beb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">前端通常通过web3.js JavaScript库链接到以太坊，该库与前端资源捆绑在一起，由web服务器提供给浏览器。</p><h1 id="fd0a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据存储</h1><p id="9c1d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于高昂的天然气成本和目前较低的区块天然气限制，智能合同不太适合存储或处理大量数据。因此，大多数DApps利用链外数据存储服务，这意味着他们将以太坊链外的大量数据存储在数据存储平台上。该数据存储平台可以是集中式的(例如，典型的云数据库)，或者数据可以是分散的，存储在P2P平台(如IPFS)或以太坊自己的Swarm平台上。</p><p id="632d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">分散式P2P存储非常适合存储和分发大型静态资产，如图像、视频和应用程序前端web界面的资源(HTML、CSS、JavaScript等)。).接下来，我们将看看几个选项。</p><h1 id="cbfa" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">IPFS</h1><p id="0e90" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">行星间文件系统(IPFS)是一种分散的内容可寻址存储系统，它在P2P网络中的对等点之间分发存储的对象。“内容可寻址”意味着每一部分内容(文件)都经过哈希处理，哈希用于标识该文件。然后，您可以通过散列请求从任何IPFS节点检索任何文件。</p><p id="4e7e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">IPFS的目标是取代HTTP，成为交付web应用程序的首选协议。文件存储在IPFS上，可以从任何IPFS节点检索，而不是将web应用程序存储在单个服务器上。</p><p id="29aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">更多关于IPFS的信息可以在<a class="ae ky" href="https://ipfs.io/" rel="noopener ugc nofollow" target="_blank"> https://ipfs.io </a>找到。</p><h1 id="908a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">蜂群</h1><p id="b8ba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Swarm是另一个内容寻址P2P存储系统，类似于IPFS。Swarm是以太坊基金会创建的，作为Go-Ethereum工具套件的一部分。像IPFS一样，它允许你存储由群体节点传播和复制的文件。你可以通过散列引用任何Swarm文件来访问它。Swarm允许你从一个分散的P2P系统访问一个网站，而不是一个中央网络服务器。</p><p id="a3f2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Swarm的主页本身存储在Swarm上，可以在你的Swarm节点或网关上访问:【https://swarm-gateways.net/bzz:/theswarm.eth/】T2。</p><h1 id="31ff" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分散式消息通信协议</h1><p id="4f54" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">任何应用程序的另一个主要组件是进程间通信。这意味着能够在应用程序之间、应用程序的不同实例之间或者应用程序的用户之间交换消息。传统上，这是依靠中央服务器来实现的。然而，除了基于服务器的协议之外，还有各种分散的替代方案，通过P2P网络提供消息传递。DApps最著名的P2P消息协议是<a class="ae ky" href="http://bit.ly/2CSls5h" rel="noopener ugc nofollow" target="_blank"> Whisper </a>，它是以太坊基金会Go-Ethereum工具套件的一部分。</p><p id="5d8d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">应用程序可以去中心化的最后一个方面是名称解析。在这一章的后面，我们将仔细研究以太坊的名称服务；不过，现在让我们来看一个例子。</p><h1 id="3443" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拍卖DApp</h1><p id="bfb0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">拍卖DApp允许用户注册一个“契约”令牌，它代表一些独特的资产，如房子、汽车、商标等。一旦代币被注册，代币的所有权被转移到拍卖DApp，允许它被挂牌出售。拍卖DApp列出了每一个注册的令牌，允许其他用户出价。在每次拍卖期间，用户可以加入一个专门为该拍卖创建的聊天室。一旦拍卖结束，代币所有权将转移给拍卖的获胜者。</p><p id="1742" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">整个拍卖过程可以在下图中看到</p><p id="3e5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的拍卖DApp的主要组成部分是:</p><ul class=""><li id="ea10" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">实现ERC721不可替换“契约”令牌(DeedRepository)的智能合约</li><li id="381d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">实施拍卖(<code class="fe ng nh ni nj b">AuctionRepository</code>)以出售契约的智能合同</li><li id="fb26" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">使用Vue/Vuetify JavaScript框架的web前端</li><li id="6ff7" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">用于连接以太坊链的web3.js库(通过MetaMask或其他客户端)</li><li id="7936" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">一个群组客户端，用于存储图像等资源</li><li id="3e30" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">一个耳语客户端，为所有参与者创建每次拍卖聊天室</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/4163ecc13deac10829fc542dc1d589e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Nyb-tdo5WJ6y9FP"/></div></div></figure><p id="5652" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以在这里找到拍卖dApp <a class="ae ky" href="https://github.com/ac12644/auction_dapp.git" rel="noopener ugc nofollow" target="_blank">的源代码。</a></p><h1 id="754b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拍卖DApp:后端智能合约</h1><p id="7f4c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们的拍卖DApp示例由两个智能合约支持，我们需要将它们部署在以太坊区块链上以支持应用程序:AuctionRepository和DeedRepository。</p><p id="d67c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们从DeedRepository开始，如<a class="ae ky" href="https://github.com/ac12644/auction_dapp/blob/main/backend/contracts/DeedRepository.sol" rel="noopener ugc nofollow" target="_blank"> DeedRepository.sol所示:一个用于拍卖的ERC721契约令牌</a>。此合约是ERC721兼容的不可替换令牌。</p><p id="16f1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例1。<code class="fe ng nh ni nj b">DeedRepository.sol</code>:用于拍卖的ERC721契约令牌</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="2641" class="np la it nj b gy nq nr l ns nt">link:code/auction_dapp/backend/contracts/DeedRepository.sol[]</span></pre><p id="58c2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，<code class="fe ng nh ni nj b">DeedRepository</code>契约是ERC721兼容令牌的直接实现。</p><p id="5b9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的拍卖DApp使用<code class="fe ng nh ni nj b">DeedRepository</code>合同来发布和跟踪每次拍卖的令牌。拍卖本身是由AuctionRepository契约编排的。此合同太长，无法在此完整介绍，但<code class="fe ng nh ni nj b"><a class="ae ky" href="https://github.com/ac12644/auction_dapp/blob/main/backend/contracts/AuctionRepository.sol" rel="noopener ugc nofollow" target="_blank">AuctionRepository.sol</a></code> <a class="ae ky" href="https://github.com/ac12644/auction_dapp/blob/main/backend/contracts/AuctionRepository.sol" rel="noopener ugc nofollow" target="_blank">:主拍卖DApp智能合同</a>显示了合同的主要定义和数据结构。</p><p id="6685" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例2。<code class="fe ng nh ni nj b"><a class="ae ky" href="https://github.com/ac12644/auction_dapp/blob/main/backend/contracts/AuctionRepository.sol" rel="noopener ugc nofollow" target="_blank">AuctionRepository.sol</a></code>:主拍卖DApp智能合约</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c0cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ng nh ni nj b"><a class="ae ky" href="https://github.com/ac12644/auction_dapp/blob/main/backend/contracts/AuctionRepository.sol" rel="noopener ugc nofollow" target="_blank">AuctionRepository</a></code>合同通过以下功能管理所有拍卖:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b56e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以使用该书的存储库中的Truffle将这些合同部署到您选择的以太坊区块链(例如Ropsten ):</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="bcee" class="np la it nj b gy nq nr l ns nt">$ cd code/auction_dapp/backend<br/>$ truffle init<br/>$ truffle compile<br/>$ truffle migrate --network ropsten</span></pre><h1 id="8506" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">DApp治理</h1><p id="d0f0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你通读了拍卖dApp的两个智能合同，你会注意到一些重要的事情:没有特殊的帐户或角色对dApp有特殊的特权。每个拍卖都有一个拥有一些特殊能力的所有者，但是拍卖dApp本身没有特权用户。</p><p id="1ed8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是一个深思熟虑的选择，目的是分散dApp的治理，并在部署后放弃任何控制。相比之下，一些dApp拥有一个或多个具有特殊能力的特权帐户，例如终止DApp合同、覆盖或更改其配置或“否决”某些操作的能力。通常，这些治理功能是在dApp中引入的，以避免由于bug而可能出现的未知问题。</p><p id="e65b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">治理问题是一个特别难以解决的问题，因为它是一把双刃剑。一方面，特权帐户是危险的；如果遭到破坏，他们可以破坏DApp的安全。另一方面，没有任何特权帐户，如果发现错误，就没有恢复选项。我们已经在以太坊DApps中看到了这两种风险。在道和以太坊的历史中，有一些被称为“管理者”的特权账户，但是他们的能力非常有限。这些帐户无法覆盖DAO攻击者的资金提取。在最近的一个案例中，分散式exchange Bancor经历了一次大规模盗窃，因为一个特权管理帐户遭到了破坏。事实证明，Bancor并不像最初设想的那样分散。</p><p id="9db9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在构建DApp时，您必须决定是否要让智能合约真正独立，启动它们，然后失去控制，或者创建特权帐户并承担被泄露的风险。这两种选择都有风险，但从长远来看，真正的DApps不能对特权账户进行专门访问——这不是分散的。</p><h1 id="d2f1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拍卖DApp:前端用户界面</h1><p id="6b08" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦DApp拍卖行的合同部署完毕，你就可以使用你最喜欢的JavaScript控制台和web3.js或者其他web3库与它们进行交互。然而，大多数用户将需要一个易于使用的界面。我们的拍卖DApp用户界面是使用Google的Vue2/Vuetify JavaScript框架构建的。</p><p id="21fc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以在<a class="ae ky" href="https://github.com/ac12644/auction_dapp/tree/main/frontend" rel="noopener ugc nofollow" target="_blank"> repo </a>的code/auction_dapp/frontend文件夹中找到用户界面代码。该目录具有以下结构和内容:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="4184" class="np la it nj b gy nq nr l ns nt">frontend/<br/>|-- build<br/>|   |-- build.js<br/>|   |-- check-versions.js<br/>|   |-- logo.png<br/>|   |-- utils.js<br/>|   |-- vue-loader.conf.js<br/>|   |-- webpack.base.conf.js<br/>|   |-- webpack.dev.conf.js<br/>|   `-- webpack.prod.conf.js<br/>|-- config<br/>|   |-- dev.env.js<br/>|   |-- index.js<br/>|   `-- prod.env.js<br/>|-- index.html<br/>|-- package.json<br/>|-- package-lock.json<br/>|-- README.md<br/>|-- src<br/>|   |-- App.vue<br/>|   |-- components<br/>|   |   |-- Auction.vue<br/>|   |   `-- Home.vue<br/>|   |-- config.js<br/>|   |-- contracts<br/>|   |   |-- AuctionRepository.json<br/>|   |   `-- DeedRepository.json<br/>|   |-- main.js<br/>|   |-- models<br/>|   |   |-- AuctionRepository.js<br/>|   |   |-- ChatRoom.js<br/>|   |   `-- DeedRepository.js<br/>|   `-- router<br/>|       `-- index.js</span></pre><p id="b440" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦您部署了契约，编辑<code class="fe ng nh ni nj b">frontend/src/config.js </code>中的前端配置，并输入<code class="fe ng nh ni nj b">DeedRepository</code>和AuctionRepository契约的地址，如部署的那样。前端应用程序还需要访问提供JSON-RPC和WebSockets接口的以太坊节点。配置好前端后，在本地机器上用web服务器启动它:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="d7eb" class="np la it nj b gy nq nr l ns nt">$ npm install<br/>$ npm run dev</span></pre><p id="5c67" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">拍卖dApp前端将启动，并可通过任何网络浏览器在<a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>访问。</p><p id="c253" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果一切顺利，您应该会看到拍卖DApp用户界面中显示的屏幕，它说明了拍卖dApp在网络浏览器中运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/5ebb4a715af71cba5250ae86880ecfb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8xa6WqFpC_t4k2if"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">前端</p></figure><h1 id="fb39" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">进一步下放拍卖DApp</h1><p id="3740" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们的dApp已经相当分散，但我们可以改善事情。</p><p id="ed53" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ng nh ni nj b">AuctionRepository</code>合同独立运作，不受任何监管，对任何人开放。一旦部署，就无法停止，也无法控制任何拍卖。每个拍卖会都有一个单独的聊天室，允许任何人在没有审查或识别的情况下交流拍卖情况。各种拍卖资产，如描述和相关图片，都存储在Swarm上，使得它们很难被审查或屏蔽。</p><p id="8fd4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">任何人都可以通过手动构建事务或在本地机器上运行Vue前端来与dApp交互。dApp代码本身是开源的，是在公共存储库上合作开发的。</p><p id="64ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以做两件事来让这个dApp变得分散和有弹性:</p><ul class=""><li id="3d5d" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">将所有应用程序代码存储在Swarm或IPFS上。</li><li id="bbcb" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">使用以太坊名称服务，通过引用名称来访问dApp。</li></ul><p id="33c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将在下一节探讨第一个选项，我们将深入研究以太坊名称服务(ENS)中的第二个选项。</p><h1 id="83e0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在Swarm上存储拍卖DApp</h1><p id="a13d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们在本章前面介绍了Swarm中的Swarm。我们的拍卖dApp已经使用Swarm来存储每次拍卖的图标图像。这是一个比试图在以太坊上存储数据更有效的解决方案，因为以太坊很贵。与将这些图像存储在web服务器或文件服务器等集中式服务中相比，这种方法也更具弹性。</p><p id="48d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是我们可以更进一步。我们可以将dApp本身的整个前端存储在Swarm中，并直接从Swarm节点运行它，而不是运行web服务器。</p><h2 id="bf06" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">准备蜂群</h2><p id="3bd6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要开始，您需要安装Swarm并初始化您的Swarm节点。Swarm是以太坊基金会Go-Ethereum工具套件的一部分。参考[ <code class="fe ng nh ni nj b">go_ethereum_geth</code> ]中安装Go-Ethereum的说明，或者按照<a class="ae ky" href="http://bit.ly/2Q75KXw" rel="noopener ugc nofollow" target="_blank"> Swarm文档</a>中的说明安装Swarm二进制版本。</p><p id="5523" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦安装了Swarm，您可以通过使用version命令运行它来检查它是否正常工作:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="5233" class="np la it nj b gy nq nr l ns nt">$ swarm version<br/>Version: 0.3<br/>Git Commit: 37685930d953bcbe023f9bc65b135a8d8b8f1488<br/>Go Version: go1.10.1<br/>OS: linux</span></pre><p id="fa97" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要开始运行Swarm，您必须告诉它如何连接到Geth的一个实例，以访问JSON-RPC API。按照<a class="ae ky" href="https://swarm-guide.readthedocs.io/en/latest/gettingstarted.html" rel="noopener ugc nofollow" target="_blank">入门指南</a>中的说明开始。</p><p id="c184" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当您开始Swarm时，您应该会看到类似这样内容:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="67cc" class="np la it nj b gy nq nr l ns nt">Maximum peer count                       ETH=25 LES=0 total=25<br/>Starting peer-to-peer node               instance=swarm/v0.3.1-225171a4/linux...<br/>connecting to ENS API                    url=http://127.0.0.1:8545<br/>swarm[5955]: [189B blob data]<br/>Starting P2P networking<br/>UDP listener up                          self=enode://f50c8e19ff841bcd5ce7d2d...<br/>Updated bzz local addr                   oaddr=9c40be8b83e648d50f40ad3... uaddr=e<br/>Starting Swarm service<br/>9c40be8b hive starting<br/>detected an existing store. trying to load peers<br/>hive 9c40be8b: peers loaded<br/>Swarm network started on bzz address: 9c40be8b83e648d50f40ad3d35f...<br/>Pss started<br/>Streamer started<br/>IPC endpoint opened                      url=/home/ubuntu/.ethereum/bzzd.ipc<br/>RLPx listener up                         self=enode://f50c8e19ff841bcd5ce7d2d...</span></pre><p id="56e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以通过连接本地的Swarm gateway web接口:<a class="ae ky" href="http://localhost:8500/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8500 </a>来确认你的Swarm节点是否运行正常。</p><p id="108f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您应该会看到一个类似于本地主机上Swarm gateway的屏幕，并且能够查询任何Swarm hash或ENS名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/068681c17ed0bb81e95b952ab3bb97ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ppOEl3FaooD0euoc.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本地主机上的群网关</p></figure><h2 id="b225" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">上传文件到Swarm</h2><p id="d9f1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦你运行了你的本地Swarm节点和网关，你就可以上传到Swarm，文件在任何Swarm节点上都是可访问的，只需要参考文件散列。</p><p id="52df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们通过上传一个文件来测试一下:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="ee3d" class="np la it nj b gy nq nr l ns nt">$ swarm up code/auction_dapp/README.md<br/>ec13042c83ffc2fb5cb0aa8c53f770d36c9b3b35d0468a0c0a77c97016bb8d7c</span></pre><p id="7099" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Swarm已经上传了<code class="fe ng nh ni nj b">README.md</code>文件并返回了一个散列，您可以使用它从任何Swarm节点访问该文件。例如，你可以使用<a class="ae ky" href="https://bit.ly/2znWUP9" rel="noopener ugc nofollow" target="_blank">公共群网关</a>。</p><p id="314e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然上传一个文件相对简单，但上传整个dApp前端要复杂一些。这是因为各种dApp资源(HTML、CSS、JavaScript、库等。)都嵌入了对彼此的引用。通常，web服务器将URL转换为本地文件，并提供正确的资源。我们可以通过打包我们的dApp为Swarm实现同样的目标。</p><p id="8c99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在拍卖dApp中，有一个打包所有资源的脚本:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="ade7" class="np la it nj b gy nq nr l ns nt">$ cd code/auction_dapp/frontend<br/>$ npm run build</span><span id="713b" class="np la it nj b gy oj nr l ns nt">&gt; frontend@1.0.0 build /home/aantonop/Dev/ethereumbook/code/auction_dapp/frontend<br/>&gt; node build/build.js</span><span id="35b4" class="np la it nj b gy oj nr l ns nt">Hash: 9ee134d8db3c44dd574d<br/>Version: webpack 3.10.0<br/>Time: 25665ms<br/>Asset     Size<br/>static/js/vendor.77913f316aaf102cec11.js  1.25 MB<br/>static/js/app.5396ead17892922422d4.js   502 kB<br/>static/js/manifest.87447dd4f5e60a5f9652.js  1.54 kB<br/>static/css/app.0e50d6a1d2b1ed4daa03d306ced779cc.css  1.13 kB<br/>static/css/app.0e50d6a1d2b1ed4daa03d306ced779cc.css.map  2.54 kB<br/>static/js/vendor.77913f316aaf102cec11.js.map  4.74 MB<br/>static/js/app.5396ead17892922422d4.js.map   893 kB<br/>static/js/manifest.87447dd4f5e60a5f9652.js.map  7.86 kB<br/>index.html  1.15 kB</span><span id="bfd9" class="np la it nj b gy oj nr l ns nt">Build complete.</span></pre><p id="9e28" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个命令的结果将是一个新的目录，<code class="fe ng nh ni nj b">code/auction_dapp/frontend/dist</code>，它包含了整个拍卖DApp前端，打包在一起:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="6a5d" class="np la it nj b gy nq nr l ns nt">dist/<br/>|-- index.html<br/>`-- static<br/>    |-- css<br/>    |   |-- app.0e50d6a1d2b1ed4daa03d306ced779cc.css<br/>    |   `-- app.0e50d6a1d2b1ed4daa03d306ced779cc.css.map<br/>    `-- js<br/>        |-- app.5396ead17892922422d4.js<br/>        |-- app.5396ead17892922422d4.js.map<br/>        |-- manifest.87447dd4f5e60a5f9652.js<br/>        |-- manifest.87447dd4f5e60a5f9652.js.map<br/>        |-- vendor.77913f316aaf102cec11.js<br/>        `-- vendor.77913f316aaf102cec11.js.map</span></pre><p id="180a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，您可以使用up命令和——recursive选项将整个dApp上传到Swarm。这里，我们还告诉Swarm，index.html是加载这个dApp的默认路径:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="b74d" class="np la it nj b gy nq nr l ns nt">$ swarm --bzzapi <a class="ae ky" href="http://localhost:8500" rel="noopener ugc nofollow" target="_blank">http://localhost:8500</a> --recursive \<br/>  --defaultpath dist/index.html up dist/</span><span id="c6f2" class="np la it nj b gy oj nr l ns nt">ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581</span></pre><p id="fbfa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们的整个拍卖dApp托管在Swarm上，可以通过Swarm URL访问:</p><ul class=""><li id="7215" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><em class="ok">bzz://ab 164 cf 37 DC 10647 e43 a 233486 CD effa 8334 b 026 e 32 a 480 DD 9 CBD 020 c12d 4581</em></li></ul><p id="69d4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们在DApp去中心化方面取得了一些进展，但我们使它更难使用。像这样的网址比像<code class="fe ng nh ni nj b">auction_dapp.com</code>这样好听的名字更不友好。为了获得去中心化，我们被迫牺牲可用性吗？不一定。</p><p id="7815" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下一节中，我们将研究以太坊的名称服务，它允许我们使用易于阅读的名称，但仍然保留了我们的应用程序的分散性质。</p><h1 id="ad0d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">以太坊名称服务(ENS)</h1><p id="73e7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以设计出世界上最好的智能合约，但是如果你不给用户提供一个好的界面，他们就无法访问它。</p><p id="68c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在传统互联网上，域名系统(DNS)允许我们在浏览器中使用人类可读的名称，同时在后台将这些名称解析为IP地址或其他标识符。在以太坊区块链上，<em class="ok">以太坊命名系统</em> (ENS)解决了同样的问题，但是以一种分散的方式。</p><p id="9f72" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">比如以太坊基金会捐款地址是<code class="fe ng nh ni nj b">0xfB6916095ca1df60bB79Ce92cE3Ea74c37c5d359;</code>在一个支持ENS的钱包里，简单来说就是<code class="fe ng nh ni nj b">ethereum.eth</code>。</p><p id="8b4d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ENS不仅仅是一个智能合约；它本身是一个基本的dApp，提供一个分散的名称服务。此外，ENS还得到许多dApps的支持，用于注册、管理和拍卖注册域名。ENS演示了dApp如何协同工作:它是为其他dApp服务而构建的dApp，由dApp的生态系统支持，嵌入在其他dApp中，等等。</p><p id="b33d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本节中，我们将了解ENS是如何工作的。我们将演示如何设置自己的名称并将其链接到钱包或以太坊地址，如何将ENS嵌入另一个dApp，以及如何使用ENS命名dApp资源以使其更易于使用。</p><h2 id="2757" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">ENS规范</h2><p id="1774" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">ENS主要在三个以太坊改进提案中规定:EIP-137，规定了ENS的基本功能；EIP-162，它描述了拍卖系统。eth根；以及EIP-181，它规定了地址的反向解析。</p><p id="858a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ENS遵循“三明治”设计理念:底层是非常简单的一层，下面是更复杂但可替换的代码层，顶层非常简单，将所有资金保存在单独的账户中。</p><h2 id="9f08" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">底层:名称所有者和解析者</h2><p id="c1c1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">ENS对“节点”而不是人类可读的名称进行操作:使用“Namehash”算法将人类可读的名称转换为节点。</p><p id="6300" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ENS的基础层是ERC137定义的一个巧妙的简单契约(不到50行代码)，它只允许节点的所有者设置关于它们的名称的信息，并创建子节点(相当于DNS子域的ENS)。</p><p id="d7d4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基础层上仅有的功能是使节点所有者能够设置关于他们自己的节点的信息(特别是解析器、生存时间或转移所有权)以及创建新子节点的所有者。</p><p id="79f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Namehash算法是一种递归算法，可以将任何名称转换为标识该名称的哈希。</p><p id="04bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">“递归”是指我们通过解决一个子问题来解决问题，这个子问题是同类型的一个更小的问题，然后用子问题的解来解决原问题。</p><p id="a1ca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Namehash递归地散列名称的组成部分，为任何有效的输入域产生唯一的固定长度的字符串(或“节点”)。比如subdomain.example.eth的Namehash节点是<code class="fe ng nh ni nj b">keccak('&lt;example.eth&gt;' node) + keccak('&lt;subdomain&gt;')</code>。我们必须解决的子问题是计算节点例如. eth，也就是<code class="fe ng nh ni nj b">keccak('&lt;.eth&gt;' node) + keccak('&lt;example&gt;')</code>。首先，我们必须计算eth的节点，即<code class="fe ng nh ni nj b">keccak(&lt;root node&gt;) + keccak('&lt;eth&gt;')</code>。</p><p id="ed6a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">根节点就是我们所说的我们递归的“基格”，显然不能递归定义，否则算法永远不会终止！根节点定义为<code class="fe ng nh ni nj b">0x0000000000000000000000000000000000000000000000000000000000000000</code> (32个零字节)。</p><p id="279b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">综上所述，subdomain.example.eth的节点就是<code class="fe ng nh ni nj b">keccak(keccak(keccak(0x0...0 + keccak('eth')) + keccak('example')) + keccak('subdomain'))</code>。</p><p id="554b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">概括地说，我们可以将Namehash函数定义如下(根节点或空名称的基本情况，随后是递归步骤):</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="93f3" class="np la it nj b gy nq nr l ns nt">namehash([]) = 0x0000000000000000000000000000000000000000000000000000000000000000<br/>namehash([label, ...]) = keccak256(namehash(...) + keccak256(label))</span></pre><p id="3c9a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在Python中，这变成了:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="f995" class="np la it nj b gy nq nr l ns nt">def namehash(name):<br/>  if name == '':<br/>    return '\0' * 32<br/>  else:<br/>    label, _, remainder = name.partition('.')<br/>    return sha3(namehash(remainder) + sha3(label))</span></pre><p id="990c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，<code class="fe ng nh ni nj b">mastering-ethereum.eth</code>将被处理如下:</p><pre class="kj kk kl km gt nl nj nm nn aw no bi"><span id="df97" class="np la it nj b gy nq nr l ns nt">namehash('mastering-ethereum.eth')<br/>⇒ sha3(namehash('eth') + sha3('mastering-ethereum'))<br/>⇒ sha3(sha3(namehash('') + sha3('eth')) + sha3('mastering-ethereum'))<br/>⇒ sha3(sha3(('\0' * 32) + sha3('eth')) + sha3('mastering-ethereum'))</span></pre><p id="d663" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当然，子域本身也可以有子域:在<code class="fe ng nh ni nj b">subdomain.example.eth</code>之后可以有一个<code class="fe ng nh ni nj b">sub.subdomain.example.eth</code>，然后是一个<code class="fe ng nh ni nj b">sub.sub.subdomain.example.eth</code>，依此类推。为了避免昂贵的重新计算，因为Namehash只依赖于名称本身，所以给定名称的节点可以预先计算并插入到契约中，从而消除了对字符串操作的需要，并允许立即查找ENS记录，而不管原始名称中有多少个组件。</p><p id="ed4a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">如何选择一个有效的名字？<br/> </strong>名称由一系列用点分隔的标签组成。尽管允许使用大写和小写字母，但所有标签都应遵循UTS #46标准化流程，即在散列标签之前对标签进行大小写折叠，因此大小写不同但拼写相同的名称最终将具有相同的Namehash。</p><p id="ee51" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以使用任意长度的标签和域，但是为了与传统DNS兼容，建议使用以下规则:</p><ul class=""><li id="7c95" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">每个标签不应超过64个字符。</li><li id="606d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">完整的ENS名称不应超过255个字符。</li><li id="ce11" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">标签不应以连字符开头或结尾，也不应以数字开头。</li></ul><p id="4e5d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">根节点所有权</strong></p><p id="6381" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这种分级系统的结果之一是，它依赖于根节点的所有者，这些所有者能够创建顶级域(TLD)。</p><p id="bb23" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然最终目标是为新TLD采用分散决策流程，但在编写本报告时，根节点由不同国家/地区的人持有的4/7 multi SIG控制(作为DNS系统7个密钥持有者的反映)。因此，任何更改都需要7个密钥持有者中至少4个的多数才能生效。</p><p id="3f4d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前，这些密钥持有者的目的和目标是与机构群体达成共识，以:</p><ul class=""><li id="76ce" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">迁移和升级的临时所有权。一旦该系统被评估，eth TLD将签订一份更长期的合同。</li><li id="11f4" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">如果机构群体认为有必要，允许添加新的TLD。</li><li id="8218" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">当这样的系统被同意、测试和实现时，将根multisig的所有权转移到更分散的契约。</li><li id="f590" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">作为处理顶级注册管理机构中任何缺陷或漏洞的最后手段。</li></ul><p id="9e9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">解析器<br/> </strong>基本ENS契约不能给名称添加元数据；这就是所谓的“解决合同”的工作这些是用户创建的合同，可以回答关于名称的问题，例如什么群地址与应用程序相关联，什么地址接收对应用程序的支付(以以太或令牌的形式)，或者应用程序的哈希是什么(以验证其完整性)。</p><h2 id="a103" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">中间层:即。以太网节点</h2><p id="b3c3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在撰写本文时，智能合同中唯一可注册的顶级域名是. eth。</p><blockquote class="ol om on"><p id="b5d1" class="lr ls ok lt b lu mn ju lw lx mo jx lz oo mp mc md op mq mg mh oq mr mk ml mm im bi translated">注意:让传统的DNS域名所有者能够要求ENS所有权的工作正在进行中。虽然理论上这是可行的。到目前为止，唯一实现这个的域是<a class="ae ky" href="http://bit.ly/2SwUuFC" rel="noopener ugc nofollow" target="_blank">。xyz，而且只在Ropsten testnet </a>上。</p></blockquote><p id="d18e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">。eth域名通过拍卖系统进行分配。没有预约名单和优先顺序，获得名字的唯一方法是使用系统。拍卖系统是一段复杂的代码(超过500行)；大部分早期的开发工作(还有bug！)都在系统的这一部分。然而，它也是可替换和可升级的，没有资金风险——稍后将详细介绍。</p><p id="e677" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">维克瑞拍卖公司</strong></p><p id="2e34" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">名字是通过改良的维克瑞拍卖来分配的。在传统的维克瑞拍卖中，每个竞标者都提交一份密封的出价，所有的出价都会同时显示出来，最高出价者赢得拍卖，但只需支付第二高的出价。因此，投标人被鼓励不要出价低于该名称对他们的真实价值，因为出价他们的真实价值增加了他们获胜的机会，但不影响他们最终将支付的价格。</p><p id="3c54" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">在区块链上，需要进行一些更改:</strong></p><ul class=""><li id="d504" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">为了确保投标人不会提交他们不打算支付的投标，他们必须事先锁定等于或高于其投标的价值，以保证投标有效。</li><li id="bd7e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">因为你不能在区块链上隐藏秘密，竞拍者必须执行至少两次交易(提交-展示过程)，以便隐藏他们出价的原始价值和名称。</li><li id="66ab" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">由于你不能在一个分散的系统中同时显示所有的出价，投标人必须自己显示他们自己的出价；如果他们不这样做，他们就会没收锁定资金。如果没有这种弃权，人们可以进行多次出价，并选择只披露一两次，从而将密封投标拍卖变成传统的加价拍卖。</li></ul><p id="658f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">因此，拍卖分为四个步骤:</strong></p><ol class=""><li id="e00e" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm or my mz na bi translated">开始拍卖。这是广播注册名称的意图所必需的。这创造了所有拍卖的截止日期。这些名字被散列，以便只有那些在他们的字典中有这个名字的人才能知道哪个拍卖被打开。这允许一些隐私，如果您正在创建一个新项目并且不想共享它的细节，这是很有用的。您可以同时开启多个虚拟拍卖，因此如果有人跟踪您，他们无法对您开启的所有拍卖出价。</li><li id="6015" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm or my mz na bi translated">进行密封投标。你必须在投标截止日期前完成这项工作，方法是将一定量的乙醚与一条秘密消息的散列值(包含名称散列值、实际投标金额和一个盐)捆绑在一起。你可以锁定比你实际出价更多的乙醚，以掩盖你的真实估价。</li><li id="9303" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm or my mz na bi translated">透露出价。在展示期间，您必须进行一项交易来展示出价，然后该交易将计算最高出价和第二高出价，并将ether发送回未成功的投标人。每次公布出价时，都要重新计算当前的赢家；因此，最后一个在揭示截止日期到期前设置的成为总赢家。</li><li id="d584" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm or my mz na bi translated">之后清理干净。如果你是赢家，你可以完成拍卖，以取回你的出价和第二高的出价之间的差额。如果你忘了透露，你可以晚透露，恢复你的出价。</li></ol><h2 id="773a" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">顶层:契约</h2><p id="1d00" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">ENS的顶层是另一个超级简单的合同，只有一个目的:持有资金。</p><p id="3d4b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当你赢得一个域名时，这些资金实际上不会被送到任何地方，而只是在你希望持有该域名的一段时间内被锁定(至少一年)。这就像一个有保证的回购:如果所有者不再想要这个名字，他们可以把它卖回给系统，并收回他们的以太(所以持有这个名字的成本是做一些回报大于零的事情的机会成本)。</p><p id="4c38" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当然，事实证明，让一份合同持有数百万美元的资产是非常危险的，因此ENS为每个新名字创建了一份契约。契约契约非常简单(大约50行代码)，它只允许将资金转移回单个帐户(契约所有者)并由单个实体调用(注册商契约)。这种方法极大地减少了漏洞可能给资金带来风险的攻击面。</p><h2 id="c6e4" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">注册一个名字</h2><p id="a907" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在ENS中注册一个名字需要四个步骤，正如我们在Vickrey auctions中看到的那样。首先，我们对任何可用的名称出价，然后我们在48小时后公布我们的出价以保护该名称。ENS注册时间表是显示注册时间表的图表。</p><p id="21e5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们注册我们的名字！</p><p id="4ec5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将使用几个可用的用户友好界面中的一个来搜索可用的名称，对名称ethereumbook.eth出价，显示出价，并保护该名称。</p><p id="3757" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ENS有许多基于网络的界面，允许我们与ENS DApp进行交互。对于这个例子，我们将使用<a class="ae ky" href="https://mycrypto.com/" rel="noopener ugc nofollow" target="_blank"> MyCrypto接口</a>，结合元掩码作为我们的钱包。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/db325ead61936d85062bbd1eda39676a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qpTPASocyIbe2txS.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ENS注册时间表</p></figure><p id="577d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们需要确保我们想要的名称可用。在写这本书的时候，我们真的很想注册这个名字<code class="fe ng nh ni nj b">mastering.eth</code>，但是唉，在MyCrypto.com上搜索ENS的名字发现它已经被占用了！因为ENS注册仅持续一年，所以将来有可能保护该名称。与此同时，我们来搜索一下<code class="fe ng nh ni nj b">ethereumbook.eth</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/7fb179fc60a28d8d7ed3c6a9acc84806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*px29X20-Q7deKM0L.png"/></div></div></figure><p id="1cd7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">图6。在MyCrypto.com搜索ENS名称</p><p id="0d2e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">太好了！该名称可用。为了注册它，我们需要开始拍卖一个ENS名称。让我们解开元面具，开始拍卖<code class="fe ng nh ni nj b">ethereumbook.eth</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/1151c322f0365ecd91b828e4b4abcad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BnKHY41K9MOJnwoK.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">开始拍卖一个ENS名称</p></figure><p id="81de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们出价吧。为了做到这一点，我们需要遵循投标ENS名称的步骤。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/4498278e21486a21aff69770da8240c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*muUDacNXgfJkKxzs.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对ENS名称进行投标</p></figure><p id="8091" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">警告<br/> </strong>正如维克瑞拍卖所提到的，你必须在拍卖结束后的48小时内公开你的出价，否则你<em class="ok">将失去你出价的资金</em>。我们是不是忘了这么做，自己损失了0.01 ETH？你打赌我们做到了。</p><p id="5bfd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">截屏，保存您的秘密短语(作为您出价的备份)，并在您的日历中添加揭示日期和时间的提醒，这样您就不会忘记和丢失您的资金。</p><p id="f6ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们通过单击包含您的出价的MetaMask交易中显示的绿色大提交按钮来确认交易。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/b85cf95a16c750cff8b5992b328fc14f.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/0*UMvIIyCKwIp3Tskl.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含您的出价的元掩码交易</p></figure><p id="2c12" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果一切顺利，以这种方式提交交易后，您可以在48小时内返回并显示出价，您请求的名称将被注册到您的以太坊地址。</p><h2 id="b534" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">管理您的ENS名称</h2><p id="3a92" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦您注册了一个ENS名称，您就可以使用另一个用户友好的界面来管理它:<a class="ae ky" href="https://manager.ens.domains/" rel="noopener ugc nofollow" target="_blank"> ENS Manager </a>。</p><p id="8c92" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">进入后，在搜索框中输入要管理的名称(参见ENS管理器web界面)。您需要解锁您的以太坊钱包(例如元掩码)，以便ENS经理DApp可以代表您管理名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/fe4881f75ca8d5f7795e51c05b538e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EgUzgovNQeRqR5fQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ENS管理器网络界面</p></figure><p id="208d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从这个接口，我们可以创建子域，设置解析器契约(稍后将详细介绍)，并将每个域名连接到适当的资源，例如DApp前端的群地址。</p><p id="3f76" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">创建ENS子域</strong></p><p id="ac1f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，让我们为示例拍卖DApp创建一个子域(参见添加子域<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>)。我们将子域命名为auction，因此完全限定名将是<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/3999a533dd31a4422c8a52f462f22c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7Boq3ysna58KxJcS.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加子域auction.ethereumbook.eth</p></figure><p id="3b96" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们创建了子域，我们可以在搜索框中输入<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>并管理它，就像我们之前管理域<code class="fe ng nh ni nj b">ethereumbook.eth</code>一样。</p><h2 id="f02d" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">ENS解析器</h2><p id="ae0a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在ENS中，解析名称是一个两步过程:</p><ol class=""><li id="b034" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm or my mz na bi translated">ENS注册表在散列后用名称来解析。如果记录存在，注册中心将返回其解析器的地址。</li><li id="02c2" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm or my mz na bi translated">使用适合于所请求资源的方法调用解析程序。解析器返回所需的结果。</li></ol><p id="83b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个两步过程有几个好处。将解析器的功能从命名系统中分离出来给了我们更多的灵活性。名称的所有者可以使用自定义解析器来解析任何类型或资源，扩展了ENS的功能。例如，如果将来您想要将地理位置资源(经度/纬度)链接到ENS名称，您可以创建一个新的解析器来回答一个<code class="fe ng nh ni nj b">geolocation</code>查询。谁知道将来什么样的应用会有用呢？使用自定义解析器，唯一的限制是您的想象力。</p><p id="4c46" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了方便起见，有一个默认的公共解析器，可以解析各种资源，包括地址(用于钱包或合同)和内容(用于dApp或合同源代码的群哈希)。</p><p id="63bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于我们想要将我们的拍卖dApp链接到一个Swarm hash，我们可以使用公共解析器，它支持内容解析，如设置<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>的默认公共解析器所示；我们不需要编码或部署定制的解析器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/96c94450e1c81313469caceb3a2267bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tfB5sHyS9kT1BDO1.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为auction.ethereumbook.eth设置默认公共解析程序</p></figure><h2 id="cd1b" class="np la it bd lb nx ny dn lf nz oa dp lj ma ob oc ll me od oe ln mi of og lp oh bi translated">将名称解析为群组散列(内容)</h2><p id="22fb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>的解析器被设置为公共解析器，我们可以将其设置为返回Swarm hash作为我们名字的内容(参见设置<code class="fe ng nh ni nj b">auction.ethereumbook.eth</code>返回的“内容”)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/0e9127a9c5f73ee087341e7c9f3d0ef9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UNUMpln9kHo2w0kL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将“内容”设置为return for auction . ethereumbook . eth</p></figure><p id="147d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在等待我们的交易被确认后，我们应该能够正确地解析名称。在设置名称之前，我们的拍卖dApp可以通过其散列在群网关上找到:</p><ul class=""><li id="2505" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="https://swarm-gateways.net/bzz:/ab164cf37dc10647e43a233486cdeffa8334b026e32a480dd9cbd020c12d4581" rel="noopener ugc nofollow" target="_blank"><em class="ok">https://swarm gateways . net/bzz:/ab 164 cf 37 DC 10647 e 43 a 233486 CD effa 8334 b 026 e 32 a 480 DD 9 CBD 020 c12d 4581</em>T3】</a></li></ul><p id="6184" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者通过在DApp浏览器或群网关中搜索群URL:</p><ul class=""><li id="1972" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><em class="ok">bzz://ab 164 cf 37 DC 10647 e43 a 233486 CD effa 8334 b 026 e 32 a 480 DD 9 CBD 020 c12d 4581</em></li></ul><p id="c0df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们已经将它附加到一个名称上，这就简单多了:</p><ul class=""><li id="f18f" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="http://swarm-gateways.net/bzz:/auction.ethereumbook.eth/" rel="noopener ugc nofollow" target="_blank"><em class="ok">http://swarm-gateways.net/bzz:/auction.ethereumbook.eth/</em></a></li></ul><p id="5baf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们也可以在任何一个与ENS兼容的钱包或DApp浏览器(如Mist)中搜索“auction.ethereumbook.eth”来找到它。</p><h1 id="9167" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">从App到DApp</h1><p id="a8b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在过去的几节中，我们已经逐步构建了一个分散的应用程序。我们从一对智能合同开始，为ERC721契约进行拍卖。这些合同被设计成没有管理或特权账户，因此它们的操作是真正分散的。我们添加了一个用JavaScript实现的前端，为我们的dApp提供了一个方便且用户友好的界面。拍卖dApp使用分散式存储系统Swarm来存储图像等应用资源。dApp还使用分散式通信协议Whisper为每次拍卖提供加密聊天室，无需任何中央服务器。</p><p id="0ea7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将整个前端上传到Swarm，因此我们的dApp不依赖任何web服务器来提供文件。最后，我们使用ENS为我们的dApp分配了一个名称，将它连接到前端的Swarm hash，这样用户就可以用一个简单易记的人类可读名称来访问它。</p><p id="c09d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每走一步，我们都增加了应用程序的分散性。最终的结果是一个dApp，它没有权威的中心点，没有失败的中心点，并且表达了“web3”的愿景。</p><p id="0bbb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">拍卖dApp架构显示了拍卖dApp的完整架构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/0e2399b7ff244c2cae9bdd14f1a8a889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XhzLxco9K3NzFiJB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拍卖DApp建筑</p></figure><h1 id="df05" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="5a86" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如创始人在最早的设计中所表达的，分散式应用是以太坊愿景的顶点。虽然今天很多应用程序自称为“dApps ”,但大多数并没有完全去中心化。</p><p id="7da8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，构建几乎完全去中心化的应用程序已经成为可能。</p><p id="6b2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">随着时间的推移，随着技术的进一步成熟，我们越来越多的应用程序可以去中心化，从而产生一个更有弹性、抗审查和自由的网络。</p></div></div>    
</body>
</html>