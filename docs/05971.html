<html>
<head>
<title>What Makes Ruby Beautiful: Metaprogramming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">是什么让Ruby如此美丽:元编程</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-makes-ruby-beautiful-metaprogramming-8d3bf3e046fb?source=collection_archive---------9-----------------------#2020-08-21">https://betterprogramming.pub/what-makes-ruby-beautiful-metaprogramming-8d3bf3e046fb?source=collection_archive---------9-----------------------#2020-08-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3932" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Ruby的respond_to方法的魔力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/98a1d6bff2781edcd2f6470f92983199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhMEqJ5c67ok42SWHGOjog.png"/></div></div></figure><p id="5d0a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">随着Ruby on Rails框架的出现而流行起来的Ruby，是现代开发者中最被低估的编程语言之一。</p><blockquote class="lq"><p id="2e38" class="lr ls it bd lt lu lv lw lx ly lz lp dk translated">Ruby让开发人员快乐、高效并享受编程。—松本幸宏</p></blockquote><p id="d524" class="pw-post-body-paragraph ku kv it kw b kx mb ju kz la mc jx lc ld md lf lg lh me lj lk ll mf ln lo lp im bi translated">也许你来自有很多框架的JavaScript世界，或者来自Java及其所有的复杂性。</p><p id="0467" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你已经受够了浪费时间<em class="mg">构建重要的软件</em>并且你想要<em class="mg">尽快得到具体的结果</em>，让我向你介绍Ruby。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="fca6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我将向您介绍元编程的概念。</p><p id="2c5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我第一次学习Ruby，<strong class="kw iu">当我面对这个的时候，我的头脑被炸了</strong>:<em class="mg">想象一下，一个程序可以自己生成代码，不需要开发者的帮助。这不是科幻小说，而是Ruby元编程！</em></p><p id="d4b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我必须向一个5岁的孩子解释，我会说，想象你想画一个阳光灿烂的城市。你拿起笔在纸上写下“阳光之城”，按下按钮，画面就出现了。这就是元编程。</p><p id="7db4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我给开发者解释一下。在Ruby中，可以对方法进行运行时自省。另一方面，你可以询问一个对象的能力(<em class="mg">你有这个方法吗？</em>)，它的变量、常数，以及它的类和祖先。</p><p id="38a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我将向您展示一些使用类似<code class="fe mo mp mq mr b">respond_to?</code> ( <em class="mg">)的方法的示例。</em>是返回布尔值的方法的Ruby约定)<code class="fe mo mp mq mr b">send</code>和<code class="fe mo mp mq mr b">define_method</code>。但是还有很多像<code class="fe mo mp mq mr b">method_missing</code>、<code class="fe mo mp mq mr b">remove_method</code>和<code class="fe mo mp mq mr b">undef_method</code>这样的。</p><p id="430e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将解释这三种方法，最后给你看一些令人兴奋的例子。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="68e6" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">对...的回应？()方法</h1><p id="91db" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">此方法测试您的类是否可以处理特定的消息。对于那些不会说Ruby的人:它检查一个方法是否可以在一个特定的类中被调用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/9c7154d989799105e704f0160053d8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oU6LKjeKozgrshw5Se_AaA.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">在Ruby词汇表中，消息被称为方法</p></figure><p id="9bd1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有一个<code class="fe mo mp mq mr b">Shipment</code>类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f7b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe mo mp mq mr b">respond_to?</code>方法检查<code class="fe mo mp mq mr b">prepare_for_delivery</code>方法是否存在:</p><pre class="kj kk kl km gt nw mr nx ny aw nz bi"><span id="b84b" class="oa mt it mr b gy ob oc l od oe">s = Shipment.new <br/>s.respond_to?(:prepare_for_delivery) </span><span id="6edd" class="oa mt it mr b gy of oc l od oe">==&gt; true</span></pre><p id="d032" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一个更完整的向另一个对象发送消息的示例(如果存在的话):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="3784" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它可用于任何类别:</p><pre class="kj kk kl km gt nw mr nx ny aw nz bi"><span id="ba01" class="oa mt it mr b gy ob oc l od oe">'hello'.respond_to?(:count)<br/>==&gt; true</span><span id="f274" class="oa mt it mr b gy of oc l od oe">'world'.respond_to?(:include)<br/>==&gt; false</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="1c22" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">send()方法</h1><p id="a2ef" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">您可以用<code class="fe mo mp mq mr b">send()</code>方法调用类中的任何方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/be609d53f1c1b4b3a8244940af7e2cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*erYpwJi2aGRzy_w0pfdsdQ.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">消息在send()的第一个参数中发送</p></figure><p id="6672" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">“为什么不能直接调用我们的方法？”我听到你哭泣。</p><p id="204d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你说得对，我们可以这样做，我知道这不是我们如何使用它的真实例子。我们继续。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="2f49" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">方法的定义方法</h1><p id="82b3" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">现在你知道了逻辑，你甚至可以在我解释之前找到这个方法的行为。</p><p id="a667" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它定义了一个方法？<em class="mg">干得好！</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9cfc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您刚刚为<code class="fe mo mp mq mr b">Shipment</code>类定义了一个新方法，将实例变量<code class="fe mo mp mq mr b">cancelled</code>设置为<code class="fe mo mp mq mr b">true</code>，并打印<code class="fe mo mp mq mr b">reason</code> <strong class="kw iu">。</strong></p><p id="f327" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们看看最后一个例子，它会让你大吃一惊！</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="fd2c" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">在一个例子中，元编程</h1><p id="02a5" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">您已经了解了Ruby元编程的基础，让我们来看看最后一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="0022" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里我们已经使用了我解释过的所有方法。对于每个<code class="fe mo mp mq mr b">Container</code>类，我们定义了新的方法，这些方法根据它们的产品名调用一个方法(如果存在的话),一个扫描器。</p><p id="ef64" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">输出:</p><pre class="kj kk kl km gt nw mr nx ny aw nz bi"><span id="6def" class="oa mt it mr b gy ob oc l od oe">Scanning apples...<br/>Scanning potatoes...</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="4690" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，您知道了什么是元编程以及它是如何工作的。干得好！</p><p id="72f9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">元编程的第一个用例是创建自己的DSL(领域特定语言)。</p><p id="2864" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有一些著名的基于Ruby DSL的工具——devo PS人民用的<a class="ae og" href="https://www.chef.io/" rel="noopener ugc nofollow" target="_blank"> Chef </a>和<a class="ae og" href="https://puppet.com/" rel="noopener ugc nofollow" target="_blank">木偶</a>。</p><p id="93e7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是红宝石的美丽之处。</p></div></div>    
</body>
</html>