<html>
<head>
<title>Vite vs. Webpack — Under the Hood</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vite与web pack——在引擎盖下</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/vite-vs-webpack-3286e188aaae?source=collection_archive---------2-----------------------#2022-09-07">https://betterprogramming.pub/vite-vs-webpack-3286e188aaae?source=collection_archive---------2-----------------------#2022-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1fcc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">帮助您降低编译时间的深入指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e56c78945b400956a9ffeffa2f12b615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PEgRh_SAYFaioVOU"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿诺德·弗朗西斯卡</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="3302" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的编译时间有多长？你能狂饮《星球大战》三部曲直到它结束吗——我正看着你呢，网络包？还是毫秒内完成？遇见:<a class="ae kv" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> Vite </a>。</p><h1 id="bdca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">我们为什么要编译？</h1><p id="6c87" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">网站可以很简单。HTML、CSS和Javascript是您启动和运行所需的全部工具，但是一旦您开始构建真正的应用程序和企业应用程序，还需要其他工具。</p><p id="6f86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">后端的React、Vue或Angular之类的工具，作为CSS处理器的SASS，可能是TypeScript而不是普通的JavaScript。这些是现代开发团队最常用的工具。</p><p id="1076" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">问题是…浏览器不知道React、SASS或Typescript是什么。它不关心任何不是HTML、CSS和JavaScript的东西。</p><blockquote class="mp mq mr"><p id="9d17" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">编译器翻译你的React，SASS，Typescript等等。JS、CSS和Html，这样你的浏览器就可以使用这些代码。</p></blockquote><h1 id="63af" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">我们如何编译？</h1><p id="438e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">编译器使用捆绑器将多个JavaScript文件合并成一个可以在浏览器中运行的文件。这个包将包含运行应用程序所需的全部源代码和所有导入的依赖项。</p><p id="c389" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使用你的花哨SASS，我们需要加载器将其直接翻译成CSS。</p><p id="b8ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Webpack、Rollup和Vite等工具使这些事情成为可能。</p><h1 id="fcf3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Vite是什么？</h1><p id="069f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://vitejs.dev/guide/" rel="noopener ugc nofollow" target="_blank"> Vite </a>(这是法语，意思是“快”)，是由<a class="ae kv" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue </a>的创建者和维护者尤雨溪创建的，它提供了一个完整的框架不可知捆绑器，编译速度提高了10到100倍，内置了近乎实时的热重新加载功能，给开发者带来了惊人的体验。</p><p id="2ca5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是通过利用浏览器本地ESM支持实现的，类似于<a class="ae kv" href="https://www.snowpack.dev/" rel="noopener ugc nofollow" target="_blank"> snowpack </a>和<code class="fe mw mx my mz b"><a class="ae kv" href="https://github.com/preactjs/wmr" rel="noopener ugc nofollow" target="_blank">preact/wmr</a></code>。您的应用程序模块将被分为依赖项和源代码。</p><ul class=""><li id="26bd" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated">依赖关系不经常变化，所以和<a class="ae kv" href="https://github.com/evanw/esbuild" rel="noopener ugc nofollow" target="_blank">https://github.com/evanw/esbuild</a>(一个用Go写的JavaScript bundler)预捆绑；除非依赖关系发生变化，否则这种情况只会发生一次</li><li id="0465" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">在您使用源代码时，源代码会发生多次变化，它将被转换为浏览器本机ESM (Ecma-Script-Modules ),其中浏览器只加载当前页面所需的文件</li></ul><h1 id="ff0a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">引擎盖下的网络包</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/bb1d4a9e6365d5741cab62a103a1bf36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k-tVKBekIq9v2ync"/></div></div></figure><p id="4007" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为Webpack是一个基于bundler的构建工具，它必须抓取、处理和连接整个JavaScript文件来交付您的应用程序。这适用于您的应用程序代码和您的依赖项。</p><p id="af5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您保存文件时，整个JavaScript包将由Webpack重新构建，这就是为什么即使打开了HMR，更改也可能需要10秒钟才能显示在浏览器中。由于Webpack的延迟反馈循环，处理大量JavaScript应用程序将导致糟糕的开发人员体验。</p><h1 id="6851" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">请到车下</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/bca2d4071189db5410e0c835e46c44cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uX1j5XggsC6WQVTokTv3Cw.png"/></div></div></figure><p id="7138" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像Webpack这样的基于bundler的工作流必须在单个浏览器请求之前处理整个JavaScript模块，而Vite只在单个浏览器请求之前处理依赖模块。</p><h1 id="53ed" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Vite的捆绑产品版本</h1><p id="8bce" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">虽然现在所有主流浏览器都支持原生ES模块，但是提供实现性能优化技术(如树抖动、延迟加载和公共块分割)的捆绑应用仍然比非捆绑应用具有更好的整体性能。</p><p id="64c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于这个原因，Vite附带了一个预配置的<code class="fe mw mx my mz b">build</code>命令，该命令使用<a class="ae kv" href="http://rollupjs.org/" rel="noopener ugc nofollow" target="_blank"> Rollup </a>捆绑您的应用程序。Vite还为您提供了一个合理的默认汇总配置<a class="ae kv" href="https://vitejs.dev/guide/build.html#customizing-the-build" rel="noopener ugc nofollow" target="_blank">，您可以在需要时定制</a>。</p><h1 id="1d72" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何使用它</h1><blockquote class="mp mq mr"><p id="01a7" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">像大多数前端开发人员一样，我们使用Webpack和Rollup来构建基于JavaScript的web应用程序。一旦我们达到一定的项目规模(超过500个模块)，在浏览器中检查变更就成了一件痛苦的事情。使用Create React应用程序，我们的启动时间明显超过了20秒。我们切换到Vite作为我们的开发服务器，现在享受20倍的加载速度。了解更多有关我们迈向更好的开发人员体验之旅的信息。</p></blockquote><p id="7856" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Sipgate | <a class="ae kv" href="https://www.sipgate.de/blog/how-we-set-up-vite-dev-server" rel="noopener ugc nofollow" target="_blank">来源</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">replit | <a class="ae kv" href="https://twitter.com/amasad/status/1355379680275128321?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1355379680275128321%7Ctwgr%5E%7Ctwcon%5Es1_c10&amp;ref_url=https%3A%2F%2Fwww.sipgate.de%2F%3Fp%3D30276" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><h1 id="0e25" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">意识到</h1><p id="fff1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">没有什么是完美的，即使是Vite也有你需要注意的地方。</p><h2 id="6a97" class="ns lt iq bd lu nt nu dn ly nv nw dp mc lf nx ny me lj nz oa mg ln ob oc mi od bi translated">Vite dev服务器没有内置的类型检查</h2><p id="0154" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">问题:</p><p id="79ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Vite使用<a class="ae kv" href="https://esbuild.github.io/" rel="noopener ugc nofollow" target="_blank"> esbuild </a>将Typescript编译成Javascript。遗憾的是，Eslint并不关心类型，在编译时也不会做任何类型检查。</p><p id="2121" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决方案:</p><ul class=""><li id="eaee" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated">利用EsLint(甚至可以添加预推送/预提交git挂钩)</li><li id="b162" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">添加<a class="ae kv" href="https://github.com/fi3ework/vite-plugin-checker" rel="noopener ugc nofollow" target="_blank"> ViteTypeCheck </a>插件</li></ul><h2 id="9741" class="ns lt iq bd lu nt nu dn ly nv nw dp mc lf nx ny me lj nz oa mg ln ob oc mi od bi translated">您必须更新您的TypeScript接口导入</h2><p id="ce5c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您像其他人一样使用了TypeScript接口的通用默认导入:</p><pre class="kg kh ki kj gt oe mz of og aw oh bi"><span id="7f5b" class="ns lt iq mz b gy oi oj l ok ol">import SomeInterface from '@/types/SomeInterface'</span></pre><p id="583c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要在import语句后显式设置<code class="fe mw mx my mz b">type</code>:</p><pre class="kg kh ki kj gt oe mz of og aw oh bi"><span id="bef6" class="ns lt iq mz b gy oi oj l ok ol">import type SomeInterface from '@/types/SomeInterface'</span></pre><h1 id="1a9c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">“快:呃”编译时间的其他选择</h1><p id="1f27" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Vite并不意味着适合每一个用例。正如尤雨溪自己所说:</p><blockquote class="mp mq mr"><p id="a3d3" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">“完全取代webpack并不是Vite的目标。可能有一些现有webpack项目所依赖的少量特性/功能在Vite中不存在，但这些特性在长尾中，只有少数编写定制webpack配置的高级用户需要。这里的一些评论者可能属于这个群体。</p><p id="1826" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">如果您这样做了(例如，您试图迁移并发现了障碍，或者评估并得出结论Vite不适合您的需求)，请务必使用webpack！你并不是Vite设计的目标受众——你绝对应该为这项工作选择合适的工具。<em class="iq"> — </em> <a class="ae kv" href="https://news.ycombinator.com/item?id=26972400" rel="noopener ugc nofollow" target="_blank"> <em class="iq">来源</em> </a></p></blockquote><p id="b19f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，万一你有一个不太适合Vite的项目；以下是其他解决方案的列表:</p><ul class=""><li id="ed06" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated">更新您的webpack或CRA(创建-反应-应用程序)配置</li><li id="4ab2" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">考虑用esbuild替换Babel/TS；您甚至可以用<code class="fe mw mx my mz b">[esbuild-loader](&lt;https://github.com/privatenumber/esbuild-loader&gt;)</code>将eslint添加到webpack中，并在编译<code class="fe mw mx my mz b">[fork-ts-checker-webpack-plugin](&lt;https://github.com/TypeStrong/fork-ts-checker-webpack-plugin#readme&gt;)</code>时进行类型检查，这很方便；<a class="ae kv" href="https://hashnode.com/@marcin-wosinek" rel="noopener ugc nofollow" target="_blank"> Marcin Wosinek </a>甚至写了一篇<a class="ae kv" href="https://how-to.dev/how-to-speed-up-webpack-with-esbuild-loader" rel="noopener ugc nofollow" target="_blank">如何使用esbuild-loder加速webpack的指南</a>。</li></ul><h1 id="e98a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="0964" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank">与传统捆绑器相比，Vite </a>将开发人员的体验和编译时间提高了10-100倍。这不是靠魔法完成的。这是通过使用现代语言的现代标准实现的。</p><p id="19c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你应该为遗留项目使用Vite吗？如果可能，为什么不呢？检查需求，如果不是很合适，检查上面的其他解决方案。</p><p id="ff4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你应该为一个新项目使用Vite吗？当你想学习react时，可以坚持使用create-react-app，这样你就可以先学习React，然后再学习Bundlers😉。</p><h1 id="2836" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">来源</h1><ul class=""><li id="1792" class="na nb iq ky b kz mk lc ml lf om lj on ln oo lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://radixweb.com/blog/webpack-vs-vitejs-comparison" rel="noopener ugc nofollow" target="_blank">了解比较:Webpack vs ViteJS </a></li><li id="6cfc" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://blog.bitsrc.io/vite-is-better-than-webpack-d5dd59610d56" rel="noopener ugc nofollow" target="_blank">Vite比Webpack好吗？</a></li><li id="5eaa" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://www.sipgate.de/blog/how-we-set-up-vite-dev-server" rel="noopener ugc nofollow" target="_blank">移过Webpack！我们如何设置Vite(一个更快的开发服务器)</a></li><li id="a378" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/is-vite-the-killer-of-webpack-a515d9e77a4">Vite是Webpack的黑仔吗？</a></li><li id="b054" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://blog.replit.com/vite" rel="noopener ugc nofollow" target="_blank">为什么我们从Webpack转向Vite </a></li><li id="0890" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/our-journey-with-vite-and-why-we-turned-back-to-webpack-b9a84ba7a223">我们的Vite之旅以及我们为何回归Webpack </a></li><li id="ad5f" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://www.reddit.com/r/javascript/comments/u8m6c8/askjs_is_vite_better_than_using_create_react_app/" rel="noopener ugc nofollow" target="_blank">【AskJS】Vite比用Create React App好吗？</a></li><li id="c298" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">📄<a class="ae kv" href="https://www.reddit.com/r/vuejs/comments/r0fbfw/eli5_why_is_vite_so_much_faster_than_webpack/" rel="noopener ugc nofollow" target="_blank"> ELI5:为什么Vite比Webpack快那么多？</a></li></ul></div></div>    
</body>
</html>