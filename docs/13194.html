<html>
<head>
<title>WSL Extreme Usages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WSL极端用法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/wsl-extreme-usages-bdbb9ec218e7?source=collection_archive---------4-----------------------#2022-08-05">https://betterprogramming.pub/wsl-extreme-usages-bdbb9ec218e7?source=collection_archive---------4-----------------------#2022-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="506c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用图形用户界面、USB连接和Kubernetes</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d370447578a2e48571bc0c5a184c67ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X3GRi1gzUgkJiAvj"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">加布里埃尔·海因策在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="ef2e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="d72e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">正如你可能从我以前的帖子中知道的，我倾向于使用很多开发环境，并且尝试了相当多的不同技术。我在Linux、Windows和Mac上用各种语言编写代码，主要是C/C++与SYCL、Golang、Python、JavaScript和Java。我也使用像<a class="ae kv" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>这样的技术，并涉猎像<a class="ae kv" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>、<a class="ae kv" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>和<a class="ae kv" href="https://www.intel.com/content/www/us/en/developer/tools/openvino-toolkit/overview.html" rel="noopener ugc nofollow" target="_blank"> Intel发行的OpenVINO </a>这样的人工智能技术。</p><p id="dc59" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我总是对简化跨平台开发感兴趣，因为我们永远都不会满足的一件事就是时间。在这篇文章中，我将概述一些我对Linux的Windows子系统(WSL)的快速体验。简而言之，它通常工作得很好，有时我们可以使用变通方法使它工作得相当好，有时我们可能需要引导到Linux。</p><p id="a406" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在我们走得太远之前，我建议如果您在Windows上使用WSL，请从Microsoft Store获得最新版本，因为它确实为我修复了一些与CMake用法和其他一些奇怪行为有关的问题。只需搜索WSL并安装下面的Linux预览版Windows子系统。</p><p id="d173" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我觉得很奇怪，它不在顶部，但如果你向下滚动一点，你会找到它。快速提示，我必须重新创建我的WSL环境，以使更改对我有效。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/af18c80baa3cf474145fba94915a4d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5L1Vg8YNhPFvlfkAXk9bBA.png"/></div></div></figure><p id="f0fa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">假设在此之后您还没有设置WSL环境，您可以遵循任何WSL设置教程(下面的一些链接)。作为参考，我在这篇文章中使用的系统是:</p><ul class=""><li id="d2a0" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj mv mw mx my bi translated">惠普Envy 16笔记本电脑，采用英特尔Alder Lake酷睿i7-12700H、32GB DDR4、英特尔Arc a370m GPU和Windows 11 Pro</li><li id="0770" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj mv mw mx my bi translated">外星人R13采用英特尔Alder Lake Core i9–12900 KF，64GB DD5，NVIDIA GeForce 3080Ti GPU，Windows 11 Pro</li></ul><h1 id="ce02" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么才管用？</h1><h2 id="9f07" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">基础知识</h2><p id="41b9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果您只是编写命令行代码、脚本或使用类似Jupyter笔记本的东西，它会工作得很好。我的C++、Python和Golang代码可以像在Linux上一样编译和运行。Conda，Tensorflow，PyTorch都可以安装和工作。</p><p id="c408" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你想使用一些简单的工具，这里有一些链接可能会帮助你开始:</p><p id="922d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/docker-wsl-and-oneapi-a-quick-how-to-guide-d7db3363b303">设置WSL、VSCode和英特尔oneAPI基础工具包</a></p><p id="4329" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://medium.com/@ferarias/docker-in-windows-11-using-wsl2-8e30faddc32c" rel="noopener">设置码头</a></p><p id="d308" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://towardsdatascience.com/configuring-jupyter-notebook-in-windows-subsystem-linux-wsl2-c757893e9d69" rel="noopener" target="_blank">设置Jupyter笔记本</a></p><p id="a3fa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/intel-arc-gpus-and-oneapi-do-they-sycl-9b3ba7c888b8">英特尔Arc GPU上的GPGPU编程</a></p><h2 id="71b2" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">Kubernetes(用于小型系统)</h2><p id="95d1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我过去用过K3s和MicroK8s，但我不确定开箱后是否能正常工作。我非常高兴在使用20.04 Ubuntu的WSL上安装K3s就像在Linux上一样简单。</p><ol class=""><li id="0245" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj nq mw mx my bi translated">确保在WSL中配置了systemd</li><li id="8c4b" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj nq mw mx my bi translated">从<a class="ae kv" href="https://k3s.io/" rel="noopener ugc nofollow" target="_blank">https://k3s.io/</a>安装K3s并运行<code class="fe nr ns nt nu b">sudo k3s server</code></li><li id="c3aa" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj nq mw mx my bi translated">使用<code class="fe nr ns nt nu b">sudo apt get kubectl</code>安装kubectl</li><li id="312c" class="mq mr iq lq b lr mz lu na lx nb mb nc mf nd mj nq mw mx my bi translated">确保kubeconfig <code class="fe nr ns nt nu b">/etc/rancher/k3s/k3s.yaml</code>可以被kubectl使用</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/7b6cddf462c1b0fb07949795866e7a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wH8hfM6SCDh4CfBI27an8A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不到10分钟即可完成K3s</p></figure><p id="0940" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是开发人员需要的一小部分，我不可能涵盖所有有效的东西，但是对于大多数事情来说，WSL非常容易使用。</p><h1 id="c142" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么在帮助下起作用？</h1><h2 id="eb26" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">GUI</h2><p id="7981" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">WSL2是原始WSL的一大进步，因为它增加了对GUI的支持。对于我测试的一些东西，它只是开箱即用。例如，创建一个简单的OpenGL窗口并渲染一个简单的场景就很好。我遇到的唯一问题是WSL DirectX层支持的最高OpenGL版本是3.3。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/33070b1f604ff46eacff4ac0d9464656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNoNDsjERzojK-rfMuw49Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">WSL支持的OpenGL版本</p></figure><p id="6977" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我的第二个测试是看看我们的英特尔图形用户界面工具能否工作。当我尝试运行英特尔VTune分析器GUI时，遇到了这个问题:</p><pre class="kg kh ki kj gt nx nu ny nz aw oa bi"><span id="ef9c" class="ne kx iq nu b gy ob oc l od oe">tonym@HPEnvy:~$ vtune-gui<br/>vtune-gui: error while loading shared libraries: libnss3.so: cannot open shared object file: No such file or directory</span></pre><p id="93c6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在安装了一些库之后，我意识到问题的原因是应用程序期望GTK+安装在系统上。以下命令允许我在WSL中运行英特尔VTune分析器GUI:</p><pre class="kg kh ki kj gt nx nu ny nz aw oa bi"><span id="4137" class="ne kx iq nu b gy ob oc l od oe">&gt; sudo apt install libnss3-dev<br/>&gt; sudo apt install libatk1.0–0<br/>&gt; sudo apt install libatk-bridge2.0–0<br/>&gt; sudo apt-get install libgtk-3-dev</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/311deb9d7c5d6abe21f3758100b6d9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXerH46nsJL62argRuzjLw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">英特尔VTune分析器GUI正在运行！</p></figure><p id="a90f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">通过WSL做这件事的好处是，现在我可以使用GUI在我的WSL文件系统上定位我的Linux应用程序，并运行我的工作负载。</p><p id="80dd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">公平地说，这最后一个问题不是WSL的限制。不幸的是，这是一个非常常见的问题，Linux GUI开发人员假设他们的应用程序有特定的平台库。</p><h1 id="dcd0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">USB设备连接</h1><p id="c265" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当我使用USB设备进行一些测试时，将我的设备连接到机器的简单工作流程最初并不工作。当然，这很有意义，因为这需要通过虚拟机层映射连接。</p><p id="2a2b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">幸运的是，有一种方法可以使用USB/IP开源项目来启用USB连接的设备。微软已经记录了<a class="ae kv" href="https://docs.microsoft.com/en-us/windows/wsl/connect-usb" rel="noopener ugc nofollow" target="_blank">的需求以及如何为WSL </a>建立这个库，它允许我与设备进行交互。对常见问题有简单的解决方案真好！</p><h1 id="ff74" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">虚拟专用网络</h1><p id="5359" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果您的工作需要一个公司VPN，那么在使用VPN时将WSL实例连接到互联网可能会非常棘手。有几个变通办法，但官方的，非官方的变通办法可以在这里找到。</p><div class="og oh gp gr oi oj"><a href="https://randombytes.substack.com/p/bridged-networking-under-wsl" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">WSL下的桥接网络</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">但仍未得到官方批准。我的意思是，它是来自实际的WSL团队本身的一个特性，对于WSL…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">randombytes.substack.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kp oj"/></div></div></a></div><h1 id="40fe" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么没用？</h1><h2 id="76e6" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">带GPU支持的K3s</h2><p id="92c4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对我来说幸运的是，我只尝试了一件事没有成功，可能我只是不知道如何正确地设置它。罪魁祸首是在GPU支持下运行Kubernetes。我确实找到了一些<a class="ae kv" href="https://dev.to/mweibel/add-nvidia-gpu-support-to-k3s-with-containerd-4j17" rel="noopener ugc nofollow" target="_blank">资源</a>，暗示你也许能让它运行起来，但是我没能让它运行起来。</p><p id="0965" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">WSL和Docker(或其他容器运行时)开箱即用。我对此唯一的使用案例是真正的利基；如果你想运行一个支持GPU的容器工作流，但想通过K3s而不是另一个容器运行时来完成。除非您正在进行一些Kubernetes开发或者试图利用一些Kubernetes部署，否则这可能没有意义。</p><p id="45dd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">据我所知，WSL使用其DirectX Linux驱动程序与底层GPU进行接口，这可能会暴露给Kubernetes。我没有找到一种简单的方法来做这件事。不幸的是，我的用例甚至更窄；我正在实现一个特定的Kubernetes设备插件。</p><p id="6a83" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在一天结束的时候，当我需要这样做的时候，我只是在系统上启动Linux。</p><h1 id="9c5b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="b8f2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">WSL对于我所做的95%的工作都非常有效，尽管我在所有的系统上都安装了Linux，但我很少需要引导到原生Linux。这为我在进行跨平台开发时节省了大量时间，这很好，这样我就不用浪费半天时间盯着我的BIOS启动屏幕了。</p><p id="899c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">它还有一些额外的好处，比如让我在我喜欢的操作系统上运行一些跨平台的工具，比如Python。这似乎是一件小事，但出于某种原因，我喜欢键入<code class="fe nr ns nt nu b">ls</code>而不是<code class="fe nr ns nt nu b">dir</code>。总而言之，我认为WSL对我的生产力来说是一个巨大的胜利，我猜如果你正在阅读这篇文章，你可能会同意(或者你想达到你同意的程度😊).</p><pre class="kg kh ki kj gt nx nu ny nz aw oa bi"><span id="4dc9" class="ne kx iq nu b gy ob oc l od oe"><strong class="nu ir">Want to Connect?</strong></span><span id="f9a7" class="ne kx iq nu b gy oy oc l od oe">If you want to see what random tech news I’m reading, you can <a class="ae kv" href="https://twitter.com/tonymongkolsmai" rel="noopener ugc nofollow" target="_blank">visit me on Twitter</a>.</span></pre></div></div>    
</body>
</html>