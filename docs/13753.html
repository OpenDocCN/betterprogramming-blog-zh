<html>
<head>
<title>A Gentle Introduction to PyPy — Faster Python With Minimal Changes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyPy的简单介绍——速度更快、改动最少的Python</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-gentle-introduction-to-pypy-python-performance-and-benchmarking-3d0e5609985?source=collection_archive---------0-----------------------#2022-09-24">https://betterprogramming.pub/a-gentle-introduction-to-pypy-python-performance-and-benchmarking-3d0e5609985?source=collection_archive---------0-----------------------#2022-09-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="22da" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">PyPy与Python——性能和基准测试</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fa96eaeadc87d0cd137221b9fbc5d307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Rctc_ZO7HF7D5Y48"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/es/@tetrebbien?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> TETrebbien </a>拍摄的照片</p></figure><p id="1d21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将讲述我最近才接触到的PyPy的经历。</p><p id="1dc1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文是对2011年【1】的<a class="ae kv" href="https://morepypy.blogspot.com/2011/04/tutorial-writing-interpreter-with-pypy.html" rel="noopener ugc nofollow" target="_blank">用PyPy </a>编写解释器教程的补充。当我第一次尝试按照这篇博文的步骤操作时，我遇到了许多问题，比如过时的文档、过时的代码引用、python版本不兼容等等。我将试着在这里介绍这些问题和我的学习经历。</p><p id="d7aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://morepypy.blogspot.com/2011/04/tutorial-writing-interpreter-with-pypy.html" rel="noopener ugc nofollow" target="_blank">用PyPy </a>写一个解释器是关于用PyPy工具链创建一个<a class="ae kv" href="https://en.wikipedia.org/wiki/Brainfuck" rel="noopener ugc nofollow" target="_blank">BF</a>【2】解释器以及它的翻译过程。当我跟进时，对我来说主要的问题与工具链本身有关。因此，我决定把我的注意力集中在这里。我们不会在这里讨论BF解释器，因为它已经在最初的博客文章中解释过了，但是我将介绍PyPy工具链和一些基本的基准概念，它们对于理解这个主题是必不可少的。</p><h1 id="7869" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">PyPy到底是什么？</h1><p id="e6b0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果你以前尝试过Python，你可能运行的是<a class="ae kv" href="https://en.wikipedia.org/wiki/CPython" rel="noopener ugc nofollow" target="_blank">CPython</a>【3】。CPython是Python VM(虚拟机)最常见的实现。<a class="ae kv" href="https://www.pypy.org/" rel="noopener ugc nofollow" target="_blank">PyPy</a>【4】是CPython的替代品。</p><p id="ab1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用PyPy，我们用<a class="ae kv" href="https://doc.pypy.org/en/latest/coding-guide.html#restricted-python" rel="noopener ugc nofollow" target="_blank">RPython</a>【5】编写程序，并应用生成二进制可执行文件的RPython翻译工具链。PyPy相对于CPython的一个主要优势是速度，这将在本文后面使用基本的基准测试工具进行演示。</p><p id="c288" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">行话总结:</strong></p><ul class=""><li id="823e" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><strong class="ky ir">CPython</strong>——最常见的Python实现</li><li id="6247" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">PyPy——CPython替代方案</li><li id="1ba4" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">RPython</strong>—Python的受限版本</li><li id="3d5c" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">基准</strong>——评估程序相对性能的行为(在我们的例子中是时间)</li></ul><h1 id="e0c9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">上手使用RPython</h1><p id="b562" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们需要编写一个简单的<code class="fe nd ne nf ng b">RPython</code>程序，称之为<code class="fe nd ne nf ng b">python_prime.py</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1d6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它绝对类似于Python👀。那是因为<code class="fe nd ne nf ng b">RPython</code>是限制级Python。我们必须选择某种计算问题，所以我们用了一个素数序列生成器。实际的计算工作不是这里的重点。</p><p id="e188" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的RPython程序也有一些PyPy挂钩——一个叫做<code class="fe nd ne nf ng b">target</code>的函数(注释应该是不言自明的)。</p><h1 id="1988" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">运行程序</h1><p id="5d8f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将使用Python 2.7.18版本，因为我发现了与更高版本的不兼容问题。如果你没有安装2.7 Python版本，你可以使用<a class="ae kv" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank">pyenv</a>【6】或<a class="ae kv" href="https://docs.conda.io/projects/conda/en/latest" rel="noopener ugc nofollow" target="_blank">conda</a>【7】等工具。</p><p id="e0aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行我们的程序:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="52fa" class="nn lt iq ng b gy no np l nq nr">$ python ./python_prime.py 10</span></pre><p id="27e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们应该得到类似于图1的输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/3a5a54145c3ccef7531e1fe038ca4995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKJN0vgFFVoVQAd4blexZg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图一。以CPython身份运行RPython程序。</p></figure><h1 id="a4ba" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">标杆管理</h1><p id="d1db" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们已经有了自己的程序，我们可以做一些基准测试来了解它的运行时性能。</p><p id="e8ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们将使用一个叫做<a class="ae kv" href="https://github.com/sharkdp/hyperfine" rel="noopener ugc nofollow" target="_blank">超精细</a>【8】的工具。</p><p id="627d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Mac安装:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="ddd3" class="nn lt iq ng b gy no np l nq nr">brew install hyperfine</span></pre><p id="8bd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Linux Debian安装:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="9426" class="nn lt iq ng b gy no np l nq nr">wget <a class="ae kv" href="https://github.com/sharkdp/hyperfine/releases/download/v1.15.0/hyperfine_1.15.0_amd64.deb" rel="noopener ugc nofollow" target="_blank">https://github.com/sharkdp/hyperfine/releases/download/v1.15.0/hyperfine_1.15.0_amd64.deb</a> </span><span id="37ef" class="nn lt iq ng b gy nt np l nq nr">sudo dpkg -i hyperfine_1.15.0_amd64.deb</span></pre><p id="7ad0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与我们如何运行RPython程序类似，我们可以通过hyperfine实用程序来运行它:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="83e9" class="nn lt iq ng b gy no np l nq nr">$ hyperfine 'python ./python_prime.py 10000'</span></pre><p id="e021" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图2展示了完整的输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/2444773bdf0f10de7217fd46d82ceadb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeBN0O8cIxjQUS5IQahQPQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图二。RPython程序基准测试结果。</p></figure><p id="4566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认情况下，Hyperfine会运行我们的程序十次，并给出诸如最小和最大执行时间之类的统计数据。这里我们不打算详细讨论超精细。重要的是，在比较运行时时，要有一种感觉和高层次的理解。</p><p id="7daf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，基准测试的结果可能会受到不同因素的影响，例如运行基准测试的机器、运行基准测试时同时运行的其他进程、热启动与冷启动、缓存等。但是，就我们的目的而言，我们这里的基准流程已经足够好了。</p><h1 id="1061" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用PyPy翻译我们的程序</h1><p id="65ba" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">第一步是获得PyPy源代码:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="e61f" class="nn lt iq ng b gy no np l nq nr">wget <a class="ae kv" href="https://downloads.python.org/pypy/pypy2.7-v7.3.9-src.tar.bz2" rel="noopener ugc nofollow" target="_blank">https://downloads.python.org/pypy/pypy2.7-v7.3.9-src.tar.bz2</a> <br/>tar -xvf pypy2.7-v7.3.9-src.tar.bz2 # extracting <br/>tar mv pypy2.7-v7.3.9-src ./pypy </span></pre><p id="ecdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们下载源代码，提取它并重命名提取的目录，以便以后使用。</p><p id="e34b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下载并解压缩后，运行PyPy翻译工具链:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="8762" class="nn lt iq ng b gy no np l nq nr">export PYTHONPATH=${PWD}:${PWD}/pypy/ <br/>python ./pypy/rpython/translator/goal/translate.py python_prime.py</span></pre><p id="c6c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您将教程代码与我的进行比较，您会注意到文件路径的不同——<code class="fe nd ne nf ng b"><a class="ae kv" href="http://translate.py" rel="noopener ugc nofollow" target="_blank">translate.py</a></code>是从<code class="fe nd ne nf ng b">pypy/translator/goal/translate.py to rpython/translator/goal/translate.py</code>转移过来的。</p><p id="0820" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，我将<code class="fe nd ne nf ng b"><a class="ae kv" href="https://bic-berkeley.github.io/psych-214-fall-2016/using_pythonpath.html" rel="noopener ugc nofollow" target="_blank">PYTHONPATH</a></code> [9]环境变量设置为当前目录和PyPy源代码的路径。这将使PyPy模块可供我们的程序运行。</p><p id="bb79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当运行它时，您应该在您的终端上看到toolchain日志(在我的M1芯片上大约需要30秒)；当这个过程完成时，我们应该得到与python文件同名但后缀为“-c”的翻译后的二进制文件。</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="14c2" class="nn lt iq ng b gy no np l nq nr">$ ls -lah ./python_prime-c <br/>-rwxr-xr-x 1 medium medium 217K 24 Sep 11:34 ./python_plain_class-c</span></pre><p id="ad9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看里面👀</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="9dd1" class="nn lt iq ng b gy no np l nq nr">$ file ./python_plain_class.py ./python_plain_class-c </span><span id="46f9" class="nn lt iq ng b gy nt np l nq nr">python_plain_class.py: <strong class="ng ir">Python script text executable, ASCII text </strong>python_plain_class-c: Mach-O 64-bit <strong class="ng ir">executable x86_64</strong></span></pre><p id="41e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您不信任文件命令:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="6853" class="nn lt iq ng b gy no np l nq nr">$ head ./python_plain_class-c</span><span id="db3e" class="nn lt iq ng b gy nt np l nq nr">������ H__PAGEZEROx__TEXT__text__TEXT0/��0/�__stubs__TEXT��&gt;��__stub_helper__TEXT�”��__cstring__TEXT2�q2�__const__TEXT�����__unwind_info__TEXTD��D�__eh_frame__TEXT8��...</span></pre><p id="850a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是的，它确实是一个二进制文件。</p><p id="43c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，我们用PyPy把Python翻译成了二进制。现在怎么办？</p><h1 id="fb6b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">比较基准🔬</h1><p id="2928" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在我们翻译的程序上运行hyperfine:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="609e" class="nn lt iq ng b gy no np l nq nr">$ hyperfine ‘./python_prime-c 10000’</span></pre><p id="d7bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整输出见图3。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/8945c9aca8a72dc909dd61f1e941941a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*245AkEwOAyxSgqwNCu5TYw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图3。翻译的RPython程序基准测试结果。</p></figure><p id="78f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">发现区别了吗？我们也可以运行hyperfine来比较这两个程序:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="6bb9" class="nn lt iq ng b gy no np l nq nr">$ hyperfine './python_prime-c 10000' 'python ./python_prime.py 10000'</span></pre><p id="5915" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图4显示了完整的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/9fb48e68df2747b028abd68bb125e444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hK5pM64W1_33-TfB_40yDw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4。比较CPython和RPython基准。</p></figure><p id="c88a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">说什么！？速度快72倍🤯？！</p><p id="0b9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">显然是的。超精细不会骗你。你可以相信它。</p><p id="0960" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你真的希望这样吗？？也许我应该把这篇文章命名为“让你的python程序运行速度提高70倍”？我认为这仍然很酷…好了，继续。</p><p id="9267" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们再次运行hyperfine，这一次使用worm-up和更多运行:</p><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="d7a2" class="nn lt iq ng b gy no np l nq nr">$ hyperfine --warmup 10 './python_prime-c 10000' 'python ./python_prime.py 10000' \<br/>&amp;&amp; hyperfine -m 100 -M 100 './python_prime-c 10000' 'python ./python_prime.py 10000'</span></pre><p id="1ea4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果见图4。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/b6ac862dae0be283609fd1145ca34472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SzPcX02sbNepKVVqKycAvw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4。比较CPython和PyPy基准。</p></figure><p id="7731" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在运行基准测试之前，我们执行了十次预热，然后每个程序运行100次，并记录它们的执行时间。结果和上一个相差不远；这是完全相同的指标，因为我没有在实验室中运行基准测试，所以基准测试可能有些偏差！</p><h1 id="bfa4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">总结✏️</h1><p id="187c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">那么我们做了什么？我们构建了一个简单的RPython程序，使用PyPy工具链对其进行了翻译，并在使用hyperfine并排比较两个程序的执行时间时，亲眼见证了显著的性能提升。</p><p id="6942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于编写计算密集型应用程序来说，PyPy似乎是一个不错的选择，尤其是如果您想留在Python领域的话。但是，如果您尝试一段时间，您会发现它可能没有使用CPython方便；您可能会遇到一些模糊的类型注释错误或不支持的函数调用异常。就像生活中的任何事情一样，它有优点也有缺点。</p><p id="a8df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道，我知道。谁关心Python 2.7？！在撰写本文时，我们已经处于Python 3.10.7。我们为什么要为Python 2.7费心？它也达到了支持的结尾，因为你错过了它！</p><p id="3ccf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">主要原因是我在跟踪2011年的文章，你猜怎么着？2011年还没有Python 3 . 10 . 7版本。顺便说一下，我打赌你可以使用更新的版本，就像我在官方下载页面上看到的那样。我只是还没试过。</p><p id="3cc1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我听说PyPy的时候，我很兴奋(自从我写第一个Python语言以来差不多十年了)。即使我还不打算在生产中使用它，仅仅知道执行这样的优化实际上是可行的也是令人大开眼界的。</p><h1 id="5961" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">下一个❓️是什么</h1><p id="cefc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">接下来，我们将查看PyPy jit跟踪日志，并在我们的RPython应用程序中执行进一步的优化。</p><h2 id="20af" class="nn lt iq bd lu ny nz dn ly oa ob dp mc lf oc od me lj oe of mg ln og oh mi oi bi translated">参考</h2><p id="1592" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">[1]<a class="ae kv" href="https://morepypy.blogspot.com/2011/04/tutorial-writing-interpreter-with-pypy.html" rel="noopener ugc nofollow" target="_blank">https://morepypy . blogspot . com/2011/04/tutorial-writing-interpreter-with-pypypy . html</a></p><p id="2249" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]https://en.wikipedia.org/wiki/Brainfuck<a class="ae kv" href="https://en.wikipedia.org/wiki/Brainfuck" rel="noopener ugc nofollow" target="_blank"/></p><p id="5865" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]https://en.wikipedia.org/wiki/CPython<a class="ae kv" href="https://en.wikipedia.org/wiki/CPython" rel="noopener ugc nofollow" target="_blank"/></p><p id="5102" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.pypy.org/" rel="noopener ugc nofollow" target="_blank">https://www.pypy.org/</a></p><p id="b2a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[5]<a class="ae kv" href="https://doc.pypy.org/en/latest/coding-guide.html#restricted-python" rel="noopener ugc nofollow" target="_blank">https://doc . pypy . org/en/latest/coding-guide . html # restricted-python</a></p><p id="2077" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank">https://github.com/pyenv/pyenv</a></p><p id="b996" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html" rel="noopener ugc nofollow" target="_blank">https://docs.conda.io/projects/conda/en/latest</a></p><p id="db3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/sharkdp/hyperfine" rel="noopener ugc nofollow" target="_blank">https://github.com/sharkdp/hyperfine</a></p><p id="5cde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[9]<a class="ae kv" href="https://bic-berkeley.github.io/psych-214-fall-2016/using_pythonpath.html" rel="noopener ugc nofollow" target="_blank">https://BIC-Berkeley . github . io/psych-214-fall-2016/using _ python path . html</a></p></div></div>    
</body>
</html>