<html>
<head>
<title>The 2 Must-Know Protocols for SwiftUI Animation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI动画的两个必须知道的协议</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/2-must-know-protocols-for-swiftui-animation-cd50bf38895e?source=collection_archive---------10-----------------------#2020-08-17">https://betterprogramming.pub/2-must-know-protocols-for-swiftui-animation-cd50bf38895e?source=collection_archive---------10-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2071" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Animatable和AnimatableModifier是创建SwiftUI动画的基本要素</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/996bce74cb126eb7b2357cc16c7ba2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qwv8_U3VcpQbOFcv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@phoebezzf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">周</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="6b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用SwiftUI时，以如丝般平滑的性能制作视图和过渡的动画非常重要。本文介绍了每个开发人员都必须知道的SwiftUI动画的两个协议。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="00a1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.动画协议</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/77ee9c7f086eb5e8b92edd1df84bf26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IScYq3TVM4RPYNuO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">西蒙·伯杰在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e6e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">iOS 13+上有<code class="fe mv mw mx my b">Animatable</code>协议。它定义了可以制作动画的类型。协议包含的唯一值是<code class="fe mv mw mx my b">animatableData</code>，它是<code class="fe mv mw mx my b">VectorArithmetic</code>的关联类型。<code class="fe mv mw mx my b">VectorArithmetic</code>扩展了<code class="fe mv mw mx my b">AdditiveArithmetic</code>协议，增加了标量乘法和一种查询向量大小的方法。协议帮助我们制作路径动画和转换矩阵。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的动画协议要点</p></figure><p id="6d02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI遍历视图层次结构，找到采用<code class="fe mv mw mx my b">Animatable</code>协议的值，并通过使用特定项目的<code class="fe mv mw mx my b">animatableData</code>动画显示其变化。</p><p id="e4f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面我们用进度条圈动画为例多解释一下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/adcffc65f4edd4c8f680032b01ee0af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/1*owLyDTVPMdiUDK7Sv-EJQw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的进步圈动画</p></figure><h2 id="d3fa" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated"><code class="fe mv mw mx my b">State</code>变量</h2><p id="acf9" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">通常，我们使用<code class="fe mv mw mx my b">@State</code>属性包装器来定义一些状态变量，然后将动画修改器附加到视图上。<code class="fe mv mw mx my b">progress</code>是进度百分比的状态变量。并且我们使用<code class="fe mv mw mx my b">Circle</code>的实例来绘制进度弧线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的内容视图</p></figure><h2 id="42fc" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated">动画和动画数据</h2><p id="bb60" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">为了理解<code class="fe mv mw mx my b">Animatable</code>的细节，让我们看一下下面的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">非动画AnimatableCircle.swift作者杨梦</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/2906cbc034720fb2ac8c0469f2ee39db.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*DstCUgG9L4LlmH_Rhxmm4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的非动画圈</p></figure><p id="d0f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们有一个采用<code class="fe mv mw mx my b">Shape</code>协议的<code class="fe mv mw mx my b">AnimatableCircle</code>。SwiftUI中的所有形状都符合<code class="fe mv mw mx my b">Animatable</code>协议，但是在启动示例时没有动画。</p><p id="3152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI不能识别如何动画化这个圆，因为没有<code class="fe mv mw mx my b">AnimatableData</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的动画圈</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/adcffc65f4edd4c8f680032b01ee0af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/1*owLyDTVPMdiUDK7Sv-EJQw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的动画圈</p></figure><p id="ab86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过实现<code class="fe mv mw mx my b">animatableData</code>，我们更新了<code class="fe mv mw mx my b">progress</code>属性，并可以将它制作成动画。最重要的是，通过实现<code class="fe mv mw mx my b">Shape</code>协议，它给了我们更多的灵活性来制作更多可定制的动画。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a4e2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.AnimatableModifier协议</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/f839d8da3a37b375425912f8370a79e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j1G3fpP9Wne1E5VP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@fabianmardi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Fabian Mardi </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="fcdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">AnimatableModifier</code>协议采用<code class="fe mv mw mx my b">Animatable</code>和<code class="fe mv mw mx my b">ViewModifier</code>协议。iOS 13+上有。正如你可能已经从协议的名字中注意到的，它可以动画化<code class="fe mv mw mx my b">Shape</code>的路径和<code class="fe mv mw mx my b">View</code>的内容！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的动画修改器协议要点</p></figure><p id="c51a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面我们用带百分号标签的进度圈动画来解释一下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/96f1866156398c1a22f863bf3081fcf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/1*iXOC-VFshmgHCkIzHP57Ug.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">进度圈与杨梦的百分比动画</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杨梦的percentageanimatablecircle . swift</p></figure><p id="3da3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一个一个地检查代码:</p><h2 id="8f01" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated">动画圈</h2><p id="856b" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated"><code class="fe mv mw mx my b">AnimatableCircle</code>通过实现路径功能，采用<code class="fe mv mw mx my b">Shape</code>协议绘制圆弧。</p><p id="7bfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们没有让<code class="fe mv mw mx my b">AnimatableCircle</code>可动画化，也没有使用<code class="fe mv mw mx my b">animatableData</code>。</p><h2 id="1c00" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated">文本视图</h2><p id="089c" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们在视图中添加了带有百分比的<code class="fe mv mw mx my b">Text</code>实例。它实现了<code class="fe mv mw mx my b">View</code>的主体，但也没有使用<code class="fe mv mw mx my b">@State</code>或<code class="fe mv mw mx my b">animatableData</code>。</p><p id="84bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，SwiftUI在<code class="fe mv mw mx my b">Text</code>的末尾使用额外的<code class="fe mv mw mx my b">.id</code>来决定它是处理同一个视图还是一个新视图。通过使用一个惟一的id，SwiftUI将按照预期用指定的过渡重新绘制它。</p><h2 id="c637" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated">动画修改器</h2><p id="964f" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated"><code class="fe mv mw mx my b">PercentageAnimatableCircle</code>采用<code class="fe mv mw mx my b">AnimatableModifier</code>。由于<code class="fe mv mw mx my b">AnimatableModifier</code>符合<code class="fe mv mw mx my b">Animatable</code>和<code class="fe mv mw mx my b">ViewModifier</code>，我们现在有两个地方可以做动画:<code class="fe mv mw mx my b">animatableData</code>和<code class="fe mv mw mx my b">body(content: Content)</code>。</p><p id="6fd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">animatableData</code>更新进度百分比，<code class="fe mv mw mx my b">body</code>控制内容覆盖。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ef61" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/76cc079f748009d7e24f66c5ea011886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*72A41Vt_ninreYOh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@aaronburden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚伦·伯顿</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b9c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文章介绍了SwiftUI动画最重要的两个协议<code class="fe mv mw mx my b">Animatable</code>和<code class="fe mv mw mx my b">AnimatableModifier</code>。通过采用它们，我们可以实现许多令人兴奋的动画，并利用我们的应用程序的UX。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1797" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><p id="7045" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">上述所有代码均可在<a class="ae ky" href="https://gist.github.com/ericleiyang/50caec4afd8dbbb551a1e18a5786cbdc" rel="noopener ugc nofollow" target="_blank">要点报告</a>中找到。</p></div></div>    
</body>
</html>