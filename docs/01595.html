<html>
<head>
<title>Improve Your App’s Performance With Profiler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Profiler提高应用的性能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/improve-your-apps-performance-with-profiler-67e65153d5d9?source=collection_archive---------14-----------------------#2019-09-26">https://betterprogramming.pub/improve-your-apps-performance-with-profiler-67e65153d5d9?source=collection_archive---------14-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="18ef" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">100天代码的第九天——性能至关重要</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9a1c99ad4d29d7d250a4dfa66cca965d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3E8nadfwExepu-fxORZmA.png"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ku kv l"/></div></figure><p id="beec" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">在如此努力地开发应用程序后，你不会想发布一个占用大量内存、不稳定的应用程序来加热用户的手机。</p><p id="00d8" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">在Android Studio 3.0之前，有一些可用的监控工具，以及传统的日志记录。但是，检查您的代码日志记录语句，并使用旧的工具，对开发人员来说并没有多大帮助。</p><p id="4281" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">Android Studio 3.0自带的<a class="ae ls" href="https://developer.android.com/studio/profile/android-profiler" rel="noopener ugc nofollow" target="_blank"> Android Profiler </a>出现了。开发人员可以使用它来监控他们的CPU、内存、电池消耗，以及监控应用程序发出的网络请求。是的，您仍然可以在Logcat中打印日志语句。</p><p id="3436" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我总是忙于学习和试验最新的Android概念，从来没有时间深入剖析。我知道它就在那里，但总是拖延去了解更多，尽管它是Android应用程序开发的一个如此重要的方面。</p><p id="8076" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">您可以跟踪活动，这一过程可能是您的应用程序出现性能问题的根本原因。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="1c44" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">让我们看看侧写员</h1><p id="c269" class="pw-post-body-paragraph kw kx it ky b kz ms ju lb lc mt jx le lf mu lh li lj mv ll lm ln mw lp lq lr im bi translated">你需要(至少)在设备上安装Android Studio 3.0和SDK。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/c55eb064ed4294effb8763c4926aa0a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jxhip85kxPkOVHQc5xW6EQ.png"/></div></div></figure><p id="66e7" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">一旦你启动你的应用程序，点击底部的<em class="my">分析器</em>标签，它将靠近<em class="my">日志目录</em>。你会看到这样一个连续的图表，是实时更新的。它将在前台运行的活动显示在顶部。</p><p id="76c2" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">当你点击任何一个图表，你会看到一个详细的细分。</p><p id="bc4f" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">更多地运行您的应用程序，进行互动，打开多个活动，并进行网络请求，您将观察到这些图表正在更新，这真的很有趣。</p><p id="39dd" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">而且，如果您很想了解并看到哪些函数消耗了更多的资源，您甚至可以看到这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/5c28869978e5ca9ee718598a9396b28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDP1vN5FiXlP92TWGIDIKQ.png"/></div></div></figure><p id="5c1c" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">单击图表的任意位置，查看更多详细信息。将鼠标指针移到它上面，可以查看资源消耗的详细明细。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/d93e62bd8f75e0b92f7805b738ff7f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6rKbGX_VQwp3aVzIASPiQ.png"/></div></div></figure><p id="9ad4" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我们才刚刚开始。再次单击以查看更详细的屏幕。</p><p id="80fa" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">在这里，您可以选择查看调用堆栈、调用的各种类、涉及的线程，这对于一些人来说可能会有点令人不知所措。但是一旦你学会了，它真的是一个很好的工具。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/bb8c76fa3217295374f30c29157b54ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQlxc9OYNlKraqJ_QCCX3A.png"/></div></div></figure><p id="f04d" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我们还没完呢。你甚至可以记录一段时间内的读数。在你完成记录后，Android Studio会向你展示一些真正深入的内存消耗统计数据，精确到每一个字节。太神奇了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/c3d714eb72b3f58f1fb9ab80a9ff93ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cbv7GPWVjQ_K3kqUP9Fn2Q.png"/></div></div></figure><p id="6f01" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">请确保您在记录会话时进行了一些互动，因为它确实需要数据来生成见解。一旦停止记录，底部将会充满数据。</p><h2 id="4ac8" class="nd mb it bd mc ne nf dn mg ng nh dp mk lf ni nj mm lj nk nl mo ln nm nn mq no bi translated"><strong class="ak"> <em class="np">调用图表</em> </strong></h2><p id="02ff" class="pw-post-body-paragraph kw kx it ky b kz ms ju lb lc mt jx le lf mu lh li lj mv ll lm ln mw lp lq lr im bi translated">它以自上而下的方式显示所有呼叫者及其呼叫。方法调用将有不同的调用供您轻松识别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/03b26fdd153dd79940e6897920c81de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRTVgwI0q4UoNs-7-ICd7A.png"/></div></div></figure><h2 id="c110" class="nd mb it bd mc ne nf dn mg ng nh dp mk lf ni nj mm lj nk nl mo ln nm nn mq no bi translated"><em class="np">火焰图</em></h2><p id="9d43" class="pw-post-body-paragraph kw kx it ky b kz ms ju lb lc mt jx le lf mu lh li lj mv ll lm ln mw lp lq lr im bi translated">它揭示了哪些方法占用了我们设备宝贵的CPU时间。它与调用堆栈聚合相同，颠倒了前一个选项卡中的图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/8a123b90638b557b6b782309f7f883ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXQP8IJz5cSLJNwBkh7QLA.png"/></div></div></figure><h2 id="508a" class="nd mb it bd mc ne nf dn mg ng nh dp mk lf ni nj mm lj nk nl mo ln nm nn mq no bi translated">自上而下</h2><p id="9c8a" class="pw-post-body-paragraph kw kx it ky b kz ms ju lb lc mt jx le lf mu lh li lj mv ll lm ln mw lp lq lr im bi translated">以自顶向下的方式显示方法调用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/7bbdfca4f42ddc81bd41da084495a9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0136-ZDUcJOQq57VrODUJQ.png"/></div></div></figure><h2 id="b153" class="nd mb it bd mc ne nf dn mg ng nh dp mk lf ni nj mm lj nk nl mo ln nm nn mq no bi translated">自下而上</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/c7e656e3ae0d52a1a4620e8ffcbb04e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKgrNljqrN4LMf6Gclz9QA.png"/></div></div></figure></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="0313" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">从这些图表中你能得出什么结论？</h1><ol class=""><li id="23d9" class="nu nv it ky b kz ms lc mt lf nw lj nx ln ny lr nz oa ob oc bi translated">如果你的内存图表持续增长，并且没有内存被释放，那么你的Android操作系统将只分配有限的内存给你的应用程序，之后你的应用程序将抛出一个<code class="fe od oe of og b">OutOfMemory</code>错误。(要看到这一点，可以创建一个无限增长的列表视图。孩子们不要在家里尝试这个！)然后，也许用回收器视图替换你的列表视图，看看在使用回收器视图后你是否节省了内存。</li><li id="aee8" class="nu nv it ky b kz oh lc oi lf oj lj ok ln ol lr nz oa ob oc bi translated">如果您的图形波动很快，这意味着您的内存正在被消耗，垃圾收集也在频繁地释放内存，这也会对UX造成影响。</li></ol><p id="91d5" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">这里的主要目标应该是在尽可能低的读数下保持图形尽可能的平坦。不要把它保持在800兆字节。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="3469" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">一个个人的例子和你在剖析时应该期待什么</h1><p id="5e35" class="pw-post-body-paragraph kw kx it ky b kz ms ju lb lc mt jx le lf mu lh li lj mv ll lm ln mw lp lq lr im bi translated">今天，当我在做我的一个项目时，我查看了Android Profiler，发现应用程序的内存消耗出现了巨大的峰值，看到如此巨大的内存峰值，我感到非常惊讶，尽管应用程序在开始时几乎什么也没有做。</p><p id="103d" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">因此，我想将我已经在运行的应用程序与一个什么都不做的全新应用程序进行比较，所以我创建了默认的<em class="my">我的应用程序</em> Android Studio项目，并在我的Oppo Realme 2上运行，运行Android Oreo。</p><p id="2da8" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">这是默认新项目的概要分析器的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/2049a8f740d99b86a4bb6a1edee51b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gvGeCMbek6WEztIeJPjJzQ.png"/></div></div></figure><p id="17ff" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">查看峰值，它显示了正在使用的内存的明细。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/86e23dfa1c52d8959e3486760599bc03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ce_CvPSaMRt5fO6n8lQzyA.png"/></div></div></figure><p id="3b83" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">于是，我试着在一个运行API 28的仿真设备Nexus 6上运行同样的<em class="my">我的应用</em>，这是它的概要文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/6e95fb69f2203a228b4b162b0f92f878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EVaThbuENpR_JfLlOj-oA.png"/></div></div></figure><p id="72b4" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">详细地说:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/43c39dbbb15b4760d14903fc8000ab4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hS6-wmbTkJhstcGPvYzzMg.png"/></div></div></figure><p id="8662" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">所以，运行你的应用程序的Android设备确实会影响你的应用程序的性能，并且可能会给你一些像这样令人震惊的结果！</p><p id="481c" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">仿真设备的本机内存消耗为42MB，而Oppo Realme 2的本机内存消耗为283.5MB。非常明显的结论是，我不应该使用我的手机在Profiler中检查应用程序的性能。</p><p id="e193" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">这只是刚刚触及表面。在未来的一个故事中，我们将深入探索它的产品，以及我们如何利用它来构建美丽而高性能的应用程序。</p><p id="c1e1" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">那是给第八天的人的！我希望你能和我一起学习这个系列。让我知道你的想法，或者分享任何反馈，这样我才能给你带来更多的价值。明天见！</p></div></div>    
</body>
</html>