<html>
<head>
<title>Modeling Software Architecture With C4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用C4建模软件体系结构</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/modeling-software-architecture-with-c4-243eb1f240c7?source=collection_archive---------1-----------------------#2019-10-30">https://betterprogramming.pub/modeling-software-architecture-with-c4-243eb1f240c7?source=collection_archive---------1-----------------------#2019-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cb03" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习如何以生动和可用的方式描述软件架构</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d3b90ddec8041cb5bf0adbf85ebc530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpyPMzJWeeS2KBdPUUqiEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:https://c4model.com/</p></figure><p id="3452" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新概念用在现实生活的例子中更容易理解。我们将开发一个全新的工作板应用程序，同时，看看<a class="ae ky" href="https://c4model.com/" rel="noopener ugc nofollow" target="_blank"> C4 </a>如何帮助描述和定义架构。</p><p id="e6f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的应用程序被称为<em class="lv"> Instant </em>，因为它允许用户通过一个简单的移动应用程序在几秒钟内申请一份工作。我们有几个开发团队在做这个项目，并希望让它的架构尽可能地具有表现力，并让所有公司成员都能理解。</p><p id="a467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Instant会扰乱市场，我们希望每个人都明白它是如何工作的，以便他们能够向我们的客户解释。我们的应用程序正在快速发展，所以我们需要一些易于维护和低门槛的东西。</p><p id="87f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很难用每个人都能理解的方式来描述这个架构。有一些标准，如<a class="ae ky" href="https://www.uml.org/" rel="noopener ugc nofollow" target="_blank"> UML </a>或<a class="ae ky" href="https://www.archimatetool.com/" rel="noopener ugc nofollow" target="_blank"> ArchiMate </a>，但是它们有局限性，特别是当我们想从不同的角度来看我们的应用程序时。</p><p id="a301" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有技术背景的人，或者甚至是没有受过培训的程序员，看那些图时不会感到舒服，也不会理解符号。</p><p id="3d9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使所有的图表都是最新的，并且是由优秀的专家创建的，这在现实生活中是很少见的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/685e8502227f172563a0886134540043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thnKCQikAiJJxmbiXFE1mQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">UML图并不是让架构听起来更好的工具</p></figure><p id="7f75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们找到了一个有希望的替代品。C4是一个帮助我们从不同角度看待应用程序的模型。我们可以放大和缩小我们感兴趣的部分。</p><p id="ace6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像在谷歌地图上一样。变焦越大，我们能看到的细节就越多。C4使用了四种核心观点(我猜这就是这个名字的来源)。每一个都代表软件中不同的缩放级别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9048e76b85a946fcb11a4e70eb9d33de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_tE1lMe-B7d6L6JLRDUEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://c4model.com/" rel="noopener ugc nofollow" target="_blank">https://c4model.com/</a></p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="cdf2" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">一级。系统上下文图</h1><p id="872d" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我们从非常高的抽象层次开始。在这里，技术细节并不重要，我们关注的是软件的系统和用户。</p><p id="f617" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该系统是我们的应用程序中为客户带来价值的一个元素。该系统是一个完整的解决方案，可以独立使用。</p><p id="f22a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用软件的人<strong class="lb iu"> </strong>也包含在图表中。</p><p id="6170" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多方法可以创建C4图。我们可以使用一个叫做<a class="ae ky" href="https://structurizr.com/" rel="noopener ugc nofollow" target="_blank"> Structurizr </a>的工具，这个工具是由方法论的作者创建的，它允许手工绘制图表，或者用Java、C#或TypeScript编码。</p><p id="b62b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能是在单独的存储库中维护和版本化架构图的一个很好的方法。我们将使用<a class="ae ky" href="https://www.draw.io/" rel="noopener ugc nofollow" target="_blank"> Draw.io </a>和一个支持C4符号的自定义<a class="ae ky" href="https://github.com/tobiashochguertel/c4-draw.io" rel="noopener ugc nofollow" target="_blank">插件。</a></p><p id="60cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多不同的方法来模拟这样一个应用程序，但我们想把重点放在使用C4，而不是技术细节，所以它将被简化。</p><p id="64e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">求职者和招聘人员使用我们的应用程序。我们需要继续处理招聘人员支付的款项，并使用我们的ERP系统开具发票。我们的应用程序还使用外部邮件系统来发送用户通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/7d5af24878b432dd78836ca26aea2d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FB8THazLqD0yB0tvD2zzGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">很容易看到关键系统和我们一起工作的人</p></figure><p id="9658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在能够很容易地看到我们正在使用哪个系统，谁是我们的主要用户。现在让我们关注核心系统的更详细的元素。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="ea43" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">二级。集装箱图</h1><p id="afce" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">容器<strong class="lb iu"> </strong>是应用程序的<strong class="lb iu"> </strong>大部分，可以单独部署。例如，它可以是:数据库、微服务、移动应用、Docker容器。</p><p id="46d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们通过API(例如SOAP、gRPC、REST)相互通信，并且不直接依赖。在这个层面上，我们还对每个容器用来通信的协议和它使用的技术感兴趣。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/851a7547666315b90c641862fc739afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mcOnnh2sJbQk82w6ZrhCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的应用程序的构建块现在是可见的</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="5b7d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">三级。构件图</h1><p id="f375" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">组件<strong class="lb iu"> </strong>是一组一起工作的类或函数。我们能够观察到他们的关系和职责分工。</p><p id="2ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种低级的抽象对于程序员和架构师理解组件的细微差别和相互依赖性非常重要。在这个层面上，我们对所使用的解决方案和每个组件之间的通信方式有了更多的了解。</p><p id="4040" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的API服务是用MVC框架实现的PHP模块化整体。在这样的场景中，一个组件可以是一个单独的模块，也可以是一组内聚类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/6b51372cddc58d79227018030982b147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NR2uFN0RHMziPfxgaQJriw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们看到了API服务的技术栈和内部结构</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="db82" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">四级。密码</h1><p id="2d6d" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">代码是最底层的视角。代码可以是代码中的类或函数。这种观点可能只对公司的技术部门有兴趣。</p><p id="f67c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有必要将它包含在模型中，但有时会有所帮助。这种结构非常脆弱，随着时间的推移会发生很大变化。UML是在这个层次上描述关系的最常见的工具，如果我们想这么做的话，它会是一个很好的选择。</p><p id="2709" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们正在运营一家初创公司，并且不断地修改我们的代码库，所以我们不会在这个层面上对我们的应用程序进行建模。如果需要的话，这种低级图表也可以通过使用一些外部工具或IDE自动生成。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="756b" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="545d" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">C4是一个非常灵活的框架，可以根据我们的需要进行不同的使用。它有很多优点，但也有一些缺点。</p><h2 id="b473" class="ne mf it bd mg nf ng dn mk nh ni dp mo li nj nk mq lm nl nm ms lq nn no mu np bi translated">C4的优势</h2><ul class=""><li id="255b" class="nq nr it lb b lc mw lf mx li ns lm nt lq nu lu nv nw nx ny bi translated">不难维护(比大多数解决方案更容易)。</li><li id="afc8" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">从不同的角度展示观点。</li><li id="2381" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">在组织层面上可能是有帮助的(不仅仅是对技术人员)。</li><li id="fa59" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">删除不明确的符号。</li><li id="febb" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">有些零件可以自动生成。</li></ul><h2 id="2c38" class="ne mf it bd mg nf ng dn mk nh ni dp mo li nj nk mq lm nl nm ms lq nn no mu np bi translated">C4的缺点</h2><ul class=""><li id="4ba9" class="nq nr it lb b lc mw lf mx li ns lm nt lq nu lu nv nw nx ny bi translated">静态可视化。我们不知道每种关系发生的时间和频率。</li><li id="307e" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">低级抽象非常脆弱，需要定期更新。</li></ul></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="2518" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">资源</h1><ul class=""><li id="6f19" class="nq nr it lb b lc mw lf mx li ns lm nt lq nu lu nv nw nx ny bi translated"><a class="ae ky" href="https://c4model.com/" rel="noopener ugc nofollow" target="_blank"> C4官网</a></li><li id="74f6" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=x2-rSnhpw0g" rel="noopener ugc nofollow" target="_blank">“用C4模型可视化软件架构”，西蒙·布朗</a></li><li id="7706" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://www.structurizr.com/" rel="noopener ugc nofollow" target="_blank">结构化器</a></li><li id="59f3" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://github.com/tobiashochguertel/c4-draw.io" rel="noopener ugc nofollow" target="_blank"> Draw.io插件</a></li></ul></div></div>    
</body>
</html>