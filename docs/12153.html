<html>
<head>
<title>How to Visualize Soccer Data Using Mplsoccer in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中使用Mplsoccer可视化足球数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-visualize-soccer-data-using-mplsoccer-in-python-39e2eddfb7d9?source=collection_archive---------6-----------------------#2022-05-16">https://betterprogramming.pub/how-to-visualize-soccer-data-using-mplsoccer-in-python-39e2eddfb7d9?source=collection_archive---------6-----------------------#2022-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f03e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">每个人的足球分析。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2f7a95b026d6aac5475d06fc0a4a158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s2dutTqWVatnKpgf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@jesusance?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">托马斯·塞勒</a>在<a class="ae ky" href="https://unsplash.com/s/photos/football?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="fe1c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="5554" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">近年来，足球分析已经成为一种趋势。许多足球俱乐部开始招募数据科学家加入他们的团队。甚至BBC还创造了一个标题，数据专家是足球界最好的引援[1]。</p><p id="f36a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于高需求和曝光率，人们开始进入足球分析。有很多开源工具和数据可以用来开始这个领域的工作。Mplsoccer是创建足球数据可视化的工具之一[2]。</p><p id="4404" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将向您展示如何通过使用像<code class="fe ms mt mu mv b">mplsoccer</code>和<code class="fe ms mt mu mv b">matplotlib</code>这样的库来实现这些可视化。事不宜迟，我们开始吧！</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="c9e8" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">履行</h1><h2 id="ac51" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">关于图书馆</h2><p id="23ad" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Mplsoccer是一个基于Python的可视化足球图表库。在Python中可视化足球数据并不像可视化散点图或直方图那样简单。</p><p id="68da" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">多亏了这个库，我们可以根据现有数据展示任何足球图表。我们可以使用mplsoccer创建一些可视化效果，如雷达图、热图、射击图等等，这个库可以帮助你直接生成可视化效果。</p><p id="4cae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，这个库可以帮助加载StatsBomb数据。对于本文，我们将不使用加载StatsBomb数据的函数，我们将尝试从头开始加载数据。</p><p id="efed" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要安装库，很简单。您所需要的只是一个如下所示的pip命令:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="449f" class="ni la it mv b gy ny nz l oa ob">! pip install mplsoccer</span></pre><p id="a215" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">运行该命令后，您可以使用该库来可视化足球数据。</p><h2 id="35e9" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">加载数据</h2><p id="aef1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">但是在我们能够可视化数据之前，我们需要首先访问我们的数据。在本文中，我们将使用来自StatsBomb的数据，您可以通过StatsBomb的GitHub存储库<a class="ae ky" href="https://github.com/statsbomb/open-data" rel="noopener ugc nofollow" target="_blank">访问这些数据。</a></p><p id="d290" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与其他数据集不同，使用和访问足球数据，尤其是StatsBomb，是一项具有挑战性的工作。</p><p id="d65f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们需要采取三个步骤。这些步骤是查看比赛ID、比赛ID，最后加载混乱的JSON文件。所以让我们开始吧。</p><p id="604f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们需要获得2005年利物浦和AC米兰之间的欧洲冠军联赛决赛的赛事数据。</p><p id="0c58" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是因为events文件夹包含许多文件，并且他们使用ID来命名它，所以我们需要首先打开competitions.json文件。</p><p id="17ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将数据作为数据框打开，并过滤包含冠军联赛作为其比赛名称的数据。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="9465" class="ni la it mv b gy ny nz l oa ob">import pandas as pd</span><span id="7505" class="ni la it mv b gy oc nz l oa ob">competitions = pd.read_json('open-data/data/competitions.json')<br/>competitions[competitions.competition_name == 'Champions League']</span></pre><p id="6d99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是数据框的预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/ab24fdcfca294f5d7f101aa176555bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Hq_alBZlxyz6YBK"/></div></div></figure><p id="d308" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如您从数据框中看到的，有比赛何时举行以及赛季和比赛的相应ID等信息。利物浦和AC米兰的比赛发生在2005年。所以我们取比赛ID 16，赛季ID 37。</p><p id="8ea3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为比赛包含大量的比赛，我们需要查看相应比赛的比赛ID。为此，您可以运行以下代码行:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="a623" class="ni la it mv b gy ny nz l oa ob">import json</span><span id="320e" class="ni la it mv b gy oc nz l oa ob">with open('open-data/data/matches/16/37.json') as f:<br/>   data = json.load(f)<br/>   for i in data:<br/>      print(i['match_id'], i['home_team']['home_team_name'],     <br/>      i['home_score'], "-", i['away_score'], i['away_team'] <br/>      ['away_team_name'])</span></pre><p id="93a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从该代码中，我们只检索到StatsBomb提供的一个匹配，这是最终的匹配。匹配的对应ID是23202764。有了这个ID，我们就可以访问事件数据来分析游戏。</p><p id="323e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所知，像competition.json文件一样，事件数据也使用json格式，并且它包含一个嵌套表单。</p><p id="8dc9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">起初，加载像dataframe这样的文件似乎很有挑战性。但是我们不用担心，因为熊猫图书馆提供了一个名为<code class="fe ms mt mu mv b">json_normalize</code>的函数。</p><p id="5795" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="cf7d" class="ni la it mv b gy ny nz l oa ob">with open('open-data/data/events/2302764.json') as f:<br/>   data = json.load(f)<br/>   df = pd.json_normalize(data, sep="_")<br/>   df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/66f4a6bc0fe0e166eee912828cc6f1fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8IWQfpq57aCqwyct_MxTtw.png"/></div></div></figure><p id="94bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从这个数据框架，现在我们可以创建任何我们喜欢的可视化。为了方便起见，我们把数据分成前半部分和后半部分。让我们开始吧。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="36dc" class="ni la it mv b gy ny nz l oa ob">first_half = df.loc[:1808, :]<br/>second_half = df.loc[1809:3551, :]</span></pre><h1 id="9941" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拍摄地图</h1><p id="de5c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">获得数据后，让我们从中创建一些可视化。我想给你们看的第一个可视化图像是拍摄地图。但在此之前，让我们先看看如何创造音高。</p><p id="6235" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可视化球场是可视化足球数据的重要步骤。在<code class="fe ms mt mu mv b">mplsoccer</code>出现之前，人们创建了他们的足球图表，我知道这很有挑战性，因为我们必须自己绘制线条。</p><p id="e4d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，在<code class="fe ms mt mu mv b">mplsoccer</code>库出现之前，可视化足球数据并不适合所有人。为了直观地展示这一点，我们只需添加以下几行代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="721e" class="ni la it mv b gy ny nz l oa ob">from mplsoccer import Pitch</span><span id="541d" class="ni la it mv b gy oc nz l oa ob">pitch = Pitch(pitch_type='statsbomb')<br/>pitch.draw()</span></pre><p id="db24" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是结果预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/83a7673038ab1fcfb39b527288752759.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/0*OPuJtksx2zWcgxDo"/></div></figure><p id="d3d9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们不必添加线条或指定间距的长度。你所需要的只是一个物体，然后嘣，你就有了它。</p><p id="7e40" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为我们想要可视化射门图，所以我们需要一个半垂直的足球场。要创建它，您需要做的就是像这样修改前面的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="537d" class="ni la it mv b gy ny nz l oa ob">from mplsoccer import VerticalPitch</span><span id="ce8b" class="ni la it mv b gy oc nz l oa ob">pitch = VerticalPitch(pitch_type='statsbomb', half=True)</span></pre><p id="ef61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是结果预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/550ca18bbff85dc2af67a0983f64c586.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/0*UaqWS2Sfc-wZ_KvU"/></div></figure><p id="cfd3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这不是很简单吗？！现在让我们创建拍摄地图。</p><p id="c004" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在创建可视化之前，我们需要准备包含射门本身信息的数据，包括射门位置、哪个队射门、谁射门以及进球的可能性。</p><p id="e5a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们准备一个包含AC米兰上半场镜头的数据框架。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="8043" class="ni la it mv b gy ny nz l oa ob"><strong class="mv iu"># Retrieve rows that record shots</strong><br/>shots = first_half[first_half.type_name == 'Shot']</span><span id="1f74" class="ni la it mv b gy oc nz l oa ob"><strong class="mv iu"># Filter the data that record AC Milan</strong><br/>shots = shots[shots.team_name == 'AC Milan']</span><span id="c464" class="ni la it mv b gy oc nz l oa ob"><strong class="mv iu"># Select the columns</strong><br/>shots = shots[['team_name', 'player_name', 'minute', 'second', 'location', 'shot_statsbomb_xg', 'shot_outcome_name']]</span><span id="fc37" class="ni la it mv b gy oc nz l oa ob"><strong class="mv iu"># Because the location data is on list format (ex: [100, 80]), we extract the x and y coordinate using apply method.</strong><br/>shots['x'] = shots.location.apply(lambda x: x[0])<br/>shots['y'] = shots.location.apply(lambda x: x[1])<br/>shots = shots.drop('location', axis=1)</span><span id="ab6d" class="ni la it mv b gy oc nz l oa ob"><strong class="mv iu"># Divide the dataset based on the outcome</strong><br/>goals = shots[shots.shot_outcome_name == 'Goal']<br/>shots = shots[shots.shot_outcome_name != 'Goal']</span><span id="fe5a" class="ni la it mv b gy oc nz l oa ob">shots.head()</span></pre><p id="63e7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是数据预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/ad95f0dc4cc060c8e8f91cdae6ed0651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GrdzbHgJ9x_tM5Y_"/></div></div></figure><p id="fc04" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有了数据之后，下一步是创建可视化。让我们先建一个摊位。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="4d80" class="ni la it mv b gy ny nz l oa ob">from mplsoccer import VerticalPitch</span><span id="43bc" class="ni la it mv b gy oc nz l oa ob">pitch = VerticalPitch(pitch_type='statsbomb', half=True, goal_type='box', goal_alpha=0.8, pitch_color='#22312b', line_color='#c7d5cc')</span><span id="105e" class="ni la it mv b gy oc nz l oa ob">fig, axs = pitch.grid(figheight=10, title_height=0.08, endnote_space=0, axis=False,title_space=0, grid_height=0.82, endnote_height=0.05)</span><span id="2569" class="ni la it mv b gy oc nz l oa ob">fig.set_facecolor("#22312b")</span></pre><p id="d694" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">之后，我们来添加拍摄点。在下面添加这些代码行:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="4ce0" class="ni la it mv b gy ny nz l oa ob">scatter_shots = pitch.scatter(shots.x, shots.y, s=(shots.shot_statsbomb_xg * 900) + 100, c='red', edgecolors='black', marker='o', ax=axs['pitch'])</span><span id="8e62" class="ni la it mv b gy oc nz l oa ob">scatter_goals = pitch.scatter(goals.x, goals.y, s=(goals.shot_statsbomb_xg * 900) + 100, c='red', edgecolors='black', marker='*', ax=axs['pitch'])</span></pre><p id="aa2c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">添加完这些点之后，让我们添加描述可视化本身的文本。在下面添加这些代码行:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="c9f2" class="ni la it mv b gy ny nz l oa ob">axs['endnote'].text(0.85, 0.5, '[YOUR NAME]', color='#c7d5cc', va='center', ha='center', fontsize=15)</span><span id="a257" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.7, 'The Shots Map from AC Milan', color='#c7d5cc', va='center', ha='center', fontsize=30)</span><span id="e616" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.25, 'The Game\'s First Half', color='#c7d5cc', va='center', ha='center', fontsize=18)</span></pre><p id="d8c4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们需要添加一个箭头来清除正在发生的比赛的攻击方向。在下面添加这些代码行:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="c90e" class="ni la it mv b gy ny nz l oa ob">pitch.arrows(70, 5, 100, 5, ax=axs['pitch'], color='#c7d5cc')</span></pre><p id="2978" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">完整的代码如下所示:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="2c40" class="ni la it mv b gy ny nz l oa ob">from mplsoccer import VerticalPitch</span><span id="6840" class="ni la it mv b gy oc nz l oa ob">pitch = VerticalPitch(pitch_type='statsbomb', half=True, goal_type='box', goal_alpha=0.8, pitch_color='#22312b', line_color='#c7d5cc')</span><span id="681f" class="ni la it mv b gy oc nz l oa ob">fig, axs = pitch.grid(figheight=10, title_height=0.08, endnote_space=0, axis=False, title_space=0, grid_height=0.82, endnote_height=0.05)</span><span id="9dd8" class="ni la it mv b gy oc nz l oa ob">fig.set_facecolor("#22312b")</span><span id="6504" class="ni la it mv b gy oc nz l oa ob">scatter_shots = pitch.scatter(shots.x, shots.y, s=(shots.shot_statsbomb_xg * 900) + 100, c='red', edgecolors='black', marker='o', ax=axs['pitch'])</span><span id="8cdd" class="ni la it mv b gy oc nz l oa ob">scatter_goals = pitch.scatter(goals.x, goals.y, s=(goals.shot_statsbomb_xg * 900) + 100, c='red', edgecolors='black', marker='*', ax=axs['pitch'])</span><span id="5d8e" class="ni la it mv b gy oc nz l oa ob">pitch.arrows(70, 5, 100, 5, ax=axs['pitch'], color='#c7d5cc')</span><span id="8610" class="ni la it mv b gy oc nz l oa ob">axs['endnote'].text(0.85, 0.5, '[YOUR NAME]', color='#c7d5cc', va='center', ha='center', fontsize=15)</span><span id="8c83" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.7, 'The Shots Map from AC Milan', color='#c7d5cc', va='center', ha='center', fontsize=30)</span><span id="7a50" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.25, 'The Game\'s First Half', color='#c7d5cc', va='center', ha='center', fontsize=18)</span><span id="e84e" class="ni la it mv b gy oc nz l oa ob">plt.show()</span></pre><p id="a805" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最终，照片的可视化效果将会是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/9365473fc11bea6cb8e029ebe5d62335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LL-ngQpIxvvh0Zno"/></div></div></figure><h2 id="904d" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">压力热图</h2><p id="c5bc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我想给你们看的第二个图像是压力热图。该热图表示一个位置的压力频率。压力越大，该位置的颜色越亮。</p><p id="4b08" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">生成热图与创建前一张拍摄图是一样的。唯一的不同是我们在球场上想象一个统计总结。但在此之前，我们首先准备数据。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="7855" class="ni la it mv b gy ny nz l oa ob">pressure = first_half[df.type_name == 'Pressure']<br/>pressure = pressure[['team_name', 'player_name', 'location']]<br/>pressure = pressure[pressure.team_name == 'AC Milan']</span><span id="74d0" class="ni la it mv b gy oc nz l oa ob">pressure['x'] = pressure.location.apply(lambda x: x[0])<br/>pressure['y'] = pressure.location.apply(lambda x: x[1])<br/>pressure = pressure.drop('location', axis=1)</span><span id="3811" class="ni la it mv b gy oc nz l oa ob">pressure.head()</span></pre><p id="b9bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是数据预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3e22bcb7b9af31b357c161dd3f60fd0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/0*AjKVr7zS_8RR1vgI"/></div></figure><p id="273b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们创建图表。代码如下所示:</p><pre class="kj kk kl km gt nu mv nv nw aw nx bi"><span id="40a3" class="ni la it mv b gy ny nz l oa ob">from scipy.ndimage import gaussian_filter<br/>import matplotlib.pyplot as plt</span><span id="2697" class="ni la it mv b gy oc nz l oa ob">pitch = Pitch(pitch_type='statsbomb', line_zorder=2, pitch_color='#22312b', line_color='#efefef')</span><span id="e6bb" class="ni la it mv b gy oc nz l oa ob">fig, axs = pitch.grid(figheight=10, title_height=0.08, endnote_space=0, axis=False, title_space=0, grid_height=0.82, endnote_height=0.05)</span><span id="e92a" class="ni la it mv b gy oc nz l oa ob">fig.set_facecolor('#22312b')</span><span id="3d22" class="ni la it mv b gy oc nz l oa ob">bin_statistic = pitch.bin_statistic(pressure.x, pressure.y, statistic='count', bins=(25, 25)) </span><span id="5fcf" class="ni la it mv b gy oc nz l oa ob">bin_statistic['statistic'] = gaussian_filter(bin_statistic['statistic'], 1)</span><span id="d759" class="ni la it mv b gy oc nz l oa ob">pcm = pitch.heatmap(bin_statistic, ax=axs['pitch'], cmap='hot', edgecolors='#22312b')</span><span id="42b4" class="ni la it mv b gy oc nz l oa ob">cbar = fig.colorbar(pcm, ax=axs['pitch'], shrink=0.6)</span><span id="cde8" class="ni la it mv b gy oc nz l oa ob">cbar.outline.set_edgecolor('#efefef')</span><span id="f940" class="ni la it mv b gy oc nz l oa ob">cbar.ax.yaxis.set_tick_params(color='#efefef')</span><span id="46fd" class="ni la it mv b gy oc nz l oa ob">plt.setp(plt.getp(cbar.ax.axes, 'yticklabels'), color='#efefef')</span><span id="47b5" class="ni la it mv b gy oc nz l oa ob">axs['endnote'].text(0.8, 0.5, '[YOUR NAME]', color='#c7d5cc', va='center', ha='center', fontsize=10)</span><span id="542d" class="ni la it mv b gy oc nz l oa ob">axs['endnote'].text(0.4, 0.95, 'Attacking Direction', va='center', ha='center', color='#c7d5cc', fontsize=12)</span><span id="b9c5" class="ni la it mv b gy oc nz l oa ob">axs['endnote'].arrow(0.3, 0.6, 0.2, 0, head_width=0.2, head_length=0.025, ec='w', fc='w')</span><span id="72c0" class="ni la it mv b gy oc nz l oa ob">axs['endnote'].set_xlim(0, 1)<br/>axs['endnote'].set_ylim(0, 1)</span><span id="03f3" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.7, 'The Pressure\'s Heat Map from AC Milan', color='#c7d5cc', va='center', ha='center', fontsize=30)</span><span id="b124" class="ni la it mv b gy oc nz l oa ob">axs['title'].text(0.5, 0.25, 'The Game\'s First Half', color='#c7d5cc', va='center', ha='center', fontsize=18)</span></pre><p id="a529" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你能看出这段代码和前一段代码的区别吗？几乎没有！</p><p id="0055" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除此之外，我们在前半部分增加了gaussian_filter函数来生成AC Milan的压力分布。根据结果，我们使用它创建热图。</p><p id="941d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是可视化的最终结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/77a2933df98c2f90fc5f96774a298dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O7rgNKSxnYkgTIin"/></div></div></figure><h1 id="d207" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结束语</h1><p id="7b19" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！您已经学习了如何使用Python中的<code class="fe ms mt mu mv b">mplsoccer</code>创建足球数据的可视化。</p><p id="691b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望你能从这里学到新的东西，并指导你分析比赛，尤其是在StatsBomb数据上。你可以通过这个网站<a class="ae ky" href="https://mplsoccer.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>了解<code class="fe ms mt mu mv b">mplsoccer</code>图书馆。</p><p id="238a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p><h2 id="0022" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">参考</h2><p id="2167" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]英国广播公司。数据专家正在成为足球界最好的签约。https://www.bbc.com/news/business-56164159<br/>【2】mpl soccer文档。<a class="ae ky" href="https://mplsoccer.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">https://mplsoccer.readthedocs.io/en/latest/index.html</a></p></div></div>    
</body>
</html>