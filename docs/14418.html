<html>
<head>
<title>Build a Python Package to Convert Audiobook “.aax” Files Into “mp3”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Python包来转换有声读物”。aax "文件转换成" mp3 "</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-python-package-to-convert-aax-files-into-mp3-f72201aba6b0?source=collection_archive---------7-----------------------#2022-12-12">https://betterprogramming.pub/build-a-python-package-to-convert-aax-files-into-mp3-f72201aba6b0?source=collection_archive---------7-----------------------#2022-12-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="20d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Garmin设备上播放声音</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/32e89e4db048c33cfca091c674b4df0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PF1k2Go4FBi7yKZ-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚瑟·辛顿在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="a413" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">问题</h1><p id="7d3e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你做好长距离跑的准备，打开你的训练计划，离开房间，然后意识到没有手机你无法听那本伟大的有声读物。</p><p id="5692" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这篇文章是写给你的，如果你和我一样，购买了一个Garmin来减少你在训练时必须携带的东西的数量(卡片、音乐、追踪器)，但发现自己在整个训练过程中都带着一个稍微更便于携带的平板电脑。更令人恼火的是，Spotify有一个功能完善的界面，可以流畅地处理DDRM的内容——那么，最近怎么样，Audible？</p><h1 id="cad1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">解决办法</h1><p id="c730" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在尝试了所有其他方法后，似乎最好的解决方案是下载每本书，将其转换为mp3格式，然后拖放到您的设备/手表上。</p><p id="2588" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将讨论这一过程。如果您有兴趣直接使用该脚本，请滚动到页面末尾。</p><h1 id="cc0e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.下载您的有声读物</h1><p id="1980" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们从获得一份有声读物开始。这是通过导航到<a class="ae ky" href="https://www.audible.co.uk/library" rel="noopener ugc nofollow" target="_blank">https://www.audible.co.uk/library</a>，登录，并选择我们想要保存的书籍。</p><p id="7054" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意:</strong>您只能下载用您的点数购买的图书。</p><p id="1ac6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们找到我们的书籍，我们将选择下载按钮，然后是“完整”选项。然后，我们将下载移动到一个组文件夹中，并记下它的位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/68562caecc99c718ee1fa3386a04ee1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*iEPvlSYZmIMG0TqUUxiX3A.png"/></div></figure><h1 id="f3d9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.获取激活字节</h1><p id="5588" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要解码我们的有声读物，我们需要一个激活密钥。这是一组20长的二进制字符，由有声读物文件校验和的653个元素编码而成。</p><p id="bf7d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然我们可以手动完成，但最简单的方法是使用在<a class="ae ky" href="https://audible-converter.ml/" rel="noopener ugc nofollow" target="_blank">https://audible-converter.ml/</a>举办的精彩脚本来帮助我们。</p><h1 id="3d6b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.安装我们的依赖项</h1><p id="6ecf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们有了校验和值，我们安装“FFmpeg”，它将转换我们的音频文件。如果您打算在最后使用脚本，我们可以安装可选的依赖项。</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="ce18" class="mz la it mv b be na nb l nc nd">conda install -c conda-forge js2py selenium webdriver_manager</span></pre><p id="a1b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意</strong>:我们不想用anaconda安装<code class="fe ne nf ng mv b">FFmpeg</code>，因为它会引起问题。如果您已经这样做了，您必须手动将其从conda <code class="fe ne nf ng mv b">bin</code>文件夹中删除。</p><p id="ed62" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">相反，我们可以使用<code class="fe ne nf ng mv b">brew</code>在Mac上安装我们的视频处理脚本，命令如下:</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="6297" class="mz la it mv b be na nb l nc nd">brew install ffmpeg</span></pre><p id="6cda" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在Linux上，您可以选择以下选项:</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="e1de" class="mz la it mv b be na nb l nc nd">sudo apt install ffmpeg</span></pre><h1 id="3e30" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.列出我们有声读物的章节</h1><p id="dec4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们已经安装了所有的东西，我们可以通过列出不同的章节来测试<code class="fe ne nf ng mv b">FFmpeg</code>。</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="7f87" class="mz la it mv b be na nb l nc nd">ffprobe -i &lt;your file path here&gt; -print_format json -show_chapters -loglevel error</span></pre><p id="7d3d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这将返回一个JSON对象，其中包含“chapters”键的值。</p><h1 id="83ef" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.另存为MP3</h1><p id="2504" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，我们可以将FFmpeg、我们的激活字节和有声读物结合起来得到一个输出。</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="1b01" class="mz la it mv b be na nb l nc nd">ffmpeg -activation_bytes &lt;our-activation-bytes&gt; -i &lt;input/file/path&gt; -codec copy &lt;output file&gt;.m4b -y -loglevel quiet -stats</span></pre><p id="75dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在大型有声读物的情况下，我们可能想把它们分成更容易管理的部分。为此，我们可以使用以下标志指定开始和结束时间:</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="ccbd" class="mz la it mv b be na nb l nc nd">-ss &lt;start-time&gt; -to &lt;end-time&gt;</span></pre><p id="e6a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中时间以<code class="fe ne nf ng mv b">HHMMSS</code>格式给出。</p><h1 id="0524" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">把所有的放在一起</h1><p id="cc5d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，为了把它放在一起，我已经编译了一个Python脚本来处理这个过程。该脚本的主要格式如下:</p><ul class=""><li id="7557" class="nh ni it lt b lu mn lx mo ma nj me nk mi nl mm nm nn no np bi translated">从给定的目录中读取所有的<code class="fe ne nf ng mv b">.aax</code>文件</li><li id="e8f8" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">从第一个文件中提取激活字节。如果所有文件都来自同一个帐户，激活字节应该保持不变。否则，请使用单独的目录</li><li id="e2f3" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">对于每个文件，获取章节信息，包括开始和结束时间。</li><li id="c988" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">我们在默认位置<code class="fe ne nf ng mv b">~/Music</code>创建一个有声读物名称的文件。这是你的<code class="fe ne nf ng mv b">$HOME</code>目录，如果你没有“音乐”文件夹，请创建一个。</li><li id="758d" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">对于每一章，我们创建一个新的(带标签的)MP3文件。</li><li id="703b" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">这些都是并行完成的，以节省计算时间。</li></ul><p id="dae6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个脚本可以在这里的<a class="ae ky" href="https://github.com/wolfiex/AudiableConvert" rel="noopener ugc nofollow" target="_blank">中找到</a>，并通过运行这个命令来启动</p><pre class="kj kk kl km gt mu mv mw bn mx my bi"><span id="669c" class="mz la it mv b be na nb l nc nd">python -m AudiableConvert '/abspath/to/audiablebookdirectory/'</span></pre><p id="f521" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在您选择的终端模拟器中。这将在存储库中完成。</p><p id="ef41" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，一边跑一边享受你的有声读物吧！</p></div></div>    
</body>
</html>