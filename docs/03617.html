<html>
<head>
<title>The Elvis Operator in Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">科特林的猫王接线员</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/elvis-operator-in-kotlin-if-null-then-use-this-instead-e4989677a9b1?source=collection_archive---------3-----------------------#2020-02-22">https://betterprogramming.pub/elvis-operator-in-kotlin-if-null-then-use-this-instead-e4989677a9b1?source=collection_archive---------3-----------------------#2020-02-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a1f2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果为空，则使用以下代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ec15502f9fada59298264ac4aa06eb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bml22qoaJD_ooCK_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Shane Hauser 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="ea95" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">介绍</h1><p id="357b" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">“我想使用那个值，但是如果它是null，那么我可以使用这个非null值来代替。”</p><p id="24c7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">很多时候，我们在编写应用程序时都会面临上述情况。这可能是我们的应用程序代码中最常见的情况之一。</p><p id="ff87" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">不同的编程语言提供了不同的方法，但是今天，我们来看看Kotlin是如何做到的。</p><p id="bb60" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">向猫王接线员问好！它被表示为<code class="fe mz na nb nc b">?:</code>。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="9336" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">何时使用Elvis操作员</h1><p id="1a3f" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">使用Elvis操作符的时机是当我们期望一个可空值并且需要处理它以避免著名的<code class="fe mz na nb nc b">NullPointerException</code>时。</p><p id="4065" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">一些使用案例包括:</p><ul class=""><li id="763c" class="nd ne it ma b mb mu me mv mh nf ml ng mp nh mt ni nj nk nl bi translated">通过主键从数据库中查询某些东西，可能不会返回任何记录。</li><li id="7052" class="nd ne it ma b mb nm me nn mh no ml np mp nq mt ni nj nk nl bi translated">从一个对象映射到另一个对象，其中一个或多个字段可能为空。</li></ul></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="e122" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">如何使用Elvis操作员</h1><p id="e89a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">使用Elvis操作符的语法非常简单明了。</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="f4f7" class="nv lh it nc b gy nw nx l ny nz">val result = x ?: y</span></pre><p id="37e4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这基本上就是说如果值不是<code class="fe mz na nb nc b">null</code>就用<code class="fe mz na nb nc b">x</code>，否则就用<code class="fe mz na nb nc b">y</code>。Elvis运算符右侧的表达式或本例中的<code class="fe mz na nb nc b">y</code>，仅在<code class="fe mz na nb nc b">x</code>为<code class="fe mz na nb nc b">null</code>的情况下计算。</p><p id="44fc" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">y</code>可以是一个值，<code class="fe mz na nb nc b">return</code>可以是一个表达式，<code class="fe mz na nb nc b">throw</code>可以是一个表达式。</p><p id="eda4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们来看几个例子。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="0192" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">查询可能不返回记录的表</h1><p id="ec97" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">下面是一个函数，它基于主键<code class="fe mz na nb nc b">customerId</code>对<a class="ae ky" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a>表执行<code class="fe mz na nb nc b">GetItem</code>操作，并返回其项目的地图(如果存在的话)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="f321" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">然后，我们希望获得客户的电子邮件，如果它不存在，我们希望我们的应用程序抛出一个<code class="fe mz na nb nc b">Exception</code>。</p><p id="9650" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这就是我们使用Elvis操作符的方式。</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="af73" class="nv lh it nc b gy nw nx l ny nz">val email = getCustomerInfo("123")?.get("emailAddress")?.s() ?: throw IllegalArgumentException("email should exist")</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="e18f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">为可空字段提供默认值</h1><p id="197b" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在某些情况下，我们需要将一个对象的值赋给另一个对象。假设我们将下面的<code class="fe mz na nb nc b">dataclass</code>命名为<code class="fe mz na nb nc b">Address</code>。</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="c68a" class="nv lh it nc b gy nw nx l ny nz">data class Address(val streetNumber: Int, val streetAddress: String, val streetSuffix: String?)</span></pre><p id="c32a" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们有一个简单的函数来返回完整的级联地址，如下所示。</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="72c8" class="nv lh it nc b gy nw nx l ny nz">fun returnFullAddress(address: Address): String {<br/>    val fullAddress = address.streetNumber.toString() + " " + address.streetAddress + " " + (address.streetSuffix ?: "")<br/>    return fullAddress.<em class="oc">trim</em>()<br/>}</span></pre><p id="16a2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">然后，我们可以像这样使用它来处理可空的<code class="fe mz na nb nc b">streetSuffix</code>字段。</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="2f49" class="nv lh it nc b gy nw nx l ny nz">val address = Address(12, "John Drive", null)<br/><br/>returnFullAddress(address)</span><span id="547f" class="nv lh it nc b gy od nx l ny nz">// 12 John Drive</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="1469" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">链式猫王操作员</h1><p id="9036" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我们也可以锁住猫王操作员。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="e4a4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">记住Elvis操作符只会在左边的表达式是<code class="fe mz na nb nc b">null</code>的时候对右边的表达式求值(或者我们称之为右操作数)。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="6af1" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">包裹</h1><p id="5c20" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">当您希望得到一个<code class="fe mz na nb nc b">null</code>值并希望很好地处理它时，Elvis操作符非常方便。</p><p id="25b8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">希望这篇简短的教程能让您了解何时以及如何使用这个操作符。</p></div></div>    
</body>
</html>