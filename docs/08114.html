<html>
<head>
<title>Predict Cryptocurrency Price With Cubic Splines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用三次样条预测加密货币价格</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/predict-cryptocurrency-price-with-cubic-splines-275d109b9d65?source=collection_archive---------0-----------------------#2021-03-27">https://betterprogramming.pub/predict-cryptocurrency-price-with-cubic-splines-275d109b9d65?source=collection_archive---------0-----------------------#2021-03-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0817" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">分段插值实用指南。Litecoin价格预测的实用Python代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f57db7b0ee770011d428e39bbdaf34c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCViBzgDOy13L4LLwclFxQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@thisisengineering" rel="noopener ugc nofollow" target="_blank"> ThisisEngineering RAEng </a></p></figure><p id="95a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该实用指南提供了预测加密货币价格所需的基础知识。</p><p id="e126" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">15年前，我开始探索数字货币的世界，并开发了一个仅使用短信的点对点移动货币平台。</p><p id="8968" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我的一位合作者问我，人工智能是否可以预测加密货币的价格。她对围绕区块链的大肆宣传感到好奇。</p><p id="dc40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过一些研究，我发现预测加密货币价格是一个可解决的问题，但肯定不是所有的市场条件。</p><p id="9c13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加密资产的典型预测模型将利用时间序列预测(例如，ARIMA、<a class="ae ky" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书预言家</a>)、机器学习(例如，随机森林、线性回归)或深度学习方法(例如，LSTM)。</p><p id="c422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我研究了分段插值在预测给定日期<a class="ae ky" href="https://litecoin.com/en/" rel="noopener ugc nofollow" target="_blank">莱特币</a>的平均价格时的表现。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="771a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">数据</h1><p id="52ce" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将关注2013年4月至2021年2月莱特币的历史价格。该数据取自<a class="ae ky" href="https://coinmarketcap.com/" rel="noopener ugc nofollow" target="_blank"> coinmarketcap </a>并且<a class="ae ky" href="https://coinmarketcap.com/faq/" rel="noopener ugc nofollow" target="_blank">可以免费使用</a>。我把数据分成80%的训练数据集和20%的测试数据集。后者用于评估我们预测收盘价的准确度。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/5561e02449a9b4626d7293f0ec83ff78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fB-6-5kftyLEu0H8NX-ThQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加密货币莱特币的价格历史(来源:<a class="ae ky" href="https://www.kaggle.com/sudalairajkumar/cryptocurrencypricehistory" rel="noopener ugc nofollow" target="_blank"> Kaggle </a></p></figure><p id="eb45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个简短的探索性数据分析显示了平均收盘价如何在年初和年末最高。10月份最低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/35dfe873e31f49bd701debc54371ffb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*Cz6wB2n0d--Od2g8Mq7Z-Q.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6848" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">多项式回归</h1><p id="e097" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可能听说过多项式回归，这可以说是创建一个阶为<em class="nb"> d </em>的基来逼近一个非线性函数(在我们的例子中是加密货币价格波动)的最简单的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a6e408442fc6d07c8ff7b5eb09f91b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*ueYcc9KETufR1fFvq4Y0vw.png"/></div></figure><p id="c48f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用5、25和80阶多项式对莱特币的历史价格进行了简单的多项式回归。在每种情况下，R2分数将给出关于模型在测试数据集上的拟合优度的一些信息。</p><p id="7bc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">观察下面拟合训练数据的蓝线，我们可以观察到曲线随着多项式阶数的增加而增加。这是因为高阶多项式试图追踪训练集中的每个单个数据点，从而增加了模型的复杂性。</p><p id="d052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第0天表示2013年4月30日，第2，800天表示2021年2月28日。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/5c56e9414374601e54ccf5cc390b0044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_b2OQ32GnU0K6XMgFyhmng.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/541e99853ee4f8fdd2cc4b9df17dca19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Y0rlbQmDuA4ndRHSxOjCA.png"/></div></div></figure><p id="91e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尤其是在有异常值的区域(图的中间部分)，更高次的多项式倾向于向那些异常值的方向发展。因此，具有80阶多项式的模型具有最高的方差。</p><p id="db24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与低阶多项式相比，它对训练数据的偏差最小，这体现在最高的R2分数上，低阶多项式具有较低的R2，这意味着较高的偏差但较低的方差。低阶多项式对训练数据不太敏感。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/1f6ad5504721bc180169c27d3172f6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nGOSqGSKyPdLijGy4bR52Q.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="bb23" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">分段插值</h1><p id="59a8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我发现一种更灵活的方法是使用分段多项式来预测加密价格。</p><p id="4980" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分段插值用低次多项式拟合大量数据点。由于我们只使用低次多项式，我们消除了过度的振荡和不收敛。</p><p id="3102" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定一组数据点，分段插值通过在数据的每个部分使用不同的多项式来工作。</p><p id="abda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别地，我们使用连接的分段多项式，也称为<em class="nb">样条</em>。</p><p id="a7f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">样条的一个例子是下面的截断线性函数。它位于4的左侧，称为函数的<em class="nb">结</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/d78fdc16f5e79dd8a070e941cf9c52c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ovnu_1YY0OtXZzEtFKFwtQ.png"/></div></div></figure><p id="3695" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定几个节点，我们可以组合多个线性基函数，并将它们拟合到非线性数据中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/a511f78dee7098cd8ccbe93b07403d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUf_Mm0DyN1Su7CdLT_rtA.png"/></div></div></figure><p id="3b1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了检测加密货币价格中存在的高度弯曲的关系，我使用了截断的三次函数，也称为<em class="nb">三次样条</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/2559637832a3ee1bf45a8e1051bce7f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F9nLfaeIijGxwXJgDPoJCQ.png"/></div></div></figure><p id="18c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用三次样条，我们将数据分成块，并为每个块拟合一个三次样条。每个样条函数都在节点处与下一个相连。</p><p id="0f7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">三次样条是加密货币价格变化的一个非常好的选择，因为连接是平滑的。三次样条及其一阶和二阶导数的斜率都匹配。三次样条是3阶多项式函数，仍然足够小以避免可变性。</p><p id="9ddd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nb">三次B样条</em>是用于高效计算的三次样条的一种更简单的变体，因为最多有五个基函数参与插值。我们可以看到在四分点上放置结后，三次B样条如何在下面的莱特币价格上表现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/d398fd4374e779c36132ab3e0f122f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M7SpMLFpv0zICeLViLec5Q.png"/></div></div></figure><p id="31c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过手动选择结，即，当我们有一堆数据点时，与基于四分位数放置结时的分数相比，我们在测试数据集上实现了更好的R2。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/00b507f8fb903a7f80423504c81c3d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qB2WBBo2IEoGVD-iapj6LA.png"/></div></div></figure><p id="c7ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">边界附近的三次样条曲线可以表现得很奇怪，正如你在上面的红色图中所注意到的。所谓的<em class="nb">自然三次样条</em>通过在每个极值处将三次多项式变为线性，强制函数在极值节点之外是线性的。</p><p id="dc82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自然三次样条要求选择所谓的自由度。对于莱特币的价格，我通过交叉验证发现了最好的自由度:174节是作为预测值的日期的合适选择分位数。结果是，与三次B样条相比，边缘处的可变性更小，但测试数据集上的R2稍差。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/5c4bfb72658533e66eafaab58983e20e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FIX_HuTBWDS9JX3A7vaUA.png"/></div></div></figure><p id="ebd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我实现了<em class="nb">平滑样条</em>，它最小化了均方误差，同时惩罚了价格的变化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/befc39327f25c4153c9770b343e91d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_MKZdqPlsjF14fCa_Qy4g.png"/></div></div></figure><p id="5ff6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">平滑样条似乎是莱特币价格最合适的分段插值。该模型在测试数据集上取得了迄今为止最好的R2评分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/332c7a24a3607b4ccbf1e2903b822b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aqm_rtpVmvKYxHnghKm3Tw.png"/></div></div></figure><p id="d26c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">三次样条令人兴奋的部分是如何在用于训练模型的数据范围之外进行外推。</p><p id="5303" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">据以预测和时间序列工作而闻名的著名统计学家<a class="ae ky" href="https://robjhyndman.com/publications/splinefcast/" rel="noopener ugc nofollow" target="_blank">罗布·金德曼</a>称，三次平滑样条模型可以作为<a class="ae ky" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank"> ARIMA模型</a>的等效模型用于预测，但具有有限的参数空间。Rob声称样条函数提供了一个平滑的历史趋势以及一个线性预测函数。</p><p id="9398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我邀请你进一步尝试这个想法。我的<a class="ae ky" href="https://colab.research.google.com/drive/1rC830W23JrI8JtSj74lcZhdyABiSit3N" rel="noopener ugc nofollow" target="_blank">计算机代码在网上</a>可以作为Jupyter Python/R笔记本在起点的伪装下获得。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/7639305a0f439c3aee48d78f4b73d026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zeCOrtyemvAgPClIs-c6w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://colab.research.google.com/drive/1rC830W23JrI8JtSj74lcZhdyABiSit3N" rel="noopener ugc nofollow" target="_blank">本文使用的Google Colab笔记本</a>。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="ae0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数字货币和加密货币(如莱特币)是现代全球经济中最具争议和最复杂的技术创新。本文旨在用一种不太流行的方法预测莱特币价格的变化:三次样条。</p></div></div>    
</body>
</html>