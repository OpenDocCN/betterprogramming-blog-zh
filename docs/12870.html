<html>
<head>
<title>Using Schemes and .xcconfig Files to Organize Build Deliveries in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用方案和。xcconfig文件来组织iOS中的构建交付</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-schemes-and-xcconfig-files-to-organize-builds-delivery-in-ios-633ba7992703?source=collection_archive---------9-----------------------#2022-07-07">https://betterprogramming.pub/using-schemes-and-xcconfig-files-to-organize-builds-delivery-in-ios-633ba7992703?source=collection_archive---------9-----------------------#2022-07-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e399" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何为我们的项目定义不同的配置</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b4ecd423026a998e32101d67edc21f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kjmIByImJJT35F-z"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pawel Czerwinski 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="91d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很多时候，我们需要组织我们的移动交付。这意味着，我们用来在App Store中发布应用程序的版本，或者我们每天用来在本地构建应用程序的版本，或者在我们公司内部分发的版本是不一样的。</p><p id="1809" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们将看到一种更好地组织我们的应用交付的方法，并开始在日常工作中有意义的内部配置中组织它。</p><h1 id="71ba" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">关于构建方案</h1><p id="79b0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">来自<a class="ae ky" href="https://developer.apple.com/documentation/xcode/customizing-the-build-schemes-for-a-project" rel="noopener ugc nofollow" target="_blank">苹果文件</a>:</p><blockquote class="ms mt mu"><p id="6a69" class="kz la mv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">当您构建、运行、测试、分析或归档项目的一部分时，Xcode会使用选定的构建方案来确定要做的事情。构建方案包含要构建的目标列表，以及影响所选操作的任何配置和环境详细信息。例如，当您构建并运行一个应用程序时，该方案会告诉Xcode将哪些启动参数传递给该应用程序。Xcode为大多数目标提供了默认方案，您可以自定这些方案或根据需要创建新的方案。</p></blockquote><p id="35ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建方案基本上是一个配置，它将一个目标和我们可能需要的任何配置联系起来。这包括环境变量、配置文件或任何可以使构建可定制的东西。</p><p id="20bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以有以下三种方案:</p><ul class=""><li id="ab5e" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">一个生产方案，我们的用户可以在应用商店下载</li><li id="f464" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">阶段计划，或内部测试计划。也可以叫做贝塔</li><li id="b051" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">工程师在本地使用的开发方案</li></ul><p id="a733" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种构建配置方面的关注点分离可以帮助我们定制应用程序的体验。例如，通过这类方案，我们可以:</p><ul class=""><li id="55c4" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">更改应用程序图标</li><li id="de15" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">为我们的内部API使用不同的基本URL</li><li id="6742" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">在各自的环境中配置第三方SDK</li><li id="6a78" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">添加可以帮助QA或Devs团队的内部开发工具</li><li id="da72" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">避免向第三方发送信息，例如，如果我们在本地编译应用程序，我们就不需要向Firebase发送崩溃信息。这将增加不真实的数据到我们的碰撞仪表板。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/62a23733005d7596e7150fdb857281fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/0*EmUvZTzYtV7blpDa"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">试用版配置的Chrome图标示例</p></figure><h1 id="d19e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">计划与目标</h1><p id="f054" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我们的建筑体系结构中还有一个重要的组成部分，那就是目标。目标基本上是我们正在构建的应用程序，我们旨在构建的产品。也就是说，需要编译并最终创建二进制文件的所有源代码。<strong class="lb iu">目标使用一个方案来构建产品。</strong>我们可以将差异总结如下:</p><blockquote class="ms mt mu"><p id="f2d5" class="kz la mv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><strong class="lb iu">目标指定了要构建的产品</strong>，并包含了从项目或工作空间中的一组文件构建产品的指令。</p><p id="eaf8" class="kz la mv lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated">Xcode方案定义了要构建的目标集合、构建时要使用的配置以及要执行的测试集合。</p></blockquote><p id="b7e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们可以使用目标来区分配置，这不是它们的目的。我们最终会使构建系统和开发人员使用项目的体验变得更加复杂。目标构建产品，方案包含如何构建产品的配置。</p><h1 id="0a5c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Xcode配置文件</h1><p id="15da" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">使用方案的一个关键核心是使用Xcode配置文件。这些是扩展名为<code class="fe no np nq nr b">.xcconfig</code>的。</p><p id="4a3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，我们可以为我们想要的构建配置定义定制值，我们可以在以后使用它来构建我们的目标。一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="70fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以创建许多<code class="fe no np nq nr b">.xcconfig</code>文件，并在其中相互引用，以避免在配置之间重复公共值。下一节将更好地解释这个概念。</p><h1 id="1a08" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">示例项目</h1><p id="f903" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于我们的示例项目，我们有以下内容:</p><ul class=""><li id="d8ed" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">1目标名为<code class="fe no np nq nr b">schemes-test</code></li><li id="c68b" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">名为<code class="fe no np nq nr b">STDevelopment</code>和<code class="fe no np nq nr b">STProduction</code>的两个方案</li><li id="5386" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">3个<code class="fe no np nq nr b">.xcconfig</code>档:<code class="fe no np nq nr b">Common.xcconfig</code>、<code class="fe no np nq nr b">Development.xcconfig</code>和<code class="fe no np nq nr b">Production.xcconfig</code></li></ul><p id="39c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为当我们有一个新项目时，目标已经创建，我们将继续创建方案。我们将点击项目名称旁边顶部菜单中的“管理方案…”选项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/0504f0cc279c9325a4d729a305470b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Daih-hP4cKbCTjdfOScVKQ.png"/></div></figure><p id="1291" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在Schemes列表视图中，我们点击+按钮来创建一个新的方案</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/15da502f2b4d389d4ec921a5168511a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9zGwixj0IIfH1Ql2Bjf5A.png"/></div></div></figure><p id="373f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建一个名为<code class="fe no np nq nr b">STDevelopment</code>的新方案:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/c3b714f1741b667671228360ed8f7747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oN0Hf5yK2zUv8ObER9ygbg.png"/></div></div></figure><p id="7ab9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样适用于<code class="fe no np nq nr b">STProduction</code></p><p id="849c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们的列表中应该有以下方案:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/09eb29e96775b7dfda173635c5657b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhbijnqhnchHJStI43cnXg.png"/></div></div></figure><p id="9f50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">删除自动生成的<code class="fe no np nq nr b">schemes-test</code>方案是安全的，因为我们不会使用它。</p><p id="16a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将继续创建<code class="fe no np nq nr b">.xcconfig</code>文件。我们需要在项目根目录下创建一个<code class="fe no np nq nr b">BuildConfigurations</code>文件夹。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/12ae4cc0e085d7379f3d054207379357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*nes3pEWqD7uQwHOrD-UJ0g.png"/></div></figure><p id="49c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将创建一个类型为<code class="fe no np nq nr b">Configuration Settings File</code>的新文件</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/8960e1c4e9ea3c9a91080557e45ecd15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqj7r47sfVAuuuucbTUqrg.png"/></div></div></figure><p id="8cd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将这个文件称为<code class="fe no np nq nr b">Common</code>。然后我们对新文件<code class="fe no np nq nr b">Development</code>和<code class="fe no np nq nr b">Production</code>做同样的步骤。此时，我们的项目中应该有这些文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/928c92b1c662ef7b29446a0051fc6a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*aIM1ryhC6yBVggCQkgHc6g.png"/></div></figure><p id="8477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe no np nq nr b">Common</code>文件中，我们将输入以下代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="779d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe no np nq nr b">Development</code>我们将输入以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="1deb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一行是<code class="fe no np nq nr b">Production</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="ed40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在<code class="fe no np nq nr b">.xcconfig</code>文件中定义了以下值:</p><ul class=""><li id="3c08" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe no np nq nr b">PRODUCT_BUNDLE_IDENTIFIER</code>:我们方案的包标识符</li><li id="6ec9" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">MARKETING_VERSION</code>:构建的版本号</li><li id="8600" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">CURRENT_PROJECT_VERSION</code>:内部版本号</li><li id="a969" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">BUNDLE_DISPLAY_NAME</code>:应用在屏幕上可见的名称</li></ul><p id="a5db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以想象，使用<code class="fe no np nq nr b">#include</code>关键字我们可以包含文件。在我们的例子中，<code class="fe no np nq nr b">MARKETING_VERSION</code>和<code class="fe no np nq nr b">CURRENT_PROJECT_VERSION</code>的值应该在配置之间保持相同。但是<code class="fe no np nq nr b">PRODUCT_BUNDLE_IDENTIFIER</code>的值是不同的，因为我们希望两种环境有不同的应用。同样适用于<code class="fe no np nq nr b">BUNDLE_DISPLAY_NAME</code>，它是应用程序的可见名称</p><p id="39f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在下一步是将这些文件与配置相关联。为此，我们转到项目设置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d241df3b1c6e7c70a635bd013a644cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WdL9QRHaa_RnyC91HtvJdg.png"/></div></div></figure><p id="ef33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们将用<code class="fe no np nq nr b">Development</code>和<code class="fe no np nq nr b">Production</code>替换<code class="fe no np nq nr b">Debug</code>和<code class="fe no np nq nr b">Release</code>名称，只是为了匹配我们的文件名。我们还将相应的xcconfig文件添加到每个配置中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/6f83626cadd48ef04c8d8851ac4fce01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3GeZ8-aj6rCyfm61QUNnzw.png"/></div></div></figure><p id="a954" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够使用这些值，我们需要转到我们的<code class="fe no np nq nr b">Info.plist</code>文件，在这里我们将添加以下属性，以及每个匹配的变量:</p><ul class=""><li id="1326" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe no np nq nr b">Bundle identifier</code>同<code class="fe no np nq nr b">PRODUCT_BUNDLE_IDENTIFIER</code></li><li id="1a41" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">Bundle version string (short)</code>同<code class="fe no np nq nr b">MARKETING_VERSION</code></li><li id="904e" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">Bundle version</code>同<code class="fe no np nq nr b">CURRENT_PROJECT_VERSION</code></li><li id="61ae" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe no np nq nr b">Bundle display name</code>同<code class="fe no np nq nr b">BUNDLE_DISPLAY_NAME</code></li></ul><p id="b48c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，我们将以这样的话来结束:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/737154113564b0a49a656f2e82cc4ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzjURwi21L9PQL_bLbjRFA.png"/></div></div></figure><p id="e560" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们点击我们的目标设置，并在各自的字段中为每个变量设置<code class="fe no np nq nr b">$(…)</code>，同样可以做到这一点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/dee4a9a39b1cba0c18df25380d287fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0vm9ZQnuBUmIY6ZUPllbZg.png"/></div></div></figure><p id="e28b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步，我们需要将每个方案与每个配置关联起来，因此我们点击顶部栏上的编辑方案:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/5524c7994059e855acc3e39daf8ab01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*kSwLc0V_aH66Srbdt3rtwA.png"/></div></figure><p id="c10d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将把每个方案与相关配置联系起来:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/70b9857787cbe5c6ceeea20407a37348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xy2A47TDuy9zhAL_Ji7e9g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/36ba1ee69a89538b82dd2b6c12b4e68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_kR6MoBrbdj9GJN5ypd7g.png"/></div></div></figure><p id="bcb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！如果我们在模拟器中运行我们的方案，我们会看到我们有两个不同的应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b73236d1fb37d24261c4b9d7ca743d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*-I6cjD8am3U_5AwcTkn2JQ.png"/></div></figure><h1 id="24f8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">代码中的检查方案</h1><p id="354e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果需要，我们可以在二进制文件中包含关于该方案的代码。对于这种特殊情况，我们可以对<code class="fe no np nq nr b">Development.xcconfig</code>使用以下内容:</p><pre class="kj kk kl km gt oj nr ok ol aw om bi"><span id="d68b" class="on lw it nr b gy oo op l oq or">SWIFT_ACTIVE_COMPILATION_CONDITIONS = DEBUG</span></pre><p id="5e4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个是给<code class="fe no np nq nr b">Production.xcconfig</code>的:</p><pre class="kj kk kl km gt oj nr ok ol aw om bi"><span id="ab63" class="on lw it nr b gy oo op l oq or">SWIFT_ACTIVE_COMPILATION_CONDITIONS = RELEASE</span></pre><p id="3343" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在我们的代码中，我们可以有以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="ff4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这对于显示隐藏菜单或开发人员/QA实用程序来帮助调试非常有用。</p><h1 id="f387" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">匹配应用程序和扩展之间的版本和内部版本号</h1><p id="3f85" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对测试目标进行相同的编号更改是很重要的，因此主目标和测试目标都有相同的版本号和内部版本号。应用程序扩展也是如此。我们需要在主目标和应用扩展之间保持相同的版本和内部版本号，否则当我们将内部版本上传到App Store Connect时，Apple会警告我们。该消息将类似于下一条消息(也将通过电子邮件接收)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/733394f7ef8614bd8d0a4743a99e8917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*0fOQif1zCMwkfZ4b.png"/></div></figure><h1 id="b17b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">关于添加令牌或API密钥</h1><p id="a4d7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们可以在<code class="fe no np nq nr b">.xcconfig</code>文件中添加API密钥/令牌，这样我们就可以在<code class="fe no np nq nr b">plist</code>文件中定义它们并像这样访问它们:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/529081274c585ba51384c56d13978cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG4HSd86c3Lf0rGbtImCLw.png"/></div></div></figure><pre class="kj kk kl km gt oj nr ok ol aw om bi"><span id="ade8" class="on lw it nr b gy oo op l oq or">let bundleId = Bundle.main.infoDictionary?["APIKey"] as? String</span></pre><p id="99e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这不是一个安全的解决方案。我们应该致力于以另一种方式获取如此敏感的数据，因为在我们的git存储库中提交它们是不安全的。如果我们使用CI来构建和分发我们的应用程序，许多CI提供者可以选择设置秘密(例如<a class="ae ky" href="https://devcenter.bitrise.io/en/builds/secrets.html" rel="noopener ugc nofollow" target="_blank">Bitrise</a>)，然后将这些秘密注入到项目中，使用类似<a class="ae ky" href="https://github.com/orta/cocoapods-keys" rel="noopener ugc nofollow" target="_blank"> cocoapods-keys </a>的解决方案。我将在下一篇文章中讨论如何做到这一点。</p><h1 id="288d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="dcca" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们看到了如何为我们的项目定义不同的配置。以这样一种方式组织真的很有用，我们可以将一个构建用于本地开发，而将另一个构建用于生产。这种能力将使我们能够添加适当的测试工具，更好地定义第三方环境，或者只是以更有效的方式组织我们的代码。</p><p id="9e79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里看完整源码<a class="ae ky" href="https://github.com/fedejordan/schemes-test" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="30da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><h1 id="0f49" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">来源</h1><ul class=""><li id="4e15" class="mz na it lb b lc mn lf mo li ou lm ov lq ow lu ne nf ng nh bi translated"><a class="ae ky" href="https://developer.apple.com/documentation/xcode/customizing-the-build-schemes-for-a-project" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/documentation/xcode/customizing-the-build-schemes-for-a-project</a></li><li id="a142" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://tech.olx.com/xcode-targets-arent-schemes-a087ac4bbe3a" rel="noopener ugc nofollow" target="_blank">https://tech . olx . com/xcode-targets-arent-schemes-a 087 AC 4 bbe3a</a></li><li id="fe25" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://www.donnywals.com/configuring-projects-with-xcconfig/" rel="noopener ugc nofollow" target="_blank">https://www . donny wals . com/configuring-projects-with-xc config/</a></li></ul></div></div>    
</body>
</html>