# 如何在 React 中重用代码

> 原文：<https://betterprogramming.pub/how-to-reuse-code-in-react-40637747125f>

## 帮助您以正确的方式共享 React 代码的技术

![](img/abca9a3b929dec37960098abc2e0efe7.png)

由诺埃米·马卡维-卡特茨在 [Unsplash](https://unsplash.com/photos/Zsiuja6HQCU) 上拍摄的图片

嗨！我是 EPAM Systems 的首席软件工程师，今天我想写下我关于在 React 项目中重用代码的想法和经验。

我正在做一个很酷的项目，有一个非常大的前端代码库，其中大部分是 React。我每天都面临代码可重用性的问题，有一些技术我广泛而成功地使用了。这就是为什么我有权利在这个问题上咨询你。

也许你已经从这篇文章中知道了一些或所有的技巧和原则。无论如何，我希望这能给你一些有用的信息，帮助你提高代码库的质量。

我们走吧！

# 一个对抗干和啊哈的故事

这个设计原则你应该已经知道了——不要重复了。对吗？这听起来绝对清晰合理:必须避免代码重复。但是界限在哪里呢？我们应该避免我们面临的每一个代码重复吗？共享和可重用的最小代码长度是多少？

你知道，这是个棘手的问题。我建议你小心 DRY 原则，因为它会使你的代码根本不被支持。但是这里的问题是什么呢？

你听说过美国心脏协会的设计原则吗？这个缩写代表避免草率的抽象。[肯特·c·多兹](https://kentcdodds.com/blog/aha-programming)有一篇关于这个原则的文章。简而言之，它警告你不要使用大量的抽象。但是什么是抽象呢？这是一段共享和可重用的代码，隐藏在统一的接口下，以防止代码重复！

但是，你可能会问，真相在哪里？一方面你听说应该避免重复代码，另一方面你听说应该避免抽象(例如，共享代码)。要回答这个问题，我们需要深入探究…

# 和谐干和啊哈的故事

在这一节中，我们将寻找一个平衡点。因为这是关于可重用性和可支持性争论的主要问题。让我们从共享一段代码的绿灯开始。

**第一步:新功能。想象一下，你正在为你的项目开发一个新的“牛逼功能 1”。作为该特性的一部分，您可以添加文件上传功能:这包括“FileDropArea”React 组件和“FileUploader”助手类。在这种情况下，我们对实现细节不感兴趣——只是概念性的东西。**

很明显，在这一步中，共享任何代码都不是一个好主意。所以，我们可以继续了。

**第二步:多一个新功能。**过了一段时间，现在你正在开发“牛逼功能 2”。和前面一样，这里也需要一个文件拖放区。你有什么行动！在大多数类似的情况下，人们会共享“文件放置区”组件。而且在我看来，是完全错误的！这是一个草率抽象的好例子——当你不知道所有可能的用例并试图共享一段代码时。

那么，在这种情况下该怎么办呢？请为“awesome-feature-2”复制一份文件拖放区组件。这个副本可能与最初的示例有一些不同，这是绝对可以的——在这一步，您不需要分享任何内容。

**第三步:还有一个新功能。**又是一样的:新的“牛逼功能 3 ”,带文件拖放区。我简单说一下。这是共享文件放置区的理想时刻。您需要为这个共享的 React 组件开发一个统一的 API，并在包含该功能的所有特性中重用它。

你会如何组织它？这是我的建议。

# 错误的抽象

现在你可能会问如何识别草率的抽象并避免它们。你应该看看肯特·c·多兹的那篇文章。这是我的观点。

避免抽象上的抽象。少说话，举有用的例子。假设我们有一个函数来检查用户是否属于某种类型。

这是一个正确用法的例子:

这是一个错误用法的例子，代表了抽象上的抽象。

当然，有些情况下我们需要抽象上的抽象。但是在大多数情况下，像`getIsUserOfType`这样的底层函数不应该有这样的抽象。

**控制重复代码**。你应该知道如何以正确的方式复制代码。最有可能的是，在你的项目中有一个关于代码重复的明确政策是一个好主意。

有两种类型的重复代码:

*   为功能/应用程序提供灵活性的重复代码。
*   等待被通用和共享的重复代码。

# 如何分享代码？

我不想写很多关于 React 技术的文字来分享代码。为什么？只是因为这个话题的文章很多！有一些你应该注意的事项。

**特设。**在引入 React 挂钩之前，这是一个标准且使用最广泛的技术。还是有很多有用的 libs 曝光 HOCs 的。您也可以创建自己的自定义。但是可以考虑用钩子。

**反应钩子。这是你可以用来重用代码的最好的东西。我现在广泛使用它。**

**共享组件。**最简单的选择。我们在“第 3 步:还有一个新特性”一节中看到了它。它与[故事书](https://storybook.js.org/)和[比特](https://bit.dev/)配合得非常好。

就是这样！

我在医院的两天里开始写这篇文章。它看起来更像是一套论文，你可以用它来深入研究，并根据自己的需要进行调整。希望这对你有帮助。

让我们保持联系。