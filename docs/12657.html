<html>
<head>
<title>How to Create The xG Progress Chart using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python创建xG进度图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-the-xg-progress-chart-using-python-10c8cef306f3?source=collection_archive---------13-----------------------#2022-06-20">https://betterprogramming.pub/how-to-create-the-xg-progress-chart-using-python-10c8cef306f3?source=collection_archive---------13-----------------------#2022-06-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e252" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用数据讲足球故事。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f8a78dc2c7c35b13e27daa694b9336dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yx5G8hDhLDCuWzw0YRYceA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内森·罗杰斯在<a class="ae ky" href="https://unsplash.com/s/photos/football-posts?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="2298" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="d7a6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">足球有时是一种不公平的游戏。如果你观看了德国和韩国之间的世界杯比赛，你会惊讶地发现德国输掉了那场比赛，无法进入下一阶段。当我们看到两个团队的预期目标(xG)值时，我们会觉得更痛苦。</p><p id="f22a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">预期目标是什么(xG)？xG值是射门可以转化为进球的概率。如果值更接近1，就更容易成为目标。决定该值的因素是距离、角度、射手前面的玩家数量等。</p><p id="d84c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我将向您展示如何使用Python创建xG进度图。事不宜迟，我们开始吧！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="009a" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">履行</h1><h2 id="8799" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">数据源</h2><p id="6cdd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于数据源，我们将使用来自StatsBomb开放数据的数据。StatsBomb提供了开放数据，我们可以使用这些数据来提高我们的足球分析技能。</p><p id="caf9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据包含欧洲冠军联赛、国际足联世界杯、2020年欧洲杯等比赛的事件数据。更多细节，你可以通过<a class="ae ky" href="https://github.com/statsbomb/open-data" rel="noopener ugc nofollow" target="_blank">这里</a>的链接了解。</p><h2 id="6859" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">行动（或活动、袭击）计划</h2><p id="955b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了实现xG进度表，我们需要做几个步骤。这些步骤是:</p><ul class=""><li id="ffb8" class="nq nr it lt b lu mn lx mo ma ns me nt mi nu mm nv nw nx ny bi translated">找到数据</li><li id="a6e6" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">准备数据</li><li id="04ad" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">将数据可视化</li></ul><h2 id="8976" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">找到数据</h2><p id="98c9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我们将使用2018年韩国和德国之间的世界杯比赛数据。</p><p id="4715" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为StatsBomb提供了如此多的匹配，并且数据被分成几个JSON文件，所以我们需要找到数据的文件名。</p><p id="e4b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们需要打开competition.json文件来检索比赛和赛季id。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="2e94" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面可以看到，比赛和赛季对应的id分别是43和3。</p><p id="271e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在下一步是从这些比赛中检索比赛id。为了简化我们的搜索过程，我们过滤了包含韩国作为竞争对手的数据。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="303d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面的结果我们可以看到，韩国和德国比赛对应的比赛id是7567。</p><p id="9cbc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以使用id作为事件数据的文件名。让我们通过使用这些代码行来打开数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="650e" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">准备数据</h2><p id="b8df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们想创建xG进度图，数据还没有完全准备好。因此，我们需要几个步骤来准备数据。首先，我们需要过滤包含镜头事件的数据。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="e551" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们过滤数据之后，下一步是获取利息列。这些列是时间戳、代表当前正在进行的比赛的时间段、比赛的分钟数、击球结果名称以及来自StatsBomb的xG值。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="951d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如你所知，足球比赛的半场不会在45分钟结束，所以应该进入伤停补时阶段。因此，时间有可能与下半年重叠。因此，我们需要创建一个新的标识符来标记时间。</p><p id="5a54" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以通过合并周期和分钟列来实现。比如说上半场第47分钟有一脚射门。因此，标识符将是1st-47。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="676d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为我们想知道每个团队在xG方面的进展，下一步是从每个团队的xG值生成累积和。</p><p id="f8b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了生成这些值，我们可以根据团队名称对数据进行分组，并使用cumsum函数对其进行聚合。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="65fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们聚合数据之后，最后一步是根据时间段和分钟对数据进行排序。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="5833" class="ne la it bd lb nf ng dn lf nh ni dp lj ma nj nk ll me nl nm ln mi nn no lp np bi translated">将数据可视化</h2><p id="f139" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，我们可以可视化xG进度图。我们将使用seaborn来可视化图表，并使用matplotlib来提高可视化效果。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="5ff5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">那么，我们能从图表中推断出什么呢？我们可以看到德国队从上半场就创造了很多机会。但遗憾的是，他们无法将其转化为目标。因为他们的xG更接近3，这意味着他们表现不佳。</p><p id="baf0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与此同时，韩国队没有创造很多机会，因为他们受到了德国球员的轰炸。但最终，他们获得了冲力，粉碎了德国人的防线。因此，德国自1938年以来第一次没有进入下一阶段。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="5890" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结束语</h1><p id="b476" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！您已经学习了如何使用Python创建xG进度图。我希望你能学到很多东西，从准备数据到可视化数据。</p></div></div>    
</body>
</html>