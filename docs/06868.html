<html>
<head>
<title>Angular Dynamic Templates: How to Build an App With 3 Layout Styles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度动态模板:如何建立一个有3种布局风格的应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-dynamic-layout-with-ngtemplate-8b6faa995a8f?source=collection_archive---------6-----------------------#2020-11-12">https://betterprogramming.pub/angular-dynamic-layout-with-ngtemplate-8b6faa995a8f?source=collection_archive---------6-----------------------#2020-11-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="1bbb" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://rakiabensassi.medium.com/list/software-engineering-7a179a23ebfd" rel="noopener">软件工程</a></h2><div class=""/><div class=""><h2 id="6f01" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">Angular ngTemplateLayout的高级用例</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/3bb31f36a9a8e3a8482878738c59189a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h9Qa-VQ3nRypn1Zo"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@halacious?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">光晕</a>在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1dd2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Angular 提供了非常强大的功能，支持各种各样的高级用例。今天我们将学习如何设计和实现一个支持三种布局风格的Angular应用程序:</p><ul class=""><li id="5b6d" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">在对话框中打开更新视图</li><li id="8664" class="mf mg iu ll b lm mo lp mp ls mq lw mr ma ms me mk ml mm mn bi translated">使用<code class="fe mt mu mv mw b">arrowBack</code>在新页面中打开更新视图，返回到列出所有项目的上一页</li><li id="b0eb" class="mf mg iu ll b lm mo lp mp ls mq lw mr ma ms me mk ml mm mn bi translated">在多个选项卡中打开多个更新视图</li></ul><p id="a05b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">要在三种布局之间切换，我们需要做的就是改变变量<code class="fe mt mu mv mw b">layoutStyle</code>的值。就这么简单。默认值为<code class="fe mt mu mv mw b">'dialog'</code>。</p><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="8d52" class="nb nc iu mw b gz nd ne l nf ng">layoutStyle = 'dialog' | 'tabs' | 'newPage'</span></pre><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj nh"><img src="../Images/ee1c17adbb2a515391b0cc8455f1af24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*psaXIy5CWgaJ5YrbgY0eKg.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">布局样式1:在对话框中更新联系人</p></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ni"><img src="../Images/91fe72bac37cc31c034b0a39c2b36240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2X1TSImZ9yBrojcKGM5Bg.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">布局样式2:在新选项卡中更新联系人</p></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ni"><img src="../Images/ce1fb713143a77245e4528aadfcb2b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LvTvPArZq_yWPkVo14TXIw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">布局样式3:在新页面中使用返回按钮更新联系人</p></figure><p id="e48e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们将使用容器-呈现器设计模式，并从组件继承、内容投影以及Angular Core和Angular template系统的一些很酷的特性(<code class="fe mt mu mv mw b">ng-template</code>、<code class="fe mt mu mv mw b">ng-container</code>、<code class="fe mt mu mv mw b">ngTemplateOutlet</code>)中获益，以实现我们的目标。让我们从引入允许灵活布局系统的<code class="fe mt mu mv mw b">ng-template</code>指令开始。</p></div><div class="ab cl nj nk hy nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="in io ip iq ir"><h1 id="2426" class="nq nc iu bd nr ns nt nu nv nw nx ny nz kj oa kk ob km oc kn od kp oe kq of og bi translated">ng模板指令</h1><p id="b391" class="pw-post-body-paragraph lj lk iu ll b lm oh ke lo lp oi kh lr ls oj lu lv lw ok ly lz ma ol mc md me in bi translated">Angular已经在许多结构指令中使用了<code class="fe mt mu mv mw b">ng-template</code>，比如<code class="fe mt mu mv mw b">ngIf</code>、<code class="fe mt mu mv mw b">ngFor</code>和<code class="fe mt mu mv mw b">ngSwitch</code>。该标签的内容包含模板的一部分，该模板可以与其他模板组合在一起，以形成最终的组件模板。下面是一个简单的用例:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">角度ng模板的使用案例</p></figure><p id="6fab" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mt mu mv mw b">else</code>子句指向名为<code class="fe mt mu mv mw b">progress-bar</code>的模板。使用<code class="fe mt mu mv mw b">#progress-bar</code>语法，通过模板引用为其指定名称。</p></div><div class="ab cl nj nk hy nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="in io ip iq ir"><h1 id="b18b" class="nq nc iu bd nr ns nt nu nv nw nx ny nz kj oa kk ob km oc kn od kp oe kq of og bi translated">项目设置</h1><p id="8ba5" class="pw-post-body-paragraph lj lk iu ll b lm oh ke lo lp oi kh lr ls oj lu lv lw ok ly lz ma ol mc md me in bi translated">如果你的机器上还没有Angular CLI，那么让我们按照这些说明<a class="ae li" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank">开始安装吧</a>。下一步是使用以下命令创建项目:</p><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="3a89" class="nb nc iu mw b gz nd ne l nf ng">ng new ng-dynamic-layout<br/>cd ng-dynamic-layout</span></pre><p id="beb5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mt mu mv mw b">ng new</code>命令提示您输入要包含在初始应用程序中的特性信息。按下<em class="oo"> y </em>出现“您想添加角度布线吗？”并选择SCSS作为样式表格式，然后按Enter键。</p><ul class=""><li id="b04d" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">安装<a class="ae li" href="https://material.angular.io/components/table/overview" rel="noopener ugc nofollow" target="_blank">角材</a>、<a class="ae li" href="https://github.com/angular/flex-layout" rel="noopener ugc nofollow" target="_blank">角材柔性布局</a>和角材:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="1d6a" class="nb nc iu mw b gz nd ne l nf ng">npm install @angular/material<br/>npm install @angular/cdk<br/>npm install @angular/flex-layout</span></pre><ul class=""><li id="df1a" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">通过将此行添加到<code class="fe mt mu mv mw b">src/style.scss</code>来导入角度主题:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="fbc4" class="nb nc iu mw b gz nd ne l nf ng">@import "~@angular/material/prebuilt-themes/indigo-pink.css";</span></pre><ul class=""><li id="9b17" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">生成<code class="fe mt mu mv mw b">BaseModule</code>:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="01d7" class="nb nc iu mw b gz nd ne l nf ng">ng generate module shared/base-module</span></pre><ul class=""><li id="5885" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">在其中生成一个新组件，<code class="fe mt mu mv mw b">dynamic-layout</code>:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="8c70" class="nb nc iu mw b gz nd ne l nf ng">ng generate component shared/base-module/dynamic-layout --export</span></pre><ul class=""><li id="4d38" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">生成<code class="fe mt mu mv mw b">ContactsModule</code>:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="9975" class="nb nc iu mw b gz nd ne l nf ng">ng generate module modules/contacts</span></pre><ul class=""><li id="df8b" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">在其中生成以下组件:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="c50b" class="nb nc iu mw b gz nd ne l nf ng">ng generate module modules/contacts/containers/contact-container</span><span id="9d1c" class="nb nc iu mw b gz op ne l nf ng">ng generate module modules/contacts/presenters/contact</span><span id="a55a" class="nb nc iu mw b gz op ne l nf ng">ng generate module modules/contacts/presenters/contact-list</span><span id="ba69" class="nb nc iu mw b gz op ne l nf ng">ng generate module modules/contacts/presenters/contact-update/contact-form</span><span id="2e6a" class="nb nc iu mw b gz op ne l nf ng">ng generate module modules/contacts/presenters/contact-update/contact-update-dialog --type=dialog</span></pre><ul class=""><li id="d6ea" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">更新<code class="fe mt mu mv mw b">app-routing.module.ts</code>中的路由:</li></ul><pre class="kt ku kv kw gu mx mw my mz aw na bi"><span id="5d8f" class="nb nc iu mw b gz nd ne l nf ng">const routes: Routes = [<br/>  { path: '', redirectTo: 'contacts', pathMatch: 'full' },<br/>  { path: 'contacts', component: ContactContainerComponent<em class="oo"> </em>}<br/>];</span></pre></div><div class="ab cl nj nk hy nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="in io ip iq ir"><h1 id="92da" class="nq nc iu bd nr ns nt nu nv nw nx ny nz kj oa kk ob km oc kn od kp oe kq of og bi translated">深入细节</h1><p id="dcc3" class="pw-post-body-paragraph lj lk iu ll b lm oh ke lo lp oi kh lr ls oj lu lv lw ok ly lz ma ol mc md me in bi translated">好了，现在是时候进入正题了。我们在<code class="fe mt mu mv mw b">ContactsModule</code>中的主要展示者是<code class="fe mt mu mv mw b">ContactComponent</code>，它是使用多时隙内容投影为两个动态模板指定值的地方—“T8”和“<code class="fe mt mu mv mw b">update</code>”。</p><p id="a32c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mt mu mv mw b">dynamic-layout</code>标签将内容包装在组件中，根据<code class="fe mt mu mv mw b">layoutStyle</code>的值，<code class="fe mt mu mv mw b">DynamicLayoutComponent</code>将管理如何以及在哪里呈现更新模板:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">contact.component.html</p></figure><p id="abc4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">打字稿部分，<code class="fe mt mu mv mw b">contact.component.ts</code>:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">contact.component.ts</p></figure><p id="9f04" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">您可能已经注意到，<code class="fe mt mu mv mw b">ContactComponent</code>正在扩展<code class="fe mt mu mv mw b">BasePresenter</code>，它是一个父组件，负责处理相应更新视图的创建/打开/删除，并将用户重定向到列表或更新页面:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">base-presenter.component.ts</p></figure><p id="a7d4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">与<code class="fe mt mu mv mw b">BasePresenter</code>类似，我使用了<code class="fe mt mu mv mw b">BaseContainer</code>和<code class="fe mt mu mv mw b">BaseList</code>父组件，并将通用功能委托给它们，这有助于避免重复代码:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">基本容器.组件. ts</p></figure><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">基本列表.组件. ts</p></figure><p id="dbe3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在是时候揭示我是如何设计<code class="fe mt mu mv mw b">DynamicLayoutComponent</code>的了。除了一些输入字段和事件发射器与宿主组件通信之外，TypeScript部分没有任何逻辑:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">动态布局.组件. ts</p></figure><p id="ccf0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">是我们的主要游戏领域。我在这里添加了逻辑，通过<code class="fe mt mu mv mw b">ng-content select="[list]"</code>和<code class="fe mt mu mv mw b">ng-content select="[update]"</code>将正确的内容附加到正确的模板上。我还指定了用<code class="fe mt mu mv mw b">ng-container *ngTemplateOutlet="update"</code>和<code class="fe mt mu mv mw b">ng-container *ngTemplateOutlet="list"</code>呈现每个模板的占位符:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div></figure><p id="afe3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">最后但同样重要的是向您展示父代<code class="fe mt mu mv mw b">StoreService</code>的外观。这是一个基于<code class="fe mt mu mv mw b">BehaviorSubject</code>的服务，同时扮演着商店的角色。它也是所有模块的商店服务继承的类:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="om on l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">基本模块商店服务</p></figure><p id="a75b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">整个应用程序可在<a class="ae li" href="https://github.com/rakia/angular-dynamic-layout" rel="noopener ugc nofollow" target="_blank"> Github这里</a>获得。自己查一下app，点一下周围。</p></div><div class="ab cl nj nk hy nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="in io ip iq ir"><h1 id="4292" class="nq nc iu bd nr ns nt nu nv nw nx ny nz kj oa kk ob km oc kn od kp oe kq of og bi translated">最后的想法</h1><p id="214b" class="pw-post-body-paragraph lj lk iu ll b lm oh ke lo lp oi kh lr ls oj lu lv lw ok ly lz ma ol mc md me in bi translated">角度内容投影和动态模板是构建可重用组件和实现清晰架构的非常有用的特性。我们已经看到了<code class="fe mt mu mv mw b">ng-content</code>和<code class="fe mt mu mv mw b">ng-template</code>指令是如何工作的，以及它们如何改进UX设计和解决我们在企业应用程序中最常遇到的问题。</p><p id="8131" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">受益于Typescript/Angular继承，将许多功能转移到一个中心位置，这使我能够摆脱大量样板代码，便于将来的维护。我介绍的解决方案并不是构建最终应用程序的唯一解决方案。请随时提供反馈或分享您是如何解决类似挑战的。</p><p id="c6e2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">感谢阅读。</p></div><div class="ab cl nj nk hy nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="in io ip iq ir"><p id="30fc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">🧠💡我为一群聪明、好奇的人写关于工程、技术和领导力的文章。<a class="ae li" href="https://rakiabensassi.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je">加入我的免费电子邮件简讯，独家获取</strong> </a> <strong class="ll je"> </strong>或在此注册Medium <a class="ae li" href="https://rakiabensassi.medium.com/membership" rel="noopener">。</a></p><p id="eee3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="oo">你可以在Udemy上查看我的</em> <strong class="ll je"> <em class="oo">视频课程</em></strong><em class="oo">:</em><a class="ae li" href="https://www.udemy.com/course/identify-and-fix-javascript-memory-leaks/" rel="noopener ugc nofollow" target="_blank"><em class="oo">如何识别、诊断、修复Web Apps中的内存泄漏</em> </a> <em class="oo">。</em></p></div></div>    
</body>
</html>