<html>
<head>
<title>Programming a Crypto Wallet Dashboard for Binance Smart Chain Holdings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为币安智能连锁控股公司设计加密钱包仪表板</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/programming-a-crypto-wallet-dashboard-4d421d866e05?source=collection_archive---------15-----------------------#2022-02-10">https://betterprogramming.pub/programming-a-crypto-wallet-dashboard-4d421d866e05?source=collection_archive---------15-----------------------#2022-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7971" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用共价的API生成一个最新的仪表板</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/263ca24e628ab3678047fabb6434a964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3ryulKWeMuWGb7y4"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="b6a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我在2022年2月初写这篇文章时，加密市场(以及股票市场)正在经历一场相当糟糕的衰退。但在此之前，当我开始这个项目时，crypto看到了一轮令人印象深刻的牛市，比特币在2021年11月10日达到了69，000美元的历史高点。具有创新技术的严肃项目，以及唯一目的是潜在迷因的硬币(或加密领域亲切地称为“shitcoins ”,如我最喜欢的DogeBonk)正在蓬勃发展。</p><p id="4480" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然我也投资严肃的项目，但我真的很喜欢交易替代硬币，即币安智能链(BSC)上的那些。很明显，这只是一种赌博形式，但跟随社区生成的shitcoins迷因是一种享受。</p><p id="ec26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，我遇到的一个缺点是跟踪你的硬币和当前利润的能力。熟悉BSC令牌的人会知道BSCscan和<code class="fe ls lt lu lv b">poocoin.app</code>，但这些网站在相对容易地跟踪您的交易方面有局限性。</p><p id="a4a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我决定建立一个仪表板表，它将每天自动通过电子邮件发送给我，并将提供我希望看到的BSC令牌的统计数据，我计划一步一步地介绍我是如何实现这一点的。</p><h1 id="d4c7" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">入门指南</h1><p id="50f3" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">你首先要前往<a class="ae kv" href="https://www.covalenthq.com/" rel="noopener ugc nofollow" target="_blank">https://www.covalenthq.com/</a>并获得一个API密匙。共价慷慨地提供了一个免费的API与吨的端点和支持区块链网络，我用共价的API的大部分功能在这个项目中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/b077482fb14cb496b782d80b7db2ffb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1GgKxZ9PbLePfCL3qHdSg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">共价支持的区块链列表。来自covalenthq.com的照片</p></figure><p id="0bb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们要做的第一件事是使用下面的函数获取我们钱包的更新快照。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f3a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“地址”指的是你钱包的42位地址。Hidelist是一个简单的加密代码列表(“ETH”等)。)你不想在你钱包的结果中显示出来。</p><p id="c372" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常情况下，诈骗令牌会尝试添加您的钱包作为诈骗的一部分，请隐藏这些令牌，这样您就不用担心它们了。还请注意，如果使用BSC以外的网络，您将需要一个不同的编号，而不是API URL中的“56”。参考共价的其他网络id的文件。</p><h2 id="394f" class="mw lx iq bd ly mx my dn mc mz na dp mg lf nb nc mi lj nd ne mk ln nf ng mm nh bi translated">获取定价数据</h2><p id="5cbe" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">有了从<code class="fe ls lt lu lv b">get_wallet()</code>函数返回的字典数据的钱包列表，我们现在想要获得最新的、准确的价格。虽然共价API将价格作为API终点，但我发现价格数据是滞后的。我用了PancakeSwap的API来代替。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="ed2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们可以用这些更新的价格修改我们的钱包列表。我还生成了一个不同的列表，稍后用作过滤器来删除价格为“0”的任何响应(被删除的令牌或收集数据的API有问题)。</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="5b64" class="mw lx iq lv b gy nm nn l no np"># Update wallet prices<br/>for i in wallet:<br/>    for j in current_prices:<br/>        if j['Name'] == i['Name']:<br/>            i['Price'] = j['Price']</span><span id="21c8" class="mw lx iq lv b gy nq nn l no np"># Generate filter to remove '0' prices<br/>zerodrop = []<br/>for i in current_prices:<br/>    if float(i['Price']) == 0:<br/>        if i['Name'] != 'BNB':<br/>            zerodrop.append(i['Name'])</span></pre><p id="6336" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来我们想要的是我们所有交易的累计金额。下一个函数从上一个函数中读入我们的钱包数据，并计算交易代币的等价BNB值乘以交易时BNB的美元值，以获得我们每个代币的所有交易总和的美元值。这为我们的钱包中的每个代币提供了以美元计的净成本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="2ddd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！现在我们可以将这个输出添加到我们的钱包数据中。</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="92bc" class="mw lx iq lv b gy nm nn l no np"># Update wallet list of dicts with net cost value<br/>for i in wallet:<br/>    for j in netcost:<br/>        if j['Name'] == i['Name']:<br/>            i['Net Cost'] = j['Net Cost']</span></pre><p id="b8d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在运行这段代码的Jupyter笔记本中，我将钱包响应转换为数据帧，清除了一些格式，更新了USD值列，并生成了“Percent Gain”列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="be9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还想包括一些移动平均值—一周和六周。下面我加入了一周移动平均线的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="e95c" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">生成可视化</h1><p id="90f7" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">我们需要做的最后一件事是生成包含这些信息的仪表板，并将其发送到我的电子邮件中。</p><p id="4107" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我开始添加到仪表板上以在电子邮件中发送的两个数字是资金分布，或者我的BSC加密钱包如何在不同硬币之间分割，以及一个显示我钱包中每个硬币的损益百分比的数字。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0302" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我从共价网收集的数据可以产生很多其他的可视化效果。</p><p id="5c64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果您每天将从共价返回的数据保存到一个SQL表中，那么您可以随时间跟踪您的投资组合价值。</p><p id="a5a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将继续使用dataframe表和我们在最后一个嵌入式代码块中生成的两个可视化。</p><h1 id="1081" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">发送电子邮件</h1><p id="af1b" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">为了配置要发送到我的电子邮件的投资组合数据，我借用并修改了一些伟大的代码，这些代码是我在<a class="nr ns ep" href="https://medium.com/u/3ab8d3143e32?source=post_page-----4d421d866e05--------------------------------" rel="noopener" target="_blank">张秀坤·波尔泽</a>的一篇媒体文章中找到的，在这里找到<a class="ae kv" href="https://towardsdatascience.com/how-to-distribute-your-data-reports-via-mail-with-a-few-lines-of-code-8df395c72e55" rel="noopener" target="_blank"/>。</p><p id="78e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我创建了一个新的Gmail账户，专门用于用Python自动发送电子邮件(在我写的另一篇文章中，我用这个账户发送股票通知<a class="ae kv" href="https://jspitzer.medium.com/using-python-to-generate-product-in-stock-notifications-b793fa3db066" rel="noopener">这里</a>)。我建议不要用你的主邮箱来完成这个任务。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1204" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">配置完邮件凭证后，我们就可以设置要发送的消息了。在本例中，我将dataframe对象和dashboard对象转换为HTML，以确保它们在电子邮件中正确显示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="a203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是发送到我收件箱的邮件截图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/48054954ca10971d3296efdba22e17d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h5aWThNAI85u1HDDEx14qg.png"/></div></div></figure><p id="0c05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了每天自动发送电子邮件，我将<code class="fe ls lt lu lv b">.ipynb</code>文件转换为<code class="fe ls lt lu lv b">.bat</code>文件，并设置任务调度程序每天运行一次任务。查看我关于自动库存通知的文章<a class="ae kv" href="https://medium.com/@jspitzer/using-python-to-generate-product-in-stock-notifications-b793fa3db066" rel="noopener">这里</a>，了解更多关于如何设置任务调度程序来运行脚本的信息。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="54f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读，我希望你喜欢这篇文章。如果你有任何问题，请随时告诉我。完整的代码可以在我的Github <a class="ae kv" href="https://github.com/jspitze/Crypto-Token-Tracker" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>