<html>
<head>
<title>Creating Beautiful Animations in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React Native中创建漂亮的动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/it-is-moving-a68b89aee1e5?source=collection_archive---------6-----------------------#2020-10-21">https://betterprogramming.pub/it-is-moving-a68b89aee1e5?source=collection_archive---------6-----------------------#2020-10-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="530b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">动画让你的应用在视觉上更有吸引力。在React原生应用中制作标题动画</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/98a0b5ddb85a84aab6ce4159ff3210ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kU9Bs-M5Hmw5k3DeYQ4nMg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">运动很吸引人(照片由<a class="ae kv" href="https://unsplash.com/@aoddeh" rel="noopener ugc nofollow" target="_blank"> Ahmad Odeh </a>在<a class="ae kv" href="https://medium.com/r?url=https%3A%2F%2Funsplash.com%2Fphotos%2Fckm1yAe6jhU" rel="noopener"> Unsplash </a>上拍摄)</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f5e6" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">动画API</h1><p id="0e1f" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">如<a class="ae kv" href="https://reactnative.dev/docs/animated" rel="noopener ugc nofollow" target="_blank"> React原生文档</a>所述:</p><blockquote class="mr ms mt"><p id="7fd7" class="lv lw mu lx b ly mv jr ma mb mw ju md mx my mg mh mz na mk ml nb nc mo mp mq ij bi translated">"<code class="fe nd ne nf ng b">Animated</code>库旨在使动画流畅、强大，并且易于构建和维护."</p></blockquote><p id="6d06" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">换句话说，<code class="fe nd ne nf ng b">Animated</code>帮助我们在屏幕上创造运动。创建动画的常见工作流程是:</p><ul class=""><li id="67ea" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated">创造一个<code class="fe nd ne nf ng b">Animated.Value</code></li><li id="cd53" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated">将其与动画组件的样式属性挂钩(例如，<code class="fe nd ne nf ng b">Animated.View</code>)</li></ul><p id="950b" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">听起来很简单，但实际上并不容易。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="e49c" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">移动标题</h1><p id="8fdf" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">假设我们的视图由一个标题和可滚动的内容组成。当我们滚动时，标题应该折叠一点，为内容腾出更多的空间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/da05cef186da4c1b6f500c4f5955c89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*bB3DIPAIXA2SYbUclXzR0A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">页眉折叠，为内容腾出更多空间</p></figure><p id="4d50" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">实现类似行为有两种可能性:</p><ul class=""><li id="4977" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated">粘性视差标题</li><li id="0dda" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated">差动夹钳接头</li></ul><p id="0034" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">他们之间的区别非常微妙。您对它们的外观以及如何实现它们感兴趣吗？继续读！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="a8ae" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">成分</h1><p id="7692" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">首先，我们需要定义一些常数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="b6af" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">它们定义了页眉在展开和折叠时的大小(见上面的蓝色/红色/绿色)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/5a6ea5d7a329843cbd6988cfb67082f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*Qjkf7EjYR2LvImCv4SkryA.png"/></div></figure><p id="9711" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">该应用程序由标题和滚动视图组成。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f2dc" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">标题和滚动视图组件定义如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="ddd5" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">以上要点中最重要的是:</p><ul class=""><li id="8918" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated"><code class="fe nd ne nf ng b">Animated.View</code>和<code class="fe nd ne nf ng b">Animated.ScrollView</code>是允许动画的库组件。</li><li id="1e69" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated">当滚动视图滚动时(<code class="fe nd ne nf ng b">onScroll</code>)，内容偏移的y值被分配给一个<code class="fe nd ne nf ng b">scroll</code>变量。</li><li id="1414" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">scroll</code>变量被转换成<code class="fe nd ne nf ng b">translateHeader</code>(参见下面要点中的转换)，然后用于滚动标题(<code class="fe nd ne nf ng b">translateY: translateHeader</code>)。</li></ul><p id="0721" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">现在你可能会问自己<code class="fe nd ne nf ng b">translateHeader</code>是如何计算的，以及<code class="fe nd ne nf ng b">scroll</code>变量到底是什么。让我们来看看它们。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="7cd7" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">动画片</h1><p id="a032" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated"><code class="fe nd ne nf ng b">scroll</code>保存滚动y轴偏移量的当前值。它是一个<code class="fe nd ne nf ng b">Animated.Value</code>，用它来驱动所有的动画。</p><p id="af70" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">例如，<code class="fe nd ne nf ng b">translateHeader</code>是<code class="fe nd ne nf ng b">scroll</code>的插值。从范围<code class="fe nd ne nf ng b">[0, X]</code>到<code class="fe nd ne nf ng b">[0, -X]</code>进行插补。这仅仅意味着当我们向下滚动时，标题向上，当我们向上滚动时，标题向下(我打赌你猜到了)。如果<code class="fe nd ne nf ng b">scroll</code>值超出规定范围，则<code class="fe nd ne nf ng b">translateHeader</code>值被“钳位”以保持在界限内。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="4eaf" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">在上面的代码中，还有两个到目前为止还没有提到的变量:</p><ul class=""><li id="2bcd" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated"><code class="fe nd ne nf ng b">translateHeaderText</code>是相乘的<code class="fe nd ne nf ng b">translateHeader</code>。<code class="fe nd ne nf ng b">1.5</code> multiplier表示文字移动速度比页眉快，<code class="fe nd ne nf ng b">-</code>符号表示文字向相反方向移动。</li><li id="ab9c" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">fadeOut</code>与<code class="fe nd ne nf ng b">translateHeader</code>非常相似。它也是一个插值<code class="fe nd ne nf ng b">scroll</code>，但是插值发生在不同的范围。</li></ul><p id="d198" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">刚刚描述的两个变量用于动画标题中的两个动画文本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="a1bc" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">让我们来分解一下:</p><ul class=""><li id="8e5a" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated">它们都是<code class="fe nd ne nf ng b">Animated.Text</code>组件——这是使用<code class="fe nd ne nf ng b">Animated</code>库的先决条件。</li><li id="801e" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">headerText</code>正在y轴上平移。</li><li id="7227" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">fadingOutText</code>有动画不透明度(所以神奇的消失了)。</li></ul><p id="7db5" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">如果你对动画看起来很好奇，向下滚动一点。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4207" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">式样</h1><p id="6eb9" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">现在是创建动画视图的最后一个元素——样式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="58f3" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">上面的一些值只是为了使景色变美才重要。(只？那也很重要！)</p><p id="2757" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">对动画来说至关重要的是:</p><ul class=""><li id="f708" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated"><code class="fe nd ne nf ng b">height: HEADER_MAX_HEIGHT</code> —定义割台的初始高度。</li><li id="70c7" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">position: "absolute"</code> —使<code class="fe nd ne nf ng b">header</code>独立于<code class="fe nd ne nf ng b">scrollView</code>定位。</li><li id="d903" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">zIndex: 1</code> —因为<code class="fe nd ne nf ng b">header</code>是绝对定位的，所以它必须在<code class="fe nd ne nf ng b">scrollView</code>的上方。</li><li id="c7c0" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">marginTop: HEADER_MAX_HEIGHT</code> —由于<code class="fe nd ne nf ng b">header</code>被绝对定位，<code class="fe nd ne nf ng b">scrollView</code>被锚定在<code class="fe nd ne nf ng b">container</code>组件的顶部。这意味着如果没有上边距，<code class="fe nd ne nf ng b">scrollView</code>最初会隐藏在<code class="fe nd ne nf ng b">header</code>后面。</li></ul><p id="d77c" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">在所有的理论和代码示例之后，是时候看看动画是什么样子了。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="1b20" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">粘性视差标题</h1><p id="10d2" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">向下滚动滚动视图时，粘性视差标题会折叠。只有当滚动内容到达顶部时，标题才会展开。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/432a12ea7950d75259d6d313a1c7af25.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/1*QJ5BPBnAnc1arIU2Fjtogw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">粘性视差标题</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="29ef" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">差动夹钳接头</h1><p id="f309" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">当滚动视图向下滚动时，比较箝位标题折叠。每当滚动内容向上滚动时，标题就会展开。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/be4b6ea0c2c7342c79d2af0a42046e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/1*9-oSUABNq-lK5ahtGKc6uQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">差动夹钳接头</p></figure><p id="fc60" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">是如何实现的？与粘性视差头的区别实际上非常微妙:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><ul class=""><li id="05c6" class="nh ni iq lx b ly mv mb mw me nj mi nk mm nl mq nm nn no np bi translated"><code class="fe nd ne nf ng b">headerDiffClamp</code>使用<code class="fe nd ne nf ng b">diffClamp</code>实现所需的行为。<code class="fe nd ne nf ng b">scroll</code>值保持在范围<code class="fe nd ne nf ng b">[0, HEADER_SCROLL_DISTANCE]</code>内。动画值使用当前值和上一个值之差(<code class="fe nd ne nf ng b">value = clamp(value + diff, min, max)</code> <em class="mu">)。</em>因此，即使<code class="fe nd ne nf ng b">scroll</code>远离边界，当值开始再次接近时<code class="fe nd ne nf ng b">headerDiffClamp</code>也会改变。</li><li id="62ff" class="nh ni iq lx b ly nq mb nr me ns mi nt mm nu mq nm nn no np bi translated"><code class="fe nd ne nf ng b">translateHeader</code>和<code class="fe nd ne nf ng b">fadeOut</code>基于差分箝位值，而不是之前的原始<code class="fe nd ne nf ng b">scroll</code>。</li></ul></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4052" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">源代码</h1><p id="45da" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">如果您想深入了解并尝试使用演示应用程序，可以在GitHub上找到源代码:</p><div class="nz oa gp gr ob oc"><a href="https://github.com/kwiecien/animated-header-rn" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">kwiecien/animated-header-rn</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">github.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq kp oc"/></div></div></a></div></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="041a" class="pw-post-body-paragraph lv lw iq lx b ly mv jr ma mb mw ju md me my mg mh mi na mk ml mm nc mo mp mq ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>