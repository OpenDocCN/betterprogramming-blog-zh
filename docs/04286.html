<html>
<head>
<title>Sync Your Android and GitHub Releases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">同步您的Android和GitHub版本</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/sync-your-android-and-github-releases-519c0e9dfa8c?source=collection_archive---------20-----------------------#2020-04-02">https://betterprogramming.pub/sync-your-android-and-github-releases-519c0e9dfa8c?source=collection_archive---------20-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7010" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以直观的方式自动化应用的发布流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cd37298b79a986192c2f01f3367bcd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUysPCMt1rE1BttyyD1QQQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布鲁斯·马斯在<a class="ae ky" href="https://unsplash.com/s/photos/app?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="14b4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在NoOps中的部署应该是直观的</h1><p id="8a1f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">NoOps意味着自动化整个工作流程——开发人员所要做的就是推送代码。这是2020年的流行概念。</p><p id="7b2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于app store和GitHub存储库概念之间的不一致，自动化应用发布经常会导致混乱。</p><p id="d2fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了确保开发人员有信心做出改变，来自应用商店的应用发布流程应该在概念上与GitHub发布流程一致，因为存储库是开发人员推送代码的地方。</p><p id="b4d3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文主要关注GitHub发布流程与Android发布流程(谷歌Play商店)的一致性，以及实现细节。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="a5b9" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">Google Play支持GitHub事件的超集</h1><p id="815b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们需要了解谷歌Play商店版本的各个阶段:</p><ol class=""><li id="f9ef" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm nj nk nl nm bi translated"><strong class="lt iu">内部</strong>:向核心团队成员推送更新，收集bug。</li><li id="958d" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><strong class="lt iu"> Alpha </strong>:向更广泛的团队成员推送更新，收集bug。</li><li id="fe77" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><strong class="lt iu"> Beta </strong>:向外部测试人员推送更新，收集反馈。</li><li id="75b0" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><strong class="lt iu">制作</strong>:给大家推送更新。</li></ol><p id="6374" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，让我们看看GitHub发布的各个阶段:</p><ol class=""><li id="6bc5" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm nj nk nl nm bi translated"><strong class="lt iu">推</strong>:代码进入主分支。</li><li id="ae98" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><strong class="lt iu">预发布</strong>:当版本代码完成时。</li><li id="f844" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated"><strong class="lt iu">发布</strong>:当一个版本准备好生产时。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/3b62a6eaf11f41d0006ef7c48fb53312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--e46M3QOSDvS50-RzooEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">谷歌Play商店和GitHub库事件匹配演示</p></figure><p id="0881" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，beta在概念上类似于预发布，而生产在概念上类似于发布。</p><p id="1fce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然存储库没有定义内部和alpha之间的界限，但是内部只允许少量的测试人员，所以我们可以把内部和alpha结合起来对应push。</p><p id="9ad3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在匹配概念之后，让我们一步一步地实现一个自动发布工作流。</p><p id="3a5d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文将展示与GitHub Action (CI/CD平台)和浪子(app automation framework)的版本同步，但是这个想法适用于任何CI和app automation框架。</p><p id="a994" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注:我从一个加密的隐写应用程序<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>那里借来了脚本。要了解它在一个完整的移动应用中是如何工作的，请查看<a class="ae ky" href="https://github.com/tianhaoz95/photochat" rel="noopener ugc nofollow" target="_blank">资源库</a>。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="fc1d" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">步骤0:编写一个浪子脚本来与谷歌Play商店进行交互</h1><p id="4edc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于浪子不是这里的主要焦点，我将简单地发布一个上传应用到谷歌Play商店的最小的浪子脚本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="4fd4" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">步骤1:让工作流触发推送和发布事件</h1><p id="e0e9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以下脚本在每次推送或释放时触发释放操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="d4d9" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">第二步:捕捉推送动作，发布内部和Alpha应用</h1><p id="55ab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这里我们希望捕获推送事件，而忽略释放事件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="69f1" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">步骤3:捕获预发布操作以发布测试版应用程序</h2><p id="98b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以下脚本确保触发事件是预发布事件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="06de" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">步骤4:捕获发布动作以发布生产应用程序</h2><p id="b6ec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以下脚本检查触发事件是发行版，而不是预发行版:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="cb6b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意:只有两种类型的发布事件:“预发布”和“发布”，所以检查它不是“预发布”就足够了。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="e2c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">万岁！通过这种设置，开发人员可以检查代码，就好像发布的应用程序不存在一样。该应用程序将准确地出现在谷歌Play商店或你喜欢的市场上。</p></div></div>    
</body>
</html>