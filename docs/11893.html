<html>
<head>
<title>Goodbye Heroku Postgres. Hello, Railway</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">再见了Heroku Postgres。你好，铁路</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/goodbye-heroku-postgres-hello-railway-b9a7ef9eb88d?source=collection_archive---------10-----------------------#2022-04-25">https://betterprogramming.pub/goodbye-heroku-postgres-hello-railway-b9a7ef9eb88d?source=collection_archive---------10-----------------------#2022-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="442d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我现在要离开Heroku Postgres。原因如下</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/79c359ed1789f7ff3ba3a23aabc4171c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OKmiUa7xy150yV0R"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·阿巴迪亚在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9276" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不到一年前，我创建了<a class="ae ky" href="https://burplist.me/" rel="noopener ugc nofollow" target="_blank"> Burplist </a>，这是一个免费的精酿啤酒搜索引擎。为了<a class="ae ky" href="https://jerrynsh.com/how-i-built-burplist-for-free/" rel="noopener ugc nofollow" target="_blank">尽可能降低我的基础设施成本</a>，我从<a class="ae ky" href="https://elements.heroku.com/addons/heroku-postgresql" rel="noopener ugc nofollow" target="_blank"> Heroku Postgres免费层</a>开始。</p><p id="f5bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">行数限制为10，000，存储容量为1 GB，我以为它至少可以用一年——事实并非如此。</p><p id="52d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管Heroku Postgres有一个垃圾收集器服务，每周运行一次来删除过时的行，但它的免费层还是不够。我开始寻找替代品。</p><p id="0037" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">TL；DR:我已经将我的副业项目的PostgreSQL迁移到了</em><a class="ae ky" href="https://railway.app/" rel="noopener ugc nofollow" target="_blank"><em class="lv">Railway</em></a><em class="lv">上，因为它的价格和易于迁移。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d695" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">Heroku Postgres替代方案</h1><p id="9dfe" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在谷歌上搜索了一番后，我发现了几个类似Heroku的PaaS，每个都有自己的Postgres服务:</p><ul class=""><li id="400b" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><a class="ae ky" href="https://render.com/pricing" rel="noopener ugc nofollow" target="_blank">render.com/pricing</a></li><li id="0725" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://fly.io/docs/about/pricing/#postgresql-clusters" rel="noopener ugc nofollow" target="_blank">fly.io/docs/about/pricing/#postgresql-clusters</a></li><li id="6a78" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://railway.app/pricing" rel="noopener ugc nofollow" target="_blank">railway.app/pricing</a></li></ul><h2 id="5de6" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">一个脱颖而出</h2><p id="3025" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我选择铁路，因为它对我的用例来说是最经济的。以下是我喜欢铁路的一些地方:</p><ul class=""><li id="078e" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">令人难以置信的慷慨定价，你只需支付10美元后的资源使用费。对我来说，这比用Heroku便宜多了。</li><li id="c1be" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">他们有一个不和谐的社区，在那里你可以很容易地得到帮助。</li><li id="8f7e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">相当光滑和直观的用户界面。最重要的是，您可以通过仪表板直接查看和执行SQL查询。不过，我认为使用像<a class="ae ky" href="https://tableplus.com/" rel="noopener ugc nofollow" target="_blank"> TablePlus </a>或<a class="ae ky" href="https://www.pgadmin.org/" rel="noopener ugc nofollow" target="_blank"> pgAdmin </a>这样的数据库工具会方便得多。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl oa"><img src="../Images/ebd93542575f650b6e0841ec515c2f51.png" data-original-src="https://miro.medium.com/v2/format:webp/0*NQNaIGZY6CNBGilX.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您只能在默认数据库名称<code class="fe ob oc od oe b">railway</code>上查看和执行SQL查询</p></figure><ul class=""><li id="3c2c" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">仪表板还提供了关于数据库使用情况的CPU、内存和网络指标；这在Heroku的免费等级中是没有的。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/10ef1e47ded3bedabb02cc0b6b3649d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K8iHVbLrT4K0590i.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">铁路PostgreSQL仪表板指标</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6060" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">如何迁移</h1><p id="c135" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">迁移是小菜一碟。这很容易成为促使我决定迁移到铁路邮政的推动因素之一。</p><h2 id="2471" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">先决条件</h2><ol class=""><li id="8f69" class="na nb it lb b lc mv lf mw li og lm oh lq oi lu oj ng nh ni bi translated">在您的机器上本地安装了<code class="fe ob oc od oe b">postgresql</code>。例如，如果你在苹果电脑上——<code class="fe ob oc od oe b">brew install postgresql</code></li><li id="b18e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu oj ng nh ni bi translated">确保您可以运行<code class="fe ob oc od oe b"><a class="ae ky" href="http://www.postgresql.org/docs/current/static/app-pgrestore.html" rel="noopener ugc nofollow" target="_blank">pg_restore</a></code>命令</li></ol><h2 id="1577" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">设置铁路</h2><ol class=""><li id="b818" class="na nb it lb b lc mv lf mw li og lm oh lq oi lu oj ng nh ni bi translated">设置一个<a class="ae ky" href="https://railway.app/" rel="noopener ugc nofollow" target="_blank">铁路</a>账户</li><li id="d307" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu oj ng nh ni bi translated">转到您的铁路仪表板，创建一个新项目并提供PostgreSQL</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b76456c0d28fd4d0f1d222192b443a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ftW5Pg_VOs6-9JE7.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">记下“连接”或“变量”选项卡下的数据库凭据。你以后会需要它们的。</p></figure><h2 id="91d1" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">5个迁移步骤</h2><ol class=""><li id="8c8e" class="na nb it lb b lc mv lf mw li og lm oh lq oi lu oj ng nh ni bi translated">导出Heroku Postgres ( <a class="ae ky" href="https://devcenter.heroku.com/articles/heroku-postgres-import-export" rel="noopener ugc nofollow" target="_blank">参考</a>)。</li></ol><pre class="kj kk kl km gt ol oe om on aw oo bi"><span id="d0c8" class="no me it oe b gy op oq l or os">heroku pg:backups:capture -a &lt;heroku_app_name&gt;<br/>heroku pg:backups:download -a &lt;heroku_app_name&gt;</span></pre><p id="3160" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.在你当前的工作目录下，你应该看到<code class="fe ob oc od oe b">latest.dump</code>文件</p><pre class="kj kk kl km gt ol oe om on aw oo bi"><span id="8230" class="no me it oe b gy op oq l or os">$ heroku pg:backups:capture -a &lt;heroku_app_name&gt;</span><span id="208d" class="no me it oe b gy ot oq l or os">Starting backup of postgresql-encircled-90125... done<br/>Use Ctrl-C at any time to stop monitoring progress; the backup will continue running.<br/>Use heroku pg:backups:info to check progress.<br/>Stop a running backup with heroku pg:backups:cancel.<br/>Backing up DATABASE to b001... done</span><span id="2e93" class="no me it oe b gy ot oq l or os">$ heroku pg:backups:download -a &lt;heroku_app_name&gt;<br/>Getting backup from ⬢ &lt;heroku_app_name&gt;... done, #1<br/>Downloading latest.dump... ████████████████████████▏  100% 00:00 309.99KB</span><span id="5cc0" class="no me it oe b gy ot oq l or os">$ ls<br/>latest.dump</span></pre><p id="eb3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.在与<code class="fe ob oc od oe b">latest.dump</code>相同的工作目录中，运行下面的命令将下载的数据库转储文件导入到您的Railway Postgres中。使用您自己的Postgres证书进行相应更新:</p><pre class="kj kk kl km gt ol oe om on aw oo bi"><span id="4467" class="no me it oe b gy op oq l or os"># NOTE:<br/># Keep PGDATABASE as `railway` if you want to view your tables via the Railway dashboard.<br/># If you insist on another database name, you will have to create your own database via psql command.<br/>#<br/># E.g.:<br/># PGPASSWORD=$PGPASSWORD psql -h $PGHOST -U $PGUSER -p $PGPORT -d $PGDATABASE<br/># CREATE DATABSE your_database_name;</span><span id="1800" class="no me it oe b gy ot oq l or os">PGPASSWORD=$PGPASSWORD pg_restore -h $PGHOST -U $PGUSER -p $PGPORT -d $PGDATABASE &lt; latest.dump</span></pre><p id="c78d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.验证您的数据是否正确导入。为此，您可以使用步骤4中的示例所示的<code class="fe ob oc od oe b">psql</code>命令，或者通过类似pgAdmin的工具连接到您自己的数据库。</p><p id="fda8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.转到您现有的应用程序，例如Heroku应用程序，并相应地更新数据库连接URL/凭据。</p><p id="412b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！</p><h1 id="632e" class="md me it bd mf mg ou mi mj mk ov mm mn jz ow ka mp kc ox kd mr kf oy kg mt mu bi translated">我想念Heroku数据剪辑</h1><p id="e1b5" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">Heroku Postgres让我非常怀念的一点是它与<a class="ae ky" href="https://devcenter.heroku.com/articles/dataclips" rel="noopener ugc nofollow" target="_blank"> Dataclips </a>共享查询结果的能力。Heroku Dataclips非常有用，因为您可以轻松地:</p><ol class=""><li id="f8b2" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu oj ng nh ni bi translated">通过用户界面进行SQL查询</li><li id="9cfb" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu oj ng nh ni bi translated">通过链接共享JSON或CSV格式的输出</li></ol><p id="ead6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你有了一个可共享的CSV链接，你就可以很容易地把它导入到其他SaaS，比如Google Sheets。最重要的是，大多数数据处理SaaS支持CSV开箱即用；这使得Dataclip非常有用。</p><p id="5e8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我要么在另一台服务器上生成自己的CSV，要么祈祷我使用的SaaS集成了PostgreSQL(提示:大多数没有)。</p><p id="26f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">话虽如此，我还是很乐意做出这样的权衡。</p><h2 id="b692" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">其他用途</h2><p id="8fd4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">除了使用Railway作为我的项目的PostgreSQL数据库服务器，我还使用它来托管我自己的<a class="ae ky" href="https://umami.is/" rel="noopener ugc nofollow" target="_blank">鲜味</a>分析网站和<a class="ae ky" href="https://vercel.com/" rel="noopener ugc nofollow" target="_blank"> Vercel </a>。</p><p id="733a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还推荐你去看看他们的其他产品，比如Redis，MongoDB，还有他们的项目模板。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2604" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结束语</h1><p id="70a0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">不，我不会完全离开赫罗库。赫罗库经受住了时间的考验。我希望Salesforce旗下的公司能够提供更好的可靠性和稳定性。</p><p id="6591" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除此之外，Heroku的<a class="ae ky" href="https://elements.heroku.com/addons" rel="noopener ugc nofollow" target="_blank">附件</a>经常派上用场。附加组件提供了开箱即用的有用集成，例如日志记录、搜索等等！</p><p id="a11c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，我不能保证铁路的可靠性和正常运行时间。话虽如此，我正在运行的项目允许我承担这种程度的风险，到目前为止，我的体验非常好。</p><p id="504c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我支持铁路。我只是喜欢看市场上的竞争。</p><p id="bce2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt ol oe om on aw oo bi"><span id="06fb" class="no me it oe b gy op oq l or os"><strong class="oe iu">Want to Connect?</strong></span><span id="ddd6" class="no me it oe b gy ot oq l or os">This article was originally published at <a class="ae ky" href="https://jerrynsh.com/saying-goodbye-to-heroku-postgres/" rel="noopener ugc nofollow" target="_blank">jerrynsh.com</a></span></pre></div></div>    
</body>
</html>