<html>
<head>
<title>Phoenix 1.6 With TypeScript and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Phoenix 1.6，带TypeScript和React</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/phoenix-1-6-with-typescript-react-bea7f3a792d5?source=collection_archive---------2-----------------------#2022-01-01">https://betterprogramming.pub/phoenix-1-6-with-typescript-react-bea7f3a792d5?source=collection_archive---------2-----------------------#2022-01-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c0b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">仙丹、凤凰、打字稿和反应——2022年版</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4c195cc58ba5b4ef66e4992ad08e638d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H5544gnRnvK6C6LR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@lukesouthern?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢克·南</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><blockquote class="kw kx ky"><p id="7134" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="iq">这是我之前的</em> <a class="ae kv" href="https://levelup.gitconnected.com/elixir-phoenix-typescript-and-react-2020-edition-32ceb753705" rel="noopener ugc nofollow" target="_blank"> <em class="iq">文章</em> </a> <em class="iq">关于构建现代Web应用堆栈的2022年更新。</em></p><p id="c311" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">Github上也有代码:<a class="ae kv" href="https://github.com/aisrael/elixir-phoenix-typescript-react" rel="noopener ugc nofollow" target="_blank">aisrael/elixir-phoenix-typescript-react</a>。</p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="0035" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">凤凰1.6的发布带来了一些显著的改进，比如HEEx模板化。然而，对我来说，改善开发者体验的最显著的事情是放弃<code class="fe mg mh mi mj b">webpack</code>而支持<a class="ae kv" href="https://github.com/evanw/esbuild" rel="noopener ugc nofollow" target="_blank"> esbuild </a>。</p><p id="9981" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated"><code class="fe mg mh mi mj b">esbuild</code>不仅承诺更快的构建时间，它支持开箱即用的打字稿<em class="lb"/>，而且添加React也容易得多！</p><p id="9245" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">整个过程已经变得如此简化，以至于在本文中我们可以跳过它的前身的整个部分。</p><p id="73b7" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在，让我们继续使用Elixir和Phoenix 1.6以及TypeScript和React创建一个新项目。</p><h1 id="eaef" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated"><strong class="ak">先决条件</strong></h1><p id="cd12" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">本指南要求您在撰写本文时具备以下指定版本:</p><ul class=""><li id="38d5" class="nh ni iq lc b ld le lg lh md nj me nk mf nl lv nm nn no np bi translated"><a class="ae kv" href="https://www.erlang.org/" rel="noopener ugc nofollow" target="_blank">二郎</a> (24.2+)</li><li id="2b7f" class="nh ni iq lc b ld nq lg nr md ns me nt mf nu lv nm nn no np bi translated"><a class="ae kv" href="https://elixir-lang.org/" rel="noopener ugc nofollow" target="_blank">仙丹</a> (1.13+)</li><li id="b108" class="nh ni iq lc b ld nq lg nr md ns me nt mf nu lv nm nn no np bi translated"><a class="ae kv" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a> (7.6.0+)</li><li id="33c5" class="nh ni iq lc b ld nq lg nr md ns me nt mf nu lv nm nn no np bi translated"><a class="ae kv" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank"> git </a></li><li id="df36" class="nh ni iq lc b ld nq lg nr md ns me nt mf nu lv nm nn no np bi translated"><a class="ae kv" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>与Docker构成</li></ul><p id="f268" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">在macOS上，最简单的入门方法是安装<a class="ae kv" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">家酿</a>，然后用家酿安装Node、Git、Docker、<a class="ae kv" href="https://github.com/asdf-vm/asdf" rel="noopener ugc nofollow" target="_blank"> asdf </a>。</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="038d" class="nz ml iq mj b gy oa ob l oc od">$ brew install node git homebrew/cask/docker asdf</span></pre><p id="3036" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后我们可以使用<code class="fe mg mh mi mj b">asdf</code>来安装Erlang和Elixir:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="e601" class="nz ml iq mj b gy oa ob l oc od">$ asdf plugin add erlang<br/>$ asdf install erlang 24.2<br/>$ asdf global erlang 24.2</span><span id="fbdc" class="nz ml iq mj b gy oe ob l oc od">$ asdf plugin add elixir<br/>$ asdf install elixir 1.13.1<br/>$ asdf global elixir 1.13.1</span></pre><h2 id="ca3f" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">凤凰</h2><blockquote class="kw kx ky"><p id="14d1" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">对于那些已经熟悉Elixir和Phoenix的人来说，您可能希望直接跳到集成TypeScript并使用Phoenix 1.6。</p></blockquote><p id="897d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果您还没有这样做，让我们按照<a class="ae kv" href="https://hexdocs.pm/phoenix/installation.html#content" rel="noopener ugc nofollow" target="_blank"> Phoenix安装说明</a>安装Phoenix。</p><p id="8d9c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">首先，我们需要获得十六进制软件包管理器:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="ca44" class="nz ml iq mj b gy oa ob l oc od">$ mix local.hex<br/>Are you sure you want to install "https://repo.hex.pm/installs/1.13.1/hex-1.0.1.ez"? [Yn]</span></pre><p id="f455" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后安装Phoenix应用程序生成器:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="6dbd" class="nz ml iq mj b gy oa ob l oc od">$ mix archive.install hex phx_new<br/>Resolving Hex dependencies...<br/>Dependency resolution completed:<br/>New:<br/>phx_new 1.6.5<br/>* Getting phx_new (Hex package)<br/>All dependencies are up to date<br/>Compiling 11 files (.ex)<br/>Generated phx_new app<br/>Generated archive "phx_new-1.6.5.ez" with MIX_ENV=prod<br/>Are you sure you want to install "phx_new-1.6.5.ez"? [Yn]</span></pre><p id="fb62" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">您可以使用<code class="fe mg mh mi mj b">mix phx.new --version</code>检查Phoenix安装是否顺利:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="270d" class="nz ml iq mj b gy oa ob l oc od">$ mix phx.new --version<br/>Phoenix installer v1.6.5</span></pre><h1 id="eed1" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">生成Phoenix应用</h1><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="5521" class="nz ml iq mj b gy oa ob l oc od">$ mix phx.new hello --umbrella</span></pre><p id="9792" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这将在当前目录下生成一个名为<code class="fe mg mh mi mj b">hello_umbrella</code>的<a class="ae kv" href="https://elixir-lang.org/getting-started/mix-otp/dependencies-and-umbrella-projects.html" rel="noopener ugc nofollow" target="_blank">凤凰伞项目</a>，目录结构如下:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="b51b" class="nz ml iq mj b gy oa ob l oc od">.<br/>├── apps<br/>│   ├── hello<br/>│   └── hello_web<br/>└── config</span></pre><p id="b232" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这两个Elixir应用是<code class="fe mg mh mi mj b">/apps/hello</code>(领域模型)和<code class="fe mg mh mi mj b">/apps/hello_web</code>(网络应用)。</p><p id="8389" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">每个应用都有自己的依赖配置，尽管整个保护伞项目将为所有应用提供一个共享的依赖库(在<code class="fe mg mh mi mj b">/deps</code>)。</p><p id="71de" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">所有子应用程序也将在<code class="fe mg mh mi mj b">/config</code>文件夹中共享相同的根配置。</p><p id="f659" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我们从伞状项目开始，因为随着应用程序的规模和复杂性的增长，它有助于组织代码。我还发现，将一个伞状项目重构为一个单独的应用程序项目比反过来更容易。</p><p id="20ad" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果你认为你只需要一个单独的应用程序项目，只需使用<code class="fe mg mh mi mj b">mix phx.new hello</code>(没有<code class="fe mg mh mi mj b">--umbrella</code>选项)。</p><h2 id="db84" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">PostgreSQL、MySQL或无</h2><p id="978b" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">默认情况下，Phoenix的数据库使用Postgres。</p><p id="0989" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果您想使用MySQL而不是Postgres，那么您需要使用</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="2802" class="nz ml iq mj b gy oa ob l oc od">mix phx.new hello_react --umbrella --database mysql</span></pre><p id="5441" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果你不需要一个数据库，或者只希望在没有数据库的情况下使用，那么使用</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="a3cc" class="nz ml iq mj b gy oa ob l oc od">mix phx.new hello_react --umbrella --no-ecto</span></pre><p id="4430" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然而，本指南的其余部分假设缺省值为Postgres。</p><h2 id="bb65" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated"><strong class="ak"> Git </strong></h2><p id="ec57" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">此时，我们应该开始使用Git来跟踪我们的更改。如果您不需要使用Git，请随意跳到下一节。</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="26fa" class="nz ml iq mj b gy oa ob l oc od">$ cd hello_umbrella</span><span id="28e0" class="nz ml iq mj b gy oe ob l oc od">~/hello_umbrella$ git init<br/>Initialized empty Git repository in /Users/aisrael/hello_umbrella/.git/</span><span id="8d07" class="nz ml iq mj b gy oe ob l oc od">~/hello_umbrella$ git add -A<br/>~/hello_umbrella$ git commit -m "mix phx.new hello --umbrella"</span></pre><h2 id="96a6" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">Docker撰写</h2><p id="c95b" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">我们需要一个PostgreSQL服务器来运行我们的Phoenix应用程序。对于本地开发和测试目的，我发现使用Docker，或者更确切地说，<a class="ae kv" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"> Docker Compose </a>使得处理服务依赖变得轻而易举。</p><p id="61fa" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">在项目根目录下创建下面的<code class="fe mg mh mi mj b">docker-compose.yml</code>文件:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="8c97" class="nz ml iq mj b gy oa ob l oc od">version: "3"<br/>services:<br/>  postgres:<br/>    image: postgres:14.1<br/>    ports:<br/>      - 5432:5432<br/>    environment:<br/>      POSTGRES_USER: postgres<br/>      POSTGRES_PASSWORD: postgres<br/>      POSTGRES_DB: hello_dev</span></pre><p id="052c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">注意，我们配置PostgreSQL(使用<code class="fe mg mh mi mj b">POSTRES_*</code>环境变量)来处理生成的Phoenix应用程序默认值。</p><p id="e257" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后，要在后台运行Postgres，您只需要:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="fc2f" class="nz ml iq mj b gy oa ob l oc od">$ docker compose up -d<br/>[+] Running 2/2<br/>⠿ Network hello_umbrella_default             Created<br/>⠿ Container hello_umbrella_postgres_1        Started</span></pre><p id="0575" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">对于其他Docker编写命令，请访问<a class="ae kv" href="https://docs.docker.com/compose/reference/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/compose/reference/</a></p><p id="ce9a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">如果您不能或不想使用Docker &amp; Docker Compose，您将不得不在本地工作站上手动安装PostgreSQL。确保使用由<code class="fe mg mh mi mj b">mix phx.new</code>生成的相同默认值对其进行配置，或者使用适当的配置修改各自的<code class="fe mg mh mi mj b">config.exs</code>文件。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="c411" class="mk ml iq bd mm mn oq mp mq mr or mt mu jw os jx mw jz ot ka my kc ou kd na nb bi translated">欢迎来到凤凰城！</h1><p id="b3c4" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">此时，我们应该能够运行我们的Phoenix应用程序了。从项目根目录(您可能希望在新的终端窗口或标签中运行它)，只需:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="76c6" class="nz ml iq mj b gy oa ob l oc od"><br/>~/hello_umbrella$ mix phx.server</span></pre><p id="52fc" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">(如果你得到一个提示，问你是否要安装<code class="fe mg mh mi mj b">rebar3</code>，就说是。)</p><p id="343e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在如果我们访问<a class="ae kv" href="http://localhost:4000" rel="noopener ugc nofollow" target="_blank"> http://localhost:4000 </a>我们应该能够看到熟悉的“欢迎来到凤凰城！”页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/60d62f3fb12f82cfc09bf4a7c307b095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSlrLFH6YUaZ21vk7MWKuA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">欢迎来到凤凰城！</p></figure><h1 id="31ad" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">Phoenix 1.6中的TypeScript</h1><p id="93a9" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">凤凰1.6最好的一点是它抛弃了<code class="fe mg mh mi mj b">webpack</code>而选择了<code class="fe mg mh mi mj b">esbuild</code>。</p><p id="b265" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">这不仅保证了更短的构建时间，<code class="fe mg mh mi mj b">esbuild</code>支持开箱即用的TypeScript <em class="lb">！</em> —不需要更多的工具或配置！</p><h2 id="3631" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">欢迎来到凤凰城</h2><p id="486c" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">为了实际演示TypeScript，让我们创建一个新的TypeScript模块<code class="fe mg mh mi mj b">apps/hello_web/assets/js/greeter.ts</code>:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="a630" class="nz ml iq mj b gy oa ob l oc od">function greet(name: string): string {<br/>  return "Welcome to " + name + " with TypeScript!";<br/>}</span><span id="942a" class="nz ml iq mj b gy oe ob l oc od">export default greet;</span></pre><p id="d34e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后，在<code class="fe mg mh mi mj b">apps/hello_web/assets/js/app.js</code>中，向末尾添加以下几行:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="32d7" class="nz ml iq mj b gy oa ob l oc od">import greet from "./greeter";</span><span id="4cf3" class="nz ml iq mj b gy oe ob l oc od">document.querySelector("section.phx-hero h1").innerHTML = greet("Phoenix");</span></pre><p id="0e18" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">刷新localhost:4000 上的页面，您应该会看到“欢迎来到Phoenix with TypeScript！”：</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/ffa612170595c74fb2f9b573d09f8fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_4XBVE-Wsn_JFO9fX5T9w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">欢迎来到凤凰城！</p></figure><p id="bc58" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">就是这样！无需<code class="fe mg mh mi mj b">npm</code>或摆弄<code class="fe mg mh mi mj b">tsconfig.json</code>和<code class="fe mg mh mi mj b">webpack.config.js</code>！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="8ead" class="mk ml iq bd mm mn oq mp mq mr or mt mu jw os jx mw jz ot ka my kc ou kd na nb bi translated">反应</h1><p id="afa9" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">现在，我们可以将React添加到组合中。为此，我们现在需要<code class="fe mg mh mi mj b">npm</code>来获取并安装必要的包。</p><p id="465d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">首先，确保我们在<code class="fe mg mh mi mj b">apps/hello_web/assets</code>目录中:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="c4ea" class="nz ml iq mj b gy oa ob l oc od">~/hello_umbrella$ cd apps/hello_web/assets</span></pre><p id="3ae4" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">从那里，我们将发出:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="90af" class="nz ml iq mj b gy oa ob l oc od">npm install --save react react-dom<br/>npm install --save-dev <a class="ae kv" href="http://twitter.com/types/react" rel="noopener ugc nofollow" target="_blank">@types/react</a> <a class="ae kv" href="http://twitter.com/types/react-dom" rel="noopener ugc nofollow" target="_blank">@types/react-dom</a></span></pre><h2 id="26c7" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">我们的第一个组件</h2><p id="aff8" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">让我们将<code class="fe mg mh mi mj b">greeter.ts</code>重命名为<code class="fe mg mh mi mj b">greeter.tsx</code>(类似于将常规的<code class="fe mg mh mi mj b">.js</code>文件重命名为<code class="fe mg mh mi mj b">.jsx</code>)。</p><p id="b3db" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">然后，用<code class="fe mg mh mi mj b">Greeter</code>反应组件替换<code class="fe mg mh mi mj b">greeter.tsx</code>的内容:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="8ea0" class="nz ml iq mj b gy oa ob l oc od">import React from "react";</span><span id="47db" class="nz ml iq mj b gy oe ob l oc od">interface GreeterProps {<br/>    name: string;<br/>}</span><span id="3741" class="nz ml iq mj b gy oe ob l oc od">const Greeter: React.FC&lt;GreeterProps&gt; = (props: GreeterProps) =&gt; {<br/>    const name = props.name;<br/>    return (<br/>        &lt;section className="phx-hero"&gt;<br/>          &lt;h1&gt;Welcome to {name} with TypeScript and React!&lt;/h1&gt;<br/>          &lt;p&gt;Peace-of-mind from prototype to production&lt;/p&gt;<br/>        &lt;/section&gt;<br/>    );<br/>};</span><span id="aa35" class="nz ml iq mj b gy oe ob l oc od">export default Greeter;</span></pre><h2 id="0e2b" class="nz ml iq bd mm of og dn mq oh oi dp mu md oj ok mw me ol om my mf on oo na op bi translated">欢迎来到Phoenix与TypeScript和React</h2><p id="9ae4" class="pw-post-body-paragraph kz la iq lc b ld nc jr lf lg nd ju li md ne ll lm me nf lp lq mf ng lt lu lv ij bi translated">接下来，编辑文件<code class="fe mg mh mi mj b">apps/hello_web/lib/hello_web/templates/page/index.html.heex</code>并替换整个部分:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="704e" class="nz ml iq mj b gy oa ob l oc od">&lt;section class="phx-hero"&gt;<br/>  &lt;h1&gt;&lt;%= gettext "Welcome to %{name}!", name: "Phoenix" %&gt;&lt;/h1&gt;<br/>  &lt;p&gt;Peace of mind from prototype to production&lt;/p&gt;<br/>&lt;/section&gt;</span></pre><p id="a8d6" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">只需</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="9850" class="nz ml iq mj b gy oa ob l oc od">&lt;div id="greeting"/&gt;</span></pre><p id="438b" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在，我们需要将<code class="fe mg mh mi mj b">apps/hello_web/assets/js/app.js</code>重命名为<code class="fe mg mh mi mj b">app.jsx</code>，并将之前添加的最后两行替换为:</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="41bd" class="nz ml iq mj b gy oa ob l oc od">import React from "react";<br/>import ReactDOM from "react-dom";</span><span id="1bb0" class="nz ml iq mj b gy oe ob l oc od">import Greeter from "./greeter";</span><span id="0518" class="nz ml iq mj b gy oe ob l oc od">const greeting = document.getElementById("greeting");<br/>ReactDOM.render(&lt;Greeter name="Phoenix" /&gt;, greeting);</span></pre><p id="643d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">(我们需要将其从<code class="fe mg mh mi mj b">.js</code>重命名为<code class="fe mg mh mi mj b">.jsx</code>，以避免最后一行出现语法错误。)</p><p id="1293" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">最后，我们需要编辑<code class="fe mg mh mi mj b">config/config.exs</code>来告诉esbuild寻找<code class="fe mg mh mi mj b">app.jsx</code>而不是<code class="fe mg mh mi mj b">app.js</code>。寻找从<code class="fe mg mh mi mj b"># Configure esbuild</code>开始的部分，并替换该部分</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="0b7f" class="nz ml iq mj b gy oa ob l oc od">~w(js/app.js --bundle --target=es2017 --outdir=../priv/static/assets --external:/fonts/* --external:/images/*),</span></pre><p id="2707" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">随着</p><pre class="kg kh ki kj gt nv mj nw nx aw ny bi"><span id="e0de" class="nz ml iq mj b gy oa ob l oc od">~w(js/app.jsx --bundle --target=es2017 --outdir=../priv/static/assets --external:/fonts/* --external:/images/*)</span></pre><p id="54eb" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">此时，我们可能需要重启我们的Phoenix服务器(按下<code class="fe mg mh mi mj b">Ctrl+C</code>然后<code class="fe mg mh mi mj b">(a)bort</code>)并使用<code class="fe mg mh mi mj b">mix phx.server</code>再次重启它。</p><p id="2ca4" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">当我们重新加载http://localhost:4000 时，应该会看到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/4e0b6ae70a286723ef89e5b445001444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aSDhd-dGU81GacyffKxOKQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">欢迎来到Phoenix with TypeScript and React！</p></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="bd70" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">瞧吧！</p><p id="50f2" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">我认为带有<code class="fe mg mh mi mj b">esbuild</code>的Phoenix 1.6提供了我最近在建立一个最现代和最高效的Web应用程序栈时遇到的最好的开发者体验，我希望这篇文章已经让你相信这是多么容易，特别是与以前相比。</p><p id="ed55" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li md lk ll lm me lo lp lq mf ls lt lu lv ij bi translated">现在就去构建你的下一个独角兽网络应用吧！</p></div></div>    
</body>
</html>