<html>
<head>
<title>Set Up Your React Native App to Offer In-App Purchases and Subscriptions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置React原生应用程序以提供应用内购买和订阅</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/react-native-in-app-purchase-subscription-bb7ad18ec5a0?source=collection_archive---------0-----------------------#2020-05-03">https://betterprogramming.pub/react-native-in-app-purchase-subscription-bb7ad18ec5a0?source=collection_archive---------0-----------------------#2020-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="08ad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用JavaScript执行iOS和Android用户交易的详细设置</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6df1f5b77b20040a1a0d25be55c23fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_sydRtY-DM559T3L5cpyKg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ky" href="https://unsplash.com/s/photos/future?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7a2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">许多人认为他们的应用程序主要是收入来源。任何进入移动应用程序开发的明智开发者在选择他们的盈利策略时，至少会考虑ROI(投资回报)。</p><p id="ad8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用内购买是一种可以帮助你赚钱的模式，我们对此有着复杂的感受。秘密已经暴露了——用应用赚钱并不容易。在我们自己的移动产品上进行货币化实验后，我们知道选择正确的收入来源并维持它有多难。</p><h2 id="3124" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是应用内购买？</h2><p id="2d86" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">应用内购买是指从移动设备上的应用购买商品和服务。应用内购买意味着开发者可以免费提供他们的应用，但随后向用户宣传付费升级、功能解锁、特殊商品，甚至其他应用和服务。尽管免费提供基本的应用程序本身，这使得开发者能够获利。</p><h1 id="7179" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">应用内购买的类型</h1><p id="ee8a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">应用内购买包括:</p><ul class=""><li id="11e6" class="ne nf it lb b lc ld lf lg li ng lm nh lq ni lu nj nk nl nm bi translated"><strong class="lb iu">消耗品:</strong>比如游戏币，生命值，提示。用户需要重复购买这些物品，每次他们想使用它们时——它们不能在未来免费使用。在重新安装或更换设备时，用户可能会丢失他们的消费品。</li><li id="1d4d" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated"><strong class="lb iu">非消耗性:</strong>比如将app升级到pro版本或者移除广告。用户只需购买一次这些物品，就可以免费持续使用。在重新安装或更换设备时，这些产品会被保留下来——如果用户丢失了他们的非消耗品，他们可以通过恢复应用内购买再次免费下载。</li><li id="4d9d" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated"><strong class="lb iu">非续保:</strong>例如，一个月、三个月或六个月的运动时段通行证。用户可以在一段固定的时间内使用这些项目，并可以选择在期限结束时再次购买。</li><li id="068e" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated"><strong class="lb iu">自动续费订阅:</strong>用户可以在指定的时间段内购买这些项目，当该时间段过后，他们会自动续费。例如，持续服务(网飞、Hulu Plus等)或杂志订阅。</li></ul><h2 id="f250" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">应用内购买产品创建</h2><p id="b5b0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">对于应用内购买，你需要向用户提供产品——订阅或一些硬币——在应用中向用户展示。</p><p id="bdbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把产品想象成不同的包装，展示给用户购买。所以，你应该在iOS版的iTunes Connect和Android版的谷歌Play商店控制台中创建一个或两个以上的产品。</p><p id="42b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ns">要为您的应用程序启用应用内购买，您应该拥有iOS的</em><a class="ae ky" href="https://itunesconnect.apple.com/" rel="noopener ugc nofollow" target="_blank"><em class="ns">iTunes Connect</em></a><em class="ns">帐户和Android的</em> <a class="ae ky" href="https://play.google.com/apps/publish/signup/" rel="noopener ugc nofollow" target="_blank"> <em class="ns">谷歌Play商店控制台</em> </a> <em class="ns">帐户。</em></p><p id="dc8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始在应用程序中实现应用内购买。以下是我们必须遵循的步骤:</p><ul class=""><li id="a2dc" class="ne nf it lb b lc ld lf lg li ng lm nh lq ni lu nj nk nl nm bi translated">在谷歌Play商店控制台上配置应用内购买。</li><li id="9bee" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">在React native中配置<code class="fe nt nu nv nw b"><a class="ae ky" href="https://github.com/dooboolab/react-native-iap#readme" rel="noopener ugc nofollow" target="_blank">react-native-iap</a></code>库。</li></ul><h2 id="1d70" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">1.在iTunes Connect上配置应用内购买(适用于iOS)</h2><p id="bfdc" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><strong class="lb iu"> <em class="ns">重要提示:</em> </strong> <em class="ns">在您创建应用内购买之前，Apple要求您申请并填写他们的付费应用合同。</em></p><p id="d6fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此处登录您的App Store Connect帐户</p><p id="7f48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://appstoreconnect.apple.com/】</p><p id="5664" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到“协议、税务和银行”部分。你会在页面顶部看到申请付费应用合同的链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/005320cea87518c34bec42a430c49cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aplWF7VbA8ob6o0DVtkBAA.png"/></div></div></figure><p id="a6e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">索取并填写付费申请合同。</p><p id="dc6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是非常重要的。在苹果允许你对应用内购买收费之前，你需要有付费应用合同。确保您填写了所有的联系信息、银行信息和税务信息。如果其中任何一项没有填写，与苹果的合同就没有完成，因此应用内购买将不起作用。</p><p id="451b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经填写了付费应用程序合同，您需要将产品(应用程序内购买)添加到您的应用程序列表中。</p><p id="6e0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前往您的“App Store Connect”帐户的“我的应用程序”部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/895b63cd42b0724e46b45a1cba02c5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DVOQVQbYGANKnwqWjN6u_Q.png"/></div></div></figure><p id="8161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击你的应用程序进入列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/15628f242656a171dfa75462cffd8c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4hdWQWVCDm1xXDrroSiaA.png"/></div></div></figure><p id="f3f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从顶部的菜单中选择“功能”。</p><p id="d94c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保点击“功能”选项卡后，您进入了左侧菜单的“应用内购买”部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/dc6ec25d366a9cbfddb284a8a1160bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppPHj8YqWnZbzCbMjqpJAw.png"/></div></div></figure><p id="fffa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">通过选择(+)按钮添加应用内购买产品。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/9373d3697c29d12d823c4d31f561c887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7rcJ12juIFr5XFEvJWk9fw.png"/></div></div></figure><p id="a37a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择“非耗材”类型，然后单击“创建”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/6323298f8f6f5b3387a3d97f44c6534f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tq_uJYlV-mqIKaXwXu3ZLw.png"/></div></div></figure><p id="b822" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您的需求进行选择——这取决于您想要创造的产品类型。</p><p id="88d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入参考名称和产品ID。输入一个参考名称是个好主意，它可以清楚地告诉你这个特定的购买将解锁哪个应用内部分。此外，请记下您输入的产品ID，因为您还需要在应用程序控制面板上输入产品ID。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/ee7a915a8ade8b49471ef459deabda30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4CP6-qrKFf1JeCiOKNq-A.png"/></div></div></figure><p id="1224" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择您要为此特定购买收取的价格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/27918721d92339b68cc9b2eb56547421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zxw3fDIRbXaBtJyYoHZ2Q.png"/></div></div></figure><p id="ca51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入此次购买的App Store信息。这是将在App Store上显示的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/27918721d92339b68cc9b2eb56547421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zxw3fDIRbXaBtJyYoHZ2Q.png"/></div></div></figure><p id="cbd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入采购的审核信息。截屏(至少需要640 x 920像素)和您提供的信息不会显示在App Store上——它仅用于Apple的审查目的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/2c193a7683e2bc3c5ac987971b002a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCGkzKuFOZ1ijkP3lrvlpg.png"/></div></div></figure><p id="270a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击右上角的“保存”。</p><p id="1d96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经创建了应用内购买，您需要将产品ID添加到应用的控制面板。</p><p id="97b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你的应用程序控制面板中，从左侧菜单转到“商务”部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/7eed2563fa7bdb1eeaa1775964984e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8VEd5w8nU7fcdgFlQM7tQ.png"/></div></div></figure><p id="82c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从您添加到iOS产品ID栏的App Store Connect帐户中复制并粘贴产品ID</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/077012cb089cec9a33e5cad1f9155419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BrfxoTP8OFOIu2C1Um9GzA.png"/></div></div></figure><p id="6b71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入产品id后，单击“添加”按钮进行保存。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/883b8f04a3775c98565733bede7b547c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pj1cmUszVmin-nyTTE1fEw.png"/></div></div></figure><p id="2ee9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ns">你必须在</em> <strong class="lb iu"> <em class="ns"> XCode </em> </strong> <em class="ns">设置中配置的最后一件事，打开XCode并选择项目，转到功能部分，启用</em> <strong class="lb iu"> <em class="ns"> InApp购买</em> </strong> <em class="ns">按钮。</em></p><h2 id="bca8" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak"> 2。在谷歌Play商店控制台上配置应用内购买</strong></h2><p id="6ed7" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><strong class="lb iu">重要提示:</strong>在您可以在android中创建应用内购买之前，您需要在您的Google开发者帐户中激活一个商家帐户。</p><p id="e619" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里登录你的谷歌开发者账户:<a class="ae ky" href="https://play.google.com/apps/publish/" rel="noopener ugc nofollow" target="_blank">https://play.google.com/apps/publish</a></p><p id="89b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从左侧菜单中单击“设置”选项卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/bd36d031f2e35538ad4ef4fb16d120a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-gedzGQNd0VE5KZ_4bI62A.png"/></div></div></figure><p id="a72a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">滚动到这一页的底部，你会看到一个链接，激活您的商家帐户。</p><p id="8a28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您激活您的商家帐户时，它看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8b1147327dfa6bb0ecb0188e934e7a88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8m-tEkIFcxHFTcTrlaXlgw.png"/></div></div></figure><p id="ae57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经激活了您的商业帐户，您需要从您的Google Developer帐户获取您的许可证/付费密钥。</p><p id="4a4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从左侧菜单中，选择“所有应用程序”，然后点击您要应用应用内购买的应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/60b2b436d9725b64872657b4c9dc34af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IdJH1wCWd20IcEET27y3bw.png"/></div></div></figure><p id="1816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从左侧菜单中选择“开发工具”下的“服务和API”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/0ae496016a71ebcf8ab7543a4b5fd677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_IY1SzlieQV9iwxTweRZ6w.png"/></div></div></figure><p id="2fdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制标题为“此应用程序的许可密钥”部分中的许可密钥</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/127dc20268a317327cc3bc87b786eefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTZYkL8dT1M5-JdRxrNVTA.png"/></div></div></figure><p id="05c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将您的许可证/计费密钥上传到应用程序控制面板的商务部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/413b49add2aa665cadf140baf8b08d98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OgiNpT4r-_41wq_JeGNnyw.png"/></div></div></figure><p id="2c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经激活了您的商家帐户，并上传了您的许可证/付费密钥。</p><p id="a7c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击您的应用列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/3f456d9dff169d260070554735f12429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bNoig8QM23oHOyMyuDKxQ.png"/></div></div></figure><p id="7939" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从左侧菜单中点击“应用内产品”标签。</p><p id="2fc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的应用程序已经在Play Store上发布，并且您刚刚加入了应用程序内购买，则应用程序内产品部分位于应用程序列表的Store Presence选项卡下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/bd9758e263e16685d9ec734b2ba74101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zE50WPSEX0lMW9T7wLsc6Q.png"/></div></div></figure><p id="c320" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保选择了“被管理产品”，然后单击“创建被管理产品”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/60b015d95e35acca5e7dd065f0a250fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4CuJaWkmzpdYJiGN5EgmiA.png"/></div></div></figure><p id="be2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入您的产品ID。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/a8cdd63d6c01a6d3dfea1093500fed16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cl_7KyaRugeNuYxAm7aTXg.png"/></div></div></figure><p id="1563" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入您的标题和描述，然后将状态更改为活动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0b974efd6c8b7e391bcffe636d260cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bb-R_-_I7JzLfG_QQJAQew.png"/></div></div></figure><p id="4908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置价格，然后点击页面底部的“保存”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/ea6846077181e3ba9f24533af27aad30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQoJNLUSG35COSJGgcniog.png"/></div></div></figure><p id="1a29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经创建了应用内购买，您需要将产品ID添加到您的应用控制面板。</p><p id="f47d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在应用程序控制面板中，从左侧菜单转到商务部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/0a0587e12c3e73b1b7b3a8ec0e5d0e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z0YxpwU-MX--vtReST7MAw.png"/></div></div></figure><p id="c2ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从您之前在Google Play产品ID字段中输入的Google开发者帐户中复制并粘贴产品ID。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/b303deee9a0fb1867cb0799991d14894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNCXAZCghUJP0PP96BSBiA.png"/></div></div></figure><p id="9062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入产品id后，单击“添加”按钮进行保存。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/34d2338cf98e27fd7af0bf29adef9c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GFu7MiwZ2YNHxe6sQFWIg.png"/></div></div></figure><p id="b585" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ns">还有一件事你必须在Android中配置:你必须在Android Manifest.xml中提交带有以下权限的alpha或beta版本:</em></p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="17bc" class="lv lw it nw b gy om on l oo op">&lt;uses-permission android:name=”com.android.vending.BILLING” /&gt;</span></pre><h2 id="07df" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">3.在React native中配置<code class="fe nt nu nv nw b"><a class="ae ky" href="https://github.com/dooboolab/react-native-iap#readme" rel="noopener ugc nofollow" target="_blank">react-native-iap</a></code>库</h2><p id="64bd" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><code class="fe nt nu nv nw b">react-native-iap</code>是一个react原生模块库，用于Android和iOS平台的应用内购买。</p><p id="ef8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个库的目标是在两个平台之间获得应用内购买的体验。</p><p id="868d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装<code class="fe nt nu nv nw b">react-native-iap</code>，你只需要在项目终端运行以下命令之一:</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="782a" class="lv lw it nw b gy om on l oo op">npm i react-native-iap</span></pre><p id="2f4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="c00d" class="lv lw it nw b gy om on l oo op">yarn add react-native-iap</span></pre><p id="b56f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从React Native 0.60及更高版本开始，<a class="ae ky" href="https://github.com/react-native-community/cli/blob/master/docs/autolinking.md" rel="noopener ugc nofollow" target="_blank">链接为自动</a>。所以你<em class="ns">不需要</em>跑<code class="fe nt nu nv nw b">react-native link</code>。</p><p id="4f10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你在Mac上开发iOS，你需要安装pods(通过<a class="ae ky" href="https://cocoapods.org/" rel="noopener ugc nofollow" target="_blank"> Cocoapods </a>)来完成链接:</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="8872" class="lv lw it nw b gy om on l oo op">npx pod-install ios</span></pre><p id="b956" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在应用内购买的设置已经完成，我们应该在React native中看到代码部分。</p><p id="5522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们应该从<code class="fe nt nu nv nw b">react-native-iap</code>导入RNIap，就像这样:</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="fff7" class="lv lw it nw b gy om on l oo op">import RNIap, {<br/>    Product,<br/>    ProductPurchase,<br/>    PurchaseError,<br/>    acknowledgePurchaseAndroid,<br/>    purchaseErrorListener,<br/>    purchaseUpdatedListener,<br/>} from 'react-native-iap';</span></pre><p id="3571" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你必须为iOS和Android分别定义你的产品SKU:</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="8e73" class="lv lw it nw b gy om on l oo op">const itemSkus <strong class="nw iu">=</strong> Platform.select({<br/> ios<strong class="nw iu">: </strong>[<br/>  'com.example.productId'<br/> ],<br/> android<strong class="nw iu">:</strong> [<br/>  'com.example.productId'<br/> ]<br/>});</span></pre><p id="92aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还必须分别为iOS和Android定义您的产品订阅:</p><pre class="kj kk kl km gt oi nw oj ok aw ol bi"><span id="d2e7" class="lv lw it nw b gy om on l oo op">const itemSubs <strong class="nw iu">=</strong> Platform.select({<br/> ios<strong class="nw iu">: </strong>[<br/>  'test.sub'<br/> ],<br/> android<strong class="nw iu">:</strong> [<br/>  'test.sub'<br/> ]<br/>});</span></pre><p id="e974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以使用<code class="fe nt nu nv nw b">itemsSkus</code>和<code class="fe nt nu nv nw b">itemsSubs</code>继续获取您的应用内购买产品，如图所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><h1 id="b10b" class="mt lw it bd lx mu oz mw ma mx pa mz md jz pb ka mg kc pc kd mj kf pd kg mm nd bi translated">测试</h1><p id="7f8b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们通过让任何用户购买一件产品来检查应用内购买功能。</p><p id="57b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于iOS，我们为此创建了一个沙盒测试器。</p><p id="c4af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到iTunes中的“用户和角色部分”，选择“沙盒测试者”标签，添加一个新用户作为测试者，并提供一些基本信息。有了该用户的凭证，你可以在iOS上购买任何产品，而无需支付任何实际费用，并在iOS应用程序中测试应用程序购买功能。</p><p id="bc6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在Android中添加测试者帐户，请打开play store控制台，转到“设置”部分，然后转到“帐户详细信息”选项卡，向下滚动到<strong class="lb iu">“</strong>许可证测试”并添加您想要添加为测试者的用户的电子邮件。您可以使用这些测试者帐户凭证在Android应用程序中测试应用内购买功能。</p><p id="1a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一点要补充:要检查应用内购买，你的Android版本必须处于发布模式——你不能在调试版本中测试。</p></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><p id="d881" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这样，现在您可以对您的应用内购买进行配置并进行测试。</p><p id="324c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:应用内购买不能在iOS模拟器或Android模拟器上测试——请使用真实设备。</p><p id="396b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢大家！</p></div></div>    
</body>
</html>