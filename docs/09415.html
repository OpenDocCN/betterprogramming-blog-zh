<html>
<head>
<title>7 Tips for Empathetic Code Reviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">感同身受的代码审查的7个技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/7-tips-for-empathetic-code-reviews-901e8b049a88?source=collection_archive---------2-----------------------#2021-08-23">https://betterprogramming.pub/7-tips-for-empathetic-code-reviews-901e8b049a88?source=collection_archive---------2-----------------------#2021-08-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8bc2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">诚实容易，善良难</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/36346212d5e5b1b499798c7ddc592fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-7ICSLvsQVE3opQt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="e77f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">审查你同事的代码是困难的。你开始关注代码中的所有缺陷，因为这正是你所需要的。但在这个过程中，很难保持冷静，说白了，也很难不做一个混蛋。以下是我的一些建议，可以让你保持头脑冷静，专注于寻找解决方案。</p><h1 id="321b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">不要从阅读代码开始！</h1><p id="a0ea" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">通常直接从代码开始并不是最好的主意。审查代码意味着你判断它是否是一个适合问题的解决方案，它是否符合需求。所以你最好先读一下。这可能出现在“拉”请求的描述、票据的链接或提交消息中。之后，你仍然不应该阅读代码，而是测试。从需求中，您可以很好地了解测试是否与需求相匹配。您还可以在使用函数签名的上下文中看到它们。在您确认测试和需求对您有意义之后，继续阅读代码。</p><h1 id="f5e7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">当心WTF时刻</h1><p id="4b22" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">不可避免地，你会遇到对你没有意义的测试和代码。或者只有在第三、第五或第十次重读时才有意义。这些时刻是我在评论中寻找的主要内容之一。美妙之处在于，你不需要成为语言或框架方面的专家就能发现它们。有时候，如果你以初学者的心态去做，事情会变得更简单。最近的一个例子是一个函数，它根据作为参数之一的布尔标志，在数据结构中添加或删除一个元素。既然发现了值得评论的东西，就准备猛扑了吧？</p><h1 id="90aa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">你能把你的评论变成一个问题吗？</h1><p id="792c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们已经做到了，我们发现了一个bug，一个没有被覆盖的边缘案例，或者被一段违背干净代码本质的代码绊倒。渴望展示我们的智慧，我们开始输入“这实际上是错误的，因为…”。<br/>或者我们从另一个角度来看这件事。作为一名初级开发人员，你努力开发一个新特性，但当涉及到评审时，它会被诸如“这不行”、“你没有考虑输入X”、“你为什么不直接用Y”之类的评论否决。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/a08edd0bfdf380451fe3920c396c2dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9lU01eKtgO7_5uOF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·施诺布里奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都是出于好意，防止错误和不合标准的代码，但也可能是有害的。像“这是错误的”这样的陈述会给人一种咄咄逼人的感觉，它们会阻止任何关于更好解决方案的讨论。如果你把它重新表述为一个问题，比如“这个对输入X有效吗？”或者“当这个变量为空时会发生什么？”展开讨论。如果事实证明你错了，也不会那么尴尬。</p><p id="d1bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一条规则，不要以“为什么”开始你的问题。我从克里斯·沃斯的书《永远不要分割差异》中学到了这一点。以“为什么”开头的问题通常与指责联系在一起，使作者处于防御地位，并转移对问题的关注。把它变成“是什么”或“如何”会给人一种更合作的感觉。如果有疑问，我喜欢把问题变成“你为什么使用这个库？”变成“你怎么会用这个图书馆？”。代码审查可能不像人质谈判那样紧张，但是我们仍然可以从中学习。</p><h1 id="22ff" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">为学习而优化</h1><p id="fc76" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们的代码审查的主要优先事项是检查代码是否干净、没有bug并且经过良好的测试。但是从长远来看，如果你的评审是确保高编码标准所必需的，那么你就会陷入困境。你最终每周都要审查更多的代码，并且不相信你在度假时写的任何东西。最理想的情况是，您希望您的同事提高他们的编码技能，并满怀信心地审查代码。</p><p id="b00e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不是提供一个具体的解决方案，而是问一个问题可以吗？人们通过自己解决问题学得更好。将这一点发挥到极致，你几乎可以通过询问作者如何看待他们自己的作品来扭转代码审查的局面。“你觉得这个函数好理解吗？”，“你认为你能优化这个的时间复杂度吗？”。这里有一个警告:需要清楚你的目标是什么，你需要对什么是干净有效的代码有一个共同的理解。我发现<a class="ae ky" href="https://davidmarquet.com/turn-the-ship-around-book/" rel="noopener ugc nofollow" target="_blank">《扭转乾坤》</a>这本书对这种教练风格很有启发。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/e92a5efaa1809ff172cdd30d55b7fadf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gn77NkB-7DDdeZS4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@kaleidico?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">万花筒</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="8431" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">谁是专家？</h1><p id="750b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当你在整理你的评论和修改时，记住一件事:谁在你正在审查的代码上花费了最多的时间？当然是作者。他们将会更详细地阅读需求，花更多的时间阅读他们正在使用的复杂的库，并且爱抚测试直到他们通过。有时情况并非如此，例如当你有一个新的或初级的团队成员时。无论哪种方式，当你开始评审时，把作者当作代码方面的专家。它将解析成一个更平衡的代码判断。</p><h1 id="3655" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">务实点</h1><p id="e1b6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">人们很容易迷失在为性能和易读性而优化代码的错综复杂中。但是在一天结束的时候，是部署的代码和解决的客户问题会支付你的薪水。所以没有理由纠结于小事。要找到提高关键可读性和吹毛求疵之间的界限并不容易，但是这里有一些经验法则。</p><ul class=""><li id="88d1" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">它把代码放在比以前更好的地方了吗？这是鲍勃叔叔的童子军规则。如果一个变更主要是重构现有代码，并且变更比旧代码更好，那么就去好了。</li><li id="c516" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">你剩下的评论里有“我更喜欢”这几个字吗？在代码中总是有几种表达需求的方式，如果你支持或反对某个变化的主要理由是你的偏好，那么你最好不要写那个注释。</li><li id="d23a" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">问问你自己:为了让我批准这个变更，为了让作者完成他们的任务，这个变更缺少了什么？没有人喜欢没完没了的代码审查。将它与你的同事陷入实施修复和延迟变更的成本相比较，会将它放在不同的环境中。一些最初的评论可能被证明是无关紧要的。</li></ul><h1 id="7bde" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">个性化</h1><p id="f41c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果您发现自己在代码评审中对一个注释来回走，那么进一步的注释不太可能解决问题。相反，抓住作者，面对面地讨论问题。迄今为止，这每次都解决了分歧。不幸的是，当你在同一个办公室工作时，这要容易得多，远程工作在这种情况下没有帮助。但是有足够多的工具可以让你在几秒钟内建立视频通话。</p><h1 id="2c6c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">最后的想法</h1><p id="f66c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">以下是我对移情式代码评审的顶级建议:从需求和测试开始，寻找WTF时刻，将评论转化为问题，为学习而优化，将作者视为专家，务实，个性化。</p><p id="b470" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我总是遵循所有这些吗？不要！我和他们中的每一个人都对抗过，我也学到了很多，我相信这些会让你成为一个更好的软件工程师和更好的队友。</p><p id="3eff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也不是审查代码时要遵循的规则的详尽列表。我对干净代码的定义超出了“它对我来说有意义吗”，但是我选择关注交流。你觉得我错过了什么重要的东西吗？审查代码时，你的首要原则是什么？</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="3132" class="np lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">关于代码评审原则的进一步阅读</h2><ul class=""><li id="4ffb" class="mu mv it lb b lc mn lf mo li ob lm oc lq od lu mz na nb nc bi translated"><a class="ae ky" href="https://blog.palantir.com/code-review-best-practices-19e02780015f" rel="noopener ugc nofollow" target="_blank"> Palantir的代码审查最佳实践</a></li><li id="a197" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="https://itnext.io/im-changing-how-i-review-code-dbf212507e5f" rel="noopener ugc nofollow" target="_blank">文章“我正在改变我评审代码的方式”协作进行代码评审</a>:我喜欢将代码评审视为协作而不是评判的想法。</li><li id="95c6" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">文章<a class="ae ky" href="https://medium.com/inside-league/how-one-code-review-rule-turned-my-team-into-a-dream-team-fdb172799d11" rel="noopener">“一个代码评审规则如何将我的团队变成一个梦之队”</a>:一个好的代码评审实践可以实现什么的例子。</li><li id="abc2" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">文章<a class="ae ky" href="https://stevenheidel.medium.com/what-i-learned-from-doing-1000-code-reviews-fe28d4d11c71" rel="noopener">“我从1000次代码审查中学到了什么”</a>:一些关于寻找什么模式的好建议</li><li id="f43e" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="https://google.github.io/eng-practices/review/reviewer/" rel="noopener ugc nofollow" target="_blank">谷歌的代码审查实践</a></li></ul><h2 id="5f79" class="np lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">资源</h2><ul class=""><li id="6e3f" class="mu mv it lb b lc mn lf mo li ob lm oc lq od lu mz na nb nc bi translated"><a class="ae ky" href="https://www.oreilly.com/library/view/97-things-every/9780596809515/ch08.html" rel="noopener ugc nofollow" target="_blank">鲍勃叔叔的童子军规则</a></li><li id="187c" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="https://davidmarquet.com/turn-the-ship-around-book/" rel="noopener ugc nofollow" target="_blank">调转船头</a></li><li id="7e22" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="https://info.blackswanltd.com/never-split-the-difference" rel="noopener ugc nofollow" target="_blank">绝不分摊差额</a></li></ul></div></div>    
</body>
</html>