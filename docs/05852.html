<html>
<head>
<title>Integrating SwiftUI With UIKit Apps for Early Adoption</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将SwiftUI与UIKit应用集成，以便尽早采用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/integrating-swiftui-with-uikit-apps-for-early-adoption-1d8668442ae5?source=collection_archive---------13-----------------------#2020-08-11">https://betterprogramming.pub/integrating-swiftui-with-uikit-apps-for-early-adoption-1d8668442ae5?source=collection_archive---------13-----------------------#2020-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3385" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你越早开始，你就越早使用SwiftUI做任何事情</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/364809c5938d032f009a1b0283049a57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZU6hGD_sNY-V5Jwm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Thom Bradley 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6ef4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI是在iOS 13推出的，当时我们很多人都有一个用UIKit构建的大应用。SwiftUI让我们充满热情地开始使用这个新框架来构建应用程序，就像Swift首次推出时一样。</p><p id="1f39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当推出Swift时，我们必须从Objective-C迁移到Swift。许多应用程序可能仍在使用(部分)Objective-C，因为这种转变需要相当长的时间。知道如何开始过渡以使这个过程尽可能短是很好的。iOS 14越来越近，你可能<a class="ae ky" href="https://www.avanderlee.com/workflow/minimum-ios-version/" rel="noopener ugc nofollow" target="_blank">会考虑在今年晚些时候放弃iOS 12 </a>，允许你在SwiftUI中编写新视图。因此，这里有一篇文章解释了如何在UIKit应用程序中使用SwiftUI。</p><p id="210e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽早在UIKit应用程序中添加SwiftUI视图将使您未来的自己更加快乐！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="bde1" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在UIKit应用中尽快使用SwiftUI的好处</h1><p id="dfcd" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">从UIKit应用程序过渡到SwiftUI非常耗时，对于较大的应用程序，可能需要数年时间。当Swift推出时，用Objective-C编写的应用程序必须进行同样的转换，并且可能仍然没有完全迁移。因此，尽早采用SwiftUI有几个好处:</p><ul class=""><li id="02bc" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">没有必要在将来把你的新视图重写到SwiftUI上。</li><li id="a0c5" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">您开始学习SwiftUI，同时像平常一样进行开发。</li><li id="b611" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">向SwiftUI的过渡需要时间。你越早开始，你的应用程序就越早完全用SwiftUI编写。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f233" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在UIKit应用中采用SwiftUI时需要考虑的事项</h1><p id="3ca8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">要知道只有iOS 13及以上版本才能使用SwiftUI。最重要的是，SwiftUI是一项新技术，在以后的更新中得到了改进。放弃iOS 12意味着你可以从SwiftUI开始，但也意味着你开始使用SwiftUI的第一个版本。这可能会导致早期的意外行为和错误。</p><h2 id="fdb3" class="no me it bd mf np nq dn mj nr ns dp mn li nt nu mp lm nv nw mr lq nx ny mt nz bi translated">仅对新功能使用SwiftUI</h2><p id="1518" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">您可以决定仅对新功能使用SwiftUI。即使你没有放弃iOS 12，这也是可能的。您将使用可用的API，这使得您新编写的视图仅在支持SwiftUI的版本上可用。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="6e43" class="no me it ob b gy of og l oh oi">if #available(iOS 13.0, *) {<br/>    presentSwiftUIView()<br/>} else {<br/>    // Fallback on earlier versions<br/>}</span></pre><p id="92d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以决定使用SwiftUI提供新功能，这些新功能使您的代码经得起未来考验，因为它消除了在几年内重写代码的需要。这显然只有在你可以决定让某个功能只对iOS 13及以上版本的用户可用的情况下才有效。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a2d6" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在UIKit视图控制器中呈现SwiftUI视图</h1><p id="b12d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">一旦你有了想用SwiftUI开发的特性，就该用SwiftUI框架集成它了。SwiftUI引入了一个名为<code class="fe oj ok ol ob b">UIHostingController</code>的实例，负责“托管”SwiftUI视图。</p><p id="369c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oj ok ol ob b">UIHostingController</code>本身继承自<code class="fe oj ok ol ob b">UIViewController</code>,这使得可以像处理任何其他视图控制器实例一样处理它。因此，呈现SwiftUI视图的代码就像这样简单:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="d5d1" class="no me it ob b gy of og l oh oi">func presentSwiftUIView() {<br/>    let swiftUIView = SwiftUIView()<br/>    let hostingController = UIHostingController(rootView: swiftUIView)<br/>    present(hostingController, animated: true, completion: nil)<br/>}</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f66a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">将SwiftUI视图添加到UIKit视图</h1><p id="cefc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">同样的技术也适用于将SwiftUI视图添加到UIKit视图层次结构中。唯一的区别是，您没有呈现视图，而是将它添加为子视图控制器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="1030" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在这里做一些事情:</p><ul class=""><li id="1a4c" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">首先，我们将宿主控制器作为子控件添加到当前视图控制器中。</li><li id="6b85" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">该视图被添加到当前视图控制器的视图层次结构中。</li><li id="fa78" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">在代码中设置约束来更新SwiftUI视图的边界。你可以在这里了解更多关于用代码<a class="ae ky" href="https://www.avanderlee.com/swift/auto-layout-programmatically/" rel="noopener ugc nofollow" target="_blank">编写自动布局的信息。</a></li><li id="2a44" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">托管控制器被通知其包含的SwiftUI视图已经移动到父视图。</li></ul><h1 id="2fb0" class="md me it bd mf mg oo mi mj mk op mm mn jz oq ka mp kc or kd mr kf os kg mt mu bi translated">创建扩展以简化SwiftUI视图的添加</h1><p id="3cf5" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为了提高效率，我们可以将这个逻辑封装在<code class="fe oj ok ol ob b">UIViewController</code>的扩展中。这允许我们编写与上面相同的代码，如下所示:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="7138" class="no me it ob b gy of og l oh oi">func addSwiftUIView() {<br/>    let swiftUIView = SwiftUIView()<br/>    addSubSwiftUIView(swiftUIView, to: view)<br/>}</span></pre><p id="4741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个扩展看起来与我们之前的代码基本相同:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="aaa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这使得将视图添加到UIKit视图层次结构变得非常容易，甚至允许您将SwiftUI视图添加到界面构建器中定义的容器视图。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="eff0" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="e8d2" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">尽早在UIKit应用程序中添加SwiftUI视图将使您未来的自己更加快乐，因为您不必在以后重写它。通过一个简单的<code class="fe oj ok ol ob b">UIViewController</code>扩展方法，您可以用几行代码轻松地添加一个视图。决定是否可以使用SwiftUI构建新功能，并利用<code class="fe oj ok ol ob b">UIHostingController</code>来呈现SwiftUI视图。</p><p id="d499" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想进一步提高您的SwiftUI知识，请查看<a class="ae ky" href="https://www.avanderlee.com/category/swiftui/" rel="noopener ugc nofollow" target="_blank"> SwiftUI类别页面</a>。</p><p id="0e50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢！</p></div></div>    
</body>
</html>