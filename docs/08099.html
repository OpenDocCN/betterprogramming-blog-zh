<html>
<head>
<title>How To Improve Rendering Performance in a 1,000-Item React List</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何提高包含1000个条目的React列表的渲染性能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-improve-rendering-performance-in-a-1-000-item-react-list-85be129b8c0d?source=collection_archive---------2-----------------------#2021-03-25">https://betterprogramming.pub/how-to-improve-rendering-performance-in-a-1-000-item-react-list-85be129b8c0d?source=collection_archive---------2-----------------------#2021-03-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="b621" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让我们确保我们的web应用程序能够高效滚动</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/501d0e50e2e8c9d6174ad82978bfc893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPrxdN2yGaPHDr8PZo-W2g.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上的<a class="ae kz" href="https://www.pexels.com/photo/marketing-notebook-office-pen-97076/" rel="noopener ugc nofollow" target="_blank">负空格</a>拍摄。</p></figure><p id="9c6d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">假设您正在使用React构建某种应用程序，要求您显示一长串项目。比如说1000件。你有什么选择？就一次渲染全部？</p><p id="f9fc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">今天，我的目标是向您展示问题，以便您了解我们正在解决的问题，然后提出解决方案。</p><p id="ef16" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="6496" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">创建项目</h1><p id="24fa" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">至此，你们都应该知道如何使用<code class="fe na nb nc nd b">create-react-app</code>从命令行创建一个新的React应用程序。只需在您的终端上运行以下命令，即可开始使用全新的React应用程序:</p><pre class="kk kl km kn gu ne nd nf ng aw nh bi"><span id="9ca9" class="ni me iu nd b gz nj nk l nl nm">npx create-react-app long-list-app</span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="5a09" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">让我们渲染1000个项目</h1><p id="2659" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">好吧，我先给你看看问题。看看下面的组件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">手动列表</p></figure><p id="9278" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这个组件中，我们将生成1，000个名字，并将它们呈现在一个列表中。现在让我们在浏览器中查看一下:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj np"><img src="../Images/4c0a5a1117e5996e9deeadf859a9cec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zA89An2T8Jv6h-pR7PAs1w.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">低效渲染</p></figure><p id="5c8c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">虽然我们的窗口能够显示六个项目，但是从控制台上，我们可以看到有1000个项目正在后台呈现！</p><p id="6273" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这种低效的渲染会让你的应用程序非常慢。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="2f32" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">现在给我看看代码！</h1><p id="4849" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">我们将使用一个名为<code class="fe na nb nc nd b"><a class="ae kz" href="https://github.com/bvaughn/react-virtualized" rel="noopener ugc nofollow" target="_blank">react-virtualized</a></code>的很棒的库。这个概念非常简单和优雅:不要渲染你在屏幕上看不到的东西！</p><p id="d83b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先，安装依赖项:</p><pre class="kk kl km kn gu ne nd nf ng aw nh bi"><span id="2722" class="ni me iu nd b gz nj nk l nl nm">yarn add react-virtualized</span></pre><p id="3459" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个库所做的是导出一些包装组件来包装你的列表。您提供高度、宽度和要呈现的函数，库处理其余的。</p><p id="40f6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们更新代码，使用从库中导出的<code class="fe na nb nc nd b">List</code>组件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用react-virtualized更新</p></figure><p id="b311" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们已经用<code class="fe na nb nc nd b">List</code>组件改变了渲染过程。</p><p id="36d8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意这里的一件事:我们传递了一些额外的道具。<code class="fe na nb nc nd b">width</code>、<code class="fe na nb nc nd b">height</code>、<code class="fe na nb nc nd b">rowHeight</code>和<code class="fe na nb nc nd b">rowCount</code>是自解释的，而<code class="fe na nb nc nd b">rowRender</code>是每个行项目的渲染函数。</p><p id="8630" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在让我们看看结果:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj np"><img src="../Images/0bd889b2d68d748f9e80775644e7f800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BycFRJrNF4-bOzzSn8eq4w.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">优化后</p></figure><p id="7ab7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在我们可以看到屏幕上有39个项目，现在正好呈现了39个项目。没有不必要的渲染！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="74b7" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">可变尺寸屏幕</h1><p id="b64d" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">您可能已经注意到，我们给定的容器的高度和宽度是一个常数。但是如果用户的屏幕大小不同呢？你只是不能说，“但它在我的机器上工作！”</p><p id="0f09" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">react-virtualized已经解决了这个问题。它还有另一个名为<code class="fe na nb nc nd b">AutoSizer</code>的组件，帮助动态查找列表容器的高度和宽度。它遵循一个<code class="fe na nb nc nd b">render-props</code>模式。</p><p id="d19f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们像这样更新代码:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用自动筛分机</p></figure><p id="3810" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，屏幕的高度和宽度会根据用户的屏幕大小自动更新。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="4efd" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">可变大小的行</h1><p id="b4ce" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">所以我们解决了容器的高度和宽度问题。但是单独的行项目呢？如果它们的大小因内容而异呢？</p><p id="fcbb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">react-virtualized对此也有解决方案。为此，您需要使用另一个名为<code class="fe na nb nc nd b">CellMeasurer</code>的组件。我们将使用另一个名为<code class="fe na nb nc nd b">CellMeasurerCache</code>的组件来缓存组件的大小。</p><p id="27f3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在看看修改后的渲染过程:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">可变高度行示例</p></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="d9fe" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">结论</h1><p id="138c" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">所以你有它。我只是简单介绍了react虚拟化的可能性，以及它如何帮助我们显著改善低性能React应用程序。</p><p id="178f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">祝您愉快！</p><p id="b377" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">有什么话要说？通过</strong> <a class="ae kz" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv"> LinkedIn </strong> </a>联系我</p><div class="nq nr gq gs ns nt"><a rel="noopener  ugc nofollow" target="_blank" href="/the-7-traits-of-a-rock-star-react-developer-747fbb001c05"><div class="nu ab fp"><div class="nv ab nw cl cj nx"><h2 class="bd iv gz z fq ny fs ft nz fv fx it bi translated">摇滚明星React开发者的7个特质</h2><div class="oa l"><h3 class="bd b gz z fq ny fs ft nz fv fx dk translated">造成差异的习惯</h3></div><div class="ob l"><p class="bd b dl z fq ny fs ft nz fv fx dk translated">better编程. pub</p></div></div><div class="oc l"><div class="od l oe of og oc oh kt nt"/></div></div></a></div></div></div>    
</body>
</html>