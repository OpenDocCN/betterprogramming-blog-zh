<html>
<head>
<title>How To Create a Button With Loading Indicator in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在iOS中创建一个带加载指示器的按钮</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-button-with-loading-indicator-in-ios-b579e063b91c?source=collection_archive---------4-----------------------#2022-10-11">https://betterprogramming.pub/how-to-create-a-button-with-loading-indicator-in-ios-b579e063b91c?source=collection_archive---------4-----------------------#2022-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ba5d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何创建带有内置微调器的按钮</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/acea062ec53c6be16a1a7cea6d179a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAhJ-MM_EM_Njdhzx8cURw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有加载指示器按钮的移动应用程序用户界面。图片作者。</p></figure><p id="dab6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">移动开发中最重要的UI组件之一是按钮。在移动应用程序设计中，我们基本上需要一个加载指示，通过确保用户知道状态已经改变或请求正在被处理来改善用户体验。</p><h1 id="9311" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">入门指南</h1><p id="0761" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在本文中，我们将学习如何:</p><ol class=""><li id="3ff5" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated">使用<a class="ae mx" href="https://developer.apple.com/documentation/uikit/uiactivityindicatorview" rel="noopener ugc nofollow" target="_blank">UIActivityIndicatorView</a>创建一个带有内置加载指示器的自定义<a class="ae mx" href="https://developer.apple.com/documentation/uikit/uibutton" rel="noopener ugc nofollow" target="_blank"> UIButton </a>类</li><li id="01bf" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">在视图控制器中使用自定义按钮。在这个例子中，我们将使用故事板。</li></ol><p id="a3d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，这个项目是在Swift 5中用iOS13+和Xcode 13.4开发的。</p><p id="89c6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是应用程序的最终输出，我们将从本教程中实现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/c77fdf716e388bb4ab6d8b80ae9d98f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KakdKWGbSgGjedBq-X56HA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">本教程的最终输出。图片作者。</p></figure><h1 id="2950" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">1.创建新的UIKit项目</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/8cbc40ad3c765803ab9062d68dbdc8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1b0haZ8nHeu4lNVp0DKeA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建新的UIKit项目</p></figure><h1 id="357e" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">2.创建自定义按钮</h1><p id="4351" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">从“Cocoa Touch Class”模板创建一个新文件，然后选择子类为“UIButton”并将其命名为“LoaderButton”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/ff052db9a713a9cdb95dc89535c15e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wP7Qs64ybnKhLOkinCl9EA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建新的按钮子类</p></figure><p id="d07f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">单击“下一步”，并将以下代码添加到文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="5e0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是添加到该文件中的每个要点的解释:</p><ol class=""><li id="05bc" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated">通过子类化<code class="fe ni nj nk nl b">UIButton</code>创建一个自定义按钮。</li><li id="9f20" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">添加一个<code class="fe ni nj nk nl b">UIActivityIndicatorView</code>作为装载指示器，即“spinner”</li><li id="39ce" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">添加一个<code class="fe ni nj nk nl b">isLoading</code>变量来保持按钮的状态。每次这个变量被更新，它会立即调用<code class="fe ni nj nk nl b">updateView()</code>函数。</li><li id="fed1" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">按钮初始化后，调用<code class="fe ni nj nk nl b">setupView()</code>。</li><li id="8d6e" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">当装载指示器停止动画时，它将总是隐藏。</li><li id="536e" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">添加加载指示器作为按钮子视图，并将约束设置为<code class="fe ni nj nk nl b">view</code>的中间。</li><li id="01d4" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated"><code class="fe ni nj nk nl b">updateView()</code>将保持按钮状态。如果它处于加载状态，标题和图像将被隐藏(透明)并显示加载指示器，反之亦然。</li></ol><p id="2eb9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">太好了。现在，主要部分完成了。让我们尝试将它添加到视图控制器中。</p><h1 id="53de" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">3.在视图控制器中实现</h1><p id="a0fa" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在本节中，我们将向故事板添加自定义按钮，并简单地设置约束。</p><ol class=""><li id="8deb" class="mo mp iq kx b ky kz lb lc le mq li mr lm ms lq mt mu mv mw bi translated">单击右上角的+按钮，从对象库中选择可用的控件。</li><li id="d489" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">找到按钮并将其拖动到视图控制器中。</li><li id="1a35" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">选择右上角的Identity Inspector选项卡，并将类更改为我们刚刚创建的<code class="fe ni nj nk nl b">LoaderButton</code>。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/acbb0e773be9b33c040368f3f6ef49f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Xd_eo9OtN6PzwqASWTjzaQ.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用故事板将UIButton添加到视图控制器中</p></figure><p id="3744" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.将约束设置为垂直居中，水平填充为32，高度等于54。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/d3a24bb52845ad7cb0f8616623879c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvLi0msikRZlJWaP6p2IOQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">设置按钮的约束</p></figure><p id="bd00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">5.现在，我们需要定制按钮的外观。将按钮标题设置为“演示按钮”，将背景颜色更改为蓝绿色，文本颜色更改为白色，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/ac7a6287ea633259f69f0838b5062102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7YVGvCfAXwo3W2zGsVwIw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自定义按钮外观</p></figure><h1 id="8275" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">4.将按钮连接到视图控制器</h1><ol class=""><li id="faeb" class="mo mp iq kx b ky mj lb mk le no li np lm nq lq mt mu mv mw bi translated">选择故事板，并打开助理编辑器。</li><li id="821c" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">通过按住control键并将按钮拖到编辑器，将按钮作为<code class="fe ni nj nk nl b">IBAction</code>连接到代码编辑器。</li><li id="5fad" class="mo mp iq kx b ky my lb mz le na li nb lm nc lq mt mu mv mw bi translated">选择连接作为动作，然后将类型更改为<code class="fe ni nj nk nl b">LoaderButton</code>，并将名称字段输入为<code class="fe ni nj nk nl b">onClickedButton</code>。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/c0dc92880ff38c2f20df2de895cbdd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cal1hRynMOTwrIDV1GbO4w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">连接按钮以动作形式查看控制器</p></figure><h1 id="2922" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">5.更新按钮处理程序</h1><p id="5a55" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在<code class="fe ni nj nk nl b">onClickedButton</code>中，添加下面的代码来模拟一个请求。代码将激活微调器，并等待两秒钟完成。一旦完成，微调将消失，按钮状态将恢复正常。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="e7e1" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">项目已完成</h1><p id="13eb" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">恭喜你。现在，我们已经完成了这个项目，并准备运行。</p><p id="d2af" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完整的源代码可以从我的GitHub <a class="ae mx" href="https://github.com/xmhafiz/medium-custom-loader-button-app" rel="noopener ugc nofollow" target="_blank">库</a>下载。</p><p id="63d6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尝试将它实现到您的项目中，并通过添加更多功能来改进代码。</p><p id="b4e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢您的阅读，祝您编码愉快！</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="af45" class="lr ls iq bd lt lu nz lw lx ly oa ma mb jw ob jx md jz oc ka mf kc od kd mh mi bi translated">参考</h1><p id="2832" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated"><a class="ae mx" href="https://developer.apple.com/documentation/uikit/uibutton" rel="noopener ugc nofollow" target="_blank">ui按钮</a>文档</p><p id="e71d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mx" href="https://developer.apple.com/documentation/uikit/uiactivityindicatorview" rel="noopener ugc nofollow" target="_blank"> UIActivityIndicatorView </a>文档</p><p id="a78c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mx" href="https://github.com/xmhafiz/medium-custom-loader-button-app" rel="noopener ugc nofollow" target="_blank">演示项目GitHub资源库</a></p></div></div>    
</body>
</html>