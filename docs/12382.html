<html>
<head>
<title>Are You Really API-First or Do You Just Think It?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你真的是API第一还是只是觉得？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/are-you-really-api-first-or-do-you-just-think-it-24ffc47ec7ea?source=collection_archive---------11-----------------------#2022-06-01">https://betterprogramming.pub/are-you-really-api-first-or-do-you-just-think-it-24ffc47ec7ea?source=collection_archive---------11-----------------------#2022-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bb30" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">API优先涉及的过程变化和文化变化一样多</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e03d15e77679271ffbdc120125e0071f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RemVAE6PDRLYit32.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@blackodc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">苏三·李</a>在<a class="ae ky" href="https://unsplash.com/s/photos/network?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="3d7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近有机会会见了API领域的<a class="ae ky" href="https://www.postman.com" rel="noopener ugc nofollow" target="_blank">波兹曼</a>高管和其他行业领袖。这是一次可怕的、令人兴奋的、又令人谦卑的经历。我们谈论了从开发者体验到API生命周期到API优先开发，甚至是API前景的未来。</p><p id="0a07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太棒了。</p><p id="2df0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我毫不掩饰我对两件事充满热情:无服务器和API。置身于最热情的API负责人中间令人振奋。</p><p id="71da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们开始围绕API优先开发展开对话时，一些事情引起了我的注意。多年来，我一直在谈论API优先，并认为我正在这样做，但当我们谈论实现的细微差别时，我很快意识到我认为这是一个谎言。</p><p id="70ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧，不是真的撒谎，但是我被误解了。我发现你可能和我一样有错误的印象。</p><p id="b377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们来讨论一下，弄清楚你是真的在开发API优先，还是你只是认为你是。</p><h1 id="23be" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">什么是API优先？</h1><p id="4789" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我永远不会像《邮差》中的<a class="ae ky" href="https://twitter.com/kinlane" rel="noopener ugc nofollow" target="_blank">金巷</a>那样解释这一点。他可以在13分钟内解释成为API第一公司的所有方面。</p><p id="382f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">高层次的，API优先意味着你优先考虑你的API作为你的产品。您在它们的设计、实现、安全性和可发现性中加入了有意的策略。</p><p id="8056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这些特征听起来像是需要重点关注的显而易见的组成部分，但它实际上是区分因素。</p><p id="29b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">传统上，你会看到一些公司将设计、安全性、可发现性等重点放在他们正在构建的应用程序上。这意味着他们向客户提供的全栈应用。这本质上不是问题，但它不是API优先的。</p><p id="2905" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用API-first，上下文就是您的API。这是用来操纵你的系统的机制。你把你的重点放在那里，这样集成商就有和你一样的系统钥匙(除了一些例外)。</p><blockquote class="mt"><p id="cdec" class="mu mv it bd mw mx my mz na nb nc lu dk translated"><em class="nd"> API-first是一种思维方式的转变，从为你的消费者构建定制的应用程序到让他们自己构建。</em></p></blockquote><p id="e4aa" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">消除您创建和维护定制应用的麻烦。为用户提供有意义的开发者体验，他们会以你意想不到的方式改变你的系统。</p><p id="3df1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你认为你已经这样做了，那么我也是。让我们来讨论一下这一切在日常生活中意味着什么。</p><h1 id="e6ab" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">那是什么意思？</h1><p id="e327" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当将API优先的开发付诸实践时，您必须做出的标准流程更改中的细节真正浮出水面。需要改变的不仅仅是事件的顺序，还有组织工作的努力。</p><h2 id="6862" class="nj lx it bd ly nk nl dn mc nm nn dp mg li no np mi lm nq nr mk lq ns nt mm nu bi translated">定义工作</h2><p id="1669" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">定义了API-first第一阶段。API开发的定义阶段不仅仅涉及开发人员。它涉及到业务和产品单元与开发一起工作，以清楚地定义这个API想要带来的功能。</p><p id="5a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">你在努力解决什么业务问题？涉及哪些数据实体？这些实体的生命周期是什么？</em></p><p id="a453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更详细的问题——这应该是一个补丁还是一个PUT，我们应该如何构造端点格式，以及我们如何处理分页——应该已经在您的<a class="ae ky" href="https://blog.postman.com/platform-api-governance/#api-design-consistency" rel="noopener ugc nofollow" target="_blank">治理模型</a>中得到回答和定义。</p><p id="2e81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您还没有合适的治理模型，这将是一个很好的起点。如果您不知道从哪里开始构建治理模型，您可以使用<a class="ae ky" href="https://www.postman.com/postman/workspace/postman-open-technologies-governance-rules/overview" rel="noopener ugc nofollow" target="_blank">Postman Open Technologies Governance Rules</a>集合作为基础。</p><p id="af04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">治理规则意味着被迭代。所以，找到你喜欢的，进行修改，解决任何新出现的问题。</p><p id="f4ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的是你从某个地方开始。</p><p id="d7de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论您是从头开始创建一个全新的API，还是向现有API添加功能，以这种方式处理工作都是一样的。第一步是让小组成员一起讨论业务目标，并清楚地定义问题领域。</p><h2 id="17cf" class="nj lx it bd ly nk nl dn mc nm nn dp mg li no np mi lm nq nr mk lq ns nt mm nu bi translated">拆分故事</h2><p id="d756" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当我第一次开始使用我的API-first版本时，我的印象是它意味着我必须首先处理端点故事。</p><blockquote class="mt"><p id="18d9" class="mu mv it bd mw mx my mz na nb nc lu dk translated"><em class="nd"> API优先并不意味着简单地在你的UI故事之前做你的API故事</em></p></blockquote><p id="7668" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">事实上，在API优先的开发中同时处理UI和API实现是完全可行的。</p><p id="08a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的第一组故事是构建出<a class="ae ky" href="https://www.openapis.org/" rel="noopener ugc nofollow" target="_blank"> API规范</a>，其中包括端点、模式以及请求和响应的示例。一旦这些完成，你就可以<a class="ae ky" href="https://learning.postman.com/docs/designing-and-developing-your-api/mocking-data/setting-up-mock/" rel="noopener ugc nofollow" target="_blank">创建一个模拟服务器</a>，它将以预期的格式返回假数据。</p><p id="1f1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住这一点，当您开始API的真正实现时，您的UI开发就可以开始了。请记住，使用这种开发方法，您将API视为您的产品。基于它构建的任何UI都是增值的。</p><h2 id="f4cd" class="nj lx it bd ly nk nl dn mc nm nn dp mg li no np mi lm nq nr mk lq ns nt mm nu bi translated">测试和监控</h2><p id="70ca" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">弹性和健壮性是API开发的关键成功指标。为了测试这些组件，您的API应该有各种不同的测试，以不同的方式对它们进行测试。</p><ul class=""><li id="43c0" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">契约测试—验证API接受并在请求和响应中返回正确的模式</li><li id="1b34" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">性能测试——确保您的API在预期的时间内返回响应</li><li id="877d" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">安全测试—确定您的API是否具有正确的数据和端点访问控制</li><li id="be14" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">端到端测试—在系统中运行工作流，以确保不同的业务目标可以完成</li></ul><p id="0eb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您不仅应该对您的API进行这些测试，还需要有一种方法来确保它们不会抛出错误。使用任何种类的<a class="ae ky" href="https://www.dynatrace.com/news/blog/what-is-apm-2" rel="noopener ugc nofollow" target="_blank"> APM </a>，像<a class="ae ky" href="https://www.datadoghq.com/" rel="noopener ugc nofollow" target="_blank"> DataDog </a>、<a class="ae ky" href="https://newrelic.com/" rel="noopener ugc nofollow" target="_blank"> New Relic </a>，甚至<a class="ae ky" href="https://learning.postman.com/docs/monitoring-your-api/intro-monitors/" rel="noopener ugc nofollow" target="_blank"> Postman </a>来监控你的测试的成功率，并在某些东西停止工作时通知适当的团队。</p><blockquote class="mt"><p id="5e77" class="mu mv it bd mw mx my mz na nb nc lu dk translated"><em class="nd">将自动化API测试作为done定义的一部分，表明您正在做API优先的正确工作。</em></p></blockquote><p id="4ae5" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">如果您没有在开发周期中运行这些测试，那么您需要开始了。合同测试和性能测试<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/dynamic-test-generation-with-open-api-spec-3-0-10dacd7866c2">可以动态生成。但是对于端到端的测试，你需要有意识的手工操作来运行真实的场景。</a></p><p id="0f64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你越能自动化你的消费者正在运行的场景，你就越有可能不会推出一个<a class="ae ky" href="https://blog.postman.com/how-to-catch-breaking-changes-before-they-happen/" rel="noopener ugc nofollow" target="_blank">突破性的变化</a>。</p><h2 id="24a7" class="nj lx it bd ly nk nl dn mc nm nn dp mg li no np mi lm nq nr mk lq ns nt mm nu bi translated">使您的API可被发现</h2><p id="cfb3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当我管理一个云原生开发团队时，我们会完成一个新API的工作，然后继续下一个故事。我公司周围的其他团队不知道有新的API，即使他们发现了，也不知道如何找到它并与之集成。</p><p id="4a7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">见鬼，即使是我团队中的开发人员也很难找到API的细节。</p><p id="0b46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为我们没有使我们的API可被发现。</p><p id="8c6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，你正在出售你的房子，你的房地产经纪人把它列在他们的网站上。他们不会在你的院子里放一个标志，也不会在社交媒体上做广告。很有可能你的房子在任何合理的时间内都卖不出去。这是因为它不可被发现。</p><p id="6639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">买家应该如何找到你的房子？他们一定要知道才能看你房产经纪人的网站吗？那是不会发生的。</p><p id="21a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样的事情也适用于构建API。你需要把它放在人们知道的地方，然后大肆宣传。</p><p id="fd1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有人问你在哪里可以找到你的API的文档，或者你有什么可用的API，你可以认为这是一个危险信号，表明你在可发现性方面做得不够好。</p><p id="f149" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Postman有一个<a class="ae ky" href="https://blog.postman.com/postman-public-api-network-is-now-the-worlds-largest-public-api-hub/" rel="noopener ugc nofollow" target="_blank">公共网络</a>和一个<a class="ae ky" href="https://blog.postman.com/new-private-api-network-for-easier-discovery/" rel="noopener ugc nofollow" target="_blank">私有网络</a>，让你可以轻松地在外部和内部共享你的API。</p><h1 id="c936" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="6a26" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">API优先意味着把你的API当成你的产品。</p><p id="ef5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要做到这一点，你的关注点和重点必须改变。你不会根据你认为用户应该点击的位置来驱动设计决策。相反，您正在考虑如何轻松地让集成商将请求链接在一起，以完成一个业务场景。</p><p id="6068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">跨组织工作，以有意义的方式设计你的API规范。重复设计，直到你满意为止。在规范完成之前，不要开始编写代码。</p><p id="c263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重新关注监控能力。改变你对完成的定义。不要接受任何需要在每次变更时进行手动测试的东西。自动化测试，并在测试失败时通知团队。</p><p id="3cab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让世界知道你做了什么。把你的API放在一个容易被发现的网络中。当你的API做好了，不要依赖口碑和部落知识。您的开发团队无法扩展。他们不能开发新的API，也不能宣传他们已经完成的API。</p><p id="75b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种开发方法感觉像是颠倒了标准开发。这是件好事。</p><blockquote class="mt"><p id="2af7" class="mu mv it bd mw mx my mz na nb nc lu dk translated">颠覆推动创新。</p></blockquote><p id="4445" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">通过将您的组织转向关注API和开发人员体验，您打开了从未想过可能的事情的大门。</p><p id="0238" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人是有创造力的。如果你给他们你的API的钥匙，他们会让它做你从来没有想过的事情。这就是我们在这里的目的。</p><p id="ceb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p></div></div>    
</body>
</html>