<html>
<head>
<title>Why Art Blocks Uses JavaScript in Its Smart Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么Art Blocks在其智能合约中使用JavaScript</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-art-blocks-uses-javascript-in-its-smart-contract-e252ceb4cf93?source=collection_archive---------8-----------------------#2022-04-11">https://betterprogramming.pub/why-art-blocks-uses-javascript-in-its-smart-contract-e252ceb4cf93?source=collection_archive---------8-----------------------#2022-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5f0f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">艺术阻碍智能合同分解</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/61b2f588998510a2cbc56623e036f70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5TmsU0sKVxut-HfK5EHZXA.png"/></div></div></figure><p id="4656" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Art Blocks是一个创建链上创成式NFT的平台。但是你知道什么是真正的内链和外链吗？为什么他们的智能合约中需要JavaScript？</p><p id="3ecc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将通过打破艺术块的智能合约来找出答案。我们还将了解图像是如何生成/渲染的，以及艺术块在哪里获得生成它们所需的随机性。</p><p id="422e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是这篇文章的大纲</p><ul class=""><li id="545d" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">NFT标准ERC-721的背景</li><li id="667e" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">艺术块合同源代码</li><li id="1752" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">创造艺术</li></ul><h1 id="6335" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">ERC-721—NFT标准</h1><p id="272e" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">首先，一点艺术块的背景。</p><p id="8eaf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Art Blocks是一个平台(实际上只是一个智能合同)，在这里你可以创建生成性NFT。艺术家提交可以生成图像的脚本。Art Blocks存储这些脚本，当有人想要铸造NFT时，它会创建一个独特的哈希。该散列被用作图像生成算法的种子，并且所生成的图像对于minter是唯一的。</p><p id="4077" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是一些生成图像的示例:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eaeeb7032f8078f659ca4a8955b2b2ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qHgGW-YbON3BeXdGe7AusA.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">流行艺术块收集:Ringers，铬曲线，Fidenza。</p></figure><p id="717c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了理解艺术块智能合同，我们首先需要了解ERC-721。ERC-721是用于实现NFT智能合同的标准。为了被认为符合ERC-721协议，合同需要实现这些功能:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="ae26" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">name</code>和<code class="fe nf ng nh ni b">symbol</code>是NFT描述符。比如对于艺术街区来说，就是“艺术街区”和“街区”。</li><li id="6ffc" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">tokenUri</code> -令牌元数据的路径(图像url、稀有属性等)</li><li id="3306" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">totalSupply</code> -统计该合同跟踪的NFT</li><li id="c642" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">tokenByIndex</code> -返回指定索引处令牌的tokenId。索引为[0，totalSupply。</li><li id="bb69" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">tokenOfOwnerByIndex</code> -枚举所有者的令牌并返回索引处的令牌Id</li><li id="a6cc" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">balanceOf</code>-NFTs所有者的数量</li><li id="e1ff" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">ownerOf</code> -指定令牌的所有者</li><li id="fde6" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">approve</code> -允许他人管理(转让、出售等)自己的代币。由OpenSea等第三方用来管理令牌。(有一个类似的函数<code class="fe nf ng nh ni b">setApprovalForAll(address _operator, bool _approved)</code>，它类似于approve，但是为所有令牌而不是一个令牌提供许可。为简洁起见跳过)</li><li id="4dfc" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">transferFrom</code> -转移令牌。呼叫者需要是预先批准的地址。</li></ul><p id="b565" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所有NFT智能合同都需要实施ERC-721标准。这允许像OpenSea这样的第三方以一种标准化的方式与NFT合同进行交互(例如，所有的合同将具有相同的<code class="fe nf ng nh ni b">ownerOf</code>功能)。查看我关于<a class="ae nc" href="https://ilamanov.medium.com/bored-ape-yacht-club-smart-contract-breakdown-6c254c774394" rel="noopener"> BoredApeYachtClub智能合同分解</a>的文章，了解更多关于ERC-721标准的信息。</p><p id="016c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在让我们来了解Art Blocks是如何实现这个标准并创建创成式NFT的。</p><h1 id="1b8b" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">艺术块合同源代码</h1><p id="416b" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">艺术板块的区块链后台仅由一个名为<code class="fe nf ng nh ni b">GenArt721Core.sol</code>的大型智能合同组成。这份智能合同分为两部分:</p><ol class=""><li id="e272" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm nj lt lu lv bi translated">实施ERC-721标准的合同</li><li id="0833" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm nj lt lu lv bi translated">主合同<code class="fe nf ng nh ni b">GenArt721Core.sol</code>负责存储呈现NFTs所需的数据</li></ol><p id="ed2c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nf ng nh ni b">GenArt721Core.sol</code>继承自ERC-721合同。源代码可以在<a class="ae nc" href="https://etherscan.io/address/0xa7d8d9ef8d8ce8992df33d8b8cf4aebabd5bd270#code" rel="noopener ugc nofollow" target="_blank"> Etherscan </a>和<a class="ae nc" href="https://gist.github.com/ilamanov/e4241e5b8afd0cb2341c544363899f8b" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><blockquote class="nk nl nm"><p id="8740" class="kr ks nn kt b ku kv jr kw kx ky ju kz no lb lc ld np lf lg lh nq lj lk ll lm ij bi translated"><em class="iq"> Art Blocks还有另外2个轻量级合约:</em> <code class="fe nf ng nh ni b"><a class="ae nc" href="https://etherscan.io/address/0x091dcd914fceb1d47423e532955d1e62d1b2daef#code" rel="noopener ugc nofollow" target="_blank"><em class="iq">GenArt721Minter</em></a></code> <em class="iq">(铸造代币并接受支付)和</em> <code class="fe nf ng nh ni b"><em class="iq">Randomizer</em></code> <em class="iq">(生成伪随机数)。但这些不会在本文中涉及。</em></p></blockquote><h2 id="5782" class="nr mc iq bd md ns nt dn mh nu nv dp ml la nw nx mn le ny nz mp li oa ob mr oc bi translated">ERC-721实施</h2><p id="29ca" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">Art Blocks使用OpenZeppelin 的现成<a class="ae nc" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/ERC721.sol" rel="noopener ugc nofollow" target="_blank">实现来实现ERC-721接口。OpenZeppelin是最常见标准的实现库。</a></p><p id="f420" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个实现没有任何惊喜。您期望从标准实施中获得的一切:</p><ul class=""><li id="3789" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">他们使用映射来管理令牌的所有权:</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="7bda" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">所有权是如何转移的:</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="be18" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">以及如何管理批准:</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="62ff" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">虽然不是ERC-721标准的一部分，但OpenZeppelin的ERC-721实现包括<code class="fe nf ng nh ni b">mint</code>和<code class="fe nf ng nh ni b">burn</code>功能:</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="f5ae" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">该实现还有一些映射来存储附加信息(为了简洁起见，将省略这些映射的setter/getter函数):</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="c7c9" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">最后，这里是ERC 721的其余功能:</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="64d5" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">ERC-721规范剩下的一个函数<code class="fe nf ng nh ni b">tokenUri</code>，将在本文后面解释。</li></ul><h1 id="f389" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">主合同:<code class="fe nf ng nh ni b">GenArt721Core.sol</code></h1><p id="8a6c" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">man合同扩展了ERC-721合同，增加了艺术块特有的功能:“存储项目信息”和“生成NFT”。让我们从存储项目信息部分开始。</p><h2 id="cf5b" class="nr mc iq bd md ns nt dn mh nu nv dp ml la nw nx mn le ny nz mp li oa ob mr oc bi translated">存储项目信息</h2><p id="5388" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">每个NFT系列都被认为是一个独立的项目(如Chromie Squiggle、Ringers等)。主合同定义了项目的数据结构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="cddb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所有项目的NFT都存储在一个大的智能契约中——我们不会为每个集合创建一个新的契约。所有的项目都存储在一个叫做<code class="fe nf ng nh ni b">projects</code>的大映射中，这里的键就是项目的索引(0，1，2，…):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9ced" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能已经从上面的屏幕截图中注意到，该合同使用了更多的数据结构来跟踪一切:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c996" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我解释一下最后4行:</p><ul class=""><li id="9849" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">tokenId</code>是NFT的ID，<code class="fe nf ng nh ni b">projectId</code>是项目的ID。该协定跟踪两者之间的双向映射。</li><li id="4bf2" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated"><code class="fe nf ng nh ni b">hash</code>是[1]NFT的索引，2)块号，prev的块散列的组合的keccak256散列值。块，minter的地址，5)来自随机发生器契约的随机值]。我们一会儿会谈到随机数发生器合同。<code class="fe nf ng nh ni b">hash</code>值是在mint函数中计算的:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/32eb11523d7ba4a674a274f7ac6ef9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ju7ORsaxtmYCR-YN30ed1A.png"/></div></div></figure><p id="3b5a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">艺术家可以通过一系列设置器来更改项目参数，例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="16f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是项目一旦锁定，很多变量就永远无法改变。</p><p id="a3c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是“存储项目信息”功能。让我们继续讨论由<code class="fe nf ng nh ni b">GenArt721Core.sol</code>契约实现的下一个功能。</p><h1 id="b388" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">创造艺术</h1><p id="e938" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">生成艺术的入口点是<code class="fe nf ng nh ni b">tokenUri</code>函数。这是ERC-721标准中的函数之一，应该返回NFT的元数据(如图像或属性)。下面是<code class="fe nf ng nh ni b">tokenUri</code>的实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4d88" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它有许多if条件，但本质上只是有条件地构造元数据路径。项目可以选择在IPFS上存储元数据(作为图像或JSON文件)，或者，如果项目是动态的，元数据可以从传统的HTTP API提供。大多数项目都是动态的，所以我们将关注这种情况。</p><p id="b63a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如，Fidenza集合(<code class="fe nf ng nh ni b">projectId</code> =78)具有以下元数据路径:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/30e25535ab0944920d1afc8ad448e669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Amt34LFcLo5yBDxOu-2aDQ.png"/></div></div></figure><p id="eb6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以从<a class="ae nc" href="https://etherscan.io/address/0xa7d8d9ef8d8ce8992df33d8b8cf4aebabd5bd270#readContract" rel="noopener ugc nofollow" target="_blank">以太扫描</a>中获得此信息。只需向下滚动到“tokenURI”。如果我们导航到这个HTTP路径，就会得到这个JSON文件:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/5b5ba1595c58c15389b7246429e02b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bW9RbM-rweFQsVxe16pmVQ.png"/></div></div></figure><p id="5819" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意，JSON文件有一堆不同的特征类型和项目描述的信息。它还有一个到实际图像的链接:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/75d21589043758d77b88531081fde0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rG0sJbRwSzMCVFvFhtVWbA.png"/></div></div></figure><p id="fe79" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那么，当你购买NFT时，你真正拥有的是什么？在这种情况下，您只拥有<code class="fe nf ng nh ni b">tokenId</code>。<code class="fe nf ng nh ni b">tokenUri</code>函数然后根据项目设置将<code class="fe nf ng nh ni b">tokenId</code>映射到IPFS或HTTP链接。这个链接或者直接指向图像，或者指向一个JSON，这个JSON有属性和一个到图像的嵌套链接。</p><p id="1b3e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是图像是如何生成/渲染的呢？不幸的是，图像不是在链上生成的。智能契约只存储渲染图像所需的JavaScript脚本。艺术块的前端然后查询这个脚本，并在其传统的后端，而不是区块链后端按需生成图像。</p><p id="3cc5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为什么图像没有在链上生成/渲染？这是因为脚本依赖于库。这些脚本依赖于常见的JavaScript库，如<em class="nn"> p5.js </em>和<em class="nn"> processing </em>，它们通常被设计者用来创建创成式图像。将这些依赖库放在链上是非常昂贵的，这就是为什么图像是离线生成的。</p><p id="b31a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">渲染图像的指令(渲染脚本)存储在链上。您可以通过导航到<a class="ae nc" href="https://etherscan.io/address/0xa7d8d9ef8d8ce8992df33d8b8cf4aebabd5bd270#readContract" rel="noopener ugc nofollow" target="_blank"> Etherscan </a>上的<code class="fe nf ng nh ni b">projectScriptInfo</code>来查看存储的脚本。这将向您显示项目脚本需要什么库依赖以及它有多少个脚本(如果脚本太长，它将被分成许多部分):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/49aea4790fa5c1e63c9effd6c5a3630e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXd4DczMRooNLEKIVXzhLA.png"/></div></div></figure><p id="d756" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">实际的剧本在<code class="fe nf ng nh ni b">projectScriptByIndex</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/44676775fc36c192cfe7f3b99ff31879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KGrIARRciL1K89BP2u0_Q.png"/></div></div></figure><p id="ef6d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">脚本作为普通字符串存储在项目数据结构中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/c7c8f6d6925e326978d72f748c8fa98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtRgWY2lOeiQuU4pxU0hyw.png"/></div></div></figure><h1 id="8953" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">随机性是如何产生的？</h1><p id="64dc" class="pw-post-body-paragraph kr ks iq kt b ku mt jr kw kx mu ju kz la mv lc ld le mw lg lh li mx lk ll lm ij bi translated">你可能想知道NFT收藏品中的随机图案是如何产生的。当生成图像时，前端不仅仅从智能合同中提取脚本。它还提取散列字符串。还记得哈希字符串吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/91dca2acc4332ec727229d19ef3b0219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AcOPE9leDH4bPYBSFnZQ2Q.png"/></div></div></figure><p id="828d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个散列可以从<code class="fe nf ng nh ni b">tokenIdToHash</code>映射的契约中读取。哈希字符串在图像生成过程中用作输入/种子。哈希字符串控制图像的参数(例如，铬黄曲线的弯曲程度)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/49eb3b852b9be44e0d432fec14a807b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfKYRXYJBR-exkJlURE1Mg.png"/></div></div></figure><p id="d691" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">大量的信息被组合起来产生散列。其中一个输入是minter的地址。这样，minter参与图像生成过程，并且NFT对于minter来说变得唯一。(如果其他人在完全相同的条件下铸造相同的代币，他会得到不同的图像，因为他的地址会不同)。</p><p id="14f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">散列的另一个输入是来自<code class="fe nf ng nh ni b">randomizerContract</code>的<code class="fe nf ng nh ni b">returnValue</code>。这个合同似乎不是开源的(没有在Etherscan上验证)，所以我们看不到它的代码。但它最有可能是一个伪随机数生成器，它从诸如最后一个铸币厂的块号等来源生成链上的随机数。</p></div><div class="ab cl ol om hu on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="ij ik il im in"><p id="0fa9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是艺术块合同的破裂！我希望这有所帮助。如果你有任何问题，请在评论中告诉我。</p><p id="38f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我计划对流行的智能合约进行更多的分解，比如UST算法稳定币和thirdweb的NFT工厂。</p><p id="cba5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你还可以在solidnoob.com的<a class="ae nc" href="https://www.solidnoob.com/" rel="noopener ugc nofollow" target="_blank">查看其他智能合同的细目表和更多关于Solidity noobs的东西。</a></p><pre class="kg kh ki kj gt os ni ot ou aw ov bi"><span id="0d79" class="nr mc iq ni b gy ow ox l oy oz"><strong class="ni ir">Want to Connect?</strong></span><span id="cbb7" class="nr mc iq ni b gy pa ox l oy oz">Follow me on <a class="ae nc" href="https://twitter.com/nazar_ilamanov" rel="noopener ugc nofollow" target="_blank">Twitter</a>.</span></pre></div></div>    
</body>
</html>