<html>
<head>
<title>How to Present Customizable Bottom Sheets in iOS 15</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在iOS 15中呈现可定制的底部表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-present-customizable-bottom-sheets-in-ios-15-e98e530208b2?source=collection_archive---------0-----------------------#2021-10-26">https://betterprogramming.pub/how-to-present-customizable-bottom-sheets-in-ios-15-e98e530208b2?source=collection_archive---------0-----------------------#2021-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8655" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用UISheetPresentationController</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cdcd8cc32f3ec7011edf168c3c84bfbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HrJYPG8XzGf9ibOd"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·罗梅罗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3e43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习如何使用iOS 15中可用的<code class="fe lv lw lx ly b">UISheetPresentationController</code> API来呈现底部表单。示例项目的源代码可以在本文的底部找到。简而言之，这是你学完这个教程后会知道的:</p><ul class=""><li id="6e01" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">如何将任何<code class="fe lv lw lx ly b">UIViewController</code>呈现为底单？</li><li id="8db9" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">如何为你的底层提供尺寸？</li><li id="6872" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">如何自定义底部工作表的布局和行为。</li><li id="fe11" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">决定使用<code class="fe lv lw lx ly b">UISheetPresentationController</code>时需要考虑哪些细微差别。</li></ul><p id="9892" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们将要建造的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/b3a449f4821cc628f9f9758adc48f40b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/1*7M9h3lo2uA1OlsuQFD9HFg.gif"/></div></figure><h1 id="6c36" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">我们开始吧</h1><p id="2010" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们从在屏幕中央显示一个按钮的<code class="fe lv lw lx ly b">UIViewController</code>开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="98b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">buttonHandler</code>中，我们将实现一个底部表单并在屏幕上显示它。</p><p id="0c7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先创建另一个<code class="fe lv lw lx ly b">UIViewController</code>作为底板:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><ol class=""><li id="2092" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu nn mf mg mh bi translated">我们将<code class="fe lv lw lx ly b">modalPresentationStyle</code>指定为<code class="fe lv lw lx ly b">.pageSheet</code>来告诉系统我们将使用这个视图控制器作为一个工作表。</li><li id="a595" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">通过将<code class="fe lv lw lx ly b">isModalInPresentation</code>设置为<code class="fe lv lw lx ly b">false</code>，我们允许用户交互式地关闭表单。如果我们将它设置为<code class="fe lv lw lx ly b">true</code>，工作表将不会被忽略。</li><li id="e133" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">为了简单起见，我们只显示橙色视图。</li></ol><p id="f4e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候在按钮的处理程序中显示底部的工作表了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><ol class=""><li id="d091" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu nn mf mg mh bi translated">我们从初始化<code class="fe lv lw lx ly b">BottomSheetViewController</code>开始。</li><li id="68f5" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">获取内置的<code class="fe lv lw lx ly b">sheetPresentationController</code>属性。当<code class="fe lv lw lx ly b">modalPresentationStyle</code>为<code class="fe lv lw lx ly b">.pageSheet</code>或<code class="fe lv lw lx ly b">.formSheet</code>时，视图控制器设置该属性。之前，我们将<code class="fe lv lw lx ly b">BottomSheetViewController</code>的属性设置为<code class="fe lv lw lx ly b">.pageSheet</code>，所以<code class="fe lv lw lx ly b">sheetPresentationController</code>存在。</li><li id="c960" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">“定位”属性用于为底部图纸提供尺寸配置。目前，苹果只为我们提供了<code class="fe lv lw lx ly b">.medium()</code>和<code class="fe lv lw lx ly b">.large()</code>卡顿。由于开发人员无法访问制动器创建API，我们无法创建自定义大小的制动器。希望我们以后能看到API的更新，比如<code class="fe lv lw lx ly b">.small()</code>或者<code class="fe lv lw lx ly b">.custom(size: CGSize)</code>。</li><li id="7459" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated"><code class="fe lv lw lx ly b">largestUndimmedDetentIdentifier</code>属性决定底部工作表后面的视图何时变暗。通过将它设置为<code class="fe lv lw lx ly b">.medium</code>，我们告诉系统仅当纸张处于其<code class="fe lv lw lx ly b">.large()</code>尺寸时才使背景变暗。</li><li id="5475" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">当我们在底部表单中有<code class="fe lv lw lx ly b">UIScrollView</code>时，<code class="fe lv lw lx ly b">prefersScrollingExpandsWhenScrolledToEdge</code>属性可以为案例提供支持。当它被设置为<code class="fe lv lw lx ly b">true</code>时，用户能够滚动底部表单的内容，一旦它以其完整高度显示。否则，我们无法在底部工作表内滚动<code class="fe lv lw lx ly b">UIScrollView</code>。为了说明它是如何工作的，考虑值为<code class="fe lv lw lx ly b">true</code>的情况:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/a351d10f4607fed724c7b98ebffcf9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/1*DroE49dMCARc2oyj05HSOw.gif"/></div></figure><p id="7eb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当设置为<code class="fe lv lw lx ly b">false</code>时:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/8e8b7b87377cdfc7fb74c4729fa22bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/1*95UBWOfJVXq8UGf1inM1pg.gif"/></div></figure><p id="343e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.<code class="fe lv lw lx ly b">prefersGrabberVisible</code>设置为<code class="fe lv lw lx ly b">true</code>显示料板顶部的抓取器视图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/e72c7212a876f046fd24c2eb4f187bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*rnDS_I4XX2Y6H98MKAaaGQ.png"/></div></figure><p id="6d9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.最后，我们使用标准的<code class="fe lv lw lx ly b">present()</code>方法展示底部的表。</p><p id="d922" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了上面显示的属性，我们还有一个称为<code class="fe lv lw lx ly b">preferredCornerRadius</code>的圆角半径属性。通过将其设置为0，我们得到以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/eff83eeef077a6cf00401f07357adc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*XW4ylT23komYjeCBD5MgTw.png"/></div></figure><h1 id="1fcf" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">以编程方式更改大小</h1><p id="1e4e" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们还可以更改当前的<code class="fe lv lw lx ly b">Detent</code>并以编程方式动画显示这些更改:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><ol class=""><li id="8a16" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu nn mf mg mh bi translated">在表单显示两秒钟后，启动这段代码。</li><li id="2a7c" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu nn mf mg mh bi translated">通过使用<code class="fe lv lw lx ly b">animateChanges</code>闭包，我们告诉系统动画显示板材属性的变化。上面，我们告诉它改变卡位到<code class="fe lv lw lx ly b">.large</code>并激活它。</li></ol></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="4ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，在决定是自己实施底单还是使用<code class="fe lv lw lx ly b">UISheetPresentationController</code>时，我们需要记住这些事情:</p><ul class=""><li id="f27e" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">UISheetPresentationController</code> API仅支持iOS 15及更新版本。</li><li id="62a1" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">API目前是有限的，因为它只提供<code class="fe lv lw lx ly b">.medium()</code>和<code class="fe lv lw lx ly b">.large()</code>尺寸配置。</li><li id="4d54" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">想象你想摆脱这种视差效应:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1487096efb540cb7674a1d732af7c8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/1*uXRgCAfE-aTlI3cq7Zk8mA.gif"/></div></figure><p id="7164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要做到这一点，您需要违背API的准则:您需要按照降序提供<code class="fe lv lw lx ly b">detents</code>:</p><p id="6ab0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">sheet.detents = [.large(), .medium()]</code></p><p id="78c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这产生了我们需要的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/fb94dda1141a0523a9f08f8e4be678ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/1*joyRHrJg5IJKFNRIXViisw.gif"/></div></figure><p id="ba66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种溶液之所以“有气味”，是因为当纸张被呈现时，它立即以<code class="fe lv lw lx ly b">.large()</code>尺寸显示。此外，苹果告诉我们在文档中使用<em class="ny">升序</em>顺序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/b5b8b23120c4eaafeb768f98a859568a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_oMumrr-0Q2HWpe2w4VKg.png"/></div></div></figure></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="848b" class="mo mp it bd mq mr oa mt mu mv ob mx my jz oc ka na kc od kd nc kf oe kg ne nf bi translated">资源</h1><p id="4358" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">示例项目可在<a class="ae ky" href="https://github.com/zafarivaev/uisheetpresentationcontroller-ios15" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。希望这篇教程对你有用，感谢阅读！</p></div></div>    
</body>
</html>