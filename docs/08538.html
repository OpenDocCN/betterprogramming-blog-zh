<html>
<head>
<title>Build a Note-Taking App With Google Authentication in Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Next.js中构建一个带Google认证的笔记应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-note-taking-app-with-google-authentication-in-next-js-f0835d14034e?source=collection_archive---------2-----------------------#2021-05-12">https://betterprogramming.pub/build-a-note-taking-app-with-google-authentication-in-next-js-f0835d14034e?source=collection_archive---------2-----------------------#2021-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce16" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用NextAuth.js在你的Next.js应用中实现Google OAuth</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/97db0b1bac7427164d85aade4505ef1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kE0rzpR8dvEmszWC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jakeculp?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">雅各布·库尔普</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="5b10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将了解以下内容:</p><ul class=""><li id="64b8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用<a class="ae ky" href="https://next-auth.js.org/" rel="noopener ugc nofollow" target="_blank"> NextAuth.js </a>和Next.js。</li><li id="14ed" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用NextAuth.js的第三方Google认证。</li><li id="a954" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">维护用户和Notes表之间的关系。</li><li id="7996" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在我们的数据库上执行CRUD操作来读写注释。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="e0b9" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">介绍</h1><p id="8b9f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">所以你用Next.js建立了一个每天吸引数百万用户的牛逼博客。为了从你的写作中获得收入，你有了把文章锁在付费墙后面的想法。这样，读者才能支持你。要实现这样的想法，您需要执行以下步骤:</p><ul class=""><li id="afe9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">建立一个登录系统。</li><li id="2237" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">检查登录用户是否订阅了您的网站。</li><li id="e6cd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如果他们是付费会员，让他们继续享受你的内容。</li><li id="3ff9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">另一方面，如果访问者没有登录，则提示他们创建帐户或登录。</li></ul><p id="71df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，让我们面对它:认证是一种痛苦。它需要大量的代码，在某些情况下，维护是一件麻烦的事情。</p><p id="72c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是Next-Auth.js的用武之地。它不仅简化了构建用户身份验证的过程，还具有以下优势:</p><ul class=""><li id="12c6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">Cookies:在Passport中，如果你重启你的服务器，你会被自动注销。在Next-Auth.js中，这不是问题，因为它已经使用cookies来存储会话数据。</li><li id="e5f4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">极其安全:Next-Auth.js积极推广无密码登录选项。此外，它在代码中使用CSRF令牌来确保您的项目没有漏洞。</li></ul><p id="f5bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在该编码了！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a8d1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">项目设置</h1><h2 id="efee" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">储存库的初始化</h2><p id="05b2" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">这一步相当简单。要实例化Next.js项目，请运行以下终端命令:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/7f2d99ad9b02283ca77c8c2a9d7caf64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxkX5TUGCvZQwyUdFOKLRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要运行的终端命令</p></figure><p id="f07c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在项目的根目录下创建一个<code class="fe oa ob oc od b">.env.local</code>文件，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/69f86c18f21965b3055efd46b0135cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mhzhukET059gwCzBVXfbA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要运行的终端命令</p></figure><p id="c448" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们将存储我们的环境变量。</p><p id="93d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们继续安装我们的依赖项。</p><h2 id="be3a" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">模块安装</h2><p id="7263" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">对于本项目，我们将使用以下模块:</p><ul class=""><li id="e7c0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oa ob oc od b">next-auth</code>:我们项目的要旨。这个库将处理我们所有的基于身份验证的过程。</li><li id="94ec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">mongodb</code>:由于我们将使用MongoDB服务器，Next-Auth.js将使用<code class="fe oa ob oc od b">mongodb</code>包作为其依赖项之一。</li><li id="bb02" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">mongoose</code>:与我们的数据库交互，对我们的集合执行CRUD操作。</li></ul><p id="f4a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装这些软件包，请运行以下终端命令:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/c384a4e19fa25609240b8c8fcc4ebafb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPgVkriJIHWph4jqc32CUg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安装模块</p></figure><p id="0966" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们初始化我们的MongoDB服务器。</p><h2 id="47fc" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">MongoDB Atlas设置</h2><p id="5278" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我推荐用<a class="ae ky" href="https://www.mongodb.com/cloud/atlas" rel="noopener ugc nofollow" target="_blank"> MongoDB Atlas </a>。它在云中为您设置了一个数据库服务器，不需要任何额外的配置。</p><p id="60fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，登录到Atlas页面，然后<a class="ae ky" href="https://docs.atlas.mongodb.com/tutorial/create-new-cluster/" rel="noopener ugc nofollow" target="_blank">按照这些步骤</a>创建您的第一个集群。完成后，点击“连接”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/fca4f971cd722472c17949551987b22e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkw9O-oHKnGCYDXi9zPvEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接到我们的集群</p></figure><p id="0149" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，选择“允许从任何地方访问”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/2099b1daf1db4b7682aabc5d77c4f93b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HJU37OboS8CY74ZilTK7Vg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安全设置面板</p></figure><p id="5703" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，创建您的用户名和密码，并点击“创建数据库用户”注册为用户。完成后，点击“连接您的应用程序”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/100544f7c15be8947b74856afa42a93e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KL4xbBntgP44aEyv002IHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将我们的服务器链接到我们的项目</p></figure><p id="65eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您将收到您的连接字符串。复制并粘贴到您的<code class="fe oa ob oc od b">.env.local</code>文件中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/ae858ceacff336d53711e32896537e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MM48z4VJx5bqAIuFj9fDpg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要写入. env.local的代码</p></figure><p id="0355" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们现在开始创建我们的Google OAuth凭证。</p><h2 id="e07b" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">与谷歌的OAuth</h2><p id="fea7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">去你的<a class="ae ky" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>点击“选择一个项目”接下来，点击“新项目”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/297db2cd63cb876001ed9239239eb191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VueySSqjEf5WU7SQTHsjUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“新项目”</p></figure><p id="6912" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，转到侧面板，点击“APIs &amp; Services”接下来，点击“仪表板”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8a9854f0d7398083521d065dcbfc5db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*iQNrJj8FfbDlDyxufAfrUw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击“仪表板”</p></figure><p id="be7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在顶栏上，单击“启用API和服务”它将引导您进入API库页面。搜索“Google+”并启用它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/7fcc574af7e72595b32cd59c82e301b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kzkuaUgpmHJgnbv_6AW1Yg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">激活Google+API</p></figure><p id="42fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该网站现在将引导您进入“启用的API”页面。首先，选择“凭据”，然后单击“API和服务中的凭据”链接:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/1fb269349caf5118311ee2336b1a439a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFeQXlz8VMch4nzRcl-Ygg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">转到“API和服务中的凭据”</p></figure><p id="c460" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把你重定向到主页。单击“创建凭据”，然后单击“OAuth客户端ID”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/591d823c96c6f555c1d6f14496790181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*B2QT0bq2INUtRlGiFGo6NA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建OAuth ID</p></figure><p id="5d2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择“Web应用程序”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/b773bcd8c207d0c18433b7a9aff3c9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOKUCsFdyR8z28fdVn2MHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">选择“网络应用程序”</p></figure><p id="5778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在给你的应用起个名字。完成后，向下滚动到“授权重定向URIs”并进行如下配置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/5bbdc3b7de058b8359ec4656631f8988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*N6s_Gb4dzLFe1YgTA23pKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重定向URIs设置面板</p></figure><p id="b972" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在点击“创建”来告诉Google构建我们的OAuth客户端。您将收到您的客户ID和密码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/47c34d5deea0fb45c9f4c2e9cb775de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*5a27InXZtUalO0SugWrbCQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">OAuth密钥</p></figure><p id="f87e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将它们复制到您的<code class="fe oa ob oc od b">.env.local</code>文件中，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/77291c7a7a8b518c7d900bd51bea700f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fNwo21vTHoFNowNCo-yg2A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的环境变量</p></figure><p id="e01d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们终于完成了！在下一节中，我们将讨论我们的文件结构。</p><h2 id="bfc1" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">项目文件结构</h2><p id="6c24" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在项目的根目录中，创建以下文件夹:</p><ul class=""><li id="cd45" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oa ob oc od b">models</code>:将存放我们的猫鼬模型。</li><li id="0acf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">helpers</code>:将持有我们所有的中间件功能。</li><li id="375f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">components</code>:存储我们的自定义组件，可以在其他文件中重用。</li></ul><p id="e10b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在进入您的<code class="fe oa ob oc od b">pages</code>文件夹，创建这些文件夹:</p><ul class=""><li id="c046" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oa ob oc od b">/api</code>目录中的<code class="fe oa ob oc od b">notes</code>:处理<code class="fe oa ob oc od b">/api/notes/</code>航线。</li><li id="1413" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">/api</code>目录中的<code class="fe oa ob oc od b">auth</code>:保存用户认证逻辑。</li><li id="a710" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oa ob oc od b">notes</code>:将处理<code class="fe oa ob oc od b">/notes</code>路线。</li></ul><p id="8f08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您的项目结构应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/e4dbd41358d1187c5ef396801d45724c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*JruXq87_x82MiN-Q1d7WOg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目的文件结构</p></figure><p id="5559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们完了。现在让我们试着构建我们的登录系统。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3c85" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建我们的登录系统</h1><h2 id="5066" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">配置后端</h2><p id="8958" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在您的项目中，转到您的<code class="fe oa ob oc od b">/pages/api/auth</code>目录并创建一个名为<code class="fe oa ob oc od b">[...nextauth.js]</code>的文件。这意味着所有以<code class="fe oa ob oc od b">/api/auth</code>开头的路径都将由<code class="fe oa ob oc od b">[...nextauth].js</code>文件处理。</p><p id="d81d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/api/[...nextauth].js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="8c0c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第1-2行:导入<code class="fe oa ob oc od b">NextAuth</code>模块实现认证。然后导入<code class="fe oa ob oc od b">Providers</code>包告诉Next.js我们会使用第三方认证。</li><li id="f52a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第6-11行:告诉Next.js我们将只在这个项目中使用Google OAuth。我们还通过环境变量传递我们的Google ID和密钥。</li><li id="d74c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第13行:使用我们的MongoDB数据库实例。连接字符串通过我们的环境变量传递。</li><li id="5a6e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第14行:我们的<code class="fe oa ob oc od b">session</code>回调将在用户会话被检查时运行。</li><li id="d883" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第16行:公开会话的<code class="fe oa ob oc od b">id</code>属性，这样我们就可以访问它。这在创建与每个用户相关的笔记时会很有用。</li></ul><p id="9185" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们现在建立我们的前端。</p><h2 id="a26d" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">构建我们的前端</h2><p id="d23b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/index.js</code>中，用以下代码替换您的所有代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="9515" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3行:使用<code class="fe oa ob oc od b">useSession</code>钩子获取登录用户的数据。</li><li id="6215" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第7行:检查用户是否没有登录(如果<code class="fe oa ob oc od b">session</code>没有值)。如果是，提示用户登录。<code class="fe oa ob oc od b">signIn</code>方法处理登录功能。</li><li id="4e23" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第19行:如果用户已经登录(如果<code class="fe oa ob oc od b">session</code>有值)，那么显示一个退出的选项。<code class="fe oa ob oc od b">signOut</code>方法将为我们处理这个问题。</li><li id="3ef0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第21行:在主页上显示用户名。</li></ul><p id="4735" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一步是修改我们的<code class="fe oa ob oc od b">_app.js</code>文件。在<code class="fe oa ob oc od b">/pages/_app.js</code>中，首先导入<code class="fe oa ob oc od b">Provider</code>模块，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/1dcfb5749f8c58dea595c015ae5b3425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCmuySDyitV6aOb3l27Lww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要写入pages/_app.js的代码</p></figure><p id="793b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在在<code class="fe oa ob oc od b">/pages/_app.js</code>中找到下面这段代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/dbe5cee53242774b7bf76b74ad108587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BGQWcFvtcxvcd48b_JFIQg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要在pages/_app.js中查找的代码</p></figure><p id="6757" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样改变它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/13cc0f7780e658e38d001e4aa304d2ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ajp-RO_wrofDzzIwfiK2A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pages/_app.js中要替换的代码</p></figure><ul class=""><li id="ae10" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第2-4行:用<code class="fe oa ob oc od b">Provider</code>标签包装我们的<code class="fe oa ob oc od b">Component</code>。这将使我们的会话数据在所有路由中保持不变。</li></ul><p id="78ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。这将是结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/9ae905e0836a65e8499b363b1d3f3f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*E1w3KaqAMquelIVh2PPd1Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="b33b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！我们的代码按预期工作。现在让我们构建我们的<code class="fe oa ob oc od b">Note</code>组件。</p><p id="3127" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您的<code class="fe oa ob oc od b">/pages/_app.js</code>文件应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="190a" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">笔记组件</h2><p id="ef33" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在你的<code class="fe oa ob oc od b">components</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">Note.js</code>的文件。在该文件中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="99d4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第4行:我们的<code class="fe oa ob oc od b">Note</code>组件将接受两个道具:<code class="fe oa ob oc od b">id</code>和<code class="fe oa ob oc od b">title</code>。</li><li id="caab" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第5行:这个<code class="fe oa ob oc od b">useRouter</code>实例将帮助我们执行客户端重定向。</li><li id="5bec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第7行:创建<code class="fe oa ob oc od b">sendDelete</code>函数。</li><li id="b2ad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第8-10行:对<code class="fe oa ob oc od b">api/notes/delete/{id}</code>路线执行<code class="fe oa ob oc od b">DELETE</code>请求。这将告诉服务器通过<code class="fe oa ob oc od b">id</code>识别我们的记录，然后删除它。</li><li id="85e6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第11行:在<code class="fe oa ob oc od b">DELETE</code>请求之后，将用户重定向到<code class="fe oa ob oc od b">/dashboard</code>。</li><li id="8339" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第16-21行:显示<code class="fe oa ob oc od b">title</code>道具。如果点击，则将用户重定向到<code class="fe oa ob oc od b">/notes/{id}</code>路线。这将显示注释的完整详细信息。</li><li id="9d85" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第22-24行:将用户重定向到<code class="fe oa ob oc od b">/notes/update/${id}</code>页面。这将允许客户端更新指定的文档。</li><li id="e87d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第25行:如果点击，调用<code class="fe oa ob oc od b">sendDelete</code>函数。</li></ul><p id="3366" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一部分中，我们现在将创建我们的仪表板页面。</p><h2 id="748f" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">仪表板页面</h2><p id="2994" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在你的<code class="fe oa ob oc od b">/pages</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">dashboard.js</code>的文件。该文件将显示用户所有保存的笔记。</p><p id="b08a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">pages/dashboard.js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="5620" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第6行:<code class="fe oa ob oc od b">useSession</code>钩子会告诉我们用户是否已经登录。</li><li id="5f34" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第11行:如果用户已经登录，显示一条问候消息。</li><li id="e7e1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第13-14行:单击时，用户将被重定向到<code class="fe oa ob oc od b">notes/add</code>路线。</li><li id="e60d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第15行:这个按钮将允许用户注销。如果成功，我们的应用程序会将他们重定向到<code class="fe oa ob oc od b">/</code>页面。</li></ul><p id="25c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/e59abf94e24f02f39aba01c7d013d9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*_uxOZ1s2Av-UisauCnfdAw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="eff4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，让用户手动导航到<code class="fe oa ob oc od b">/dashboard</code>页面并不是很好的用户体验。我们需要解决这个问题。</p><p id="a93f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">pages/index.js</code>中，找到下面这段代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b706b778a6a30fefdbf905791261c8bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOllKw5XH15ltqojR5Zkqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要在/pages/index.js中查找的代码</p></figure><p id="1815" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样改变它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/222cb130fa6711cb303fcc1a75e2e6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3LyRghtMUzyTwI92Ph5gA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在/pages/index.js中替换的代码</p></figure><ul class=""><li id="e9c6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3行:当用户登录时，将用户重定向到<code class="fe oa ob oc od b">dashboard</code>页面。</li></ul><p id="d0c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/4f4f8d0623ce749971c650f4a19cff8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*Exr24vMhUSalxBpU8FeTiw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="8a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们完事了。现在是时候围绕它构建我们的笔记应用程序了。</p><p id="2de9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<code class="fe oa ob oc od b">/pages/index.js</code>应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d4d6" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">笔记应用程序</h1><h2 id="4bb7" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">Notes模型</h2><p id="71cd" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在你的<code class="fe oa ob oc od b">/models</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">Note.js</code>的文件。在<code class="fe oa ob oc od b">/models/Note.js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="d2d2" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3行:定义我们的<code class="fe oa ob oc od b">noteSchema</code>。</li><li id="2d40" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第4行:我们的集合将有一个<code class="fe oa ob oc od b">user</code>字段，它将与登录的用户相链接。这使得我们可以制作一个关系数据库。</li><li id="ca4d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第8-9行:我们的模型将拥有保存字符串值的<code class="fe oa ob oc od b">title</code>和<code class="fe oa ob oc od b">body</code>字段。</li><li id="d0f0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第13行:导出我们的<code class="fe oa ob oc od b">Note</code>模型，它将从<code class="fe oa ob oc od b">noteSchema</code>派生而来。</li></ul><p id="bb14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们把数据库和这个项目连接起来。</p><h2 id="b1c1" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">连接到数据库</h2><p id="3193" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在您的<code class="fe oa ob oc od b">helpers</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">dbConnect.js</code>的文件。顾名思义，这个文件包含我们的数据库配置。</p><p id="802f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">helpers/dbConnect.js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="69ec" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3-9行:从<code class="fe oa ob oc od b">.env.local</code>获取我们的MongoDB连接字符串。如果它不存在，那么抛出一个错误。</li><li id="215d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第16行:这里，我们使用全局变量来维护一个缓存的连接。这将防止连接在使用过程中增长。</li><li id="5484" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第28-34行:指定我们的数据库配置。</li><li id="8e90" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第37行:连接到数据库。</li><li id="8a8f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第45行:最后，导出我们的<code class="fe oa ob oc od b">dbConnect</code>函数。我们现在可以在我们的项目中使用它。</li></ul><p id="0d94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们完了！现在让我们用笔记来处理CRUD操作。</p><h2 id="932e" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">添加注释</h2><p id="2647" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">转到您的<code class="fe oa ob oc od b">/pages/api/notes</code>文件夹，创建一个名为<code class="fe oa ob oc od b">add.js</code>的文件。这个文件将告诉我们的数据库插入一条记录。</p><p id="9ae8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/api/notes/add.js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="0b9d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第6行:<code class="fe oa ob oc od b">getSession</code>方法将返回用户数据。</li><li id="5315" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第8行:在执行任何数据库关键功能之前连接到数据库。</li><li id="ecae" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第10行:如果客户端没有登录，那么发送一个错误。</li><li id="2422" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第14行:检查是否执行了一个<code class="fe oa ob oc od b">POST</code>请求。</li><li id="2923" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第15-16行:如果为真，那么创建一个<code class="fe oa ob oc od b">Note</code>文档，其中的<code class="fe oa ob oc od b">user</code>字段指向登录用户的<code class="fe oa ob oc od b">id</code>。这使我们能够建立关系。</li><li id="8726" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第17-18行:<code class="fe oa ob oc od b">title</code>和<code class="fe oa ob oc od b">body</code>字段将包含用户输入的数据。</li><li id="e94c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第21-24行:保存文档并注销保存的记录。</li><li id="41f5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第26行:结束响应。</li></ul><p id="9691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们为这个功能编写前端代码。在<code class="fe oa ob oc od b">/pages/notes</code>中，创建一个名为<code class="fe oa ob oc od b">add.js</code>的文件。</p><p id="f383" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">pages/notes/add.js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="b1c5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第7行:创建我们的<code class="fe oa ob oc od b">addNote</code>函数。</li><li id="8b25" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第10-19行:向<code class="fe oa ob oc od b">/api/notes/add</code>发送一个<code class="fe oa ob oc od b">POST</code>请求。这将告诉我们的服务器向数据库添加数据。我们的<code class="fe oa ob oc od b">body</code>和<code class="fe oa ob oc od b">title</code>字段将来自<code class="fe oa ob oc od b">input</code>值。</li><li id="2937" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第20行:当请求完成时，将用户重定向到<code class="fe oa ob oc od b">/dashboard</code>。</li><li id="b8cd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第26行:当表单提交后，调用<code class="fe oa ob oc od b">addNote</code>函数。</li></ul><p id="004b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/fe723d6998c65959eb9070be12a0f75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/0*bF1tjfEGadCO--_Y.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="6cde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看着控制台:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/2ef65a59d34cb44f31cccdd32df01278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*t7PQxceBirGnBEz4ABtqXw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">控制台输出</p></figure><p id="7eec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这证明我们的文档已经保存到数据库中。我们的代码按预期工作。</p><p id="0edd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将显示我们所有的笔记。</p><h2 id="5f4a" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">显示我们的笔记</h2><p id="626d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们先来设计这一节的后端代码。在您的<code class="fe oa ob oc od b">/pages/api/notes</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">list.js</code>的文件。在该文件中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="203a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第11行:找到用户的所有笔记。这通过过滤掉具有当前用户的<code class="fe oa ob oc od b">id</code>字段的<code class="fe oa ob oc od b">user</code>字段的笔记来完成。最后，使用<code class="fe oa ob oc od b">lean</code>方法返回JSON格式的文档。</li><li id="d88f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第12行:用JSON将结果发送给客户机。</li><li id="467c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第13行:如果用户没有登录，那么返回一个错误。</li></ul><p id="9f20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们现在与我们的前端工作。在<code class="fe oa ob oc od b">/pages/dashboard.js</code>中，添加下面这段代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="ce4a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第1行:<code class="fe oa ob oc od b">getServerSideProps</code>函数将从服务器获取数据。</li><li id="0951" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第3行:创建我们的头来告诉NextAuth.js我们被授权查看我们的文档。</li><li id="5cde" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第4行:对我们的服务器执行一个<code class="fe oa ob oc od b">FETCH</code>请求，并发送这些头。</li><li id="9da3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第6行:如果返回的数据有错误，那么将用户重定向到<code class="fe oa ob oc od b">/</code>路线。</li><li id="b008" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第14行:将返回的数据作为道具发送。</li></ul><p id="4e0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在<code class="fe oa ob oc od b">/pages/dashboard.js</code>中，找到下面这段代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/e32b23212f9bd44869fba82efe73ee77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynRdZ00DNm1O89pJ1GkD-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要在pages/dashboard.js中查找的代码</p></figure><p id="068a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样改变它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/9b1e3d98010548356ce08315b9650e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wh5ajxPA_RHsLWq4MiW2Nw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pages/dashboard.js中要替换的代码</p></figure><p id="0e81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以在组件中使用服务器返回的数据。</p><p id="fd4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在同一个文件中，找到您的<code class="fe oa ob oc od b">return</code>块:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/6c561b4593a9e01897b9bd3db9b46f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_7ItkKhaZL9jnIDmw680A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要在pages/dashboard.js中查找的代码</p></figure><p id="8aa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像这样替换它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/f8d3b68a173d41de8f5ef3489825dc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jkrb-0esfvzN96-JcLTTtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pages/dashboard.js中要替换的代码</p></figure><ul class=""><li id="cd73" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第2行:使用<code class="fe oa ob oc od b">map</code>函数显示我们的数据。</li><li id="e0d8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第4行:每个对象都将显示有<code class="fe oa ob oc od b">Note</code>组件。</li></ul><p id="92c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/fe9ba8b81c4597e6817245d08fa40c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*3If-BlvlKUPJgPTuH-flQQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="c564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的代码有效！现在让我们开始阅读一个特定的文档。</p><p id="8e5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<code class="fe oa ob oc od b">/pages/dashboard.js</code>应该是这样的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="e82c" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">阅读笔记</h2><p id="0457" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">作为第一步，我们需要编写后端代码。在您的<code class="fe oa ob oc od b">/pages/api/notes</code>目录中，创建一个名为<code class="fe oa ob oc od b">[id].js</code>的文件。在这里，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="ed1f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第10行:用特定的<code class="fe oa ob oc od b">id</code>找到用户的笔记。</li><li id="e820" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第12行:以JSON的形式返回文档。</li></ul><p id="f1d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在需要建立我们的前端。在您的<code class="fe oa ob oc od b">/pages/notes</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">[id].js</code>的文件。这意味着这个文件将处理<code class="fe oa ob oc od b">/pages/notes/{id}</code>路径。这里，<code class="fe oa ob oc od b">{id}</code>就是我们笔记的<code class="fe oa ob oc od b">id</code>。</p><p id="3a18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/notes/[id].js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="36a1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第1行:<code class="fe oa ob oc od b">data</code>属性包含我们想要显示的数据。</li><li id="6a2e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第6-7行:显示我们对象的<code class="fe oa ob oc od b">title</code>和<code class="fe oa ob oc od b">body</code>字段。</li><li id="009e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第14行:创建一个<code class="fe oa ob oc od b">getServerSideProps</code>函数从服务器接收数据。</li><li id="ebb3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第18-22行:从数据库获取数据，然后返回它。</li><li id="0187" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第24-31行:如果出现错误，那么将用户重定向到<code class="fe oa ob oc od b">/</code>。</li><li id="2bb0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第33行:将数据作为道具返回给<code class="fe oa ob oc od b">Specific</code>组件。</li></ul><p id="33e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/8e9539dfd1b0e533408c7a47fa36b731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*-FT1p3CP35eNN5mMlbMlPg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="3c23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！我们的代码按预期工作。</p><p id="2078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步，我们将学习如何更新我们的记录。</p><h2 id="22a7" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">更新便笺</h2><p id="9c7e" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在你的<code class="fe oa ob oc od b">/pages/api/note</code>目录中，创建一个名为<code class="fe oa ob oc od b">update</code>的文件夹。在这个文件夹中，创建一个名为<code class="fe oa ob oc od b">[id].js</code>的文件。</p><p id="f2a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/api/note/update/[id].js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="5320" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第11行:检查是否执行了<code class="fe oa ob oc od b">GET</code>请求。</li><li id="d790" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第12行:如果是<code class="fe oa ob oc od b">true</code>，找到位于URL的参数中具有匹配<code class="fe oa ob oc od b">id</code>的注释。</li><li id="d698" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第13行:最后，以JSON的形式返回数据。</li><li id="d572" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第16行:检查是否执行了一个<code class="fe oa ob oc od b">PUT</code>请求。</li><li id="ed1e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第17行:找到匹配<code class="fe oa ob oc od b">id</code>的文档，然后更新它。</li><li id="a2d2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第22行:用用户输入值更新它的<code class="fe oa ob oc od b">title</code>和<code class="fe oa ob oc od b">body</code>字段。</li><li id="2010" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第26行:结束响应。</li></ul><p id="da4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们写我们的前端。在您的<code class="fe oa ob oc od b">/pages/notes</code>文件夹中，创建另一个名为<code class="fe oa ob oc od b">update</code>的目录。在这里，创建一个名为<code class="fe oa ob oc od b">[id].js</code>的文件。</p><p id="221d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/notes/update/[id].js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="9b2e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第3行:在我们的组件中使用<code class="fe oa ob oc od b">data</code>道具。这将包含来自服务器的数据。</li><li id="e97c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第5行:从URL中提取<code class="fe oa ob oc od b">id</code>参数。</li><li id="0eb0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第7行:创建<code class="fe oa ob oc od b">updateNote</code>函数。</li><li id="e91d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第10行:对<code class="fe oa ob oc od b">api/notes/update</code>路由执行一个<code class="fe oa ob oc od b">PUT</code>请求，并将我们的输入<code class="fe oa ob oc od b">title</code>和<code class="fe oa ob oc od b">body</code>字段作为有效载荷发送出去。</li><li id="73ca" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第20行:当请求完成时，将用户重定向到<code class="fe oa ob oc od b">/dashboard</code>页面。</li></ul><p id="068b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，在同一个文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="860f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第6行:当表单提交后，运行<code class="fe oa ob oc od b">updateNote</code>函数。</li><li id="381e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第8-13行:创建我们的<code class="fe oa ob oc od b">input</code>元素。它的初始值将是我们的注释的<code class="fe oa ob oc od b">title</code>字段。</li><li id="fd77" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第15-20行:创建我们的<code class="fe oa ob oc od b">input</code>元素，它将包含注释的<code class="fe oa ob oc od b">body</code>字段作为默认值。</li></ul><p id="bf56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为最后一步，我们需要告诉Next.js获取数据。在该文件中追加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="1b6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能代码与<code class="fe oa ob oc od b">/pages/notes/[id].js</code>文件的功能代码相同。</p><p id="08c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。这将是结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/5386d61e624a77ae7de9ee8c5ddb9639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*4Nb9Tmo81wXQ0wDkT0gGMQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="0ba3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。结果在意料之中。现在让我们删除我们的记录。</p><p id="06f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<code class="fe oa ob oc od b">/pages/notes/update/[id].js</code>应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><h2 id="1105" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">删除记录</h2><p id="a13e" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在您的<code class="fe oa ob oc od b">/pages/api/notes</code>文件夹中，创建一个名为<code class="fe oa ob oc od b">delete</code>的目录。在这里，创建一个名为<code class="fe oa ob oc od b">[id].js</code>的文件。</p><p id="ab20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oa ob oc od b">/pages/api/notes/delete/[id].js</code>中，编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><ul class=""><li id="c0b8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">第11行:找到带有匹配的<code class="fe oa ob oc od b">id</code>和<code class="fe oa ob oc od b">user</code>字段的注释。如果找到，就删除。</li><li id="ca6f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第20行:结束响应。</li></ul><p id="9107" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行代码。结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/603e6d0e97efbf990828185f5206e54c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*jMo6f5UTXEmrk4YCZF-tbg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码的输出</p></figure><p id="3e8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们完事了。结果在意料之中。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="b64e" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">额外资源</h1><h2 id="45a3" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">GitHub知识库</h2><ul class=""><li id="4763" class="lv lw it lb b lc ni lf nj li oz lm pa lq pb lu ma mb mc md bi translated"><a class="ae ky" href="https://github.com/HussainArif12/nextjs-login-tutorial" rel="noopener ugc nofollow" target="_blank">这是项目的代码</a></li></ul><h2 id="3b0a" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">其他学习材料</h2><ul class=""><li id="0316" class="lv lw it lb b lc ni lf nj li oz lm pa lq pb lu ma mb mc md bi translated"><a class="ae ky" href="https://blog.logrocket.com/using-authentication-in-next-js/" rel="noopener ugc nofollow" target="_blank">使用NextJS-LogRocket认证</a></li><li id="de72" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=o_wZIVmWteQ" rel="noopener ugc nofollow" target="_blank">使用NextAuth的NextJS认证—詹姆斯·珀金斯</a></li><li id="6448" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=iJ_MiYEgDiM" rel="noopener ugc nofollow" target="_blank">使用Next构建网飞克隆。Js和下一位作者——李·罗宾逊</a></li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a48d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="c65f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">NextAuth.js让开发者更容易在他们的应用中构建用户认证功能。因此，这改善了开发人员的体验。此外，我们不需要构建外部Express服务器来构建我们的登录系统。所有的工作都在Next.js中完成，从而保证了一个更快、更高性能的应用程序。</p><p id="62e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你遇到任何问题，我建议你解构这个程序，用代码来玩。非常感谢你坚持到最后！</p></div></div>    
</body>
</html>