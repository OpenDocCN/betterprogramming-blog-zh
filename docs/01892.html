<html>
<head>
<title>Build a React Component Library and Publish to the GitHub Package Registry</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个React组件库并发布到GitHub包注册中心</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-your-very-own-react-component-library-and-publish-it-to-github-package-registry-192a688a51fd?source=collection_archive---------1-----------------------#2019-10-21">https://betterprogramming.pub/build-your-very-own-react-component-library-and-publish-it-to-github-package-registry-192a688a51fd?source=collection_archive---------1-----------------------#2019-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="119a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当跨多个项目工作时，它总是很方便</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4436763a62f537f25d83d253eed745fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JNpk3yLpt9f4x_aEO5pa-w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com/@sapegin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Artem Sapegin </a>在<a class="ae ky" href="https://unsplash.com/s/photos/react?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="cada" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有一套设计精美的组件，完美到可以从一个项目复制到另一个项目？你梦想过用<code class="fe lv lw lx ly b">npm install</code>把它放到你的下一个应用中，而不是必须复制/粘贴它吗？如果是这样，你来对地方了！</p><p id="280a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，您将学习如何构建自己的React组件库，并将其发布到全新的GitHub包注册表中！</p><p id="e6e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你将会用到以下这些很酷的东西:</p><ul class=""><li id="6ad2" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><a class="ae ky" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">打字稿</strong> </a>:这个不用介绍了，希望！</li><li id="38d8" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://rollupjs.org/guide/en/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Rollup.js </strong> </a>:一个Javascript模块bundler来编译我们的代码，</li><li id="dd47" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Create-react-App</strong></a>:创建一个简单的React应用程序的简单方法，我们将用它作为测试你的组件的平台。</li><li id="3a6b" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://www.npmjs.com/package/npm-run-all" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">【Npm-run-all】</strong></a>:一个CLI工具，可以并行运行多个Npm脚本，</li><li id="54ea" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://github.com/features/package-registry" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> GitHub包注册表</strong> </a> : GitHub的包管理服务，可以很方便的在你的源代码旁边发布公有或者私有的包。</li></ul><p id="e3f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，我的作品的所有代码都可以在我的GitHub上找到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/9429d5b378ada1c70c29864b08cbe3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aTGGrVkd-tV1Z4eJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克劳迪奥·泰斯塔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="6bf7" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">时间就是金钱，让我们开始吧！</h1><h2 id="c8b2" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">package.json</h2><p id="c0e3" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">在您选择的目录中，创建一个新的<code class="fe lv lw lx ly b">package.json</code>文件并安装我们需要的第一个<code class="fe lv lw lx ly b">devDependencies</code>。</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="390e" class="nn mw it ly b gy oi oj l ok ol">$ npm init -y<br/>$ npm i -D <!-- -->@types/react @types/react-dom @types/styled-components typescript</span></pre></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="db11" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">tsconfig.json</h2><p id="052c" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">正如我所说的，我们将使用TypeScript，因此，我们的项目需要一个TypeScript配置。</p><p id="e325" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要生成一个，通过运行<code class="fe lv lw lx ly b">$ npm i -g typescript </code>确保您的环境中已经全局安装了TypeScript，然后只需运行<code class="fe lv lw lx ly b">$ tsc --init</code>。</p><p id="1de5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个命令生成一个json文件，我们将在其中修改一些东西:</p><ul class=""><li id="418f" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">取消对<code class="fe lv lw lx ly b">jsx</code>键的注释，将其值改为<code class="fe lv lw lx ly b">react</code></li><li id="b146" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">将<code class="fe lv lw lx ly b">module</code>设置为<code class="fe lv lw lx ly b">ESNext</code></li><li id="935f" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">取消注释<code class="fe lv lw lx ly b">outDir</code>并将其设置为<code class="fe lv lw lx ly b">./dist</code></li><li id="ab68" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">取消注释<code class="fe lv lw lx ly b">declaration</code></li><li id="c7b1" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">取消注释<code class="fe lv lw lx ly b">moduleResolution</code></li><li id="d766" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">在编译器选项下面，添加<code class="fe lv lw lx ly b">"include":["src/**/*"].</code></li></ul><p id="9ae9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的<code class="fe lv lw lx ly b">tsconfig.json</code>文件应该如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="290a" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">创建我们库的第一个组件</h1><p id="2441" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">我们库的所有组件都在一个<code class="fe lv lw lx ly b">./src</code>文件夹中。</p><p id="5a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该结构将如下所示:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="629f" class="nn mw it ly b gy oi oj l ok ol">-- src/<br/>   |-- my-component/<br/>       |-- index.tsx <br/>   |-- index.ts</span></pre><p id="7048" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">index.ts</code>将是我们的主文件，导出我们将创建的所有组件。当我们谈论它时，这是创建我们的第一个React组件的好时机！</p><p id="7b50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">my-component/index.tsx</code>内部，编写一个简单的React组件。</p><p id="78d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个例子:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="de0c" class="nn mw it ly b gy oi oj l ok ol">import React from 'react';<br/>import styled from 'styled-components';<br/><br/>const StyledMyComponent = styled.div&lt;{ color?: string }&gt;`<br/>  color: ${p =&gt; p.color || 'pink'};<br/>`;<br/><br/>interface MyComponentProps {<br/>  text: string;<br/>  color?: string;<br/>}<br/><br/>const MyComponent: React.FC&lt;MyComponentProps&gt; = ({ text, color }) =&gt; (<br/>  &lt;StyledMyComponent color={color}&gt;{text}&lt;/StyledMyComponent&gt;<br/>);<br/><br/>export { MyComponentProps, MyComponent };</span></pre><p id="d902" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不是最有用的组件，但这只是为了测试。</p><p id="f2b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从<code class="fe lv lw lx ly b">./src</code>文件夹的<code class="fe lv lw lx ly b">index.ts</code>中导出该组件:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="e829" class="nn mw it ly b gy oi oj l ok ol">import { MyComponent } from './my-component';<br/><br/>export { MyComponent };</span></pre></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="80a9" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">使用Rollup.js构建我们的库</h1><p id="31f8" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">太好了—我们已经创建了一个奇妙的React组件！</p><p id="5cad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，要建立我们的图书馆，我们必须做三件事:</p><ul class=""><li id="22d7" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">需要安装<code class="fe lv lw lx ly b">devDependencies</code></li><li id="35b9" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">创建<code class="fe lv lw lx ly b">Rollup</code>配置，</li><li id="1226" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">向<code class="fe lv lw lx ly b">package.json</code>添加新脚本。</li></ul><p id="fd74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们来关注一下<code class="fe lv lw lx ly b">devDependencies</code>。我们需要:</p><ul class=""><li id="2b5d" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><a class="ae ky" href="https://www.npmjs.com/package/rollup" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Rollup </strong> </a>:我们的模块捆绑器，</li><li id="130c" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://www.npmjs.com/package/rollup-plugin-delete" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">roll up-plugin-delete</strong></a>:一个插件，会负责每次构建之间的垃圾(清理<code class="fe lv lw lx ly b">./dist</code>文件夹)，</li><li id="7e4e" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://www.npmjs.com/package/rollup-plugin-typescript2" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Rollup-plugin-typescript 2</strong></a>:一个用于TypeScript的roll up插件，</li></ul><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="9613" class="nn mw it ly b gy oi oj l ok ol">$ npm i -D <!-- -->rollup rollup-plugin-delete rollup-plugin-typescript2</span></pre><p id="567f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在根文件夹中创建一个<code class="fe lv lw lx ly b">rollup.config.js</code>文件。它应该是这样的:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="4578" class="nn mw it ly b gy oi oj l ok ol">import typescript from 'rollup-plugin-typescript2';<br/>import del from 'rollup-plugin-delete';<br/>import pkg from './package.json';<br/><br/>export default [<br/>  {<br/>    input: 'src/index.ts',<br/>    output: [<br/>      {<br/>        file: 'playground/src/component-lib/index.js',<br/>        format: 'esm',<br/>        banner: '/* eslint-disable */',<br/>      },<br/>      { file: pkg.main, format: 'cjs' },<br/>      { file: pkg.module, format: 'esm' },<br/>    ],<br/>    plugins: [<br/>      del({ targets: ['dist/*', 'playground/src/component-lib'] }),<br/>      typescript(),<br/>    ],<br/>    external: Object.keys(pkg.peerDependencies || {}),<br/>  },<br/>];</span></pre><p id="fd9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要求<code class="fe lv lw lx ly b">Rollup</code>做的事情:</p><ul class=""><li id="412e" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">将<code class="fe lv lw lx ly b">src/index.ts </code>作为输入</li><li id="44ad" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">将生成的库的一个副本输出到我们的playground(我们将在下一步中创建它)，一个副本输出到一个具有两种格式的<code class="fe lv lw lx ly b">./dist</code>文件夹中:<em class="oo"> EsModules格式</em> (esm)和<em class="oo"> CommonJS格式</em> (cjs)。我们的<code class="fe lv lw lx ly b">package.json</code>需要知道它们，所以让我们修改它:</li></ul><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="7db4" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>    "main": <strong class="ly iu">"dist/index.cjs.js"</strong>,<br/>    "module": "dist/index.esm.js",<br/>  ...<br/>}</span></pre><ul class=""><li id="f3fb" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">我们使用两个插件，<code class="fe lv lw lx ly b">TypeScript</code>和<code class="fe lv lw lx ly b">Del</code>T23。我们为<code class="fe lv lw lx ly b">Del</code>提供了两个目录来在每次构建之后进行清理，</li><li id="99da" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><em class="oo">外部</em>键告诉<code class="fe lv lw lx ly b">Rollup</code>我们不希望它与我们的项目捆绑在一起的依赖项。它们来自我们的<code class="fe lv lw lx ly b">package.json</code>，所以让我们把它们写在那里:</li></ul><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="657a" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>    "peerDependencies": {<br/>      "react": "^16.10.2",<br/>      "react-dom": "^16.10.2",<br/>      "styled-components": "^4.4.0"<br/>    },<br/>  ...<br/>}</span></pre><p id="087f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们几乎完成了<code class="fe lv lw lx ly b">Rollup</code>！我们需要做的最后一件事是向我们的<code class="fe lv lw lx ly b">package.json</code>添加两个脚本:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="607a" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>    "scripts": {<br/>      "build": "rollup -c",<br/>      "build-watch": "rollup -c -w",<br/>    },<br/>  ...<br/>}</span></pre></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="7e2b" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">在我们的项目中添加一个测试平台</h1><p id="7c17" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">如果有一个地方让我们可以玩我们的组件，那不是很酷吗？<code class="fe lv lw lx ly b">Create-react-app</code>非常适合这种情况。</p><p id="1b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的环境中全局安装一个CRA的副本，并在项目的根目录下创建一个<code class="fe lv lw lx ly b">playground</code>。</p><p id="6b92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您计划使用styled-components库创建组件，不要忘记在playground的依赖项中安装它的副本:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="10ca" class="nn mw it ly b gy oi oj l ok ol">$ npm i -g create-react-app<br/>$ create-react-app playground --typescript<br/>$ cd playground &amp;&amp; npm i styled-components</span></pre><p id="3452" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加这三个脚本，让所有的东西一起工作:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="69eb" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>    "scripts": {<br/>      "build": "rollup -c",<br/>      "build-watch": "rollup -c -w",<br/>      <strong class="ly iu">"start-playground": "cd playground &amp;&amp; npm run start",<br/>      "i-all": "npm i &amp;&amp; cd playground &amp;&amp; npm i",<br/>      "dev": "npm-run-all --parallel build-watch start-playground"</strong><br/>    },<br/>  ...<br/>}</span></pre><p id="23a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:我们正在使用<code class="fe lv lw lx ly b">npm-run-all</code>同时运行多个进程，不要忘记将其安装为<code class="fe lv lw lx ly b">devDependencies</code>:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="c877" class="nn mw it ly b gy oi oj l ok ol">$ npm i -D npm-run-all</span></pre><p id="8bd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很好！用<code class="fe lv lw lx ly b">$ npm run i-all</code>安装node_modules之后，您应该能够运行<code class="fe lv lw lx ly b">$ npm run dev</code>。</p><p id="2948" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将构建我们的库，观察修改，并在<code class="fe lv lw lx ly b"><a class="ae ky" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code> <a class="ae ky" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank">运行Playground App。</a></p><p id="d3b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们操场的源文件夹(<code class="fe lv lw lx ly b">playground/src</code>)里，你应该可以在一个<code class="fe lv lw lx ly b">./component-lib</code>文件夹里找到我们库的副本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/f5f40800207519bccb4b429793735329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xvy2CaoHjrKnr3zw"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="2f05" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">将我们的库发布到GitHub包注册表</h1><p id="8cac" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">恭喜你建立了自己的组件库！</p><p id="ea5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程的最后一步是教你如何将你的库发布到<a class="ae ky" href="https://github.com/features/package-registry" rel="noopener ugc nofollow" target="_blank"> GitHub包注册表</a>。</p><p id="1946" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在发布我们的库之前，我们有一些事情要做</p><h2 id="48da" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated"><strong class="ak">重命名您的包</strong></h2><p id="0fa6" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">到目前为止，你的<code class="fe lv lw lx ly b">package.json</code>应该有你的文件夹的名字。为了发布你的包，你需要像这样重命名它:<br/> <code class="fe lv lw lx ly b">@&lt;github_name&gt;/&lt;repo&gt;</code>。在我的例子中，它看起来像这样:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="eb71" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>  "name": "@thmsgbrt/my-react-component-library",<br/>  ...<br/>}</span></pre><h2 id="fca6" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">我们想发布什么？</h2><p id="3793" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">当然，我们希望包含我们生成的库，它可以在<code class="fe lv lw lx ly b">./dist</code>文件夹中找到。</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="36a5" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>  "files": "dist",<br/>  ...<br/>}</span></pre><h2 id="c31c" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">在哪里可以找到我们的类型定义文件？</h2><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="9c50" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>  "typings": "dist/index.d.ts",<br/>  ...<br/>}</span></pre><h2 id="4b06" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">我们在哪里发布我们的包？</h2><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="93c8" class="nn mw it ly b gy oi oj l ok ol">{<br/>  ...<br/>  "publishConfig": {<br/>    "registry": "https://npm.pkg.github.com"<br/>  },<br/>  ...<br/>}</span></pre><p id="f7e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在应该可以出版了。</p><p id="a93b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们跑<code class="fe lv lw lx ly b">$ npm publish</code>。</p><p id="0392" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你以前从未发布到GitHub包库，你可能会有一个错误…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/2daedb0e52da217070069da5f1ef5601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhbXsCmRZN9S6pXH_ZeLxA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">npm要求您先登录🤷‍♂️</p></figure><h2 id="b6d3" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">登录GitHub，然后发布你的包(我发誓)</h2><p id="4d0a" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">首先，您需要生成一个令牌。转到你的GitHub的开发者设置，在个人访问令牌标签中(<a class="ae ky" href="https://github.com/settings/tokens" rel="noopener ugc nofollow" target="_blank">如果你懒的话点击这里</a>，按<em class="oo">生成新令牌</em>)。</p><p id="12c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要的最小范围是<code class="fe lv lw lx ly b">write:packages</code>和<code class="fe lv lw lx ly b">read:packages</code>(这也将检查回购范围)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/0d830be87ff9e8c1833f930963a9fe98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LkyHb20puPEhHlv70QJlUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">生成新令牌，选择范围</p></figure><p id="bf72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击页面底部的<em class="oo">生成令牌</em>将生成一个令牌。复制它！</p><p id="ab8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到您的终端，运行以下命令:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="cb60" class="nn mw it ly b gy oi oj l ok ol">$ npm login --registry=https://npm.pkg.github.com</span></pre><p id="076d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统会提示您填写您的GitHub用户名、电子邮件和密码。</p><p id="3c52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="oo">使用令牌作为您的密码</em> </strong>，您就应该登录了！</p><p id="8534" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将在您的环境的<code class="fe lv lw lx ly b">.npmrc</code>文件中添加一个新条目，如下所示:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="a645" class="nn mw it ly b gy oi oj l ok ol">//npm.pkg.github.com/:_authToken=&lt;YOUR_TOKEN&gt;</span></pre><p id="964f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在试着运行<code class="fe lv lw lx ly b">$ npm publish</code>，应该会成功！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/310f4fa72ac6021dea159992080dba4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXE1YDwTDpD8fq-vryd2hA.png"/></div></div></figure><p id="9257" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的包现在可以在Github上看到了。</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="ac67" class="nn mw it ly b gy oi oj l ok ol">https://github.com/&lt;name&gt;/&lt;repo&gt;/packages</span></pre><h2 id="4514" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">在您的项目中安装软件包</h2><blockquote class="ot ou ov"><p id="1f52" class="kz la oo lb b lc ld ju le lf lg jx lh ow lj lk ll ox ln lo lp oy lr ls lt lu im bi translated">太棒了，托马斯，但是，我如何在我的项目中安装它呢？</p></blockquote><p id="61c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好问题！答案很简单。\</p><p id="fdfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在与项目的<code class="fe lv lw lx ly b">package.json</code>相同的目录下创建一个<code class="fe lv lw lx ly b">.npmrc</code>文件。</p><p id="7feb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用一个GitHub注册表的链接填充它，用你的GitHub名字。</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="125a" class="nn mw it ly b gy oi oj l ok ol">registry=https://npm.pkg.github.com/&lt;github_name&gt;</span></pre><p id="b976" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！</p><p id="7443" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，尝试运行安装命令:</p><pre class="kj kk kl km gt oe ly of og aw oh bi"><span id="085d" class="nn mw it ly b gy oi oj l ok ol">$ npm install @&lt;github_name&gt;/&lt;package&gt;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/c4615303444bfd8f8cbbcdb1420c8608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*36wxap8Q67P2NANVG7zUXQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">它有效</p></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="1870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您已到达本教程的结尾！恭喜你！</p><p id="cbe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你学到了一些东西，我学到了很多！</p><p id="d157" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想看看完成的项目吗？下面是你的链接:<a class="ae ky" href="https://github.com/thmsgbrt/my-react-component-library" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="0e80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">觉得这篇文章有用？在Medium上关注我(<a class="ae ky" href="https://medium.com/@th.guibert" rel="noopener">托马斯·吉伯特</a>)，看看我下面最受欢迎的文章！请👏这篇文章分享一下吧！</p><ul class=""><li id="fe9f" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/better-programming/everyday-activities-to-become-a-better-developer-3d00ec8d14a5" rel="noopener">帮助你成为更好的开发者的日常活动</a></li><li id="10a6" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/swlh/convert-your-javascript-react-app-to-typescript-the-easy-guide-631592dc1876" rel="noopener">将您的Javascript React应用程序转换为TypeScript，这是一个简单的指南</a></li><li id="2c05" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/better-programming/create-a-chrome-extension-using-react-and-typescript-50e94e14320c" rel="noopener">使用React和TypeScript创建一个Chrome扩展</a></li></ul></div></div>    
</body>
</html>