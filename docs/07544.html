<html>
<head>
<title>How to Migrate Environment Variables (ENV) to Rails Credentials</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将环境变量(ENV)迁移到Rails凭证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-migrate-environment-variables-env-to-rails-credentials-d3f48164f7c8?source=collection_archive---------6-----------------------#2021-01-26">https://betterprogramming.pub/how-to-migrate-environment-variables-env-to-rails-credentials-d3f48164f7c8?source=collection_archive---------6-----------------------#2021-01-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="17d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一把钥匙统治着他们所有人</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d7d1d266f4fa9ab7703817558d9f9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBwi0FnJ1xgIyNWWfy_00w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="6bf5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Rails凭证是新的黄金标准。ENV文件是不安全的祖先。在本文中，您将了解为什么以及如何进行迁移，如何在Ruby、YML和js.erb中使用API键，以及如何与您的团队共享一个键。</p><p id="692c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">DHH在近三年前就在推特上发布了它的到来，但新技术往往需要时间才能跟上。当您发现自己过于频繁地在团队中的开发人员之间摆弄API键时，就需要敲响警钟了。可能是时候重新审视一下如何在rails应用程序中实现凭证了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f43d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">你为什么要从？Env到凭据？</h1><p id="d136" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">项目在开发周期中进行得越久，集成的服务就越多。每个外部服务都有自己的API键。开发人员通常不会花太长时间就开始为最新的API密钥寻找队友。好烦啊！</p><p id="66c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者，想象一下当一个API键被刷新时。每个开发人员都必须单独将其更新到本地dotenv文件中。这似乎是反自动化和反程序化的——的确如此。</p><p id="e6d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">停止通过Slack或电子邮件发送API密钥，避免您的密钥出现安全漏洞。幸运的是，rails凭证提供了一个简单且受欢迎的继任者。上传你的密钥到Github。</p><p id="14e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上传到Github！？是的，上传到Github！一个小注释是API密钥是完全加密的。</p><p id="39f3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最大的优势是只有一个密钥可以与您的团队共享。永远不会变！当您从Github获取最新的main ( <a class="ae na" href="https://www.zdnet.com/article/github-to-replace-master-with-main-starting-next-month/" rel="noopener ugc nofollow" target="_blank"> prev)时，您的开发伙伴作为rails凭证添加的任何新的API键都会从Github获取。高手</a>)。</p><p id="06ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以在config/master.key文件夹中找到该密钥。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="da23" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">它是如何工作的</h1><p id="7c1e" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在rails中运行<code class="fe nb nc nd ne b">bin/rails credentials:edit</code>会在config文件夹中创建两个所需的文件:</p><ul class=""><li id="4308" class="nf ng it la b lb lc le lf lh nh ll ni lp nj lt nk nl nm nn bi translated"><code class="fe nb nc nd ne b">credentials.yml.enc</code>存储你所有的API密匙。如果你想知道。enc扩展名表示加密。</li><li id="bb9d" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated"><code class="fe nb nc nd ne b">master.key</code>是用来解密encrypted.file的密钥(1。)确保检查您的<code class="fe nb nc nd ne b">.gitignore.yml</code>文件中是否包含了<code class="fe nb nc nd ne b">master.key</code>。</li></ul><p id="3d5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nb nc nd ne b">Credentials.yml.enc</code>是否安全可靠地与您的存储库一起发送到Github。然而，万能钥匙是不会被送来的——要像保护你的生命一样保护它！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f71b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">从...迁移。Env到Rails凭据</h1><p id="f330" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在您的终端中运行以下命令打开凭证文件:<br/> <code class="fe nb nc nd ne b">EDITOR='code --wait' bin/rails credentials:edit</code>。根据你当前使用的编辑器，替换<code class="fe nb nc nd ne b">code</code> (VS代码)。例如:</p><ul class=""><li id="acaf" class="nf ng it la b lb lc le lf lh nh ll ni lp nj lt nk nl nm nn bi translated">vim或vi= Vim</li><li id="ec5c" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">原子=原子</li><li id="b2b7" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">subl或stt = Sublime</li></ul><p id="a31e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">凭据文件会在编辑器中自动打开，并等待您再次更新和关闭该文件。迁移您在中使用的ENV键。env文件添加到credentials.yml文件中。</p><p id="46af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">转遗产<code class="fe nb nc nd ne b">.ENV</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt lv l"/></div></figure><p id="faa4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">变成了<code class="fe nb nc nd ne b">credentials.yml</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt lv l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">注意:Cloudinary API键是按照文档分解的。</p></figure><p id="ef6a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您现在一切就绪。查看凭证可以在终端中运行。<br/>运行<code class="fe nb nc nd ne b">bin/rails credentials:show</code> <strong class="la iu">。</strong></p><p id="806a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在是时候对那个旧的<code class="fe nb nc nd ne b">.ENV</code>文件说再见并删除它了。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="5353" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">如何在多种文件格式中使用凭证，比如Ruby、YML和JavaScript</h1><h2 id="7b07" class="nu me it bd mf nv nw dn mj nx ny dp mn lh nz oa mp ll ob oc mr lp od oe mt of bi translated"><strong class="ak">红宝石</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og lv l"/></div></figure><h2 id="9a84" class="nu me it bd mf nv nw dn mj nx ny dp mn lh nz oa mp ll ob oc mr lp od oe mt of bi translated"><strong class="ak"> YML </strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og lv l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对于Cloudinary，需要一个额外的<a class="ae na" href="https://gist.github.com/thomasvanholder/6ee92715274ad993f080db15ed3dd177" rel="noopener ugc nofollow" target="_blank"> config/cloudinary.yml </a>文件</p></figure><h2 id="a0fe" class="nu me it bd mf nv nw dn mj nx ny dp mn lh nz oa mp ll ob oc mr lp od oe mt of bi translated">Java Script语言</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og lv l"/></div></figure><h2 id="9296" class="nu me it bd mf nv nw dn mj nx ny dp mn lh nz oa mp ll ob oc mr lp od oe mt of bi translated"><strong class="ak"> HTML </strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og lv l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2017" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">如何与团队共享密钥</h1><ul class=""><li id="03b5" class="nf ng it la b lb mv le mw lh oh ll oi lp oj lt nk nl nm nn bi translated">与其他开发人员共享<code class="fe nb nc nd ne b">master.key</code>中的密钥来实现解密。</li><li id="6cf6" class="nf ng it la b lb no le np lh nq ll nr lp ns lt nk nl nm nn bi translated">每个团队成员在本地的config文件夹中创建一个<code class="fe nb nc nd ne b">master.key</code>文件，并将其粘贴到共享密钥中。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="cc50" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="5cd0" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">没有追逐正确的API键的麻烦，编码更有趣。你的应用采用最新的安全最佳实践。一次共享一个主密钥，避免繁琐的复制粘贴。</p><p id="91c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！</p></div></div>    
</body>
</html>