<html>
<head>
<title>Introduction to Docker Extensions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker扩展简介</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/introduction-to-docker-extensions-b95a582a6ecc?source=collection_archive---------11-----------------------#2022-05-19">https://betterprogramming.pub/introduction-to-docker-extensions-b95a582a6ecc?source=collection_archive---------11-----------------------#2022-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="210c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让你的docker环境超级牛逼！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ec05df7146efdb8dbbc8d32c0e3e4705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6BduAahul2KGyg4k"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@carrier_lost" rel="noopener ugc nofollow" target="_blank">伊恩·泰勒</a>在<a class="ae kv" href="http://unsplash.com" rel="noopener ugc nofollow" target="_blank"> unsplash </a>拍照</p></figure><p id="ef41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Docker在上一个dockerCon中引入了docker-extensions。</p><p id="21ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它目前是一个测试功能，看起来它可以给docker生态系统带来令人难以置信的启示，并增强开发人员的体验和提高生产力。</p><p id="fd41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来探索这个有前途的新特性。</p><h1 id="c8a8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">前提</h1><p id="b39a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，你必须安装docker-desktop的4.8以上版本。只需遵循此处的安装指南<a class="ae kv" href="https://docs.docker.com/desktop/" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="c7ab" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Docker扩展概述</h1><p id="8e49" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦你安装了docker-desktop，你就可以看一下仪表盘了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/0cb399f8b6e3ce5c32958bd13b1af35e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Tz6bZwHx1N6XzV5opCK5g.png"/></div></div></figure><p id="dc6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，在屏幕左侧有一个扩展部分。大家点一下吧:)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/fdf92239de81573e98750b68c0b0eaa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKEAPK6cXA3iVMBPjMnPDQ.png"/></div></div></figure><p id="ba15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经到达了docker的扩展市场，在那里我们可以搜索由令人敬畏的开源社区提供的扩展。</p><p id="56c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有几个例子:</p><ol class=""><li id="0ad9" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">网真——由大使实验室开发。允许开发人员直接连接到远程Kubernetes集群并与之交互。</li><li id="5609" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">jrog—使用JFrogs Xray对您的docker映像运行漏洞检查</li><li id="31bd" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">日志浏览器—查看所有容器中的日志，以便于故障排除。</li><li id="a5ba" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">OpenShift —与Rad Hat的OpenShift编排工具轻松集成。</li></ol><p id="eb61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有更多！</p><h1 id="40b5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">构建自己的扩展！</h1><p id="2041" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">是的，您也可以构建自己的扩展。</p><p id="e7e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们开始吧！</p><h2 id="cdfa" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤0:前提条件</h2><ul class=""><li id="5b45" class="mq mr iq ky b kz mk lc ml lf nq lj nr ln ns lr nt mw mx my bi translated">如上所述，您必须拥有docker-desktop 4.8或更高版本</li><li id="cf42" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">Golang — go将用于创建与dockers守护进程交互的后端部分</li><li id="97e6" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">nodejs——将使用react来创建UI元素</li><li id="ca77" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">Make — make用于在Windows计算机上运行配置和安装插件。你可以用mingw-make</li></ul><h2 id="fc9e" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤1:安装docker扩展CLI</h2><ul class=""><li id="5ade" class="mq mr iq ky b kz mk lc ml lf nq lj nr ln ns lr nt mw mx my bi translated">从<a class="ae kv" href="https://github.com/docker/extensions-sdk/releases" rel="noopener ugc nofollow" target="_blank">此链接</a>下载docker扩展CLI</li><li id="9b7f" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">提取tar文件；它包含一个可执行文件</li><li id="73e6" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">将可执行文件移动到<code class="fe nu nv nw nx b">${user_dir}\.docker\cli-plugins</code>(如果文件夹不存在，您需要创建它)</li></ul><h2 id="b68b" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤2:初始化扩展项目</h2><p id="695a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">安装docker扩展CLI后，我们可以用它来初始化项目。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="7ded" class="ne lt iq nx b gy oc od l oe of">docker extension init first-ever-extension</span></pre><p id="4a27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将获取所有Golang和NodeJS的前提条件和模板。</p><p id="7c33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将提示几个关于扩展属性的问题，所有这些都是可以更改的。</p><p id="93bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要有耐心；这需要时间！</p><p id="8c9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是输出结果:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="c2da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们看看创建的文件夹，<code class="fe nu nv nw nx b">first-ever-extension</code>。为了方便，我用VS代码打开了它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/479b1f356e086cce9ae0d51381f67e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*8ZDal-_FiDuYwo-1SCp3tg.png"/></div></figure><ul class=""><li id="5734" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr nt mw mx my bi translated"><code class="fe nu nv nw nx b">ui</code> =包含用reactjs编写的UI组件的文件夹</li><li id="ace3" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated">包含用golang编写的后端组件的文件夹</li><li id="1985" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated"><code class="fe nu nv nw nx b">docker.svg</code> =扩展区域中呈现的图像</li><li id="ba43" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated"><code class="fe nu nv nw nx b">Makefile</code> =标准制定定义</li><li id="a53e" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr nt mw mx my bi translated"><code class="fe nu nv nw nx b">metadata</code> =关于扩展包的详细信息</li></ul><p id="8aab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:这个文件夹很重！超过265 MB。</p><h2 id="1cb9" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤3:编辑代码</h2><p id="46fa" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们来看看后端主函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="d40c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">后端基于echo包。它监听<code class="fe nu nv nw nx b">hello</code> get请求并返回一个JSON响应<code class="fe nu nv nw nx b">{“‘message”: ”hello”}</code>。</p><p id="2419" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们用<code class="fe nu nv nw nx b">{“‘message”: ”hello”, “time”:${currenttime}}</code>来代替:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="572e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，我们导入了Go的<code class="fe nu nv nw nx b">time</code>包，然后我们用它将当前时间添加到响应中。</p><h2 id="45ef" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤4:构建扩展</h2><p id="5935" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将使用make(或mingw-make)来构建扩展:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="9fa5" class="ne lt iq nx b gy oc od l oe of">mingw32-make build-extension</span></pre><p id="fcf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再次强调，要有耐心。也是需要时间的！</p><p id="d0b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后，转到docker-desktop并导航到图像区域。<br/>您可以根据创建日期对表格进行排序，您可以在顶部找到您的扩展图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/5c9067881d45dcaad3e532ad8a017c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWqdj6Dsq3lRpYyPCx4bVQ.png"/></div></div></figure><h2 id="295a" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">步骤5:安装扩展</h2><p id="729c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们使用docker扩展CLI工具，通过以下命令将扩展安装到docker-desktop中:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="d054" class="ne lt iq nx b gy oc od l oe of">docker extension install my-namespace/my-awesome-extension</span></pre><p id="76c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，我们将其命名为图像名。</p><p id="48d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您看到确认信息时，点击“y”并回车继续。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="3b5e" class="ne lt iq nx b gy oc od l oe of">Extensions can install binaries, invoke commands and access files on your machine. <br/>Are you sure you want to continue? [y/N] y<br/>Installing new extension "my-namespace/my-awesome-extension"<br/>Installing service in Desktop VM...<br/>Setting additional compose attributes<br/>VM service started<br/>Installing Desktop extension UI for tab "First-Ever-Extension"...<br/>Extension UI tab "First-Ever-Extension" added.<br/>Extension "first-ever-extension" installed successfully</span></pre><h2 id="8c71" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">第六步:使用扩展</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/9c254642e0516d1268f713ccb79c50f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*Znpb-bTFNzMlcwmzaw_V-g.png"/></div></figure><p id="d38d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很好。我们的分机安装好了！让我们单击我们的扩展小部件并使用它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/11629b64923a546a98cc9a480ade1f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Ira82oNXmqIlzdzlw6S6A.png"/></div></div></figure><p id="017e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们启动扩展时得到的标准GUI。现在，让我们点击“呼叫后端”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/50903b9b34d5eb5f01c01ce9f914a4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*ZNKgQpJsFaLg3BKy9LR7Ag.png"/></div></figure><p id="36ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不错！它给了我们当前的UTC时间:)</p><h2 id="33f2" class="ne lt iq bd lu nf ng dn ly nh ni dp mc lf nj nk me lj nl nm mg ln nn no mi np bi translated">第七步:进行更新</h2><p id="e444" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">请记住，扩展仍然是测试版的功能，所以事情不会总是那么顺利。</p><p id="516f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们转到位于<code class="fe nu nv nw nx b">ui</code>目录中的<code class="fe nu nv nw nx b">app.js</code>文件。代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="9f10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们看到它有一个“呼叫后端”按钮。</p><p id="3f6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当它被点击时，它调用<code class="fe nu nv nw nx b">get</code>函数，该函数向后端发送“hello”请求，然后用来自后端的响应中的字符串化JSON设置状态。</p><p id="e176" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们添加一个新按钮，在我的docker守护进程上打印图像的数量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="f54a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模块将提供两个按钮:一个使用docker客户端从守护进程获取图像列表，另一个向后端发送“hello”请求并返回stringified JSON。</p><p id="afa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们需要重建图像:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="15da" class="ne lt iq nx b gy oc od l oe of">mingw32-make build-extension</span></pre><p id="7011" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后重新安装该映像</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="22ee" class="ne lt iq nx b gy oc od l oe of">docker extension install my-namespace/my-awesome-extension</span></pre><p id="6489" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是输出结果:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="428c" class="ne lt iq nx b gy oc od l oe of">Extensions can install binaries, invoke commands and access files on your machine. <br/>Are you sure you want to continue? [y/N] y<br/>Installing new extension "my-namespace/my-awesome-extension"<br/>Installing service in Desktop VM...<br/>Setting additional compose attributes<br/>VM service started<br/>Installing Desktop extension UI for tab "First-Ever-Extension"...<br/>Extension UI tab "First-Ever-Extension" added.<br/>Extension "first-ever-extension" installed successfully</span></pre><p id="8cd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后的结果是:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oh l"/></div></figure><p id="e015" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">漂亮！</p><h1 id="a1eb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后一个音符</h1><p id="114b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这个新特性将有助于将许多devops工作，特别是devsecops考虑事项，转移到左边。</p><p id="caf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它可以提高开发人员的生产力，并帮助快速交付高质量的软件产品。</p><p id="234c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我个人很好奇这会把我们引向何方。</p></div></div>    
</body>
</html>