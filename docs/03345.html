<html>
<head>
<title>Replace Delegation With RxSwift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用RxSwift替换委托</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/replace-delegation-with-rxswift-32ad18d75140?source=collection_archive---------18-----------------------#2020-02-04">https://betterprogramming.pub/replace-delegation-with-rxswift-32ad18d75140?source=collection_archive---------18-----------------------#2020-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1f8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不再有协议一致性，只有简单的可观察性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8c91289972f9254b9db68487db4f6ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5nGXpwK9Vn-6bpzB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@oria_hector?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">赫克托·马丁内斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将学习如何将数据从一个显示的视图控制器发送到另一个显示的视图控制器。我们将使用RxSwift的<code class="fe lv lw lx ly b">Observable</code>代替标准的委托方式。</p><p id="d205" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">项目的<a class="ae ky" href="https://github.com/zafarivaev/RxSwift-Delegation" rel="noopener ugc nofollow" target="_blank">源代码可以在Github上获得。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lz"><img src="../Images/a4f39f6d3badb34668a8719095681e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4D8MtxrNOSnczKptduUsA.jpeg"/></div></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="a4a0" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">我们开始吧</h1><p id="108c" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">首先，让我们看看呈现视图控制器。它有一个<code class="fe lv lw lx ly b">tableView</code>，在每个相应的<code class="fe lv lw lx ly b">UITableViewCell</code>中显示一个标题:</p><h2 id="30ae" class="ne mi it bd mj nf ng dn mn nh ni dp mr li nj nk mt lm nl nm mv lq nn no mx np bi translated">ListViewController.swift</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b884" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们设置<code class="fe lv lw lx ly b">tableView</code>的方式非常简单明了。如果不是，请随意访问我的另一篇文章，在那里我解释了如何以编程方式创建它。</p><p id="bcf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仔细看看这一部分:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="0891" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码的作用如下:</p><ul class=""><li id="03f0" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">我们使用<code class="fe lv lw lx ly b">.debounce</code>方法来防止意外双击。</li><li id="8bd7" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">使用<code class="fe lv lw lx ly b">.flatMapLatest</code>，我们呈现<code class="fe lv lw lx ly b">AddItemViewController</code>并等待，直到它向<code class="fe lv lw lx ly b">newTitle</code>属性发出一个<code class="fe lv lw lx ly b">onNext</code>事件，这是一个<code class="fe lv lw lx ly b">String</code>类型的<code class="fe lv lw lx ly b">PublishSubject</code>。</li><li id="3cda" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">使用<code class="fe lv lw lx ly b">.do</code>，一旦发出<code class="fe lv lw lx ly b">onNext</code>事件，我们就解除<code class="fe lv lw lx ly b">AddItemViewController</code>。</li><li id="a8d6" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">最后，我们使用<code class="fe lv lw lx ly b">.subscribe</code>订阅结果(新标题)，其中我们将全新的<code class="fe lv lw lx ly b">title</code>附加到<code class="fe lv lw lx ly b">ListViewController</code>的<code class="fe lv lw lx ly b">titles</code>属性，并重新加载<code class="fe lv lw lx ly b">tableView</code>。</li></ul><p id="bef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何在<code class="fe lv lw lx ly b">AddItemViewController</code>中向<code class="fe lv lw lx ly b">newTitle</code>发出一个<code class="fe lv lw lx ly b">onNext</code>事件:</p><h2 id="c141" class="ne mi it bd mj nf ng dn mn nh ni dp mr li nj nk mt lm nl nm mv lq nn no mx np bi translated">AddItemViewController.swift</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7e35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要做的就是创建类型为<code class="fe lv lw lx ly b">PublishSubject&lt;String&gt;</code>的<code class="fe lv lw lx ly b">newTitle</code>属性，订阅<code class="fe lv lw lx ly b">doneButton</code>点击事件，并将<code class="fe lv lw lx ly b">textField</code>的内容发布到<code class="fe lv lw lx ly b">newTitle</code>主题。注意，当<code class="fe lv lw lx ly b">textField</code>为空时，我们使用<code class="fe lv lw lx ly b">.filter</code>忽略点击事件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b248" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经成功地用RxSwift observables替换了delegation。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="9d5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<a class="ae ky" href="https://github.com/RxSwiftCommunity/RxDataSources" rel="noopener ugc nofollow" target="_blank"> RxDataSources </a>大大缩短<code class="fe lv lw lx ly b">ListViewController</code>中与<code class="fe lv lw lx ly b">tableView</code>相关的代码，您可以在本文中了解到这一点:</p><div class="og oh gp gr oi oj"><a href="https://medium.com/better-programming/how-to-implement-uitableview-and-uicollectionview-with-rxdatasources-1afcd68729bf" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">用RxDataSources实现UITableView和UICollectionView</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">以及为什么您再也不会直接使用UITableViewDataSource</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ks oj"/></div></div></a></div><p id="8140" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要开始使用RxSwift，并了解您可能想要学习它的原因，请查看以下资源:</p><div class="og oh gp gr oi oj"><a href="https://academy.realm.io/posts/tryswift-Marin-Todorov-I-create-iOS-apps-is-RxSwift-for-me/" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">我创建iOS应用程序RxSwift适合我吗？</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">很难从地图和过滤器跳到显示视图控制器或搜索栏，因为它们需要调用一个…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">学院.领域. io</p></div></div><div class="os l"><div class="oy l ou ov ow os ox ks oj"/></div></div></a></div><p id="e747" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读！</p></div></div>    
</body>
</html>