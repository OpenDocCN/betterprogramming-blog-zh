<html>
<head>
<title>Introduction to Jetpack Compose: The Future UI Toolkit for Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jetpack Compose简介:Android的未来UI工具包</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/jetpack-compose-androids-modern-toolkit-for-building-ui-82e67d384c26?source=collection_archive---------8-----------------------#2021-03-10">https://betterprogramming.pub/jetpack-compose-androids-modern-toolkit-for-building-ui-82e67d384c26?source=collection_archive---------8-----------------------#2021-03-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="33fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">告别XML布局，采用现代技术</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/76d043d7bb9e499a580fc411cdcff04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w4qskc2NbRu5mfbq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@bensow?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Benjamin Sow </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="bd76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Android中构建UI的传统和常见方式是使用基于XML的布局。然而，一旦稳定版本的Jetpack Compose 发布，这将是一种老式的方式。</p><p id="1205" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将提供Jetpack Compose的基本概述，以及我们如何使用它来代替XML布局来构建声明性UI。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="06e3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是Jetpack Compose？</h1><blockquote class="mu mv mw"><p id="cec5" class="kz la mx lb b lc ld ju le lf lg jx lh my lj lk ll mz ln lo lp na lr ls lt lu im bi translated">“Jetpack Compose是Android的现代声明式UI工具包，用于构建原生UI。它简化并加速了Android上的UI开发。借助更少的代码、强大的工具和直观的Kotlin APIs，快速实现您的应用。”— <a class="ae ky" href="https://developer.android.com/jetpack/compose" rel="noopener ugc nofollow" target="_blank">安卓开发者</a></p></blockquote><p id="90cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单来说，Jetpack Compose是一个简单的框架或组件或工具的集合，可以帮助我们在Android中用更少的时间构建优秀的应用程序。Jetpack Compose使用更少的样板代码和UI状态与数据变化的同步使UI开发变得更容易。我们可以说Jetpack Compose是一个UI构建框架，它取代了基于XML的UI开发方法。它使得开发UI更快更容易。</p><p id="be17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谷歌在谷歌I/O 2019上推出了Jetpack Compose，目前它有测试版，这意味着功能集开发已经完成，但他们仍在打磨和稳定东西。要体验使用Jetpack Compose进行开发，请下载Android Studio预览版的<a class="ae ky" href="https://developer.android.com/studio/preview" rel="noopener ugc nofollow" target="_blank">最新金丝雀版本。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e476" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">梯度构型</h1><p id="30b3" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">如果我们正在创建一个新项目，那么我们可以直接从可用的选项中选择“Empty Compose Activity”。这减少了Gradle设置用于合成的开销。否则，我们需要配置Gradle文件来支持Jetpack Compose。让我们看看如何配置Gradle文件。</p><h2 id="41e9" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">第一步</h2><p id="722d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们需要为项目配置Kotlin。确保您在项目中使用的是Kotlin 1.4.30或更高版本。</p><p id="4ad2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在项目级<code class="fe ns nt nu nv b">build.gradle</code>文件中，添加一个最低版本为1.4.30的Kotlin类路径:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="7eee" class="ng md it nv b gy oa ob l oc od">classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:1.4.30"</span></pre><p id="2c20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在应用级<code class="fe ns nt nu nv b">build.gradle</code>文件中，添加kotlin-android插件:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="3f7e" class="ng md it nv b gy oa ob l oc od">plugins <strong class="nv iu">{<br/>    </strong>id 'com.android.application'<br/>    id 'kotlin-android'<br/><strong class="nv iu">}</strong></span></pre><h2 id="3253" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">第二步</h2><p id="8a7c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在app级<code class="fe ns nt nu nv b">build.gradle</code>文件中，将<code class="fe ns nt nu nv b">minSdkVersion</code>设置为<code class="fe ns nt nu nv b">21</code>或更高:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="3dae" class="ng md it nv b gy oa ob l oc od">defaultConfig {<br/>        ...<br/><strong class="nv iu">        minSdkVersion 21<br/></strong>    }</span></pre><p id="acf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在app-level <code class="fe ns nt nu nv b">build.gradle</code>文件中启用Jetpack Compose选项:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="0e81" class="ng md it nv b gy oa ob l oc od">buildFeatures {<br/>        // Enables Jetpack Compose for this module<br/><strong class="nv iu">        compose true<br/></strong>    }</span></pre><p id="9690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在<code class="fe ns nt nu nv b">composeOptions</code>中设置Kotlin编译器的版本:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="04cf" class="ng md it nv b gy oa ob l oc od">composeOptions<strong class="nv iu">{<br/>    </strong>kotlinCompilerExtensionVersion '1.0.0-beta01'<br/>    kotlinCompilerVersion '1.4.30'<br/><strong class="nv iu">}</strong></span></pre><p id="c3f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本配置的app级<code class="fe ns nt nu nv b">build.gradle</code>文件如下图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="00e2" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">第三步</h2><p id="02ff" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们在应用程序级<code class="fe ns nt nu nv b">build.gradle</code>文件中添加所需的Jetpack合成依赖项:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="23b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些依赖项中的每一个都有独特的用途。请根据您的使用情况添加所需的依赖项。</p><p id="7862" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然我们已经完成了Gradle的设置，让我们转到代码部分。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fe3b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Jetpack撰写基础</h1><p id="6e4b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们通过构建具有声明性功能的基本UI组件来尝试一下Jetpack Compose。Jetpack Compose的主要概念是不再使用基于XML的UI创建，而是使用Compose函数。</p><h2 id="9c29" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">可组合函数</h2><p id="835f" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">可组合函数定义了应用程序的用户界面。可组合函数是将应用程序数据转换为UI层次结构的普通函数。用<code class="fe ns nt nu nv b">@Composable</code>标注的函数被视为可组合函数。一个可组合函数只能从另一个可组合函数中调用。</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="efde" class="ng md it nv b gy oa ob l oc od"><strong class="nv iu">@Composable<br/></strong>fun displayMessage() {<br/>    Text (text = "Hello World of Compose!")<br/>}</span></pre><h2 id="86b9" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">例子</h2><p id="3fd3" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们用Compose创建一个示例活动来显示一条消息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="75d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu nv b">setContent</code>将给定的可组合件组合成给定的活动。内容将成为给定活动的根视图。这或多或少相当于用<code class="fe ns nt nu nv b">ComposeView</code>调用<code class="fe ns nt nu nv b">setContentView</code>。</p><p id="72f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您运行并在屏幕上看到只有一行代码的文本输出时，奇迹就发生了。</p><p id="971b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看如何将它分解成一个独立的可组合函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="1cf5" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">使用Jetpack Compose预览</h2><p id="b4d4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在不运行应用程序的情况下，我们可以通过使用注释<code class="fe ns nt nu nv b">@Preview</code>来预览Jetpack Compose或composable函数的变化。<code class="fe ns nt nu nv b">preview</code>可组合函数不能带任何参数。由于存在限制，我们不能用<code class="fe ns nt nu nv b">preview</code>注释来注释上面的<code class="fe ns nt nu nv b">displayMessage</code>方法，因为它是参数化的。所以在这种情况下，我们可以创建一个带有<code class="fe ns nt nu nv b">preview</code>注释的中间函数，并从中调用<code class="fe ns nt nu nv b">displayMessage</code>方法。</p><p id="b1c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们重新构建项目时，我们可以在右上角看到三个选项卡(类似于我们开发布局时的视图)。<code class="fe ns nt nu nv b">preview</code>注释只是为了预览变化。或者，我们可以设置参数，在不运行应用程序的情况下查看更改。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/99f88f0066066fef592c7fa02b3c3db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3ps-etYB3hytvH8Lf6ghw.png"/></div></div></figure><h2 id="9d0a" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">用Jetpack定义保存视图的容器</h2><p id="5780" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们已经看到了如何放大单一视图。现在让我们定义一个包含一组视图的可组合函数。在Compose中，我们可以通过从其他可组合函数调用可组合函数来构建UI层次结构。</p><p id="9bb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个新的活动并检查:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="e122" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/527b4c5190df211b9cfe53d943682b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ft0dmtifiRNKZvl2VXGlTg.jpeg"/></div></div></figure><p id="0ed5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这三个文本相互重叠，因为我们没有在内容视图中指定任何与它们的排列相关的内容。我们可以使用不同的概念来排列这些项目:</p><ul class=""><li id="2910" class="oi oj it lb b lc ld lf lg li ok lm ol lq om lu on oo op oq bi translated"><code class="fe ns nt nu nv b">Row</code> —以水平方式对齐元素。</li><li id="5dd2" class="oi oj it lb b lc or lf os li ot lm ou lq ov lu on oo op oq bi translated"><code class="fe ns nt nu nv b">Column</code> —以垂直方式对齐元素。</li></ul><h2 id="24ff" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">圆柱</h2><p id="d9a5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在Jetpack Compose中，<code class="fe ns nt nu nv b">Column</code>是一个让我们垂直排列元素的函数。现在让我们给<code class="fe ns nt nu nv b">newStory</code>方法添加一个<code class="fe ns nt nu nv b">Column</code>并检查输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/29260f324e343bfde027e9dc0b4b27ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONEfUNmKZ90tVDq7Fr7h8A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">排列在左上方，因为我们没有指定任何其他属性。</p></figure><p id="4432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们为该列添加样式设置。添加<code class="fe ns nt nu nv b">Modifier.padding</code>，从内容视图中插入列。</p><p id="6173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ns nt nu nv b">Newstory</code>方法的<strong class="lb iu"> </strong>中添加<code class="fe ns nt nu nv b">Modifier.padding</code> <strong class="lb iu"> </strong>，从内容视图中排列填充:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/4136bad389df5a8fe858179d32d295b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-OYKDlaMfKKXzhuzeD4-g.jpeg"/></div></div></figure><h2 id="8a3d" class="ng md it bd me nh ni dn mi nj nk dp mm li nl nm mo lm nn no mq lq np nq ms nr bi translated">在列中添加图像</h2><p id="f2c2" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">只需添加对<code class="fe ns nt nu nv b">Image()</code>的调用，将图形放入<code class="fe ns nt nu nv b">Column</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="4ed0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将在文本上添加一个图像。我们还可以通过向调用<code class="fe ns nt nu nv b">Image()</code>传递一个大小<code class="fe ns nt nu nv b">Modifier</code>来设置图形的样式。</p><blockquote class="mu mv mw"><p id="c928" class="kz la mx lb b lc ld ju le lf lg jx lh my lj lk ll mz ln lo lp na lr ls lt lu im bi translated">注意:仅支持<code class="fe ns nt nu nv b">VectorDrawables</code>和栅格化资产类型(如PNG、JPG)。如果您使用任何其他类型，应用程序将由于<code class="fe ns nt nu nv b">IllegalArgumentException</code>而崩溃。</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9310" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><p id="45a3" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Jetpack Compose取代了传统的UI开发方法，可以减少工作量和样板代码，并保持UI与数据变化的同步，等等。这是一种新的构建UI的声明方式。</p><p id="0d53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章只是一个介绍。我们将在接下来的文章中看到更多与Jetpack Compose相关的概念。</p><p id="3c13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="e2b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mx">注意:Jetpack目前处于测试版，这意味着事情几乎是稳定的。我们可以开始构建东西，但实际上并不计划发布它们，因为我们需要等待一个稳定的版本，计划在今年的某个时候发布。</em></p></div></div>    
</body>
</html>