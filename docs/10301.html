<html>
<head>
<title>How to Add an Emoji Search Bar With SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用SwiftUI添加表情符号搜索栏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-add-a-search-bar-with-swiftui-d76a0b46a07e?source=collection_archive---------3-----------------------#2021-12-23">https://betterprogramming.pub/how-to-add-a-search-bar-with-swiftui-d76a0b46a07e?source=collection_archive---------3-----------------------#2021-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="973d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">SwiftUI简化了搜索栏、列表和导航的实现</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ba38f074688d76efe053c27a01ecaeb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lnLhtUECoKq_im9HUE_wYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a693" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我们将使用SwiftUI构建一个简单的应用程序，允许您查看和搜索表情列表。</p><p id="3c53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在创建一个使用SwiftUI作为接口的新Xcode项目后，我们将开始添加一个模型结构来表示列表中的每个表情符号。</p><p id="ac46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">继续创建一个名为<code class="fe lu lv lw lx b">EmojiProvider</code>的新文件。</p><p id="6031" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个文件中，我们将添加一个名为<code class="fe lu lv lw lx b">EmojiDetails</code>的<code class="fe lu lv lw lx b">struct</code>，它有4个属性(id、表情符号、名称、描述)，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="87e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在定义了我们的模型结构之后，我们将添加另一个名为<code class="fe lu lv lw lx b">EmojiProvider</code>的<code class="fe lu lv lw lx b">struct</code>，它将包含一个返回包含多个<code class="fe lu lv lw lx b">EmojiDetails</code>的列表的方法。</p><p id="bcc0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就在<code class="fe lu lv lw lx b">EmojiDetails</code> <code class="fe lu lv lw lx b">struct</code>上面，可以添加下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="c7cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用这个<code class="fe lu lv lw lx b">EmojiDetails</code>数组来填充<code class="fe lu lv lw lx b">View</code>的<code class="fe lu lv lw lx b">List</code>。</p><p id="8848" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们转到<code class="fe lu lv lw lx b">ContentView.swift</code>文件。</p><p id="be2c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe lu lv lw lx b">ContentView</code>中，我们首先要添加一个名为<code class="fe lu lv lw lx b">searchResults</code>的计算变量。</p><p id="7e19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，这将返回我们刚刚定义的完整数组，但是稍后，我们将根据用户在搜索栏上键入的文本过滤列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="7a4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以修改我们的<code class="fe lu lv lw lx b">View</code>的<code class="fe lu lv lw lx b">body</code>来显示一个嵌入在<code class="fe lu lv lw lx b">NavigationView</code>中的<code class="fe lu lv lw lx b">List</code>，它显示<code class="fe lu lv lw lx b">searchResults</code>中的每个<code class="fe lu lv lw lx b">EmojiDetails</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="dd4e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你运行你的应用程序，你现在应该可以看到表情列表，就像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/d6489d77eac3393f6d5096c888e0eca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*6A6vIzIfhGTur8L1HT9Nxg.gif"/></div></figure><p id="54d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们将更新我们的代码，以便点击列表中的任何一行都会显示更多关于表情符号的详细信息。</p><p id="7619" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe lu lv lw lx b">ContentView.swift</code>文件中，我们将定义一个名为<code class="fe lu lv lw lx b">EmojiDetailsView</code>的新视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="e472" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在在<code class="fe lu lv lw lx b">ContentView</code> <code class="fe lu lv lw lx b">struct</code>中，我们将使用一个<code class="fe lu lv lw lx b">NavigationLink</code>，这样每当点击列表中的一行时，就会显示一个<code class="fe lu lv lw lx b">EmojiDetailsView</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="b23f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再次运行我们的应用程序。点击列表中的任意一行，应导航至详细视图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/222b0a288cebfb1119eeb3229eecb123.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/1*j1Ir9yF0_-TUmsj4x_0YHA.gif"/></div></figure><p id="11ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们最终将把搜索栏添加到我们的视图中。我们将首先添加一个名为<code class="fe lu lv lw lx b">searchText</code>的新状态变量。这个变量将保存用户在搜索栏中键入的文本，最初将是一个空字符串。</p><p id="4ece" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了显示搜索栏，我们将使用<code class="fe lu lv lw lx b"><a class="ae mc" href="https://developer.apple.com/documentation/swiftui/view/searchable(text:placement:prompt:)-18a8f" rel="noopener ugc nofollow" target="_blank">searchable</a></code>修饰符。在<code class="fe lu lv lw lx b">navigationTitle</code>下面，我们将增加<code class="fe lu lv lw lx b">searchable</code>，并将提供一个<code class="fe lu lv lw lx b">text</code>、<code class="fe lu lv lw lx b">placement</code>和<code class="fe lu lv lw lx b">prompt</code>。</p><p id="8664" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于文本，我们可以将绑定传递给我们的<code class="fe lu lv lw lx b">searchText</code>变量。</p><p id="6e16" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于<code class="fe lu lv lw lx b">placement</code>，我们将使用<code class="fe lu lv lw lx b">navigationBarDrawer</code>和显示模式<code class="fe lu lv lw lx b">always</code>。这样，搜索栏将始终可见。</p><p id="647e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，对于提示，我们可以提供一个字符串。当用户没有在搜索栏中键入任何内容时，就会显示这个字符串，我将使用<code class="fe lu lv lw lx b">“Search for emoji”</code>。</p><p id="0404" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最终，我们的<code class="fe lu lv lw lx b">ContentView</code>看起来会是这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="2972" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">既然我们将<code class="fe lu lv lw lx b">searchText</code>绑定到在搜索栏中输入的文本，我们可以更新<code class="fe lu lv lw lx b">searchResults</code>变量的值。</p><p id="09de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将只返回其名称或表情与用户的搜索查询相匹配的表情细节。</p><p id="9365" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以让我们更新一下:如果搜索文本为空，那么我们可以显示所有的表情细节项。</p><p id="1861" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">否则，我们将过滤列表，只返回那些姓名或表情符号包含<code class="fe lu lv lw lx b">searchText</code>中文本的人。</p><p id="3746" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于名称，我们应该进行不区分大小写的比较。我们的<code class="fe lu lv lw lx b">searchResults</code>变量现在看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="7f33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再次运行我们的应用程序。我们现在应该能够使用视图顶部的搜索栏来搜索特定的表情符号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/80d5cb6dab1aa739f4f6762328d00076.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*ojhHABwHKau4LAIznZxLRA.gif"/></div></figure><p id="9c59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们要做的最后一件事是在用户输入时提供一个建议列表。</p><p id="61f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过向<code class="fe lu lv lw lx b">searchable</code>提供一个闭包来实现这一点，这个闭包将返回一个包含建议的视图。我们将添加一个名为<code class="fe lu lv lw lx b">suggestedResults</code>的新变量。</p><p id="a803" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果搜索文本为空，我们不会显示任何建议，否则我们希望为每个搜索结果显示一个建议。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="1fa5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以添加闭包，对于每个建议的结果，我们将显示一个表示<code class="fe lu lv lw lx b">“Looking for \(emojiDetails.emoji)?”</code>的<code class="fe lu lv lw lx b">Text</code>。最后，我们将添加<code class="fe lu lv lw lx b">searchCompletion(emojiDetails.name)</code>,这样当用户点击搜索建议时，搜索栏将自动显示表情符号的名称。<code class="fe lu lv lw lx b">ContentView</code> <code class="fe lu lv lw lx b">body</code>的代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="974b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们最后一次运行我们的应用程序。当您在搜索栏上键入时，您现在应该会看到不同的建议。如果你按下一个建议，搜索栏将会显示表情符号的名称，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/39a532318022bce5d524b5e8ecf2cde5.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*3z1aUeIsT_BTFAGEgnjaCw.gif"/></div></figure><p id="1301" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！我希望你今天学到了新东西。你可以在<a class="ae mc" href="https://github.com/apatronl/YouTube/tree/main/Emoji%20Search" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完成的app。本教程也可以在YouTube上找到:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md lz l"/></div></figure></div></div>    
</body>
</html>