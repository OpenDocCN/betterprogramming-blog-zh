<html>
<head>
<title>Create and Chain Observable Sequences in RxSwift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在RxSwift中创建和链接可观察序列</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-and-chain-observable-sequences-in-rxswift-fae9c5bbbc49?source=collection_archive---------8-----------------------#2020-02-12">https://betterprogramming.pub/create-and-chain-observable-sequences-in-rxswift-fae9c5bbbc49?source=collection_archive---------8-----------------------#2020-02-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">缩短你的代码，让它更有效率</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4526eb8fe4352a56b3b82d6a23ecae30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CCJFsHMbNhTWH2Ct"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">鲍里斯·米塞维奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="277a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个简短的教程中，我们将学习如何创建两个<a class="ae ky" href="https://github.com/ReactiveX/RxSwift" rel="noopener ugc nofollow" target="_blank"> RxSwift的</a> <code class="fe lv lw lx ly b">Observable</code>序列并链接它们。</p><p id="849f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">示例应用程序在屏幕顶部显示一个<code class="fe lv lw lx ly b">UITextField</code>。它等待用户输入，当用户输入了包含“rx”的五个字母时，<code class="fe lv lw lx ly b">UITextField</code>闪烁绿色并刷新:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ba7acd4f049dde623e6bb426078f02dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/1*KPrSKVnVC6U2nJURjzeGRg.gif"/></div></figure><p id="b78b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">项目的<a class="ae ky" href="https://github.com/zafarivaev/RxSwift-Chaining" rel="noopener ugc nofollow" target="_blank">源代码可以在GitHub上获得。</a></p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="e60e" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">我们开始吧</h1><p id="fb5e" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">首先，让我们快速创建并在屏幕上定位我们的<code class="fe lv lw lx ly b">textField</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="8d8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，在文件顶部添加以下导入:</p><pre class="kj kk kl km gt ng ly nh ni aw nj bi"><span id="01f0" class="nk mi it ly b gy nl nm l nn no">import RxSwift</span><span id="c8ef" class="nk mi it ly b gy np nm l nn no">import RxCocoa </span></pre><p id="23c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须添加<code class="fe lv lw lx ly b">disposeBag</code>属性，以便将来取消分配订阅:</p><pre class="kj kk kl km gt ng ly nh ni aw nj bi"><span id="7477" class="nk mi it ly b gy nl nm l nn no">private let disposeBag = DisposeBag()</span></pre><p id="b9ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在准备创建我们的序列。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="9fa0" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">创建可观察的序列</h1><p id="e8b8" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">让我们从第一个任务开始:在输入的字符串中查找“rx ”:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="75af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在用户输入一个字母后，我们将调用这个搜索方法。如果成功，它将发出一个<code class="fe lv lw lx ly b">true</code>值。否则，将发出<code class="fe lv lw lx ly b">false</code>值。</p><p id="e923" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建第二个任务的方法，动画和清除<code class="fe lv lw lx ly b">textField</code>，我们编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="e7ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，这个方法执行了一个0.2秒的简短动画，改变了<code class="fe lv lw lx ly b">textField</code>的<code class="fe lv lw lx ly b">backgroundColor</code>属性。完成后，我们执行另一个动画，将<code class="fe lv lw lx ly b">backgroundColor</code>返回到它以前的状态，并将<code class="fe lv lw lx ly b">true</code>事件发送到<code class="fe lv lw lx ly b">observer</code>。</p><p id="3397" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候把这些全新的可观察物连接起来了。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="1c20" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">链式可观测量</h1><p id="28cd" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们需要创建一个方法来保存<code class="fe lv lw lx ly b">textField</code>的绑定:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="ca86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是这种方法中发生的事情的分类:</p><ul class=""><li id="3330" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">使用<code class="fe lv lw lx ly b">.orEmpty</code>方法，我们将可选的<code class="fe lv lw lx ly b">String?</code>类型转换为<code class="fe lv lw lx ly b">String</code>。</li><li id="5903" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">我们过滤掉所有<code class="fe lv lw lx ly b">textField</code>的文本计数不等于5的事件。当它等于5时，我们执行<code class="fe lv lw lx ly b">.flatMap</code>方法。</li><li id="7df9" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe lv lw lx ly b">.flatMap</code>方法将序列的类型从<code class="fe lv lw lx ly b">Observable&lt;String&gt;</code>更改为<code class="fe lv lw lx ly b">Observable&lt;Bool&gt;</code>，因为这是<code class="fe lv lw lx ly b">findSubstring(in: )</code>方法返回的类型。</li><li id="1c3d" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">我们只允许<code class="fe lv lw lx ly b">true</code>事件通过next，这意味着找到了“rx”子串。</li><li id="9d2f" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">在下一个<code class="fe lv lw lx ly b">.flatMap</code>方法中，我们制作了<code class="fe lv lw lx ly b">textField</code>的动画并返回一个新的<code class="fe lv lw lx ly b">Observable&lt;Bool&gt;</code>类型的序列，它在动画完成时发出一个<code class="fe lv lw lx ly b">true</code>事件。</li><li id="9c2e" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">当动画完成后，我们通过<code class="fe lv lw lx ly b">.filter</code>方法要求。</li><li id="be8d" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">在<code class="fe lv lw lx ly b">.subscribe</code>中，我们简单地打印“Subscribed”来调试实现。</li><li id="1625" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">最后，我们将订阅添加到<code class="fe lv lw lx ly b">disposeBag</code>中，它将解除对它的分配。</li></ul><p id="5d1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忘记将<code class="fe lv lw lx ly b">bindTextField()</code>方法添加到<code class="fe lv lw lx ly b">viewDidLoad</code>中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="36d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经成功地创造并链接了可观测的序列。</p><p id="bbbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们最终的<code class="fe lv lw lx ly b">ViewController.swift</code>文件现在看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="c587" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">包扎</h1><p id="4c24" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们已经看到使用<code class="fe lv lw lx ly b">.flatMap</code>函数链接不同的可观察序列是多么容易。如果您想了解更多关于RxSwift的功能，请随时查看我的其他相关文章:</p><div class="oe of gp gr og oh"><a href="https://medium.com/better-programming/replace-delegation-with-rxswift-32ad18d75140" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">用RxSwift替换委托</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">不再有协议一致性，只有简单的可观察性</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://medium.com/better-programming/reactive-mvvm-and-the-coordinator-pattern-done-right-88248baf8ca5" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">反应式MVVM和协调模式做对了</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">使用Swift 5、RxSwift和RxDataSources</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ks oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://medium.com/better-programming/how-to-implement-uitableview-and-uicollectionview-with-rxdatasources-1afcd68729bf" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">如何用RxDataSources实现UITableView和UICollectionView</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">以及为什么您再也不会直接使用UITableViewDataSource</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov ks oh"/></div></div></a></div><p id="2fbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读！</p></div></div>    
</body>
</html>