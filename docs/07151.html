<html>
<head>
<title>Building APIs: A Comparison Between Cursor and Offset Pagination</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建API:游标分页和偏移分页的比较</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-apis-a-comparison-between-cursor-and-offset-pagination-88261e3885f8?source=collection_archive---------3-----------------------#2020-12-11">https://betterprogramming.pub/building-apis-a-comparison-between-cursor-and-offset-pagination-88261e3885f8?source=collection_archive---------3-----------------------#2020-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="122d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">哪个对你的API最有意义？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/29c0947fff74d0181276bd251eb6194c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oFVFiaClyT2JH_FV.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://sitechecker.pro/" rel="noopener ugc nofollow" target="_blank">现场检查员</a>。</p></figure><h1 id="48be" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分页概述</h1><p id="dad3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当您有一个庞大的数据库需要发送给用户，并且您决定分块发送而不是一次性发送整个数据库时，分页就开始发挥作用了。几乎所有每天访问的站点都使用分页的概念。</p><p id="941b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在深入研究分页之前，您必须了解两种不同类型的分页。</p><h2 id="3cf7" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">基于光标的分页</h2><p id="9507" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">光标被认为是这种分页类型中的一个关键参数。客户端收到一个名为<code class="fe ne nf ng nh b">Cursor</code>的变量和响应。它是一个指针，指向需要随请求一起发送的特定项目。然后，服务器使用光标搜索另一组项目。基于光标的分页更复杂，在处理实时数据集时更受欢迎。</p><h2 id="1c1a" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">基于偏移量的分页</h2><p id="2542" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">基于偏移量的分页是一种非常著名的技术，其中客户端请求具有特定限制(结果的数量)和偏移量(需要跳过的记录的数量)的参数。基于偏移量的分页易于使用，是静态数据的首选。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="a9b7" class="kz la it bd lb lc np le lf lg nq li lj jz nr ka ll kc ns kd ln kf nt kg lp lq bi translated">利弊</h1><p id="1700" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">基于光标的分页被认为是最有效的分页方法之一，必须尽可能地集成。</p><p id="c150" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与偏移分页相比，基于光标的分页的优点是:</p><ul class=""><li id="639c" class="nu nv it lt b lu mn lx mo ma nw me nx mi ny mm nz oa ob oc bi translated">不会跳过任何数据。游标分页不是发送一个行为类似于索引的偏移量参数，而是发送一个行为类似于指向数据库中特定记录的指针的游标参数，以显示最后一页离开的位置。</li><li id="213f" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">出色的实时数据能力。游标分页最显著的优点之一是它能够非常高效地管理实时数据。这背后的主要原因是游标不需要静态数据。因此，可以轻松地删除或添加新的行或项目，而不会影响每个页面的加载过程。随着时间的推移，实时应用程序越来越多，基于光标的分页越来越流行。但是，偏移分页需要静态数据。如果不是这种情况，那么要么该项被返回两次，要么被完全跳过。</li><li id="ecd0" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">大型数据集的有效管理。为了更好地理解这一点，首先必须了解偏移。偏移量是数据库在选择记录之前必须跳过的记录数。这意味着它不仅返回所请求的下一个数据集，还会扫描出现在它之前的所有其他数据。当偏移量增加时，这是一个重大问题。因此，假设页面中有一些小故障，页面需要大量的时间来加载和离开页面。</li></ul><p id="208c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">凡事都有利弊。基于光标的分页有其自身的缺点。与基于偏移量的分页相比，基于光标的分页的缺点是:</p><ul class=""><li id="5255" class="nu nv it lt b lu mn lx mo ma nw me nx mi ny mm nz oa ob oc bi translated">有限的排序功能。假设我们有一个基于名字和姓氏对用户表进行排序的任务。这可能成为游标的一个问题，因为游标需要实现唯一的顺序列来排序。大多数游标实现都基于时间戳列。因此，如果需要排序，那么游标不是最佳选择。人们可以尝试不同的技术来达到同样的效果，但这会减慢这一过程，甚至比胶印还慢。</li><li id="febb" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">游标的实现被认为有点棘手。游标实现起来可能并不困难，但是偏移量通常很容易实现。因此，如果希望快速实现分页，那么选择offset是正确的。如果数据是静态的，这尤其有益。因此，必要时可以避免并发症。</li><li id="a2ac" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">无限卷轴让人上瘾。当然，这主要不是一个游标问题，因为后端使用的偏移分页甚至可以实现无限滚动。然而，cursor在实时应用程序中的广泛使用使其使用更加方便。无限滚动被认为是方便用户一次查看大量数据的用户界面。然而，这剥夺了用户浏览下一页的意识和决定能力，导致了非常上瘾的体验。</li></ul></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="8f34" class="kz la it bd lb lc np le lf lg nq li lj jz nr ka ll kc ns kd ln kf nt kg lp lq bi translated">偏移实现</h1><p id="b152" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在为偏移量分页检索数据时，查询中通常需要两个参数:limit和offset。当数据库项目增加时，速度会变慢。发生这种情况是因为仍然需要读取数据库直到偏移的行数，以确定需要从哪里开始选择数据。</p><p id="d1e7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它通常具有最坏情况的复杂度<em class="oi"> o(n) </em>。此外，这些大型数据库通常不是静态的，这将需要频繁的写入。在不同的页面上，生成的窗口通常会不准确。如果需要从数据库中获取最新帖子的第一页，必须使用以下查询:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/e88f78c81b891bf064221ceccb9ca590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ttd_YseIDqMp1yLz.png"/></div></div></figure><p id="4885" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了知道第二页的结果，我们可以包括的偏移量是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/55b6c2efb974813c303a5be74dd3dc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R_FZX8nwL2kgEEo4.png"/></div></div></figure><p id="7ec0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，当数据集增加时，这个过程变得很长。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="cbca" class="kz la it bd lb lc np le lf lg nq li lj jz nr ka ll kc ns kd ln kf nt kg lp lq bi translated">光标实现</h1><p id="a61a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如上所述，游标分页是指向特定记录的唯一指针。在游标的帮助下，人们不再需要在<code class="fe ne nf ng nh b">WHERE</code>子句的帮助下读取已经看到的所有行。因此，这使得它的复杂性<em class="oi"> o(1) </em>。</p><p id="1b6d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不准确结果的问题是在读取特定行之后处理的，而不是依赖于记录是相同的这一事实。已知自由列表表示在给定权限中插入数据结构。从给定空闲列表中删除的单元恰好是最近由于“空闲”而被放在那里的单元因此，被放入空闲列表的最后一个单元被认为是被取下的第一个单元。给定的数据结构具有给定的属性(称为堆栈)。</p><p id="ce7d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">借助以下使用游标分页的查询，可以实现相同的示例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/ddae32e960164a70ea6739095b8a860b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L9JJdcLgM5RidShE.png"/></div></div></figure><p id="9b5a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要使用游标，除了用于结果集中最后一项的游标之外，还需要从第一页返回结果。这是游标在结果集中向前移动的合理用法。但是，如果提取方向改变，检索记录的复杂性就会增加。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="37ed" class="kz la it bd lb lc np le lf lg nq li lj jz nr ka ll kc ns kd ln kf nt kg lp lq bi translated">结论</h1><p id="454f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">实时应用程序中使用最广泛的分页是游标分页。这主要是因为向数据库中添加新记录的频率增加了。总是推荐使用光标方法，因为它消除了重复的项目，并且不会跳过任何项目。指针跟踪数据的位置以及下一步需要获取的项目。在不同的情况下，游标和偏移量各有优势。使用主要取决于被处理的数据。</p><p id="5154" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是，当查询静态数据时，性能成本可能不值得使用游标，因为在这种情况下复杂性会增加。很明显，与偏移分页相比，基于光标的分页是更好的选择。然而，选择正确方法的决定完全取决于用例以及分页对产品的影响。</p></div></div>    
</body>
</html>