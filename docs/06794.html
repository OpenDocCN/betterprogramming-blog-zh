<html>
<head>
<title>Authenticate Users and Save Data in a Database Using Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Firebase验证用户身份并在数据库中保存数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/authenticate-users-and-save-data-in-a-database-using-firebase-5a7e8828a5f8?source=collection_archive---------2-----------------------#2020-11-05">https://betterprogramming.pub/authenticate-users-and-save-data-in-a-database-using-firebase-5a7e8828a5f8?source=collection_archive---------2-----------------------#2020-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="70b1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Android版Firebase入门</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b40dea0fb3b45ac35040f7339ab36f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MWQuPnHRqfnV0GqM"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@tdpatch?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Tim Patch </a>拍摄</p></figure><p id="b003" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您着手构建一个应用程序时，有大量的事项需要考虑。这些都主要与客户端有关。当您开始考虑应用程序的服务器时，事情会变得非常复杂。减轻压力的一个选择是使用<a class="ae kv" href="https://firebase.google.com/docs" rel="noopener ugc nofollow" target="_blank"> Firebase </a>，特别是Firebase的两个特性:</p><ol class=""><li id="e7d8" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">使用Firebase Auth验证用户</li><li id="d4fe" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">使用实时数据库存储数据</li></ol><p id="ad82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在本文中展示:</p><ul class=""><li id="1547" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mg ly lz ma bi translated">如何在<a class="ae kv" href="https://kotlinlang.org/docs/reference/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>中构建一个使用Firebase Auth认证用户的Android应用程序</li><li id="a726" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">使用<a class="ae kv" href="https://square.github.io/retrofit/" rel="noopener ugc nofollow" target="_blank"> Retrofit2 </a>向我们的服务器发出请求</li><li id="1dfb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">如何使用Express在<a class="ae kv" href="https://nodejs.org/en/docs/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>中构建一个服务器，该服务器将接收来自我们的应用程序的请求，并从Firebase中的实时数据库获取数据</li></ul><p id="90c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果所有这些看起来像是一个简单的任务，它不是。很明显，需要做大量的设置和处理各种配置，但这里也有一些陷阱，人们可以从中受益，这将有助于节省时间和减少挫折。</p><p id="fd29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从我的错误中吸取教训。</p><p id="43d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想跳过所有的解释，你可以到文章的底部，通过链接查看完整的源代码。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="fb2f" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">设置</h1><p id="79c2" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我们的应用程序将由前端和后端组成。从前端的角度来看，将有一个登录/注册页面和另一个页面，将获取/发送随机数据到我们的数据库。我们将在这里使用Firebase身份验证来验证注册用户。有几种方法可以验证用户:</p><ul class=""><li id="1947" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mg ly lz ma bi translated">电子邮件和密码</li><li id="ff76" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">谷歌/脸书/Twitter/GitHub账户(所谓的联合身份提供商身份认证)</li><li id="c4f1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">电话号码</li><li id="620d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">自定义授权</li><li id="7f7e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr mg ly lz ma bi translated">匿名授权</li></ul><p id="fb4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的应用程序中，我们将使用电子邮件和密码选项，因为这是更简单的方法，在大多数情况下，也是更常见的解决方案。</p><p id="53cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种认证将发生在我们的客户端，不需要任何通信到我们的后端为这项任务。</p><p id="cbad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了向服务器发出请求，我们将通过发出GET请求来使用Retrofit2。在这些GET请求中，我们将发送需要更新的数据和一个令牌(关于令牌的更多信息在服务器部分)。</p><p id="13d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从后端来看，我们的服务器负责接受用户使用我们的应用程序获取/保存/删除数据的请求(或<a class="ae kv" href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" rel="noopener ugc nofollow" target="_blank"> CRUD </a>)。为了能够让认证用户访问数据库，我们需要使用<a class="ae kv" href="https://firebase.google.com/docs/admin/setup" rel="noopener ugc nofollow" target="_blank"> Firebase的管理SDK </a>。这个框架将使我们能够访问一个API来验证经过身份验证的用户，并将请求传递给我们的数据库。我们将使用Firebase的<a class="ae kv" href="https://firebase.google.com/docs/database" rel="noopener ugc nofollow" target="_blank">实时数据库</a>保存用户数据。在后端完成所有工作后，我们将通过<a class="ae kv" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>部署它。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="53f6" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">客户端用户界面</h1><p id="7cbf" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">打开一个新的Kotlin项目后，我们需要导入一些依赖项。首先，您需要将Firebase添加到您的项目中。</p><p id="f716" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://firebase.google.com/docs/android/setup#console" rel="noopener ugc nofollow" target="_blank">遵循此处概述的步骤</a></p><p id="1a85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成后，将以下依赖项添加到您的应用程序级<code class="fe nl nm nn no b">build.gradle</code>文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="20e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户打开应用程序时，他们可以登录或注册(如果是第一次)。因为我们已经同意基于用户的电子邮件和密码的组合来验证用户，所以我们将创建一个简单的活动，它有两个<code class="fe nl nm nn no b">EditTexts</code>来完成这个任务。我们还将有两个按钮来表示注册或登录的选择。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的登录屏幕布局</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的LoginActivity.kt文件</p></figure><ol class=""><li id="26bb" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">我们将监听器附加到我们的编辑文本，以识别它们何时失去焦点或者用户何时按下了完成按钮。</li><li id="0f58" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe nl nm nn no b">loginUser</code>方法负责根据用户先前的凭证对用户进行身份验证(使用signInWithEmailAndPassword API)。</li><li id="ef6a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe nl nm nn no b">signupUser</code>方法使用createUserWithEmailAndPassword API。</li><li id="2d83" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">您可以看到，我们已经覆盖了<code class="fe nl nm nn no b">onStart</code>生命周期方法，以识别用户何时返回应用程序，并在用户已经登录的情况下适当地更新UI。</li></ol><p id="01ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行我们的应用程序时，我们会看到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9a5cc188b9d436d1f67137aa94b5bd2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*q4L52_29VKSTqAkOOqOL2w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不要太花哨</p></figure><p id="bda3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那是容易的部分。在我们继续编写与后端通信的逻辑之前，让我们首先构建后端。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="abb0" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">服务器</h1><p id="8de1" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我们将在构建服务器时使用Express。下面是这样一个服务器的模板，它还添加了标头以绕过我们可能遇到的任何CORS问题:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="45e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似于我们在客户端所做的，我们也需要将Firebase添加到我们的节点服务器。如果您回想一下在Firebase中创建项目的步骤，并选择了一个Android项目，那么您需要向该项目添加另一个代表我们的服务器的应用程序。通过点击Firebase控制台主屏幕上的添加应用程序，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2cc9502434e31bff84be16b9fe4e4277.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*D5U2pOM8pvb73KFPCPyYdg.png"/></div></figure><p id="f997" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将看到可供选择的平台:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/cbf18df0a3f8ee2f345945207e588113.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*g5MOxShv5H07Cw_QFEJ61Q.png"/></div></figure><p id="90fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要选择web选项(带有&gt;图标的选项)</p><p id="db71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Firebase控制台中完成初始配置后，您需要将配置对象添加到项目中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">firebaseConfig示例(填写您项目的详细信息)</p></figure><p id="92de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将把这些配置放在我们的主文件(<code class="fe nl nm nn no b">app.js</code>)中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="dfdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你们中有些人可能会想，“我把所有这些秘密信息都保存在客户端。大家都会看得见的！”这是完全正确的，但在Firebase的情况下，这是可以的。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="126a" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">数据库</h1><p id="4172" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">然而，唉，我们仍然有一些更多的配置要做。这次它与我们的实时数据库有关。转到Firebase控制台，选择您在本文前面创建的项目。在左侧菜单中，您会看到一个实时数据库选项。点击它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/fd6b31026661ee5b9c1452431a4b6f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*OS0GNYQgtF2GAEBDup02hQ.png"/></div></figure><p id="b22c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，在右侧会出现一个窗口，其中包含以下选项卡:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/1c2f450449d5e280839d33585997e1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*fnyDO96rxl8mmBE0XQbI2A.png"/></div></figure><p id="e3d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在“数据”选项卡下，会有您的数据库的URL。记住它，因为我们以后会用到它。另一个要查看的重要选项卡是规则。这些规则指定谁可以访问您的数据库以及他们可以在那里做什么。最初(出于测试目的)，那里的规则相当宽松，任何人都可以读写你的数据库。<strong class="ky ir">在你让你的应用程序上线之前，确保用更严格的东西更新这些规则</strong>。别担心，你会看到一个例子。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="ddc4" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">Firebase管理</h1><p id="4b84" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">接下来，我们需要设置<a class="ae kv" href="https://firebase.google.com/docs/admin/setup" rel="noopener ugc nofollow" target="_blank"> Firebase Admin SDK </a>。因为我们已经在firebase控制台中设置了必要的东西，所以我们需要安装Firebase管理包。</p><pre class="kg kh ki kj gt nw no nx ny aw nz bi"><span id="3cd7" class="oa mp iq no b gy ob oc l od oe">npm install firebase-admin --save</span></pre><p id="92f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要生成一个私钥，因为我们的项目是一个服务帐户。内部Firebase控制台:</p><ol class=""><li id="093e" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">项目概述旁边有一个齿轮图标。点按它并选取“项目设置”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/ec20e7bb1d867e83be94a773074af3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*aWjJKvMCZM3DaiX5cukmsQ.png"/></div></figure><p id="a2a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.点击<strong class="ky ir"> <em class="og"> </em> </strong>服务账户选项卡。</p><p id="7e12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.单击创建服务帐户按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/67138866bd993f2f35a4df19831be487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqdWHjt64JUauzNgik5Hcg.jpeg"/></div></div></figure><p id="29b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.选择节点作为配置片段。</p><p id="1689" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.单击生成新的私钥。</p><p id="2e69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将这个文件放在您的项目中，并在Firebase提供的代码片段中更改它的路径。</p><p id="3016" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:请确保将该文件排除在您的</strong> <code class="fe nl nm nn no b"><strong class="ky ir">.gitignore</strong></code> <strong class="ky ir">文件之外，并且不要将其上传到任何公共存储库中。</strong></p><p id="ddac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将所有这些放在一起，我们的<code class="fe nl nm nn no b">app.js file</code>将如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="cd02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还记得我之前提到的数据库URL吗？你需要将它插入到传递给Firebase的admin <code class="fe nl nm nn no b">initializeApp</code>方法的对象中。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="9ea6" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">创建端点和部署</h1><p id="4406" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">唷，这是一个很大的设置。现在，我们的服务器能够运行，但它不会做任何事情，因为没有配置端点。为了解决这种情况，让我们定义一个端点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="73d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的端点称为<code class="fe nl nm nn no b">getData</code>，您可以看到，在执行任何其他逻辑之前，我们正在提取发送的auth令牌，并使用Firebase Admin对其进行验证。如果一切正常，我们继续获取用户的UID，并使用它从数据库中获取用户的数据。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="9df7" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">在客户端发出请求</h1><p id="141c" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">正如我们前面提到的，我们将使用Retrofit2向服务器发出请求。这里我不会详细介绍如何使用Retrofit2(有很多文章都是这么做的)，所以下面您可以找到使用Retrofit2进行网络请求的标准实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="4399" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，在获得FirebaseUser对象后，我们使用<code class="fe nl nm nn no b">getIdToken</code>方法提取令牌，该令牌将被发送到服务器。同样，我们可以创建另一个GET请求来设置数据库中的数据。</p><p id="06cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后但并非最不重要的一点是，下面是一组数据库规则的示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a87a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们确保任何想要读取或写入数据的用户都得到授权。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="ee1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文基于我在构建自己的应用程序时所经历的事情。可以在下面查看一下(源代码也有):</p><div class="oi oj gp gr ok ol"><a href="https://play.google.com/store/apps/details?id=com.tomerpacific.todo" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">Google Play上的待办事项应用</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">你是否曾经很难记住你一天中需要完成的所有事情？曾经需要一个地方写下你的…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">play.google.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz kp ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://github.com/TomerPacific/Todo" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">TomerPacific/Todo</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">Todo List应用程序，它使用Firebase来验证用户并在数据库中保存数据。还有一个选项是…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz kp ol"/></div></div></a></div></div></div>    
</body>
</html>