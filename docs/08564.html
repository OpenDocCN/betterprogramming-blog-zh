<html>
<head>
<title>How to Speed Up Your Day-To-Day Work in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何加快Python中的日常工作</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-speed-up-your-day-to-day-work-in-python-213762cd56b1?source=collection_archive---------4-----------------------#2021-05-14">https://betterprogramming.pub/how-to-speed-up-your-day-to-day-work-in-python-213762cd56b1?source=collection_archive---------4-----------------------#2021-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="50a7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用所有可用的计算能力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4b4663689436b530811e03cdc4d2534a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jg-qT_MZF9Au5gND"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰克·吉文斯在Unsplash上的照片</p></figure><p id="9b0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的日常数据工作中，我经常发现自己运行许多<code class="fe lv lw lx ly b">for</code>循环。这些可能需要几分钟才能完成，这不一定是很长的时间，但循环是令人尴尬的并行化。我们可以做得更好。</p><p id="cb6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将讨论如何在使用Python时更有效地利用时间。无论您使用笔记本电脑还是高性能计算机(HPC ),您都可以充分利用所有可用的计算能力来加快工作流程。这可以通过<code class="fe lv lw lx ly b">Dask</code>和<code class="fe lv lw lx ly b">Dask-jobqueue</code>库来实现。这篇文章将讨论如何在本地计算机和HPC上创建和使用<code class="fe lv lw lx ly b">dask</code>集群。</p><p id="8ec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Dask</code>是一个用于并行计算的Python库，<code class="fe lv lw lx ly b">dask-jobqueue</code>让你从一个Jupyter笔记本上与任务调度器交互，比如Slurm。<code class="fe lv lw lx ly b">Dask</code>让简单的事情变得更容易，复杂的事情变得可能，它的<code class="fe lv lw lx ly b">numpy </code>和<code class="fe lv lw lx ly b">pandas</code>式的API让编写代码成为Pythonic数据从业者熟悉的事情。</p><h2 id="2a52" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated"><strong class="ak">目录</strong></h2><ul class=""><li id="e2e7" class="ms mt it lb b lc mu lf mv li mw lm mx lq my lu mz na nb nc bi translated"><a class="ae ky" href="#bfbe" rel="noopener ugc nofollow">安装</a></li><li id="3178" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="#b21c" rel="noopener ugc nofollow">在笔记本电脑上安装Dask集群</a></li><li id="500c" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="#6ec5" rel="noopener ugc nofollow">在HPC上设置Dask集群</a></li><li id="66c5" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="#069f" rel="noopener ugc nofollow">向集群提交工作</a></li><li id="433d" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="#7ec2" rel="noopener ugc nofollow">Dask labe extension</a></li><li id="0907" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><a class="ae ky" href="#067c" rel="noopener ugc nofollow">最后的想法</a></li></ul><h1 id="bfbe" class="ni ma it bd mb nj nk nl me nm nn no mh jz np ka mk kc nq kd mn kf nr kg mq ns bi translated">装置</h1><p id="8a5f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">首先，您需要安装<code class="fe lv lw lx ly b">dask</code>和<code class="fe lv lw lx ly b">dask-jobqueue</code></p><p id="03ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">注意:</em> <code class="fe lv lw lx ly b"><em class="nw">dask-jobqueue</em></code> <em class="nw">仅在使用带有作业调度程序的HPC时需要。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="f98c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Dask</code>也可以通过pip或者直接从源代码<a class="ae ky" href="https://docs.dask.org/en/latest/install.html" rel="noopener ugc nofollow" target="_blank">安装</a>。默认情况下，它也包含在<a class="ae ky" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank"> Anaconda发行版</a>中。然而，我推荐最小的<a class="ae ky" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank"> miniconda </a>安装程序来设置Python环境。如何设置miniconda的说明如下:</p><div class="nz oa gp gr ob oc"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-miniconda-with-python-and-jupyterlab-5ce07845e818"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">如何将Miniconda与Python和JupyterLab结合使用</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">从头开始设置极简Python环境</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">better编程. pub</p></div></div><div class="ol l"><div class="om l on oo op ol oq ks oc"/></div></div></a></div><h1 id="b21c" class="ni ma it bd mb nj nk nl me nm nn no mh jz np ka mk kc nq kd mn kf nr kg mq ns bi translated">在笔记本电脑上设置Dask集群</h1><p id="b518" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">安装好软件包后，您只需几行代码就可以创建一个本地集群，连接到我们笔记本电脑上的所有内核:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="d8d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会将笔记本电脑上的所有内核变成一个<code class="fe lv lw lx ly b">dask</code>集群。如果你只想在你的机器上使用一定数量的内核，你可以调整<code class="fe lv lw lx ly b">localCluster()</code>中的参数。文档在这里是<a class="ae ky" href="https://docs.dask.org/en/latest/setup/single-distributed.html" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="6ec5" class="ni ma it bd mb nj nk nl me nm nn no mh jz np ka mk kc nq kd mn kf nr kg mq ns bi translated">在HPC上设置Dask集群</h1><p id="b019" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">HPC通常由多个用户共享，并使用一个调度器(如Slurm)来分配任务。在HPC上加速Python的一种方法是并行化工作，并将其分布在HPC上的多个内核上。这需要您向调度器提交许多Python脚本，这将在下面的文章中讨论。</p><div class="nz oa gp gr ob oc"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-process-multiple-files-10x-faster-in-python-4f0ea9c7f64a"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">如何在Python中将处理多个文件的速度提高10倍</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">不要循环，同时运行每个迭代</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">better编程. pub</p></div></div><div class="ol l"><div class="or l on oo op ol oq ks oc"/></div></div></a></div><p id="d23b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们想在JupyterLab会话中使用HPC节点，该怎么办呢？我们如何将这些节点连接起来？当我们在做的时候，你如何远程连接到Jupyterlab？以下部分将讨论这些主题。</p><h2 id="005f" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">远程连接到JupyterLab</h2><p id="5c57" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">除非您有幸使用JupyterHub，否则在远程计算机上连接JupyterLab并不容易。以下是打开在远程计算机上运行的笔记本的说明。</p><div class="nz oa gp gr ob oc"><a href="https://towardsdatascience.com/how-to-connect-to-jupyterlab-remotely-9180b57c45bb" rel="noopener follow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">如何远程连接到JupyterLab</h2><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="os l on oo op ol oq ks oc"/></div></div></a></div><h2 id="41df" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">在HPC上创建Dask集群</h2><p id="ec23" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated"><code class="fe lv lw lx ly b">dask.job_queue</code>为通用<a class="ae ky" href="https://jobqueue.dask.org/en/latest/api.html" rel="noopener ugc nofollow" target="_blank">作业调度器</a>提供接口，包括SLURM、PBS、OAR、SGE和LSF。我将在这个例子中使用Slurm，因为它安装在哥伦比亚大学的<a class="ae ky" href="https://confluence.columbia.edu/confluence/display/rcs/Ginsburg+HPC+Cluster+User+Documentation" rel="noopener ugc nofollow" target="_blank"> Ginsburg </a>集群上。</p><h2 id="dc87" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">设置步骤</h2><ol class=""><li id="c6e3" class="ms mt it lb b lc mu lf mv li mw lm mx lq my lu ot na nb nc bi translated">定义工人的规格</li><li id="724b" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu ot na nb nc bi translated">将集群扩展到几个工作人员</li><li id="5996" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu ot na nb nc bi translated">将集群连接到一个<code class="fe lv lw lx ly b">Dask </code>调度程序</li></ol><p id="df72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的代码中，我使用<code class="fe lv lw lx ly b">SLURMCluster</code>定义了一个worker，然后将该定义连接到一个<code class="fe lv lw lx ly b">dask</code>调度器(<code class="fe lv lw lx ly b">Client</code>)。然后，我可以根据需要将集群扩展到任意数量的员工。在这种情况下，我指示调度程序使用8个工人(<code class="fe lv lw lx ly b">cluster.scale(8)</code>)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="795a" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">SLURMCluster参数</h2><p id="5d45" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">我为定义单个工人的<code class="fe lv lw lx ly b">SLURMCluster</code>提供一些参数。你传递给<a class="ae ky" href="https://jobqueue.dask.org/en/latest/generated/dask_jobqueue.SLURMCluster.html#" rel="noopener ugc nofollow" target="_blank"> dask_jobqueue的选项。SLURMCluster </a>或者特定于HPC集群，或者特定于Dask。这里有几个相关的论点。</p><ul class=""><li id="65d6" class="ms mt it lb b lc ld lf lg li ou lm ov lq ow lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">project</code>:作业的账户字符串</li><li id="9f3b" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">cores</code>:每个作业的核心总数</li><li id="4f5a" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">把工作分成这么多的过程。</li><li id="1936" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">memory</code>:每个作业的内存总量</li><li id="92ae" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">shebang</code>:批量提交脚本所需解释器的路径。</li><li id="2f26" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">walltime</code>:每个工人工作的休息时间。</li><li id="4627" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">death_timeout</code>:关闭工作线程前等待调度程序的秒数</li><li id="24ba" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><code class="fe lv lw lx ly b">interface</code>:网络接口。<code class="fe lv lw lx ly b">ib0</code>指定Infiniband。</li></ul><h2 id="0e99" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">它如何与员工联系起来</h2><p id="ae69" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">这在幕后所做的是启动一个bash脚本来连接每个工人。我们可以看到带有<code class="fe lv lw lx ly b">print(cluster.job_script())</code>的脚本:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/569a5a845508735b3130228b7f1cd84f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8e0IEZgX5zIV4Uz8jhkNsg.png"/></div></div></figure><p id="0361" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您熟悉启动作业脚本，这可能看起来很熟悉。它所做的就是利用我们给<code class="fe lv lw lx ly b">SLURMCluster()</code>的选项，构造一个小的作业脚本，告诉Slurm如何用我们提供的参数启动一个dask worker。</p><p id="1a5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们运行<code class="fe lv lw lx ly b">cluster.scale()</code>时，它会多次提交这个脚本，并为我们提供更多的计算。</p><h2 id="6796" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">配置文件</h2><p id="e5e0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">您可以将这些参数存储在配置文件中，而不是每次运行笔记本时都向<code class="fe lv lw lx ly b">SLURMCluster()</code>提供选项。当您安装<code class="fe lv lw lx ly b">dask-jobqueue</code>时，这里会创建一个配置文件:</p><pre class="kj kk kl km gt oy ly oz pa aw pb bi"><span id="0a37" class="lz ma it ly b gy pc pd l pe pf">~/.config/dask/jobqueue.yaml</span></pre><p id="7a35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这允许您存储每个调度程序的配置设置。下面是我的<code class="fe lv lw lx ly b">jobqueue.yaml</code>文件的一个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/3e902dcb128c48f2fc3ce9f8202e8430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yyvmmd24EUJnxieoqtPItw.png"/></div></div></figure><p id="b74c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，只需运行以下命令即可应用这些配置:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="5d10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样做的好处是减少了您的打字量，并且文件可以很容易地与同事共享。</p><h1 id="069f" class="ni ma it bd mb nj nk nl me nm nn no mh jz np ka mk kc nq kd mn kf nr kg mq ns bi translated">向集群提交工作</h1><p id="381a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">在这一节中，我将讨论如何向集群提交工作。</p><h2 id="0325" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">提交单个函数调用</h2><p id="5d09" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">您可以使用<code class="fe lv lw lx ly b">submit()</code>函数提交单个函数调用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="e171" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Dask命令是懒洋洋地运行<a class="ae ky" href="https://tutorial.dask.org/01x_lazy.html" rel="noopener ugc nofollow" target="_blank"/>，这意味着我们不会马上收到一个结果，相反，你会收到一个<a class="ae ky" href="https://docs.python.org/3/library/asyncio-future.html" rel="noopener ugc nofollow" target="_blank"><em class="nw"/></a><em class="nw"/>对象<em class="nw">。</em><code class="fe lv lw lx ly b">result()</code>函数将计算工作量并返回结果。</p><h2 id="2bf2" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">提交多个函数调用</h2><p id="881a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">如果你有多个输入，你可以使用<code class="fe lv lw lx ly b">client.submit()</code>和<code class="fe lv lw lx ly b">future.read()</code>进行列表理解。然而，使用<code class="fe lv lw lx ly b">map()</code>和<code class="fe lv lw lx ly b">gather()</code>通常会更快、更有技巧。<code class="fe lv lw lx ly b">Map()</code>将在一个列表中对未来进行分组，而<code class="fe lv lw lx ly b">gather()</code>将以列表的形式返回结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="7ec2" class="ni ma it bd mb nj nk nl me nm nn no mh jz np ka mk kc nq kd mn kf nr kg mq ns bi translated">Dask LabExtension</h1><p id="6ef6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">现在让我们安装<a class="ae ky" href="https://github.com/dask/dask-labextension" rel="noopener ugc nofollow" target="_blank"> JupyterLab Dask扩展</a>，它允许你将仪表盘直接嵌入笔记本面板。这可以在作业运行时提供进度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="8af1" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">连接到笔记本电脑上的仪表板</h2><p id="076a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">创建dask集群后，您可以通过打印<code class="fe lv lw lx ly b">client</code>对象来查看仪表板位置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/5f10ee3c4e266df5cc1a2c06a819b26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BNldVf_jbNtQCKcjFKuSCA@2x.png"/></div></div></figure><p id="6f4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以单击JupyterLab中的<code class="fe lv lw lx ly b">dask</code>图标，并将仪表板地址粘贴到文本框中。这将连接到仪表板，以便您可以将窗格拖动到您的会话中并停靠它们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/6c1acfee09ae5740ceb032b356297037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*VeyGlvGkjCQPRA51--Zkkg.png"/></div></figure><h2 id="48c2" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">连接到HPC上的仪表板</h2><p id="f69d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">连接到HPC上的仪表板要稍微复杂一些。</p><p id="da77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建dask集群后，仪表板需要进行端口转发。您可以通过打印<code class="fe lv lw lx ly b">client</code>对象来查看仪表板位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/e0c2d701fd833f41e5b71d2f9a703d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wwXlzkdzDbfJCwIioqUDsA@2x.png"/></div></div></figure><p id="8961" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仪表板需要首先进行端口转发。您可以在计算机的端口8787上打开仪表板。</p><pre class="kj kk kl km gt oy ly oz pa aw pb bi"><span id="3d5f" class="lz ma it ly b gy pc pd l pe pf">ssh -L 8787:10.197.20.3:8787 USER@HOST</span></pre><p id="70dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在可以在本地端口8787上查看仪表板。</p><p id="10b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在浏览器中打开一个新选项卡，并通过以下URL连接仪表板:</p><pre class="kj kk kl km gt oy ly oz pa aw pb bi"><span id="270d" class="lz ma it ly b gy pc pd l pe pf">http://localhost:8787</span></pre><p id="e82b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，<code class="fe lv lw lx ly b">Dask</code> labextension允许您在JupyterLab中显示仪表板。点击<code class="fe lv lw lx ly b">dask</code>图标，粘贴端口转发仪表板地址(<code class="fe lv lw lx ly b">http://localhost:8787</code>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/c733baa889bd4ee4f942b57ede598845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krrsMbF8BHU1RSixsCTCGA@2x.png"/></div></div></figure><p id="be9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">粘贴仪表板地址后，您可以从左侧面板中拖出不同的窗格。在这里，我在右侧显示了进度和任务流窗格。这些窗格显示每个内核上运行的作业进度和任务。</p><p id="69e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，循环的每次迭代暂停一秒钟。运行500次迭代大约在5秒钟内完成，因为这项工作分散在120个内核上。</p></div><div class="ab cl pl pm hx pn" role="separator"><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq"/></div><div class="im in io ip iq"><h1 id="067c" class="ni ma it bd mb nj ps nl me nm pt no mh jz pu ka mk kc pv kd mn kf pw kg mq ns bi translated">最后的想法</h1><p id="a737" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">如果您正在使用Python，我希望这篇文章有助于加快您的日常工作。<code class="fe lv lw lx ly b">Dask</code>非常适合<a class="ae ky" href="https://examples.dask.org/applications/embarrassingly-parallel.html" rel="noopener ugc nofollow" target="_blank">令人尴尬的并行工作负载</a>和<code class="fe lv lw lx ly b">dask-jobqueue</code>允许您充分利用HPC上的内核，提高速度和可扩展性。HPC通常是一个面向批处理的系统——这种方法将它变成了一个成熟的交互式Python工具，可以跨多个内核扩展。</p><p id="692d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我没有提到在云中使用<code class="fe lv lw lx ly b">dask</code>。你可以在这里阅读各种云部署<a class="ae ky" href="https://docs.dask.org/en/latest/setup/cloud.html" rel="noopener ugc nofollow" target="_blank"/>。我也鼓励大家去看看<a class="ae ky" href="https://coiled.io/" rel="noopener ugc nofollow" target="_blank"> coiled.io </a>，由<code class="fe lv lw lx ly b">Dask</code>维护者、<a class="ae ky" href="https://matthewrocklin.com/" rel="noopener ugc nofollow" target="_blank">马修·洛克林</a>启动。标语是“盘绕使云易于扩展。”我并不隶属于coiled，我只是认为这是一个伟大的创业。</p></div><div class="ab cl pl pm hx pn" role="separator"><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq"/></div><div class="im in io ip iq"><p id="bb47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">我很乐意帮助您解决在JupyterLab中运行Dask时遇到的任何问题。</em></p><p id="1c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">感谢阅读和支持媒体作者</em></p><div class="nz oa gp gr ob oc"><a href="https://lukegloege.medium.com/membership" rel="noopener follow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">通过我的推荐链接加入Medium—Luke Gloege博士</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">lukegloege.medium.com</p></div></div><div class="ol l"><div class="px l on oo op ol oq ks oc"/></div></div></a></div></div></div>    
</body>
</html>