<html>
<head>
<title>How to Build Your First dApp on Tezos</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Tezos上构建您的第一个dApp</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-your-first-dapp-on-tezos-270c568d4fe9?source=collection_archive---------5-----------------------#2020-03-17">https://betterprogramming.pub/build-your-first-dapp-on-tezos-270c568d4fe9?source=collection_archive---------5-----------------------#2020-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b5db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建第一个简单的dApp所需的一切</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/34f0536e75032371a7e7b50b1ba2c47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8LLYN0yow4oh0RqiKPNRA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/de/photos/notebook-laptop-macbook-1280538/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上的<a class="ae ky" href="https://pixabay.com/de/users/freephotocc-2275370/" rel="noopener ugc nofollow" target="_blank">安德里安·瓦雷亚努</a>拍摄</p></figure><blockquote class="kz la lb"><p id="6648" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">反对警告</strong>:自从这篇文章发表以来，Tezos生态系统已经进化了很多。这里展示的部分代码已经被弃用，或者已经创建了更好的工具。<br/>请查看<a class="ae ky" href="https://medium.com/ecad-labs-inc/how-to-build-your-first-tezos-dapp-2021-edition-b1263b4ba016" rel="noopener"> 2021版“在Tezos上构建您的第一个dapp”</a>了解最新信息。</p></blockquote><p id="9518" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">本文是我的Ligo智能合约开发系列教程的副产品(<a class="ae ky" href="https://medium.com/@claudebarde/getting-started-with-ligo-13ea2c4e844e" rel="noopener">第1部分</a>、<a class="ae ky" href="https://medium.com/@claudebarde/getting-started-with-ligo-part-2-fb0c000e40c6" rel="noopener">第2部分</a>和<a class="ae ky" href="https://medium.com/@claudebarde/getting-started-with-ligo-part-3-c1c4a403c5e4" rel="noopener">第3部分</a>)。我们将花一些时间来看看前端应用程序如何与部署在Tezos区块链上的智能合约进行交互。</p><p id="82b8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果你已经在其他区块链上开发了<a class="ae ky" href="https://blog.coincodecap.com/tag/dapps/" rel="noopener ugc nofollow" target="_blank"> dApps </a>(比如<a class="ae ky" href="https://blog.coincodecap.com/tag/ethereum/" rel="noopener ugc nofollow" target="_blank">以太坊</a>)，其中一些东西看起来会很相似，但其他的东西会完全不同。你还必须记住，在Tezos上，dApps们还处于早期阶段，他们还没有准备好全力工作。然而，现在你仍然可以在Tezos上做很多很酷的事情。</p><p id="eeb9" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们将为一家名为Café Tezos的虚拟咖啡馆建立一个销售点系统。我最迫不及待想在不久的将来看到的事情之一是使用加密货币进行日常生活购物的可能性。如果你是一名开发人员，你可能会喝很多咖啡！这是一个很好的例子。</p><p id="e717" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">dApp将基于反应。老实说，我更像是一个苗条的人，但由于React是目前最流行的前端框架，为了与尽可能多的人分享这些知识，使用它似乎是合乎逻辑的。</p><p id="375a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">除了React之外，我们还将使用为与Tezos区块链一起工作而开发的不同工具:Truffle来编译和部署合同，Stove Labs 的修改版<a class="ae ky" href="https://github.com/stove-labs/tezos-starter-kit" rel="noopener ugc nofollow" target="_blank"> Tezos starter kit来运行沙盒节点，TezBridge将我们的钱包与dApp连接并签署交易，最后，Taquito与</a><a class="ae ky" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>和智能合同交互。这些工具通常是分开展示的，但我相信看到它们如何协同工作会很有趣。</p><p id="b36b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在深入研究代码之前，我希望您记住两点:</p><h2 id="e661" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated"><strong class="ak">这款dApp还没有做好生产准备</strong></h2><p id="e076" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">尽管它是可用的，但正如您将看到的，为了简单起见，还有一些考虑事项没有考虑。例如，React代码没有进行优化以保持简单，以便初学者和高级用户都能够理解。</p><h2 id="850a" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">这不是一个React教程。</h2><p id="a369" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">本教程需要React.js和JavaScript的基础知识。我在这里只复制重要的代码dApp的完整代码可以在<a class="ae ky" href="https://github.com/claudebarde/tezos-react-tutorial" rel="noopener ugc nofollow" target="_blank">相关的GitHub库</a>中找到。</p><p id="5e4f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在是卖咖啡的时候了！</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="74b7" class="nh md it bd me ni nj nk mh nl nm nn mk jz no ka mn kc np kd mq kf nq kg mt nr bi translated">设置环境</h1><p id="2456" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">在开始之前，必须确保您的计算机上安装了Docker和Node.js。如果你有它们，启动Docker桌面。</p><p id="acc2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">接下来，你必须在全球范围内安装Truffle Tezos。打开新的终端窗口，并键入:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="dd20" class="mc md it nt b gy nx ny l nz oa">$ npm i -g truffle@tezos</span></pre><p id="2788" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我已经在GitHub repo 中准备好了本教程所需的一切。在终端窗口中键入:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d622" class="mc md it nt b gy nx ny l nz oa">$ git clone <a class="ae ky" href="https://github.com/claudebarde/tezos-react-tutorial" rel="noopener ugc nofollow" target="_blank">https://github.com/claudebarde/tezos-react-tutorial</a><br/>$ cd tezos-react-tutorial<br/>$ npm install</span></pre><p id="3dea" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在这一步之后，您有两个解决方案:您可以离开<code class="fe ob oc od nt b">client</code>文件夹，按照本教程检查代码。或者你可以删除<code class="fe ob oc od nt b">client</code>文件夹，在文件夹的根目录下创建一个新的React app。我建议只对React power用户删除<code class="fe ob oc od nt b">client</code>文件夹，因为你必须填补本教程中不会出现的代码空白。</p><p id="6f66" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，让我们安装React依赖项:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="11f1" class="mc md it nt b gy nx ny l nz oa">$ cd client<br/>$ npm install</span></pre><p id="c979" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">至此，大部分设置已经完成。我们可以启动沙盒节点:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ffd0" class="mc md it nt b gy nx ny l nz oa">$ cd ..<br/>$ npm run start-sandbox -- carthage</span></pre></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="4631" class="nh md it bd me ni nj nk mh nl nm nn mk jz no ka mn kc np kd mq kf nq kg mt nr bi translated">编译合同并部署它</h1><p id="9531" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">我们将使用的契约已经存在于项目中。这与我们在Ligo教程的第3部分中创建的是同一个。Truffle使得在一个叫做<a class="ae ky" href="https://www.trufflesuite.com/docs/truffle/getting-started/running-migrations" rel="noopener ugc nofollow" target="_blank"> <em class="le">迁移</em> </a> <em class="le">的过程中编译和部署新合同变得非常容易。</em>部署者文件如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/33ed5a7a74a803b8c4d82043af571771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F9rUfIepLajkviCoHXWWHg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">部署者文件</p></figure><p id="0288" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这个文件做了几件简单的事情:</p><ul class=""><li id="0394" class="of og it lf b lg lh lj lk lz oh ma oi mb oj ly ok ol om on bi translated">取合同进行部署:<code class="fe ob oc od nt b">artifacts.require("PointOfSale")</code></li><li id="4286" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated">它获取我们将用来部署合同的账户信息(在<code class="fe ob oc od nt b">alice</code>变量中)</li><li id="b8b1" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated">它设置初始存储(这些值将被Taquito自动转换成Ligo兼容的值)</li><li id="db6c" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated">它导出部署器函数和初始存储</li></ul><p id="39a2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在我们可以编译合同了:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a70e" class="mc md it nt b gy nx ny l nz oa">$ npm run compile</span></pre><p id="1229" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">只需要几秒钟，如果我没有犯任何错误，合同就编译好了。</p><p id="2b92" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果你很好奇，你可能注意到这一步创建了一个<code class="fe ob oc od nt b">build</code>文件夹。在这个文件夹中，另一个文件夹<code class="fe ob oc od nt b">contracts</code>包含两个JSON文件，其中一个与我们的合同同名。如果你打开它，你会看到从我们的Ligo合同编译的迈克尔逊。</p><p id="fc3d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，我们可以将契约部署到沙盒节点:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7735" class="mc md it nt b gy nx ny l nz oa">$ npm run migrate</span></pre><p id="4ae4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">控制台中的输出应该类似于以下内容:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7292" class="mc md it nt b gy nx ny l nz oa">Starting migrations...<br/>======================<br/>&gt; Network name:    'development'<br/>&gt; Network id:      NetXdQprcVkpaWU<br/>&gt; Block gas limit: 10400000</span><span id="1bb9" class="mc md it nt b gy ot ny l nz oa">1_deploy_point_of_sale.js<br/>==========================</span><span id="3823" class="mc md it nt b gy ot ny l nz oa">Replacing 'PointOfSale'<br/>  -----------------------<br/>  &gt; operation hash:                 oo3JG8jJhGLtQ71qMtqZqKzAniadiZDeQNqe6sA7W8ZXuydSfeS<br/>  &gt; Blocks: 1            Seconds: 8<br/>  &gt; contract address:    KT1SVc1wpWdBmJUMruacMjfjS9Gib5WLmz28<br/>  &gt; block number:        6631<br/>  &gt; block timestamp:     2020-03-13T14:47:47Z<br/>  &gt; account:             tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb<br/>  &gt; balance:             1999999.536464<br/>  &gt; gas used:            42199<br/>  &gt; storage used:        1208 bytes<br/>  &gt; fee spent:           5.73 mtz<br/>  &gt; burn cost:           1.465 tez<br/>  &gt; value sent:          0 XTZ<br/>  &gt; total cost:          1.47073 XTZ</span><span id="3eed" class="mc md it nt b gy ot ny l nz oa">  &gt; Saving artifacts<br/>  -------------------------------------<br/>  &gt; Total cost:             1.47073 XTZ</span><span id="f3a0" class="mc md it nt b gy ot ny l nz oa">Summary<br/>=======<br/>&gt; Total deployments:   1<br/>&gt; Final cost:          1.47073 XTZ</span></pre><p id="4fbf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">你会注意到有些值是不同的，比如<code class="fe ob oc od nt b">operation hash</code>或者<code class="fe ob oc od nt b">contract address</code>，这是完全正常的。这也给你提供了很多有价值的信息供以后使用，比如使用的气体和总成本。</p><p id="4bec" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我还建议您使用<a class="ae ky" href="https://better-call.dev/" rel="noopener ugc nofollow" target="_blank"> Better Call Dev explorer </a>检查您新部署的契约——只需选择“沙箱”选项，并将契约地址复制粘贴到输入字段中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/63ad2836f2f1515eccce2969e5d2b4dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yjaqb0PJkMbOYqVIxl8Upw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更好的呼叫开发输出</p></figure><p id="6ffb" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">既然我们已经建立了我们的开发环境，并且编译和部署了我们的契约，那么是时候构建我们的dApp了。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="478c" class="nh md it bd me ni nj nk mh nl nm nn mk jz no ka mn kc np kd mq kf nq kg mt nr bi translated">构建前端</h1><h2 id="57e7" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">设置事物</h2><p id="e2ab" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">正如您从<code class="fe ob oc od nt b">client</code>文件夹中看到的，我们的React应用程序将非常简单:<code class="fe ob oc od nt b">App.js</code>文件是入口点，包含一个<code class="fe ob oc od nt b">Menu</code>组件，它将显示我们刚刚开始存储的不同种类的咖啡以及其他交互。</p><p id="9337" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">还有一个显示登录按钮和用户余额的小钱包组件。一些基本样式和加载动画样式位于<code class="fe ob oc od nt b">App.css</code>文件中，你也可以看到一个布尔玛CSS文件，它可以让我们快速创建一个更好的界面。</p><p id="e085" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在让我们看看<code class="fe ob oc od nt b">App.js</code>文件的顶部:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/7fa2743f732a40d13bcc0b52396c9d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPxgyV36xIVhnxoH5OoMkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">App.js</p></figure><p id="5587" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们从<a class="ae ky" href="https://tezostaquito.io/" rel="noopener ugc nofollow" target="_blank"> Taquito包</a>中导入我们需要的不同依赖项和两个函数(下面将详细介绍)。</p><p id="6515" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">无论您在这里找到什么样的契约地址，都用您输入到Better Call Dev接口中的地址替换它。Tezos区块链上的合同地址以<code class="fe ob oc od nt b">KT1</code>开头——这就是你如何知道你有合适的价值。</p><p id="0603" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">接下来，我添加了两个简单的函数，使我们的界面更加友好:</p><ul class=""><li id="c1eb" class="of og it lf b lg lh lj lk lz oh ma oi mb oj ly ok ol om on bi translated"><code class="fe ob oc od nt b">shortenAddress</code>会把<code class="fe ob oc od nt b">tz1VSUr8wwNhLAzempoch5d6hLRiTh8Cjcjb</code>变成<code class="fe ob oc od nt b">tz1VSU…8Cjcjb</code>，我相信你会同意，这样看起来更舒服</li><li id="7a96" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated"><code class="fe ob oc od nt b">mutezToTez</code>将micro tez中的值转换成tez。通常，我只使用<code class="fe ob oc od nt b">mutez</code>值。在我看来，它们更容易使用，也不容易出现计算错误。您总是可以轻松地在前端显示用户友好的值，并避免tez &lt; = &gt; mutez转换或处理mutez的错误，而您认为它们是tez，反之亦然！</li></ul><h2 id="1ad9" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">添加TezBridge</h2><p id="6eab" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">到目前为止，TezBridge还没有npm包，所以不能像其他依赖项一样导入它。</p><p id="735b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果你打开位于<code class="fe ob oc od nt b">public</code>文件夹中的<code class="fe ob oc od nt b">index.html</code>文件，你会在<code class="fe ob oc od nt b">&lt;title&gt;</code>标签前看到<br/> <code class="fe ob oc od nt b">&lt;script src="https://www.tezbridge.com/plugin.js"&gt;&lt;/script&gt;</code>。这一行是导入<a class="ae ky" href="https://docs.tezbridge.com/" rel="noopener ugc nofollow" target="_blank"> TezBridge </a>所必需的。</p><p id="5730" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">TezBridge是一个工具，它允许你使用任何你想要的Tezos地址来签署交易。在区块链的背景下，<em class="le">签署一项交易</em>仅仅意味着你批准了这项交易。在Café Tezos的例子中，当我们想买一杯咖啡时，我们将签署一项交易。TezBridge插件将为我们提供一些有用的函数，我们可以用它们来签署交易和做其他重要的动作。</p><p id="bbaa" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">为Tezbridge插件添加脚本标签将在<code class="fe ob oc od nt b">window</code>对象中公开一个<code class="fe ob oc od nt b">tezbridge</code>对象。我们将把它保存在<code class="fe ob oc od nt b">window</code>对象中，这样我们就可以在任何时候访问它，我们将只编写<code class="fe ob oc od nt b">const tezbridge = window.tezbridge</code>来使它更容易在我们的React代码中使用。</p><h2 id="5c6a" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">设置Taquito</h2><p id="07df" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">在我们的组件安装完成后，我们将设置<a class="ae ky" href="https://tezostaquito.io/" rel="noopener ugc nofollow" target="_blank"> Taquito </a>。塔基多是一个令人惊叹的图书馆，它将允许我们与合同和泰佐斯区块链进行交流。</p><p id="8e7f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">正如你在<code class="fe ob oc od nt b">App</code>组件的顶部看到的，我们将从两个包中导入两个函数:<code class="fe ob oc od nt b"><a class="ae ky" href="https://tezostaquito.io/typedoc/modules/_taquito_taquito.html" rel="noopener ugc nofollow" target="_blank">@taquito/taquito</a></code>是主包，包含我们将使用的所有可爱的功能，<code class="fe ob oc od nt b"><a class="ae ky" href="https://tezostaquito.io/typedoc/modules/_taquito_tezbridge_signer.html" rel="noopener ugc nofollow" target="_blank">@taquito/tezbridge-signer</a></code>是我们需要的第二个包，以便使用TezBridge作为我们的签名者。为了安装它们，只需返回到<code class="fe ob oc od nt b">client</code>文件夹的根目录，并在控制台中键入:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="96f3" class="mc md it nt b gy nx ny l nz oa">$ npm install @taquito/taquito<br/>$ npm install @taquito/tezbridge-signer</span></pre><p id="75cf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在是时候实际使用Taquito了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9e2d65d0ce93366ba17270ce1450cb92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OPzBP-5oP9HpKL_i3ZnVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Taquito设置</p></figure><p id="81ab" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">先不说这个:</strong>我们将使用的函数是异步的，但是你不能将异步函数传递给<code class="fe ob oc od nt b">useEffect</code>。诀窍是在传递给<code class="fe ob oc od nt b">useEffect</code>的函数中使用一个声明为IIFE的异步函数。</p><p id="9e27" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">首先，我们需要设置我们的提供商。RPC协议是由我们的沙盒节点(或者任何Tezos节点)公开的API，它允许我们与节点通信。在本教程中，节点将使用端口<code class="fe ob oc od nt b">8732</code>来公开RPC，所以我们使用<code class="fe ob oc od nt b">http://localhost:8732</code>作为我们的RPC。</p><p id="730a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">因为我们将使用TezBridge作为我们的签名者，所以我们还必须实例化TezBridge签名者并将其传递给Taquito提供者。我们调用<code class="fe ob oc od nt b">Tezos</code>对象的<code class="fe ob oc od nt b">setProvider</code>函数来设置它。一旦建立了<code class="fe ob oc od nt b">Tezos</code>对象，我们就可以使用它了。</p><p id="59d5" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">首先，我们想要创建一个契约的<em class="le">实例</em>。可以把这个实例看作是我们可以在JavaScript中使用的契约的副本:它将包含契约的入口点及其存储(以及其他有用的信息)。</p><p id="cc2d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">只需键入:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="407b" class="mc md it nt b gy nx ny l nz oa">const contract = await Tezos.contract.at(contractAddress);</span></pre><p id="83c4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这就是为什么在<code class="fe ob oc od nt b">truffle migrate</code>之后用控制台返回的地址更新合同地址很重要。Taquito将使用您为RPC提供的端口来查找您的合同。然后，我们将保存契约实例，因为我们稍后将通过<code class="fe ob oc od nt b">useState</code>钩子再次使用它。</p><p id="18ba" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在让我们来看看合同的存储:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a56e" class="mc md it nt b gy nx ny l nz oa">const storage = await contract.storage();</span></pre><p id="38b0" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">契约实例有一个<code class="fe ob oc od nt b">storage</code>方法，您可以使用它来返回存储。Taquito使得处理存储变得非常容易，因为您在Ligo的契约存储中声明的字段将是<code class="fe ob oc od nt b">storage</code>对象的属性。</p><p id="ea7a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><code class="fe ob oc od nt b">menu</code>属性作为具有不同方法的<code class="fe ob oc od nt b"><a class="ae ky" href="https://tezostaquito.io/typedoc/classes/_taquito_michelson_encoder.michelsonmap-1.html" rel="noopener ugc nofollow" target="_blank">MichelsonMap</a></code> <a class="ae ky" href="https://tezostaquito.io/typedoc/classes/_taquito_michelson_encoder.michelsonmap-1.html" rel="noopener ugc nofollow" target="_blank">给出，这些方法的功能超出了本文的范围。例如，<code class="fe ob oc od nt b">keys()</code>用<code class="fe ob oc od nt b">bigmap</code>的不同键返回一个生成器对象；<code class="fe ob oc od nt b">values()</code>对与键相关的值做同样的事情。这里我们将使用<code class="fe ob oc od nt b">forEach()</code>方法，该方法允许我们遍历<code class="fe ob oc od nt b">MichelsonMap</code>并获取字段/值:</a></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="b495" class="mc md it nt b gy nx ny l nz oa">storage.menu.forEach((value, key) =&gt; {<br/>  coffees.push({ name: key, price: value.c[0] });<br/>});</span></pre><p id="9cdc" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们简单地用包含每种咖啡的名称和价格的对象填充一个JavaScript数组。</p><h2 id="2038" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">将钱包添加到TezBridge</h2><p id="84a5" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">当你的用户使用你的dApp时，他们可能会做的第一件事就是连接他们的钱包。</p><p id="1716" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">由于来自以太坊，一开始没有像MetaMask这样的解决方案有点令人沮丧，在尝试TezBridge之前，我尝试了几个解决方案。我第一次看到它时，它并没有吸引我，因为它的界面有点——我们应该说——严厉！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/1f9f874aaa4ce01cd7776146d1f7ab71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4-fhSybR1EikibZAhW6pw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">TezBridge页面</p></figure><p id="270e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">页面的百分之八十都是空白，点击菜单会打开跳动的窗口(和更多的空白),尽可能采用极简风格。但是不要让这欺骗了你，TezBridge是一个很好的工具，它易于使用，并且为你的用户和你自己提供了有价值的信息。</p><p id="4301" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，在我们可以使用TezBridge之前，我们必须导入我们的私钥来建立一个帐户。</p><p id="70dd" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果你回到<code class="fe ob oc od nt b">tezos-react-tutorial</code>文件夹的根目录，你会发现一个<code class="fe ob oc od nt b">scripts</code>文件夹——在里面，还有一个<code class="fe ob oc od nt b">sandbox</code>文件夹。在后者里面，打开<code class="fe ob oc od nt b">accounts.js</code>文件。</p><p id="62b8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在那里，复制<code class="fe ob oc od nt b">alice</code>对象(即<code class="fe ob oc od nt b">“edsk3QoqBuvdamxouPhin7swCvkQNgq4jP5KZPbwWNnwdZpSpJiEbq”</code>)的<code class="fe ob oc od nt b">sk</code>(如<em class="le">密钥</em>)属性。</p><p id="0d9a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">返回到TezBridge页面，在刚刚出现的字段中粘贴密钥之前，单击“导入密钥”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/82f1d9e2602417bf8ec5c687f7f94aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPEFgN09xYH5ooumPFHryg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在TezBridge中导入密钥</p></figure><p id="3c68" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">您知道您得到了正确的秘密密钥，因为它生成了正确的公共密钥(您可以在<code class="fe ob oc od nt b">alice</code>对象的<code class="fe ob oc od nt b">pkh</code>属性下找到的那个)。作为经理姓名，键入<code class="fe ob oc od nt b">alice</code>(或任何其他姓名)，并选择一个简单的密码(对于您的开发环境，它只与这个帐户相关联，您将会多次键入)。</p><p id="3a2b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">点击“确认”，你就可以使用TezBridge了！</p><h2 id="f192" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">初始化钱包</h2><p id="9580" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">作为dApp中的一个好习惯，我们不想自动连接或者有令人吃惊的欢迎用户的窗口。我们想让他们决定什么时候是他们连接钱包的好时机。Café Tezos在右上角有一个按钮，当我们的用户按下它时，它会初始化钱包。当用户连接他们的钱包时，我们希望发生一些事情:</p><ol class=""><li id="791d" class="of og it lf b lg lh lj lk lz oh ma oi mb oj ly oz ol om on bi translated">我们将获得他们的地址，并显示在按钮上，以显示他们确实是连接的</li><li id="0a5d" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">我们将获取他们的余额，这样他们可以很快知道他们是否有足够的钱购买咖啡</li><li id="1c07" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">如果合同的所有者登录，我们将为他们提供一个按钮来提取合同的余额</li></ol><p id="d2c0" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这是它看起来的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/e8b65321af8def1a65f4dff518674a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBF_ak-Ku1MydXNO7z65fw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">钱包初始化</p></figure><p id="ee0e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><code class="fe ob oc od nt b">tezbridge</code>对象公开了一个名为<code class="fe ob oc od nt b">request</code>的方法，在这里我们将传递一个属性设置为<code class="fe ob oc od nt b">get_source</code>的对象。这允许用户选择他们想要连接到dApp的<a class="ae ky" href="https://blog.coincodecap.com/different-types-of-crypto-wallets/" rel="noopener ugc nofollow" target="_blank">钱包</a>并返回相关的地址。Tezbridge会在dApp旁边打开一个新标签页——你可以在完成后让它保持打开状态，也可以关闭它。用户连接后，我们保存他们的地址来更新按钮。</p><p id="1b18" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">在Taquito的帮助下，我们使用<code class="fe ob oc od nt b">await Tezos.tz.getBalance(userAddress)</code>获取用户的余额。</p><p id="8d65" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">再次感谢Taquito提供的令人难以置信的函数，我们可以获取存储的状态。我们只需要之前创建的契约实例，并在其上调用<code class="fe ob oc od nt b">storage</code>方法。<code class="fe ob oc od nt b">storage</code>对象将拥有以我们存储的字段命名的属性。</p><p id="702d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">正如我们之前解释的，存储对象的每个属性现在都有一些可用的函数。我们想得到当前用户的点数，所以用<code class="fe ob oc od nt b">storage.customers.get(userAddress)</code>来找。</p><p id="63e8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">因为用户的地址可能在地图中丢失，并且在JavaScript中有一个<code class="fe ob oc od nt b">undefined</code>值，如果是这种情况，我们将在我们的前端dApp中将点数设置为<code class="fe ob oc od nt b">0</code>。</p><p id="97ad" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果用户是合同的所有者，我们还将获得合同的总余额，并显示撤销它的按钮。如果你认为在我们的界面中使用这种按钮可能不安全，请记住，即使有不良意图的人获得了该按钮，他们也无法使用它——因为<a class="ae ky" href="https://blog.coincodecap.com/tag/smart-contact/" rel="noopener ugc nofollow" target="_blank">智能合约</a>将检查他们的地址。</p><h2 id="27aa" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">买咖啡</h2><p id="dc28" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">编程中最迷人的一点是，从用户的角度来看，这只是点击一个按钮——但从开发人员的角度来看，改变一个值可能需要十几次或上百次的计算和检查！</p><p id="3059" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">当您向Tezos契约发送交易时，就会出现这种情况。该功能位于<code class="fe ob oc od nt b">Menu</code>组件中。在发送之前，您必须确保有正确的参数。您必须验证事务已被应用，并且必须等待其完成。再次，塔基多将有助于实现这一目标。这就是买咖啡的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/b90f336958bd248cb2f6826d7cc4d083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QnZnWgVHYYv7n7ZF6yMYJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">买咖啡</p></figure><p id="96c1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">事务从以下函数开始:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="21bd" class="mc md it nt b gy nx ny l nz oa">const op = await contractInstance<br/>    .methods<br/>    .buy(coffee)<br/>    .send({amount: price, mutez: true})</span></pre><p id="cfe8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">让我们分解一下:首先，我们需要之前声明的契约实例。这个契约实例让我们可以访问<code class="fe ob oc od nt b">methods</code>方法，它包含了契约的不同入口点。我们将使用<code class="fe ob oc od nt b">buy</code>。如果您还记得的话，智能合约中的<code class="fe ob oc od nt b">buy</code>入口点期望用户想要购买的<code class="fe ob oc od nt b">coffee</code>的名称，因此我们将其作为参数传递给<code class="fe ob oc od nt b">buy</code>方法。</p><p id="5909" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">最后，我们调用<code class="fe ob oc od nt b">send</code>方法，并向其传递一个具有两个属性的对象:<code class="fe ob oc od nt b">amount</code>，它包含用户为咖啡支付的tezzies的数量，以及<code class="fe ob oc od nt b">mutez</code>，它设置为<code class="fe ob oc od nt b">true</code>，以告诉Taquito我们传递的值以micro tez为单位。然后，事务返回一个我们接下来要使用的具有不同属性的对象。</p><p id="e070" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这个操作会将用户的屏幕切换到TezBridge标签页(或者打开一个新的标签页，如果他们已经关闭了它)，并且会提示他们批准(或者拒绝，如果他们改变主意的话)这个交易。</p><p id="4ebf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">一旦完成，事务返回的对象的<code class="fe ob oc od nt b">status</code>属性应该更改为<code class="fe ob oc od nt b">applied</code>。这意味着交易已发送。</p><p id="15e9" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，当沙盒节点确认事务并将其包含在块中时，我们可以坐下来放松一下了。为了做到这一点，我们调用<code class="fe ob oc od nt b">await op.confirmation(1)</code>，它将在继续执行您的代码之前等待一次确认。一旦交易被包含在一个块中，<code class="fe ob oc od nt b">includedInBlock</code>属性将从<code class="fe ob oc od nt b">Infinity</code>变为一个数字(块号)。这是信号——你可以开始煮咖啡了。</p><p id="b3c8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">您可以从代码中注意到，在这个流程中，我们更新了dApp的状态。通知用户正在发生的事情是非常重要的，因为交易的确认可能需要一分钟的时间，并且您希望防止他们多次点击按钮并订购10杯咖啡！</p><p id="8ed0" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">花了这么多时间煮咖啡，是时候收获你的劳动果实了。</p><h2 id="9211" class="mc md it bd me mf mg dn mh mi mj dp mk lz ml mm mn ma mo mp mq mb mr ms mt mu bi translated">收回合同余额</h2><p id="a4d6" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">在<code class="fe ob oc od nt b">App</code>组件中<code class="fe ob oc od nt b">withdraw</code>函数的实现将与<code class="fe ob oc od nt b">buy</code>函数非常相似，但有很大的不同，这需要深入研究一下Taquito文档才能发现:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/b99175c1454d12da6b30bd919e614b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhT051tvdoCWjnvSypCJQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">撤回功能</p></figure><p id="8e01" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如您所见，我们也使用契约实例来发送事务，但是请记住，<code class="fe ob oc od nt b">withdraw</code>入口点不需要任何参数。但是，契约中的<code class="fe ob oc od nt b">main</code>函数有！为了使它工作，您将一个包含另一个数组的数组以字符串<code class="fe ob oc od nt b">unit</code>作为第一个元素传递给表示您的入口点的方法——所以是<code class="fe ob oc od nt b">withdraw([["unit"]])</code>。对于<code class="fe ob oc od nt b">send</code>方法，不需要传递任何参数。</p><p id="4405" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如上所示，然后等待事务被包含在块中的确认，并更新dApp的状态。</p><p id="3257" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">就是这样！现在您知道了如何使用React、Ligo、TezBridge和Taquito构建一个简单的dApp。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="e1cf" class="nh md it bd me ni nj nk mh nl nm nn mk jz no ka mn kc np kd mq kf nq kg mt nr bi translated">概述</h1><p id="3087" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">本教程提供了一个机会，让我们了解在Tezos上开发dApps的不同工具是如何协同工作的。这些工具通常是单独呈现的，但是最好记住它们实际上是您的全球dApp的不同部分。以下是我们在本教程中介绍的内容:</p><ul class=""><li id="c7b6" class="of og it lf b lg lh lj lk lz oh ma oi mb oj ly ok ol om on bi translated"><strong class="lf iu"> React </strong>:使用最广泛的前端框架就不用介绍了。React与其他工具无缝协作，其Hook API允许我们高效地更新dApp的状态，以保持其与智能合约的存储同步。</li><li id="0609" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated">Taquito是一个非常有用的库，它允许与智能合约和数据操作进行多种类型的交互</li><li id="dbcd" class="of og it lf b lg oo lj op lz oq ma or mb os ly ok ol om on bi translated">这个小而方便的工具允许dApp用户选择一个钱包来签署他们的交易。如果你熟悉以太坊，它类似于MetaMask所实现的。</li></ul><p id="b4e5" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">记住用户在开发dApp时将经历的不同步骤也很重要:</p><ol class=""><li id="20ec" class="of og it lf b lg lh lj lk lz oh ma oi mb oj ly oz ol om on bi translated">他们连接他们的钱包。</li><li id="c512" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">他们请求将交易发送到智能合约。</li><li id="ea82" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">他们签署交易。</li><li id="86fd" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">智能合约检查并处理交易。</li><li id="8565" class="of og it lf b lg oo lj op lz oq ma or mb os ly oz ol om on bi translated">dApp界面显示确认(或错误)消息。</li></ol></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h1 id="3f9b" class="nh md it bd me ni nj nk mh nl nm nn mk jz no ka mn kc np kd mq kf nq kg mt nr bi translated">结论</h1><p id="f15f" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll lz mx lo lp ma my ls lt mb mz lw lx ly im bi translated">在花了几周时间寻找最佳解决方案后，我有信心如果你想在Tezos上构建一个dApp，只要你使用下面的栈就不会出错:【你最喜欢的前端JS框架】/ Ligo / Taquito / TezBridge。</p><p id="a14f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，您对如何在Tezos上构建一个简单的dApp有了更好的了解。这些工具非常容易使用，只要你遵循正确的步骤，就不会出错。</p><p id="5f05" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">同样值得记住的是，在Tezos上开发dApps是一件很新的事情，而且库也在不断更新。Taquito捆绑在您的dApp中，所以这不会是一个问题。但是，例如，TezBridge的一个更新可能会打破你的dApp。因此，关注Tezos社区的发展并相应地更新你的dApp是非常重要的。</p><p id="675b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">您可能已经注意到，我们没有为我们的用户实施任何兑换积分的解决方案—您可以将它视为一个练习！否则，你能为dApp想到什么样的改进？也许React代码中存储的同步状态更好？更多数据验证？更可爱的加载动画？我迫不及待地想看看你做了什么。</p></div></div>    
</body>
</html>