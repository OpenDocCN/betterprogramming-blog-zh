<html>
<head>
<title>Implementing the Viper Design Pattern in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS中实现Viper设计模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/viper-design-pattern-step-by-step-with-example-project-247b3d101a9e?source=collection_archive---------0-----------------------#2022-09-10">https://betterprogramming.pub/viper-design-pattern-step-by-step-with-example-project-247b3d101a9e?source=collection_archive---------0-----------------------#2022-09-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ea18" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">包含示例项目的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b9d80d686a860bb15103fd5e12ba10d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-d2wt7RvAdtIAFMt"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@lazizli?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拉拉·阿兹利</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1210" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">设计模式！在软件世界中，它们对于我们能够在可持续的代码基础上工作是不可或缺的，这样可以防止我们自己编写代码。毒蛇呢？这是一种我们用来开发iOS应用程序的流行设计模式。所以，让我们更好地了解它，踏上长期的冒险之旅。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="21d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi lz translated"><span class="l ma mb mc bm md me mf mg mh di">看来，还能是什么呢？包含用户界面元素并且只能与演示者通信的层。</span></p><p id="0ce5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi lz translated">作为交互者，这一层将我们与现实生活联系起来，同样只与演示者交流。</p><p id="5e8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi lz translated">冤魂，毒蛇的掌上明珠。一切发生的那一层。简而言之，我们连接各层的桥梁。</p><p id="79d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi lz translated"><span class="l ma mb mc bm md me mf mg mh di">E</span>entity(可选)，我们的型号。真的只有模特。我们的结构或类。</p><p id="3fbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi lz translated"><span class="l ma mb mc bm md me mf mg mh di"> R </span>外，毒蛇的bigbang。我们的勇敢层负责模块和所有层(包括它自己)的创建。</p><p id="de50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们遇到了我们的层。是的，是的，他们也很高兴见到你。所以我们准备回答这个问题。</p><h1 id="57ad" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated"><strong class="ak">我为什么应该或不应该使用Viper？</strong></h1><p id="f8bc" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">这里没有诽谤或赞美。只有事实。</p><p id="0525" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从积极的方面开始。</p><ul class=""><li id="ed96" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">Viper非常容易测试。</li><li id="d248" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">Viper很好地提供了代码布局。</li><li id="e895" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">可读性很高。</li></ul><p id="be5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们来看看不好的一面。</strong></p><ul class=""><li id="89fe" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">蝰蛇非常笨重。太多层次太多时间！</li><li id="46d0" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">这很复杂。你可能会迷失在文件夹中。或者你找到确切的路径。</li></ul><p id="6462" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在就来看看这些项目吧。</p><ul class=""><li id="f9a1" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">你想快速发布一个应用。非常快。例如使用SwiftUI。最好不要用。</li><li id="1dc3" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">你已经开始了一个巨大的UIKit项目。需要测试。一定要用。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8516" class="mi mj iq bd mk ml nt mn mo mp nu mr ms jw nv jx mu jz nw ka mw kc nx kd my mz bi translated">了解毒蛇</h1><p id="877e" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">如果你从未做过面向协议的编程，Viper是一个令人头疼的东西。但是一旦你习惯了，它就消失了。这篇文章正是为此而写的。让我们卷起袖子开始吧。</p><p id="a5c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我为此编写了一个应用程序，当您阅读本文时，您可以检查它并了解代码是如何工作的。</p><div class="ny nz gp gr oa ob"><a href="https://github.com/devmehmetates/Viper-Example" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">GitHub-devmehmetates/Viper-示例</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kp ob"/></div></div></a></div><p id="6679" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我认为我们的首要工作是完成我们一直在做的视图层。这里我使用<code class="fe oq or os ot b">UICollectionView</code>的组合布局创建了一个简单的列表视图。即使这样做，我也需要<strong class="ky ir">呈现器</strong>，但是现在让我们在视图控制器中做。</p><h1 id="0d24" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated"><strong class="ak">查看</strong></h1><p id="8d95" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">下面你看到的代码肯定不适合<strong class="ky ir">蝰蛇❌ </strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/d3852edb9a450e717bc13e912fbf7e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*YSvfMvbOSs83iaFol5XDgQ.png"/></div></div></figure><p id="c84c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码给出了相同的输出。已经成功地创建了细胞，并且已经准备好了基础。现在让我们通过保持视图不变来将这段代码传递给Viper。正如我前面提到的，Viper非常积极地使用P.O.P。因此，我们在视图界面的presenter中定义所有视图操作。这样做的目的是为了能够从演示者处访问。我们来看看剪辑版。</p><h1 id="0804" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated"><strong class="ak">毒蛇解✅ </strong></h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="5191" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你正看着一大段代码，你可能不明白会有什么变化。首先，确保这段代码给出相同的输出。我们目前有一个演示者没有出现在背景中，这可能会令人困惑。但是不要担心！一切很快就会明朗。</p><ul class=""><li id="84af" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">第一个变化当然是协议。我们添加了2个函数，并在<code class="fe oq or os ot b">ViewController</code>中定义。我们现在需要做的是在需要的地方调用它。这就是目前的<strong class="ky ir"> </strong> <code class="fe oq or os ot b">presenter.notifyViewDidLoad()</code></li><li id="1671" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">第二个变化是<code class="fe oq or os ot b">numberOf</code>功能。这些功能可能因服务器或本地服务而异。所以这个数字应该由服务器传递给视图。这样，如果有变化，视图可以知道它。</li><li id="afd4" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">最后一个变化是<code class="fe oq or os ot b">setTitle</code>功能。把这个转给演示者的原因其实是一样的。因为我们可以通过服务来设置。</li></ul><p id="1e31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，我们实际上正在做的是分离所有的逻辑操作。与此同时，我们已经为未来编写了代码。虽然这一开始会让它变慢，但以后会加快很多。记住。<strong class="ky ir">视图尚未完成。</strong>现在让我们编写一个服务并创建我们的交互层。</p><h1 id="9cf5" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">交互者、服务和实体</h1><p id="ed9d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">因为这些是相互关联的，所以最好将它们一起处理。Interactor连接服务并为我们处理模型。我们将有一个非常简单的模型和一个负责读取它的服务。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="ae09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，我们有一个相当简单的模型和注册系统。它有阅读和写作的功能。为了让大家理解这一点，请这样想，这是我们为后端操作进行通信的层。我们只发出了一个请求，我们正在获取一个数组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="7ad8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，没什么复杂的。我们首先记录我们的数据，然后读取它。因此，互动者履行了自己的责任。现在让我们来看看所有东西的连接处，即<code class="fe oq or os ot b">Presenter</code>。</p><blockquote class="ox oy oz"><p id="cb72" class="kw kx pa ky b kz la jr lb lc ld ju le pb lg lh li pc lk ll lm pd lo lp lq lr ij bi translated">重要提示:您可以忽略这里的第16行。它的唯一目的是在首次运行应用程序时为您创建一个数据。如果您愿意，分叉应用程序，运行一次并删除这一行。结果将是一样的。</p></blockquote><h1 id="1c92" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">提出者</h1><p id="ed94" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我们真的来到了几乎所有事情都发生的那一层。这一层现在应该看起来像这样。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="cb14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里慢下来！！这一层对蝰蛇来说是最重要的一层，我们有问题要问。这些是我们会问为什么的问题。让我们慢慢解释我们的层。</p><p id="36a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">见协议。它拥有我们在视图控制器上使用的所有功能。它在界面设置中定义，很清楚它们做什么。完美！</p><p id="28db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看一下<code class="fe oq or os ot b">NotifyViewDidLoad</code>函数。“看法？”我们看到了这些表情。这些实际上是我们一开始做的<code class="fe oq or os ot b">viewController</code>界面中的功能。它们在演示者中被触发，效果很好。一切似乎都有了解释。现在让我们继续我们的问题:)</p><ul class=""><li id="ee72" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated"><strong class="ky ir">为什么变量是私有的？</strong>原因是变量代表我们的类。它希望我们对演示者执行毒蛇逻辑运算。如果我们将其留给公共访问，我们可以通过ViewControler直接访问路由器或交互器。我们不应该这样做。</li><li id="cd24" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated"><strong class="ky ir">为什么视图弱而其他强？</strong>原因是<strong class="ky ir">保留周期。</strong>演示者在视图控制器上被严格定义。如果我们也将视图定义为presenter上的strong，这两个类将永远不会离开彼此。对于我们的内存管理来说，这是一次糟糕的经历。其他人呢？你认为这适用于互动者吗？<code class="fe oq or os ot b">Presenter</code>甚至没有定义。如果我们保持它的虚弱，交互作用者将无法找到一个可以抓住的分支，并会消失</li><li id="61c3" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated"><strong class="ky ir">嗯，我明白了类，但是为什么</strong> <code class="fe oq or os ot b"><strong class="ky ir">datas</strong></code> <strong class="ky ir">是私有的呢？</strong>记住这是演示者的逻辑。这与我们的第一个问题相关但不完全相同。如果我们将这些数据作为公共数据打开，我们更有可能“无意中”在视图控制器上执行逻辑操作。比如获得第一批数据:)</li></ul><p id="1391" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我认为我们已经完成了工作中最困难的部分。如果你对保留周期感到困惑，我建议你研究一下。现在，我们可以创建最后的图层并进行最后的编辑。</p><h1 id="c7fe" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">路由器</h1><p id="1047" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">这是整个页面开始的地方。它将创建所有的层，并给我们一个视图。现在应该是这样的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="838d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">快点，这是什么？为什么协议是空的？为什么我们让它空着？</strong>事实上，它完全可以在我们需要的时候随时使用，原因就在于此。请记住，演示者是通过界面创建的。经典的初始化操作和回退<code class="fe oq or os ot b">viewController</code>。</p><p id="55fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">但是，路由器也可以。我将在哪里以及如何使用它？</strong>我为你准备了一个标签栏控制器。当然，它也是用viper创建的。我们必须在标签栏控制器中做一些事情。比如初始化<code class="fe oq or os ot b">ViewController</code>？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="c022" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要在这里混淆。<strong class="ky ir">只关注第18行。我们看到了我们的路由器。我们已经运行了我们的功能。而我们开始了<strong class="ky ir">蝰蛇流。现在我们写的所有代码都是活动的。</strong></strong></p><h1 id="73ce" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">最后润色</h1><p id="a89d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我们已经做了很多操作，但是我们仍然没有将我们的数据处理到视图中。现在是时候定义我们的观点了。为此，我们只需要做2个步骤。</p><ul class=""><li id="97e3" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">第一种是在presenter中通过索引获取数据。</li><li id="6011" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">第二是在小区配置中使用该数据。</li></ul><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="bc20" class="pi mj iq ot b gy pj pk l pl pm"><strong class="ot ir">protocol</strong> HomePresenterInterface: AnyObject {<br/>...<br/>   <strong class="ot ir">func</strong> getDataByIndex(_ index: Int) -&gt; BaseModel?<br/>...<br/>}</span></pre><p id="c238" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们在协议中添加这个函数。所以我们可以通过索引得到一个基础模型。Xcode应该在我们加这个的那一刻就气疯了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pn"><img src="../Images/111479cc439e6b7dafa0ec1c3613833d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1CrjYm7dw-vYaSXosiGlQ.png"/></div></div></figure><p id="2037" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们在不进一步激怒Xcode的情况下完成函数。</p><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="3615" class="pi mj iq ot b gy pj pk l pl pm"><strong class="ot ir">func</strong> getDataByIndex(_ index: Int) -&gt; BaseModel? {<br/>   datas?[index]<br/>}</span></pre><p id="c6ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好，现在让我们来看风景。</p><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="5f1e" class="pi mj iq ot b gy pj pk l pl pm">cell.configureLabels(with: presenter?.getDataByIndex(indexPath.row))</span></pre><p id="6deb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，这是一条线，工作完美无缺。现在让我们打开我们的应用程序。我们应该会看到我们的数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/94d06e16e6a2da155e226f4f4d5d6f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*gmI_YWgFULpDM05l_GxqCg.png"/></div></div></figure><p id="0757" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太棒了。<strong class="ky ir"> </strong>这样，我们就完成了我们的申请。当然，如果我们编写了Viper，而不是如果我们没有为我们的应用程序编写测试。来吧，你不累。让我们也写我们的单元测试，这一切都结束了。</p><h1 id="dee9" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">单元测试</h1><p id="1a23" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我们将为这一部分做一些非常酷的事情。我想让你回顾一下这个<a class="ae kv" href="https://github.com/seanhenry/SwiftMockGeneratorForXcode" rel="noopener ugc nofollow" target="_blank">链接</a>。我想你可以轻松安装。这很简单。如果您已经成功完成了安装，让我们包括我们的项目并继续。在此之前，让我解释一下我们为什么这样做。</p><p id="66ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们用mock概念复制要测试的类，由于我们已经设置了生成器，我们可以在协议的帮助下在几秒钟内执行测试操作。所以让我们开始吧。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="74d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们是不是突然惊呆了？不要担心，这是一个您将自动创建的文件。所以它是由上面链接的模拟生成器创建的。</p><p id="829b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">如果你不明白这是怎么做到的:)</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi po"><img src="../Images/540c520644f66e706000eb212e3fe39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_Azggtg6wLc_EcjzfiZBA.png"/></div></div></figure><p id="93d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们来谈谈我们为什么要创建它，以及我们将如何使用它。看一下interactor文件来记住。协议中只有一个变量。在模拟文件中，保存了测试所需的变量。在这里迷茫很正常。现在，当我创建一个单元测试并对其进行详细说明时，您将会非常清楚地理解它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="7c74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，您可能会注意到其他类也有模拟类。仅演示者除外。我们把它命名为毒蛇的苹果，因为我们在这里做所有的事情。我们把它命名为毒蛇的苹果，因为我们在这里做所有的事情。</p><p id="9a10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在理解这个短语。通过将我们的模拟类提供给路由器，我们可以模拟presenter中定义的层。这样，通过presenter触发的视图类将被模仿，我们将能够测试它。因为单元测试的目的是检查一个函数是否触发了一个类。</p><p id="03a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了，现在让我们回顾一下我们的测试。首先，调用presenter函数并触发视图模拟类。因此，模拟类中的变量发生了变化，我们的测试成功了。让我们仔细看看这个函数。</p><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="5004" class="pi mj iq ot b gy pj pk l pl pm"><strong class="ot ir">func</strong> testNotifyViewDidLoad() {<br/>   <strong class="ot ir"> homePresenter.notifyViewDidLoad()</strong><br/>    XCTAssertTrue(homeView.invokedSetupView)<br/>    XCTAssertTrue(homeView.invokedSetTitle)<br/>}</span></pre><p id="1cbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的第一行中，我们从演示者那里触发一个函数。该函数如下所示:</p><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="af54" class="pi mj iq ot b gy pj pk l pl pm"><strong class="ot ir">func</strong> notifyViewDidLoad() {<br/>    <strong class="ot ir">view?.setupView()<br/>    view?.setTitle(with: "Home")</strong><br/>    fetchDatas()<br/>}</span></pre><p id="54d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，我们的函数是由视图中定义的两个函数触发的。下面是我们模拟类中的函数！出于这个原因，我们去检查我们的模拟类中的变量是否为真，这样我们就可以确保它被触发。这是我们的目标。为了更清楚地看到它并理解事件，您可以自己更新函数，如下所示，并重新测试。</p><pre class="kg kh ki kj gt pe ot pf pg aw ph bi"><span id="041e" class="pi mj iq ot b gy pj pk l pl pm"><strong class="ot ir">func</strong> testNotifyViewDidLoad() {<br/><strong class="ot ir">    XCTAssertFalse(homeView.invokedSetupView)<br/>    XCTAssertFalse(homeView.invokedSetTitle)   </strong><br/>    homePresenter.notifyViewDidLoad()<br/>    XCTAssertTrue(homeView.invokedSetupView)<br/>    XCTAssertTrue(homeView.invokedSetTitle)<br/>}</span></pre><p id="a68c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试仍然会成功</p><h1 id="b46d" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">关闭</h1><p id="c9ba" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">而你以飞快的脚步进入了毒蛇的世界。分叉项目，这样整篇文章就会浮现在脑海中。然后玩一玩，试着发现变化。</p><p id="df94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我想让你经历一些情况。</strong></p><ul class=""><li id="45c1" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">为了更好地理解演示者上弱的概念，添加和删除弱。用断点跟踪引用和对象。</li><li id="ff9f" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">编辑<code class="fe oq or os ot b">Interactor</code>、<code class="fe oq or os ot b">Entity</code>和<code class="fe oq or os ot b">Service</code>。舞台是你的。可以这样从网上打印一个数据吗？如果事情可以分类就好了:)</li><li id="d43a" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">创建排序算法。这将使你清楚如何使用演示者。</li></ul><p id="d754" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一切都是你做的。你想确保它是正确的。别担心，我当然也考虑过这个问题。检查树枝！您将看到一个名为“高级”的分支。去结帐并检查您的解决方案。</p><h1 id="b75e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">注意</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pp"><img src="../Images/cc85f265708a235b2c89889c1cecf7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEjHm-dDSBGG7ei-h8Hxmg.png"/></div></div></figure><p id="37ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在高级分支中，应用程序将以这种状态出现。数据完全通过互联网来获取和更新。你还有很多可以改进的地方。可以试试:)</p><h1 id="f5fb" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">资源</h1><p id="1755" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">一篇我明确推荐并作为<a class="ae kv" href="https://medium.com/trendyol-tech/creating-an-ios-viper-module-step-by-step-guide-cd1f414b7dd3" rel="noopener">例子</a>的文章。</p><p id="9e9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还要感谢我的导师，他在我准备这篇文章的时候给了我支持，🥹</p></div></div>    
</body>
</html>