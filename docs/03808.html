<html>
<head>
<title>How to Set the iOS and Android App Version Through a Local File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过本地文件设置iOS和Android应用版本</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/setting-ios-and-android-app-version-through-a-file-e95cec9573b2?source=collection_archive---------11-----------------------#2020-03-05">https://betterprogramming.pub/setting-ios-and-android-app-version-through-a-file-e95cec9573b2?source=collection_archive---------11-----------------------#2020-03-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1f0a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在一个地方更新您的版本和内部版本号</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/609a2abbf6f78bdfd6ccc7fcda958a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVxXFHBx-aLRFQWzhnpqsg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Maksym Kaharlytskyi 在<a class="ae ky" href="https://unsplash.com/s/photos/file?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a4eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当我们想要上传一个新版本的应用程序时，我们需要手动编辑多少次版本(Android版为<code class="fe lv lw lx ly b">build.gradle</code>, iOS版为<code class="fe lv lw lx ly b">Info.plist</code>)?这是一项令人生畏的工作！</p><p id="292c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果它在一个文本文件中，我们可以编写一个脚本来自动更新它(并根据回购协议检查更新，并运行所有需要的步骤来自动发布应用程序)，那该有多好？</p><p id="76a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我将向您展示如何获取文件中的应用程序版本。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="aa12" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在安卓系统中</h1><p id="bc64" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这相对简单。在应用程序的<code class="fe lv lw lx ly b">build.gradle</code>文件中，将<code class="fe lv lw lx ly b">versionName</code>设置为一个函数名，比如<code class="fe lv lw lx ly b">getVersionName()</code>。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="6880" class="nh mh it ly b gy ni nj l nk nl">defaultConfig <strong class="ly iu">{<br/>    </strong>applicationId "com.elyeproj.fileversion"<br/>    minSdkVersion 21<br/>    targetSdkVersion 29<br/>    versionCode 1<br/>    versionName <strong class="ly iu">getVersionName()</strong><br/> <strong class="ly iu">}</strong></span></pre><p id="d555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在同一个<code class="fe lv lw lx ly b">build.gradle</code>文件中，编写从文件中读取版本的函数，如下所示。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="7812" class="nh mh it ly b gy ni nj l nk nl">static def getVersionName() {<br/>    return new File("./app/versionName").getText().trim()<br/>}</span></pre><p id="1a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，相应地创建文件。在我们的例子中，应该是<code class="fe lv lw lx ly b">./app/versionName</code>。在我的示例代码中，我写了<code class="fe lv lw lx ly b">10.10</code>。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="1081" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在iOS中</h1><p id="6a8d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们需要设置<code class="fe lv lw lx ly b">.xconfig</code>文件来获取应用程序版本。</p><p id="cfc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过新建文件对话框窗口创建一个新的配置文件来实现。选择配置设置文件，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/cd955b70a3a0aa3e7c122d2ad00f548a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pos4I-8TwsG0plCIKzSl7Q.png"/></div></div></figure><p id="f9da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建文件后，使用指向它的键将应用程序版本写入其中，例如<code class="fe lv lw lx ly b">APP_VERSION = 10.10</code>(这是我在下面的代码示例中编写的)。</p><p id="eca4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，转到<code class="fe lv lw lx ly b">Info.plist</code>文件，按照如下所示键入密钥(在我的例子中是<code class="fe lv lw lx ly b">APP_VERSION</code>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/4cc8983bd10d2ce654433b9ff943e8ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jkfyHJuZSyuKGdjqnOYqg.png"/></div></div></figure><p id="7c22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，转到项目的信息设置页面，进入配置部分添加您的配置，如下图所示。对发布版本和调试版本都这样做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/993f76ceb9e6b324bc48cfbd86b28fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_epomMMWIBVYPS7cZLpIQ.png"/></div></div></figure><p id="d6f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您可以通过下面的Identify部分来检查版本，您将看到版本根据您的配置文件中的内容进行了更新。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/8db7e77134566197ba956a5865b50655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h6QrWozHCgnYUQY_m4qyMA.png"/></div></div></figure><p id="b34b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">附加说明:</strong>如果你的配置文件有很多变量，你想分离出版本变量，你可以在有很多变量的配置文件上使用<code class="fe lv lw lx ly b">#include “VersionFile.xcconfig”</code>，创建另一个名为<code class="fe lv lw lx ly b">VersionFile.xcconfig</code>的文件，只包含版本变量。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6ca7" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="1b4f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这样，您的Android和iOS版本名称值现在位于一个单独的文件中。您可以编写一个Bash脚本来自动更新它，并执行必要的更新自动化和发布过程。</p><p id="bd79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以从以下位置获取代码示例:</p><div class="nq nr gp gr ns nt"><a href="https://github.com/elye/demo_ios_android_file_app_version" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">elye/demo _ IOs _ Android _ file _ app _ version</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">展示了如何在一个文件中为iOS和Android设置应用版本</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">github.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh ks nt"/></div></div></a></div><p id="043c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">享受自动化！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure></div></div>    
</body>
</html>