<html>
<head>
<title>Image Style Transfer CoreML Model Training</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像风格转换CoreML模型训练</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/image-style-transfer-a510edcb2aa5?source=collection_archive---------13-----------------------#2022-06-13">https://betterprogramming.pub/image-style-transfer-a510edcb2aa5?source=collection_archive---------13-----------------------#2022-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9a88" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用CreateML和Turi Create</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/439af8c7dda67c11e77922f4faae1834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nKzKUKMPWeudJeRd"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> CHUTTERSNAP </a>拍摄</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/5355e851e252783dcf261c3ea3d5bdd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*aGZVO-rXySjSvFdbgGt-oQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内容图像。黄色拉布拉多寻找，从维基共享精灵。许可证CC BY-SA 3.0</p></figure><p id="7bd9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">给定两个图像，样式转移技术允许您在保留内容的同时将样式从一个图像转移到另一个图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/5355e851e252783dcf261c3ea3d5bdd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*aGZVO-rXySjSvFdbgGt-oQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内容图像。黄色拉布拉多寻找，从维基共享精灵。许可证CC BY-SA 3.0</p></figure><p id="2f99" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成的图像将由第一个图像的内容(内容图像)与第二个图像的样式(样式引用)合并而成，如下所示:</p><div class="kg kh ki kj gt ab cb"><figure class="lt kk lu lv lw lx ly paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/0c3aaa613c76575af0fe7777bdae002c.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*Ih7JPhN9hw29cTHY8zR-wg.jpeg"/></div></figure><figure class="lt kk lz lv lw lx ly paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b6baf928379f37ab4ccbe607c28e119e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*v8vEIGhL8n0thYH6jMlSLw.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk ma di mb mc translated">风格参考。</p></figure></div><p id="f4fe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文中，我们将学习如何创建一个机器学习模型，并训练它应用风格转移技术。我们将使用两种方法，使用CreateML和Turi Create。</p><h1 id="dcf9" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">创建ML</h1><p id="33ce" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated">要使用Create ML，必须安装Xcode。安装后，打开创建ML，方法是从菜单栏转到Xcode &gt;打开开发者工具&gt;创建ML。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/50638f0ddd2b0c20be55599852e3c700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*SCzcCzHjKc1UYXwOgoO_qg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Xcode菜单栏。</p></figure><p id="ff62" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">点击新建文档。从可用模板中选择“风格转换”。单击下一步。为项目选择一个名称，然后单击下一步。选择一个文件夹来保存您的项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/629fece566b2a8c2cebdd263c5e3d2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kUgSRJ7hR37wpVF77n1o1g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">空核心ML样式转移项目</p></figure><p id="082e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要创建和训练模型，您需要:</p><ul class=""><li id="c8c7" class="nc nd iq kz b la lb ld le lg ne lk nf lo ng ls nh ni nj nk bi translated">训练风格图像:包含要转换的风格的图像。</li><li id="33bb" class="nc nd iq kz b la nl ld nm lg nn lk no lo np ls nh ni nj nk bi translated">验证图像:将接收样式的图像。</li><li id="5139" class="nc nd iq kz b la nl ld nm lg nn lk no lo np ls nh ni nj nk bi translated">内容图像:用于训练模型的一组示例图像。</li></ul><p id="27fb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于内容图像，我们将使用一个图像库<a class="ae kv" href="http://images.cocodataset.org/zips/val2017.zip" rel="noopener ugc nofollow" target="_blank"> val2017 </a>。下载并解压缩文件。将图像加载到项目中。点击火车。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/71ff0d8b42b66bf4a3902d486d9d0091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKsJXKSZOO-GAbAWEEYkQw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建ML项目时加载的培训样式、验证和内容图像。</p></figure><p id="31bd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">耐心点。培训可能需要几个小时。随着模型被训练，我们可以在我们的验证图像中跟踪结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/a9e5cc5f5e624fb69869070992f712d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*agvayHM59GAIZK2wg60glQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建ML培训流程</p></figure><h1 id="e12b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">Turi创建</h1><p id="207b" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated">我们可以使用<a class="ae kv" href="https://github.com/apple/turicreate" rel="noopener ugc nofollow" target="_blank"> Turi Create </a>和<a class="ae kv" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Colab </a>来加速样式转换模型的创建。</p><blockquote class="nq nr ns"><p id="1afc" class="kx ky nt kz b la lb jr lc ld le ju lf nu lh li lj nv ll lm ln nw lp lq lr ls ij bi translated">“Turi Create简化了定制机器学习模型的开发。你不必成为机器学习专家，就可以在你的应用程序中添加推荐、对象检测、图像分类、图像相似性或活动分类。”</p><p id="7dd8" class="kx ky nt kz b la lb jr lc ld le ju lf nu lh li lj nv ll lm ln nw lp lq lr ls ij bi translated">—<a class="ae kv" href="https://github.com/apple/turicreate" rel="noopener ugc nofollow" target="_blank">https://github.com/apple/turicreate</a></p><p id="f792" class="kx ky nt kz b la lb jr lc ld le ju lf nu lh li lj nv ll lm ln nw lp lq lr ls ij bi translated">“Colaboratory，或简称为“Colab”，是谷歌研究院的产品。Colab允许任何人通过浏览器编写和执行任意python代码，特别适合机器学习、数据分析和教育。从技术上来说，Colab是一种托管的Jupyter笔记本服务，无需设置即可使用，同时提供对包括GPU在内的计算资源的免费访问。”</p><p id="6a40" class="kx ky nt kz b la lb jr lc ld le ju lf nu lh li lj nv ll lm ln nw lp lq lr ls ij bi translated">——【https://research.google.com/colaboratory/faq.html T4】</p></blockquote><p id="04c2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">去Collab。在菜单栏上，转到运行时&gt;更改运行时类型。在硬件加速器下选择GPU。单击保存。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/8f04e5b305d2940474a45123e3ddb1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*MyyWkzoH0-FJNiSWTQy_tQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Colab运行时类型</p></figure><p id="3b59" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">用下面的代码创建一个代码块。该模块将负责配置参数和下载图像数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><ul class=""><li id="c8b0" class="nc nd iq kz b la lb ld le lg ne lk nf lo ng ls nh ni nj nk bi translated"><code class="fe oa ob oc od b">image_data_set</code> : val2017或Selfie-dataset用作内容图像。</li><li id="e257" class="nc nd iq kz b la nl ld nm lg nn lk no lo np ls nh ni nj nk bi translated"><code class="fe oa ob oc od b">style_folder</code>:保存训练风格图像的文件夹。</li><li id="0615" class="nc nd iq kz b la nl ld nm lg nn lk no lo np ls nh ni nj nk bi translated"><code class="fe oa ob oc od b">test_folder</code>:你的验证图片。</li><li id="74f2" class="nc nd iq kz b la nl ld nm lg nn lk no lo np ls nh ni nj nk bi translated"><code class="fe oa ob oc od b">model_name</code>:名称。模型和。mlmodel文件。</li></ul><p id="61d8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将您的训练风格图像(您可以使用多个图像)和验证图像上传到您的Colab文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/78b8cef6c58d51ae55d2b0022317b6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*IIrS_XRpNjApbVGo30gOEQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Colab文件</p></figure><p id="3c56" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">用下面的内容创建第二个代码块。我们将安装Turi Create和TensorFlow。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="9bfd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">用下面的代码创建第三个块。这负责创建模型和执行训练。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="ab2d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">应用于验证图像的训练模型的结果在训练过程结束时示出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3b648ef897e6b6703c5be7fe3a9346bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*sh60z_lZuY5dldHbJDj3eA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">验证图像</p></figure><h2 id="2cee" class="og me iq bd mf oh oi dn mj oj ok dp mn lg ol om mp lk on oo mr lo op oq mt or bi translated">结果</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">完整的colab笔记本</p></figure></div></div>    
</body>
</html>