<html>
<head>
<title>How to Use Python and the NBA API to Create a Simple Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python和NBA API创建一个简单的回归模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-pythons-nba-api-to-create-a-simple-regression-model-ac9a3b36bc8?source=collection_archive---------4-----------------------#2020-03-20">https://betterprogramming.pub/using-pythons-nba-api-to-create-a-simple-regression-model-ac9a3b36bc8?source=collection_archive---------4-----------------------#2020-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5245" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索NBA数据的初级Python项目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/045615ef824aee35ea1d8cf157257670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fLzkfqdj5hSMTY9y"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@echaparro?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">埃德加·恰帕罗</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄。</p></figure><p id="d746" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去的十年里，统计数据的使用从根本上改变了NBA。球队正在使用几十种先进的衡量标准来衡量他们的球员表现如何，并预测未来大学前景如何。统计数据也有助于教练理念的转变。例如，中距离跳投已经消失，取而代之的是三分球。探索这些篮球统计数据确实很有趣，但是对于一个初学Python的程序员来说却是个挑战。</p><p id="cef4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个项目，我们将使用NBA赛季统计数据来建立一个基本的线性回归模型。我们的<code class="fe ls lt lu lv b">x</code>变量将是投篮次数(FGA ),而<code class="fe ls lt lu lv b">y</code>变量将是每个球员每场比赛的平均得分(PPG)。我们将使用赛季平均值，而不是每场比赛都有一行。这样，每一行代表一个球员的赛季平均水平。</p><p id="22a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个项目中，我们将通过关注如何使用nba_api包进行API调用以及如何使用Scikit-learn创建线性回归来保持事情的简单。我们的最终产品将是一个可视化和模型，它将帮助我们理解尝试投篮和得分之间的关系。幸运的是，这是一个相当线性的关系。将来，我们可以通过包含更多变量、优化模型参数或选择一个更有趣的<code class="fe ls lt lu lv b">y</code>变量来扩展模型。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e9d5" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">链接到GitHub</h1><p id="25f2" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我们已经创建了一个GitHub项目，你可以在这里找到。</p><p id="f98f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该项目包含一个笔记本，您可以跟随它以及一个空Python文件，您可以使用该文件作为模板来完成项目。我们建议遵循这里的教程，自己输入代码，而不是复制粘贴。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="8244" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">先决条件</h1><p id="9e24" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">你一定很乐意下载一些软件包。</p><h2 id="f086" class="na me iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">包装</h2><ul class=""><li id="d8a8" class="nm nn iq ky b kz mv lc mw lf no lj np ln nq lr nr ns nt nu bi translated">熊猫</li><li id="0d13" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><a class="ae kv" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a></li><li id="11d6" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">Sklearn</li><li id="4486" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">要求</li><li id="a07f" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><a class="ae kv" href="https://pypi.org/project/nba-api/" rel="noopener ugc nofollow" target="_blank"> nba_api </a></li><li id="8cd1" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><a class="ae kv" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a></li></ul></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="f1be" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">使用nba_api加载数据</h1><p id="2d4a" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我们将使用nba_api库来获取当前nba赛季的数据。这个库对任何从事篮球项目的人都很有帮助。它通过处理幕后的繁重工作，简化了从NBA官网获取数据的过程。你应该可以从NBA 收集的<a class="ae kv" href="https://github.com/swar/nba_api/tree/master/docs/nba_api/stats/endpoints" rel="noopener ugc nofollow" target="_blank">大量数据集中找到你需要的任何篮球数据。我们将使用它来获取当年的赛季得分数据。</a></p><p id="1563" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步是导入我们所有的包。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="c9d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们所有的包都准备好了，我们必须请求nba_api来下载我们的数据集。我们想要关于季节总数的信息，所以我们使用<code class="fe ls lt lu lv b">LeagueLeaders()</code>函数。如果您想请求另一个数据集，只需浏览<a class="ae kv" href="https://github.com/swar/nba_api/tree/master/nba_api/stats/endpoints" rel="noopener ugc nofollow" target="_blank">端点文件夹</a>，直到找到您需要的数据。然后，您可以使用与下面相同的结构通过用适当的条目替换<code class="fe ls lt lu lv b">LeagueLeaders()</code>来发出请求。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="d120" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们的数据被导入，使用Panda的<code class="fe ls lt lu lv b">.head()</code>函数读取数据集的前五行会很有帮助。这确保了数据集正确加载，一切都按计划进行。</p><pre class="kg kh ki kj gt oc lv od oe aw of bi"><span id="b25d" class="na me iq lv b gy og oh l oi oj"><em class="ok"># take a sneak peak at the first 5 rows</em><br/>df.head()</span></pre></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="6875" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">建立一个简单的回归模型</h1><p id="1a35" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">通过几行代码，我们现在有了NBA所有466名球员的赛季总数。现在我们可以用sklearn建立一个线性回归模型。我们的数据中有很多很好的信息，但我们只需要两个变量:投篮命中率(FGA)和总得分。因此，我们将隔离这些数据，并从那里开始构建。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h2 id="3dd1" class="na me iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated"><strong class="ak">功能模型</strong></h2><p id="d55b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">在上面的几行代码中，我们创建、训练了一个线性回归模型，并进行了预测。如果我们想要一个更健壮的模型，我们通常会在数据选择和模型创建过程中多采取一些步骤。首先，在训练之前，我们通常会尝试可视化我们的数据，清理它，并做一些功能工程。特征工程是一个用我们已有的数据创造新变量的时髦词。这样，我们知道我们正在使用<code class="fe ls lt lu lv b">x</code>变量的质量选择来预测我们的<code class="fe ls lt lu lv b">y</code>变量。</p><p id="de7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二，我们通常希望在一组未用于训练模型的测试数据上测试模型的准确性。我们这样做是为了确保我们的模型不会过度拟合。过度拟合模型擅长对训练数据进行预测，但对新数据的预测不那么准确。这没什么用，因为我们不需要对已经有的数据进行预测。</p><p id="27f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决方法是交叉验证。通常，为了交叉验证，我们将原始数据分成两个不同的集合。首先，我们的训练数据将包含原始数据的85%的随机样本。测试集将包含剩余的15%。我们使用训练数据进行训练，然后通过对测试数据的准确性进行评分来测试真实世界的性能。很简单。</p><h2 id="6bb8" class="na me iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">可视化我们的结果</h2><p id="8cdc" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">可视化您的模型总是一个好的做法，这样您就可以看到它是如何执行的。使用实际<code class="fe ls lt lu lv b">y</code>值的散点图和预测<code class="fe ls lt lu lv b">y</code>值的直线可以很容易地显示线性回归。我们将使用Matplotlib——最流行的可视化软件包——但是也有一些替代方案。</p><p id="49a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了可读性，我们将逐行创建我们的图表。每一行代码都会给我们的图表增加一个新的特性。这包括像我们的散布点或我们的标签。</p><p id="a3e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能需要根据您完成本项目的赛季中球员的得分数字来更改文本的位置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="5c29" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="5bcb" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">不出所料，如果一个篮球运动员在比赛中投篮次数多，他们往往得分就多。这是一个显而易见的想法，我们的图表帮助我们形象化:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/bfca3365e1f4f0da796b5e8429f71e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGaPdz495iEa0sYqIsXJxQ.png"/></div></div></figure><ul class=""><li id="768f" class="nm nn iq ky b kz la lc ld lf om lj on ln oo lr nr ns nt nu bi translated">我们可以直观的看到联盟大部分球员场均出手7次甚至更少。</li><li id="e590" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">每场比赛出手次数多(17次以上)的球员开始比模型预测的表现更好。</li></ul><p id="9f27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以这样想:让真正擅长得分的球员多出手。这些运动员比一般人更有效率。因此，我们的线性模型并不擅长预测他们的得分。</p><h2 id="ce32" class="na me iq bd mf nb nc dn mj nd ne dp mn lf nf ng mp lj nh ni mr ln nj nk mt nl bi translated">恭喜你！</h2><p id="c69b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">利用你从这个项目中学到的东西，你应该能够开始探索NBA.com其他有趣的数据集。一个好的第一步是扩展这个模型。尝试包含更多的<code class="fe ls lt lu lv b">x</code>变量，看看这如何改变预测或拟合线。</p></div></div>    
</body>
</html>