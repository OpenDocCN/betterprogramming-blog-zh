<html>
<head>
<title>App Clips in iOS14 — Mobile Apps Made Instant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS14中的应用剪辑——即时移动应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/app-clips-in-ios14-swift-wwdc20-e10bb4280259?source=collection_archive---------10-----------------------#2020-07-06">https://betterprogramming.pub/app-clips-in-ios14-swift-wwdc20-e10bb4280259?source=collection_archive---------10-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab98" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">WWDC20 Swift会议演练</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f58435bcf18545dc42289e4bd0a419e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRx5tCXHdfylF_u04ERe7w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过<a class="ae ky" href="https://developer.apple.com/documentation/app_clips" rel="noopener ugc nofollow" target="_blank">苹果开发者文档</a>的说明</p></figure><p id="e784" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">本文是WWDC20届</em><a class="ae ky" href="https://developer.apple.com/videos/play/wwdc2020/10174/" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a><em class="lv">的简短文字总结。</em></p><p id="177a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">iOS 14中引入了应用剪辑，通过几乎即时下载应用的一部分来完成一些任务，帮助更多人在旅途中发现应用。</p><p id="4c4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与应用程序不同，应用程序剪辑不能从主屏幕打开。他们推出了应用程序剪辑网址，通过应用程序剪辑而不是浏览器来处理。这些URL可以嵌入到<code class="fe lw lx ly lz b">NFC</code>标签中，处理成二维码/app-clip码(可以用<code class="fe lw lx ly lz b">NFC</code>，FYI的力量扫描或点击)，或者只是通过iMessages转发。</p><p id="70c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">App Store提交的应用程序剪辑必须非常小，小于10 MB。以前，应用程序在使用前需要安装、登录和设置。应用程序剪辑使人们可以扫描二维码，几乎立即下载你的应用程序剪辑来使用它，使它成为一个整体更流畅的体验。</p><p id="96bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于开发人员来说，应用程序剪辑需要在Xcode中创建第二个应用程序目标，其中包含处理应用程序剪辑体验所需的所有代码。这是用SwiftUI或UIKit编写的原生Swift代码，意味着您可以将应用程序现有代码的一部分用于应用程序剪辑。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/f71b07b063343d8e21e095b8a6d8be0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgFfTxVw2uR0BdVwXARgYg.png"/></div></div></figure><p id="ed6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序剪辑是应用程序的附加功能，这意味着您需要一个应用程序来制作应用程序剪辑。应用程序剪辑不能自行提交到应用程序商店。它们需要作为应用审查流程的一部分提交。</p><p id="e82e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">iOS 14中的应用程序剪辑和应用程序是互斥的——下载应用程序剪辑而不下载整个应用程序是可能的，这是整个要点。但是，如果已经安装了应用程序，应用程序剪辑URL将打开应用程序的相关部分，而不是下载应用程序剪辑。</p><p id="97f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个应用程序只能有一个应用程序剪辑，可以配置URL来打开应用程序的特定部分。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="4667" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">应用程序剪辑的应用程序设计</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/dd0a165d6f2040d78bc8835e8467c3e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GIibjO1IPg_Wy0k8xaO5Fg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">典型应用图WWDC20“探索应用剪辑”会议的04:38</p></figure><p id="8d79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与应用程序不同，应用程序包含一个标签栏控制器，允许用户在不同的屏幕之间导航，应用程序剪辑应该省略像标签栏这样的顶级导航元素，而是将用户导向单个流程，从而允许用户根据URL执行特定的任务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/4ec048b186ff00038b257b2a4e0c01e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cy7-pUNQo1s0kL7fzY_dLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对不同的流使用多个URL的相同应用程序剪辑WWDC20“探索应用程序剪辑”会议的06:00</p></figure><p id="8442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于多种体验，可以有多个URL——每个URL打开一个流线型的流程。</p><p id="90f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，应用程序剪辑对用户位置的依赖性可以被推迟。例如，如果用户试图从实体店结账，而不是向用户询问他们的位置来定位他们所在的商店，则可以配置该商店的URL，以便应用程序剪辑知道用户在哪个商店。</p><p id="707a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在“身份”检查器的“目标成员资格”下，应用程序和应用程序剪辑之间通用的代码部分可以同时选择应用程序和应用程序剪辑目标。对于共享图像资源，您可以创建一个共享资源目录，并对目标成员资格进行类似的修改，以确保应用程序和应用程序剪辑都使用同一共享文件夹中的图像。</p><p id="e9ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能在你的应用程序中需要一个类，但在你的应用程序剪辑中不需要，如果两者共有的代码使用这个类，就会导致构建错误。<br/>在这种情况下，您需要通过在构建设置&gt; Swift编译器-定制标志部分为调试和发布创建一个定制条件，有条件地编译出对该类的引用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/825361002b5e160744be2982d660e3b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-GTAzhSONKuDzX_7vUI8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://developer.apple.com/videos/play/wwdc2020/10174/" rel="noopener ugc nofollow" target="_blank"> WWDC20“探索应用程序剪辑”会议的10:00</a></p></figure><p id="96cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以有条件地编译出对对象的引用，这些引用不会包含在应用程序剪辑中，方法是:</p><p id="f81a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lw lx ly lz b">#if !APPCLIP<br/> //Code which runs on app but not on appClip<br/>#endif</code></p><p id="00ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">App clips可以使用iOS SDK中的所有框架，但是对敏感数据的访问受到限制。像HealthKit这样的框架在作为应用程序剪辑运行时，对于<code class="fe lw lx ly lz b">isHealthDataAvailable</code>(布尔表示访问健康数据)将总是返回负值。因此，在尝试使用数据之前，主应用程序应该检查对数据的访问。如果做到了这一点，应用程序剪辑将运行良好。</p><p id="728d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦用户使用应用程序剪辑并安装完整的应用程序，就可以通过共享数据容器将数据从应用程序剪辑自动填充到完整的应用程序，从而实现无缝体验。虽然这不是强制的，但是强烈推荐。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="a8c2" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">关于App-Clip生命周期的更多信息</h1><p id="a62d" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">应用程序剪辑在需要时运行-当应用程序未安装且应用程序剪辑体验打开时。一段时间不活动后，它们会自动与该应用程序剪辑相关的数据一起删除。应用程序片段也不包括在iCloud备份中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/882f6b44f02a32d804eb377d0f748275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phIGT4CcMM_wDq2iZE-_Ew.png"/></div></div></figure><p id="eb39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不活动后，可以随时删除应用程序剪辑。储存的数据也会随任何钥匙串数据一起被删除。因此，这种存储的数据应该被认为是临时缓存的数据，除非数据存储在共享数据容器中，并且用户还在应用剪辑被删除之前安装了完整的应用。</p><p id="8d33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果用户经常使用该应用程序剪辑，则该应用程序剪辑可能永远不会被删除。之前会话中的缓存数据可以在下一个会话中使用，例如，如果应用程序剪辑是为在当地实体店购物而设计的，则过去的订单可以用于推荐未来的订单。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/945ae2c282a2738cf85fc188b47278c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tol6uGdzuVDDxBQQueIp-w.png"/></div></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="598e" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">App-Clip体验</h1><p id="e5f8" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">苹果希望应用程序剪辑快速、直截了当，尽可能减少隐私问题，并尽可能减少障碍。</p><p id="730c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，获取个人数据是有限的。如果需要访问受限数据，应用程序剪辑可以提示用户下载完整的应用程序。</p><p id="7df3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于支付，建议使用Apple Pay，因为用户不需要输入卡的详细信息或担心其安全性。</p><p id="6e4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注册应该是可选的，因为用户将被迫输入他们的详细信息，而不是享受体验。相反，它可以在用户完成体验后以“以苹果身份登录”的方式呈现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/a8ca020c43f71e016090c4620e43b4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hywa8uDh5Mvc-nMY3XsSog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">WWDC20“探索应用程序剪辑”会议的18:12</p></figure><p id="dd06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要将app clip用户转换为安装完整应用，可以使用<code class="fe lw lx ly lz b">SKOverlay</code>—或者在SwiftUI应用的情况下使用App Store覆盖修改器。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="ff3c" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">总结</h1><p id="604f" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">iOS 14中引入的应用程序剪辑是新用户体验应用程序一部分的好方法。它们不会显示在主屏幕上，但可以通过iMessage上的URL、苹果的app-clip代码或Safari上的横幅来调用。</p><p id="44d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个应用程序只能有一个应用程序剪辑；然而，它可以通过不同的URL显示多种体验。无论是在SwiftUI还是UIKit中编码，您都可以拥有与应用程序剪辑相同的应用程序代码，这只是应用程序的一个扩展。将应用程序剪辑提交给审核流程时，其大小应小于10 MB。</p><p id="b27e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序的小尺寸，加上预定义的流程，使用户可以轻松流畅地体验应用程序的一部分，从而让您有机会将他们转换为应用程序安装。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="d9af" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">资源</h1><ul class=""><li id="c385" class="nl nm it lb b lc nd lf ne li nn lm no lq np lu nq nr ns nt bi translated"><a class="ae ky" href="https://developer.apple.com/documentation/app_clips" rel="noopener ugc nofollow" target="_blank">苹果开发者文档</a></li><li id="b669" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://developer.apple.com/videos/play/wwdc2020/10172" rel="noopener ugc nofollow" target="_blank">“设计优秀的应用程序剪辑”视频</a></li><li id="844e" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://developer.apple.com/videos/play/wwdc2020/10146" rel="noopener ugc nofollow" target="_blank">“配置并链接您的应用程序剪辑”视频</a></li></ul></div></div>    
</body>
</html>