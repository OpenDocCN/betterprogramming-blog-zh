<html>
<head>
<title>Functional Solutions for Classes in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中类的函数式解决方案</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/functional-solutions-for-classes-in-javascript-7116d12be6b6?source=collection_archive---------11-----------------------#2020-01-21">https://betterprogramming.pub/functional-solutions-for-classes-in-javascript-7116d12be6b6?source=collection_archive---------11-----------------------#2020-01-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dc4f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在JavaScript中处理对象的更好方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f53dd8d312f1917fe53edecc9addd04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CXQriZfRwMENayAp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jaimespaniol?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">海梅·斯巴尼奥</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="2cee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JavaScript不是经典的面向对象语言。它是面向原型的。他们都旨在用不同的方式解决同样的问题。两者各有利弊。</p><p id="ca9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是由于历史原因，JavaScript需要看起来和感觉上像Java，正如你从名字中看到的那样。出于各种原因，主要是市场营销，即使没有类，它也需要具有与Java相似的面向对象的特性。</p><p id="c467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在ES2015中，JavaScript中终于引入了类语法。一场大狂欢！但是这种快乐并没有持续多久，因为它只是对原型遗传的一种掩饰。</p><p id="dbd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样的怪癖仍然存在，尽管用JavaScript的类来编写和阅读OOP要容易得多。</p><p id="3d2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有很多关于在JavaScript中使用类的讨论。很多人建议避免使用它们，因为它们有很多奇怪的地方，很难理解、调试和维护。</p><p id="eff6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">围绕这场争论，你已经可以找到很多文章了。我想写这篇文章来提供一个针对JavaScript中的类的函数式解决方案的快速指南。</p><p id="685f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中，我将展示在JavaScript中使用类的两种方式。历史函数类语法和ES2015类语法。</p><p id="3f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单起见，我将把它们都称为类，除非我明确地提到其中的一个。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8cdd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建对象</h1><p id="0a2c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在JavaScript中，可以使用对象字面语法直接创建对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="409e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">多亏了这种语法，根本不需要类语法。了解一些模式有助于我们远离那些怪癖，写出更好的代码。首先，让我们看看如何使用类语法创建对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="71de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使ES2015类语法更好，但它只是原型之上的语法糖。使用对象工厂模式可以获得相同的结果。</p><p id="c163" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">工厂模式只是一个使用对象字面语法返回对象的纯函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="adde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有一些经验，您应该已经意识到这种方法的一个问题。每次创建一个新对象时，<code class="fe nb nc nd ne b">createHuman</code>工厂都会创建一个新的<code class="fe nb nc nd ne b">getFullname</code>方法。</p><p id="9b0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果创建了数千或数百万个对象，这会增加内存消耗并产生一些性能开销。</p><p id="f250" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是不用担心。这很容易解决。把<code class="fe nb nc nd ne b">getFullname</code>方法搬到工厂外面，在工厂里面引用就行了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="807b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">继承之上的组合</h1><p id="ff64" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">类最大的特点之一就是继承。你可以把重复的定义分成小块，然后继承它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="79d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管继承作为OOP的一个特性很棒，但在JavaScript中却是个问题。这是反对在JavaScript中使用类的主要理由。</p><p id="723f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用原型继承，对象直接从其他对象继承，如果有很多嵌套的原型，就会变得混乱。追踪bug会变得非常困难。</p><p id="9135" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，我们有另一种模式来复制同样的效果。作文。您可以组合它们，而不是从其他对象继承对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1e39" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">私有字段、设置器和获取器</h1><p id="bd32" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">JavaScript类还没有私有字段的概念。幸运的是，在漫长的等待之后，<a class="ae ky" href="https://github.com/tc39/proposal-class-fields" rel="noopener ugc nofollow" target="_blank">私有字段</a>很快就会出现在JavaScript中。</p><p id="02f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但在此之前，有一些变通办法，如以下划线开始字段名以将其标记为私有或使用符号。即使JavaScript中还没有私有字段，setters和getters也已经存在很久了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b328" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果考虑函数式方法，私有字段只是变量和函数，不通过对象工厂公开。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="884b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">静态字段</h1><p id="cc5f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">静态字段不能访问对象上下文。一些用例是存储与类相关的常量、一些助手函数或工厂函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="f2f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为静态字段不能访问对象上下文，所以把它们放在哪里并不重要。你可以把它们作为变量，一个模块中的纯函数，如果需要它们是公共的或者你可以把它们赋给工厂函数，就把它们导出来。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6d90" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="28be" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">每年我们都会看到各种JavaScript主题的大量改进，包括类。甚至类语法也比函数类有了巨大的改进，但它仍然有着与原型继承相同的怪癖。</p><p id="316d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在有意义的时候，在JavaScript中使用类并没有错。但是强烈建议远离它们，以防止不必要的错误和行为。</p><p id="641a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，JavaScript的设计允许我们以更简单的方式使用类的相同特性，使用函数和一些模式。</p><p id="c4db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>