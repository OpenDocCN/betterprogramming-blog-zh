# 神奇的数字没有那么神奇

> 原文：<https://betterprogramming.pub/magic-numbers-are-not-that-magic-132297d435f5>

## 硬编码数字的更好解决方案

![](img/19ad2261bd7e63e70e8a99cb692dea61.png)

在 [Unsplash](https://unsplash.com/s/photos/feathers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上由 [Maail](https://unsplash.com/@maail?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 拍摄的照片

我真的不喜欢*神奇数字*这个词。我看到很多人都弄错了。我见过并有过多次代码审查，有人看到代码中的任何数字并评论道，“哦，这是一个神奇的数字，确保你把它放在一个名字的上面。”

(我也很不喜欢我们觉得有必要把所有变量放在一个文件的顶部，但那是以后的事了。)

开发者，你可以在你的代码中使用你的数字小键盘。注意你的做法。

# 什么是幻数？

我的意思是，你可以谷歌它，得到一堆蹩脚的定义，但底线是，幻数是你的代码中很难推理的数字。

52 从何而来？

事实证明，这是生成一副牌的代码，因为一副牌中的牌数是 52。让我们给这个数字起个名字。

这是更易读、更易维护、更好的代码。太好了，你已经掌握了干净的代码。

不，这只是冰山一角。这个例子(这是一个非常常见的例子)的问题是，开发人员可能很容易从其余的代码中找出地狱 52 是什么。这是一个相当平淡的神奇数字。

当神奇的数字不知从哪里冒出来的时候，你会觉得很难受。取此代码为调优搜索算法:

这些数字到底是什么意思？要理解这些数字的用途和作用并不容易。

# 幻数有什么问题？

比方说，你的应用程序变得越来越大，需要搜索的东西越来越多，突然之间，你的搜索结果并不完全是你想要的。

我们有一个错误“当我搜索‘磨砂麦片’时，结果里没有麦片，尽管我知道它在里面。”

所以你，Joe Schmo，在这个算法最初调整四年后，需要改变这些值来修复这个错误。你首先改变什么？

这就是幻数的问题。这些数字最好用长的、描述性的名称组合在一起，并在代码中记录改变它们对结果的影响。

解释算法也是加分的。

让我们来解决这个问题:

你难道不会对这样的代码感到更舒服吗？你甚至可能知道要开始改变什么。调优搜索可能很困难，但是有人会更好地利用这份文档来解决这个 bug。

# 什么不是幻数？

事实上，难以推理的数字不像容易推理的数字那样经常出现。拿这些硬编码的数字

这不是一个神奇的数字。我再说一遍:这不是一个神奇的数字。

我知道。我让一些爪哇纯粹主义者和洁癖者得了动脉瘤。

但是这个数字并不难理解。它的思想是完全独立的。此视图的高度为 42 *。*就是这样。像这样给它起个名字能增加什么价值？

这只是代码膨胀。这看起来像是一个小例子，但是这种不必要地命名数字的想法很快就扩大了 UI 代码的大小，并且只会增加代码的行数。

# 等等，我能不能在代码中使用数字？

当然了。世界上有很多包含数字的好代码。你只需要记住几件事:

*   确保你的数字是容易理解的——就像，一个孩子能猜出这个数字是从哪里来的。
*   如果你正在改变一个数字，调整一些东西，或者在纸上做一些计算来得到一个硬编码的数字，解释它。在代码中。号码旁边。或者至少在提交时。应解释硬编码数字的变化。
*   额外收获:确保你的硬编码数字是干燥的。

这不是火箭科学，但在使用数字行时有很多微妙之处。

你会没事的。感谢阅读！