<html>
<head>
<title>3 Steps To Enhance Images Using OpenCV Noise Reduction in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的OpenCV降噪增强图像的3个步骤</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-steps-to-enhance-images-using-opencv-noise-reduction-in-python-f53d2abf2f6f?source=collection_archive---------0-----------------------#2021-02-28">https://betterprogramming.pub/3-steps-to-enhance-images-using-opencv-noise-reduction-in-python-f53d2abf2f6f?source=collection_archive---------0-----------------------#2021-02-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3dfb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用降噪来消除像素化图像</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d0b7ac7a910aae5af95f176a4feb2fb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bLklbXC5KgvzbN8i"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> CHUTTERSNAP </a>拍摄。</p></figure><p id="8821" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示如何通过三个简单的步骤实现降噪。我们将使用机器学习训练的降噪模型。这是我发现的最好的降噪模型之一。</p><p id="b9e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个程序能判断一幅图像是否有噪声吗？这可能是另一个项目的想法，因为我们的降噪模型不够智能，无法计算噪音。我们必须自己决定价值观。在这种情况下，最好的方法通常是尝试不同的值，找到最佳结果。经过一些实践后，您将获得更多的经验，并且更容易找到最佳参数值。</p><p id="6636" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我给你简单介绍一下这个项目，然后我们就开始。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7b46" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="3224" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这个项目中，我们将使用三个Python包:<a class="ae ky" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>、<a class="ae ky" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae ky" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>。OpenCV是一个非常著名的计算机视觉工具包。作为OpenCV库的先决条件，我们需要安装NumPy。读取图像时，我们将像素转换为数组。NumPy将在幕后完成这项工作。在处理多维数组时，NumPy是完美的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="01ff" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">降噪模型</h1><p id="1a29" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">接下来是这个项目有见地的部分。首先，我要分享我们将使用哪种算法进行降噪。然后，我将分享它有多少个参数，以及每个参数的含义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/2317fa2c94c8c03b64e00734e7e8c6e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PQdno2FfHOMDHG8J"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.pexels.com/photo/crop-thoughtful-woman-with-short-hair-standing-on-street-5420550/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ky" href="https://www.pexels.com/@mbardo?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> MBARDO </a>的照片(作者设计)。</p></figure><p id="e20c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图中的黄色区域看起来很像。另外，绿色的小区域看起来很相似。非局部均值去噪算法选择一个像素，在其周围取一个小窗口，扫描图像寻找相似的窗口，对所有窗口进行平均，计算结果以替换该像素。这种算法被描述为非局部的，因为它搜索整个图像来寻找相互的联系，而不是仅仅在单个区域周围寻找。是不是很酷？</p><p id="3a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个算法包含两个流行的函数:<code class="fe na nb nc nd b">fastNlMeansDenoising</code>和<code class="fe na nb nc nd b">fastNlMeansDenoisingColored</code>。<em class="ne"> </em>第一个用于灰度图像，第二个用于彩色照片。在我们的例子中，我们将使用一个彩色图像。</p><p id="1507" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能的参数有<code class="fe na nb nc nd b">src</code>、<code class="fe na nb nc nd b">dst</code>、<code class="fe na nb nc nd b">h</code>、<code class="fe na nb nc nd b">hcolor</code>、<code class="fe na nb nc nd b">templateWindowSize</code>和<code class="fe na nb nc nd b">searchWindowSize</code>。</p><ul class=""><li id="a283" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">src</code>:我们要做降噪处理的输入图像。</li><li id="7fdb" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">dst</code>:我们要导出结果的目的地。</li><li id="28c1" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">h</code>:亮度分量(较大的<code class="fe na nb nc nd b">h</code>值会去除更多的噪声，但也会降低图像质量)。</li><li id="fd12" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">hcolor</code>:彩色分量(<code class="fe na nb nc nd b">10</code>是彩色图像文档的推荐值)。</li><li id="fbb0" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">templateWindowSize</code>:函数将要平滑的区域的像素大小。它应该是一个奇数。</li><li id="3a2c" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe na nb nc nd b">searchWindowSize</code>:该函数将查找并用作参考的区域的像素大小。它线性地影响性能:更大的<code class="fe na nb nc nd b">searchWindowSize</code>意味着更长的去噪时间。此外，它应该是一个奇数(<code class="fe na nb nc nd b">21</code>是官方文档推荐的值，因为它适合大多数有噪声的图像情况)。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3404" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤1:安装软件包</h1><p id="ab88" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们必须安装两个库，这样我们的程序才能工作:numpy和opencv-python。我们可以使用PIP库管理器在一行中安装它们:</p><pre class="kj kk kl km gt nt nd nu nv aw nw bi"><span id="40ba" class="nx md it nd b gy ny nz l oa ob">pip install numpy opencv-python</span></pre><p id="da93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续创建一个新的Jupyter笔记本(但是可以随意使用您想要的代码编写环境)。这是我的第一个笔记本块，我们正在导入刚刚构建的库:</p><pre class="kj kk kl km gt nt nd nu nv aw nw bi"><span id="735b" class="nx md it nd b gy ny nz l oa ob">import cv2 <br/>import numpy as np</span></pre><p id="5093" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在我们可以进入下一步，导入并读取图像。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9961" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤2:导入图像</h1><p id="c286" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这一步中，我们将找到一张想要用于降噪的图片。为了更清楚地看到变化，它可以是一张嘈杂的图片。也可以随意使用普通的图像——仍然会有平滑的效果。</p><p id="3627" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我打算使用的图片:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a7644ce7b0d6222e3ba28a575588eab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*DC1tL1SfDByccQ2L_fV0-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/crop-thoughtful-woman-with-short-hair-standing-on-street-5420550/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ky" href="https://www.pexels.com/@mbardo?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">姆巴多</a>拍摄。</p></figure><p id="6365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是读取图像的一行。我们使用OpenCV的<code class="fe na nb nc nd b">imread</code>方法:</p><pre class="kj kk kl km gt nt nd nu nv aw nw bi"><span id="4228" class="nx md it nd b gy ny nz l oa ob">img = cv2.imread("test_image.png")</span></pre><p id="9c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们进入第三步，也是最后一步，在这里我们将看到我们的降噪效果。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="80ff" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤3:图像去噪</h1><p id="e281" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">目前看起来很棒！这是这个项目有趣的部分。我们将看到降噪后的图像。我们将使用三个不同的值运行该函数，看看每个值如何影响最终结果。请随意检查第一步，以了解每个参数代表什么。</p><pre class="kj kk kl km gt nt nd nu nv aw nw bi"><span id="0058" class="nx md it nd b gy ny nz l oa ob">denoise_1 = cv2.fastNlMeansDenoisingColored(img,None,3,3,7,21) <br/>denoise_2 = cv2.fastNlMeansDenoisingColored(img,None,5,5,7,21) <br/>denoise_3 = cv2.fastNlMeansDenoisingColored(img,None,15,15,7,21)</span></pre><p id="f94b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">去噪后的图像被分配给不同的变量。让我们保存结果。我们将使用OpenCV的<code class="fe na nb nc nd b">imwrite</code>方法。如您所见，我们传递了变量和想要保存的文件名。</p><pre class="kj kk kl km gt nt nd nu nv aw nw bi"><span id="6496" class="nx md it nd b gy ny nz l oa ob">cv2.imwrite('image_1.png', denoise_1) <br/>cv2.imwrite('image_2.png', denoise_2) <br/>cv2.imwrite('image_3.png', denoise_3)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0c41" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">比较结果</h1><p id="24a7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以按顺序看到它们。该值越大，图像变得越平滑。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/91f8f1c3612b25c3f814c4268e3fb08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwGWLZFXoiry9CDWJT8gpg.png"/></div></div></figure><p id="c271" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一张前后对比的图片，可以看到这些变化。我选择了<code class="fe na nb nc nd b">denoise_1</code>作为我的最终结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/7e1acf00cfe7973c460ff6abb01d2905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WL97injrT7D2J6X7rIl-QA.png"/></div></div></figure><p id="f6bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！我们开发了一个程序，通过不同的级别降低图像的噪声。还有许多其他的图像缩小算法。你可以试一试，选出你最喜欢的。根据我的经验，它们不如我们在本文中使用的非局部均值去噪算法强大。一些降噪算法也被称为模糊算法。这可能有助于您搜索不同的型号。</p><p id="ed33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从事像这样的动手编程项目是提高编码技能的最好方式。我希望你喜欢这篇文章，并且今天学到了一些新东西。感谢您的阅读！</p></div></div>    
</body>
</html>