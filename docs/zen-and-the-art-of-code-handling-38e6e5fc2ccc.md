# 禅宗和代码处理艺术

> 原文：<https://betterprogramming.pub/zen-and-the-art-of-code-handling-38e6e5fc2ccc>

## 编写优秀代码的简单指南

![](img/74cc2a40492063c6ba1af8c26160119e.png)

亚历克斯·博尔苏克，幻想艺术，忍者神龟，斯普林特(TMNT)，高清壁纸。

我是一个后端公会大师(也是 Java 开发者)。“开发人员”是我的日常工作，但“大师”更适合这个职位，我只是喜欢“大师”的发音。就叫我斯普林特大师吧(在梦里)。

说实话，“后端公会主”更多的是行政角色。我负责在每周例会上与后端开发人员分享的内容，并负责推广 R&D 部门的政策和惯例。

在一次会议中，我做了一个“干净代码的基本原则”的报告。这个主题与我们当时特别相关，因为我们刚刚开始将一个整体拆成微服务。

在那次演讲将近两年后的今天，我可以看到它是多么的有帮助。首先，这对我很有帮助。我的意思是，我们大多数人，至少有一次，不得不阅读甚至编写有质量问题的代码(我知道我是这样的！).所以，我们都有一个代码不应该是什么样子的心理图像。尽管如此，当一些指导方针放在前面和中间时，它迫使我们停下来，在我们编写代码时评估代码。可读性够吗？够干净吗？这就是我现在回想起来写这篇文章的原因。

> *“没有对错。只有选择。明智地选择。”—分裂大师*

写代码没有对错之分。不同的开发者对于什么是“正确的”有不同的想法，这取决于他们个人的经验和倾向。我想和你分享我对如何处理代码的想法。

# **遵循通用编码惯例**

“编码约定”只是“标准”的一种花哨的说法(也是我喜欢的)，标准(最好是有文档记录的)应该出现在每个团队中。这些可能描述了标准的项目结构，类和资源应该如何命名，缩进标准，以及其他管理如何在这个部门编写软件的标准。

遵循惯例意味着项目中的元素看起来好像是由一个人、一个想法创作的。惯例对程序的质量有积极的影响。它有助于避免常见的编码错误，提高代码的可读性，并简化修改。遵守约定意味着任何人都能够理解和修改代码，而不管它是什么时候或者由谁编写的😉。以约定编写的代码是可预测的。

> *“通往我们真正渴望的道路是漫长而艰难的，但只有沿着这条路走，我们才能实现目标。”* —分裂大师

# **选择可读名称**

为了编写代码，你必须了解它的环境和周围的代码。要理解代码，你必须通读一遍。有时候你必须这样做几次。可读的代码可以让你在大脑紧张地一次理解所有不同部分的时候不至于失去理智。

好的名字可以让代码更具可读性。为你的方法和变量选择名字要像为你的孩子选择名字一样小心。想一想——名字不好的孩子在学校受罪。你能想象一个叫做“ImplFactoryReactor”的人会有什么样的名字吗😑？然后他们达到成熟，获得护照的权利，并愉快地改变这个不幸的名字。我夸大了——但没有夸大太多。好名字真的很重要；我是认真的。

变量、函数或类的名字应该回答所有的大问题。它应该告诉你:

*   为什么会存在？
*   它是做什么的？
*   如何使用？

这是我的一点智慧(我是一个分裂的追随者，记得吗？):“恶名就像一个糟糕的笑话:如果你一定要解释，那就不好笑了。”如果一个名字需要一个解释，它不会暴露它的意图。

选择好名字需要时间(有时需要更多时间，然后编写逻辑)，但这是值得的。

# 函数应该做一件事

听起来很老套，一个函数应该“只做一件事，并且做好。”碰巧的是，很多时候这个“一件事”意味着某种逻辑的单级抽象。

考虑以下示例，客户创建逻辑可以包括以下步骤:

*   客户应该丰富一些内部参数，如注册标志和日期，他来自的活动和其他类似的元数据
*   应该在数据库中创建客户
*   还应保存客户对许可协议的同意书
*   应该发送业务事件，以便将客户的创建通知给其他服务

你可以把所有这些步骤写成一个大的笨拙的方法，或者分成非常具体的小步骤。您的客户创建可能如下所示:

编写有效函数的一些技巧:

*避免将布尔参数传递给函数*。这是一种“气味”,函数内部有一个“如果”条件，导致它做不止一件事。当您识别代码的不同部分时，首先要将它们分成不同的方法。

*保持函数的参数数量尽可能少*。根据经验:如果一个函数需要两个或三个以上的参数，那么这些参数中的一些很可能应该被包装到它们自己的类中。

该功能应该做它承诺要做的事情。如果函数名为`isEnabled()`，它应该只回答问题(返回一个布尔值)而不做任何其他操作。否则，函数的名称会产生误导。这是一种“因遗漏而说谎”。不是开玩笑，我谷歌了一下。下一段话摘自《[科学的人](https://www.scienceofpeople.com/different-types-lies/)》:

> “另一种谎言是你遗漏了信息的重要部分，因此被称为遗漏谎言。在这些谎言中，有人忽略了陈述中的一个重要细节。这些都是令人讨厌的谎言，因为它们更难被识破，而且说谎者付出的努力也更少”。

你的函数承诺做一件事，但也做其他隐藏的事情。这是一个“恶毒的谎言”😱！现在，玩笑归玩笑，通过做一件事，这个功能确保它没有隐藏的[副作用](https://en.wikipedia.org/wiki/Side_effect_(computer_science))。

就像口头禅一样重复一遍:“函数是做什么的？”；"这个函数只做一件事吗？"，“函数的名字是否准确描述了它的作用？”

# **捕捉并处理异常**

异常是现代编程的一个基本元素。它们允许我们干净地进行故障转移，从而使我们的代码变得更好。异常处理将保持代码的可维护性和可读性。

*   **可维护，**因为异常处理给你一个更好的顺序感和对代码的控制，这允许容易地发现和修复新的错误。
*   **可读**，因为一个正确编写的异常处理程序允许我们轻松地阅读代码并发现其用途。

附加智慧(我势如破竹！):“安全总比后悔好。”总是以明确的方式捕捉和处理异常，即使你觉得没有必要。

# 努力达到 100%的测试覆盖率

测试测试测试。我们都知道我们应该这样做，但有时我们会偷工减料，这样我们可以更快地推出项目…

最后(但不是最不重要的)一点智慧:“**如果没有经过测试，它就坏了**”。没有人能写出完美的、无 bug 的代码。即使有可能这样做，也不能保证完美的代码不会在以后崩溃。

写很多测试，尤其是单元测试。单元测试很“便宜”，所以你可以覆盖所有可能的情况和变化。认真考虑集成测试，确保覆盖核心业务功能。

哦，我可以想象自己挥舞着食指威胁道:“如果你现在不进行测试，你的代码将来会崩溃的！穆哈哈！”

# 离开你工作过的地方，让它比你来的时候更干净、更好

这是我最喜欢的😁。

代码应该处于不断重构的状态。当你在一个现有的类上工作时，只要看看周围——什么可以“在途中”被清理？重构你正在处理的一小段代码，删除未使用的代码，添加缺失的测试。收拾残局真好。我没开玩笑，我真的很喜欢。

如果您有一个好的测试套件来备份您的代码(检查前面的框)，您可以尽可能地重构它，而不必太担心损坏。

# 结论

没有一种正确的方法可以写出高质量的代码。在这篇文章中，我列出了一些想法，在我看来，这些想法可以帮助我做到这一点。所有提到的想法，最终都是为了让代码更具可读性。

所以尽量让你的代码可读性更好。

> *“加油忍者，加油忍者，加油！我又做了一个搞笑的！哈哈哈哈！”* —分裂大师

感谢阅读！