<html>
<head>
<title>Singletons in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的单例</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/singleton-in-python-5eaa66618e3d?source=collection_archive---------1-----------------------#2019-05-26">https://betterprogramming.pub/singleton-in-python-5eaa66618e3d?source=collection_archive---------1-----------------------#2019-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5ec0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">编写一个单例装饰器用于任何类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3a212cd205418ac0c142fd4abc33c554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*voEegRVgjiNWRDxxkviWFw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">帕特里克·施耐德在<a class="ae ky" href="https://unsplash.com/s/photos/decorate?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="84ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，我们根据自己的需要创建许多类的对象。有时，创建多个对象会占用大量资源。</p><p id="0c6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据库连接类就是一个真实的例子。您不希望有多个数据库对象，因为其中一个对象的更改可能会导致其他对象不一致。</p><p id="bc69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们可以使用单例模式。使用单例模式，我们确保一个类只创建一个实例。</p><p id="a3df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>中有几个你经常使用的单例，包括<code class="fe lv lw lx ly b">None</code>、<code class="fe lv lw lx ly b">True</code>、<code class="fe lv lw lx ly b">False</code>。事实上，<code class="fe lv lw lx ly b">None</code>是一个单例，允许你使用<code class="fe lv lw lx ly b">is</code>关键字来比较<code class="fe lv lw lx ly b">None</code>。</p><p id="ef20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中，创建单例模式的典型方式是使用装饰器。可以阅读Python  中的文章<a class="ae ky" href="https://medium.com/@goutomroy/decorators-in-python-72a1d578eac4" rel="noopener"> <em class="lz"> Decorators，了解更多关于Decorators的知识。</em></a></p><p id="3d41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们希望在应用程序的整个生命周期中只有一个数据库连接。让我们创建一个单例类来满足我们的目的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="a083" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，创建数据库连接类:</p><pre class="kj kk kl km gt mc ly md me aw mf bi"><span id="f1bc" class="mg mh it ly b gy mi mj l mk ml">@Singleton<br/>class DBConnection(object):<br/><br/>    def __init__(self):<br/>        <em class="lz">"""Initialize your database connection here."""<br/>        </em>pass<br/><br/>    def __str__(self):<br/>        return 'Database connection object'</span></pre><p id="4c2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们访问这个连接类:</p><pre class="kj kk kl km gt mc ly md me aw mf bi"><span id="5dfe" class="mg mh it ly b gy mi mj l mk ml">c1 = DBConnection.Instance()<br/>c2 = DBConnection.Instance()<br/><br/>print("Id of c1 : {}".format(str(id(c1))))<br/>print("Id of c2 : {}".format(str(id(c1))))<br/><br/>print("c1 is c2 ? " + str(c1 is c2))</span></pre><p id="f96e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt mc ly md me aw mf bi"><span id="e534" class="mg mh it ly b gy mi mj l mk ml">Id of c1 : 139699882512960<br/>Id of c2 : 139699882512960<br/>c1 is c2 ? True</span></pre><p id="5c9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们做如下，我们将得到<code class="fe lv lw lx ly b">TypeError</code>:</p><pre class="kj kk kl km gt mc ly md me aw mf bi"><span id="56e3" class="mg mh it ly b gy mi mj l mk ml">try:<br/>    p = DBConnection()<br/>except TypeError as ex:<br/>    print("ERROR: {}".format(ex.message))</span></pre><p id="1b1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章能帮助你在任何类中实现单例模式。</p></div></div>    
</body>
</html>