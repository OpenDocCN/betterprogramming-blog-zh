<html>
<head>
<title>An Introduction to Jest JavaScript Testing Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jest JavaScript测试框架介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/an-introduction-to-jest-javascript-testing-framework-b6677f0d30d?source=collection_archive---------11-----------------------#2021-01-13">https://betterprogramming.pub/an-introduction-to-jest-javascript-testing-framework-b6677f0d30d?source=collection_archive---------11-----------------------#2021-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4f95" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">适用于大多数JavaScript项目的开源测试工具包</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9c8f1fa1c59f77b7cc799f85f9f8a8a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RwLnI2i1n1ctLKjh3xZaJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Jest官方GitHub 页面上的徽标，由作者修改以包含附加文本</p></figure><p id="3077" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天的主题是Jest，这是一个JavaScript测试框架，可以方便地测试您的JavaScript项目。在撰写本文时，它提供了对Babel、TypeScript、Node、React、Angular、Vue以及更多的支持。</p><p id="0036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据<a class="ae ky" href="https://jestjs.io/docs/en/getting-started" rel="noopener ugc nofollow" target="_blank">官方文档</a>，它提供以下功能:</p><ul class=""><li id="6228" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">快速安全</li><li id="7372" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代码覆盖率</li><li id="0b77" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">轻松嘲讽</li><li id="0e1d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">伟大的例外</li></ul><p id="cb02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jest是一个非常棒的测试工具包，适用于正在寻找其他替代方案并拥有以下测试框架经验的开发人员:</p><ul class=""><li id="5a03" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">自动话频警报器(automatic voice alarm)ˌ视听教具(audiovisual aids)</li><li id="a336" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">Expect.js</li><li id="2021" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">茉莉</li><li id="2eb1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">摩卡</li><li id="715a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">代理查询</li><li id="f661" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">应该. js</li><li id="7753" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">磁带</li></ul><p id="cdd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们进入下一部分，开始安装Jest。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2975" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">设置</h1><p id="2894" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">根据您自己的喜好，通过yarn或npm安装非常简单。</p><h2 id="3818" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">故事</h2><p id="b492" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">通过纱线安装Jest，如下所示:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="dbe6" class="nn mr it oa b gy oe of l og oh">yarn add --dev jest</span></pre><h2 id="0359" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">npm</h2><p id="b78d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">或者，您也可以使用npm来安装Jest。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="78d9" class="nn mr it oa b gy oe of l og oh">npm install --save-dev jest</span></pre><h2 id="1631" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">JavaScript文件</h2><p id="a07b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们创建两个新的JavaScript文件作为测试的一部分:</p><ul class=""><li id="bf3d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">algebra.js</code></li><li id="8353" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">algebra.test.js</code></li></ul><p id="eb20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以<code class="fe oi oj ok oa b">.test.js</code>结尾的文件将成为Jest测试套件的一部分。您可以创建更多的测试文件，Jest会自动将它们包含在测试中。</p><h2 id="460e" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">配置</h2><p id="2b73" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果您在一个新文件夹中重新开始，运行以下命令创建一个新的<code class="fe oi oj ok oa b">package.json</code>文件。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="d04d" class="nn mr it oa b gy oe of l og oh">npm init</span></pre><p id="8ccd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在<code class="fe oi oj ok oa b">package.json</code>中修改或包含以下内容</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="4cd1" class="nn mr it oa b gy oe of l og oh">{<br/>  "scripts": {<br/>    "test": "jest"<br/>  }<br/>}</span></pre><p id="325f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的最终<code class="fe oi oj ok oa b">package.json</code>应该如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="40ca" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">基本用法</h1><p id="48af" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在这一节中，我们将在<code class="fe oi oj ok oa b">algebra.js</code>中实现两个函数，并设置相应的测试脚本。</p><p id="3a9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe oi oj ok oa b">algebra.js</code>，在里面添加以下代码。在文件的最后，调用<code class="fe oi oj ok oa b">exports</code>来导出函数。稍后我们将在<code class="fe oi oj ok oa b">algebra.test.js</code>内部调用它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="e15f" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">创建测试脚本</h2><p id="c0d2" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">接下来，转到<code class="fe oi oj ok oa b">algebra.test.js</code>并添加下面的代码来导入我们之前定义的函数。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="b468" class="nn mr it oa b gy oe of l og oh">const {sum, subtract} = require('./algebra');</span></pre><p id="dc23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单调用内置的<code class="fe oi oj ok oa b">test</code>函数如下:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="446a" class="nn mr it oa b gy oe of l og oh">test('addition', () =&gt; {<br/>  expect(sum(1, 2)).toBe(3);<br/>});</span></pre><p id="b316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">断言是通过将任何函数包装在<code class="fe oi oj ok oa b">expect</code>函数中，后跟任何预定义的<a class="ae ky" href="https://jestjs.io/docs/en/using-matchers" rel="noopener ugc nofollow" target="_blank">匹配器</a>来确定的。在本例中，我们使用了<code class="fe oi oj ok oa b">toBe</code>作为匹配器，这意味着Jest期望返回的结果是3。</p><p id="2d98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok oa b">toBe</code>表示完全相等，因为它在内部使用了<code class="fe oi oj ok oa b">Object.is</code>。如果你只是想测试一个对象的值，你应该使用<code class="fe oi oj ok oa b">toEqual</code>。<code class="fe oi oj ok oa b">toEqual</code>将递归检查一个对象的所有字段。</p><p id="987e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，您可以通过使用<code class="fe oi oj ok oa b">not</code>否定测试或检查相反的值。举个例子，</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="e7c4" class="nn mr it oa b gy oe of l og oh">test('addition', () =&gt; {<br/>  expect(sum(1, 2)).toBe(3);<br/>  expect(sum(2, 2)).not.toBe(3);<br/>});</span></pre><h2 id="b72a" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">运行测试</h2><p id="9830" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">一旦您对您的测试脚本感到满意，回到您的终端并运行</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="b840" class="nn mr it oa b gy oe of l og oh">yarn test</span></pre><p id="a231" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="dd4e" class="nn mr it oa b gy oe of l og oh">npm run test</span></pre><p id="9c67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该在终端中看到以下输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/8e258373343e12b1cb03102f78fd568c.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*XzH5O2QUzvdpJV0vA2eUDg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9f63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Test Suites表示测试的文件数量(以<code class="fe oi oj ok oa b">test.js</code>结尾)。同时，Tests表示进行的测试总数。让我们在<code class="fe oi oj ok oa b">algebra.test.js</code>内部增加一个新的测试。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="a8e2" class="nn mr it oa b gy oe of l og oh">test('subtraction', () =&gt; {<br/>  expect(subtract(1, 2)).toBe(-1);<br/>});</span></pre><p id="93ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行测试时，将显示以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/e6e11aae44081c402cc16ac1d401df1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*SIsRVYc9MhVxpq3q8gSVyg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="8c1a" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">比较数字</h1><p id="ff4f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">请注意<code class="fe oi oj ok oa b">toBe</code>和<code class="fe oi oj ok oa b">toEqual</code>的数字相同。你可以互换使用它们。此外，通过使用以下匹配器，您可以轻松地比较测试中的数字:</p><ul class=""><li id="0506" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">toBeGreaterThan</code></li><li id="3741" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">toBeGreaterThanOrEqual</code></li><li id="47d3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">toBeLessThan</code></li><li id="9a06" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">toBeLessThanOrEqual</code></li></ul><p id="7036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看下面的例子，它使用了一个循环，并检查最终值是否小于20。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="cf19" class="nn mr it oa b gy oe of l og oh">test('loop less than', () =&gt; {<br/>  for (let i = 1; i &lt; 10; i++) {<br/>    expect(i + i).toBeLessThan(20);<br/>  }<br/>});</span></pre><p id="54ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将该值从20改为15。当您运行测试时，您应该得到下面的错误日志。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/0daa50e70a4bc83cb962c023a854e1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*albjrjF0fZePsjuJJGcQyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5c1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">表示调用<code class="fe oi oj ok oa b">toBeLessThan</code>时第14行断言失败。它期望返回值小于15，但却得到了16。正如您所看到的，它对于识别无效测试用例背后的问题非常有用和容易。</p><h2 id="6123" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">浮点</h2><p id="a44b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">浮点比较应该通过<code class="fe oi oj ok oa b">toBeCloseTo</code>来完成。这仅仅是因为任何舍入误差都会使测试用例无效。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="aa49" class="nn mr it oa b gy oe of l og oh">test('compare floating number', () =&gt; {<br/>  let value = 0.1 + 0.2;<br/>  expect(value).toBeCloseTo(0.3);<br/>});</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d7a6" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">比较字符串</h1><h2 id="8c48" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">正则表达式</h2><p id="58cc" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">Jest支持通过正则表达式比较字符串。您需要做的就是调用<code class="fe oi oj ok oa b">toMatch</code>函数并传入regex字符串。这里有一个例子来检查字符串<code class="fe oi oj ok oa b">medium</code>是否出现在<code class="fe oi oj ok oa b">welcome to medium</code>字符串中。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="830e" class="nn mr it oa b gy oe of l og oh">const text = 'welcome to medium'<br/>test('string comparison', () =&gt; {<br/>  expect(text).toMatch(/medium/);<br/>});</span></pre><p id="8a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用一个<code class="fe oi oj ok oa b">RegExp</code>对象来代替正则表达式字符串符号。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="1bc7" class="nn mr it oa b gy oe of l og oh">expect(text)<!-- -->.toMatch(new RegExp('<!-- -->medium<!-- -->'));</span></pre><h2 id="e826" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">长度</h2><p id="2c19" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">另一方面，您也可以通过<code class="fe oi oj ok oa b">toHaveLength</code>比较两个字符串之间的长度。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="bdf4" class="nn mr it oa b gy oe of l og oh">expect('abc').toHaveLength(3);</span></pre><p id="443f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它也适用于数组。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="b089" class="nn mr it oa b gy oe of l og oh">expect([1, 2, 3]).toHaveLength(3);</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="406a" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">比较数组</h1><p id="5024" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果你想检查一个数组中是否有一个特定的条目，你应该使用<code class="fe oi oj ok oa b">toContain</code>。下面的例子说明了如何检查<code class="fe oi oj ok oa b">apple</code>是否出现在<code class="fe oi oj ok oa b">fruits</code>数组中。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="8936" class="nn mr it oa b gy oe of l og oh">const fruits = ['apple', 'orange', 'papaya', 'banana', 'peach'];<br/>test('check list', () =&gt; {<br/>  expect(fruits).toContain('apple');<br/>});</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="593d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">异步代码</h1><p id="e7ea" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">根据您的需要，有多种方式来处理异步代码。</p><h2 id="446b" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">回收</h2><p id="539f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">处理回调最简单的方法是在调用回调函数时使用单个<code class="fe oi oj ok oa b">done</code>参数。举个例子，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="2c85" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">承诺</h2><p id="34c5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">带有承诺的异步代码要容易得多，因为您需要做的就是返回承诺。看看修改后的例子:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="a47b" class="nn mr it oa b gy oe of l og oh">test('test promise', () =&gt; {<br/>  return getData().then(data =&gt; {<br/>    expect(data).toBe('wfng');<br/>  });<br/>});</span></pre><h2 id="1050" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">异步/等待</h2><p id="622e" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">另一方面，使用async/await要简单得多。让我们重用前面的例子，并将其修改为使用async/await。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="46f8" class="nn mr it oa b gy oe of l og oh">test('test async', async () =&gt; {<br/>  const data = await getData();<br/>  expect(data).toBe('wfng');<br/>});</span></pre><h2 id="8d2f" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">例子</h2><p id="7a5b" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">请注意，您可以在您的测试脚本中混合使用它们。让我们尝试使用<code class="fe oi oj ok oa b">Promise</code>实现一个简单的例子。创建两个新的JavaScript文件:</p><ul class=""><li id="f686" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">data.js</code></li><li id="2ac1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe oi oj ok oa b">data.test.js</code></li></ul><p id="5cfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oi oj ok oa b">data.js</code>中，将下面的代码添加到其中以创建一个通用的<code class="fe oi oj ok oa b">getData</code>函数，该函数从一个URL获取数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="501f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后打开<code class="fe oi oj ok oa b">data.test.js</code>并在其中创建以下测试函数。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="c9e9" class="nn mr it oa b gy oe of l og oh">test('example promise', () =&gt; {<br/>  return getData('https://httpbin.org/get?name=wfng').then(data =&gt; {<br/>    expect(data.args.name).toBe('wfng');<br/>  });<br/>});</span></pre><p id="2d88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将对<code class="fe oi oj ok oa b">httpbin</code>进行URL调用，您应该会从中获得下面的<code class="fe oi oj ok oa b">responseText</code>。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="3d9a" class="nn mr it oa b gy oe of l og oh">{<br/>  "args": {<br/>    "name": "wfng"<br/>  }, <br/>  "headers": {<br/>    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8", <br/>    "Accept-Encoding": "gzip, deflate, br", <br/>    "Accept-Language": "en-US,en;q=0.5", <br/>    "Dnt": "1", <br/>    "Host": "httpbin.org", <br/>    "Upgrade-Insecure-Requests": "1", <br/>    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0", <br/>    "X-Amzn-Trace-Id": "Root=1-5fe85ce9-7d0b2686509d0aaf2cd7043a"<br/>  }, <br/>  "origin": "180.129.116.68", <br/>  "url": "https://httpbin.org/get?name=wfng"<br/>}</span></pre><p id="90a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的测试案例是按如下方式比较<code class="fe oi oj ok oa b">args.name</code>输出:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="be49" class="nn mr it oa b gy oe of l og oh">expect(data.args.name).toBe('wfng');</span></pre><p id="b4c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存您的文件并重新运行测试。Jest将对<code class="fe oi oj ok oa b">algebra.test.js</code>和<code class="fe oi oj ok oa b">data.test.js</code>进行测试。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="42a7" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="3a9f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们回顾一下今天所学的内容。</p><p id="f167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先简要解释了Jest背后的基本概念。我们还通过yarn或npm安装了必要的模块。</p><p id="14ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们创建了一个简单的测试脚本，并使用Jest成功运行了测试。对于数字、字符串和数组断言，我们使用了不同的匹配器。</p><p id="b860" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还学习了处理异步代码，并使用promise实现了一个简单的例子。</p><p id="e62e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们探索了如何将Jest与<a class="ae ky" href="https://www.selenium.dev/" rel="noopener ugc nofollow" target="_blank"> Selenium </a>和<a class="ae ky" href="https://developers.perfectomobile.com/display/PD/Test+analysis+with+Smart+Reporting" rel="noopener ugc nofollow" target="_blank"> Perfecto Smart Reporting </a>集成。这有助于简化我们项目的整个测试过程。</p><p id="b936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢你阅读这篇文章。希望在下一篇文章中再见到你！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="be08" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">参考</h1><ol class=""><li id="4525" class="lv lw it lb b lc ni lf nj li oq lm or lq os lu ot mb mc md bi translated"><a class="ae ky" href="https://jestjs.io/docs/en/getting-started" rel="noopener ugc nofollow" target="_blank">玩笑——入门</a></li><li id="8de1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ot mb mc md bi translated"><a class="ae ky" href="https://jestjs.io/docs/en/using-matchers" rel="noopener ugc nofollow" target="_blank">Jest——使用匹配器</a></li><li id="c35d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ot mb mc md bi translated"><a class="ae ky" href="https://jestjs.io/docs/en/asynchronous" rel="noopener ugc nofollow" target="_blank"> Jest —测试异步代码</a></li><li id="876d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ot mb mc md bi translated"><a class="ae ky" href="https://developers.perfectomobile.com/display/PD/Jest" rel="noopener ugc nofollow" target="_blank"> Perfecto — Jest集成</a></li><li id="927c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ot mb mc md bi translated"><a class="ae ky" href="https://github.com/PerfectoMobileSA/Jest-perfecto-sample" rel="noopener ugc nofollow" target="_blank"> Github — Jest Perfecto示例</a></li></ol></div></div>    
</body>
</html>