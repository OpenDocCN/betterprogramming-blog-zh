<html>
<head>
<title>How to Create a Custom Page Crawler With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python创建自定义页面爬虫</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-custom-page-crawler-with-python-814c477b2952?source=collection_archive---------16-----------------------#2022-01-18">https://betterprogramming.pub/how-to-create-a-custom-page-crawler-with-python-814c477b2952?source=collection_archive---------16-----------------------#2022-01-18</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2f6d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">扫描页面以查看更改，并通过电子邮件获得通知</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/207649aa4b97ace7f7fd000283f867cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z5KIGM85ztxBQQKT"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@chrissiey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">黄诗丹·詹纳库迪</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7920" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">很多网站都提供新闻订阅，但也有一些情况下，我们只想跟踪特定的信息。当您可能需要这样的工具时，以下是一些想法:</p><ul class=""><li id="c263" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">有一个你想买的产品，如果能知道价格下降就太好了。</li><li id="81d1" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">如果您正在关注covid新闻门户网站，您可能希望在政府宣布新的测量结果时得到通知。</li><li id="4050" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">您还可以跟踪这些变化，看看数据是如何随时间变化的。这可能有助于准备研究，例如，显示价格如何在一段时间内变化。</li></ul><p id="ef50" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本教程中，我将向您展示一种使用<a class="ae kz" href="https://beautiful-soup-4.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Beautiful Soup </a> Python库跟踪页面变化的简单方法。您还将学习如何在<a class="ae kz" href="https://pipedream.com" rel="noopener ugc nofollow" target="_blank"> Pipedream </a>的帮助下免费发送电子邮件，这是一个非常棒的低代码API集成平台。</p><p id="7f1c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="4beb" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">创建Python项目</h1><p id="b7ed" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">首先，让我们安装必要的库:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="0570" class="nt ms iu np b gz nu nv l nw nx">pip3 install beautifulsoup4</span></pre><p id="373e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用以下代码创建一个新的Python文件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">页面扫描仪</p></figure><p id="1e62" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">代码解释:</p><ul class=""><li id="7e9a" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">只要网站没有变化，while循环就返回true。程序会等待60秒，然后继续扫描。</li><li id="95b8" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">我们将使用<code class="fe oa ob oc np b">requests</code> Python库下载一个页面。在本例中，我选择了一个列出受影响的covid19国家及其颜色(绿色、橙色、红色)的页面。</li><li id="37e2" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">为了处理内容，我们将使用Beautiful Soup Python库。它解析页面内容。这样，我们可以搜索任何元素。</li><li id="56b6" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">示例的页面源代码在一个<code class="fe oa ob oc np b">&lt;li&gt;</code>标签中显示了一个国家列表:</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj od"><img src="../Images/eaaba44c2232729054c1d0003a37ada9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*UDms8In4at25hsosAl6EsA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">从页面来源提取的国家/地区列表</p></figure><p id="2840" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">主要逻辑:</p><p id="9da8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们希望检索列表并记录国家的数量。每当列表大小改变时，我们将触发一个电子邮件发送请求。我将在下一节解释电子邮件配置。</p><p id="c0ad" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="oe">别忘了把占位符URL换成你自己的。</em> <strong class="lc iv"> <em class="oe"> </em> </strong> <em class="oe">你需要修改逻辑来匹配你的用例。</em></p><ul class=""><li id="44f6" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><code class="fe oa ob oc np b">ul_items</code>列表包含来自HTML源代码的<code class="fe oa ob oc np b">ul</code>元素，<code class="fe oa ob oc np b">li_items</code>包含来自HTML源代码的<code class="fe oa ob oc np b">li</code>元素。我使用美汤的<code class="fe oa ob oc np b">find</code>方法提取了<code class="fe oa ob oc np b"><strong class="lc iv">&lt;h3&gt;</strong></code>下的值，然后搜索<code class="fe oa ob oc np b">nextSibling</code>来收集<code class="fe oa ob oc np b">ul</code> <strong class="lc iv"> </strong>值。</li><li id="2cfd" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">目前，这些国家有31个。所以，我们在检查自上次扫描后号码是否有变化。</li></ul></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="ee84" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">配置Pipedream</h1><p id="d949" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">Pipedream是一个API集成平台，用于创建事件驱动的工作流。我已经在另一篇文章中介绍过了—</p><div class="of og gq gs oh oi"><a rel="noopener  ugc nofollow" target="_blank" href="/pipedream-api-integration-made-easy-f098de654cd1"><div class="oj ab fp"><div class="ok ab ol cl cj om"><h2 class="bd iv gz z fq on fs ft oo fv fx it bi translated">Pipedream: API集成变得简单</h2><div class="op l"><h3 class="bd b gz z fq on fs ft oo fv fx dk translated">了解如何使用Pipedream通过几次点击来连接API</h3></div><div class="oq l"><p class="bd b dl z fq on fs ft oo fv fx dk translated">better编程. pub</p></div></div><div class="or l"><div class="os l ot ou ov or ow kt oi"/></div></div></a></div><p id="58e2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，我们将使用电子邮件发送功能。酷的是，你不需要拥有一个域名或配置一个电子邮件服务器。</p><h2 id="4675" class="nt ms iu bd mt ox oy dn mx oz pa dp nb lj pb pc nd ln pd pe nf lr pf pg nh ph bi translated">Pipedream入门</h2><ol class=""><li id="11c8" class="lw lx iu lc b ld nj lg nk lj pi ln pj lr pk lv pl mc md me bi translated">首先，在Pipedream中创建一个帐户。</li></ol><p id="881d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.登录并转到<a class="ae kz" href="https://pipedream.com/workflows" rel="noopener ugc nofollow" target="_blank">工作流程</a>选项卡。点击<strong class="lc iv">新建</strong>按钮创建工作流程。</p><p id="0f02" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.选择<strong class="lc iv"> HTTP API </strong>作为触发器。</p><p id="4df6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">4.在下一个屏幕上，点击<strong class="lc iv">“+”</strong>符号添加一个步骤。</p><p id="2d72" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">再来补充一下“<strong class="lc iv">给自己发邮件</strong>”。请注意，它会将邮件发送到您注册时使用的电子邮件地址。</p><p id="f62a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">添加自己的主题和正文。</p><p id="d4e3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该步骤带有现成的生成代码(操作):</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="aa77" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">5.点击<strong class="lc iv">保存</strong>，然后<strong class="lc iv">部署</strong>。</p><p id="6e4e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，我的设置如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pm"><img src="../Images/3d50c7d03941b098aabba8f16ed149c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z21N_RvGQYlyiXz1k5VfGA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">电子邮件步骤设置</p></figure><h2 id="44d6" class="nt ms iu bd mt ox oy dn mx oz pa dp nb lj pb pc nd ln pd pe nf lr pf pg nh ph bi translated">测试工作流程</h2><p id="1c02" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">从步骤屏幕顶部复制唯一的URL:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pn"><img src="../Images/f6b9aecd9c5f0461a469c786004b56a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IHmmFkZsoyfIbg95nY9dFg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">触发工作流的URL</p></figure><p id="f1a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在浏览器中打开URL。它将返回一个默认的响应页面。</p><p id="9259" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了稍微定制一下响应，让我们将这段代码添加到操作中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="3b63" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">保存并再次部署。如果您现在调用URL，您应该会收到一封电子邮件，并在浏览器中看到自定义消息:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="f53b" class="nt ms iu np b gz nu nv l nw nx">{"message":"Everything is fine. Email has been sent."}</span></pre><h2 id="4df5" class="nt ms iu bd mt ox oy dn mx oz pa dp nb lj pb pc nd ln pd pe nf lr pf pg nh ph bi translated">用Python连接Pipedream</h2><p id="8d3e" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">唯一缺少的步骤是将页面扫描仪与电子邮件管道连接起来。</p><p id="b2d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">回到Python代码，将URL粘贴到<code class="fe oa ob oc np b">requests.get()</code>部分。</p><p id="fd32" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，每次我们的脚本检测到变化，Pipedream都会发送一封电子邮件。</p></div><div class="ab cl mk ml hy mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="in io ip iq ir"><h1 id="a375" class="mr ms iu bd mt mu mv mw mx my mz na nb ka nc kb nd kd ne ke nf kg ng kh nh ni bi translated">结论</h1><p id="1eec" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">在这个简短的教程中，您学习了如何使用Python和漂亮的Soup库来检测网站中的变化。您还知道如何使用Pipedream配置电子邮件发送。您可以随意使用代码作为起点，并根据您的需要进行调整。</p><p id="6853" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在现实生活中，页面扫描程序将运行在远程服务器上，或者托管在云中。如果你正在寻找一个免费的解决方案，试试Heroku，在那里你可以免费托管一个应用程序。</p><p id="f1df" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你喜欢美丽的汤和烟斗梦，你可能也会喜欢我的相关教程:</p><ul class=""><li id="e6b9" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/create-your-own-book-recommendation-application-using-wit-ai-and-beautiful-soup-8d0343288d28">使用Wit.ai和Beautiful Soup创建自己的图书推荐应用</a></li><li id="4ee2" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/create-your-unique-newsletter-with-pipedream-f0bc2de1a067">使用Pipedream </a>创建您独特的简讯</li></ul><p id="a3db" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望你喜欢这篇文章。感谢您的阅读，祝您编码愉快！</p></div></div>    
</body>
</html>