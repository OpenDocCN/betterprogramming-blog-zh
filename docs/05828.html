<html>
<head>
<title>Optimizing Django Admin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化Django管理</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/optimizing-django-admin-6a1187ddbb09?source=collection_archive---------6-----------------------#2020-08-10">https://betterprogramming.pub/optimizing-django-admin-6a1187ddbb09?source=collection_archive---------6-----------------------#2020-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7280" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何根据另一个选择填充选择选项</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bf725b429eab7d9210e9aba482c32ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xbv4lRHyC0Dnoji4"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@heyfaisal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Faisal M </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="efbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从<a class="ae kv" href="https://docs.djangoproject.com/en/3.1/ref/contrib/admin/" rel="noopener ugc nofollow" target="_blank"> Django管理界面</a>管理数据应该快速而简单，尤其是当我们有大量数据需要管理的时候。</p><p id="843b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了改进这个过程，也为了让你更容易理解，我们将在这里用一个我在一个项目中经历过的真实场景来工作。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="153f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">场景</strong></h1><p id="5d17" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">该场景是为电子商务网站添加Django administration的产品。</p><p id="b005" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有三个表:类别、子类别和产品。</p><p id="92d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个产品都与一个类别和一个子类别相关，子类别也与一个类别相关。你可以在下面看到所有三个表的模型。</p><p id="b8a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">产品需要填充这些字段:名称、Slug、类别、子类别(应该与一个类别相关)和描述。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/77f96b7aca3c22e24d488eda925a48ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*XWpY9hHtpwt8fd9B3WcpPg.png"/></div></figure><p id="2f2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">插入新产品时，有两个下拉选择字段(类别和子类别)。</p><p id="137d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">这里的问题是:</strong>当我填写名称和slug，然后选择我要添加的产品的类别时，我得到了子类别的下拉列表中的所有项目，甚至是不属于所选类别的项目。因此，我需要填充下拉子类别中与所选类别相关的项目。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="39dd" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结果预览</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/ca92245891ed92370203ef0e705f0f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WfEOUVkR-riCelQNPd6UNQ.gif"/></div></div></figure><p id="ea9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我将向你展示我找到的解决这个问题的正确方法。这很容易实现——只要仔细遵循这三个步骤。但首先，这是我的设置:</p><p id="aee2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python →3.7</p><p id="1cb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">姜戈→2.2.4</p><p id="fd12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JQuery →3.2.1</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="2210" class="nd ma iq mz b gy ne nf l ng nh">&lt;script <em class="ni">src</em>="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"&gt;&lt;/script&gt;</span></pre><p id="59ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是三张桌子的模型。</p><h2 id="a155" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">类别表的模型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="cb2b" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">子类别表的模型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="6cc8" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">产品表的模型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0e06" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">解决办法</h1><h2 id="d46f" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">1.创建视图</h2><p id="6ed3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">要填写子类别字段下拉列表中的项目，您必须创建一个视图来响应<code class="fe nw nx ny mz b">JSON</code>数据。</p><p id="c216" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nw nx ny mz b">views.py</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="7b1d" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">2.添加图案</h2><p id="dbae" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在<strong class="ky ir"> <em class="ni"> </em> </strong> <code class="fe nw nx ny mz b">urls.py</code>处，需要添加一个图案才能到达视图:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="1239" class="nd ma iq bd mb nj nk dn mf nl nm dp mj lf nn no ml lj np nq mn ln nr ns mp nt bi translated">3.添加JavaScript代码</h2><p id="aa6a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在你必须为你的产品应用程序覆盖Django admin的<code class="fe nw nx ny mz b">change_form.html</code> <em class="ni"> </em>来添加一些JavaScript代码来完成这个魔术。</p><p id="4003" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个文件的位置并不重要。你可以把它放在你的应用程序中，它仍然可以工作。只要姜戈能发现它的位置。更重要的是，HTML文件的名称<code class="fe nw nx ny mz b">change_form.html</code>必须与Django提供的原始HTML文件名相同。</p><p id="3a33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nw nx ny mz b">change_form.html</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="4e04" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="1489" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">就这样，现在下拉选择子类别中的项目列表中的项目与所选择的类别相关。</p><p id="a3f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有这个问题的另一个解决方案，请在下面随意提出来，以增加我们与Django框架的技能，特别是使Django管理界面成为一个更强大的工具。</p></div></div>    
</body>
</html>