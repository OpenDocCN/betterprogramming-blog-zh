<html>
<head>
<title>Converting a Node.js Script Into a Desktop Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Node.js脚本转换为桌面应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/converting-a-node-js-script-into-a-desktop-application-844c328e2858?source=collection_archive---------12-----------------------#2020-12-09">https://betterprogramming.pub/converting-a-node-js-script-into-a-desktop-application-844c328e2858?source=collection_archive---------12-----------------------#2020-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="159b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是一个简单的脚本如何变成一个漂亮的桌面应用程序的故事</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/08f86bf4bb6bc5d749bcca4d31be715a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Hdz0gZL8WeJXEXe"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯多夫·高尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="1f54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我如何将一些基本的UI设计概念、Node.js、JavaScript、Swift、HTML和CSS的知识放入一个电子容器中，以创建一个非常好看的应用程序，允许iOS开发者将那些旧的XIB文件转换为Swift代码。</p><p id="3006" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了解释这个工具是如何诞生的，我将使用克里斯托弗·诺兰的蝙蝠侠电影(我喜欢这个三部曲)。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8c28" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">开始</h1><h2 id="c478" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">创造核心</h2><p id="e719" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">不，这里没有涉及某人父母的悲惨事故。但是有一个关于伟大事物如何诞生的故事。</p><p id="7536" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一切都是从学习如何创建XIB文件开始的。当你打开故事板或XIB文件时，有时Xcode会神奇地改变一些属性，即使你还没有接触过它。我对此非常好奇，想知道这些XIB文件的内容以及它们为什么会改变。</p><h2 id="b2f1" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">核心</h2><p id="b305" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我做的第一件事是创建一个脚本，将<strong class="ky ir"> </strong> XML文件转换成JSON文件，并给对象一个更好、更直观的表示。我使用Node用JavaScript编写了这个脚本，因为我以前是一名全职的Node开发人员，仍然有一些技能。就像一个叫ras al Ghul<strong class="ky ir"/>的家伙把那些技能传给了我。</p><p id="4a85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我发现一般变化的值是Xcode用来标识那些元素的某种键。但是我的好奇心更进一步。</p><p id="34c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我遍历转换后的XML文件的JSON对象时，我看到了一些模式，并开始编写一些函数来将这些对象组合在一起。然后我意识到我已经按类型对所有视图进行了分组。</p><p id="76c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那一刻，我想，“嘿，我可以用这个做很多事情。”我开始编写一个map类，它将接受对象数组，并将它们转换成UIKit元素。</p><p id="614e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个工具的核心就是这样诞生的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/87694619e931607a8272df937abc6ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMuqVgBYD35WJHYxIq3eug.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是映射器的外观</p></figure><h2 id="9225" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">名字</h2><p id="f432" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">创建这个脚本后，我开始在一些必须迁移到Swift代码的视图中使用它。为了在终端中使用这个工具，我必须给出一个名称，这样我就可以更容易地记住每次想要运行脚本时要执行的命令。我把它叫做<em class="nj"> xtos </em>，是Xib到Swift的缩写。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/4236473d543165bd4d2ae0b3c419bed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHGjPlo_EGmwzM4qBYEnFA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在终端中使用xtos</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a8e4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">黑暗骑士</h1><h2 id="6d98" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">构建用户界面</h2><p id="16c5" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">很多人认为小丑只是一个戴着面具的恶棍。其他人认为他是其他事物的代表。一些开发者认为UI设计师是某种恶棍，但我真的认为他们是我们用户想要的代表。</p><p id="eb85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在使用该脚本一段时间后，我认为如果它有一些接口就好了，这样就不必在终端中运行脚本和更改参数。</p><p id="ab58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我开始考虑我的应用程序应该是什么样子时，我首先开始寻找某种灵感。我发现了许多不同类型的转换工具。有些是全屏幕格式，有些是固定大小，占用最小的空间。我更喜欢固定的尺寸，因为我相信屏幕空间是所有桌面开发者都应该关心的事情。我们必须允许用户在同一个屏幕上同时打开多个工具。当我们的应用程序的初始输入是通过拖放文件时，这允许更好的可用性。</p><p id="f195" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我首先画了一个视图，它只有必要的部分:一个拖动XIB文件的部分，一些用于某种品牌的部分，也许还有一些描述。这是初稿:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/f22dd4e48d549b4b69b721d2980a720b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iCze-Ru104fPDG6W4RBMIA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">xtos第一稿</p></figure><p id="42fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">画完我想要的东西后，我已经有了一些开始的东西，所以我创建了三个可能是我的工具的表面的线框:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/5acb34db61fc244a66258f9f857bb9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAr-auI1iZ5UPMGWEcw2Cg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">xtos线框</p></figure><p id="0891" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我画了线框并有了一个更图形化的应用程序外观之后，我决定使用最后一个版本，因为我发现它完全符合我对应用程序的期望。</p><h2 id="3575" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">身份</h2><p id="96bb" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">选择了线框之后，我需要创建UI并给我的应用程序赋予一些身份。</p><p id="1e99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一步，我首先打开Adobe XD并开始构建组件库和界面，总是使用所选的线框作为参考。</p><p id="2cc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我选择了一个符合我正在做的事情的调色板，所以我考虑了像Xcode背景、XIB文件的图标颜色和Swift标志颜色这样的东西。我已经有三种颜色了。为文本、成功屏幕、错误屏幕和按钮添加一些颜色。对于文本，我选择了Roboto字体。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/04cb7d1cb91308387ef4fd3e23f663b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*C5XrRKIZ37baqX9P0GdjFQ.png"/></div></figure><p id="4f39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了这个标志，我请了一位设计师。logo有一个带粒子效果的S，但是为什么是粒子呢？在我的脑海中，一个转化最有代表性的事情之一就是我们在高中看到的那些化学转化过程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/e0b57b6db7d45799829231f53e40577f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XrYfKfrcSiMMfI_VrY0dg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">xtos徽标</p></figure><p id="1dd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在有了徽标、线框和视觉库，是时候构建UI了，所以我为应用程序创建了三种状态:</p><ul class=""><li id="99d7" class="nn no iq ky b kz la lc ld lf np lj nq ln nr lr ns nt nu nv bi translated">默认:这是应用程序的初始状态(当我打开它并且还没有处理任何文件时)。</li><li id="5b53" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">成功:此状态用于当您已经处理了一个文件并且一切都成功时。</li><li id="8fc8" class="nn no iq ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">错误:所有应用程序都必须有一个错误屏幕。这是错误处理的通用概念。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/7e4fbc629c6107dace5f12593cd62466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09fQ4l9-FYY3LkNdZuYlzQ.png"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="59bd" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">黑暗骑士崛起</h1><h2 id="b056" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">更大事物的崛起</h2><p id="5e5d" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">许多开发人员创建小脚本来帮助他们完成任务。我们今天使用的许多工具都来自那些将脚本从黑暗带到光明的开发人员。正如贝恩所说，“你以为黑暗是你的盟友？但你只是接受了黑暗。我出生在里面。被它塑造了。”</p><p id="1237" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我开始用纯HTML和CSS制作应用程序。<strong class="ky ir"> </strong>我知道，你在说“为什么？”嗯，我很想说这是用React、Vue或更专业的东西完成的，但事实是我只是在做一个供我个人使用的工具，所以我只是放了几个<code class="fe oc od oe of b">divs</code>，添加了一些JavaScript，就这样。用那可怕的普通HTML代码构建UI只花了一天时间，但它成功了。</p><p id="c7a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我在写HTML代码时，我意识到背景太单调了。这是我不能允许的。为了解决这个问题，我添加了一个包含一个名为<code class="fe oc od oe of b">particle-js</code>的类的<code class="fe oc od oe of b">div</code>,当它打开时，这个类给了应用一个粒子动画。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/31815689a62ac992ee13673853473f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYWjNmR47PC6Y07iA0J44A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是xtos用户界面所需的所有HTML代码。</p></figure><h2 id="12d1" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">把所有的放在一起</h2><p id="c0ed" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">一旦我有了界面的HTML代码，就该把所有的部分放在一起，准备像其他应用程序一样使用这个工具了。</p><p id="d149" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是怎么做呢？嗯，这就是<a class="ae kv" href="https://www.electronjs.org" rel="noopener ugc nofollow" target="_blank">电子</a>登场的地方。</p><p id="d5b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">把所有的代码放在一个电子容器里是非常容易的。我只需要启用一些允许我在HTML中运行节点的设置，但仅此而已。</p><p id="024f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我将监听器添加到拖放区<code class="fe oc od oe of b">div</code>，以允许所需的行为，让用户在这里留下一些文档。在这样做之后，我只是抓取文档并内部调用xtos内核来进行转换。把这些碎片拼在一起真的很容易。</p><p id="f7bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了导出文件，我使用了来自电子API的<code class="fe oc od oe of b"><a class="ae kv" href="https://www.electronjs.org/docs/api/dialog" rel="noopener ugc nofollow" target="_blank">showOpenDialog</a></code>函数，并使用<a class="ae kv" href="https://nodejs.org/api/fs.html" rel="noopener ugc nofollow" target="_blank"> fs lib </a>编写了一些代码，将文件复制到用户选择的目标路径。</p><p id="6ff1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在所有这些编程、身份创建、界面设计和编译过程之后，这位黑暗骑士崛起了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c371244d36058737ee26a44368463c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/1*lV7mQw_aOL2kwFi5E7lX8A.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">xtos</p></figure><p id="7008" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一步是发布工具。</p><p id="a245" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要发布到商店，我必须登录，然后上传。我用的<a class="ae kv" href="https://www.electron.build" rel="noopener ugc nofollow" target="_blank">电子生成器</a>包装类型<a class="ae kv" href="https://www.electron.build/configuration/mas" rel="noopener ugc nofollow" target="_blank"> MAS </a> <strong class="ky ir"> </strong>然后送到商店。</p><p id="6da6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。现在每个人都可以使用我的工具。</p><p id="364b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以在<a class="ae kv" href="https://apps.apple.com/us/app/xtos/id1543113295" rel="noopener ugc nofollow" target="_blank"> App Store </a>下载xto。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8915" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">下一步是什么？</h1><p id="4940" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">有许多工作要做。我需要添加约束支持，支持非CocoaTouch XIB文件，按钮，动作连接，和一些更多的东西。</p><p id="41a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一件好事是启用SwiftUI转换选项。你能想象把你的XIB文件直接转换成SwiftUI类吗？嗯，我希望我能很快做到这一点。</p><p id="a23d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前，我不打算将这段代码开源，因为它有点乱。我正在将核心从JavaScript迁移到TypeScript，并将React用于用户界面。然后我计划使用一个稍微更优化的<a class="ae kv" href="https://github.com/electron-react-boilerplate/electron-react-boilerplate" rel="noopener ugc nofollow" target="_blank">电子样板</a>。</p><p id="6aa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有任何改进工具的想法，请在评论中告诉我。</p></div></div>    
</body>
</html>