# @ngrx/data 将改变你的生活

> 原文：<https://betterprogramming.pub/ngrx-data-will-change-your-life-8528736e4fc0>

## 移除 React 样板文件并简化您的代码库

![](img/2f13d36611e66cc6e5fb862a08176c9d.png)

由[本·怀特](https://unsplash.com/@benwhitephotography?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

我已经使用某种形式的 [Redux](https://redux.js.org/) 模式好几年了，除了一些小的例外，我每次都在做同样的事情——创建实体、读取它们、更新它们、删除它们。

CRUD 应用程序仍然是我作为前端开发人员的主要工作。我脑海深处的一个小小的声音告诉我，我应该找到一种方法来减少我一直在写的锅炉板，但我脑海中的一个更大的声音却在津津乐道于通过每次连续的实施来调整我的方法。

我将是第一个承认某些 [NgRx](https://ngrx.io/) 感觉有些过头了——我很少使用像`createSelector`这样的东西，也很少使用副作用。

大多数时候，我觉得自己做得“不对”，但对我来说已经足够对了。尽管如此，我还是有点希望下一次我可能会灵光一现，引导我去做“正确的”事情。

然后，我参加了约翰·帕帕和沃德·贝尔在 AngularConnect 2019 举办的研讨会，当时他们用 [@ngrx/data](https://ngrx.io/guide/data) 把我的小脑袋轰出了脑壳。

这是我一直在等待的库，但为了确保我们都在同一页上，让我们谈谈我如何用@ngrx/store 来做这些事情。

声明:我没有测试就凭记忆写了下面的片段——它们缺少了一些，如果它们真的能工作，我会很惊讶。然而，它们大部分是正确的，并且代表了我试图展示的工作类型。

简单客户商店的操作和缩减器

上面的代码片段缺少一些明显的部分:它们没有连接到`AppModule`并且对持久化数据没有影响。

但是你可以看到，对于一个相对简单的例子，总共有 62 行代码。这并不可怕，而且对于采用一种随着应用程序增长而难以置信地扩展的模式来说，这是很小的代价。

但是当您想要实现另一个实体类型的状态(例如，产品、订单等)时，您将不得不编写同样的 62 行代码。).

除此之外，从 API 获取数据的效果是另一个很大的时间消耗，需要您考虑数据加载时的信号等问题(通常，您将通过 API 加载，延迟可能是一个问题)。

也许更重要的是，这是你必须为之编写测试的所有代码，因为这是你编写并控制的代码。我倾向于发现 Redux 使编写测试变得更容易，但是如果你要对你存储的每个实体类型做同样的事情，仍然有很多工作要做。

这就是`@ngrx/data`的用武之地。作者已经确定了这些数据之间的共性，并编写了一个库来处理这些数据。您需要做的只是提供一个配置。这里有一个例子:

这已经减少到 22 行代码了。还有这个:它包含了一个默认行为，通过一个使用效果的 RESTful API 持久化数据。它假设您使用正确的 HTTP 动词与 API 进行交互。

例如，如果您有以下端点，`DefaultDataService`将通过 REST 持久化数据，无需配置:

*   /API/客户(后)
*   /api/customer/:id(获取、放置或删除)
*   /API/客户(GET)

如果你根本不想要任何效果，你可以很容易地配置你的商店不使用任何效果。如果您希望以另一种方式持久化数据，可以通过编写自己的数据服务来实现。

例如，我想为我正在构建的手机应用程序将实体数据持久化到本地存储，所以我编写了这个服务:

LocalStorageDataService 示例

您可以在自己的工作中随意重用它——它并不完整，但演示了如何连接除默认行为之外的其他行为。

重要的部分(除了实际的服务)是你注册服务的地方(见`AppModule`的构造函数)。美妙之处在于，这个服务可以用于任何类型，尽管它假设存在 ID 列。

# 结论

对于任何对 Redux 感兴趣的开发人员来说，学习@ngrx/data 都是非常值得的——无论您是否已经在使用 ngrx(这种情况下，它将节省您的时间),或者您是否因为它看起来令人生畏而从未迈出这一步(在这种情况下，它将为您打开大门)。

您需要测试的东西更少，需要实现的东西更少，需要担心的东西更少。

该文档是一个福音，您绝对应该用一个简单的应用程序来尝试一下。

它与常规 NgRx 配合得很好，所以您可以将实体数据与更多定制的状态管理混合和匹配。去 https://ngrx.io/guide/data 的[看看吧。](https://ngrx.io/guide/data)