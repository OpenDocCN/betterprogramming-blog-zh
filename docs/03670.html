<html>
<head>
<title>Notes to Myself on Software Rewriting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于软件重写的笔记</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/notes-to-myself-on-software-rewriting-14508205331b?source=collection_archive---------14-----------------------#2020-02-25">https://betterprogramming.pub/notes-to-myself-on-software-rewriting-14508205331b?source=collection_archive---------14-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="743c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们是在重构还是重写？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/caed82ed8e646fa7ee943447eeca3c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v8V6a92NJjavRT69"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@andrewtneel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安德鲁·尼尔</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><blockquote class="kz"><p id="2f16" class="la lb it bd lc ld le lf lg lh li lj dk translated"><em class="lk">“从头重写一个系统本质上是承认一个设计师的失败。它在陈述:“我们没能设计出一个可维护的系统，所以必须重新开始。"— Max Kanat-Alexander，</em> <a class="ae ky" href="http://shop.oreilly.com/product/0636920022251.do" rel="noopener ugc nofollow" target="_blank"> <em class="lk">代码简洁</em> </a></p></blockquote><p id="bb9c" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt lu lv lw lx ly lz ma mb mc md me mf lj im bi translated">所以，和其他软件设计师一样，我也经历过软件重写的过程，我承认我们没能设计出我们的软件。我从那个令人筋疲力尽的过程中学到了很多，在这里我要分享一些让我难忘的经验。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="5676" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">重写代码是开发人员的错觉，在大多数情况下不是解决方案</h1><p id="9da3" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">当您的代码遇到问题时，诊断问题到底是什么非常重要。正如每个开发人员都会做的那样，您最初的想法不应该是重写。这只是一种错觉。</p><p id="603f" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">这是一种错觉，因为你正在努力阅读别人的代码，你认为如果你从头开始重写，你会做得更好。然而，作为开发人员，我们一次又一次地陷入这个陷阱。重写看起来很容易，因为你不必去读别人的代码，你不必浪费时间去修改小块的代码并再次测试以确保你没有破坏任何东西。</p><p id="9c3c" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">你下意识地选择了更容易的方式，但在这一点上，你陷入了另一个陷阱。有人在阅读你的代码时会有同样的想法。甚至有很大的可能，你以后会不喜欢自己重写的代码。当这种情况发生时，你会再次考虑重写代码吗？因此，当你想从头开始重写代码时，请记住这些事实。请记住，在大多数情况下，这是一个陷阱。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="0f8e" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">在进行代码重写之前，请考虑重构</h1><p id="125d" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">有针对性的重写对于处理代码库中最严重的错误非常有用。如果可以限制范围并解决大部分问题，就不要完全重写。</p><p id="d421" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">例如，你的软件加载很慢。但这只影响到项目的一小部分。这些问题可以解决，一次一个，通过小心地移动代码，重构，改变接口。你没必要重写整本书。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="dfc1" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">当心。这是一条比你想象的更长、更难、更容易失败的道路</h1><p id="9f19" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">事实是，开发人员通常在错过截止日期后才意识到这一点:所有事情花费的时间都比你想象的要长。</p><p id="b39e" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">对重写成本的估计要非常悲观。它几乎总是比你想象的花费更多，时间更长。总会有很多的复杂性，这将使重写过程更加困难和痛苦。最终，失败的可能性是很难被忽略的。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="a23f" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">确保新产品能更好地解决用户的问题(或者至少是相同的)——更差的是不可接受的</h1><p id="174c" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">重写对客户没有直接影响/好处。你的用户不关心你的代码。他们只想解决自己的问题。仅此而已。在他们看来，如果你的产品适合解决他们的问题，你就是成功的。否则，他们不会使用该产品。</p><p id="8cf5" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">他们不在乎你的重写决定，所以重写的版本至少要和旧版本一样高效。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="4b50" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">继续维护和支持现有产品</h1><p id="9f4c" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">在我参与的一个重写故事中，我们一年没有给用户任何更新。在我们今天生活的世界里，这太漫长了。我们的产品仍然足够好，但是用户抱怨没有更新。</p><p id="4b1d" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">永远不要停止维护一个正在使用的系统，这样程序员就可以重写它。在重写过程中，仍然需要维护旧代码。</p><p id="0c7c" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">当你重写旧代码的时候，应该给用户一些小的更新和错误修正。否则，你将面临失去你的客户。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="0bfb" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">让用户尽快参与设计过程</h1><p id="70b7" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">总是定期向您的最终用户展示您当前的进展，以便他们可以帮助您抓住最严重的问题。</p><p id="cee5" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">尽快与你的用户见面是很重要的。他们的反馈将帮助你根据他们的需求设计新产品。不要实现任何不必要的功能。这将使您免于拥有复杂的代码库。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="4401" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">保持团队在同步的产品上工作</h1><p id="3da7" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">产品不仅仅是关于编程团队的。营销、支持、编程、设计……许多团队都在从事这项工作。通过定期更新重写过程来保持同步。</p><p id="39f6" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">就我们而言，我们已经处理了许多问题。例如，营销团队正在准备我们的产品测试活动，他们必须确切地知道产品方面发生了什么，以便他们可以为客户准备好即将到来的产品变化。</p><p id="28cb" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">有时，我们在没有通知他们的情况下做了一些改变。这导致他们从头开始准备竞选活动。不要无效率地浪费任何人的时间。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="914d" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">不要对产品做太大的改动</h1><p id="0d79" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">了解你的产品的优缺点是很重要的。不要改变强势的一面，用户喜爱的一面。如果用户对你的UI很满意，就不要改了。</p><p id="5dc3" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">做最小的改变和小的UX改进。当你用新的软件替换现有的软件时，你的用户不应该对新的巨大变化感到困惑。</p><p id="c1f4" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">有很多情况下，用户放弃了新产品，因为他们没有找到与前一个产品提供的相同的功能。不要让同样的事情发生在你身上。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="f954" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">不要让你的产品只依赖于一个开发者</h1><p id="3bbd" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">在我的案例中，我们的主要程序员之一是我们软件的负责开发人员。因为他是管理人员，他还必须处理其他问题。</p><p id="469d" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">由于他的职位，我们的产品开发进展缓慢。即使是很小的变化也需要几个星期，有时甚至几个月。关键是要一直保持前进。永不停止。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="daf4" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">迁移应该缓慢而稳定</h1><p id="67cb" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">当你确定新的软件已经准备好的时候，用新的替换你原来的软件。一步一步来。</p><p id="24a1" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">首先，从一个小型的私人测试团队开始，将你的产品加入到这个团队中。不断收集反馈和崩溃报告，修复bug，迭代新版本，同样的事情再来一遍。遵循这个循环，直到你确保你的产品准备好公开测试。</p><p id="0e1a" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">当你进行公开测试时，反馈将再次成为你最好的朋友。你的首要目标应该是确保你的产品能够解决用户的问题。</p><p id="3cc5" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">当您确信您提供的功能与旧软件相同或更好时，就可以进行替换了。为新用户发布新软件，并将现有用户迁移到新用户。</p><p id="5624" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">这些是我从重写过程中学到的关键经验。重写几乎是答案。通常，重构是更好的选择。我强烈建议使用重构这种缓慢的方法。风险更小，而且你能让你的顾客满意。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="0bb4" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">何时重写代码</h1><p id="f871" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">有些时候重写是合适的。如果我可以列出何时重写代码的清单，这将是我的清单:</p><h2 id="46ee" class="nq mo it bd mp nr ns dn mt nt nu dp mx lu nv nw mz ly nx ny nb mc nz oa nd ob bi translated">切换到另一种语言或平台</h2><p id="3bfb" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">这种语言太古老了。很难找到开发商，或者你必须花很多钱去找一个。在这两种情况下，太多的努力。</p><h2 id="9956" class="nq mo it bd mp nr ns dn mt nt nu dp mx lu nv nw mz ly nx ny nb mc nz oa nd ob bi translated">现有的代码库不再可维护</h2><p id="0e6a" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">你如何决定你的代码是不可维护的？</p><p id="7857" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">这很难确定，但是如果即使是很小的改变都很难做到，如果新的更新花费的时间比平时长，如果任何新的改变影响了软件的其他部分并引入了新的错误，那么你的软件就是不可维护的。</p><h2 id="7e3c" class="nq mo it bd mp nr ns dn mt nt nu dp mx lu nv nw mz ly nx ny nb mc nz oa nd ob bi translated">您有足够的资源来同时维护现有系统和设计新系统</h2><p id="c52e" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">永远不要停止维护一个正在使用的系统，这样程序员就可以重写它。如果系统在使用中，必须经常维护。</p><p id="bc0c" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">请记住，您的个人注意力也是这里必须考虑的一个资源——如果您打算同时在新系统和旧系统上工作，那么您每天是否有足够的时间同时在新系统和旧系统上工作？</p><h2 id="4162" class="nq mo it bd mp nr ns dn mt nt nu dp mx lu nv nw mz ly nx ny nb mc nz oa nd ob bi translated">团队中的开发人员是软件的瓶颈</h2><p id="1ca0" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">这不应该成为从头重写代码的理由。你可以随时在团队中更换开发人员，或者雇佣新的开发人员来消除瓶颈。</p><p id="8001" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">但是，有时，您可能需要选择重写选项。软件是用旧技术编写的，而你的一个主要开发者是开发它的唯一负责人。</p><p id="5c56" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">你可以试着找一个对你所依赖的旧技术有经验的新开发人员，但是我警告你，这是一个困难的过程，需要太多的时间。</p><p id="93b6" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">即使你能找到一个新的，雇佣他们可能会非常昂贵。所以，加上其他条件，这可能是你决定重写代码的清单。</p><h2 id="dd9e" class="nq mo it bd mp nr ns dn mt nt nu dp mx lu nv nw mz ly nx ny nb mc nz oa nd ob bi translated">这个软件是长寿的(我说的是10-20年或更久)</h2><p id="60ec" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">随着时间的推移，维护变得越来越昂贵。这是因为代码变得越来越杂乱，因为为了快速维护补丁而牺牲了原来的架构。</p><p id="fe17" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">此外，开发旧技术的人越来越少，也越来越贵。</p><p id="f2aa" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">最后，硬件开始老化，越来越难找到新的硬件、操作系统、框架等。在其上运行旧的应用程序。</p><p id="b940" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">此外，业务不断发展，旧系统很可能无法满足组织的业务需求。</p><p id="7c58" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">因此，你必须权衡所有持续的维护成本，以及新系统的潜在好处，与从头重写系统的成本。</p><p id="e569" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">如果你的案例符合以上一个或多个要点，你可能处于可以重写的情况。</p><p id="ce55" class="pw-post-body-paragraph ll lm it ln b lo nk ju lq lr nl jx lt lu nm lw lx ly nn ma mb mc no me mf lj im bi translated">否则，正确的做法是通过一系列简单的步骤改进系统的设计来处理现有系统的复杂性，而不需要重写。</p><blockquote class="kz"><p id="a472" class="la lb it bd lc ld oc od oe of og lj dk translated">从头重写你的代码可能是你犯的最大的错误，但是同样的，不重写你的代码也会导致同样的结果—  <a class="ae ky" href="https://programmingisterrible.com/post/73023853878/getting-away-with-rewriting-code-from-scratch" rel="noopener ugc nofollow" target="_blank"> <em class="lk">从零开始重写代码。</em> </a></p></blockquote><p id="13d4" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt lu lv lw lx ly lz ma mb mc md me mf lj im bi translated">这里有一条建议。重构应该是第一选择。</p></div></div>    
</body>
</html>