<html>
<head>
<title>Let’s create an Instagram bot to show you the power of Selenium!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们创建一个Instagram bot来向您展示硒的威力！</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lets-create-an-instagram-bot-to-show-you-the-power-of-selenium-349d7a6744f7?source=collection_archive---------0-----------------------#2018-09-11">https://betterprogramming.pub/lets-create-an-instagram-bot-to-show-you-the-power-of-selenium-349d7a6744f7?source=collection_archive---------0-----------------------#2018-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1945" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你将能够把你学到的东西应用到任何网络应用程序中。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d751f20739309571e1eb04a9ef70567d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPCyUqPjBd66Wl6bvBaLOg.jpeg"/></div></div></figure><p id="eaf8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">简介</strong></p><p id="abad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是他们<a class="ae lq" href="https://www.seleniumhq.org/" rel="noopener ugc nofollow" target="_blank">官网</a>给出的硒的定义:</p><blockquote class="lr"><p id="d784" class="ls lt it bd lu lv lw lx ly lz ma lp dk translated">Selenium自动化浏览器。</p></blockquote><p id="50ed" class="pw-post-body-paragraph ku kv it kw b kx mb ju kz la mc jx lc ld md lf lg lh me lj lk ll mf ln lo lp im bi translated">就是这样。这是硒是什么的最有代表性的定义。有了这个库，你将能够控制网络浏览器并与网站互动。最初创建它是为了在开发中的web应用程序上运行测试，但是它也可以用作web抓取工具，或者作为创建bot的一种方式。</p><p id="8bd4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我们将创建一个简单的Instagram机器人，向您展示Selenium的能力。</p><blockquote class="mg mh mi"><p id="407f" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated">为什么我们不使用像Scrapy或Requests这样的库来执行我们的机器人所需的操作？</p></blockquote><p id="243d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">原因是Scrapy或Requests在Javascript制作的网站上表现不佳。我们使用Selenium是因为它能够用Javascript以及Chrome或Firefox等普通浏览器呈现页面。</p><h2 id="6ce5" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">我们希望为我们的机器人实现哪些功能？</h2><p id="18bb" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">本文的目标是向您概述Selenium提供的可能性，因此我无法向您展示如何在Instagram上编写我们的机器人可能的每一个动作，但是通过阅读本文您将获得的知识，您将能够自己添加缺失的功能。现在，我们的机器人应该能够执行以下操作:<br/> -登录。<br/> -关注用户<br/> -取消关注用户<br/> -获得用户的关注者</p><h2 id="aca1" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">剧本的架构</h2><p id="3b0b" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">为了保持我们的代码在其他项目中有组织和可重用，我们将把代码放在一个名为InstagramBot的类中。机器人能够采取的每一个行动都是一种方法。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5cf6" class="mn mo it nm b gy nq nr l ns nt">class InstagramBot():<br/>   def __init__<br/>   def signIn<br/>   def followWithUsername<br/>   def unfollowWithUsername<br/>   def getUserFollowers<br/>   def closeBrowser<br/>   def __exit__</span></pre><h2 id="0716" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">我们开始吧</h2><p id="b1bd" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">首先，让我们通过运行以下命令来安装Selenium:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="b427" class="mn mo it nm b gy nq nr l ns nt">pip install selenium</span></pre><p id="c89d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装完成后，在你选择的文件夹中创建一个文件名为<strong class="kw iu"> <em class="mj"> main.py </em> </strong>的文件。</p><p id="3528" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们需要在脚本中从Selenium导入<strong class="kw iu"> webdriver </strong>对象。这将允许我们用自己的代码控制Chrome。</p><p id="83a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">构造函数将用户的邮件和密码作为参数。我们还在这个方法中创建了我们的<strong class="kw iu"> webdriver </strong>,并使它可以被类的其余部分访问。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><blockquote class="mg mh mi"><p id="cbc7" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong>如果你的机器上没有安装Chrome或者<code class="fe nw nx ny nm b">webdriver.Chrome()</code>抛出错误，你需要从<a class="ae lq" href="http://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>下载ChromeDriver。(选择与您的操作系统兼容的版本)。然后只需将ChromeDrive的路径作为该方法的第一个参数。例如，如果你的操作系统是Windows，ChromeDriver在你脚本的同一个文件夹里:<code class="fe nw nx ny nm b"><em class="it">webdriver.Chrome('chromedriver.exe')</em></code></p></blockquote><p id="9f20" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们定义一下<strong class="kw iu">登录</strong>方法。我们的机器人将访问这个URL<a class="ae lq" href="https://www.instagram.com/accounts/login/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/accounts/login/</a>，并用构造函数中初始化的电子邮件和密码完成登录表单。</p><p id="9345" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您查看页面，您会注意到只有两个<input/>可用。第一个总是接受电子邮件，第二个接受密码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/4593f40a09714ec30b42f951c0e2a07e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZedZ0uwbxnBhaKkIK90qkg.png"/></div></div></figure><p id="53cc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这意味着我们可以选择这两个输入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9ce2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们只需在Selenium的帮助下完成它们，就可以发送表单了。为此，我们将使用<strong class="kw iu">。send_keys </strong>方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="56ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">硒将把邮件和密码写在相应的<em class="mj"> &lt;输入&gt; </em>。</p><p id="0056" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们需要做的最后一件事是发送表单。我们可以选择按钮并模拟点击，但是有一个更快的方法:一旦输入被聚焦，大多数表单可以通过按回车键来发送。这意味着在我们的例子中，我们将简单地告诉Selenium在输入密码字段后按回车键。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9ab7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们已经完成了登录方法！</p><p id="86dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我冒昧地在方法的末尾添加了<code class="fe nw nx ny nm b">time.sleep(2)</code>，让您有一点时间来看看脚本运行时发生了什么。</p><p id="513a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到目前为止，我们的代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6d46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您已经可以通过在文件末尾添加以下行来测试它(不要在类内部添加它！)</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="6b82" class="mn mo it nm b gy nq nr l ns nt">bot = InstagramBot('youremail', 'yourpassword')<br/>bot.signIn()</span></pre><p id="7ebd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们打开终端并运行以下命令:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="ffb8" class="mn mo it nm b gy nq nr l ns nt">python main.py</span></pre><p id="14a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Chrome的一个新实例应该会打开Instagram登录页面。输入应该已经完成，几秒钟后，您应该会被重定向到您的主页。</p><blockquote class="mg mh mi"><p id="a583" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated"><strong class="kw iu">注:</strong> Instagram是一个复杂的web应用。完全有可能在你登录后，Instagram会显示一个页面，询问你是否要下载他们的移动应用程序，而不是将你导向你的主页。也有可能你会在另一个页面上看到另一张要求你确认身份的表格。为了简短起见，我不会在本文中讨论这些可能性，但是我邀请您实现自己的解决方案作为练习。</p></blockquote><h2 id="9314" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">让我们跟着人走</h2><p id="a952" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">如果你想在Instagram上关注一个用户，最常见的方法是进入他们的页面，点击“关注”按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/2aa459c69e255d91cae1058cf0c3f2c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*T3AUHUtv7nbltNdY1Wnufw.png"/></div><p class="ob oc gj gh gi od oe bd b be z dk translated">Instagram个人资料布局示例。</p></figure><p id="9eff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们检查这个页面，我们会注意到上面有三个不同的按钮,“Follow”是列表中的第一个按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/545950ad9c59f73df9a7b605ab8f7a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*1y1IeslbWwGgcnnMPeMLWQ.png"/></div></figure><p id="e80c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以得出结论，可以使用以下代码选择“Follow”按钮:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><blockquote class="mg mh mi"><p id="860f" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong>注意，使用CSS选择器选择元素有两种方法:<br/> - <em class="it">。find _ element _ by _ CSS _ selector()<br/>-。find _ element</em><strong class="kw iu"><em class="it">s</em></strong><em class="it">_ by _ CSS _ selector()<br/></em>第一个会返回页面上我们搜索对应的第一个元素。第二个函数将在一个数组中返回页面上找到的所有元素。</p></blockquote><p id="aa7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了这些信息，让我们开始实现我们的<strong class="kw iu"> followWithUsername </strong>方法。</p><p id="35e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该方法将我们想要跟踪的人的用户名作为参数。然后我们告诉Selenium进入这个人的页面，选择“关注”按钮并点击它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a342" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种方法还有一个问题。如果我们已经在关注某人，Selenium仍然会进入那个人的页面，点击它找到的第一个按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/471c1c68488d3095330e60184d53e539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tOiQzXjNKyicWmbqNN68tA.png"/></div></div></figure><p id="cc42" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这种情况下，找到的第一个按钮是“跟随”按钮。如果我们点击它，Instagram会显示一个模式，询问我们是否要取消对该人的关注。这不是最佳选择。我们可以重构我们的<strong class="kw iu"> followWithUsername </strong>方法，在点击之前检查按钮文本是否不等于“Following”。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e73f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就结束了我们的<strong class="kw iu"> followWithUsername </strong>方法…或者也许不是？如果你将浏览器或操作系统的语言设置为英语以外的语言，你可能会遇到一些问题:当你打开Instagram时，他们可能会以你的默认语言显示页面。条件<code class="fe nw nx ny nm b">followButton.text != 'Following'</code>将总是返回真。</p><p id="35fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了解决这个问题，我们可以配置我们的网络驱动程序，使它总是使用英语作为默认语言。Instagram的界面会一直包含相同的文字。为了应用这一点，我们将利用<code class="fe nw nx ny nm b">webdriver.Chrome()</code>方法中的<code class="fe nw nx ny nm b">chrome_options</code>参数。下面是我们重构后的<code class="fe nw nx ny nm b">__init__</code>方法的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="0b0a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第二行，我们设置了一个包含空ChromeOptions的新变量。在下一行，我们指定我们的语言是英语。当我们初始化<code class="fe nw nx ny nm b">webdriver.Chrome()</code>时，我们只需要传递参数<code class="fe nw nx ny nm b">chrome_options</code>。有了这个补丁，我们可以保证我们加载的页面是英文的。</p><h2 id="83ce" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">取消跟随方法</h2><p id="b69a" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">为了实现<strong class="kw iu">unfollowwithnusername</strong>方法，我们可以以<strong class="kw iu">followwithnusername</strong>方法为例。开始是一样的:我们进入用户页面，点击第一个按钮。</p><p id="256b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除了这一次，一个模态将打开，要求确认。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d68e4552257c602ca6f77aad8cebc1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*mcMuHNLx4NJqENb6-lx4fg.png"/></div></figure><p id="7de7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们需要点击“取消关注”按钮来完成操作。在这种情况下，我们将使用XPath选择器，而不是通常的选择器。当我们的选择依赖于元素的文本时，这种方法使得寻找元素变得更加容易。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d8a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，这与我们习惯的工作方式相同:我们用XPath选择器选择一个元素，并模拟单击它。</p><p id="6893" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以在类后使用以下代码测试我们刚刚创建的两个方法:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="e7be" class="mn mo it nm b gy nq nr l ns nt">bot = InstagramBot('youremail', 'yourpassword')</span><span id="3508" class="mn mo it nm b gy oi nr l ns nt">bot.signIn()</span><span id="2595" class="mn mo it nm b gy oi nr l ns nt">bot.followWithUsername('therock')</span><span id="2486" class="mn mo it nm b gy oi nr l ns nt">bot.unfollowWithUsername('therock')</span></pre><p id="55f3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这应该会打开Chrome，登录Instagram，关注“岩石”并取消关注他。</p><h2 id="82f7" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">我们的最后一个特性:获取用户的关注者列表</h2><p id="2d5f" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">让我们开始实现<strong class="kw iu"> getUserFollowers </strong>方法。它需要两个参数:目标的用户名和我们想要获取的追随者链接的数量。</p><p id="253a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要在真正的浏览器上实现这一点，我们必须导航到用户的个人资料，然后单击“x followers”元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/74ff80251eccaffff1ab410e61e67092.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*aE8fYrGvaVf7xANTH6tTFw.png"/></div></figure><p id="bdba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Instagram然后打开一个带有关注者列表的模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/8a7eaa89c9f8dbe03a33ccce5bdc4cd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*c32FW3A7zR4GiP7VLYU0MA.png"/></div></figure><p id="1104" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该列表只包含十几个用户。向下滚动只能得到更多。</p><p id="9732" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以对Selenium应用相同的步骤:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="484f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们分解代码来理解发生了什么:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c3cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们导航到用户的个人资料页面，找到“x followers”按钮并模拟点击它。这时候模态打开了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="7208" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们选择页面上的模态，并计算列表中有多少追随者。为了选择这些元素，我使用了与前面的方法相同的策略。和零件<code class="fe nw nx ny nm b">div[role=\'dialog\'] ul</code>只是有一点小区别。我们说Selenium选择一个<em class="mj">&lt;【div】&gt;</em>内的<em class="mj"> &lt; ul &gt; </em>，其<em class="mj"> "role" </em>属性等于<em class="mj"> "dialog" </em>。我们使用反斜杠，这样Python就不会认为字符串在这里结束。<code class="fe nw nx ny nm b">time.sleep()</code>是必需的，否则我们的脚本将试图在元素呈现之前选择它并抛出一个错误。</p><p id="ccfb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击模态(<code class="fe nw nx ny nm b">followersList.click()</code>)将“聚焦”它，并允许我们使用空格键向下滚动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="dc1e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这一部分，我们定义一个动作链。动作链基本上允许我们执行一系列的动作(按一个键，移动鼠标，等等)。)以精确的顺序。这里我们对我们的脚本说:只要列表中的关注者数量低于所需数量，就按空格键。每次按下后，我们刷新列表中的用户数量并打印出来。(此处不需要打印。这是一种直观检查机器人进度的好方法。).</p><blockquote class="mg mh mi"><p id="b68d" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong> <code class="fe nw nx ny nm b">.perform()</code>添加在动作的末尾，因此事件是按照它们排队的顺序触发的。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b2e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该方法的最后一部分非常简单。一旦用户列表大于所需的数量，我们就遍历整个列表，提取配置文件的链接，将其添加到一个新列表中，并在达到所需数量时返回完整的列表。同样，<code class="fe nw nx ny nm b">print</code>不是必需的，它只是用来检查脚本的进度。</p><p id="e0dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就结束了我们的<strong class="kw iu"> getUserFollowers </strong>方法。让我们通过在类声明后添加这些行来测试它:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="76a5" class="mn mo it nm b gy nq nr l ns nt">print(bot.getUserFollowers('therock', 50))</span></pre><p id="4dd5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这应该会打印出50个岩石追随者的列表。</p><h2 id="2d29" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">清理干净！</h2><p id="ab1b" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">我们只需添加两个方法来在执行后清理我们的脚本，并销毁我们使用的浏览器实例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="3596" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这部分只是确保当脚本停止运行时<code class="fe nw nx ny nm b">self.browser.close()</code>被调用。</p><p id="958d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你需要的话，这里有完整的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="1576" class="mn mo it bd mp mq mr dn ms mt mu dp mv ld mw mx my lh mz na nb ll nc nd ne nf bi translated">结论</h2><p id="67e4" class="pw-post-body-paragraph ku kv it kw b kx ng ju kz la nh jx lc ld ni lf lg lh nj lj lk ll nk ln lo lp im bi translated">您现在已经看到了Selenium的主要特性。你拥有在任何网站上创建自动化系统的工具。作为练习，您可以通过向我们刚刚编写的代码中添加特性来进行改进。</p><p id="df40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在开发你自己的机器人之前，看看你想自动化的网站是否提供了通过自己的官方API进行交互的可能性总是好的。它可以节省你很多时间，而且通常更容易使用。</p><blockquote class="mg mh mi"><p id="f673" class="ku kv mj kw b kx ky ju kz la lb jx lc mk le lf lg ml li lj lk mm lm ln lo lp im bi translated"><strong class="kw iu">免责声明</strong>:不要用你的自动化系统向网站发送大量请求。以我们的Instagram机器人为例，不要用它来关注每分钟数百名用户。如果你做了这样的事，你的账号肯定会被封禁。</p></blockquote><p id="c5ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢您阅读这篇文章。和往常一样，如果你有问题，你可以通过Medium联系我。</p><p id="3d7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我还想感谢大家对我第一篇文章的支持。这是意料之外的，让我很开心！我希望你会像喜欢上一篇文章一样喜欢这篇文章！</p></div></div>    
</body>
</html>