<html>
<head>
<title>Flutter Testing— Understand Unit, Widget, and Integration Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">颤动测试——理解单元、部件和集成测试</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/flutter-testing-101-understand-unit-widget-and-integration-testing-fd5d07e312e?source=collection_archive---------1-----------------------#2022-02-06">https://betterprogramming.pub/flutter-testing-101-understand-unit-widget-and-integration-testing-fd5d07e312e?source=collection_archive---------1-----------------------#2022-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9c01" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Flutter中常见测试类型的实用指南，如单元测试、小部件测试和集成测试。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/25ead6e87792d0a13d9d9b1513ead25c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDwF45hIwIbQG-IEDJ7p0w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@balazsketyi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">巴拉兹·克提伊</a>在<a class="ae kv" href="https://unsplash.com/s/photos/mobile-app?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8a7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当以应用程序的形式开发产品时，测试是很重要的。通过实施测试，我们将在向公众发布产品或应用程序时变得更加自信，因为我们可以确保我们开发的应用程序按预期运行，并且有更少的错误。</p><h1 id="46eb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">颤振试验的类型</h1><p id="3574" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">颤振项目中通常采用三种类型的试验方法:</p><h2 id="f335" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">单元测试</h2><p id="93e6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">单元测试是对应用程序的一种测试，其中测试集中在所谓的单元上。单元是构建应用程序的最小部分。当我们谈论OOP(面向对象编程)时，最简单的单元例子是类和函数。单元测试将确保应用程序的小组件运行良好并符合预期。</p><p id="de82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了执行单元测试，我们使用以下函数:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="a1c4" class="mp lt iq nc b gy ng nh l ni nj">test('description', () {});</span></pre><p id="953a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="e4ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码中，我们尝试对数据源<code class="fe nm nn no nc b">movie_remote_data_source.dart</code>进行单元测试，以从API获取电影数据。有两种情况:(1)成功检索到来自API的数据时，以及(2)检索不到来自API的数据时。</p><p id="9796" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一组测试代码通常由3部分组成:</p><ul class=""><li id="70e5" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated"><strong class="ky ir">安排— </strong>我们为测试准备对象或配置的阶段。在上面的例子中，我们设置了一个模拟HTTP客户端对象来模拟在测试中从API获取数据。</li></ul><blockquote class="ny nz oa"><p id="c612" class="kw kx ob ky b kz la jr lb lc ld ju le oc lg lh li od lk ll lm oe lo lp lq lr ij bi translated"><strong class="ky ir">模仿</strong>是创建一个模仿对象，这样它就可以用于测试，而不必考虑该对象与项目中其他对象的依赖关系。</p></blockquote><p id="755c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是常用于模仿的库:</p><div class="of og gp gr oh oi"><a href="https://pub.dev/packages/mockito" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">莫奇托|镖包</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">受Mockito启发的Dart模拟库。Mockito 5.0.0支持Dart 2.12中Dart新的空安全语言特性…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">公共开发</p></div></div><div class="or l"><div class="os l ot ou ov or ow kp oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://pub.dev/packages/mocktail" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">仿制品|省道包</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">受mockito启发的Dart模拟库。Mocktail专注于提供一个熟悉的、简单的API，用于在…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">公共开发</p></div></div><div class="or l"><div class="ox l ot ou ov or ow kp oi"/></div></div></a></div><ul class=""><li id="b9ea" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated"><strong class="ky ir"> Act — </strong>调用我们想要测试的函数的阶段。在上面的例子中，我们调用了<code class="fe nm nn no nc b">MovieRemoteDataSourceImpl</code>类中的<code class="fe nm nn no nc b">getNowPlayingMovies()</code>函数。</li><li id="6d2a" class="np nq iq ky b kz oy lc oz lf pa lj pb ln pc lr nu nv nw nx bi translated"><strong class="ky ir">断言— </strong>我们验证已执行的行动是否符合预期的阶段。在上面的例子中，当从API中成功检索到数据时，我们验证了函数调用<code class="fe nm nn no nc b">getNowPlayingMovies()</code>的结果等于电影列表。</li></ul></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><h2 id="e125" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">小部件测试</h2><p id="4db2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">小部件测试或者用其他术语叫做<strong class="ky ir">工具测试</strong>是一种测试类型，它关注于构建应用程序用户界面的部分，比如按钮、文本字段等等。小部件测试将确保用户界面根据应用程序的UI设计进行布局，并且可以与用户进行良好的交互。</p><p id="60f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了执行小部件测试，我们使用以下函数:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="32ba" class="mp lt iq nc b gy ng nh l ni nj">testWidgets('description', (WidgetTester tester) {});</span></pre><p id="ed57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="0ba5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">小部件测试的过程仍然与单元测试相同(排列、动作和断言)。不同之处在于，这里我们测试的是应用程序的用户界面(小部件)的一部分。在上面的例子中，我们测试了当用户通过点击save watchlist按钮将一部电影添加到watchlist时，是否会出现一个小吃店。</p><p id="5ac2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们的应用程序实现诸如provider、BLoC等状态管理时，我们也需要在pump小部件过程中声明它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><h2 id="7181" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">集成测试</h2><p id="eff8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">集成测试是一种专注于测试应用程序整个流程的测试(端到端测试)。要运行集成测试，您需要一个仿真器或真实的设备。在测试期间，应用程序将出现在模拟器或真实设备上，并自动运行该应用程序。</p><p id="257f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">集成测试对于测试一个特性或整个应用程序在开发过程中是如何运行的非常有帮助。这将比我们必须手动运行应用程序并测试功能或整个应用程序更有效率。</p><p id="eda5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了实现集成测试，我们需要将库添加到<code class="fe nm nn no nc b">pubspec.yaml</code>中。</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="3c0a" class="mp lt iq nc b gy ng nh l ni nj">dev_dependencies:    <br/>    ...<br/>    <strong class="nc ir">integration_test:       <br/>        sdk: flutter</strong></span></pre><p id="54e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在项目目录下，我们需要创建一个名为<code class="fe nm nn no nc b">integration_test</code>的新文件夹。例子如下:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="9041" class="mp lt iq nc b gy ng nh l ni nj"><strong class="nc ir">integration_test</strong><br/>├── app_test.dart<br/>└── robots<br/>    ├── home_robot.dart<br/>    └── ...</span></pre><p id="06e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在那个文件夹中有<code class="fe nm nn no nc b">app_test.dart</code>，它包含了我们应用程序的所有端到端测试场景。然后还有一个包含每个测试场景的<code class="fe nm nn no nc b">robots</code>文件夹。应用程序测试场景可以被分离(例如通过页面)。</p><p id="56c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="480f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的<code class="fe nm nn no nc b">home_robot.dart</code>中，我们为应用程序的主页创建了一个测试场景。一个例子是按下<code class="fe nm nn no nc b">AppBar</code>上的菜单按钮打开抽屉。</p><p id="fa4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了能够访问我们想要的小部件，我们可以使用<code class="fe nm nn no nc b">Key()</code>功能。所以我们必须在想要测试的小部件上注册一个键。例子如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="6e5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们就可以把所有的场景组合成<code class="fe nm nn no nc b">app_test.dart</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="c8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码中，我们首先调用<code class="fe nm nn no nc b">IntegrationTestWidgetsFlutterBinding.ensureInitialized()</code>函数来确保我们的应用程序页面已经准备好进行测试。</p><p id="53a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行集成测试，请设置一个模拟器或真实设备。之后，在终端上运行以下命令:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="fa7a" class="mp lt iq nc b gy ng nh l ni nj">flutter test integration_test</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pk"><img src="../Images/26a644668e261252b23b804b21be33a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gsJkg5uGtmpm8Tub.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">集成测试结果</p></figure><h1 id="8092" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">概述</h1><p id="65aa" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">总之，在开发应用程序时，尽可能多地考虑测试。以便应用程序的最终结果可以被正确地度量，并且在您想要修改或修复某些特性时便于维护。</p><p id="f899" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整源代码:</p><div class="of og gp gr oh oi"><a href="https://github.com/codestronautHub/flutter-movie-database-app" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd ir gy z fp on fr fs oo fu fw ip bi translated">GitHub-codestronautHub/flutter-movie-database-app:这是一个电影目录app。主要特点…</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">这是一个电影目录应用程序。主要功能是电影和电视节目列表，观看列表，等等。这个应用程序是…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">github.com</p></div></div><div class="or l"><div class="pl l ot ou ov or ow kp oi"/></div></div></a></div><p id="3db5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上是关于颤振应用项目测试的一些讨论，希望对大家有所帮助。</p></div></div>    
</body>
</html>