<html>
<head>
<title>Machine Learning for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的机器学习</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/machine-learning-for-beginners-predicting-insurance-costs-using-linear-regression-40989645dfa3?source=collection_archive---------20-----------------------#2020-03-03">https://betterprogramming.pub/machine-learning-for-beginners-predicting-insurance-costs-using-linear-regression-40989645dfa3?source=collection_archive---------20-----------------------#2020-03-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="879c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用线性回归预测保险成本</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/efa64497ec42e7fae6369badb20a0f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PCwc6w9vARU-iLaL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亨特·哈里特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="44e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性回归适用于我们希望预测某个数值的问题，这与我们使用逻辑回归的“是或否”预测相反。</p><p id="f662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">什么是“是或不是”的预测？</p><p id="3357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果一家保险公司想要预测一个人是否可能早死(一个“是或否”的预测)，并获得索赔保险，他们应该使用逻辑回归。</p><p id="34d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在这里，我们想要预测个人的保险成本——我们将使用线性回归来实现这一点。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a6d8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">导入数据集</h1><p id="e31c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">首先，让我们导入必要的库并将csv文件中的数据读入pandas数据框。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="62d4" class="ne md it na b gy nf ng l nh ni">import pandas as pd</span><span id="0121" class="ne md it na b gy nj ng l nh ni">import numpy as np</span><span id="57d8" class="ne md it na b gy nj ng l nh ni">df = pd.read_csv(“/content/drive/My Drive/Colab Notebooks/insurance.csv”)</span></pre><p id="bb83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看数据框是什么样的:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a4a1" class="ne md it na b gy nf ng l nh ni">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7b5682e0cb5c242ebbeb111fcb5612a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*Fx9N29Pg-2ymPF2t5oGzZg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们关于不同背景的人及其保险费用的数据。</p></figure><p id="acad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是检查数据框中的空值，并移除或均值归一化不可用的值。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="42e7" class="ne md it na b gy nf ng l nh ni">df.isnull().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/91eeb265741ad51bf0cc39c7b558fadd.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*88h74IftvyzC9pivuPk3CQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不同列中null值的数量。</p></figure><p id="d087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，数据集中没有空值。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7a9a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">将类别转换为数字</h1><p id="e8a3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在，在这个数据集中，我们有像“吸烟者”、“地区”和“性别”这样的分类特征</p><p id="71b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不是用数字而是用范畴来表示的分类特征。</p><p id="300b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性回归只能在数字上执行，所以我们应该将这些分类特征转换成数字。为此，我们可以使用一个名为<code class="fe nm nn no na b">get_dummies</code>的函数。</p><p id="9172" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，让我们将“性别”、“吸烟者”和“地区”列转换成数字表示的特征。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="599a" class="ne md it na b gy nf ng l nh ni">cols = ['sex', 'smoker', 'region']</span><span id="284f" class="ne md it na b gy nj ng l nh ni">new_df = pd.get_dummies(df, cols, drop_first= True)</span><span id="be7a" class="ne md it na b gy nj ng l nh ni">new_df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/b1d8964df8e8e364b16276ca91c2bbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KlD33skIweyp9s3sEVZkcA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">性别、吸烟者和地区类别现在用数字表示。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6804" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">特征选择</h1><p id="e13f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在，让我们只选择最相关的特性。</p><p id="6def" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特征选择是任何机器学习项目中的重要任务之一。您必须知道哪些特性与目标最相关(在我们的例子中是“charges”列)，并且必须只使用那些与您的目标高度相关的特性。</p><p id="1822" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以通过实验来实现。</p><p id="ecfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在这个问题中，我尝试使用“性别”和“地区”功能来预测“费用”，但没有发现模型的预测性能有太大的改进。</p><p id="61b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我决定在模型中省略这些特性。</p><p id="b67a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这样的小实验，我发现“年龄”、“bmi”和“吸烟者”列与预测保险费用最相关(数据框中的“费用”列)。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="916a" class="ne md it na b gy nf ng l nh ni">X = new_df[[‘age’, ‘bmi’, ‘smoker_yes’]]</span><span id="06b7" class="ne md it na b gy nj ng l nh ni">y = new_df[‘charges’]</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6d3e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">分割数据集</h1><p id="a765" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">数据预处理现在已经完成，我们准备对我们的数据应用线性回归。</p><p id="5762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但在此之前，我们需要将数据分成两组:一组训练集和一组测试集。</p><p id="3dcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着我们使用80%的可用数据创建一个线性回归模型，然后使用剩余的20%的数据来查看我们的模型在以前没有见过的数据上的表现。</p><p id="b1e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了进行数据集分割，我们在Sci-kit learn中有一个名为<code class="fe nm nn no na b">train_test_split</code>函数。看起来是这样的:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="de46" class="ne md it na b gy nf ng l nh ni">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)</span></pre><p id="de1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面那行代码中<code class="fe nm nn no na b">test_size</code>的值意味着我们需要分别截掉的样本的百分比，以测试我们的线性回归模型。</p><p id="7c43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，<em class="nq"> test_size=0.2 </em>意味着我们的样本(<code class="fe nm nn no na b">X_test</code>、<code class="fe nm nn no na b">y_test</code>)的20%将从我们的数据集中剔除，因此我们可以在数据集的剩余80%( <code class="fe nm nn no na b">X_train</code>、<code class="fe nm nn no na b">y_train</code>)上训练模型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="22b4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">导入和拟合我们的ML算法</h1><p id="97b0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在，我们已经准备好根据数据训练我们的模型。</p><p id="c3fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该从Sci-kit learn库中导入<code class="fe nm nn no na b">LinearRegression</code>类，并用一个变量实例化它，该变量可以用来适应我们的数据。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5756" class="ne md it na b gy nf ng l nh ni">from sklearn.linear_model import LinearRegression<br/>model = LinearRegression()</span></pre><p id="63a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们对数据应用线性回归并试图预测输出时，会发生一些非常复杂的事情。</p><p id="5aca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但我们只需要将预处理过的数据传递到我们的模型中，所有复杂的机器学习计算都会在引擎盖下进行。</p><p id="d10b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要将数据拟合到我们的线性回归模型中。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1503" class="ne md it na b gy nf ng l nh ni">model.fit(M_train, n_train)</span></pre><p id="697d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的模型已经准备好了，我们可以通过计算分数来评估它的性能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7859" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们模型的R2分数(误差分数)</h1><p id="d1e9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">使用一种叫做<code class="fe nm nn no na b">R2(R square)</code>的误差计算方法计算分数，给出实际值和预测值之间的误差。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ce74" class="ne md it na b gy nf ng l nh ni">model.score(X_test, y_test)</span></pre><p id="1963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我运行代码时，我得到的R2值是0.7422。</p><ul class=""><li id="1eb0" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">R2 = 0意味着我们有一个糟糕的预测模型，我们的预测保险成本只是数据集中所有个人的平均保险成本。</li><li id="79aa" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">R2 = 1意味着我们有完美的预测模型，其中每个预测值都等于实际值。</li></ul><p id="74ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们有0.74，这对于R2值来说是相当不错的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6316" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">线性方程</h1><p id="a533" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">接下来，让我们更深入地了解我们的算法创建的用于预测保险成本的线性方程。</p><p id="4df2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们找出我们的模型用来计算保险费用预测的公式。</p><p id="de66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，该等式的形式为<em class="nq"> y = w0 + w1*x1 + w2*x2 + w3*x3 </em>。</p><p id="d4c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">w0是截距，x1、x2和x3是“年龄”、“bmi”和“吸烟者_是”特征，而w1、w2和w3是各自的系数。</p><p id="18d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们找出我们模型的截距w0是多少:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="fc95" class="ne md it na b gy nf ng l nh ni">model.intercept_</span></pre><p id="10ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nq">输出:-12038.54 </em></p><p id="0870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们看看系数w1、w2和w3是什么:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="8239" class="ne md it na b gy nf ng l nh ni">model.coef_</span></pre><p id="a121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nq">输出:数组([ 269.75240575，316.68365152，24140.19804267]) </em></p><p id="cb2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，w1、w2和w3的值分别为269.75、316.68和24140.19。</p><p id="56b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">w3的值大得不成比例，因为它与x3成对出现，这是“smoker_yes”特性。</p><p id="a35f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这表明一个人的吸烟状况在决定一个人的保险费用中起着不成比例的作用。这是因为吸烟会增加你的生命风险，从而导致高额的保险费用。</p><p id="bb4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，线性方程中与“年龄”特征配对的系数w1等于269.75。这意味着年龄每增加1岁，保险费用就会增加269.75美元。</p><p id="4e39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，使用这个线性方程，我们可以编写一个函数，预测给定年龄、体重指数和吸烟状况的保险费用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="1624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过我们的值，看看保险成本的预测值。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="69b5" class="ne md it na b gy nf ng l nh ni">calc_insurance(27, 42.13, “smoker”)</span></pre><p id="7d1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:36860 . 48686868686</p><p id="f740" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，使用我们训练的线性回归模型，上面的函数预测了27岁身体质量指数为42.13的吸烟者的保险成本。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1672" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="302d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">简而言之，线性回归就是计算每个要素在您想要预测的目标值中所占的权重。</p><p id="2f39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的示例中，我们的数据集中有三个相关要素，我们的模型计算了三个唯一的权重w1、w2和w3。</p><p id="d3f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一些复杂的机器学习问题中，你可能会处理更多的特征。</p><p id="5452" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，考虑一个目标值依赖于40个特征的机器学习问题。在这种情况下，使用线性回归是为了有效地计算40个特征中每个特征的适当权重(即w1、w2、… w40)。</p></div></div>    
</body>
</html>