<html>
<head>
<title>Angular 5 — Creating New Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度5-创建新元件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-5-creating-new-component-c6c5236f8024?source=collection_archive---------0-----------------------#2018-02-02">https://betterprogramming.pub/angular-5-creating-new-component-c6c5236f8024?source=collection_archive---------0-----------------------#2018-02-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ccb9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">要获取(使用HttpClient)并显示数据列表的角度组件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f43ff1c4881acdaa5bb0e26f01bc8fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dxH9sY8UyBNW1M_5rqI6Kw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·冯·阿彭的照片</p></figure><p id="8bf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TK本文是系列的一部分— <a class="ae ky" href="https://medium.com/all-is-web/make-a-crud-web-app-with-angular-5-caa83e06ab60" rel="noopener">用angular 5 </a>制作一个crud web app。</p><ul class=""><li id="5007" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://medium.com/all-is-web/angular-5-bootstrapping-using-angular-cli-918050c4dd7d" rel="noopener">角度5 —引导</a></li><li id="b5bd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://medium.com/all-is-web/angular-5-inside-components-3001813034b9" rel="noopener">角形5 —内部组件</a></li><li id="b430" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">角度5-创建新组件(您在这里)</li><li id="600e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://medium.com/all-is-web/https-medium-com-all-is-web-angular-5-routing-fad9b3648f67" rel="noopener">角度5——布线</a></li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="8c81" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">angular-cli.json的更改</h1><p id="3d84" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在继续之前，我们先对<code class="fe nn no np nq b">angular-cli.json</code>做一些改动。</p><ol class=""><li id="8063" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nr mb mc md bi translated">将<code class="fe nn no np nq b">apps.styles</code>改为<code class="fe nn no np nq b">styles.scss</code>。同时将<code class="fe nn no np nq b">src</code>目录下的文件<code class="fe nn no np nq b">styles.css</code>重命名为<code class="fe nn no np nq b">styles.scss</code>。我们想使用<a class="ae ky" href="https://sass-lang.com/" rel="noopener ugc nofollow" target="_blank"> Sass </a>预处理器来处理样式。</li><li id="dfac" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated">将<code class="fe nn no np nq b">defaults.styleExt</code>改为<code class="fe nn no np nq b">"scss"</code>。</li><li id="447a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nr mb mc md bi translated">移除<code class="fe nn no np nq b">prefix</code>属性。</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="80b1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">成分</h1><p id="d88a" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们要创建的第一个组件是<code class="fe nn no np nq b">pokemon-list</code>组件。</p><p id="010e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个组件只是从一个远程URL(本例中为<a class="ae ky" href="https://github.com/SF-WDI-LABS/super-crud-api" rel="noopener ugc nofollow" target="_blank"> super-crud-api </a>)获取数据，并显示在一个列表中。</p><ol class=""><li id="da1f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nr mb mc md bi translated">使用<code class="fe nn no np nq b">ng generate</code>创建一个新组件。</li></ol><pre class="kj kk kl km gt ns nq nt nu aw nv bi"><span id="aa71" class="nw mr it nq b gy nx ny l nz oa">ng generate component pokemon-list</span></pre><p id="e088" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.让我们看看我们的组件类<code class="fe nn no np nq b">PokemonListComponent</code>。</p><p id="c4e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是它现在的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="a674" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了我们在<a class="ae ky" href="https://medium.com/all-is-web/angular-5-inside-components-3001813034b9" rel="noopener">上一篇文章</a>中讨论的基本组件特性，这个类还实现了来自<code class="fe nn no np nq b">Core</code>库的<code class="fe nn no np nq b">OnInit</code>接口。</p><p id="aff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个组件都有一个创建、更新和销毁的生命周期。</p><p id="6a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当这些事件在组件的生命周期中发生时，Angular向接口公开钩子。这些钩子可以使用Angular的核心库中相应的生命周期钩子接口来实现。</p><p id="1d14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nn no np nq b">ngOnInit</code>就是这样一个钩子，它在<code class="fe nn no np nq b">OnInit</code>接口(如下图)中声明，最初被调用一次。</p><pre class="kj kk kl km gt ns nq nt nu aw nv bi"><span id="76c4" class="nw mr it nq b gy nx ny l nz oa">export interface OnInit {</span><span id="3a14" class="nw mr it nq b gy od ny l nz oa">  ngOnInit(): void;</span><span id="e864" class="nw mr it nq b gy od ny l nz oa">}</span></pre><p id="0243" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这相当于<code class="fe nn no np nq b">this.$onInit</code>由<code class="fe nn no np nq b">angular1.x</code>组件组成。</p><p id="6baf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在<code class="fe nn no np nq b">OnInit</code>期间调用API来获取口袋妖怪数据。</p><p id="086b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们使用<code class="fe nn no np nq b">ng generate</code>创建组件时，Angular CLI也导入了我们的新组件，并将其添加到我们的<code class="fe nn no np nq b">AppModule</code>的<code class="fe nn no np nq b">declarations</code>数组中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="dc5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.我们的组件现在需要进行API调用来从远程服务器获取数据，但是组件不应该这样做。</p><p id="d484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是<code class="fe nn no np nq b">service</code> s的作用；因此组件可以专注于显示数据并将数据传递给需要它的其他组件。</p><p id="87b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个<code class="fe nn no np nq b">pokemon service</code>，它将为我们的<code class="fe nn no np nq b">pokemon-list</code>组件获取数据。</p><p id="6b04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.创建新的口袋妖怪服务:</p><pre class="kj kk kl km gt ns nq nt nu aw nv bi"><span id="7f89" class="nw mr it nq b gy nx ny l nz oa">ng generate service pokemon --module=app</span></pre><p id="5da6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将生成一个新的<code class="fe nn no np nq b">PokemonService</code>类，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="a6e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并将上述服务类添加到app模块<code class="fe nn no np nq b">providers</code>。</p><p id="12af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们需要稍后将该服务注入到我们的组件中，因此该服务需要被<code class="fe nn no np nq b">provide</code> d到依赖注入系统中。一种方法是将它添加到我们模块的<code class="fe nn no np nq b">providers</code>数组中。</p><p id="a61f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务用一个<code class="fe nn no np nq b">@Injectable</code>装饰器来装饰。我们稍后会研究这个问题。</p><p id="28db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.Angular使用<code class="fe nn no np nq b">HttpClient</code>类与远程服务器通信。</p><p id="154e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在我们的服务中(以及应用程序中的任何地方)使用<code class="fe nn no np nq b">HttpClient</code>，我们需要将<code class="fe nn no np nq b">HttpClientModule </code>导入到<code class="fe nn no np nq b">AppModule</code>中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="72cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.现在我们可以将<code class="fe nn no np nq b">HttpClient</code>注入到<code class="fe nn no np nq b">pokemon service</code>构造函数中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="e28d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.让我们在这个服务中定义<code class="fe nn no np nq b">getPokemon</code>方法，它对<a class="ae ky" href="https://github.com/SF-WDI-LABS/super-crud-api" rel="noopener ugc nofollow" target="_blank"> super-crud api </a>进行HTTP调用以获取Pokemon数据并返回一个泛型<code class="fe nn no np nq b">Observable</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><ul class=""><li id="66fe" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">与angular 1.x <code class="fe nn no np nq b">$http</code>服务返回一个承诺不同，<code class="fe nn no np nq b">HttpClient</code>从<code class="fe nn no np nq b">rxjs</code>返回一个<code class="fe nn no np nq b">Observable</code>。</li><li id="a6cc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">您可以<code class="fe nn no np nq b">subscribe</code>到可观察对象以获得HTTP响应数据，这可以被认为是相当于承诺的<code class="fe nn no np nq b">then</code>。当然，这两者的工作方式是不同的。</li></ul><p id="2073" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">8.在<code class="fe nn no np nq b">OnInit</code>期间，将<code class="fe nn no np nq b">PokemonService</code>注入到<code class="fe nn no np nq b">PokemonListComponent</code>构造函数中，并在注入的实例上调用<code class="fe nn no np nq b">getPokemons</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="2f6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经订阅了返回的可观察值，并将返回的数据赋给了一个私有声明的<code class="fe nn no np nq b">pokemonData</code>变量。这可用于组件模板中的绑定。</p><p id="d686" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">9.更新组件模板<code class="fe nn no np nq b">pokemon-list.component.html</code> <em class="oe"> </em>迭代返回的口袋妖怪列表，列表显示口袋妖怪名称。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="8115" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的模板中，我们使用了两个<em class="oe">指令</em> <code class="fe nn no np nq b">*ngIf</code>和<code class="fe nn no np nq b">*ngFor</code>。</p><ul class=""><li id="2c2c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe nn no np nq b">*ngIf</code>检查传递的变量中的值，如果发现为真，则从模板创建DOM。相当于角度1.x中的<code class="fe nn no np nq b">ng-if</code></li><li id="9db4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nn no np nq b">*ngFor</code>是一个repeater指令，它遍历一个条目列表，并为每个条目提供要在DOM中显示的HTML内部块。相当于Angular 1.x中的<code class="fe nn no np nq b">ng-repeat</code>指令。</li></ul><p id="4b8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">10.让我们更新我们的根shell组件来显示<code class="fe nn no np nq b">pokemon-list</code>组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="61a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">11.在你的终端中运行<code class="fe nn no np nq b">ng serve</code>，打开<a class="ae ky" href="http://localhost:4200/" rel="noopener ugc nofollow" target="_blank"> http://localhost:4200/ </a>。您应该会看到视图中显示的口袋妖怪名称列表。</p><p id="0a62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经创建了第一个组件！我们接下来要做的是，点击每个口袋妖怪的名字，并查看该口袋妖怪的详细信息。</p><p id="54d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续创建一个<code class="fe nn no np nq b">pokemon-details</code>组件。</p><p id="27af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/all-is-web/angular-5-inside-components-3001813034b9" rel="noopener"> <em class="oe"> &lt;上一张</em> </a> | <a class="ae ky" href="https://medium.com/all-is-web/https-medium-com-all-is-web-angular-5-routing-fad9b3648f67" rel="noopener"> <em class="oe">下一张&gt; </em> </a></p></div></div>    
</body>
</html>