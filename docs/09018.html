<html>
<head>
<title>Automate On-Premise Performance Testing With Azure DevOps and Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure DevOps和Linux自动进行内部性能测试</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/automate-on-premise-performance-testing-with-azure-devops-and-linux-59e5f777eb80?source=collection_archive---------5-----------------------#2021-07-07">https://betterprogramming.pub/automate-on-premise-performance-testing-with-azure-devops-and-linux-59e5f777eb80?source=collection_archive---------5-----------------------#2021-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6cfe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在CI渠道中添加压力测试的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/19bf0cbaa8367cc832da656730c3dbb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zGKKKGZGN2veFQ1e"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">布拉登·科拉姆在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="2221" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个应用程序在被允许投入生产之前必须通过一系列测试。从单元测试到性能测试，每一个都和其他的一样重要。2020年3月31日，Azure DevOps <a class="ae kv" href="https://devblogs.microsoft.com/devops/cloud-based-load-testing-service-eol/#:~:text=Running%20load%20tests%20in%20Azure,run%20until%20March%2031st,%202020" rel="noopener ugc nofollow" target="_blank">正式退役其基于云的Apache JMeter负载测试工具</a>。这被证明是一个困境，因为没有工具的替代品，用户必须自己托管机器来进行负载测试。</p><p id="5958" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自各地的开发人员开始拿出他们自己的解决方案，从<a class="ae kv" href="https://www.colinsalmcorner.com/executing-jmeter-tests-in-an-azure-pipeline/" rel="noopener ugc nofollow" target="_blank">用于负载测试其他容器的dockered JMeter</a>到制作他们自己的专用服务器和手动实现负载测试。有些人甚至求助于第三方服务，比如Loadium。</p><p id="8df0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将制作一个自动化的管道来加载测试<a class="ae kv" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">。Centos 8服务器上的NET Core </a>应用。为了测试该应用程序，它将作为服务运行，并通过使用<a class="ae kv" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank"> Nginx </a>的反向代理提供服务。在这个设置中，我们将使用两个服务器，构建服务器和测试服务器。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="37cf" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">安装自托管Azure构建代理</h1><p id="1638" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在<a class="ae kv" href="https://azure.microsoft.com/en-ca/services/devops/" rel="noopener ugc nofollow" target="_blank"> Azure DevOps </a>中，我们可以安装一个自托管代理来运行CI管道。生成代理将安装在生成服务器和测试服务器上。安装代理很简单，只需遵循以下步骤:</p><h2 id="491b" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">1.设置自托管代理池</h2><p id="db13" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">转到“组织设置”,然后单击侧栏中的“代理池”菜单。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/c19ae0bb63df7a56342380e3df037876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpZbN5vzQz3__k4kbp4Xtw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1bab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后单击“添加池”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8a03b871231eeedff3b80e20098feb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*tJ7jgShBnNdV-BZYOFx0rA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3644" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将出现一个表单，用于填写您的座席代表池数据:</p><ol class=""><li id="bfb8" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">首先，选择自托管池类型。</li><li id="7c22" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">为您的代理池命名。在我的例子中，它是“selfhostedagent”保存它，因为你以后会需要它。</li><li id="5ed2" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">单击创建按钮。</li></ol><p id="52ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以设置代理池的权限，但这是可选的。</p><h2 id="077c" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">2.下载自承载构建代理</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/f9bacdb709e33468f6162f42b4f99e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGuWx1kx4p5IwXnYGhSNXQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="9619" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在代理池屏幕上，单击“新建代理”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/20c0dabf633f1fd7b1650bc322815d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xvfi_6x8OpIIjU3f8DH2w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="a7c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将出现一个提示，其中包含如何为特定操作系统安装代理的说明。因为我们将在Centos 8上安装代理，所以请执行以下操作:</p><ol class=""><li id="6f5a" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击Linux选项卡。</li><li id="6b7a" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">单击边栏上的RHEL6选项卡。</li><li id="73af" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">单击复制按钮获取代理链接，然后保存它。我们以后会需要它。</li></ol><p id="83cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检索下载链接后，转到主目录:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="f58e" class="mw ma iq ob b gy of og l oh oi">cd ~</span></pre><p id="89d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe oj ok ol ob b">wget</code>和前面步骤中的链接下载构建代理。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="9a3c" class="mw ma iq ob b gy of og l oh oi">wget <a class="ae kv" href="https://vstsagentpackage.azureedge.net/agent/2.188.2/vsts-agent-rhel.6-x64-2.188.2.tar.gz" rel="noopener ugc nofollow" target="_blank">https://vstsagentpackage.azureedge.net/agent/2.188.2/vsts-agent-rhel.6-x64-2.188.2.tar.gz</a></span></pre><p id="9f6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为构建代理创建一个新目录，并进入该目录。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="f41b" class="mw ma iq ob b gy of og l oh oi">mkdir myagent &amp;&amp; cd myagent</span></pre><p id="45d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解压缩代理。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="d8bb" class="mw ma iq ob b gy of og l oh oi">tar zxvf ~/vsts-agent-rhel.6-x64-2.188.2.tar.gz</span></pre><p id="5299" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装依赖项。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="375d" class="mw ma iq ob b gy of og l oh oi">sudo ./bin/installdependencies.sh</span></pre><p id="d0e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果安装依赖项时出现错误，比如缺少<code class="fe oj ok ol ob b">libssl</code>包，运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="13e2" class="mw ma iq ob b gy of og l oh oi">sudo dnf install compat-openssl10</span></pre><h2 id="df9d" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">3.配置生成代理</h2><p id="cbf8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在开始配置之前，您需要有一个个人访问令牌来使用您的Azure DevOps项目对构建代理进行身份验证。按照这些说明你可以得到一个个人访问令牌。</p><p id="e20a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">拥有个人访问令牌后，开始配置:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="be4b" class="mw ma iq ob b gy of og l oh oi">./config.sh</span></pre><p id="8736" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此步骤中，您将需要个人访问令牌和代理池名称。当询问代理的名称时，因为这是构建服务器，所以输入名称“build server”</p><h2 id="b4d3" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">4.安装生成代理</h2><p id="cb61" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">安装构建代理将非常简单。您需要运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="d5aa" class="mw ma iq ob b gy of og l oh oi">sudo ./svc.sh install</span></pre><p id="e2c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要启动代理，请运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="4de3" class="mw ma iq ob b gy of og l oh oi">sudo ./svc.sh start</span></pre><p id="9bfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成所有工作后，检查代理池中的代理:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/20483307c4a930399f7e0b9d45e9c825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alEq3rdKP4whAiXGQfmDAQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ee9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果一切顺利，应该会有一个新的在线代理。</p><h2 id="0bc0" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">5.在另一台服务器上重复所有步骤</h2><p id="a6e6" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">安装完第一个构建代理后，在第二台服务器上重做整个过程。将第二台服务器命名为“TestServer”</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="16f8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">在测试服务器上安装JMeter</h1><p id="a707" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">JMeter是一个使用Java构建的负载测试工具。要安装JMeter，我们需要安装一个兼容的Java版本。本教程将使用Apache JMeter 5.4.1。</p><h2 id="0a58" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">1.安装Java</h2><p id="7b44" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Java的安装非常简单。运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="8e63" class="mw ma iq ob b gy of og l oh oi">sudo dnf install java-11-openjdk-devel</span></pre><h2 id="5c93" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">2.下载并安装JMeter</h2><p id="4aa4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">转到主目录:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="805b" class="mw ma iq ob b gy of og l oh oi">cd ~</span></pre><p id="75ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后使用<code class="fe oj ok ol ob b">wget</code>和前面步骤中的链接下载JMeter二进制文件。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="3332" class="mw ma iq ob b gy of og l oh oi">wget <a class="ae kv" href="https://downloads.apache.org/jmeter/binaries/apache-jmeter-5.4.1.tgz" rel="noopener ugc nofollow" target="_blank">https://vstsagentpackage.azureedge.net/agent/2.188.2/vsts-agent-rhel.6-x64-2.188.2.tar.gz</a></span></pre><p id="14df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解压缩二进制文件。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="c951" class="mw ma iq ob b gy of og l oh oi">tar zxvf apache-jmeter-5.4.1.tgz</span></pre><p id="5a90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行JMeter，请运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="93dc" class="mw ma iq ob b gy of og l oh oi">~/apache-jmeter-5.4.1/bin/jmeter</span></pre><p id="2433" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个简短的安装指南是基于UnixCop 的一篇文章。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="cefe" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">为自动化配置构建服务器</h1><p id="506f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在剩下的就是配置shell脚本了。这里有两种类型的脚本:创建脚本和销毁脚本。这一节的部分内容摘自<a class="ae kv" href="https://towardsdatascience.com/automate-your-linux-deployment-using-azure-devops-ffe4ba7c938b" rel="noopener" target="_blank">我之前的文章</a>。</p><h2 id="ed32" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">1.制作一个脚本来自动化系统服务配置</h2><p id="6f0f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了添加新的系统服务配置，我们将创建一个shell脚本。在主目录中添加这个<code class="fe oj ok ol ob b">make-service.sh</code>脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自动化制作<code class="fe oj ok ol ob b">systemd</code>服务的shell脚本。</p></figure><p id="44b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在复制和粘贴代码之前，请注意脚本中的<code class="fe oj ok ol ob b">&lt;user&gt;</code>和<code class="fe oj ok ol ob b">&lt;server environment&gt;</code>标签。请事先将这些更改为您相应的用户和服务器环境。在这种情况下，服务器环境要么是开发环境，要么是生产环境。</p><p id="9f87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该脚本将生成新的<code class="fe oj ok ol ob b">systemd</code>服务文件。净核心项目。要为其他类型的应用程序生成脚本，您需要更改给定的模板。</p><p id="d7f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">shell脚本接受两个参数:服务名和使用的项目名。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="4da1" class="mw ma iq ob b gy of og l oh oi">sudo ~/make-service.sh &lt;service name&gt; &lt;project name&gt;</span></pre><p id="210a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="1963" class="mw ma iq ob b gy of og l oh oi">sudo ~/make-service.sh CI-Build API-Project</span></pre><p id="29a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，脚本将添加一个新的系统服务文件<code class="fe oj ok ol ob b">CI-Build.service</code>，它运行一个名为<code class="fe oj ok ol ob b">API-Project.dll</code>的dll文件。</p><h2 id="c716" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">2.制作一个脚本来自动化Nginx配置</h2><p id="6d20" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了添加新的Nginx配置，我们将创建一个shell脚本。在主目录中添加这个<code class="fe oj ok ol ob b">add-nginx-conf.sh</code>脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自动添加Nginx配置的shell脚本。</p></figure><p id="e7fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此脚本将使用关联的DNS创建对名为的配置文件的搜索。如果没有找到，它将创建一个新的。一旦找到，新的配置路由将被添加到那里。请注意，这个脚本中的配置路径是一个基本的代理传递，因此如果您想将它用于生产，您可能需要向脚本中添加更多的配置。</p><p id="7640" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">shell脚本接受三个参数:DNS、代理路由和正在使用的端口。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="cab1" class="mw ma iq ob b gy of og l oh oi">sudo ~/add-nginx-conf.sh &lt;DNS&gt; &lt;proxy route&gt; &lt;app port&gt;</span></pre><p id="5270" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="e746" class="mw ma iq ob b gy of og l oh oi">sudo ~/add-nginx-conf.sh yourdomain.com proxy 14321</span></pre><p id="a304" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，脚本将为yourdomain.com域添加配置，并在<code class="fe oj ok ol ob b">proxy</code>中使用端口14321的反向代理。</p><h2 id="36f6" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">3.创建一个脚本来移除系统服务配置并移除内部版本</h2><p id="7023" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了删除新的系统服务配置，我们将创建一个shell脚本。在主目录中添加这个<code class="fe oj ok ol ob b">remove-service.sh</code>脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自动化移除<code class="fe oj ok ol ob b">systemd</code>服务的shell脚本。</p></figure><p id="0fe4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该脚本将删除<code class="fe oj ok ol ob b">systemd</code>服务文件和。NET核心构建。shell脚本接受一个参数，即使用的服务名。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="f438" class="mw ma iq ob b gy of og l oh oi">sudo ~/remove-service.sh &lt;service name&gt;</span></pre><p id="4ecc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="0063" class="mw ma iq ob b gy of og l oh oi">sudo ~/remove-service.sh CI-Build</span></pre><p id="07bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，脚本将添加一个新的系统服务文件<code class="fe oj ok ol ob b">CI-Build.service</code>。</p><h2 id="d117" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">4.创建一个脚本来删除Nginx配置</h2><p id="b72b" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">删除新的Nginx配置。我们将创建一个shell脚本。在主目录上添加这个<code class="fe oj ok ol ob b">remove-nginx-conf.sh</code>脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自动添加Nginx配置的shell脚本。</p></figure><p id="b7cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该脚本将使用<code class="fe oj ok ol ob b"><a class="ae kv" href="https://stackoverflow.com/questions/6958841/use-grep-to-report-back-only-line-numbers" rel="noopener ugc nofollow" target="_blank">grep</a></code>创建对代理路由行号的搜索。在检索到相关的行号后，它会将数字增加2，然后使用<code class="fe oj ok ol ob b"><a class="ae kv" href="https://www.folkstalk.com/2013/03/sed-remove-lines-file-unix-examples.html" rel="noopener ugc nofollow" target="_blank">sed</a></code>删除中间的内容。</p><p id="fe8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">shell脚本接受两个参数:DNS和代理路由。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="b22a" class="mw ma iq ob b gy of og l oh oi">sudo ~/remove-nginx-conf.sh &lt;DNS&gt; &lt;proxy route&gt;</span></pre><p id="2e44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="f726" class="mw ma iq ob b gy of og l oh oi">sudo ~/remove-nginx-conf.sh yourdomain.com myproxypath</span></pre><p id="f3a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，脚本将删除yourdomain.com域的配置，并反向代理到<code class="fe oj ok ol ob b">myproxypath</code>。</p><h2 id="3ad1" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">5.设置用户运行systemctl和Nginx命令时不显示密码提示</h2><p id="2b32" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">出于自动化的目的，用来安装Azure代理的用户需要能够在没有密码提示的情况下运行<code class="fe oj ok ol ob b">systemctl</code>和Nginx命令。要删除<code class="fe oj ok ol ob b">sudo</code>上的密码提示，请运行:</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="08c5" class="mw ma iq ob b gy of og l oh oi">sudo visudo</span></pre><p id="9b46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要使用<code class="fe oj ok ol ob b">sudo</code>运行脚本中的所有命令，而不需要提示密码，所以我们对这些命令和我们将要使用的相应脚本进行了例外处理。</p><p id="5845" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后将此添加到最后一行(预先更改<code class="fe oj ok ol ob b">&lt;user&gt;</code>标签):</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="d9d1" class="mw ma iq ob b gy of og l oh oi">&lt;user&gt; ALL=(ALL) NOPASSWD:/usr/bin/cat, /usr/bin/systemctl, /usr/sbin/nginx, /usr/bin/chcon, /usr/bin/chown, /usr/bin/echo, /usr/bin/touch, /usr/bin/sed, /usr/bin/cp, /usr/bin/rm, /home/&lt;user&gt;/make-service.sh, /home/&lt;user&gt;/add-nginx-conf.sh,  /home/&lt;user&gt;/remove-service.sh, /home/&lt;user&gt;/remove-nginx-conf.sh</span></pre><p id="21ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">退出并保存配置文件，然后尝试使用<code class="fe oj ok ol ob b">sudo</code>运行其中一个命令。不应该提示您输入密码。</p><p id="37ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于如何在没有密码的情况下运行<code class="fe oj ok ol ob b">sudo</code>命令的完整解释可以在这篇<a class="ae kv" href="https://www.cyberciti.biz/faq/linux-unix-running-sudo-command-without-a-password/" rel="noopener ugc nofollow" target="_blank">文章</a>中看到。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="2982" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">准备CI管道</h1><p id="120f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">CI渠道将分为三项任务:</p><ol class=""><li id="27fc" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">运行服务</li><li id="9e19" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">运行性能测试</li><li id="1311" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">出版</li></ol><h2 id="6015" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">1.创建管道</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/f2a2b663c262a0c843e6e4f5bb427aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ymYnBtzTM9iw_mFI.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e8fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将使用. NET核心应用程序作为我们的例子。</p><ol class=""><li id="72c5" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">首先，转到“管道”选项卡。</li><li id="df30" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">单击新建管道。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/805d34f423c8597334d01c193f3f9e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i7OYhb2_wZUTTZBK"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="b4e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用经典编辑器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/6b1fa779b9e1937f1d36f4353986b144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/0*hLsepIEHTG7QvAAa"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="285f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择一个存储库，然后点按“继续”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/285411770c00399283f3abecf230054a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/0*e-vZS5UXaCanS6Y5"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="66d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应用。NET核心模板。</p><ol class=""><li id="0edf" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">搜索”。网芯。”</li><li id="4b48" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">然后应用模板。</li></ol><h2 id="414e" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">2.创建运行服务作业</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/c9554755c5cec4a9f883884399acb5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0rQIX2zME1w-ilohPDMWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="4e22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在模板上:</p><ol class=""><li id="b7a4" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击“构建管道”选项卡。</li><li id="24a3" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">然后将“代理池”更改为您在前面步骤中创建的池。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/c9b2cb0d3c3e037eac83820193797d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fJCafb3s42lJa-72SNPbmw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d8ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要指定我们将使用的代理，请执行以下操作:</p><ol class=""><li id="da49" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击“代理工作”</li><li id="5b66" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将“代理池”设置为从管道继承。</li><li id="2122" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">因为我们的代理使用的是Linux，所以根据需要将目标OS设置为Linux，将目标名称设置为“BuildServer”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/8fa4ad7b388b5980835148b33ad5db89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzxI0RTRYy8cWExYhjfArw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="954a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">向下滚动到“代理作业”配置的底部，并确保在“附加选项”中，该作业将仅在所有之前的作业成功后运行此作业。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/f2cd4200aeeb15e37a7580d45fec7c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G2wcro9aHfDY1gBNsOFcuQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2a49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择后三个任务，并将其从作业中删除。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/97b923456eb7e5b9ded74390f9f4eb5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pygj1GMLS7RU9XrRB-fVGA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="6960" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加新的命令行任务:</p><ol class=""><li id="7bca" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击<strong class="ky ir"> + </strong>符号。</li><li id="7564" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">在搜索栏上键入“命令行”。</li><li id="999c" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将任务添加到作业中。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/e0848ad4708408437a058e3f59eef5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fywl8zESNo4Mpp4YBBzteQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2163" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建任务后:</p><ol class=""><li id="16fb" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">在恢复和构建任务之间拖动任务。</li><li id="e8a0" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“Download appsettings.json”</li><li id="6d19" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">粘贴一个脚本，将<code class="fe oj ok ol ob b">appsettings.json</code>下载到app文件夹。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">下载appsettings.json脚本。</p></figure><p id="58e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后再添加两个命令行任务来创建服务，并在Nginx上添加配置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/48639b441d5e1d5c5b31895a2ae771d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwL1w8QSoi7WgaohsvLJ0w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7ef5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样做之后，将任务放在工作的末尾:</p><ol class=""><li id="df62" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击其中一个新任务。</li><li id="91a7" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将命令行任务显示名称更改为“生成服务”</li><li id="5114" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加脚本<code class="fe oj ok ol ob b">sudo ~/make-service.sh &lt;service name&gt; &lt;project name&gt;</code>。(有关如何使用该脚本的详细信息，请参考上一节。)</li></ol><p id="7e7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请不要忘记根据您环境的值来更改<code class="fe oj ok ol ob b">&lt;service name&gt;</code>和<code class="fe oj ok ol ob b">&lt;project name&gt;</code>占位符。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/ed47916839b6e2ec618c11619fa0f121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iecx5triEnCZwEBH9YzTBA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d5f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在添加Nginx配置:</p><ol class=""><li id="bd3f" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击最后一个任务。</li><li id="cd48" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“添加NGINX配置”</li><li id="a7ca" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加剧本<code class="fe oj ok ol ob b">sudo ~/add-nginx-conf.sh &lt;DNS&gt; &lt;proxy pass&gt; &lt;port&gt;</code>。(有关如何使用该脚本的详细信息，请参考上一节。)</li></ol><p id="8309" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请不要忘记使用您的环境值来更改<code class="fe oj ok ol ob b">&lt;DNS&gt;</code>、<code class="fe oj ok ol ob b">&lt;proxy pass&gt;</code>和<code class="fe oj ok ol ob b">&lt;port&gt;</code>占位符。</p><h2 id="cef7" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">3.创建运行性能测试作业</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/2e28c8a5e28af8648553b231a581015b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvpMdXDy3h5iG5ZGFvWH8Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="b6a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要创建新作业:</p><ol class=""><li id="e85a" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击pipeline选项卡上的三个点。</li><li id="f479" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">选取“添加代理作业”</li><li id="1fa1" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加两个新的命令行任务。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/079de9e31b967daf74acdfe21163c670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4isYp9wfDEhcnLzP9KCww.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="664c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要指定我们将使用的代理，请执行以下操作:</p><ol class=""><li id="12bf" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击新的“代理作业”</li><li id="17d3" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将<strong class="ky ir"> </strong>设置为从管道中继承。</li><li id="2a52" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">因为我们的代理使用的是Linux，所以根据需要将目标操作系统设置为Linux，将目标名称设置为“TestServer”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/de5017b84d9e1eb20e189c96aa36d40c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WjLH_5bld9PdZuxxKwkWAg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="fe9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">向下滚动到“代理作业”配置的底部，并确保在“附加选项”中，该作业将仅在所有之前的作业成功后运行此作业。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/032968f40ced633f69aab78f16d6b568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srwObSwK_SHRPayGMCKfhQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="f4ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JMeter测试产生一个CSV文件作为输出，但是在我们运行测试之后，输出文件不会被自动删除。为了防止我们添加文件而不是覆盖它，我们必须事先删除所有现有的输出。</p><ol class=""><li id="3193" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击第一个命令行任务。</li><li id="c2b7" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将任务显示名称更改为“删除JMeter结果”</li><li id="1e9e" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加删除脚本。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">删除JMeter结果脚本。</p></figure><p id="4087" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，要从CLI运行JMeter脚本，您必须首先理解JMeter命令的基本结构。JMeter有六个标志，你必须知道。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="11d1" class="mw ma iq ob b gy of og l oh oi">-n: Indicates that JMeter will run without GUI.<br/>-t: Specifies the test path.<br/>-l: Specifies the result filename.<br/>-J: Supply variables if required (optional).<br/>-j: Specifies log filename.<br/>-e: Specifies if JMeter should post a report.<br/>-o: Specifies the report location.</span></pre><p id="d0c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，下面的命令将运行一个位于主目录的JMeter实例，而不使用GUI(即从CLI)。</p><pre class="kg kh ki kj gt oa ob oc od aw oe bi"><span id="b668" class="mw ma iq ob b gy of og l oh oi">~/apache-jmeter-5.4.1/bin/jmeter -n -t tests/performancetest.jmx -l results.csv -Jprotocol=http -Jhost=myhost.com -j jmeter.log -e -o reports</span></pre><p id="ffcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JMeter将运行tests文件夹中的文件<code class="fe oj ok ol ob b">performancetest.jmx</code>，并输出文件<code class="fe oj ok ol ob b">results.csv</code>。</p><p id="8f1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JMeter还接受两个用户定义的变量，协议和主机。JMeter完成运行后，日志将被写入到<code class="fe oj ok ol ob b">jmeter.log</code>文件中，输出将被保存在<code class="fe oj ok ol ob b">reports</code>文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/6a81ccc5c82fccaf1bf069f00a57086a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Bg8yO-kVC1xg8oW0QMYAA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d07a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，您需要:</p><ol class=""><li id="7156" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击最后一个命令行任务。</li><li id="2bc6" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“运行JMeter”</li><li id="681a" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加JMeter脚本。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/070d9104b6644a4ff893be1676f1526e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gHiTPHo-3BdT3Kwgs77Ig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="31f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">若要发布测试结果，请添加一个新任务:</p><ol class=""><li id="b99e" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击<strong class="ky ir"> + </strong>符号。</li><li id="8f1e" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将“发布”添加到搜索栏。</li><li id="bbcc" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">在“发布管道项目”任务中，单击“添加”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/8365c659cdc8c3b7f0041017998607a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUReVmT-rEUNQ5IVGSA8Hw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自作者</p></figure><p id="0b21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">指定发布目录"</p><ol class=""><li id="6461" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击发布管道工件任务。</li><li id="7390" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将文件路径改为<code class="fe oj ok ol ob b">results.csv</code>。</li><li id="be84" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将工件名称更改为“jmeter”</li></ol><h2 id="be8c" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">4.创建发布生成和清理代理作业</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/2e28c8a5e28af8648553b231a581015b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvpMdXDy3h5iG5ZGFvWH8Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="a229" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建新工作:</p><ol class=""><li id="c4d6" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击Pipeline选项卡上的三个点。</li><li id="0a1d" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">选取“添加代理作业”</li><li id="4275" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加两个新的命令行任务。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/db4c95b86d600758ac0df0e6585eadc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWVEFIwC0FPqMDcV1RB6Lw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1c04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要指定我们将使用的代理，请执行以下操作:</p><ol class=""><li id="bd1c" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击新的“代理作业”</li><li id="1c28" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将“代理池”设置为从管道继承。</li><li id="ca80" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">因为我们的代理使用Linux，所以根据需要将目标操作系统设置为Linux，将目标名称设置为“BuildServer”。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/86ffe85eadf51207f5f790e7b7dc5160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iiFG66cYQQ49qVpPq21Bww.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8a5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">若要发布构建结果，请添加一个新任务:</p><ol class=""><li id="7364" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击<strong class="ky ir"> + </strong>符号。</li><li id="6a02" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将“核心”添加到搜索栏。</li><li id="ecf2" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">单击上的添加。NET核心任务。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/703b768d9673190e53e39aa47a05f714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNdF6uZThYNWVTaLOf0gtw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="144b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建任务后，您需要对其进行配置:</p><ol class=""><li id="052a" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">首先，单击发布任务。</li><li id="4819" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将任务显示名称更改为“发布”</li><li id="2322" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将命令更改为“发布”</li><li id="8e6f" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">对于参数，插入<code class="fe oj ok ol ob b">— configuration $(BuildConfiguration) — output $(build.artifactstagingdirectory)</code>。</li><li id="dee0" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">取消选中Zip复选框。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/490bf27fa1caa9ad6733038f263cea61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILh_1S9Op5Qi21qrZb9S3A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="9f4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了上传发布的工件，</p><ol class=""><li id="45da" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">点击<strong class="ky ir"> + </strong>符号。</li><li id="ba85" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将“发布工件”添加到搜索栏。</li><li id="54e3" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">在“发布构建工件”任务上单击添加。</li></ol><p id="1790" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后添加另外三个命令行任务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/b1bb42496d17efa27aa198176876a6e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ctae3x4vvU48gCSEMz4laA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8b90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试完成后，您需要删除Nginx配置:</p><ol class=""><li id="e456" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击第一个命令行任务。</li><li id="3391" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“删除NGINX配置”</li><li id="e18b" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加脚本<code class="fe oj ok ol ob b">sudo ~/remove-nginx-conf.sh &lt;DNS&gt; &lt;proxy route&gt;</code>。(有关如何使用该脚本的详细信息，请参考上一节。)</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/eb33d0189ad481c903a1e02aac4c3de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kwtu0s1tfoJfDCLk5mu6rA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="4a13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，取下<code class="fe oj ok ol ob b">appsettings.json</code>:</p><ol class=""><li id="922b" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击第二个命令行任务。</li><li id="e077" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“Remove appsettings.json”</li><li id="2aef" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加脚本<code class="fe oj ok ol ob b">sudo rm &lt;foldername&gt;/appsettings.json</code>。(有关如何使用该脚本的详细信息，请参考上一节。)</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/5a3f463f20d27c44fbb80690e249d7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLObls1QPlAyoYAYwFF_nQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3264" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要删除服务文件:</p><ol class=""><li id="da48" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单击第三个命令行任务。</li><li id="66b3" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">将显示名称更改为“删除服务”</li><li id="7e47" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">添加脚本<code class="fe oj ok ol ob b">sudo ~/remove-service.sh $(Build.DefinitionName)</code>。(有关如何使用该脚本的详细信息，请参考上一节。)</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/656075f0029bd0da878edcae3fd2201a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unxuBhuXALlKfvHTj31K-A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e991" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，这是你剩下的。下一步，我们将在我们的解决方案中实现持续开发。</p><ol class=""><li id="10a0" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">更改CI管道的名称。</li><li id="56ed" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">拯救管道。</li></ol></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6409" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">测试管道</h1><p id="c156" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">要测试管道，请转到管道部分，打开刚刚创建的管道，然后单击运行管道。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/2c28c8381b6a7272267c15b979ae1cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BT6jA-9k4CtUCPit.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="c970" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">摘要</h1><p id="a663" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在本教程中，您已经学习了如何使用Azure DevOps和shell脚本来自动化性能测试。我们使用. NET核心项目对其进行了测试。使用的Linux服务器是Centos 8。</p><p id="b2ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总结一下我们所做的工作:</p><ul class=""><li id="c43c" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr pf nq nr ns bi translated">安装了自承载的Azure生成代理。</li><li id="53f9" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr pf nq nr ns bi translated">为自动化配置了生成服务器。</li><li id="25c2" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr pf nq nr ns bi translated">准备CI管道。</li></ul><p id="4136" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，当您想要自动化性能测试时，您有了一个开放的剧本可以使用。</p></div></div>    
</body>
</html>