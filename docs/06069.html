<html>
<head>
<title>Exploring Google Play’s In-App Review API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Google Play的应用内评论API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-google-plays-in-app-review-api-8cd8586d26c5?source=collection_archive---------8-----------------------#2020-08-31">https://betterprogramming.pub/exploring-google-plays-in-app-review-api-8cd8586d26c5?source=collection_archive---------8-----------------------#2020-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a231" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">谷歌提供了一种应用内的系统范围的功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7cabe3e90166bbee60ed496734e67e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bohbMtxQmmnIOz3-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@jonasleupe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jonas Leupe </a>拍摄。</p></figure><p id="c988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个指南，解释如何集成新的谷歌应用内审查API，这是谷歌Play核心库的一部分。您还将学习如何使用FakeReviewManager测试API。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7952" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="c7ff" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">谷歌已经努力了很长时间来提供API，这将使他们能够访问Android开发者，以触发系统范围的功能，如自动填充OTP、应用内更新等。现在是应用内评论的时候了。</p><p id="929f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于像Android这样的系统，不可避免地会期望更多的定制和更好的应用内体验。谷歌几年前开始注意到这一点，并开始构建应用内更新等API。</p><p id="a9f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些API为开发人员提供了执行全系统功能的访问权限，而无需用户离开应用程序(应用内体验)。从长远来看，这些类型的改进将提高系统的质量。</p><p id="c789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入今天的主题，谷歌的应用内审查API将让开发者触发一个评级底单，用户可以在这里对应用进行评级并提供详细的审查。用户不再需要导航到Play Store来给出评论。</p><p id="3038" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了一个应用内评论API，下一个问题是什么时候要求用户评论。这是许多开发人员纠结的最棘手的问题之一，因为在正确的时间要求评审是至关重要的。</p><p id="ac08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这取决于应用程序的功能和类型。以下是关于这件事的一些注意事项:</p><ol class=""><li id="5410" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">当用户启动应用程序时，不要要求查看权限。</li><li id="a2f4" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">当用户正在执行任务时，不要用弹出评论来打断他们。</li><li id="b81a" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">只有当你确定用户已经对你的应用/游戏有足够的体验时，才要求评论。</li></ol><p id="20b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候集成API了。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6fc0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">综合</h1><p id="272b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">正如我所说，从1.8.0版本开始，应用内评论API是核心Google Play库的一部分。首先，我们需要在应用程序级<code class="fe nn no np nq b">build.gradle</code>文件中的dependencies标签下包含下面一行:</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="6152" class="nv md it nq b gy nw nx l ny nz"><strong class="nq iu">def play_core_version </strong>= '1.8.0'<br/>implementation "com.google.android.play:core:$<strong class="nq iu">play_core_version</strong>"</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="97fb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建ReviewManager实例</h1><p id="e8d9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们需要通过<code class="fe nn no np nq b">ReviewManagerFactory</code>创建<code class="fe nn no np nq b">ReviewManager</code>接口实例。利用这一点，我们可以开始一个应用内评论流程。我们必须用一个<code class="fe nn no np nq b">addOnCompleteListener</code>来观察反应。</p><p id="bdad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果请求成功，那么我们可以检索<code class="fe nn no np nq b">ReviewInfo</code>对象。必须记住，这个对象只在有限的时间内有效。因此，开发人员只需要在确定显示应用内审核流程时调用<code class="fe nn no np nq b">ReviewManager</code>实例上的<code class="fe nn no np nq b">requestReviewFlow</code>。</p><p id="1870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们看看如何创建<code class="fe nn no np nq b">ReviewManager</code>实例并调用<code class="fe nn no np nq b">requestReviewFlow</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从ReviewManager获取ReviewInfo数据。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3510" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">显示检查对话框</h1><p id="b834" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们有了<code class="fe nn no np nq b">ReviewInfo</code>，是时候调用评审流程了。这只能在我们从上一节的<code class="fe nn no np nq b">ReviewManager</code>中获得有效的<code class="fe nn no np nq b">ReviewInfo</code>时执行:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">触发审核流程。</p></figure><p id="088d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nn no np nq b">addOnFailureListener</code>和<code class="fe nn no np nq b">addOnCompleteListener</code>是请求的回调。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c90e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">测试</h1><p id="1134" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们已经完成了实现，是时候进行测试了。我们可以用内部测试跑道来测试。最重要的是应用要发布在Play Store的内测赛道，用户要安装。</p><p id="2df7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，我们可以使用来自应用内审查工件的<code class="fe nn no np nq b">FakeReviewManager</code>实现进行测试，它允许您伪造API的行为。要使用<code class="fe nn no np nq b">FakeReviewManager</code>，请用<code class="fe nn no np nq b">FakeReviewManager</code>实例替换<code class="fe nn no np nq b">ReviewManager</code>实例:</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="d774" class="nv md it nq b gy nw nx l ny nz">val manager = <strong class="nq iu">FakeReviewManager</strong>(context)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a9cb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">定额</h1><p id="20d5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了给用户提供良好的体验，Google Play实施了一些限制(例如，它显示查看对话框的频率)。目前还不清楚Google Play如何衡量这一点，因为它还处于早期阶段。但是我发现，当我在24小时内多次尝试请求审查流时，审查对话框没有显示。</p><p id="5cb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也不建议使用行动号召来触发评审流，因为用户可能会在之前调用它。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7c6f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="ea1f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">尽管API还处于早期阶段，但我已经看到许多开发人员在他们的产品级应用中使用它，并获得了显著的正面评价。我建议现在就使用它。我确信随着API的发展，开发人员最终会有更多的控制权。</p><p id="727e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读！</p></div></div>    
</body>
</html>