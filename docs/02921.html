<html>
<head>
<title>Workbox Strategies With Examples and Use Cases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有示例和使用案例的工具箱策略</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/workbox-strategies-with-examples-and-use-cases-ebb32f8cbe4d?source=collection_archive---------17-----------------------#2020-01-08">https://betterprogramming.pub/workbox-strategies-with-examples-and-use-cases-ebb32f8cbe4d?source=collection_archive---------17-----------------------#2020-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c2dc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用工具箱提高你的PWA</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c6034d861ff2979f376da2027a9a97b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ho8yrRDnFooVGRVISR2vQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://undraw.co/illustrations" rel="noopener ugc nofollow" target="_blank">插图unDraw </a></p></figure><p id="1d50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在网站上使用服务人员时，如果你已经熟悉API和服务人员线程内部的工作方式，你完全可以自己用普通的JavaScript编写所有代码。</p><p id="712d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，尽管普通的JS会给你更多的清晰度，仍然推荐你使用<a class="ae ky" href="https://developers.google.com/web/tools/workbox" rel="noopener ugc nofollow" target="_blank">工具箱</a>来代替，以避免错误并增加简单性<em class="lv">。</em></p><p id="3242" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox" rel="noopener ugc nofollow" target="_blank"> Workbox </a>是一组JavaScript库，旨在使用服务工作者和渐进式web应用开发来简化高级缓存的实现<strong class="lb iu">。</strong></p><p id="1a55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Workbox可以简化您的服务人员文件，通过使用无错误代码使其更具可读性，更易于更新。</p><p id="fcae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇短文中，我将为每个<a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies" rel="noopener ugc nofollow" target="_blank">工作箱策略</a>列出一个用例示例，旨在启发您，以防您对这些相对较新的细微差别感到困惑，或者刚刚开始使用工作箱。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4331" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">解释工具箱策略</h1><p id="2ae7" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">工作盒策略被用作响应客户端HTTP请求的方式。例如，假设客户端请求一个URL为<code class="fe na nb nc nd b">/styles/main.css</code>的资源。指定的策略告诉服务人员如何响应这一请求。服务工作者应该首先在缓存中寻找<code class="fe na nb nc nd b">/styles/main.css</code>资源吗？还是来自网络？还是两者都有？</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6ade" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">示例和使用案例</h1><p id="2e31" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为了确保您知道哪种策略最适合您的情况，让我们来看看所有可用工具箱策略的一些用例。</p><h2 id="43cd" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#cache_first_cache_falling_back_to_network" rel="noopener ugc nofollow" target="_blank">先缓存</a></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/85109dd31b04c2fd270401bc0c5202c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uRJFO0Q7iau29KfG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">首先尝试在缓存中查找资源</p></figure><p id="7119" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先尝试在缓存中查找资源。如果没有，尝试从网络上获取。用例:版本不经常改变的资源，例如字体文件</p><h2 id="7b91" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#network_first_network_falling_back_to_cache" rel="noopener ugc nofollow" target="_blank">网络第一</a></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/31bc87c22a4aaad4ad31f702a227e6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AHpx0R9MLP4JSZBV.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尝试先从网络上获取它</p></figure><p id="d1ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请先尝试从网络上获取它。如果找不到资源，尝试从缓存中获取它。用例:其最新版本很重要但仍然需要离线的资源，例如服务器端呈现的HTML资源</p><h2 id="4e22" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#cache_only" rel="noopener ugc nofollow" target="_blank">仅缓存</a></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/53fa3e03dc21dbfe1ba9097c6775626f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qKjsVYqhG5bjKnzY.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尝试仅从缓存中获取资源</p></figure><p id="c471" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请尝试仅从缓存中获取资源。用例:当你已经为一个文件配置了预缓存，并且想只使用那个资源时，例如一个<a class="ae ky" href="https://medium.com/better-programming/cache-handling-using-service-workers-and-the-cache-api-on-the-web-7c00c478d39b?source=friends_link&amp;sk=414f61ce6a9b9d612be1d617217422ad/#7093" rel="noopener">默认离线页面</a>或者一个占位符后备图像</p><h2 id="9d81" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#network_only" rel="noopener ugc nofollow" target="_blank">仅网络</a></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/b84949eb9f4eb4b43bb314927307e750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D3MfHKfEzgscbG3f.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尝试仅从网络获取资源</p></figure><p id="66b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尝试仅从网络获取资源<em class="lv">。</em>用例:只在在线活动期间有意义的页面，例如，活动用户页面及其资源</p><h2 id="e6cd" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#stale-while-revalidate" rel="noopener ugc nofollow" target="_blank">重新验证时失效</a></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/b563b54ea408a1bc0e4406993845d2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g_eXBiJIodXKtqSj.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#stale-while-revalidate" rel="noopener ugc nofollow" target="_blank"> stale-while-revalidate </a>策略是最复杂的工具箱策略。</p></figure><p id="7c55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尝试从网络和缓存中获取资源。如果可用，从高速缓存响应，并退回到网络。用网络响应更新缓存。用例:资源的最新版本并不重要，但加载时间具有优先权，例如，用于快速初始页面渲染的CSS文件。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="3ff1" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">应用工具箱策略</h1><p id="8f72" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">策略应用于指定的HTTP路由。为此，Workbox通过<code class="fe na nb nc nd b">registerRoute</code>函数提供了一个高层接口，该函数在运行时需要一个<code class="fe na nb nc nd b">RegExp</code>来匹配多条路径。</p><p id="499a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能允许<a class="ae ky" href="https://developers.google.com/web/tools/workbox/guides/route-requests" rel="noopener ugc nofollow" target="_blank">在添加基于所有匹配<code class="fe na nb nc nd b">RegExp</code>的路由URL的特定策略后，进行</a>路由缓存处理。</p><h2 id="eb78" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#stale-while-revalidate" rel="noopener ugc nofollow" target="_blank">重新验证时失效</a></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0ff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务工作者JavaScript文件中包含的上述单行代码声明，以任何扩展名<code class="fe na nb nc nd b">js</code>、<code class="fe na nb nc nd b">css</code>、<code class="fe na nb nc nd b">webp</code>、<code class="fe na nb nc nd b">png</code>或<code class="fe na nb nc nd b">svg</code>结尾的每个请求都应该由<code class="fe na nb nc nd b"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#stale-while-revalidate" rel="noopener ugc nofollow" target="_blank">StaleWhileRevalidate</a></code>策略处理。</p><p id="73e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有指定策略，则使用默认策略，即先缓存。</p><h2 id="c91d" class="ne me it bd mf nf ng dn mj nh ni dp mn li nj nk mp lm nl nm mr lq nn no mt np bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/workbox/modules/workbox-strategies#network_first_network_falling_back_to_cache" rel="noopener ugc nofollow" target="_blank">网络第一</a></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="b559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的路由注册对于服务器端呈现的应用程序来说很方便，在这些应用程序中，显示网站和数据库的最新版本很重要，但是在没有网络的情况下，您仍然希望至少向用户显示一些内容。</p></div></div>    
</body>
</html>