<html>
<head>
<title>Why You Should Use Python Pandas Over Vlookups for Merging Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么应该使用Python Pandas而不是Vlookups来合并数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/vlookups-are-cancelled-why-python-pandas-are-a-much-better-way-to-merge-data-dbce0126166a?source=collection_archive---------2-----------------------#2022-01-07">https://betterprogramming.pub/vlookups-are-cancelled-why-python-pandas-are-a-much-better-way-to-merge-data-dbce0126166a?source=collection_archive---------2-----------------------#2022-01-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c229" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个简单的介绍和模板脚本，没有必要的python经验。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/94f2dedac9915120c6aa8d5de1976cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqiCyH2jyipO7gVTGzCaaA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由来自<a class="ae ky" href="https://www.pexels.com/photo/female-office-worker-relaxing-with-feet-on-table-3790848/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ky" href="https://www.pexels.com/@olly?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">安德里亚·皮亚卡迪奥</a>拍摄</p></figure><p id="f01a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">VLookups很棒。在excel中打开一些数据，决定要在另一个表中查找的值，并使用它来合并所需的数据。</p><p id="deb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经在一个表中拥有了所有相关数据，可以对其进行进一步的分析。但是等等，你没有确保你的<code class="fe lv lw lx ly b">vlookup</code>键是按字母顺序排列的，这扰乱了操作，而且你说的是废话。</p><p id="c534" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您在继续您的项目之前没有检查这一点，现在您有一大堆工作要重做。</p><p id="46b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将数据合并在一起的简单操作应该不难，对吧？</p><p id="c772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入Python Pandas，最棒的是，你不需要有任何编码或Python经验就能有效地使用这个操作。</p><p id="2ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我非常提倡聪明地工作，而不是努力地工作，我知道我的局限性——当我手动做事时，我会犯错误。</p><p id="648a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有一个或两个集合要合并，并且您已经在excel中工作，Vlookups可能会很快，但是如果您手动添加的越多，就会很快变得耗时且容易出错。通过创建一个读入源数据集的脚本，您可以将操作设置为合并一次数据，包括您想要的任意多的列，并根据您的感觉反复运行。</p><p id="d58e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您有一项日常任务，包括下载一些数据，在excel中打开它，使用<code class="fe lv lw lx ly b">vlookup</code>添加一些信息以使数据更有用，关闭文件，将其附加到电子邮件中，然后发送给您的经理。一旦你非常熟练，你可能至少需要5分钟的手工工作，或者一周25分钟。不多，但是当你想到一年有20个小时，你就会意识到没人有时间做这些。</p><p id="f080" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们进入<em class="lz">如何</em>。</p><p id="c4c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用Spyder(Anaconda套件的一部分)来编辑我的python脚本。它很容易安装，最重要的是它是免费的。</p><p id="3c8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个虚拟脚本，您只需根据自己的需要进行调整:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="0310" class="me mf it ly b gy mg mh l mi mj"># import the pandas library and name it pd for short<br/>import pandas as pd</span><span id="bdec" class="me mf it ly b gy mk mh l mi mj"># import data, in this case csv<br/>dataset1 = pd.read_csv(r’filepath\filename.csv’)</span><span id="957e" class="me mf it ly b gy mk mh l mi mj">#import lookup table, what you would before have used as your vlookup<br/>lookup = pd.read_excel(r’filepath\filename.xlsx’, sheet_name = ‘sheetname’)</span><span id="b00c" class="me mf it ly b gy mk mh l mi mj"># merge on date and location<br/>datasetmerged = pd.merge(dataset1,lookup, left_on = [‘id’], right_on = [‘person_id’], how = ‘left’)</span><span id="8173" class="me mf it ly b gy mk mh l mi mj">## write back to csv (or excel or whatever type you like)<br/>datasetmerged.to_csv(r’filepath\filename.csv’, index = False)</span><span id="f24d" class="me mf it ly b gy mk mh l mi mj"># ’cause you are one:<br/>print(“SUCCESS”)</span></pre><p id="eead" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我读入我的数据集，随心所欲地命名它们(dataset1和lookup)，根据我的匹配<code class="fe lv lw lx ly b">id</code>合并它们，并输出到我命名为dataset_merged的<code class="fe lv lw lx ly b">DataFrame</code>。</p><p id="e078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我在自己选择的位置把它写回excel中。当您合并<code class="fe lv lw lx ly b">how = ‘left’</code>时，输出将保留您首先提到的所有文件(<code class="fe lv lw lx ly b">dataset1</code>)，并合并任何匹配的文件，这就是我们在这里想要的。</p><p id="68fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要根据多个匹配项进行合并，例如id和日期都需要匹配，请改用以下语法:</p><pre class="kj kk kl km gt ma ly mb mc aw md bi"><span id="9390" class="me mf it ly b gy mg mh l mi mj">datasetmerged = pd.merge(dataset1, lookup, left_on = [‘id’, ‘date’], right_on = [‘person_id’, ‘date’], how = ‘left’)</span></pre><p id="cd0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更重要的是，随着你对熊猫越来越有信心，你可以开始在同一个文件中编写你的分析脚本。例如，您可以创建透视表和聚合值，删除某些数据以消除噪音，删除不需要的列并输出有吸引力的图表，所有这些都是同一脚本的一部分。</p><p id="8c43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常简单的介绍，旨在让您快速使用该功能。有更多的文章更详细地解释了合并函数，如果你想继续追求高效的怠惰，我建议你这样做。</p><p id="5a97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关合并如何工作以及根据需要调整语法的更多信息，请参见熊猫文档:</p><div class="ml mm gp gr mn mo"><a href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd iu gy z fp mt fr fs mu fu fw is bi translated">熊猫.合并-熊猫1.3.5文档</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">将数据框架或命名的系列对象与数据库样式的连接合并。命名的系列对象被视为数据帧…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">pandas.pydata.org</p></div></div></div></a></div></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><div class="kj kk kl km gt mo"><a href="https://medium.com/@hollydalligan/membership" rel="noopener follow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd iu gy z fp mt fr fs mu fu fw is bi translated">加入Medium，我的推荐链接- Holly Dalligan</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">作为一名中型会员，您的部分会员费将支付给您所阅读的作家，您可以完全接触到每个故事……</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">medium.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ks mo"/></div></div></a></div></div></div>    
</body>
</html>