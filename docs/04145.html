<html>
<head>
<title>How to Handle User Interactions With Component-Based Architecture and Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用基于组件的架构和Jetpack Compose处理用户交互</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-handle-user-interactions-with-component-based-architecture-and-jetpack-compose-196e8cdd1aee?source=collection_archive---------15-----------------------#2020-03-25">https://betterprogramming.pub/how-to-handle-user-interactions-with-component-based-architecture-and-jetpack-compose-196e8cdd1aee?source=collection_archive---------15-----------------------#2020-03-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b43f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使UIComponents与ComposeActivity交互</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/90c48c45dbfbf749a92fce963ea88125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6EOOrQh_hGqoyNyL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@maartendeckers?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马腾·戴克斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="ece2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的上一篇文章中，我们使用Jetpack Compose创建了可重用的UIComponents:</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/better-programming/create-a-component-based-architecture-in-android-jetpack-compose-96980c191351" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">在Android Jetpack Compose中创建基于组件的架构</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">用不同的方式思考你的UI和它的后续类</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="994a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它的功能有限，因为UIComponents只能显示在屏幕上。本文将讨论没有被处理的用户交互，比如点击事件。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7aa8" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">什么是互动？</h1><p id="b472" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">它是UIComponents上的一个事件(例如,<code class="fe nr ns nt nu b">MovieUI</code>组件上的一个点击事件)。</p><p id="185b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">UIComponent上的交互将由包含UIComponents的<code class="fe nr ns nt nu b">ComposeActivity</code>类处理。例如，<code class="fe nr ns nt nu b">HomeScreen</code>中的<code class="fe nr ns nt nu b">MovieView</code> <em class="nv"> </em>上的点击事件由<code class="fe nr ns nt nu b">HomeScreen Activity</code>处理。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c06f" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">我们在建造什么？</h1><p id="70b5" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我们有<code class="fe nr ns nt nu b">HomeScreen</code>和<code class="fe nr ns nt nu b">MovieDetailScreen</code> <em class="nv">。</em>两者都包含电影(<code class="fe nr ns nt nu b">MovieView</code> ) <em class="nv">。</em>点击<code class="fe nr ns nt nu b">MovieView</code>会导致导航到所点击电影的<code class="fe nr ns nt nu b">MovieDetailScreen</code> <em class="nv"> </em>。</p><p id="a5cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这需要遵循架构中的变化(红色部分):</p><ul class=""><li id="2d0d" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated">我们的视图模型(表示层)保持不变。</li><li id="bf58" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><code class="fe nr ns nt nu b">UIComponent</code>通过一个接口将事件传播到<code class="fe nr ns nt nu b">ComposeActivity</code>(<code class="fe nr ns nt nu b">UIDelegate</code>——解释如下)。</li><li id="f5db" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated"><code class="fe nr ns nt nu b">ComposeActivity</code>通过实现上面的接口来处理事件。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/a738b949611915b0891006a4d212cbce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48PbEE-qxGb-NDeqrO6L2A.jpeg"/></div></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="84c1" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">让我们来建造它吧</h1><ol class=""><li id="a8b7" class="nw nx it lb b lc nm lf nn li ol lm om lq on lu oo oc od oe bi translated">首先，我们需要更改UIComponent。我们将它转换为类型<code class="fe nr ns nt nu b">UIDelegate</code>的通用接口。<code class="fe nr ns nt nu b">composableView()</code>函数现在接受泛型<code class="fe nr ns nt nu b">UIDelegate</code>。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="6885" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">什么是<code class="fe nr ns nt nu b">UIDelegate</code>？它是一个负责将UI事件/交互从<code class="fe nr ns nt nu b">UIComponent</code>发送到<code class="fe nr ns nt nu b">View</code> (activity)的接口。下面用一个例子来解释。</p><p id="95aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MovieView <strong class="lb iu"> </strong>现在应该可以发送点击事件了。如上所述，交互是通过<code class="fe nr ns nt nu b">UIDelegate</code>来处理的。为此，<code class="fe nr ns nt nu b">MovieUIDelegate</code>接口被创建为具有接收电影点击的能力。</p><p id="6a4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个<code class="fe nr ns nt nu b">UIDelegate</code>作为参数传递给<code class="fe nr ns nt nu b">Composable</code>函数<strong class="lb iu">。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MovieView将click事件传递给MovieUIDelegate。</p></figure><p id="0e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2 </strong>。因此，<code class="fe nr ns nt nu b">MovieListUIComponent</code>负责将<code class="fe nr ns nt nu b">MovieUIDelegate</code>传递给<code class="fe nr ns nt nu b">MovieView</code>。这是一个介于<code class="fe nr ns nt nu b">MovieView</code>和<code class="fe nr ns nt nu b">ComposeActivity</code>之间的中间人。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对处理click事件进行了更改的MovieListUIComponent。</p></figure><p id="d6b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。</strong><code class="fe nr ns nt nu b">View</code>(Jetpack Compose activity)应该实现<code class="fe nr ns nt nu b">MovieUIDelegate</code>来处理事件。点击电影打开该电影的<code class="fe nr ns nt nu b">MovieDetailScreen</code> <em class="nv"> </em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="c600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由<code class="fe nr ns nt nu b">ComposeActivity</code>实现的<code class="fe nr ns nt nu b">UIDelegate</code>被传递给组件，同时将其呈现在屏幕上。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="2d9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以从这里获得完整的代码:</p><div class="lv lw gp gr lx ly"><a href="https://github.com/AnupAmmanavar/MovieBrowsing/tree/master/jetpackui/src/main/java/com/kinley/jetpackui/jetcompose" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">AnupAmmanavar/电影浏览</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="or l mj mk ml mh mm ks ly"/></div></div></a></div><p id="22fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nr ns nt nu b">ComposeActivity</code>处理多个组件的情况下，这是通常的情况，它需要实现其视图中包含的所有UIComponents的所有<code class="fe nr ns nt nu b">UIDelegates</code>。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="ac1b" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">结论</h1><p id="ac89" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">就是这样！我们已经创建了一个向外部世界发送事件的UIComponent。现在，这些事件被发送到<code class="fe nr ns nt nu b">ComposeActivity</code>。在下面的文章中，我们将看到UIComponent如何与表示层交互。此外，我们将看到UIComponents之间的交互。</p></div></div>    
</body>
</html>