<html>
<head>
<title>Custom Gestures in SwiftUI 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI 2.0中的自定义手势</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/custom-gestures-in-swiftui-2-0-132590d66ee7?source=collection_archive---------8-----------------------#2021-01-11">https://betterprogramming.pub/custom-gestures-in-swiftui-2-0-132590d66ee7?source=collection_archive---------8-----------------------#2021-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c67a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习实现非自带的自定义手势</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1f7fae73fc1022fca2435f7bafb046ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6uGkVJ5HUmzSFzH7sBmH1g.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者GIF。</p></figure><p id="c3ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一个守旧派，当iPad第一次出现时，我无法想象为什么会有人想要一个没有键盘的设备。我大错特错了，因为你用iPad得到的基于触摸的界面是它的决定性差异。正是这一点让这款产品如此人性化。回想起来，我已经忘记了使用键盘是我的第二天性，但对一般人来说却不一定如此。</p><p id="504d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我想探索SwiftUI 2.0中自定义手势的世界，并在一定程度上重写这个优秀的<a class="ae lu" href="https://www.raywenderlich.com/1724-uigesturerecognizer-tutorial-creating-custom-recognizers#toc-anchor-006" rel="noopener ugc nofollow" target="_blank">教程</a>，这个主题是<a class="ae lu" href="https://www.raywenderlich.com/u/mkatz" rel="noopener ugc nofollow" target="_blank">迈克尔·卡茨</a>为<a class="ae lu" href="https://www.raywenderlich.com/" rel="noopener ugc nofollow" target="_blank">raywenderlich.com</a>写的。</p><p id="6e45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个游戏，假设你至少浏览过教程，你会知道我们需要从一个简单的网格开始玩。我们用Swift 2.0吧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0b23634315392b795436facb12f266f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMdmAVbGZrkq51d3r-f3nA.png"/></div></div></figure><p id="83c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个想法是用一个不同于所有其他生物(还有一些其他生物)的手势把青蛙圈起来。当然，挑战在于SwiftUI没有圆形手势。我们需要创造一个。这是让我们开始的代码模板。您可以在这里看到视图的模板。显然，我借用了原始教程中的图片。</p><p id="06a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在其中，我使用了Swift2.0 grid和Combine框架，我使用该框架通过<code class="fe lw lx ly lz b">nextSet passthroughSubject</code>消息管理图像到新集合的刷新。从数组中可以看到，有四种动物:一只青蛙、一只狼、一只熊和一只猫。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="d482" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很好。现在我们可以专注于手势。在Swift 2.0中，您有一些内置的手势。但是，这是我们真正面临挑战的地方。Mike的教程是基于UIKit的触摸手势(SwiftUI中我们没有的手势)。所以我将尝试通过创造性地使用拖拽手势来达到同样的效果。</p><p id="45f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，在我开始之前，这里有一个我写的关于用SwiftUI绘图的另一篇文章的快速参考，我将借用它的一个例程:</p><div class="mc md gp gr me mf"><a href="https://medium.com/analytics-vidhya/shapes-with-paths-using-swiftui-part2-98760ed0a3d7" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">使用SwiftUI的带路径的形状第2部分</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">使用路径的形状概要</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ks mf"/></div></div></a></div><p id="3e68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">画多边形的例程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="f5c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有一个管理视图的例程:</p><div class="mc md gp gr me mf"><a href="https://levelup.gitconnected.com/6-ways-to-show-hide-views-in-swiftui-d55fd3485009" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">在SwiftUI中显示和隐藏视图的6种方法</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">探索在SwiftUI中显示和隐藏视图的不同方法</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt ks mf"/></div></div></a></div><p id="11c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我感兴趣的特定方法的代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="1522" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们关注手势——特别是拖拽手势。我将在网格内的每个方框中添加一个。在这一级添加手势有助于我了解它返回的坐标，并让我立即知道他们画了哪个框。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="361c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我浏览这段代码之前，这里是它作为<code class="fe lw lx ly lz b">observedObject</code>(一个我作为单例引用的对象)引用的类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="b394" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在singleton中，我保存了代码中<code class="fe lw lx ly lz b">drawPoly</code>方法引用的坐标的四个副本——一个多维数组。</p><p id="46ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它的工作方式是拖动手势不断更新四组中的一组，这取决于你画的是哪一个方块。由于集合是已发布的对象，更新会立即被<code class="fe lw lx ly lz b">drawPoly</code>例程反映出来。这就是我们的结局。注意，我把方框改成了圆形，以帮助我在测试时画圆。这个动画GIF是已经完成的应用程序。你需要继续阅读，因为我们还没到那一步。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cc83bb02ca2e985dcd832df56f29bc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wB9BR7kmk1w3HqtEXGhCcQ.gif"/></div></div></figure><p id="eb9b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我试了几个明显不是圈的东西，它忽略了我，尽管它也忽略了一些非常糟糕的圈。</p><p id="1e95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们需要Mike的输入，或者更确切地说，他从Nikolai Chernov的C++实现中找到并改编的例程，该实现将一系列点拟合为一个圆。这种方法被称为陶宾拟合。他的代码可以在一个名为<code class="fe lw lx ly lz b">CircleFit.swift</code>的函数中找到，因为它是在Swift 3.0中，所以我不得不做一些小的调整。现在已经画了圆，当用户完成绘制时，您可以使用它来检查以下细节:</p><ul class=""><li id="8045" class="mv mw it la b lb lc le lf lh mx ll my lp mz lt na nb nc nd bi translated">如果是圆的话。</li><li id="32d8" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">如果是，如果是正确的。</li></ul><p id="937f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这几乎把我带到了这篇文章的结尾。我想做得更多，但我认为我已经做得足够多，为你完成工作打下了良好的基础。这是模板的第二个副本，这次包含了我一直在谈论的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="5129" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是迈克改编代码的副本。我稍微修改了一下，可以在Swift 5.0上运行。抱歉，太长了。不要责备我，我只是个信使。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="1665" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">等等，我还没教你怎么用<code class="fe lw lx ly lz b">CircleFit</code>。为了使用它，我改变了拖拽手势的<code class="fe lw lx ly lz b">.end</code>。现在看起来是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="36e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些代码是做什么的？好吧，如果你选择正确，它播放哔哔声，并移动到下一集。如果你弄错了，它会播放不同的声音，然后给你一个再试的机会。</p><p id="5428" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你能像我写这篇文章一样喜欢阅读。如果你读了雷的文章，你会发现这个圈子里的匹配业务远比我在这里介绍的要多。我会把它作为家庭作业留给你们，作为学习练习融入到这个项目中。点击此链接阅读后续文章。</p><div class="mc md gp gr me mf"><a href="https://medium.com/codestory/correcting-paths-on-custom-gestures-with-swiftui2-0-7113019684f0" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">使用SwiftUI2.0纠正自定义手势的路径</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">寻找不同的方法来改善绘画</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">medium.com</p></div></div><div class="mo l"><div class="nj l mq mr ms mo mt ks mf"/></div></div></a></div><p id="beb1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">保持冷静，继续编码。</p><p id="5ec0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nk">答案:青蛙的眼睛不同，狼缺了一颗牙，熊的帽子上有不同的图案，猫的右耳也不同。</em></p></div></div>    
</body>
</html>