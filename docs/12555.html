<html>
<head>
<title>Create a Serverless Form for a Serverless Website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为无服务器网站创建无服务器表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-serverless-form-for-a-serverless-website-69b1a62c4eeb?source=collection_archive---------12-----------------------#2022-06-13">https://betterprogramming.pub/create-a-serverless-form-for-a-serverless-website-69b1a62c4eeb?source=collection_archive---------12-----------------------#2022-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2861" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何创建一个无服务器的后端来接受输入的表单数据(或来自API请求的其他数据)并发送包含这些数据的电子邮件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/512307924587702971039ec2d748b1f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*54V65V93k8LH86Nu"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔纳森拍摄于<a class="ae ky" href="https://unsplash.com/photos/SwVkmowt7qA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="b7f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3 </a> + <a class="ae ky" href="https://aws.amazon.com/cloudfront/" rel="noopener ugc nofollow" target="_blank"> CloudFront </a>为托管一个静态网站提供了一个简单且低成本的解决方案。但是，当您需要一个HTML表单时会发生什么呢？为此，我们将介绍如何实现一个简单的无服务器后端！</p><h1 id="5194" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">介绍</h1><p id="1f34" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> AWS S3 </a> + <a class="ae ky" href="https://aws.amazon.com/cloudfront/" rel="noopener ugc nofollow" target="_blank"> Cloudfront </a>为托管静态网站提供了一个低成本、可扩展的选择，比如初创公司的<a class="ae ky" href="https://avantsoft.com.br/" rel="noopener ugc nofollow" target="_blank">登录页面</a>，或者时事通讯的注册页面。但是，如果没有服务器，如何实现表单呢？</p><p id="d8a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将使用AWS的<a class="ae ky" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> Lambda </a>和<a class="ae ky" href="https://aws.amazon.com/api-gateway/" rel="noopener ugc nofollow" target="_blank"> API网关</a>来检查一个表单的无服务器后端，以触发使用<a class="ae ky" href="https://aws.amazon.com/ses/" rel="noopener ugc nofollow" target="_blank"> AWS SES </a>将表单中已填写的信息发送到预定的电子邮件。</p><h1 id="e807" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">先决条件</h1><p id="8ec4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我们深入Lambda的代码之前，我们需要设置开发环境和我们的AWS帐户，包括以下几点:</p><ol class=""><li id="d7bc" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">AWS无服务器应用模型(SAM)本地开发工具按照此处的说明进行安装。</li><li id="79d7" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">AWS SES是在生产模式(非沙箱)下配置的，并且域已经按照这里的说明<a class="ae ky" href="https://docs.aws.amazon.com/ses/latest/dg/request-production-access.html" rel="noopener ugc nofollow" target="_blank">进行了验证。</a></li><li id="52cf" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">拥有一个带有HTML表单的网站，该表单可以被配置为向API网关的端点提交数据，API网关将在本文稍后创建。</li></ol><h1 id="3d50" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">履行</h1><p id="2143" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://aws.amazon.com/serverless/sam/" rel="noopener ugc nofollow" target="_blank"> SAM </a>来部署Lambda及其依赖资源。关于山姆的更深入的介绍，请看下面的文章。</p><div class="ng nh gp gr ni nj"><a rel="noopener  ugc nofollow" target="_blank" href="/private-serverless-rest-api-with-lambda-using-sam-2eb31864b243"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">使用SAM的AWS Lambda私有无服务器REST APIs</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">使用Lambdas快速创建无服务器微服务</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">better编程. pub</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ks nj"/></div></div></a></div><p id="c33e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">先说文件夹结构。我们将有一个应用程序源文件目录，一个可用于部署应用程序的脚本目录，以及SAM使用的顶层文件，如<code class="fe ny nz oa ob b">template.yaml</code>。</p><pre class="kj kk kl km gt oc ob od oe aw of bi"><span id="fa65" class="og lw it ob b gy oh oi l oj ok">my-serverless-form/<br/>├── cmd/<br/>│   └── deploy.sh<br/>├── src/<br/>|   ├── package.json<br/>│   └── index.js<br/>├── .gitignore <br/>└── template.yaml</span></pre><p id="3be4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa ob b">template.yaml</code>将如下图所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="0ac8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的模板定义了两个资源:</p><ol class=""><li id="4326" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><code class="fe ny nz oa ob b">FormSubmissionFunction</code>:当被触发时会发送电子邮件的Lambda。</li><li id="65c9" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe ny nz oa ob b">FormSubmissionApi</code>:API网关，接收来自互联网的公共请求，触发Lambda。</li></ol><p id="8955" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">λ代码将在如下所示的<code class="fe ny nz oa ob b">index.js</code>文件中指定:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="4847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在其中，我们使用<a class="ae ky" href="https://aws.amazon.com/ses/" rel="noopener ugc nofollow" target="_blank"> SES </a>发送一封电子邮件，其中包含来自<code class="fe ny nz oa ob b">eventObject</code>的数据，该数据将包含用于触发Lambda的请求的主体和标头。您可以根据需要设置电子邮件正文的格式。</p><p id="754f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解析Lambda中的表单数据，我推荐使用下面的库:</p><div class="ng nh gp gr ni nj"><a href="https://github.com/francismeynard/lambda-multipart-parser" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">GitHub-Francis meynard/lambda-multipart-parser:这个nodejs模块将解析multipart-form…</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">这个nodejs模块将解析包含来自AWS lambda事件对象的文件和字段的多部分表单。它有效…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="on l nu nv nw ns nx ks nj"/></div></div></a></div><p id="81e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要部署Lambda，您可以运行<code class="fe ny nz oa ob b">script.sh</code>文件(如下所示),并按照屏幕指示进行操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="2bb7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="ddc1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们已经讨论了如何创建一个无服务器的后端，它可以用来接受输入的表单数据(或来自API请求的其他数据)并发送包含这些数据的电子邮件。</p><p id="7c7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在将这样的东西部署到生产之前，实现<a class="ae ky" href="https://www.google.com/recaptcha/about/" rel="noopener ugc nofollow" target="_blank"> reCaptcha </a>(或类似的)可能是明智的，以避免机器人发现您的端点并提交错误的数据(您不想因为从机器人发送电子邮件而被收取Lambda执行时间的费用)。</p><p id="b512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这对你有帮助！</p><p id="05f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oo">如果你有任何问题或只是想聊聊创业、创业、承包或工程，请发邮件给我，地址是Paulo @</em><a class="ae ky" href="https://avantsoft.com.br/" rel="noopener ugc nofollow" target="_blank"><em class="oo">avantsoft.com.br</em></a><em class="oo">。</em></p></div></div>    
</body>
</html>