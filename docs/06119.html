<html>
<head>
<title>Importing and Exporting Files in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中导入和导出文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/importing-and-exporting-files-in-swiftui-719086ec712?source=collection_archive---------2-----------------------#2020-09-03">https://betterprogramming.pub/importing-and-exporting-files-in-swiftui-719086ec712?source=collection_archive---------2-----------------------#2020-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="15df" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用视图修饰符在应用程序中导入或导出数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b9fe74eb1321980f04f6b17201c5341b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y-Ryocmdbax7ppQK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">维克多·塔拉舒克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="1c4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在WWDC 2020大会上，SwiftUI推出了使用新的<code class="fe lv lw lx ly b">@Environment</code>变量向您的应用程序导入和从中导出数据的功能。虽然这些新增功能对SwiftUI来说是一个受欢迎的改进，但它们有点笨重。随着iOS 14 beta 6的发布，苹果为我们提供了一套新的视图修改器，减少了进出口摩擦。</p><p id="f409" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过创建一个可以以纯文本格式导入和导出数据的简单项目来探索这些新的视图修饰符。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="56b4" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">入门</strong></h1><p id="6a26" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">首先使用iOS应用程序模板创建一个新的Xcode项目。确保您已经为界面选择了“SwiftUI ”,为生命周期选择了“SwiftUI App”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/8a8f94ca8749d174e6a31f6473c1034f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GR6MEuNOUChBO88Tyz_-6w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者为这个项目使用的Xcode选项。</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0f90" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">创建文档类型</strong></h1><p id="8a16" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们需要提供一个文档类型来表示我们导出的数据，所以接下来让我们创建它。我们的文件将是符合<code class="fe lv lw lx ly b">FileDocument</code>协议的<code class="fe lv lw lx ly b">struct</code>。</p><p id="876e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个名为<code class="fe lv lw lx ly b">MessageDocument.swift</code>的新Swift文件，内容如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="ab86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们的文档是一个简单的包装器，包装了一个名为<code class="fe lv lw lx ly b">message</code>的<code class="fe lv lw lx ly b">String</code>变量。在您的应用程序中，这个文档可以表示您希望导出的任何数据。上面的代码是我们对纯文本文件进行编码和解码所需的全部内容。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="23af" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">创建用户界面</h1><p id="3874" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">接下来，我们将创建一个基本的UI，允许我们编辑消息并提供导入和导出按钮。在<code class="fe lv lw lx ly b">ContentView.swift</code>中，将内容替换为以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6db4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里没什么意思。我们已经创建了一个<code class="fe lv lw lx ly b">TextEditor</code>元素，它绑定到我们文档的<code class="fe lv lw lx ly b">message</code>属性，这将允许我们编辑我们的消息。我们还制作了两个绑定到几个<code class="fe lv lw lx ly b">State</code>变量的导入和导出按钮。现在是时候实施导入导出了！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6a0d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">实现出口</strong></h1><p id="31b4" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在我们的<code class="fe lv lw lx ly b">VStack</code>上的<code class="fe lv lw lx ly b">.padding()</code>修饰符下面，添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">fileExporter()</code>方法接受一个到我们的<code class="fe lv lw lx ly b">isExporting</code>变量的绑定，以及一个到要在导出时写入的文档的绑定。我们还为该方法提供了符合<code class="fe lv lw lx ly b">UTType</code>的内容类型和默认文件名。在我们的简单示例中，我们可以忽略结果，但是您可能希望在应用程序中更加健壮，并在导出成功或失败时向用户提供反馈。</p><p id="2d09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码是我们导出一个文件所需要的全部！在模拟器中运行并尝试一下！按下<code class="fe lv lw lx ly b">Export</code>按钮会出现一个模态对话框，您可以在其中选择保存文件的位置，并根据需要重命名文件。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0428" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">实施进口</strong></h1><p id="28c1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在我们可以导出我们的消息了，让我们颠倒这个过程并实现import，这样我们就可以从我们新导出的文件中读取数据。在<code class="fe lv lw lx ly b">fileExporter()</code>方法下面，添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="3af9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">fileImporter()</code>方法也接受一个表示绑定——这次是绑定到我们的<code class="fe lv lw lx ly b">isImporting</code>变量。<code class="fe lv lw lx ly b">allowedContentTypes</code>属性接受一个<code class="fe lv lw lx ly b">UTType</code>类型的数组，该数组将限制用户的选择。如果您希望用户选择多个文件，也可以将<code class="fe lv lw lx ly b">allowsMultipleSelection</code>设置为<code class="fe lv lw lx ly b">true</code>，但是在这个简单的例子中，我们一次只允许导入一个文件。</p><p id="be3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在结果块中，<code class="fe lv lw lx ly b">result.get()</code>方法为用户选择的文件返回一个<code class="fe lv lw lx ly b">URL</code>数组。在我们的例子中，我们只对第一个<code class="fe lv lw lx ly b">URL</code>感兴趣，因为我们已经将<code class="fe lv lw lx ly b">allowsMultipleSelection</code>设置为<code class="fe lv lw lx ly b">false</code>。我们从这个<code class="fe lv lw lx ly b">URL</code>中读取<code class="fe lv lw lx ly b">Data</code>,并将其转换为一个<code class="fe lv lw lx ly b">String</code>,然后分配给我们文档的<code class="fe lv lw lx ly b">message</code>属性。</p><p id="94ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重新运行项目，您应该能够将之前导出的文件导入到应用程序中！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6cdd" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="ee45" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果您遵循了本教程，您现在应该有一个在SwiftUI中导入和导出的工作示例。</p><p id="beb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读和快乐编码！</p><p id="95b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitHub 上的<a class="ae ky" href="https://github.com/acwright/ImportExport" rel="noopener ugc nofollow" target="_blank">提供了示例代码。</a></p></div></div>    
</body>
</html>