<html>
<head>
<title>Introduction to Beautiful Soup in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的美汤介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/introduction-to-beautifulsoup-in-python-5ea1c68dc58d?source=collection_archive---------9-----------------------#2019-09-03">https://betterprogramming.pub/introduction-to-beautifulsoup-in-python-5ea1c68dc58d?source=collection_archive---------9-----------------------#2019-09-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1698" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为那些希望从网页中提取数据的人提供的资源</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e0ea3b2af7dccc27297bc42ef5bc653d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kWsiLu-Dr0TPVoX9"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@ellaolsson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾拉·奥尔森</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="91ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在当今的技术环境下，数据非常重要。收集数据是为了研究趋势和分析信息，否则将需要更长的时间来收集。</p><p id="ffea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，收集这些数据是棘手的部分。很多时候，数据并没有交给你，你需要出去收集这些数据。</p><p id="be13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，我们有<a class="ae kv" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank">漂亮的汤</a>，一个Python编程语言的库，它允许我们有能力抓取网页数据。有了这些数据，我们可以放入易于查看的列，并进一步评估趋势。</p><p id="17ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我个人参与的许多项目都需要我使用漂亮的Soup库，我的目标是为那些想做同样事情的人创建一个有用的资源。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="29a1" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">入门指南</h1><p id="69b3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">首先，我们需要将库导入到笔记本中。这将允许我们从网页上抓取数据。</p><p id="5f77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们要添加的第一个导入是<a class="ae kv" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>，我们将把它作为<code class="fe mw mx my mz b">pd</code>导入。</p><p id="e9b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用的第二个导入是<a class="ae kv" href="https://2.python-requests.org/en/master/" rel="noopener ugc nofollow" target="_blank">请求</a>，我们可以将它作为<code class="fe mw mx my mz b">req</code>导入。Requests用于从外部URL获取HTML数据。</p><p id="2f43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的情况下，我还导入了时间库，我习惯在再次刮之前暂停一秒钟。这通常在您需要访问多个页面时使用。</p><p id="91d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可能需要这样做的原因是，抓取太快可能会导致你被标记为黑客。黑客试图用请求淹没系统的服务器，最终导致服务器崩溃。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/d1f48138e8ed909bb7d52d7a48ed7974.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*CT7RQ6rbOy6qjHcbrytlYA.png"/></div></figure><p id="ed7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">检查网站的条款和条件页面也是一个很好的做法。这是因为条款和条件页可能有关于你可以刮的信息。</p><p id="4e63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经有了导入并检查了是否能够抓取我们想要的网页，我们可以检查状态代码了。</p><p id="21ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一件事是将所需的URL传递到请求库中以获取内容。这允许我们确定网页是否允许我们抓取想要的网页。我将用篮球参考网站作为我的例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/fac1dbf501af068313d40cbad73d3e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*BCyhqHaNHMdbokGDYDtvqw.png"/></div></figure><p id="d33f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们要找的代码是<code class="fe mw mx my mz b">200</code>。200代码表示可以抓取想要的网页。状态代码类似于您在地址栏中输入不存在的URL时收到的404错误，这意味着未找到<em class="nc">页面</em>。</p><p id="ff27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常情况下，以4开头的错误意味着您这边有错误。以5开头的错误通常意味着服务器出现了错误，您无能为力。</p><p id="65a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然我们已经有了<code class="fe mw mx my mz b">200</code>状态代码并获得了抓取权限，我们可以用<code class="fe mw mx my mz b">‘lxml’</code>解析库将请求的内容放入漂亮的Soup中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/d06fc9e57a384a12c6639489cf06882d.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*31CDiiDUO4WZt8Cq-9zuzQ.png"/></div></figure><p id="43ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要转到我们的网页，右键单击页面上的任意位置，然后单击<em class="nc"> inspect </em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/6e60fd49a6871bec43aea67cad135d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Q-3QV9dJYxK1dkydne8f4g.png"/></div></figure><p id="77ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，这将返回页面上的HTML内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/e0ea96e2d8e9f058ea7920e7df63fd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pajUV1tOSB3NBJu3NIQJXQ.png"/></div></div></figure><p id="e49d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面我们可以看到，当我们高亮显示HTML标签表格时，它会高亮显示网页上的整个表格。这是完美的，因为这是我们希望收集的数据。</p><p id="1ff5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了抓取我们想要的内容，我们需要找到一些独特的东西来标识特定的表。为此，我们使用<code class="fe mw mx my mz b">table = soup.find</code>来查找特定的HTML标签。</p><p id="1c55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">dictionary方法在我们正在寻找的<code class="fe mw mx my mz b">‘table’</code>中找到特定的HTML标签。正如你在下面看到的，我使用了高级统计的ID，它是如何显示在网页上的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/746020fe49cce2f8bac729a4fe375dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*edQsIMgjxTyYUqzCChc6rA.png"/></div></figure><p id="067b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们创建一个空列表。空列表将从循环HTML中所有内容的<code class="fe mw mx my mz b">for</code>循环中出来。</p><p id="debc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一个<code class="fe mw mx my mz b">for</code>循环中，我们创建了一个字典，用来自<code class="fe mw mx my mz b">for</code>循环的所有信息填充字典，并使用append方法将其添加到一个列表中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8f8792b18f669b8c7bf7499754a331c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*wG8QXnrg7ZJtWCIMAI3N1Q.png"/></div></figure><p id="fb76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们查看表格时，我们需要确定每一列中需要哪些属性。同样，我们需要在HTML标记中找到特定的信息，以明确返回列中的内容。</p><p id="1e81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以索引特定的项目，以便更好地识别我们希望提取的内容。</p><p id="c134" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个有用的技术是<code class="fe mw mx my mz b">.all</code>技术。<code class="fe mw mx my mz b">.Find_all</code>方法获取该行中所有单元格的列表。我们可以用它来确定我们正在寻找的HTML标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/170ff971513c06ba1156da46dc538340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1vYCb7nbHqN6LT-KPZBBVg.png"/></div></div></figure><p id="2de1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">返回每一列的全部代码都封装在一个<code class="fe mw mx my mz b">try</code>中，除了告诉Python如果我们没有抓取任何数据就继续运行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/e5e9706da3d7b99e78ea662c0931dd32.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*-MTf3dQ4e7iJ0M_hHjscJQ.png"/></div></figure><p id="2eb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我上面提到的，我使用了<em class="nc"> sleep 1 </em>，告诉Python在每次刮擦后休眠一秒钟。</p><p id="29af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我将列表添加到字典中，并使用名称<em class="nc">数据帧</em>。为了进行健全性检查，我还要求输入前五行数据，以确保所有数据都是有序的。</p><p id="c335" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以查看形状，以了解新数据框中有多少列和多少行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/149c019599b5d728d26a18f646221e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*Re6ankPH7u2_LnZJdt9afQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/45ffeeb3e8d113b26feb787f61c2b09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*A6Bi9aVrNnfxtyl7DdT7qw.png"/></div></figure><p id="f5fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时，我们使用panda的<code class="fe mw mx my mz b">.to_csv</code>将数据帧转换成CSV格式。</p><p id="2549" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这篇文章对那些希望从网页中提取数据的人有所帮助。我决定写这篇文章，因为美丽的汤是我的顶点的巨大部分。</p><p id="a164" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我觉得这是一项非常有价值的技能，可以用来返回一个CSV，您可以在其中进一步研究您的数据。</p></div></div>    
</body>
</html>