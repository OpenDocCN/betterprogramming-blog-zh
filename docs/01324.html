<html>
<head>
<title>iOS: Implementing the Notification/Observer Communication Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS:实现通知/观察者通信模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/ios-lets-implement-that-notification-observer-communication-pattern-fc513f61b33e?source=collection_archive---------7-----------------------#2019-09-01">https://betterprogramming.pub/ios-lets-implement-that-notification-observer-communication-pattern-fc513f61b33e?source=collection_archive---------7-----------------------#2019-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9705" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过案例研究解释这种模式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8e63dd94b29a6a0bac360ea9715c431f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zb6W50gQNY1po5hyK-byAQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@dnnsbrndl?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹尼斯·布伦德尔</a>在<a class="ae ky" href="https://unsplash.com/search/photos/ios?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e1d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们解释什么是通知/观察者通信模式，以及它是如何工作的。后者是一个非常简单易懂的概念。</p><ul class=""><li id="7473" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">观察者:等待通知被触发的接收者，执行您希望它执行的任何代码。</li><li id="f8c8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">通知:每当我们希望观察者执行某个动作时，它将被触发的实际通知。此外，我们可以在整个应用程序中获得任意多的通知。</li></ul><p id="b11c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，通过这一点，我们理解观察者/通知是一种基于多对一的通信模式。通过<em class="mj">多个</em>，我们指的是通知，通过<em class="mj">一个</em>我们指的是观察者。</p><p id="d9eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">容易吗？实际上是。</p><p id="6648" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">案例研究将帮助我们理解:</p><p id="7cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们有一个商店应用程序，它有一个购物车视图和其他视图，购物车视图有一个通知标记，我们可以在其他视图中购买想要的产品。每当用户购买一个新的项目，它将被添加到他的购物车，同时更新徽章。</p><p id="b416" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们直接进入代码。</p><p id="0dc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，请继续并<a class="ae ky" href="https://github.com/MoussaHellal/NotificationObserverSample" rel="noopener ugc nofollow" target="_blank">下载项目</a>，这样我们就不会浪费时间开始一个新项目并构建一些样板视图。因此，我们只能关注本文中重要的内容。</p><p id="7b30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单起见，这个项目:</p><ul class=""><li id="56f9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">是一个选项卡式的应用程序。</li><li id="5f30" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">有三个非常简单的观点。</li></ul><p id="a4b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单视图:</p><ul class=""><li id="c06b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我的购物车视图:什么都没有，只有一个徽章，显示购买了多少产品。</li><li id="147e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">另外两个观点:食物和汽水。</li></ul><p id="dc99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从<code class="fe mk ml mm mn b">before</code>文件夹启动项目。否则，你可以从<code class="fe mk ml mm mn b">after</code>文件夹开始这个项目，然后跟着我做我们将要做的事情。</p><p id="57d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为第一步，我们将把我们的<code class="fe mk ml mm mn b">Notification.Name</code>对象全局添加到<code class="fe mk ml mm mn b">GlobalVariables</code>文件中，这样我们就可以随时访问它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="8890" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将创建我们的观察者和函数，我们将在<code class="fe mk ml mm mn b">TabBarController</code>中触发通知时执行该函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="5659" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，让我们将<code class="fe mk ml mm mn b">createObservers()</code>函数添加到同一个文件<code class="fe mk ml mm mn b">TabBarController</code>中的<code class="fe mk ml mm mn b">viewDidLoad()</code>中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="c161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经将我们的<code class="fe mk ml mm mn b">createObservers(</code>函数添加到了<code class="fe mk ml mm mn b">viewDidLoad()</code>中，因此每当<code class="fe mk ml mm mn b">TabBarController</code>被分配到内存中时，观察者就会被创建。</p><p id="693c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，我们的<code class="fe mk ml mm mn b">TabBarController</code>文件必须是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="6337" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是我们在视图控制器<code class="fe mk ml mm mn b">Food</code>和<code class="fe mk ml mm mn b">Soda</code>上放置通知的时候了:</p><p id="8c1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe mk ml mm mn b">SodaController</code>文件。将这一行添加到按钮动作<code class="fe mk ml mm mn b">addImaginarySoda()</code>中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="7b61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对<code class="fe mk ml mm mn b">FoodController</code>做同样的操作，但对<code class="fe mk ml mm mn b">addImaginaryFood()</code>做。</p><p id="97b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，运行应用程序，点击<em class="mj">食物</em>或<em class="mj">汽水</em>视图上的<em class="mj">添加</em>按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/ff2ac3e5a17b9778abe4e8a318569137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kjFly4sJBno8Uy-4GR9Q8A.png"/></div></div></figure><p id="cb46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在您点击<em class="mj">添加</em>按钮后，<em class="mj">我的购物车</em>图标顶部的徽章会通过<code class="fe mk ml mm mn b">setBadge()</code>功能进行更新。</p><p id="a6b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个更新:<br/>请不要忘记将这个添加到你的视图控制器中，它保存了从内存中释放它的观察器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="6936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这样，谢谢你阅读我的第一篇关于媒介的文章。</p></div></div>    
</body>
</html>