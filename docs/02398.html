<html>
<head>
<title>Editing Multilingual Websites With GatsbyJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用GatsbyJS编辑多语言网站</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/multiple-language-websites-with-gatsbyjs-b4985746b9eb?source=collection_archive---------9-----------------------#2019-11-27">https://betterprogramming.pub/multiple-language-websites-with-gatsbyjs-b4985746b9eb?source=collection_archive---------9-----------------------#2019-11-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f3061910374b34e5c42afe0717722501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XA0om_KiEhl9wv7p1ojg5w.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@steveroe_?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">史蒂文·罗</a>在<a class="ae kf" href="https://unsplash.com/s/photos/seoul?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="1550" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在通过GatsbyJS +插件的出色组合提供了大量服务之后，将GatsbyJS项目本地化为多种语言比预期的更困难。</p><p id="5cc2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">插件解决了我的许多问题——例如..偷懒加载图片，制作网站地图，洗衣服。等等。所以当需要添加本地化的时候，我在插件中寻找一个合适的，可以帮助我把我的网站翻译成我的访问者所说的12种不同语言的插件。不幸的是，几乎没有几个插件有显著的GitHub星级和牵引力，我找不到一个满足下面要求的插件。</p><p id="7a89" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(不过，GatsbyJS repo中的<a class="ae kf" href="https://github.com/gatsbyjs/gatsby/tree/master/examples/using-i18n" rel="noopener ugc nofollow" target="_blank">使用-i18n </a>示例为设置提供了一个良好的开端。)</p><h2 id="0010" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">本地化要求:</h2><ol class=""><li id="bb4c" class="lx ly it ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated">SEO优化的预渲染翻译。当机器人抓取您的页面时，您希望页面的内容被翻译成该页面的语言。</li><li id="3cd5" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">动态创建的页面。我不想手动跟踪同一页面的副本，但在不同的语言中，这将是一个更大的项目的噩梦。</li><li id="b489" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">我希望能够轻松地将字符串翻译成翻译程序(例如Crowdin、Locize)。</li><li id="97dc" class="lx ly it ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">更小的束尺寸以提高性能。如果你有大量的文本需要翻译，你最终会得到大量的源翻译文件，而你只想把与特定语言相关的翻译发送到该语言的页面。</li></ol></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="02e3" class="mu lf it bd lg mv mw mx lj my mz na lm nb nc nd lp ne nf ng ls nh ni nj lv nk bi translated">设置</h1><p id="926f" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">查看<a class="ae kf" href="https://github.com/OskarAhl/Gatsby-react-i18next" rel="noopener ugc nofollow" target="_blank">这个回购</a>的基本实现。</p><p id="6c85" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe no np nq nr b">gatsby-node.js</code>提供了一个API，用于在页面构建过程中访问生命周期事件，在这里您可以动态地创建页面，并将数据传递给所创建的页面(我们希望为每种语言创建一次页面)。</p><p id="304f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我想做的是用正确的路径为每种语言创建一个页面。我已经在<code class="fe no np nq nr b">language-config.js</code>中设置了路径:</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="6321" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们的网站上有三个页面:主页、关于和联系我们。然后，我们希望在我们的站点上有这些路径:</p><pre class="ns nt nu nv gt ny nr nz oa aw ob bi"><span id="509c" class="le lf it nr b gy oc od l oe of">// English is our default language<br/>www.myawesomesite.com<br/>www.myawesomesite.com/about<br/>www.myawesomesite.com/contact</span><span id="313b" class="le lf it nr b gy og od l oe of">// for our Spanish friends:<br/>www.myawesomesite.com/es<br/>www.myawesomesite.com/es/about<br/>www.myawesomesite.com/es/contact</span><span id="a0fe" class="le lf it nr b gy og od l oe of">// for our French friends:<br/>www.myawesomesite.com/fr<br/>www.myawesomesite.com/fr/about<br/>www.myawesomesite.com/fr/contact</span></pre><p id="15d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要创建(和删除页面)，您可以使用在<code class="fe no np nq nr b">gatsby-node.js</code>中称为<code class="fe no np nq nr b">createPages()</code>的生命周期方法。在那里，您可以动态地为我们所有的语言制作每个页面的副本，如下所示:</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="7d16" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里，我还将与特定语言相关的翻译(在JSON文件中)只发送到该语言的页面。翻译后的JSON文件如下所示:</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="fcd7" class="mu lf it bd lg mv mw mx lj my mz na lm nb nc nd lp ne nf ng ls nh ni nj lv nk bi translated">react-i18接下来</h1><p id="5152" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">对于实际的翻译本身，我使用了<a class="ae kf" href="https://react.i18next.com/" rel="noopener ugc nofollow" target="_blank"> react-i18next </a>，因为它带有复数、上下文、插值、格式，这是一个健壮的、经过良好测试的、使用过的解决方案。</p><p id="b7b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<code class="fe no np nq nr b">crc32</code>翻译键值是可选的，但是我发现这比必须使用命名键更方便，因为在实际收集需要翻译的字符串时可以更灵活一些——这可以通过NodeJS脚本来完成。</p><p id="3150" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">设置:</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="8fc3" class="mu lf it bd lg mv mw mx lj my mz na lm nb nc nd lp ne nf ng ls nh ni nj lv nk bi translated">预先呈现的翻译</h1><p id="19e2" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">对于要以各自语言预呈现的页面，我添加了一个HOC(这样页面就不会在客户机上被动态翻译)。我还使用了<code class="fe no np nq nr b">I18nextProvider</code>来包装带有<code class="fe no np nq nr b">i18n</code>实例的页面。</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="c3ca" class="mu lf it bd lg mv mw mx lj my mz na lm nb nc nd lp ne nf ng ls nh ni nj lv nk bi translated">链接</h1><p id="0a63" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">由于我们在页面routes中有语言路径(除了默认语言)，我们需要稍微修改一下Gatsby链接，以使路由适用于不同的语言。</p><figure class="ns nt nu nv gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="3999" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">如何使用</h2><p id="fcf7" class="pw-post-body-paragraph kg kh it ki b kj lz kl km kn ma kp kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">要翻译一个字符串，导入上面的<code class="fe no np nq nr b">react-i18next</code>配置文件中添加的本地化函数，然后键入:</p><pre class="ns nt nu nv gt ny nr nz oa aw ob bi"><span id="095a" class="le lf it nr b gy oc od l oe of">&lt;h1&gt;{localize('Hello world')}&lt;/h1&gt;</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="9a8c" class="mu lf it bd lg mv mw mx lj my mz na lm nb nc nd lp ne nf ng ls nh ni nj lv nk bi translated">回购示例</h1><div class="oh oi gp gr oj ok"><a href="https://github.com/OskarAhl/Gatsby-react-i18next" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">奥斯卡拉尔/盖茨比-react-i18下一个</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">GatsbyJS-oskar ahl/Gatsby-react-i18next中react-i18 next的示例实现</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">github.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy jz ok"/></div></div></a></div></div></div>    
</body>
</html>