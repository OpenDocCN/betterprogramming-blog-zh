# 提升 Python 中元组技能的 5 件事

> 原文：<https://betterprogramming.pub/5-things-to-know-to-level-up-your-skills-with-tuples-in-python-6e7c1dc16945>

## 利用这种强大的数据类型

![](img/f8e24614b067bf10e424be799c6aed43.png)

[Ethan McArthur](https://unsplash.com/@snowjam?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片。

作为一种通用编程语言，Python 为我们提供了一组内置的数据类型，包括`int`、`str`、`tuple`、`list`、`dict`和`set`、*。*后四种被认为是容器数据类型，因为它们可以保存其他数据对象。相比其他容器(即`list`、`dict`、`set`)，tuple 较少被开发者提及，但它是一种非常方便的数据结构，其用法我们应该非常了解。

在本文中，除了元组的基本操作之外，我将重点介绍元组的五个特性，比如元组创建和带索引的项目检索。其中一些特性比其他特性更为人所知，但是我将对这些特性进行更深入的解释，以便您可以更好地理解相关概念。

# 1.多变量赋值

许多列举 Python 技巧的文章都包括下面的例子，它向您展示了如何在不创建第三个变量的情况下交换两个变量。然而，这些文章中的大多数并没有试图解释这种特殊用法到底发生了什么。不知道我指的是什么？让我们看看代码:

交换两个变量

上面的代码(第 3 行)是我们如何在 Python 中交换两个变量。正如您所看到的，变量在交换后更新了值，这是该操作应该实现的。但是我们如何理解语法呢？

本质上，在这个过程中发生了两件截然不同的事情。在赋值的右边(记住等号可以是赋值操作符)，我们使用这两个变量创建一个`tuple`对象。您可能想知道为什么没有看到括号将这些变量括起来以创建`tuple`。这是因为当你创建一个非空的`tuple`对象时它们是可选的。请看下面的证明:

没有括号的元组

在赋值的左边，我们使用两个变量解包或销毁新创建的`tuple`对象，每个变量引用相应位置的元素。这种操作是可能的，因为元组是一种序列数据类型，因此可以跟踪它们的元素位置。下面的代码向您展示了我们如何解包一个包含三个元素的`tuple`对象，其中每个元素都被分配给一个变量:

元组解包

需要注意的一点是，尽管这两个变量属于不同的数据类型，但由于 Python 的[动态类型](https://medium.com/swlh/duck-typing-in-python-3-practical-examples-a40d8113266c)特性，Python 允许我们将这些变量赋以其他数据类型(例如，对于变量`a`，最初是`int`，然后是`str`)。因此，变量在其生命周期中可以有不同的数据类型。

现在，你已经清楚地了解了双变量交换的工作原理，你也很容易理解多变量赋值的一般形式是如何工作的。下面是一个简单的例子。同样，我们不需要在两边都使用括号。如果您确实想使用括号，结果不会改变:

多重赋值

这个技巧对于用一行代码声明多个变量特别有用。然而，一个最佳实践是，我只在声明密切关系的变量时使用这个特性。例如，以上两个变量都属于 HTTP 响应的一部分。但是，如果这些变量在语义上不相关，您可能希望用单独的行来声明它们，以更好地显示声明的意图，并使您的代码更容易理解。

# 2.用 _ 和*打开包装

在上一节中，我们简要讨论了元组解包。我们使用相同数量的变量来解包在赋值语句右侧创建的`tuple`对象中的每个元素。然而，有更多的选项可以解包一个`tuple`对象。一种方法是使用下划线符号，这表示我们不会在那个特定的位置使用未打包的变量。让我们看下面的例子:

带下划线的元组解包

正如您在上面看到的，我们感兴趣的是获得响应的消息，而不是响应代码。因此，在第一个位置，我们使用下划线。但是，有一点需要注意，尽管下划线是用来表示我们不使用相应值的意图，但下划线实际上是一个有效的变量名，并且包含对第一个元素的引用。但是请注意，如果后面的操作再次使用下划线，后面的值将被赋给下划线，并且它不会总是具有相同的值(例如，在我们的示例中为 200)。

当一个对象有多个元素时，我们可能只需要其中的一部分。例如，假设我们有一个`tuple`对象存储一个体操运动员的分类分数，我们更想知道中间的分数。我们可以做到以下几点:

带星号的元组解包

如你所见，我们使用三个变量来解包`tuple`对象。变量`min_score`和`max_score`分别具有第一个和最后一个元素，而`valid_scores`具有中间的所有元素。为什么会这样？这是因为当我们使用星号作为变量`valid_scores`的前缀时，这个变量将捕获所有未被其他变量赋值的变量。例如，我们可以这样做:

带星号的元组解包(其他场景)

# 3.函数中的可变位置参数

根据前面的例子，有人可能想知道如果我们只使用一个带星号的变量来解包`tuple`对象会发生什么。

带星号的元组解包(错误)

哎呀。没用。但是请注意，这里的错误是一个`SyntaxError`，这意味着如果我们修复语法错误，这个操作是可能的。修复非常棘手，因为不清楚错误消息的确切含义。

提示:去检查一下我声明了一个元素的`tuple`对象(即变量`c`)的注释。还需要注意的是，上面的代码试图解包一个`tuple`对象，这个赋值操作中的两个变量都是省略了括号的`tuple`对象。

找到解决方法了吗？我希望你知道。神奇的是逗号，当在一个`tuple`对象中只使用一个变量时，它必须出现。让我们看看下面代码片段中的修复:

带星号的元组解包(错误已修复)

使用单个变量的最重要的用例是在声明函数时捕获数量不确定或可变的位置参数。还记得在一些函数定义里看到过`*args`吗？考虑下面这个微不足道的例子:

带*参数的函数

正如你所看到的，对于声明的函数，我们使用了`*numbers`参数(它可以被称为`*args`，名字并不重要)来表示这个函数可以接受可变数量的位置参数。重要的是，这些参数将被带星号的参数捕获。如上面的代码所示，我们用四个数字调用函数，所有数字都打包到函数中名为`numbers`的`tuple`对象中。

另外，您可能已经注意到了在函数声明中使用了`**kwargs`，它指的是数量可变的关键字参数。关于这个你可以在[我之前的文章](https://medium.com/swlh/how-to-pack-and-unpack-data-in-python-tuples-and-dictionaries-55d218c65674)中了解更多。

# 4.相对不变性

在 Python 中，我们有可变数据和不可变数据，它们指的是特定对象的值在创建后是否可以更改。数据可变性是一个广泛的主题，详细的讨论超出了本文的范围(如果感兴趣，请参见[我以前的文章](https://medium.com/swlh/6-things-to-understand-python-data-mutability-b52f5c5db191))。这里相关的是元组被认为是不可变的数据。让我们看看代码:

元组不变性

如上面的代码所示，我们不能在给定位置给一个`tuple`对象赋值。然而，如果`tuple`对象中的元素是可变容器数据类型，事情就有点棘手了。我们能改变它吗？让我们看看答案的例子:

具有可变元素的元组不变性

显然，如上所示，当一个`tuple`对象中的元素可变时，不管它是一个`list`还是`dict`对象，我们都能够更新元组的值。从这个意义上说，元组对象不是严格不可变的，因此我们说元组的不变性是相对的。

然而，当我们仍然说元组是不可变的时，它真正意味着什么呢？本质上，元组的不变性不在于它们持有的值。相反，它们的不变性指的是对对象的引用，而这些引用不会改变。让我们检查一下是不是这样。如下所示，即使列表的值被改变，两个列表在内存中是相同的对象，当调用`id()`函数进行[自检](https://medium.com/better-programming/the-5-most-useful-introspection-functions-in-python-7084e3bf9f01)时，内存地址相同:

元组可变元素

# 5.命名元组

元组的一个常见用途是存储特定实体的相关数据，因此您可以将`tuple`对象视为保存数据表中某一行的数据。例如，让我们创建一个保存学生信息的元组，如下所示:

一组学生信息

正如您在上面的代码中看到的，我们必须使用正确的索引来检索特定的数据元素，如果我们只是错过了索引，这是不方便的，并且容易出错——特别是如果我们在实际项目中处理更多的记录。

虽然我们可以实现一个自定义类来显示数据，但是我们可以利用创建一个`named tuple`类的优势，这个类作为标准库的一部分在`collections`模块中可用。使用`namedtuple`函数，我们可以轻松地创建一个轻量级数据类型，它可以将相关数据保存为一个`tuple`对象。所创建的`named tuple`类的便利之处在于它允许我们使用点符号来检索特定的数据元素。你还不明白吗？用一个具体的例子很容易理解:

命名元组—学生

如上面代码的第 2 行所示，我们通过调用`namedtuple`函数创建了一个名为`Student`的新类型，这是一个创建`named tuple`类的工厂函数。基本上，我们将类型的名称指定为“Student，*”*，它包含三个元素，它们的属性列在一个字符串中，用空格分隔。或者，属性可以作为一个`list`对象列出，就像`namedtuple(“Student”, [“name”, “age”, “student_id”])`一样。

在第 3 行和第 4 行，我们创建了一个`Student`类的实例对象。值得注意的是，我们可以使用点符号来访问学生的属性，这比使用常规`tuple`对象的索引方法更方便，也更不容易出错，如前所示。

如果我们对运行一些自省检查感兴趣，我们可以使用`issubclass`和`isinstance`函数来查找关于`Student`类及其实例对象与`tuple`数据类型之间关系的更多信息，如下所示:

命名元组—自省

简而言之，当我们关心用于存储和检索数据的轻量级数据类型时，我们可以考虑使用`namedtuple`工厂函数来创建一个`named tuple` 类，以使这些数据检索工作更容易。与定制类不同的是，`named tuple` 类的开销要小得多，它对内存更友好。

# 结论

在本文中，我们回顾了 Python 中元组的五个重要特性，这些特性超出了我们通常与`tuple`对象一起使用的基本功能。通过理解这些特性，我敢打赌元组在您的日常 Python 项目中会变得更加有用。

感谢阅读这篇文章。