<html>
<head>
<title>Point Cloud Filtering in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中点云过滤</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/point-cloud-filtering-in-python-e8a06bbbcee5?source=collection_archive---------1-----------------------#2022-09-29">https://betterprogramming.pub/point-cloud-filtering-in-python-e8a06bbbcee5?source=collection_archive---------1-----------------------#2022-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b4a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用Open3D进行点云预处理</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f1b6bbf9c942a2249fbd30e5f19f9078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VA-D108LIZN7dOAe"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">戴维·马尔库在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d025" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我的“点云处理”教程的第4篇文章。“点云处理”教程是初学者友好的，其中我们将简单介绍从数据准备到数据分割和分类的点云处理流水线。</p><ul class=""><li id="17ee" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><a class="ae kv" href="https://medium.com/@chimso1994/introduction-to-point-cloud-processing-dbda9b167534" rel="noopener">第一篇:点云处理简介</a></li><li id="8ff0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://medium.com/better-programming/point-cloud-computing-from-rgb-d-images-918414d57e80" rel="noopener">文章2:用Python从深度图像中估计点云</a></li><li id="6221" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/understand-point-clouds-a-simple-ground-detection-algorithm-71aaa0dd2b2d">第三篇:理解点云:使用Python实现地面检测</a></li><li id="b22e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://medium.com/@chimso1994/point-cloud-filtering-in-python-e8a06bbbcee5" rel="noopener">第4篇:Python中的点云过滤</a></li><li id="e964" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://medium.com/@chimso1994/point-cloud-segmentation-in-python-2fdbf5ea0617" rel="noopener">第五篇:Python中点云分割</a></li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="677f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将学习如何使用Open3D在python中过滤点云以进行下采样和离群点移除。</p><pre class="kg kh ki kj gt mn mo mp mq aw mr bi"><span id="ae68" class="ms mt iq mo b gy mu mv l mw mx"><strong class="mo ir">Table of contents</strong></span><span id="4f78" class="ms mt iq mo b gy my mv l mw mx">· <a class="ae kv" href="#d9b8" rel="noopener ugc nofollow">1. Introduction</a><br/>· <a class="ae kv" href="#830e" rel="noopener ugc nofollow">2. Pass-through filter</a><br/>· <a class="ae kv" href="#b2f6" rel="noopener ugc nofollow">3. Down-sampling</a><br/>· <a class="ae kv" href="#5fd9" rel="noopener ugc nofollow">4. Outlier removal filters</a><br/>· <a class="ae kv" href="#9412" rel="noopener ugc nofollow">5. Conclusion</a></span></pre></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="d9b8" class="mz mt iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">1.介绍</h1><p id="3109" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">由于所使用的3D扫描仪(如结构光扫描仪)或捕获的场景(包括吸收红外光的材料)的性质，计算或收集的点云有时会有噪声。另一方面，一些算法和/或计算机视觉技术对噪声敏感，如估计表面法线和曲率变化。</p><p id="dc7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了降低噪声，使用了滤波技术。一些过滤器也被用来减少点云密度，从而减少计算时间。在本文中，我们将看到一些常见的过滤器，即:通过过滤器，统计离群点消除过滤器，半径离群点消除过滤器和下采样过滤器。</p><h1 id="830e" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">2.通过过滤器</h1><p id="b62c" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">通过滤波器对输入数据施加约束，这些约束通常是阈值或间隔。对于点云，如果一个点满足约束(主要是沿一个或多个轴的间隔),则该点通过过滤器。为了减少噪声，通常根据输入设备的性质和状态来固定间隔:深度数据在间隔内更准确，否则会变得更嘈杂。带通滤波器不仅可以用于从噪声中过滤输入，还可以用于减少数据，例如考虑最近点。</p><p id="b59c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到版本<em class="oa"> 0.7.0 </em>，Open3D支持函数<code class="fe ob oc od mo b"><strong class="ky ir">crop_point_cloud(input, min_bound, max_bound)</strong></code>，其中[1]:</p><blockquote class="oe of og"><p id="2cbd" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">input</code>是输入的点云。</p><p id="8cb6" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">min_bound</code>是点坐标的最小界限。</p><p id="fb42" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">max_bound</code>是点坐标的最大界限。</p><p id="064a" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">返回</em> </strong>区间内的点云。</p></blockquote><p id="b2cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，通过考虑间隔<code class="fe ob oc od mo b">[0.8, 3]</code>来过滤点云以减少沿Z轴的噪声。对于X和Y轴，我们将边界设置为无穷大，因为我们没有沿着它们进行过滤:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="02f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在0.7.0版本之后，可以使用<code class="fe ob oc od mo b">open3d.geometry.PointCloud</code>的方法<code class="fe ob oc od mo b">crop(bounding_box)</code>来裁剪点云。与前面的函数类似，该方法返回裁剪后的点云。为此，我们首先创建一个包围将要考虑的点的边界框。该边界框由间隔边界的组合创建(见<code class="fe ob oc od mo b">bounding_box_points</code>)。这里，我们只沿Z轴过滤:只返回其Z坐标在<code class="fe ob oc od mo b">[0.8, 2]</code>之间的点。最后，使用创建的边界框对象裁剪输入点云:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="111a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">生成的点云如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/36d5d235001144d748c73f5b49a496c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*xzhs1lylc2NJKWGgxxDaOQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">灰色:输入点云。绿色:生成的点云。</p></figure><h1 id="b2f6" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">3.向下采样</h1><p id="3c0e" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">向下采样点云包括减少点的数量。例如，它通常用于减少处理步骤的运行时间或选择精确的训练点数。</p><p id="0579" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Open3D库提供了三种不同的方法来向下采样点云:</p><ul class=""><li id="9429" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><code class="fe ob oc od mo b">random_down_sample(pcd, sampling_ratio)</code>:从输入点云<code class="fe ob oc od mo b">pcd</code>中选择<code class="fe ob oc od mo b">n*sampling_ratio</code>个随机点。它可用于数据扩充，因为每次选择不同的点。但是，它对噪音很敏感:可以选择。</li><li id="c6a9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe ob oc od mo b">uniform_down_sample(every_k_points)</code>:根据顺序统一选择点。每隔<code class="fe ob oc od mo b">every_k_points</code>点选择一个点。总是选择第一个点(具有索引0)。因此，所选点的指数为:0、<code class="fe ob oc od mo b">every_k_points</code>、2 * <code class="fe ob oc od mo b">every_k_points</code>等。如果输入的点云是有组织的，函数返回一个均匀的点云；另外，它与第一种方法相似，只是每次都生成相同的输出。</li><li id="4413" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe ob oc od mo b">voxel_down_sample(voxel_size)</code>:创建一个三维体素网格。体素网格将输入分成一组<code class="fe ob oc od mo b">voxel_size</code> × <code class="fe ob oc od mo b">voxel_size</code> × <code class="fe ob oc od mo b">voxel_size</code>体素。每个体素包括属于关于3个轴的相同间隔的点。然后，属于同一体素的点被下采样并用它们的质心代替。该过滤器用于减小点云的大小并使其平滑。然而，这是耗时的，因为它在将点云重组为体素之后计算质心，并且它对异常值敏感。</li></ul><p id="e662" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们测试所有这些方法，并显示结果点云。为了更好的可视化，我们将<code class="fe ob oc od mo b">random_down_sample</code>、<code class="fe ob oc od mo b">uniform_down_sample</code>和<code class="fe ob oc od mo b">voxel_down_sample</code>分别设置为<code class="fe ob oc od mo b">sampling_ratio</code>到<code class="fe ob oc od mo b">0.005</code>、<code class="fe ob oc od mo b">every_k_points</code>到<code class="fe ob oc od mo b">200</code>和<code class="fe ob oc od mo b">voxel_size</code>到<code class="fe ob oc od mo b">0.4</code>。最后，我们应用平移在同一个窗口中分别显示所有的点云。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/73dc3c9d7273822d1def2d86ffd3d068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*-Sx61x191Y4BV9iv6oq2VA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">有组织的点云向下采样。顶部:输入点云。向下，从左到右:随机向下采样、均匀向下采样和基于体素的向下采样。</p></figure><p id="967a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，<code class="fe ob oc od mo b">uniform_down_sample</code>方法产生的点云均匀分布在3D空间中。这是因为输入是有组织的点云(列表中的点是有组织的)。</p><p id="da68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建一个无组织的点云，通过洗牌点云的前一个点，如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="bf19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，与前面的示例类似，我们对<code class="fe ob oc od mo b">u_pcd</code>应用不同的下采样方法，并显示结果。可视化窗口如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/75f7dcd61ff4ff0777a704bb1a57ec61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*fCKah5WZjoAXQAU7Kd73qA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">无组织点云下采样。顶部:输入点云。向下，从左到右:随机向下采样、均匀向下采样和基于体素的向下采样。</p></figure><p id="afcc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，<code class="fe ob oc od mo b">uniform_down_sample</code>方法产生的点云在3D空间中不是均匀分布的。因为点是无组织的，所以看起来更像是随机下采样。然而，<code class="fe ob oc od mo b">voxel_down_sample</code>返回相同的点云，因为它将点重新组织成一个3D网格。</p><h1 id="5fd9" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">4.离群点去除过滤器</h1><ul class=""><li id="80fe" class="ls lt iq ky b kz nq lc nr lf op lj oq ln or lr lx ly lz ma bi translated"><strong class="ky ir">半径异常值移除</strong>是一个条件过滤器，移除在给定半径的球体内具有少于给定数量的邻居的每个点。Open3D提供了方法<code class="fe ob oc od mo b">remove_radius_outlier(nb_points, radius)</code>，其中:</li></ul><blockquote class="oe of og"><p id="5245" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">nb_points</code>是邻居的数量。</p><p id="1f16" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">radius</code>是球体半径。</p><p id="2ec0" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><strong class="ky ir">返回</strong>:过滤后的点云的元组和内联器索引的列表。</p></blockquote><ul class=""><li id="59cd" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">统计异常值移除过滤器</strong>移除离其邻居较远的点。对于每个点，计算从它到所有它的邻居的平均距离。然后，如果该点的平均距离在由全局距离平均值和标准差定义的区间之外，则该点是异常值。Open3D提供了方法<code class="fe ob oc od mo b">remove_statistical_outliers(nb_neighbors, std_ratio)</code>其中[2]:</li></ul><blockquote class="oe of og"><p id="1381" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">nb_neighbors</code>是邻居的数量。</p><p id="579b" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><code class="fe ob oc od mo b">std_ratio</code>是标准差比率。</p><p id="1554" class="kw kx oa ky b kz la jr lb lc ld ju le oh lg lh li oi lk ll lm oj lo lp lq lr ij bi translated"><strong class="ky ir">返回</strong>:过滤后的点云元组和内联器索引列表。</p></blockquote><p id="d26c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们测试这两种方法，并显示结果点云。为了减少运行时间，我们首先应用下采样。在应用离群点去除过滤器后，我们使用<code class="fe ob oc od mo b">select_by_index(index, invert)</code>通过索引选择离群点。我们将<code class="fe ob oc od mo b">invert</code>设置为<code class="fe ob oc od mo b">True</code>来反转索引的选择。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><div class="kg kh ki kj gt ab cb"><figure class="os kk ot ou ov ow ox paragraph-image"><img src="../Images/cdd9d23706ad701cb5f19be6db3e2446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*B5u0H4c0jyZd9GgJXY6PRw.gif"/></figure><figure class="os kk ot ou ov ow ox paragraph-image"><img src="../Images/ecb0f047fb5fc5d921167ce87fcec435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*HRIsz5yZSoFO5shPFYBVUg.gif"/><p class="kr ks gj gh gi kt ku bd b be z dk oy di oz pa translated">点云异常值去除。左:半径过滤器。右图:统计过滤器。</p></figure></div><h1 id="9412" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">5.结论</h1><p id="c2b2" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">为此，我们介绍了最著名的点云过滤器。这些过滤器在Open3D中实现。它们也在其他一些点云库中实现，比如PCL。在大多数实时应用中，特别是对于密集的点云，需要过滤和减少点云的大小。<a class="ae kv" href="https://medium.com/@chimso1994/point-cloud-segmentation-in-python-2fdbf5ea0617" rel="noopener">下一个教程</a>讲点云分割。您将会看到，只需使用一些Python库就可以简单地做到这一点。</p><p id="d9ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢，我希望你喜欢读这篇文章。你可以在我的<a class="ae kv" href="https://github.com/Chim-SO/pointcloudprocessing" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到例子。如果你有任何问题或建议，欢迎在下面给我留言。</p><h1 id="6d7a" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">参考</h1><p id="c9e5" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">[1]<a class="ae kv" href="http://www.open3d.org/docs/0.7.0/python_api/open3d.geometry.crop_point_cloud.html?highlight=crop_point_cloud#open3d.geometry.crop_point_cloud" rel="noopener ugc nofollow" target="_blank">open 3d . geometry . crop _ point _ cloud</a></p><p id="1cd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]<a class="ae kv" href="http://www.open3d.org/docs/release/python_api/open3d.geometry.PointCloud.html" rel="noopener ugc nofollow" target="_blank">http://www . open 3d . org/docs/release/python _ API/open 3d . geometry . point cloud . html</a></p><h1 id="4f1b" class="mz mt iq bd na nb nv nd ne nf nw nh ni jw nx jx nk jz ny ka nm kc nz kd no np bi translated">图像制作者名单</h1><p id="e04c" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">本文中所有图片和数字的来源未在标题中提及，均由作者提供。</p></div></div>    
</body>
</html>