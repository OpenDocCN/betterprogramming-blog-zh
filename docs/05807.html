<html>
<head>
<title>How to Fetch Contact Lists and Create a SearchBar in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中获取联系人列表并创建搜索栏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-fetch-contact-lists-and-create-a-searchbar-in-swiftui-35713daaf25a?source=collection_archive---------3-----------------------#2020-08-07">https://betterprogramming.pub/how-to-fetch-contact-lists-and-create-a-searchbar-in-swiftui-35713daaf25a?source=collection_archive---------3-----------------------#2020-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7c1f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何让你的用户获取和搜索他们自己的联系人列表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/65f39b7c079bfffc119423ad1f999538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmuOVqblY0ResbPpHnNm5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">搜索栏和联系人列表(作者照片)。</p></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="ee66" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">联系信息解析</h1><p id="6753" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">为我们的联系信息创建一个可识别的结构。为ID、名字、姓氏和电话号码声明变量，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="cbf3" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">获取联系人</h1><p id="c5b5" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">创建一个包含获取联系信息的函数并返回我们的<code class="fe mv mw mx my b">ContactInfo</code>结构数组的类。每个联系人可以有多个电话号码。在本教程中，我只使用了第一个电话号码。在返回<code class="fe mv mw mx my b">contacts</code>数组之前，我们可以按名字、姓氏或电话号码对其进行排序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="9580" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">操作键盘</h1><p id="87f9" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">在UI上开始之前，我们需要添加一个<code class="fe mv mw mx my b">UIApplication</code>的扩展，用于在编辑结束时重新签名键盘:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="fcba" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">联系人行视图</h1><p id="683e" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">为联系人行创建一个结构，该结构采用一个<code class="fe mv mw mx my b">ContactInfo</code>并在一个<code class="fe mv mw mx my b">Text</code>视图中显示名字和姓氏:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="7671" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">主视图(内容视图)</h1><p id="3055" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">在我们的<code class="fe mv mw mx my b">ContentView</code>中，我们需要声明以下三个变量:</p><ul class=""><li id="92ac" class="mz na it lz b ma nb md nc mg nd mk ne mo nf ms ng nh ni nj bi translated">将保存我们的联系人列表的数组。</li><li id="df69" class="mz na it lz b ma nk md nl mg nm mk nn mo no ms ng nh ni nj bi translated"><code class="fe mv mw mx my b">searchText</code>将用于搜索文本字段。</li><li id="e92d" class="mz na it lz b ma nk md nl mg nm mk nn mo no ms ng nh ni nj bi translated"><code class="fe mv mw mx my b">showCancelButton</code>将决定何时在视图中显示取消按钮。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b932" class="pw-post-body-paragraph lx ly it lz b ma nb ju mc md nc jx mf mg np mi mj mk nq mm mn mo nr mq mr ms im bi translated">添加下面的函数，使用我们之前的<code class="fe mv mw mx my b">FetchContents</code>类获取内容列表。使用<code class="fe mv mw mx my b">DispatchQueue.main.async</code>加快性能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="63f2" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">许可</h1><p id="21b7" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">在<code class="fe mv mw mx my b">info.plist</code>中，我们需要添加下面的键和值来获得使用用户联系信息的权限。该值需要描述您访问联系人列表的需求。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/09c31e1cff934c6341ad8e6852bcd981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3j25b3PYqlPVjw2D5K373A.png"/></div></div></figure><p id="ce0a" class="pw-post-body-paragraph lx ly it lz b ma nb ju mc md nc jx mf mg np mi mj mk nq mm mn mo nr mq mr ms im bi translated">我们仍然需要检查权限是否被拒绝或限制，并请求访问联系人。一旦我们被授权访问联系人列表，我们就可以使用我们的<code class="fe mv mw mx my b">getContacts</code>函数来获取联系人:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="c7d4" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">搜索栏</h1><p id="bc3a" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf mg mh mi mj mk ml mm mn mo mp mq mr ms im bi translated">在下面的SwiftUI中创建搜索栏。使用放大镜和<code class="fe mv mw mx my b">x</code>标记系统符号来模仿手机应用程序中搜索栏的外观:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="32ad" class="pw-post-body-paragraph lx ly it lz b ma nb ju mc md nc jx mf mg np mi mj mk nq mm mn mo nr mq mr ms im bi translated">将上面的代码嵌入到一个<code class="fe mv mw mx my b">VStack</code>、<em class="nt">、</em>中，然后将下面的代码添加到同一个<code class="fe mv mw mx my b">VStack</code>中。<code class="fe mv mw mx my b">List</code>视图包含我们获取的每个联系人的<code class="fe mv mw mx my b">ContactRow</code>。使用<code class="fe mv mw mx my b">onAppear</code>启动我们的<code class="fe mv mw mx my b">requestAccess</code>功能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/937ff975e67842a1a360b52364b7afad.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/1*X20LNQxm-Sda5k6b41FjcQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">搜索栏和联系人列表</p></figure><p id="ad26" class="pw-post-body-paragraph lx ly it lz b ma nb ju mc md nc jx mf mg np mi mj mk nq mm mn mo nr mq mr ms im bi translated">全部完成！感谢您阅读这篇文章。</p></div></div>    
</body>
</html>