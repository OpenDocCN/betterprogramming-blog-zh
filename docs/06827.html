<html>
<head>
<title>How to Create Flutter Charts on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android上创建颤振图表</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-flutter-charts-on-android-5a75b5fc337c?source=collection_archive---------6-----------------------#2020-11-09">https://betterprogramming.pub/how-to-create-flutter-charts-on-android-5a75b5fc337c?source=collection_archive---------6-----------------------#2020-11-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="79d2" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在抖动图表中显示来自Android后端的数据</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/d933b1bca2973e0c04a25cf27b057dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nZmsKq319C5fUMCj"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">卡洛斯·穆扎在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b0ed" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本教程中，我们将使用<a class="ae kz" href="https://pub.dev/packages/charts_flutter" rel="noopener ugc nofollow" target="_blank"> charts_flutter </a>库来构建不同类型的图表，并显示来自Android后端的数据。</p><p id="0e19" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个库得到了积极的支持，并提供了一个大型的在线图库，您可以根据自己的需要选择图表类型。实现是相似和简单的。</p><p id="84b3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了演示如何将<a class="ae kz" href="https://flutter.dev/docs" rel="noopener ugc nofollow" target="_blank"> Flutter </a>与您的Android应用程序集成，我将向您展示如何创建一个饼图和一个条形图。</p><p id="10e6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="04da" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">创建Android项目</h1><h2 id="bd38" class="mv me iu bd mf mw mx dn mj my mz dp mn lj na nb mp ln nc nd mr lr ne nf mt ng bi translated">先决条件</h2><p id="c964" class="pw-post-body-paragraph la lb iu lc b ld nh jv lf lg ni jy li lj nj ll lm ln nk lp lq lr nl lt lu lv in bi translated">由于这是一个Android项目，我使用Android Studio作为IDE。我已经安装了旋舞和飞镖插件。我还设置了一个Android模拟器来测试代码的变化。</p><h2 id="6aab" class="mv me iu bd mf mw mx dn mj my mz dp mn lj na nb mp ln nc nd mr lr ne nf mt ng bi translated">准备后端</h2><ul class=""><li id="622d" class="nm nn iu lc b ld nh lg ni lj no ln np lr nq lv nr ns nt nu bi translated">创建一个新的颤振项目，并选择一个颤振应用。然后包含<a class="ae kz" href="https://kotlinlang.org/docs/reference/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>作为平台语言。</li><li id="7bc0" class="nm nn iu lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">打开<code class="fe oa ob oc od b">MainActivity.kt</code>文件，在新窗口中选择“在Android Studio中打开进行编辑”。客户端和平台代码将位于两个独立的窗口中。</li><li id="e1ef" class="nm nn iu lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">用我们的代码替换文件的内容:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="06a9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意，我们需要提供一个<code class="fe oa ob oc od b">MethodChannel</code>。它必须与Flutter的<code class="fe oa ob oc od b">MethodChannel</code>相匹配，我们将在后面进行配置。这样，我们可以从客户端发送对应于平台端方法的消息。我们还可以在平台端接收方法调用，并将结果发送回前端。</p><p id="0d8d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里我们指定了一个方法<code class="fe oa ob oc od b">getData()</code>，它将从客户端调用。这是您通常获取数据的地方，例如，从SQLite数据库获取数据。如何检索数据由您决定。为了简单起见，我们将硬编码一些值。</p><p id="ce25" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">假设您想要显示2015年到2019年之间的费用。我已经在一个<code class="fe oa ob oc od b">HashMap</code>里放了一些数据。</p><p id="eb90" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们已经完成了平台部分。</p><h2 id="7420" class="mv me iu bd mf mw mx dn mj my mz dp mn lj na nb mp ln nc nd mr lr ne nf mt ng bi translated">准备前端</h2><p id="4b37" class="pw-post-body-paragraph la lb iu lc b ld nh jv lf lg ni jy li lj nj ll lm ln nk lp lq lr nl lt lu lv in bi translated">在单独的Android Studio窗口中导航到项目中的<code class="fe oa ob oc od b">lib</code>目录。</p><ul class=""><li id="027c" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">首先，让我们通过在<code class="fe oa ob oc od b">pubspec.yaml</code>文件中添加一个新的依赖项来导入charts_flutter库:</li></ul><pre class="kk kl km kn gu oj od ok ol aw om bi"><span id="e90e" class="mv me iu od b gz on oo l op oq">charts_flutter: ^0.9.0</span></pre><ul class=""><li id="4b8e" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">让我们通过创建一个名为<code class="fe oa ob oc od b">dto.dart</code>的新Dart文件来创建我们的DTO:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="5d0b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们只需要一年的时间和一笔图表费用。为了按年份降序显示数据，我们将使用<code class="fe oa ob oc od b">compareByYear(LinearExpenses expenses)</code>方法。</p><ul class=""><li id="acc5" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">通过创建一个名为<code class="fe oa ob oc od b">piechart.dart</code>的新Dart文件来实现饼图:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="bc91" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你看，我们在这里定义了<code class="fe oa ob oc od b">MethodChannel</code>。</p><p id="c113" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我们将调用一个异步方法来保持GUI的响应，所以我们需要从后端返回一个<code class="fe oa ob oc od b">FutureBuilder</code>和我们的费用列表。</p><p id="6dca" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我选择了一个带有自动标签定位的圆环饼图。如果标签适合图表，它将显示在内部；否则，在外面。您可以通过设置<code class="fe oa ob oc od b">ArcLabelPosition</code>来更改该属性。</p><p id="45eb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过定义<code class="fe oa ob oc od b">arcWidth</code>，饼图呈现出一个甜甜圈的形状。如果省略该属性，将得到一个简单的饼图。</p><p id="6c0f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在呈现图表时,<code class="fe oa ob oc od b">animate</code>属性创建一个动画。这给它增添了一种美丽的效果。你甚至可以指定动画的持续时间。</p><ul class=""><li id="1784" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">通过创建一个<code class="fe oa ob oc od b">barchart.dart</code>文件来实现条形图:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><ul class=""><li id="ae87" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">为图表准备创建一个<code class="fe oa ob oc od b">util.dart</code>文件。</li><li id="c39f" class="nm nn iu lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">这是饼图的代码:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><ul class=""><li id="dd9e" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">条形图的实现略有不同:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="0d22" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意它返回的是<code class="fe oa ob oc od b">List&lt;charts.Series&lt;LinearExpenses, String&gt;&gt;</code>，而饼状图返回的是<code class="fe oa ob oc od b">List&lt;charts.Series&gt;</code>。</p><ul class=""><li id="418e" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">从<code class="fe oa ob oc od b">main.dart </code>文件中删除自动生成的内容，替换为我们的内容。</li></ul><p id="bda0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要这些进口品:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><ul class=""><li id="69de" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">让我们也为我们的图表类型创建一个<code class="fe oa ob oc od b">enum</code>,因为它更优雅:</li></ul><pre class="kk kl km kn gu oj od ok ol aw om bi"><span id="f3dc" class="mv me iu od b gz on oo l op oq"><strong class="od iv">enum </strong>ChartType { <strong class="od iv">PIE</strong>, <strong class="od iv">BAR </strong>}</span></pre><ul class=""><li id="7cd3" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">然后让我们创建<code class="fe oa ob oc od b">MyApp</code>和<code class="fe oa ob oc od b">MyHomePage</code>小部件:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><ul class=""><li id="33f4" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">创建<code class="fe oa ob oc od b">_MyHomePageState</code>小部件:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="8526" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里我们定义了相同的平台通道。</p><p id="d719" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将有一个下拉菜单，在这里我们可以选择我们想要显示的图表类型。默认值为<code class="fe oa ob oc od b">PIE</code>。</p><p id="500d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过调用我们的<code class="fe oa ob oc od b">getData()</code>方法，<code class="fe oa ob oc od b">_getAsyncData()</code>方法将从平台端检索我们想要显示的结果。</p><ul class=""><li id="0b02" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">让我们构建我们的<code class="fe oa ob oc od b">MyHomePage</code>小部件:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="6575" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我想在同一个屏幕上显示多个小部件，所以我使用了一个带有两个<code class="fe oa ob oc od b">Columns</code>的<code class="fe oa ob oc od b">Container</code>。一个是下拉菜单，另一个是图表。</p><ul class=""><li id="8271" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">这是如何创建下拉列表:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="cf31" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意，Dart的<code class="fe oa ob oc od b">enum</code>将显示类似<code class="fe oa ob oc od b">ChartType.BAR</code>的值。然而，如果我们提取名称，看起来会更好，在本例中是“PIE”和“BAR”这就是我使用<code class="fe oa ob oc od b">split()</code>方法的原因。</p><p id="319c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当用户从列表中选择一个值时，调用<code class="fe oa ob oc od b">onChanged() </code>方法，我们根据选择改变图表的类型。</p><ul class=""><li id="6d2a" class="nm nn iu lc b ld le lg lh lj og ln oh lr oi lv nr ns nt nu bi translated">粘贴以下代码以创建图表:</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="44eb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">就是这样！现在让我们开始应用程序并测试它。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="54b8" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">测试应用程序</h1><p id="114f" class="pw-post-body-paragraph la lb iu lc b ld nh jv lf lg ni jy li lj nj ll lm ln nk lp lq lr nl lt lu lv in bi translated">使用Android Studio中的Run按钮在模拟器或真实设备上运行代码。</p><p id="2a15" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一个屏幕应该是这样的:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/16883e6a8db01cd71a4bdf2b0c1dfa12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4x7bX93iUKCQHm36Wqb7A.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">显示饼图的我的电脑截图</p></figure><p id="66dc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在让我们改变图表的类型:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/edae40e18c7070bdb2cab4bd7ab7a26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qlbAkp88sBAzqsO9dhglSQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">演示下拉功能的电脑截图</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/aae0bbac7eaaa178d590780effb2e2cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AAeRdk5M4A-phctJTUe9nA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">我电脑上显示条形图的屏幕截图</p></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="54f5" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">结论</h1><p id="bf93" class="pw-post-body-paragraph la lb iu lc b ld nh jv lf lg ni jy li lj nj ll lm ln nk lp lq lr nl lt lu lv in bi translated">我们已经到了本教程的结尾。现在，您已经知道如何从charts_flutter库中实现图表，并从您的Android应用程序中检索数据。</p><p id="a607" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你需要这个项目的完整源代码，你可以在下面的链接参考中找到。</p><p id="1620" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，祝您编码愉快！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="6420" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">参考</h1><ul class=""><li id="fabc" class="nm nn iu lc b ld nh lg ni lj no ln np lr nq lv nr ns nt nu bi translated"><a class="ae kz" href="https://github.com/kirshiyin89/flutter_charts_demo" rel="noopener ugc nofollow" target="_blank">https://github.com/kirshiyin89/flutter_charts_demo</a></li><li id="0db2" class="nm nn iu lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated"><a class="ae kz" href="https://flutter.dev/docs/development/platform-integration/platform-channels" rel="noopener ugc nofollow" target="_blank">https://flutter . dev/docs/development/platform-integration/platform-channels</a></li><li id="a3e0" class="nm nn iu lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated"><a class="ae kz" href="https://google.github.io/charts/flutter/example/pie_charts/auto_label" rel="noopener ugc nofollow" target="_blank">https://Google . github . io/charts/flutter/example/pie _ charts/auto _ label</a></li></ul></div></div>    
</body>
</html>