<html>
<head>
<title>Create Your Own Markdown Editor With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React创建您自己的降价编辑器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-your-own-markdown-editor-with-react-6906ea2b6c2?source=collection_archive---------0-----------------------#2020-11-06">https://betterprogramming.pub/create-your-own-markdown-editor-with-react-6906ea2b6c2?source=collection_archive---------0-----------------------#2020-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="590b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个很酷的初学者项目，帮助我更好地反应</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3852258272a050be138b83e674128931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*diSA6UTA4_pETqM_bTYP1w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本·罗宾斯在<a class="ae ky" href="https://unsplash.com/s/photos/arrow?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="4fad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我开始学习React(一个用于web应用程序的JavaScript框架)时，创建一个Markdown编辑器是我做的第一批项目之一。它帮助我处理和理解React的一些功能，比如DOM处理、DOM和我们的组件之间的通信、使用状态等。</p><p id="69eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个有趣且容易制作的项目。我喜欢它，因为你可以把它变成你自己的——而且它也很有用。我并不特别喜欢目前可用的任何降价编辑器。Webstorm有一个不错的，但是这个编辑器不是免费的，除非你是学生。</p><p id="c99d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文中讨论的编辑器将在本地运行，并在您键入时实时更新。如果编辑器中没有任何内容，占位符文本将返回。</p><p id="42dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想知道，这是我们编辑器的最终输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ce890f7fb3385ddf426b6b20852929f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7gWZSOBjbWqY-nc5acEFFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图。该应用程序正在本地运行。</p></figure><p id="e360" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入研究一下。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="21cd" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建应用程序的基础</h1><p id="577b" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">对于这个项目，您需要安装<a class="ae ky" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>。然后，您只需运行以下命令。他们会让你的应用程序运行。目前，它看起来只是一个基本的React应用程序:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="5003" class="nf me it nb b gy ng nh l ni nj">npx create-react-app my-markdown-editor<br/>cd my-markdown-editor<br/>npm start</span></pre><p id="8005" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后你会想安装<a class="ae ky" href="https://getbootstrap.com" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>来让你的应用更好看，更容易设计。此外，我们将使用一个将Markdown转换成HTML的库(<a class="ae ky" href="https://getbootstrap.com" rel="noopener ugc nofollow" target="_blank">标记为</a>)，这对我们非常有用:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="eabc" class="nf me it nb b gy ng nh l ni nj">npm install marked bootstrap</span></pre><p id="f902" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的<code class="fe nk nl nm nb b">App.js</code>文件中，不要忘记在所有现有导入之后的页面顶部添加以下内容:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="1025" class="nf me it nb b gy ng nh l ni nj">import marked from ‘marked’</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="1021" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设定基础:分解我们拥有的和我们需要做的</h1><h2 id="62b6" class="nf me it bd mf nn no dn mj np nq dp mn li nr ns mp lm nt nu mr lq nv nw mt nx bi translated">渲染和CSS</h2><p id="cc8a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">所以现在我们的节点模块包含了一些很好的引导CSS，这将帮助我们很好地渲染我们的应用程序。我们可以删除生成的所有React CSS，因为Bootstrap提供了我们需要的所有内容。Bootstrap自动创建一个包含12列的网格。</p><h2 id="b277" class="nf me it bd mf nn no dn mj np nq dp mn li nr ns mp lm nt nu mr lq nv nw mt nx bi translated"><strong class="ak">引导类</strong></h2><p id="7461" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">基本的有<code class="fe nk nl nm nb b">container</code>、<code class="fe nk nl nm nb b">row</code>和<code class="fe nk nl nm nb b">column</code>，它们分别把一个<code class="fe nk nl nm nb b">div</code>变成一个容器、行或列。然后，您可以选择容器中列的大小。例如，<code class="fe nk nl nm nb b">col-sm-6</code>使屏幕适合只有六列的小屏幕(平板电脑)。以下是一些例子:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="a46e" class="nf me it nb b gy ng nh l ni nj">className=’container’<br/>className=’row’<br/>className=’form-control’</span></pre><p id="d8a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">表单控件将允许我们从容器中获取数据并在以后使用。</p><p id="9a02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，我们不想要任何花哨的东西。只有两列——一列用于输入文本，另一列用于显示降价:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="fdc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们想做的就是将容器向下移动一点，使它更适合屏幕，并且在视觉上更令人愉悦:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a2ac" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">我们的第一次降价翻译</h1><p id="1573" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为了查看我们的MD编辑器是否工作，我们需要一些文本来预先试用。</p><p id="383c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我决定将示例文本移动到一个单独的<code class="fe nk nl nm nb b">.js</code>文件中，这样它就不会过载我们的主页:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="aaed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，这是一个用MD编写的简单文本行。当这个文本被转换成HTML时，魔法就会降临。现在，我们只想在我们的<code class="fe nk nl nm nb b">App.js</code>文件中获取这个字符串。我们只需要字符串，而不是整个文件。这就是为什么我们对析构导入使用括号:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="8871" class="nf me it nb b gy ng nh l ni nj">import { sampleText } from ‘./sampleText’</span></pre><p id="bc81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们在<code class="fe nk nl nm nb b">App.js</code>文件中有了所有的导入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="cdab" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">控制要呈现的文本</h1><p id="1a15" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">越来越有趣了。当然，我们希望显示“翻译的”样本文本，但也希望显示我们在专用区域中编写的任何类型的文本。我们通过将我们在文本区域中写的内容与应用程序的<em class="oa">状态</em>相链接来做到这一点。当我们改变文本时，我们同时改变了状态，那就是将被翻译成MD的状态。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d55f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最后，把你的文本翻译成Markdown</h1><p id="c2e9" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们通过使用标记为的<em class="oa">来实现这一点。它是我们在节点模块中提供的降价翻译工具。因此，我们需要一个函数来接收我们的输入文本，并将其呈现为“markdown HTML”<em class="oa"> marked </em>把要翻译的文本和一个带有我们想要的选项的对象作为参数。</em></p><p id="2046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们不希望用户直接在编辑器中键入HTML:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="6d7d" class="nf me it nb b gy ng nh l ni nj"><em class="oa">&lt;h1&gt;Hello World!&lt;/h1&gt;</em></span></pre><p id="48d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将被完全相同地呈现:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="155c" class="nf me it nb b gy ng nh l ni nj">&lt;h1&gt;Hello World!&lt;/h1&gt;</span></pre><p id="ac5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们编辑的工作是将我们的文本转换成MD HTML——这就是<code class="fe nk nl nm nb b">{ sanitize: true }</code>的目的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们在类中添加的另一个函数。</p></figure><p id="328b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm nb b">renderText</code>函数给出了我们所写的MD文本对应的HTML。现在是时候把它放到我们的HTML模板中了。</p><p id="6e5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们使用了<code class="fe nk nl nm nb b">dangerouslySetInnerHTML</code> DOM属性。它是React特有的，就像<code class="fe nk nl nm nb b">innerHTML</code>一样工作，但是它也让React知道DOM节点已经被修改。</p><p id="4f33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oa">注:如果你想了解更多关于</em> <code class="fe nk nl nm nb b"><em class="oa">dangerouslySetInner</em></code> <em class="oa"> HTML的内容，可以查看</em> <a class="ae ky" href="https://medium.com/better-programming/what-is-dangerouslysetinnerhtml-6d6a98cbc187" rel="noopener"> <em class="oa">这篇文章</em> </a> <em class="oa">。</em></p><p id="5c18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们的渲染模板看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9c0d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">用心使用React生命周期</h1><p id="7210" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们希望保存我们所写的内容，以备刷新页面时使用。因此，我们将在本地存储中保存包含原始文本的状态。为此，我们将利用React组件的生命周期。组件被安装、更新和卸载。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0665" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">ComponentDidUpdate</h1><p id="635f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">就在组件更新之前，我们可以对它进行操作。我们可以用<code class="fe nk nl nm nb b">componentDidUpdate()</code>，其中<em class="oa"> </em>就是为此而生的。这里，当我们的文本改变时，除了更新我们的状态之外，我们还想改变本地存储。即使我们刷新页面，存储空间也会保留。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这发生在我们的州宣言之后。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a436" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">组件安装</h1><p id="e447" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这与安装(创建)组件时的情况相同。这意味着我们可以更好地控制如何装载以及装载哪些数据。我们使用有状态组件上的<code class="fe nk nl nm nb b">componentDidMount()</code>函数来获取本地存储中的文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从技术上讲，它就在componentDidUpdate()函数之前。</p></figure><p id="6db3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是它工作的原因:当我们刷新页面时，我们的组件重新加载，但是它首先检查存储以寻找任何现有的文本。如果没有文本(我们已经写了)，组件将显示示例文本。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2a87" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">我们走吧！</h1><p id="19e1" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">所以我们都准备好了。如果您缺少一些代码或信息，请使用应用程序代码查看<a class="ae ky" href="https://github.com/anaisberg/markdown-editor/tree/master/" rel="noopener ugc nofollow" target="_blank">我的GitHub repo </a>。</p><p id="0831" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ce890f7fb3385ddf426b6b20852929f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7gWZSOBjbWqY-nc5acEFFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图。这是该应用程序的示例文本外观。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="419d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">奖励:黑暗模式</h1><p id="7971" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">你以为我们结束了吗？不完全是！如果你想增加一些乐趣，玩一点CSS，你可以在编辑器中添加一个<em class="oa">黑暗模式</em>。</p><p id="eee8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单的方法是创建一个专用于黑暗模式的新样式表，并在我们的<code class="fe nk nl nm nb b">App.js</code>文件的开头更改导入:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="2025" class="nf me it nb b gy ng nh l ni nj">import ‘./DarkApp.css’</span></pre><p id="0e06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，我们要做的是自己改变文本和背景的颜色。你喜欢什么颜色就用什么颜色。我喜欢用柔和的调色板:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">随意修改更多的类/指针！</p></figure><p id="e04b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们完成了！下面是它的样子(我就是这样一个粉丝):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/f5e63e747597c429ae4ee5c8acace786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AoOIOcZLFGqCDmJ3gmXOuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图。这是启用黑暗模式时应用程序的外观。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="3d98" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">你自己试试！</h1><p id="6297" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">轮到你去尝试实现它了。</p><p id="a042" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢你坚持到最后。我希望你喜欢这个初学者教程。如果你试过或者有任何问题，请告诉我。</p></div></div>    
</body>
</html>