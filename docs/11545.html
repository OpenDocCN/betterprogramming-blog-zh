<html>
<head>
<title>The Secret of the ‘delete operator’</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“删除操作符”的秘密</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-secret-of-the-delete-operator-ab793997d89f?source=collection_archive---------6-----------------------#2022-03-29">https://betterprogramming.pub/the-secret-of-the-delete-operator-ab793997d89f?source=collection_archive---------6-----------------------#2022-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="441e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">JavaScript中到底什么是可析构的？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ac0a2b78c70fd1ab67be088e4a5b2308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lO3_5oVv0kl0c7eANV6USw.png"/></div></div></figure><p id="0a2f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">删除操作符可以说是JavaScript的一个古老的语言特性。顾名思义，它想摧毁什么东西，但究竟能摧毁什么呢？来和我一起探索吧！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="5a29" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">删除0</h1><p id="0a17" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">执行delete 0时，是否会从0开始从执行系统中销毁？</p><blockquote class="mu"><p id="382e" class="mv mw it bd mx my mz na nb nc nd lp dk translated">显然不是，<strong class="ak">它的真正目的是删除一个对象的属性引用。</strong></p></blockquote><pre class="ne nf ng nh ni nj nk nl nm aw nn bi"><span id="d0af" class="no ly it nk b gy np nq l nr ns"><strong class="nk iu">delete object.property<br/>delete object['property']</strong></span></pre><p id="cbf6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一般删除成功会返回true，失败会返回false，但也有一些例外。</p><h1 id="6c07" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">拥有财产</h1><p id="e113" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">删除操作符只作用于它自己的属性。如果原型链上有一个同名的属性，这个属性将被跳过。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/200abd37bc985f9f96c7b595d23a4c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmxaIoSrVekS-jn5SfpWPg.png"/></div></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="6afd" class="no ly it nk b gy np nq l nr ns">Object.prototype.name = 1;</span><span id="b14a" class="no ly it nk b gy nz nq l nr ns">const object = {<br/>  name: 2,<br/>};</span><span id="2ebd" class="no ly it nk b gy nz nq l nr ns"><strong class="nk iu">// Only valid for its own properties.<br/>console.log(delete object.name); // true<br/>console.log(object.name); // 1</strong></span><span id="d64d" class="no ly it nk b gy nz nq l nr ns"><strong class="nk iu">// But we can directly manipulate the prototype object.<br/>console.log(delete Object.getPrototypeOf(object).name); // true<br/>console.log(object.name); // undefined</strong></span></pre><h1 id="9a28" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">不存在的财产</h1><p id="ed5d" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">如果删除的属性不存在，delete将不起作用，但仍将返回true。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="99ac" class="no ly it nk b gy np nq l nr ns">const object = {};</span><span id="2489" class="no ly it nk b gy nz nq l nr ns">delete object.name; // true</span></pre><h1 id="685d" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">不可配置的属性</h1><p id="751b" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">无法删除不可配置的属性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/076e8fdfb341644ee75bdf5165713363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b5AEYUE72Odhorz5pijYmg.png"/></div></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="597c" class="no ly it nk b gy np nq l nr ns">const object = {};</span><span id="2731" class="no ly it nk b gy nz nq l nr ns">Reflect.defineProperty(object, 'name', {<br/>  configurable: false,<br/>});</span><span id="c8f0" class="no ly it nk b gy nz nq l nr ns"><strong class="nk iu">// Built-in object properties<br/>console.log(delete Math.PI); // false<br/>// Non-configurable properties<br/>console.log(delete object.name); // false</strong></span></pre><p id="d59a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在非严格模式下，移除自身的不可配置属性将返回false，但在严格模式下，将引发TypeError。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/459090c052b91c1a1a2580cb58e087e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sg_HX-cWrraDd2Y19bmG7Q.png"/></div></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="986f" class="no ly it nk b gy np nq l nr ns">'use strict';</span><span id="5771" class="no ly it nk b gy nz nq l nr ns">const object = {};</span><span id="4cee" class="no ly it nk b gy nz nq l nr ns">Reflect.defineProperty(object, 'name', {<br/>  configurable: false,<br/>});</span><span id="cf8e" class="no ly it nk b gy nz nq l nr ns">// ❌ TypeError: Cannot delete property 'PI' of #&lt;Object&gt;<br/>console.log(delete Math.PI);<br/>// ❌ TypeError: Cannot delete property 'name' of #&lt;Object&gt;<br/>console.log(delete object.name);</span></pre><h1 id="89ea" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">由var，let，const声明的属性</h1><p id="1cc7" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">在全局范围内，既不能删除用var声明的属性，也不能删除用函数声明(非函数表达式)声明的函数。这是因为两个声明的属性都安装在窗口上并且是不可配置的，所以删除时将遵循前一项的逻辑。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/159bf0cf2b2683fd2655cfb7913e6722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x217vepVEhp-B9IIrQCq8Q.png"/></div></div></figure><p id="3e96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，不能删除用var、let、const和这些函数声明的属性，无论是在全局范围内还是在函数范围内。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="4cd2" class="no ly it nk b gy np nq l nr ns"><strong class="nk iu">{</strong><br/>  let object = {<br/>    name: 1,<br/>  };</span><span id="31cc" class="no ly it nk b gy nz nq l nr ns">  function getName(obj) {<br/>    return obj.name;<br/>  }</span><span id="2284" class="no ly it nk b gy nz nq l nr ns">  console.log(delete object); // false<br/>  console.log(delete getName); // false<br/><strong class="nk iu">}</strong></span></pre><p id="b14d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在非严格模式下，返回false，<strong class="kw iu">但在严格模式下，抛出的是SyntaxError而不是TypeError。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/27774a9e7a2f7cb81fb7c688930d0903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CaoI_f22avr-4k53KUVsMw.png"/></div></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="76fe" class="no ly it nk b gy np nq l nr ns">'use strict';</span><span id="5844" class="no ly it nk b gy nz nq l nr ns"><strong class="nk iu">{</strong><br/>  let object = {<br/>    name: 1,<br/>  };</span><span id="34a1" class="no ly it nk b gy nz nq l nr ns">  function getName(obj) {<br/>    return obj.name;<br/>  }</span><span id="516e" class="no ly it nk b gy nz nq l nr ns">  // ❌ SyntaxError: Delete of an unqualified identifier in strict mode.<br/>  console.log(delete object);<br/>  // ❌ SyntaxError: Delete of an unqualified identifier in strict mode.<br/>  console.log(delete getName);<br/><strong class="nk iu">}</strong></span></pre><h1 id="fbc6" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">数组属性</h1><p id="75a5" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">首先，数组的length属性是不可配置的，所以在严格模式下删除它会抛出一个<strong class="kw iu"> TypeError </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/a46783a50cb4c186dec5f3000d2b82af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3j55YoASrzsShC83HX_GzQ.png"/></div></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="e514" class="no ly it nk b gy np nq l nr ns">'use strict';</span><span id="6de7" class="no ly it nk b gy nz nq l nr ns">const arr = [1, 2, 3, 4, 5];</span><span id="cc53" class="no ly it nk b gy nz nq l nr ns">console.log(Reflect.getOwnPropertyDescriptor(arr, 'length'));<br/>// ❌ TypeError: Cannot delete property 'length' of [object Array]<br/>console.log(delete arr.length);</span></pre><p id="369c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另外，当删除一个数组元素时，被删除的项将是空的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/e4237d7fb273fa40eae351948744f410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rA8fxwfKTBk9QeBYRTzWQ.png"/></div></div></figure><p id="1622" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果要修改原数组，可以使用<code class="fe og oh oi nk b">Array.prototype.splice()</code>，<a class="ae oj" href="https://javascript.plainenglish.io/interviewer-please-tell-me-the-difference-between-slice-splice-and-split-5a6617692395" rel="noopener ugc nofollow" target="_blank">详见我之前的文章。</a></p><h1 id="aca0" class="lx ly it bd lz ma nt mc md me nu mg mh jz nv ka mj kc nw kd ml kf nx kg mn mo bi translated">结论</h1><p id="dd00" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">JavaScript中“删除操作符”的真正目的是删除对象的属性引用。在某些特殊情况下，它会表现得很奇怪，所以最好只使用它来删除对象本身存在的可配置属性。</p><p id="429b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除此之外，请注意‘删除操作符’与直接释放内存无关(与C++ 中的<a class="ae oj" href="https://docs.microsoft.com/en-us/cpp/cpp/delete-operator-cpp?view=msvc-170&amp;viewFallbackFrom=vs-2019" rel="noopener ugc nofollow" target="_blank"> delete相比)，这是因为JavaScript的运行时环境自动管理内存。有关编程语言内存管理的更多信息，请查看我以前的文章:</a></p><div class="ok ol gp gr om on"><a href="https://towardsdatascience.com/memory-management-every-developer-should-know-4f4911d8268b" rel="noopener follow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">每个开发人员都应该知道的内存管理</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">这可能是你最不能错过的编程知识</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="f700" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">今天到此为止。我是Zachary，我将继续输出与web开发相关的故事，如果你喜欢这样的故事，别忘了关注我。</p></div></div>    
</body>
</html>