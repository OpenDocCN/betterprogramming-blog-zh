<html>
<head>
<title>Implement a Debouncer in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中实施去抖器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/implement-a-debouncer-in-swift-3b5c775f90b8?source=collection_archive---------2-----------------------#2020-06-17">https://betterprogramming.pub/implement-a-debouncer-in-swift-3b5c775f90b8?source=collection_archive---------2-----------------------#2020-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6a6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学会在执行过程中给方法调用一些喘息的空间</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5107f2da81216363593d677d61259402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I2ObFeZhhHGdOtR9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@mr_fresh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Yura Fresh </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="46ca" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">什么是方法调用的反跳？</strong></h1><p id="0aaa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对方法调用进行反跳可以确保该方法不会被过于频繁地执行。</p><p id="a3cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如:如果您在任何应用程序中看到一个搜索视图的基本实现，它不会为您键入的每个字符向后端发出HTTP调用。这将导致许多HTTP调用，其中大多数都是不必要的。</p><p id="24a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">相反，我们使用一个叫做<code class="fe ms mt mu mv b">Debouncer</code>的东西，它只在给定的时间间隔后调用一个特定的方法。对于搜索示例，如果我们有一个0.3秒的时间限制，那么当用户在0.3秒内没有键入任何内容时，将进行HTTP调用来获取搜索结果。如果用户没有停顿0.3秒就继续键入，则每次按下一个键时，时间间隔都会更新。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="2055" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">实现自定义去抖器</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="1b4f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们了解一下这是如何实现的！</p><p id="ecf3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 3</code>:这是去抖器的时间间隔。如果在此时间间隔内没有采取任何操作，则将调用该方法</p><p id="b1ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 4</code>:我们使用了一个计时器来确保在时间间隔结束之前方法不会被调用</p><p id="cd7f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 6,7</code>:这是一个处理程序闭包，当时间间隔结束时将被调用。在这个闭包里，我们可以实现要运行的代码，或者要去抖的代码。</p><p id="8579" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 9</code>:这是一个自定义的init，以时间间隔为参数。我们不能没有时间间隔的去抖实例</p><p id="f45d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 13</code>:更新间隔方式用于更新去抖时间间隔。如果用户在没有暂停的情况下按下十个键，时间间隔将更新十次，以确保我们正在检查从最后一次用户操作开始的时间间隔。每次调用这个方法时，我们都会创建一个新的<code class="fe ms mt mu mv b">Timer</code>,它会在时间间隔结束后调用一个函数。</p><p id="09b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 20</code>:当<code class="fe ms mt mu mv b">Timer</code>完成时间间隔时，调用该方法。作为回报，我们将调用负责执行去抖代码的<code class="fe ms mt mu mv b">handler</code>。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="1029" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">使用去抖器</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="15d9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 3</code>:我们已经创建了一个<code class="fe ms mt mu mv b">Debouncer</code>的实例，时间间隔为<code class="fe ms mt mu mv b">0.3 seconds</code>。</p><p id="fa6e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 25</code> : <code class="fe ms mt mu mv b">doSomething</code>是我们计划去抖的方法。每次更新时间间隔时，它将打印出<code class="fe ms mt mu mv b">renew interval</code>，每当在处理程序中执行该方法时，它将打印出<code class="fe ms mt mu mv b">method executed</code>。</p><p id="a963" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">Line 5</code>:我们使用<code class="fe ms mt mu mv b">DispatchQueue</code> <br/>在<code class="fe ms mt mu mv b">viewDidLoad</code>中制定用户动作，在<code class="fe ms mt mu mv b">0.1 seconds</code>的间隔之后，我们调用<code class="fe ms mt mu mv b">doSomething()</code>方法三次。时间间隔大于<code class="fe ms mt mu mv b">0.1 seconds</code>，因此将不会执行处理程序，而去抖器将更新其时间间隔三次。</p><p id="bf75" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，有一个<code class="fe ms mt mu mv b">0.4 seconds</code>的暂停——大于去抖时间间隔，所以它将执行处理程序。之后，<code class="fe ms mt mu mv b">Line 18</code>再次更新间隔，并在<code class="fe ms mt mu mv b">0.3 seconds</code>之后执行处理程序。</p><p id="702f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">输出将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6f18d26d4d505a8f2a1270c1341b6d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*7B8xPHINKSzxf6LAfEhYNQ.png"/></div></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="fe1c" class="kz la it bd lb lc nd le lf lg ne li lj jz nf ka ll kc ng kd ln kf nh kg lp lq bi translated">包扎</h1><p id="418f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是<code class="fe ms mt mu mv b">Debouncer</code>的一个基本实现。有许多不同的方法来实现同一件事——如果它们满足您的要求，它们都是正确的。</p><p id="7a2e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以在<a class="ae ky" href="https://github.com/samarth4487/Debouncer" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到示例项目。</p></div></div>    
</body>
</html>