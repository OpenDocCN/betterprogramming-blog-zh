<html>
<head>
<title>React Native Hooks: To-Do App with CRUD Operations and AsyncStorage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native Hooks:带有CRUD操作和异步存储的待办事项应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/react-native-hooks-to-do-app-with-crud-operations-and-asyncstorage-ff20b1c862b8?source=collection_archive---------5-----------------------#2019-09-05">https://betterprogramming.pub/react-native-hooks-to-do-app-with-crud-operations-and-asyncstorage-ff20b1c862b8?source=collection_archive---------5-----------------------#2019-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a6e1bada94371974e79a8dab3c67c96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTsFrFNywgcUqto8qpyKTQ.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae kf" href="https://unsplash.com/search/photos/to-do-list?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fe36" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最近React引入了钩子，我一点也不赞成功能组件。我是如此习惯于类组件，以至于这种改变也不是我所期待的。此外，最新的版本更新也是一个重大变化。所以我同时用两只手试了试。</p><p id="6daa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我想到的。这基本上是用React Hooks做一个常规待办app的尝试。因此，如果你是一个专业人士，正在寻找不同的东西，这个博客不适合你。我们开始吧。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="91fb" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">定义</h1><p id="4f4f" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated"><strong class="ki iu"> 1。钩子:</strong>钩子是React 16.8中新增的。它们允许您使用状态和其他React特性，而无需编写类。React提供了一些内置的钩子，比如<code class="fe mo mp mq mr b">useState</code>和<code class="fe mo mp mq mr b">useEffect.</code></p><p id="2929" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 2。useState: </strong>它返回一对值:当前状态和更新它的函数。这就是我们写<code class="fe mo mp mq mr b">const [count, setCount] = useState()</code>的原因。这类似于一个类中的<code class="fe mo mp mq mr b">this.state.count</code>和<code class="fe mo mp mq mr b">this.setState</code>，除了它们是成对的。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="730a" class="na lm it mr b gy nb nc l nd ne">Examples how we can initialise states using useState</span><span id="427b" class="na lm it mr b gy nf nc l nd ne">const [count, setCount] = useState(0)      // Number<br/>const [name, setName] = useState('James')  // String<br/>const [data, setData] = useState([])       // Array</span></pre><p id="6fb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 3。useEffect: </strong>通过使用这个钩子，你告诉React你的组件在渲染之后需要做一些事情。不要从挂载和更新的角度来考虑，你可能会发现渲染之后产生效果更容易。React保证DOM在运行效果时已经更新。</p><p id="9b65" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">默认情况下，它会在第一次渲染<em class="ng">和每次更新</em>后运行。它类似于<code class="fe mo mp mq mr b">componentDidMount</code>和<code class="fe mo mp mq mr b">componentDidUpdate</code>，只是更干净，更有逻辑。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="dda8" class="na lm it mr b gy nb nc l nd ne">const App = ( ) =&gt; {<br/>  const [count, setCount] = useState(0);<br/>  useEffect(() =&gt; {<br/>    document.title = `You clicked ${count} times`;<br/>  });<br/>}</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="600d" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">介绍</h1><p id="ab77" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们将使用AsyncStorage创建一个普通的待办事项应用程序。</p><h2 id="d151" class="na lm it bd ln nh ni dn lr nj nk dp lv kr nl nm lz kv nn no md kz np nq mh nr bi translated">要求</h2><p id="9fa1" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">使用React Native的最新版本创建一个新应用程序。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="096e" class="na lm it mr b gy nb nc l nd ne">react-native init tasks<br/>cd tasks</span></pre><p id="2237" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，当你创建了一个新的应用程序，是时候导入更多的组件了。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="5624" class="na lm it mr b gy nb nc l nd ne">yarn add 'react-native-dropdownalert';<br/>// To show alert messages</span><span id="772a" class="na lm it mr b gy nf nc l nd ne">yarn add 'react-native-vector-icons';<br/>// To use icons in the app</span><span id="efa5" class="na lm it mr b gy nf nc l nd ne">yarn add '@react-native-community/asyncstorage';<br/>// To use local database</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="db9b" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">代码参考</h1><p id="02e5" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">现在删除<code class="fe mo mp mq mr b">App.js</code>文件中的所有内容，并添加下面的<a class="ae kf" href="https://gist.github.com/sudhirkumarojhaa/8d49d2f521f4a4727305483edfd89365" rel="noopener ugc nofollow" target="_blank">代码。</a></p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ff98da73a51843df8fd078c505f8c6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*4TJJGKoy5wvCgaopkXI1kQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">文件的截图</p></figure><h2 id="8342" class="na lm it bd ln nh ni dn lr nj nk dp lv kr nl nm lz kv nn no md kz np nq mh nr bi translated">使用状态解释</h2><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="63b9" class="na lm it mr b gy nb nc l nd ne">// Initialisation of state:</span><span id="055c" class="na lm it mr b gy nf nc l nd ne">this.state {<br/>name: 'James'<br/>}</span><span id="041d" class="na lm it mr b gy nf nc l nd ne">// Updating state value:</span><span id="33a3" class="na lm it mr b gy nf nc l nd ne">this.setState({<br/> name: 'Sudhir'<br/>});</span><span id="8206" class="na lm it mr b gy nf nc l nd ne">console.log(this.state.name);<br/>output: Sudhir</span><span id="f78a" class="na lm it mr b gy nf nc l nd ne"><br/>// Now using hooks we can declare this as </span><span id="f608" class="na lm it mr b gy nf nc l nd ne">const [name,setName] = useState('James');<br/>setName('Sudhir');<br/>console.log(name);</span><span id="b556" class="na lm it mr b gy nf nc l nd ne">output: Sudhir</span></pre><p id="2759" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相同的过程用于更新字符串、数字或数组。与上面描述的流程没有什么不同。</p><h2 id="6072" class="na lm it bd ln nh ni dn lr nj nk dp lv kr nl nm lz kv nn no md kz np nq mh nr bi translated">UseEffect解释</h2><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="97ad" class="na lm it mr b gy nb nc l nd ne">//before hooks</span><span id="9ec7" class="na lm it mr b gy nf nc l nd ne">componentDidMount(){<br/>  AsyncStorage.clear();<br/>  retrieveData();  <br/>});</span><span id="72a3" class="na lm it mr b gy nf nc l nd ne">// using hooks</span><span id="95ec" class="na lm it mr b gy nf nc l nd ne">useEffect(() =&gt; {    <br/>  AsyncStorage.clear();<br/>  retrieveData();  <br/>});</span></pre><p id="6786" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我使用<code class="fe mo mp mq mr b">useEffect</code>清除AsyncStorage，并调用<code class="fe mo mp mq mr b">retrieveData</code>函数来获取应用程序渲染时的值。有许多其他方法可以做到这一点——请随意阅读React文档以了解更多用例。</p><h2 id="c70f" class="na lm it bd ln nh ni dn lr nj nk dp lv kr nl nm lz kv nn no md kz np nq mh nr bi translated">异步存储用例</h2><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="4ad0" class="na lm it mr b gy nb nc l nd ne">// Save data to AsyncStorage</span><span id="ebc6" class="na lm it mr b gy nf nc l nd ne">let user = {<br/> name,<br/> email,<br/> phone, <br/> key: Math.random(),<br/>};</span><span id="eeea" class="na lm it mr b gy nf nc l nd ne">const arrData = [user];<br/>setData(arrData);<br/>await AsyncStorage.setItem('user', JSON.stringify(arrData));</span><span id="fdea" class="na lm it mr b gy nf nc l nd ne">// Get data from AsyncStorage</span><span id="941c" class="na lm it mr b gy nf nc l nd ne">const retrieveData = async () =&gt; {<br/> try {<br/>  const valueString = await AsyncStorage.getItem('user');<br/>  const value = JSON.parse(valueString);<br/>  setData(value);<br/> } <br/> catch (error) {<br/>  console.log(error);<br/> }<br/>};</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="d0b0" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="5262" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我希望这些基本的例子能帮助你理解钩子的概念。试试我的代码，如果有任何新的问题，请告诉我。</p><p id="fb7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不断学习和分享。</p></div></div>    
</body>
</html>