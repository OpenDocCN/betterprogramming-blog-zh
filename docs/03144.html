<html>
<head>
<title>Learn the Django REST Framework in Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">几分钟内学会Django REST框架</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/learn-django-rest-framework-in-minutes-ef5159dc60ab?source=collection_archive---------2-----------------------#2020-01-23">https://betterprogramming.pub/learn-django-rest-framework-in-minutes-ef5159dc60ab?source=collection_archive---------2-----------------------#2020-01-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d793" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们构建我们的第一个API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/cc9ebe8a7fb564d6ef23c6a2db32a32b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*N5Iep1wJY1iXgMzpHxzE8w.png"/></div></figure><p id="f6e0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如今，编写REST APIs对于开发人员来说已经很平常了。当面临技术堆栈的选择时，我倾向于将<a class="ae lm" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>作为我的首选之一。</p><p id="457a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">“为什么？”你应该问问。原因相当简单:</p><ul class=""><li id="cc99" class="ln lo it ks b kt ku kw kx kz lp ld lq lh lr ll ls lt lu lv bi translated">它是用Python开发的(我喜欢Python)。</li><li id="c602" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll ls lt lu lv bi translated">这是一个久经考验的框架，可以让您快速部署到生产环境中并测试您的API。</li><li id="2134" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll ls lt lu lv bi translated">Django Rest框架(从现在开始是DRF)非常灵活并且易于理解。</li></ul><p id="55db" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以，说了这么多，让我们写一个REST API来管理餐馆里的食物。在项目结束时，您应该有一个可以使用的API，它具有以下端点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/6a4b8746f3a422f7abbe027e63313274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZnCwAWzeM-5mmYElXJteNw.png"/></div></div></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="9f31" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">项目设置</h1><ol class=""><li id="0eb5" class="ln lo it ks b kt nf kw ng kz nh ld ni lh nj ll nk lt lu lv bi translated">安装Python(我用的是Python 3.6)。</li><li id="bb5e" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">初始化一个虚拟环境<code class="fe nl nm nn no b">python3 -m venv env</code>并激活它:<code class="fe nl nm nn no b">source env/bin/activate</code>。</li><li id="8280" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">安装Django、DRF和<a class="ae lm" href="https://pypi.org/project/psycopg2/" rel="noopener ugc nofollow" target="_blank"> psycopg2 </a>(我们数据库的SQL适配器):<code class="fe nl nm nn no b">pip install django djangorestframework psycopg2</code>。</li><li id="e03e" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">创建Django项目:<code class="fe nl nm nn no b">django-admin startproject restaurants</code>。</li><li id="d963" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">创建一个<a class="ae lm" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> Postgres </a>数据库，并替换项目的<code class="fe nl nm nn no b">settings.py</code>文件中的配置。</li><li id="978c" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">应用迁移:<code class="fe nl nm nn no b">python3 manage.py migrate</code>。</li><li id="a809" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">创建超级用户:<code class="fe nl nm nn no b">python3 manage.py createsuperuser</code>。</li><li id="199a" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nk lt lu lv bi translated">启动本地服务器:<code class="fe nl nm nn no b">python3 manage.py runserver</code>。</li></ol><p id="bcd0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">太好了！现在，如果你在浏览器中进入<code class="fe nl nm nn no b"><a class="ae lm" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/</a></code>，你应该会看到一个功能性的starter Django站点。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="05b1" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak"> Django Rest框架设置</strong></h1><p id="026c" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">要将DRF添加到项目中，请转到<code class="fe nl nm nn no b">settings.py</code>并将<em class="ns"> rest_framework </em>添加到您已安装的应用中。让我们也为API创建一个应用程序:<code class="fe nl nm nn no b">python3 manage.py startapp api</code>并将其添加到您已安装的应用程序中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e6c6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在将API项目URL添加到餐馆项目中的主<code class="fe nl nm nn no b">url.py</code>文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="99cc" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">创建模型</h1><p id="504d" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">我们将非常简单地模拟我们的餐馆。每个餐馆都有许多食谱，每个食谱都有许多配料。配料可以属于一个以上的食谱。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi nv"><img src="../Images/1b7a8c3cd79ecbf45a7e871731933635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZ1R6E010oFXC8lXs6h-Qw.png"/></div></div></figure><p id="153b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">由于<code class="fe nl nm nn no b">Recipe</code>模型中的属性缩略图是图像，我们需要安装带有<code class="fe nl nm nn no b">pip install pillow</code>的<a class="ae lm" href="https://pypi.org/project/Pillow/2.1.0/" rel="noopener ugc nofollow" target="_blank">枕头</a>。</p><p id="68dc" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是<code class="fe nl nm nn no b">models.py</code>中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6660" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了创建我们的数据库模式，我们需要进行适当的迁移:</p><p id="c012" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe nl nm nn no b">python3 manage.py makemigrations</code>和<code class="fe nl nm nn no b">python3 manage.py migrate</code> …现在你的模型应该是你数据库中的表格了。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="1ea5" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">创建序列化程序</h1><p id="9fde" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">在Django REST框架中，序列化器将JSON或XML中的querysets或model实例等复杂数据转换为Python数据类型，反之亦然。</p><p id="a064" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">序列化程序还提供了额外的功能，允许您在操作资源时封装CRUD操作的逻辑。</p><p id="d443" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将在API项目中的一个单独的<code class="fe nl nm nn no b">serializers.py</code>文件中为我们的模型定义序列化程序，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="03a7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如你所见，我们为每个模型定义了一个<code class="fe nl nm nn no b">serializer</code>类。序列化程序的行为有点像表单，它验证数据，控制响应的输出，并提供创建和更新模型的功能。</p><p id="5104" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，我们的请求将由我们的视图来处理，视图将使用这些序列化器来验证数据并在JSON之间转换数据。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="fda3" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">创建视图</h1><p id="3f8e" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">Django提供了不同的方法来创建视图:基于类的视图和基于函数的视图。</p><p id="e8d4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在Django REST框架中，您可以通过用<code class="fe nl nm nn no b">@api_view</code>修饰基于函数的视图来创建API视图，或者如果您更喜欢基于类的视图，可以子类化<code class="fe nl nm nn no b">APIView</code>。</p><p id="cec7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在本教程中，我将使用基于类的视图，但切换到基于函数的视图是一件小事。Django REST框架还通过mixin类实现了一些常见的操作，比如基于类的视图的CRUD操作。</p><p id="68ea" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Django REST框架甚至提供了一组已经混合的基于类的视图，称为<em class="ns">通用的基于类的视图</em>，如<code class="fe nl nm nn no b">ListCreateAPIView</code>或<code class="fe nl nm nn no b">RetrieveUpdateDestroyAPIView</code>。</p><p id="ecb3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将在<code class="fe nl nm nn no b">views.py</code>文件中定义我们的<code class="fe nl nm nn no b">APIViews</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="f814" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">注意我们的视图如何使用我们之前定义的序列化器来验证和序列化数据。</p><p id="1444" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，难题的最后一部分是定义URL并将它们指向我们的视图。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="23b4" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">定义URL</h1><p id="2929" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">当Django服务器收到请求时，它将请求URL与<code class="fe nl nm nn no b">urls.py</code>中描述的URL进行匹配，找到的第一个匹配由路径中定义的相应视图处理。</p><p id="780b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们在<code class="fe nl nm nn no b">urls.py</code>文件中编写餐馆API的URL:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="60c0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，这应该是我们API的最后一部分。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><h1 id="e44e" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="2656" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz np lb lc ld nq lf lg lh nr lj lk ll im bi translated">现在，如果我们启动服务器并前往<code class="fe nl nm nn no b"><a class="ae lm" href="http://127.0.0.1:8000/restaurants/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/restaurants/</a></code>,我们应该会看到Django REST框架测试站点，在那里您可以使用刚刚创建的API。</p><p id="5a37" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个API测试站点是Django REST框架的一个非常酷的东西，你可以很容易地从你的浏览器测试你的API。</p><p id="e567" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">DRF还提供了很多其他的好东西，比如不同的授权和认证模型来保护你的API。</p><p id="0ccb" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个项目的工作代码可以在GitHub(下面的链接)上找到，随时让它成为你的。</p><div class="nw nx gp gr ny nz"><a href="https://github.com/agustincastro/DjangoRestAPI-Restaurant" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">agustin Castro/DjangoRestAPI-餐厅</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">用Django Rest API制作的API，用于管理餐馆中的食谱-agustin Castro/DjangoRestAPI-餐馆</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ko nz"/></div></div></a></div></div></div>    
</body>
</html>