<html>
<head>
<title>Improving Your Python Projects With Type Hints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用类型提示改进Python项目</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/improving-your-python-projects-with-type-hints-63cbdb16d97c?source=collection_archive---------16-----------------------#2022-01-17">https://betterprogramming.pub/improving-your-python-projects-with-type-hints-63cbdb16d97c?source=collection_archive---------16-----------------------#2022-01-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="586c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">知道如何使用静态类型检查和类型注释最佳实践</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2ffb2c0c1433b18e18983b4daf227c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D2pTs4JZKVeT55C9"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@artturijalli?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Artturi Jalli </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="a4d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类型检查是任何现代编程语言最重要的特性之一；这就是TypeScript诞生的原因。一般来说，类型检查不仅使代码库更容易扩展和使用，而且它还能快速、可靠和自动地检测许多编程错误。</p><p id="80cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Python 3.5中首次引入的<strong class="ky ir">类型提示</strong>是Python开发人员向变量和函数标注类型的主要方式。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><blockquote class="lz"><p id="1de9" class="ma mb iq bd mc md me mf mg mh mi lr dk translated"><strong class="ak">类型提示— </strong>顾名思义，不在解释器级别执行任何类型检查。它们是为开发人员、ide、linters、类型检查人员等而设计的。</p></blockquote><p id="fe85" class="pw-post-body-paragraph kw kx iq ky b kz mj jr lb lc mk ju le lf ml lh li lj mm ll lm ln mn lp lq lr ij bi translated">用技术术语来说，<strong class="ky ir"> Python有动态类型检查</strong>，因此类型在运行时是已知的，而在编译时是未知的(像C#这样的静态类型检查语言就是这种情况)。尽管如此，值得一提的是，Python社区已经黑出了一个Python解释器的<a class="ae kv" href="http://mypy-lang.org/" rel="noopener ugc nofollow" target="_blank">变种</a>，它执行静态类型检查。</p><p id="8780" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将探讨如何将Python的类型检查整合到我们的代码库中，以减少与项目单元集成时的摩擦。</p><h1 id="95e3" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">类型提示语法</h1><p id="7ec3" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">Python支持语言所支持的基本变量类型<code class="fe nl nm nn no b">str</code>、<code class="fe nl nm nn no b">int</code>、<code class="fe nl nm nn no b">float</code>、<code class="fe nl nm nn no b">bool</code>、<strong class="ky ir">、<code class="fe nl nm nn no b">None</code>的类型注释。它还附带一个<code class="fe nl nm nn no b">typing</code>图书馆电池；这个类型库为我们提供了使用更多特殊类型的方法。</strong></p><h2 id="d785" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">注释变量</h2><p id="818a" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">要在Python中指明变量的类型，只需添加一个冒号加空格，后跟类型(str，int，List[]，等等。)，就在变量名后面。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="8cfc" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">注释函数</h2><p id="be16" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">变量的变量注释语法也适用于函数参数。然而，为了指示返回类型，我们添加了一个箭头“-&gt; ”,后跟它的类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h1 id="2ef5" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">使用特殊类型</h1><p id="cf8d" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">现在，我们已经熟悉了类型注释语法，让我们来熟悉更复杂的类型。</p><h2 id="eb6e" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">任何的</h2><p id="dc91" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">类型为<code class="fe nl nm nn no b">Any</code>的变量不受约束。所以，这样的变量兼容所有其他类型(int，str，<code class="fe nl nm nn no b">List</code>等)，所有其他类型都兼容这些。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="368b" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">逐字的</h2><p id="b912" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">文字用于向类型检查器指示变量或函数的值等于指定的值之一。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="d5f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，性别将是性别文字声明中的值之一——“男性”、“女性”或“不一致”。</p><h2 id="87b0" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">联盟</h2><p id="a32a" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">有时，一个变量可能有跨越两个类型声明的属性。变量也可能有两种类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="be31" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">TypedDict</h2><p id="6980" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">字典是Python中最简单的数据结构形式之一，是该语言中最常用的变量类型之一。</p><p id="6f0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe nl nm nn no b">TypedDict</code>可以极大地提高代码的可读性，尤其是在一个大项目中，在很多地方有很多声明；记录下<em class="od">发生了什么</em>发生了什么<em class="od">当你缩放时</em>变得紧张。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="edc6" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">无回报</h2><p id="312c" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated"><code class="fe nl nm nn no b">NoReturn</code>类型类似于其他编程语言中的<code class="fe nl nm nn no b">void</code>。它用于声明一个函数没有任何返回。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="8efe" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">最后的</h2><p id="5321" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">这是一个类型构造，用于指示变量不能在子类中被重新赋值或覆盖。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h1 id="8167" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">在Python中使用静态类型检查</h1><p id="23b4" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">Python的解释器我默认不强制类型检查。然而，Python解释器的一个变体——<code class="fe nl nm nn no b">mypy</code>已经被创建来在解释器级别上执行类型检查。</p><p id="07e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以用两种方式使用<code class="fe nl nm nn no b">mypy</code>:</p><ol class=""><li id="c073" class="oe of iq ky b kz la lc ld lf og lj oh ln oi lr oj ok ol om bi translated">下载<code class="fe nl nm nn no b">mypy</code>命令行并使用它来运行您的Python脚本。</li><li id="3234" class="oe of iq ky b kz on lc oo lf op lj oq ln or lr oj ok ol om bi translated">安装VSCode和PyCharm上可用的<code class="fe nl nm nn no b">mypy</code>扩展。</li></ol><h1 id="2162" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">类型注释最佳实践</h1><h2 id="93e4" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">1.使用<code class="fe nl nm nn no b">Any</code></h2><p id="9031" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">只有当我们不知道返回变量或函数参数的确切类型时，才应该使用<code class="fe nl nm nn no b">Any</code>类型；当使用没有类型注释的第三方库，或者使用没有类型注释的模块时，可能会出现这种情况。</p><h2 id="a773" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">2.启用静态类型检查</h2><p id="4803" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">如果类型检查是动态的，那么它在防止错误和指导开发人员方面的好处就不会那么明显。如果你不是<code class="fe nl nm nn no b">mypy</code>命令行的粉丝，你也可以把它安装成VSCode或者PyCharm扩展。</p><h2 id="d7ae" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">3.对固定长度数组使用元组</h2><p id="e02e" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">元组作为记录有双重用途。因此，当数组中有已知数量的项时，尤其是当它们不都是同一类型时，该变量更适合元组类型。</p><h2 id="f444" class="np mp iq bd mq nq nr dn mu ns nt dp my lf nu nv na lj nw nx nc ln ny nz ne oa bi translated">4.函数返回类型</h2><p id="037d" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">函数应该做一件事并且只做一件事，因此它们应该有一个确定的类型。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt os no ot ou aw ov bi"><span id="df3e" class="np mp iq no b gy ow ox l oy oz"><strong class="no ir">Want to Connect?</strong></span><span id="a445" class="np mp iq no b gy pa ox l oy oz">Get weekly articles and coding tricks by <a class="ae kv" href="https://tomisin.dev/subscribe" rel="noopener ugc nofollow" target="_blank">subscribing to my newsletter</a>.</span></pre></div></div>    
</body>
</html>