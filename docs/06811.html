<html>
<head>
<title>JavaScript ES 2020 Tips: The .matchAll() Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript ES 2020提示。matchAll()方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/es-2020-tips-matchall-method-f0513e335315?source=collection_archive---------5-----------------------#2020-11-06">https://betterprogramming.pub/es-2020-tips-matchall-method-f0513e335315?source=collection_archive---------5-----------------------#2020-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4c79" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">matchAll是如何比较和对比的匹配</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e4f4e09a1ca11301644f2fb07e5d6ea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmECoE4Ei3oA528pNTKLCw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jamie452?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae ky" href="https://unsplash.com/s/photos/matches?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure><p id="20d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我从我的正则表达式系列，<strong class="lb iu"> </strong>中休息的时候，我想写一篇仍然与正则表达式有关的文章。<strong class="lb iu"> </strong>我最近学习了<code class="fe lv lw lx ly b">.matchAll()</code> <em class="lz"> </em>法，直到上周我才开始使用。</p><p id="0e62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在本文<a class="ae ky" href="https://medium.com/swlh/regex-series-what-is-regex-926ea8284cd9" rel="noopener">中提到过</a>如何匹配一个模式，并使用<code class="fe lv lw lx ly b">.match()</code>方法将其提取到一个数组中。你会发现<code class="fe lv lw lx ly b">.matchAll()</code>和<code class="fe lv lw lx ly b">.match()</code>的工作方式相似，只是略有不同。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="987f" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">。匹配()</h1><p id="9802" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated"><code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match" rel="noopener ugc nofollow" target="_blank">.match()</a></code> <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match" rel="noopener ugc nofollow" target="_blank">方法</a>采用一个参数:<code class="fe lv lw lx ly b">RegExp</code>。</p><p id="fec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将使用<code class="fe lv lw lx ly b">.match()</code>作为您正在测试的字符串值的属性，在括号内，您将放置您的<code class="fe lv lw lx ly b">RegExp</code>模式。返回值将是所有匹配的数组或空数组。返回的数组将依赖于<code class="fe lv lw lx ly b">g</code>(或全局)标志，该标志返回您想要匹配的模式的所有出现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/1fe0d2d94151e6efb90cc38688f64172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ErvsC3-3-_iaJpXdT1x4g.png"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="484c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，它返回一个数组，第一个索引是它匹配的元音字母。有趣的是，数组中的下一个索引读起来像一个对象。第二个索引包含一个<code class="fe lv lw lx ly b">index</code>属性，其值是字符串中匹配出现位置的索引。接下来，<code class="fe lv lw lx ly b">input</code>属性包含原始字符串的值和属于捕获组的<code class="fe lv lw lx ly b">groups</code>属性。它只匹配第一个事件，因为我们没有使用全局标志。</p><h2 id="8aca" class="nh mi it bd mj ni nj dn mn nk nl dp mr li nm nn mt lm no np mv lq nq nr mx ns bi translated">带着全球国旗</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/2019be04f3e65a8cd8379e8766a01e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcgiXef4IZlp-EsWt6p40A.png"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="33ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它返回一个数组，字符串中的所有元音字母都匹配到该数组中。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="286d" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">。matchAll()</h1><p id="3877" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">对于<code class="fe lv lw lx ly b">.matchAll()</code>，它<em class="lz">不会</em>创建一个提取了所有匹配的数组，而是创建一个迭代器。它需要一个参数:<code class="fe lv lw lx ly b">RegExp</code>。</p><p id="83bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll" rel="noopener ugc nofollow" target="_blank"> MDN web文档</a>,<code class="fe lv lw lx ly b">RegExp</code>必须有<code class="fe lv lw lx ly b">/g</code>标志。否则，会抛出一个<code class="fe lv lw lx ly b">TypeError</code>。</p><p id="6f8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地理解<code class="fe lv lw lx ly b">.matchAll()</code>方法，让我们尝试使用它。</p><p id="3350" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将把上面的例子粘贴到控制台中，但是变量<code class="fe lv lw lx ly b">vowelsInString</code>中有<code class="fe lv lw lx ly b">.matchAll()</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e176804150212967a7d12ab4f8123bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TgOoWcGmo1ZljcTWxHlKmw.png"/></div></div></figure><p id="cd6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们检查变量<code class="fe lv lw lx ly b">vowelsInString</code>时，我们得到一个<code class="fe lv lw lx ly b">RegExpStringIterator</code>。</p><p id="a19a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那是什么意思？</p><p id="4640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查看迭代器，我们可以循环遍历它或者使用<code class="fe lv lw lx ly b">.next()</code>方法。我会告诉你两种方法。</p><p id="57b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们使用<code class="fe lv lw lx ly b">.next()</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/3511d5e0c71e0045b7e56d45f2336c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rE6SpoyVR18prd4NCIOA0g.png"/></div></div></figure><p id="aa59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到第一个匹配，它以一个对象的形式存在，有两个键值对。它有一个值为数组的<code class="fe lv lw lx ly b">value</code>键和一个值为<code class="fe lv lw lx ly b">false</code>的<code class="fe lv lw lx ly b">done</code>键。</p><p id="79e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">value</code>键的数组中，我们有实际的匹配及其所有信息。第一个索引是我们在正则表达式中寻找的元音。这个数组中的下一个索引读起来像一个对象。它包含原始字符串中匹配位置的索引值。接下来是输入属性和输入字符串本身的值。最后，最后一个索引是<code class="fe lv lw lx ly b">groups</code>属性，它查看捕获组是否在我们的正则表达式中。</p><p id="3669" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对象的第二个<code class="fe lv lw lx ly b">done</code>键意味着这个正则表达式有额外的匹配。换句话说，这个迭代器还没有完成。到最后会变成<code class="fe lv lw lx ly b">true</code>。让我们继续我们的迭代:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/b5c0f2ff565a73cb4f2bfc0ef1ef8f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MYrQjUORebJ5fG1MpGZB5g.png"/></div></div></figure><p id="d046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是最终版本的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/96116b19274e4d42f2931e2e888e26bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mg9ss_Wpbzem1bzrWAWUow.png"/></div></div></figure><p id="1d88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，我们的<code class="fe lv lw lx ly b">value</code>是未定义的，并且<code class="fe lv lw lx ly b">done</code>属性现在是<code class="fe lv lw lx ly b">true</code>。</p><p id="9e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我将向您展示它是如何与<code class="fe lv lw lx ly b">for…of</code>循环一起工作的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/d3308d88f956b9b6fe5e9f7904d035d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6F0XNvQc3InWQkgYVi4q-w.png"/></div></div></figure><p id="8add" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将它转换成一个完整的数组，MDN建议使用<code class="fe lv lw lx ly b">spread</code>操作符。为此，我们只需写下:</p><pre class="kj kk kl km gt ny ly nz oa aw ob bi"><span id="69e8" class="nh mi it ly b gy oc od l oe of">let allMatches = […vowelsInString]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/48b99b64b8e2462e7079af4f83945dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxqE7Siq9kIT9-eWJ6s6hQ.png"/></div></div></figure><p id="b375" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在有一个包含所有匹配及其相应信息的数组。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="3950" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="8b60" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我希望这是一个关于使用<code class="fe lv lw lx ly b">.matchAll()</code>和<code class="fe lv lw lx ly b">.match()</code>的有用教程。如果您仍然对这两种方法感到好奇，我建议您阅读MDN的文档:</p><ul class=""><li id="5b04" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated"><code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll" rel="noopener ugc nofollow" target="_blank">.matchAll</a></code></li><li id="ed2e" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated"><code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match" rel="noopener ugc nofollow" target="_blank">.match</a></code></li></ul></div></div>    
</body>
</html>