# Python 的 6 个让你困惑的怪癖

> 原文：<https://betterprogramming.pub/6-quirks-of-python-that-can-puzzle-you-4476012a1fee>

## 一些你可能忽略的鲜为人知的令人困惑的特性

![](img/ae5e9d94cffdf159967b7a8f1545f6f2.png)

照片由[艾米丽·莫特](https://unsplash.com/@emilymorter?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/confusion?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄

Python 是一种初学者友好的语言，依赖于可读性。它因其伪英语式的语法而广受欢迎。我们知道英语是一种有趣的语言。

嗯，Python 也是。语言中有相当多的不一致之处(注意:这并不意味着设计缺陷),这可能会让任何开发人员感到困惑——尤其是在他们刚开始的时候。

在接下来的几节中，我们将了解一些奇怪的事情。

# 1.在 f 字符串中显示浮点值

Python f 字符串是一个强大的特性。它们允许您计算表达式、为更好的调试设置占位符，以及用引号格式化字符串。人们也可以使用它们相当快地打印出一个值的字典。

这里有一个例子:

```
>>> x = {‘lang’: ‘Python’, ‘version’: 3.10}
>>> print(‘{lang} {version} is amazing.’.format(**x))Python 3.1 is amazing.
```

如您所见，输出不是您所期望的。它缺少十进制值。

我们可以通过设置格式说明符来解决这个问题，如下所示:

```
>>> print(‘{lang} {version:.2f} is amazing.’.format(**x))Python 3.10 is amazing.
```

# 2.for-else 和 while-else 条件循环

这是一个会让任何开发人员感到困惑的怪癖，尤其是那些来自另一种语言的开发人员，比如说 JavaScript。

我们在编程中都见过并使用过`if-else`条件句。`if-elif`构造是 Python 中常用的。然而，也可以使用`for-else`和`while-else`语法。

现在，从远处看，条件循环的`else`子句似乎只有在循环无法完全执行时才会执行，但实际上，它的工作正好相反。

考虑一下这个:

人们本以为`else`条款不会被打印出来。令人惊讶的是，确实如此。

基本上，`for-else`或`while-else`语句的工作方式如下:

*   只有当`for`或`while`循环没有终止时，才会执行`else`语句。
*   如果使用`break`语句终止循环，则`else`结构不会执行。

因此，在下面这段代码中，`else`子句不执行:

`for-else`这是一个很难理解的概念，因此这是一个需要注意的流行怪癖。当进行线性搜索时，如上所示的条件循环非常方便。

# 3.循环变量缺乏作用域

在大多数编程语言(如 Java)中，当循环终止时，它的索引变量变得未定义。同样，在 Python 中这不会发生。

```
i = 1
for i in [2,3,4]:
    print(i)print(i)
```

您希望打印的内容:

```
#Output: 2, 3, 4, 1
```

实际打印的内容:

```
#Output: 2, 3, 4, 4
```

这是因为 Python 除了函数级别之外没有任何作用域规则。因此，您可以在循环或条件语句中定义的任何内容都可以从该块外部访问。

这个想法相当简单。但是，当开发人员刚刚开始接触 Python 时，这可能会造成混乱。

# 4.列表()和方括号是不同的

您会注意到创建列表有两种方式:使用`[]`操作符和使用`list()`构造函数。字典也是如此(`dict()` vs. `{}`)。

然而，两者之间有着鲜明的差异。`[]`不仅速度更快，而且输出也与`list()`不同。

正如您所看到的，list 构造函数遍历字符串，然后将它转换成一个列表，而括号操作符将字符串作为列表的一个元素。

类似地，如果在 list 构造函数中设置一个字典，它只会创建一个字典键列表。因此，最好选择`[]`而不是`list`构造函数。

# 5.默认可变参数

通过在函数中设置默认参数，我们可以在调用点防止函数中可怕的长参数列表。

但是设置可变值，比如列表、字典和集合，并不能真正给出您最初期望的结果:

```
def addToList(x, a=[]):
    a.append(x)
    return a>>> list1 = addToList(5)
[5]list2 = addToList(10)
[5, 10]
```

上面的输出展示了函数中的默认可变参数在调用时只计算一次。这并不奇怪，因为 Python 中的函数被认为是一级对象。

如果您不希望在函数调用中保留默认值，可以使用稍微不同的方法。这里有一个例子，将字典作为默认参数，并设置为`None`。

# 6.迭代时修改列表是可行的，但是使用字典时，它会抛出一个错误

在遍历集合时添加或删除元素从来都不是一个好主意。然而，如果我们比较两个微不足道的输出，一个用 Python 字典，另一个用列表，结果是惊人的。

这里有一个字典的例子，我们在迭代过程中删除元素:

然而，如果我们将相同的逻辑应用于 Python 列表，它在某种程度上是有效的:

您会注意到，在迭代过程中，只有第一个和第三个元素会从列表中删除。这是因为删除一个元素后，下一个元素会占用该索引。此外，每迭代一次，索引就增加一——这导致我们跳过奇数元素。

现在，这是 Python 列表的一个奇怪行为，尤其是当字典和集合抛出一个错误时，我们得到了一致的结果(尽管它是不正确的)。列表和字典中不同结果的原因与它们的底层实现有关。

传统上，列表是基于索引的，而字典依赖于哈希查找表，这要求字典的大小在迭代期间保持不变。因此，在迭代过程中删除字典键会导致运行时错误。

我们总是可以将字典键包装在一个`list()`中来使它工作。但理想情况下，字典理解应该优先用于删除元素。

# 结论

还有一些，像`is`对`==`进行身份对等式检查，以及`tuple`对`u`操作符。希望你发现 Python 的上述怪癖有用。

感谢阅读。