<html>
<head>
<title>Take a Look at the Awesome New Features Coming in Python 3.9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">看看Python 3.9中令人惊叹的新特性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/take-a-look-at-the-awesome-new-features-coming-in-python-3-9-8753c494de39?source=collection_archive---------1-----------------------#2020-07-15">https://betterprogramming.pub/take-a-look-at-the-awesome-new-features-coming-in-python-3-9-8753c494de39?source=collection_archive---------1-----------------------#2020-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">字典联合操作符、泛型类型注释等等</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7dddf6efad368667e961ba340d8ce69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UiKP0VVRUNksfTNE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@grohsfabian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法比安·格罗斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="109e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.9目前正处于测试阶段的第四个迭代阶段(截至2020年7月)。虽然有些事情可能会改变，但现在已经很清楚新版本会是什么样子了。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e54e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">泛型类型批注</h1><p id="f437" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">泛型类型注释，又名<a class="ae ky" href="https://www.python.org/dev/peps/pep-0585/" rel="noopener ugc nofollow" target="_blank"> PEP 585 </a>，是许多python爱好者渴望已久的东西。现在，您可以指定一个集合及其项目的类型，而不依赖于<code class="fe mz na nb nc b">types</code>库:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="1ea8" class="nh md it nc b gy ni nj l nk nl">def do_stuff(data: list[int]): <br/>    pass</span></pre><p id="b273" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些现在已经通用的集合:</p><ul class=""><li id="a50c" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">tuple</code></li><li id="dfb8" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">list</code></li><li id="1ce7" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">dict</code></li><li id="dba7" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">set</code></li><li id="0fa9" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">frozenset</code></li><li id="e801" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">type</code></li><li id="845d" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">collections.deque</code></li><li id="4a8b" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">collections.abc.Coroutine</code></li><li id="15f7" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe mz na nb nc b">re.Pattern</code></li><li id="6b5c" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ky" href="https://www.python.org/dev/peps/pep-0585/" rel="noopener ugc nofollow" target="_blank">还有更多</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a97d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">字典联合运算符</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/78d45ef960e0165f54104cf71d00e130.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*5dn3NfDVtrQHVrC_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">JS开发人员。</p></figure><p id="937c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python 3.9之前，合并到字典的标准方法是:</p><ol class=""><li id="6d40" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu ob ns nt nu bi translated"><code class="fe mz na nb nc b">.update</code>方法:<code class="fe mz na nb nc b">a.update(b)</code></li><li id="9e5a" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu ob ns nt nu bi translated">传播操作员(hello JS): <code class="fe mz na nb nc b">{**a, **b}</code></li></ol><p id="ff99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，我们又有一个了。<code class="fe mz na nb nc b">|</code> union操作符做了它应该做的事情:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2d15" class="nh md it nc b gy ni nj l nk nl">a = {'cars': 5, 'phones': 2} <br/>b = {'cows': 10, 'lizards': 3} <br/>a | b <br/>// {'cars': 5, 'phones': 2, 'cows': 10, 'lizards': 3}</span></pre><p id="dd34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像<code class="fe mz na nb nc b">.update</code>或spread操作符一样，如果字典中有重复的关键字，这可能会导致数据丢失。此外，该运算符同样适用于扩充赋值:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="d87a" class="nh md it nc b gy ni nj l nk nl">a = {'cars': 5, 'phones': 2} <br/>b = {'cows': 10, 'lizards': 3} <br/>a |= b <br/>print(a) <br/>// {'cars': 5, 'phones': 2, 'cows': 10, 'lizards': 3}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4a18" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">删除后缀和前缀</h1><p id="8ebf" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">新的<code class="fe mz na nb nc b">.removesuffix()</code>和<code class="fe mz na nb nc b">.removeprefix()</code>字符串方法就是这么做的:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="5a35" class="nh md it nc b gy ni nj l nk nl">'SubaruImpreza`.removeprefix('Subaru') // 'Impreza' 'SubaruImpreza'.removesuffix('Impreza') // 'Subaru'</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1d47" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">新解析器</h1><p id="a40c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在Python 3.9中，使用了新的解析器。它基于<a class="ae ky" href="https://en.wikipedia.org/wiki/Parsing_expression_grammar" rel="noopener ugc nofollow" target="_blank"> PEG(解析表达式语法)</a>，不像旧的使用<a class="ae ky" href="https://en.wikipedia.org/wiki/LL_parser" rel="noopener ugc nofollow" target="_blank"> LL(从左到右解析器)</a>。这样做是因为LL解析器的能力已经耗尽，实现新的语言特性变得越来越困难。最有可能的是，您会注意到没有区别——性能是可比的，并且完全向后兼容性是经过验证的。</p><p id="42a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只有当您的代码使用标准库中的<code class="fe mz na nb nc b">parser</code>模块时，您才需要关心它。不久前它被弃用了，并且不能与新的解析器一起工作。作为一种变通方法，您可以使用参数<code class="fe mz na nb nc b">-X oldparser</code>或环境变量<code class="fe mz na nb nc b">PYTHONOLDPARSER=1</code>切换回旧的解析器。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4fa9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Zoneinfo模块</h1><p id="85a4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python 3.9引入了一个名为<code class="fe mz na nb nc b">zoneinfo</code>的新模块。它实现了为IANA时区提供支持的<code class="fe mz na nb nc b">ZoneInfo</code>类。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="d406" class="nh md it nc b gy ni nj l nk nl">from zoneinfo import ZoneInfo <br/>from datetime import datetime, timedelta <br/>timestamp = datetime(2020, 7, 15, 11, tzinfo=ZoneInfo("America/Los_Angeles"))</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6a7c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">图形库模块</h1><p id="892f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">另一个新模块——这次是处理图表。目前，它只实现了有向无环图的拓扑排序算法。如果你不明白我刚刚写的，你很可能不会需要新的模块。对于那些熟悉图论的人来说，模块应该是这样使用的(摘自Python文档):</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="dd07" class="nh md it nc b gy ni nj l nk nl">&gt;&gt;&gt; graph = {"D": {"B", "C"}, "C": {"A"}, "B": {"A"}} <br/>&gt;&gt;&gt; ts = TopologicalSorter(graph) <br/>&gt;&gt;&gt; tuple(ts.static_order()) <br/>('A', 'C', 'B', 'D')</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4514" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结束语</h1><p id="769f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">谢谢你的阅读，我希望你喜欢我的文章。请继续订阅更多内容！</p><h2 id="281c" class="nh md it bd me oc od dn mi oe of dp mm li og oh mo lm oi oj mq lq ok ol ms om bi translated">资源</h2><ul class=""><li id="6c6f" class="nm nn it lb b lc mu lf mv li on lm oo lq op lu nr ns nt nu bi translated"><a class="ae ky" href="https://docs.python.org/3.9/whatsnew/3.9.html" rel="noopener ugc nofollow" target="_blank">发行说明</a></li><li id="09c7" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ky" href="https://docs.python.org/3.9/whatsnew/changelog.html#changelog" rel="noopener ugc nofollow" target="_blank">变更日志</a></li></ul></div></div>    
</body>
</html>