<html>
<head>
<title>Building a One-page Data-driven Site With Google Sheets and React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Google Sheets和React构建一个单页数据驱动的网站</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-one-page-data-driven-site-with-google-sheets-and-react-68a50a00a2e6?source=collection_archive---------4-----------------------#2022-10-31">https://betterprogramming.pub/building-a-one-page-data-driven-site-with-google-sheets-and-react-68a50a00a2e6?source=collection_archive---------4-----------------------#2022-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3fb5" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">使用Google Sheets构建可编辑的网站</h2><div class=""/><div class=""><h2 id="d9fa" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一种快速建立有用的单页网站的方法，该网站包含餐厅菜单、上课时间和其他可以使用数据表编辑的内容</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b17936515329bd0e84a9f609fec2a882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vht-ycJMlkDOQ2rp"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@whale?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马修·史密斯</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="aa14" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先:这并不像看起来那样是一个新的和创新的想法。我不知道是谁先想到的，但是你可以在网上找到很多这样的例子。我只是试着把一些事情放在一起…</p><p id="f5de" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">基本思想是将Google工作表导出为JSON的可能性(如<a class="ae le" href="https://developers.google.com/chart/interactive/docs/dev/implementing_data_source" rel="noopener ugc nofollow" target="_blank">实现图表工具数据源协议</a>中所述)。</p><p id="e754" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，Google Sheets将成为我们的后端接口和网页的数据提供者。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="35cf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本文的目标是使用现代工具构建一个快速的站点页面:</p><ul class=""><li id="d8d5" class="mi mj iq lh b li lj ll lm lo mk ls ml lw mm ma mn mo mp mq bi translated"><a class="ae le" href="https://www.google.com/intl/en-US/sheets/about/" rel="noopener ugc nofollow" target="_blank"> Google Sheets </a>用于存储和编辑数据。</li><li id="1596" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma mn mo mp mq bi translated"><a class="ae le" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a>建立站点。</li></ul><p id="3064" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我会假设你已经有一个谷歌帐户，至少有一个谷歌表和React的基本知识。</p><p id="0757" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">开始吧！</p><h1 id="8ab0" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">创建数据手册</h1><p id="41e1" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">对于我的示例，我将创建一个意大利餐厅菜单，因此我创建了一个数据表，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nt"><img src="../Images/c1cf3d89cca0e8536ee4c5bdab64d303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tmOPns6XLk8S5WLpTeQa4g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">“菜单”表</p></figure><p id="bec3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们的文档包含两个表:<strong class="lh ja">菜单</strong>和<strong class="lh ja">类别</strong>。</p><p id="6b16" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">第一个是主数据库，第二个是<em class="nu">菜单</em>表的<em class="nu">类别</em>列的值列表。使用<strong class="lh ja">数据</strong>菜单的<strong class="lh ja">数据验证</strong>命令，我们可以将<em class="nu">类别</em>列表绑定到第一列:这将确保每条记录都与现有的<em class="nu">类别</em>相关。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/231b921ef9d4564593b8d4061742c434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*dyZ0BcM9o1vfmwCLP53gbA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">谷歌表单中的数据验证窗口</p></figure><p id="7e5a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在可以通过弹出菜单编辑<em class="nu">类别</em>栏。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/d543bd8545cabfea9fabbcaf077f3dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72udlsEW-CjVIVa-2GYIQQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">目录弹出菜单</p></figure><p id="4e52" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">此外，最后的灰色列(<code class="fe nx ny nz oa b">CategoryOrder</code>和<code class="fe nx ny nz oa b">CategoryTranslation</code>)会自动连接到<em class="nu">类别</em>表，这样当我们选择一个类别时，它们会填充相应的行号和翻译列的值。</p><p id="a161" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以使用第一列的公式:</p><pre class="kp kq kr ks gt ob oa oc od aw oe bi"><span id="4664" class="of mx iq oa b gy og oh l oi oj">=MATCH(A2,Categories!$A:$A, false)</span></pre><p id="0848" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后是以下内容:</p><pre class="kp kq kr ks gt ob oa oc od aw oe bi"><span id="f5fa" class="of mx iq oa b gy og oh l oi oj">=VLOOKUP(A2,Categories!$A:$B, 2,false)</span></pre><p id="156a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将使用这些行号来显示我们的记录，使用与<strong class="lh ja">类别</strong>表行相同的顺序(我们将在后面介绍)。</p><p id="cff5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们的目标是通过第一张表上的一个独特的ajax调用获取所有数据。效率不是很高，但是由于我们必须获得有限数量的记录，这个系统绰绰有余(而且简单)。</p><p id="f3b6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">其他栏目没什么特别的。</p><h1 id="fc9e" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">共享</h1><p id="ced5" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">为了让您的应用程序阅读我们的文档，我们需要共享它。</p><p id="8e7c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后点击文档左上角的绿色<strong class="lh ja">共享</strong>按钮或文档列表中的共享图标。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/89afc4a0e711a69e7a4040e325617231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YSUf6u83oDwjxsN2D4qv8Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Google Drive文档列表</p></figure><p id="c26b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将向您显示<strong class="lh ja">共享</strong>窗口:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/35f502fa13e2e28888e052bd2d076847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*r9HsfC6VhUtY5ZNU6a4WuQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Google Drive共享窗口</p></figure><ol class=""><li id="755c" class="mi mj iq lh b li lj ll lm lo mk ls ml lw mm ma om mo mp mq bi translated">在<strong class="lh ja">一般访问</strong>部分，选择<em class="nu">任何具有链接</em>的人:这允许任何具有正确链接的人阅读您的文档，而不需要密码。</li><li id="41b0" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma om mo mp mq bi translated">在右侧的<strong class="lh ja">角色</strong>弹出框中，选择<em class="nu">查看器</em>。这样，任何人都可以阅读您的文档，但不能编辑它。</li><li id="413f" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma om mo mp mq bi translated">如果您想进一步降低共享权限，请单击左上方的齿轮图标并取消选择第二个选项，这样您的文档就无法打印或下载。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi on"><img src="../Images/23a5e5ac55bcd3ec31040c4de760c0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*1E0jzJ4GwaJzSfU8jg8anA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Google Drive共享选项</p></figure><p id="6041" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，点击<strong class="lh ja"> Done </strong>:现在你已经为下一步做好了准备。</p><h1 id="0ace" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">解析数据</h1><p id="8ab3" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">下一步是创建我们的数据提供者脚本。它将获得Json格式的电子表格数据，并按照我们需要的方式解析它。</p><p id="ba13" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为此，我们需要我们文档的文档ID 。</p><p id="160b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">来自<a class="ae le" href="https://developers.google.com/docs/api/how-tos/overview" rel="noopener ugc nofollow" target="_blank">谷歌文档开发者指南</a>:</p><blockquote class="oo op oq"><p id="1c92" class="lf lg nu lh b li lj ka lk ll lm kd ln or lp lq lr os lt lu lv ot lx ly lz ma ij bi translated"><em class="iq">文档id引用文档，可以从URL中导出:</em></p><p id="99b5" class="lf lg nu lh b li lj ka lk ll lm kd ln or lp lq lr os lt lu lv ot lx ly lz ma ij bi translated"><code class="fe nx ny nz oa b"><em class="iq">https://docs.google.com/document/d/__documentId__/edit</em></code></p><p id="e8f4" class="lf lg nu lh b li lj ka lk ll lm kd ln or lp lq lr os lt lu lv ot lx ly lz ma ij bi translated"><em class="iq"/>_ _ documentId _ _<em class="iq">是包含字母、数字和一些特殊字符的唯一字符串。</em></p></blockquote><p id="78ab" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您可以从您的电子表格url获取您的<em class="nu">文档Id </em>，并将其插入url <code class="fe nx ny nz oa b">https://docs.google.com/spreadsheets/d/&lt;DocumentId&gt;/gviz/tq?tqx=out:json</code>，如<a class="ae le" href="https://developers.google.com/chart/interactive/docs/dev/implementing_data_source" rel="noopener ugc nofollow" target="_blank">实现图表工具数据源协议</a>中所述。</p><p id="5986" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将返回一个为Google Chart数据程序优化的JSONP文档。通过更改一些url参数，可以有其他输出格式，但是JSON是实现我们目标的最简单的解决方案。</p><p id="5344" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">url返回一个<code class="fe nx ny nz oa b">txt</code>文件(JSONP内容),如下所示:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="92d0" class="ox mx iq oa b be oy oz l pa oj">/*O_o*/<br/>google.visualization.Query.setResponse({<br/>    "version":"0.6",<br/>    "reqId":"0",<br/>    "status":"ok",<br/>    "sig":"642849398",<br/>    "table":{<br/>        "cols":[...],<br/>        "rows":[...],<br/>        "parsedNumHeaders":1<br/>    }<br/>});</span></pre><p id="878e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个项目是我们需要的。它包含了<code class="fe nx ny nz oa b">cols</code>(电子表格标题)和<code class="fe nx ny nz oa b">rows</code>(数据)元素。<code class="fe nx ny nz oa b">cols</code>元素的第一行是<code class="fe nx ny nz oa b">rows.c</code>元素的第一行的标题，依此类推:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="5003" class="ox mx iq oa b be oy oz l pa oj">"cols":[<br/>    {"id":"A","label":"Category","type":"string"}, <br/>    {"id":"B","label":"Name","type":"string"},<br/>    ...<br/>],<br/><br/>"rows":[<br/>    {"c":[<br/>        {"v":"Primi Piatti"},<br/>        {"v":"Spaghetti con le vongole"},<br/>        {"v":"Spaghetti with clams"},<br/>        {"v":16.0, "f":"\u20AC16.00"},<br/>        {"v":true, "f":"TRUE"},<br/>        {"v":2.0, "f":"2"},<br/>        {"v":"Pasta and Soups"}<br/>    ]}, <br/>    ...<br/>]</span></pre><p id="6ae0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">每个行元素又有一个<code class="fe nx ny nz oa b">v</code>元素(原始值)，如果需要，还有一个<code class="fe nx ny nz oa b">f</code>元素(格式化值)。</p><p id="84d2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们的脚本需要解析JSONP文本，提取并解析JSON数据，然后重新排列结果:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="8ad4" class="ox mx iq oa b be oy oz l pa oj">export default async function getData() {<br/><br/>  // https://stackoverflow.com/questions/31765773/converting-google-visualization-query-result-into-javascript-array<br/>  // https://developers.google.com/chart/interactive/docs/dev/implementing_data_source#responseformat<br/><br/>  const spreadsheetId = '1lipvFbBqi0PhyeNMik6rhgYnBRlg4aJFX6LdjXvwBTQ',<br/><br/>    response = await fetch(`https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json`),<br/>    result = await response.text(),<br/>    json = JSON.parse(result.replace(/.*google.visualization.Query.setResponse\({(.*?)}\);?/s, '{$1}'));<br/><br/>  // console.log(json);<br/><br/>  // `table.cols` element contains headings<br/>  // we will use them to build our data array<br/>  const headings = json.table.cols.map(item =&gt; item.label);<br/><br/>  // console.log(headings);<br/><br/>  // data of each row is associated to the headings<br/>  let data = json.table.rows.map(item =&gt; {<br/>    // console.log(item);<br/>    let row = {};<br/>    item.c.forEach((cell, idx) =&gt; {<br/>      row[headings[idx]] = cell?.v?? null;<br/>    });<br/>    return row;<br/>  });<br/><br/>  // filtering and sorting<br/>  data = data.filter(item =&gt; item.Publish === true);<br/>  data.sort((a, b) =&gt; a.CategoryOrder &gt; b.CategoryOrder);<br/><br/>  // console.log(data);<br/><br/>  /*<br/>    Fields:<br/>    -------------------<br/>    Category<br/>    Name<br/>    Description<br/>    Price<br/>    Publish<br/>    CategoryOrder<br/>    CategoryTranslation<br/>  */<br/><br/>  // aggregating data by category<br/>  data = [...new Set(data.map(item =&gt; item.CategoryOrder))].map(categoryIndex =&gt; {<br/>    return data.filter(item =&gt; item.CategoryOrder === categoryIndex);<br/>  });<br/><br/>  return data;<br/>}</span></pre><ul class=""><li id="0431" class="mi mj iq lh b li lj ll lm lo mk ls ml lw mm ma mn mo mp mq bi translated">首先，使用<code class="fe nx ny nz oa b">fetch</code>检索远程内容。JSONP回调函数名(<code class="fe nx ny nz oa b">google.visualization.Query.setResponse</code>)被删除，生成的JSON被解析(其他信息请看Stackoverflow上的<a class="ae le" href="https://stackoverflow.com/questions/31765773/converting-google-visualization-query-result-into-javascript-array" rel="noopener ugc nofollow" target="_blank">将Google可视化查询结果转换成JavaScript </a>数组问题)。</li><li id="a7e9" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma mn mo mp mq bi translated">然后解析标题:它们将被用作返回的JSON的键。</li><li id="c21f" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma mn mo mp mq bi translated">解析JSON行并创建一个新的JSON。</li><li id="e052" class="mi mj iq lh b li mr ll ms lo mt ls mu lw mv ma mn mo mp mq bi translated">最后，删除未发布的项目，剩余的数据按<code class="fe nx ny nz oa b">CategoryOrder</code>排序。</li></ul><p id="6f14" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们有了一个规范化的JSON:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="145a" class="ox mx iq oa b be oy oz l pa oj">[<br/>  {<br/>    "Category": "Primi Piatti",<br/>    "Name": "Spaghetti con le vongole",<br/>    "Description": "Spaghetti with clams",<br/>    "Price": 16,<br/>    "Publish": true,<br/>    "CategoryOrder": 2,<br/>    "CategoryTranslation": "Pasta and Soups"<br/>  },<br/>  {<br/>    "Category": "Antipasti",<br/>    "Name": "Caprese",<br/>    "Description": "Tomatoes and mozzarella seasoned with oil and basil",<br/>    "Price": 8,<br/>    "Publish": true,<br/>    "CategoryOrder": 1,<br/>    "CategoryTranslation": "Hors d'oeuvre"<br/>  }<br/>  // ...<br/> ]</span></pre><p id="6020" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是我们需要通过<code class="fe nx ny nz oa b">Category</code>来聚集行，以便更好地显示它们。</p><p id="7b30" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在脚本的最后几行，我们使用<a class="ae le" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set/Set" rel="noopener ugc nofollow" target="_blank">集合构造函数</a>获得了一个唯一的<code class="fe nx ny nz oa b">CategoryOrder</code>项数组，然后构建了一个新数组。现在所有项目都由<code class="fe nx ny nz oa b">Category</code>汇总:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="fa8b" class="ox mx iq oa b be oy oz l pa oj">[<br/>  [<br/>    {<br/>      "Category": "Antipasti",<br/>      "Name": "Caprese",<br/>      "Description": "Tomatoes and mozzarella seasoned with oil and basil",<br/>      "Price": 8,<br/>      "Publish": true,<br/>      "CategoryOrder": 1,<br/>      "CategoryTranslation": "Hors d'oeuvre"<br/>    }<br/>    //...<br/>  ],<br/>  [<br/>    {<br/>      "Category": "Primi Piatti",<br/>      "Name": "Spaghetti con le vongole",<br/>      "Description": "Spaghetti with clams",<br/>      "Price": 16,<br/>      "Publish": true,<br/>      "CategoryOrder": 2,<br/>      "CategoryTranslation": "Pasta and Soups"<br/>    }<br/>    //...<br/>  ],<br/>  //...<br/>]</span></pre><p id="74ba" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">每个记录都包含<code class="fe nx ny nz oa b">Category</code>、<code class="fe nx ny nz oa b">CategoryOrder</code>和<code class="fe nx ny nz oa b">CategoryTranslation</code>条目——这确实是多余的，但是我们处理的是少量的记录，所以我们可以忽略这一点。</p><h1 id="eedd" class="mw mx iq bd my mz na nb nc nd ne nf ng kf nh kg ni ki nj kj nk kl nl km nm nn bi translated">发展中的</h1><p id="6aa5" class="pw-post-body-paragraph lf lg iq lh b li no ka lk ll np kd ln lo nq lq lr ls nr lu lv lw ns ly lz ma ij bi translated">由于我们的目标是构建一个非常简单的页面，所以我们不会使用任何CSS框架(我们只会使用像<a class="ae le" href="https://necolas.github.io/normalize.css/" rel="noopener ugc nofollow" target="_blank"> Normalize.css </a>这样的CSS重置表)。</p><p id="6402" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">总的来说，我尽可能地简化了一切，这样我们就可以专注于工作流程。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="2828" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nx ny nz oa b">App.jsx</code>脚本完成了所有的工作:</p><pre class="kp kq kr ks gt ob oa ou bn ov ow bi"><span id="f363" class="ox mx iq oa b be oy oz l pa oj">import './App.scss';<br/>import React from 'react';<br/>import getData from './google-sheets-data-provider';<br/><br/>import deco1 from './imgs/deco1.svg';<br/>import deco2 from './imgs/deco2.svg';<br/>import deco3 from './imgs/deco3.svg';<br/>import deco4 from './imgs/deco4.svg';<br/><br/>function App() {<br/>  const [content, setContent] = React.useState(null),<br/>    [json, updJson] = React.useState(null);<br/><br/>  React.useEffect(() =&gt; {<br/><br/>    try {<br/>      getData().then(result =&gt; updJson(result));<br/><br/>    } catch(e) {<br/>      updJson(null);<br/>      setContent('Error on data loading...');<br/>    }<br/><br/>  }, []);<br/><br/>  React.useEffect(() =&gt; {<br/><br/>    if(json?.length) {<br/><br/>      setContent(json.map((item, idx) =&gt; {<br/>        // We get Category and CategoryTranslation from the first item<br/>        return &lt;React.Fragment key={idx}&gt;<br/>          &lt;h2&gt;{item[0].Category}&lt;/h2&gt;<br/>          {item[0].CategoryTranslation &amp;&amp; &lt;p lang="en" className='subtitle'&gt;{item[0].CategoryTranslation}&lt;/p&gt;}<br/>          &lt;ul&gt;<br/>            {item.map((row, idx) =&gt; {<br/>              return &lt;li key={idx}&gt;<br/>                &lt;div className="name-wrapper"&gt;<br/>                  &lt;span className='name'&gt;{row.Name}&lt;/span&gt;<br/>                  &lt;span className='dotted-line'&gt;&lt;/span&gt;<br/>                  &lt;span className='price'&gt;{row.Price.toLocaleString('en-UK', {<br/>                    minimumFractionDigits: 2,<br/>                    maximumFractionDigits: 2,<br/>                    currency: 'EUR',<br/>                    style: 'currency'<br/>                  })}&lt;/span&gt;<br/>                &lt;/div&gt;<br/>                {row.Description &amp;&amp; &lt;div className="description"&gt;{row.Description}&lt;/div&gt;}<br/>              &lt;/li&gt;;<br/>            })}<br/>          &lt;/ul&gt;<br/>          {idx &lt; json.length -1 &amp;&amp;<br/>            &lt;div className="deco small"&gt;&lt;img src={deco3} alt="" /&gt;&lt;/div&gt;<br/>          }<br/>        &lt;/React.Fragment&gt;;<br/>      }));<br/>    }<br/>  }, [json]);<br/><br/>  return (&lt;&gt;<br/>    &lt;div className="menu"&gt;<br/>      &lt;h1&gt;<br/>        &lt;img src={deco1} alt="" /&gt;<br/>        Menu<br/>        &lt;img src={deco1} alt="" /&gt;<br/>      &lt;/h1&gt;<br/>      &lt;div className="deco"&gt;&lt;img src={deco2} alt="" /&gt;&lt;/div&gt;<br/><br/>      {content? content : &lt;p className='big'&gt;Loading...&lt;/p&gt;}<br/><br/>      &lt;div className="deco"&gt;&lt;img src={deco4} alt="" /&gt;&lt;/div&gt;<br/>      &lt;p className='small'&gt;&lt;a href="https://www.freepik.com/free-vector/decorative-lines_4249919.htm"&gt;Images by rawpixel.com&lt;/a&gt; on Freepik&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  &lt;/&gt;);<br/>}<br/><br/>export default App;</span></pre><p id="7454" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们首先使用之前描述的脚本获取并解析Google Sheet数据，然后构建菜单。</p><p id="95f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pb"><img src="../Images/c2ffce98569a580777df457c53f4b475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URJDEmrO7Yb9JRa6sxRDdg.jpeg"/></div></div></figure><p id="c54a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您更改电子表格中的数据，菜单将会更新。这不是一个非常快速有效的解决方案，但对于小需求来说可能足够了。</p><p id="7969" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可以在我的GitHub库上找到完整的<a class="ae le" href="https://github.com/massimo-cassandro/area-test/tree/main/2022-10-google-sheets-react" rel="noopener ugc nofollow" target="_blank">源代码</a>和一个<a class="ae le" href="https://massimo-cassandro.github.io/area-test/2022-10-google-sheets-react/build/index.html" rel="noopener ugc nofollow" target="_blank">工作演示</a>。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><pre class="kp kq kr ks gt ob oa oc od aw oe bi"><span id="a373" class="of mx iq oa b gy og oh l oi oj"><strong class="oa ja">Want to Connect?</strong></span><span id="bddc" class="of mx iq oa b gy pc oh l oi oj">Check out <a class="ae le" href="https://medium.com/@massimo.cassandro/my-dev-publications-eacf6727e4a" rel="noopener">my other development-related articles</a>.</span></pre></div></div>    
</body>
</html>