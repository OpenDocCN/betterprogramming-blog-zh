<html>
<head>
<title>Implement Horizontal and Vertical ViewPager in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Jetpack Compose中实现水平和垂直ViewPager</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/implement-horizontal-and-vertical-viewpager-in-jetpack-compose-a7a91f2ac746?source=collection_archive---------2-----------------------#2022-07-14">https://betterprogramming.pub/implement-horizontal-and-vertical-viewpager-in-jetpack-compose-a7a91f2ac746?source=collection_archive---------2-----------------------#2022-07-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="11db" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在Jetpack撰写中实现ViewPager</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f2f91a0d0cf729fd213268e1b5e0ff9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3xO1dvWTpSC353E3y1uiw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这张图片中使用的Jetpack Compose徽标是由Google创建的官方徽标</p></figure><p id="4b0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Jetpack Compose中，默认情况下我们没有像<code class="fe ls lt lu lv b">ViewPager</code>这样可以使用的东西，但是我们有一个解决方案。我们要用<code class="fe ls lt lu lv b">Accompanist Pager library</code>。首先，我们要将依赖关系添加到应用程序级的<code class="fe ls lt lu lv b">build.gradle</code>文件中:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="7853" class="ma mb iq lv b gy mc md l me mf">implementation "com.google.accompanist:accompanist-pager:0.23.1"</span></pre><p id="0625" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong>撰写本文时，0.23.1是最新的稳定版本。检查是否有更新的版本。</p><blockquote class="mg mh mi"><p id="20fd" class="kw kx mj ky b kz la jr lb lc ld ju le mk lg lh li ml lk ll lm mm lo lp lq lr ij bi translated">"为Jetpack编写提供分页布局的库。如果你以前用过安卓的<code class="fe ls lt lu lv b"><a class="ae kv" href="https://developer.android.com/reference/kotlin/androidx/viewpager/widget/ViewPager" rel="noopener ugc nofollow" target="_blank">ViewPager</a></code>，它也有类似的属性。”根据<a class="ae kv" href="https://google.github.io/accompanist/pager/" rel="noopener ugc nofollow" target="_blank">寻呼机官方文档</a></p></blockquote><h2 id="2898" class="ma mb iq bd mn mo mp dn mq mr ms dp mt lf mu mv mw lj mx my mz ln na nb nc nd bi translated">水平寻呼机</h2><p id="639d" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated"><code class="fe ls lt lu lv b">HorizontalPager</code>是可组合的，内容水平排序并显示为页面。我们将创建一个名为<code class="fe ls lt lu lv b">HorizontalPagerContent</code>的数据类，它将表示水平页面内容。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="13e3" class="ma mb iq lv b gy mc md l me mf">data class HorizontalPagerContent(<br/>    val title: String,<br/>    val subtitle: String,<br/>    val description: String<br/>)</span></pre><p id="d701" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一步是创建将在此寻呼机中显示的项目列表:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="aea1" class="ma mb iq lv b gy mc md l me mf">fun createItems() = <em class="mj">listOf</em>(<br/>    HorizontalPagerContent(title = "Title1", subtitle = "Subtitle1", description = "Description1"),<br/>    HorizontalPagerContent(title = "Title2", subtitle = "Subtitle2", description = "Description2"),<br/>    HorizontalPagerContent(title = "Title3", subtitle = "Subtitle3", description = "Description3"),<br/>    HorizontalPagerContent(title = "Title4", subtitle = "Subtitle4", description = "Description4"),<br/>    HorizontalPagerContent(title = "Title5", subtitle = "Subtitle5", description = "Description5")<br/>)</span></pre><p id="5610" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个简单的函数，返回一个<code class="fe ls lt lu lv b">HorizontalPagerContent</code>项的列表。<code class="fe ls lt lu lv b">HorizontalPager</code>有两个强制参数，它们是<code class="fe ls lt lu lv b">count: Int</code>和<code class="fe ls lt lu lv b">content: @Composable PagerScope.(page: Int) -&gt; Unit</code>，其他参数都是可选的，还有很多类似的:<code class="fe ls lt lu lv b">modifier</code>、<code class="fe ls lt lu lv b">reverseLayout</code>、<code class="fe ls lt lu lv b">verticalAlignment</code>等等。我没有提到的一个非常有用的可选参数是代表页面状态的<code class="fe ls lt lu lv b">state: PagerState</code>。您可以使用该状态来获取当前页面、页数，并滚动到我们将在示例中显示的特定页面。因此，我们的主要可组合组件将如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="a0eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>我们需要添加<code class="fe ls lt lu lv b">ExperimentalPermissionsApi</code>注释，因为库中所有的API仍然是实验性的。</p><p id="c4f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们创建<code class="fe ls lt lu lv b">items</code>和<code class="fe ls lt lu lv b">pagerState</code>，并将它们都传递给<code class="fe ls lt lu lv b">HorizontalPager</code>。<code class="fe ls lt lu lv b">content</code> composable返回当前页面的索引，我们可以用它从列表中获取条目并加载数据。在我们的主composable的末尾，我们可以看到一个按钮，当按下时，会滚动到第三页。根据你的需要，你可以使用<code class="fe ls lt lu lv b">animateScrollToPage</code>或者<code class="fe ls lt lu lv b">scrollToPage</code>来滚动，但是这两个都需要在<code class="fe ls lt lu lv b">Coroutine</code>内部调用。两者的区别在于<code class="fe ls lt lu lv b">animateScrollToPage</code>滚动流畅。</p><p id="ffe5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来我们要添加的是<code class="fe ls lt lu lv b">indicators</code>和<code class="fe ls lt lu lv b">tabs</code>。为此，我们需要添加一个新的伴奏库:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="e4fb" class="ma mb iq lv b gy mc md l me mf">implementation "com.google.accompanist:accompanist-pager-indicators:0.23.1"</span></pre><p id="7ee2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong>撰写本文时，0.23.1是最新的稳定版本。检查是否有更新的版本。</p><p id="4954" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加指标很简单，我们只需要添加<code class="fe ls lt lu lv b">HorizontalPagerIndicator</code>并通过<code class="fe ls lt lu lv b">pagerState</code>即可。例如，它看起来像这样:</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="a5f1" class="ma mb iq lv b gy mc md l me mf"><em class="mj">HorizontalPagerIndicator</em>(<br/>    pagerState = pagerState,<br/>    modifier = Modifier<br/>        .<em class="mj">align</em>(Alignment.CenterHorizontally)<br/>        .<em class="mj">padding</em>(16.<em class="mj">dp</em>),<br/>)</span></pre><p id="9cd5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不错吧？现在让我们添加选项卡，我们将创建一个名为<code class="fe ls lt lu lv b">HorizontalTabs</code>的新的可组合组件，在该可组合组件中，我们将使用<code class="fe ls lt lu lv b">Accompanist Pager Indicator</code>库中的<code class="fe ls lt lu lv b">TabRow</code>和<code class="fe ls lt lu lv b">Tab </code>。这个可组合组件将如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5094" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ls lt lu lv b">TabRow</code>有两个强制参数<code class="fe ls lt lu lv b">selectedTabIndex: Int</code>和<code class="fe ls lt lu lv b">tabs: @Composable () -&gt; Unit</code>。此处使用参数<code class="fe ls lt lu lv b">indicator</code>来激活标签空间内的指示器绘图，而指示器不会从一个标签跳到另一个标签。在可组合的内部，我们只是传递标签的外观。我们正在使用这个库中的可组合<code class="fe ls lt lu lv b">Tab</code>，它有强制参数:<code class="fe ls lt lu lv b">selected: Boolean</code>、<code class="fe ls lt lu lv b">onClick: () -&gt; Unit</code>和<code class="fe ls lt lu lv b">content: @Composable ColumnScope.() -&gt; Unit</code>。当点击任何一个标签时，我们可以平滑地滚动到它。</p><p id="ae0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那就是<code class="fe ls lt lu lv b">HorizontalPager</code>和围绕它使用的主要特性。现在我们要实现<code class="fe ls lt lu lv b">VerticalPager</code>。</p><h2 id="dd8b" class="ma mb iq bd mn mo mp dn mq mr ms dp mt lf mu mv mw lj mx my mz ln na nb nc nd bi translated">垂直寻呼机</h2><p id="7718" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated"><code class="fe ls lt lu lv b">VerticalPager</code>是可组合的，内容垂直排序并显示为页面。</p><p id="c7ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实现<code class="fe ls lt lu lv b">VerticalPager</code>和实现<code class="fe ls lt lu lv b">HorizontalPager</code>基本是一回事。</p><p id="c8ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你只需要用<code class="fe ls lt lu lv b">VerticalPager</code>代替<code class="fe ls lt lu lv b">HorizontalPager</code>，对于指标你用<code class="fe ls lt lu lv b">VerticalPagerIndicator</code>代替<code class="fe ls lt lu lv b">HorizontalPagerIndicator</code>。其他都一样。所以它看起来像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="ffe9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是这篇文章的全部内容，希望你喜欢！<br/>你可以在<a class="ae kv" href="https://github.com/Giga99/MediumRepos" rel="noopener ugc nofollow" target="_blank">我的GitHub repo </a>中找到所有的源代码。</p><pre class="kg kh ki kj gt lw lv lx ly aw lz bi"><span id="09bc" class="ma mb iq lv b gy mc md l me mf">Connect with me on:<br/><a class="ae kv" href="https://github.com/Giga99" rel="noopener ugc nofollow" target="_blank">Github</a><br/><a class="ae kv" href="https://www.linkedin.com/in/igor-stevanovic/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><br/><a class="ae kv" href="https://twitter.com/igor_s1999" rel="noopener ugc nofollow" target="_blank">Twitter</a><br/><a class="ae kv" href="https://giga99.github.io/portfolio-website/" rel="noopener ugc nofollow" target="_blank">Portfolio website</a></span></pre><p id="0687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想了解如何在Jetpack Compose中请求权限，请阅读这篇文章:</p><div class="nl nm gp gr nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/jetpack-compose-request-permissions-in-two-ways-fd81c4a702c"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">在Jetpack Compose中请求权限的两种方法</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">在Jetpack Compose中请求权限的最佳方式</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">better编程. pub</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kp no"/></div></div></a></div><h1 id="1c62" class="od mb iq bd mn oe of og mq oh oi oj mt jw ok jx mw jz ol ka mz kc om kd nc on bi translated">资源</h1><div class="nl nm gp gr nn no"><a href="https://google.github.io/accompanist/pager/" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">向导伴奏者</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">为Jetpack Compose提供分页布局的库。如果你以前用过安卓的，它有类似的…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">google.github.io</p></div></div><div class="nx l"><div class="oo l nz oa ob nx oc kp no"/></div></div></a></div></div></div>    
</body>
</html>