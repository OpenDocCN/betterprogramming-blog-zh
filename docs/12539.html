<html>
<head>
<title>Create and Host Your Go Package for Tax Calculations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建并托管用于税收计算的Go包</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/go-package-for-taxes-c634924e1ee8?source=collection_archive---------7-----------------------#2022-06-12">https://betterprogramming.pub/go-package-for-taxes-c634924e1ee8?source=collection_archive---------7-----------------------#2022-06-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="52e8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">重复使用和共享您的解决方案的超级简单的方法！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b0bd2f7c6e6385e6b932d75e60db37b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6yiiSnJlXAB2Uj6Qa9KdQg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">雷尼·弗伦奇的《去地鼠》</p></figure><p id="f119" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文将创建一个Go包。Go标准库附带了大量优秀的包，可以省去重新创建解决方案的麻烦。</p><p id="3a24" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">需要你的程序打印信息到标准输出？您可以将包“fmt”导入到您的文件中，并通过调用<code class="fe lr ls lt lu b">fmt.Println(“I called fmt”)</code>来使用Println函数。不错！</p><p id="42f1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你*<strong class="kx ir">*</strong>创造的解决方案怎么样？您可能已经意识到您可以在多种场景中重用您的解决方案。</p><p id="2258" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">重用Go代码的潜在方法:</p><p id="82a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">❌反复将你的解决方案复制粘贴到其他文件中</p><p id="52ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">✔️创建一个可以轻松导入和使用的Go包</p><p id="1ed4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">✔️ ✔️Create和主机的Go包，任何人都可以导入和使用</p><h1 id="a4b2" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">我们的使用案例</h1><p id="14dc" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">作为<a class="ae ms" href="https://www.monumentcpa.com" rel="noopener ugc nofollow" target="_blank">纪念碑会计</a>的会计，你有时需要计算税金。你的一些客户是负责任的公民，喜欢预测他们的年度税收，并做出估计付款。你想帮助客户确定正确的付款，但是，你知道…数学。</p><p id="ff88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">税级和税率每年都在变化。美国的税收制度是累进的。这意味着税率随着收入的增加而上升。它也是一个分级系统。这意味着前10，000美元的收入按10%征税，接下来的30，000美元的收入按12%征税，等等。哦，如果你是已婚、单身或被认为是一家之主，括号的设置会有所不同。嗯，这有点糟糕。</p><p id="b70a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你知道你不能只是告诉你的客户支付20%的统一费率。你知道你会在很多年里为很多客户清洗和重复这些计算。你知道还有其他会计师和顾问想避免繁琐的税务计算。你知道你已经厌倦了谷歌搜索“[插入年份]税级”。</p><h1 id="8e58" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">我们的解决方案</h1><ul class=""><li id="016e" class="mt mu iq kx b ky mn lb mo le mv li mw lm mx lq my mz na nb bi translated">使用Go解决税收问题</li><li id="a1fb" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">在Github上托管我们的Go解决方案</li><li id="3b0d" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">每当我们需要计算税收时，导入税收包</li></ul><p id="ac8a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:本文中使用了以下Go概念:结构、函数、方法、接口、映射和切片。查看https://go.dev/doc/<a class="ae ms" href="https://go.dev/doc/" rel="noopener ugc nofollow" target="_blank">了解更多信息。</a></p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="615b" class="lv lw iq bd lx ly no ma mb mc np me mf jw nq jx mh jz nr ka mj kc ns kd ml mm bi translated">我们的Go文件</h1><p id="aa29" class="pw-post-body-paragraph kv kw iq kx b ky mn jr la lb mo ju ld le mp lg lh li mq lk ll lm mr lo lp lq ij bi translated">让我们首先在我们的计算机上创建一个名为<code class="fe lr ls lt lu b">taxgo</code>的文件夹。接下来，我们将在<code class="fe lr ls lt lu b">taxgo</code>文件夹中创建文件<code class="fe lr ls lt lu b">tax.go</code>。</p><p id="d8ed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将根据纳税人信息计算税款。让我们在一个结构中定义我们的<code class="fe lr ls lt lu b">Taxpayer</code>。注意，这个包被命名为<code class="fe lr ls lt lu b">tax</code>。</p><p id="5659" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是我们到目前为止的<code class="fe lr ls lt lu b">tax.go</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们需要每个纳税人的信息</p></figure><p id="960a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe lr ls lt lu b">Taxpayer</code>结构中的<code class="fe lr ls lt lu b">Status</code>是报税状态。我们需要选择一组与现状相匹配的税级。</p><p id="7da2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我使用以下缩写来表示归档状态:</p><ul class=""><li id="9c35" class="mt mu iq kx b ky kz lb lc le nv li nw lm nx lq my mz na nb bi translated">IND:个人</li><li id="0e06" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">MFS:已婚人士分开申报</li><li id="6247" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">MFJ:夫妻共同申报</li><li id="b5fe" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq my mz na nb bi translated">HOH:户主</li></ul><p id="074d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每一组税级都有一个备案状态和一组累进税率的累进门槛(为什么这么复杂！).以下是税级的结构:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="176b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们可以创建一个计算联邦税的方法。方法<code class="fe lr ls lt lu b">fedtax</code>有一个纳税人接收者参数，并返回一个float64数字。</p><pre class="kg kh ki kj gt ny lu nz oa aw ob bi"><span id="91a5" class="oc lw iq lu b gy od oe l of og">func (tp Taxpayer) fedTax() float64 {}</span></pre><p id="9226" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们制作一些地图。我们的第一张地图是税率地图。我们的税率图的关键字是Year，值是包含税率的一部分float64。这是<code class="fe lr ls lt lu b">fedTax</code>方法的一部分。</p><pre class="kg kh ki kj gt ny lu nz oa aw ob bi"><span id="de0d" class="oc lw iq lu b gy od oe l of og">rates := make(map [int] []float64)<!-- --> think: <!-- -->rates[Year] = [tax rates … ]</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">fedTax方法中的比率映射</p></figure><p id="7a79" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的收入等级图也将使用年份作为关键字。该值将是类型为<code class="fe lr ls lt lu b">Bracket</code> ( <em class="oh">提醒:类型括号中有状态和阈值字段)</em>的切片</p><pre class="kg kh ki kj gt ny lu nz oa aw ob bi"><span id="a0a6" class="oc lw iq lu b gy od oe l of og">brackets := make(map[int] []Bracket)<!-- --> think <!-- -->brackets[Year] = {Status, Thresholds … }</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">fedTax方法中的括号映射</p></figure><p id="d4bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">是时候进行数学运算了。我们需要为我们的<code class="fe lr ls lt lu b">taxpayer</code>找到正确的年份和状态，以便在税收计算中使用正确的一组等级和税率。</p><p id="800c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们定义变量<code class="fe lr ls lt lu b">myBracket</code>来保存<code class="fe lr ls lt lu b">Taxpayer</code>接收到<code class="fe lr ls lt lu b">fedTax </code>方法中的正确括号。</p><p id="25e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将遍历括号映射，并根据<code class="fe lr ls lt lu b">Taxpayer</code>信息追加正确的收入括号集(<em class="oh">这就是我们拥有纳税人结构的原因)。</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">fedTax方法中的括号范围</p></figure><p id="fb25" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<code class="fe lr ls lt lu b">fedTax</code>方法现在有了正确的一组括号来计算税收。税款计算将是按每个税率计算的金额总和(基于<code class="fe lr ls lt lu b">Taxpayer</code>的年份、身份和收入)。</p><p id="6b4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们宣布可变税，以保持价值，因为它通过每个税级和税率组合增加。我们遍历纳税人的括号。如果纳税人的收入大于其等级的当前迭代(var <code class="fe lr ls lt lu b">myBrackets</code>)，则加到var <code class="fe lr ls lt lu b">tax</code>的税额为:(其收入的出租人和该等级的顶部)*(该等级&amp;年的税率)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">把每个等级的税加起来。仍在fedTax方法中。注意:从Go标准库导入的数学包</p></figure><p id="a133" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那很容易！但是，有一个问题。我们故意避开最高的税级(嘿，这当然不是我的个人税级！).</p><p id="ddd0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果纳税人处于最高等级(收入&gt;最高起征点金额)，我们会将最高等级的税额添加到<code class="fe lr ls lt lu b">tax</code>变量中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">顶部支架计算。fedTax方法返回税收值。</p></figure><p id="a05d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">税收现在从<code class="fe lr ls lt lu b">fedTax</code>方法返回。完事了吗？我们可能完了。</p><p id="1c0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们也可以把这个<code class="fe lr ls lt lu b">taxgo</code>方案设置得在未来更加稳健。也许当这个忙碌的会计有空的时候😆</p><p id="0d47" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<code class="fe lr ls lt lu b">taxgo</code>包还可以包含各种州税、资本收益税或个体户税的方法。让我们添加一个<code class="fe lr ls lt lu b">Taxes</code>接口和一个接受类型<code class="fe lr ls lt lu b">Taxes</code>的<code class="fe lr ls lt lu b">Calc</code>函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">税接口和计算功能</p></figure></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="53d5" class="lv lw iq bd lx ly no ma mb mc np me mf jw nq jx mh jz nr ka mj kc ns kd ml mm bi translated">推到GitHub并测试</h1><ol class=""><li id="9d31" class="mt mu iq kx b ky mn lb mo le mv li mw lm mx lq oi mz na nb bi translated">本地运行Git init</li><li id="cbf1" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq oi mz na nb bi translated">添加并提交tax.go. <code class="fe lr ls lt lu b"> git commit -am “initial commit”</code></li><li id="0390" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq oi mz na nb bi translated">在GitHub上创建一个与本地目录同名的存储库<code class="fe lr ls lt lu b">taxgo</code></li><li id="9a11" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq oi mz na nb bi translated">不要选择创建一个自述文件</li><li id="dd1e" class="mt mu iq kx b ky nc lb nd le ne li nf lm ng lq oi mz na nb bi translated">复制并粘贴下面的终端命令(将为您填充您的用户名和repo)</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/9837c1e637651004baf21116837beb75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTIJ7U0_wwemW8qQCJ8Sxg.jpeg"/></div></div></figure><p id="714e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">6.为测试创建一个新文件。我要跳到<a class="ae ms" href="https://www.replit.com" rel="noopener ugc nofollow" target="_blank"> Replit </a>上，有一个干净的环境来测试这个包。</p><p id="26d5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">7.创建一个main.go文件并在控制台中运行<code class="fe lr ls lt lu b">go get github.com/massia1207/taxgo</code>。</p><p id="d60a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">8.设置一两个试验<code class="fe lr ls lt lu b">Taxpayer</code>并打印一些结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">导入taxgo包</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ee6e358bd586b10ef7b2bec77596b45b.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*z7hM8CEkI220rt7tAmN_sw.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">运行main.go的结果</p></figure><p id="d65e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">想在电子表格中直接计算税款？在<a class="ae ms" href="https://workspace.google.com/marketplace/app/tax_functions/925755930014" rel="noopener ugc nofollow" target="_blank">Google Workspace market place</a>中查看<a class="ae ms" href="https://taxapp.monumentcpa.com" rel="noopener ugc nofollow" target="_blank">税务功能</a>。</p></div></div>    
</body>
</html>