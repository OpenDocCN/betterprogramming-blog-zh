<html>
<head>
<title>How to Screenshot Your iOS App’s UI in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Swift中截屏您的iOS应用程序的用户界面</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-screenshot-your-ios-apps-ui-in-swift-5c054a9226a5?source=collection_archive---------2-----------------------#2020-03-31">https://betterprogramming.pub/how-to-screenshot-your-ios-apps-ui-in-swift-5c054a9226a5?source=collection_archive---------2-----------------------#2020-03-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a22" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">并将生成的图像保存到照片库中</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/af39cb797baca3317a69d7b2d0001a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1UWrbUOT3fOafAxI"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">保罗·高迪奥在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2913" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，我们将学习如何在您的Swift应用程序中创建任意视图<em class="lv">的屏幕截图，并将生成的图像保存到照片库中。</em></p><p id="8580" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该项目的源代码可以在文章的底部找到。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d2e1" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">我们开始吧</h1><p id="bcad" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">假设我们有以下屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/985494880faf891df47857b0173754f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wlad0W4XMN5A5s-na_Y8bA.png"/></div></div></figure><p id="8eae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想要的是拍摄项目列表的快照，将其转换成一个<code class="fe nb nc nd ne b">UIImage</code>，然后将图像保存在照片库中。</p><p id="6e14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以在我们的<code class="fe nb nc nd ne b">ViewController</code>中有如下的初始结构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7458" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了开始响应按钮点击，让我们用新的动作更新<code class="fe nb nc nd ne b">actionButton</code>属性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="915f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们在<code class="fe nb nc nd ne b">Actions</code>标记下添加实际的截屏逻辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="223e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，在<code class="fe nb nc nd ne b">takeScreenshot(of:)</code>方法中，我们执行了以下操作:</p><ul class=""><li id="24bb" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">根据<code class="fe nb nc nd ne b">view</code>参数的大小开始创建图像上下文。</li><li id="77ff" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">将层<code class="fe nb nc nd ne b">view</code>渲染到上下文中。</li><li id="8650" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">从上下文中获取实际图像。</li><li id="3bd8" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">结束图像上下文。</li><li id="cb32" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">将生成的图像写入保存的相册。</li></ul><p id="1193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nb nc nd ne b">UIImageWriteToSavedPhotosAlbum</code>操作需要访问照片库的权限，因此我们必须向<code class="fe nb nc nd ne b">Info.plist</code>添加以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/084e212e842fe045a2647894471f6f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ct9NaL3OZhmBScv6uLjp-w.png"/></div></div></figure><p id="53f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该操作中，我们传入一个名为<code class="fe nb nc nd ne b">imageWasSaved</code>选择器，我们用它来执行照片写入的特定操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="f9a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们在过程中有任何错误，我们只需打印出来。否则，我们打开<em class="lv">照片</em>应用程序来查看我们全新的截图。</p><p id="3389" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们有以下工作流程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c09becbf79c81f1014fe41b15e316510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/1*LZm9ErwyjBGWHFdSUf00yA.gif"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0437" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">资源</h1><p id="f23b" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这个项目的源代码可以在GitHub上找到:</p><div class="nx ny gp gr nz oa"><a href="https://github.com/zafarivaev/SnapshotUI" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">zafarivaev/SnapshotUI</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">展示如何在应用程序中创建用户界面截图的应用程序- zafarivaev/SnapshotUI</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d9fc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">包扎</h1><p id="e224" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">有关上述<code class="fe nb nc nd ne b">UIGraphics</code>操作的更多信息，请参见Apple官方文档:</p><div class="nx ny gp gr nz oa"><a href="https://developer.apple.com/documentation/uikit/1623912-uigraphicsbeginimagecontextwitho" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">UIGraphicsBeginImageContextWithOptions(_:_:_:)</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">新位图上下文的大小(以磅为单位)。这表示由…返回的图像的大小</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">developer.apple.com</p></div></div></div></a></div><div class="nx ny gp gr nz oa"><a href="https://developer.apple.com/documentation/uikit/1623924-uigraphicsgetimagefromcurrentima" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">UIGraphicsGetImageFromCurrentImageContext()</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">包含当前位图图形上下文内容的image对象。您应该仅在以下情况下调用此函数…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">developer.apple.com</p></div></div></div></a></div><div class="nx ny gp gr nz oa"><a href="https://developer.apple.com/documentation/uikit/1623933-uigraphicsendimagecontext" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">UIGraphicsEndImageContext()</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">您使用此函数来清理由UIGraphicsBeginImageContext(_:)函数放置的绘图环境…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">developer.apple.com</p></div></div></div></a></div><p id="2f28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>