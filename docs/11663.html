<html>
<head>
<title>My Top 3 Wishes for WWDC 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我对WWDC 2022的三大愿望</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/my-top-3-wishes-for-wwdc-2022-cdb7ca39e9e7?source=collection_archive---------11-----------------------#2022-04-06">https://betterprogramming.pub/my-top-3-wishes-for-wwdc-2022-cdb7ca39e9e7?source=collection_archive---------11-----------------------#2022-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6bfb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">随着苹果<a class="ae ki" href="https://www.apple.com/newsroom/2022/04/apples-worldwide-developers-conference-returns-in-its-all-online-format/" rel="noopener ugc nofollow" target="_blank">宣布今年6月6日至10日的</a> WWDC周，让我们深入了解我希望看到哪些新的框架、API和工具亮相，以及使用它们的示例感觉如何。</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/fd359c44700d3036bb2c63c708a8d5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lwtzURhw_fEeuHbT"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae ki" href="https://unsplash.com/@mikearney?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈克·阿尼</a>在<a class="ae ki" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="d2d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每年都有一个非常特殊的时刻，一群特定的人会许下愿望，对各种各样的事情抱有希望。有些人与他人分享他们的愿望，有些人只是把愿望藏在心里，以免未能实现时过于失望。我曾经属于后一类人，但这一次我想分享我的愿望，以提高它们实现的概率——如果今年没有，那么也许明年会有。毕竟，圣诞老人可能在听。</p><p id="f5a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将跳过几乎所有iOS开发者列表中最常见的话题，例如更稳定的Xcode、更无bug的Swift、更完整的SwiftUI或更可靠的SwiftUI预览。我们开始吧！</p><h1 id="7992" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">#3:从一张图片导入各种尺寸的应用图标</h1><h2 id="51d1" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">问题</h2><p id="0f4e" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">每个应用程序都需要有一个应用程序图标。Xcode要求我们提供几十种不同大小的应用程序图标，但不支持调整它们的大小。虽然有许多应用程序和工具可以帮助实现这一目标，但只有少数几个支持最新的尺寸，因为苹果喜欢随着时间的推移添加新的尺寸。这对于刚起步的新开发者来说是不必要的障碍。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nf"><img src="../Images/66b274fa9fcd6bf945428180ca0c1be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igIfo88DAgFFJlrjIHsPkQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">我的<a class="ae ki" href="https://github.com/FlineDevPublic/OpenFocusTimer" rel="noopener ugc nofollow" target="_blank">自动对焦定时器</a>应用的临时应用图标集</p></figure><h2 id="50f4" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">解决办法</h2><p id="dfc0" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">当拖放一个1024x1024的图像到<code class="fe ng nh ni nj b">AppIcon</code>集合或其中的<code class="fe ng nh ni nj b">App Store</code>条目时，Xcode会询问我们是否要使用它作为参考图像来生成所有其他大小的图像。同样的情况也可能发生在拖拽SVG文件的时候，尽管我已经很满意1024倍的大小了。</p><p id="b49e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拖放的一种替代方法是在选择名为“存档时生成大小”的<code class="fe ng nh ni nj b">AppIcon</code>图像集时，在右侧窗格中选择一个选项，这样您只需提供甚至提交一个大小，Xcode就会在为某个版本存档时动态生成其他大小。</p><h2 id="58e4" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">可能性</h2><p id="caf6" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">与Xcode 5一起在2013年推出。从那以后，他们没有得到太多的爱，所以我怀疑这一天会到来。另一方面，<a class="ae ki" href="https://support.apple.com/en-gb/guide/playgrounds-ipad/itc8ff20cba7/ipados" rel="noopener ugc nofollow" target="_blank">iPad上的Swift Playgrounds</a>似乎确实能够从一张“图片”中生成所有尺寸的图片。虽然这在技术上可能适用于矢量图形，但也许我们会在Xcode中看到完全相同的图标生成器？</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nf"><img src="../Images/0a286bfac453ee95fc3319586e6c5b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXhVwHxpM19_Uo0zmJZvtQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">在iPad上的Swift Playgrounds中创建应用图标</p></figure><h1 id="4501" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"># 2:Xcode中的应用模块化支持</h1><h2 id="1f61" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">问题</h2><p id="32fc" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在包含大量文件的应用程序目标中工作很简单，但也有缺点，这些文件被分组到文件夹中，以松散地表示属于一起的功能。例如，为了测试出最小的代码变化，您需要构建整个项目。这也带来了SwiftUI预览工作不太可靠，或者需要很长时间来显示您的更改。虽然增量构建没那么慢，但实际上你也在其他地方做了更改，然后Xcode不得不构建比需要更多的内容。或者你明确地告诉Xcode进行一次干净的构建，因为，好吧，不知何故Xcode的行为不像预期的那样。</p><p id="9f71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是构建时间并不是单一目标项目的唯一问题。在一个<code class="fe ng nh ni nj b">main</code>模块中拥有你的所有类型意味着你可以从任何地方访问所有类型，因为Swift默认为<code class="fe ng nh ni nj b">internal</code>访问级别——这个<a class="ae ki" href="https://en.wikipedia.org/wiki/Coupling_(computer_programming)" rel="noopener ugc nofollow" target="_blank">不好</a>，因为它会使你的代码更难重用和测试。即使你想用较低的访问级别显式地标记你所有的属性&amp;函数，你也不能在你必须从一个其他文件访问它们的时候使用<code class="fe ng nh ni nj b">private</code>或<code class="fe ng nh ni nj b">fileprivate</code>——也很容易忘记添加它们。</p><p id="a5ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我个人目前使用的解决方法由来自Point-Free的Stephen和Brandon在视频<a class="ae ki" href="https://www.pointfree.co/episodes/ep171-modularization-part-1" rel="noopener ugc nofollow" target="_blank">中详细解释。虽然它解决了上述两个问题，但手动更新<code class="fe ng nh ni nj b">Package.swift</code>文件是一个麻烦。看看我的(目前)单屏幕对焦定时器应用程序的清单文件</a>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nk"><img src="../Images/0e6e7a5c7f7e5560ddc2e8d4d8f3cfc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiT1Bt7zjqx6NQf5umzaIg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">手动模块化应用程序“Package.swift”清单的一小段摘录。</p></figure><h2 id="f127" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">解决办法</h2><p id="9134" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">苹果可以在Xcode中提供一个新的UI，允许为我们的应用程序模块创建包，而不必像上面提到的那样做任何变通。我认为最简单的方法是增加对现有“目标”UI的支持，但要为Swift包增加一个额外的部分，并将SwiftPM作为底层技术。此外，每当我引用一个模块中的类型时，Xcode会警告我正在访问一个不可访问的模块，并询问我是否要将它作为一个依赖项添加到当前模块中。</p><p id="fa8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这甚至可能会让Xcode问我们是想创建基于Xcode项目的应用程序还是基于SwiftPM的应用程序。虽然我不期望(或要求)今年用一个<code class="fe ng nh ni nj b">Package.swift</code>文件完全替换<code class="fe ng nh ni nj b">.xcodeproj</code>文件(在SwiftPM中还有一些工作<a class="ae ki" href="https://forums.swift.org/c/development/swiftpm/6/l/top" rel="noopener ugc nofollow" target="_blank">要做，比如添加构建脚本等等。)，我认为至少可以将包的链接迁移到基于SwiftPM的基础上。</a></p><h2 id="fa91" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">可能性</h2><p id="f737" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">尽管今年我很想看到，但我认为在SwiftPM准备好完全取代<code class="fe ng nh ni nj b">.xcodeproj</code>文件之前，苹果不会在这个方向上做太多。我认为他们在这个领域“孤注一掷”，所以我对今年不抱什么希望。但也许明年会有一面测试旗可供选择？</p><h1 id="f4b0" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">#1:新的Swift专用数据库框架</h1><h2 id="35ef" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">问题</h2><p id="8af4" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">核心数据是苹果在2005年与Mac OS X 10.4 Tiger一起推出的，目的是为开发者提供一个比使用SQL指令更好的API。它很快成为了本地应用程序开发的首选数据库框架，现在依然如此。但它显然是为目标C写的。请看这个简单的模型:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="93a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，所有这些字段在核心数据中都被指定为非可选的<a class="ae ki" href="https://github.com/FlineDevPublic/OpenFocusTimer/blob/main/Sources/Model/Model.xcdatamodeld/Shared.xcdatamodel/contents" rel="noopener ugc nofollow" target="_blank">:</a></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nn"><img src="../Images/a2e15411b5adc8afd31d00b4f8026587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGEJsRPfCRrhB-7BwGPniQ.png"/></div></div></figure><p id="ca2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但无论如何都是作为Swift代码中的<code class="fe ng nh ni nj b">Optional</code>类型生成的。这和整个<code class="fe ng nh ni nj b">NSManagedObjectContext</code> API设计感觉相当过时，不太“<a class="ae ki" href="https://www.swift.org/about/" rel="noopener ugc nofollow" target="_blank"> Swifty </a>”(比如“不安全”)。是时候来点新鲜的了！</p><h2 id="7909" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">解决办法</h2><p id="1566" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">苹果可以引入一个新的仅支持Swift的框架(如<code class="fe ng nh ni nj b">SwiftUI</code>)，命名为类似<code class="fe ng nh ni nj b">SwiftData</code>的东西，它提供一个高级API来定义和管理持久模型。定义模型可能如下所示:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="f7b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于存储在iCloud中的模型，您需要在<code class="fe ng nh ni nj b">actor</code>前面加上<code class="fe ng nh ni nj b">distributed</code>。通常访问<code class="fe ng nh ni nj b">actor</code>的任何属性都需要<code class="fe ng nh ni nj b">await</code>关键字，但是一些神奇的属性包装器可以简化为:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="9e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从外部写入一个<code class="fe ng nh ni nj b">actor</code>属性是不可能的，但是<code class="fe ng nh ni nj b">@Persisted</code>属性包装器可能有一些<code class="fe ng nh ni nj b">Binding</code>魔法允许这样做:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="de34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不得不承认，我还没有在实践中使用过演员，所以如果上面的一些例子没有任何意义，请原谅我。但是我有一种感觉，演员可以在安全访问的框架中扮演重要的角色。</p><p id="828e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，Xcode可以附带一个UI，使数据模型版本化变得容易，并提供一个图形迁移工具，可以用声明性Swift语法编写，并在右侧作为UML图预览(像SwiftUI预览一样)。但也许我在这里开始梦想太大了…</p><h2 id="ed91" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">可能性</h2><p id="d793" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在过去的两年里，许多人都在期待这一点，因为这是SwiftUI之后合乎逻辑的下一步。但是今年，随着Swift 5.5中已经发布了<a class="ae ki" href="https://github.com/apple/swift-evolution/blob/main/proposals/0306-actors.md" rel="noopener ugc nofollow" target="_blank"> Actors </a>，并且最近刚刚接受了<a class="ae ki" href="https://github.com/apple/swift-evolution/blob/main/proposals/0336-distributed-actor-isolation.md" rel="noopener ugc nofollow" target="_blank">分布式</a> <a class="ae ki" href="https://github.com/apple/swift-evolution/blob/main/proposals/0344-distributed-actor-runtime.md" rel="noopener ugc nofollow" target="_blank"> Actors </a>(用于iCloud支持)，该技术可能会在9月份发布第一个版本。</p><h1 id="e33f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="031a" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">苹果会在六月宣布很多事情，以上只是我个人的愿望。但在过去，我总是对至少一两个框架感到惊讶，比如2019年的<a class="ae ki" href="https://developer.apple.com/videos/play/wwdc2019/216/" rel="noopener ugc nofollow" target="_blank"> SwiftUI </a>，2020年的<a class="ae ki" href="https://developer.apple.com/videos/play/wwdc2020/10028/" rel="noopener ugc nofollow" target="_blank"> WidgetKit </a>，2021年的<a class="ae ki" href="https://developer.apple.com/videos/play/wwdc2021/10166/" rel="noopener ugc nofollow" target="_blank"> DocC </a>。今年会是什么呢？我迫不及待地想知道！</p><pre class="kk kl km kn gt no nj np nq aw nr bi"><span id="0121" class="mo lx it nj b gy ns nt l nu nv"><strong class="nj iu">Want to Connect?</strong></span><span id="4140" class="mo lx it nj b gy nw nt l nu nv">You can find me also on 👾 <a class="ae ki" href="https://www.twitch.tv/Jeehut" rel="noopener ugc nofollow" target="_blank">Twitch</a>, 🎬 <a class="ae ki" href="https://www.youtube.com/channel/UCtg6Ck7oYa_9k1oSTmFGNRw" rel="noopener ugc nofollow" target="_blank">YouTube</a>, and 🐦 <a class="ae ki" href="https://twitter.com/Jeehut" rel="noopener ugc nofollow" target="_blank">Twitter</a>.</span></pre></div></div>    
</body>
</html>