# 实践中真正可重用的设计系统

> 原文：<https://betterprogramming.pub/truly-reusable-design-systems-in-practice-b6a07d7e59e9>

## 什么是伟大的设计系统——你如何为你的项目或公司创造你自己的系统？

![](img/e3b618783d440deb7d40d4c2ce49e377.png)

阿尔瓦罗·雷耶斯在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

Airbnb、苹果、优步和 GitHub 等公司已经改变了他们设计数字产品的方式，将他们的设计语言整合到一个系统中，这个系统可以供所有员工使用，甚至可以在公司外部使用。

它很快在整个行业流行起来:只要谷歌一下公司的名字和旁边的“设计”这个词，你会惊讶地发现有多少公司有类似的东西。 [Airbnb 设计](https://airbnb.design/the-way-we-build/)、[苹果设计](https://developer.apple.com/design/)、[优步基础网页](https://baseweb.design/)、[GitHub Primer](https://primer.style/)——这些都是好的设计系统的例子。

我们今天不会讨论拥有一个全公司范围的设计系统背后的原因或随之而来的组织挑战(尽管稍后肯定会涉及到它，所以请保持关注)。相反，我们将关注技术选择和实现细节。

# 一个好的设计系统的特征

一个好的设计系统是可重用组件的集合——由清晰的标准指导——这些组件可以组合在一起构建任意数量的应用程序。让我们试着把这个定义分成我们希望从技术角度优先考虑和关注的可操作的特征。

## 可重用组件

一般来说，设计系统是一组每个人都会使用的共享组件。

想象一下，你在公司有几个独立的团队，其中一些使用香草 JS。另一个小组使用 React，甚至另一个小组正在试验 Svelte。作为一个设计系统的创建者，你必须为这些框架构建组件，并考虑功能中的灵活性，这样你就不会将其他开发者锁定在特定的生态系统中。

## 大量文档

为了确保顺利采用您的设计系统，您必须提供经过深思熟虑、易于使用的文档，其中包含示例和最佳实践。

你是怎么做到的？首先，一个包含所有组件及其描述的网站会有所帮助。第二，如果您能直接在开发人员的 ide 中为您的组件提供关于可能的参数和用例的指导，那将是令人惊奇的。

## 面向绩效

因此，你将要求你的开发伙伴将这个设计系统作为一个依赖项添加进来，并可能替换一些已经工作的东西，确保依赖项的数量尽可能少，最好是零，这样你就不会膨胀所有项目的包大小。

尝试依赖浏览器 API 或 CSS，并更接近浏览器本机行为，因为更少的自定义 JS 代码意味着更快的组件。

## 保持最高质量

你还需要确保你的设计系统不会在新版本中崩溃。除了做代码审查和手工测试，我鼓励每个人都去看自动化测试。对于表示组件，考虑[截图测试](https://storybook.js.org/docs/testing/automated-visual-testing/)。对于有状态的测试，编写集成和端到端测试。

# StencilJS 和 Web 组件拯救世界

如果您想知道如何在不花费一个月的时间建立架构的情况下涵盖上面列表中的所有内容，我有一些建议。

StencilJS 是一个工具链，用于创建基于 Web 组件的可重用、可扩展的设计系统。它提供了一套完整的工具，让您可以立即开始在设计系统上工作，并使使用 Web 组件变得更加容易。

用 Stencil 创建的组件与浏览器标准完全兼容，可以在任何框架中运行，包括一个普通的 HTML 文件。您可以使用[输出目标](https://stenciljs.com/docs/output-targets)来添加一个展示您作品的自定义网站。它还具有[截图测试](https://stenciljs.com/docs/screenshot-visual-diff)(除了 e2e 和 Jest 集成)。

让我们深入研究一下，看看构建一个简单但有状态的组件有多容易。

## 介绍获取按钮

任何设计系统的核心组件都是按钮。但是因为只有一个按钮太简单了，我们将使它足够强大，可以从属性中指定的任何端点获取数据，并通过浏览器事件返回数据。

首先，运行模板生成器:`npm init stencil`。它会让你选一个开胃菜。选择组件。这将生成一个包含简单测试组件的文件夹，这样您就可以开始使用它了(`npm install && npm start`)。

在`src/components`文件夹中，你会找到`my-component`文件夹。将其重命名为`fetch-button`——以及其中的`css`和`tsx`文件。CSS 文件负责我们按钮的样式，所以让我们添加一些样式:

现在转到`tsx`文件。这是我们需要构建的实际组件。

在 component 类之前，我们需要添加一个 decorator 来指定标记名，即样式文件的路径。

然后在类内部，我们需要定义一个名为`url`的`prop`。它将作为一个 HTML 属性工作，并允许我们将数据传递给组件。

下一行创建了一个状态变量:每次我们改变它，render 函数都会重新运行。

`@Event`指令为我们注册了两个事件:`onSuccess`和`onError`。

`@Listen`帮助我们监听点击事件并执行相应的功能。在我们的例子中，我们将调用本机 fetch 函数，并根据结果更新状态和触发事件。

最后，`render`函数定义了将要创建的 DOM。`<slot />`标签将被`<fetch-button>`子标签替换。

就是这样。现在让我们看看如何使用它。

除了原生 HTML 示例，我还添加了与 React 的集成。如您所见，这就像编写普通的`div`元素一样简单。

# 已知的复杂性

现在，是时候谈谈使用 Web 组件的缺点了。

最重要的一个是缺乏良好的框架支持。例如，在 React 中，您不能将事件侦听器附加到您的组件。

作为一种变通方法，您可以使用`ref`属性附加一个本地事件——这就是我在上面的例子中所做的。[Custom Elements Everywhere](https://custom-elements-everywhere.com/)网站展示了 Web 组件与流行框架的兼容性。

# 结论

在开始设计系统之前，评估您想要关注的值。也许你根本不需要它，只要适当地组织共享组件就足够了。

如果您已经决定整合系统，Web 组件完美地解决了设计系统面临的挑战，并且是构建组件的好技术。

StencilJS 使得为不同的目标管理和交付组件变得容易。但是考虑到这一点，请注意并探索仍然存在的关于框架支持的问题。