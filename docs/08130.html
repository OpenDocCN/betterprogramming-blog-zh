<html>
<head>
<title>Apparently, You Can Use Route53 as a Blazingly Fast Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">显然，您可以将Route53用作速度惊人的数据库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/apparently-you-can-use-route53-as-a-blazingly-fast-database-dd416b56b005?source=collection_archive---------1-----------------------#2021-03-30">https://betterprogramming.pub/apparently-you-can-use-route53-as-a-blazingly-fast-database-dd416b56b005?source=collection_archive---------1-----------------------#2021-03-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="357a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索利弊，以及它是如何成为可能的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c9ab37d3099dfeffc7f5cdd87301689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tqamswBJUs4W1tN0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jan_huber?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">简·侯伯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="16c3" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">介绍</h1><p id="972a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">几年前，我偶然发现了科里·奎因的这个疯狂的故事，故事讲述了他们如何将<a class="ae ky" href="https://aws.amazon.com/route53/" rel="noopener ugc nofollow" target="_blank">亚马逊路线53 </a>用作一个简单的数据库:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="d997" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">这是真是假，很难说，但科里经常把Route53称为他们选择的数据库。</p><p id="51c9" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">事实证明，这可能完全是虚构的，根据他们的<a class="ae ky" href="https://www.lastweekinaws.com/blog/route-53-amazons-premier-database/" rel="noopener ugc nofollow" target="_blank">博客文章</a>，该文章实际上提出了一个相当不错且有些可行的用例。</p><p id="63e3" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">Corey也在Reddit上发表了这个评论，这可能会揭穿Route53是数据库的神话:</p><blockquote class="nb"><p id="bf3a" class="nc nd it bd ne nf ng nh ni nj nk mt dk translated">“我的废话得到了牵引。请不要把它当成一个好主意；我的大部分建筑都是为了娱乐而故意糟糕的。”</p></blockquote><p id="3d9b" class="pw-post-body-paragraph ly lz it ma b mb nl ju md me nm jx mg mh nn mj mk ml no mn mo mp np mr ms mt im bi translated">考虑到这一点，让我们深入研究一下如何以及为什么您可能实际上使用Route53作为数据库。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="97b3" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">Route53(或任何域DNS配置)真的可以用作数据库吗？</h1><p id="f754" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">仔细想想，DNS配置实际上是一个非常初级的NoSQL数据库。您可以通过域名提供商的网站随时轻松地查看和修改它，并且您可以查看每个“记录”，就像查看数据库表中的一行一样。</p><p id="d322" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">许多服务使用DNS TXT记录来验证域所有权。您实际上是添加或修改一个TXT记录来存储一个键/值对，然后服务将对其进行查询。</p><p id="d8e1" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">作为一个例子，我们可以通过查询Google的TXT记录在实践中看到这一点:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="d9c0" class="nv lh it nr b gy nw nx l ny nz">$ dig -t txt google.com +short</span><span id="19d1" class="nv lh it nr b gy oa nx l ny nz">"facebook-domain-verification=22rm551cu4k0ab0bxsw536tlds4h95"<br/>"docusign=1b0a6754-49b1-4db5-8540-d2c12664b289"<br/>"docusign=05958488-4752-4ef2-95eb-aa7ba8a3bd0e"<br/>"google-site-verification=wD8N7i1JTNTkezJ49swvWW48f8_9xveREV4oB-0Hf5o"<br/>"apple-domain-verification=30afIBcvSuDV2PLX"<br/>"v=spf1 include:_spf.google.com ~all"<br/>"globalsign-smime-dv=CDYX+XFHUw2wml6/Gb8+59BsH31KzUr6c1l2BPvqKX8="</span></pre><p id="1f41" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">像脸书这样的服务将查询TXT记录，就像他们查询数据库中的行一样，以检索验证密钥来验证域的所有权。</p><p id="a8f5" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">您可以在任何时候从命令行使用<code class="fe ob oc od nr b">dig -t txt google.com +short</code>查询这些TXT记录，或者如果您喜欢冒险，您可以像我一样花几个小时编写一个可以在应用程序中实际使用的<a class="ae ky" href="https://nodejs.org/en/docs/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>库。稍后会详细介绍。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="7d1a" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">那么，你为什么要用亚马逊Route53做数据库呢？</h1><p id="1b59" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">实际上，使用DNS记录可能是一个好主意的原因有很多。</p><ul class=""><li id="a71a" class="of og it ma b mb mw me mx mh oh ml oi mp oj mt ok ol om on bi translated"><strong class="ma iu">性能:</strong>查询一条TXT记录快得惊人。查询谷歌的TXT记录只花了大约7毫秒。</li><li id="c138" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">高可用性:</strong>与任何其他AWS服务不同，Route53有保证的可用性。它基本上拥有100%的SLA。</li><li id="0464" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">边缘缓存:</strong> DNS解析器通过缓存查找结果来减少NS查找延迟，并且通常非常靠近发出请求的机器，就像CDN一样。</li><li id="9658" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">性价比:</strong>托管区域每月只需0.50美元，DNS查询每百万0.40美元。</li><li id="5788" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">简单的NS查找</strong>:任何人都可以以可读的格式“查询”数据。您不需要特定的数据库驱动程序或语言来查询它。</li></ul><p id="af86" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">你相信了吗？这无疑让我有足够的信心来建立一个概念验证。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8729" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">DiggyDB简介</h1><p id="eafa" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我花了几个小时构建了一个名为<a class="ae ky" href="https://www.npmjs.com/package/diggydb-nodejs" rel="noopener ugc nofollow" target="_blank"> DiggyDB </a>的Node.js库作为概念验证。</p><p id="2f55" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">首先，我应该简要解释一些数据库定义以及它们的用法:</p><ul class=""><li id="a0ee" class="of og it ma b mb mw me mx mh oh ml oi mp oj mt ok ol om on bi translated"><strong class="ma iu">数据库:</strong>这实际上是域的主主机名。<br/>例如<code class="fe ob oc od nr b">diggydb.example.com</code></li><li id="39b0" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">表:</strong>这是子域的一部分。<br/>例如<code class="fe ob oc od nr b"><strong class="ma iu">table</strong>.diggydb.example.com</code></li><li id="90eb" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">行/键:</strong>这是子域的最后一部分，允许您查询“表”中的特定行<br/>例如<code class="fe ob oc od nr b"><strong class="ma iu">3a7b68cf-686a-4135-b48b-6471deb3643a</strong>.table.diggydb.example.com</code></li><li id="2bba" class="of og it ma b mb oo me op mh oq ml or mp os mt ok ol om on bi translated"><strong class="ma iu">值:</strong>在其原始形式中，这是对应于如上所示的FQDN的实际TXT记录值。这被分解成本质上是一个<strong class="ma iu">列</strong>和它的<strong class="ma iu">值</strong>。</li></ul><p id="7a14" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">如果我们知道键和表，我们可以使用<code class="fe ob oc od nr b">dig</code>来查找值:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="c74b" class="nv lh it nr b gy nw nx l ny nz">$ dig -t txt 3a7b68cf-686a-4135-b48b-6471deb3643a.frameworks.diggydb.example.com +short</span><span id="0ae9" class="nv lh it nr b gy oa nx l ny nz">"name=gatsby"<br/>"version=3.1.2"<br/>"downloads=409,484"</span></pre><p id="8995" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">记住这一点，让我们看看如果我们使用DiggyDB <strong class="ma iu"> </strong>来:</p><ol class=""><li id="2c97" class="of og it ma b mb mw me mx mh oh ml oi mp oj mt ot ol om on bi translated">查询名为“框架”的表中的所有行(通过AWS SDK)</li><li id="9172" class="of og it ma b mb oo me op mh oq ml or mp os mt ot ol om on bi translated">查询表中的特定项目(通过DNS)</li><li id="53aa" class="of og it ma b mb oo me op mh oq ml or mp os mt ot ol om on bi translated">向表中添加新项目(通过AWS SDK)</li><li id="e6b5" class="of og it ma b mb oo me op mh oq ml or mp os mt ot ol om on bi translated">再次查询表中的所有行以显示新项目(通过AWS SDK)</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/5489fcad799795aa51d85974153b68a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ALdaxhscFJp0JV1D"/></div></div></figure><p id="ed45" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">非常强大，您会注意到执行这些操作实际上非常快，特别是当我们查询表中的特定键时，因为这是通过DNS查找完成的，所以只需要大约55毫秒。DiggyDB使用AWS-SDK来修改DNS记录，这大约需要1秒。</p><p id="6f42" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">以下是它在Route53中的存储方式(即raw格式):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/be3a0bd3a6eb6f74f4e02cdbf68a7460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ho6QukL-vBPkGvBq6UJztQ.png"/></div></div></figure><p id="6b91" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">下面是查询表的实际代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow mv l"/></div></figure><p id="270c" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">当我们使用AWS-SDK时，我们需要在配置中包含<code class="fe ob oc od nr b">accessKeyId</code>和<code class="fe ob oc od nr b">secretAccessKey</code>。</p><p id="0878" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">下面是查询表中特定键的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow mv l"/></div></figure><p id="bba8" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">注意到我们没有包括AWS访问键配置吗？这是因为我们使用了DNS查找方法，所以不需要。</p><p id="0172" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">最后，这是我们将如何向表中添加一行(再次使用AWS SDK):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow mv l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8d83" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">所以，等等…这其实是个好主意？</h1><p id="d3a7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我认为可以肯定地说，概念证明工作得非常好，这是一个非常有创意的解决方案。尽管有这么做的好处，但还是有一些缺点需要考虑:</p><p id="f6e8" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated"><strong class="ma iu">写入延迟:</strong>由于DNS解析器的缓存行为，传播DNS更改可能需要60到48小时。尽管大多数公共DNS解析器会遵守60s TTL，但有些会忽略它或完全忽略它。</p><p id="2111" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated"><strong class="ma iu">大小限制:</strong>TXT记录中的字符串最大长度为255个字符。FQDN也被限制为255个字符。</p><p id="9b5d" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated"><strong class="ma iu">行限制:</strong> Route53对于每个托管区域有10，000个资源记录集的限制。你可以要求更高的限额，但祝你好运解释原因。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="0edb" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="9647" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">实际上没有什么可以阻止你使用Route53作为数据库。DiggyDB在概念验证方面做得非常好，并且有一些在DNS配置中存储值的有效用例。我可以肯定地看到DiggyDB对于某些场景是有用的。然而，如果你正在寻找一个合适的可伸缩数据库，它可能不是Route53。</p><p id="cffd" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">如果DiggyDB真的被证明是有用的，我很想知道你是如何使用它的！如果你有任何想法，也非常欢迎你为这个项目做出贡献，因为将这个概念推向极限是非常棒的。</p><p id="f6eb" class="pw-post-body-paragraph ly lz it ma b mb mw ju md me mx jx mg mh my mj mk ml mz mn mo mp na mr ms mt im bi translated">谢谢，科里的灵感！</p></div></div>    
</body>
</html>