<html>
<head>
<title>Building Dark Mode for Storybook and Web Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为故事书和网络应用程序构建黑暗模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-dark-mode-for-storybook-and-web-applications-99d3a0b76312?source=collection_archive---------7-----------------------#2022-08-16">https://betterprogramming.pub/building-dark-mode-for-storybook-and-web-applications-99d3a0b76312?source=collection_archive---------7-----------------------#2022-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8caf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">黑暗模式完全指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c2d66a04b19cd93b6a02cea7a56e4483.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0iiRAg_uYwsTkhXY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@stenslens?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯登冲锋枪·里特菲尔德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="fd2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Light-on-dark_color_scheme" rel="noopener ugc nofollow" target="_blank">深色模式</a>是一种在深色背景上使用浅色文本、图标和UI元素的配色方案。相反的配色方案被称为轻模式。</p><p id="8f2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是用户选择黑暗模式的原因:</p><ul class=""><li id="f158" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">黑暗模式下的光需要更少的能量来显示。</li><li id="e87d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">科学表明，从长远来看，负极性(暗模式)对眼睛的伤害小于亮模式。</li><li id="4f83" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">对于一些UI设计来说，黑暗模式是时尚和时髦的。</li></ul><p id="6cb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是用户选择照明模式的原因:</p><ul class=""><li id="43f0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">大多数电子设备的默认设置是灯光模式。</li><li id="28aa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">光模式是skeuomorphic方法。</li><li id="7a52" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">强光模式在强光下阅读效果更好。</li></ul><p id="c77f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">暗模式是选择，亮模式是必须。当它被称为支持黑暗模式时，它意味着同时支持黑暗和光明模式。自2015年以来，黑暗模式获得了很大的吸引力。如今，复杂的web应用程序同时支持这两者。</p><p id="7493" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是关于以下主题的完整指南:</p><ul class=""><li id="64a7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#fe99" rel="noopener ugc nofollow">故事书的黑暗模式</a></li><li id="c5ef" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#eecb" rel="noopener ugc nofollow">网络应用的黑暗模式</a></li></ul><h1 id="fe99" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">故事书的黑暗模式</h1><p id="06c0" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><a class="ae ky" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank"> Storybook </a>是一个开源工具，用于构建独立的UI组件和页面。这允许我们一次处理一个组件。它简化了UI开发、测试和文档。</p><p id="a74e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为故事书建立黑暗模式需要几个步骤:</p><ul class=""><li id="633a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#d8ca" rel="noopener ugc nofollow">在Create React环境中设置故事书</a>。</li><li id="248c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#b506" rel="noopener ugc nofollow">安装插件，</a> <code class="fe ng nh ni nj b"><a class="ae ky" href="#b506" rel="noopener ugc nofollow">storybook-dark-mode</a></code>。</li><li id="75d5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#baf8" rel="noopener ugc nofollow">遵循初始配色方案的优先顺序</a>。</li><li id="1955" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#2055" rel="noopener ugc nofollow">使用故事书按钮控制主题和背景</a>。</li><li id="f264" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#0b4e" rel="noopener ugc nofollow">自定义故事书设置</a>。</li></ul><h2 id="d8ca" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">在Create React环境中设置故事书</h2><p id="a97a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们使用<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-in-depth-guide-for-create-react-app-5-cra-5-b94b03c233f2"> Create React App </a>作为探索故事书的基础。以下命令创建一个React项目:</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="8079" class="nk mk it nj b gy oa ob l oc od">npx create-react-app storybook-darkmode<br/>cd storybook-darkmode</span></pre><p id="02bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入命令<code class="fe ng nh ni nj b">npx sb init</code>，故事书就安装好了。虽然我们已经安装了故事书6.5，但它类似于我们为故事书6.3 所描述的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-in-depth-look-at-storybook-6-8c44cd6895ee">。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/d90be588154baa850d1f681c8565c761.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*8DvmuOploKKY7aVdaAtcrw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e2ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它用两个配置文件创建了文件夹<code class="fe ng nh ni nj b">.storybook</code>:</p><ul class=""><li id="be0a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe ng nh ni nj b">main.js</code>:配置故事文件位置，插件，自定义网络包和巴别塔配置。</li><li id="11fb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ng nh ni nj b">preview.js</code>:设置装饰器、参数和全局类型的全局设置。</li></ul><p id="ad51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">键入命令<code class="fe ng nh ni nj b">npm run storybook</code>，示例故事书在<code class="fe ng nh ni nj b">http://localhost:6006</code>运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b35d6ec4553523f853c5e443834ce4fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fgnpaqldfvnqQ6aoP35pBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4bd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，Storybook处于光照模式。</p><h2 id="b506" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">安装插件，故事书-黑暗模式</h2><p id="5647" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">是一个故事书插件，支持黑暗和光明模式之间的切换。这个插件每周有183.5k的下载量，它的使用量正在赶上Storybook。看这两条汇合的线，猜一猜。2020年是不是每个故事书都自带<code class="fe ng nh ni nj b">storybook-dark-mode</code>的一年？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/eb8a9f536b5ad897424ff01e93c1427c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CX-chRAzk7BshCFpnnZlug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1f07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们安装<code class="fe ng nh ni nj b">storybook-dark-mode</code>:</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="cff5" class="nk mk it nj b gy oa ob l oc od">npm i --save-dev storybook-dark-mode</span></pre><p id="1e8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ng nh ni nj b">.storybook/main.js</code>中，我们在下面的代码中包含了addon，<code class="fe ng nh ni nj b">'storybook-dark-mode'</code>(第11行):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="7717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">键入命令<code class="fe ng nh ni nj b">npm run storybook</code>，Storybook处于黑暗模式，因为macOS已经设置为黑暗模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/8e90163142b71fd284e3eaa43e7838d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ceyJBDvBqQfX3H0GXzZKnw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="baf8" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">遵循初始配色方案的优先顺序</h2><p id="e1f9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">以下是为初始配色方案定义的优先顺序:</p><ol class=""><li id="d8c5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu oj mb mc md bi translated">如果用户以前已经设置了配色方案，请重新使用该配色方案。</li></ol><p id="1ebf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本地存储器中，键<code class="fe ng nh ni nj b">sb-addon-themes-3</code>保存主题对象，其中<code class="fe ng nh ni nj b">current</code>设置为颜色方案。在以下示例中，<code class="fe ng nh ni nj b">current</code>被设置为<code class="fe ng nh ni nj b">light</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/547e61cbc2dc18804a2da1ffa40a8e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AovGSZMv4EbwliT9_0d9rA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e6d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.使用在<code class="fe ng nh ni nj b">.storybook/preview.js</code>中为<code class="fe ng nh ni nj b">current</code>参数配置的值。在以下示例中，<code class="fe ng nh ni nj b">current</code>被设置为<code class="fe ng nh ni nj b">light</code>(第3行):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="87a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.使用操作系统颜色方案首选项。</p><p id="869e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是macOS上的配色方案偏好设置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/745b542b3428a734fbf56972cfa1fd0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*bAxePckmpZ-583XFPo3LDA.png"/></div></figure><p id="1171" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，由于<a class="ae ky" href="https://github.com/hipstersmoothie/storybook-dark-mode/issues/179" rel="noopener ugc nofollow" target="_blank">的一个已知问题</a>，已配置的<code class="fe ng nh ni nj b">current</code>参数(#2)成为第一优先。</p><h2 id="2055" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">使用故事书按钮来控制主题和背景</h2><p id="3bf8" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">故事书启动后，有一个更改主题按钮(在下面的红色框中)，可以在黑暗(月亮)和光明(太阳)模式之间切换。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/3a3e24152312a1ee2cf4afb03098b7b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*le5D6od9-gO2UGsNqeC8zA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8d7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了“更改主题”按钮，还有一个“更改背景”按钮(在下面的红框中),用于更改预览的背景，与配色方案无关。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/54919ff7fe8ce5ec6d9a57183d95738e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKHWDBu96B5lyDUs4xqBiw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6aec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你觉得有两个控件比较混乱，可以用<code class="fe ng nh ni nj b">.storybook/preview.js</code>中的如下设置隐藏这个改变背景按钮。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="0b4e" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">自定义故事书设置</h2><p id="6d33" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">事情进展顺利。然后我们转到文档选项卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/0bff838e75f099fcf04fe858d7e0ef72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y9vMuwS2TSw14UtYlKniMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7d12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们发现show code部分并不处于黑暗模式，尽管在Canvas选项卡中相同的部分处于黑暗模式。</p><p id="4e13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能把它定制成黑暗模式吗？</p><p id="30e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我们可以。</p><p id="8de1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将以下<code class="fe ng nh ni nj b">darkMode</code>设置放入<code class="fe ng nh ni nj b">.storybook/preview.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="4c1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当在暗模式和亮模式之间切换时，第2行和第3行将<code class="fe ng nh ni nj b">darkClass</code>或<code class="fe ng nh ni nj b">lightClass</code>添加到<code class="fe ng nh ni nj b">body</code>元素。第4行将<code class="fe ng nh ni nj b">darkClass</code>或<code class="fe ng nh ni nj b">lightClass</code>配置为预览iframe中的<code class="fe ng nh ni nj b">body</code>元素。</p><p id="75c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/5ad5a2707b9afe80c50ef7466f84ea2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XN0lN_adryy2anXjMojMbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a947" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">预览iframe中的<code class="fe ng nh ni nj b">body</code>元素具有类<code class="fe ng nh ni nj b">darkClass</code>。show code部分在类<code class="fe ng nh ni nj b">docs-story</code>的<code class="fe ng nh ni nj b">body</code>中。使用<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/6-ways-to-configure-global-styles-for-storybook-faa1517aaf1a"> 6种配置故事书全局样式的方法</a>中描述的技术，我们可以在<code class="fe ng nh ni nj b">.storybook/preview.js</code>中导入样式表。</p><p id="35f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">增加<code class="fe ng nh ni nj b">.storybook/style.css</code>如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="f5c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将样式文件导入<code class="fe ng nh ni nj b">.storybook/preview.js</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="7627" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">show code部分现在处于黑暗模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/3c8d8137c3c18e45e96cb1895b508afa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUWNg1lwIlTMpXMdo-Yzag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fd20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们可以根据需要定制其他故事书设置。</p><h1 id="eecb" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">Web应用程序的黑暗模式</h1><p id="163b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们可以借用Storybook的想法来为Web应用程序设置黑暗模式。</p><ul class=""><li id="57e0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#f9c4" rel="noopener ugc nofollow">遵循初始配色方案</a>的优先顺序。</li><li id="a1e7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#57df" rel="noopener ugc nofollow">用</a> <code class="fe ng nh ni nj b"><a class="ae ky" href="#57df" rel="noopener ugc nofollow">ThemeProvider</a></code> <a class="ae ky" href="#57df" rel="noopener ugc nofollow">换</a> <code class="fe ng nh ni nj b"><a class="ae ky" href="#57df" rel="noopener ugc nofollow">styled-components</a></code>。</li><li id="c7c8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#9361" rel="noopener ugc nofollow">用黑暗模式实现Create React App</a>。</li></ul><h2 id="f9c4" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">遵循初始配色方案的优先顺序</h2><p id="d9f4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">以下是初始配色方案的优先顺序:</p><ol class=""><li id="88a4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu oj mb mc md bi translated">如果用户以前已经设置了配色方案，请重新使用该配色方案。</li></ol><p id="e6bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本地存储器中，<code class="fe ng nh ni nj b">my-color-scheme</code>键保存配色方案，<code class="fe ng nh ni nj b">dark</code>或<code class="fe ng nh ni nj b">light</code>:</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="e002" class="nk mk it nj b gy oa ob l oc od">const storageKey = 'my-color-scheme';</span></pre><p id="d3cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.使用操作系统颜色方案首选项。</p><p id="66f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/implement-dark-mode-using-javascript-css-and-third-party-libraries-50e27817c790">之前的一篇文章</a>解释了如何使用媒体查询<code class="fe ng nh ni nj b">matchMedia()</code>来获得操作系统的配色方案偏好。黑暗模式意味着下面的陈述是正确的。</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="badf" class="nk mk it nj b gy oa ob l oc od">matchMedia('(prefers-color-scheme: dark)').matches</span></pre><p id="aaad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.默认使用灯光模式。</p><p id="651d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果什么都没有设置，我们将灯光模式作为默认设置。</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="37f8" class="nk mk it nj b gy oa ob l oc od">const defaultMode = 'light';</span></pre><p id="e9db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是总结的算法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="57df" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">在样式化组件中使用ThemeProvider</h2><p id="452c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><code class="fe ng nh ni nj b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/styled-components-a-css-in-js-approach-755f6a196c42">styled-components</a></code>是一种CSS-in-JS方法——一个JavaScript库，它将每个JavaScript组件与其所有的CSS规则和依赖项捆绑在一起。</p><p id="6b52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们定义了黑暗模式主题和光明模式主题。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="836d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后根据选择的主题定义<code class="fe ng nh ni nj b">Container</code>样式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="35b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">ThemeProvider</code>是一个上下文API，它用<code class="fe ng nh ni nj b">theme</code>道具提供了一个主题上下文。每个包装的组件都可以动态地访问这个属性。</p><p id="73bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<code class="fe ng nh ni nj b">Container</code>放入<code class="fe ng nh ni nj b">ThemeProvider</code>中，它会接收到正确的主题。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="9361" class="nk mk it bd ml nl nm dn mp nn no dp mt li np nq mv lm nr ns mx lq nt nu mz nv bi translated">使用黑暗模式实现创建React应用程序</h2><p id="b0ab" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">要使用<code class="fe ng nh ni nj b">styled-components</code>，我们需要安装软件包:</p><pre class="kj kk kl km gt nw nj nx ny aw nz bi"><span id="5929" class="nk mk it nj b gy oa ob l oc od">npm i styled-components</span></pre><p id="fa62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ng nh ni nj b">styled-components</code>成为<code class="fe ng nh ni nj b">package.json</code>中<code class="fe ng nh ni nj b"><a class="ae ky" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">dependencies</a></code>的一部分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="f669" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是最后的<code class="fe ng nh ni nj b">src/App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><ul class=""><li id="5241" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">在第2行，<code class="fe ng nh ni nj b">styled</code>和<code class="fe ng nh ni nj b">ThemeProvider</code>从<code class="fe ng nh ni nj b">styled-components</code>导入。</li><li id="543f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第6–9行，定义了黑暗模式主题。</li><li id="b0fd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">第11–14行定义了灯光模式主题。</li><li id="b908" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第16–19行，<code class="fe ng nh ni nj b">Container</code>样式是通过所选主题定义的。</li><li id="fa12" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第26–41行，颜色方案按照优先顺序设置。</li><li id="53b7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第43–47行，按钮处理程序在黑暗和光明模式之间切换，并更新本地存储。</li><li id="4783" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第50行，<code class="fe ng nh ni nj b">ThemeProvider</code>的主题被设置为所选的配色方案。</li><li id="8d23" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第55–57行，按钮被设置为基于颜色方案的适当文本，单击它在暗模式和亮模式之间切换。</li></ul><p id="97d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于<code class="fe ng nh ni nj b">background-color</code>和<code class="fe ng nh ni nj b">color</code>是在主题中定义的，所以它们应该从<code class="fe ng nh ni nj b">src/App.css</code>中的<code class="fe ng nh ni nj b">App-header</code>类造型中移除。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/124eb1c8ea6dc520dbfe320c29a1b621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XVKUDnoqVnH3-SZWWswedg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行<code class="fe ng nh ni nj b">npm start</code>。我们可以通过点击按钮在深色和浅色模式之间切换配色方案。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/1c8ddb9a27c3efc9d0841021d470b6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*PKatitJRuUQcnScWPZIQTw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="0110" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="0a46" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">黑暗模式现在很流行。当它被称为支持黑暗模式时，它意味着同时支持黑暗和光明模式。我们已经给出了如何为故事书和网络应用程序构建黑暗模式的完整指南。</p><p id="7ee2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p><p id="6afe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣，可以查看一下<a class="ae ky" href="https://jenniferfubook.medium.com/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">我的web开发文章目录</a>。</p></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><p id="4deb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oz">注:感谢S . Sreeram和悉达多Chinthapally与我一起参与</em> <a class="ae ky" href="https://www.dominodatalab.com/" rel="noopener ugc nofollow" target="_blank"> <em class="oz">多米诺骨牌产品</em> </a> <em class="oz">的黑暗模式项目。</em></p></div></div>    
</body>
</html>