<html>
<head>
<title>Optional Chaining, Null Coalescing and How They Will Change the Way You Write Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可选链接、空合并以及它们将如何改变您编写代码的方式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/optional-chaining-and-null-coalescing-a93cb3dc7bb9?source=collection_archive---------18-----------------------#2020-01-15">https://betterprogramming.pub/optional-chaining-and-null-coalescing-a93cb3dc7bb9?source=collection_archive---------18-----------------------#2020-01-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="595d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种更安全、更符合人机工程学的方式来编写代码以访问对象属性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/77ad7b11b7f7fea7c33817cd7dc6e3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrPc1Etx4ZY3lvBf5uiwHw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">西蒙·艾布拉姆斯在<a class="ae ky" href="https://unsplash.com/s/photos/coding-at-work?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2bab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您最近一直在关注TypeScript版本，那么您已经知道可选链接和Nullish合并是在<a class="ae ky" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html" rel="noopener ugc nofollow" target="_blank"> TypeScript 3.7 </a>中引入的。它们都是JavaScript即将推出的特性的一部分，截至本文发布时，它们分别处于<a class="ae ky" href="https://github.com/TC39/proposal-optional-chaining" rel="noopener ugc nofollow" target="_blank">阶段4 </a>和<a class="ae ky" href="https://github.com/tc39/proposal-nullish-coalescing" rel="noopener ugc nofollow" target="_blank">阶段3 </a>。</p><p id="6835" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更新:从<a class="ae ky" href="https://babeljs.io/blog/2020/01/11/7.8.0" rel="noopener ugc nofollow" target="_blank"> Babel 7.8.0 </a>开始，这些特性也是默认包含的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ac9b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">可选链接</h1><p id="c605" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们经常发现自己深入一个对象来获取一个属性的值。如果你用JavaScript写了超过100行的代码，你就会知道，如果做得不对，这可能是一个常见错误的根源:<code class="fe mz na nb nc b">Uncaught TypeError</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/f10aca0613c75f6662235f72048bf320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRMANl7HNBa-0qf3pYa4zw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个常见的问题是在JavaScript中访问值会遇到可怕的undefined的无法读取属性</p></figure><p id="20cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在其余示例中使用这个模拟响应:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/fccd80c05ce19e778d14a9781077db03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6W4jIh0IqNrzRbGY1lllbw.png"/></div></div></figure><p id="5e69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了避免常见的<code class="fe mz na nb nc b">Uncaught TypeError</code>并从上面的响应中获得<code class="fe mz na nb nc b">id</code>的值，我们需要在JavaScript中做一些舞蹈。我们今天的方法是通过检查物体在每个深度的真实性，我们的工作方式是<code class="fe mz na nb nc b">id</code>。这种模式看起来更像是一个条件语句，它应该产生一个布尔值，而不是一个属性访问器语句，但这是我们今天拥有的最干净、最安全的本机方式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/24b6779f552be8b9370ef5f753463f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2NBPoGnVtysqTLIJpm1-g.png"/></div></div></figure><p id="426d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果您喜欢对象析构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/2cc86e54e3e7e192385d44915fa29a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_MPZo_tpB3-ebTYM1WRmA.png"/></div></div></figure><p id="a023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，这里发生的是<code class="fe mz na nb nc b">&amp;&amp;</code> <code class="fe mz na nb nc b">Logical-and-operator</code>左侧的代码块与<code class="fe mz na nb nc b">Boolean(data)</code>类似地被求值，如果值为<code class="fe mz na nb nc b">true</code>它就移动到右边求值。</p><p id="95d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你使用Lodash或Ember，会有更多符合人体工程学的方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/a7d9815954b6e2d8eae8a68942c7f7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EPpiUmq6SqNIQqL2quYOA.png"/></div></div></figure><p id="68c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，我们如何使用新的<code class="fe mz na nb nc b">Optional Chaining</code>做同样的事情呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ea6da4def1f658f3ce8ad3bfa0ece162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbPIpSu8JshugrjC5E0QjA.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6afe" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">零合并</h1><p id="ccd2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当我们访问的属性值为<code class="fe mz na nb nc b">null</code>或<code class="fe mz na nb nc b">undefined</code>时，通常会有一个默认值。目前，实现这一点的常用方法是使用<code class="fe mz na nb nc b">||</code> <code class="fe mz na nb nc b">Logical-or-operator</code></p><p id="492b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们需要Github用户名，即<code class="fe mz na nb nc b">login</code>属性，并且将默认设置为当前用户的用户名，在本例中为<code class="fe mz na nb nc b">sedighian</code>，我们的做法如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/0b72316fca536a988eb6630303ad1666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDvT_hmhVMxMCXQRnkIvtQ.png"/></div></div></figure><p id="3df7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个和第三个例子看起来很相似。那么，<code class="fe mz na nb nc b">Null Coalescing</code>为什么有用呢？简而言之，只有当左边的结果为<code class="fe mz na nb nc b">undefined</code>或<code class="fe mz na nb nc b">null</code>时，<code class="fe mz na nb nc b">Null Coalescing</code>才会计算<code class="fe mz na nb nc b">??</code>操作符右边的结果——这为我们在处理数据中有效但虚假的值时提供了一些保护，以防出现意外的结果。</p><p id="b26b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在许多情况下，我们希望将一个空字符串<code class="fe mz na nb nc b">''</code>、<code class="fe mz na nb nc b">false</code>和<code class="fe mz na nb nc b">0</code>返回一个值，而不是产生一个假值，并因此移动到<code class="fe mz na nb nc b">||</code>逻辑“或”操作符的右侧进行求值。现在，我们可以使用<code class="fe mz na nb nc b">Null Coalescing</code>，我们将不再有这些问题，如下例所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/ee133e0653ddd4c3063d448eed5fe3c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQr94su6ZG3Tpqpdohdl_Q.png"/></div></div></figure><p id="b419" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当访问一个对象时，为了得到后备或缺省值，有第三方库形式的替代方法，在Ember的例子中，有一个内置的实用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/f782ab8a49b4c3534058b1cd0453dd2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18UCoBzdZsBXn_rf0FRJCQ.png"/></div></div></figure><p id="cd5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忘记<code class="fe mz na nb nc b">Null Coalescing</code>不仅仅是提供一个默认值给变量。这是执行给定了<code class="fe mz na nb nc b">null</code>或<code class="fe mz na nb nc b">undefined</code>值的代码块的另一种方法。例如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/c8137ab0a49fa46649cb95d6b8cd4f1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3eeSeD8EHMU8qnYU-Z37g.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="18c8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">需要注意什么…</h1><p id="ff5e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在可选链接中使用<code class="fe mz na nb nc b">?</code>时，顺序很重要:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/1c3730fcbec486c2e6ea224b64c42dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ohJgavJeoj3JocAFeCvRQ.png"/></div></div></figure><p id="2565" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可选链接不能防止您错误地调用非函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/a383ff52196051a224a4f620600ce448.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrngoGIgHz-Phcu2HcwU0w.png"/></div></div></figure><p id="0adb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">零合并不是苹果对苹果对<code class="fe mz na nb nc b">lodash.get</code>或<code class="fe mz na nb nc b">EmberObject.getWithDefault</code>。主要区别在于<code class="fe mz na nb nc b">Null Coalescing</code>如何对待<code class="fe mz na nb nc b">null</code>和这两个工具。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/292b37bf95c87e743078985f1617be6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8d3B8RDAWXRMYaikwpXHTA.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d833" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><p id="a77a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html" rel="noopener ugc nofollow" target="_blank"> TypeScript 3.7发行说明</a></p><p id="dae7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://babeljs.io/blog/2020/01/11/7.8.0" rel="noopener ugc nofollow" target="_blank">巴别塔7.8.0发行说明</a></p><p id="bc67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【JavaScript提议的可选链接</p><p id="f806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【JavaScript提案的无效合并</p><p id="a822" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://lodash.com/docs/4.17.15#get" rel="noopener ugc nofollow" target="_blank"> lodash.get </a></p><p id="dc91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://api.emberjs.com/ember/3.15/functions/@ember%2Fobject/get" rel="noopener ugc nofollow" target="_blank"> EmberObject.get </a></p><p id="fccb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://api.emberjs.com/ember/3.15/functions/@ember%2Fobject/getWithDefault" rel="noopener ugc nofollow" target="_blank">ember object . getwithdefault</a></p></div></div>    
</body>
</html>