<html>
<head>
<title>Quickly Develop Highly Performant APIs With FastAPI and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FastAPI和Python快速开发高性能API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/quickly-develop-highly-performant-apis-with-fastapi-and-python-4ac1f252c935?source=collection_archive---------8-----------------------#2020-08-06">https://betterprogramming.pub/quickly-develop-highly-performant-apis-with-fastapi-and-python-4ac1f252c935?source=collection_archive---------8-----------------------#2020-08-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e975" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及为什么您应该在下一个API项目中考虑FastAPI</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/045c1aec9812f90a7aa949f94db663eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ai2HbhZQuplcAm5l"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Marc Sendra Martorell 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="8c5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你读过我以前的一些Python文章，你就会知道我是一个<a class="ae ky" href="https://livecodestream.dev/post/2020-05-21-python-flask-api-starter-kit-and-project-layout/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>迷。它是我在Python中构建API的首选。然而，最近我开始听到很多关于Python的一个新的API框架，叫做<a class="ae ky" href="https://github.com/tiangolo/fastapi" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>。用它构建了一些API之后，我可以说它很神奇！</p><p id="ee07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个项目是由<a class="ae ky" href="https://twitter.com/tiangolo" rel="noopener ugc nofollow" target="_blank"> Sebastian Ramírez </a>创建的，在撰写本文时，它已经积累了差不多20K颗星星。像微软、优步、网飞和其他一些大公司已经用它开发了API。</p><p id="c9e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是为什么这个新库如此受欢迎，它与Flask或Django相比如何？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9dec" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">特征</h1><p id="3e3b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">FastAPI是一个相当简约的框架。然而，这并没有减少它的功能。FastAPI是使用现代Python概念构建的，并且基于Python 3.6类型声明。让我们看看这个库的一些特性。</p><h2 id="4af9" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">自动文档</h2><p id="fea0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">任何API都必须有关于端点和类型的文档。解决这个问题的一个常见方法是使用<a class="ae ky" href="https://github.com/OAI/OpenAPI-Specification" rel="noopener ugc nofollow" target="_blank"> OpenAPI </a>和类似<a class="ae ky" href="https://github.com/swagger-api/swagger-ui" rel="noopener ugc nofollow" target="_blank"> Swagger UI </a>或<a class="ae ky" href="https://github.com/Redocly/redoc" rel="noopener ugc nofollow" target="_blank"> ReDoc </a>的工具来呈现信息。这些都是FastAPI自动打包的，允许您将更多的精力放在代码上，而不是设置工具。</p><h2 id="8ed0" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">类型化Python</h2><p id="ae89" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这是一个<em class="nl">大</em>的例子:FastAPI使用了Python 3.6类型声明(感谢Pydantic)。这意味着它使用Python特性，允许您指定变量的类型。这个框架广泛利用了它，为您提供了强大的编辑器支持。自动完成惊人地有效。</p><p id="1c8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一些使用类型化声明的示例代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="52e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们刚刚从:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c26d" class="mz md it np b gy nt nu l nv nw">name</span></pre><p id="777b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">收件人:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a755" class="mz md it np b gy nt nu l nv nw">name: str</span></pre><p id="608b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！结果是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/e73f9b002d95615940522d6ac3679a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdsWIt3Qe8XwwJf9y4_ZaQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用PyCharm在FastAPI中自动完成</p></figure><p id="8e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">漂亮！</p><h2 id="c0b5" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">确认</h2><p id="bff6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">由于<a class="ae ky" href="https://pydantic-docs.helpmanual.io/" rel="noopener ugc nofollow" target="_blank"> Pydantic </a>，验证已经集成到这个框架中。您可以验证标准Python类型以及一些自定义字段验证。这里有几个例子:</p><ul class=""><li id="427f" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated">JSON对象(<code class="fe oh oi oj np b">dict</code>)</li><li id="7c03" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">JSON数组(<code class="fe oh oi oj np b">list</code>)</li><li id="626e" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">具有最小和最大长度的字符串(<code class="fe oh oi oj np b">str</code>)</li><li id="09fb" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">带有最小值和最大值的数字(<code class="fe oh oi oj np b">int</code>、<code class="fe oh oi oj np b">float</code>)</li><li id="7d18" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">统一资源定位器</li><li id="9250" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">电子邮件</li><li id="3e0d" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">UUID</li><li id="c44e" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">还有更多…</li></ul><h2 id="862b" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">安全性和身份验证</h2><p id="f762" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这是任何API的关键部分，它是我们经常重复的代码，所以为什么不把它集成到框架中呢？FastAPI正是这样做的。</p><p id="89c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该库支持以下内容:</p><ul class=""><li id="f103" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated">HTTP基本</li><li id="009a" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">OAuth2 (JWT代币)</li><li id="cd9d" class="ny nz it lb b lc ok lf ol li om lm on lq oo lu od oe of og bi translated">头、查询参数或cookies中的API键。</li></ul><h2 id="67e1" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">证明文件</h2><p id="b4c8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这也许不完全是框架的特性，但是值得一提。该项目的文档简直令人惊叹。它非常清晰，涵盖了带有示例和解释的主题。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f87f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">表演</h1><p id="aa72" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">FastAPI快！它不仅编码速度快，而且处理请求的速度也非常快！您可以使用<a class="ae ky" href="https://www.techempower.com/benchmarks/#section=test&amp;runid=7464e520-0dc2-473d-bd34-dbdfd7e85911&amp;hw=cl&amp;test=composite&amp;l=zijzen-7&amp;a=2" rel="noopener ugc nofollow" target="_blank"> TechEmpower基准工具</a>检查多个框架的基准。以下是我得到的Python框架的结果。Flask和Django在列表中远远落后，FastAPI是第一个，因此是性能最好的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/557edfb2e13f39a613534d31514e23d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5jy_6FuSNuVjdYz-hMy5w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">TechEmpower基准测试结果</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4750" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">天生异步</h1><p id="ad98" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们来看看下面的代码:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a142" class="mz md it np b gy nt nu l nv nw">@app.post("/item/", response_model=Item)<br/>async def create_item(item: Item):<br/>    result = await some_code_running_in_background(item)<br/>    return result</span></pre><p id="525a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那是JavaScript吗？我向你保证这不是。不过，看起来很眼熟，对吧？这个片段实际上是使用异步方法的Python。</p><p id="63a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，FastAPI支持异步端点，这可以简化并提高代码效率。这是Flask的一个巨大优势。Django已经做了一些异步支持工作，但是它不像在FastAPI中那样集成。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="419b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="bd89" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">FastAPI是一个相对较新的框架，它遵循Flask的极简方法，但增加了一些重要的特性，使它更容易使用，性能惊人。对于您的下一个API项目来说，这是一个很好的选择，随着我在我的API上越来越多地使用它，我将会写更多关于它的内容。</p><p id="52f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>