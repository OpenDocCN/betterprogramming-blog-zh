# 3 个看似简单的 Python 特性让初学者感到困惑

> 原文：<https://betterprogramming.pub/3-seemingly-simple-python-features-that-confuse-beginners-313575312dcf>

## 让我们澄清一些 Python 的惯用用法

![](img/3bcff1a958b2322c32f6876036f42aa8.png)

Juan Pablo Donadías 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片。

Python 已经成为许多初次学习编程的人的首选语言。鉴于 Python 在机器学习、数据处理和其他领域的广泛能力，许多具有不同语言背景的人可能会考虑转向 Python。

Python 的设计非常简单。但是，有一些场景可能会让初学者感到困惑。在本文中，我想澄清一些令人困惑的 Python 特性。

# 1.逻辑运算符:与、或

当我们构造`if…else…`语句时，我们需要发送条件进行评估。当条件评估为`True`时，`if`程序块执行。当到达`False`时，`else`块执行。

如果条件有几部分，我们需要使用逻辑运算符`and`和`or`来连接它们。我们知道，所有单个的片段必须是真的，才能使`and`条件为真，而任何单个的片段都可以是真的，才能使`or`条件为真。

这些组合条件可以直接求值，因此有些人可能会将它们用作三元表达式。考虑下面的例子:

这两个例子表明，评估值将是第一个非虚假对象。下面这个表达怎么样？

```
empty_string = ""
empty_list = []
what = empty_string or empty_list
```

如果您运行这几行代码，您会发现`what`将是一个空列表。让我们把那个讨论留到以后。使用`and`逻辑运算符观察以下示例:

看看这些例子，看看它们是否对你有意义。

在 Python 中，这些组合条件遵循*短路规则*。对于`and`操作，它将寻找第一个错误值。如果它找到一个，评估就停止并返回 falsy 值，比如上面代码片段中的`text1`变量。但是，如果找不到，它将返回最后一项，如变量`number1`和`text2`所示。

对于`or`操作，它将寻找第一个真值。如果找到一个，计算停止并返回真值，如变量`number`和`text`所示。但是如果找不到，它仍然会返回最后一项，如变量`what`所示。

# 2.赋值表达式

在 Python 和许多其他编程语言中，表达式和语句是截然不同的概念。通常，表达式表示一个计算结果为 Python 对象的值。我们可以在内置的`eval`方法中使用表达式来产生评估值。相比之下，语句执行的是动作，而不是 Python 对象。语句不能求值。

陈述的一种特殊形式是赋值。具体来说，当我们给一个变量赋值时，它是一个赋值语句，是一个动作。我们正在创建一个新的变量，它并没有计算出一个值。以下是一个微不足道的例子:

无法评估陈述

Python 3.8 中引入的赋值表达式特性允许特殊形式的赋值语句具有表达式的特征。本质上，我们可以将一个对象赋给一个变量(赋值组件)，同时，它求值为一个值(表达式组件)。这个特性涉及到一个新操作符`:=`的使用，这个操作符被一些人称为 walrus 操作符。请注意以下特征:

```
>>> (numbers1 := [1, 2, 3])
[1, 2, 3]
>>> eval("(numbers2 := [2, 3, 4])")
[2, 3, 4]
```

请注意，这个例子没有实际意义，因为我们在顶层使用了赋值表达式，所以出于语法原因需要一对括号。我们将看到一个更实际的例子，不需要括号。

假设我们有一个数字列表，我们想计算保存到列表对象中的累积和。我们可以利用`itertools`模块中的`accumulate`函数，如下所示:

使用 accumulate 计算累积和

还有另一种利用赋值表达式的解决方案。考虑以下解决方案:

```
>>> total = 0
>>> [total := total + x for x in numbers]
[1, 3, 6, 10]
```

如你所知，在列表理解中，我们期望在关键字`for`之前有表达式。赋值语句不能放在那里。但是，赋值表达式是有效的。重要的是，这个表达式允许更新`total`变量，我们可以用它来获得累积和。

# 3.上下文管理:使用

当你研究别人的代码时，你可能会遇到下面的用法。本质上，当我们试图打开一个文件时，我们使用`with`语句，并在文件体中执行必要的操作。

```
with open("some_file.txt") as file:
    text_data = file.read()
```

尽管每当您有与文件相关的操作时，您可能会做同样的事情，但您是否想过我们为什么要这样做？毕竟，它创造了一个额外的缩进层次，有点分散注意力。

这个特性背后的总体概念被称为*上下文管理*。这意味着该语句将创建一个上下文，您可以在其中访问托管资源。在这种情况下，它是一个文件。如果没有上下文管理，我们应该如何处理文件:

文件操作

如您所见，要处理一个文件，我们需要打开和关闭它。关闭文件很重要，因为如果在其他地方使用，更新可能不会保存到文件中。

`with`语句旨在为我们处理这个样板文件。具体来说，文件在退出`with`语句后会自动关闭。请注意以下特征:

文件自动关闭

一旦我们退出`with`语句，打开的文件就会自动关闭。方便吧？

# 结论

在本文中，我们回顾了 Python 的三个特性，这些特性可能会让一些初学者感到困惑。我希望我已经澄清了它们。这里有一个快速回顾:

1.  当我们组合条件时，Python 会进行一次短路评估。当你有一个`and`操作时，它将返回第一个 falsy 值或最后一项。当你有一个`or`操作时，它将返回第一个真值或最后一项。
2.  表达式和语句是截然不同的。赋值语句不产生值。但是，赋值表达式在给变量赋值的同时也对值求值。
3.  当我们需要管理特定的上下文时，我们应该使用`with`语句。最常见的情况是对文件进行操作。当我们退出上下文时，上下文管理器会自动关闭文件。