<html>
<head>
<title>Swift — Creating a Custom View From a XIB (Updated for Swift 5)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift —从XIB创建自定义视图(针对Swift 5进行了更新)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swift-3-creating-a-custom-view-from-a-xib-ecdfe5b3a960?source=collection_archive---------2-----------------------#2017-05-05">https://betterprogramming.pub/swift-3-creating-a-custom-view-from-a-xib-ecdfe5b3a960?source=collection_archive---------2-----------------------#2017-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a210" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Swift从XIB创建自定义视图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cf1766b98908948cb7c6c62a03d56591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CBr9_Hsh69G3QNveiXtig.png"/></div></div></figure><p id="f603" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在XIB文件中创建自定义视图通常是最容易的，在这里您可以可视化、布局和编辑您试图构建的外观。</p><p id="b7bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将这些视图从XIB显示到应用程序的屏幕上比看起来更复杂，因为这种模式在iOS开发中很常见。</p><p id="656a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是一个非常简单的教程，说明了整个过程。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="bae7" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">创建新的单一视图应用程序项目</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/e86d00c27c040eeba7c1e0b63f3c2771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8ocYJmVQWW20UbeNi1MJQ.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="c712" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">2.创建一个XIB文件</h1><p id="848a" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">右键单击项目文件所在的屏幕部分(视图控制器、故事板等)，并选择<code class="fe mv mw mx my b">new file</code>。</p><p id="ce6c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae mz" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode </a>会提示你想要创建哪种文件类型。选择用户界面菜单下的<code class="fe mv mw mx my b">View</code>选项。在下面的弹出窗口中，你将被提示给你的XIB命名——我们称我们的为<code class="fe mv mw mx my b">TestView</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/423d56eec894568e959cd3c45fa874a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjTR1BfDou2PHtDeKd0AyA.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="ee75" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">3.在界面构建器中设计视图</h1><p id="a3a4" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我们插入了一个UILabel，并将其约束在屏幕的中心。你可能想要一些更复杂的东西。</p><p id="905c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还将背景颜色设为粉色，这样当我们最终运行我们的应用程序时更容易看到。您可能需要做出其他设计决策。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/979110954ff50ec83a955f8abbac6a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPaDBLyMgS4Y2iOzdmCzfw.png"/></div></div></figure><p id="79a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想改变你的XIB的形状，点击右上角的<code class="fe mv mw mx my b">attributes inspector </code>，将大小改为<code class="fe mv mw mx my b">freeform</code>。</p><p id="2351" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将让你点击视图，并改变你认为合适的形状。您选择的形状实际上并不重要，您将在本教程结束时看到这一点，但是您可能希望使XIB的形状与您在应用程序中设想的形状大致相同，以帮助布局您的元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/d57ed053064f21ca9d7f3a5e4ebe46c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2zddqtZOo3KyEnN60sLmA.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="3224" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">4.创建自定义UIView文件</h1><p id="2072" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">现在我们有了XIB，我们需要创建自定义的UIView类来控制它。</p><p id="0f57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">右键单击所有文件所在的位置，并选择<code class="fe mv mw mx my b">new file</code>(再次)，但这次选择<code class="fe mv mw mx my b">Source</code>菜单下的<code class="fe mv mw mx my b">Cocoa Touch Class</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/fce9c162c2eef762a39c6d009e46c329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRS2R3g7n3SVPIlNdNVNzg.png"/></div></div></figure><p id="b554" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当系统提示您命名新文件时，确保将其作为<code class="fe mv mw mx my b">UIView</code>的子类。Xcode可能默认为另一个Cocoa类。</p><p id="29ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本教程中，我们也将这个文件命名为<code class="fe mv mw mx my b">TestView</code>，因为它将与我们刚刚创建的<code class="fe mv mw mx my b">TestView</code> XIB相关联。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/37d06be9903f70a46a06f738f2af0561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoqtltbirAiLQDBMA2H2mg.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="520f" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">5.重写两个UIView初始值设定项</h1><p id="1ef6" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">这就是事情变得有点棘手的地方。UIViews可以通过两种方式创建——在界面构建器中(例如故事板或XIB ),或者直接在代码中。</p><p id="f00f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每个创建方法都有一个初始化器，我们需要用我们自己的自定义初始化器来覆盖它们。</p><p id="0e43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你创建你的自定义UIView时，你会看到一个空文件，苹果添加了一些注释，暗示我们将要做什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/41728fcb95347a9b046ba95fee587856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*mKRjtQzv5wymIXijXW6eTA.png"/></div></figure><p id="ecf3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">删除注释，并键入以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c5403d7011590e9065f9cdabce3709a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*cJiT4ibDrTQ5MVo-pnWckg.png"/></div></figure><p id="8abc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们重写了两个UIView初始化器，并调用了我们的名为<code class="fe mv mw mx my b">commonInit</code>的初始化器(你可以随便叫它什么)。不幸的是，我们的初始化器还没有做任何事情。我们一会儿就到了。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="9b7a" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">6.将UIView添加为XIB文件的所有者</h1><p id="3589" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我们快到了。我们现在有了一个XIB文件和一个自定义UIView。我们只需要把两者联系起来。</p><p id="5426" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击回到你的XIB文件，并点击占位符部分下的<code class="fe mv mw mx my b">File’s Owner</code>选择。然后在屏幕右侧的<code class="fe mv mw mx my b">Identity Inspector</code>中，输入UIView文件的名称(<code class="fe mv mw mx my b">TestView</code>)作为<code class="fe mv mw mx my b">Class</code>。这应该会自动完成——如果没有，您可能做错了什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/17dece9bc1b76660978d6a4b458d6207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh8ipXTaR_NCEf2wQz36GA.png"/></div></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="4f4a" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">7.将整个视图作为IB插座添加到UIView文件中</h1><p id="2a31" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">既然您已经将自定义UIView添加为文件的所有者，那么您应该能够点击右上角的<code class="fe mv mw mx my b">assistant editor</code>按钮，将视图与您的XIB并排加载。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/58b3d9bfc4997e8083bdf52e79fc3275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3V5TM37xkuf_a7R2wL1Mw.png"/></div></div></figure><p id="6a9b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mv mw mx my b">Ctrl-drag</code>中的<em class="ni">整个视图</em>，作为视图文件的出口。你想怎么叫都行，但是叫<code class="fe mv mw mx my b">contentView</code>是个好习惯。</p><p id="1eac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还可以将任何其他元素作为IBOutlets拖进来。在这种情况下，我们所拥有的只是我们的标签，所以我们也把它拖了进来。我们的视图文件现在看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/52f9a5e742b225c957fee7e4fcb1a9cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*DGJDYJbtWRdjsqRZMbLl4Q.png"/></div></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="f367" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">8.<strong class="ak">在通用初始化器中加载XIB</strong></h1><p id="6839" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在您的<code class="fe mv mw mx my b">commonInit</code>中键入以下四行代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/cd2a4bea6dd5c74727079cdd03badad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*QZWd4CneZ97UrIjN-7kLNQ.png"/></div></div></figure><p id="9aa4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第一行中，我们根据名称从内存中加载XIB。如果您将XIB文件命名为不同的名称，您需要更改<code class="fe mv mw mx my b">loadNibNamed</code>函数中的<code class="fe mv mw mx my b">TestView</code>字符串。</p><p id="038b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下一行中，我们添加了内容视图，我们将它作为一个出口，作为我们创建的视图的子视图。</p><p id="e56b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在接下来的两行中，我们定位了内容视图以占据整个视图的外观。有无数种方法可以实现这一点，这可能不是最好的模式，但它快速简单，并且只有两行代码。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="dc66" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">9.<strong class="ak">使用您的视图</strong></h1><p id="651e" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我们完了！现在我们有了一个自定义视图，由一个XIB文件制成，可以在整个项目中使用。让我们看看那是什么样子。</p><p id="7f7b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击你的故事板文件，并在UIView中拖动。点击右上角的<code class="fe mv mw mx my b">identity inspector</code>，将类更改为<code class="fe mv mw mx my b">TestView</code>(或者您命名的UIView)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/e0c51ec4a695d7f019ea52f708f60760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kyC8D2SL_UYwyDy-01kkQ.png"/></div></div></figure><p id="0442" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以把它放在屏幕上任何你想放的地方。我们将它限制在屏幕的中心，并让它占据50%的宽度和50%的高度——只是为了演示的目的。</p><p id="51b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">再次打开你的助理编辑。这一次它应该打开到您的视图控制器文件。拖动<code class="fe mv mw mx my b">TestView</code>作为一个IBOutlet。您的视图控制器现在应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/6b5ec4b9afe1f471ce70207058329bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Bp7cSayFox-tIzk-dREkw.png"/></div></div></figure><p id="e1c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后一件事—还记得我们视图上的标签吗？让我们改一下课文。我要用我以前老板最喜欢的问候语:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/199217bd602bd1421d50b364662b1194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Afe0lrEUxZy5LQJZ5MxmCQ.png"/></div></div></figure><p id="7098" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就是这样。让我们运行项目！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/928bbed7d1f9b5cb000da311d24f127d.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*4ZbJ3Wt_oePPIIBpwh98vg.png"/></div></figure><p id="3916" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是你要的——一个模拟NBA前台生活的应用程序。</p><p id="f341" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还记得你建XIB的时候，我说过大小并不重要吗？这就是为什么。XIB将占据这个视图的大小——无论它是大是小，无论你在故事板(或代码)中把它做成什么形状。真正重要的是你如何约束XIB中的所有元素。</p><p id="7155" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以在整个应用程序中使用此视图。如果你想回去重新设计它的外观，你只需在你的XIB文件中更改它，所有这些更改将在整个应用程序中流动。</p><p id="f21f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有问题或意见吗？让我知道！对于任何对投资感兴趣的人，请查看<a class="ae mz" href="https://apps.apple.com/us/app/stock-genius/id1237897006" rel="noopener ugc nofollow" target="_blank">股票天才</a>，这是我开发的一个全新的免费股票跟踪应用程序，其特点是直接从交易所获得实时价格(以及许多从xib构建的自定义视图！).</p></div></div>    
</body>
</html>