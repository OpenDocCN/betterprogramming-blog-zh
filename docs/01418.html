<html>
<head>
<title>How To Add Parallax Scrolling to Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React应用中添加视差滚动</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-add-parallax-scrolling-for-your-vue-app-626df9789f37?source=collection_archive---------2-----------------------#2019-09-08">https://betterprogramming.pub/how-to-add-parallax-scrolling-for-your-vue-app-626df9789f37?source=collection_archive---------2-----------------------#2019-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d967" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Pixabay API创建应用程序的分步教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9b8a10c5aca08bfa2a405e7079ae43ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1bNEZ-tIrQhXaYpGdP5ow.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@rohittandon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Rohit Tandon </a>在<a class="ae ky" href="https://unsplash.com/search/photos/scroll?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="95a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">视差滚动的效果是背景图像比前景中的元素滚动得慢，从而产生页面深度的错觉。</p><p id="323d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网站通常在信息页面中使用这种方式，在这种页面中，一些文本在前景中，一个图像在背景中，滚动得更慢，为用户创造更有趣的体验。</p><p id="a8dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.mockplus.com/blog/post/parallax-scrolling-websites" rel="noopener ugc nofollow" target="_blank">本页</a>有一些视差滚动的网页示例。</p><p id="dfad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了React，用<a class="ae ky" href="https://www.npmjs.com/package/react-parallax" rel="noopener ugc nofollow" target="_blank"> react-parallax </a>库创建视差滚动效果就变得又快又简单。</p><p id="fc40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将制作一个应用程序，在背景中显示图像列表，在前景中显示标签文本。图像将由Pixabay API提供。您可以在<a class="ae ky" href="https://pixabay.com/api/docs/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>注册一个API密钥。</p><p id="6cc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了开始构建应用程序，我们通过运行<a class="ae ky" href="https://create-react-app.dev/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> Create React App </a>来创建应用程序。</p><p id="1176" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行<code class="fe lv lw lx ly b">npx create-react-app scrolling-app</code>构建app的骨架。一旦运行完成，我们安装一些软件包。</p><p id="b308" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要安装<a class="ae ky" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> axios </a>来从Pixabay API获取图像，<a class="ae ky" href="https://react-bootstrap.github.io/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>用于样式化，<a class="ae ky" href="https://reacttraining.com/react-router/" rel="noopener ugc nofollow" target="_blank"> React Router </a>用于将URL路由到我们创建的页面，以及react-parallax来创建视差滚动效果。</p><p id="6944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们编写视差滚动应用程序的代码。在<code class="fe lv lw lx ly b">App.js</code>中，我们用以下代码替换现有代码:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="d8e2" class="md me it ly b gy mf mg l mh mi">import React from "react";<br/>import TopBar from "./TopBar";<br/>import { Router, Route, Link } from "react-router-dom";<br/>import { createBrowserHistory as createHistory } from "history";<br/>import HomePage from "./HomePage";<br/>import "./App.css";<br/>const history = createHistory();</span><span id="24b6" class="md me it ly b gy mj mg l mh mi">function App() {<br/>  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;Router history={history}&gt;<br/>        &lt;TopBar /&gt;<br/>        &lt;Route path="/" exact component={HomePage} /&gt;<br/>      &lt;/Router&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="d1a3" class="md me it ly b gy mj mg l mh mi">export default App;</span></pre><p id="c720" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们添加了一个顶部的酒吧，我们将创建和一个路由到主页与反应路由器。</p><p id="a3df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们创建视差滚动应用程序的主页。在<code class="fe lv lw lx ly b">src</code>文件夹中创建一个名为<code class="fe lv lw lx ly b">HomePage.js</code>的文件，并添加以下内容:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="50be" class="md me it ly b gy mf mg l mh mi">import React, { useState, useEffect } from "react";<br/>import { Parallax, Background } from "react-parallax";<br/>import "./HomePage.css";<br/>import { getPhotos } from "./requests";</span><span id="b5f3" class="md me it ly b gy mj mg l mh mi">const insideStyles = {<br/>  background: "transparent",<br/>  padding: 20,<br/>  position: "absolute",<br/>  top: "50%",<br/>  left: "50%",<br/>  transform: "translate(-50%,-50%)",<br/>};</span><span id="477b" class="md me it ly b gy mj mg l mh mi">function HomePage() {<br/>  const [initialized, setInitialized] = useState(false);<br/>  const [images, setImages] = useState([]);<br/>  const [layers, setLayers] = useState([]);</span><span id="4ec5" class="md me it ly b gy mj mg l mh mi">  const loadImages = async () =&gt; {<br/>    const response = await getPhotos();<br/>    setImages(response.data.hits);<br/>  };</span><span id="7a54" class="md me it ly b gy mj mg l mh mi">  useEffect(() =&gt; {<br/>    if (!initialized) {<br/>      loadImages();<br/>      setInitialized(true);<br/>    }<br/>  });<br/>  return (<br/>    &lt;div className="home-page"&gt;<br/>      {images.map((img, i) =&gt; {<br/>        return (<br/>          &lt;&gt;<br/>            &lt;Parallax<br/>              blur={10}<br/>              bgImage={img.userImageURL}<br/>              bgImageAlt={img.tags}<br/>              strength={600}<br/>              renderLayer={percentage =&gt; (<br/>                &lt;div&gt;<br/>                  &lt;div<br/>                    style={{<br/>                      position: "absolute",<br/>                      background: `white`,<br/>                      left: "50%",<br/>                      top: "50%",<br/>                      borderRadius: "50%",<br/>                      transform: "translate(-50%,-50%)",<br/>                      width: percentage * 500,<br/>                      height: percentage * 500,<br/>                    }}<br/>                  /&gt;<br/>                &lt;/div&gt;<br/>              )}<br/>            &gt;<br/>              &lt;div style={{ height: 500 }}&gt;<br/>                &lt;div style={insideStyles}&gt;{img.tags}&lt;/div&gt;<br/>              &lt;/div&gt;<br/>            &lt;/Parallax&gt;<br/>          &lt;/&gt;<br/>        );<br/>      })}<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="98e7" class="md me it ly b gy mj mg l mh mi">export default HomePage;</span></pre><p id="2bbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个页面中，当页面第一次加载时，我们用函数<code class="fe lv lw lx ly b">loadImages</code>中的Pixabay API加载图像。我们检查页面是否是<code class="fe lv lw lx ly b">initialized</code>。如果没有，我们加载图像。</p><p id="1acd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦图像被加载，我们通过将图像数据映射到react-parallax提供的<code class="fe lv lw lx ly b">Parallax</code>组件来显示它们。</p><p id="5afd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">strength</code>属性指定了被转换以创建视差滚动的像素数。数字越大，前景和背景之间的滚动速度差异就越明显。</p><p id="d57e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe lv lw lx ly b">Parallax</code>组件中，我们指定想要显示的内容。我们指定显示来自Pixabay API的图像附带的标记文本。</p><p id="631d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">renderLayer</code>道具让我们显示前景和背景之间的元素。我们可以通过使用功能调整尺寸中的<code class="fe lv lw lx ly b">percentage</code>参数来激活此处定义的元素。例如，在此页面上，我们用<code class="fe lv lw lx ly b">percentage</code>调整<code class="fe lv lw lx ly b">width</code>和<code class="fe lv lw lx ly b">height</code>。</p><p id="77cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">bgImage</code>是我们图像的URL，<code class="fe lv lw lx ly b">bgImageAlt</code>是背景图像的<code class="fe lv lw lx ly b">alt</code>属性。<code class="fe lv lw lx ly b">blur</code>属性指定背景图像的模糊程度。</p><p id="45dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们创建从Pixabay API获取图像的文件。在<code class="fe lv lw lx ly b">src</code>文件夹中创建一个名为<code class="fe lv lw lx ly b">requests.js</code>的文件，并添加以下代码:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="f7f8" class="md me it ly b gy mf mg l mh mi">const axios = require("axios");<br/>const apiUrl = "<a class="ae ky" href="https://pixabay.com/api" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/api</a>";</span><span id="49c8" class="md me it ly b gy mj mg l mh mi">export const getPhotos = () =&gt;<br/>  axios.get(`${apiUrl}/?key=${[process.env.REACT_APP_APIKEY]}`);</span></pre><p id="3359" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API键在项目根文件夹的<code class="fe lv lw lx ly b">.env</code>文件中定义。环境变量的关键字是<code class="fe lv lw lx ly b">REACT_APP_APIKEY</code>。</p><p id="7963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们为图像创建一个顶栏。在<code class="fe lv lw lx ly b">src</code>文件夹中创建一个名为<code class="fe lv lw lx ly b">TopBar.js</code>的文件，并添加:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="f928" class="md me it ly b gy mf mg l mh mi">import React from "react";<br/>import Navbar from "react-bootstrap/Navbar";<br/>import Nav from "react-bootstrap/Nav";<br/>import "./TopBar.css";<br/>import { withRouter } from "react-router-dom";</span><span id="3ee5" class="md me it ly b gy mj mg l mh mi">function TopBar({ location }) {<br/>  const { pathname } = location;</span><span id="7a8c" class="md me it ly b gy mj mg l mh mi">  return (<br/>    &lt;Navbar bg="primary" expand="lg" variant="dark"&gt;<br/>      &lt;Navbar.Brand href="#home"&gt;Scrolling App&lt;/Navbar.Brand&gt;<br/>      &lt;Navbar.Toggle aria-controls="basic-navbar-nav" /&gt;<br/>      &lt;Navbar.Collapse id="basic-navbar-nav"&gt;<br/>        &lt;Nav className="mr-auto"&gt;<br/>          &lt;Nav.Link href="/" active={pathname == "/"}&gt;<br/>            Home<br/>          &lt;/Nav.Link&gt;<br/>        &lt;/Nav&gt;<br/>      &lt;/Navbar.Collapse&gt;<br/>    &lt;/Navbar&gt;<br/>  );<br/>}</span><span id="d1a7" class="md me it ly b gy mj mg l mh mi">export default withRouter(TopBar);</span></pre><p id="d6ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们通过使用React Bootstrap中的<code class="fe lv lw lx ly b">Navbar</code>创建顶栏，并用<code class="fe lv lw lx ly b">withRouter</code>函数包装组件，这样我们就可以将<code class="fe lv lw lx ly b">location</code>属性传递给组件。</p><p id="60ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这让我们通过检查<code class="fe lv lw lx ly b">location</code>属性的<code class="fe lv lw lx ly b">pathname</code>属性来检查用户所在页面的URL，让我们动态设置<code class="fe lv lw lx ly b">Nav.Link</code>的<code class="fe lv lw lx ly b">active</code>属性。</p><p id="42ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在<code class="fe lv lw lx ly b">index.html</code>中，我们用以下代码替换现有代码:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="9de6" class="md me it ly b gy mf mg l mh mi">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8" /&gt;<br/>    &lt;link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;meta name="theme-color" content="#000000" /&gt;<br/>    &lt;meta<br/>      name="description"<br/>      content="Web site created using create-react-app"<br/>    /&gt;<br/>    &lt;link rel="apple-touch-icon" href="logo192.png" /&gt;<br/>    &lt;!--<br/>      manifest.json provides metadata used when your web app is installed on a<br/>      user's mobile device or desktop. See <a class="ae ky" href="https://developers.google.com/web/fundamentals/web-app-manifest/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/web/fundamentals/web-app-manifest/</a><br/>    --&gt;<br/>    &lt;link rel="manifest" href="%PUBLIC_URL%/manifest.json" /&gt;<br/>    &lt;!--<br/>      Notice the use of %PUBLIC_URL% in the tags above.<br/>      It will be replaced with the URL of the `public` folder during the build.<br/>      Only files inside the `public` folder can be referenced from the HTML.</span><span id="9647" class="md me it ly b gy mj mg l mh mi">Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will<br/>      work correctly both with client-side routing and a non-root public URL.<br/>      Learn how to configure a non-root public URL by running `npm run build`.<br/>    --&gt;<br/>    &lt;title&gt;Parallax App&lt;/title&gt;<br/>    &lt;link<br/>      rel="stylesheet"<br/>      href="<a class="ae ky" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css</a>"<br/>      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"<br/>      crossorigin="anonymous"<br/>    /&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;noscript&gt;You need to enable JavaScript to run this app.&lt;/noscript&gt;<br/>    &lt;div id="root"&gt;&lt;/div&gt;<br/>    &lt;!--<br/>      This HTML file is a template.<br/>      If you open it directly in the browser, you will see an empty page.</span><span id="f953" class="md me it ly b gy mj mg l mh mi">You can add webfonts, meta tags, or analytics to this file.<br/>      The build step will place the bundled scripts into the &lt;body&gt; tag.</span><span id="b4a1" class="md me it ly b gy mj mg l mh mi">To begin the development, run `npm start` or `yarn start`.<br/>      To create a production bundle, use `npm run build` or `yarn build`.<br/>    --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="fb71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们添加了引导CSS并改变了这个文件的标题。</p><p id="0a5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/dc929d4e6b145dd76ce49f9553129de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-ngHTRIocgmjYslPEQbew.png"/></div></div></figure></div></div>    
</body>
</html>