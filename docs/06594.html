<html>
<head>
<title>Everything About XMLHttpRequest in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中关于XMLHttpRequest的一切</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/everything-about-xmlhttprequest-in-javascript-8adacc98a209?source=collection_archive---------1-----------------------#2020-10-16">https://betterprogramming.pub/everything-about-xmlhttprequest-in-javascript-8adacc98a209?source=collection_archive---------1-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a2be" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用XMLHttpRequests发出请求</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6d1bca7eed5d3196dcd9b49e160fad25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bU9zxOus8NB2hSXhVlejrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="6f4f" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">什么是XMLHttpRequest ( <code class="fe lu lv lw lx b">XHR</code>)？</h1><ul class=""><li id="093c" class="ly lz iq ma b mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">XMLHttpRequest</code>是一个内置的JavaScript对象，用于在服务器和客户端之间传输数据，无需刷新整个页面。</li><li id="8367" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">但是使用<code class="fe lu lv lw lx b">XHR</code>，我们可以根据用户的动作更新页面。</li><li id="6b05" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">例如，一个无限的新闻提要。(一旦用户向下滚动到页面的末尾，我们就请求获取下一篇文章并将数据追加到页面)。</li><li id="bc30" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">使用<code class="fe lu lv lw lx b">XHR</code>，我们可以发出同步和异步请求。</li></ul></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="9fe2" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">使用XMLHttpRequest发出请求的步骤</h1><ul class=""><li id="2071" class="ly lz iq ma b mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">创建一个<code class="fe lu lv lw lx b">XMLHttpRequest</code>对象。</li><li id="32b4" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">使用请求详细信息配置对象。</li><li id="83b8" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">发送请求。</li></ul><h2 id="de37" class="mv ld iq bd le mw mx dn li my mz dp lm mf na nb lo mh nc nd lq mj ne nf ls ng bi translated">1.创建一个XMLHttpRequest对象</h2><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="1ee2" class="mv ld iq lx b gy nl nm l nn no">let request = new <!-- -->XMLHttpRequest();</span></pre><h2 id="b81f" class="mv ld iq bd le mw mx dn li my mz dp lm mf na nb lo mh nc nd lq mj ne nf ls ng bi translated">2.使用请求详细信息配置对象</h2><p id="019c" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated">为了配置请求，我们可以使用<code class="fe lu lv lw lx b">XMLHttpRequest</code>对象的<code class="fe lu lv lw lx b">open</code>方法。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="c2e3" class="mv ld iq lx b gy nl nm l nn no">request.open(method, URL, [async, user, password])</span></pre><ul class=""><li id="c033" class="ly lz iq ma b mb oc md od mf oe mh of mj og ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">method</code> — <code class="fe lu lv lw lx b">"GET"</code>或<code class="fe lu lv lw lx b">"POST"</code></li><li id="516f" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">URL</code> —请求的URL字符串。也可以是一个<a class="ae oh" href="https://javascript.info/url" rel="noopener ugc nofollow" target="_blank"> URL </a>对象。</li></ul><p id="ce1c" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated"><strong class="ma ir">可选参数</strong></p><ul class=""><li id="56c1" class="ly lz iq ma b mb oc md od mf oe mh of mj og ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">async</code> —默认为<code class="fe lu lv lw lx b">true</code>。如果我们将其设置为<code class="fe lu lv lw lx b">false</code>，那么它将发送一个<code class="fe lu lv lw lx b">synchronous</code>请求。</li><li id="2fa6" class="ly lz iq ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">user</code>、<code class="fe lu lv lw lx b">password</code> —基本HTTP认证的登录和密码</li></ul><h2 id="e734" class="mv ld iq bd le mw mx dn li my mz dp lm mf na nb lo mh nc nd lq mj ne nf ls ng bi translated">3.发送请求</h2><p id="6f2a" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated"><code class="fe lu lv lw lx b">send</code>方法可用于向服务器发送请求。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="4db6" class="mv ld iq lx b gy nl nm l nn no">request.send();</span></pre><p id="2f37" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">一旦请求被发送到服务器，我们可以使用三个事件来跟踪请求。</p><ul class=""><li id="e7e3" class="ly lz iq ma b mb oc md od mf oe mh of mj og ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">load</code>—<code class="fe lu lv lw lx b">load</code>事件在<code class="fe lu lv lw lx b">XMLHttpRequest</code>成功完成(即使HTTP状态为400或500)且响应完全下载时触发。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="0952" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated"><code class="fe lu lv lw lx b">status</code> — <a class="ae oh" href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" rel="noopener ugc nofollow" target="_blank"> HTTP状态码</a> <code class="fe lu lv lw lx b">200</code>、<code class="fe lu lv lw lx b">404</code>、<code class="fe lu lv lw lx b">403</code>等等</p><p id="3e93" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated"><code class="fe lu lv lw lx b">statusText</code> — <a class="ae oh" href="https://www.w3schools.com/tags/ref_httpmessages.asp" rel="noopener ugc nofollow" target="_blank"> HTTP状态消息</a> <code class="fe lu lv lw lx b">200 → OK</code>、<code class="fe lu lv lw lx b">404 → Not Found</code>等等</p><p id="4bc1" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated"><code class="fe lu lv lw lx b">response</code> —对请求的响应</p><ul class=""><li id="2b0a" class="ly lz iq ma b mb oc md od mf oe mh of mj og ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">error</code> —请求无法发出时。例如网络故障、跨源访问</li></ul><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="3659" class="mv ld iq lx b gy nl nm l nn no">xhr.onerror = function() { </span><span id="69b5" class="mv ld iq lx b gy on nm l nn no">    console.log(`Unable to make request`); </span><span id="fbe5" class="mv ld iq lx b gy on nm l nn no">};</span></pre><ul class=""><li id="23d0" class="ly lz iq ma b mb oc md od mf oe mh of mj og ml mm mn mo mp bi translated"><code class="fe lu lv lw lx b">progress</code> —定期触发，直到响应完全下载。使用这个事件，我们可以跟踪从服务器下载了多少数据。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="989a" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">示例:</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="9fb3" class="mv ld iq lx b gy nl nm l nn no">let url = "<a class="ae oh" href="https://google.com/search?q=javascriptjeep" rel="noopener ugc nofollow" target="_blank">https://medium.com/search?q=javascriptjeep</a>";</span><span id="293a" class="mv ld iq lx b gy on nm l nn no">let request = new <!-- -->XMLHttpRequest();</span><span id="381d" class="mv ld iq lx b gy on nm l nn no">request.open("GET", url);</span><span id="eb4b" class="mv ld iq lx b gy on nm l nn no">request.onload = function(){<br/>   console.log(request.response);<br/>}</span><span id="5a20" class="mv ld iq lx b gy on nm l nn no">request.send();</span></pre><p id="415f" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">在执行上述操作时，您可以看到Medium将返回用户搜索网页作为响应。</p><p id="728e" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">我们可以在<code class="fe lu lv lw lx b">XMLHttpRequest</code>对象中设置请求超时。如果请求在给定的时间内没有成功，请求将被取消，一个<code class="fe lu lv lw lx b">timeout</code>事件将被触发。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="b587" class="mv ld iq lx b gy nl nm l nn no">xhr.timeout = 10000; //time in milliseconds , actually 10s </span></pre><p id="06b6" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">在上面的例子中，我们也可以传递一个<code class="fe lu lv lw lx b">URL</code>对象，而不是一个<code class="fe lu lv lw lx b">URL</code>字符串。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="0131" class="mv ld iq lx b gy nl nm l nn no">let url = new URL('https://medium.com/search');</span><span id="fa13" class="mv ld iq lx b gy on nm l nn no">url.searchParams.set('q', 'JavaScript Jeep');</span><span id="3d80" class="mv ld iq lx b gy on nm l nn no">request.open('GET', url);</span><span id="9415" class="mv ld iq lx b gy on nm l nn no">request.send();</span><span id="1ec2" class="mv ld iq lx b gy on nm l nn no">request.onload = function(){<br/>   console.log(request.response);<br/>}</span></pre><p id="234b" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">在执行上面的响应时，默认情况下，我们将获得字符串形式的响应，但是我们可以通过设置<code class="fe lu lv lw lx b">request</code>对象的<code class="fe lu lv lw lx b">responseType</code>来指定我们期望的响应类型。基于<code class="fe lu lv lw lx b">responseType</code>，浏览器会自动解析数据并显示给我们。<code class="fe lu lv lw lx b">responseType</code>的可用选项如下:</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="bf8a" class="mv ld iq lx b gy nl nm l nn no">1. text → get as string</span><span id="19ce" class="mv ld iq lx b gy on nm l nn no">2. arraybuffer → get as ArrayBuffer</span><span id="4647" class="mv ld iq lx b gy on nm l nn no">3. blob → get as Blob</span><span id="01e4" class="mv ld iq lx b gy on nm l nn no">4. document → get as XML document</span><span id="74c9" class="mv ld iq lx b gy on nm l nn no">5. json → get as JSON</span></pre><p id="1245" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">如果我们不指定<code class="fe lu lv lw lx b">responseType</code>，默认情况下我们将得到响应<code class="fe lu lv lw lx b">string</code>。</p><p id="84e6" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">在我们的例子中，我们得到一个<code class="fe lu lv lw lx b">HTML</code>文档作为响应，所以我们需要将<code class="fe lu lv lw lx b">responseType</code>设置为<code class="fe lu lv lw lx b">document</code>。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="f574" class="mv ld iq lx b gy nl nm l nn no">let url = "<a class="ae oh" href="https://google.com/search?q=javascriptjeep" rel="noopener ugc nofollow" target="_blank">https://medium.com/search?q=javascriptjeep</a>";</span><span id="8dd6" class="mv ld iq lx b gy on nm l nn no">let request = new <!-- -->XMLHttpRequest();</span><span id="0a33" class="mv ld iq lx b gy on nm l nn no">request.open("GET", url);</span><span id="d26a" class="mv ld iq lx b gy on nm l nn no">request.onload = function(){<br/>   console.log(request.response);<br/>}</span><span id="ea17" class="mv ld iq lx b gy on nm l nn no">request.responseType = "document";</span><span id="4031" class="mv ld iq lx b gy on nm l nn no">request.send();</span></pre><p id="dd94" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">现在，您可以在控制台中看到，响应显示为一个HTML对象。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="1caa" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">就绪状态</h1><p id="9369" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated">我们可以使用<code class="fe lu lv lw lx b">readyState</code>属性来检测<code class="fe lu lv lw lx b">XMLHttpRequest</code>对象的当前状态。另外，一旦<code class="fe lu lv lw lx b">XMLHttpRequest</code>对象的状态改变，就会触发<code class="fe lu lv lw lx b">readystatechange</code>事件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/2cf09f703b4467a4c81565a845809610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9C1b5jUKidtWR7xAUKJ8w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:<a class="ae oh" href="https://xhr.spec.whatwg.org/#states" rel="noopener ugc nofollow" target="_blank"> WHATWG社区</a></p></figure><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="a082" class="mv ld iq lx b gy nl nm l nn no">0  → Object created</span><span id="3ee9" class="mv ld iq lx b gy on nm l nn no">1  → Open method called </span><span id="37ea" class="mv ld iq lx b gy on nm l nn no">2  → Response header received</span><span id="9899" class="mv ld iq lx b gy on nm l nn no">3  → Reponse is loading </span><span id="017e" class="mv ld iq lx b gy on nm l nn no">4  → Request is complete </span></pre><p id="fa2b" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="a1d0" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">如果我们需要中止已经发送的请求，我们可以使用<code class="fe lu lv lw lx b">abort</code>方法。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="208a" class="mv ld iq lx b gy nl nm l nn no">request.abort();</span></pre></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="43bb" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated"><strong class="ak">向请求添加标题</strong></h1><p id="ff31" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated">我们可以使用<code class="fe lu lv lw lx b">setRequestHeader</code> <strong class="ma ir"> </strong>方法来为请求设置自定义头。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="6353" class="mv ld iq lx b gy nl nm l nn no">// syntax</span><span id="30e0" class="mv ld iq lx b gy on nm l nn no">request.setRequestHeader( name , value);</span></pre><p id="438e" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">示例:</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="89d8" class="mv ld iq lx b gy nl nm l nn no">let request = new <!-- -->XMLHttpRequest();</span><span id="daeb" class="mv ld iq lx b gy on nm l nn no">request.open("GET", url);</span><span id="8887" class="mv ld iq lx b gy on nm l nn no">request.setRequestHeader('Content-Type', 'application/json');</span><span id="4141" class="mv ld iq lx b gy on nm l nn no">request.setRequestHeader('user-token', 123);</span></pre><p id="6804" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">我们不能在调用<code class="fe lu lv lw lx b">open</code>方法之前调用<code class="fe lu lv lw lx b">setRequestHeader</code>方法。</p><p id="1a7b" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">此外，一旦设置了标题，我们就不能删除它。如果我们调用<code class="fe lu lv lw lx b">setRequestHeader</code>，相同的<code class="fe lu lv lw lx b">name</code>，那么值将被追加。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="f50a" class="mv ld iq lx b gy nl nm l nn no">request.setRequestHeader('test', 123);</span><span id="39d4" class="mv ld iq lx b gy on nm l nn no">request.setRequestHeader('test', 321);</span><span id="9547" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">// header is test:123, 321</strong></span></pre><p id="2f6f" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">我们还可以使用两种方法获得响应的头:<code class="fe lu lv lw lx b">getResponseHeader(name)</code>和<code class="fe lu lv lw lx b">getAllResponseHeaders()</code>。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="ca49" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated"><strong class="ak">发送</strong> <code class="fe lu lv lw lx b"><strong class="ak">POST</strong></code> <strong class="ak">请求带数据</strong></h1><p id="0ed6" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated">如果我们需要向服务器发送一个带有一些数据的<code class="fe lu lv lw lx b">POST</code>请求，比如图像或表单数据，那么我们可以将数据作为<code class="fe lu lv lw lx b">XMLHttpRequest</code>的<code class="fe lu lv lw lx b">send</code>方法的参数发送。</p><p id="6507" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">假设我们有一个表单。我们将从那里创建表单数据。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="8349" class="mv ld iq lx b gy nl nm l nn no">let data = new FormData(document.forms[0]);</span><span id="ccdf" class="mv ld iq lx b gy on nm l nn no">let request = new XMLHttpRequest();   </span><span id="b77e" class="mv ld iq lx b gy on nm l nn no">request.open("POST", "http:myserver.com/getResult");   </span><span id="0505" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">request.send(data);    </strong></span></pre><p id="fc1b" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">使用<code class="fe lu lv lw lx b">XHR</code>上传图像:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="2c08" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">为了跟踪上传进度，我们可以使用在<code class="fe lu lv lw lx b">XMLHttpRequest</code>的<code class="fe lu lv lw lx b">upload</code>对象中可用的多个事件:</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="baf1" class="mv ld iq lx b gy nl nm l nn no"><strong class="lx ir">loadstart</strong> → upload started.</span><span id="03c8" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">progress</strong> → triggers periodically during the upload.</span><span id="1601" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">abort</strong> → upload aborted.</span><span id="c573" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">error</strong> → non-HTTP error.</span><span id="00eb" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">load</strong> → upload finished successfully.</span><span id="de7b" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">timeout</strong> → upload timed out (if timeout property is set)</span><span id="c831" class="mv ld iq lx b gy on nm l nn no"><strong class="lx ir">loadend</strong> →  upload finished with either success or error</span></pre><p id="5d38" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">现在，我们可以将上述事件应用于我们的图像上传请求。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><h1 id="b8c0" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">发送CORS请求</h1><p id="818f" class="pw-post-body-paragraph np nq iq ma b mb mc jr nr md me ju ns mf nt nu nv mh nw nx ny mj nz oa ob ml ij bi translated">使用<code class="fe lu lv lw lx b">XMLHttpRequest</code>，我们可以进行跨来源请求。为此，我们需要将<code class="fe lu lv lw lx b">withCredentials</code>设置为<code class="fe lu lv lw lx b">false</code>。</p><pre class="kg kh ki kj gt nh lx ni nj aw nk bi"><span id="237d" class="mv ld iq lx b gy nl nm l nn no">let xhr = new XMLHttpRequest();<br/>xhr.withCredentials = true;</span><span id="224a" class="mv ld iq lx b gy on nm l nn no">let url = "<a class="ae oh" href="https://google.com/search?q=javascriptjeep" rel="noopener ugc nofollow" target="_blank">https://otherorigin.com/search?q=javascriptjeep</a>";</span><span id="02c5" class="mv ld iq lx b gy on nm l nn no">xhr.open("GET", url);</span><span id="4242" class="mv ld iq lx b gy on nm l nn no">xhr.send();</span></pre><p id="6c61" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">感谢阅读。</p><div class="op oq gp gr or os"><a href="https://medium.com/@jagathishsaravanan/why-should-you-donate-me-30a6f5d112b8" rel="noopener follow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd ir gy z fp ox fr fs oy fu fw ip bi translated">你为什么要捐赠我</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">请求为y羽毛球训练捐款。</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg kp os"/></div></div></a></div><p id="4ebf" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">可以在<a class="ae oh" href="https://paypal.me/jagathishSaravanan?locale.x=en_GB" rel="noopener ugc nofollow" target="_blank"> PayPal </a>里捐我。</p><p id="6dcf" class="pw-post-body-paragraph np nq iq ma b mb oc jr nr md od ju ns mf oi nu nv mh oj nx ny mj ok oa ob ml ij bi translated">关注我<a class="ph pi ep" href="https://medium.com/u/f9ffc26e7e69?source=post_page-----8adacc98a209--------------------------------" rel="noopener" target="_blank"> Javascript Jeep🚙💨</a>。</p></div></div>    
</body>
</html>