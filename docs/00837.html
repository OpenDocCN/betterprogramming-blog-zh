<html>
<head>
<title>You Don’t Even Need React-Redux and Redux Thunk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你甚至不需要React-Redux和Redux Thunk</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/you-dont-even-need-react-redux-and-redux-thunk-d9dce6c0a89f?source=collection_archive---------2-----------------------#2019-07-19">https://betterprogramming.pub/you-dont-even-need-react-redux-and-redux-thunk-d9dce6c0a89f?source=collection_archive---------2-----------------------#2019-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e9d7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用上下文在React应用程序中使用Redux，而不使用React-Redux或Thunk</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/507ef58b077b30ad16e7704c01061aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5MzKDbKV6JKdOvn8OoY3_g.jpeg"/></div></div></figure><p id="024e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你使用<a class="ae lq" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>和<a class="ae lq" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>时，每个人都会想到<a class="ae lq" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank"> React-Redux </a>(将Redux与React应用程序连接)和<a class="ae lq" href="http://redux-thunk" rel="noopener ugc nofollow" target="_blank"> Redux Thunk </a>。</p><p id="0864" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Redux Thunk处理异步动作，有些使用sagas，但是现在让我们忽略它。在这篇文章中，我将只关注Thunk。但是，没有React-Redux，如何使用React app中的Redux商店呢？</p><p id="ab28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">答案是语境。</p><p id="ed98" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您不熟悉上下文，请查看一下<a class="ae lq" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React文档</a>。</p><p id="f200" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在向您展示如何使用上下文将Redux连接到React应用程序之前，我将向您展示这样做的好处。</p><ol class=""><li id="9886" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated">不需要在应用程序中安装额外的库。</li><li id="e57c" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">让你的组件代码更短，更易读。</li><li id="0558" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">减少React-Redux的额外学习曲线。</li></ol><p id="abc0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一是显而易见的，我不认为我需要解释。</p><p id="d0db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第二:这是一个使用React-Redux的组件和一个不使用React-Redux的组件的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mf"><img src="../Images/fb80e9a75e82cb2e106db402cba096e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9cbBAzDCEpezKfQI0AlZ2g.png"/></div></div></figure><p id="ea2f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">看吧！左边的组件只需要15行代码，而右边的组件(使用React-Redux)需要32行代码，是另一个的两倍。</p><p id="8b63" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第三:(减少React-Redux的额外学习曲线)。我仍然记得我第一次与React合作的时候(两三年前)。</p><p id="4758" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">名为<code class="fe mg mh mi mj b">mapStateToProps</code>和<code class="fe mg mh mi mj b">mapDispatchToProps</code>的东西让我花了一段时间才习惯使用它。更别说什么叫高阶函数“connect”的东西了，让初级开发者很困惑。</p><p id="9315" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我肯定你现在有什么困惑。这是哪里来的？</p><p id="4d99" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mg mh mi mj b">const {state, actions} = useContext(AppContext)</code></p><p id="2d41" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我解释它是什么和它来自哪里之前，我将向您展示如何使用上下文将Redux连接到您的React应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/7786f6c5d96630a9fd5df744f79f0cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ls-578qBXp7_Y61KuMuAHQ.png"/></div></div></figure><p id="594b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就在那里。左边是<code class="fe mg mh mi mj b">App.js</code>(我的React app的根组件)，设置上下文的地方。</p><p id="54a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您将看到我们的上下文值包含来自商店的<code class="fe mg mh mi mj b">appState</code>和所有动作(从左边的<code class="fe mg mh mi mj b">index.js</code>文件导入)。</p><p id="43ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，我们必须向Redux store订阅应用程序状态，这样每当Redux store发生变化时，它都会得到通知。当应用程序卸载时，不要忘记取消订阅。</p><p id="70a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们将把app组件的所有内容包装在上下文提供者中。这样，React应用程序中的其他组件就能够访问产品组件中的应用程序状态和操作，如上所述。</p><p id="749d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里要注意的一点是，在每个动作中，我们不是返回包含类型和有效载荷的对象，而是直接在动作函数中调度它。这是因为我们没有使用React-Redux，所以我们必须在action函数中调用dispatch。</p><p id="bb57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">仅此而已。对我来说，这是一种真正简单的结合React和Redux的方式，不需要React-Redux。使用React语法编写组件将更加本地化。</p><p id="68eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不再有<code class="fe mg mh mi mj b">mapDispatch</code>、<code class="fe mg mh mi mj b">mapState</code>，以及其他连接的东西。</p><p id="01c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一件事是，使用这种方法，我们不需要Redux Thunk来处理异步操作。我们只是在一个动作中直接调用它们，并在异步动作被解析时分派一个动作。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="b851" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">结论</h1><h2 id="a051" class="nk mt it bd mu nl nm dn my nn no dp nc ld np nq ne lh nr ns ng ll nt nu ni nv bi translated"><strong class="ak">免责声明</strong></h2><p id="33e5" class="pw-post-body-paragraph ku kv it kw b kx nw ju kz la nx jx lc ld ny lf lg lh nz lj lk ll oa ln lo lp im bi translated">每次提供者更改值时，React context都会导致其所有使用者重新呈现，从而严重影响性能。</p><h2 id="4c67" class="nk mt it bd mu nl nm dn my nn no dp nc ld np nq ne lh nr ns ng ll nt nu ni nv bi translated"><strong class="ak">解决方案</strong></h2><p id="c306" class="pw-post-body-paragraph ku kv it kw b kx nw ju kz la nx jx lc ld ny lf lg lh nz lj lk ll oa ln lo lp im bi translated">解决此问题的提示:</p><p id="4518" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你应该用容器(在这个上下文中称为消费者)和组件(那些不关心Redux商店的，他们只依赖于道具)来架构你的应用。</p><p id="b79d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">容器总是呈现组件，而不是DOM，并且组件总是呈现DOM，并且仅在其属性或状态改变时才重新呈现。</p><p id="9a3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">容器可以任意多次重新渲染。我们不介意，因为这实际上并没有重新呈现DOM，所以不会影响我们应用程序的性能。</p><h2 id="223b" class="nk mt it bd mu nl nm dn my nn no dp nc ld np nq ne lh nr ns ng ll nt nu ni nv bi translated">密码</h2><p id="dff6" class="pw-post-body-paragraph ku kv it kw b kx nw ju kz la nx jx lc ld ny lf lg lh nz lj lk ll oa ln lo lp im bi translated">我已经把参考代码放在这个<a class="ae lq" href="https://github.com/chiquyet199/redux-context" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>里了。</p><p id="563d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！</p></div></div>    
</body>
</html>