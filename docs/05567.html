<html>
<head>
<title>A Simple Way to Create Kubernetes Clusters Locally Using kind</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用kind在本地创建Kubernetes集群的简单方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-simple-way-to-create-kubernetes-clusters-locally-using-kind-efc4b21e6788?source=collection_archive---------1-----------------------#2020-07-19">https://betterprogramming.pub/a-simple-way-to-create-kubernetes-clusters-locally-using-kind-efc4b21e6788?source=collection_archive---------1-----------------------#2020-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9852" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用K8s更好地进行本地开发</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6294db8aff9f5109787ae24ab6624d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SqyjTWRYimQmbnq3.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://kind.sigs.k8s.io/docs/user/quick-start/" rel="noopener ugc nofollow" target="_blank">亲切的官方logo </a></p></figure><h1 id="f4ec" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="01df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是另一个Kubernetes SIGs项目，但是与minikube相比有很大的不同。它将集群移动到Docker容器中。与生成虚拟机相比，这将大大加快启动速度。</p><p id="f1fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://sigs.k8s.io/kind" rel="noopener ugc nofollow" target="_blank"> kind </a>是一个使用Docker容器节点运行本地Kubernetes集群的工具(CLI)。</p><p id="4bc3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们开始吧。</p><h2 id="a91f" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">先决条件</h2><p id="9c0f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面的东西应该是本地系统里有的。</p><ul class=""><li id="9cad" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm nj nk nl nm bi translated"><a class="ae ky" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank">去</a></li><li id="9157" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">Docker服务需要运行</li></ul></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="ecf7" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">装置</h1><p id="05e4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面的命令应该下载并安装<code class="fe oe of og oh b">kind</code>二进制文件。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="7606" class="ms la it oh b gy om on l oo op">GO111MODULE=”on” go get sigs.k8s.io/kind@v0.8.1</span></pre></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="861b" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">确保二进制类型存在</h1><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="3584" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> version<br/>kind v0.8.1 go1.14.2 darwin/amd64</span></pre><p id="f34a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们应该能够使用<code class="fe oe of og oh b">kind</code> CLI来启动K8s集群。</p><p id="2ad7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oe of og oh b">kind</code>的用法:</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="6e1c" class="ms la it oh b gy om on l oo op">Usage:<br/>  kind [command]Available Commands:<br/>  build       Build one of [node-image]<br/>  completion  Output shell completion code for the specified shell<br/>  create      Creates one of [cluster]<br/>  delete      Deletes one of [cluster]<br/>  export      Exports one of [kubeconfig, logs]<br/>  get         Gets one of [clusters, nodes, kubeconfig]<br/>  help        Help about any command<br/>  load        Loads images into nodes<br/>  version     Prints the kind CLI version</span></pre><p id="6efa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们将主要关注<code class="fe oe of og oh b">create</code>、<code class="fe oe of og oh b">get</code>和<code class="fe oe of og oh b">delete</code>命令。</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="efcc" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">创建一个集群</h1><p id="d797" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要创建集群，只需执行。</p><p id="384a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">cmd:</strong>T6】</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="1b45" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> create cluster<br/>Creating cluster "kind" ...<br/> ✓ Ensuring node image (kindest/node:v1.18.2) 🖼<br/> ✓ Preparing nodes 📦<br/> ✓ Writing configuration 📜<br/> ✓ Starting control-plane 🕹️<br/> ✓ Installing CNI 🔌<br/> ✓ Installing StorageClass 💾<br/>Set kubectl context to "kind-kind"<br/>You can now use your cluster with:kubectl cluster-info --context kind-kind Have a nice day! 👋</span></pre><p id="6733" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这将通过拉最新的Kubernetes节点(1.18.2版)来创建一个Kubernetes集群。我们刚刚创建了1.18.2版的Kubernetes集群。</p><p id="8cd0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们在创建集群时没有传递<code class="fe oe of og oh b">--name</code>参数，那么集群名称默认设置为<code class="fe oe of og oh b">kind</code>。</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="a624" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">创建特定版本的K8s集群</h1><p id="9377" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以通过<code class="fe oe of og oh b">--image</code>参数来部署特定版本的K8s集群。</p><p id="85bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">cmd:</strong>T10】</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="3f80" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> create cluster --image kindest/node:v1.15.6 --name kind-1.15.6<br/>Creating cluster "kind" ...<br/> ✓ Ensuring node image (kindest/node:v1.15.6) 🖼<br/> ✓ Preparing nodes 📦<br/> ✓ Writing configuration 📜<br/> ✓ Starting control-plane 🕹️<br/> ✓ Installing CNI 🔌<br/> ✓ Installing StorageClass 💾<br/>Set kubectl context to "kind-kind"<br/>You can now use your cluster with:kubectl cluster-info --context kind-kind Have a nice day! 👋</span></pre><p id="cbac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">提供所有支持的K8s版本标签的列表可以在<a class="ae ky" href="https://hub.docker.com/r/kindest/node/tags" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="119f" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">列出已部署的集群</h1><p id="0e7d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">命令:</strong>T11】</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="40a3" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> get clusters<br/>kind<br/>kind-1.15.6</span></pre><p id="c9a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这应该会列出自从我们为两个不同的K8s版本执行<code class="fe oe of og oh b">kind create cluster</code>以来创建的两个集群。</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="4162" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">为kubectl设置上下文</h1><p id="d5ec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">创建集群后，<code class="fe oe of og oh b">kubectl</code>将始终指向最近创建的K8s集群。</p><p id="626a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们检查所有可用的上下文。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="21e1" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kubectl </strong>config get-contexts<strong class="oh iu"><br/></strong>CURRENT   NAME                               CLUSTER                      <br/>          kind-kind                          kind-kind            <br/>*         kind-kind-1.15.6                   kind-kind-1.15.6</span></pre><p id="5d77" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从输出中，我们可以得出结论，<code class="fe oe of og oh b">kubectl</code>上下文当前已经被设置为最新的集群，即<code class="fe oe of og oh b">kind-1.15.6</code>。</p><p id="7cf0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">(上下文名称以<code class="fe oe of og oh b">kind</code>为前缀。)</p><p id="7fb0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要将<code class="fe oe of og oh b">kubectl</code>上下文设置为<code class="fe oe of og oh b">kind</code>集群(即版本1.18.2 ),我们需要:</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="58e7" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kubectl</strong> config set-context kind-kind <br/>Context "kind-kind" modified.</span></pre><p id="17fb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了验证<code class="fe oe of og oh b">kubectl</code>是否指向正确的集群，让我们检查节点。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="03af" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kubectl</strong> get nodes<br/>NAME                        STATUS   ROLES    AGE     VERSION<br/>kind-1.18.2-control-plane   Ready    master   8m20s   v1.18.2</span></pre></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="f6cc" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">删除集群</h1><p id="0a11" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要删除特定的集群，可以将集群名称传递给<code class="fe oe of og oh b">--name</code>参数中的<code class="fe oe of og oh b">delete</code>命令。</p><p id="1f9f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">cmd:</strong>T8】</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="78ba" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> delete cluster --name kind<br/>Deleting cluster "kind" ...</span></pre></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="ddd5" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">删除您的所有集群</h1><p id="f9c7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果要一次性删除所有集群，请执行:</p><p id="0d9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">cmd:</strong>T9】。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="1fa9" class="ms la it oh b gy om on l oo op">&gt; <strong class="oh iu">kind</strong> delete clusters --all<br/>Deleted clusters: ["kind-1.15.6"]</span></pre></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><h1 id="88fc" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">为什么善良？</h1><ul class=""><li id="b76c" class="ne nf it lt b lu lv lx ly ma oq me or mi os mm nj nk nl nm bi translated">kind支持多节点(包括HA)集群</li><li id="f57b" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">kind支持Linux、macOS和Windows</li><li id="0b85" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">kind通过了云本地计算基金会<a class="ae ky" href="https://landscape.cncf.io/selected=kind" rel="noopener ugc nofollow" target="_blank">的认证，并符合该基金会(CNCF </a></li></ul></div></div>    
</body>
</html>