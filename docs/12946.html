<html>
<head>
<title>Create a Custom Template for Dotnet New</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为点网新建创建自定义模板</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-custom-template-for-dotnet-new-9feae7ed5b55?source=collection_archive---------2-----------------------#2022-07-13">https://betterprogramming.pub/create-a-custom-template-for-dotnet-new-9feae7ed5b55?source=collection_archive---------2-----------------------#2022-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="93dc" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">编程技巧和诀窍</h2><div class=""/><div class=""><h2 id="9f39" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">停止浪费时间清理初始项目</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/23cbc14b8ecba80c2a18c0f128c03c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7tGh28T8DVbZAv3Q"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">罗曼·辛克维奇·🇺🇦在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f29a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当开始一个新项目时，我经常使用<code class="fe me mf mg mh b">dotnet new webapi</code>命令。我必须做的第一件事是清理项目。我删除我不需要的文件，并重命名和修改我想保留的文件。然后，我想，“必须有一种方法来定义我自己的模板，这样我就可以跳过清理。”嗯，有。</p><p id="4ec6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将向您展示如何创建一个自定义模板来使用<code class="fe me mf mg mh b">dotnet new</code>命令。这样，您就可以获得您想要的项目，而不必清理示例代码。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="3083" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有趣的是，我必须做的第一件事是创建一个Web API项目并清理它。在名为<code class="fe me mf mg mh b">template</code>的文件夹中，我运行<code class="fe me mf mg mh b">dotnet new webapi</code>来创建一个示例项目。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="3c8a" class="mo mp it mh b gy mq mr l ms mt">dotnet new webapi --no-https -n Cleanwebapi</span></pre><p id="c410" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，像往常一样，我清理样本代码。我不再需要天气预报文件，所以我删除了它。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="969f" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>ri .\Cleanwebapi\WeatherForecast.cs</span></pre><p id="64b0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我还将默认的控制器文件重命名为<code class="fe me mf mg mh b">CleanWebApiController</code>。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="edfb" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>ren .\Cleanwebapi\Controllers\WeatherForecastController.cs CleanwebapiController.cs</span></pre><p id="c1ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我打开<code class="fe me mf mg mh b">CleanwebapiController.cs</code>，找到并替换<code class="fe me mf mg mh b">WeatherForecast</code>到<code class="fe me mf mg mh b">Cleanwebapi</code>。我取出<code class="fe me mf mg mh b">Summaries</code>阵。最后，我替换GET方法并添加一个POST方法。在GET方法中，我记录它被调用并返回“Hello World”在POST方法中，我记录被发布的主体。当代码运行时，日志消息将可见。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mu mj l"/></div></figure><p id="ea7b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着项目的更新，我执行它以确保它能够编译和运行。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7b92220f7c1d4aa1b91f368a539ec82d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*8RiHtncEYEsOilkddxqKXA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">模板正在工作</p></figure><p id="ee8e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，我使用<a class="ae lh" href="https://marketplace.visualstudio.com/items?itemName=humao.rest-client" rel="noopener ugc nofollow" target="_blank"> REST客户端扩展</a>为<a class="ae lh" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>创建一个HTTP文件来发送测试方法的请求。我首先测试GET方法，在<code class="fe me mf mg mh b">port 5287</code>到<code class="fe me mf mg mh b">cleanwebapi </code>路由上请求localhost。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mu mj l"/></div></figure><p id="602d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">发送请求返回状态码200，值“Hello World”，终端显示记录的消息。现在我用JSON主体测试Post方法。发送这个请求还会返回一个状态码200，终端会显示JSON主体的日志消息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/adc52949d19f31978eec694698f1c679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*hUGvyVFjVeDjCtcqekskcQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">应用程序日志</p></figure><p id="ba9e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">测试完代码后，我停止它并删除bin和obj文件夹，这样它们就不会包含在模板中。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="4df3" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>ri .\bin\ -fo -r<br/>ri .\obj\ -fo -r</span></pre><p id="29a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了将这些文件转换成模板，我添加了一个<code class="fe me mf mg mh b">.template.config</code>文件夹，并在其中放置了一个<code class="fe me mf mg mh b">template.json</code>文件。注意:以下命令(mcd和touch)需要<a class="ae lh" href="https://www.powershellgallery.com/packages/Trackyon.Utils/0.2.1" rel="noopener ugc nofollow" target="_blank">轨迹。Utils PowerShell模块</a>。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="222a" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>mcd .template.config<br/>touch template.json</span></pre><p id="aee2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我将一个架构添加到文件中，这将使Visual Studio代码能够提供智能感知。在对模式进行编辑时，按CTRL + space组合键会列出可以添加到该文件中的所有属性。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mx"><img src="../Images/4a9f071f6af9a84ad18aad23af8c3edd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QpUyEmBC3e2vJ-ZafhTJGQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">所有可能的元素</p></figure><p id="5271" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我从<code class="fe me mf mg mh b">author</code>开始，输入我的Twitter账号。然后我添加了<code class="fe me mf mg mh b">classifications</code>，这是用户可以用来搜索模板的特征。当使用<code class="fe me mf mg mh b">dotnet new</code>命令列出可用模板时，<code class="fe me mf mg mh b">classifications</code>也会出现在标签栏中。接下来，我在<code class="fe me mf mg mh b">identity</code>属性中为模板添加一个惟一的名称。<code class="fe me mf mg mh b">name</code>属性是列出可用模板时用户看到的值。</p><p id="33ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">shortName</code>是从命令行使用的，是在<code class="fe me mf mg mh b">dotnet new</code>之后键入的。将<code class="fe me mf mg mh b">preferNameDirectory</code>设置为true将创建一个目录，而不是直接在当前文件夹中创建内容。模板中的<code class="fe me mf mg mh b">sourceName</code>将被替换为用户提供的名称。这将在文件和文件名中被替换。注意这个值的大小写，并确保它匹配，否则将不会被替换。最后，我使用<code class="fe me mf mg mh b">tags</code>属性来设置<code class="fe me mf mg mh b">language</code>和<code class="fe me mf mg mh b">type</code>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mu mj l"/></div></figure><p id="5e77" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着<code class="fe me mf mg mh b">template.json</code>文件的完成，我现在可以安装和使用这个模板了。为了安装，我使用带有<code class="fe me mf mg mh b">-i</code>选项的<code class="fe me mf mg mh b">dotnet new</code>命令指向当前文件夹Cleanwebapi。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="a7a1" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>dotnet new -i .</span></pre><p id="a907" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该命令的输出显示了新的“干净的ASP.NET核心Web API”模板。安装好模板后，我使用cleanwebapi模板创建了一个新项目。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="8f1d" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>dotnet new cleanwebapi -n Test</span></pre><p id="c519" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">列出新测试文件夹的内容显示了使用传入的名称创建的<code class="fe me mf mg mh b">Test.csproj</code>文件。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="1ce2" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>ls</span><span id="ae78" class="mo mp it mh b gy my mr l ms mt">Directory: F:\temp\template\Test</span><span id="ae9c" class="mo mp it mh b gy my mr l ms mt">Mode            Length Name<br/>----            ------ ----<br/>d----                  Controllers<br/>d----                  Properties<br/>-a---           127    appsettings.Development.json<br/>-a---           151    appsettings.json<br/>-a---           527    Program.cs<br/>-a---           327    Test.csproj</span></pre><p id="09e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">列出<em class="mz">控制器</em>目录显示控制器文件名为<em class="mz"> TestController.cs </em>。</p><pre class="ks kt ku kv gt mk mh ml mm aw mn bi"><span id="1dd6" class="mo mp it mh b gy mq mr l ms mt">PowerShell<br/>--------------------------------------------------------------------<br/>ls</span><span id="2910" class="mo mp it mh b gy my mr l ms mt">Directory: F:\temp\template\Test\Controllers</span><span id="7015" class="mo mp it mh b gy my mr l ms mt">Mode            Length Name<br/>----            ------ ----<br/>-a---           600    TestController.cs</span></pre><p id="1faa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，打开该文件会显示名称空间和类名也是使用由<code class="fe me mf mg mh b">-n</code>选项提供的名称创建的。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mu mj l"/></div></figure><p id="8334" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<code class="fe me mf mg mh b">dotnet new</code>创建自定义模板很容易，并且可以节省您的时间。</p><p id="3c73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢阅读。下次见！</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="7174" class="mo mp it bd nh ni nj dn nk nl nm dp nn lr no np nq lv nr ns nt lz nu nv nw iz bi translated">信用</h2><p id="a979" class="pw-post-body-paragraph li lj it lk b ll nx kd ln lo ny kg lq lr nz lt lu lv oa lx ly lz ob mb mc md im bi translated">编辑:<a class="ae lh" href="https://cbrownauthor.com/" rel="noopener ugc nofollow" target="_blank">切尔西·布朗</a></p></div></div>    
</body>
</html>