<html>
<head>
<title>Pickling Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">酸洗机器学习模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/pickling-machine-learning-models-aeb474bc2d78?source=collection_archive---------6-----------------------#2020-08-19">https://betterprogramming.pub/pickling-machine-learning-models-aeb474bc2d78?source=collection_archive---------6-----------------------#2020-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e6a2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">训练你的ML模型一次，不用训练就可以使用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b378607d4cfa7ac45f82d742add09191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yNJVZ52nlLlAnGkr_AHHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.deviantart.com/tmgomes" rel="noopener ugc nofollow" target="_blank"> TmGomes </a>在<a class="ae ky" href="https://www.deviantart.com/" rel="noopener ugc nofollow" target="_blank"> DeviantArt </a>上拍摄的照片。</p></figure><p id="231e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你创建了一个机器学习模型之后，你训练它。培训过程通常需要一些时间。模型训练好之后，得到的就是模型对象。要使用该模型，您要么以某种方式保存该模型，要么可以在每次使用时重新训练该模型，这是低效的)。</p><p id="e3ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有数万亿字节的模型训练数据，每次您都要进行预测，那么每次都训练模型将是低效的。而是训练完模型，就可以保存了。理想情况下，一旦有了新数据，就应该对模型进行重新训练，但不必在每次想要使用它时都进行重新训练。</p><p id="882f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要保存机器学习模型，请使用<a class="ae ky" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> pickle </a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0f12" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是腌制？</h1><p id="be5a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Pickle是Python中的一个模块，用于序列化和反序列化Python对象。这将转换列表、字典等Python对象。转换成字节流(零和一)。您可以通过称为unpickling的过程将字节流转换回Python对象。酸洗也称为序列化、扁平化或编组。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8c78" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何腌制</h1><p id="1524" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">pickle模块有两个方法。</p><h2 id="3b78" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">泡菜。<strong class="ak">转储()</strong></h2><p id="a474" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe nl nm nn no b">pickle.dump()</code>方法将Python对象转储到pickle文件中。这将在您当前的工作目录(<code class="fe nl nm nn no b">pickle.dump(what_are_we_dumping, where_are_we_dumping_it)</code>)中创建一个<code class="fe nl nm nn no b">.pickle</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="6a1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，我们从一个<code class="fe nl nm nn no b">example_dict</code>字典创建了一个<code class="fe nl nm nn no b">example_dict.pickle</code>文件。语句1和2执行同样的任务，将字典转换成pickle文件。使用<code class="fe nl nm nn no b">with</code>语句确保在程序执行离开<code class="fe nl nm nn no b">with</code>语句的上下文后，打开的文件描述符自动关闭。<code class="fe nl nm nn no b">open</code>语句中的<code class="fe nl nm nn no b">'wb'</code>表示我们正在<em class="nr">将字节</em>写入文件。</p><h2 id="ec57" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">泡菜。<strong class="ak"> load() </strong></h2><p id="41aa" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe nl nm nn no b">pickle.load()</code>方法允许您通过将<code class="fe nl nm nn no b">.pickle</code>文件(<code class="fe nl nm nn no b">pickle.load(what_do_we_want_to_load)</code>)加载到内存中来使用它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="7126" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，我们从一个<code class="fe nl nm nn no b">example_dict.pickle</code>文件创建了一个<code class="fe nl nm nn no b">example_dict</code>字典。语句1和2执行读取pickle文件的相同任务，pickle文件是一个字典。open语句中的<code class="fe nl nm nn no b">'rb'</code>表示我们正在从文件中读取<em class="nr">字节数据</em>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b469" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">酸洗机器学习分类器</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="dd32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在导入所有必要的库之后，我们读取数据，然后将它分成测试集和训练集。然后，我们根据<code class="fe nl nm nn no b">X_train</code>和<code class="fe nl nm nn no b">y_train</code>数据训练(拟合)分类器。在我们训练了分类器之后，我们接着将这个分类器保存在一个pickle文件中。我们从线性回归分类器(<code class="fe nl nm nn no b">clf</code>)中创建一个pickle文件(<code class="fe nl nm nn no b">linearregression.pickle</code>)。</p><p id="bf8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们想要使用一个训练好的分类器时，我们将pickle文件(<code class="fe nl nm nn no b">linearregression.pickle</code>)转换回一个分类器(<code class="fe nl nm nn no b">pickle_clf</code>)。任何时候我们想在程序中使用分类器，我们只需使用<code class="fe nl nm nn no b">pickle_clf</code>。</p><p id="2fab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">原始分类器(<code class="fe nl nm nn no b">clf</code>)和酸洗分类器(<code class="fe nl nm nn no b">pickle_clf</code>)相同。这可以通过在相同的测试集上比较两者所达到的准确度来证明。对比后返回<code class="fe nl nm nn no b">True</code>，显示准确率相同，证明分类器相同。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e630" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么时候腌制</h1><ul class=""><li id="7e0a" class="ns nt it lb b lc mu lf mv li nu lm nv lq nw lu nx ny nz oa bi translated">保存程序的状态。</li><li id="aef1" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">通过TCP连接发送Python数据。</li><li id="4311" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">保存Python对象。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a9f6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么时候不腌制</h1><ul class=""><li id="1fee" class="ns nt it lb b lc mu lf mv li nu lm nv lq nw lu nx ny nz oa bi translated">当使用多个Python版本时:<strong class="lb iu"> </strong>在不同的Python版本中分离对象可能会很麻烦。</li><li id="19f8" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">当跨多种语言工作时:<strong class="lb iu"/><code class="fe nl nm nn no b">pickle </code>使用的数据格式是Python特有的，这意味着非Python程序可能无法重构腌制的Python对象。</li><li id="7980" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">当使用递归数据结构时:<strong class="lb iu"> </strong>试图处理一个高度递归的数据结构可能会超过最大递归深度。在这种情况下会引发一个<code class="fe nl nm nn no b"><a class="ae ky" href="https://docs.python.org/2/library/exceptions.html#exceptions.RuntimeError" rel="noopener ugc nofollow" target="_blank">RuntimeError</a></code>。您可以使用<code class="fe nl nm nn no b"><a class="ae ky" href="https://docs.python.org/2/library/sys.html#sys.setrecursionlimit" rel="noopener ugc nofollow" target="_blank">sys.setrecursionlimit()</a></code>提高此限制。</li><li id="45f6" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">使用外部pickle文件时:<strong class="lb iu"/><code class="fe nl nm nn no b">pickle</code>模块<a class="ae ky" href="https://docs.python.org/3/library/pickle.html#admonition%20warning" rel="noopener ugc nofollow" target="_blank">不安全</a>。只对您信任的数据进行解压缩。有可能构建恶意pickle数据，该数据将在拆包期间<strong class="lb iu"> </strong>执行任意代码。永远不要解开可能来自不可信来源的数据。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6fc3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">cPickle</h1><p id="885c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">就像<code class="fe nl nm nn no b">pickle</code>模块一样，<code class="fe nl nm nn no b">cPickle</code>支持Python对象的序列化和反序列化。因为是用C语言写的，所以比基于Python的<code class="fe nl nm nn no b">pickle</code>快一千倍的<a class="ae ky" href="https://docs.python.org/2/library/pickle.html#module-cPickle" rel="noopener ugc nofollow" target="_blank">。由于<code class="fe nl nm nn no b">pickle</code>和<code class="fe nl nm nn no b">cPickle</code>产生的输出相同，我们可以互换使用这两个模块。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="715e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><ol class=""><li id="db9e" class="ns nt it lb b lc mu lf mv li nu lm nv lq nw lu og ny nz oa bi translated">Python官方文档:<br/><a class="ae ky" href="https://docs.python.org/2/library/pickle.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/2/library/pickle.html</a><br/><a class="ae ky" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/pickle.html</a></li><li id="5542" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu og ny nz oa bi translated">丹·巴德的博客:<br/><a class="ae ky" href="https://dbader.org/blog/python-context-managers-and-with-statement" rel="noopener ugc nofollow" target="_blank">https://dbader . org/blog/python-context-managers-and-with-statement</a></li><li id="46dd" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu og ny nz oa bi translated">Manu Kalia关于pickle的文章:<br/><a class="ae ky" href="https://medium.com/better-programming/dont-fear-the-pickle-using-pickle-dump-and-pickle-load-5212f23dbbce" rel="noopener">https://medium . com/better-programming/don-fear-the-pickle-using-pickle-dump-and-pickle-load-5212 f 23 dbce</a></li><li id="7a1a" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu og ny nz oa bi translated">Lokesh Sharma关于pickle的博客:<br/><a class="ae ky" href="https://medium.com/@lokeshsharma596/what-is-pickle-in-python-3d9f261498b4" rel="noopener">https://medium . com/@ lokesh Sharma 596/what-is-pickle-in-python-3d9f 261498 B4</a></li><li id="e7b9" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu og ny nz oa bi translated">Sentdex机器学习播放列表:<br/><a class="ae ky" href="https://www.youtube.com/watch?v=za5s7RB_VLw&amp;list=PLQVvvaa0QuDfKTOs3Keq_kaG2P55YRn5v&amp;index=7&amp;t=0s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watchv=za5s7RB_VLw&amp;list = plqvvvaa 0 qudfktos 3 keq _ kag 2 p 55 yrn 5v&amp;index = 7&amp;t = 0s</a></li><li id="f70c" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu og ny nz oa bi translated">Sentdex泡菜教程:<br/><a class="ae ky" href="https://www.youtube.com/watch?v=2Tw39kZIbhs&amp;t=343s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=2Tw39kZIbhs&amp;t = 343s</a></li></ol></div></div>    
</body>
</html>