<html>
<head>
<title>Raspberry Pi Pulse Width Modulation for Dummies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">仿树莓Pi脉宽调制</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/raspberry-pi-pulse-width-modulation-for-dummies-10005f3f3583?source=collection_archive---------5-----------------------#2021-11-03">https://betterprogramming.pub/raspberry-pi-pulse-width-modulation-for-dummies-10005f3f3583?source=collection_archive---------5-----------------------#2021-11-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c665" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用C和Golang了解Raspberry Pi上的脉冲宽度调制</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/054c5e5edf22b3c2784255b41682a717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKPxuDXF4bUKLWN9cq519g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="f83c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文详细介绍了基于硬件和软件的rampberry Pi PWM，特别是带有<a class="ae lr" href="https://www.raspberrypi.org/app/uploads/2012/02/BCM2835-ARM-Peripherals.pdf" rel="noopener ugc nofollow" target="_blank"> Broadcomm BCM2835板</a>的3B+。本文附带了一个应用程序，<a class="ae lr" href="https://github.com/youngkin/gpio" rel="noopener ugc nofollow" target="_blank"> PWM Explorer </a>，可以用来试验PWM设置和功能。</p><h1 id="4438" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">概观</h1><p id="a79b" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我正在写一篇<a class="ae lr" href="https://youngkin.github.io/post/sunfoundergpionotesrgbled" rel="noopener ugc nofollow" target="_blank">文章</a>作为<a class="ae lr" href="https://docs.sunfounder.com/projects/raphael-kit/en/latest/1.1.1_blinking_led_c.html" rel="noopener ugc nofollow" target="_blank"> SunFounder RGB LED项目</a>的配套文章，以涵盖该项目中遗漏的一些领域，例如什么是PWM，它是如何工作的，以及为什么代码是这样写的。我不知道PWM是什么，也不知道我在做什么，也不知道为什么。为了填补这个空白，我开始研究PWM，并找到了许多关于PWM的文章(参考文献2、3、4，以及一些软件库，如<a class="ae lr" href="https://github.com/WiringPi/WiringPi" rel="noopener ugc nofollow" target="_blank"> WiringPi </a> (C)、<a class="ae lr" href="https://github.com/stianeikeland/go-rpio" rel="noopener ugc nofollow" target="_blank"> go-rpio </a> (Go)、Mike McCalley的<a class="ae lr" href="https://www.airspayce.com/mikem/bcm2835" rel="noopener ugc nofollow" target="_blank">BCM 2835</a>(C)和<a class="ae lr" href="https://abyz.me.uk/rpi/pigpio/pdif2.html" rel="noopener ugc nofollow" target="_blank"> pigpio </a> (Python &amp; C)。因此，我仍然专注于通过GPIO和PWM控制RGB LED，并开始用C和Go编写程序。我很快在几个方面遇到了困难:</p><ol class=""><li id="a0a1" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">文章和库中的术语使用不一致。例如，有些人用术语<em class="my">循环</em>和<em class="my">范围</em>来表示同一事物。</li><li id="1eb7" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">这些库都有不同程度的文档记录。加上缺乏通用术语，很难弄清楚如何使用它们。</li><li id="adef" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">在弄清楚如何使用库的同时，很难理解不同的参数如何影响硬件的行为，在本例中是RGB LED。</li></ol><p id="d08e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我写这篇文章的目的是:</p><ol class=""><li id="8efd" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">概述PWM及其主要概念。</li><li id="4bc8" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">提供一个词汇表，将各种PWM术语与一致的定义联系起来。</li><li id="8f66" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">解释各种PWM设置如何相互作用(不仅仅是<em class="my">占空比</em>)。</li><li id="f118" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">提供在Raspberry Pi 3B+上安装GPIO测试平台所需的信息(有时通过外部参考)。</li><li id="0bbf" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">提供用Go和C编写的程序，演示如何有效地使用<a class="ae lr" href="https://github.com/WiringPi/WiringPi" rel="noopener ugc nofollow" target="_blank"> WiringPi </a>和<a class="ae lr" href="https://github.com/stianeikeland/go-rpio" rel="noopener ugc nofollow" target="_blank"> go-rpio </a>。</li><li id="b485" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">提供可用于实时试验各种PWM参数的应用程序。</li><li id="1eb6" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">提供一些难以找到的概念和PWM设置信息(例如，最小/最大PWM频率)。</li></ol><p id="0fff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以免有人认为我是GPIO和PWM方面的专家，我不是。尽管我尽了最大努力来总结我所学到的东西，但我确信我犯了错误，或者让事情变得更加混乱。我犯的任何错误都是我自己的。如果任何人遇到任何可以澄清的错误主题，我会很感激评论，这样我就可以修改这篇文章。</p><p id="037b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我写这篇文章并不是为了成为PWM的权威来源。有更好的资源。参见下面的<strong class="kx ir">参考资料</strong>部分，获得我认为特别有用的资源。</p><p id="3310" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在来看这篇文章的大纲。这些部分如下:</p><ol class=""><li id="4d85" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><strong class="kx ir">先决条件</strong>涵盖了如何获得本文中使用的软件库以及<em class="my"> PWM Explorer </em>应用程序演示行为所需的硬件等内容。</li><li id="cd2e" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">什么是PWM？</strong>提供了PWM的基本介绍。它提供了文章和软件库中常用术语和别名的定义。</li><li id="bc6c" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">Raspberry Pi 3B+</strong>概述GPIO和PWM如何在Raspberry Pi上实现。</li><li id="95b1" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">探索Raspberry Pi上的PWM</strong>提供了各种PWM设置的描述，它们如何相互作用，一些很难找到的关于PWM设置的花絮，以及应用概述<em class="my"> PWM Explorer </em>，它可用于驱动Raspberry Pi上的PWM，以查看设置如何实时相互作用。</li><li id="5872" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">一个<strong class="kx ir">总结</strong>来总结事情。</li><li id="242e" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">还有一套有用的<strong class="kx ir">参考资料</strong>。</li></ol><h1 id="21e3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">先决条件</h1><p id="fd4a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如果你没有，你需要一个树莓派。我在Raspbian OS的“拉伸”版本中使用了一个树莓派3B+。Raspberry Pi网站上有关于如何<a class="ae lr" href="https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up" rel="noopener ugc nofollow" target="_blank">从头开始设置一个新的Raspberry Pi的说明</a>，如果你决定走那条路，而不是购买一个完整的套件。</p><p id="10bd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你需要的其他物品包括:</p><ul class=""><li id="0c82" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq ne mv mw mx bi translated">一个<a class="ae lr" href="https://www.amazon.com/dp/B082KBF7MM/ref=sspa_dk_detail_4?psc=1&amp;pd_rd_i=B082KBF7MM&amp;pd_rd_w=1tGTV&amp;pf_rd_p=887084a2-5c34-4113-a4f8-b7947847c308&amp;pd_rd_wg=fX8JB&amp;pf_rd_r=44DE0RS1E9FD42RBYC7R&amp;pd_rd_r=47cbdc7f-7834-455f-9429-ef74a438bd45&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUFVVkdZVUZRNUw3ODkmZW5jcnlwdGVkSWQ9QTA4MzI4MzYyU0VLNzBJM0cxRUVMJmVuY3J5cHRlZEFkSWQ9QTA0Mjk1NTMzSzNSWlNFUjU0NURBJndpZGdldE5hbWU9c3BfZGV0YWlsJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==" rel="noopener ugc nofollow" target="_blank">试验板</a> <em class="my">(你可能会发现</em> <a class="ae lr" href="http://wiki.sunfounder.cc/index.php?title=Breadboard_Basics_%E2%80%93_Types" rel="noopener ugc nofollow" target="_blank"> <em class="my">这个教程对试验板</em> </a> <em class="my">很有帮助)</em>，</li><li id="a2c1" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">一些<a class="ae lr" href="https://www.amazon.com/dp/B08HZ26ZLF/ref=syn_sd_onsite_desktop_19?psc=1&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUExRFpLWElCRjg1MUNMJmVuY3J5cHRlZElkPUEwMjMyMTE1M01aOFE3U1BQS09YSiZlbmNyeXB0ZWRBZElkPUEwODE5NTMxMktEMTlZRjEyQjBJNiZ3aWRnZXROYW1lPXNkX29uc2l0ZV9kZXNrdG9wJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==" rel="noopener ugc nofollow" target="_blank">跳线</a>，</li><li id="82f6" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><a class="ae lr" href="https://www.amazon.com/EDGELEC-Tri-Color-Multicolor-Diffused-Resistors/dp/B077XGF3YR/ref=asc_df_B077XGF3YR/?tag=hyprod-20&amp;linkCode=df0&amp;hvadid=242051162351&amp;hvpos=&amp;hvnetw=g&amp;hvrand=11064062033670066895&amp;hvpone=&amp;hvptwo=&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9028749&amp;hvtargid=pla-430228081645&amp;psc=1" rel="noopener ugc nofollow" target="_blank">一个220欧姆的电阻和一个RGB LED </a>。</li><li id="31d7" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">您还应该考虑使用一个带有T型适配器的<a class="ae lr" href="https://www.amazon.com/dp/B082PRVRYR/ref=sspa_dk_detail_2?psc=1&amp;pd_rd_i=B082PRVRYR&amp;pd_rd_w=8mKhr&amp;pf_rd_p=887084a2-5c34-4113-a4f8-b7947847c308&amp;pd_rd_wg=e9psa&amp;pf_rd_r=S09F37DF2G5FW8B8GX4B&amp;pd_rd_r=c065c120-e60b-45e9-b93b-f581f048cf46&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUFCMzhUQ09COFI2VlMmZW5jcnlwdGVkSWQ9QTA5NjU2ODUxRDkxNEYwSTYwV09KJmVuY3J5cHRlZEFkSWQ9QTAxOTg1MTUyRUhEUlc2VzQ2VDQ4JndpZGdldE5hbWU9c3BfZGV0YWlsJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==" rel="noopener ugc nofollow" target="_blank"> 40引脚母对母，将GPIO输出连接到试验板上。您只能使用跳线，但T型适配器将使事情变得更容易，并有助于防止损坏Raspberry Pi上的GPIO引脚。如果您选择不购买带T型适配器的40针电缆，您需要购买</a><a class="ae lr" href="https://www.amazon.com/SinLoon-Breadboard-Arduino-Circuit-40-Pack/dp/B08M3QLL3Q/ref=pd_sbs_7/143-0445142-7950409?pd_rd_w=sVLrc&amp;pf_rd_p=8b76d7a7-ab83-4ddc-a92d-e3e33bfdbf03&amp;pf_rd_r=CDM5TGJT03VKF0ZFB577&amp;pd_rd_r=8e58fd82-8503-41cf-b8f2-c78eaeb78d25&amp;pd_rd_wg=tT1U0&amp;pd_rd_i=B08M3QLL3Q&amp;psc=1" rel="noopener ugc nofollow" target="_blank">公母跳线</a>。然而，单独购买所有这些东西会比一套花费更多。</li></ul><p id="727c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://www.amazon.com/dp/B06WP7169Y/ref=sspa_dk_detail_5?psc=1&amp;pd_rd_i=B06WP7169Y&amp;pd_rd_w=OZVyf&amp;pf_rd_p=887084a2-5c34-4113-a4f8-b7947847c308&amp;pd_rd_wg=0V0IH&amp;pf_rd_r=623YJTBQ2CN2B2GYXQG5&amp;pd_rd_r=faa61f0f-3aec-4cf0-8e7e-d44eb1b3b92f&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUEyUVlDQzMzVVZBMFYxJmVuY3J5cHRlZElkPUEwMzExNzk4MUhGSjFSS0VKTlBROCZlbmNyeXB0ZWRBZElkPUEwMzYwNjg2UUdMRU44N0YzNzIwJndpZGdldE5hbWU9c3BfZGV0YWlsJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==" rel="noopener ugc nofollow" target="_blank">这里有一个简单的工具包，上面所有的</a>。我发现sun founder Raspberry Pi Ultimate Starter Kit特别有用。<em class="my">注:Ultimate Starter Kit和Raphael Kit是同一产品。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/7e0875a997c7603788d009a264804a9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hQNO9rrJDq2150_y.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="d38e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您还需要一些基本的C和Go编程知识，并且熟悉登录到Raspberry Pi终端，或者登录到一些操作系统版本附带的桌面GUI。根据您采用的方法，您可能需要将键盘和显示器连接到Raspberry Pi。我只是简单地进入Pi。您还需要熟悉如何使用像vim或nano这样的编辑器。</p><p id="b96e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了编译和运行C程序，你需要<a class="ae lr" href="https://github.com/WiringPi/WiringPi" rel="noopener ugc nofollow" target="_blank"> WiringPi </a>库。很容易得到:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="8d55" class="nl lt iq nh b gy nm nn l no np">sudo apt-get install wiringpi</span></pre><p id="58a1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后使用以下命令测试安装:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="4116" class="nl lt iq nh b gy nm nn l no np">pi@pi-node1:~/go/src/github.com/youngkin/gpio/rgbled $ gpio -v<br/>gpio version: 2.50<br/>Copyright (c) 2012-2018 Gordon Henderson<br/>This is free software with ABSOLUTELY NO WARRANTY.<br/>For details type: gpio -warranty</span><span id="8968" class="nl lt iq nh b gy nq nn l no np">Raspberry Pi Details:<br/>  Type: Pi 3B+, Revision: 03, Memory: 1024MB, Maker: Sony<br/>  * Device tree is enabled.<br/>  *--&gt; Raspberry Pi 3 Model B Plus Rev 1.3<br/>  * This Raspberry Pi supports user-level GPIO access.</span></pre><p id="d8cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面你会注意到<code class="fe nr ns nt nh b">gpio version: 2.50</code>。如果你使用的是Rasberry Pi 4，使用Sunfounder <a class="ae lr" href="https://docs.sunfounder.com/projects/raphael-kit/en/latest/check_the_wiringpi_c.html" rel="noopener ugc nofollow" target="_blank">中给出的检查接线Pi </a>的说明。</p><p id="a5ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">WiringPi的独特之处在于它包括一个命令行工具<code class="fe nr ns nt nh b">gpio</code>，如上所示，可用于管理、控制和查询GPIO板。这非常方便。参见<a class="ae lr" href="http://wiringpi.com/the-gpio-utility/" rel="noopener ugc nofollow" target="_blank"> gpio参考</a>了解更多关于它能做什么和如何使用的信息。</p><p id="10a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您对在Raspberry Pi上进行Go开发感兴趣，您需要将开发环境安装到Raspberry Pi上。<a class="ae lr" href="https://www.jeremymorgan.com/tutorials/raspberry-pi/install-go-raspberry-pi/" rel="noopener ugc nofollow" target="_blank">这里有一个简单的来源</a>解释了如何实现这一点。这个源代码有点过时了，但是唯一重要的问题是Go to install的版本。来源显示正在安装围棋<strong class="kx ir">1.14.4.linux-arm64.tar.gz</strong>和<strong class="kx ir">1.14.4.linuxarmv6l.tar.gz</strong>。目前的版本是<strong class="kx ir">1.17.1.linux-arm64.tar.gz</strong>和<strong class="kx ir">1.17.1.linuxarmv6l.tar.gz</strong>。对于树莓派3B+正确的选择将是<strong class="kx ir">1.17.1.linuxarmv6l.tar.gz</strong>。另一个是为64位系统设计的，比如Raspberry Pi 4系列。你可以在Golang下载网站找到当前ARM版本的Go。</p><p id="75c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于围棋开发，你还需要<a class="ae lr" href="https://github.com/stianeikeland/go-rpio" rel="noopener ugc nofollow" target="_blank"> go-rpio </a>库。</p><p id="700c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想脱离Sunfounder文档的食谱风格，你需要一些Linux的基础知识。例如，我不会解释什么是根特权。</p><p id="e819" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我编写了一个应用程序，支持在树莓Pi 3B+上试验各种PWM设置。获取代码有两种选择。首先，你可以从GitHub中克隆或者派生出<a class="ae lr" href="https://github.com/youngkin/gpio.git" rel="noopener ugc nofollow" target="_blank">项目</a>。如果你这样做，你需要有git的经验，并把它安装在Raspberry Pi上。更多细节参见这篇关于安装git 的文章。安装完<code class="fe nr ns nt nh b">git</code>后，您可以通过运行以下命令下载该项目:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="1d80" class="nl lt iq nh b gy nm nn l no np">git clone https://github.com/youngkin/gpio.git</span></pre><p id="4016" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想为这个项目做贡献，请转到仓库。作为使用git的替代方法，您也可以通过导航到<a class="ae lr" href="https://github.com/youngkin/gpio.git" rel="noopener ugc nofollow" target="_blank">项目的URL </a>，点击文件列表上方和右侧的<em class="my">代码</em>按钮，并选择<em class="my">下载ZIP </em>来下载项目的<em class="my"> zip </em>文件。</p><h1 id="df16" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是PWM？</h1><p id="913e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">最基本的是，PWM用于利用数字源(如GPIO引脚)模拟模拟信号。例如，可以通过改变提供给LED的电压来修改LED的亮度和/或颜色。各种模拟设备，如电机的速度，都可以用同样的方式控制。PWM通过在给定持续时间内改变数字功率脉冲的长度来模拟变化的电压。</p><p id="2fae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">除了这里介绍的内容之外，<a class="ae lr" href="https://www.kompulsa.com/introduction-pwm-pulse-width-modulation-works/" rel="noopener ugc nofollow" target="_blank">PWM简介:脉宽调制如何工作</a>描述了这里描述的一些相同的概念，以及一些如何使用PWM的例子。<strong class="kx ir">参考</strong>部分有更多PWM信息来源的链接。</p><p id="7edb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下部分涵盖了要点:</p><ul class=""><li id="9241" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq ne mv mw mx bi translated"><strong class="kx ir">术语</strong>定义了将在整个文档中使用的术语</li><li id="db13" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">主要概念</strong>描述了主要概念</li></ul><h2 id="f32f" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">术语</h2><p id="82ab" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我对PWM的研究包括阅读几篇文章以及检查几种不同语言的PWM软件库的代码。这些不同的来源使用的术语并不完全一致。以下是一些常用术语、它们的别名和定义。有关术语的直观表示，请参见下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/c734b40a0b0109ba18c0bc12ca74bc0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6c_nQoYstL7qxZWA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">PWM时序图—图片来源:作者</p></figure><ul class=""><li id="9902" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq ne mv mw mx bi translated"><strong class="kx ir">频率</strong>——根据<a class="ae lr" href="https://en.wikipedia.org/wiki/Frequency" rel="noopener ugc nofollow" target="_blank">维基百科</a>，<em class="my">频率是单位时间内重复事件发生的次数</em>。在电子学中，一个事件是一个波峰到下一个波峰(模拟)。在数字术语中，事件是从一个脉冲的前沿到下一个脉冲的前沿。频率以赫兹为单位，即每秒重复事件的次数。</li><li id="4e2a" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">周期</strong>——同样来自维基百科，<em class="my">周期是重复事件中一个周期的持续时间。</em>周期以秒为单位。所以周期是一件事需要多长时间，而频率是一件事在给定时间内发生的次数。这使得周期是频率的倒数，反之亦然，即。、<em class="my">每事件单位时间</em>与<em class="my">每时间单位事件</em>。在上图中，周期为10毫秒(ms)。所以上图中的频率是<code class="fe nr ns nt nh b">1/.01</code>或者100。由于频率是以赫兹或事件/秒为单位测量的，所以上图中的频率是100赫兹。</li><li id="67e3" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">时钟源</strong> —也称为时钟，它设置时钟前进的速率。</li><li id="68a3" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir"> PWM时钟</strong>——有时也被称为时钟，所以这有点让人困惑。PWM时钟的基本输入是时钟源。不同的硬件设备，如电机和伺服系统，只在特定的周期范围内工作。对于这些器件来说，时钟源通常太快。PWM时钟是通过将时钟源的频率除以一个数字来创建的，该数字将导致PWM时钟以适合给定器件的频率工作。不同的器件需要不同的PWM时钟速度。在此计算中用作分母的数字在软件库和<a class="ae lr" href="https://www.raspberrypi.org/app/uploads/2012/02/BCM2835-ARM-Peripherals.pdf" rel="noopener ugc nofollow" target="_blank"> BCM2835数据手册</a>中经常被称为<strong class="kx ir">除数</strong>。</li><li id="7b9d" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">脉冲</strong> —来自PWM中的“P”。这是PWM引脚输出设为高电平或低电平的最短时间。其最小长度由PWM时钟的速度决定。我将在整个文档中使用pulse，主要是因为它在名称中。</li><li id="ad2d" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">范围</strong> —范围可以被认为是一个计数PWM时钟脉冲的计数器。范围与PWM时钟频率之比可视为发送至PWM引脚的信号频率。我还见过周期长度这个术语被用作范围的别名。</li><li id="c776" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">脉冲宽度</strong> —脉冲宽度是一个脉冲的持续时间。在各种软件库中我见过叫<em class="my">宽度</em>、<em class="my">数值</em>、<em class="my">数据</em>、<em class="my">占空比长度</em>的。</li></ul><h1 id="0193" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基本概念</h1><ul class=""><li id="51a7" class="mp mq iq kx b ky mk lb ml le og li oh lm oi lq ne mv mw mx bi translated"><strong class="kx ir">占空比</strong>是脉冲宽度与范围的比值，即<code class="fe nr ns nt nh b">Pulse-Width/Range</code>。对于10的范围和5的脉冲，占空比是5/10或50%。占空比调节PWM器件的输出电压。对于50%的占空比和5伏的输入电压，输出电压将是2.5伏。</li><li id="ea2a" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">软件与硬件PWM</strong>——就本文而言，有两种方式产生PWM信号，基于软件的和基于硬件的(<a class="ae lr" href="https://stackoverflow.com/questions/50427275/raspberry-how-does-the-pwm-via-dma-work" rel="noopener ugc nofollow" target="_blank">还有一种方式</a>)。基于硬件的PWM由专用硬件PWM设备产生，该专用硬件PWM设备可以被配置成产生如上所述的PWM信号。基于硬件的PWM产生非常一致的时序信号。例如，需要均匀的信号来产生无闪烁的光源，如LED。基于软件的PWM直接在执行程序中实现，使用一个永不结束的<code class="fe nr ns nt nh b">while(true)</code> for循环，控制引脚允许电流流动(脉冲)的时间量与引脚不允许电流流动的时间量。在这种情况下，信号的一致性由语言的<code class="fe nr ns nt nh b">sleep()</code>函数和OS (Linux)调度程序的准确性决定。例如，不均匀的信号可能导致光源闪烁。在Raspberry Pi堆栈交换网站上有关于软PWM和PWM之间的差异以及相关利弊的更完整描述。</li><li id="2a15" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated"><strong class="kx ir">平衡与传号/空号</strong>是指用于确定如何产生PWM输出信号的方法。有两种算法，平衡和标记/间隔。平衡表示占空比将在整个范围内均匀分布。也就是说，脉冲宽度将被分成一组分布在整个范围内的更短的脉冲。相比之下，在传号/空号中，脉冲是作为称为“传号”的单个信号产生的。范围内剩余的时间<code class="fe nr ns nt nh b">range-pulseWidth</code>称为“空间”。在空间持续时间内没有信号出现。标记/间隔通常足够好，但是随着周期变长，标记和间隔持续时间之间的绝对时间差也变长。对于大比率的<code class="fe nr ns nt nh b">range/PWMClockFrequency</code>，例如1 ( <em class="my">，其等于1Hz，因为分母单位是频率</em>)和50%的占空比，空间将是500毫秒，标记将是500毫秒。这种差异大到足以在设备的行为中辨别出来。例如，电机可能会喘振或灯光闪烁。相反，平衡模式将消除这些差异。对于相同的1Hz范围和50%占空比，平衡模式可能每2毫秒产生500个1毫秒信号(<code class="fe nr ns nt nh b">1/(500 * .002) = 1 = 1Hz</code>)。产生相同的50%占空比，但输出信号更加平滑。BCM2835等硬件实现支持这两种算法。在软件中支持这两种算法是可能的，但是根据所实现的算法，它们可能会消耗大量的CPU。</li></ul><h1 id="e840" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">树莓Pi 3B+上的PWM概述</h1><p id="754e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">物理PWM通过BCM2835的GPIO引脚实现。BCM2835板有40个引脚，其中一部分是GPIO引脚。在<a class="ae lr" href="https://pinout.xyz/" rel="noopener ugc nofollow" target="_blank"> GPIO引脚</a>中，有4个硬件PWM引脚，分别是13、19、12和18。其余的GPIO引脚以及硬件GPIO引脚可用于软件PWM。</p><p id="996f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">BCM2835板上有多个时钟源。本文中GPIO库使用的时钟源称为振荡器。它的频率在几个参考文献中记载为19.2MHz，周期约为52纳秒(1 / 19，200，000 = ~0.000000052秒)。</p><p id="22fe" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">BCM2835板还实现了一个称为通道的东西。硬件PWM引脚由一个通道控制。PWM时钟、范围和脉冲宽度是为一个通道指定的。连接到该通道的所有硬件引脚将共享相同的范围、脉冲宽度和占空比。BCM2835板有两个通道。GPIO引脚18和12在一个通道上，13和19在另一个通道上。这意味着，发送到共用一个通道的任一引脚的信号都会同时到达这两个引脚。例如，在GPIO12上发送信号也将与GPIO18共享，反之亦然。</p><h1 id="77b2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在树莓Pi上探索PWM</h1><p id="0456" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">本练习的设置类似于组合<a class="ae lr" href="https://docs.sunfounder.com/projects/raphael-kit/en/latest/1.1.1_blinking_led_c.html" rel="noopener ugc nofollow" target="_blank"> SunFounder闪烁LED </a>和<a class="ae lr" href="https://docs.sunfounder.com/projects/raphael-kit/en/latest/1.1.2_rgb_led_c.html" rel="noopener ugc nofollow" target="_blank"> Sunfounder RGB LED </a>项目。如果你熟悉试验板的布线，下面的图表可能就是你需要开始的全部。否则，可能值得看看Sunfounder的LED项目和对试验板的<a class="ae lr" href="http://wiki.sunfounder.cc/index.php?title=Breadboard_Basics_%E2%80%93_Types" rel="noopener ugc nofollow" target="_blank">介绍</a> <a class="ae lr" href="https://youngkin.github.io/post/pulsewidthmodulationraspberrypi/#fn:10" rel="noopener ugc nofollow" target="_blank"> 10 </a>。两个图中使用的电阻都是220欧姆。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/8410dc60876ad336d9efd401ed7640f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ObQIsuYxUFzB7zCBeOoSjw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:<a class="ae lr" href="http://www.oomlout.co.uk" rel="noopener ugc nofollow" target="_blank">oomloout</a></p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/568dc15ca2ddf24fef3a7d9b7af76de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OQSRDpELm2VsjVz6.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">软件PWM的试验板布线—图片来源:作者</p></figure><p id="8818" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一个设置将用于演示非PWM引脚上的软件PWM。黑线是地线。上面的黑线将电路板<em class="my"> GND </em>引脚连接到试验板上的接地总线。下面的黑线将接地总线连接到红色LED的负极引脚(负极引脚较短)。红线代表正电流。它将GPIO6连接到红色LED的正极引脚(正极引脚较长)。注意跨接在红色导线和LED正极引脚之间的220欧姆电阻。这是为了避免烧坏LED。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/7f9ac89fd01142c4b3007ec7a6e0f74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3H_d2q0rrAr3ZJM-.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">硬件PWM的RGB试验板设置—图片来源:作者</p></figure><p id="0854" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一个设置将用于演示硬件PWM引脚上的硬件和软件PWM。俯视试验板，RGB LED引脚设置如下:</p><ul class=""><li id="8199" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq ne mv mw mx bi translated">红色引脚位于RGB LED的顶部。它用红线连接到GPIO引脚13。</li><li id="339f" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">地面是下一个倒下的。它用黑线连接到地面总线。与上面的红色LED一样，较长的那条腿是地面。</li><li id="c1d9" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">绿色大头针离地1。它用白线连接到GPIO引脚18。</li><li id="8b3a" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">蓝色引脚位于RGB LED的底部。它用蓝线连接到GPIO引脚19。</li></ul><p id="7746" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与上图一样，220欧姆电阻将GPIO引脚桥接至LED的红色、绿色和蓝色引脚。</p><p id="de27" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该设置显示了连接到GPIO硬件PWM引脚18的LED(白线)上的绿色引脚。可以使用不同的硬件PWM引脚，例如12、13和19。此外，不需要使用RGB LED。任何类型的LED都可以工作。不过，它必须以类似的方式接线，即LED正极引线应连接到硬件PWM引脚(白线)，LED的接地引线(最长的引线)应连接到电路板的地。</p><p id="ed64" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您选择使用RGB LED引脚，请务必注意，只有两种颜色可以由硬件PWM控制。这些引脚需要位于不同的PWM通道上。在上图中，连接到GPIO引脚13和19(蓝色和红色)的红色和蓝色引脚演示了这种限制。回想一下，GPIO引脚13和19共享一个通道。因此，发送到一个引脚的信号会传播到另一个引脚。为了获得真正的RGB LED颜色，需要软件PWM，以及不同通道上最多2个硬件引脚。虽然可以使用硬件引脚，但也可以使用所有非硬件引脚。</p><p id="c502" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当上述两种设置同时连接时，使用不同的PWM设置组合会更容易。它允许任何GPIO引脚由<em class="my"> PWM Explorer </em>使用，但对于硬件PWM，LED必须安装在硬件PWM引脚上(GPIO引脚13、19、18和12)。如果使用一个以上的硬件引脚，它们必须在不同的通道上。</p><h1 id="2b78" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用PWM Explorer驱动PWM</h1><p id="55d2" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">PWM Explorer支持C和Go。选择C，您可以尝试传号/空号和平衡PWM模式。我用的Go库，<a class="ae lr" href="https://github.com/stianeikeland/go-rpio" rel="noopener ugc nofollow" target="_blank"> go-rpio </a>，只支持Mark/Space。</p><p id="cf86" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如上面的<strong class="kx ir">先决条件</strong>部分所述，我写了一个名为<em class="my"> PWM Explorer </em>的应用程序，在Raspberry Pi上试验PWM。该软件可用于驱动PWM和非PWM引脚上的PWM。它还支持改变各种PWM参数，如除数、范围和脉冲宽度，以直观地反馈这些参数对连接到引脚的led行为的影响。这个软件可以在我的<a class="ae lr" href="https://github.com/youngkin/gpio" rel="noopener ugc nofollow" target="_blank"> gpio GitHub库</a>上获得。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/bd284c4e83c3b6b0cbbd40a4ed56bbe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YFeHbdmb_dzc7oDm.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">PWM Explorer —图片来源:作者</p></figure><p id="4ffe" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上图是主程序的屏幕截图，标签上简要描述了用户界面的各个部分。这是一个基于文本的UI，所以它可以在没有安装桌面功能的Raspberry Pi上运行。它可以通过导航到<code class="fe nr ns nt nh b">gpio/pwmdemo/pwmexplorer</code>目录下的安装目录并运行<code class="fe nr ns nt nh b">sudo /usr/local/go/bin/go run main.go</code>在命令行运行。需要<code class="fe nr ns nt nh b">sudo</code>是因为一些GPIO访问需要<code class="fe nr ns nt nh b">root</code>权限。除了主UI应用程序，在<code class="fe nr ns nt nh b">gpio/pwmdemo/pwmexplorer/apps</code>目录中还有两个支持程序<code class="fe nr ns nt nh b">freqtest.go</code>和<code class="fe nr ns nt nh b">freqtest.c</code>。这些是使用go-rpio和WiringPi库与Raspberry Pi 3B+上的PWM功能进行交互所需的代码的实际实现。分别用Go和C写的。必须在运行PWM Explorer之前构建C程序。这是通过切换到<code class="fe nr ns nt nh b">gpio/pwmdemo/pwmexplorer/apps</code>目录并运行<code class="fe nr ns nt nh b">gcc -o freqtest freqtest.c -lwiringPi -lpthread</code>来完成的。</p><p id="7972" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">支持多种PWM参数。这些是:</p><ol class=""><li id="90af" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><strong class="kx ir"> PWM引脚</strong> —此项允许您选择要使用的PWM硬件引脚。下拉列表中可用的pin特定于所选的语言。c使用WiringPi库，该库使用自己的管脚编号方案。Go使用标准GPIO引脚编号</li><li id="6535" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">非PWM引脚</strong> —此项允许您指定要使用的PWM引脚，甚至是硬件引脚。PWM引脚和非PWM引脚是互斥的，程序将阻止您指定两者。与上面的PWM引脚一样，编号方案特定于所选的语言，C或Go。该计划没有提供保护，防止使用错误的引脚编号方案，所以要小心你所指定的。如果所选的插针不符合预期，可能是因为您使用了错误的插针编号方案。</li><li id="fb4e" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">时钟频率/时钟除数</strong> —此项用于设置PWM时钟频率。go-rpio库支持直接指定PWM时钟频率。C WiringPi库使用上面定义的除数概念来设置PWM时钟频率。通过将Raspberry Pi 3B振荡器时钟的频率19，200，000赫兹除以所需的PWM时钟频率，可以计算出要使用的除数。比如说。要获得100kHz PWM时钟频率，请将19200000除以100000。这一计算给出了要使用的时钟除数，本例中为192。为了避免混淆，当选择C语言时，标签将是<em class="my">时钟除数</em>。当Go为所选语言时，该项目标签将为<em class="my">时钟频率</em>。</li><li id="39c5" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir"> PWM模式</strong> —此项用于指定是使用传号/空号模式还是平衡模式。注意:语言、引脚类型(PWM与非PWM)和PWM类型(硬件/软件)的某些组合不支持平衡模式。在这种情况下，在<em class="my">消息</em>区域会显示一条消息。Go go-rpio库不支持平衡模式。</li><li id="ddd2" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">范围</strong> —在上面的<strong class="kx ir">术语</strong>部分中定义的期望范围。</li><li id="3539" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir">脉冲宽度</strong>——如上文<strong class="kx ir">术语</strong>部分所定义的所需脉冲宽度。</li><li id="55f6" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><strong class="kx ir"> PWM类型</strong> —此项用于指定是使用硬件还是软件PWM。</li></ol><p id="009c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">根据终端尺寸，一些<em class="my">帮助</em>和<em class="my">代码</em>文本可能不可见。为了解决这个问题，<em class="my">帮助</em>和<em class="my">代码</em>部分都是可滚动的。</p><h2 id="2928" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">试验PWM参数</h2><p id="e9fc" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如前所述，WiringPi和go-rpio库都使用Raspberry Pi 3B的振荡器时钟，其频率为19.2MHz。这是固定的，不能更改。但是除了所选的引脚之外，时钟频率/除数、PWM模式、范围、脉冲宽度和PWM类型都可以修改。所有这些都直接或间接地相互作用。在这一部分，我将解释这些关系以及它们是如何相互作用的。您可以使用PWM Explorer直接查看我将解释的效果。</p><p id="e501" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本节使用LED来演示各种参数对器件的影响。人眼有一个特性需要了解。人眼以对数方式感知亮度的线性变化。具体来说，在脉冲宽度设置的低端(较低电压)，给定设置的变化将产生比高端(较高电压)的相同变化更显著的结果<a class="ae lr" href="https://youngkin.github.io/post/pulsewidthmodulationraspberrypi/#fn:18" rel="noopener ugc nofollow" target="_blank"> 18 </a>。PWM浏览器不会对此进行补偿。</p><h2 id="09a2" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">PWM时钟频率/时钟除数</h2><p id="0730" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">首先要决定的是希望PWM时钟以什么频率运行。使用Go时直接指定其频率，使用c时通过除数指定，选择该频率受所用PWM器件类型的影响，例如LED或电机。本文并没有介绍如何计算这个频率，但是有资料可以介绍(参见参考文献3 &amp; 4)。相反，我将重点讨论时钟频率对LED器件的一般影响。</p><p id="0a4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可能知道也可能不知道，人眼可以检测到大约60Hz及以下频率的闪烁。使用周边视觉时，闪烁更明显。鉴于此，PWM时钟频率范围<code class="fe nr ns nt nh b">PWMClockFrequency / Range</code>低于60Hz是不理想的，除非你试图创造一个闪烁的LED。假设范围不可修改，选择正确的时钟频率/除数将直接影响LED是稳定光源、闪烁还是闪烁。</p><p id="23e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一些设置来尝试这个<em class="my">(这些假设LED连接到GPIO引脚18) </em>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/cfadd2bd8b78f9cc73483fd851860430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIwCErYjSjcbsXj1WR1NCA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="fbd1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用上述设置将导致引脚频率为30Hz。因为这远低于60Hz，所以闪烁会很明显。改变PWM时钟频率/时钟除数将导致引脚频率为62.5Hz。结果将是没有明显的闪烁。</p><p id="9f17" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">注意:</strong>BCM 2835上的“通用时钟分频器”具有12位的寄存器宽度(参见BCM2835 的<a class="ae lr" href="https://www.raspberrypi.org/app/uploads/2012/02/BCM2835-ARM-Peripherals.pdf" rel="noopener ugc nofollow" target="_blank"> Broadcom规格，第108页，<code class="fe nr ns nt nh b">DIVI</code>域位23至12)。这意味着时钟除数的最大值是4095 (0到2^12-1).go-rpio进一步指出，低于4688Hz的PWM时钟频率将导致“意外行为”(rpio.go，参见<code class="fe nr ns nt nh b">SetFreq()</code>功能的注释)。其他来源指出，9.6Mhz是可用的最高PWM时钟频率(19.2Mhz/2)。我在低于4688Hz和高于9.6Mhz的频率下都看到了意想不到的结果。</a></p><h2 id="e7b4" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">范围</h2><p id="6db3" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">范围有效地决定了GPIO引脚的信号频率。这意味着引脚的频率由<code class="fe nr ns nt nh b">PWM Clock Frequency/Range</code>的比值决定。range决定的另一个因素是进入设备的信号的分辨率。回想一下，占空比是脉冲宽度与范围的比值。从较低的范围值(比如4)开始，将占空比限制为0%、25%、50%、75%或100%。换句话说，在4的范围内，唯一有意义的脉冲宽度值是0、1、2、3、4。这反过来限制了LED亮度或闪烁的范围。</p><p id="270e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于范围会影响引脚<em class="my">的频率和</em>的分辨率，因此结合选择正确的PWM时钟频率、范围和脉冲宽度非常重要。从低PWM时钟频率开始会限制范围的选择，进而限制可用的占空比。</p><p id="e4fe" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">举个例子，让我们选择两个极端。首先，我们选择PWM时钟频率为5kHz，范围为5。分辨率为5。这意味着只有5个可用的占空比，包括全开和全关。如上所述，这限制了像LED这样的灯的可用亮度设置。</p><p id="d817" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是尝试这个例子的设置<em class="my">(第二个例子的设置在括号内)</em>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/b62ca08171b98333439338ea738c0fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q43c8YRJ1S6JPdnWskVG6w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="3937" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后将脉冲宽度改为5。这将是LED的最亮设置。虽然它明显比1的脉冲宽度更亮，但由于范围较窄，它并没有亮多少。</p><p id="57c4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在另一个极端，让我们配置一个LED从关闭到全亮度非常平滑的过渡。这将需要更高的分辨率。让我们疯狂一下，决定我们想要10，000级的亮度。这意味着范围为10，000。为了避免可见的闪烁，我们需要在GPIO引脚上有至少60Hz的信号。由于<code class="fe nr ns nt nh b">PWM Clock Frequency/Range</code>的比值决定了引脚处的信号频率，我们将需要至少600kHz的PWM时钟频率。60Hz的最小引脚信号频率的10000倍的范围是600kHz (10，000 * 60 = 600，000)。检查我们的工作，<code class="fe nr ns nt nh b">PWM Clock Frequency / Range</code>，60万/ 1万= 60 (Hz)。</p><h2 id="fba0" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">脉冲宽度</h2><p id="69e7" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在更高的GPIO引脚频率下，脉冲宽度会影响LED的亮度。在较低的GPIO引脚频率下，脉冲宽度可以通过LED开启的时间长度与闪烁速率来显示。让我们再次用极端的例子来说明这一点。</p><p id="a378" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于第一个例子，我们使用1MHz的PWM时钟频率和10，000的范围。GPIO引脚的频率将为100Hz，足够快以至于看不到闪烁。10，000的范围同样足够高，以至于我们无法辨别LED亮度的离散步长。</p><p id="7bef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是第一个示例的设置:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/1be45a12af0a4f3335cc06af13416af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dYRZx-slWz1KUOVmYqWmAg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="9850" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于第二个示例，将时钟频率(Go)更改为5000，时钟除数(C)更改为3840，范围更改为10000，脉冲宽度更改为5000。LED将闪烁非常短的时间，并且大约每2秒钟重复闪烁一次(时钟频率/范围，5000/10000 = 0.5Hz或每2秒钟一次)。现在将脉冲宽度改为5000。现在，LED将亮起1秒钟，熄灭1秒钟。这使得占空比从2%变为50%，LED闪烁的持续时间也相应改变。本例展示了如何使用PWM创建闪烁的灯，只需选择一个PWM时钟频率和范围，使GPIO引脚频率非常低，远低于60Hz。</p><h2 id="8096" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">PWM模式</h2><p id="b9ab" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">可用的PWM模式有平衡模式和占空比模式。回想一下，对于传号/空号，信号在范围内的固定持续时间内为开或关(高或低)。例如，占空比为50%，范围为10，信号将连续打开5秒钟，关闭5秒钟。如上所述，平衡模式将该50%的占空比均匀地分布在整个范围内，这将使占空比的影响不太明显，除了LED的变暗(例如，10ms脉冲，每10ms，10秒内500次)。</p><p id="288c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了说明这种行为，将时钟频率设置为4688 (Go)，时钟除数设置为4095 (C)，PWM模式设置为markspace，范围设置为1000，脉冲宽度设置为10，PWM类型设置为硬件。这导致LED以大约4.69Hz或几乎5/秒的引脚频率闪烁。现在将PWM模式改为平衡模式。语言必须是C才能使用平衡模式，因为go-rpio只支持标记/空格。现在眨眼不再明显。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/c8e52bfcd80da6bc4fb0265ab7617fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQTAfdg7azyfFS6T8i77yA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><h2 id="96e4" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">PWM类型</h2><p id="059e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">可用的PWM类型有<em class="my">硬件</em>和<em class="my">软件</em>。上面的例子只使用了硬件PWM。这是因为真正的平衡模式仅在硬件上可用。此外，Go和C中实现的软件PWM更类似于平衡模式，而绝对不是传号/空号模式。Go和C版本都有硬编码的100MHz时钟。前面部分中的一些示例依赖于传号/空号行为，尤其是PWM模式部分。</p><h2 id="5dd1" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">其他可以尝试的事情</h2><p id="924c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">要了解上述方法在非PWM引脚上的工作原理，请使用PWM类型的软件在非硬件PWM引脚上尝试上述部分或全部方法。在这些测试中监控CPU使用情况可能会显示硬件PWM和软件PWM的CPU使用情况之间的一些差异。</p><h2 id="b900" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">PWM浏览器代码</h2><p id="48e4" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在<a class="ae lr" href="https://github.com/youngkin/gpio" rel="noopener ugc nofollow" target="_blank"> PWM浏览器</a> GitHub库中的代码被广泛的评论。为了避免重复代码中最清楚的内容，这里就不多说了。这两个程序的结构基本上是相似的，尽管在如何使用Go和C库来完成相同的任务上有所不同。</p><h2 id="b696" class="nl lt iq bd lu nu nv dn ly nw nx dp mc le ny nz me li oa ob mg lm oc od mi oe bi translated">关键要点</h2><ol class=""><li id="f6ee" class="mp mq iq kx b ky mk lb ml le og li oh lm oi lq mu mv mw mx bi translated">在Raspberry Pi上，只有4个硬件PWM引脚和2个通道。每个通道有2个引脚。这将有效硬件PWM引脚的数量减少到2个。</li><li id="1ced" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">指定时钟频率或时钟除数时必须小心。PWM时钟频率的可接受范围为4688Hz至9.6Mhz。</li><li id="a659" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">范围决定了GPIO引脚的频率和LED或电机等设备的信号分辨率。第一个因素是频率，因为在较低的引脚频率下，引脚的开/关状态变得非常明显，就像LED灯闪烁一样。第二个是分辨率，它很重要，因为它定义了设备控制的精细程度。例如，在低分辨率下，只有有限的一组LED亮度可供选择，差异非常明显。在更高的分辨率下，脉冲宽度的微小变化将导致非常小的、几乎不可辨别的亮度变化。这在实现诸如调光器之类的东西时很重要，在调光器中，从关闭到完全打开的亮度变化不应该以大的、可辨别的亮度步长变化。即希望在整个范围内有更平滑的过渡。</li><li id="470b" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">对于更高的分辨率(范围)，应选择更高的PWM时钟频率。这确保GPIO引脚频率不会降得太低，例如，低于避免LED灯闪烁所需的60Hz频率。</li><li id="0de9" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">在更高的GPIO引脚频率下(例如，高于60Hz)，改变脉冲宽度将导致LED看起来更暗或更亮。</li><li id="d7bd" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">在较低的GPIO引脚频率下(例如，低于60Hz，尤其是低于10Hz)，脉冲宽度可用于产生明显的脉冲，如闪烁的LED灯。灯亮的时间长度与脉冲宽度成正比。</li><li id="882e" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">PWM模式的选择也会影响信号的“平滑度”。即使在通常会导致LED闪烁的低GPIO频率下，平衡模式也会减少这种影响，通常会使其变得不明显。</li><li id="098e" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">PWM类型(软件与硬件)会影响PWM信号周期的一致性，甚至超过60Hz时，LED也会明显闪烁。它还会导致支持所需时钟速率所需的CPU负载量过大。</li><li id="8b96" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">可以使用软件PWM，但产生的信号可能过于粗糙，不适用于某些器件。</li><li id="6f52" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">设置一个大于PWM时钟频率的范围可能看起来很奇怪，但它可以有效地用于创建一个低频脉冲信号，该信号可用于使LED闪烁等。</li></ol><h1 id="748d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="5ef2" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">希望到现在为止，你已经有足够的知识在Raspberry Pi 3B+上，或者在其他Raspberry Pi模型上，甚至在其他平台上有效地使用PWM。具体来说:</p><ul class=""><li id="1fb8" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq ne mv mw mx bi translated">我们已经讨论了各种术语，因此您现在应该能够阅读大多数关于PWM的文献，并理解这些资料中使用的概念和术语。</li><li id="4107" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">如果您在Raspberry Pi上安装并试验了PWM，那么现在您已经在Raspberry Pi上安装了一个完整的、可工作的GPIO测试平台。</li><li id="6279" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">您应该了解各种PWM设置以及它们之间的相互作用。</li><li id="5344" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">如果您使用了<em class="my"> PWM Explorer </em>应用程序，那么您将拥有使用各种PWM设置组合的宝贵实践经验。当你有问题或测试假设时，你可以继续使用<em class="my"> PWM浏览器</em>来试验各种设置。</li><li id="e404" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq ne mv mw mx bi translated">通过阅读Go和/或C代码，您现在知道如何有效地使用go-rpio和/或WiringPi库。即使你决定使用其他库，比如<a class="ae lr" href="https://abyz.me.uk/rpi/pigpio/pdif2.html" rel="noopener ugc nofollow" target="_blank"> pigpio </a>，你也应该很好地理解这些术语，以便有效地使用它们，或者至少在学习如何使用它们方面有一个良好的开端。</li></ul><h1 id="929b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><ol class=""><li id="d665" class="mp mq iq kx b ky mk lb ml le og li oh lm oi lq mu mv mw mx bi translated"><a class="ae lr" href="https://github.com/youngkin/gpio" rel="noopener ugc nofollow" target="_blank"> PWM Explorer </a>是本文附带的一个应用程序，可用于试验各种PWM设置。它使用Go和C库演示了PWM。</li><li id="334c" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://www.allaboutcircuits.com/technical-articles/introduction-to-microcontroller-timers-pwm-timers/" rel="noopener ugc nofollow" target="_blank">微控制器定时器介绍:周期定时器</a>是一个很好的定时器通用介绍。PWM硬件是一种周期性定时器。看这个介绍很有用。</li><li id="5e98" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://www.allaboutcircuits.com/technical-articles/introduction-to-microcontroller-timers-pwm-timers/" rel="noopener ugc nofollow" target="_blank">微控制器中的脉宽调制(PWM)定时器</a>很好地详细讨论了PWM定时器。如果你想知道比这里更多的细节，这是一本很好的读物。</li><li id="17db" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://www.iot-programmer.com/index.php/books/22-raspberry-pi-and-the-iot-in-c/chapters-raspberry-pi-and-the-iot-in-c/60-raspberry-pi-and-the-iot-in-c-pulse-width-modulation-servos-and-more" rel="noopener ugc nofollow" target="_blank"> Raspberry Pi和C中的物联网——脉宽调制、伺服等</a>是一本关于在Raspberry Pi上编程GPIO的详细书籍。有一章专门讨论PWM。</li><li id="3c2d" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">WiringPi是一个用于GPIO编程的C库</li><li id="3f87" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://github.com/stianeikeland/go-rpio" rel="noopener ugc nofollow" target="_blank"> go-rpio </a>是用于GPIO编程的go库</li><li id="71c6" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://www.airspayce.com/mikem/bcm2835/" rel="noopener ugc nofollow" target="_blank">Mike McCalley的BCM 2835</a>是另一个GPIO编程的C库。</li><li id="3357" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">pigpio 主要是一个Python库。它还有一个C库。它的特点是在任何GPIO引脚上执行硬件PWM。我不知道它是怎么做到的。</li><li id="4e15" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up" rel="noopener ugc nofollow" target="_blank">设置您的Raspberry Pi </a>是开始使用Raspberry Pi的官方文档，包括所需的硬件以及如何安装操作系统和其他重要细节。</li><li id="1c58" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="http://wiki.sunfounder.cc/index.php?title=Breadboard_Basics_%E2%80%93_Types" rel="noopener ugc nofollow" target="_blank">试验板基础—类型</a>是对试验板及其使用方法的有用介绍。</li><li id="6af0" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="http://wiringpi.com/reference/" rel="noopener ugc nofollow" target="_blank"> WiringPi库参考指南</a>记录了WiringPi的主要功能。网站的其余部分也有一些有用的信息。</li><li id="04da" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">维基百科上的频率页面讨论了频率和周期</li><li id="7c4f" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://www.sensorsone.com/frequency-to-period-calculator/" rel="noopener ugc nofollow" target="_blank">频率-周期计算器</a>便于快速计算或验证频率-周期转换(周期= 1/频率)。</li><li id="9317" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">BCM2835 的<a class="ae lr" href="https://www.raspberrypi.org/app/uploads/2012/02/BCM2835-ARM-Peripherals.pdf" rel="noopener ugc nofollow" target="_blank">完整Broadcom规格，从第138页开始，了解有关BCM2835如何实现PWM的更多详细信息。</a></li><li id="238b" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">关于<a class="ae lr" href="https://www.raspberrypi.org/forums/viewtopic.php?t=150254" rel="noopener ugc nofollow" target="_blank">RPi 3B上的哪个(哪些)引脚支持PWM</a>有详细的讨论。特别是关于4个PWM引脚共享2个PWM通道的效果。Broadcom spec <a class="ae lr" href="https://youngkin.github.io/post/pulsewidthmodulationraspberrypi/#fn:14" rel="noopener ugc nofollow" target="_blank"> 14 </a>也在第139页的第9.4节讨论了这一点，但方式不太明显。</li><li id="4e3b" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated">产生PWM信号有第三种方式，<a class="ae lr" href="https://stackoverflow.com/questions/50427275/raspberry-how-does-the-pwm-via-dma-work" rel="noopener ugc nofollow" target="_blank"> DMA或直接存储器访问</a>。本文这里就不讨论了。</li><li id="fa18" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://pinout.xyz/" rel="noopener ugc nofollow" target="_blank"> RaspberryPPi引脚排列</a>是一个很好的来源，它描述了每个引脚的作用、物理引脚编号，对于GPIO引脚，还描述了BCM2835板的GPIO引脚编号。它有选项卡，可用于突出显示哪些引脚用于何种目的，例如PWM引脚。</li><li id="721d" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://jared.geek.nz/2013/feb/linear-led-pwm" rel="noopener ugc nofollow" target="_blank">线性LED PWM </a>提供了通过PWM改变LED亮度时获得线性比例的指南/公式。在谷歌上搜索“LED PWM线性亮度”,还会出现其他几篇文章。</li><li id="dddf" class="mp mq iq kx b ky mz lb na le nb li nc lm nd lq mu mv mw mx bi translated"><a class="ae lr" href="https://raspberrypi.stackexchange.com/questions/53854/driving-pwm-output-frequency" rel="noopener ugc nofollow" target="_blank">驱动PWM输出频率</a>提供了一些关于26和40 GPIO引脚的Raspberry Pis的有趣信息和讨论。</li></ol></div></div>    
</body>
</html>