<html>
<head>
<title>Build Your First Machine Learning Model With TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TensorFlow建立你的第一个机器学习模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-your-first-machine-learning-model-with-tensorflow-ffc2f7cbf4f2?source=collection_archive---------7-----------------------#2021-09-13">https://betterprogramming.pub/build-your-first-machine-learning-model-with-tensorflow-ffc2f7cbf4f2?source=collection_archive---------7-----------------------#2021-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0483" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解机器学习如何工作的一步一步的实际例子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d9349a8f530f1279fa3afd4f80a4767a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7lx34vYoJ8lAeNU6un7_g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@agk42?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>从<a class="ae ky" href="https://www.pexels.com/photo/high-angle-photo-of-robot-2599244/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><p id="eecd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将一步一步地解释如何使用TensorFlow创建一个简单的机器学习模型。</p><p id="2a1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>是谷歌开发的一个库，于2015年作为开源发布。TensorFlow使建立和训练机器学习模型变得非常简单。</p><p id="44df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们接下来要构建的模型将允许我们自动将公里转换为英里。用数学公式进行这种计算并不神秘，但我们在本例中要做的是创建一个模型，学习如何进行这种转换。</p><p id="2c9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将为模型提供一个输入<a class="ae ky" href="https://en.wikipedia.org/wiki/Comma-separated_values" rel="noopener ugc nofollow" target="_blank"> CSV </a>文件，其中包含已经执行的29种公里和英里之间的转换，基于这些转换，我们的模型将学习自动执行这种转换。</p><p id="cf18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用监督学习算法，因为我们知道数据的输入和输出结果。</p><p id="2031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为编程语言，我们准备用Python。<a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>提供了一系列方便的库和实用程序来处理机器学习。</p><p id="817f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本例中的所有步骤都是使用<a class="ae ky" href="https://www.youtube.com/watch?v=inN8seMm7UI" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>执行的。Google Colab允许我们在零配置的情况下在浏览器中编写和执行Python。</p><h1 id="9cb3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">导入必要的库</h1><p id="eeb4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们从导入我们将在示例中使用的库开始。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入必要的库。</p></figure><ul class=""><li id="63fc" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">我们将导入TensorFlow来创建我们的机器学习模型。</li><li id="b75a" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">我们还将导入Pandas库来读取CSV文件，将公里转换为英里。</li><li id="751c" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">最后，我们将导入Seaborn和Matlotlib库来描绘不同的结果。</li></ul><h1 id="0460" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">加载样本数据</h1><p id="32d7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将逗号分隔值(公里-英里. csv)文件读入数据框。这个文件包含了公里和英里值之间的一系列对应关系。我们将使用这个数据帧来训练我们的模型。</p><p id="a099" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以从<a class="ae ky" href="https://drive.google.com/file/d/1m63pJA-zUAA12XOCCBt3Aik9fnjrj_8s/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="53d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">☝从谷歌Colab中读取文件，你可以使用不同的方式。在这种情况下，我将CSV文件直接上传到Google Colab中的sample_data文件夹，但是您也可以从URL读取文件，例如从GitHub。</p><p id="ca93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上传到Google Colab的问题是，当运行时重新启动时，数据会丢失。</p><ul class=""><li id="80e5" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">数据框是一种二维的、大小可变的异构表格数据。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5b25d820103291e40ab08f511ff21ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*xaHjd1HlPDcKiQtKeMhP6A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">样本数据信息。</p></figure><h1 id="c9bb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">绘制数据框</h1><p id="69d9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们使用“seaborn”库的“散点图”方法绘制上述值的图表，我们已经以“sns”的名称导入了该库。它向我们展示了X(公里)和Y(英里)对应关系之间的图形表示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制数据帧。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/b8edf9946baa03d9b2f47116c3441112.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*UH3aU6fMAJ0LcAgJW6g1WA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">公里和英里之间的相互关系。</p></figure><p id="54d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们定义数据帧的输入和输出来训练模型:X(公里)是输入，Y(英里)是输出。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入和输出变量。</p></figure><h1 id="3873" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建神经网络</h1><p id="b4b4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在，让我们使用“keras”。“顺序”方法创建一个“层”被顺序添加到其中的神经网络。每一层都具有逐渐提取输入数据以获得所需输出的功能。</p><p id="b04f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>是一个用Python编写的库，允许我们创建神经网络，访问不同的机器学习框架，比如TensorFlow。</p><p id="5a5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用“添加”方法给模型添加一个层。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创造神经网络。</p></figure><h1 id="e4fd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">编译模型</h1><p id="9423" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在训练我们的模型之前，我们将在编译步骤中添加一些额外的设置。</p><p id="a12d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将建立一个优化器和一个损失函数，它将测量我们的模型的准确性。</p><ul class=""><li id="9df5" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">Adam优化是一种基于一阶和二阶矩的自适应估计的随机梯度下降方法。</li></ul><p id="4078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将使用基于均方差的损失函数，它测量我们预测的均方差。</p><p id="e724" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们模型的目标是最小化这个函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">编译模型。</p></figure><h1 id="37e6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">训练模型</h1><p id="00cd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用“拟合”方法来训练我们的模型。首先，我们传递自变量或输入变量(X公里)和目标变量(Y英里)。</p><p id="27e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，我们指出了历元的数量。在这种情况下，250个历元。一个历元是对所提供的整个X和Y数据的迭代。</p><ul class=""><li id="5892" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">如果历元数少，误差就大，反之亦然。</li><li id="e0d4" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">如果历元的数量很大，算法的执行速度会比较慢。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练模型。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/62b0a9416a895124684667b09acee2de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*xA26Tqci3b_IIx8uZjwc7w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练模型控制台。</p></figure><h1 id="ffda" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">评估模型</h1><p id="74ec" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在，我们评估所创建的模型，其中我们可以观察到损失(Training_loss)随着更多迭代(epoch)的执行而减少，如果训练集数据有意义并且是足够大的组，这是合乎逻辑的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/c679056d9d6f91f7a9baad382154f750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*91scZd10f8DmTLw3BpnH9A.png"/></div></figure><p id="5bc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从图中我们可以看出，用250步训练模型没有多大帮助，并且在第50次迭代之后，误差没有减小。</p><p id="6537" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，训练该算法的最佳步骤数大约是50步。</p><h1 id="365a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">做出预测</h1><p id="98d4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">既然我们已经训练了我们的模型，我们可以用它来做一个预测。</p><p id="d3b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们将值100赋给模型输入变量，模型将以英里为单位返回预测值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">做出预测。</p></figure><p id="716a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从公里到毫勒的换算是62.133785。</p><h1 id="890f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">检查结果</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查结果。</p></figure><p id="eefe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用数学公式从公里到英里的转换如下:62.139999999999999预测误差:0.00621414</p><h1 id="9a50" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">最后的想法</h1><p id="5812" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">通过这个例子，我们看到了如何使用TensorFlow库来创建一个模型，该模型已经学会自动地将公里转换成英里，并且误差很小。</p><p id="ad3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TensorFlow用于执行此过程的数学非常简单。基本上，此示例使用线性回归来创建模型，因为输入变量千米和输出变量英里是相关的。</p><p id="2949" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在机器学习中，过程中最耗时的部分通常是准备数据。</p><p id="2bf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着时间的推移，我们获得了帮助我们选择最合适的算法及其设置的经验和一些直觉，但总的来说，这是一项分析-测试和改进的任务。</p><p id="47c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，考虑通过我的<a class="ae ky" href="https://kesk.medium.com/membership" rel="noopener">个人资料</a>订阅Medium。谢谢大家！</p><h1 id="792b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><div class="nm nn gp gr no np"><a href="https://keras.io/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">keras:Python深度学习API</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">Keras是为人类设计的API，不是为机器设计的。Keras遵循减少认知负荷的最佳实践:it…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">keras.io</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od ks np"/></div></div></a></div><p id="c40a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/getting _ started/index . html</a></p><div class="nm nn gp gr no np"><a href="https://www.tensorflow.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">张量流</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">一个面向所有人的端到端开源机器学习平台。探索TensorFlow灵活的工具生态系统…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.tensorflow.org</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od ks np"/></div></div></a></div><p id="efdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://colab.research.google.com/notebooks/welcome.ipynb? T4】hl=en </p></div></div>    
</body>
</html>