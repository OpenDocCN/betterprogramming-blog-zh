<html>
<head>
<title>How to Use Pandas to Consume Data and Perform Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用熊猫消费数据和执行数据分析</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-pandas-to-consume-data-and-perform-data-analysis-76e000ad5480?source=collection_archive---------7-----------------------#2022-04-14">https://betterprogramming.pub/how-to-use-pandas-to-consume-data-and-perform-data-analysis-76e000ad5480?source=collection_archive---------7-----------------------#2022-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a9cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫数据分析导论</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/792e9fee57c04f5ccb0fb56e5df79c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCVt19YA7PcffHASSw_h-Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">活动创作者</a>在<a class="ae ky" href="https://unsplash.com/s/photos/spreadsheet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><blockquote class="kz la lb"><p id="bb21" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">Pandas是一个<a class="ae ky" href="https://www.python.org" rel="noopener ugc nofollow" target="_blank"> Python </a>包，提供了快速、灵活、富于表现力的数据结构，旨在使处理“关系”或“标签”数据变得既简单又直观。它的目标是成为用Python进行实际的、真实世界的数据分析的基础高级构建块。此外，它还有一个更广泛的目标，那就是成为任何语言中最强大、最灵活的开源数据分析/操作工具。它已经朝着这个目标前进了——来源(<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/</a>)</p></blockquote><h2 id="7c16" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">装置</h2><p id="f19e" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">熊猫入门，先安装一下。建议将pandas安装为Anaconda的一部分，但是我们仍然可以使用pip来安装它。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="6e9a" class="lz ma it nb b gy nf ng l nh ni">pip install pandas</span></pre><p id="7539" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated"><code class="fe nj nk nl nb b">pandas</code>模块通常作为别名<code class="fe nj nk nl nb b">pd</code>导入，所有操作都使用<code class="fe nj nk nl nb b">pd</code>完成，如下图。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="d1f9" class="lz ma it nb b gy nf ng l nh ni">import pandas as pd</span></pre><p id="4d94" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">Pandas支持两种类型的数据结构，即:</p><ul class=""><li id="4dde" class="nm nn it lf b lg lh lj lk mi no mm np mq nq ly nr ns nt nu bi translated">系列</li><li id="7722" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">数据帧</li></ul><p id="ae64" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">一个<code class="fe nj nk nl nb b">DataFrame</code>是一个二维数据结构(<strong class="lf iu">数组中的数组)</strong>可以在行和列中存储不同类型的数据。你可以把它想象成一个电子表格或SQL表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/d2b3d9abba07b20e23e089347bafee6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*cCIztjG_LCMdyzYvjDiuSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图来自<a class="ae ky" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/</a></p></figure><h1 id="cc09" class="ob ma it bd mb oc od oe me of og oh mh jz oi ka ml kc oj kd mp kf ok kg mt ol bi translated">数据帧</h1><p id="d508" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">让我们首先用下面的数据创建一个简单的数据框架。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="6aa1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">这里我们创建一个Python字典，它的键用作列标题，值用作列</p><p id="8731" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="b246" class="lz ma it nb b gy nf ng l nh ni">      First_name Last_name                  Email<br/>0       Matt  Mckinney     <a class="ae ky" href="mailto:mattneey@gmail.com" rel="noopener ugc nofollow" target="_blank">mattneey@gmail.com</a><br/>1      Harry   ndarray  <a class="ae ky" href="mailto:Harryndarry@gmail.com" rel="noopener ugc nofollow" target="_blank">Harryndarry@gmail.com</a><br/>2        ete       Wes      <a class="ae ky" href="mailto:petewes@gmail.com" rel="noopener ugc nofollow" target="_blank">petewes@gmail.com</a></span></pre><p id="998e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">我们的表格有3列，即名字、姓氏和电子邮件。</p><p id="1f8f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">要获得前两行</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="a525" class="lz ma it nb b gy nf ng l nh ni">df.head(2)</span></pre><p id="a5f8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="767f" class="lz ma it nb b gy nf ng l nh ni">      First_name Last_name                  Email<br/>0       Matt  Mckinney     <a class="ae ky" href="mailto:mattneey@gmail.com" rel="noopener ugc nofollow" target="_blank">mattneey@gmail.com</a><br/>1      Harry   ndarray  <a class="ae ky" href="mailto:Harryndarry@gmail.com" rel="noopener ugc nofollow" target="_blank">Harryndarry@gmail.com</a></span></pre><p id="e74e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">创建数据帧的另一种方法是使用如下所示的列表</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><h2 id="0e39" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">读写表格数据</h2><p id="5108" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">让我们从下面的CSV文件中读取数据。CSV(逗号分隔值)包含用逗号分隔的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/aa02fc920d2b211decff933e5552e60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wWk7QAAIDee0Auqj_fMYIA.png"/></div></div></figure><p id="d0e4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">pandas提供了read_csv()函数，用于将csv文件读入pandas DataFrame。其他支持的文件格式包括:</p><ul class=""><li id="349d" class="nm nn it lf b lg lh lj lk mi no mm np mq nq ly nr ns nt nu bi translated">csv，</li><li id="e3b1" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">excel，</li><li id="5210" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">SQL，</li><li id="cb52" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">JSON，</li><li id="e1d8" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">镶木地板</li></ul><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="e0ad" class="lz ma it nb b gy nf ng l nh ni">import pandas as pd<br/>df = pd.read_csv('students.csv')</span><span id="e98e" class="lz ma it nb b gy op ng l nh ni">print(df)</span></pre><p id="3397" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="dd3d" class="lz ma it nb b gy nf ng l nh ni">        student_id first_name last_name<br/>0         1000       Matt    Leakey<br/>1         1001      Nelly     Green<br/>2         1002    Rachael   Johnson<br/>3         1003      David      Wood<br/>4         1004        Bob       Lee<br/>5         1005        Tom     Smith<br/>6         1006     Taylor    Miller<br/>7         1007    Barbara     Stone<br/>8         1008    Marlene      Cook<br/>9         1009     Marlon    Marlon<br/>10        1010     selene    martin</span></pre><p id="0ad2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">您也可以使用<code class="fe nj nk nl nb b">.csv</code>功能将数据加载到CSV。让我们将数据写入CSV文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="7eba" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">输出将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="f27d" class="lz ma it nb b gy nf ng l nh ni">,First_name,Last_name,Email<br/><a class="ae ky" href="mailto:0,Matt,Mckinney,mattneey@gmail.com" rel="noopener ugc nofollow" target="_blank">0,Matt,Mckinney,mattneey@gmail.com</a><br/><a class="ae ky" href="mailto:1,Harry,ndarray,Harryndarry@gmail.com" rel="noopener ugc nofollow" target="_blank">1,Harry,ndarray,Harryndarry@gmail.com</a><br/><a class="ae ky" href="mailto:2,ete,Wes,petewes@gmail.com" rel="noopener ugc nofollow" target="_blank">2,ete,Wes,petewes@gmail.com</a></span></pre><h1 id="45f7" class="ob ma it bd mb oc od oe me of og oh mh jz oi ka ml kc oj kd mp kf ok kg mt ol bi translated">系列</h1><p id="9151" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">系列是可以容纳任何数据类型的一维数组。简单来说，系列就是一列。让我们看看如何使用列。</p><p id="f00c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">让我们假设我们正在处理下面的数据帧</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="8694" class="lz ma it nb b gy nf ng l nh ni">          Name Math Calculus Statistics<br/>0       Matt Harry    70       50         56<br/>1  Mckinney ndarray   67       56         78<br/>2        Cathy Matt   63       65         60<br/>3        Leakey Wes   54       55         56</span></pre><p id="9d06" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">选择列有两种方式，可以使用<code class="fe nj nk nl nb b">dictionary[key]</code>格式或<code class="fe nj nk nl nb b">dictionary.key</code>格式。</p><p id="4496" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">如果我们希望选择数学列，我们应该</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="01f5" class="lz ma it nb b gy nf ng l nh ni">print(df['Math'])<br/>    #or</span><span id="72cc" class="lz ma it nb b gy op ng l nh ni">print(df.Math)</span></pre><p id="3e86" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">两个print语句的结果应该如下所示。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="32c2" class="lz ma it nb b gy nf ng l nh ni">0     70<br/>1     67<br/>2     63<br/>3     54<br/>Name: Math, dtype: object<br/>0     70<br/>1     67<br/>2     63<br/>3     54<br/>Name: Math, dtype: object</span></pre><p id="9034" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">如果列包含空格或特殊字符，则使用dictionary[key]格式；例如，如果我们有一个名为“体育”的列，我们将选择它，如下所示</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="6487" class="lz ma it nb b gy nf ng l nh ni">df['physical education']</span></pre><h2 id="21df" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">使用列</h2><p id="bd57" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">我们已经学习了如何从列中选择数据，现在让我们开始处理这些数据；让我们将数学列中的数据存储在一个名为math_data的变量中</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="df29" class="lz ma it nb b gy nf ng l nh ni">math = df.Math<br/>print(math)</span></pre><p id="7e44" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">我们也可以选择多个列，如下所示</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="4194" class="lz ma it nb b gy nf ng l nh ni">df_data =df[['Math','Calculus']]</span><span id="d492" class="lz ma it nb b gy op ng l nh ni">print(df_data)</span></pre><p id="8bed" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="eb48" class="lz ma it nb b gy nf ng l nh ni">   Math Calculus<br/>0   70       50<br/>1   67       56<br/>2   63       65<br/>3   54       55</span></pre><p id="68ed" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">因为数据包含不止一列，所以它不再是一个系列，而是一个数据框架。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="71f2" class="lz ma it nb b gy nf ng l nh ni">print(type(df_data))</span></pre><p id="6f8a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">输出是</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="3d9b" class="lz ma it nb b gy nf ng l nh ni">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></pre><h2 id="5dd9" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">使用行</h2><p id="6381" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">要选择一行，我们使用<code class="fe nj nk nl nb b"> dataframe. iloc </code>属性并传入该行的索引。例如，要获得我们的<code class="fe nj nk nl nb b">dataframe</code>中最后一个学生的行数据，我们应该这样做:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="dd45" class="lz ma it nb b gy nf ng l nh ni">print(df.iloc[-1])</span></pre><p id="7500" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="90cf" class="lz ma it nb b gy nf ng l nh ni">Name          Leakey Wes<br/>Math                  54<br/>Calculus              55<br/>Statistics            56</span></pre><p id="5f42" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">如果你传递一个不存在的索引，<code class="fe nj nk nl nb b">iloc</code>属性将引发一个IndexError。例如，如果您传递6作为索引</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="ba33" class="lz ma it nb b gy nf ng l nh ni">print(df.iloc[6])</span></pre><p id="6220" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">您将得到以下错误</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="5393" class="lz ma it nb b gy nf ng l nh ni">raise IndexError("single positional indexer is out-of-bounds")<br/>IndexError: single positional indexer is out-of-bounds</span></pre><p id="fe0d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">您也可以选择多行，就像我们选择列一样。但是首先，让我们向数据框架添加更多的数据。它现在应该是这样的:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="0f16" class="lz ma it nb b gy nf ng l nh ni">Name Math Calculus Statistics<br/>0       Matt Harry    70       50         56<br/>1  Mckinney ndarray   67       56         78<br/>2        Cathy Matt   63       65         60<br/>3     Thomas Thomas   64       75         46<br/>4      Richard Grey   74       65         56<br/>5       Ching Chang   44       55         46<br/>6          Jim Cary   64       65         76</span></pre><p id="37f1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">例如，让我们选择第二、第三和第四行中的数据</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="8c1e" class="lz ma it nb b gy nf ng l nh ni">print(df.iloc[2:5])</span></pre><p id="5caf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">结果将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="405c" class="lz ma it nb b gy nf ng l nh ni">             Name Math Calculus Statistics<br/>2     Cathy Matt   63       65         60<br/>3  Thomas Thomas   64       75         46<br/>4   Richard Grey   74       65         56</span></pre><h1 id="639a" class="ob ma it bd mb oc od oe me of og oh mh jz oi ka ml kc oj kd mp kf ok kg mt ol bi translated">添加和修改行和列</h1><p id="8b65" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">到目前为止，我们已经能够使用现有数据，现在让我们学习如何</p><ul class=""><li id="c384" class="nm nn it lf b lg lh lj lk mi no mm np mq nq ly nr ns nt nu bi translated">向行和列中添加新数据</li><li id="8ebb" class="nm nn it lf b lg nv lj nw mi nx mm ny mq nz ly nr ns nt nu bi translated">重命名列</li></ul><h2 id="d4c2" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">添加新列</h2><p id="96f7" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">假设我们想为一个新的主题添加一个新的列，让我们这样做。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="fe7d" class="lz ma it nb b gy nf ng l nh ni">df['Quantitative Analysis'] = [60,56,78,45,64,78,69]</span><span id="8a74" class="lz ma it nb b gy op ng l nh ni">print(df)</span></pre><p id="c7b9" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">我们的新数据将是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="c6de" class="lz ma it nb b gy nf ng l nh ni">Name Math Calculus Statistics  Quantitative Analysis<br/>0       Matt Harry    70       50         56                     60<br/>1  Mckinney ndarray   67       56         78                     56<br/>2        Cathy Matt   63       65         60                     78<br/>3     Thomas Thomas   64       75         46                     45<br/>4      Richard Grey   74       65         56                     64<br/>5       Ching Chang   44       55         46                     78<br/>6          Jim Cary   64       65         76                     69</span></pre><h2 id="655b" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">重命名列</h2><p id="6e60" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">考虑以下数据帧:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="db7e" class="lz ma it nb b gy nf ng l nh ni">       Product Name   Cost<br/>0  Tony valencia 7047   36.5<br/>1  Tony valencia 6171   28.5<br/>2  Tony valencia 7050   36.5<br/>3  Tony valencia 7056   28.5<br/>4  Tony valencia 6170   28.5<br/>5       Rayban Rb3025  200.0</span></pre><p id="d992" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">让我们将成本列重命名为商品成本</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="e280" class="lz ma it nb b gy nf ng l nh ni">df.columns = ['Product Name', 'Cost of goods']</span><span id="b59d" class="lz ma it nb b gy op ng l nh ni">print(df)</span></pre><p id="4a80" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">该表现在看起来像这样:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="edbc" class="lz ma it nb b gy nf ng l nh ni">           Product Name  Cost of goods  <br/>0  Tony valencia 7047           36.5    <br/>1  Tony valencia 6171           28.5    <br/>2  Tony valencia 7050           36.5    <br/>3  Tony valencia 7056           28.5    <br/>4  Tony valencia 6170           28.5    <br/>5       Rayban Rb3025          200.0    </span></pre><h2 id="8594" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">使用现有数据添加新列</h2><p id="d986" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">对于上面的数据，添加一个等于<code class="fe nj nk nl nb b">Cost*0.4</code>的利润列</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="1c32" class="lz ma it nb b gy nf ng l nh ni">df['Profit'] = df.Cost *0.4</span><span id="981c" class="lz ma it nb b gy op ng l nh ni">print(df)</span></pre><p id="f065" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">我们的表格现在看起来像这样:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="34b7" class="lz ma it nb b gy nf ng l nh ni">         Product Name   Cost  Profit<br/>0  Tony valencia 7047   36.5    14.6<br/>1  Tony valencia 6171   28.5    11.4<br/>2  Tony valencia 7050   36.5    14.6<br/>3  Tony valencia 7056   28.5    11.4<br/>4  Tony valencia 6170   28.5    11.4<br/>5       Rayban Rb3025  200.0    80.0</span></pre><h2 id="bd18" class="lz ma it bd mb mc md dn me mf mg dp mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">将Lamba应用于行和列</h2><p id="3288" class="pw-post-body-paragraph lc ld it lf b lg mv ju li lj mw jx ll mi mx lo lp mm my ls lt mq mz lw lx ly im bi translated">兰姆达斯被用来在行和列上用熊猫执行复杂的操作。lambda函数的语法是:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="c60d" class="lz ma it nb b gy nf ng l nh ni">lambda <em class="le">args </em>: <em class="le">expression</em></span></pre><p id="baf6" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">考虑下面的数据框架，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="b11d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">假设我们想要创建一个列平均值来显示每个学生的总体表现。创建一个lambda函数平均值，取一个值，然后除以3(受试者总数)</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="885e" class="lz ma it nb b gy nf ng l nh ni">average = lambda a : a/3</span></pre><p id="9951" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">现在将lambda函数应用于Total_marks列</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="05ab" class="lz ma it nb b gy nf ng l nh ni">df["average"] = df.Total_marks.apply(average)</span></pre><p id="8ccf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">输出将是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="0340" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mi ln lo lp mm lr ls lt mq lv lw lx ly im bi translated">本教程涵盖了开始使用<code class="fe nj nk nl nb b">pandas</code>模块所需要知道的一切。更多高级示例，请参考<a class="ae ky" href="https://pandas.pydata.org/docs/user_guide/cookbook.html#cookbook" rel="noopener ugc nofollow" target="_blank">烹饪书</a>指南。</p></div></div>    
</body>
</html>