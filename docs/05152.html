<html>
<head>
<title>Loading Images From Cloud Storage on Android using Coil</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Coil从Android上的云存储中加载图像</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/loading-images-from-cloud-storage-on-a-kotlin-android-app-d1574a059e04?source=collection_archive---------10-----------------------#2020-06-15">https://betterprogramming.pub/loading-images-from-cloud-storage-on-a-kotlin-android-app-d1574a059e04?source=collection_archive---------10-----------------------#2020-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="daf4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">救援的协程和扩展函数</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b8d1bbe4a82c623091e4d5b8cccf0415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3_xSqvv0mj16W9oB9KfZw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@invictar1997?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Soragrit Wongsa </a>在<a class="ae kv" href="https://unsplash.com/s/photos/polaroid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="f8ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你正在开发一个Android应用程序，并且你正在云存储中为Firebase存储图像，以便稍后在你的应用程序中显示，你可能正在使用一个图像加载库，如<a class="ae kv" href="https://github.com/bumptech/glide" rel="noopener ugc nofollow" target="_blank"> Glide </a>、<a class="ae kv" href="https://github.com/square/picasso" rel="noopener ugc nofollow" target="_blank"> Picasso </a>、<a class="ae kv" href="https://github.com/facebook/fresco" rel="noopener ugc nofollow" target="_blank"> Fresco </a>或<a class="ae kv" href="https://github.com/firebase/FirebaseUI-Android/blob/master/storage/README.md" rel="noopener ugc nofollow" target="_blank"> firebase-ui-storage </a>。是的，这些库可以完成这项工作，但是如果我告诉你有一个更愉快和更有效的方法呢？</p><p id="a89f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将向您介绍这个新来的家伙，<a class="ae kv" href="https://coil-kt.github.io/coil/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Coil </strong> </a> <strong class="ky ir">，</strong>，并且我将向您展示如何使用它用较少的样板代码加载您的云存储映像。<br/>我假设你已经熟悉Firebase的云存储，并且已经知道如何在Android应用程序中使用它。如果没有，你可能想看一看<a class="ae kv" href="https://firebase.google.com/docs/storage" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="577e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Coil(协同程序图像加载器)</h1><p id="2194" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Coil是一个用于Android的开源图像加载库。与其他预先存在的库(Glide、Picasso等)不同，Coil完全是在Kotlin中构建的，并由协程支持。也是:</p><ul class=""><li id="a353" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><strong class="ky ir">易于使用:</strong>因为它利用了一些Kotlin语言的特性，比如Kotlin扩展函数，这可以让你保持代码简洁明了。</li><li id="204a" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">轻量级:</strong>给你的APK加~2000法，和毕加索差不多，比Glide少一点。</li><li id="90ac" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated"><strong class="ky ir">快:</strong>它的速度与毕加索和Glide相当，如<a class="ae kv" href="https://proandroiddev.com/coil-vs-picasso-vs-glide-get-ready-go-774add8cfd40" rel="noopener ugc nofollow" target="_blank">这个基准</a>所示。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a206" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">入门指南</h1><p id="516c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">因为Coil使用的是Java 8，前提条件之一就是你在你的Android项目中启用Java 8。您可以在模块的<code class="fe nk nl nm nn b">build.gradle</code>文件中这样做:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">启用Java 8</p></figure><p id="a8f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您将它添加为同一个文件的依赖项:</p><pre class="kg kh ki kj gt nq nn nr ns aw nt bi"><span id="352f" class="nu ma iq nn b gy nv nw l nx ny">dependencies {<br/>    // ... other dependencies<br/>    <strong class="nn ir">implementation 'io.coil-kt:coil:0.11.0'</strong><br/>}</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="6e99" class="nu ma iq bd mb nz oa dn mf ob oc dp mj lf od oe ml lj of og mn ln oh oi mp oj bi translated">使用</h2><p id="d2d8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">使用Coil最简单的方法是调用库提供的<code class="fe nk nl nm nn b">ImageView.load()</code>扩展函数:</p><pre class="kg kh ki kj gt nq nn nr ns aw nt bi"><span id="a1ed" class="nu ma iq nn b gy nv nw l nx ny">// URL<br/>imageView.<strong class="nn ir">load(</strong>"https://www.example.com/image.jpg"<strong class="nn ir">)</strong><br/><br/>// Resource<br/>imageView.<strong class="nn ir">load(</strong>R.drawable.image<strong class="nn ir">)</strong></span></pre><p id="7a3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还可以在尾随lambda上指定一个<code class="fe nk nl nm nn b">placeholder</code>或任何其他附加配置:</p><pre class="kg kh ki kj gt nq nn nr ns aw nt bi"><span id="ca13" class="nu ma iq nn b gy nv nw l nx ny">imageView.<strong class="nn ir">load(</strong>"https://www.example.com/image.jpg"<strong class="nn ir">)</strong> <strong class="nn ir">{</strong><br/>    <strong class="nn ir">placeholder(</strong>R.drawable.image<strong class="nn ir">)</strong><br/>    <strong class="nn ir">transformations(</strong>CircleCropTransformation()<strong class="nn ir">)</strong><br/><strong class="nn ir">}</strong></span></pre><p id="1836" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了扩展功能之外，Coil还提供了其他加载图像的方法，比如<a class="ae kv" href="https://coil-kt.github.io/coil/requests/" rel="noopener ugc nofollow" target="_blank">请求</a>和<a class="ae kv" href="https://coil-kt.github.io/coil/image_loaders/" rel="noopener ugc nofollow" target="_blank">图像加载器</a>，为了简洁我就不赘述了。但是你可以在他们的文档中了解更多。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3620" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">面向Firebase的Coil Plus云存储</h1><p id="89a7" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">假设您在Firebase的云存储上存储了一个图像，可以使用路径“users/me/profile.png”来访问它。要在你的Android应用程序中的<code class="fe nk nl nm nn b">ImageView</code>上显示这张图片，你可能需要首先获取它的<code class="fe nk nl nm nn b">download URL</code>，然后将它传递给Coil，正如文档所建议的那样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用Coil从云存储中为Firebase加载一个映像</p></figure><p id="6643" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看起来很简单吧？但是如果我告诉你即使这样也可以简化呢？这就是<a class="ae kv" href="https://firebaseopensource.com/projects/rosariopfernandes/firecoil/" rel="noopener ugc nofollow" target="_blank">点火线圈</a>的用武之地。</p><h1 id="efd7" class="lz ma iq bd mb mc ok me mf mg ol mi mj jw om jx ml jz on ka mn kc oo kd mp mq bi translated">火焰线圈:火焰基座和火焰线圈</h1><p id="913d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated"><a class="ae kv" href="https://firebaseopensource.com/projects/rosariopfernandes/firecoil/" rel="noopener ugc nofollow" target="_blank"> firecoil </a>是一个开源库，允许你通过简单地提供图像的<code class="fe nk nl nm nn b">StorageReference</code>来用coil加载图像。要使用firecoil，您需要将<code class="fe nk nl nm nn b">jitpack</code> maven添加到项目的<code class="fe nk nl nm nn b">build.gradle</code>文件中:</p><pre class="kg kh ki kj gt nq nn nr ns aw nt bi"><span id="ec8f" class="nu ma iq nn b gy nv nw l nx ny">repositories {<br/>    // ...<br/>    <strong class="nn ir">maven { url 'https://jitpack.io' }</strong><br/>}</span></pre><p id="9614" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，将firecoil依赖项添加到模块的<code class="fe nk nl nm nn b">build.gradle</code>文件中:</p><pre class="kg kh ki kj gt nq nn nr ns aw nt bi"><span id="fc41" class="nu ma iq nn b gy nv nw l nx ny"><strong class="nn ir">implementation 'com.github.rosariopfernandes:firecoil:0.2.0'</strong></span></pre><p id="bda4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在有了firecoil，你不再需要获得下载网址。您可以简单地将您的<code class="fe nk nl nm nn b">StorageReference</code>传递给库提供的<code class="fe nk nl nm nn b">ImageView.load()</code>扩展函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用firecoil从云存储中为Firebase加载一个映像</p></figure><p id="8bf6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于firecoil是在coil的基础上构建的，所以您还可以使用一个尾随的lambda来指定其他配置:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用firecoil和附加配置从Firebase的云存储中加载映像</p></figure><p id="1f7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！有了这个简单明了的代码片段，您的应用程序现在应该可以显示漂亮的图像了。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1c0a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">资源</h1><ul class=""><li id="5fda" class="mw mx iq ky b kz mr lc ms lf op lj oq ln or lr nb nc nd ne bi translated">GitHub上的线圈:<a class="ae kv" href="https://github.com/coil-kt/coil" rel="noopener ugc nofollow" target="_blank">https://github.com/coil-kt/coil</a></li><li id="56c0" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">GitHub上的fire coil:【https://github.com/rosariopfernandes/firecoil T2】</li><li id="ffcd" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">线圈文件:【https://coil-kt.github.io/coil/ T4】</li><li id="4106" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">firecoil文档:<a class="ae kv" href="https://firebaseopensource.com/projects/rosariopfernandes/firecoil" rel="noopener ugc nofollow" target="_blank">https://firebaseopensource . com/projects/rosariopfernandes/fire coil</a></li><li id="b41d" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">Glide vs. Picasso vs. Coil基准:<a class="ae kv" href="https://proandroiddev.com/coil-vs-picasso-vs-glide-get-ready-go-774add8cfd40?gi=f21b6d717eec" rel="noopener ugc nofollow" target="_blank">https://proandroiddev . com/Coil-vs-Picasso-vs-glide-get-ready-go-774 add 8 CFD 40</a></li></ul></div></div>    
</body>
</html>