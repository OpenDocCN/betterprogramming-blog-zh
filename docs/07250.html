<html>
<head>
<title>Write Books in React With Next.js and MDX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Next.js和MDX在React里写书</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/write-books-in-react-with-next-js-and-mdx-8deec9fec761?source=collection_archive---------12-----------------------#2020-12-22">https://betterprogramming.pub/write-books-in-react-with-next-js-and-mdx-8deec9fec761?source=collection_archive---------12-----------------------#2020-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c9e5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在React中建立自己的图书平台</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0ddc5675269bdf3315fa36391d132a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ODuZhn3ISW7n_Njj"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@drewcoffman?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">德鲁·科夫曼</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="6f1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在阅读这篇文章之前，我想说Next.js现在有一个他们链接到这类事情的模板:<a class="ae kv" href="https://github.com/shuding/nextra" rel="noopener ugc nofollow" target="_blank">https://github.com/shuding/nextra</a>。请随意欣赏我的评论，但上面链接的回购可能是你想要的。</p><p id="9163" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用本文中的软件，您可以将任何现有的GitBook(在GitHub上写书的流行软件)加载到Next.js中，并开始添加您想要的任何自定义元素。比如:</p><ul class=""><li id="7e0b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">多项选择问题</li><li id="5e30" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">实时代码编辑器</li><li id="32dd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">任何你想要的反应组件！</li></ul><p id="bfd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以用Next.js和MDX轻松构建一本书，但这不仅仅是一本书！这是一个可扩展的教育网站(如果你不怕写一些代码的话)。让我们开始吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/cd98d8ede65c20070ebfacf07d9f96d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tK2wYAunDQkBtVzDkGwQ8g.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者GIF。</p></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="5221" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">什么是MDX？</h1><p id="3819" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">JSX降低了MDX的价格。这是一个包含markdown和JSX (React元素)的文件，扩展名为<em class="nl">。mdx </em>。这是我用来写书的语言。我们希望兼容现有的git book，这些只是Markdown，所以在现有的git book中加载没有问题。</p><h2 id="9209" class="nm mp iq bd mq nn no dn mu np nq dp my lf nr ns na lj nt nu nc ln nv nw ne nx bi translated">使用next-mdx-remote将代码和内容分开</h2><p id="5f91" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">一本书的GitHub存储库中不应该有任何代码。这给人的印象是你的书是一些需要学习的新代码库，而它应该只是一堆纯文本文件。</p><p id="f561" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了将我们的内容从代码中分离出来，我们使用了一个名为next-mdx-remote的库，并使用一个对<code class="fe ny nz oa ob b">raw.githubusercontent</code>的请求来获取代码，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="09e6" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">URL树</h1><p id="5a6b" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">因为没有任何内容需要保存在我们的存储库中，所以我们需要一个树来表示内容的层次结构和图书资源的位置。下面的文件有一个<code class="fe ny nz oa ob b">rawURL</code>属性用于获取Markdown，还有一个<code class="fe ny nz oa ob b">ghURL</code>属性用于为每个页面提供到GitHub页面的链接:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="7545" class="nm mp iq bd mq nn no dn mu np nq dp my lf nr ns na lj nt nu nc ln nv nw ne nx bi translated">从现有的GitBooks构建URL树</h2><p id="9b45" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">GitBook有一个很好的格式来指定资源的位置。您只需编写一个目录，在您的存储库中包含链接。以下是next-mdx-books文档中使用的GitBook兼容配置:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="6f3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用<a class="ae kv" href="https://unifiedjs.com/" rel="noopener ugc nofollow" target="_blank"> unifiedjs </a> Markdown解析器解析Markdown。对于next-mdx-books <a class="ae kv" href="https://www.openedtech.dev/Open-EdTech/next-mdx-books/about.md" rel="noopener ugc nofollow" target="_blank">文档站点</a>，我希望我的URL树包含指向标题的链接，所以当我重新格式化目录时，我会访问引用的文件并抓取标题。这在<code class="fe ny nz oa ob b">next-mdx-books</code>中是可选的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="750d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行转换脚本，只需传入一个指向有效目录的URL。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="2f0a" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">Next.js中的动态路径</h1><p id="7701" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">如果你不知道动态路由在Next.js中是如何工作的，这一节就很混乱了！试着对正在发生的事情有一个大概的了解…但是代码是给你思考的。</p><p id="bfb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了内容的路线和位置列表，我们需要将它输入Next.js，创建路线，并提供内容。我不会深入研究源代码，但本质上，我们正在对URL树进行深度优先搜索，并列出树中所有需要生成路由的节点。我们让我们的对象看起来像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="bcfe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这看起来可能有点滑稽，但是这个对象的意义在于我们可以映射Next.js的<code class="fe ny nz oa ob b">getStaticPaths</code>中的键。这为一个页面生成页面<code class="fe ny nz oa ob b">[...id].js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="4f89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用<code class="fe ny nz oa ob b">getStaticProps</code>中提供的路径来检索元数据，如GitHub URL:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="e033" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在一切都连接好了。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="991b" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">创作你的第一本书</h1><p id="d09d" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我们在GitHub 上有一个最小的例子，项目是这样开始的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/8c58bb26bca9d553b8065ef300dd9568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*3d-uY3HSQzxqtA4eVJzmhg.png"/></div></figure><p id="b3f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你运行<code class="fe ny nz oa ob b">yarn book</code>时，它运行这个脚本:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="b5f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，用户只需要输入URL。如果他们想删除标题，刷新页面会得到这样的结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/140985768cc0c3c75bcfb367b0f81723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5rOlyTr0PVPtDFTpVJ51g.png"/></div></div></figure><p id="8b21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您现在可以访问列出的页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c568c3eec7f1e10f96f679beae00beaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*9aS0A2Zi84aNYrg94Q30Ig.png"/></div></figure><p id="a9ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想做一些更复杂的事情，我们建议你叉我们的网站。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="c2ab" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">资源</h1><ul class=""><li id="d1d7" class="ls lt iq ky b kz ng lc nh lf oh lj oi ln oj lr lx ly lz ma bi translated">URL树工具包:<a class="ae kv" href="https://github.com/Open-EdTech/next-mdx-books" rel="noopener ugc nofollow" target="_blank">https://github.com/Open-EdTech/next-mdx-books</a></li><li id="8861" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们用next-mdx-books建立的网站:<a class="ae kv" href="https://www.openedtech.dev/" rel="noopener ugc nofollow" target="_blank">https://www.openedtech.dev/</a></li></ul></div></div>    
</body>
</html>