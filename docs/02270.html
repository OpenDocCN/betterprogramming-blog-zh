<html>
<head>
<title>Did You Know There’s an Elvis Operator?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你知道有猫王接线员吗？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/did-you-know-theres-an-elvis-operator-1406cb364929?source=collection_archive---------11-----------------------#2019-11-18">https://betterprogramming.pub/did-you-know-theres-an-elvis-operator-1406cb364929?source=collection_archive---------11-----------------------#2019-11-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c65c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">还有哪些聪明的运营商名称？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bf32cf73a3af13b4e86fa8d83285f1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMnxRxjfJkY2u1u-4RBWLA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@antisocia1?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">格雷戈·奥特加</a>在<a class="ae ky" href="https://unsplash.com/s/photos/elvis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ce2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python 3.8发布了<a class="ae ky" href="https://medium.com/better-programming/what-is-the-walrus-operator-in-python-5846eaeb9d95" rel="noopener">海象操作符</a>之后，我开始用它<a class="ae ky" href="https://medium.com/better-programming/three-ways-to-use-the-walrus-operator-in-python-d5550f3a7dd" rel="noopener">做实验</a>，不禁被命名中的创意所折服。我是说，它看起来真的很像海象。因此，我问自己这样一个问题:还有哪些聪明的操作符名称？</p><p id="b25d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这让我想到了猫王算子，<code class="fe lv lw lx ly b">?:</code>，它因与他著名的头发相似而得名。虽然我不能说这是运营商的“王者”，但我发现它非常有价值，值得分享。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="5bd0" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">什么是猫王算子？</h1><p id="7a34" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">像其他有通俗名字的运营商一样，Elvis也有一个技术或正式的名字。属于<em class="nd">二进制赋值操作符</em>的一类——这意味着它采用两个操作数进行赋值Elvis操作符是一种“逻辑或”,用于对变量(或常数)进行赋值。</p><p id="b8e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也被称为空安全<em class="nd"/>，如果值的布尔表达式为真，Elvis操作符将取两个操作数中的第一个；否则，采用第二个值。</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="15ea" class="ni mh it ly b gy nj nk l nl nm">// example is language agnostic<br/>// assume variable 'a' is null</span><span id="4e9a" class="ni mh it ly b gy nn nk l nl nm">// This would store the default string<br/>my_var = a ?: "a default string"</span></pre><p id="16a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Elvis运算符的目的是浓缩一个<a class="ae ky" href="https://medium.com/better-programming/does-python-have-a-ternary-conditional-operator-830454c34de7" rel="noopener">三元运算符</a>语句，其中“如果为真”值的布尔评估是行列式表达式。</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="9aeb" class="ni mh it ly b gy nj nk l nl nm">// examples are language agnostic</span><span id="8c9a" class="ni mh it ly b gy nn nk l nl nm">// ternary example<br/>my_var = a ? a : b</span><span id="eedf" class="ni mh it ly b gy nn nk l nl nm">// expanded if/else example<br/>if(a) {<br/>   my_var = a<br/>} else {<br/>   my_var = b<br/>}</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="03fd" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">我的语言有猫王运算符吗？</h1><p id="eb10" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">很有可能，是的；虽然它可能不像国王。特定的字符序列“<code class="fe lv lw lx ly b">?:</code>”出现在许多语言中，例如C、C++、<a class="ae ky" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>、<a class="ae ky" href="http://groovy-lang.org/" rel="noopener ugc nofollow" target="_blank"> Groovy </a>和<a class="ae ky" href="https://coldfusion.adobe.com/" rel="noopener ugc nofollow" target="_blank"> ColdFusion </a>。</p><p id="27b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在PHP的三元运算符实现中，中间的操作数可能会被省略，在这种情况下，三元运算符类似于Elvis运算符，并且行为相同。</p><p id="5ebc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python、JavaScript、Ruby、Perl中，Elvis运算符是不存在的；然而，OR运算符(<code class="fe lv lw lx ly b">||</code>、<code class="fe lv lw lx ly b">or</code>)的功能类似。在这些情况下，在分配第一个或第二个操作数之间的确定不完全取决于第一个是否为空，而是取决于第一个是否为真；或评估到一个真实的结果。这意味着空字符串、空数组/列表以及对象/字典中未定义的键的计算结果为false，并导致第二个操作数被赋值。</p><p id="c724" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JavaScript示例:</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="f81c" class="ni mh it ly b gy nj nk l nl nm">let name = "";</span><span id="8595" class="ni mh it ly b gy nn nk l nl nm">let user = name || "Default Name"; # Default Name</span></pre><p id="5c74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python示例:</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="9006" class="ni mh it ly b gy nj nk l nl nm">person = {<br/>   "first_name": "Jonathan",<br/>   "last_name": "Hsu"<br/>}</span><span id="b405" class="ni mh it ly b gy nn nk l nl nm">middle_initial = person['middle_name'][0] or None # None</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="797a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">我为什么要使用Elvis运算符？</h1><p id="7e1c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用Elvis运算符的主要原因是为了清晰起见合并语句。这种整合不仅仅是视觉上的，如果上面例子中的<code class="fe lv lw lx ly b">a</code>是一个长函数，Elvis操作符也有可能影响性能。</p><p id="3536" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我发现使用Elvis操作符的主要原因是防止空值或未定义的值；因此，我倾向于把它视为一种零安全。对我来说，这在处理接受参数的Python命令行脚本时最常见。</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="2a7c" class="ni mh it ly b gy nj nk l nl nm">import argparse</span><span id="58b1" class="ni mh it ly b gy nn nk l nl nm">parser = argparse.ArgumentParser(description='')<br/>parser.add_argument('--server', dest='server', help='iFormBuilder server name (ie. app.iformbuilder.com)')</span><span id="2691" class="ni mh it ly b gy nn nk l nl nm">args = parser.parse_args()<br/>server = args.server or ""</span></pre><p id="c4c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目的是在命令行中没有提供参数的情况下，以简洁的方式提供默认值。</p><p id="39d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么我想要一个参数的默认值？两个原因:</p><p id="2628" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，后续函数经常需要特定的数据类型，比如字符串。我可以使用这种技术来分配一个空字符串，而不是传递一个未定义的值或空值。</p><p id="22f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，如果我想避免在命令行输入所有参数的障碍，或者我想简化特定客户的执行，我可以跳过这些参数(假设我已经将它们设置为可选的)，并将客户的特定值设置为第二个操作数。</p><pre class="kj kk kl km gt ne ly nf ng aw nh bi"><span id="b8c6" class="ni mh it ly b gy nj nk l nl nm">import argparse</span><span id="ac06" class="ni mh it ly b gy nn nk l nl nm">parser = argparse.ArgumentParser(description='')<br/>parser.add_argument('--server', dest='server', help='iFormBuilder server name (ie. app.iformbuilder.com)')</span><span id="8aaa" class="ni mh it ly b gy nn nk l nl nm">args = parser.parse_args()<br/>server = args.server or "default.iformbuilder.com"</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="1978" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="d7c8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">您可以在代码中使用Elvis/null-safety/short-circuiting OR运算符来防止空值，并在主要选项失败时提供默认的赋值。</p><p id="d367" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您最喜欢这些运算符的哪些用途？</p></div></div>    
</body>
</html>