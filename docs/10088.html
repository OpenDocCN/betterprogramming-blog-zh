<html>
<head>
<title>Generate and Share Excel Styled Spreadsheets Using React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native生成和共享Excel风格的电子表格</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/generate-and-share-excel-styled-spreadsheets-using-react-native-e2034492c234?source=collection_archive---------3-----------------------#2021-11-25">https://betterprogramming.pub/generate-and-share-excel-styled-spreadsheets-using-react-native-e2034492c234?source=collection_archive---------3-----------------------#2021-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c63" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建一个生成和共享电子表格的React本地Expo应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1bc41d88a36cbce4a3b266181e2ef3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*06kMZzoNpaKd3TuH"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">米卡·鲍梅斯特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="eec6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么要用ExcelJS？</h1><p id="29c9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果你正在阅读这篇教程，也许你已经谷歌过“生成excel react native”这个短语，并且和我一样，找到了<a class="ae kv" href="https://stackoverflow.com/questions/51309125/react-native-how-to-create-excel-file-from-code" rel="noopener ugc nofollow" target="_blank">这个StackOverflow问题</a>或者<a class="ae kv" href="https://rushikeshvidhate.medium.com/export-data-to-excel-with-react-native-bc43fd10f681" rel="noopener">这个故事</a>。这些资源很好地总结了如何在React Native应用程序上使用<a class="ae kv" href="https://github.com/SheetJS/sheetjs" rel="noopener ugc nofollow" target="_blank"> SheetJS </a>生成Excel文件。</p><p id="f13c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然而，在我的例子中，我想设计一些行的样式并给单元格添加颜色来突出显示值。虽然专业版的<a class="ae kv" href="https://github.com/SheetJS/sheetjs" rel="noopener ugc nofollow" target="_blank"> SheetJS </a>允许样式化你的电子表格，也许你想要一个免费的替代品。这可以通过<a class="ae kv" href="https://github.com/exceljs/exceljs" rel="noopener ugc nofollow" target="_blank"> ExcelJS </a>实现。</p><p id="0b7e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你不需要造型并且满足于<a class="ae kv" href="https://github.com/SheetJS/sheetjs" rel="noopener ugc nofollow" target="_blank"> SheetJS </a>的基本特性，我推荐你使用它，因为它似乎有很好的支持并且易于使用。如果您需要为电子表格添加样式，请遵循本教程。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="206b" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">创建您的项目</h1><p id="fbf7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果您已经有了一个React原生项目，或者熟悉使用Expo创建项目，那么您可以跳过这一节，直接跳到Excel生成。</p><p id="e7ec" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我假设你有Xcode和一个iOS模拟器/设备，如果你是为iOS开发，或者Android Studio和一个Android模拟器/设备。如果您想要运行应用程序并查看更改，这些是必需的。要在您的设备上运行该应用程序，您可以在<a class="ae kv" href="https://apps.apple.com/us/app/expo-go/id982107779" rel="noopener ugc nofollow" target="_blank"> iOS </a>或<a class="ae kv" href="https://play.google.com/store/apps/details?id=host.exp.exponent&amp;hl=en&amp;gl=US" rel="noopener ugc nofollow" target="_blank"> Android </a>上安装Expo应用程序。在您的设备上运行该应用程序就像扫描二维码一样简单。</p><p id="4117" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果您从未使用Expo创建过项目，您可以使用npm在终端上安装Expo CLI it:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="408a" class="ng kx iq nc b gy nh ni l nj nk">npm install — global expo-cli</span></pre><p id="e3b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">安装后，您可以使用Expo CLI创建一个项目:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="5ed6" class="ng kx iq nc b gy nh ni l nj nk">expo init react-native-excel-style</span></pre><p id="4c26" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您可以选择空白模板。我选择了打字稿。</p><p id="90f3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在生成的项目文件夹中，您可以使用以下命令运行它:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="9dc7" class="ng kx iq nc b gy nh ni l nj nk">npm start</span></pre><p id="77fe" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在终端上，您可以通过按<code class="fe nl nm nn nc b">a</code>在已安装的Android模拟器上运行项目，或者通过按<code class="fe nl nm nn nc b">i</code>在iOS模拟器上运行项目。如前所述，你也可以通过扫描二维码在你的设备上运行它。您应该会看到这样的屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/22fe9e7f35784bae40e4e505077581d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6M_g-tcKSl-jI8B4_jIcg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">启动项目</p></figure><p id="888b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们已经有了一个正在运行的项目，让我们开始生成一个Excel。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="d0ba" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">设置我们的应用程序</h1><p id="113f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，让我们安装将用于生成Excel文件的依赖项，然后在下一步中共享它。在终端上运行:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="ac2a" class="ng kx iq nc b gy nh ni l nj nk">npm install exceljs<br/>expo install expo-file-system<br/>expo install expo-sharing</span></pre><p id="c61d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们可以开始写代码了。首先更改导入，并创建一个样式表来放置我们要创建的按钮:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于生成Excel电子表格的导入、样式表和应用程序组件</p></figure><p id="ccaa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">至于App组件，我们添加了一个暂时不做任何事情的按钮。我们的简单应用程序应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/87a7c8d684514c76347c5ad07033d5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flmRZI79ri_-FfBJCxhHsA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">只有一个按钮的应用程序，现在什么也不做</p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="8631" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">生成可共享的Excel</h1><p id="2b87" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们创建一个函数，该函数生成带有样式的Excel并返回uri。该函数将创建一个名为“YourFilename.xlsx”的文件。要共享一个文件，我们不能直接共享它，需要将它存储在设备上，并获取一个本地uri。由于我们不需要永久存储文件，我们可以将它存储在设备的缓存中，使用函数<code class="fe nl nm nn nc b">FileSystem.cacheDirectory</code>获取缓存路径。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">函数生成带有样式的Excel电子表格，并将uri返回到缓存目录</p></figure><p id="ff18" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们添加了一些信息，如创建者姓名、创建和修改日期。然后，我们添加一个名为“我的工作表”的工作表。在创建的工作表上，我们添加名为“Id”、“Name”、“D.O.B”的列，每个列都有不同的宽度。在您的应用程序中，您可以根据您的数据命名列，并添加包含您的数据项的行。</p><p id="9ddf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">创建列之后，我们继续添加2行测试值。现在，对于有趣的部分，我们只能使用<a class="ae kv" href="https://github.com/exceljs/exceljs" rel="noopener ugc nofollow" target="_blank"> ExcelJS </a>，我们添加<strong class="lq ir">样式。在第一行，我们将字体改为漫画字体。为了进一步展示一些样式，我们将第二列的字体改为绿色。这些风格只是在<a class="ae kv" href="https://github.com/exceljs/exceljs" rel="noopener ugc nofollow" target="_blank"> ExcelJS </a>的GitHub页面上可以看到的一些例子。根据这些示例，您可以根据自己的需要设置电子表格的行和单元格的样式。</strong></p><p id="1827" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了完成文件生成，我们使用函数<code class="fe nl nm nn nc b">writeBuffer</code>，因为我们不能在React Native上使用ExcelJS的<code class="fe nl nm nn nc b">writeFile</code>。然后我们将这个缓冲区转换成一个<code class="fe nl nm nn nc b">base64</code>字符串。我们使用这个字符串以我们之前选择的文件名写入本地缓存，然后返回uri。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="84a8" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">共享文件</h1><p id="30e6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果您需要生成一个Excel电子表格，可能您的用户希望与客户共享一些数据，所以让我们开始吧。幸运的是，<a class="ae kv" href="https://docs.expo.dev/versions/latest/sdk/sharing/" rel="noopener ugc nofollow" target="_blank"> React Native的世博会让这一切变得简单</a>。让我们创建一个调用我们刚刚创建的<code class="fe nl nm nn nc b">generateShareableExcel</code>函数的函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">函数来共享生成的Excel文件</p></figure><p id="56ff" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">获得uri后，我们调用Expo的<code class="fe nl nm nn nc b">shareAsync</code>。我们需要为一个Excel文件设置合适的<code class="fe nl nm nn nc b">mimeType</code>和<code class="fe nl nm nn nc b">UTI</code>。当调用这个函数时，可以使用可用的应用程序在iOS和Android设备上共享生成的文件，如iOS上的电子邮件、WhatsApp甚至隔空投送。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="eb50" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">测试我们的应用</strong></p><p id="925f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了测试我们的功能，让我们将App组件上不执行任何操作的按钮更改为以下内容:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="458a" class="ng kx iq nc b gy nh ni l nj nk">&lt;Button title=’Generate Excel’ onPress={shareExcel} /&gt;</span></pre><p id="9283" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们运行应用程序并按下按钮，我们应该会看到以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/006ebcbeccd8edb6f6323a756b865185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*UJLgtxOAk7MhNl95oIVD9g.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在iOS模拟器上打开共享对话框</p></figure><p id="f9b1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">由于这个视频是在iOS模拟器上录制的，我们没有看到太多的选项。但在设备上，我们应该可以看到我们已经安装的应用程序，我们可以用来分享，如隔空投送，WhatsApp和Gmail。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/4bcaaf0e10c8c53536104e78cb9355f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWoqjn3cIego47OoFPcSvw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">iOS设备上的共享选项</p></figure><p id="eeb2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们在Android模拟器上运行该应用程序，我们可以看到Gmail和Drive等选项。在Android设备上运行它应该会给你你已经安装的应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/de423455baf96d2a42c2f273279c17ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/1*rPMlXME1nkyWmHHkN4fcOQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Android模拟器上打开共享对话框</p></figure><p id="e3c7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们将生成的文件发送到我们的电子邮件并下载，当我们在Excel上打开它时，应该会看到以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/a966dfec2a1e46ce2d08a1bf41dd5039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*2ALHku49kvT74BDyTm_P4A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">下载我们生成的Excel文件</p></figure><p id="d609" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">正如我们所看到的，我们添加的样式正在工作。现在您可以继续修改这段代码，生成您自己的带有样式的电子表格，并共享它们:)</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="a438" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">结论</h1><p id="d007" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果你想看看整个项目，请查看<a class="ae kv" href="https://github.com/rolisanchez/react-native-excel-style" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>。</p><p id="e1c8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>