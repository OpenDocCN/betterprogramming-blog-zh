<html>
<head>
<title>Web Sockets: Stream Tweets in Real-Time With No Fuss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web Sockets:实时流畅地发送推文</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/web-sockets-streaming-tweets-in-real-time-with-no-fuss-fcb4749c2078?source=collection_archive---------15-----------------------#2020-01-27">https://betterprogramming.pub/web-sockets-streaming-tweets-in-real-time-with-no-fuss-fcb4749c2078?source=collection_archive---------15-----------------------#2020-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="67b9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建自己的实时Twitter客户端</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d2ff5553d8b1351fc7471eea03c6c624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYBQIscoOfGr5jso8iX9Mg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@pietrozj?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Pietro Jeng </a>拍摄</p></figure><p id="f7b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们生活在一个数据被认为比石油更有价值的时代。</p><p id="7aec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鉴于这种说法，任何可以帮助我们挖掘和分析数据的工具或机制都成为一种强大的资源。数据可以帮助我们理解人们的普遍行为，并帮助企业设计更好的用例。</p><p id="a9e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Twitter是一个丰富的数据来源。我们可以从那里得到的数据，任何话题，都是令人着迷的。</p><p id="16bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有一件事:我们将实时获取数据。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="afff" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">web Sockets——触手可及的实时优势</h1><p id="9642" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们都用过聊天应用。发送实时消息的魔力是通过一种叫做web套接字的东西实现的。这是我们将在用例中使用的神奇调味汁。如果我必须用简单的门外汉术语来描述什么是web套接字，我会这样说:</p><p id="cd2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mw"> Web sockets是一种网络技术，能够在用户的浏览器和服务器之间进行实时双向通信。也就是说，您可以发送和接收消息/信息，而不必不断地点击API。</em></p><p id="d1a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想了解更多，你可以在这里了解它们<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API" rel="noopener ugc nofollow" target="_blank">。除了web sockets，我们将使用React作为我们的客户机，使用Express作为我们的服务器节点。</a></p><p id="5921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">说得够多了，让我们开始吧。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e82f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">少说多做</h1><p id="9a8f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在我们看到实际应用之前，代码部分有四个部分需要处理:</p><p id="05fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">1.获取Twitter开发者应用证书<br/> 2。设置服务器<br/> 3。配置客户端<br/> 4。见证应用的诞生</p><h2 id="5a4e" class="mx ma iq bd mb my mz dn mf na nb dp mj lf nc nd ml lj ne nf mn ln ng nh mp ni bi translated">获取Twitter开发人员应用程序凭据</h2><p id="e52d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在我们开始编写任何可操作的代码之前，您应该登录或注册<a class="ae kv" href="https://developer.twitter.com/" rel="noopener ugc nofollow" target="_blank"> Twitter开发者</a>网站。完成后，您可以在这里创建一个新的个人应用程序<a class="ae kv" href="https://developer.twitter.com/en/apps" rel="noopener ugc nofollow" target="_blank">。从那里获取您的凭证，并将它们复制到某个地方以保证它们的安全。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/6331b0c921958921a501f27a017b12cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1e96PjGYNNKPg-iGOiuN8Q.png"/></div></div></figure><p id="30cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mw">注:</em> </strong> <em class="mw"> Twitter在注册开发者账户时采用了审核流程。在你准备好之前，你可能需要和评审小组交换一系列的电子邮件。</em></p><p id="e843" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您已经有了凭证，是时候启动服务器了。</p><h2 id="4de3" class="mx ma iq bd mb my mz dn mf na nb dp mj lf nc nd ml lj ne nf mn ln ng nh mp ni bi translated"><strong class="ak">设置服务器</strong></h2><p id="8a57" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了在服务器端传输twitter数据，我们需要两个库:<code class="fe nk nl nm nn b">Twit</code> <strong class="ky ir"> </strong>(处理Twitter的流和连接)和<code class="fe nk nl nm nn b">Socket.io</code> <strong class="ky ir"> </strong>(帮助在服务器上创建套接字连接)。</p><p id="e0d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将它们安装在您的express应用程序中:</p><pre class="kg kh ki kj gt no nn np nq aw nr bi"><span id="048f" class="mx ma iq nn b gy ns nt l nu nv">npm install --save twit socket.io</span></pre><p id="44ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装完所需的依赖项后，是时候调用<code class="fe nk nl nm nn b">socket.io</code>模块，并用它将我们创建的服务器包装在<code class="fe nk nl nm nn b">./bin/www</code>文件中。我们调用<code class="fe nk nl nm nn b">tweetsRoute</code>并发送<code class="fe nk nl nm nn b">socket</code>模块作为要使用的参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/ab9f1020c22248e99fa67c04367e9ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3_uf3cht-PqNPLSRS40zg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">服务器:调用socket.io并将其传递给tweetsRoute</p></figure><p id="6a03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nk nl nm nn b">tweets</code>路径中，我们导入<code class="fe nk nl nm nn b">Twit</code>库，并用从我们之前创建的应用程序中获得的凭证初始化它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/05916b9f7608b7ef0d7c1633cb8468b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmXydiW-M7mnAI0JdlQ5iA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">服务器:用获得的凭证创建一个Twit实例</p></figure><p id="f79b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经到达了应用程序的有趣部分，在这里我们开始从twitter读取信息，并将获取的tweets发送给指定的客户端。</p><p id="90af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码非常简单。使用初始化的<code class="fe nk nl nm nn b">Twit</code>对象，我们创建一个用于连接Twitter APIs的流。我们开始监听来自客户端的连接，一旦我们得到一个连接，我们就创建一个结果<code class="fe nk nl nm nn b">socket</code>对象。</p><p id="dc8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们主要使用来自<code class="fe nk nl nm nn b">socket</code>对象的两个函数。<code class="fe nk nl nm nn b">on</code>函数监听来自客户端的任何事件，而<code class="fe nk nl nm nn b">emit</code>函数将任何消息/信息发送回客户端。<code class="fe nk nl nm nn b">stream</code>对象本身使用其<code class="fe nk nl nm nn b">on</code>函数来监听任何传入的tweet，而<code class="fe nk nl nm nn b">stream.start()</code>基本上帮助启动一个流，以防它在会话期间被停止。你可以更深入地挖掘Twit的<code class="fe nk nl nm nn b"><a class="ae kv" href="https://github.com/ttezel/twit" rel="noopener ugc nofollow" target="_blank">streaming</a></code> API以获得更多细节。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/07da4056392d5d80936d85587520d2ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nvL9ASxysCv8xrE-li3pcA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">服务器:设置套接字和流以开始监听和响应事件</p></figure><p id="7610" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就解决了服务器端的基本问题。让我们把我们的客户安排好。</p><h2 id="3333" class="mx ma iq bd mb my mz dn mf na nb dp mj lf nc nd ml lj ne nf mn ln ng nh mp ni bi translated"><strong class="ak">配置客户端</strong></h2><p id="6d31" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">与服务器相比，客户机相对容易成形。我们将使用<code class="fe nk nl nm nn b">socket.io-client</code>库在客户端创建一个套接字连接。代码中有三点需要关注:</p><ul class=""><li id="3241" class="nz oa iq ky b kz la lc ld lf ob lj oc ln od lr oe of og oh bi translated">我们使用<code class="fe nk nl nm nn b">socket.io-client</code>连接到服务器端套接字。如果在任何时间点连接失败，客户端将继续尝试建立连接。</li><li id="6077" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated">listen事件在<code class="fe nk nl nm nn b">componentDidMount()</code>生命周期函数中声明，因为它在DOM挂载后立即被触发，并且是声明任何通用侦听器的理想位置。它之所以存在，是因为我们想让客户端一直监听传入的推文。</li><li id="fdcc" class="nz oa iq ky b kz oi lc oj lf ok lj ol ln om lr oe of og oh bi translated"><code class="fe nk nl nm nn b">startStreaming()</code>函数触发了<code class="fe nk nl nm nn b">emit</code>事件，这基本上表明服务器应该开始向应用程序传输twitter数据。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/a8fe69333c5f14ca9960fb561735d9b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oKk8nwg6Br6MwMazJ_714A.png"/></div></div></figure><p id="06fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，您的客户机就可以接收流数据了。我避免了钻研样式方式和组件来显示输入数据。这与正在讨论的话题无关。但是你可以查看代码——我已经把它保持得非常简单了。</p><p id="4bfd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在所有的工作之后，是时候看看魔法了。</p><h1 id="7ab6" class="lz ma iq bd mb mc oo me mf mg op mi mj jw oq jx ml jz or ka mn kc os kd mp mq bi translated"><strong class="ak">见证应用实现</strong></h1><p id="6f79" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">服务器端就位了吗？检查。反应所有配置旋转插座？检查。爆米花好了吗？是时候运行应用程序并查看结果了！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/55b2f787e0014d761664225f0d7baada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*PHenTzqAtxWUZh6oeGqrZg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">而且是活的！</p></figure><p id="ef1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有一个Twitter流应用程序！</p><p id="9324" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">继续玩吧。从业务和个人角度来看，有很多机会可以利用这一特性。</p><p id="b851" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是源代码！：</p><div class="ou ov gp gr ow ox"><a href="https://github.com/tarique93102/article-snippets/tree/master/sockets-twitter-app" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">关税93102/文章片段</h2><div class="pe l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk kp ox"/></div></div></a></div></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="c02c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">包裹</h1><p id="dc62" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在我寻求创建一个数据分析应用程序，可以实时跟踪任何与世界各地某些社会，环境和政治情况有关的推文。强调“实时”这个词。当然，您可以将这个解决方案应用到您认为合适的任何用例中。我们仍然可以做很多事情来大规模改进当前的实现。</p><p id="893b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我寻求创建一个数据分析应用程序的一部分，该应用程序可以实时跟踪任何与世界各地某些社会、环境和政治情况有关的推文。强调“实时”这几个字当然，您可以将这个解决方案应用到您认为合适的任何用例中。我们还可以做很多事情来改进当前的实现。</p><p id="412e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Web Sockets是一个强大的工具，如果你知道如何正确使用它，你实际上应该最终享受自己。接下来，我将重点为每个连接创建标识符，并根据每个用户的需求定制事件。</p><p id="fb84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有任何疑问或反馈，请在评论区留言。</p><p id="9d75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">记住要把你的代码用好。直到下一次——和平！。</p></div></div>    
</body>
</html>