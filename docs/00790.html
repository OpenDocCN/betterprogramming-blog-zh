<html>
<head>
<title>How to Make a Custom Screensaver for Mac OS X</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Mac OS X制作自定义屏幕保护程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-make-a-custom-screensaver-for-mac-os-x-7e1650c13bd8?source=collection_archive---------1-----------------------#2019-07-15">https://betterprogramming.pub/how-to-make-a-custom-screensaver-for-mac-os-x-7e1650c13bd8?source=collection_archive---------1-----------------------#2019-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dba5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解编写自己的Mac OS X屏幕保护程序的基础知识</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e92cbf7039fbda7ceb6c01b4e9c408dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BIGTY604aR0LT0h1DcQEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“Wirbel”屏幕保护程序</p></figure><p id="1655" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">苹果Mac OS X的默认屏保很好，但过一会儿就变得无趣了。当这种情况发生时，任何真正的书呆子都会自己解决问题！</p><p id="eb8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想让自己的<em class="lu">为Mac OS X定制</em>屏保，这篇文章就是为你准备的。我们将浏览一个制作模拟游戏<a class="ae lv" href="https://en.wikipedia.org/wiki/Pong" rel="noopener ugc nofollow" target="_blank"> Pong </a>的屏幕保护程序的教程。这将会非常简单——这只是让你开始如何制作一个屏幕保护程序。最后，它看起来会像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/7b6b8f292a1455712f03df20612398a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/1*IS9jtv_oJ95qqOkpzt3AIA.gif"/></div></figure><p id="b9aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想获得灵感来制作其他东西，这里有更复杂的屏保。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="5df9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">步骤1:项目设置</h1><p id="5f52" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">Mac OS X的屏幕保护程序是用Xcode开发的。您需要做的第一件事是创建一个新的Xcode项目，类别为“屏幕保护程序”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/eb2f458bf9aab5db8151239b732f590d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q6qKafBJF-ks8S4b-bqQbw.png"/></div></div></figure><p id="2436" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将我的项目命名为<strong class="la iu"> Pong </strong>，但是你可以随意命名你的项目。从Xcode 10.2.1开始，Xcode会生成一些文件:<code class="fe nc nd ne nf b">PongView.h</code>、<code class="fe nc nd ne nf b">PongView.m</code>、<code class="fe nc nd ne nf b">Info.plist</code>。</p><p id="dc25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于Objective-C不是最漂亮的语言，而Swift正变得越来越主流，我们将删除这些自动生成的Objective-C文件，并创建一个新文件，<code class="fe nc nd ne nf b">PongView.swift</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/09846a866f2febb8174285ae168bc069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*t3hj6n9TUwJR1h4S_EYXbQ.png"/></div></figure><p id="c1e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个Swift文件的结构非常简单。您可以从下面复制粘贴模板:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="4f7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用函数<code class="fe nc nd ne nf b">draw()</code>来渲染屏保动画的每一帧内容。</p><p id="2d78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用函数<code class="fe nc nd ne nf b">animateOneFrame()</code>在每次动画定时器触发时更新屏保的“状态”(这个定时器由操作系统自动创建和处理)。在这个函数的末尾调用<code class="fe nc nd ne nf b">setNeedsDisplay(bounds)</code>很重要，这样操作系统就知道要重新绘制屏幕。</p><p id="df71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">重要提示</strong>:由于我们去掉了Objective-C的东西，使用Swift，所以项目的<code class="fe nc nd ne nf b">Info.plist</code>文件需要更新。在关键字“Principal class”的值前面加上Xcode项目的<em class="lu">名称。比如我的Xcode项目叫做<em class="lu"> Pong </em>，所以我把值从<code class="fe nc nd ne nf b">PongView</code>改成了<code class="fe nc nd ne nf b">Pong.PongView</code>。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/69d94b7583b7baca17b19feec0f15d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XWHjFhtOVS9vfYzNJDH8qg.png"/></div></div></figure><h1 id="f45a" class="me mf it bd mg mh nk mj mk ml nl mn mo jz nm ka mq kc nn kd ms kf no kg mu mv bi translated">步骤2:实现逻辑</h1><p id="8ea7" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">我们的pong屏幕保护程序的状态将通过几个简单的变量来跟踪:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="72fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe nc nd ne nf b">init()</code>函数中，我们将配置球的初始位置和速度。我们将初始位置设置为屏幕的中心，并将初始速度设置为一个大小为<code class="fe nc nd ne nf b">10</code>的随机向量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8bea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们需要一些辅助函数来确定球何时接触到屏幕的边缘和/或球拍。以下两个函数将完成这一任务:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="daa7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我知道，<code class="fe nc nd ne nf b">ballHitPaddle()</code>功能并不是100%可靠地验证球和桨之间的接触。但是对于我们的目的来说，已经足够好了。</p><p id="5273" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将使用这些辅助函数来更新<code class="fe nc nd ne nf b">animateOneFrame()</code>中我们的屏保的“状态”。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8d14" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">桨保证跟踪球的x位置。因此，在球弹到屏幕底部之前，它总是会与球接触(除非你将球的速度设置得很高，在这种情况下，它可能会“跳过”球拍)。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="2ea7" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">步骤3:绘制动画</h1><p id="722b" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">剩下唯一要做的就是在<code class="fe nc nd ne nf b">draw()</code>函数中画出球和桨。请注意，在绘制任何其他东西之前，我们先重新绘制背景<strong class="la iu">再绘制</strong>，否则球在屏幕上反弹时会留下“轨迹”。</p><p id="942a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还定义了更多的辅助函数来划分绘图逻辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="b55f" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">步骤4:安装和调试</h1><p id="5247" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">此时，屏保已经准备好了。你可以在这里找到所有的代码。</p><p id="07c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要安装屏保，按Xcode上的“运行”按钮，在Finder中打开构建产品<code class="fe nc nd ne nf b">Pong.saver</code>，双击它。“设置”应用程序应该会打开，并提示您安装屏幕保护程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/caa67b562b7f85024e7bc0a819ef5dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*taEzoLGsBGn9UOFdAfuaBQ.png"/></div></figure><p id="1e34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您更改了屏幕保护程序并想要重新安装它，在尝试重新安装屏幕保护程序之前关闭设置应用程序是很重要的。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="c06b" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">附加调试</h1><p id="671d" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">使用在Finder中打开构建产品、关闭设置应用程序、重新安装屏保等繁琐的过程来测试屏保并不理想。</p><p id="2236" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">而且，这个方法不允许你设置断点，与<code class="fe nc nd ne nf b">lldb</code>交互，或者查看控制台输出。<strong class="la iu">但是有办法！</strong></p><p id="19d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你的屏保类继承自<code class="fe nc nd ne nf b">ScreenSaverView</code>，而T7又继承自<code class="fe nc nd ne nf b">NSView</code>。这意味着它可以被添加到一个常规的旧Mac OS X应用程序的子视图中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/48aeefcc8daa689041dae15cdba4096f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbecOIvS13DCEFNI-QBbiA.png"/></div></div></figure><p id="1b34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只需创建一个“Cocoa App”类型的新Xcode项目然后，添加你的屏保作为Xcode生成的主<code class="fe nc nd ne nf b">NSViewController</code>视图的子视图。我们需要为动画循环人工创建一个计时器，但这是一个非常简单的修复。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f8f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当您从Xcode运行这个Cocoa应用程序时，所有的普通工具(如断点和控制台日志)都将可供您调试，并且开发您的屏幕保护程序将会容易得多！</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="15c9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">资源</h1><p id="1304" class="pw-post-body-paragraph ky kz it la b lb mw ju ld le mx jx lg lh my lj lk ll mz ln lo lp na lr ls lt im bi translated">这只是一个开发Mac OS X屏幕保护程序的介绍。你的可能性只受到苹果API的限制，还有很多事情可以做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/71d03413bfe69a1dd4fa10f7b0bc6c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*HMVPmWiKxciiV-exLBhjng.gif"/></div></figure><ul class=""><li id="7cc9" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">https://trevphil.com/screensavers的<a class="ae lv" href="https://trevphil.com/screensavers" rel="noopener ugc nofollow" target="_blank">有更多的例子。</a></li><li id="6098" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated"><code class="fe nc nd ne nf b">PongView.swift</code>的完整代码可从<a class="ae lv" href="https://gist.github.com/trevphil/58d3cbbfdefc2ec71e986b28aaf29f32" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</li></ul></div></div>    
</body>
</html>