<html>
<head>
<title>Quit Google Analytics and use self-hosted Gatsby statistics with Ackee</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">退出谷歌分析和使用Ackee自主盖茨比统计</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/quit-google-analytics-self-hosted-gatsby-statistics-with-ackee-846a2b4be634?source=collection_archive---------20-----------------------#2020-02-13">https://betterprogramming.pub/quit-google-analytics-self-hosted-gatsby-statistics-with-ackee-846a2b4be634?source=collection_archive---------20-----------------------#2020-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cc8f325ac26e19f68f6cd41fceee981b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-t2-XvLC_1SjmnXu0eoymw.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">哈尔·盖特伍德在<a class="ae kc" href="https://unsplash.com/s/photos/web?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b7a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拥有自己的网站或博客有很多不同的目标。对我来说，这意味着只要有一个地方，我拥有我的文字内容，并可以根据我的喜好定制。说到分析，我的需求并不多——我的大多数观众都是通过像<a class="ae kc" href="http://dev.to" rel="noopener ugc nofollow" target="_blank"> dev.to </a>或Medium这样的平台阅读我的内容的。我只需要知道有多少人访问我的网站，哪些帖子做得很好，用户来自哪里(推荐链接)。</p><p id="eea9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">鉴于我最近痴迷于消除生活中的所有跟踪和广告，我选择停止支持谷歌，并从谷歌分析转向自我托管。这不是一个容易使用的产品，而且大部分功能对我来说都没有用，因为我不在博客上卖任何东西。这样，我就拥有了数据，而不是把它提供给一个可能会恶意使用它的公司。</p><p id="aee2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我开始为我的博客寻找一个新的跟踪工具。我选择新产品的标准是:</p><ul class=""><li id="d9dd" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">简单点。</li><li id="d233" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有我将使用的功能。</li><li id="a421" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">注重隐私。</li><li id="dbad" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">用我知道的编程语言构建，所以修改很容易。</li><li id="2eb7" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">能够在Heroku这样的平台即服务上轻松托管</li><li id="5a2a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">有能力很容易被添加到盖茨比的博客</li><li id="70fe" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">可以选择不收集独特的用户数据，如操作系统、浏览器信息、设备和屏幕尺寸</li></ul><h2 id="ff90" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">见见Ackee</h2><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/9477a2553c9d2306d5dbd75ce1a03322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJoA0YLnM-xBRQFiqx28KA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">很美，不是吗</p></figure><p id="be0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我偶然发现了一个自托管的分析工具Ackee，发现它几乎完全符合我的要求。它是使用Node.js构建的，我对此有经验，它专注于匿名化它收集的数据。点击阅读关于Ackee如何匿名化数据<a class="ae kc" href="https://github.com/electerious/Ackee/blob/master/docs/Anonymization.md" rel="noopener ugc nofollow" target="_blank">的更多信息。</a></p><p id="7ff4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">开始用Ackee收集统计数据需要采取的步骤是在服务器上运行它，在我的例子中是Heroku，将Javascript tracker添加到您的Gatsby站点，并测试数据是否正确流动。</p><p id="7e5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mn">这是我如何着手将它部署到Heroku的详细指南。之后，</em> <a class="ae kc" href="https://github.com/electerious/Ackee/pull/77" rel="noopener ugc nofollow" target="_blank"> <em class="mn">我贡献了一个Deploy-to-Heroku </em> </a> <em class="mn">按钮，一键部署。</em> <a class="ae kc" href="https://github.com/electerious/Ackee/blob/master/docs/Get%20started.md#with-heroku" rel="noopener ugc nofollow" target="_blank"> <em class="mn">在这里找到按钮</em> </a> <em class="mn">。</em></p><h2 id="1252" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">在Heroku上运行</h2><p id="26fa" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">首先，你必须开始运行服务器，它将从你的网站接收跟踪数据。</p><p id="eae8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建新的Heroku应用程序实例:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/c7f6d2d50e32d53b9d366bf7b7c8f9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3SXCHXtZRQTXiH_xJ7HgA.png"/></div></div></figure><p id="cbd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe mu mv mw mx b"><a class="ae kc" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank">heroku-cli</a></code>上传代码:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="5fb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">配置一个MongoDB附加组件—这是存储数据的地方:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/8ccdd2f3f38f4dac75ed46c33edec58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvM4qWRiSLD3n8XIq4--Ww.png"/></div></div></figure><p id="4f76" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://devcenter.heroku.com/articles/config-vars#using-the-heroku-cli" rel="noopener ugc nofollow" target="_blank">配置环境变量</a>:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="1798" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">瞧，你完成了！那很容易，不是吗？</p><p id="5144" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开Heroku自动为你配置的网页——应该是<a class="ae kc" href="https://ackee-instance.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://ackee-server.herokuapp.com/</a>——你应该会看到这个:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/df8b15f365d74cb7ff25459b4cc79a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z583LDPwpElbZfFH5Dz9TQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">登录页面！</p></figure><h2 id="9013" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">添加跟踪器</h2><p id="ae8a" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">现在我们需要将数据从网站发送到我们现在运行在Heroku上的服务器。如果你用的是Gatsby，这个插件非常简单。</p><ul class=""><li id="49fe" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">安装跟踪器:</li></ul><p id="ad10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mu mv mw mx b">npm install gatsby-plugin-ackee-tracker</code></p><ul class=""><li id="1b80" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">在Ackee上创建一个域并获取域id。在Ackee实例的设置标签中找到这个选项。</li><li id="8bf2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">将其添加到您的Gatsby配置中。</li></ul><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><ul class=""><li id="2870" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">在本地运行网站:</li></ul><p id="04c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mu mv mw mx b">gatsby develop</code></p><h2 id="5b44" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">测试，以确保它的工作</h2><p id="c9a3" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">在<code class="fe mu mv mw mx b">http://localhost:8000</code>打开你的网站，转到一个新的网址。</p><p id="3027" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">观察您的站点发送的网络请求。您会注意到它现在向您的Heroku实例发送请求。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/9f0b86b5d8b6e51c5f1c69636cdfa00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HD9SfBTU3CQb8YxMQAYHkw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">勇敢的开发工具</p></figure><p id="61ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在有服务器运行Ackee和我们的盖茨比发送分析！</p><h2 id="7568" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">你得到了什么</h2><p id="5cb9" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">让我们探索一下Ackee。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/17c0f1bd44ed5be6fb73bcdc6c4188fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwRXmUI0M7p-HEruhMhZ9w.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">网站总浏览量主页</p></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/b9712318195c14c7d017354d974cc181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AM2nCc8yjsJ57-bYR9Btuw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">推荐人列表</p></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/172a1e71a7d56ab777424cdc3dde9c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VeL1DMA-tRtTzEMeeR8Z2Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">每页查看次数</p></figure></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="fa35" class="nn lq iq bd lr no np nq lu nr ns nt lx nu nv nw ma nx ny nz md oa ob oc mg od bi translated">可供选择的事物</h1><p id="eccf" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">以下是我在考虑博客分析时考虑的一些替代方法。</p><h2 id="ea1f" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated"><strong class="ak">没有跟踪</strong></h2><p id="80fe" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">再加上越来越多的人一起屏蔽追踪器(Firefox、Brave和Chrome广告屏蔽扩展)，基于JavaScript的追踪变得越来越没有价值。大多数分析很容易成为对你的博客感到虚荣的一种方式，你可能会养成总是检查它们的坏习惯(与产生实际内容相比，这是浪费时间)。如今，决定完全不跟踪任何分析并不是一个糟糕的决定。</p><h2 id="5131" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated"><strong class="ak">服务器端分析</strong></h2><p id="03c9" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">在你的网站上收集分析的最私人和快速的方法可能是在服务器级别收集分析。</p><p id="ba98" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着不使用JavaScript跟踪器(可能会被浏览器阻止)，而是在服务器发送HTML时收集统计数据。这里需要与您的静态主机提供商或DNS提供商集成。这种方法的主要缺点是数据是由第三方服务收集的，而且通常不是免费的。<a class="ae kc" href="https://www.cloudflare.com/en-ca/analytics/" rel="noopener ugc nofollow" target="_blank"> Cloudflare </a>与<a class="ae kc" href="https://www.netlify.com/products/analytics/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>一起提供这些类型的分析。一个巨大的好处是易于设置——通常，提供商只需打开他们那边的开关，不需要您进行任何设置。</p></div></div>    
</body>
</html>