# 使用 React Spring 和 Tinycolor 构建丰富多彩、富有弹性的组件

> 原文：<https://betterprogramming.pub/building-colorful-springy-components-using-react-spring-and-tinycolor-1086c6594203>

![](img/5870f40c2c57b9e77040247055fc61aa.png)

菲利普·维特在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

最近，我决定开发一个 web 应用程序[,让设计师和开发人员可以生成不同的颜色，并检查颜色的可访问性。在这篇文章中，我想给你演示一下我是如何构建我将在那个应用中使用的一些组件的。](https://rainbo.xyz/)

该应用程序的完整源代码可以在本文末尾找到，还有一个链接，指向一个包含所有描述组件的 Storybook 实例。

# 属国

为了帮助我构建这些组件，我使用了 [Tinycolor](https://github.com/bgrins/TinyColor) ，这是一个具有一系列颜色实用函数的库，您可以使用它来操作、转换和表示颜色。

我也使用过 [React Spring](https://www.react-spring.io/) ，这是一个基于 Spring 物理的库，允许你非常容易地将动画添加到你的项目中。

# 彩色瓷砖

彩色瓷砖设计

我们列表中最简单的组件，色块将作为其他组件的构建块。这个组件的职责是显示一种颜色，以及它的名称和十六进制值。

彩色拼贴源

## 实施说明

1.  如果你不熟悉优秀的[类名](https://www.npmjs.com/package/classnames)库，第 17 行和第 19 行可能看起来有点奇怪。基本上，类名库允许你连接 CSS 类并有条件地应用于你的元素。
2.  在第 36 行，你可以看到我们计算了传入的颜色的十六进制字符串。因为我们使用 CSS 中直接传递的颜色属性，它可以是任何可接受的 CSS 颜色格式，而不仅仅是十六进制。例如，它可以是 rgba 字符串。这就是 Tinycolor 的用武之地。我们可以给它这些格式中的任何一种，它会返回一个格式良好的十六进制字符串，我们可以将它与我们的图块一起显示。
3.  继续看第 36 行，您可能已经注意到计算十六进制字符串的函数被包装在`useMemo`中。这是因为我们只想在颜色改变时计算这个值。我们可以避免重新计算任何其他道具的变化，这可能会导致重新渲染。我还在学习新的 Hooks API，所以这可能不是最合适的`useMemo`用法，因为它可能不是一个特别昂贵的操作，但我认为这是一个处理它的好方法。你可以在这里了解更多关于`useMemo`函数或者钩子的一般[。](https://reactjs.org/docs/hooks-reference.html#usememo)

彩色瓷砖样式源

## 造型说明

我们瓷砖的造型非常简单。我们有瓷砖本身，它的尺寸和颜色来自我们传入的变量。

然后，我们有一个容器来保存图块、颜色名称和十六进制值。这是一个简单的 flex 容器，保持我们的元素对齐。

# 颜色选择器

![](img/8d5f19ff7aff34d8b0ce90f325d4d699.png)

颜色选择器设计

对于我们的拾色器，我们将重用色块组件，以及来自 [react-color](https://casesandberg.github.io/react-color/) 包的拾色器。

颜色选择器源

## 实施说明

我们的颜色选择器由一个显示当前选择的颜色及其十六进制值的`ColorTile`和一个来自`react-color`库的`ChromePicker`组成，后者实际上允许我们选择一种颜色。

我们有一些状态来控制`ChromePicker`是否可见，还有一个回调函数来让任何使用我们的选择器的组件知道颜色何时改变。当颜色改变时，提供了很多信息，但是十六进制值对于我的目的来说已经足够了，正如你在第 17 行看到的。

# 颜色列表

颜色列表设计

我们的颜色列表组件接受一个颜色列表，并将它们呈现为一个包含颜色块的列表。我们的颜色列表旨在将基色显示为稍大的图块，其余的图块表示基色的变体，显示为较小的图块。我们还允许命名我们的列表，这将用于显示基本颜色的名称。

我们的颜色列表也带来了本演练的“弹性”部分。使用 React Spring 将在进入时对瓷砖进行动画处理😊

调色板列表实现

## 实施说明

1.  在第 34–40 行，你可以看到我们使用`useTrail`实现了 React Spring。你可以在这里阅读更多关于步道的信息。我们将颜色块容器上的边距设置为动画，根据列表是列对齐还是行对齐，这可能是右边或底部的边距。
2.  在第 39 行，你可以看到我们传递了一个对动画的引用。这是为了让我们可以传递一个引用到我们的颜色列表来延迟动画。如果我们想从一个父组件中触发一个特定的动画序列，这将是非常有用的。

调色板列表样式

# 颜色对

色彩配对设计

颜色对组件采用两种颜色，并并排显示它们以及一些可访问性信息。这个想法是，开发者或设计师将颜色配对，以确保它们在用作背景/前景组合时一起工作。

颜色对实现

## 实施说明

如前所述，我们的颜色对组件采用背景色和前景色，在第 26–33 行，您可以看到我们使用 Tinycolor 来确定颜色对的可访问性。

我们使用一个简单的药丸组件来显示结果，药丸的类型由结果决定。我在这里没有展示药丸的源代码，但是它是一个非常标准的组件，你可以在任何组件库中找到(Bootstrap、Material 等)。

你可以在这里了解更多关于无障碍和 WCAG [的信息。](https://www.w3.org/WAI/standards-guidelines/wcag/)

# 结论和源代码

我希望你能从这个演练中学到一些东西。我强烈推荐在你的下一个项目中研究我在这里提到的库。特别是，如果没有优秀的 Tinycolor 包，我的应用程序将需要更长的时间来创建。

> 完整应用程序的源代码可以在[这里](https://github.com/stephan-mclean/project-color)找到。
> 
> 包含所有组件的故事书实例可以在[这里](https://rainbo-components.netlify.com/)找到。

如果你对设计、代码或其他方面有任何反馈，我很乐意在回复中听到。

非常感谢你看我的文章！