<html>
<head>
<title>Building a Command Line Tool using Argument Parser in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Swift中的参数解析器构建命令行工具</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/command-line-tool-with-argument-parser-in-swift-b0e1c27aebd?source=collection_archive---------12-----------------------#2022-09-15">https://betterprogramming.pub/command-line-tool-with-argument-parser-in-swift-b0e1c27aebd?source=collection_archive---------12-----------------------#2022-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="efd4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与您的团队共享Xcode片段</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fb5cd0d564ec3317474074c457514f57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euSMvlWzW3aKGIC9d1YMYA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="309e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/apple/swift-argument-parser" rel="noopener ugc nofollow" target="_blank"> Argument Parser </a>是苹果推出的新包。它使得编写命令行工具来自动化常见任务变得更加容易。参数解析器有三个属性包装器:参数、标志和选项。</p><h1 id="c32b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">争吵</h1><p id="ed56" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">它是运行脚本时在我们的参数变量中设置的一个值。例如，我们将运行与我们的参数变量相对应的<code class="fe mp mq mr ms b">swift run SnippetSharing Snippets</code>片段。它也是我们的snippets文件夹名称。也可以是别的。</p><h1 id="58ed" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">旗</h1><p id="e759" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">标志主要用于添加额外的日志。例如，我们可以运行<code class="fe mp mq mr ms b">swift run SnippetSharing Snippets --verbose</code>来获得额外的日志。</p><p id="3ec1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建一个命令行工具，与我们的团队成员共享Xcode片段。为此，我们在命令行工具文件夹中创建代码片段，命令行工具会将它移动到预期的文件夹中。在我们的例子中，我们将同时使用参数和标志属性包装器。</p><h1 id="f9d4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建Swift包</h1><p id="ddc7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们在项目文件夹中创建一个名为<code class="fe mp mq mr ms b">SnippetSharing</code>的文件夹:</p><p id="257c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mp mq mr ms b">mkdir SnippetSharing</code></p><p id="c947" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行它以创建Swift包:</p><p id="9992" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mp mq mr ms b">swift package init --type executable</code></p><p id="5edc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后输入<code class="fe mp mq mr ms b">swift run</code>，打开初始化创建的<code class="fe mp mq mr ms b">Package.swift</code>文件。</p><h1 id="78ca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">将参数分析器作为依赖项添加</h1><p id="1ea5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在<code class="fe mp mq mr ms b">Package.swift</code>中，我们需要在包中添加参数解析器。它的版本是0.0.4，因为我们不需要参数解析器的任何异步操作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7aaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成这些配置后，参数解析器包应该出现在Xcode左下方的“包依赖项”中</p><h2 id="389c" class="mv lt iq bd lu mw mx dn ly my mz dp mc lf na nb me lj nc nd mg ln ne nf mi ng bi translated">编写命令行</h2><p id="da47" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们定义一个使用<code class="fe mp mq mr ms b">ParsableCommand</code>的名为<code class="fe mp mq mr ms b">SnippetSharing</code>的结构。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8030" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的结构有<code class="fe mp mq mr ms b">folderName</code>，它对应于我们希望与团队成员共享的<code class="fe mp mq mr ms b">Snippet</code>文件夹。<code class="fe mp mq mr ms b">Manager</code>用于查找我们当前的目录路径。<code class="fe mp mq mr ms b">snippetFolderPathXcode</code>是Xcode的默认文件夹路径，我们将复制所有代码片段以显示Xcode中的代码片段。Verbose用于日志记录。</p><p id="3aa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要一个函数来运行我们的shell命令，如删除、创建和复制操作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="bebb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我们可以分别编写命令函数。如果你不熟悉Shell脚本，你应该看一些关于它的例子。代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="959b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们可以更新我们的run方法，并在结构范围之外调用结构的main函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5ca9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建Xcode片段的文件夹有一个步骤。在包文件夹中，根据需要创建一个文件夹。我的文件夹名是<code class="fe mp mq mr ms b">Snippets</code>。它同时包含了<code class="fe mp mq mr ms b">IBOutlet</code>、<code class="fe mp mq mr ms b">IBAction</code>的片段。两个关键词我们都用了很多时间。</p><h2 id="63d1" class="mv lt iq bd lu mw mx dn ly my mz dp mc lf na nb me lj nc nd mg ln ne nf mi ng bi translated">尝试命令行工具</h2><p id="d85b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">只需运行<code class="fe mp mq mr ms b">swift run SnippetSharing Snippets</code></p><p id="4ad5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所见，我们从一个基础上自动化了Xcode片段共享。所有团队成员都可以更新代码段文件夹并运行该命令。它也可以用于自定义xctemplate进行共享。<a class="ae kv" href="https://github.com/TolgaTaner/SnippetSharing" rel="noopener ugc nofollow" target="_blank">完整的项目在这里</a>。</p><p id="013d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nh">感谢阅读！</em></p></div></div>    
</body>
</html>