<html>
<head>
<title>Chatbots and What’s New in Rasa 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">聊天机器人和Rasa 2.0的新功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/chatbots-and-whats-new-in-rasa-2-0-a51c61ca3c33?source=collection_archive---------5-----------------------#2020-09-28">https://betterprogramming.pub/chatbots-and-whats-new-in-rasa-2-0-a51c61ca3c33?source=collection_archive---------5-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="52fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索一种新的方式来构建您自己的上下文聊天机器人</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3661f206be9256239079b4d8f9ce8056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OIAMRn888HFlXFJ9BCYhA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。Rasa开源图标取自<a class="ae ky" href="https://github.com/rasahq/rasa" rel="noopener ugc nofollow" target="_blank"> Rasa Github </a>。</p></figure><p id="82cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://rasa.com/" rel="noopener ugc nofollow" target="_blank"> Rasa开源</a>是一个机器学习框架，用于构建基于文本和语音的聊天机器人。最近，其背后的团队成功达到了一个显著的里程碑，并于2020年10月发布了他们的第一个正式版本2.0。新版本旨在统一训练数据格式、配置文件和处理模型的方式。因此，与以前的版本相比，有相当多的重大突破性变化。</p><p id="1d1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将深入探讨Rasa 1.10和最新发布的候选版本之间的一些主要差异。在为旧的Rasa服务器执行迁移之前，您应该检查它并确定是否值得这样做。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1b2f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">文件夹和文件层次结构</h1><p id="5e18" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">文件夹和文件的结构或多或少类似于以前的版本，但有以下例外:</p><ul class=""><li id="3151" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">actions.py</code>不再在根目录下。</li><li id="5ef9" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">在<code class="fe ni nj nk nl b">actions.py</code>所在的地方有一个名为<code class="fe ni nj nk nl b">actions</code>的新文件夹。</li><li id="bc04" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">在<code class="fe ni nj nk nl b">data</code>文件夹中还有一个名为<code class="fe ni nj nk nl b">rules.yml</code>的附加文件。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4a4b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">配置</h1><h2 id="5a63" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">config.yml</h2><p id="e3fb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">2.0版现在提供了管道和策略的默认配置。这对新用户来说方便多了。说了这么多，还是可以自定义的，格式和之前的版本一模一样。</p><h2 id="2735" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">管道</h2><div class="od oe gp gr of og"><a href="https://rasa.com/docs/rasa/components" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">组件| Rasa开源文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">如果您想在您的…中使用预训练的单词向量，以下组件将加载所需的预训练模型</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">rasa.com</p></div></div></div></a></div><p id="76eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数内置<code class="fe ni nj nk nl b">tokenizers</code>现在已经标准化为具有以下属性:</p><ul class=""><li id="acba" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">intent_tokenization_flag</code> —检查是否拆分意图的标志</li><li id="895e" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">intent_split_symbol</code> —意图应分割的符号</li><li id="5b4d" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">token_pattern</code> —检测令牌的正则表达式</li></ul><p id="6ad9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些键用于<a class="ae ky" href="https://rasa.com/docs/rasa/tuning-your-model#doing-multi-intent-classification" rel="noopener ugc nofollow" target="_blank">多意图分类</a>。目前只对<code class="fe ni nj nk nl b">DIETClassifier</code>有效。</p><p id="be93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请看下面的<code class="fe ni nj nk nl b">WhiteSpaceTokenizer</code>代码片段:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="b448" class="nr md it nl b gy ot ou l ov ow">pipeline:<br/>- name: "WhitespaceTokenizer"<br/>  "intent_tokenization_flag": False<br/>  "intent_split_symbol": "_"<br/>  "token_pattern": None</span></pre><p id="e89f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，酒店<code class="fe ni nj nk nl b">case_sensitive</code>已经从<code class="fe ni nj nk nl b">tokenizers</code>移到了<code class="fe ni nj nk nl b">featurizers</code>。除非使用以下组件，否则可以安全地忽略该属性:</p><ul class=""><li id="eaee" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">KeywordIntentClassifier</code></li><li id="fc44" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">SpacyNLP</code></li><li id="7242" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">RegexFeaturizer</code></li></ul><h2 id="03cc" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">政策</h2><div class="od oe gp gr of og"><a href="https://rasa.com/docs/rasa/policies" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">政策| Rasa开源文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">您的项目的config.yml文件带有一个policies键，您可以使用它来自定义您的助手使用的策略…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">rasa.com</p></div></div></div></a></div><p id="dac3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">增加了一个名为<code class="fe ni nj nk nl b">RulePolicy</code>的新策略。这对于总是有固定行为的对话很有用。它与故事略有不同，应该与故事一起使用以获得更好的性能。你需要在你的<code class="fe ni nj nk nl b">config.yml</code>中有<code class="fe ni nj nk nl b">RulePolicy</code>才能使用<code class="fe ni nj nk nl b">Rules</code>和<code class="fe ni nj nk nl b">Forms</code>。在实现以下功能时，它非常有用:</p><ul class=""><li id="00c5" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">一轮互动，如常见问题</li><li id="e24b" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">后退行为</li><li id="d455" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">处理表单中不需要的行为</li></ul><p id="8193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，以下政策已被弃用，转而支持<code class="fe ni nj nk nl b">RulePolicy</code>。您仍然可以使用<code class="fe ni nj nk nl b">RulePolicy</code>及其各自的<code class="fe ni nj nk nl b">classifiers</code>实现相同的功能。</p><ul class=""><li id="2c20" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">映射策略</li><li id="6928" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">后备策略</li><li id="8c3b" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">两阶段回退策略</li><li id="f90f" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">表单策略</li></ul><h2 id="fcf9" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">进口商</h2><div class="od oe gp gr of og"><a href="https://rasa.com/docs/rasa/training-data-importers" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">培训数据导入器| Rasa开源文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">默认情况下，您可以使用命令行参数来指定Rasa应该在磁盘上的什么位置查找训练数据。拉莎…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">rasa.com</p></div></div></div></a></div><p id="0c3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，Rasa使用<code class="fe ni nj nk nl b">RasaFileImporter</code>。现在，您可以创建自己的数据解析器来加载其他格式的训练数据。如果您的训练数据来自不同的资源，这将非常有用。</p><p id="5d53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，还有一个名为<code class="fe ni nj nk nl b">MultiProjectImporter</code>的实验特性，它允许您将多个Rasa项目的数据集合并成一个。例如，您可以将项目模块化为以下子项目:</p><ul class=""><li id="c9a6" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">餐馆机器人</li><li id="e894" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">房间预订机器人</li><li id="d9d6" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">聊天机器人</li></ul><p id="0351" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后将它们组合起来，创建一个成熟的聊天机器人。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f26a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">领域</h1><h2 id="0a48" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">domain.yml</h2><p id="a585" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe ni nj nk nl b">domain.yml</code>的数据结构保持不变，除了你需要在它的顶部指定版本。您需要为您的所有培训数据文件指定此选项。如果省略，默认情况下，Rasa会将其读取为2.0版。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="5f2c" class="nr md it nl b gy ot ou l ov ow">version: "2.0"</span><span id="ab2a" class="nr md it nl b gy ox ou l ov ow">intents:<br/>  - greet<br/>  - goodbye<br/>  - affirm<br/>  - deny<br/>  - mood_great<br/>  - mood_unhappy<br/>  - bot_challenge</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a8fd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">训练数据格式</h1><p id="0a0f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">2.0版本中一个重大的突破性变化是训练数据格式。</p><h2 id="9773" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">NLU</h2><p id="dd0c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于NLU培训数据，版本2.0的新结构如下:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="50eb" class="nr md it nl b gy ot ou l ov ow">version: "2.0"</span><span id="64a8" class="nr md it nl b gy ox ou l ov ow">nlu:<br/>- intent: greet<br/>  examples: |<br/>    - Hey<br/>    - Hi<br/>    - hello</span><span id="4bd5" class="nr md it nl b gy ox ou l ov ow">- intent: goodbye<br/>  examples: |<br/>    - Goodbye<br/>    - bye bye</span></pre><h2 id="b752" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">NLU元数据</h2><p id="bd31" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">事实上，您现在可以声明额外的包含任意键值对的<code class="fe ni nj nk nl b">metadata</code>。<code class="fe ni nj nk nl b">metadata</code>可由您的定制组件访问。例如，您可以将其声明如下:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="7b84" class="nr md it nl b gy ot ou l ov ow">nlu:<br/>- intent: greet<br/>  metadata:<br/>    sentiment: neutral<br/>  examples:<br/>  - text: |<br/>      hi<br/>  - text: |<br/>      hello</span></pre><p id="d09c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面给出的例子中，<code class="fe ni nj nk nl b">metadata</code>是在意图级别声明的。因此，所有的例子都包含了<code class="fe ni nj nk nl b">metadata</code>。您可以为每个示例单独声明<code class="fe ni nj nk nl b">metadata</code>。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="9a84" class="nr md it nl b gy ot ou l ov ow">nlu:<br/>- intent: greet<br/>  examples:<br/>  - text: |<br/>      hi<br/>    metadata:<br/>      sentiment: neutral<br/>  - text: |<br/>      hello</span></pre><h2 id="c1ea" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">检索意图</h2><p id="4819" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在旧版本中，检索意图是一个实验性的特性，其中一个意图可以被分类为更小的子意图。这对于闲聊很有帮助，因为它减少了你的故事的开销。你需要使用<code class="fe ni nj nk nl b"> /</code>符号来区分主要意图和次要意图。请看下面这个带有两个子意图的<code class="fe ni nj nk nl b">chitchat</code>意图的例子:</p><ul class=""><li id="0eb8" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">ask_name</code></li><li id="5446" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">ask_weather</code></li></ul><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="134e" class="nr md it nl b gy ot ou l ov ow">nlu:<br/>- intent: chitchat/ask_name<br/>  examples: |<br/>    - What is your name?<br/>    - May I know your name?</span><span id="0c36" class="nr md it nl b gy ox ou l ov ow">- intent: chitchat/ask_weather<br/>  examples: |<br/>    - What is the weather?<br/>    - May I know the current weather outside?</span></pre><p id="5f0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与正常意图不同，答案必须放在<code class="fe ni nj nk nl b">responses.yml</code>而不是<code class="fe ni nj nk nl b">domain.yml</code>中。该文件应该位于<code class="fe ni nj nk nl b">data</code>文件夹下，格式与<code class="fe ni nj nk nl b">domain.yml</code>完全相同。这意味着您可以有多种变化，并指定不同的有效载荷。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="c67b" class="nr md it nl b gy ot ou l ov ow">responses:<br/>  utter_chitchat/ask_name:<br/>    - text: "I don't have a name!"</span><span id="f00e" class="nr md it nl b gy ox ou l ov ow">  utter_chitchat/ask_weather:<br/>    - text: "It is sunny"<br/>    - text: "It is raining heavily outside"</span></pre><h2 id="3035" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">实体</h2><p id="48d1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">实体的格式仍然与以前的版本相同，包括实验角色和组标签。如果您没有意识到，角色和组标签可以用来区分同一实体中的某些概念。考虑下面的例子:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="a705" class="nr md it nl b gy ot ou l ov ow">Book me a flight from [Malaysia]{"entity": "country"} to [Singapore]{"entity": "country"}.</span></pre><p id="7c7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从人的角度来看，尽管两个实体都指国家，但我们知道第一个<code class="fe ni nj nk nl b">country</code>指的是出发地，而第二个<code class="fe ni nj nk nl b">entity</code>指的是目的地。我们可以使用这个实验特征来标记它，如下所示:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="848f" class="nr md it nl b gy ot ou l ov ow">Book me a flight from [Malaysia]{"entity": "country", "role": "departure"} to [Singapore]{"entity": "country", "role": "destination"}.</span></pre><p id="7409" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要提供足够的数据来推广它。在这种情况下，您应该具备以下条件:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="a0e1" class="nr md it nl b gy ot ou l ov ow">... from Malaysia to Singapore ...<br/>... from Singapore to Malaysia ...</span></pre><h2 id="2b68" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">同义词</h2><p id="2034" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">同义词的声明方式与NLU数据相同，只是将单词<em class="oy"> intent </em>替换为<em class="oy"> synonym </em>。看看下面的例子:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="300f" class="nr md it nl b gy ot ou l ov ow">nlu:<br/># greet &amp; goodbye intent</span><span id="df36" class="nr md it nl b gy ox ou l ov ow">- synonym: credit<br/>  examples: |<br/>    - credit card account<br/>    - credit account</span></pre><h2 id="5be5" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">正则表达式</h2><p id="3214" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">同样，您可以使用相同的风格通过regex捕获实体。下面的例子演示了一个正则表达式，用于捕获邮政编码的五位数字。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="a815" class="nr md it nl b gy ot ou l ov ow">nlu:<br/># greet &amp; goodbye intent</span><span id="534b" class="nr md it nl b gy ox ou l ov ow">- regex: zipcode<br/>  examples: |<br/>    - \b\d{5}\b</span></pre><h2 id="dcdb" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">查找表</h2><p id="2455" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">至于查找表，应该按如下方式编写:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="147f" class="nr md it nl b gy ot ou l ov ow">nlu:<br/>- lookup: fruits<br/>  examples: |<br/>    - apple<br/>    - banana<br/>    - papaya<br/>    - watermelon</span></pre><p id="9b53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保查找表中的数据是干净的，以防止不必要的行为。</p><h2 id="8bcd" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">故事</h2><p id="6569" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你可以把这些故事和NLU合并成一个文件，但是强烈建议把它们分开。与旧版本相比，新格式更加冗长，但它确实有助于区分意图和行动。因此，在构建你的故事时，你不太可能犯不必要的错误。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="7afd" class="nr md it nl b gy ot ou l ov ow">version: "2.0"</span><span id="c018" class="nr md it nl b gy ox ou l ov ow">stories:</span><span id="b5c3" class="nr md it nl b gy ox ou l ov ow"> - story: happy path<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet<br/>   - intent: goodbye<br/>   - action: utter_bye</span></pre><p id="8d1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于NLU，你可以定义<code class="fe ni nj nk nl b">metadata</code>内幕来存储与故事相关的相关信息。<code class="fe ni nj nk nl b">metadata</code>不用于培训，不会影响您的故事的表现。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="3417" class="nr md it nl b gy ot ou l ov ow">stories:</span><span id="0cd8" class="nr md it nl b gy ox ou l ov ow"> - story: happy path<br/>   metadata:<br/>     author: wfng<br/>     key: value<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet<br/>   - intent: goodbye<br/>   - action: utter_bye</span></pre><p id="6f1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于检索响应，它应该以<code class="fe ni nj nk nl b">utter_ </code>开始，而不是旧的<code class="fe ni nj nk nl b">respond_</code>前缀。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="5b9d" class="nr md it nl b gy ot ou l ov ow">stories:<br/> - story: story with a retrieval action<br/>   steps:<br/>   - intent: chitchat<br/>   - action: utter_chitchat</span></pre><h2 id="7c9c" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">形式</h2><p id="dc81" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">表单现在是培训数据的一部分，而不是Rasa SDK。表单需要<code class="fe ni nj nk nl b">RulePolicy</code>，默认情况下它已经在配置中了。首先，您应该将其定义如下:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="ae4d" class="nr md it nl b gy ot ou l ov ow">forms:<br/>  your_form:<br/>    age:<br/>    - type: from_entity<br/>      entity: age</span></pre><p id="8c1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后您可以指定<code class="fe ni nj nk nl b">action</code>和<code class="fe ni nj nk nl b">active_loop</code>字段，Rasa将在其中循环并调用<code class="fe ni nj nk nl b">utter_ask_{form_name}_{slot_name}</code>或<code class="fe ni nj nk nl b">utter_ask_{slot_name}</code>，直到实体<code class="fe ni nj nk nl b">age</code>被填充。你需要在你的回答中定义它们。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="00c7" class="nr md it nl b gy ot ou l ov ow">stories:<br/> - story: form asking for age<br/>   steps:<br/>   - intent: intent_ask_age<br/>   - action: your_form<br/>   - active_loop: your_form</span></pre><h2 id="ae43" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">检查点和OR语句</h2><p id="c733" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你仍然可以在你的故事中使用<a class="ae ky" href="https://rasa.com/docs/rasa/training-data-format#or-statement" rel="noopener ugc nofollow" target="_blank">检查点</a>和<a class="ae ky" href="https://rasa.com/docs/rasa/training-data-format#or-statement" rel="noopener ugc nofollow" target="_blank">或者陈述</a>。但是，强烈建议不要接触这些功能，因为过度使用它们会对训练时间产生很大影响。</p><h2 id="ef73" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">规则</h2><p id="eef5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">规则描述了对话的一小部分，它总是有一个固定的路径。你可以把它想成是一轮互动，其中将返回相同的答案。与故事不同，规则不概括，主要用于回答常见问题。这类似于Rasa 1.0中<code class="fe ni nj nk nl b">domain.yml</code>中<code class="fe ni nj nk nl b">trigger</code>通过<code class="fe ni nj nk nl b">MappingPolicy</code>的用法。假设每当用户问候机器人时，机器人应该总是用<code class="fe ni nj nk nl b">utter_greet</code>来响应。您可以使用如下规则轻松定义它:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="8da8" class="nr md it nl b gy ot ou l ov ow">rules:</span><span id="8ddc" class="nr md it nl b gy ox ou l ov ow"> - rule: Say `hello` whenever users greet the bot<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet</span></pre><p id="55db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，您可以在规则中指定以下键:</p><ul class=""><li id="4bec" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">conversation_started</code></li><li id="4874" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated"><code class="fe ni nj nk nl b">condition</code></li></ul><p id="9164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将<code class="fe ni nj nk nl b">conversation_started</code>键设置为<code class="fe ni nj nk nl b">true</code>，该规则将仅在会话开始时触发一次。在这种情况下，机器人将不会在稍后的对话中使用<code class="fe ni nj nk nl b">utter_greet</code>进行响应。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="69bf" class="nr md it nl b gy ot ou l ov ow">rules:</span><span id="4489" class="nr md it nl b gy ox ou l ov ow"> - rule: Say `hello` when users greet the bot at the beginning<br/>   conversation_start: true<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet</span></pre><p id="0d54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe ni nj nk nl b">condition</code>根据一个槽是否被填充或者是否有一个<code class="fe ni nj nk nl b">active_loop</code>事件来约束规则。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="33de" class="nr md it nl b gy ot ou l ov ow">rules:</span><span id="e291" class="nr md it nl b gy ox ou l ov ow"> - rule: Say `hello` whenever users greet the bot and slot was set<br/>   condition:<br/>   - slot_was_set:<br/>     - user_provided_name: true<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet</span></pre><p id="03be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦规则到达最后一步，默认行为是等待用户输入。您可以通过将<code class="fe ni nj nk nl b">wait_for_user_input</code>键设置为<code class="fe ni nj nk nl b">false</code>来修改该功能。</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="b2f9" class="nr md it nl b gy ot ou l ov ow">rules:</span><span id="22be" class="nr md it nl b gy ox ou l ov ow"> - rule: Rule which will not wait for user input<br/>   steps:<br/>   - intent: greet<br/>   - action: utter_greet<br/>   wait_for_user_input: false</span></pre><h2 id="96c7" class="nr md it bd me ns nt dn mi nu nv dp mm li nw nx mo lm ny nz mq lq oa ob ms oc bi translated">试验</h2><p id="9a56" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">供您参考，您可以编写测试对话来测试您的聊天机器人的性能。该功能在旧版本的Rasa下已经可用。版本2.0的测试用例应该编写如下:</p><pre class="kj kk kl km gt op nl oq or aw os bi"><span id="4294" class="nr md it nl b gy ot ou l ov ow">stories:<br/>- story: happy path 1<br/>  steps:<br/>  - user: |<br/>      hello there<br/>    intent: greet<br/>  - action: utter_greet<br/>  - user: |<br/>      see you later<br/>    intent: goodbye<br/>  - action: utter_bye</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="745b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="ead3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们回顾一下今天所学的内容。</p><p id="5a3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从介绍Rasa开源2.0开始。</p><p id="e951" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在新版本中，文件夹结构和配置文件或多或少是相同的，只有一些小的变化。一些政策被否决，转而支持<code class="fe ni nj nk nl b">RulesPolicy</code>。</p><p id="1aa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们继续讨论Rasa 1.10和2.0之间的重大突破性变化。，这是训练数据格式。我们深入探讨了NLU的新数据格式、故事、规则等等。</p><p id="a7b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，您应该对即将发布的Rasa 2.0稳定版有一个大致的了解。</p><p id="e3d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢你阅读这篇文章。希望在下一篇文章中再见到你！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5850" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考</h1><ol class=""><li id="bc6b" class="mz na it lb b lc mu lf mv li oz lm pa lq pb lu pc nf ng nh bi translated"><a class="ae ky" href="https://blog.rasa.com/whats-ahead-in-rasa-open-source-2-0/" rel="noopener ugc nofollow" target="_blank">Rasa开源2.0的未来</a></li><li id="4188" class="mz na it lb b lc nm lf nn li no lm np lq nq lu pc nf ng nh bi translated"><a class="ae ky" href="https://rasa.com/docs/rasa" rel="noopener ugc nofollow" target="_blank"> Rasa文档</a></li></ol></div></div>    
</body>
</html>