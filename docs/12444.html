<html>
<head>
<title>This Python Library Can Animate Your Charts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个Python库可以制作图表动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/this-python-library-can-animate-your-charts-a7c0a98b3463?source=collection_archive---------16-----------------------#2022-06-06">https://betterprogramming.pub/this-python-library-can-animate-your-charts-a7c0a98b3463?source=collection_archive---------16-----------------------#2022-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="19c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫图书馆简介</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/57dda8f50007eef4ae76cbdf399dbe14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XSv_5VRKJE-cvGryDorMsA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pawel Czerwinski 在<a class="ae ky" href="https://unsplash.com/s/photos/dark-abstract?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="8849" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="cc66" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您想创建动画图表吗？活着的熊猫可能是你的解决方案。这篇文章将向你展示如何使用Pandas Alive库制作图表动画。整个过程只用一行代码就可以完成。事不宜迟，我们开始吧！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="636b" class="kz la it bd lb lc mu le lf lg mv li lj jz mw ka ll kc mx kd ln kf my kg lp lq bi translated">履行</h1><h2 id="ac16" class="mz la it bd lb na nb dn lf nc nd dp lj ma ne nf ll me ng nh ln mi ni nj lp nk bi translated">安装库</h2><p id="8f5e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们可以使用库之前，我们需要做的第一步是安装库。该过程可以通过使用pip命令来完成，如下所示:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="3e01" class="mz la it nm b gy nq nr l ns nt">! pip install pandas_alive</span></pre><h2 id="61eb" class="mz la it bd lb na nb dn lf nc nd dp lj ma ne nf ll me ng nh ln mi ni nj lp nk bi translated">数据集</h2><p id="d777" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于数据集，我们使用Kaggle的gapminder数据集。Gapminder是一个数据集，包含从1962年到2007年世界各国的GDP、预期寿命和人口数量的信息。更多详情，可以在 这里看链接<a class="ae ky" href="https://www.kaggle.com/datasets/tklimonova/gapminder-datacamp-2007" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">。</strong></a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/4ea5919bc9fbce8466b5f65bed326344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*og3_y_7Rxy8j2YnbhMC6EA.png"/></div></div></figure><p id="0c2b" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">让我们使用下面这些代码行来加载数据:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="b2cc" class="mz la it nm b gy nq nr l ns nt">import pandas_alive<br/>import pandas as pd</span><span id="d126" class="mz la it nm b gy oa nr l ns nt">df = pd.read_csv('data.csv', encoding='iso-8859-1', parse_dates=['year'])<br/>df.head()</span></pre><p id="9481" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">以下是数据预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/d6c860a101ac9d4fa66a84d771a593aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*lXiNlQ-ThInvMjcM24XmYA.png"/></div></figure><h1 id="6725" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">准备数据</h1><p id="b442" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了使图表更加方便，我们需要对数据进行预处理。首先，我们根据世界上人口最多的国家过滤数据。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="0cc7" class="mz la it nm b gy nq nr l ns nt"><strong class="nm iu"># Input: Data -&gt; Grouping based on country -&gt; <br/># Take the max value -&gt; Sort by largest populations first -&gt; <br/># Output: the countries' name</strong><br/>most_pop = df.groupby('country').max().reset_index().sort_values('population', ascending=False).country[:10].tolist()</span><span id="cb75" class="mz la it nm b gy oa nr l ns nt">most_pop</span><span id="4627" class="mz la it nm b gy oa nr l ns nt"><strong class="nm iu">&gt;&gt;&gt; ['China', 'India', 'United States', 'Indonesia', 'Brazil',<br/> 'Pakistan', 'Bangladesh', 'Nigeria', 'Japan', 'Mexico']</strong></span></pre><p id="1bc8" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">然后，我们使用pivot_table函数透视该表，将year列设置为行索引，将population列设置为列索引。下面是代码及其输出:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="cda9" class="mz la it nm b gy nq nr l ns nt"><strong class="nm iu"># Filter based on most populous country</strong><br/>df = df[df.country.isin(most_pop)]</span><span id="73df" class="mz la it nm b gy oa nr l ns nt"><strong class="nm iu"># Pivot the table</strong><br/>df_pivot = df.pivot_table(values='population', columns=['country'], index=['year'])</span><span id="ddf7" class="mz la it nm b gy oa nr l ns nt">df_pivot.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/f6daa83302e2fa98d8456025d1e78d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSwTih1miPfMrT-9a4XISA.png"/></div></div></figure><h2 id="2c7e" class="mz la it bd lb na nb dn lf nc nd dp lj ma ne nf ll me ng nh ln mi ni nj lp nk bi translated">创建图表</h2><p id="38aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有了数据后，我们可以创建动画图表。生成图表很容易。这个过程可以在一行代码中完成。</p><p id="6017" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">让我们以创建条形图为例。要创建它，我们可以使用这样一行代码:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5bd7" class="mz la it nm b gy nq nr l ns nt">df_pivot.plot_animated('bar-chart.gif')</span></pre><p id="1393" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">这是结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/acfb4e3e5d14f9dd5eee83bb69f26857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6uRVxQiaR7XGTTrVTs6hEQ.gif"/></div></div></figure><p id="5fc3" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">多酷啊。！我们还没完。假设我们想要创建一个基于不断增长的人口数量的折线图。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5c36" class="mz la it nm b gy nq nr l ns nt">df_pivot.diff().fillna(0).plot_animated('line-chart.gif', kind='line')</span></pre><p id="e2a1" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">如您所见，我们通过添加kind参数调整了plot_animated函数。下面是代码的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/25753a655686db4445eb4a521465b64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PJ8e0YT0aJUWDX7XU_eQpQ.gif"/></div></div></figure><p id="cd22" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">现在让我们创建饼图。我们还希望图表在值改变时改变旋转。要生成图表，我们可以使用如下代码行:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="b3f2" class="mz la it nm b gy nq nr l ns nt">df_pivot.plot_animated('pie-chart.gif', kind='pie', rotatelabels=True)</span></pre><p id="cd9a" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">以下是最终结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/0cfd1d71fbd431816f2a70e6092cfb46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wZOh4c7h20nUW8-FbcBwxQ.gif"/></div></div></figure><p id="9777" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">最后，我想给你看熊猫图书馆的一个很棒的特色。我们可以一次可视化多个动画图表。</p><p id="8e0b" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">我们需要做的就是创建图表，并将它们放到animate_multiple_plots函数中。下面是实现这一点的代码:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="ec32" class="mz la it nm b gy nq nr l ns nt">anim_bar = df_pivot.plot_animated()<br/>anim_line = df_pivot.diff().fillna(0).plot_animated(kind='line', period_label=False, add_legend=False)</span><span id="46a9" class="mz la it nm b gy oa nr l ns nt">pandas_alive.animate_multiple_plots('multi-chart-1.gif', [anim_bar, anim_line], enable_progress_bar=True)</span></pre><p id="f2ba" class="pw-post-body-paragraph lr ls it lt b lu nv ju lw lx nw jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">这是最终的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/8a69948be77ef0a5b32ff5f544e489d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/1*dvInHLcxFyWkchkIZKkkag.gif"/></div></figure><h1 id="bec0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后的想法</h1><p id="4165" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！您已经学习了如何使用熊猫馆创建动画图表。我希望它能帮助你不用花太多时间在代码上就能生成一个很棒的图表。谢谢你看我的文章！</p><h2 id="0ef9" class="mz la it bd lb na nb dn lf nc nd dp lj ma ne nf ll me ng nh ln mi ni nj lp nk bi translated">参考</h2><p id="7975" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]活着的熊猫。<a class="ae ky" href="https://github.com/JackMcKew/pandas_alive" rel="noopener ugc nofollow" target="_blank">https://github.com/JackMcKew/pandas_alive</a></p></div></div>    
</body>
</html>