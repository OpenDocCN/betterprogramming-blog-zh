<html>
<head>
<title>3 Steps You Need To Know for a Successful GitOps Implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">成功实施GitOps需要知道的3个步骤</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-steps-you-need-to-know-for-a-successful-gitops-implementation-5b4a4b9f744d?source=collection_archive---------9-----------------------#2021-08-10">https://betterprogramming.pub/3-steps-you-need-to-know-for-a-successful-gitops-implementation-5b4a4b9f744d?source=collection_archive---------9-----------------------#2021-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b04d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">#3 —独立的构建和部署流程(CI和CD)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/108cfe177367d82c4bc5bc268848d294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BRP2-ljwtqeC6TIG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯汀·休姆在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps是一个能够在开发和操作流程之间实现流线化的模型。它通过一个包含配置文件和应用程序代码的协作中心Git将它们结合在一起。</p><p id="878f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://microtica.com/blog/gitops-devops-for-infrastructure-automation/?utm_source=medium&amp;utm_medium=referral_link&amp;utm_campaign=gitops&amp;utm_content=gitops_model" rel="noopener ugc nofollow" target="_blank"> GitOps </a>服务于开发基于容器化和微服务的云原生解决方案的组织。它增强了开发人员的体验，使他们无需了解底层基础设施就能贡献特性。同时通过代码审查和批准来控制操作。</p><p id="dab9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps提高了系统的稳定性和可靠性，提供了更高的安全保障。但是在您的公司中实现GitOps模型带来的最突出的优势可能是整个工作流程的标准化和一致性。</p><p id="8551" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将介绍开发一个成功的GitOps模型需要考虑的问题:</p><h1 id="3beb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">一切都是代码</h1><p id="b5f5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先将基础设施声明为代码。CloudFormation、Terraform、Palumi、Crossplane是一些可能的声明性语言，您可以使用它们来定义您希望基础设施看起来如何的配置。</p><p id="5a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">声明性代码提高了可读性和可维护性。此外，作为应用程序代码生命周期一部分的实践现在也可以复制到基础设施代码中。</p><p id="2557" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在GitOps中，使用Git存储库进行IaC开发是常见的做法。这样，您可以探索版本控制、协作和审计等好处。</p><p id="6609" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了Docker和Kubernetes这样的技术，开发环境的设置变得更加易于管理。您将系统依赖项定义为代码。在Docker文件中，您定义您的环境、版本、配置和依赖项，Docker在运行时强制执行这些定义。</p><p id="ce2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps不仅限于作为代码的基础设施。任何可以定义为代码的东西也可以使用GitOps模型。这包括安全性、策略、合规性以及基础架构之外的所有运营。</p><h1 id="1cc5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">审查过程</h1><p id="d9db" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在处理应用程序代码时，通常会有多个需要同时实现的特性。因此，利用版本控制系统是当今软件开发的必备条件，因为不同的团队在同一个代码库上合作，并且需要有合并所有这些变更的机制。</p><p id="0798" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您已经通过处理功能分支和拉请求利用了<a class="ae ky" href="https://danielkummer.github.io/git-flow-cheatsheet/" rel="noopener ugc nofollow" target="_blank"> Git flow system </a>，那么您就不需要为您的GitOps工作流投资太多新的流程。此外，由于您的基础设施(和其他操作)被定义为代码，您将能够实现相同的代码审查实践。</p><p id="2402" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个合适的Git流程包括从主分支分叉或者创建一个新的特性分支。当有人对代码进行更改时，他们会发出一个pull请求，该请求应该由没有处理过该代码的其他团队成员进行审查。他们审查代码，验证代码，然后批准代码。一旦被批准，代码就可以被合并到主分支中，并交付给测试或生产。</p><p id="919b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，您可以跟踪谁做了哪些更改，并确保环境拥有正确的代码版本。</p><p id="e667" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基础设施也是如此。在一个基础设施模型中，通常，主分支代表一个环境，比如开发、测试、阶段、生产，以及在该环境中运行的状态。通过拉式请求，开发人员可以与运营部门协作进行同行审查，安全和合规性专家也可以参与这一阶段，以正确验证环境的状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/4dd76346f17be27b65b1b86405e74b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zLYNsmG2_aQ7L5se.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="bf13" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">独立的构建和部署流程(CI和CD)</h1><p id="9d1b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在DevOps实践中，CI/CD流程被视为一个实体，通常在一个管道中交付。但是随着组件化应用程序的兴起，开发和操作之间的管道变得更加复杂。</p><p id="bb74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CI(持续集成)过程负责将应用程序代码构建并打包到容器映像中。</p><p id="800b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CD(持续部署)过程是实施GitOps的关键部分。这个过程执行自动化，使最终状态符合系统的期望状态，这在存储库代码中有描述。这是在成功合并主分支中的代码后完成的。</p><p id="ec06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终，<a class="ae ky" href="https://www.weave.works/blog/separating-ci-from-cd-with-gitops-and-other-insights-from-kubecon-eu" rel="noopener ugc nofollow" target="_blank"> GitOps将CI和CD视为两个独立的流程</a>。CI是一个开发过程，CD是一个操作过程。GitOps工作流模型将两者结合在一起。</p><p id="d4b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常用于分隔这些流程的GitOps方法是引入另一个Git存储库作为中介。这个repo包含关于环境的信息，并且随着每个提交，部署过程被触发。这样，CI流程永远不会触及底层基础设施，比如Kubernetes集群。</p><p id="25db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将构建管道从部署管道中分离出来是对错误配置的有力保护，有助于实现更高的安全性和合规性。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="0b45" class="lv lw it bd lx ly na ma mb mc nb me mf jz nc ka mh kc nd kd mj kf ne kg ml mm bi translated">结论</h1><p id="027b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">GitOps作为一个运营模型使用了许多团队都知道的DevOps实践，例如IaC、版本控制、代码审查和CI/CD管道。</p><p id="f9f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用GitOps，您可以自动化基础设施供应流程，并将Git用作基础设施的单一来源。这就是为什么要创建一个成功的GitOps模型，您需要一个环境的声明性定义。</p><p id="a5a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的团队中也有一个拉请求工作流，那将是最好的。为了能够在基础结构代码上协作并创建操作变更，您应该打开一个pull请求。然后，高级DevOps工程师和安全专家审查pull请求，以验证更改，如果一切正常，就合并到主分支中。</p><p id="186f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，对于完整的GitOps实施，您需要CI/CD自动化来调配和配置底层环境以及部署定义的代码。</p><p id="b1d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps有助于改善开发人员和运营团队之间的协作，提高他们的生产力，并增加部署频率。有了这些改进，团队可以更快更安全地发布，以保持他们在市场中的地位。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="61d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nf">最初发表于</em>【https://microtica.com】<em class="nf"/></p></div></div>    
</body>
</html>