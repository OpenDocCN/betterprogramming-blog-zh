<html>
<head>
<title>Goodbye, RecyclerView Adapters — Hello, Lists in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">再见，RecyclerView适配器—你好，Jetpack中的列表构成</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/goodbye-recyclerview-adapters-hello-lists-in-jetpack-compose-d0a389a1683e?source=collection_archive---------6-----------------------#2021-06-01">https://betterprogramming.pub/goodbye-recyclerview-adapters-hello-lists-in-jetpack-compose-d0a389a1683e?source=collection_archive---------6-----------------------#2021-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="70dd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">没有更多的适配器来显示大型Android列表。使用LazyColumn和LazyRow</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f09e091aa08487bfbabe7238b5b583ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vJ7OETlkGgxdtuaT"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@cookiethepom?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Cookie在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的Pom </a>拍摄。</p></figure><p id="05e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习如何在<a class="ae ky" href="https://developer.android.com/jetpack/compose" rel="noopener ugc nofollow" target="_blank"> Jetpack Compose </a>中显示大型数据集。我们将涉及水平和垂直列表。除此之外，您还将学习如何实现粘性标题和多种视图类型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2f3c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="f8fc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Jetpack Compose是谷歌最近试图让Android开发者轻松构建UI的尝试之一。</p><blockquote class="mz na nb"><p id="c427" class="kz la nc lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated">“Jetpack Compose是一个用于构建原生Android UI的现代工具包。Jetpack Compose以更少的代码、强大的工具和直观的Kotlin APIs简化并加速了Android上的UI开发。”— <a class="ae ky" href="https://developer.android.com/jetpack/compose/tutorial" rel="noopener ugc nofollow" target="_blank">安卓开发者</a></p></blockquote><p id="7da2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jetpack Compose最近进行了测试。这意味着API结构将不再有任何剧烈的变化，因此这将是学习如何使用这个下一代UI套件进行Android开发的大好时机。</p><p id="4d76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要安装Android Studio Canary，北极狐(2020.3.1) <strong class="lb iu"> </strong>版本才能使用Jetpack Compose beta。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8b7e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">先决条件</h1><p id="3498" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在进一步学习之前，您必须具备如何使用Jetpack Compose的基本知识。如果你是作曲新手，我强烈推荐阅读以下文章:</p><ul class=""><li id="2c6f" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/jetpack-compose-components-part-1-a80717dbfb59">“Jetpack合成组件(第1部分)”</a></li><li id="c388" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/build-android-layouts-in-jetpack-compose-bda2e0837f5e">“在JetPack Compose中构建Android布局”</a></li><li id="9ea1" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/theming-in-jetpack-compose-for-android-667d42b8279c">“面向Android的Jetpack合成中的主题化”</a></li><li id="3626" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/navigation-with-jetpack-compose-in-android-ab84d0984ade">“在Android中使用Jetpack组合导航”</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="27b6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">惰性柱</h1><p id="4382" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要以传统方式显示垂直滚动列表，我们必须编写大量代码:</p><ul class=""><li id="fc99" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">显示<code class="fe nu nv nw nx b">RecyclerView</code>的布局文件</li><li id="4384" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">适配器类</li><li id="d844" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">显示适配器项目的布局文件</li><li id="9168" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">一个<code class="fe nu nv nw nx b">Activity</code>或<code class="fe nu nv nw nx b">Fragment</code>级</li></ul><p id="a049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Compose，只需一个函数就可以显示一个列表。当涉及到编写时，主要的优点是代码简洁，手动工作少。一种常见用例的简单方法(显示项目列表)。不再拖延，让我们从<code class="fe nu nv nw nx b">LazyColumn</code>可组合函数开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="c6c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个有很多事情要做的功能，对吗？相信我，我第一次用的时候也有这种感觉，但是一旦你熟悉了，就小菜一碟了。</p><p id="1933" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是我们经常使用的参数:</p><ul class=""><li id="a3a3" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><code class="fe nu nv nw nx b">Modifier</code>:<code class="fe nu nv nw nx b">Modifier</code>是一种修改组件某些方面的方式，这将导致它在屏幕上的显示方式。不仅仅和<code class="fe nu nv nw nx b">lazyColumn</code>有关。我们几乎可以在任何组合组件上使用修饰符。你可以在<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/jetpack-compose-components-part-3-ce5ae661f3d6">这篇文章</a>中了解更多。</li><li id="59b1" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe nu nv nw nx b">LazyListState</code>:用于控制和监控列表的状态。</li><li id="589c" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe nu nv nw nx b">PaddingValues</code>:用于给列表添加填充。一个常见的用例是向列表添加内容填充。</li><li id="b71a" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe nu nv nw nx b">reverseLayout</code>:在<code class="fe nu nv nw nx b">true</code>时反转滚动方向。</li><li id="2b11" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe nu nv nw nx b">content</code>:描述内容的块。在这个块中，您可以使用像<code class="fe nu nv nw nx b">LazyListScope.item</code>这样的方法来添加单个项目，或者使用<code class="fe nu nv nw nx b">LazyListScope.items</code>来添加项目列表。</li></ul><h2 id="0e4d" class="oa md it bd me ob oc dn mi od oe dp mm li of og mo lm oh oi mq lq oj ok ms ol bi translated">使用</h2><p id="afb5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">理论说够了。让我们获得一些实际经验。我们的目标是使用<code class="fe nu nv nw nx b">LazyColumn</code>显示订阅列表。这里，我们必须显示一个可以滚动订阅列表的<code class="fe nu nv nw nx b">topbar</code>。看一下实现情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="9916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe nu nv nw nx b">lazyColumn</code>和<code class="fe nu nv nw nx b">modifier</code>参数来填充最大宽度和高度。然后我们使用<code class="fe nu nv nw nx b">item</code> Compose函数将<code class="fe nu nv nw nx b">topbar<em class="nc"> </em></code>布局放大为列表中的第一项。我们使用<code class="fe nu nv nw nx b">items</code> Compose函数通过传递列表来显示一个<code class="fe nu nv nw nx b">SubscriptionsItems</code> <em class="nc"> </em>的列表。</p><p id="6bf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw nx b">item</code>和<code class="fe nu nv nw nx b">items</code>是<code class="fe nu nv nw nx b">LazyListScope</code> <em class="nc"> </em>界面中的两个函数，分别用于展开单个作曲函数和显示列表。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5a3b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">拉兹罗</h1><p id="ec64" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">是另一个用于显示水平列表的可组合函数。在语法和实现上都是<code class="fe nu nv nw nx b">LazyColumn</code> <em class="nc"> </em>的翻版。唯一的区别是列表只能水平滚动。让我们从<code class="fe nu nv nw nx b">LazyRow</code> <em class="nc"> </em>可组合函数开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="b6a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我认为没有必要做任何解释，因为它是<code class="fe nu nv nw nx b">lazyColumn</code>的复制品。我们来看看用法。</p><h2 id="fb7e" class="oa md it bd me ob oc dn mi od oe dp mm li of og mo lm oh oi mq lq oj ok ms ol bi translated">使用</h2><p id="2d01" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们的目标是使用<code class="fe nu nv nw nx b">LazyRow</code>显示订阅列表。这里，我们必须显示订阅列表。看一下实现情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="be02" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">多视图类型</h1><p id="a2a2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">多视图类型就是在列表中显示不同布局的能力。为了在传统方法中实现这一点，我们在<code class="fe nu nv nw nx b">RecyclerView</code>适配器中使用了一个叫做<code class="fe nu nv nw nx b">getViewType</code>的东西。基于列表项，我们传递一个唯一的视图类型常量。基于这个常量，我们在适配器中创建和膨胀各自的布局和<code class="fe nu nv nw nx b">viewholder</code> <em class="nc"> </em>。</p><p id="e530" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在Compose中，我们不需要使用任何常量或额外的代码。我们只是触发适当的可组合函数，就像我们在<code class="fe nu nv nw nx b">lazyColumn</code>示例中对<code class="fe nu nv nw nx b">topbar</code>和列表项所做的那样。</p><p id="0362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更清楚地理解多视图类型，让我们看一个常见的用例，其中我们根据显示名称的第一个字符显示列表。这里我们的目标是显示列表，列表由订阅名称的首字符分隔。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="20c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在收到的数据集上，我们已经基于订阅名称的第一个字符应用了<code class="fe nu nv nw nx b">groupBy</code> <em class="nc"> </em>函数。这将返回一个以初始字符为键的映射，以及以该字符为值的订阅列表。然后，我们使用这个映射来扩展标题和组合函数列表。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3c8b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">粘性标题</h1><p id="7f55" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在Jetpack Compose中实现sticky headers是一个简单的函数调用，但是对于传统的方法，我们必须做大量的工作。还记得我说过<code class="fe nu nv nw nx b">item</code>和<code class="fe nu nv nw nx b">items</code>是<code class="fe nu nv nw nx b">LazyListScope</code>界面中的两个函数吗？原来它还有一个功能叫<code class="fe nu nv nw nx b">stickyHeader</code> <em class="nc">。</em></p><p id="5646" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw nx b">stickyHeader</code> <em class="nc"> </em>仍然是一个实验性的特性。要使用它，我们需要用<code class="fe nu nv nw nx b">@ExperimentalFoundationApi</code> <em class="nc">注释我们的Compose函数。</em>我们只需要用<code class="fe nu nv nw nx b">stickyHeader</code> <em class="nc"> </em>替换上面示例中的<code class="fe nu nv nw nx b">item</code>函数，就可以使标题项成为粘性标题。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fa84" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考</h1><ul class=""><li id="69c5" class="ng nh it lb b lc mu lf mv li om lm on lq oo lu nl nm nn no bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=BhqPpUYJYeQ&amp;t=62s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=BhqPpUYJYeQ&amp;t = 1s</a></li></ul><h1 id="72df" class="mc md it bd me mf op mh mi mj oq ml mm jz or ka mo kc os kd mq kf ot kg ms mt bi translated">奖金</h1><p id="eb10" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Jetpack中的Android素材主题由Satya Pavan Kantamani创作</p><div class="ow ox gp gr oy oz"><a rel="noopener  ugc nofollow" target="_blank" href="/material-theming-in-jetpack-compose-776af9b4498c"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">Jetpack Compose中的Android材质主题</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">使用Compose轻松定制应用程序范围的主题</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">better编程. pub</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div><p id="2512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读。</p></div></div>    
</body>
</html>