<html>
<head>
<title>How To Add Javascript to WordPress Safely</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何安全地将Javascript添加到WordPress</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-add-javascript-to-wordpress-a4fdc7618a21?source=collection_archive---------4-----------------------#2019-07-25">https://betterprogramming.pub/how-to-add-javascript-to-wordpress-a4fdc7618a21?source=collection_archive---------4-----------------------#2019-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/44058121abb416d00b559e262d66c195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QwozGRqkw0poefn2.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">莫伊插画</p></figure><p id="b8ee" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">当你想给你的<a class="ae ld" href="https://wordpress.org/about/" rel="noopener ugc nofollow" target="_blank">站点增加交互性的时候，这种情况就会出现。意思是:你好JavaScript。但是，如何以正确的方式将JavaScript添加到WordPress中，这样你就可以拥有一个很酷的网站而不会失眠？</a></p><p id="6c38" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在WordPress中，有一种特殊的方法来修改你的站点。说到JavaScript，就叫入队。</p><p id="8ce3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你在现实生活中很少会用到这个令人讨厌的词，但它值得学习，否则，你就有可能破坏你的网站。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="0783" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">以传统方式添加JavaScript</h1><p id="868f" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">在HTML中，JavaScript代码被插入到<code class="fe mo mp mq mr b">&lt;script&gt;</code>和<code class="fe mo mp mq mr b">&lt;/script&gt;</code>标签之间。就这么简单。</p><p id="9b27" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是，像WordPress这样的内容管理系统呢？在WordPress中，根据<a class="ae ld" href="https://wphierarchy.com/" rel="noopener ugc nofollow" target="_blank"> WordPress模板层次</a>，使用不同的PHP文件加载每个页面。让我们回到WordPress的基础。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="76fe" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">以正确的方式添加JavaScript</h1><p id="8570" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">WordPress作为一个内容管理系统，尽可能的不同于传统的静态网站。</p><p id="c0aa" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是一个使用一个活动主题和多个插件的生态系统。每个主题和插件又由许多文件组成，从PHP和JavaScript到CSS。</p><p id="6083" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，WordPress站点会很快变得杂乱无章。为了让一切和谐地工作，建议开发者按照标准的WordPress方法加载JavaScript和CSS，称为<em class="ms"> enqueue </em>。</p><p id="00d9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">对于新的WordPress开发者来说，Enqueue可能是一个陌生的概念，但最终，我们仍然比没有它要好。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="e67d" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤1:创建一个子主题</h1><p id="633b" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">你可能会问:“为什么要费心制作一个儿童主题，而不是马上投入进去？”</p><p id="4854" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果您对父主题进行了修改，并且在将来某个时候更新了主题，您将会丢失这些更改。</p><p id="b382" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">另一个原因是创建一个子主题需要大约五分钟。如果你已经不辞辛苦地在你的WordPress站点上添加了JavaScript，为什么不多花五分钟作为对策呢？</p><p id="7aa1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你不知道怎么做，看看我的教程，制作一个<a class="ae ld" href="https://komonodesign.com/how-to-create-a-wordpress-child-theme/" rel="noopener ugc nofollow" target="_blank"> WordPress子主题</a>。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="0189" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤2:创建您的定制JavaScript文件</h1><p id="981f" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">当我开始在WordPress中使用JavaScript时，我的一个问题是，是在现有文件中添加自定义JavaScript代码，还是创建一个新的JavaScript文件。</p><p id="4e6f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">回想起来，这听起来好像我是个业余爱好者，但我们都必须从某个地方开始。</p><p id="62ac" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">的确，作为一个任何学科的学习者，你所遇到的大多数问题，在你之前已经有成千上万的人遇到过了。</p><p id="d7e2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你有这个疑问，你并不孤单。</p><p id="fdf8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">正确答案是:</p><ul class=""><li id="7d43" class="mt mu it kh b ki kj km kn kq mv ku mw ky mx lc my mz na nb bi translated">创建一个包含自定义代码的新JavaScript文件。</li><li id="a4b1" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated">用唯一的名称保存它。</li><li id="8646" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated">将其添加到您的子主题的<code class="fe mo mp mq mr b">.js</code>文件夹中。</li></ul><p id="ac7c" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">WordPress正在把自己塑造成一个<a class="ae ld" href="https://torquemag.io/2015/07/5-ways-wordpress-is-like-the-ultimate-lego-set/" rel="noopener ugc nofollow" target="_blank">乐高套装</a>，所以如果可能的话不要弄乱现有的文件。</p><figure class="ni nj nk nl gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/95cb827f3ecac37a5594f4b4041e60d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RXidxgkfQ4EtIwjHzP14fQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">粘贴我的注册表单的简单JavaScript代码片段。</p></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="1384" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤3:在functions.php将JavaScript文件排队</h1><p id="1d4f" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">修改你的WordPress文件是一件令人头疼的事情，但是对于<code class="fe mo mp mq mr b">functions.php</code>文件来说更是如此。</p><p id="6767" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个无情的文件就像一个WordPress插件，为你的网站增加了更多的功能。事实上，你甚至可以在这个文件中制作小插件。</p><p id="2bb6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们看看如何让新创建的JavaScript文件入队。下面是我的代码，用于将我的自定义JavaScript加入WordPress。</p><pre class="ni nj nk nl gt nm mr nn no aw np bi"><span id="123f" class="nq lm it mr b gy nr ns l nt nu">function popper_enqueue_styles() {<br/>wp_enqueue_script( 'custom', get_stylesheet_directory_uri() . '/js/custom.js', array(), '', true );<br/>}</span></pre><p id="239b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我来解释一下上面的代码是什么意思。</p><ul class=""><li id="4f03" class="mt mu it kh b ki kj km kn kq mv ku mw ky mx lc my mz na nb bi translated"><code class="fe mo mp mq mr b">wp_enqueue_script</code>是一个注册你的JavaScript文件的函数。</li><li id="f964" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated"><code class="fe mo mp mq mr b">‘custom’</code>是<code class="fe mo mp mq mr b">$handle</code>值的值，它只是脚本文件的名称。</li><li id="be02" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated"><code class="fe mo mp mq mr b">get_stylesheet_directory_uri() . ‘/js/custom.js’</code>提供JavaScript的位置。<code class="fe mo mp mq mr b">get_stylesheet_directory_uri()</code>是一个函数，用于检索当前主题的目录，在本例中是子主题。整个代码告诉WordPress在<code class="fe mo mp mq mr b">wp-content/themes/theme’s name/js</code>目录中寻找名为<code class="fe mo mp mq mr b">custom.js</code>的JavaScript文件。</li><li id="11a7" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated"><code class="fe mo mp mq mr b">array()</code>是<code class="fe mo mp mq mr b">$deps</code>参数的默认值，它指定了脚本所依赖的依赖项。例如，如果您的脚本需要<a class="ae ld" href="https://jquery.com/" rel="noopener ugc nofollow" target="_blank"> jQuery </a>，<code class="fe mo mp mq mr b">$deps</code>将变成<code class="fe mo mp mq mr b">array(‘jQuery’)</code>。</li><li id="86d5" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated"><code class="fe mo mp mq mr b"><strong class="kh iu">‘’</strong></code>是<code class="fe mo mp mq mr b"><strong class="kh iu">$ver</strong></code>参数的值，它指定脚本版本号。通过留下一个空字符串，我告诉WordPress自动生成版本号。</li><li id="07ff" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc my mz na nb bi translated"><code class="fe mo mp mq mr b">true</code>是<code class="fe mo mp mq mr b">$in_footer</code>参数的值，为布尔值。如果为<code class="fe mo mp mq mr b">true</code>，脚本将在结束<code class="fe mo mp mq mr b">&lt;/body&gt;</code>标签之前排队。如果<code class="fe mo mp mq mr b">false</code>，它将在开始<code class="fe mo mp mq mr b">&lt;head&gt;</code>和<code class="fe mo mp mq mr b">&lt;/head&gt;</code>标签之间排队。</li></ul><p id="2097" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你也可以从<a class="ae ld" href="https://torquemag.io/2018/03/beginners-guide-wp_enqueue/" rel="noopener ugc nofollow" target="_blank">扭矩Mag </a>查看这篇关于<code class="fe mo mp mq mr b">wp_enque</code>如何工作的文章。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="e61e" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤4:检查Javascript文件是否添加正确</h1><p id="4afe" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">从技术上来说，你已经完成了向WordPress添加JavaScript。但是你怎么知道它是否被正确地排队了呢？</p><p id="fd08" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">右键单击页面上的任意位置并选择<em class="ms">检查元素</em>。</p><p id="15eb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在浏览器开发工具中，点击<em class="ms">调试器</em>选项卡。您应该会在<code class="fe mo mp mq mr b">wp-content/themes/your theme name/js</code>目录下看到新的JavaScript文件。</p><figure class="ni nj nk nl gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/c1fc44583ac3170bc00db614488e4fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8E8dGMKh_GSNAy8u.png"/></div></div></figure><p id="3a2f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">顺便说一下，这告诉您JavaScript文件已经被合并到您的站点中，但是您如何知道它是否在<code class="fe mo mp mq mr b">&lt;head&gt;</code>或<code class="fe mo mp mq mr b">&lt;body&gt;</code>部分中呢？</p><p id="9472" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为此，右键单击页面并选择<em class="ms">查看页面源代码</em>。</p><p id="d956" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">按CMD+F或CTRL+F调出搜索框。</p><p id="aa63" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">输入“<code class="fe mo mp mq mr b">your theme’s name/js</code>”。在我的例子中，搜索词是<code class="fe mo mp mq mr b">popper-child/js</code>。</p><figure class="ni nj nk nl gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/d2f006cf762c5a897dd6ec02cdb395a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l-luDAIxvztuNQcm.png"/></div></div></figure><p id="3308" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你可以在我网站上使用的一大堆脚本中看到我小小的自定义JavaScript。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="fc2d" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">摘要</h1><p id="fd97" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">如果你正在寻找一种安全的方式将JavaScript添加到WordPress，这里有一个总结:</p><ol class=""><li id="93c1" class="mt mu it kh b ki kj km kn kq mv ku mw ky mx lc nx mz na nb bi translated">创建一个新的JavaScript文件，并将其添加到主题的<code class="fe mo mp mq mr b">js</code>文件夹中。</li><li id="5e9b" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc nx mz na nb bi translated">使用<code class="fe mo mp mq mr b">wp_enqueue_scripts</code>函数将脚本排队。</li><li id="7156" class="mt mu it kh b ki nc km nd kq ne ku nf ky ng lc nx mz na nb bi translated">使用Firefox或Chrome开发人员工具来检查它是否已成功入队并位于正确的位置。</li></ol><p id="1cab" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在你可以走了。承认这一点很尴尬，但我花了几个小时才想出正确的方法。</p><p id="c2f0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你呢？你花了多长时间把JavaScript加入WordPress？你用自定义JavaScript在你的网站上添加了哪些很酷的特性？</p></div></div>    
</body>
</html>