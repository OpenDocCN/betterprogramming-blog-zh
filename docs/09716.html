<html>
<head>
<title>Build a Node.js App to Keep Track of Your University Credits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Node.js应用程序来记录你的大学学分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-node-js-app-to-keep-track-of-your-university-credits-cd8ed16e5b89?source=collection_archive---------2-----------------------#2021-10-01">https://betterprogramming.pub/build-a-node-js-app-to-keep-track-of-your-university-credits-cd8ed16e5b89?source=collection_archive---------2-----------------------#2021-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fa32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为你的作品集创建一个简单的网络应用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dbd589aabf4802fc503fe9097a14cdf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*srkucgZ7OQQ7XquI"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约书亚·阿拉贡在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d6ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正试图建立你的个人投资组合，或者只是想要一个简单的网络应用项目，这里有一个很好的项目想法给你。</p><p id="c2bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我将带您了解如何构建一个简单的Node.js应用程序来跟踪您的大学学分。</p><p id="d66e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程假设您至少具备JavaScript和命令行的工作知识。Node.js生态系统的一些知识也是有帮助的，但是由于教程的目的是解释这些Node.js相关技术是如何协同工作的，所以我不会假定有什么先验知识，并且会尽我所能在我们进行的过程中解释底层概念。</p><h1 id="7f1f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">高级概述</h1><p id="81b3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该项目将构建为Node.js应用程序。我们将使用Express.js作为我们的框架。对于我们的数据库组件，我们将使用MongoDB和Mongoose对象建模。最后，我们将使用Pug.js作为我们的前端模板引擎。</p><p id="38ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在直接进入代码之前，让我们暂停一下，解释一下我们为什么选择这些特定的技术，以及它们是如何协同工作的。</p><p id="f290" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，我们的web应用程序将由三个组件组成:客户端、服务器端和数据库。</p><p id="30bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">客户端是我们应用程序的前端；用户与其交互并在浏览器中看到的一面。</p><p id="ef80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">服务器端是应用程序的后端；处理用户请求并为用户提供页面的一面。服务器端还与数据库来回通信，以确保信息指向正确的位置。</p><p id="a13d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，数据库存储应用程序的所有数据。这使得数据变得永久或“持久”,甚至在我们关闭浏览器中的应用程序之后。</p><p id="1275" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解web应用程序的这三个组件如何协同工作远比理解我们将用来实现这些组件的特定技术重要得多。</p><p id="a62f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要明确的是，Node.js、Express.js和我们将使用的其他花哨技术只是流行的、已经构建好的工具，我们可以利用它们来帮助我们构建web应用程序的组件。如果我们真的想的话，我们可以使用几十种其他技术来达到同样的目的。例如，如果我们愿意，我们可以使用React代替Pug作为我们的前端。或者，我们可以使用不同的框架，如Vue.js，而不是Express.js。</p><p id="7aeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关键在于，每种技术都只是实现我们的web应用程序的三个主要组件的不同方面的一种特定方法。在阅读教程的过程中，更多地关注底层概念，而不是实现细节。如果你真的理解我们在做什么，在本教程结束时，你应该能够更容易地掌握其他框架和技术。</p><p id="38a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住，任何人都可以复制代码，但是理解你为什么做你正在做的事情总是更重要。</p><p id="1345" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住这一点，下面是构建我们的web应用程序的步骤。如果你需要的话，可以随意在不同的步骤之间跳来跳去或者暂停一下，以便更详细地理解事情。在每一步，我都将包含更多资源的链接，这样您就可以在继续下一步之前完全理解这些内容。</p><h1 id="383d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">目录</h1><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="9c53" class="mx lw it mt b gy my mz l na nb">1. Plan out the Project<br/>2. Initialize the Project and Install Dependencies<br/>3. Set Up Folder Structure<br/>4. Build the Server<br/>5. Connect the Database<br/>6. Build the Models<br/>7. Define the Routes<br/>8. Build the Controllers<br/>9. Build the UI<br/>10. Putting It All Together</span></pre><h1 id="e87b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">规划项目</strong></h1><p id="b77a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们的目标是建立一个简单的小web应用程序，跟踪我们还剩多少学分可以毕业。</p><p id="c3b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用程序会让我们一个接一个地进入课堂。然后，它会显示一个所有已报名课程的列表，以及还剩多少课程和多少学分的记录。</p><p id="1d18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，该应用程序将让我们在完成课程后从列表中删除它们。删除功能将自动更新我们剩余的课程和学分。</p><p id="340a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">真的是这样。没有花哨的功能或铃声和口哨。只是一个简单的添加功能，删除功能，以及更新类和学分的计数。</p><p id="0dfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们的应用程序非常小，所以我们计划将它构建为只有一个页面的服务器呈现的应用程序。</p><h1 id="81df" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">初始化项目并安装依赖项</h1><p id="cb54" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">第一步是确保您的计算机上安装了Node.js。Node.js的下载方式有很多种，参考一下Node.js网站的下载页面<a class="ae ky" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="fdd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦下载了Node.js或者您的计算机上已经有了它，您可以在终端中使用以下命令来检查您的版本是否正确:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2bd7" class="mx lw it mt b gy my mz l na nb">node -v</span></pre><p id="550c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本教程，我使用的是Node.js版本10.13.0，这是一个旧版本。</p><p id="b96c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Node.js自带名为npm的包管理器，帮助您向项目添加依赖项并保持更新。</p><p id="3dad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用类似的命令检查您安装了哪个版本的npm:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2e65" class="mx lw it mt b gy my mz l na nb">npm -v</span></pre><p id="b4f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的是7.16.0版本，这也是一个旧版本。</p><p id="3899" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将使用npm向项目添加依赖项，并初始化Node.js项目。如果你不明白如何使用npm，查看他们的文档<a class="ae ky" href="https://docs.npmjs.com/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="87bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，Node.js是我们应用程序的运行时。如果您不熟悉Node.js或运行时的概念，可以在这里查看他们的文档<a class="ae ky" href="https://nodejs.org/en/about/" rel="noopener ugc nofollow" target="_blank"/>。在这里<a class="ae ky" href="https://medium.com/free-code-camp/what-exactly-is-node-js-ae36e97449f5" rel="noopener">还发表了一篇很棒的文章</a>，我发现这篇文章特别有帮助。</p><p id="eeef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要启动我们的项目，请导航到您想要存放项目的文件夹并运行命令</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="20fc" class="mx lw it mt b gy my mz l na nb">npm init</span></pre><p id="2ac0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将为您的项目初始化一个<code class="fe nc nd ne mt b">package.json</code>文件。本质上，package.json文件告诉我们关于项目的所有重要信息，包括依赖项、版本号和作者信息。</p><p id="cdee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于<code class="fe nc nd ne mt b">package.json</code>文件的信息，请看文档<a class="ae ky" href="https://docs.npmjs.com/cli/v7/configuring-npm/package-json" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="ab85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要安装我们的框架和依赖项。</p><p id="6e5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装Express.js，请使用以下命令:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="e3db" class="mx lw it mt b gy my mz l na nb">npm install express --save</span></pre><p id="f1b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该命令提示节点包管理器在我们的项目文件夹中安装Express.js，并将其保存在我们的package.json文件的依赖项列表中。</p><p id="7f23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个项目，我们将只使用另外五个依赖项。每个都以相同的方式安装。</p><p id="29f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装MongoDB，我们将在数据库中使用它:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8fd4" class="mx lw it mt b gy my mz l na nb">npm install mongodb --save</span></pre><p id="518f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装Mongoose，我们将使用它来创建我们的对象模型:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="4b13" class="mx lw it mt b gy my mz l na nb">npm install mongoose --save</span></pre><p id="0dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装Pug，我们将使用它作为我们的前端:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="89f0" class="mx lw it mt b gy my mz l na nb">npm install pug --save</span></pre><p id="dcea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装body-parser，这是一个中间件，我们将使用它来解析HTTP请求:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c387" class="mx lw it mt b gy my mz l na nb">npm install body-parser --save</span></pre><p id="5874" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，安装<code class="fe nc nd ne mt b">async</code>，它是一个帮助我们使用异步JavaScript的模块:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d1f7" class="mx lw it mt b gy my mz l na nb">npm install async --save</span></pre><p id="d742" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅此而已。我们的<code class="fe nc nd ne mt b">package.json</code>文件现在已经设置好了，我们的依赖项也安装好了。</p><p id="2245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候开始构建项目了。</p><h1 id="da8a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置文件夹结构</h1><p id="3c73" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将把我们的项目分成六个基本文件夹。当我们用<code class="fe nc nd ne mt b">npm init</code>命令初始化我们的项目时，Node.js会自动创建一个<code class="fe nc nd ne mt b">/node_modules</code>文件夹和<code class="fe nc nd ne mt b">package.json</code>文件，所以我们不必担心设置它们。</p><p id="5165" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他五个文件夹，我们将自己创建。我们将在整个教程中引用每个文件夹。现在，你的文件夹结构应该是这样的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">开始文件夹结构</p></figure><h1 id="2011" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">构建服务器</h1><p id="3d33" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们的第一步将是设置我们的服务器。</p><p id="dbc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们首先在项目的根目录下创建一个名为<code class="fe nc nd ne mt b">app.js</code>的文件。<code class="fe nc nd ne mt b">app.js</code>文件将存放我们所有的服务器端代码，并作为整个项目的主文件。</p><p id="abbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nc nd ne mt b">app.js</code>中，我们将使用<code class="fe nc nd ne mt b">require()</code>函数将Express.js挂接到我们的应用程序中。然后，我们将创建一个名为<code class="fe nc nd ne mt b">app</code>的Express.js实例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="00a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用该应用程序启动我们的服务器，并在端口3000上监听连接:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="958c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们应该能够通过在终端中调用以下命令来设置我们的服务器运行:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="1dc0" class="mx lw it mt b gy my mz l na nb">node app.js</span></pre><p id="73f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们设置正确，您的终端应该会显示:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a5d6" class="mx lw it mt b gy my mz l na nb">Running on localhost: 3000</span></pre><h1 id="fea2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">连接数据库</h1><p id="01cb" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下一步是将MongoDB数据库连接到项目。</p><p id="d81f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这样做之前，请确保您的计算机上安装了MongoDB。</p><p id="bc66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用以下命令检查您安装了哪个版本的MongoDB:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d89e" class="mx lw it mt b gy my mz l na nb">mongod --v</span></pre><p id="70a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本教程，我有MongoDB版本4.4.0。如果您还没有安装MongoDB，您可以使用homebrew通过命令来安装它</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="4905" class="mx lw it mt b gy my mz l na nb">brew tap mongodb/brew<br/>brew install mongodb-community@5.0</span></pre><p id="950b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于这两个命令的更详细的解释，或者如果你还没有安装homebrew，请随意查看MongoDB的文档<a class="ae ky" href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="ff45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦安装了MongoDB，我们可以用几种不同的方法来建立数据库连接。对于这个项目，我们将通过Mongoose进行本地连接。</p><p id="c75f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将在我们的<code class="fe nc nd ne mt b">app.js</code>文件中添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，我们正在导入mongoose包。然后，我们使用mongoose打开一个到MongoDB服务器的连接，该服务器运行在本地端口27017，并使用一个名为<code class="fe nc nd ne mt b">credits-tracker</code>的数据库。</p><p id="c436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们成功连接到我们的本地数据库时，控制台将输出一条消息说“使用mongoose成功连接到MongoDB！”</p><p id="5dae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于这一切是如何工作的，我们可以在这里了解更多，但是现在，我们已经成功地连接到我们的数据库，并可以开始在那里存储持久数据。</p><h1 id="58a3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">建立模型</h1><p id="c4b5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦我们连接了数据库，我们将需要建立一些模型。</p><p id="3658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需要为我们的项目建立一个模型:信用模型。</p><p id="75ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于不熟悉对象建模概念的人来说，Mongoose是一个对象文档映射器(ODM ),它帮助我们将JavaScript代码中的类和对象映射到存储在MongoDB数据库中的文档。模型帮助我们定义什么类型的数据将存储在我们的数据中，以及我们计划如何组织它。</p><p id="a8c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们还可以在这里了解更多内容，但是现在，我们就到此为止。如果你想了解更多关于Mongoose的内容，请点击这里查看他们的文档<a class="ae ky" href="https://mongoosejs.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="a21b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在<code class="fe nc nd ne mt b">/models</code>文件夹中创建一个名为<code class="fe nc nd ne mt b">credit-model.js</code>的文件。文件中的代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="86bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个模型能得到的最简单的东西。</p><p id="d072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用命令<code class="fe nc nd ne mt b">Mongoose.Schema</code>我们定义一个信用模型。我们的模型只有三个属性:<code class="fe nc nd ne mt b">name</code>、<code class="fe nc nd ne mt b">credits</code>和<code class="fe nc nd ne mt b">classId</code>。对于每个属性，我们还指定每个属性必须存储什么类型的数据。Name和<code class="fe nc nd ne mt b">classId</code>都接受一个<code class="fe nc nd ne mt b">String</code>数据类型，而<code class="fe nc nd ne mt b">credits</code>接受一个<code class="fe nc nd ne mt b">Number</code>数据类型。</p><p id="1cca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个猫鼬模型帮助我们组织和概念化我们的数据。</p><h1 id="4f5d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">定义路线</h1><p id="48ab" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">接下来，连接数据库并定义模型后，让我们定义所需的路线。</p><p id="f4de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在学习本教程时对路由的概念不熟悉，那么我们在这里所做的基本上就是定义哪个函数将处理我们项目的哪个方面。当用户搜索或导航到一个特定的URL时，我们的路由器将决定哪个函数将处理对该特定URL的请求。</p><p id="4602" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个项目，我们只需要三个路径:对<code class="fe nc nd ne mt b">/</code>的GET请求(显示我们的主页)，对<code class="fe nc nd ne mt b">/submit</code>的POST请求(处理我们的添加新类表单)，对<code class="fe nc nd ne mt b">/delete</code>的POST请求(处理我们的删除类功能)。</p><p id="f234" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这三条路线将处理我们的web应用程序的所有用户交互。我们将在一个名为<code class="fe nc nd ne mt b">routes.js</code>的文件中定义所有三条路线，该文件位于我们的<code class="fe nc nd ne mt b">/routes</code>文件夹中。该文件将包含以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="293d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们所需要做的，以确保HTTP请求被正确的函数处理。该文件只是告诉服务器，当任何人向<code class="fe nc nd ne mt b">/ </code>提交GET请求时，调用<code class="fe nc nd ne mt b">display_credits</code>函数。同样，相同的模式处理对<code class="fe nc nd ne mt b">/add</code>和<code class="fe nc nd ne mt b">/delete</code>的POST请求</p><p id="e6e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，如果您运行这段代码，您将会得到一个错误。这是因为我们实际上还没有定义这些函数来处理HTTP请求。</p><p id="90cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在就来建造它们。</p><h1 id="bf9a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">构建控制器</h1><p id="ea01" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了让我们的路径工作，我们现在将在名为<code class="fe nc nd ne mt b">credit-controller.js</code>的控制器文件中构建我们的控制器函数，该文件位于<code class="fe nc nd ne mt b">/controllers</code>文件夹中。</p><p id="dcde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">控制器本质上只是处理对特定url的HTTP请求的功能。就像我们之前讨论的，路由定义了哪个控制器应该处理哪个请求。然后，控制器自己完成剩下的工作。</p><p id="c89e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个项目，我们需要三个控制器。一个显示我们所有的学分，一个添加新的学分，一个删除学分。</p><p id="a4d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，控制器显示所有的学分。这个控制器所要做的就是在数据库中查询所有现有的信用。使用<code class="fe nc nd ne mt b">Model.find()</code>命令，Mongoose可以非常容易地实现这一点。<code class="fe nc nd ne mt b">Model.find()</code>是Mongoose提供的几个函数之一，它让我们根据各种参数在数据库中搜索特定的项目。</p><p id="41eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些函数都返回一个查询对象，该对象应该包含我们以iterable形式请求的所有项目。你可以在这里找到Mongoose提供的查询方法<a class="ae ky" href="https://mongoosejs.com/docs/queries.html" rel="noopener ugc nofollow" target="_blank">的完整列表。</a></p><p id="e916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是现在，知道<code class="fe nc nd ne mt b">Model.find()</code>方法返回数据库中匹配任何输入参数的所有文档就足够了。请注意，如果我们不输入任何参数，如下例所示，我们只是得到数据库中所有文档的列表。下面是我们项目的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="b7b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将构建控制器来添加新的信用。同样，Mongoose也很容易做到这一点。我们需要做的就是创建一个新的信用对象，它有三个属性:名称、信用数量和<code class="fe nc nd ne mt b">classId</code>。然后，我们将新创建的对象保存到数据库中。我们是这样做的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="beaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，要删除一个信用，我们需要一个控制器，根据它的id查找指定的信用。为了寻找这一点，我们将使用猫鼬函数<code class="fe nc nd ne mt b">Model.findById()</code>。该函数的操作类似于<code class="fe nc nd ne mt b">Model.find()</code>函数，查找任何与提供的id匹配的文档。然后，一旦我们有了信用，我们简单地从数据库中删除它。这方面的代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8208" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该注意，从数据库中删除文档实际上有几种不同的方法，包括方法<code class="fe nc nd ne mt b">Model.findByIdAndDelete()</code>。这种方式在减少我们必须自己编写的代码量方面实际上会更有效一点，但是，最终，您应该只使用对您来说最有意义的方法。</p><h1 id="26af" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">构建用户界面</h1><p id="881e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">接下来，让我们构建向用户显示数据的UI。这个项目的用户界面将非常简单。</p><p id="f3d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它只会做几件事。它所能做的就是显示一个添加课程的表格，显示剩余课程和剩余学分的总数，并在底部显示输入课程的列表。</p><p id="2b42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有很多方法可以扩展这个UI，但是对于本教程，我们将尽可能保持简单。</p><p id="05cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的UI将只包含四个pug文件、一个简单的样式表和一个来自font-awesome的图标。正如我们提到的，<code class="fe nc nd ne mt b">pug</code>是一个用于渲染我们UI的模板引擎。如果你不熟悉模板引擎或pug的概念，请随意查看pug的文档<a class="ae ky" href="https://pugjs.org/api/getting-started.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="fc58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于这里的目的，我们将注意到在我们的项目中使用模板引擎的主要优点是能够在包含HTML标记的同一个文件中直接进行一些JavaScript计算。虽然这对我们来说很方便，但是我们的项目非常简单，如果我们想的话，我们可以用普通的HTML编写我们的UI。</p><p id="3396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的是要注意到这一点，只是为了指出，如果/当它对您的项目来说太大时，有时您不需要使用花哨的第三方库。遵循一般良好的编程实践，尽可能保持简单通常是个好主意。</p><p id="0564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到这里，我们将继续使用<code class="fe nc nd ne mt b">pug</code>，如果只是作为使用这个模板引擎的一个练习。</p><p id="9f90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们UI的主文件将是我们的<code class="fe nc nd ne mt b">index.pug</code>文件，我们将把它放在<code class="fe nc nd ne mt b">/views</code>文件夹中。我们还将创建一个名为<code class="fe nc nd ne mt b">style.css</code>的样式表，放在<code class="fe nc nd ne mt b">/public/css</code>文件夹中。整个<code class="fe nc nd ne mt b">index.pug</code>文件将如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="52e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果上面的代码没有完全显示在介质上，可以在这里找到整个<code class="fe nc nd ne mt b">index.pug</code>文件。<code class="fe nc nd ne mt b">index.pug</code>文件大多比较简单。该文件主要由标题、输入学分的表格、段落描述以及显示学分总计和学分列表的主要部分组成。HTML文件的头还包含一个到我们的样式表<code class="fe nc nd ne mt b">style.css</code>的链接和一个到字体很棒的文件的链接。</p><p id="5e22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您熟悉HTML的基础知识，pug文件很容易翻译。主要要注意的是以<code class="fe nc nd ne mt b">include</code>开头的行。这些语句允许我们将其他pug文件的内容插入到代码中。</p><p id="7c73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个包含的文件是<code class="fe nc nd ne mt b">credit_totals.pug</code>文件。从代码中可以看出，这个文件和其他两个包含的文件将位于<code class="fe nc nd ne mt b">/views/credits</code>文件夹中。整个文件如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e3ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，<code class="fe nc nd ne mt b">credit_display.pug </code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e7e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后是<code class="fe nc nd ne mt b">delete_credit.pug</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7eb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意这里的<code class="fe nc nd ne mt b">delete_credit.pug</code>文件包含一个带有隐藏输入和按钮的表单。表单所做的就是在每次点击按钮时向<code class="fe nc nd ne mt b">/delete</code>端点发送一个删除HTTP请求。然后，删除请求将由我们前面讨论过的控制器来处理。</p><p id="7a4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，连同我们的pug模板文件，我们将创建一个简单的<code class="fe nc nd ne mt b">style.css</code>文件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="98c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为本教程的主要焦点是构建Node.js应用程序，所以我们不会详细讨论样式表。如果你愿意，你可以简单地复制或粘贴。</p><p id="7296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了样式表，我们还需要下载font-awesome库的本地副本，并将其插入到我们的<code class="fe nc nd ne mt b">/fonts</code>文件夹中。要下载font-awesome的本地版本，只需进入他们的下载页面<a class="ae ky" href="https://fontawesome.com/download" rel="noopener ugc nofollow" target="_blank">这里</a>并选择一个桌面下载选项。同样，我们在这里不会涉及太多的细节。只要确保你在你的<code class="fe nc nd ne mt b">index.pug </code>文件中提供了一个到<code class="fe nc nd ne mt b">font-awesome.min.css</code>文件的正确链接。</p><p id="f62d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，有了这四个pug文件和几个css文件，我们的整个UI就应该构建好了。</p><h1 id="67ea" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">把所有的放在一起</h1><p id="b75c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们已经有了一个UI和所有正确的功能，我们的web应用程序就完成了！</p><p id="65b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在有一个简单的应用程序，让我们进入我们的大学课堂，并吐出我们还剩多少课和学分的记录。</p><p id="9f7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是最终的文件夹结构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="fd21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是最终项目本身的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/bb042d8f9f5d42be98521eb82432568e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAaKQfBa6_Hpih5_g506Ww.png"/></div></div></figure><p id="80bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。你可以在这里找到完整的源代码。如果你对更多像这样的教程感兴趣，可以看看我写的其他东西:</p><div class="ni nj gp gr nk nl"><a rel="noopener  ugc nofollow" target="_blank" href="/build-an-article-reader-web-app-using-free-apis-and-javascript-ce1100d43a21"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">使用免费的API和JavaScript构建一个文章阅读器Web应用程序</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">下面是我如何在一个下午构建一个web应用程序</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">better编程. pub</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div></div></div>    
</body>
</html>