# 是什么让你的代码有味道？

> 原文：<https://betterprogramming.pub/what-is-it-that-makes-your-code-smell-f9c96ac93ba2>

## 列出了八种代码气味，所以你可以避开它们

![](img/ddb3a7b90e670c38190cd51c721b164d.png)

塔德乌什·拉科塔在 [Unsplash](https://unsplash.com/s/photos/code-smell?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

可能你见过的大多数代码都有点味道。最坏的情况是，它真的很臭。很可能你自己也引入了一些代码味道。但是什么是代码气味呢？

代码气味是一种表面迹象，表明您的系统和代码质量可能存在问题。大多数时候，代码味道需要某种重构来修复。尽管有臭味的代码可以工作，但这表明代码质量很差。

在这篇文章中，我们将讨论八种常见的代码气味，这样你就可以避免它们。

> “最好的气味是容易被发现的，而且大多数时候会引导你找到真正有趣的问题。”——马丁·福勒

# 1.猎枪手术

你有没有遇到过这样的情况，某个类中的一个小变化导致你不得不改变许多不同的类？好吧，那就鸟枪手术吧。

就我个人而言，猎枪手术是我“最喜欢”的代码味道之一。我见过很多开发人员在他们的代码中引入了这种代码味道。猎枪手术不可避免地导致大量重复代码。因此，对这种风格的关注在很大程度上与对任何代码重复的关注是一样的。

在许多地方复制相同的逻辑会大大增加以后修改相同逻辑的成本。这将导致开发时间增加。由于代码库变得越来越不可维护，小功能将需要更多的时间来开发。

# 2.古怪的解决方案

一个古怪的解决方案是当一个问题在整个系统中以一种方式解决，而同样的问题在同一个系统中以另一种方式解决。

这些解决方案之一是古怪的，或不一致的解决方案。这种气味的存在通常表明代码有细微的重复。

为了摆脱古怪的解决方案，你应该从确定你喜欢的解决方案开始。在某些情况下，如果最少使用的解决方案优于最常用的解决方案，那么它可能是您的首选解决方案。

在确定了您的首选解决方案之后，您可以开始从代码中删除这个古怪的解决方案，并用首选的解决方案来替换它。

一旦您在整个代码库中实现了一致的首选解决方案，您就可以将该解决方案的所有实例移动到一个地方，从而消除重复。

# 3.把显而易见的事情复杂化

我们都见过为了好玩而引入设计模式的代码。尤其是初级开发者更倾向于这样做。这是他们炫耀的方式，让其他开发人员知道他们编码有多好。他们不知道，这降低了代码的质量。

但是什么时候我们可以说某人把事情过度复杂化了呢？一个很好的经验法则是当你编写代码来解决你没有的问题时。

最糟糕的过度复杂通常是以让代码经得起未来考验的名义犯下的——结果恰恰相反。

# 4.参数太多

Robert C. Martin 在他的书[*Clean Code:A Handbook of Agile Software crafts*](https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship-ebook/dp/B001GSTOAM)中对参数做了如下描述:

*“一个函数的理想自变量个数是零(尼拉迪奇)。接下来是一个(一元)，紧接着是两个(二元)。应尽可能避免三个参数(三元组)。三个以上(多角形)需要非常特殊的理由——无论如何都不应该使用。*

我认为这总结得很好。尽可能少用参数。

如果您发现自己将从另一个对象接收的一组数据作为参数传递，您应该考虑将对象本身传递给方法。

一旦您减少了方法中使用的参数数量，您将获得更易读、更短的代码。

# 5.长方法

我们都见过占用一百多行代码的方法。对这段代码质量的所有信心早已不复存在。

引入这种代码味道的原因很简单。大多数时候，代码被添加到一个方法中，但是什么都没有被取出。由于编写代码比阅读代码更容易，所以这种代码味道不会被注意到，直到方法变得丑陋和过大。

长方法往往有不止一个责任。遵循单一责任模式被认为是最佳实践。这意味着一个方法只能做一件事，而且只能做一件事。

# 6.不一致的命名

为了确保代码的可读性并保持代码的可维护性，代码中的命名必须正确。

不久前，我写了一篇关于一些简单规则的文章，你可以遵循这些规则在你的代码中创建有意义的名字。我再怎么强调好的变量名的重要性也不为过。选择好的名字需要时间，但节省的时间比花费的时间多。

命名的问题是，当你在发展的时候，你在做命名的决定，但是那是那些决定最没有影响力的时候。

一切都历历在目。你知道要构建什么，你知道架构和你正在编码的任何奇怪的特性是有意义的。

然而，每当项目交付时，它就进入维护阶段。这是迄今为止最长的阶段，这也是命名事物变得重要的地方。

有很多不同的方式可以用来命名，每种方式都有其优点和缺点。最重要的是，这些约定需要得到认同，你应该坚持下去。

# 7.数据块

有时，您会发现一小组参数在代码库的不同部分之间不断传递。这些不同的值被称为数据块。

如果多个方法调用采用相同的参数集，这可能是这些参数相关的标志。要将一组参数放在一起，将它们组合到一个新对象中会很有用。这将改善你的代码库的组织。

拥有一个数据块不一定是一个问题，但它可能是一个更深层次问题的指示器。

# 8.中间人

有时你有一个类，它有很多方法，这些方法除了委托给不同类中的另一个方法之外什么也不做。在这种情况下，委托的类被认为是中间人类。

在一些用例中，拥有一个中间人类被认为是有帮助的。例如，当建造一个门面时。但大多数时候摆脱中间人阶层会更好。

为了消除这种代码味道，您应该尝试直接与实现该行为的类通信，而不是通过中间人。