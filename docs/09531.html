<html>
<head>
<title>What I Learned by Switching to a Poorly-Structured Codebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过切换到一个结构不良的代码库，我学到了什么</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-i-learned-by-switching-to-a-poorly-structured-codebase-80cd690e8ef4?source=collection_archive---------8-----------------------#2021-09-06">https://betterprogramming.pub/what-i-learned-by-switching-to-a-poorly-structured-codebase-80cd690e8ef4?source=collection_archive---------8-----------------------#2021-09-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="63d8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及我希望所有开发人员遵循的东西</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/86125f99ba0ea259b858efb1d69e361d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGWJc0md3Ulapfp40XGyJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.freepik.com/" rel="noopener ugc nofollow" target="_blank"> Freepik </a></p></figure><p id="6915" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也讨厌写得不好的代码吗？嗯，我真的想。我和许多初级和高级开发人员一起工作过，他们只是写代码来完成工作。他们对编写干净、可读、结构合理的代码没有任何热情。</p><p id="b091" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你为一个组织编写代码时，写得好的代码变得更加重要。如果你在一个项目中工作，后来因为某种原因离开了组织，那么你写的糟糕的代码对于后来加入这个项目的开发人员来说可能会成为一件痛苦的事情。</p><p id="04bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我目前也在经历类似的情况。该组织要求我接管一个正在进行的项目，这让我很难理解代码库，因为它的结构很差。该项目的业务逻辑对我来说显然是新的，需要一些时间来清理，但难以消化的代码使它成为一个艰巨的旅程。</p><p id="19c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我从一个结构不良的项目中学到的一些东西，前一个团队可以遵循的东西，以及我真正希望开发人员在编写代码时遵循的东西。</p><h1 id="390e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">文件命名约定</h1><p id="44f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">遵循命名文件的约定是正确设置项目的一个重要方面。开发人员应该使用单一的约定来命名代码库的所有文件。</p><p id="71cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对一些文件使用骆驼箱，对其他文件使用烤肉串箱并不是一个好主意。选择一个你想用的案例并坚持下去。</p><p id="2cfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在构建一个React应用程序，那么你应该对你的组件使用Pascal Case，对其他文件使用Camel Case或Kebab case。如果你正在开发一个NodeJS应用程序，你可能应该使用Kebab案例。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="43d0" class="mx lw it mt b gy my mz l na nb">Pascal Case: HiThere<br/>Camel Case:  hiThere<br/>Kebab Case:  hi-there</span></pre><p id="9cbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论您选择什么，请确保在整个应用程序中使用相同的约定。遵循这种方法实际上会使代码库看起来更干净。</p><h1 id="a0eb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">文件夹结构</h1><p id="08b2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您遵循了正确的文件命名约定，现在呢？将文件放在正确的位置也是必需的。</p><p id="e4ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把太多的文件放在一个文件夹里是非常不好的，用两个文件夹来分开两个文件也不好。我刚刚接手的项目的一个子项目在一个文件夹中有60多个文件(React组件)。项目所需的几乎90%的组件都放在一个文件夹中。</p><p id="c123" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它不是一个好方法的原因之一是它使得项目更难维护，并且对于项目新手来说很难理解正在发生什么。如果我想快速找到一个组件，我必须滚动浏览60个文件。我可以使用IDE的快捷方式，但还是不太容易。</p><p id="7fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要把太多的文件放在一个文件夹里，试着把它们分成属于同一类别的子文件夹。例如，与客户相关的组件可以位于一个子文件夹中。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c558" class="mx lw it mt b gy my mz l na nb">src<br/>└── components<br/>     └── customers<br/>           ─ customer related components<br/>     └── orders<br/>           ─ order related components<br/>     └── reports<br/>           ─ reports related components</span></pre><p id="e44a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当您需要更新代码库中与客户相关的内容时，您知道在哪里可以找到您的组件。</p><h1 id="0c6e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">写评论</h1><p id="b50d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">确保你创建的所有东西的功能都有很好的文档记录。注释是描述代码功能的最佳方式之一。如果我必须为项目更新/添加一个特性，我需要阅读编写的每一行代码来理解逻辑，因为没有编写注释。</p><blockquote class="nc nd ne"><p id="576a" class="kz la nf lb b lc ld ju le lf lg jx lh ng lj lk ll nh ln lo lp ni lr ls lt lu im bi translated">代码被读的次数比它被写的次数多</p></blockquote><p id="6fd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，编写注释不仅会使代码维护更容易，而且还会帮助您更快地发现错误，并记住良好记录的代码与正确工作的代码同样重要。</p><h1 id="7ce7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">换行符和缩进</h1><p id="9cdd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">没有人喜欢阅读或理解一些胡言乱语。格式化代码使它更容易被人类阅读。您必须使用适当的:</p><ul class=""><li id="75b3" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">行距</li><li id="5bfa" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">缩排</li><li id="a514" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">运算符周围的间距</li></ul><p id="9672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是编写可读的干净代码的关键原则。对应用程序中的所有文件使用固定的标签大小(通常是两个)。理解格式不良的代码比理解格式正确的代码要困难得多。</p><p id="5bfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个格式不佳的代码示例；它可能不是很难阅读，因为它只包含了5行，但是如果它是一个包含大量函数的2000行文件，那就很难了。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="86bf" class="mx lw it mt b gy my mz l na nb">// poorly formatted code, harder to read<br/>function foo(){</span><span id="99e3" class="mx lw it mt b gy nx mz l na nb">const a=1;<br/>const b=1;<br/>const c=a*b*100/2;<br/>return c;</span><span id="bdc9" class="mx lw it mt b gy nx mz l na nb">}<br/>foo(); // returns 50</span></pre><p id="7809" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于糟糕的代码格式让我很难理解其中的逻辑，我使用了<a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">更漂亮的CLI </a>一次性格式化项目的所有文件，包括JavaScript、SASS、JSON、Markdown、YAML和CSS文件。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b6cb" class="mx lw it mt b gy my mz l na nb">// well-formatted, easier to understand<br/>function foo(){<br/>  const a = 1;<br/>  const b = 1;<br/>  const c = (a * b * 100) / 2;<br/>  <br/>  return c;<br/>}</span><span id="0f72" class="mx lw it mt b gy nx mz l na nb">foo(); // returns 50</span></pre><p id="197b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，如果一行中的内容占用了太多空间，可以考虑添加换行符以提高可读性。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a729" class="mx lw it mt b gy my mz l na nb">foo(longOne, anotherLongOne, longer, longerAmongAllOfThem, oneMore);</span><span id="baed" class="mx lw it mt b gy nx mz l na nb">// add line breaks<br/>foo(<br/>  longOne,<br/>  anotherLongOne,<br/>  longer,<br/>  longerAmongAllOfThem,<br/>  oneMore<br/>);</span></pre><p id="055d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，手动进行这种格式化不是很有效。所以，你应该在你的IDE中使用像<a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">这样的代码格式化程序。当开发人员不能使用更漂亮的代码时，如果他们自己不能编写干净和适当缩进的代码，这真的让我很生气。</a></p><h1 id="6252" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">冗长的组件</h1><p id="e387" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">困扰我做这个项目的原因之一是冗长的代码文件(基本上是React组件)。有的是2000+线。有这么多行的组件必须分成几个组件。</p><p id="4a7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在单个文件中编写太多代码会导致以下问题:</p><ul class=""><li id="4296" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">使得逻辑更难理解</li><li id="e617" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">在不同的作用域中使用相同的变量名会产生歧义</li><li id="113e" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">增加了复杂性，使调试更加困难</li></ul><p id="e289" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，你写的每个单元(一个类，一个函数)应该只关注一件事。尽量保持你的单位小。</p><h1 id="8706" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">我们的动力</h1><p id="7933" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">此外，每种编程语言都有风格指南。坚持一个方针，并保持一致。为变量命名时，避免歧义，使用能清楚表达变量或函数的名称。</p><p id="1f17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都是小事情，在你写代码的时候不需要太多的努力，但是这些小事情显著地提高了理解代码库的能力，并且使代码库结构良好，更加整洁。</p><p id="5049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果之前在这个项目中工作的团队遵循了这些指导方针，我会更容易顺利快速地接管这个项目。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="7761" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经分享了我在一个结构不良的项目中工作的故事。我必须做大量的重构工作，以便在保持相同功能的同时，使项目保持良好的状态。说得轻松一点，当你只是重构东西而不是构建新东西时，客户通常会抓狂。他们会说，“我没看到什么新东西，你在做什么？”</p><p id="3472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在没有编写干净代码的开发人员的世界里，成为那些热情地编写干净代码的人之一。在评论中等待你的体验。</p></div></div>    
</body>
</html>