<html>
<head>
<title>Actuarial Models on the GPU With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Python的GPU精算模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/actuarial-models-on-the-gpu-with-python-ff21c2d994aa?source=collection_archive---------10-----------------------#2022-08-08">https://betterprogramming.pub/actuarial-models-on-the-gpu-with-python-ff21c2d994aa?source=collection_archive---------10-----------------------#2022-08-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="52d8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速计算数百万份保单的保险数量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/7789a0f1849f0cdf005916aa48e8ec1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*4cNdvJcRVBn8CNmCtQiJZQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">经滨村文人许可使用的图表</p></figure><h1 id="5d9a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">问题陈述</h1><p id="7549" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">对于一份在死亡年度结束时支付100，000美元的保险合同，什么是公平的年度支付额？如果支付的预期现值等于未来收益的预期现值，我们说支付是公平的。</p><h1 id="c907" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">必备领域知识</h1><p id="5798" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果上一节中的粗体语句有意义，请跳过这一节。否则，请从以下资源中了解内容:</p><ul class=""><li id="4fa3" class="mf mg iq ll b lm mh lp mi ls mj lw mk ma ml me mm mn mo mp bi translated"><a class="ae mq" href="https://www.investopedia.com/terms/p/presentvalue.asp" rel="noopener ugc nofollow" target="_blank">现值</a></li><li id="c183" class="mf mg iq ll b lm mr lp ms ls mt lw mu ma mv me mm mn mo mp bi translated"><a class="ae mq" href="https://openstax.org/books/statistics/pages/4-2-mean-or-expected-value-and-standard-deviation" rel="noopener ugc nofollow" target="_blank">期望值</a></li></ul><p id="6b64" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">现值和期望值是两个独立的概念，但它们在保险中经常一起出现，因为</p><ul class=""><li id="7c65" class="mf mg iq ll b lm mh lp mi ls mj lw mk ma ml me mm mn mo mp bi translated">死亡时间是一个随机变量(使用期望值来处理)</li><li id="7964" class="mf mg iq ll b lm mr lp ms ls mt lw mu ma mv me mm mn mo mp bi translated">现金流存在于未来(贴现未来现金流以获得现值)</li></ul><h2 id="8612" class="mz ks iq bd kt na nb dn kx nc nd dp lb ls ne nf ld lw ng nh lf ma ni nj lh nk bi translated">一些符号</h2><p id="2f12" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mq" href="https://www.casact.org/sites/default/files/database/proceed_proceed49_49123.pdf" rel="noopener ugc nofollow" target="_blank">国际精算符号</a>有死亡率和贴现因子等符号。相关符号如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/021cefc4e8a1bac57c92523ddacdf418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*kew6pswBsfWgL1Q0irCz2w.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">公式来自<a class="ae mq" href="https://www.overleaf.com/read/dzpcggvvmqqs" rel="noopener ugc nofollow" target="_blank">这个背页的文档</a></p></figure><p id="a7db" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">对于持续五年的<a class="ae mq" href="https://www.investopedia.com/terms/t/termlife.asp" rel="noopener ugc nofollow" target="_blank">定期寿险</a>合同，我们可以通过将投保人支付的保费的预期现值(左)与保险人支付的福利(右)相等来确定公允价格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/cfc45f2ef2efe5ecbcee254ef6f4eeed.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*ib4nWRFdtE6JpYH5c-VBJw.png"/></div></figure><p id="4cdf" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">求解磷产量—</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e6a667aa7ca0b7f165c06934c71f8c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*BeyJLVn1mHRWP6ROoQB_YA.png"/></div></figure><p id="8ad4" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">折扣系数不同，因为保费在年初支付，而索赔在年底支付。</p><h1 id="50ef" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">为什么用Python做精算建模？</h1><p id="4e27" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这不是关于Python语言本身，而是关于Python深度学习生态系统，它为我们提供了运行在GPU上的张量库。我们将使用谷歌的JAX。</p><p id="9aa3" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated"><a class="ae mq" href="https://jax.readthedocs.io/en/latest/notebooks/quickstart.html" rel="noopener ugc nofollow" target="_blank"> JAX快速入门</a>指出</p><blockquote class="no np nq"><p id="a02a" class="lj lk nr ll b lm mh jr lo lp mi ju lr ns mw lu lv nt mx ly lz nu my mc md me ij bi translated">JAX在CPU，GPU和TPU上是NumPy，在高性能机器学习研究方面有很大的自动差异化。</p></blockquote><p id="5a27" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">精算建模通常是令人尴尬的并行<a class="ae mq" href="https://en.wikipedia.org/wiki/Embarrassingly_parallel" rel="noopener ugc nofollow" target="_blank"/>，涉及许多我们可以并行的政策或经济情景。JAX提供了熟悉的NumPy API，同时允许GPU加速我们高度并行的精算工作负载。</p><p id="e909" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">足够的背景知识。我们开始吧！</p><h1 id="686a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">计算合同的公平价格</h1><h2 id="aa7b" class="mz ks iq bd kt na nb dn kx nc nd dp lb ls ne nf ld lw ng nh lf ma ni nj lh nk bi translated">加载死亡率表</h2><p id="779d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们需要死亡概率来进行计算。精算师协会(T4)维护着一个死亡率表(T6)的集合。我发布了一个名为<a class="ae mq" href="https://github.com/actuarialopensource/pymort" rel="noopener ugc nofollow" target="_blank"> pymort </a>的Python包，可以轻松地将这些表加载到张量格式中。</p><p id="7a06" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">下面的代码加载了十种不同风险的死亡率表集合，这就是为什么主要维度的大小为<code class="fe nv nw nx ny b">10</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">“选择”和“最终”的含义将在下一节讨论</p></figure><h2 id="ae0e" class="mz ks iq bd kt na nb dn kx nc nd dp lb ls ne nf ld lw ng nh lf ma ni nj lh nk bi translated">死亡率表中的比率查找</h2><p id="680f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">传统的精算模型是递归定义的，调用栈的每一层都代表一个新的时间步。相比之下，我们同时计算所有时间点。这允许在GPU上对时间维度进行并行化。</p><p id="52ff" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">被保险人必须接受<a class="ae mq" href="https://www.aigdirect.com/about-life/applying-for-life-insurance/what-is-medical-underwriting" rel="noopener ugc nofollow" target="_blank">医疗承保</a>，该承保针对那些身患绝症的人。这降低了最初的死亡率，也是为什么有一个降低死亡率的<code class="fe nv nw nx ny b">select</code>表过渡到<code class="fe nv nw nx ny b">ultimate</code>表，这是针对一般人群的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="d829" class="mz ks iq bd kt na nb dn kx nc nd dp lb ls ne nf ld lw ng nh lf ma ni nj lh nk bi translated">现金流量的预期现值</h2><p id="da05" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们创建一个张量来表示每个保单在每个时间步中索赔的期望现值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="b8da" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">上述张量可以用矩阵符号来描述</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4db0ae8de9773f4b540d51e8a2486d4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*gWI-uV8Wk6dF7sqMbzrHbA.png"/></div></figure><h2 id="ed6a" class="mz ks iq bd kt na nb dn kx nc nd dp lb ls ne nf ld lw ng nh lf ma ni nj lh nk bi translated">获得公平的价格</h2><p id="e42d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这是公式(再次)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e6a667aa7ca0b7f165c06934c71f8c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*BeyJLVn1mHRWP6ROoQB_YA.png"/></div></figure><p id="a75f" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">看到下面的代码解决了这个问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="f765" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">P.S .如果保险公司有费用的话这个保费不公平！这个模型是一个简化，但希望它是有指导意义的。</p><p id="fead" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mw lu lv lw mx ly lz ma my mc md me ij bi translated">非常感谢您花时间阅读这篇文章。我尽力让它值得你花时间。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt oj ny ok ol aw om bi"><span id="fc1e" class="mz ks iq ny b gy on oo l op oq">LinkedIn group for open source actuarial discussion — <a class="ae mq" href="https://www.linkedin.com/groups/13937070/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/groups/13937070/</a></span></pre></div></div>    
</body>
</html>