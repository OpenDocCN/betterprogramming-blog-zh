<html>
<head>
<title>How to Display the Modal Bottom Sheet Programmatically in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Flutter中以编程方式显示模态底板</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-display-the-modal-bottom-sheet-programmatically-in-flutter-d1fad5fdd462?source=collection_archive---------4-----------------------#2021-10-22">https://betterprogramming.pub/how-to-display-the-modal-bottom-sheet-programmatically-in-flutter-d1fad5fdd462?source=collection_archive---------4-----------------------#2021-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6d88" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">无需按下浮动动作按钮</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/739bad1a04e16b9fc397db685cd1c018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXGgLlwlPI4x_igLOlEJkg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@knaggit?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马尔扬·格拉博斯基</a>在<a class="ae ky" href="https://unsplash.com/s/photos/modal-on-phone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="04cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是从我的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-update-the-state-of-a-widget-from-another-widget-in-flutter-25922ca5dd78">上一篇文章</a>来到这里的，你会看到我启动了我的待办事项应用程序，并修复了当我的状态更新时无法用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://api.flutter.dev/flutter/material/showModalBottomSheet.html" rel="noopener ugc nofollow" target="_blank">showModalBottomSheet</a></code>方法更新<code class="fe lv lw lx ly b">NewToDo</code>的问题。</p><p id="3887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在问了一个关于<a class="ae ky" href="https://stackoverflow.com/questions/69471054/unable-to-reflect-updated-parent-state-in-showmodalbottomsheet" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>的问题后，我终于能够把我的<code class="fe lv lw lx ly b">NewToDo</code>小部件放到一个<code class="fe lv lw lx ly b">showModalBottomSheet</code>里了。这样,<code class="fe lv lw lx ly b">NewToDo</code>小部件将只在我点击<code class="fe lv lw lx ly b">FloatingActionButton</code>时可见，而不是一直可见。</p><p id="1389" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在实现这一点后不久，我注意到我的应用程序中的另一个问题。</p><p id="bd60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我选择一个<code class="fe lv lw lx ly b">ToDo</code>项目进行编辑时，我希望能够重用我的<code class="fe lv lw lx ly b">NewToDo</code>。我认为这是有意义的，因为同样的两个输入可以用来改变同样的两个状态值<code class="fe lv lw lx ly b">title</code>和<code class="fe lv lw lx ly b">content</code>。</p><p id="877f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/2161cef9e9a7d9ae353077c534fa4b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*DjK9RrEYHT0sBWcxMaCDHg.png"/></div></figure><p id="1884" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了在我的<code class="fe lv lw lx ly b">FloatingActionButton</code>小部件(绿色圆圈)的<code class="fe lv lw lx ly b">onPressed</code>方法内，我无法在任何地方执行<code class="fe lv lw lx ly b">showModalBottomSheet</code>(绿色箭头)。</p><p id="b063" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当我点击伴随每个<code class="fe lv lw lx ly b">ToDo</code>项目的编辑<code class="fe lv lw lx ly b">ElevatedButton</code>小部件(用红圈标出)时，我需要能够触发<code class="fe lv lw lx ly b">onPressed</code>方法。</p><p id="9a2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想我应该如何找到一种方法来模拟<code class="fe lv lw lx ly b">onPressed</code>事件，以便执行<code class="fe lv lw lx ly b">showModalBottomSheet</code>回调。</p><p id="50fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无法模拟<code class="fe lv lw lx ly b">onPressed</code>事件(并且很沮丧),我去<a class="ae ky" href="https://stackoverflow.com/questions/69486752/trigger-floatingactionbutton-onpressed-without-pressing-the-button" rel="noopener ugc nofollow" target="_blank">栈溢出</a>看看是否还有人知道如何实现我正在寻找的东西。</p><p id="961e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">过了一会儿，我得到了答案。我松了一口气…也谦卑了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/bcfcc906df739c9ec84ea861e37f29de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*65YfK2KIMnvWa3PuFbPu1Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如此简单…如此纯粹。</p></figure><p id="d54f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我接受了<a class="ae ky" href="https://stackoverflow.com/users/1647098/eimmer" rel="noopener ugc nofollow" target="_blank"> eimmer的</a>建议，没有把我的<code class="fe lv lw lx ly b">showModalBottomSheet</code>放在<code class="fe lv lw lx ly b">onPressed</code>方法中，而是把它分解成它自己的函数<code class="fe lv lw lx ly b">_renderShowModal</code>。见下文:</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="07f7" class="mf mg it ly b gy mh mi l mj mk">_renderShowModal(){<br/>  return showModalBottomSheet&lt;void&gt;(<br/>    context: context,<br/>    builder: (BuildContext context) {<br/>      return ValueListenableBuilder(<br/>        valueListenable: titleController,<br/>        builder: (context, _content, child) {<br/>          return NewToDo(titleController, contentController, _addTodo, _clear, _todo);<br/>        });<br/>    },<br/>  );<br/>}</span></pre><p id="23a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样做之后，我能够重写我的<code class="fe lv lw lx ly b">onPressed</code>方法。</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="1a00" class="mf mg it ly b gy mh mi l mj mk">onPressed: _renderShowModal,</span></pre><p id="ee08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然我们已经将<code class="fe lv lw lx ly b">showModalBottomSheet</code>放入单独的函数中，让我们看看它是否工作:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/8b633d438baae01a50964fac38d04530.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*N1RRbgyejRWFoIFjx-jnOA.gif"/></div></figure><p id="17a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">厉害！我们现在需要做的就是在我们的<code class="fe lv lw lx ly b">editTodo</code>函数的末尾调用同样的函数，当你点击编辑<code class="fe lv lw lx ly b">EelevatedButton</code>时，这个函数就会被调用。</p><pre class="kj kk kl km gt mb ly mc md aw me bi"><span id="a452" class="mf mg it ly b gy mh mi l mj mk">void _editTodo(ToDo todoitem){<br/>  setState(() {<br/>    _todo = todoitem;<br/>    content = todoitem.content;<br/>    title = todoitem.title;<br/>  });<br/>  contentController.text = todoitem.content;<br/>  titleController.text = todoitem.title;<br/>  <strong class="ly iu">_renderShowModal();</strong><br/>}</span></pre><p id="67d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看当我们点击我们的<code class="fe lv lw lx ly b">ToDo</code>项旁边的编辑时它是否工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/80b3a5421f992c76c2a2f3146e206ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*AXlrT-kewtWjTtKx8uTwDA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">维奥拉。</p></figure><p id="4837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就在那里！我们现在可以使用<code class="fe lv lw lx ly b">NewToDo</code>来创建新的<code class="fe lv lw lx ly b">ToDo</code>条目和编辑现有的条目。</p><p id="b02f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将我们的<code class="fe lv lw lx ly b">showModalBottomSheet</code>包装在一个单独的函数中，我们使得我们的应用程序能够在任何我们想要的时候简单地通过调用<code class="fe lv lw lx ly b">_renderShowModal</code>来呈现<code class="fe lv lw lx ly b">NewToDo</code>。</p><p id="2ae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个应用的所有代码都在<a class="ae ky" href="https://github.com/macro6461/flutter_to_do" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="643d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://matt-croak.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="mt">升级您的免费媒体会员资格</em> </strong> </a> <em class="mt">并接收各种出版物上数千名作家的无限量、无广告的故事。这是一个附属链接，你的会员资格的一部分帮助我为我创造的内容获得奖励。</em></p><p id="e58d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以通过电子邮件   <em class="mt">订阅，当我发布新内容时，你会收到通知！</em></p><p id="4214" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">谢谢！</em></p><h1 id="345b" class="mu mg it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">参考</h1><ol class=""><li id="8929" class="nl nm it lb b lc nn lf no li np lm nq lq nr lu ns nt nu nv bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/69471054/unable-to-reflect-updated-parent-state-in-showmodalbottomsheet" rel="noopener ugc nofollow" target="_blank">无法在showModalBottomSheet中反映更新的父状态</a></li><li id="aaca" class="nl nm it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/69486752/trigger-floatingactionbutton-onpressed-without-pressing-the-button" rel="noopener ugc nofollow" target="_blank">未按下按钮时触发浮动操作按钮</a></li><li id="ceef" class="nl nm it lb b lc nw lf nx li ny lm nz lq oa lu ns nt nu nv bi translated"><a class="ae ky" href="https://stackoverflow.com/users/1647098/eimmer" rel="noopener ugc nofollow" target="_blank">用户艾默</a></li></ol></div></div>    
</body>
</html>