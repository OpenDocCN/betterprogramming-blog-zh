<html>
<head>
<title>4 Ways To Write One-Liner For Loops in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python写一行循环的4种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-ways-to-write-one-liner-for-loops-in-python-e8c1db903ce2?source=collection_archive---------5-----------------------#2021-04-22">https://betterprogramming.pub/4-ways-to-write-one-liner-for-loops-in-python-e8c1db903ce2?source=collection_archive---------5-----------------------#2021-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5743" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用简洁的简写方式遍历列表、字典、集合和生成器，而不牺牲可读性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/390f17f54883aa774b146e7f20bdd5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCfU-mTXythQBTL_oaW0qQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="8db7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Python中，你可以通过使用<em class="ly">理解</em>把你的<code class="fe lu lv lw lx b">for</code>循环变成一行程序。</p><p id="3480" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python支持对主要序列类型的四种不同类型的理解:</p><ul class=""><li id="20e5" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated"><em class="ly">列出理解</em></li><li id="41d3" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">词典释义</em></li><li id="0fac" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">集合理解</em></li><li id="0231" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">发电机理解</em></li></ul><p id="dc4c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有的理解看起来都非常相似，而且简单易懂。事不宜迟，让我们看一些如何在Python中使用理解的例子。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="135e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">列出理解</h1><p id="9111" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">让我们从基于现有列表创建一个新的数字列表开始，去掉所有的负数。显然，您可以使用一个<code class="fe lu lv lw lx b">for</code>循环来解决这个任务:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="0791" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="c924" class="nx mv it lx b gy ny nz l oa ob">[4, 7, 19]</span></pre><p id="d65f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是你也可以通过使用列表理解使整个<code class="fe lu lv lw lx b">for</code>循环更短、更可读、更专业:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="9171" class="nx mv it lx b gy ny nz l oa ob">new_nums = [num <strong class="lx iu">for</strong> num <strong class="lx iu">in</strong> numbers <strong class="lx iu">if</strong> num &gt; 0]</span><span id="42f7" class="nx mv it lx b gy oc nz l oa ob"><strong class="lx iu">print</strong>(new_nums)</span></pre><p id="abc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="2964" class="nx mv it lx b gy ny nz l oa ob">[4, 7, 19]</span></pre><p id="7bb3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">恭喜你。您在不牺牲可读性的情况下保存了四行代码。</p><p id="e770" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总结一下，下面是<em class="ly">清单理解</em>的大致结构:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="c57d" class="nx mv it lx b gy ny nz l oa ob">output_list = [expression <strong class="lx iu">for</strong> var <strong class="lx iu">in</strong> input_list <strong class="lx iu">if</strong> condition]</span></pre><p id="439a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了清楚起见，<code class="fe lu lv lw lx b">if condition</code>是可选的。例如，考虑使用列表理解来平方<code class="fe lu lv lw lx b">numbers</code>列表:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="dcc3" class="nx mv it lx b gy ny nz l oa ob">squares = [num * num <strong class="lx iu">for</strong> num <strong class="lx iu">in</strong> numbers]</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="5b3b" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">词典释义</h1><p id="08e6" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">惊讶吧，惊讶吧:Python也有遍历字典的简写方式。这就是所谓的<em class="ly">字典理解。</em></p><h2 id="b615" class="nx mv it bd mw od oe dn na of og dp ne lh oh oi ng ll oj ok ni lp ol om nk on bi translated">示例1:从列表中创建字典</h2><p id="09ae" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">假设您想从一个<code class="fe lu lv lw lx b">numbers</code> <em class="ly">列表</em>中创建一个<em class="ly">字典</em>。在新字典中，一个数字是一个<em class="ly">键</em>，而<em class="ly">值</em>是该数字的字符串表示。此外，您希望仅包含偶数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="ba02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="a1b8" class="nx mv it lx b gy ny nz l oa ob">{10: '10', 20: '20', 30: '30', 40: '40', 50: '50'}</span></pre><p id="59ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这工作得很好。但是通过使用<em class="ly">字典理解</em>，一行代码就能搞定一切:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="a6d3" class="nx mv it lx b gy ny nz l oa ob">dict = {num: str(num) <strong class="lx iu">for</strong> num <strong class="lx iu">in</strong> nums <strong class="lx iu">if</strong> num % 2 == 0}</span><span id="8554" class="nx mv it lx b gy oc nz l oa ob"><strong class="lx iu">print</strong>(dict)</span></pre><p id="570d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="75f3" class="nx mv it lx b gy ny nz l oa ob">{10: '10', 20: '20', 30: '30', 40: '40', 50: '50'}</span></pre><h2 id="4637" class="nx mv it bd mw od oe dn na of og dp ne lh oh oi ng ll oj ok ni lp ol om nk on bi translated">示例2:对现有字典进行操作</h2><p id="9026" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">再来看一个<em class="ly">字典理解</em>的例子。在这个例子中，您有一个通过平方所有数字来更新的字典。</p><p id="6237" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们用<em class="ly">字典理解</em>:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="1457" class="nx mv it lx b gy ny nz l oa ob">data = {'a': 1, 'b': 2, 'c': 3, 'd': 4, 'e': 5}</span><span id="5415" class="nx mv it lx b gy oc nz l oa ob">squared = {k:v*v <strong class="lx iu">for</strong> (k,v) <strong class="lx iu">in</strong> data.items()}</span><span id="edbf" class="nx mv it lx b gy oc nz l oa ob">print(squared)</span></pre><p id="f1bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="ab30" class="nx mv it lx b gy ny nz l oa ob">{'a': 1, 'b': 4, 'c': 9, 'd': 16, 'e': 25}</span></pre><p id="9dfc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就对了。</p><p id="86c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你又一次能够用一行代码编写一个更简单的<code class="fe lu lv lw lx b">for</code>循环，而丝毫不牺牲可读性。</p><p id="88f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">综合起来看，<em class="ly">字典理解</em>的基本结构是这样的:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="4cd2" class="nx mv it lx b gy ny nz l oa ob">{ key:value <strong class="lx iu">for</strong> (key,value) <strong class="lx iu">in</strong> dict <strong class="lx iu">if</strong> <em class="ly">condition </em>}</span></pre><p id="7827" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当使用字典理解时，记得将表达式放在<code class="fe lu lv lw lx b">{}</code>中，而不是<code class="fe lu lv lw lx b">[]</code>中。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="dcdb" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">集合理解</h1><p id="1345" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated"><em class="ly">集合理解</em>与<em class="ly">列表理解</em>、<em class="ly"> </em>类似，但适用于集合。</p><p id="35a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为一个例子，让我们将一个<em class="ly">列表</em>中的所有偶数移动到一个<em class="ly">集合</em>中。下面是<code class="fe lu lv lw lx b">for</code>循环方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="f43c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="ba32" class="nx mv it lx b gy ny nz l oa ob">{24, 62, 14}</span></pre><p id="44dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，使用<em class="ly">集合理解，</em>事情变得更加简单:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="50ec" class="nx mv it lx b gy ny nz l oa ob">filtered_nums = {num <strong class="lx iu">for</strong> num <strong class="lx iu">in</strong> numbers <strong class="lx iu">if</strong> num % 2 == 0}</span><span id="403a" class="nx mv it lx b gy oc nz l oa ob">print(filtered_nums)</span></pre><p id="d76c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="2929" class="nx mv it lx b gy ny nz l oa ob">{24, 62, 14}</span></pre><p id="416f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">集合理解的结构类似于列表和字典理解的结构:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="5c18" class="nx mv it lx b gy ny nz l oa ob">output_set = { expression <strong class="lx iu">for</strong> var <strong class="lx iu">in</strong> input <strong class="lx iu">if</strong> condition }</span></pre><p id="a972" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">记住用<code class="fe lu lv lw lx b">{}</code>代替<code class="fe lu lv lw lx b">[]</code>。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="54aa" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">生成器理解</h1><p id="75b5" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">最后，让我们介绍一下<em class="ly">发电机的理解。</em>与其他理解类似，<em class="ly">生成器理解</em>提供了一种使用生成器的简写方式。</p><p id="91da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设您想要对一个<em class="ly">列表</em>中的所有偶数求平方，并删除所有奇数。</p><p id="c871" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">for</code>循环方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="ea97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="70af" class="nx mv it lx b gy ny nz l oa ob">4<br/>16<br/>36</span></pre><p id="1625" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这工作得很好。但是有了<em class="ly">生成器理解</em>，你可以忘记创建生成器的<code class="fe lu lv lw lx b">square_even</code>方法，只使用一行代码:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="dff3" class="nx mv it lx b gy ny nz l oa ob">squared_numbers = (num * num <strong class="lx iu">for</strong> num <strong class="lx iu">in</strong> numbers <strong class="lx iu">if</strong> num % 2 == 0)</span><span id="c5fc" class="nx mv it lx b gy oc nz l oa ob"><strong class="lx iu">for</strong> number <strong class="lx iu">in</strong> squared_numbers: <br/>    print(number)</span></pre><p id="13eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="08d4" class="nx mv it lx b gy ny nz l oa ob">4<br/>16<br/>36</span></pre><p id="eb7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">生成器理解的基本结构是:</p><pre class="kj kk kl km gt nt lx nu nv aw nw bi"><span id="e379" class="nx mv it lx b gy ny nz l oa ob">output_gen = ( expression <strong class="lx iu">for</strong> var <strong class="lx iu">in</strong> input <strong class="lx iu">if</strong> condition )</span></pre><p id="4788" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住将表达式放在<code class="fe lu lv lw lx b">()</code>内，而不是<code class="fe lu lv lw lx b">{}</code>或<code class="fe lu lv lw lx b">[]</code>。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0034" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">结论</h1><p id="d03f" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">在Python中，可以通过使用理解将<code class="fe lu lv lw lx b">for</code>循环变成一行程序。</p><p id="4e02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有四种理解:</p><ul class=""><li id="2db0" class="lz ma it la b lb lc le lf lh mb ll mc lp md lt me mf mg mh bi translated"><em class="ly">列表理解</em></li><li id="049f" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">字典理解</em></li><li id="4516" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">设定理解</em></li><li id="8060" class="lz ma it la b lb mi le mj lh mk ll ml lp mm lt me mf mg mh bi translated"><em class="ly">发电机理解</em></li></ul><p id="7842" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。我希望这些信息对你有用。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="85be" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">资源</h1><div class="oo op gp gr oq or"><a href="https://docs.python.org/3/" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">文件</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">欢迎光临！这是Python 3.9.1的文档。</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">docs.python.org</p></div></div></div></a></div></div></div>    
</body>
</html>