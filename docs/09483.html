<html>
<head>
<title>Debug Your Web API Problems in 4 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用4个步骤调试你的Web API问题</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-debug-web-api-problems-in-4-steps-170aa12a5a9c?source=collection_archive---------15-----------------------#2021-08-30">https://betterprogramming.pub/how-to-debug-web-api-problems-in-4-steps-170aa12a5a9c?source=collection_archive---------15-----------------------#2021-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae73" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">简化您的web服务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e4ba5cb542d9a3ac09df969312469772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*igHJkA29Ns3oLST3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多梅尼科·洛亚在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="274f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文是解决web服务常见问题的分步诊断指南。本文假设您有一个web客户端和一个服务器，并试图让这两个客户端和服务器进行通信，但是遇到了问题。</p><h1 id="493f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Web服务和复杂性</h1><p id="5d4c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">代码很复杂，很多事情都可能出错。然而，当您将web通信加入进来时，除了编译器和逻辑错误之外，还会出现更多的问题。</p><p id="2ab2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些可能出错的事情包括:</p><ul class=""><li id="8a86" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">网络问题使您无法与其他服务器通话</li><li id="f596" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">另一台服务器可能因为维护而停机</li><li id="2c6d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">服务器端的新代码可能需要您改变调用API的方式</li><li id="c641" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">您的请求数据可能不是服务器可以接受的有效格式(例如，试图在商店关门的那天预约)</li><li id="4d79" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">用户可能没有填写所需的数据</li><li id="56fb" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">您的登录信息可能丢失或已过期，需要您重新登录</li></ul><p id="e741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面所有的问题都可能破坏已经工作的API，所以你可以想象，让一个新的API第一次工作是非常困难的。</p><p id="dbcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如果您遵循一个逻辑进程，您可以诊断和解决大多数web服务问题。</p><h1 id="626e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">诊断API问题</h1><p id="fd1a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">以下是我在诊断问题时学会遵循的四个步骤:</p><ol class=""><li id="95b3" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ng my mz na bi translated">获取关于请求和响应的信息</li><li id="8463" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">识别问题区域</li><li id="c69a" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">各个击破</li><li id="68e9" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">调试和解决</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/7f99c130d49b0f3cf45228b2bbea6045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J4pmRoPA40hvqxdt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图表</p></figure><p id="fd3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将依次查看其中的每一项。</p><h1 id="f372" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤1:获取关于Web请求的信息</h1><p id="ee8a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在诊断web通信问题时，首先要查看的是关于发送的请求和返回的响应的信息。</p><p id="ff2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在发出一个不需要身份验证的简单GET请求，您通常可以在浏览器中执行此操作，打开浏览器的开发人员工具并选择network选项卡。查看<a class="ae ky" href="https://developer.chrome.com/docs/devtools/network/" rel="noopener ugc nofollow" target="_blank"> Chrome的官方教程</a>了解更多关于如何使用这个功能的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/d6392abaea781e8c4165915bfaa81c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*93fw-ppjtYXDbrgi"/></div></div></figure><p id="7841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Chrome的网络工具(如上图所示)允许你选择一个特定的请求，并在Headers标签页上获得许多事情的细节，包括:</p><ul class=""><li id="971f" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">请求URL</li><li id="7d34" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">请求方法(或动词)</li><li id="3526" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">产生的状态代码</li><li id="6a87" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">与请求和响应相关联的标头</li><li id="5a87" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">请求有效负载(或主体)</li></ul><p id="9ea2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">预览和响应选项卡还将提供有关返回数据的更多信息，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/a75c021ccba596c8f6a9c163da820748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XdCzItLbfuI8N-SP"/></div></div></figure><p id="389a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时您需要诊断非GET请求或需要身份验证令牌的请求。在这些情况下，我喜欢从精彩的(免费的)<a class="ae ky" href="https://www.postman.com/product/api-client/" rel="noopener ugc nofollow" target="_blank"> Postman </a>应用程序中进行测试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/8935857e05247cb765a92d304af4b656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XGFWycuIjM2Hd_36"/></div></div></figure><p id="385d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Postman，您可以指定您想要使用的方法/动词、要使用的URL、设置您需要的任何头(例如身份验证不记名令牌)，并为您的消息提供正文(确保使用应用程序JSON内容类型将内容设置为raw)。</p><p id="6fea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成后，单击Send将发出请求，并在下方窗格中显示结果，允许您观察状态代码、响应正文和响应标题。</p><p id="64a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果您的应用程序从代码中进行调用，您可以使用调试器来获得请求和响应的详细信息，这取决于您用来进行web请求的库。但是，如果你这样做的话要非常小心，因为开发者很容易认为他们所做的请求的细节是不正确的。Postman消除了这种顾虑，并允许您独立于您的客户机代码来验证web服务的行为。</p><p id="f55a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于如何开始使用该应用程序的更多信息，请参见Postman's wonderful <a class="ae ky" href="https://learning.postman.com/" rel="noopener ugc nofollow" target="_blank">学习中心</a>。</p><h1 id="c999" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤2:识别问题区域</h1><p id="328f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在您已经有了关于您遇到的实际请求和响应的信息，您可以开始确定哪里出错了。</p><p id="5398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我的经验，最有帮助的事情是确定错误发生在哪里——是客户端发送了一个错误的请求，还是服务器发回了一个错误的响应。一旦你能专注于这两个领域中的一个，问题就变得不那么令人生畏了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9a0b2dc1aa38573dfb3e03ee4bd14299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/0*O2TimzAxKq4rRrdP"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马特·伊兰制图</p></figure><p id="3190" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您查看关于请求和响应的信息时，验证请求看起来是否正确是很重要的。</p><p id="1130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我经常检查的一些东西:</p><ol class=""><li id="343a" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ng my mz na bi translated">请求是否使用了适当的URL？</li><li id="06cd" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">是否使用了正确的方法/动词？例如，当它应该执行POST时，它是否在执行GET？</li><li id="ede1" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">如果请求是一个POST或PUT，它是否包含一个body？</li><li id="e0a8" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">那个身体看起来正确吗？即使是像发送字符串“1”而不是数字1这样的小事也会有所不同。</li></ol><p id="779f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您确定请求在各方面看起来都是正确的，请查看响应。响应可以告诉您很多关于服务器如何处理您的请求的信息。有两条非常重要的信息与响应相关联:响应状态和响应主体。</p><h2 id="81d7" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">使用响应状态</h2><p id="c94c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">响应状态是一个范围从100到599的代码。作为开发人员，您最可能看到的状态代码在200–299范围、400–499范围和500–599范围内。</p><p id="e2ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个主要的状态代码代表不同的东西。200系列状态代码通常用于没有问题的情况。另一方面，400和500系列的状态代码都表明出了问题或无效。400系列状态代码表示服务器认为请求有问题，而500系列状态代码通常表示服务器有问题。</p><p id="3d1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这可能会令人生畏，但这些状态代码可以快速传达作为开发人员您所遇到的情况。正因为如此，学习它们很重要。通常，如果响应状态不在200–299的范围内，那么一定是出了问题，如果问题不是很明显，您需要对其进行诊断。</p><p id="a04c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在后面的步骤4中更多地讨论开发人员最常看到的一些个人状态代码。</p><h2 id="0ddb" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">使用响应体</h2><p id="f823" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">虽然响应状态是一个简单的数字代码，但是响应的<em class="ny">主体</em>可以是任何内容，从完全为空到简单的错误消息到复杂的JSON对象。响应体的内容取决于您正在使用的服务器技术(例如，有些技术会自动为无效请求生成响应),并基于您的web服务返回的任何响应数据。</p><p id="1431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您查看响应正文时，您需要检查两件事情:</p><ol class=""><li id="155f" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ng my mz na bi translated">回复体告诉我什么有趣的事情了吗？例如，此响应中是否包含错误消息？</li><li id="926b" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">响应正文看起来是否正确？如果没有，您的服务器可能有一个错误。如果是这样，您的API可能工作正常，但是您在处理API调用的结果时可能有一个错误。</li></ol><p id="5fb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您怀疑您的服务器可能没有根据您获得的主体返回正确的结果，那么在您的服务器上放置调试断点并逐步完成发送请求时发生的事情可能是一个好主意。</p><h1 id="dd56" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第三步:分而治之</h1><p id="bf1e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在，您应该对客户机向服务器发送什么消息以及服务器发回什么响应有了一个合理的概念。</p><p id="b662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，你的首要目标是将问题一分为二。</p><p id="28a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为软件系统是非常复杂的，所以排除一些事情并关注剩余的因素会很有帮助。这个原则在处理web服务时非常有用。</p><p id="4ca7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您应该有足够的信息来回答以下问题:</p><ul class=""><li id="b85c" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">客户端是否向服务器发送了适当的消息？</li><li id="2274" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">服务器是否以成功的状态代码和有用的响应正文进行响应？</li></ul><p id="f26d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您对第一个问题的回答是否定的，那么您的问题至少是从客户端代码开始的，它没有发送有效的请求。</p><p id="9957" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您对第二个问题的回答是“否”,则您的服务器没有正确处理来自客户端的请求，这可能是由于请求(内容或身份验证)有问题，或者是由于服务器上的错误或逻辑缺陷。请参阅步骤4中的更多详细信息来诊断发生了什么，但通常如果状态代码在400s，您将调查客户端，如果状态代码在500s，您将调查服务器。</p><p id="6fd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果服务器返回200个状态代码，但却是无效数据，这通常表明服务器端存在逻辑问题，您应该调查服务器。</p><p id="9c42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在极少数情况下，客户端发送适当的请求，服务器以良好的响应进行回复，但应用程序中仍然出现问题，您可能在客户端处理对数据的响应时遇到了问题，应该查看该代码。</p><h1 id="9f6b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤4:调试和解决</h1><p id="8bff" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">此时，您只关注了客户端或服务器。恭喜你，这让你的工作变得简单多了。你现在的工作是通过调试确认问题，并做出适当的修复。</p><p id="2690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，考虑到web服务中有多少不同的问题和多少不同的状态代码，这使得我写调试的工作变得很困难。</p><p id="f808" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当事情变得困难时，我喜欢使用图片，所以让我们来看看我创建的流程图。该流程图从图表顶部的橙色圆角矩形开始，并基于图表中的决策从那里开始流动。准备好您的状态代码，并遵循下表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/056991cdd1cbd0543e38c435d9457f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jXQHy01Cs_-osSj3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Matt Eland的流程图</p></figure><p id="34be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了获得最佳效果，您可能需要单击图像以展开它，或者右键单击它并在新的选项卡中打开它。</p><p id="1864" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您遵循这个过程，您可能会看到一个包含您遇到的错误的蓝框，以及至少一个推荐解决方案或您可以采取的附加步骤的绿框。</p><p id="b1a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将在下一节概述一些更常见的问题以及解决这些问题的步骤，但是如果您的错误不在这里，您可能需要参考Mozilla的<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="noopener ugc nofollow" target="_blank">状态代码列表</a>或者进行一些网络搜索。</p><h1 id="45b8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">常见问题</h1><p id="37b6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们来看看一些常见的状态代码，以及您可以对它们做些什么。</p><h2 id="7bda" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">无响应/连接被拒绝</h2><p id="e160" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果您的服务器根本没有返回响应，您通常会收到某种形式的“无法连接到服务器”消息。这通常发生在互联网中断或服务器没有运行时。</p><p id="5d89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发生这种情况的另一个原因是，如果服务器在断点处暂停，它可能无法处理后续请求。</p><p id="0002" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保您有一个有效的互联网连接，并且您的服务器正在运行，没有在断点处停滞..</p><h2 id="89cb" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">200–299个状态代码</h2><p id="35f2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你得到一个200系列的状态码，这意味着服务器认为一切正常。然而，如果您正在调试东西并试图找出为什么某些东西在工作，这意味着两件事情中的一件正在发生:</p><ol class=""><li id="12b1" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ng my mz na bi translated">服务器正在返回200系列响应，但没有做正确的事情/返回正确的响应正文</li><li id="bff2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">服务器正在返回一个200系列响应和一个正确的正文，但是用户仍然会看到一个错误</li></ol><p id="fe93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一种情况下，你应该调试服务器，看看它是如何完成请求的，因为某种形式的<em class="ny">逻辑错误</em>正在发生，你的程序并没有完全按照你的预期去做。</p><p id="971d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第二种情况下，您应该调试客户端的代码来处理服务器的响应，因为看起来API运行正常。您可能需要后退一步，思考您的应用程序应该如何在较高的层次上工作，以便发现bug。</p><h2 id="7294" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">400 —错误的请求</h2><p id="1270" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当客户端发送的信息与服务器期望的不匹配时，通常会遇到坏请求。这可能是任何东西，从丢失的一段数据到字符串形式而不是数字形式的值，到发送的无效邮政编码。</p><p id="d0c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，当服务器返回一个400错误请求时，响应主体会告诉您关于请求无效的更多信息。您还可以查看请求体，以确保请求看起来有效，并且所有参数都存在并且是适当的类型。</p><h2 id="9023" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">401-未经授权</h2><p id="99cd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当客户端请求安全的内容，但服务器无法验证他们是谁时，会出现此错误。通常，当客户端在其请求标头中不包含身份验证令牌时会发生这种情况，但如果身份验证令牌已过期，也会发生这种情况。</p><p id="1630" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查您的请求，并确保您正在向服务器发送适当的授权头。</p><p id="c6c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在使用外部API，您可能需要查阅他们的文档或联系他们，以了解他们希望您如何进行身份验证。</p><h2 id="3486" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">403 —禁止</h2><p id="55f2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果当服务器不知道您是谁并需要登录才能获得特定资源时发生401未授权，当服务器知道您是谁但该身份不允许访问特定资源时发生403。</p><p id="dbf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以这样想:你的服务器是站在一个非常重要的门口的保安。一个请求走到门口，但警卫拒绝进入。请求接着说“你知道我是谁吗？”。如果保安回答“不”，那就是401未授权。如果警卫回答“可以，但你不允许回到这里”，这是403禁止的。</p><p id="50c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">403禁止响应根本不是bug。在这些情况下，应用程序的安全性是为了防止未经授权的访问。如果您认为您应该有权访问某些内容，请仔细检查您的用户权限以及服务器对您请求的资源强制执行的权限。</p><h2 id="bd52" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">404 —未找到</h2><p id="7034" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这种状态代码是开发圈之外最常见的代码，因为当链接无效或URL输入不正确时，它会出现在许多浏览器中。</p><p id="e382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在API开发中，404 Not Found响应代码以两种方式之一出现:</p><ol class=""><li id="9a08" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ng my mz na bi translated">您试图调用服务器上不存在的API端点</li><li id="9a16" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ng my mz na bi translated">您调用了一个有效的API端点来请求一个不再存在的特定东西</li></ol><p id="d922" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一种情况是最常见的，所以我们来讨论一下。如果我有一个支持GET的服务器，在一个像<strong class="lb iu"> </strong> <code class="fe oa ob oc od b">/api/menu</code>这样的URL上，你对<code class="fe oa ob oc od b">/api/menuitems</code>做了一个GET请求，这时服务器将会响应404，告诉你没有支持的端点来处理对<code class="fe oa ob oc od b">/api/menuitems</code>的GET请求。在这种情况下，最好将请求的URL与服务器支持的URL进行比较。</p><p id="fbb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二种情况发生在当你试图得到不存在的特定的东西时。例如，如果我向<code class="fe oa ob oc od b">/api/products/5003</code>发出一个GET请求，但是数据库中最大的产品号是250，服务器将无法找到我正在寻找的产品，并且理所当然地返回一个404，告诉我它不在那里。</p><p id="52a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这两种情况下，您都应该仔细检查客户端的逻辑，并确保您请求的是一个合适的URL。使用浏览器中的网络选项卡有助于验证所请求的URL是否如您所想。</p><h2 id="97ec" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">405-不允许的方法</h2><p id="3581" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当服务器提供支持特定方法(如GET)的端点，但您尝试使用不同的方法访问它时，会出现405。例如，如果一个服务器提供了一个支持GET的<code class="fe oa ob oc od b">/api/menu</code>端点，而我删除了这个端点，我会得到一个不允许的405方法。</p><p id="873c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，当您使用不正确的URL进行操作，或者服务器尚未实现您尝试调用的方法时，会出现405。仔细检查API，确保你的URL是正确的。</p><h2 id="837e" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">415 —不支持的媒体类型</h2><p id="6e93" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个错误最有可能发生在Postman内部。在Postman中，如果您忘记将请求体的内容类型更改为JSON，您很可能会得到415响应。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/7defe9b84cc151441711b2c1a3c3e0f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/0*icOjU-e9E4xjE_hu"/></div></figure><p id="5be4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为服务器不知道如何处理您请求的内容。确保在Postman中适当地设置了内容类型。</p><p id="c55c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在代码中遇到这种情况，您可能没有指定请求的content-type标头，或者将它设置为服务器不支持的内容。然而，这是一个不太常见的问题，所以我不会在这里深入讨论。</p><h2 id="d404" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">420 / 429 —请求太多</h2><p id="4039" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一些服务器支持速率限制，这是一种抑制传入请求的方法，可以确保没有用户在特定的时间跨度内用太多的请求来淹没API。</p><p id="7dba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，如果您遇到420或429响应代码，这意味着您过于频繁地调用服务器，或者需要减少您发送的请求数量，或者需要升级到付费级别。</p><p id="d759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多细节请参考您的API文档。</p><h2 id="7dca" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">其他400系列状态代码</h2><p id="51b2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">有时你会得到400–499的不同回答，这里没有列出。当使用不寻常的API时，这些错误往往是更多的情境错误。参考Mozilla关于特定错误代码的文档,并参考您正在尝试使用的API的文档。如果API是由其他人运行的，您可能需要联系他们的支持团队。</p><h2 id="f14d" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">500 —内部服务器错误</h2><p id="01a6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这通常发生在试图处理请求时服务器代码中抛出异常的情况下。看一看响应正文，看看它是否告诉您错误发生在哪里。您还可以在服务器上放置一个调试器断点，并逐句通过，直到出现错误。</p><p id="bd0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦确定了有问题的代码行，就进行修改并再次测试。</p><h2 id="9fb9" class="nm lw it bd lx nn no dn mb np nq dp mf li nr ns mh lm nt nu mj lq nv nw ml nx bi translated">其他500系列状态代码</h2><p id="5ff7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">有时你会得到500以上的回复。这些通常是指网络问题、服务器暂时离线等。并且更难诊断。请参考<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="noopener ugc nofollow" target="_blank"> Mozilla的文档</a>了解具体的错误代码，并根据需要咨询您的网络管理员。</p><h1 id="dc38" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第五步:冲洗并重复</h1><p id="ea20" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">是的，我知道，我声称这是一个4步的过程。这是谎言，因为当一个问题解决了，它可能不是你的过程的结束。</p><p id="b1af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决web服务中的问题后，如果遇到新问题，再次测试并返回到步骤1是很重要的。</p><p id="39e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">软件是复杂的，很多时候可能会有不止一个问题阻止软件工作。有时，在应用程序回到工作状态之前，您需要依次解决两三个问题。</p><p id="50a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，API是复杂但强大的东西。学习曲线很陡，但这些技术对现代web开发至关重要。</p><p id="cae6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解API和API调试对于所有类型的开发人员来说都是一项核心技能，这就是为什么我们在<a class="ae ky" href="https://www.techelevator.com/" rel="noopener ugc nofollow" target="_blank">科技电梯</a>上如此强调它。</p><p id="ab81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了开发人员之外，技术专业人员，如质量保证专业人员、项目/产品经理、系统管理员和技术领导，都需要对API的基础知识以及它们给开发团队和开发项目带来的挑战有深刻的理解。</p><p id="b106" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，学习API至关重要，也是你需要做的事情。希望这份指南能帮到你。</p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="a82c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ny">原载于2021年8月30日</em><a class="ae ky" href="https://killalldefects.com/2021/08/30/how-to-debug-web-api-problems-in-4-steps/" rel="noopener ugc nofollow" target="_blank"><em class="ny">【https://killalldefects.com】</em></a><em class="ny">。</em></p></div></div>    
</body>
</html>