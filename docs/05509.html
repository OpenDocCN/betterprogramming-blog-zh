<html>
<head>
<title>Exploring the Autofill Framework in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Android中的自动填充框架</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-the-autofill-framework-in-android-672221ccdc6a?source=collection_archive---------11-----------------------#2020-07-14">https://betterprogramming.pub/exploring-the-autofill-framework-in-android-672221ccdc6a?source=collection_archive---------11-----------------------#2020-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f003" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用自动填充框架填补论坛和用户数据之间的空白</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b19b0805c34642b43ab1b18103590f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k3MblvP8LWLe3k2r"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@christianw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯蒂安·威迪格</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="d2f6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="1e3a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">填写表格是一件既费时又乏味的工作。大多数人对长表格或忘记密码感到沮丧。为了填补论坛和用户数据之间的空白，Android团队引入了autofill框架，该框架在Android 8.0 (API level 26)及更高版本中可用。</p><p id="04bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当你在手机上使用应用程序时，你可能会看到密码管理应用程序自动填写登录信息。填充其他应用程序视图的应用程序被称为<em class="ms">自动填充服务。</em></p><p id="31a5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过为自动填充优化您的应用程序，您可以提供更复杂的用户行为，这有助于他们避免输入错误并节省时间，因为他们不需要多次输入相同的输入。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="12a0" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">成分</h1><p id="a0ac" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当我们从顶层看到自动填充框架时，我们主要有三个组件:数据源、目的地和中介。</p><ul class=""><li id="a8d2" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated"><strong class="lt iu">自动填充服务:</strong>密码管理器等应用程序充当数据源，存储可在应用程序间使用的数据</li><li id="9e6d" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><strong class="lt iu">自动填充客户端:</strong>这些是要填充数据的目标应用程序</li><li id="0be9" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><strong class="lt iu"> Android系统:</strong>这是帮助上述两个组件协同工作的中介</li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="b2cd" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">自动填充提示</h1><h2 id="f070" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">为什么我们需要实现自动填充提示？</h2><p id="c528" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我所说的，数据的来源是一个自动填充服务——他们试图使用试探法来确定视图。因此，如果他们改变行为，自动填充也会改变。为了确保自动填充服务与视图一起正确工作，我们需要提供自动填充提示。</p><h2 id="d88f" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">如何实现自动填充提示</h2><p id="9cb5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以在XML布局或Kotlin类文件中实现它们。</p><p id="3363" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，让我们看看如何使用属性<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/android/R.styleable#View_autofillHints" rel="noopener ugc nofollow" target="_blank">android:autofillHints</a></code>在XML中实现一个简单的提示。下面的代码演示如何在XML中实现密码提示。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">XML中的自动填充提示实现</p></figure><p id="fed7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们可以通过在视图上使用<code class="fe of og oh oi b">setAutofillHints</code>在Kotlin类文件中实现同样的功能。看一看:</p><pre class="kj kk kl km gt ol oi om on aw oo bi"><span id="bcf7" class="nt la it oi b gy op oq l or os">edtPassword.<strong class="oi iu">setAutofillHints</strong>(View.AUTOFILL_HINT_PASSWORD)</span></pre><p id="fe03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">自动填充框架不会验证提示常量。以下是一些预定义的提示常量:</p><ul class=""><li id="cdda" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated">我们可以在创建帐户或首次登录时使用<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_NEW_USERNAME" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_NEW_USERNAME</a></code>和<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_NEW_PASSWORD" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_NEW_PASSWORD</a> </code></li><li id="48d5" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">我们可以使用<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_CREDIT_CARD_NUMBER" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_CREDIT_CARD_NUMBER</a></code>、<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_DAY" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_DAY</a></code>、<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_MONTH" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_MONTH</a></code>、<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_YEAR" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_CREDIT_CARD_EXPIRATION_YEAR</a></code>和<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_CREDIT_CARD_SECURITY_CODE" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_CREDIT_CARD_SECURITY_CODE</a></code>等提示来自动填充卡片相关的详细信息</li><li id="a850" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">我们还可以使用以下常量自动填充与地址相关的字段:<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_STREET_ADDRESS" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_STREET_ADDRESS</a></code>、<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_EXTENDED_ADDRESS" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_EXTENDED_ADDRESS</a></code>、<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_LOCALITY" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_LOCALITY</a></code>、<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_REGION" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_REGION</a></code>、<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_COUNTRY" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_COUNTRY</a></code>、<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_CODE" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_CODE</a></code>和<code class="fe of og oh oi b"><br/><a class="ae ky" href="https://developer.android.com/reference/androidx/autofill/HintConstants#AUTOFILL_HINT_POSTAL_ADDRESS_EXTENDED_POSTAL_CODE" rel="noopener ugc nofollow" target="_blank">AUTOFILL_HINT_POSTAL_ADDRESS_EXTENDED_POSTAL_CODE</a></code></li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="1897" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">自动填充的重要性级别</h1><p id="8fdb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以通过使用<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/android/R.styleable#View_importantForAutofill" rel="noopener ugc nofollow" target="_blank">android:importantForAutofill</a></code>属性<strong class="lt iu">告诉系统层次结构中的视图是否需要自动填充。</strong>默认使用<code class="fe of og oh oi b"><a class="ae ky" href="https://developer.android.com/reference/android/view/View#IMPORTANT_FOR_AUTOFILL_AUTO" rel="noopener ugc nofollow" target="_blank">IMPORTANT_FOR_AUTOFILL_AUTO</a></code>。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动填充重要性级别</p></figure><p id="81bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还可以通过使用<code class="fe of og oh oi b">setImportantForAutofill</code>函数来设置Kotlin类的重要性级别。看一看:</p><pre class="kj kk kl km gt ol oi om on aw oo bi"><span id="0fe9" class="nt la it oi b gy op oq l or os">tvSample.<strong class="oi iu">setImportantForAutofill</strong>(View.IMPORTANT_FOR_AUTOFILL_NO);</span></pre><p id="adba" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">默认情况下，它接受五种不同的值，例如:</p><ul class=""><li id="25ff" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated"><code class="fe of og oh oi b">auto</code>:这是默认值，让Android系统使用它的试探法来确定视图是否对自动填充至关重要</li><li id="c601" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><code class="fe of og oh oi b">no</code>:该值表示该视图对自动填充不重要</li><li id="92a3" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">自动填充</li><li id="1e66" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><code class="fe of og oh oi b">yes</code>:该值表示该视图对于自动填充至关重要</li><li id="21d4" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><code class="fe of og oh oi b">yesExcludeDescendants</code>:这个视图对于自动填充很重要，但是它的子视图对于自动填充并不重要</li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="5db4" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">强制自动填充请求</h1><p id="5fad" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有时，您需要强制自动填充请求来响应用户的操作。在这种情况下，我们可以使用自动填充菜单项，它出现在长按上。下面的代码示例显示如何强制自动填充请求:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="97f9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还可以使用<code class="fe of og oh oi b">cancel()</code>功能取消自动填充上下文。如果用户清除文本，这将非常方便。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="76cf" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">奖金</h1><p id="9d9e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要了解有关Android高级开发的更多信息，请阅读以下文章:</p><ul class=""><li id="9260" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated"><a class="ae ky" href="https://levelup.gitconnected.com/vector-asserts-in-android-f0774ba8bf92" rel="noopener ugc nofollow" target="_blank">“学习如何在Android中创建矢量资产”</a></li><li id="a563" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><a class="ae ky" href="https://medium.com/better-programming/how-to-integrate-google-pay-into-your-existing-android-app-d75b269cd623" rel="noopener">“如何将Google Pay集成到您现有的Android应用中”</a></li><li id="c4bc" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><a class="ae ky" href="https://medium.com/@sgkantamani/android-product-flavors-eb526e35f9f1" rel="noopener">《安卓产品口味》</a></li><li id="7a42" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><a class="ae ky" href="https://medium.com/@sgkantamani/how-to-create-and-publish-an-android-library-f37bf715932" rel="noopener">“如何创建和发布Android库”</a></li><li id="679a" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><a class="ae ky" href="https://medium.com/better-programming/evolution-of-adapters-in-android-2e2ff58c0f98" rel="noopener">“Android中适配器的演变”</a></li></ul><p id="9571" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前就这些——希望你学到了有用的东西。感谢阅读。</p></div></div>    
</body>
</html>