<html>
<head>
<title>Automate Filling Templates With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python自动填充模板</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/automate-filling-templates-with-python-1ff6c6fd595e?source=collection_archive---------1-----------------------#2022-06-29">https://betterprogramming.pub/automate-filling-templates-with-python-1ff6c6fd595e?source=collection_archive---------1-----------------------#2022-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c21e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">做重要的工作，而不是重复的任务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0f6dc15fad4d1b7c86c6ca49ce09e270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R2-xwwJhxvyzWWJv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="550f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="d26a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，您将了解到:</p><ul class=""><li id="50eb" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">如何基于Excel输入填写预定义的Word模板？</li><li id="a511" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">如何实现自动化，以便同时创建多个模板。</li><li id="e358" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">如何使模板适应您的特定用例。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/5e11c669ed257dc9549d074ac6a868ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-l9867FSE7tsOlh_z4CZSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python流程</p></figure><h1 id="3dda" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">装载包裹</h1><ul class=""><li id="9e8d" class="mn mo it lt b lu lv lx ly ma ne me nf mi ng mm mu mv mw mx bi translated"><a class="ae ky" href="https://openpyxl.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> Openpyxl </a>:用于处理excel文件的Python包</li><li id="765c" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://python-docx.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Docx </a>:用于处理Word文档的Python包</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入必要的包</p></figure><h1 id="dc3a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">获取数据</h1><p id="658d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">将这些文件保存到您的本地文件夹:</p><ol class=""><li id="71e0" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm nj mv mw mx bi translated">Excel模板:<a class="ae ky" href="https://docs.google.com/spreadsheets/d/1SsQ0gko7AC9Vh-n_Z1Ssaw0MfRk_ZX4l/edit?usp=sharing&amp;ouid=109954644398573752131&amp;rtpof=true&amp;sd=true" rel="noopener ugc nofollow" target="_blank">下载</a></li><li id="ea2e" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm nj mv mw mx bi translated">Word模板:<a class="ae ky" href="https://docs.google.com/document/d/1iAx_P6xCwABR4zTMlNoYgEm5mhU_0w6Q/edit?usp=sharing&amp;ouid=109954644398573752131&amp;rtpof=true&amp;sd=true" rel="noopener ugc nofollow" target="_blank">下载</a></li></ol><h1 id="a3b5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建Word模板</h1><p id="f084" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">word模板以下列格式定义输入参数:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="7716" class="np la it nl b gy nq nr l ns nt">{{PARAMETER}}</span></pre><p id="38e7" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">参数中不能有空格，这一点很重要:</p><ul class=""><li id="e180" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">{ {公司名称}}正常，但{ {公司名称}}会出现错误</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a81dd28951af0482779494d1c016db5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*qF8wBMupuVdIoh3LGG-RHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Word模板</p></figure><h1 id="22c2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建Excel文件</h1><p id="0061" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在第一列中，显示了word文件中定义的相同参数。这些应该有完全相同的命名。</p><p id="b573" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">在其他列中，您为该特定参数定义输入数据。每一栏将确保填写一个额外的模板。</p><p id="631f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">在我们的示例中，将生成两个报告(B和C):</p><ul class=""><li id="8972" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">B列定义了元平台的数据</li><li id="d251" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">列C定义了123company的数据</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/79b3ed9e1f818f1b5ca63b021341238e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9mYbEZ4UPkPaJ0BXTmPFdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">擅长</p></figure><h1 id="8a30" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">用Python加载文件</h1><p id="7b87" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，用Python加载文件，如下面的代码片段所示。</p><p id="e30a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">然后，定义字典<code class="fe ny nz oa nl b">to_fill_in</code>，在这里定义参数名。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="7675" class="np la it bd lb ob oc dn lf od oe dp lj ma of og ll me oh oi ln mi oj ok lp ol bi translated"><strong class="ak"> <em class="om">分步代码解释:</em> </strong></h2><ul class=""><li id="52f7" class="mn mo it lt b lu lv lx ly ma ne me nf mi ng mm mu mv mw mx bi translated">r " C:\ Users \ Documents \ 1 _ Work \ Scripts \ template assistant \ 004-Test "</li></ul><p id="47b6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">将此更改为保存下载的word文档和excel文件的文件夹位置。</p><ul class=""><li id="d7f5" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">load_workbook(workbook_path)</code>:</li></ul><p id="9cac" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">使用前面定义的workbook_path加载excel工作簿。</p><ul class=""><li id="040d" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">DocxTemplate(template_path)</code></li></ul><p id="7f5c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">为之前下载的word文档创建一个docx模板。</p><ul class=""><li id="6627" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">workbook[“Input”]</code></li></ul><p id="b35c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">您需要指定excel表的sheet_name。</p><ul class=""><li id="a596" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">to_fill_in</code></li></ul><p id="9261" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated"><em class="on">这是一个空字典，其关键字与excel文件的第一列相匹配。现在，您分配空值(None ),这些值将在下一步中使用excel文件填充。</em></p><h1 id="fb3c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">用Python写一个循环</h1><p id="c7dc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，您希望使用Python来遍历所有参数及其各自的数据。</p><p id="22be" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">随后，使用Python填充word模板，并使用company name属性保存它们。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c730" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">分步代码解释:</p><ul class=""><li id="52fa" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">column = 2</code></li></ul><p id="a80c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">这是将在第一次迭代中读取的列。因为第一列定义了输入参数，所以第二列是包含实际数据的列。</p><ul class=""><li id="de31" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">while column ≤ worksheet.max_column</code></li></ul><p id="70f0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">虽然当前列不是最大列(或最后一列)，但我们应该继续迭代/创建已填充的模板。</p><ul class=""><li id="339b" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">col_index = chr(column+64)</code></li></ul><p id="fe37" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">将列号转换为字符<code class="fe ny nz oa nl b">(64 + 2 = B)</code></p><ul class=""><li id="773d" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">用于键入<code class="fe ny nz oa nl b">to_fill_in</code> : …</li></ul><p id="33af" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">对于字典中定义的每个参数:为当前<code class="fe ny nz oa nl b">col_index</code>和<code class="fe ny nz oa nl b">row_index</code>分配excel表的值。</p><ul class=""><li id="e9d2" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">template.render(to_fill_in)</code></li></ul><p id="81f0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">使用render函数根据创建的词典填充单词模板。</p><ul class=""><li id="b1ed" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><code class="fe ny nz oa nl b">template.save(filled_path)</code></li></ul><p id="3cf3" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nu mc md me nv mg mh mi nw mk ml mm im bi translated">您将创建的模板保存在指定的路径上，其名称包含参数“Company_Name”</p><h1 id="7301" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">恭喜</h1><p id="0ed2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，您已经编写了第一个模板填充程序。您可以尝试不同的模板并添加更多的参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/409e886805fa98852b0af6cbdda8d6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*F4klfYn4dp9fuU9QBTRb9A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出示例</p></figure><h2 id="78d5" class="np la it bd lb ob oc dn lf od oe dp lj ma of og ll me oh oi ln mi oj ok lp ol bi translated">完整代码</h2><p id="0bde" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以在这个<a class="ae ky" href="https://colab.research.google.com/drive/1V_jEt17JGCdHZ1HRHA06AbwdK4iauLtY?usp=sharing" rel="noopener ugc nofollow" target="_blank">谷歌协作文件</a>上找到完整的代码。</p><h2 id="d6c3" class="np la it bd lb ob oc dn lf od oe dp lj ma of og ll me oh oi ln mi oj ok lp ol bi translated">你可能也会喜欢</h2><p id="32c4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请随意查看我的其他Python自动化文章:</p><ul class=""><li id="8e61" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/analytics-vidhya/convert-currencies-automatically-with-python-python-in-audit-2-6c574dbae44" rel="noopener">使用Python自动进行货币兑换</a></li><li id="778f" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/analytics-vidhya/automatically-download-e-mail-attachments-python-in-finance-3-b4670178e9a0" rel="noopener">使用Pyton自动下载电子邮件附件</a></li><li id="c144" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://pythonprogramming.medium.com/create-a-distance-matrix-in-python-with-the-google-maps-api-737dd0fc8081" rel="noopener">用Python创建距离矩阵</a></li></ul></div></div>    
</body>
</html>