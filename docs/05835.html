<html>
<head>
<title>A Better Approach to Dark Mode on Your Website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在你的网站上一个更好的黑暗模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-better-approach-to-dark-mode-on-your-website-dadbe8c55b40?source=collection_archive---------13-----------------------#2020-08-10">https://betterprogramming.pub/a-better-approach-to-dark-mode-on-your-website-dadbe8c55b40?source=collection_archive---------13-----------------------#2020-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b7c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">立即了解如何实施黑暗模式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/02816de335929870663b0fdf8ed913f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVTl2gtW7fF3QoRCnt4GQg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="97f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">黑暗模式似乎会持续下去。最初，它主要由开发人员在他们的代码编辑器中使用，但现在它无处不在，从移动设备、桌面，现在甚至是web。支持黑暗模式越来越从一个美好的必须变成一个必须。当然，这取决于你的定位，但是如果你在这里，很有可能，你想在你的站点上或者为你的客户实现黑暗模式。</p><p id="14de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当谈到网站的黑暗模式时，网络上有多种方法，我想和你谈谈两种不同的方法——其中一种是最容易实现的，第二种是我的首选，也是我实际上用来在<a class="ae lu" href="https://livecodestream.dev/" rel="noopener ugc nofollow" target="_blank"> livecodestream.dev </a>上实现黑暗模式的选项。</p><p id="9f68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从第一个选项开始。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="788e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">黑暗模式中的几行代码</h1><p id="19fa" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">第一个选项通过使用“黑暗”魔法工作:p，玩笑归玩笑，它非常简单和优雅，只包含一行CSS。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="03e1" class="ne md it na b gy nf ng l nh ni">html[data-theme='dark'] {<br/>    background: #000;<br/>    filter: invert(1) hue-rotate(180deg)<br/>}</span></pre><p id="0386" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">什么？你可能想知道这是如何工作的，你的怀疑也许是正确的，但它确实如此。在我们谈论为什么我不太喜欢这个选项之前，让我们先看看它的运行情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6f2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从例子中可以看出，它工作得非常好，但是有一个问题:它也反转了图像。这是因为filter属性还适用于图像、背景和边框。现在，通过避免图像上的变化(或者更好地说，通过反转反转?)可以很容易地解决这个问题。):</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a2f2" class="ne md it na b gy nf ng l nh ni">html[data-theme='dark'] {<br/>    background: #000;<br/>    filter: invert(1) hue-rotate(180deg)<br/>}</span><span id="5d89" class="ne md it na b gy nl ng l nh ni">html[data-theme='dark'] img {<br/>  filter: invert(1) hue-rotate(180deg)<br/>}</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e0a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不错！但是一切过渡得如此突然，让我们用一些漂亮的过渡和一些颜色让它变得更好:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a2a6" class="ne md it na b gy nf ng l nh ni">html {<br/>    transition: color 300ms, background-color 300ms;<br/>}</span><span id="444a" class="ne md it na b gy nl ng l nh ni">html[data-theme='dark'] {<br/>    background: #000;<br/>    filter: invert(1) hue-rotate(180deg)<br/>}</span><span id="cd28" class="ne md it na b gy nl ng l nh ni">html[data-theme='dark'] img {<br/>  filter: invert(1) hue-rotate(180deg)<br/>}</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="4a38" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">漂亮！它只是工作。现在，并不总是看起来很棒，在某些情况下，它可能看起来有点奇怪，我们可能希望对每种颜色有更多的控制。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d2d5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">带有CSS变量的黑暗模式</h1><p id="90fd" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">这是我在我的网站上使用的技术，效果很好。CSS允许自定义属性(变量)的定义，自定义属性是可以在CSS中用特定值定义并在整个网站中重用的实体。您可以在<a class="ae lu" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties" rel="noopener ugc nofollow" target="_blank"> MDN文档</a>上找到详细信息，但是，我们将在这里快速回顾如何创建变量以及如何使用它。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2223" class="ne md it na b gy nf ng l nh ni">:root {<br/>    --my-var: blue;<br/>}</span><span id="7a69" class="ne md it na b gy nl ng l nh ni">element {<br/>    color: var(--my-var);<br/>}</span></pre><p id="987f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很简单，要命名一个变量，我们需要在变量名前面加上<code class="fe nm nn no na b">--</code>，要使用它，我们使用函数<code class="fe nm nn no na b">var()</code>。</p><p id="db0e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们回到我们的场景，并尝试以这种方式实现黑暗模式。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="deb2" class="ne md it na b gy nf ng l nh ni">html {<br/>  --background-primary: #fff;<br/>  --color-primary: #333;<br/>}</span><span id="d62a" class="ne md it na b gy nl ng l nh ni">html[data-theme='dark'] {<br/>  --background-primary: #030303;<br/>  --color-primary: #ccc;<br/>}</span><span id="8de7" class="ne md it na b gy nl ng l nh ni">html {<br/>  transition: color 300ms, background-color 300ms;<br/>  background: var(--background-primary);<br/>  color: var(--color-primary);<br/>}</span><span id="f81b" class="ne md it na b gy nl ng l nh ni">h1, h2, p {<br/>  color: var(--color-primary);<br/>}</span></pre><p id="65e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就麻烦多了。现在，我们需要为我们网站上使用的每个元素分配我们想要的文本和背景颜色，否则，它将无法工作。但是可以让你完全控制正在发生的事情，你可以为标题、按钮、标注等等创建不同的变量。</p><p id="9c13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看一个真实的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="090c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我喜欢的黑暗模式。到目前为止，我们已经解释了事情的CSS方面，但我们还将研究JavaScript代码来进行切换，甚至将它保存在本地存储上，这样下次用户进入站点时，我们就会记住他的偏好。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3fc2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">主题切换逻辑</h1><p id="e3c8" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在让我们来研究使这种转换成为可能的JS。事实上，同样非常简单:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="83f3" class="ne md it na b gy nf ng l nh ni">const htmlEl = document.getElementsByTagName('html')[0];</span><span id="98ee" class="ne md it na b gy nl ng l nh ni">const toggleTheme = (theme) =&gt; {<br/>    htmlEl.dataset.theme = theme;<br/>}</span></pre><p id="cb97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">主题的工作方式是通过在HTML元素上应用一个数据属性，为此我们需要在变量<code class="fe nm nn no na b">htmlEl</code>中捕获元素，然后最后我们有一个接收主题名称并改变属性的函数。</p><p id="99ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是我们也想确保我们的更改被保存在浏览器中，这样我们就能记住用户下次访问我们网站时的偏好。为此，我们将使用<code class="fe nm nn no na b">localStorage</code> API。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7dba" class="ne md it na b gy nf ng l nh ni">// Capture the current theme from local storage and adjust the page to use the current theme.<br/>const htmlEl = document.getElementsByTagName('html')[0];<br/>const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;</span><span id="2c55" class="ne md it na b gy nl ng l nh ni">if (currentTheme) {<br/>    htmlEl.dataset.theme = currentTheme;<br/>}</span><span id="904c" class="ne md it na b gy nl ng l nh ni">// When the user changes the theme, we need to save the new value on local storage<br/>const toggleTheme = (theme) =&gt; {<br/>    htmlEl.dataset.theme = theme;<br/>    localStorage.setItem('theme', theme);<br/>}</span></pre><p id="23a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">搞定了。让我们看看现场直播:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d893" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="04ad" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">今天我们讨论了启用黑暗模式的两个选项；然而，在如何实现这些结果的问题上，非常有创造力的人们有更多的选择。如果你有你认为更好的解决方案，请ping我，我会添加到帖子中与他人分享(适当参考作者)。</p><p id="535d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你今天学到了一些新东西，感谢你的阅读！</p></div></div>    
</body>
</html>