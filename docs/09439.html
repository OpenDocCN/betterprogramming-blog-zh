<html>
<head>
<title>Understanding Directory Trees With Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Git理解目录树</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/understanding-directory-trees-with-git-9b245fa782a8?source=collection_archive---------5-----------------------#2021-08-25">https://betterprogramming.pub/understanding-directory-trees-with-git-9b245fa782a8?source=collection_archive---------5-----------------------#2021-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="762b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习查找和设置git目录和工作树</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a36246f0b2c9b22296c20a2d3107932d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBKtJXgZ73rLn20O_Ac5Zw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1b40" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天的主题是存储库和目录树如何在Git中工作。对于已经熟悉Git的开发人员来说，我确信在您对项目进行更改之后，典型的工作流如下所示:</p><ul class=""><li id="d581" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">运行<code class="fe md me mf mg b">git add</code>来准备您的更改</li><li id="f319" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated">运行<code class="fe md me mf mg b">git commit</code>将暂存的变更添加到本地存储库中</li><li id="76fe" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated">运行<code class="fe md me mf mg b">git push</code>将本地存储库的变更推送到远程托管站点(GitHub、Gitlab等)。)</li></ul><p id="af70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">大多数情况下，根目录是您的git目录所在的位置。然而，在某些情况下，git目录和工作树可以位于不同的位置。</p><p id="6a79" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们进入下一节，学习基本概念和一些有用的git命令，用于与git目录和<a class="ae mm" href="https://www.theserverside.com/video/Understand-the-Git-working-tree-status-command-for-easy-DVCS" rel="noopener ugc nofollow" target="_blank">工作树</a>进行交互。</p><h1 id="b8cc" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">Git命令</h1><h2 id="52e1" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">树命令</h2><p id="bd12" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">通常，您可以使用tree命令来获得当前目录的概览。您应该得到子文件夹以及以下内容:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="935e" class="nf mo it mg b gy oa ob l oc od">C:.<br/>├───config<br/>├───log<br/>├───nemo_utils<br/>├───rasa_server<br/>│   ├───actions<br/>│   │   └───__pycache__<br/>│   ├───data<br/>│   ├───models<br/>│   ├───results<br/>│   └───tests<br/>└───temp</span></pre><p id="bdc5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您也希望获得文件，Linux用户应该使用-a标志:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="ab17" class="nf mo it mg b gy oa ob l oc od">tree -a</span></pre><p id="50f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于Windows用户，首选方法是通过/F开关:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="3e7c" class="nf mo it mg b gy oa ob l oc od">tree /F</span></pre><p id="9404" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该得到以下输出:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="a53d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，隐藏文件将不包括在输出中。</p><h2 id="5597" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">ls-tree命令</h2><p id="3366" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">另一方面，Git有自己的ls-tree命令<a class="ae mm" href="https://stackoverflow.com/questions/10082514/git-ls-tree-output-of-working-directory" rel="noopener ugc nofollow" target="_blank">，它接受一个对象</a>。对象引用Git引用(每次提交时看到的散列值)。或者，您也可以使用-r HEAD:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="801d" class="nf mo it mg b gy oa ob l oc od">git ls-tree -r HEAD</span></pre><p id="11cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该在控制台上获得以下输出:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="f1e8" class="nf mo it mg b gy oa ob l oc od">100644 blob 94354120be    .gitignore<br/>100644 blob d564bc662c    README.md<br/>100644 blob 78bb05dc3c    config/mybot.conf<br/>100644 blob 93088bedcc    logging_loader.py<br/>100644 blob 1c3915e0d6    mybot.py<br/>...</span></pre><p id="072c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与tree命令不同，输出基于git跟踪的文件。任何不在追踪范围内的文件。这里不会显示gitignore。</p><p id="1569" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您试图使用如下路径:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="2635" class="nf mo it mg b gy oa ob l oc od">git ls-tree</span></pre><p id="46cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将得到以下错误:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="8d55" class="nf mo it mg b gy oa ob l oc od">fatal: Not a valid object name</span></pre><h2 id="eaeb" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">ls-files命令</h2><p id="7d08" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">或者，您可以使用ls-files命令来获取工作树中文件的信息。</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="9091" class="nf mo it mg b gy oa ob l oc od">git ls-files</span></pre><p id="3895" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认情况下，它使用-c标志，这将列出工作树中的所有缓存文件。还有一些其他选项，例如:</p><ul class=""><li id="9df2" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe md me mf mg b">-d</code> —显示删除的文件。</li><li id="0b4d" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated"><code class="fe md me mf mg b">-m</code> —显示修改过的文件。</li><li id="c152" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated"><code class="fe md me mf mg b">-o</code> —显示未跟踪的文件。</li><li id="5356" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated"><code class="fe md me mf mg b">-s</code> —显示暂存文件。</li></ul><p id="1529" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，要获取所有未跟踪的文件，可以使用以下命令:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="c981" class="nf mo it mg b gy oa ob l oc od">git ls-files -o</span></pre><h2 id="1f15" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">Git目录和工作树</h2><p id="d715" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">如果您的git目录和工作树不在同一个位置，您可能会遇到以下错误:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="87e6" class="nf mo it mg b gy oa ob l oc od">fatal: not a git repository (or any of the parent directories): .git</span></pre><p id="2487" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当您运行任何git命令时，git都会找到。当前目录下的git文件夹。如果不存在，它将继续向上搜索，直到找到一个。如果找不到，它将引发<a class="ae mm" href="https://komodor.com/blog/solving-fatal-not-a-git-repository-error/" rel="noopener ugc nofollow" target="_blank">致命错误:不是git库</a>错误。</p><p id="e546" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以通过使用以下标志显式指定git目录和工作树来轻松解决这个问题:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="3e8f" class="nf mo it mg b gy oa ob l oc od">--git-dir — path to git directory<br/>--work-tree — path to working tree</span></pre><p id="045d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，如果您的。git目录位于<code class="fe md me mf mg b">folder_a</code>中，而您的工作树位于<code class="fe md me mf mg b">folder_b</code>中，您应该使用以下命令来获取它的状态:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="ec18" class="nf mo it mg b gy oa ob l oc od">git --git-dir C:/Users/wfng/Documents/folder_a/.git --work-tree C:/Users/wfng/Documents/folder_b status</span></pre><h2 id="99bf" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">GIT_DIR和GIT_WORK_TREE环境变量</h2><p id="1018" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">还有一种方法可以将这些值设置为环境变量。您需要使用以下变量名:</p><ul class=""><li id="ff4f" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe md me mf mg b">GIT_DIR</code> — git目录</li><li id="9e7c" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt lz ma mb mc bi translated"><code class="fe md me mf mg b">GIT_WORK_TREE</code> —工作树</li></ul><p id="4675" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Linux用户应该使用export命令，如下所示:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="bb2c" class="nf mo it mg b gy oa ob l oc od">export GIT_DIR=C:/Users/wfng/Documents/folder_a/.git<br/>export GIT_WORK_TREE=C:/Users/wfng/Documents/folder_b status</span></pre><p id="008b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于Windows用户，则设置相应的命令:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="dea8" class="nf mo it mg b gy oa ob l oc od">SET GIT_DIR=C:/Users/wfng/Documents/folder_a/.git<br/>SET GIT_WORK_TREE=C:/Users/wfng/Documents/folder_b status</span></pre><h2 id="8220" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated">找到您的Git目录和工作树</h2><p id="2f33" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">如果你不知道你的git目录和工作树的确切位置会发生什么？答案是依靠rev-parse命令。对于那些不知道的人来说，git rev-parse只是git revision-parse的简称。这是一个有用的命令，主要用于操作。在这种情况下，您可以使用它来查找git目录和工作树的路径。</p><p id="2dfa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行以下命令来查找当前项目的git目录的确切位置:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="8a81" class="nf mo it mg b gy oa ob l oc od">git rev-parse --git-dir</span></pre><p id="a201" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">至于工作树，您应该使用以下命令:</p><pre class="kj kk kl km gt nw mg nx ny aw nz bi"><span id="c63a" class="nf mo it mg b gy oa ob l oc od">git rev-parse --show-toplevel</span></pre><h1 id="f3f9" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="9160" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">让我们回顾一下今天所学的内容。</p><p id="830d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文首先简要解释了git的典型工作流。然后，它指出了开发人员面临的一个常见问题:当git目录和工作树位于不同的地方时。</p><p id="9cd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，它讲述了ls-tree和ls-files命令，用于获取项目中的暂存、修改、取消跟踪和其他文件。</p><p id="85bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它进而提出了解决已确定问题的两种解决方案。第一种方法是显式设置路径，而第二种方法是通过环境变量。</p><p id="343b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，它解释了如何通过rev-parse命令获得git目录和工作树的确切路径。</p><h1 id="3493" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">参考</h1><ol class=""><li id="fbff" class="lu lv it la b lb nr le ns lh og ll oh lp oi lt oj ma mb mc bi translated"><a class="ae mm" href="https://git-scm.com/docs/git-ls-tree" rel="noopener ugc nofollow" target="_blank"> Git ls-tree </a></li><li id="6916" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt oj ma mb mc bi translated"><a class="ae mm" href="https://git-scm.com/docs/git-ls-files" rel="noopener ugc nofollow" target="_blank"> Git ls文件</a></li><li id="fcc0" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt oj ma mb mc bi translated"><a class="ae mm" href="https://git-scm.com/docs" rel="noopener ugc nofollow" target="_blank"> Git文档</a></li><li id="bc80" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt oj ma mb mc bi translated"><a class="ae mm" href="https://stackoverflow.com/questions/15798862/what-does-git-rev-parse-do" rel="noopener ugc nofollow" target="_blank">stack overflow—git rev parse做什么？</a></li><li id="b162" class="lu lv it la b lb mh le mi lh mj ll mk lp ml lt oj ma mb mc bi translated"><a class="ae mm" href="https://www.logicbig.com/tutorials/misc/git/custom-git-dir.html" rel="noopener ugc nofollow" target="_blank">Git——指定定制的Git存储库和工作树位置</a></li></ol></div></div>    
</body>
</html>