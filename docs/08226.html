<html>
<head>
<title>5 Python Code Blocks You Wouldn’t Expect at First</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你一开始不会想到的5个Python代码块</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-python-code-blocks-you-wouldnt-expect-at-first-d1c3a849c834?source=collection_archive---------12-----------------------#2021-04-07">https://betterprogramming.pub/5-python-code-blocks-you-wouldnt-expect-at-first-d1c3a849c834?source=collection_archive---------12-----------------------#2021-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="50d5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">知道引擎盖下到底发生了什么，这样你就不会感到惊讶了</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d3d640fd287248bededcbd9b83bce660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yYt3cT2g8cqEJD4B"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@marslady?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米妮周</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="2cfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python是一种流行的编程语言。它有一个非常简单的语法，接近简单的英语，通常对初学者来说很清楚。这使得Python成为目前使用最广泛的编程语言之一。</p><p id="54a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管在初学者中很常见，但一些Python设计的特性可以组合起来，并带来意想不到的可能性。很多时候，这意味着一个不受欢迎的行为，因此是一个bug。大多数习惯了经典编程语言(如C、C++、C#和Java)的程序员可能会发现下面的例子真的很令人惊讶。</p><p id="a8bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些例子也可以在Replit 上访问和执行<a class="ae ky" href="https://replit.com/@fabioveronese/PythonUnexpected" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="96f6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.猴子补丁</h1><p id="3a54" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">改变一个变量的实例，重新声明它，以及其他一些事情都是Python类型化策略的可怕后果。但是你认为重写一个给定类的方法的实现是可能的吗？并在运行时完成？也许只是在特定的情况下？这正是猴子补丁是什么，而且确实可以非常危险。</p><p id="4306" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果你知道你在做什么，它可能会让你马上修复有问题的组件，或者避免为特定的修改做公关。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你给一个公共成员赋值。这也正是您(或多或少)对方法属性所做的事情。第28行和第31行之间的区别在于，类级别的普通赋值用于所有已经存在的实例，以及从那时起的所有新实例。第31行仅对单个实例有效，另一个实例不受影响。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ff35" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.交换电话</h1><p id="7dcd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一个类嵌入了称为方法的函数，这些函数作用于实例以产生给定的结果或修改。预计您可以在给定的实例上调用这样的方法，但不能调用来自另一个类的方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0928" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际上，这里发生的是类<code class="fe nb nc nd ne b">JuiceFruit</code>是一个<code class="fe nb nc nd ne b">class</code>对象的实例。所以你可以访问它的方法，而不需要调用构造函数，只要你提供实例(<code class="fe nb nc nd ne b">self</code>参数)来操作。因为我们有duck类型，如果实例有函数需要的东西，方法运行得很好。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="343b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.纠缠</h1><p id="ba3d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">许多开发人员喜欢组织有序的代码。所以当需要声明一个常量或者一些初始化值的时候，他们更喜欢把这样一段代码放在编程单元的顶部(也就是<code class="fe nb nc nd ne b">entanglement.py</code>)。然而，当使用列表和字典时，这可能会导致意想不到的后果。</p><p id="bdc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中，这被用作一个特性。但是没有经验的程序员可能会为了顺序而错误地编写代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a03d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您所期望的是两个对象实例没有链接。没有明确的行声明这样的链接。但是如果我们更深入地分析代码，我们会发现第4行是一个浅拷贝，其中的<code class="fe nb nc nd ne b">quantic_properties</code>是一个字典。这意味着<code class="fe nb nc nd ne b">quantic_properties</code>实例在构造函数调用中被保留，并且只有引用被分配给<code class="fe nb nc nd ne b">EntangledParticle</code>字段。</p><p id="2e07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当作用于一个实例时，我们实际上改变了原始的<code class="fe nb nc nd ne b">quantic_properties</code>字典，所以所有其他的实例都会受到影响。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b7f5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">4.相同但不相同</h1><p id="be72" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python中最常见的数值类型只有<code class="fe nb nc nd ne b">int</code>和<code class="fe nb nc nd ne b">float</code>。而且通常情况下，不需要其他任何东西。但是浮点精度有<a class="ae ky" href="https://realpython.com/python-numbers/#make-python-lie-to-you" rel="noopener ugc nofollow" target="_blank">它的局限性</a>，有些时候没什么经验的开发者是不会考虑的。当比较<code class="fe nb nc nd ne b">float</code>变量和<code class="fe nb nc nd ne b">int</code>文字时，通常可以忽略的小近似值会产生有趣的效果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="4b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，当做一些严肃的数学或金融时，记得使用适当的数字类型和库。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ac4a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">5.多输入多输出</h1><p id="e93e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python函数可以声明为接受未定义数量的有序输入和命名输入。这就是<code class="fe nb nc nd ne b">*args</code>和<code class="fe nb nc nd ne b">**kwargs</code>的目的(即使名字只是一个转换，但是<code class="fe nb nc nd ne b">*</code>和<code class="fe nb nc nd ne b">**</code>在做所有的工作)。一个鲜为人知的事实是，Python为它们使用了一个简单的列表和字典，您可以用它为函数调用提供一个集合和/或一个字典。这意味着您可以使用一组可变的参数来调用该函数。</p><p id="a4e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">额外的好处是，您可以在结果上利用一个类似的特性，具有不确定数量的输出。这一次，它们以元组的形式出现，但是您也可以一次将它们赋给变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9fa6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，你要知道自己在做什么。请记住，尊重<a class="ae ky" href="https://en.wikipedia.org/wiki/Single-responsibility_principle" rel="noopener ugc nofollow" target="_blank">单一责任原则</a>总是一个更好的主意。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="48f0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">外卖</h1><p id="fd4f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python很有趣，但是在这种情况下，自由也有不好的一面:更容易失败。从这个角度来看，更传统的编程语言具有更健壮的语法，这可能会以减少自由度为代价产生更少的错误代码。</p></div></div>    
</body>
</html>