<html>
<head>
<title>How to Create a CI/CD Pipeline With Jenkins, Containers, and Amazon ECS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Jenkins、Containers和Amazon ECS创建CI/CD管道</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-ci-cd-pipeline-with-jenkins-containers-and-amazon-ecs-af4eaec75b8b?source=collection_archive---------1-----------------------#2022-06-22">https://betterprogramming.pub/how-to-create-a-ci-cd-pipeline-with-jenkins-containers-and-amazon-ecs-af4eaec75b8b?source=collection_archive---------1-----------------------#2022-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c280" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解部署示例Nodejs容器化应用程序的分步过程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d7b87d990cebfb80de38de5ea4055092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84RiLa8LNGJq2bGJBtFSvQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="097f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您仍然以传统的方式构建和交付您的软件应用程序，那么您就错过了软件开发过程或软件开发生命周期中的重大创新。</p><p id="49a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了向您展示我所说的内容，在本文中，我将分享“如何使用Jenkins、Containers和Amazon ECS创建CI/CD管道”,它可以部署您的应用程序并克服传统软件交付模型的限制。</p><p id="ca4e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这项创新极大地影响了截止日期、上市时间、产品质量等。我将带您一步步完成为一个示例Nodejs应用程序设置CI/CD Docker管道的整个过程。</p><p id="4ce3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">CI/CD管道(或持续集成持续交付)是一组自动化软件测试、构建和部署过程的指令。以下是在您的组织中实施CI/CD的一些好处。</p><ol class=""><li id="74b1" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">较小的代码变更<br/>CI/CD管道允许一次集成一小部分代码的能力有助于开发人员在大量工作完成之前发现任何潜在的问题。</li><li id="1468" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更快的交付<br/>使用CI/CD管道可以实现多个每日发布或连续发布。</li><li id="a2bc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">可观察性<br/>在开发过程的每个阶段生成大量日志的自动化有助于了解是否出现了问题。</li><li id="a716" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更容易的回滚<br/>已经部署的代码可能会有问题。在这种情况下，尽快回到以前的工作版本是非常重要的。使用CI/CD管道的最大优点之一是，您可以快速轻松地回滚到先前的工作版本。</li><li id="2ad3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">降低成本<br/>让重复性任务实现自动化可以解放开发人员和运营人员的时间，让他们可以花在产品开发上。</li></ol><p id="dab8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些只是为构建和部署使用CI/CD管道的一些好处。在这个视频中，你可以继续学习<a class="ae mi" href="https://youtu.be/ZVC4TKUCqI4" rel="noopener ugc nofollow" target="_blank"> CI/CD的好处</a>以及为什么你应该首先使用CI/CD。</p><p id="bc0f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，在我们继续使用Jenkins、Containers和Amazon ECS建立CI/CD管道之前，让我们简单地看看我们将使用哪些工具和技术。</p><h1 id="2bc0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">CI/CD Docker工具堆栈</h1><ol class=""><li id="2044" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">GitHub <br/>它是一个基于网络的应用程序或基于云的服务，人们或开发者使用Git协作、存储和管理他们的应用程序代码。我们将在这里创建并存储示例Nodejs应用程序代码。</li><li id="82a1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">AWS EC2实例<br/> AWS EC2是由Amazon Web Services提供的弹性计算机服务，用于在AWS云上创建虚拟机或虚拟实例。我们将创建一个EC2实例，并在其中安装Jenkins和其他依赖项。</li><li id="95b6" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Java <br/>这是运行Jenkins服务器所必需的。</li><li id="b8f9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">aws CLI <br/> aws-cli即AWS命令行界面是一个命令行工具，用于使用命令管理AWS服务。我们将使用它来管理AWS ECS任务和ECS服务。</li><li id="2855" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Nodejs和Npm <br/> Nodejs是一个后端JavaScript运行时环境，Npm是一个节点的包管理器。我们将为Nodejs应用程序创建一个CI/CD Docker管道。</li><li id="7cc5" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Docker <br/> Docker是一个开源的容器化平台，用于开发、运输和运行应用程序。我们将使用它来构建我们的示例Nodejs应用程序的Docker映像，并将它们推送到AWS ECR或从AWS ECR中拉出。</li><li id="2bdf" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Jenkins <br/> Jenkins是一款开源的免费自动化服务器，用于构建、测试和部署软件应用程序。我们将创建CI/CD Docker管道，使用Jenkins在AWS ECS上构建、测试和部署我们的Nodejs应用程序</li><li id="fcd6" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">AWS ECR<br/>AWS Elastic Container Registry是一个Docker映像存储库，完全由AWS管理，可以轻松存储、共享和部署容器映像。我们将使用AWS ECR来存储我们的示例Nodejs应用程序的Docker映像。</li><li id="6275" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">AWS ECS <br/> AWS弹性容器服务是一种完全由AWS管理的容器编排服务，可以轻松部署、管理和扩展容器化的应用程序。我们将使用它来托管我们的示例Nodejs应用程序。</li></ol><p id="ba3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另请参阅:<a class="ae mi" href="https://www.clickittech.com/devops/ci-cd-pipeline/" rel="noopener ugc nofollow" target="_blank">AWS、Kubernetes和Docker上的CI/CD管道和工作流</a></p><h1 id="d1d6" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">体系结构</h1><p id="15f2" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">这就是我们的架构在用Docker设置了CI/CD管道后的样子。</p><p id="41af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">成功设置CI/CD Docker管道后，我们将提交到我们的GitHub存储库，然后GitHub Webhook将触发Jenkins服务器上的CI/CD管道。然后，Jenkins Server将提取最新的代码，执行单元测试，构建docker映像，并将其推送到AWS ECR。在映像被推送到AWS ECR后，Jenkins将在AWS ECS中部署相同的映像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/7a1564f3c808d181feb11c765dc20c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yD133wPM8tTq17puxi9JHA.jpeg"/></div></div></figure><h1 id="36e0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">CI/CD工作流程和阶段</h1><h1 id="6cc7" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">工作流程</h1><p id="afe8" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">CI和CD工作流允许我们专注于开发，同时它以自动化的方式执行测试、构建和部署。</p><ol class=""><li id="9ba4" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">持续集成<br/>这允许开发人员将代码推送到版本控制系统或源代码管理系统，构建和测试开发人员推送的最新代码，并生成和存储工件。</li><li id="9964" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">连续交付<br/>这是一个让我们在任何需要的时候将经过测试的代码部署到产品中的过程。</li><li id="de09" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">连续部署<br/>这更进了一步，每次生产管道通过所有测试时，无需任何人工干预即可发布每一项变更。</li></ol><h1 id="e3d1" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">阶段</h1><p id="a408" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">自动化CI/CD管道的主要目标是构建最新的代码并进行部署。根据需要可以有不同的阶段。最常见的有以下几种:</p><ol class=""><li id="7baa" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">触发<br/>当手动执行或自动触发代码库中的特定操作时，CI/CD管道可以按照指定的时间表完成工作。</li><li id="85fd" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">代码拉取<br/>在这个阶段，每当管道被触发时，管道拉取最新的代码。</li><li id="29aa" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">单元测试<br/>在这个阶段，管道执行代码库中的测试，这也被称为单元测试。</li><li id="9da0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">构建或打包<br/>一旦所有测试都通过，流水线就向前移动，并在docker化应用的情况下构建工件或docker映像。</li><li id="c669" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">推送或存储<br/>在此阶段，如果是dockerized应用程序，已经构建的代码将被推送至artifactory或Docker存储库。</li><li id="8f2e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">验收测试<br/>这个阶段或流水线阶段验证软件的行为是否符合预期。这是一种确保软件或应用程序做它应该做的事情的方法。</li><li id="171d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">部署<br/>这是任何CI/CD渠道的最后阶段。在这个阶段，应用程序已经准备好交付或部署。</li></ol><h1 id="80f4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">部署策略</h1><p id="a5c9" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">部署策略是取下和添加微服务容器的一种方式。有多种选择。但是，我们将只讨论ECS提供和支持的功能</p><h1 id="cfb5" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">滚动更新</h1><p id="7f66" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">在滚动更新中，ECS服务中的计划程序会用新任务替换当前运行的任务。ECS集群中的任务只不过是根据任务定义创建的运行容器。部署配置控制Amazon ECS在服务中添加或删除的任务数量。</p><p id="322b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">应该运行的任务数量的下限和上限分别由<code class="fe nk nl nm nn b">minimumHealthyPercent</code>和<code class="fe nk nl nm nn b">maximumPercent</code>控制。</p><ol class=""><li id="c2e4" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">minimumHealthyPercent</code>举例:如果<code class="fe nk nl nm nn b">minimumHealthyPercent</code>的值是50，期望的任务计数是<code class="fe nk nl nm nn b">4</code>，那么调度器可以在开始两个新任务之前停止两个现有的任务</li><li id="c9d8" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">maximumPercent</code>示例:如果<code class="fe nk nl nm nn b">maximumPercent</code>的值是<code class="fe nk nl nm nn b">4</code>并且期望的任务是<code class="fe nk nl nm nn b">4 </code>，那么调度器可以在停止四个现有任务之前开始四个新任务。</li></ol><p id="9841" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想了解更多，请访问官方文档<a class="ae mi" href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/deployment-type-ecs.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="6f51" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">蓝色/绿色部署</h1><p id="9664" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">蓝/绿部署策略使开发人员能够在向新部署发送流量之前，通过安装应用程序的更新版本作为新的替换任务集来验证新部署。</p><p id="4991" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在蓝/绿部署期间，主要有三种流量转移方式。</p><ol class=""><li id="3d9a" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">金丝雀— Traﬃc以两个增量移动，在第一个增量中，Traﬃc移动到您的更新任务集的百分比，以及在第二个增量中剩余traﬃc移动之前的间隔(以分钟为单位)。</li><li id="6b49" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">线性-Traﬃc以相等的增量移动，traﬃc在每个增量中移动的百分比，以及每个增量之间的分钟数。</li><li id="cae7" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">一次全部-所有traﬃc从原始任务集一次全部转移到更新的任务集。</li></ol><p id="5578" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要了解更多信息，请访问官方文档<a class="ae mi" href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/deployment-type-bluegreen.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="bb07" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这两种策略之外，我们将在我们的演示应用程序中使用滚动更新部署策略。</p><h1 id="17ea" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">Dockerize Node.js应用程序</h1><p id="36ec" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">现在，让我们开始动手吧。</p><p id="88c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">示例Nodejs应用程序的docker文件如下。没有必要复制粘贴这个文件，它已经存在于您之前克隆的示例git存储库中。</p><p id="83f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们试着理解一下docker文件的说明。</p><ol class=""><li id="e4b6" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">这将是我们容器的基本图像。</li><li id="4f7c" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">WORKDIR /app</code> <br/>这将被设置为容器中的工作目录。</li><li id="07fd" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">ENV PATH /app/node_modules/.bin:$PATH</code>T12【路径】变量被赋予一条路径给<code class="fe nk nl nm nn b">/app/node_modules/.bin</code>。</li><li id="3592" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">COPY package.json ./</code> <br/>将Package.json复制到容器的工作目录中。</li><li id="951a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">运行npm install <br/>安装依赖项。</li><li id="c3dc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">COPY . ./</code> <br/>将主机上有依赖关系的文件和文件夹复制到容器中。</li><li id="9548" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">EXPOSE 3000</code> <br/>允许到港口300的集装箱。</li><li id="b499" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">CMD [“node”, “./src/server.js”]</code> <br/>启动应用</li></ol><p id="7957" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我们将用来创建docker映像的Docker文件。</p><h1 id="bb0e" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">设置GitHub存储库</h1><h1 id="5f55" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建新的存储库</h1><ol class=""><li id="69bf" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">转到<a class="ae mi" href="https://github.com/" rel="noopener ugc nofollow" target="_blank">https://github.com/</a>，创建一个帐户(如果你还没有的话),否则登录你的帐户并创建一个新的存储库。你可以根据自己的选择来命名；然而，我建议使用相同的名称，以避免任何混淆。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/96797b989a7c112d3af73f1bfb8a92ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XRj8QUTFk7vW4PY2"/></div></div></figure><p id="7db8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.您将看到如下屏幕，复制存储库URL并保存在手边。将这个URL称为GitHub存储库URL，并将其记录在系统的文本文件中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6f017ed23b5b05b51181206d61886ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*phOMjU5V2qdqTYXd"/></div></div></figure><p id="6c07" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:在您的系统上创建一个新的文本文件，并记下稍后需要的所有细节。</p><h1 id="6a95" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建GitHub令牌</h1><p id="e2be" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">这是身份验证所必需的。它将用于代替HTTPs上Git的密码，或者可以用于通过基本身份验证向API进行身份验证。</p><ol class=""><li id="4271" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">点击右上角的用户图标，进入“设置”，然后点击左侧面板中的“开发者设置”选项。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/11cae259434b896730326ff99269cae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tEtogUCyD6XYcJ2J"/></div></div></figure><p id="ed65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.单击“个人访问令牌”选项和“生成新令牌”来创建新令牌。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/c0b9e5d85e7e3935fbc34701efde8df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JOAkx9TUbaNRfR4e"/></div></div></figure><p id="951e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.勾选“回购”复选框，令牌将“完全控制私有存储库”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/ba70ea17f6b128d35f9b16559e1333cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DI401H3sQhvKT6q2"/></div></div></figure><p id="916e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.现在，您应该看到您的令牌已创建。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/998f0dc3818313b8d1eaa9ef93629904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0EVrwyGpVEh_zF1m"/></div></div></figure><h1 id="b6d6" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">克隆示例存储库</h1><ol class=""><li id="30b6" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">检查你现在的工作目录。<br/> <code class="fe nk nl nm nn b">pwd</code></li></ol><p id="5079" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:您位于主目录中，即/home/ubuntu。</p><ol class=""><li id="8e89" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">克隆包含所有必需代码的示例存储库。<br/> <code class="fe nk nl nm nn b">git clone <a class="ae mi" href="https://github.com/shivalkarrahul/nodejs.git" rel="noopener ugc nofollow" target="_blank">https://github.com/shivalkarrahul/nodejs.git</a></code></li><li id="ee6b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建新的存储库。此存储库将用于CI/CD管道设置。<br/> <code class="fe nk nl nm nn b">git clone <a class="ae mi" href="https://github.com/shivalkarrahul/demo-nodejs-app.git" rel="noopener ugc nofollow" target="_blank">https://github.com/shivalkarrahul/demo-nodejs-app.git</a></code></li><li id="df3e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将所有代码从我的<a class="ae mi" href="https://github.com/shivalkarrahul/nodejs.git" rel="noopener ugc nofollow" target="_blank"> nodejs </a>仓库复制到新创建的<a class="ae mi" href="https://github.com/shivalkarrahul/demo-nodejs-app.git" rel="noopener ugc nofollow" target="_blank"> demo-nodejs-app </a>仓库。<br/>T3】</li><li id="2e21" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更改您的工作目录。<br/> <code class="fe nk nl nm nn b">cd demo-nodejs-app/</code></li></ol><p id="170f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:对于本文的其余部分，不要更改您的目录。留在同一个目录中。就是这里，/home/ubuntu/demo-nodejs-app/，从这里执行所有命令。</p><ol class=""><li id="10b0" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">ls -l</code></li><li id="b9b6" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">git status</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/da74ac2d99cf5e949360ed4b5dfc85f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pAlpADvQ5Rc4veD0"/></div></div></figure><h1 id="f1e1" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">将您的第一个提交推送到存储库</h1><ol class=""><li id="4e76" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">检查您当前的工作目录；应该是一样的。在这里，/home/Ubuntu/demo-nodejs-app/<br/><code class="fe nk nl nm nn b">pwd</code></li><li id="113c" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">为git提交消息设置用户名。<br/> <code class="fe nk nl nm nn b">git config user.name “Rahul”</code></li><li id="de8a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">为您的git提交消息设置一个电子邮件。<br/> <code class="fe nk nl nm nn b">git config user.email “&lt;<a class="ae mi" href="mailto:test@email.com" rel="noopener ugc nofollow" target="_blank">test@email.com</a>&gt;”</code></li><li id="a796" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">验证您设置的用户名和电子邮件。<br/> <code class="fe nk nl nm nn b">git config –list</code></li><li id="54ef" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查状态，查看已经更改或添加到git存储库中的文件。<br/> <code class="fe nk nl nm nn b">git status</code></li><li id="7b5c" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将文件添加到git临时区域。<br/> <code class="fe nk nl nm nn b">git add</code></li><li id="ecca" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查状态，查看已经添加到git临时区域的文件。<br/> <code class="fe nk nl nm nn b">git status</code></li><li id="2baf" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">用提交消息提交文件。<br/> <code class="fe nk nl nm nn b">git commit -m “My first commit”</code></li><li id="6fb4" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将提交推送到您的远程git存储库。<br/> <code class="fe nk nl nm nn b">git push</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/312c7668e911dcdbc2044d94b15f07f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ERWcz5HxAyU5d5TR"/></div></div></figure><h1 id="5a4c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">设置AWS基础设施</h1><h1 id="0556" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建具有编程访问权限的IAM用户</h1><ol class=""><li id="1531" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">在您的AWS帐户中创建一个具有编程访问权限的IAM用户，并在文本文件中记下访问密钥和秘密密钥，以供将来参考。向用户提供管理员权限。<br/>我们不需要管理员权限。但是，为了避免权限问题，也为了演示的方便，让我们从管理员访问开始。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/2e56533cd44c36bbcbef5dacb39bf5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AtzUHXChRQCNSG7q"/></div></div></figure><h1 id="c627" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建ECR存储库</h1><ol class=""><li id="719e" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">在您的AWS帐户中创建一个ECR存储库，并在文本文件中记下它的URL，以供将来参考。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/4fb455540d2aa4ff5ee69b80c7ea73fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2Hs3Fj3K6sEHChaS"/></div></div></figure><h1 id="49a0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建ECR存储库</h1><ol class=""><li id="7a5b" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">在您的AWS帐户中创建一个ECR存储库，并在文本文件中记下它的URL，以供将来参考。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/2da99c37abebdf59346169b5027bee00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zK0UuptlpnMya93p"/></div></div></figure><h1 id="f43f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建ECS群集</h1><ol class=""><li id="3a5b" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">转到ECS控制台，单击“Get Started”创建一个群集。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/30f35c3ec11a70b8ece8f4e054f262ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IsEs5oImTlMfjvMn"/></div></div></figure><p id="5e09" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.单击“容器定义”下“自定义”选项中的“配置”按钮</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/aee2b39d7e2d386a0ba94957192ea0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QL40TZqk-E0tR2en"/></div></div></figure><p id="1adc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.将容器的名称指定为"<code class="fe nk nl nm nn b">nodejs-container</code>，" Image "文本框中的ECR储存库URL，" Port mappings "部分中的" 3000 "端口，然后点击" Update "按钮。您可以为容器指定您选择的任何名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1bc22007d322d9665ddffa0fa1d7e5ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AI2fNSL5jiUM1lqb"/></div></div></figure><p id="7824" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.现在，您可以看到您在“容器定义”下指定的详细信息单击“下一步”按钮继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/c62d69a2e6b6ddfccacae2db3de738e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vEI1f8MAsfLpvznu"/></div></div></figure><p id="2994" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">5.选择“定义您的服务”下的“应用程序负载平衡器”,然后单击“下一步”按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d072308179775586773bf8779877a486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l_5NxK-kSjVns6Kx"/></div></div></figure><p id="0b13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">6.将群集名称保留为“默认”,然后单击“Next”按钮继续。如果需要，您可以更改集群名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/69cdeba56901a2e863ed4bf544176368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2MBFr2LgL-PMkTIt"/></div></div></figure><p id="9d63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">7.查看配置，应该如下所示。如果配置匹配，则单击“创建”按钮。这将启动ECS群集创建。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/93f2ca7d5e05cc05e9867a7340b8258f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yXL2uw7nwN9DUJ9Z"/></div></div></figure><p id="e51c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">8.几分钟后，您应该已经创建了ECS群集，启动状态应该如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/2a95d06b81f878cac60b6839ce1d25a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y5YDlzMlAl0nrybr"/></div></div></figure><h2 id="973e" class="np mk it bd ml nq nr dn mp ns nt dp mt lh nu nv mv ll nw nx mx lp ny nz mz oa bi translated">创建一个EC2实例来设置Jenkins服务器</h2><ol class=""><li id="c693" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">用Ubuntu 18.04 AMI创建一个EC2实例，在其安全组中为你的IP打开它的<code class="fe nk nl nm nn b">Port 22</code>，为<code class="fe nk nl nm nn b">0.0.0.0/0</code>打开<code class="fe nk nl nm nn b">Port 8080</code>。<code class="fe nk nl nm nn b">ssh g\\\\\\\\\\\\\\\\h\</code>和<code class="fe nk nl nm nn b">8080</code>需要端口22来访问Jenkins服务器。<code class="fe nk nl nm nn b">Port 8080</code>是GitHub Webhook试图连接到Jenkins服务器的地方，因此我们需要允许它用于<code class="fe nk nl nm nn b">0.0.0.0/0</code>。</li></ol><h1 id="90bb" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在EC2实例上设置Jenkins</h1><p id="0674" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">在实例可用之后，让我们在其上安装Jenkins服务器以及所有的依赖项。</p><h1 id="c4db" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">EC2实例的先决条件</h1><ol class=""><li id="9511" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">验证操作系统是否是Ubuntu 18.04 LTS <br/> <code class="fe nk nl nm nn b">cat/</code></li><li id="9114" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查内存，最少2 GB是我们需要的。<br/> <code class="fe nk nl nm nn b">free -m</code></li><li id="bde9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">用于登录服务器的用户应该拥有sudo权限。“ubuntu”是对使用“Ubuntu 18.04 LTS”AMI创建的EC2实例具有sudo权限的用户。<br/> <code class="fe nk nl nm nn b">whoami</code></li><li id="c12d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查你现在的工作目录，它将是你的主目录。<br/> <code class="fe nk nl nm nn b">pwd</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/cf6d5c628368eb3826b1a81165e9129c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Sb1mCjY8oWg1m7Eb"/></div></div></figure><h1 id="9c06" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在EC2实例上安装Java、JSON处理器jq、Nodejs/NPM和aws-cli</h1><ol class=""><li id="9b6d" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">通过从所有已配置的来源下载软件包信息来更新您的系统。<br/> <code class="fe nk nl nm nn b">sudo apt update</code></li><li id="93fe" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">搜索安装Java 11 <br/> <code class="fe nk nl nm nn b">sudo apt search openjdk</code> <br/> <code class="fe nk nl nm nn b">sudo apt install openjdk-11-jdk</code></li><li id="9998" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">安装jq命令，JSON处理器。<br/> <code class="fe nk nl nm nn b">sudo apt install jq</code></li><li id="6177" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">安装节点js 12和NPM <br/>和T6】</li><li id="3217" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">安装AWS CLI工具。<br/> <code class="fe nk nl nm nn b">sudo apt install awscli</code></li><li id="3afb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查Java版本。<br/> <code class="fe nk nl nm nn b">java –version</code></li><li id="ba5a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查jq版本。<br/> <code class="fe nk nl nm nn b">jq –version</code></li><li id="7d35" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查Nodejs版本<br/> <code class="fe nk nl nm nn b">node –version</code></li><li id="c6e2" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">查看NPM版<br/> <code class="fe nk nl nm nn b">npm –version</code></li><li id="809a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查AWS CLI版本<br/> <code class="fe nk nl nm nn b">aws –version</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/33489e081c0490258167f46ad861efc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*izHais1FOZDr-zLc"/></div></div></figure><p id="397d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:确保您的所有版本都与上图中看到的版本相匹配。</p><h1 id="ecbf" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在EC2实例上安装Jenkins</h1><ol class=""><li id="a8b1" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">Jenkins可以从Debian库<br/> <code class="fe nk nl nm nn b">wget -q -O — <a class="ae mi" href="http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key" rel="noopener ugc nofollow" target="_blank">http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key</a> | sudo apt-key add -sudo sh -c ‘echo deb <a class="ae mi" href="http://pkg.jenkins-ci.org/debian" rel="noopener ugc nofollow" target="_blank">http://pkg.jenkins-ci.org/debian</a> binary/ &gt; /etc/apt/sources.list.d/jenkins.list’</code>安装</li><li id="a7c3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更新apt包索引<br/> <code class="fe nk nl nm nn b">sudo apt-get update</code></li><li id="ba67" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在机器上安装詹金斯<br/> <code class="fe nk nl nm nn b">sudo apt-get install jenkins</code></li><li id="30b8" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查服务状态是否正在运行。<br/> <code class="fe nk nl nm nn b">service jenkins status</code></li><li id="6324" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">你现在应该有你的詹金斯了。如果你在安装过程中遇到任何问题，你可以在这里查阅官方文档<a class="ae mi" href="https://www.jenkins.io/doc/book/installing/linux/" rel="noopener ugc nofollow" target="_blank">。</a></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/93a5ea76d085242d01c6c49f0f1de7da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IZIdosh1eDqvpKMZ"/></div></div></figure><h1 id="13cc" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在EC2实例上安装Docker</h1><ol class=""><li id="8dd3" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">安装软件包以允许apt通过HTTPS使用存储库:<br/> <code class="fe nk nl nm nn b">sudo apt-get install apt-transport-https ca-certificates curl gnupg lsb-release</code></li><li id="df6d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">添加Docker官方GPG键:<br/> <code class="fe nk nl nm nn b">curl -fsSL <a class="ae mi" href="https://download.docker.com/linux/ubuntu/gpg" rel="noopener ugc nofollow" target="_blank">https://download.docker.com/linux/ubuntu/gpg</a> | sudo gpg –dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</code></li><li id="0fbc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">设置稳定资源库<br/>和<code class="fe nk nl nm nn b">echo “deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] <a class="ae mi" href="https://download.docker.com/linux/ubuntu" rel="noopener ugc nofollow" target="_blank">https://download.docker.com/linux/ubuntu</a> $(lsb_release -cs) stable” | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</code></li><li id="a86f" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更新apt包索引<br/> <code class="fe nk nl nm nn b">sudo apt-get update</code></li><li id="e21e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">安装最新版本的Docker引擎和containerd，<br/>T3】</li><li id="3177" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查docker版本。<br/> <code class="fe nk nl nm nn b">docker –version</code></li><li id="ba54" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建一个“docker”组，这可能会退出。<br/> <code class="fe nk nl nm nn b">sudo groupadd docker</code></li><li id="c1b7" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将“ubuntu”用户添加到“docker”组<br/> <code class="fe nk nl nm nn b">sudo usermod -aG docker ubuntu</code></li><li id="e9c9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将“jenkins”用户添加到“docker”组<br/> <code class="fe nk nl nm nn b">sudo usermod -aG docker jenkins</code></li><li id="57a1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">测试你是否能使用“ubuntu”用户创建docker对象。<br/> <code class="fe nk nl nm nn b">docker run hello-world</code></li><li id="4aa3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">切换到【根用户】的<br/> <code class="fe nk nl nm nn b">sudo -i</code></li><li id="bd4a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">切换到“詹金斯”用户<br/> <code class="fe nk nl nm nn b">su jenkins</code></li><li id="25d8" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">测试您是否可以使用“jenkins”用户创建docker对象。<br/> <code class="fe nk nl nm nn b">docker run hello-world</code></li><li id="22b1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">从“詹金斯”用户<br/>退出<code class="fe nk nl nm nn b">exit</code></li><li id="59a1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">从【root】用户<br/>退出<code class="fe nk nl nm nn b">exit</code></li><li id="52b9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">现在你应该回到“ubuntu”用户了。如果你在安装过程中遇到任何问题，你可以在这里查阅官方文档<a class="ae mi" href="https://docs.docker.com/engine/install/ubuntu/" rel="noopener ugc nofollow" target="_blank">。</a></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/f001a4c8e9b156da23d36021066da3c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lvAnhQXOx85sTGsZ"/></div></div></figure><h1 id="7183" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">配置Jenkins服务器</h1><ol class=""><li id="37f2" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">安装完Jenkins后，第一步是提取其密码。<br/> <code class="fe nk nl nm nn b">sudo cat /var/lib/jenkins/secrets/initialAdminPassword</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/003657af89988a4775295cc37a6b6577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oOFUlkdPmof51RO6"/></div></div></figure><p id="2bd1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.在浏览器中点击网址<br/> <code class="fe nk nl nm nn b">Jenkins URL: http://&lt;public-ip-of-the-ec2-instace&gt;:8080</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/32b9f5dc6a16fbfcaca176cc8f55e5cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jsPpGoHxKgX2XLBb"/></div></div></figure><p id="33b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.选择“安装建议的插件”选项</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/35db7563179f285c012f036fdce0ecbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W_BESOZVJPIqkFUb"/></div></div></figure><p id="aa92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.为要创建的新管理员用户指定用户名和密码。您可以将该用户用作管理员用户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/ef5a80899a4ba3a73d3ca9da2af043c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MNIYvcLhYYVfL31d"/></div></div></figure><p id="bee5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">5.此URL字段将自动填充，单击“保存并完成”按钮继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/513469cfea777d46a2cfd64ab6b154e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T6RKqHo7QdmMvTyx"/></div></div></figure><p id="31d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">6.你的Jenkins服务器已经准备好了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/de4adf6f08770837fcb2c658ae78c2ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WXRllAKm6SCEuemU"/></div></div></figure><p id="7dda" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">7.这是它的仪表板的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e88b376fc03b623a427e80b46c5ec0d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WVYZn6O6zB4RyY6M"/></div></div></figure><h1 id="cc4a" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装插件</h1><ol class=""><li id="bcc9" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">让我们安装所有我们需要的插件。单击左侧面板中的“管理Jenkins”。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/3e8971edc242986f02a23ea3339e7cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2CHjGcS_zXtLFwBL"/></div></div></figure><p id="b3db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.这是我们需要安装的插件列表</p><ol class=""><li id="ced6" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><a class="ae mi" href="https://plugins.jenkins.io/aws-credentials/" rel="noopener ugc nofollow" target="_blank"> CloudBees AWS凭证</a> : <br/>允许存储Amazon IAM凭证，即Jenkins凭证API中的密钥。</li><li id="8531" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae mi" href="https://plugins.jenkins.io/docker-workflow" rel="noopener ugc nofollow" target="_blank"> Docker Pipeline </a> : <br/>这个插件允许构建、测试和使用来自Jenkins Pipeline的Docker映像。</li><li id="4106" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae mi" href="https://plugins.jenkins.io/amazon-ecr" rel="noopener ugc nofollow" target="_blank">亚马逊ECR </a> : <br/>该插件提供了与AWS弹性容器注册中心(ECR) <br/>的集成用法:</li><li id="2257" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae mi" href="https://plugins.jenkins.io/pipeline-aws/" rel="noopener ugc nofollow" target="_blank"> AWS步骤</a> : <br/>该插件添加了Jenkins管道步骤，以与AWS API进行交互。</li></ol><p id="ed59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.在“可用”标签中，搜索所有这些插件，然后点击“无需重启即可安装”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d5b3f04d7bd8eaf68343451f7dc86175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jQ9_1gll2nVevsnb"/></div></div></figure><p id="c2e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.插件成功安装后，您将看到如下屏幕。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6cede822a9f342a62a8fe226b7198ffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5idDJzalZAjF1lez"/></div></div></figure><h1 id="b3e5" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在Jenkins中创建凭证</h1><ol class=""><li id="71f4" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated"><a class="ae mi" href="https://plugins.jenkins.io/aws-credentials/" rel="noopener ugc nofollow" target="_blank"> CloudBees AWS凭据</a>插件将在此提供帮助。转到“管理Jenkins”，然后点击“管理凭据”</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6490035ef5754178a3e679ee66917c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7od4mNGt4Ygo9N9D"/></div></div></figure><p id="5460" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.点击“(全球)。”"添加凭据。"</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6fe418da0f19fc2606e2446141236d0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_5WkmMoSltTcfwmF"/></div></div></figure><p id="dc41" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.选择种类作为“AWS凭证”，并提供ID作为“演示-管理-用户”。这可以根据您的选择来提供，在文本文件中记下这个ID。指定我们在前面步骤中创建的IAM用户的访问密钥和秘密密钥。</p><p id="883e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">单击“确定”以存储IAM凭据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6bdf7a7c1b1575212a07db7995994760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sm8iEJCIMZj_0nv_"/></div></div></figure><p id="a0ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.遵循相同的步骤，这次选择“带密码的用户名”来存储我们之前创建的GitHub用户名和令牌。</p><p id="fe54" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击“确定”保存GitHub凭证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/f9d2df1c4a84f30710e4a4e0ccaaeff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zwk9n0gzafNevjbD"/></div></div></figure><p id="9a7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">5.现在，您的Jenkins中应该有IAM和GitHub凭据了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/a74bbce2fdf935f934c4c732bf94ba7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tAfNS6EbiYUTcjxc"/></div></div></figure><h1 id="6043" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建Jenkins作业</h1><ol class=""><li id="8a1a" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">转到主仪表板，点击“新项目”创建一个詹金斯管道。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/caf2960153f46ef1e798d773392ccf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kx5SCVXZeHcOi_r0"/></div></div></figure><p id="6e58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.选择“Pipeline”并将其命名为“demo-job ”,或者提供您选择的名称。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/3ee57c26e04925c88f084c76a3bde937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ys8cTrVTl5XrtjmM"/></div></div></figure><p id="3ff6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.勾选“常规”选项卡下的“GitHub项目”复选框，提供我们之前创建的GitHub资源库的URL。另外，勾选“构建触发器”标签下的“GitHub hook Trigger for GitScm polling”复选框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/7ceadb1599cc7b7fdd8eb1119eb38438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s2g3WwuG21Ectz0d"/></div></div></figure><p id="22dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.在“Pipeline”选项卡下，选择“来自SCM的管道脚本”定义，指定我们的存储库URL，并选择我们为GitHub创建的凭证。检查分支名称是否与您将用于提交的名称匹配。</p><p id="8f25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">查看配置并单击“保存”以保存您对管道的更改。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/17d44a7b57e65673f8923e2fa0e13d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eAno4snwD_nseIBn"/></div></div></figure><p id="a965" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">5.现在，您可以看到我们刚刚创建的管道。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/0b6680c5032cfbb8c44b577815952028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rmxRg78i3PUQDeXS"/></div></div></figure><h1 id="55ce" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">集成GitHub和Jenkins</h1><p id="4449" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">下一步是将GitHub与Jenkins集成，这样每当GitHub存储库上有事件时，它就可以触发Jenkins作业。</p><ol class=""><li id="9d9e" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">转到存储库的settings标签，点击左边面板中的“Webhooks”。你可以看到“添加网页挂钩”按钮，点击它创建一个网页挂钩。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e7aa108dfe27b3c6b54fea836041dbc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ib-9XPAWn-ccxUtz"/></div></div></figure><p id="3952" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.提供带有上下文的Jenkins URL，如“/github-webhook/”。该URL将如下所示。</p><p id="ada9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">web hook URL:http://<jenkins-ip>:8080/github-web hook/<br/>您可以选择自己喜欢的事件。然而，为了简单起见，我选择了“把所有东西都发给我”</jenkins-ip></p><p id="3124" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">确保选中“活动”复选框。</p><p id="a73e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击“Add webhook”创建一个webhook，每当GitHub存储库中有任何类型的事件时，它都会触发Jenkins作业。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/f63fd9fee65d72958ef47bd0e165e495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qnDOJhN9EYVINPf_"/></div></div></figure><p id="a870" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.你应该看看你的网钩。单击它以查看它是否已被正确配置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e08959324b5ece909aaf9ebca44070ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gjdTRc9x7FMSFfxZ"/></div></div></figure><p id="818a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.点击“最近交付”标签，你应该会看到一个绿色的勾号。绿色勾号表示webhook能够连接到Jenkins服务器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/eb10da63ea63b2056b1e04efe312f19b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tnQVOlVvOmyqeoYW"/></div></div></figure><h1 id="ca57" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">将Nodejs应用程序部署到ECS集群</h1><p id="85b6" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">在我们从GitHub Webhook触发管道之前。让我们尝试手动执行它。</p><h1 id="cf79" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">手动构建作业</h1><ol class=""><li id="79c8" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">转到我们创建的作业并构建它。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/97f68c7abd74b9c372e375ec4dc27415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZNdAqrMfBHSvJiKN"/></div></div></figure><p id="526a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.如果您查看它的日志，您会发现它失败了。原因是，我们还没有给Jenkinsfile中的变量赋值。</p><h1 id="bc36" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">推动您的第二次提交</h1><p id="d8cd" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">提醒:在本文的其余部分，不要更改您的目录。呆在同一个目录下，即/home/ubuntu/demo-nodejs-app，从这里执行所有命令。</p><h2 id="9aac" class="np mk it bd ml nq nr dn mp ns nt dp mt lh nu nv mv ll nw nx mx lp ny nz mz oa bi translated">为Jenkinsfile中的变量赋值</h2><ol class=""><li id="903f" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">为了克服上述错误，您需要对Jenkinsfile进行一些更改。该文件中有变量，我们需要为这些变量赋值，以便将我们的应用程序部署到我们创建的ECS集群中。将正确的值赋给具有“CHANGE_ME”的变量<br/>卡特彼勒詹金斯文件</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/91e507401fcc7686886fa8d49ae9086c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mhIyCF9VcVd2o3h1"/></div></div></figure><p id="13ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.为了方便起见，这里列出了一些变量。<br/>我们在Jenkinsfile中有以下变量。</p><ol class=""><li id="3d79" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">AWS_ACCOUNT_ID=”CHANGE_ME”</code> <br/>在此分配您的AWS账号。</li><li id="0f17" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">AWS_DEFAULT_REGION=”CHANGE_ME”</code> <br/>分配您创建ECS集群的区域</li><li id="d288" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">CLUSTER_NAME=”CHANGE_ME”</code> <br/>指定您创建的ECS集群的名称。</li><li id="8dda" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">SERVICE_NAME=”CHANGE_ME”</code> <br/>分配在ECS集群中创建的服务名。</li><li id="d458" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">TASK_DEFINITION_NAME=”CHANGE_ME”</code> <br/>分配在ECS集群中创建的任务名称。</li><li id="ab7e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">DESIRED_COUNT=”CHANGE_ME”</code> <br/>分配您想要在ECS集群中创建的任务数量。</li><li id="a742" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">IMAGE_REPO_NAME=”CHANGE_ME”</code> <br/>分配ECR存储库URL</li><li id="5f74" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">IMAGE_TAG=”${env.BUILD_ID}”</code> <br/>不改此道。</li><li id="bfb4" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">REPOSITORY_URI = “${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_DEFAULT_REGION}.amazonaws.com/${IMAGE_REPO_NAME}”</code> <br/>不改变这一点。</li><li id="36ca" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><code class="fe nk nl nm nn b">registryCredential = “CHANGE_ME”</code> <br/>指定您在Jenkins中创建的凭证的名称，以存储AWS访问密钥和秘密密钥</li></ol><p id="3361" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.检查状态以确认文件已被更改。<br/> <code class="fe nk nl nm nn b">git status</code> <br/> <code class="fe nk nl nm nn b">cat Jenkinsfile</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/558465b28a4fddce80e5d770453ec0a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yj-uRS82fFxa1DKj"/></div></div></figure><p id="3185" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.向git staging区域添加一个文件，提交它，然后将其推送到远程GitHub存储库。<br/><code class="fe nk nl nm nn b">git status</code><br/><code class="fe nk nl nm nn b">git add Jenkinsfile </code><br/><code class="fe nk nl nm nn b">git commit -m “Assigned environment specific values in Jenkinsfile”</code><br/>T5】</p><h1 id="963e" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">Jenkins服务器出错</h1><p id="2713" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">在提交之后，Jenkins管道将被触发。</p><p id="4a80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，在您的Jenkins作业中，您将会看到一个错误“<em class="oc">在尝试连接到UNIX:///var/run/Docker . sock</em>的Docker守护进程套接字时权限被拒绝”。</p><p id="05b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">原因是jenkins作业使用的“Jenkins”用户不允许创建docker对象。为了向“jenkins”用户授予权限，我们在上一步中将其添加到了“docker”组中。但是，之后我们并没有重启Jenkins服务。</p><p id="efb5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我特意保留了这一点，以便向您展示将“jenkins”用户添加到EC2实例中的“docker”组的必要性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/151e83a6458755d26e6fdedfd45eaf37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u5_xrDrHPSi-2sQv"/></div></div></figure><p id="36b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在你知道需要做什么来克服上述错误。</p><ol class=""><li id="bf92" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">重新启动Jenkins服务。<br/> <code class="fe nk nl nm nn b">sudo service jenkins restart</code></li><li id="8913" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查Jenkins服务是否已经启动。<br/> <code class="fe nk nl nm nn b">sudo service jenkins status</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/cd4f35765d1177b978fa3c0737af1bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IQVN4Ns4ZVviFdjW"/></div></div></figure><h1 id="eda7" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">推动你的第三次提交</h1><ol class=""><li id="4e8d" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">在README.md中做一些修改，以提交、推送和测试管道是否被自动触发。<br/> <code class="fe nk nl nm nn b">vim README.md</code></li><li id="24ee" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">添加、提交和推送文件。<br/><code class="fe nk nl nm nn b">git status</code><br/><code class="fe nk nl nm nn b">git diff README.md</code><br/><code class="fe nk nl nm nn b">git add README.md</code><br/><code class="fe nk nl nm nn b">git commit -m</code>“修改README.md重新启动Jenkins服务后触发Jenkins作业”<br/> <code class="fe nk nl nm nn b">git push</code></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/da3392a374a8528d4122e81165182d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TTihvworJwATEpws"/></div></div></figure><p id="aa88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.这一次，您可以观察到作业一定是自动触发的。去詹金斯工作，并验证相同的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/0230afb5aaa8949b19f88192d2c594ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b1KCenXS7O-5BL1X"/></div></div></figure><p id="59b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.这就是舞台视图的样子。它显示了我们在Jenkinsfile中指定的阶段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/ddb34364dcb5445ba7cfb8ba6e72244a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PGIbT83javCbZXSq"/></div></div></figure><h1 id="c0a3" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">检查ECS群集中任务的状态</h1><ol class=""><li id="d57a" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">转到集群，点击“任务”选项卡，然后打开正在运行的“任务”</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/9e71487d99bd74d1a7f874a29512031f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uNce0CLAd3jNhR6T"/></div></div></figure><p id="6047" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.单击“JSON”选项卡并验证图像，图像标签应该与Jenkins版本号匹配。在这种情况下，它是“6 ”,与我的Jenkins职务构建号相匹配。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/75d4fba89577eb63196892fdf4b4e1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vwwsr4FcDD3ffBdJ"/></div></div></figure><p id="28c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.点击ELB URL检查Nodejs应用程序是否可用。点击ELB网址后，您应该会在浏览器中看到如下消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d45cb28bae7d70e122976dc88d51e802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HO-wzHVqfdng5CyF"/></div></div></figure><h1 id="bcc0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">推动你的第四次提交</h1><ol class=""><li id="5139" class="lu lv it la b lb nb le nc lh nd ll ne lp nf lt lz ma mb mc bi translated">打开"<code class="fe nk nl nm nn b">rc/server.js</code>文件并在显示消息中进行一些更改，以再次测试CI/CD管道。<br/> <code class="fe nk nl nm nn b">vim src/server.js</code></li><li id="029a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查已更改的文件。在这种情况下，只能看到一个文件被更改。<br/> <code class="fe nk nl nm nn b">git status</code></li><li id="81bc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查您的更改在文件中造成的差异。<br/> <code class="fe nk nl nm nn b">git diff src/server.js</code></li><li id="25ff" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将您更改的文件添加到git临时区域。<br/> <code class="fe nk nl nm nn b">git add src/server.js</code></li><li id="8685" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查本地存储库的状态。<br/>T3】</li><li id="5088" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">向提交添加消息。<br/> <code class="fe nk nl nm nn b">git commit -m</code>【更新欢迎词】</li><li id="6f34" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将您的更改推送到远程存储库。<br/>T5】</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1395306ca0f8325ee1074d0f42a40f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qZxWe93_RjhpeKpp"/></div></div></figure><p id="2393" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">8.转到任务，这次您将看到两个任务正在运行。一个版本较旧，一个版本较新。由于集群中默认配置的滚动更新部署策略，您会看到两个任务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/369ed7dc1f286ac9e45814f8f569a2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-7RqpU2nLVgZqhbz"/></div></div></figure><p id="1fa6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:您的修订号可能会有所不同。</p><p id="9e48" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">9.等待大约2-3分钟，您应该只能运行一个带有最新版本的任务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/72d540f49cb2bbadb430af4e66265f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YSpAxT1GU8yY6qtV"/></div></div></figure><p id="4b1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">10.再次，点击ELB的网址，你应该会看到你的变化。在这种情况下，我们更改了显示消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/2c4b7d384045f87e575d3514d19e76b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nwZ3Qfh5GdZe6oJj"/></div></div></figure><p id="b717" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">恭喜你！每当您的源代码发生变化时，您都可以使用Jenkins CI/CD管道在AWS ECS上部署Nodejs容器化应用程序。</p><h1 id="0d95" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">清理我们创建的资源</h1><p id="b8b9" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">如果您只是尝试建立CI/CD管道以熟悉它，或者出于POC目的而在您的组织中不再需要它，最好删除您在执行POC时创建的资源。作为CI/CD渠道的一部分，我们创建了一些资源。</p><p id="a41b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们创建了以下列表来帮助您删除它们:</p><ol class=""><li id="9f26" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">删除GitHub存储库</li><li id="cd0b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除GitHub令牌</li><li id="8678" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除IAM用户</li><li id="96b2" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除EC2实例</li><li id="e568" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除ECR存储库</li><li id="a29e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除ECS集群</li><li id="59e4" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">取消注册任务定义</li></ol><h1 id="5176" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">摘要</h1><p id="bc01" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">最后，这里总结了使用Jenkins设置CI/CD Docker管道以在AWS ECS上部署示例Nodejs应用程序需要做的工作。</p><ol class=""><li id="3b60" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">克隆现有的示例GitHub存储库</li><li id="0a50" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建一个新的GitHub存储库，并将示例存储库中的代码复制到其中</li><li id="13b1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建GitHub令牌</li><li id="a236" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建IAM用户</li><li id="31e3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建ECR存储库</li><li id="fce4" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建ECS群集</li><li id="a179" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建一个EC2实例来设置Jenkins服务器</li><li id="8ecc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在EC2实例上安装Java、JSON处理器jq、Nodejs和NPM</li><li id="8a01" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在EC2实例上安装Jenkins</li><li id="3fef" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在EC2实例上安装Docker</li><li id="1b99" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">安装插件</li><li id="ad58" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在Jenkins中创建凭证</li><li id="4d23" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建Jenkins作业</li><li id="e19e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">集成GitHub和Jenkins</li><li id="50bc" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查部署</li><li id="8deb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">清理资源</li></ol><h1 id="9537" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="4e9d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh ng lj lk ll nh ln lo lp ni lr ls lt im bi translated">CI/CD管道是自动化软件应用程序的构建、测试和部署的一种方式。它是任何具有DevOps文化的组织的支柱。它对软件开发有许多好处，并极大地促进了您的业务。</p><p id="8d87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们演示了创建Jenkins CI/CD Docker管道的步骤，以便在AWS ECS上部署一个示例Nodejs容器化应用程序。我们看到了如何使用GitHub Webhooks在每次推送到存储库时触发Jenkins管道，进而将最新的docker映像部署到AWS ECS。</p><p id="b946" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Docker的CI/CD管道最适合您的组织来提高代码质量和快速交付软件版本，而没有任何人为错误。</p><p id="31a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们希望这篇文章能帮助您更多地了解CI/CD Docker管道的组成部分。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="9b24" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="oc">原帖:</em>【https://www.clickittech.com/devops/ci-cd-docker/?】<em class="oc">UTM _ source = ci+CD+docker&amp;UTM _ id = Blogs+medium</em>T5】</p></div></div>    
</body>
</html>