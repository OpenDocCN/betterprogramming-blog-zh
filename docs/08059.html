<html>
<head>
<title>Adding a Tip Jar in SwiftUI Using RevenueCat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RevenueCat在SwiftUI中添加小费罐</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/adding-a-tip-jar-with-revenuecat-in-swiftui-717a0d4b60c?source=collection_archive---------0-----------------------#2021-03-20">https://betterprogramming.pub/adding-a-tip-jar-with-revenuecat-in-swiftui-717a0d4b60c?source=collection_archive---------0-----------------------#2021-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="06b3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">掌握整合应用内购买的流程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7b2bee75b8e3fa9a28ecc516fb051a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hlFY8sdXF_JDfWIi"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">萨姆·丹·张在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="09f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想玩玩<a class="ae kv" href="https://www.revenuecat.com/" rel="noopener ugc nofollow" target="_blank"> RevenueCat </a>，我认为创建一个小费罐将是一个完美的开始。所以我昨天午夜坐下来，通读了托马斯·里库德的这篇文章:</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/swlh/swiftui-in-app-purchases-and-revenuecat-abfe0478ca71" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">SwiftUI、应用内购买和RevenueCat</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">如何在SwiftUI应用中实施应用购买和订阅</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="942b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在阅读了它以及RevenueCat的文档之后，我可以给我的渐变游戏添加一个提示罐了！</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="e539" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">灵感</h1><p id="59df" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">我从Apollo的提示屏幕开始灵感——最好的Reddit客户端。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/8f79f8ae83ac6a5767d79ffa505f630d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRqioiXMCZaTfbH5QNhviQ.png"/></div></div></figure><p id="6d7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于此，我决定创建三层技巧:</p><ul class=""><li id="42d1" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated">对咖啡的热爱——基本建议</li><li id="8774" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">喜欢千层面——一个大建议</li><li id="882f" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">对披萨的热爱——巨额小费</li></ul></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="b170" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">App Store连接</h1><p id="8161" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">我将它们添加到App Store Connect应用程序的应用内购买部分:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/9aed4a3cc79663cfa3fbfe6efad2c076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67IYbPZzSYGP3Etq0iEsrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">小费的IAP</p></figure><p id="a98c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我必须为审查过程提供参考名称、产品ID、定价、显示名称、描述和屏幕截图(强制)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/cd6921f137ab656eccbe1cdeae192b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtHwh6xkTB-F-WSaqBG8lw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">为IAP提供信息</p></figure><p id="2d53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，您必须首先创建一个IAP，通过将其添加到构建中来获得批准，然后添加更多的IAP。我犯了第一次添加所有内容的错误，我的应用程序被拒绝，因为第一个没有被批准。</p><p id="1cf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在获得第一个IAP批准后(撰写本文时已上线)，我添加了更多。</p><p id="7e65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就结束了App Store连接端。是时候进入RevenueCat了！</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="088b" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">RevenueCat</h1><p id="69c5" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">创建账号登录后，我添加了渐变游戏作为app。在“产品”下，使用与App Store Connect上相同的标识符添加它。现在，为它们添加授权，并将它们附加到相应的产品。</p><p id="48a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此之后，我对是否应该添加“供品”感到困惑。在文档中，例子是订阅。我下载了样本SwiftUI项目以了解他们是如何做的，然后基于此，我也创建了一个产品。</p><p id="a49c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我创建了一个默认产品，并向其中添加了三个包，每个包对应于我之前制作的产品。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/8aa5a03c7032bf9c4da9335684144274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbaQBICekh40VtMxh1QBNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">RevenueCat上的产品屏幕</p></figure><p id="9e87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时，我已经完成了App Store Connect和RevenueCat上的IAP处理。我们写点代码吧！</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="1c2b" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">SwiftUI和一些代码</h1><p id="ab89" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">我从一个名为<code class="fe og oh oi oj b">IAPManager</code>的单例类开始(类似于上面提到的文章中出现的内容):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="4222" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我配置了购买框架，并获得了所有可用的产品。我添加了一个方法来根据用户的选择购买特定的包。</p><p id="d07c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于视图，我循环查看了包，并显示了基于包的描述:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5b38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！我成功地在我的应用中添加了一个小费罐！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/2993420bd2ba38c848f3bff4c96859df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpU0iYTHCmwcTVEHjodkXA.png"/></div></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="24a7" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">结论</h1><p id="1696" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">与StoreKit相比，使用RevenueCat是一件轻而易举的事情。对于添加一个普通的可消耗/不可消耗的IAP，没有太大的区别。但对于订阅，我会选择RevenueCat。过去，我在使用StoreKit的可更新订阅时做了一些噩梦，我希望有人来处理收据，而我则致力于为这种经常性订阅提供最佳价值。</p><p id="aff6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这篇文章！如果你有任何问题，可以在评论区留言。</p></div></div>    
</body>
</html>