# 你应该使用反冲作为一个反应状态管理库吗？

> 原文：<https://betterprogramming.pub/should-you-use-recoil-as-a-react-state-management-library-38ef14f3de10>

## 看一看脸书开发的新的反应状态管理库

![](img/be786895b1d23c38f198a9b9c0752510.png)

照片由[卡罗琳娜·加西亚·塔维松](https://unsplash.com/@karock12?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

脸书的人最近向我们介绍了一个新的 React 状态管理库。叫做[后坐力](https://recoiljs.org/)。

看到新的解决方案总是令人兴奋的，但确实会想到一个问题:我们真的需要它吗？已经有成熟的解决方案——Redux、MobX 和许多其他解决方案——我们需要一个新的吗？

对许多人来说，答案是否定的。但是让我们来了解一下什么是后坐力，它能解决什么样的问题。

# 什么是后坐力？

反冲是 React 的一个状态管理库，由脸书的 Dave McCabe 开发。

反冲有两个核心概念:原子和选择器。

原子是一种状态。您可以通过定义缓存键并传递默认数据来创建 atom。您的组件可以消耗原子并订阅对它的更改。和 React 的`useState`差不多。

选择器用于派生数据。它们类似于原子。在这里你可以消耗原子和其他选择器。此外，还可以在选择器中执行异步操作。其余与原子相同。您的组件可以消费和订阅对它们的更改。

# 如何使用它

让我们看几个例子来理解它的用法。

首先，将您的应用程序包装在`RecoilRoot`提供程序中。

接下来，创建一个原子，如下所示:

然后，在任何组件中使用这个原子，并为其设置数据。

当您需要一个派生数据时，创建一个选择器，如下所示:

然后你就可以像使用原子一样使用它了。唯一的区别是`useRecoilValue`而不是`useRecoilState`。

# 后坐力有什么好处？

在这一点上，你可能想知道仅仅使用旧的`useState`和使用后坐力有什么区别。看起来一模一样。也可能你在想，相比 Redux 的优势在哪里。

当您需要在多个组件中共享一个状态时，以及当您面临与此相关的性能问题时，反冲的力量就来了。

当你需要分享一部分状态时，你可以提升状态，就像官方 React [文档](https://reactjs.org/docs/lifting-state-up.html)中推荐的那样。如果使用 Redux，您不需要做任何事情，因为您的整个应用程序共享一个全局状态。

这两种方法的问题是不必要的渲染。当您提升状态时，所有子组件都会重新呈现。在 Redux 中，如果你在一个大的容器组件下放置很多东西，整个应用程序或页面可能会重新呈现。这对于大多数应用程序来说是没问题的，但是对于有些应用程序来说就不太好了。

举个例子，看看一些绘图应用程序，比如[diagrams.net](https://app.diagrams.net/)。屏幕上有许多单独的部分，它们都有一些状态和需要访问这些状态的其他组件。整个重新渲染太昂贵了。您需要找到一种仅在状态改变时重新渲染的方法。

您可以用传统的方法实现这一点，但是一般来说，它们太费力了，尤其是对于大型应用程序。

反冲是来帮助你的。一个原子是一个独立的状态。您的组件可以订阅一个 atom——当值改变时，只有相关的组件被重新呈现。

它为您提供了统一的状态共享方式，并在幕后解决了性能问题。它用一个简单的 API 完成所有这些。您不需要像在 Redux 中那样编写大量样板代码。

观看以下视频，了解更详细的解释。

# 成本

在撰写本文时，v0.0.8 是当前版本。它花费你[8.3 KB gzip](https://bundlephobia.com/result?p=recoil@0.0.8)。

# 该不该用？

虽然这个库很棒，但是大多数应用程序并没有从它的强大功能中受益。每一个新的解决方案都会让人兴奋，人们希望尽快尝试并投入其中。但与其这样做，不如退一步看看你*是否真的需要它。*

重要的是要理解反冲是为了什么而产生的。如果您面临上述性能问题，反冲是一个很好的选择。否则，你真的不需要它——继续使用内置的 React 解决方案和你喜欢的任何东西。

也可以部分使用后坐力。您的应用程序不需要完全依赖它。如果你看到一个特定的地方可以从中受益，就在那里使用它。没有必要疯狂地重构整个应用程序。

它还提供了一些很酷的特性，比如时间旅行、持久状态等等。但是，你的应用程序真的需要这些功能吗？

# 资源

[](https://recoiljs.org/) [## 报应

### React 反冲工程的状态管理库。添加一些到您的应用程序，获得快速和灵活…

recoiljs.org](https://recoiljs.org/) [](https://reactjs.org/docs/lifting-state-up.html) [## 提升状态向上-反应

### 通常，几个组件需要反映相同的变化数据。我们建议将共享状态提升到它们的…

reactjs.org](https://reactjs.org/docs/lifting-state-up.html)