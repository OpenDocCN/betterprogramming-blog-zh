<html>
<head>
<title>Build Advanced Machine Learning Models With OpenAI’s API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenAI的API构建高级机器学习模型</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/break-into-advanced-machine-learning-with-openai-api-fd9307bc9403?source=collection_archive---------0-----------------------#2022-03-26">https://betterprogramming.pub/break-into-advanced-machine-learning-with-openai-api-fd9307bc9403?source=collection_archive---------0-----------------------#2022-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="df05" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用几行代码过渡到机器学习</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b5d4e379054b9188b2b023d6ab4254c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DvtipZUH7bdylay005SHzQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">可扩展性—设计的映像</p></figure><p id="c0a7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">OpenAI发布了一个API，允许研究人员和开发人员基于论文“语言模型是很少的学习者”用几行代码构建高级的GPT 3机器学习模型。</p><p id="10a9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该API可以轻松地开始与最先进的GPT3模型进行交互。高级用户可以根据业务用例或用户的定制语言对模型进行微调。</p><h1 id="4c00" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">让我们建立一个模型来回答美国宇航局太阳系的事实</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/b854e1e8837b6bb2ce1a69e9df70c029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C26KKHYh85RCnkSsyHJFiQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:nasa.gov——参考文献中的许可证</p></figure><p id="e689" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我试图用GPT3建立一个机器学习模型，来回答美国宇航局网站上关于“<em class="mk">太阳系</em>10件需要知道的事情”的问题。模型结果令人兴奋，本博客将与您一起逐步构建高级问答模型。</p><p id="8c42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">模型令人兴奋的结果的一个例子:我问模型在我们的太阳系中有多少颗行星，它通过查看这一段成功返回“8”:“<em class="mk">我们的太阳系由一颗恒星、八颗行星和无数较小的天体组成，如矮行星、小行星和彗星</em>”。</p><p id="6f81" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管它看起来像是直观的信息，但该模型从给定的段落中自己学习了答案，其中包括多个细节。</p><p id="1239" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当被问及这个模型需要多少年才能完成一个环绕银河系的轨道时？它从这一段返回“2.3亿年”:</p><p id="e2ad" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mk">我们的太阳系大约需要2.3亿年绕银河系中心运行一周。</em></p><p id="7474" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是目标NASA文章的<a class="ae ml" href="https://solarsystem.nasa.gov/solar-system/our-solar-system/overview/" rel="noopener ugc nofollow" target="_blank">链接</a>。我在2022年10月更新了博客，以应对最新的openai API变化。</p><h1 id="0f7d" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">打开人工智能设置</h1><p id="5827" class="pw-post-body-paragraph kv kw iq kx b ky mm jr la lb mn ju ld le mo lg lh li mp lk ll lm mq lo lp lq ij bi translated">要开始使用开放式人工智能模型，请访问该网站并创建一个帐户:</p><div class="mr ms gp gr mt mu"><a href="https://openai.com/api/" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">OpenAI API</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">OpenAI的API提供了对GPT-3和Codex的访问，前者执行各种各样的自然语言任务，后者…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">openai.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni kp mu"/></div></div></a></div><p id="a960" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">获取API密钥以开始构建模型，这个“密钥”在您的profile/view API密钥下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/cd61a49d024e91f398fa2976491b5900.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*zi2Z9LBAWZpzOl18PKfJVQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">查看API密钥</p></figure><p id="20b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用python或node.js可获得该API本文将关注python代码。使用python run下载Open AI:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="9b74" class="np ls iq nl b gy nq nr l ns nt">pip install openai</span></pre><h1 id="736e" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">参数</h1><p id="c4b0" class="pw-post-body-paragraph kv kw iq kx b ky mm jr la lb mn ju ld le mo lg lh li mp lk ll lm mq lo lp lq ij bi translated">与开放的人工智能GPT 3交互不需要有很深的模型构建知识API为每个人民主化了模型，允许使用基本参数进行交互。然而，它为数据科学专家提供了微调功能。</p><p id="dcf8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">型号类型</strong></p><p id="32f3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，你需要选择你的模型类型；API附带了四个引擎:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="11fa" class="np ls iq nl b gy nq nr l ns nt">ada, babbage, curie, or davinci</span></pre><p id="987e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">订购的发动机从速度最快、成本最低的<strong class="kx ir"> ada </strong>到最先进的<strong class="kx ir"> davinci </strong>。</p><p id="ef32" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更多详情:<a class="ae ml" href="https://beta.openai.com/docs/engines/gpt-3" rel="noopener ugc nofollow" target="_blank">https://beta.openai.com/docs/engines/gpt-3</a></p><p id="eb00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完井API的其他参数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/5368c6f9bcf58aa4c002097467c4cc6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*foWCAjdMqDc03vo9VqA5GQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">打开AI完成参数</p></figure></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="0bf1" class="lr ls iq bd lt lu oc lw lx ly od ma mb jw oe jx md jz of ka mf kc og kd mh mi bi translated">构建太阳系答案模型的完整代码示例</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/116f5ce5963b3d470f4d2e212e46c66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2R02GmdYykVbpZrNFxlZ_Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">资料来源:unsplash.com</p></figure><p id="bc12" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">导入<code class="fe oi oj ok nl b">openai</code>并设置键值:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="31ce" class="np ls iq nl b gy nq nr l ns nt">import openai<br/>openai.api_key = "enter_your_key"</span></pre><p id="1fd0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">准备包含模型上下文段落的输入模板文件，以回答您的问题；使用文件可以更容易地设置行的格式和起草示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文件-模型输入的示例</p></figure><p id="665a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用python加载输入文件:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="7f36" class="np ls iq nl b gy nq nr l ns nt">with open('answer_ahmadai_template.txt') as f:<br/>    prompt_input = ''.join(f.readlines())</span></pre><p id="d873" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">调用openai完成API并存储响应:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码—调用openai问答</p></figure><p id="2f34" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，您可以打印返回的答案，如下所示:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="a6d1" class="np ls iq nl b gy nq nr l ns nt">response["choices"][0]["text"]</span></pre><p id="592e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">打印响应:“8”</p><p id="4049" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">参数解释:</p><ul class=""><li id="8dfb" class="on oo iq kx b ky kz lb lc le op li oq lm or lq os ot ou ov bi translated"><code class="fe oi oj ok nl b">model</code>:你的答题模式的引擎。</li><li id="f685" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated"><code class="fe oi oj ok nl b">prompt</code>:输入文本，包括文件和问题。</li><li id="83fe" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated"><code class="fe oi oj ok nl b">max_tokens</code>:生成答案的最大令牌数。</li><li id="9b6b" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated"><code class="fe oi oj ok nl b">temperature</code>:更高的值意味着模型将冒更大的风险</li><li id="38ce" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated"><code class="fe oi oj ok nl b">stop</code>:将编码标记为不包含在响应中。</li></ul><h1 id="0352" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">提高</h1><p id="9897" class="pw-post-body-paragraph kv kw iq kx b ky mm jr la lb mn ju ld le mo lg lh li mp lk ll lm mq lo lp lq ij bi translated">模型的输入提示是有限的，您不能发送扩展的上下文段落来提供答案，如完整的网站内容。<br/>为了适应这种限制，您必须对数据库进行语义搜索，并返回所有与用户问题更相似的内容。然后你可以把选中的n个内容和你的问题一起发送到openAI来提供答案。</p><h1 id="d01f" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">摘要</h1><p id="6ea8" class="pw-post-body-paragraph kv kw iq kx b ky mm jr la lb mn ju ld le mo lg lh li mp lk ll lm mq lo lp lq ij bi translated">开放式人工智能使用先进的机器学习模型来扩大你的业务；您可以使用基本设置开始构建ML模型，然后使用自定义参数和引擎选项推进模型。</p><p id="e45b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">默认情况下，API使用标准的GPT3模型和数据。为获得竞争优势，将您的自定义数据上传为文件，并使用微调功能；如果您的业务或语言有独特的数据，这将很有帮助。后续文章将更多地关注微调代码和结果。</p><p id="78c6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我更喜欢直接与模型交互，而不是通过API。然而，出于安全考虑，OpenAI决定不发布该模型本身。发布的API看起来足够灵活，可以构建许多精彩的应用程序。</p><h1 id="c142" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">参考</h1><ul class=""><li id="c1e7" class="on oo iq kx b ky mm lb mn le pb li pc lm pd lq os ot ou ov bi translated">太阳系事实:<a class="ae ml" href="https://solarsystem.nasa.gov/solar-system/our-solar-system/overview/" rel="noopener ugc nofollow" target="_blank">https://solar system . NASA . gov/solar-system/our-solar-system/overview/</a></li><li id="ebb9" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated">open ai:<a class="ae ml" href="https://beta.openai.com/" rel="noopener ugc nofollow" target="_blank">https://beta.openai.com/</a></li><li id="4525" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated">GPT3安全问题的历史:<a class="ae ml" href="https://analyticsindiamag.com/finally-openai-plans-to-tackle-gpt-3s-safety-issues/" rel="noopener ugc nofollow" target="_blank">https://analyticsindiamag . com/finally-open ai-plans-to-trough-GPT-3s-safety-issues/</a></li><li id="6808" class="on oo iq kx b ky ow lb ox le oy li oz lm pa lq os ot ou ov bi translated">美国宇航局内容政策:【https://gpm.nasa.gov/image-use-policy T2】</li></ul><p id="31d8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">引言:<strong class="kx ir"> NASA的内容(图像、视频、音频等)通常没有版权</strong>，可以用于教育或信息目的<strong class="kx ir">，无需明确许可。</strong></p></div></div>    
</body>
</html>