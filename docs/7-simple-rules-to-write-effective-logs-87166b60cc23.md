# 写有效日志的 7 个简单规则

> 原文：<https://betterprogramming.pub/7-simple-rules-to-write-effective-logs-87166b60cc23>

## 遵循这些技术来简化您的开发过程

![](img/0d1f2ef51ce6a22177ceee631aab5caa.png)

[绿色变色龙](https://unsplash.com/@craftedbygc?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片。

日志通常是开发过程中被低估的部分。我们从一开始就表现得好像我们的代码是有效的，但事实远非如此。我们的代码容易出现错误——尤其是在代码仍处于开发阶段的时候。我们没有记录正确的内容，或者我们根本不写日志。如果不这样做，我们会使查找 bug 的过程更加困难和耗时，从而降低我们的生产力。

好消息是有一个简单的解决方案:你只需要用适量的信息开始写有意义的日志。你可能会说，“说起来容易做起来难”。请继续关注，如果你遵循一些简单的规则，你会发现这相当容易。

# 1.在应用程序启动时记录加载的应用程序参数

应用程序通常使用外部文件来定义它们的行为。
您应该总是在应用程序启动时记录加载的应用程序属性。

为什么？在新环境中安装应用程序时，这是一个常见的错误。我们第一次尝试很少成功。我们想知道加载了哪些应用程序属性，以确保在应用程序启动时加载了正确的应用程序属性。我们不希望运行应用程序，然后等待有人提醒我们，由于非法的应用程序属性值，应用程序没有按预期运行。

立即记录它们，并确保在应用程序启动后验证它们。

*日志级别—信息*

# 2.在应用程序启动时记录客户端的配置

在上一步中，我们记录了加载的应用程序参数。但是我们还没有记录用于构造实际客户端的实际参数。在客户端的构建过程中记录它们，以给出关于实际使用的参数的信息。

为什么？有些情况下，我们在属性文件中放入了正确的属性值，但是我们没有使用正确的参数来构建客户端。我们想知道我们将在应用程序中为某个客户端使用哪个 URL。我们不希望开始测试后发现我们使用了错误的 URL。我们希望尽快了解这一点，应用程序启动正是时候。

*日志级别—信息*

# 3.记录公开 API 的入站请求方法调用和方法参数

我们的大多数应用程序都公开了某种 API 来触发某种动作。记录每个公开方法的方法名和方法参数。记录对 API 的每个调用。

为什么？如果两个服务之间的通信出现问题，作为被调用方的您会想知道:

*   被调用的 API
*   传递的参数

这些信息以及数据库状态对于错误解决过程至关重要。数据库状态是持久的，您可以随时访问它，但是方法调用不是，除非您在日志中使它持久化。从一开始就将信息放在日志中，以最大限度地减少解决 bug 所需的时间。

*日志级别—信息(如果方法参数为 fat，则进行调试)*

# 4.记录对第三方系统的出站请求

与前面的规则类似，对于您对第三方系统的每个调用，记录与发出的请求一起调用的 URL。

为什么？如果两个服务之间的通信出现问题，被调用方将要求您提供以下信息:

*   目标 URL/主题
*   发送的方法参数。

被调用方要做的第一件事是查看日志，看看调用了什么，以及发送和接收的参数之间是否不匹配。从一开始就将这些信息放在日志中，以最大限度地减少解决 bug 所需的时间。

*日志级别:*

*   *被称为*的 URL 的信息
*   *调试请求和响应*

# 5.代码中表达的应用程序逻辑应该易于在日志中跟踪

应尽可能避免代码中的注释。相反，您应该将日志放在代码中通常放置注释的地方。这样，如果从代码和测试应用程序的测试人员来看，你的意图不够清楚，你可以向开发人员解释。

为什么？测试人员应该通过查看日志来理解应用程序的逻辑。在大多数情况下，他们会通过查看日志的输出来识别错误是什么。当然，这是假设您记录了足够多的日志。

*日志级别——信息或调试，取决于所提供信息的级别*

# 6.记录代码中的关键路径

如果 API 调用中有多个可用路径，则记录应用程序采用的路径。记录任何选择的路径，为什么选择它，记录使你选择这条特定路径的参数。

为什么？当应用程序以您没有预料到的方式运行时，您将拥有所有需要的信息来跟踪您的逻辑在哪里走错了路。

*日志级别——信息或调试，取决于所提供信息的级别*

# 7.记录所有异常的堆栈跟踪

记录所有异常的堆栈跟踪。不要只是将错误消息放在日志中。

为什么？例外是在您的代码中不应该发生的事情。当它发生时，你会想知道它在哪条线上断了。通过这样做，您将知道导致应用程序中断的确切行号。请确保记录整个堆栈跟踪。记住，当遇到异常时，每一条信息都是有帮助的。

*日志级别—错误*

# 结论

关于这个主题可能会有更多的文章，但是如果你遵循上面列出的规则，你将会朝着成为一个更好的开发者迈出一大步。

感谢阅读！