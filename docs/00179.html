<html>
<head>
<title>Angular 6 Url Parameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度6 Url参数</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-6-url-parameters-860db789db85?source=collection_archive---------0-----------------------#2018-08-25">https://betterprogramming.pub/angular-6-url-parameters-860db789db85?source=collection_archive---------0-----------------------#2018-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c931" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在Angular中从URL和查询字符串中检索参数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fc7c37218bf34e5def567dba30a1ca81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCaKpC4wCf9L17ufPJXs-Q.jpeg"/></div></div></figure><p id="c484" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我注意到有些人对Angular中的路由感到困惑。具体来说，从URL和查询字符串中检索参数存在一些混淆。这是一个相当简单的任务，但它可能有助于一起完成一个示例。幸运的是，我创建了一个<a class="ae lq" href="https://stackblitz.com/edit/get-url-parameters" rel="noopener ugc nofollow" target="_blank"> StackBlitz </a>来帮助解释使用快照和订阅之间的区别。让我们来看看吧。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e222" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">路线</h1><p id="35dc" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">出于我们的目的，让我们关注路由参数。我们将创建路线<code class="fe mv mw mx my b">"animals/:animal"</code>。有了这条路线，我们可以导航到<code class="fe mv mw mx my b">animals/dog</code>或<code class="fe mv mw mx my b">animals/cat</code>，从<code class="fe mv mw mx my b">:animal</code>参数中检索<code class="fe mv mw mx my b">dog</code>或<code class="fe mv mw mx my b">cat</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e266" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">冒号就是证据。这就是URL的第二部分成为参数的原因。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="4066" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">访问URL</h1><p id="c2ac" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">Angular为我们提供了<code class="fe mv mw mx my b">ActivatedRoute</code>对象。我们可以通过这个对象访问URL，但是首先，您必须将它注入到您的组件中。像任何其他服务一样注入它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="6707" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">访问URL参数</h1><p id="2f7a" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">有两种普遍接受的访问URL参数的方法。一个是通过<code class="fe mv mw mx my b">route.snapshot.paramMap</code>，一个是通过<code class="fe mv mw mx my b">route.paramMap.subscribe</code>。两者之间的主要区别在于，订阅将随着特定路由的参数变化而不断更新。这比解释容易，所以请确保使用<a class="ae lq" href="https://stackblitz.com/edit/get-url-parameters" rel="noopener ugc nofollow" target="_blank"> StackBlitz </a>示例。</p><h2 id="3a34" class="nb lz it bd ma nc nd dn me ne nf dp mi ld ng nh mk lh ni nj mm ll nk nl mo nm bi translated">快照</h2><p id="df01" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">顾名思义，使用快照是一次性事件。一个典型的用例是在组件加载时获取参数。显式读取代码；当我加载组件时，我将获得URL参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="ab1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果同一组件内的参数发生变化，此策略将不起作用。更明确地说，从<code class="fe mv mw mx my b">animals/dog</code>更改为<code class="fe mv mw mx my b">animals/cat</code>不会破坏和初始化<code class="fe mv mw mx my b">AnimalComponent</code>，所以<code class="fe mv mw mx my b">ngOnInit</code>方法不会被第二次调用。</p><h2 id="ba33" class="nb lz it bd ma nc nd dn me ne nf dp mi ld ng nh mk lh ni nj mm ll nk nl mo nm bi translated">签署</h2><p id="a91d" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">使用订阅与使用任何其他订阅是一样的。如果有变化，那么可观察值将被推送到回调函数。<em class="nn">如果这不清楚，那么做些功课，仔细阅读</em><a class="ae lq" href="http://reactivex.io/intro.html" rel="noopener ugc nofollow" target="_blank"><em class="nn">RxJS</em></a><em class="nn">。我也曾</em> <a class="ae lq" href="https://medium.com/@christo8989/the-not-so-daily-blog-007-c0c84bedc1ef" rel="noopener"> <em class="nn">写过关于它的</em> </a> <em class="nn">。</em>仅当URL参数在当前路线内发生变化时，此策略才有效。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="daae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种策略可能有些矫枉过正，但是如果你仍然困惑的话，这绝对是最安全的策略。</p><p id="fa96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，<a class="ae lq" href="https://stackoverflow.com/a/41359138/2573621" rel="noopener ugc nofollow" target="_blank">没有必要取消</a>对<code class="fe mv mw mx my b">paramMap</code>的订阅。<code class="fe mv mw mx my b">ActivatedRoute</code>随路由组件一起消亡，因此订阅也随之消亡。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="35c2" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">访问查询参数</h1><p id="083e" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">访问查询字符串参数类似于访问URL参数。这只是<code class="fe mv mw mx my b">ActivatedRoute</code>对象上的不同属性；<code class="fe mv mw mx my b">queryParamMap</code>。因此，所有相同的原则都适用，但要确保使用正确的属性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="c73b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">高级—使用开关映射</h1><p id="9db0" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">在我的研究中，我发现了一个<a class="ae lq" href="https://angular.io/guide/router#route-parameters-in-the-activatedroute-service" rel="noopener ugc nofollow" target="_blank">角度示例</a>，它通过一个<code class="fe mv mw mx my b">switchMap</code>传递参数。什么是<code class="fe mv mw mx my b">switchMap</code>？长答:不知道。简而言之:它基本上是在新请求到来时取消一个请求。</p><p id="f402" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，如果我订阅了<code class="fe mv mw mx my b">paramMap</code>，并开始发送对路由参数的更改，<code class="fe mv mw mx my b">switchMap</code>将取消任何未决的请求，并获取新的请求。这在大多数情况下是多余的，但它可能是有用的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c746" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">等等！上面的代码没有反映出<a class="ae lq" href="https://angular.io/guide/router#route-parameters-in-the-activatedroute-service" rel="noopener ugc nofollow" target="_blank">角度示例</a>。我在<code class="fe mv mw mx my b">switchMap</code>中忽略了他们的HTTP请求。让我们用下面的例子更深入一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3afd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上面的例子中，我在<code class="fe mv mw mx my b">paramMap</code>订阅中发出一个HTTP请求。希望大家都知道HTTP请求是比较贵的。如果我滥发参数变化，我会想取消任何以前的请求。在这种情况下，使用<code class="fe mv mw mx my b">switchMap</code>就可以做到这一点，从而提高性能。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="2e5a" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结论</h1><p id="d348" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">总而言之，从URL获取参数非常简单。如果参数可以在同一组件/路由中更改，请使用快照进行一次性抓取或订阅。如果您在订阅中发出HTTP请求，那么使用<code class="fe mv mw mx my b">switchMap</code>来取消任何不必要的未决请求。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="7681" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nn">如果您发现任何错误或只是想说声嗨，请留下评论或建议。:)</em></p></div></div>    
</body>
</html>