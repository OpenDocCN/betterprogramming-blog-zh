<html>
<head>
<title>Improving Localizable Strings Using SwiftGen</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SwiftGen改进可本地化的字符串</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/localized-strings-using-swiftgen-55422974eb44?source=collection_archive---------1-----------------------#2019-09-18">https://betterprogramming.pub/localized-strings-using-swiftgen-55422974eb44?source=collection_archive---------1-----------------------#2019-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d7b3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">iOS应用程序在屏幕上显示文本的基础</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/10bea658470368d639b9765873eed95f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKomGRcFOMHZiz68HJIQuA.png"/></div></div></figure><p id="1d45" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">可本地化的字符串</em>是iOS应用程序在屏幕上显示文本的基础。这些通常存储在<code class="fe lo lp lq lr b">.strings</code>文件中，这些文件根据用户的语言环境进行切换。</p><p id="767b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们来看看你通常会怎么做。对于您支持的每种语言，您都有一个<code class="fe lo lp lq lr b">.strings</code>文件。每个文件可能如下所示:</p><pre class="kg kh ki kj gt ls lr lt lu aw lv bi"><span id="887f" class="lw lx iq lr b gy ly lz l ma mb">"action.cancel"="Cancel";<br/>"action.logout"="Log out";<br/>"action.ok"="Ok";</span><span id="787e" class="lw lx iq lr b gy mc lz l ma mb">"welcome.title"="Welcome!";</span></pre><p id="22be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通常，您可以通过一个本地化的字符串使用这个键来查找它。</p><pre class="kg kh ki kj gt ls lr lt lu aw lv bi"><span id="ff68" class="lw lx iq lr b gy ly lz l ma mb">let localizedTitle = NSLocalizedString("welcome.title", comment: "")</span></pre><p id="e0fb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，每当您想要一个本地化的字符串时，这是一件相当冗长的事情。我们也不需要使用comment参数，所以我们可以添加一个字符串扩展来使它读起来更清晰，如下所示:</p><pre class="kg kh ki kj gt ls lr lt lu aw lv bi"><span id="682a" class="lw lx iq lr b gy ly lz l ma mb">// MARK: String extension</span><span id="8561" class="lw lx iq lr b gy mc lz l ma mb">extension String {<br/>  var localized: String {<br/>    return NSLocalizedString(self, comment: “”)<br/>  }<br/>}</span><span id="38ce" class="lw lx iq lr b gy mc lz l ma mb">// Usage:</span><span id="8e7b" class="lw lx iq lr b gy mc lz l ma mb">let localizedTitle = "welcome.title".localized</span></pre><p id="eb41" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是一个更干净的解决方案，尽管仍然存在一些问题。让我们更深入地看看它们。</p><p id="35e8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，你可以写任何你喜欢的键，因为它只是一个字符串，不能保证它会出现在本地化的<code class="fe lo lp lq lr b">.strings</code>文件中。如果它不存在，就会导致键显示为值，给最终用户留下不愉快的体验。</p><p id="efdf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">其次，它需要不断地在本地化的<code class="fe lo lp lq lr b">.strings</code>文件之间切换视图，以找到您要复制并粘贴到所需视图或视图控制器中的键。</p><p id="26b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">肯定有更好的方法。</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><h1 id="92a2" class="mk lx iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">介绍静态编译的本地化字符串</h1><p id="4261" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">下一步将需要一个名为<a class="ae ng" href="https://github.com/SwiftGen/SwiftGen" rel="noopener ugc nofollow" target="_blank"> SwiftGen </a>的依赖项。它可以通过<a class="ae ng" href="https://cocoapods.org" rel="noopener ugc nofollow" target="_blank"> Cocoapods </a>、<a class="ae ng" href="https://github.com/Carthage/Carthage" rel="noopener ugc nofollow" target="_blank"> Carthage </a>或<a class="ae ng" href="https://swift.org/package-manager/" rel="noopener ugc nofollow" target="_blank"> Swift package manager </a>添加到您的项目中。</p><p id="7a90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">SwiftGen是一个<a class="ae ng" href="https://developer.apple.com/swift/" rel="noopener ugc nofollow" target="_blank"> Swift </a>代码生成器工具，可以在<a class="ae ng" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode </a>的构建阶段生成代码。我们希望在应用程序的主目标上，或者在包含可本地化的<code class="fe lo lp lq lr b">.strings</code>文件的目标上，添加以下代码作为新的运行脚本阶段。</p><pre class="kg kh ki kj gt ls lr lt lu aw lv bi"><span id="820a" class="lw lx iq lr b gy ly lz l ma mb">TargetName=YourAppsMainTargetName<br/>SourcePath=$SOURCE_ROOT/$TargetName/PathToLocalizableStringsFile.strings<br/>Output=$SOURCE_ROOT/$TargetName/PathToOutputFileIncludingName.swift</span><span id="7696" class="lw lx iq lr b gy mc lz l ma mb">$PODS_ROOT/SwiftGen/bin/swiftgen strings -p $PODS_ROOT/SwiftGen/templates/strings/structured-swift4.stencil $SourcePath — output $Output — param enumName=Localizable</span></pre><p id="3a36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">请确保替换以下变量:</p><pre class="kg kh ki kj gt ls lr lt lu aw lv bi"><span id="4f72" class="lw lx iq lr b gy ly lz l ma mb">YourAppsMainTargetName<br/>PathToLocalizableStringsFile.strings<br/>PathToOutputFile.swift</span></pre><p id="6b03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">构建完成后，它将生成包含枚举的文件，这些枚举具有表示所有本地化字符串的静态常数。记得将生成的文件添加到Xcode的<code class="fe lo lp lq lr b">.project</code>文件中。</p><p id="7305" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，您可以使用Xcode的自动完成功能来访问本地化字符串。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/c038bc097bf0ca7099be185922cbc555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PmZLUyYg0IvBEMJHpTMZuw.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">使用Xcode中新创建的对象自动完成</p></figure><p id="8d97" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">利用option键点击变量名来访问Xcode的快速帮助，查看本地化的<code class="fe lo lp lq lr b">.strings</code>值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/71f8b6bbac94f919a545a88defbf9a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*pFHycs46-3vyUrYgC6B0iA.png"/></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">描述本地化字符串值的Xcode快速帮助</p></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="6624" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">希望这已经教会了你一些新的东西，可以帮助你改进在iOS和Mac OS开发中使用本地化字符串的方式。</p></div></div>    
</body>
</html>