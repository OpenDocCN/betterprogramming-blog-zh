<html>
<head>
<title>Create a Rain Animation Effect Using SpriteKit in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SwiftUI中的SpriteKit创建一个雨动画效果</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/rain-lightning-animation-using-spritekit-in-swiftui-part-1-%EF%B8%8F-e2cf489e5d25?source=collection_archive---------9-----------------------#2022-06-29">https://betterprogramming.pub/rain-lightning-animation-using-spritekit-in-swiftui-part-1-%EF%B8%8F-e2cf489e5d25?source=collection_archive---------9-----------------------#2022-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2aff" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用粒子发射器和其他SpriteKit魔法药剂在SwiftUI中创建完整的降雨体验</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a5fac006e7c51353f6e6df5728a97be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DE5LdSUjmWo1uwwY"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">米歇尔·麦克尤恩在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a122" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是在SwiftUI中使用SpriteKit的雨+闪电动画的第一部分。我们将在这一部分讲述如何创建一个雨的动画。</p><p id="8f6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个故事的结尾，你会学到:</p><ul class=""><li id="9de9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">什么是SKScene</li><li id="7af9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是SpriteKit粒子发射器</li><li id="7a5d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">绘制路径</li><li id="2d5f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">最后，建立一个闪电下雨的动画</li></ul><p id="63bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注:</strong>这是我的版本如何创建一个雨+闪电的动画。你也可以通过许多其他方式达到同样的目的。:)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/9179def5a6f853b38806cd00a772502b.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*EhdPADHvnwdEX8qdwks3GQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这就是我们将如何分解雨+闪电动画</p></figure><h2 id="d442" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated"><strong class="ak">我们要如何创造</strong> <code class="fe na nb nc nd b"><strong class="ak">Rain+Lightning Animation</strong></code> <strong class="ak">？</strong></h2><p id="bc79" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">从上图中，我们可以看到我们有一个<code class="fe na nb nc nd b">SKScene</code>，它有两个孩子。</p><ol class=""><li id="dbf1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nj ly lz ma bi translated">雨(<code class="fe na nb nc nd b">SKEmitterNode</code>)</li><li id="45f4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nj ly lz ma bi translated">闪电(<code class="fe na nb nc nd b">SKShapeNode</code>)</li></ol><p id="4495" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于细节，我们也将运行灯光闪烁序列。</p><h2 id="74d2" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">我们开始吧</h2><p id="3182" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我们先从雨景开始。之后，创建雨动画就非常简单了。为了制作雨的动画，我们将使用粒子发射器。</p><p id="6e2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将为雨创造一个<code class="fe na nb nc nd b">SpriteKit Particle File</code>。从你的项目Xcode中选择<code class="fe na nb nc nd b">File</code> &gt; <code class="fe na nb nc nd b">New</code> &gt; <code class="fe na nb nc nd b">File</code> &gt; <code class="fe na nb nc nd b">SpriteKit Particle File</code>如下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/d64b0988b65bd2845a0b7de19915177e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*iEQKWiWbhtDX0wC4JPze3Q.png"/></div></figure><p id="4179" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择<code class="fe na nb nc nd b">SpriteKit Particle File</code>后，将弹出下一页，要求您选择<code class="fe na nb nc nd b">Particle Template</code>。</p><p id="2b45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击下拉菜单并选择<code class="fe na nb nc nd b">Rain</code>选项。选择<code class="fe na nb nc nd b">Rain</code>选项并点击下一步后，我们将看到一个名称输入屏幕，在这里我们将给出我们的<code class="fe na nb nc nd b">Rain</code>动画粒子文件名。</p><p id="74a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们将提供名称<code class="fe na nb nc nd b">Rain</code>。这将最终在您的项目文件夹中创建一个<code class="fe na nb nc nd b">.sks</code>文件。如下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/486f9b302952f13883547a3e0c2741a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*BZMiVVtRDo_-yOgb0eSpbQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">下雨了。SKS文件</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="2d3a" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">详细描述雨</h2><p id="d72b" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">当你点击<code class="fe na nb nc nd b">Rain.sks</code>时，文件显示SpriteKit提供的默认Rain的预览。</p><p id="29f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将修改雨看起来有点凉。</p><p id="19db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们将对Rain的一些属性进行一些修改，这可以通过点击<code class="fe na nb nc nd b">Attributes Inspector</code>来完成，并对我所做的进行如下修改。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fa8d5074fa9ff84026e96a859122737d.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*3jlzXd8Qi4gsZ1Q1Wy_sIg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">改进的雨属性</p></figure><p id="3db6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已更改的属性的详细信息:</p><ul class=""><li id="3155" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><code class="fe na nb nc nd b">Birthrate</code>——将控制将要形成的粒子数量(我已经增加了它，以便显示一场大雨)</li><li id="f554" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe na nb nc nd b">Angle</code> —角度<code class="fe na nb nc nd b">Start</code>将显示雨水将从哪个角度倾泻。倾斜的角度看起来很像刮风下雨。我已经把260看起来像一场轻微的刮风雨。</li><li id="23a7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe na nb nc nd b">Color Ramp</code>——这只是粒子的颜色，在这种情况下是雨。我在这里给了一个浅灰色</li></ul><p id="b941" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一切都好，对吧？现在，在这一点上，我们的雨是超级准备好被钉在应用程序上。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="c649" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">在ContentView中设置雨场景</h2><p id="cbcd" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">为此，我们将创建一个<code class="fe na nb nc nd b">SKScene</code>类。我们就叫它<code class="fe na nb nc nd b">RainLightningScene</code>。<br/>RainLighningScene将是我们用来创建/表现我们的雨和闪电动画的类。</p><p id="c341" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将为<code class="fe na nb nc nd b">RainLightningScene</code>创建一个<code class="fe na nb nc nd b">shared</code>实例。这将使我们在使用它时变得容易。我们还将有一个EmitterNode对象，在其中我们将给出我们的雨粒子文件名。</p><pre class="kg kh ki kj gt nu nd nv nw aw nx bi"><span id="271b" class="mh mi iq nd b gy ny nz l oa ob"><strong class="nd ir">let</strong> rainEmitter = SKEmitterNode(fileNamed: “Rain.sks”)!</span></pre><p id="3548" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还将使用<code class="fe na nb nc nd b">SKScene</code>的<code class="fe na nb nc nd b">didMove</code>委托。<code class="fe na nb nc nd b">didMove</code>实际上与<code class="fe na nb nc nd b">UIViewController</code>中的<code class="fe na nb nc nd b">viewDidAppear</code>非常相似。</p><p id="a8bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还会给出雨点的定位点。我们将给出y和x的位置。像下面这样</p><pre class="kg kh ki kj gt nu nd nv nw aw nx bi"><span id="4fa6" class="mh mi iq nd b gy ny nz l oa ob">rainEmitter.position.y = <strong class="nd ir">self</strong>.frame.maxY</span><span id="e935" class="mh mi iq nd b gy oc nz l oa ob">rainEmitter.particlePositionRange.dx = <strong class="nd ir">self</strong>.frame.width * 2.5</span></pre><p id="9867" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe na nb nc nd b">particlePositionRange</code> —粒子位置允许的随机值范围(我给了它一个长范围，这样雨看起来更分散)。<br/>这个<code class="fe na nb nc nd b">RainLightningScene</code>类现在看起来如下。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="0b3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们的雨景已经准备好了。我们将插上<code class="fe na nb nc nd b">RainLightning Scene</code>看看它是什么样子。为此，我们必须向我们的<code class="fe na nb nc nd b">ContentView</code>文件添加一些代码。</p><p id="a4ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像往常一样，我们将添加一些实用程序扩展。</p><pre class="kg kh ki kj gt nu nd nv nw aw nx bi"><span id="b54d" class="mh mi iq nd b gy ny nz l oa ob"><strong class="nd ir">extension</strong> UIScreen {</span><span id="046f" class="mh mi iq nd b gy oc nz l oa ob"><strong class="nd ir">static</strong> <strong class="nd ir">let</strong> screenWidth = UIScreen.main.bounds.size.width</span><span id="35ad" class="mh mi iq nd b gy oc nz l oa ob"><strong class="nd ir">static</strong> <strong class="nd ir">let</strong> screenHeight = UIScreen.main.bounds.size.height</span><span id="0bfc" class="mh mi iq nd b gy oc nz l oa ob"><strong class="nd ir">static</strong> <strong class="nd ir">let</strong> screenSize = UIScreen.main.bounds.size</span><span id="f5b0" class="mh mi iq nd b gy oc nz l oa ob">}</span></pre><p id="95cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将首先添加上述扩展，因为它可以方便我们的进一步发展。</p><p id="91ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦添加完毕，我们将转到我们的<code class="fe na nb nc nd b">ContentView</code>块并创建一个<code class="fe na nb nc nd b">SKScene</code>对象。</p><p id="2ad4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将它命名为<code class="fe na nb nc nd b">rainLightningScene</code>并给它一个尺寸，设置它的缩放模式如下。</p><pre class="kg kh ki kj gt nu nd nv nw aw nx bi"><span id="25aa" class="mh mi iq nd b gy ny nz l oa ob"><strong class="nd ir">var</strong> rainLightningScene: SKScene {</span><span id="c411" class="mh mi iq nd b gy oc nz l oa ob"><strong class="nd ir">let</strong> scene = RainLightningScene.shared</span><span id="c877" class="mh mi iq nd b gy oc nz l oa ob">scene.size = UIScreen.screenSize</span><span id="69f3" class="mh mi iq nd b gy oc nz l oa ob">scene.scaleMode = .fill</span><span id="22ab" class="mh mi iq nd b gy oc nz l oa ob"><strong class="nd ir">return</strong> scene</span><span id="3758" class="mh mi iq nd b gy oc nz l oa ob">}</span></pre><p id="1a72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，一旦这个被添加，我们将扑向我们的<code class="fe na nb nc nd b">body</code>并添加一个<code class="fe na nb nc nd b">SpriteView</code>与我们刚刚创建的场景现在的<code class="fe na nb nc nd b">rainLightningScene</code>。</p><p id="ea19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">雨将从这一点开始下😉</p></figure><p id="c995" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一点上，我们的动画看起来会像下面这样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/11055f1ec046db2c21618323637163a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/1*qDOrja_z6ZakOBh8ufn6AQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">大雨倾盆！！！💧</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="1716" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">需要更多细节</h2><p id="3053" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我知道我们的雨需要更多的细节。让我们把魔法药水洒在我们的雨上。魔法药水只不过是给粒子添加了一个图像。<br/>你可以在这里下载图片<a class="ae kv" href="https://github.com/Nikilicious09/Images/blob/main/Raindrop.png" rel="noopener ugc nofollow" target="_blank">。<br/>下载完图像后，您需要将图像添加到<code class="fe na nb nc nd b">Particle Sprite Atlas</code>文件夹内的资产文件中。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/267b91681e8f52b771c419e75b2662a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*5udXeNbGYCXQjPnQNAng6w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们需要添加图像的文件夹</p></figure><p id="b95a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦图像被添加，我们将点击<code class="fe na nb nc nd b">Rain.sks</code>文件，并在其属性检查器中修改一些属性。我们将把<code class="fe na nb nc nd b">Texture</code>改为我们刚才添加的图像的名称。</p><p id="5eaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们也将改变比例，发射器和速度属性，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/6970892b0285aea89732c74a75d8f039.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*5wS2Z-wASoLPWEmSkydsqw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">发射器粒子出生率为300</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/39091470091a9627d166a48de718dda9.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*SQAhDjwFA1Bfm51BJFJGsg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">恒速到300</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/be932fe008ef35a582699bb25950295b.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*S8QwUgWZEsmT15pxJ_EA4w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">缩放至0.015</p></figure><p id="22af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们的雨看起来就像下面的gif。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1d7615c93cd2221d450e409229f7e573.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/1*LhlX3ExXZ6HSf8JJ-zy-FA.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最终大雨倾盆！！！🌧</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="3bdf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你已经理解了我们如何通过使用粒子发射器和调整它的一些属性来创建一个雨的动画。</p><p id="3b1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我很快会在SwiftUI系列中发布使用SpriteKit的Rain+Lightning动画的第二部分。</p><p id="d08d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢你，祝你有美好的一天。</p></div></div>    
</body>
</html>