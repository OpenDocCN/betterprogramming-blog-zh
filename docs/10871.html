<html>
<head>
<title>Floating Hearts Animation in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI中的浮动心形动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/floating-hearts-animation-in-swiftui-1bf2f0404b12?source=collection_archive---------9-----------------------#2022-02-01">https://betterprogramming.pub/floating-hearts-animation-in-swiftui-1bf2f0404b12?source=collection_archive---------9-----------------------#2022-02-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e9f2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何让Instagram像SwiftUI中的按钮动画一样活起来</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c2aede9f9d0b2d6cbf4c9ecf722adf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-r0Mcnzdjm2id26rFim5mA.png"/></div></div></figure><p id="6f06" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了制作一个类似Instagram的like按钮动画，我们将使用<code class="fe lq lr ls lt b">GeometryEffect</code>和<code class="fe lq lr ls lt b">ViewModifier</code>。你也可以使用<code class="fe lq lr ls lt b">SKScene</code>和<code class="fe lq lr ls lt b">SpriteView</code>来达到类似的效果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/af0963191f8a602482a630ce8c4d5eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*5PpvbD4Rw6kecWf-OFqhgg.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="47a2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">心脏的几何效应</h1><p id="7d77" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">首先，我们需要创建一个随着时间改变心脏的x和y方向/位置的几何效果。x位置将彼此靠近，居中或偏心，数值在-0.05和0.05之间。y方向将随着sin和-pi和0之间的y值而变化。如果你的喜欢按钮很大，这些轻微的移动可能还不够。根据需要调整x和y值。</p><p id="20b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按照以下步骤返回正确的投影变换:</p><ul class=""><li id="e71d" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">添加一个速度变量，并给它一个100到200之间的随机值。</li><li id="ca23" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">添加一个时间变量和一个Double类型的animatableData变量。animatableData将启动我们的时间和0，并逐渐将其更改为给定的时间，我们将从我们接下来创建的ViewModifier中传递该时间。</li><li id="e199" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">创建一个xTranslation变量，将x方向和速度相乘。</li><li id="8b90" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">创建一个yTranslation变量，它乘以y方向、速度和时间的sin。</li><li id="f8cc" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">用我们的xTranslation和yTranslation创建并返回一个CGAffineTransform。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4f80" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">点击喜欢的视图修饰符</h1><p id="36e9" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">在本节中，我们将创建一个包含我们内容的<code class="fe lq lr ls lt b">ViewModifier</code>。这里，我们将使用<code class="fe lq lr ls lt b">WithAnimation</code>改变时间值，并将其传递给我们的<code class="fe lq lr ls lt b">GeometryEffect</code>修改器。</p><p id="525d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要使心形淡出，添加一个不透明度修改器，当我们的时间等于心形动画的持续时间时，给它一个0。参见下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f74e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ContentView中的Like按钮</h1><p id="62ba" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">在符号中，使用<code class="fe lq lr ls lt b">heart</code>表示我们喜欢的按钮，使用<code class="fe lq lr ls lt b">heart. fill</code>表示我们喜欢的按钮。跟踪变量中的点赞数。</p><p id="d65d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为喜欢的数量创建一个变量。每次用户点击心脏，增加喜欢。将<code class="fe lq lr ls lt b">heart.fill</code>图像嵌入到一个<code class="fe lq lr ls lt b">ForEach</code>循环中，该循环循环到喜欢的数量。</p><p id="ef37" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，将我们的<code class="fe lq lr ls lt b">LikeTapModifier</code>添加到循环内部的图像中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/d8b3a90854007189ddab44dbabb7a33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*bTvPYiRxAh-aKhBOKNu_gg.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0969" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">性能增强</h1><p id="8e41" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">在调试导航器中，我们可以看到内存不断增加。为了解决这个问题，我们可以将likes从int转换成一个可识别的结构，然后遍历它们。</p><p id="e990" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe lq lr ls lt b">onChange</code>，我们可以将喜欢数保持在一个较低的数字(下面的检查代码)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="c217" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本教程到此为止。感谢您的阅读！</p></div></div>    
</body>
</html>