<html>
<head>
<title>How to Use AWS Lambda Function URL To Send SMS in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在AWS中使用AWS Lambda函数URL发送短信</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/use-function-url-to-send-sms-in-aws-6edb1386403e?source=collection_archive---------12-----------------------#2022-04-20">https://betterprogramming.pub/use-function-url-to-send-sms-in-aws-6edb1386403e?source=collection_archive---------12-----------------------#2022-04-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="78f4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">AWS Lambda新功能的使用案例</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cdf912e3c77173aac6b5fbb0cdda1f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rufJyOIXnLrwWnM5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">保罗·花冈在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8e2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大家好。今天我们来谈谈Lambda中新的函数URL特性。我在为一个客户做的一个小项目中使用了这个新功能，这个项目涉及到在AWS中使用自定义OTP发送SMS。</p><h1 id="9e4e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是函数URL？</h1><p id="0a1e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">函数URL是AWS Lambda的一项新功能，它允许HTTPS URL调用Lambda函数。当您创建一个函数URL时，Lambda会生成一个唯一的URL端点，如下所示:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0a84" class="mu lt iq mq b gy mv mw l mx my">https://&lt;url-id&gt;.lambda-url.&lt;region&gt;.on.aws</span></pre><h2 id="0818" class="mu lt iq bd lu mz na dn ly nb nc dp mc lf nd ne me lj nf ng mg ln nh ni mi nj bi translated">Lambda函数URL和API网关有什么区别？</h2><p id="b074" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果不需要API Gateway的高级特性，比如缓存、stage、throttling或auth，而只需要一个端点来调用lambda，那么可以使用第一个。</p><p id="f59d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将无法管理状态代码，但可以为函数URL设置CORS。</p><p id="0eb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nk">每次你调用一个函数URL，都会有一次Lambda的调用。</em></p><p id="421a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于这个原因，函数URL对于webhook是很好的，在这种服务中，您不需要缓存需要立即执行操作(如发送SMS)的服务的结果。</p><p id="ac70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个项目，我使用SNS来发送带有OTP消息的SMS。</p><h1 id="b682" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是SNS？</h1><p id="5baa" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="nk">亚马逊简单通知服务(Amazon SNS)是一项托管服务，提供从发布者到订阅者的消息传递。</em></p><p id="0af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SNS有许多发送通知的渠道，如电子邮件、推送通知、短信等。这项服务非常便宜(每百万条请求0.50美元)，但短信服务有额外的费用，而且每个国家都不一样。</p><h2 id="78c0" class="mu lt iq bd lu mz na dn ly nb nc dp mc lf nd ne me lj nf ng mg ln nh ni mi nj bi translated">如何退出沙盒模式</h2><p id="5bff" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">短信服务有沙盒模式，所以你只能发送短信给验证过的号码。如果您想退出，您必须从AWS控制台打开一个支持案例。</p><p id="3d89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，您需要一些信息，如“通信类型”、“国家”、“当月消费限额”等。提交几个小时后，你就可以到处发短信了。</p><h1 id="292e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">一个小例子</h1><p id="3066" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在SAM模板中，我启用了Lambda函数中的函数URL:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="7e27" class="mu lt iq mq b gy mv mw l mx my">SendSmsFunction:<br/>  Type: AWS::Serverless::Function<br/>    Properties:<br/>    CodeUri: ./src<br/>    Runtime: nodejs14.x<br/>    Handler: index.handler<br/>    Architectures:<br/>      — arm64<br/>    FunctionUrlConfig:<br/>      AuthType: NONE<br/>    Policies:<br/>      Statement:<br/>        — Sid: Sns<br/>          Effect: Allow<br/>          Action:<br/>            — sns:Publish<br/>          Resource:<br/>            — “*”</span></pre><p id="2c86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是使用AWS SNS发送短信的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e610" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止。</p><p id="3831" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="2342" class="mu lt iq mq b gy mv mw l mx my"><strong class="mq ir">Want to Connect?</strong></span><span id="904e" class="mu lt iq mq b gy nn mw l mx my">Don’t forget to check out the <a class="ae kv" href="https://blog.salvatorecozzubo.com/upload-a-file-in-aws-s3-in-node-js-aede803ac960" rel="noopener ugc nofollow" target="_blank">other articles</a> on my website.</span></pre></div></div>    
</body>
</html>