<html>
<head>
<title>Automating Code Review Chores Using Danger.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Danger.js自动化代码审查杂务</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/code-review-chores-that-we-should-automate-using-danger-js-6cf72ff3bf98?source=collection_archive---------0-----------------------#2022-11-17">https://betterprogramming.pub/code-review-chores-that-we-should-automate-using-danger-js-6cf72ff3bf98?source=collection_archive---------0-----------------------#2022-11-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d7cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">花更多的时间审查你的拉动式请求的关键部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0e6226c4a2c3d5c79bb26ce17d12c935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTrYq2T6yHAwEq-eUeLq6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="40bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们，软件工程师，花了大量的时间做代码审查。我们应该这样做，因为审查代码是一项重要的活动，它允许我们:</p><ul class=""><li id="ce59" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">在我们发布代码之前检测潜在的错误。</li><li id="49f9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查我们的代码是否在做它应该做的事情。</li><li id="5a1c" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">确保我们的代码可维护。</li><li id="15df" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">维护一致的编码标准，例如代码质量、单元测试等。</li></ul><p id="97b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，如果不是自动化的，代码审查的某些部分会令人感到乏味。我们可以将它们归类为“代码审查杂务”一些例子是:</p><ul class=""><li id="8e5b" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">检查作者是否在拉请求中更新了文件。例如<code class="fe mi mj mk ml b">CHANGELOG.md</code>和<code class="fe mi mj mk ml b">package.json</code>文件。</li><li id="1420" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查作者是否已经向新创建的函数添加了测试。</li><li id="d5f5" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查拉动请求(PR)是否过大。</li><li id="4c57" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">检查错别字。</li></ul><p id="fec6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们不想成为那个不断提醒每个人保持拉请求(PR)较小或者保持<code class="fe mi mj mk ml b">package.json</code>文件更新的开发者。当我们重复同样的PR反馈时，代码审查的杂务变得很明显。</p><p id="2a1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们应该花更多的时间回顾公关试图解决的实际问题。因此，我们可以最大限度地减少花在代码审查琐事上的时间。</p><p id="d301" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">自动化杂务将提高我们代码的质量和团队的效率。我们越少担心杂务，我们就能花越多的时间审查公关的关键部分，如业务逻辑和潜在的错误。</p><h1 id="088a" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">危险JS</h1><p id="3701" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">幸运的是，有一个叫做<a class="ae nk" href="https://danger.systems/" rel="noopener ugc nofollow" target="_blank"> Danger </a>的免费工具可以自动完成代码审查。它有很多版本，比如Ruby的<a class="ae nk" href="https://danger.systems/ruby" rel="noopener ugc nofollow" target="_blank">Danger</a>和JavaScript的<a class="ae nk" href="https://danger.systems/js" rel="noopener ugc nofollow" target="_blank">Danger(Danger JS)</a>。两个版本做同样的事情。这是一个选择你喜欢的编程语言来编写你的危险规则的问题。我打算在这篇文章中使用Danger JS。</p><p id="db54" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以读一下<a class="ae nk" rel="noopener ugc nofollow" target="_blank" href="/set-up-danger-js-for-unsupported-cis-927a577ad03b#aa9f">什么是危险？</a>”部分，对危险做了一个简短的介绍。</p><p id="e44a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在接下来的章节中，我将分享一些我们可以使用Danger JS自动完成的常见杂务的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0cc2a94c5ad34b05b680141137f9f62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*kpM8sxfgvXkmwbqSDYkD8A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">危险JS流程图作者。</p></figure><h1 id="717d" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">更新PR中的特定文件</h1><p id="13f7" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">例如:确保我们更新了PR中的<code class="fe mi mj mk ml b">CHANGELOG.md</code>和<code class="fe mi mj mk ml b">package.json</code>文件。如果您有一个共享的JavaScript库，跟踪它的变更日志和版本是一个很好的实践。</p><p id="3c77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是您在<code class="fe mi mj mk ml b">Danger</code>函数中可以做的事情。</p><ul class=""><li id="3e6e" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">检查您的PR是否包含对您的changelog文件和<code class="fe mi mj mk ml b">package.json</code>文件的更改。</li><li id="763b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">如果没有变化，请在PR中留下评论，说明文件需要更新。</li></ul><p id="79c9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一些来自<a class="ae nk" href="https://danger.systems/js/" rel="noopener ugc nofollow" target="_blank">danger.systems/js</a>的样本代码:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="6d35" class="nq mo it ml b be nr ns l nt nu">// Add a CHANGELOG entry for app changes<br/>const hasChangelog = danger.git.modified_files.includes("changelog.md")<br/>const isTrivial = (danger.github.pr.body + danger.github.pr.title).includes("#trivial")</span></pre><pre class="nv nm ml nn bn no np bi"><span id="2418" class="nq mo it ml b be nr ns l nt nu">if (!hasChangelog &amp;&amp; !isTrivial) {<br/>  warn("Please add a changelog entry for your changes.")<br/>}</span></pre><p id="d85b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有一个用于跟踪变更日志文件的Danger JS扩展:<a class="ae nk" href="https://github.com/vtex/danger-plugin-keepachangelog" rel="noopener ugc nofollow" target="_blank">Danger-plugin-keepachangelog</a>。您可以直接使用该扩展，因此没有必要从头开始编写函数。</p><h2 id="8840" class="nw mo it bd mp nx ny dn mt nz oa dp mx lh ob oc mz ll od oe nb lp of og nd oh bi translated">非预期的打印声明</h2><p id="bbea" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">我们使用print语句在本地调试或测试我们的更改。不幸的是，我们有时会无意地将这些提交给我们的分支。</p><p id="ecbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在你的主分支中排除不必要的打印语句是一个很好的做法。运行应用程序或服务时，多余的打印语句会增加噪音，使代码库更难调试。</p><p id="b03e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">大多数时候，他们会被作者或评论家发现。然而，不可避免的是，他们中的一些人仍然可以通过。我们应该使用Danger JS来自动检查。</p><p id="7ae1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是伪代码供参考:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="1d2d" class="nq mo it ml b be nr ns l nt nu">// Get the modified files using DangerJS<br/>modifiedFiles = getModifiedFiles()<br/>for (modifiedFile in modifiedFiles) {<br/>    // Get the added diff for each file using DangerJS<br/>    diffAddedForFile = getDiffAdded(modifiedFile)<br/>    // Check if the diff's string includes a print statement e.g. fmt.print in Go or console.log in JS.<br/>    if (diffAddedForFile.includes('fmt.print')) {<br/>        warn('fmt.print detected')<br/>    }    <br/>}</span></pre><p id="1686" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，如果您使用JavaScript，也可以使用其他替代解决方案，因此您不必从头开始编写您的危险规则。</p><ul class=""><li id="6737" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">Danger JS扩展:<a class="ae nk" href="https://danger.systems/js/plugins/danger-plugin-no-console.html" rel="noopener ugc nofollow" target="_blank"> danger-plugin-noconsole </a>。</li><li id="d7bf" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae nk" href="https://eslint.org/docs/latest/rules/no-console" rel="noopener ugc nofollow" target="_blank"> ESLInt的无控制台</a>。</li></ul><h2 id="e1bf" class="nw mo it bd mp nx ny dn mt nz oa dp mx lh ob oc mz ll od oe nb lp of og nd oh bi translated">检查PR是否太大</h2><p id="89b5" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">我们希望我们的PRs尽可能小。大PRs增加认知负荷。较小的PRs更易于管理，更易于审查。有时，我们必须提醒公关作者将他们的公关分解成小块。</p><p id="a453" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以写一个危险的JS规则来计算一个PR中改变的行数。如果这个数字超过了一个指定的“大PR阈值”，留下一个注释，将PR分解成更小的PR。</p><p id="bdc8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mm">变更行数=删除数+添加数</em></p><p id="932e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这取决于你的团队是否同意一个可接受的大公关门槛。从一个你的团队认为足够好的门槛开始。以我的经验，我一般都是500到600的值开始。然后随着时间的推移进行微调。</p><p id="55d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个来自<a class="ae nk" href="https://danger.systems/js/" rel="noopener ugc nofollow" target="_blank">https://danger.systems/js/</a>的示例代码:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="3362" class="nq mo it ml b be nr ns l nt nu">var bigPRThreshold = 600;<br/>if (danger.github.pr.additions + danger.github.pr.deletions &gt; bigPRThreshold) {<br/>  warn(':exclamation: Big PR (' + ++errorCount + ')');<br/>  markdown('&gt; (' + errorCount + ') : Pull Request size seems relatively large. If Pull Request contains multiple changes, split each into separate PR will helps faster, easier review.');<br/>}</span></pre><p id="724e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你也可以排除那些你不希望被计入你的公关门槛的文件。例如，如果您想要排除模拟文件:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="d925" class="nq mo it ml b be nr ns l nt nu">const linesCount = await danger.git.linesOfCode("**/*");<br/>// exclude mock files<br/>const excludeLinesCount = await danger.git.linesOfCode("**/*mock*");<br/>const totalLinesCount = linesCount - excludeLinesCount;</span></pre><pre class="nv nm ml oi oj aw ok bi"><span id="9550" class="nw mo it ml b gy ol om l on nu">if (totalLinesCount &gt; bigPRThreshold) {<br/>  warn("Big PR, break down into smaller PRs.");<br/>}</span></pre><h2 id="4428" class="nw mo it bd mp nx ny dn mt nz oa dp mx lh ob oc mz ll od oe nb lp of og nd oh bi translated">检查降价错别字</h2><p id="75fc" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">我们文档中的错别字会导致代码库中的<a class="ae nk" href="https://blog.codinghorror.com/the-broken-window-theory/" rel="noopener ugc nofollow" target="_blank">【破窗】</a>。我们不应该忽视他们。好消息是已经有一个检查拼写错误的危险JS扩展:<a class="ae nk" href="https://github.com/orta/danger-plugin-spellcheck" rel="noopener ugc nofollow" target="_blank">危险插件拼写检查</a>。</p><p id="d534" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是GitHub repo的一个使用示例:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="6a1b" class="nq mo it ml b be nr ns l nt nu">// dangerfile.js<br/>import spellcheck from 'danger-plugin-spellcheck'</span></pre><pre class="nv nm ml nn bn no np bi"><span id="b464" class="nq mo it ml b be nr ns l nt nu">spellcheck({<br/>  ignore: ['Nachoz', 'Tacoz'],<br/>  ignoreFiles: ['README.md']<br/>})</span></pre><h2 id="bff6" class="nw mo it bd mp nx ny dn mt nz oa dp mx lh ob oc mz ll od oe nb lp of og nd oh bi translated">积极的规则，例如，补充公关作者</h2><p id="e9a1" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">危险JS不仅仅是关于“你忘记做这件事了”的规则。你可以用它来赞美你的队友，在你的危险档案中加入积极的规则。</p><p id="066e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如:当作者删除的代码多于添加的代码时，赞美他们。这并不意味着你的团队应该避免添加代码。这是鼓励团队删除冗余代码的一种方式。代码更少，维护更少。</p><p id="87e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以用一个简单的<code class="fe mi mj mk ml b">if</code>危险JS块来完成。</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="e980" class="nq mo it ml b be nr ns l nt nu">if (danger.github.pr.deletions &gt; danger.github.pr.additions) {<br/>  message(`:thumbsup: You removed more code than added!`);<br/>}</span></pre><p id="358d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在<a class="ae nk" href="https://danger.systems/js/usage/culture.html#positive-rules" rel="noopener ugc nofollow" target="_blank"> Danger JS的关于积极规则的文档</a>中参考这些积极规则的更多例子。</p><h2 id="2955" class="nw mo it bd mp nx ny dn mt nz oa dp mx lh ob oc mz ll od oe nb lp of og nd oh bi translated">检查缺失的测试</h2><p id="1c44" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">我们写了多少次，收到多少次公关反馈？</p><blockquote class="oo op oq"><p id="c4b8" class="ky kz mm la b lb lc ju ld le lf jx lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">我们应该为此增加一项测试吗？</p></blockquote><p id="fb31" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者</p><blockquote class="oo op oq"><p id="d2d8" class="ky kz mm la b lb lc ju ld le lf jx lg or li lj lk os lm ln lo ot lq lr ls lt im bi translated">请为此添加一个测试。</p></blockquote><p id="771b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可能很多。我们不必再这样了。</p><p id="4a7d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是我们在PR中审查测试时涉及的步骤:</p><ol class=""><li id="31fe" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt ou ma mb mc bi translated">检查新的函数或方法是否需要测试。</li><li id="d01b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ou ma mb mc bi translated">检查测试是否存在—模式匹配。</li><li id="d369" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ou ma mb mc bi translated">确保测试覆盖了我们需要测试的路径。</li></ol><p id="e06f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用Danger JS来自动化步骤2。我们甚至不需要自动化第1步和第3步。自动化步骤2更简单，可以节省我们很多时间。</p><p id="0165" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">检查缺失的测试不同于计算测试覆盖率，如果PR不满足指定的覆盖率阈值，构建就会失败。</p><p id="27a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们在代码评审期间检查测试时，我们不会立即计算测试覆盖率。相反，我们寻找模式。例如:如果您正在审核Golang中的PR:</p><ul class=""><li id="8b5a" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">如果有一个新功能<code class="fe mi mj mk ml b">GetUsers()</code>，是否有一个相关的测试叫做<code class="fe mi mj mk ml b">Test_GetUsers()</code>？</li><li id="2a0b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">如果<code class="fe mi mj mk ml b">Test_GetUsers()</code>缺失，留下反馈“添加缺失的测试”</li></ul><p id="eae3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用Danger JS以编程方式执行上述模式匹配逻辑。这只有在我们遵循命名约定的情况下才会起作用。</p><p id="19b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的危险JS代码中寻找PR中的测试所涉及的步骤:</p><ol class=""><li id="24ff" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt ou ma mb mc bi translated">获取PR差异。</li><li id="50f3" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ou ma mb mc bi translated">检查是否添加了新功能。我们可以为此使用正则表达式。</li><li id="3e46" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ou ma mb mc bi translated">如果有一个新函数，查找是否有该函数的相关测试。例如，如果我们在PR中发现新添加的功能— <code class="fe mi mj mk ml b">GetUsers()</code>。然后，要找测试:<code class="fe mi mj mk ml b">Test_GetUsers()</code>。</li><li id="47bd" class="lu lv it la b lb md le me lh mf ll mg lp mh lt ou ma mb mc bi translated">如果<code class="fe mi mj mk ml b">Test_GetUsers()</code>不存在，请在PR上留下评论。</li></ol><p id="d6b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">伪代码将如下所示:</p><pre class="kj kk kl km gt nm ml nn bn no np bi"><span id="d3d1" class="nq mo it ml b be nr ns l nt nu">// Check for missing tests in added functions in a PR:<br/>addedFunctionNames = []<br/>diffs = []<br/>modifiedFiles = getModifiedFiles()<br/>modifiedTestFiles = getModifiedTestFiles()<br/>diffs = modifiedFiles.map(m =&gt; getDiffAdded(m))<br/>testDiffs = modifiedTestFiles.map(m =&gt; getDiffAdded(m))<br/>for (diff in diffs) {<br/>    parsedFunctionName = parseFunctionNames(diff)<br/>    // check if the pattern matches<br/>    testsFound = testDiffs.filter(diff =&gt; diff.includes(`test_${parsedFunctionName}`))<br/>    if (testsFound.length === 0) {<br/>        warn(`tests missing for: ${parsedFunctionName}`)<br/>    }<br/>}</span></pre><p id="6123" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Google Cloudbuild中设置Danger JS很简单。查看我的<a class="ae nk" rel="noopener ugc nofollow" target="_blank" href="/set-up-danger-js-for-unsupported-cis-927a577ad03b">前一篇博文，了解更多</a>。</p><div class="ov ow gp gr ox oy"><a href="https://blog.ardy.me/membership" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">通过我的推荐链接加入媒体</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">阅读Ardy Gallego Dedase(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">blog.ardy.me</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ks oy"/></div></div></a></div></div></div>    
</body>
</html>