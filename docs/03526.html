<html>
<head>
<title>How to Execute a Cron Job on Mac With Crontab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Crontab在Mac上执行Cron作业</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-execute-a-cron-job-on-mac-with-crontab-b2decf2968eb?source=collection_archive---------0-----------------------#2020-02-16">https://betterprogramming.pub/how-to-execute-a-cron-job-on-mac-with-crontab-b2decf2968eb?source=collection_archive---------0-----------------------#2020-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1989" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用crontab在Mac上使用Python自动执行任务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/abb644c4162e37dc6d7e9ba59f52d669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfaen2d5keUfKyLhjg7SgQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@bradneathery?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布拉德在<a class="ae ky" href="https://unsplash.com/s/photos/clock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上整理</a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="e666" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">序言</h1><p id="ab0a" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在我写下面的步骤之前，我建议安装最新版本的Python和Homebrew。<a class="ae ky" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank"> Homebrew </a>是一个包管理器，就像<a class="ae ky" href="https://pip.pypa.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> pip </a>和<a class="ae ky" href="https://www.anaconda.com/" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>一样，坦率地说，我只是在这个例子中使用它，因为我花了几个小时试图运行一个简单的cron作业，但没有成功。</p><p id="5450" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我经常收到错误，比如无法打开我想要执行的文件或者找不到安装的Python版本。我不会在这篇文章中讨论我的错误，但是如果你愿意，你可以自由地使用任何其他Python安装。</p><p id="c8b6" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我卸载了我已经安装的Python 3.x版本(通过pip和Conda ),并从头开始——卸载也是一个麻烦。</p><p id="3552" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">所以，让我们假设你在你的Mac上，有默认的Python发行版，我相信应该是2.7.10。几乎没有开发人员在这个版本中更新模块，所以当你构建项目时，最好安装最新版本的Python。</p><p id="85e9" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我按照<a class="ae ky" href="https://realpython.com/installing-python/#step-2-install-homebrew-part-2" rel="noopener ugc nofollow" target="_blank">真正的Python指南</a> <strong class="ma iu"> </strong>通过自制软件安装Python 3(真的很快几步)，所以我假设你在这篇文章中也做了同样的事情。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="19a4" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步伐</h1><p id="83b0" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在Mac上打开终端命令提示符，通过运行<code class="fe mz na nb nc b">cd ~/</code>导航到主目录。对我来说，就是<code class="fe mz na nb nc b">Users/Nakul</code>。</p><p id="5312" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们将使用Mac OS的内置crontab功能来编写我们的cron作业。</p><p id="2959" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">键入<code class="fe mz na nb nc b">crontab -e</code>并按回车键。</p><p id="e04b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这将打开一个空文件，这是您编写cron作业的地方。在这种情况下，您可以编写作业来运行shell脚本或Python脚本。</p><p id="1ae5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">键入<code class="fe mz na nb nc b">:q!</code>退出编辑器。</p><p id="0b1a" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">假设你遵循了上面的自制指南，仔细检查你的Python安装路径。你可以通过在终端输入<code class="fe mz na nb nc b">which python3</code>来实现。</p><p id="8123" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">它应该显示<code class="fe mz na nb nc b">/usr/local/bin/python3</code>(这是实际的自制软件安装位置的别名，但没关系，我们现在不会深入讨论)。您将在您的cron作业语法中包含这个路径，我们将对此进行讨论。</p><p id="514b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在编写cron作业之前，我们应该有一个想要运行的脚本。我已经在我的主目录中创建了一个目录<code class="fe mz na nb nc b">/Documents/Python/cron</code>，并创建了一个名为<code class="fe mz na nb nc b">cron_test.py</code>的简单脚本。</p><p id="4a0e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">注意:这个Python脚本需要是可执行的，所以要修改它的权限，我刚刚运行了一个<code class="fe mz na nb nc b">chmod 777 cron_test.py</code>。</p><p id="f5d4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">cron_test.py</code>脚本简单地创建了一个以当前日期和时间为名称的目录。</p><p id="e188" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如果您想要使用相同的脚本，脚本文本如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="35f3" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您可能想知道第一行<code class="fe mz na nb nc b">#!/usr/bin/python3</code>是什么。这一行被称为<em class="nf"> shebang </em>以及cron作业将如何解释脚本，因此在这种情况下，它将使用Python运行<code class="fe mz na nb nc b">cron_test.py</code>(就像您在终端中执行Python <code class="fe mz na nb nc b">cron_test.py</code>)。</p><p id="1dd0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">好了，我们已经安装了Python 3.x，我们有了Python脚本，现在让我们编写cron作业来运行它！</p><p id="6417" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">假设我们想每分钟都运行这个脚本(主要是为了在您的终端进行测试，这样您就可以不用等太久就能看到结果)。</p><p id="2ae0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">cron作业语法如下:</p><pre class="kj kk kl km gt ng nc nh ni aw nj bi"><span id="b1dd" class="nk lh it nc b gy nl nm l nn no">*/1 * * * * cd ~/Documents/Python/cron &amp;&amp; /usr/local/bin/python3 cron_test.py &gt;&gt; ~/Documents/Python/cron/cron.txt 2&gt;&amp;1</span></pre><p id="9883" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">以上是什么意思？我们来快速分析一下。</p><p id="3327" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">*/1 * * * *</code>简单地说就是作业每分钟都会运行。</p><p id="6a29" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">cd ~/Documents/Python/cron &amp;&amp; /usr/local/bin/python3</code>导航到您想要执行的脚本所在的目录，并指定使用Python而不是<a class="ae ky" href="https://www.gnu.org/software/bash/" rel="noopener ugc nofollow" target="_blank"> Bash </a>来执行(因为它是一个Python脚本，还记得我们在脚本中添加了shebang，我发现它需要在两个地方都工作)。</p><p id="e090" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">cron_test.py</code>是脚本文件名。</p><p id="5ff4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">&gt;&gt; ~/Documents/Python/cron/cron.txt</code>指定当作业执行出现问题时，将日志输出到何处。</p><p id="6c04" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe mz na nb nc b">2&gt;&amp;1</code>简单地禁用电子邮件，因为默认情况下，cron作业会尝试发送电子邮件，但我们没有指定地址。</p><p id="5f38" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">无论如何，这应该足够让你编写和测试你的脚本了，所以继续吧！</p><p id="6ea8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">请随意浏览网页，了解更多关于cron jobs和crontab的信息。我决定为那些对编程有基本了解并希望尽快编写cron作业的人写这篇文章。</p><p id="4784" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">希望这有所帮助！</p></div></div>    
</body>
</html>