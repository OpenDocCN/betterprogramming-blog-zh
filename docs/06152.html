<html>
<head>
<title>Startups and the Production Readiness Process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创业和生产准备流程</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/startups-and-the-production-readiness-process-6d407f9c0b94?source=collection_archive---------17-----------------------#2020-09-04">https://betterprogramming.pub/startups-and-the-production-readiness-process-6d407f9c0b94?source=collection_archive---------17-----------------------#2020-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9323" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">定义和控制将软件应用程序交付到生产环境的方式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e34fd5f529cdb432424e43cfe664e07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m3pLEb7buP3-560p"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@jacalynbeales?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jacalyn Beales </a>拍摄的照片</p></figure><p id="25db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">稳定性和治理是任何软件开发过程中都应该处理的最热门的话题。从开发阶段到生产环境中的部署和运行阶段，这两个主题都需要解决。</p><p id="d22e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有助于掌握软件开发、部署和服务运行的流程或技术之一是生产准备流程。该过程是一系列任务和项目验证，需要在软件开发过程中进行检查，以确保服务:</p><ul class=""><li id="d461" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">有适当的文件</li><li id="fe67" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">准备在生产环境中运行</li><li id="0f95" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">符合所有采用的标准和非功能特性</li></ul><p id="b7b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为每个开发的服务检查上述信息将有助于</p><ul class=""><li id="9c62" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">提供关于服务内部的透明信息</li><li id="33a7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">开发和SRE/部署团队之间的平稳交接</li><li id="8651" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">让SRE/部署团队对在生产中运行和支持服务充满信心</li></ul><p id="bdba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将说明如何定义一个基本的生产准备过程，我将解释这个过程应该解决的每一个项目。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="e74b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生产准备流程/清单包括两个主要部分:</p><ul class=""><li id="988c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">服务描述:这些项目将描述服务并提供服务标识。这些项目中的大部分被认为是服务文档，并且在发生变化时总是需要更新。</li><li id="f105" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">标准:这些是为了使服务符合所采用的标准和支持的非功能特性而需要实现的项目。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="99a1" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">服务描述项目</h1><p id="cf1f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">以下是服务描述部分中可能包含的项目的列表和简要描述:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b350651b5324f9135b244b48aa8a8fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*sFKL9kjCd0o_Kz2t7KCdpw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><ul class=""><li id="77ed" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">所有者</strong>:列出服务所有者和贡献者(工程师、业务所有者)的角色和职责。当需要对服务做出决策时，或者在生产环境中发生事故时，这些信息非常有用。</li><li id="f96b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">业务逻辑</strong>:描述服务用例以及业务逻辑。这将有助于其他团队了解服务在内部是如何工作的，并将使团队之间的交接更加顺畅。</li><li id="d319" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">职责</strong>:描述服务的主要职责和特点，以便能够理解服务角色和需求。</li><li id="1082" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">组件和系统</strong>:描述服务架构和内部组件或服务。</li><li id="7970" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">技术规格</strong>:提供服务技术规格和要求，如</li></ul><p id="5237" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→基础设施硬件和软件要求(操作系统、RAM、CPU)</p><p id="b21e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→使用的技术(编程语言、库、第三方工具)</p><ul class=""><li id="89c1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">序列图和流程</strong>:描述服务的所有依赖关系，解释服务和其他微服务之间的流程和通信。这些信息非常有用，尤其是在发生事故并且需要调查问题时。这些图表应该至少涵盖以下两种情况。</li></ul><p id="8dc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→对第三方的服务依赖</p><p id="6c22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→服务与堆栈中其他服务的通信</p><ul class=""><li id="5d28" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">配置描述</strong>:提供并描述将服务安装并部署到环境中所需的所有可能的服务配置。受支持的配置集可以属于以下一个或多个配置类别:</li></ul><p id="1e20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→构建时配置:在构建服务包时提供的配置，例如，支持的操作系统。</p><p id="1200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→部署时配置:这些配置可以在部署时作为环境变量传递给服务流程。这种配置的一个例子是数据库连接字符串。</p><p id="ae44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→运行时配置:这些是持久的配置，可以在服务运行时加载和更改(即无需重启服务)，例如服务支持的主要语言。</p><p id="87d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→机密:这些是不应以纯文本形式存储或共享的敏感信息，如数据库密码、私钥和第三方API机密。</p><ul class=""><li id="42fb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">安装</strong>:描述服务的安装和部署所需的步骤。应该对此进行详细描述，并涵盖部署服务和对正在运行的实例进行故障排除所需的所有方面和步骤。</li><li id="4115" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> E2E自动化</strong>:描述受服务影响的端到端测试用例。</li><li id="03e7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> API规范</strong>:定义并记录API规范，以防服务提供的API应该被其他服务使用。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="1c06" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">标准和非功能特性</h1><ul class=""><li id="be58" class="lv lw it lb b lc ni lf nj li no lm np lq nq lu ma mb mc md bi translated"><strong class="lb iu">代码风格</strong>:服务应该兼容所采用的代码风格。有几个工具可以与CI/CD管道集成，以确保集成的代码与代码风格兼容。例如，对于Ruby应用程序来说，<a class="ae ky" href="https://github.com/rubocop-hq/rubocop" rel="noopener ugc nofollow" target="_blank"> Rubocop </a>可以用来轻松完成这项任务。</li><li id="560d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">安全</strong>:服务安全是最重要、最敏感的话题之一。因此，需要扫描服务源代码、Docker映像和其他包，并针对已知的漏洞进行验证。</li></ul><p id="8082" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→为Ruby应用程序使用静态分析库，如<a class="ae ky" href="https://github.com/presidentbeef/brakeman" rel="noopener ugc nofollow" target="_blank"> Brakeman </a>。</p><p id="a9df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→扫描Docker映像，查找操作系统漏洞。</p><ul class=""><li id="526f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">应用日志</strong>:生产服务需要支持服务生产日志的一致方式。以下是定义记录系统和方法时要考虑的一些建议要点。</li></ul><p id="7738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→日志级别可通过环境变量进行配置。(在生产中，级别应该是INFO。)</p><p id="d6ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→支持单行日志(每个web请求或事件只有一个日志行)。</p><p id="db4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→支持键值/JSON日志格式。这将使解析和发布日志变得更加容易。</p><ul class=""><li id="2303" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">健康检查端点集成</strong></li></ul><p id="d973" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">部署到生产环境中的每个服务都必须支持运行状况检查端点，以便能够验证服务的状态和运行状况。这些端点可以由监控系统或容器编制器解决方案(Swarm或Kubernetes)使用。运行状况检查端点是支持高可用性和零停机部署的一项要求。</p><ul class=""><li id="c61b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">请求跟踪多个服务</strong></li></ul><p id="61fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果软件遵循微服务架构，并且为一个请求提供服务可能会导致对多个服务的多次调用，我们必须确保这些服务的日志相互关联，并且可以被识别为单个请求。这个日志集合不仅适用于服务之间的同步通信，也适用于异步通信，比如后台作业、RabbitMQ订阅者、Kafka消费者等等。</p><ul class=""><li id="91f1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> Docker支持和Kubernetes支持</strong></li></ul><p id="5c5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本地容器或云中托管应用程序是支持更好、更流畅、可移植的部署和易伸缩性的必要条件。因此，需要确保服务可以在这些系统上运行。一个好主意是为开发团队提供一些标准和文档，以便能够在开发的早期阶段对服务进行分类。以下是该主题需要涵盖的一些领域。</p><p id="1cfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→将服务归档并创建归档文件。</p><p id="166c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→创建Makefile，用于构建Docker映像的统一接口。</p><p id="7b1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→创建Kubernetes资源。</p><p id="3bb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→为服务创建一个舵图。</p><p id="5c93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→创建用于构建Docker映像的Jenkins管道。</p><ul class=""><li id="05c0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">性能测试</strong>:需要执行性能测试，以便能够验证和理解新服务和整个堆栈的性能和限制。</li><li id="08af" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> CI/CD </strong>:确保在Jenkins中实现并创建所有需要的CI/CD管道。</li></ul><p id="36b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→运行单元测试。</p><p id="a7fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→构建Docker映像。</p><p id="3746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→制作舵图。</p><p id="eb26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→部署到所有支持的环境。</p><p id="ef8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→等等。—以上项目列表只是生产准备清单中可包含的项目示例。这些项目取决于服务的性质、编程语言以及将为其创建项目清单的软件架构。例如，在拥有Rails应用程序的情况下，您可能需要添加一个项目来控制和收集来自Rails控制台的日志。</p><p id="4161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，在移动应用程序的情况下，上述列表中的一些项目根本不适用，需要考虑新的项目，例如:</p><ul class=""><li id="744f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">遵守谷歌和苹果开发者计划和应用商店条款和条件</li><li id="0810" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">强制更新</li><li id="97ad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">远程功能标志</li><li id="7fad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">支持的版本和设备</li><li id="d162" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">其他…</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="8fe9" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="6312" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">生产准备过程是开始控制开发过程和维护生产系统中服务稳定性的好主意。它还有助于获得在生产中运行和支持服务的信心。文章中介绍的过程并不是一成不变的。事实上，强烈建议定制和构建一个适合项目和软件服务需求的过程。</p></div></div>    
</body>
</html>