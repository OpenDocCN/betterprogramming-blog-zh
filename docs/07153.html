<html>
<head>
<title>Deploy a Production Django App With Elastic Beanstalk (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Elastic Beanstalk部署一个生产Django应用程序(第2部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/production-django-elastic-beanstalk-part2-4501caf7d8fb?source=collection_archive---------5-----------------------#2020-12-11">https://betterprogramming.pub/production-django-elastic-beanstalk-part2-4501caf7d8fb?source=collection_archive---------5-----------------------#2020-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2a7d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">生产静态和媒体设置、环境变量和数据库设置</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5da0e2d11ac6348dbb0f3a84e9e091d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0tlzcn_qfCsDzwsm"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@affiliatejoe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乔</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="cd2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">如果你在登陆这里之前已经阅读了</em> <strong class="ky ir"> <em class="ls"> </em> </strong> <a class="ae kv" href="https://medium.com/@zackcpetersen/production-django-elastic-beanstalk-part1-6632c0d4956a" rel="noopener"> <em class="ls">第一部分</em> </a> <strong class="ky ir"> <em class="ls">，</em> </strong> <em class="ls">你可能想先回去读一下！如果没有上一篇文章给出的基础，这篇文章的某些部分将无法工作或没有意义。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lt"><img src="../Images/accc97c37db99a56e2be6aad430bd492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGS8Fn--gOAhdMisWGiJHw.png"/></div></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="9725" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">目录</h1><ol class=""><li id="e721" class="mt mu iq ky b kz mv lc mw lf mx lj my ln mz lr na nb nc nd bi translated"><a class="ae kv" href="#8f6c" rel="noopener ugc nofollow"> <strong class="ky ir">设置S3 —静态和媒体存储</strong> </a> <strong class="ky ir"> <br/> </strong> — <a class="ae kv" href="#7b79" rel="noopener ugc nofollow">创建组和用户</a> <br/> — <a class="ae kv" href="#1c5a" rel="noopener ugc nofollow">创建存储桶</a></li><li id="abca" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="#fa4f" rel="noopener ugc nofollow"> <strong class="ky ir"> django-storages和boto3 </strong> </a></li><li id="9dca" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="#2db7" rel="noopener ugc nofollow"> <strong class="ky ir">环境变量—控制台vs CLI </strong> </a></li><li id="a5bb" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="#8ff7" rel="noopener ugc nofollow"> <strong class="ky ir">配置您的数据库使用Beanstalk的Postgres</strong></a><br/>—<a class="ae kv" href="#ad42" rel="noopener ugc nofollow">创建Beanstalk数据库</a> <br/> — <a class="ae kv" href="#4ac6" rel="noopener ugc nofollow">更新数据库设置</a> <br/> — <a class="ae kv" href="#1606" rel="noopener ugc nofollow">本地PostgreS </a> QL</li><li id="1c1d" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="#1504" rel="noopener ugc nofollow"> <strong class="ky ir">清理</strong> </a></li><li id="01f8" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="#955d" rel="noopener ugc nofollow"> <strong class="ky ir">结论</strong> </a></li></ol></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="8f6c" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">设置S3 —静态和媒体存储</h1><p id="35af" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">到目前为止，我们已经在Elastic Beanstalk Amazon Linux 2上部署了一个正常工作的Django应用程序。恭喜你！然而，我们仍然需要设置S3，以便网站显示风格，我们可以上传图片-这将是很好的，考虑到它是一个每日图片应用程序！</p><h2 id="7b79" class="nm mc iq bd md nn no dn mh np nq dp ml lf nr ns mn lj nt nu mp ln nv nw mr nx bi translated">创建组和用户</h2><p id="ef9c" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">首先:我们需要创建一个具有编程访问权限的IAM用户，这样我们的应用程序就可以访问我们接下来要创建的S3桶。这里的最佳实践是创建一个附加了适当策略的组，并向该组添加一个新用户。<em class="ls">注意:我强烈建议为应用程序的S3访问创建一个新用户。使用管理员用户会带来各种安全风险。</em></p><p id="7764" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在AWS服务搜索栏中，查找IAM。导航到IAM →组→创建新组。将组名设置为类似于“<em class="ls"> S3FullAccess </em>的名称，然后进入下一步。在这里，搜索“S3”并选择<code class="fe ny nz oa ob b">AmazonS3FullAccess</code>。单击下一步，创建该组。</p><p id="55a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将导航到“用户”并添加一个新用户。您可以随意命名用户，我会选择“<em class="ls"> iotd-s3-access </em>”并选择“<em class="ls">程序化访问</em>”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/06d05b496be481ed64f0be8e035e7831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jxkq1cJGRP1Ejg1MNsIF_w.png"/></div></div></figure><p id="0654" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击权限，将该用户添加到我们创建的组中。点击并创建用户。</p><p id="fa87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建用户后，您将收到成功通知，并能够保存访问密钥ID和秘密访问密钥。<em class="ls">重要提示:如果您不在此处保存这些凭据，您将无法再次看到它们。您必须删除此用户并创建一个新用户才能再次获取凭据。</em></p><p id="b9b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下载。csv文件，并返回到iotd项目设置文件。在iotd/settings.py的末尾添加两个新设置——我们不打算添加键，而是添加对它们的引用:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="1f27" class="nm mc iq ob b gy oh oi l oj ok">if 'AWS_ACCESS_KEY_ID' in os.environ:<br/>    AWS_ACCESS_KEY_ID = os.environ['AWS_ACCESS_KEY_ID']<br/>    AWS_SECRET_ACCESS_KEY = os.environ['AWS_SECRET_ACCESS_KEY']</span></pre><p id="b4da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在设置文件中提交实际的键是一个危险的想法。如果有人能够访问您的项目代码(GitHub或其他)，就会造成安全漏洞。我们不是将它们保存在设置文件中，而是将它们作为环境变量添加，并安全地将它们放入设置文件中。<a class="ae kv" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-container.html#create-deploy-python-custom-container-envprop" rel="noopener ugc nofollow" target="_blank">此处单据</a>。</p><h2 id="1c5a" class="nm mc iq bd md nn no dn mh np nq dp ml lf nr ns mn lj nt nu mp ln nv nw mr nx bi translated">创建一个桶</h2><p id="05c6" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">在我们进入环境变量之前，导航到S3，并创建一个新的bucket。确保关闭<em class="ls">阻止公共访问</em>。我们将需要存储在这里的图像是公开的，以在API中显示它们，并在以后访问它们。你想给你的桶取什么名字都行。我通常建议启用版本控制，但这是可选的。点击“创建存储桶”,我们就都准备好了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/0e9f7ee9165f8e105b748ebdb975f8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UOE2yvEeLQXcSyUF4y8SLw.png"/></div></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="fa4f" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">django-storages和boto3</h1><p id="f42b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">现在谈谈Django的存储设置。在项目目录的根目录下，运行以下命令:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="7116" class="nm mc iq ob b gy oh oi l oj ok">pipenv install django-storages<br/>pipenv install boto3</span></pre><p id="6725" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这安装了两个库来完成处理S3的所有繁重工作。安装好之后，一定要将<code class="fe ny nz oa ob b">'storages'</code>添加到你的<code class="fe ny nz oa ob b">INSTALLED_APPS</code>中——可以在settings.py中找到</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="6fab" class="nm mc iq ob b gy oh oi l oj ok">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',</span><span id="2e31" class="nm mc iq ob b gy om oi l oj ok">    'rest_framework',<br/>    <br/>    <strong class="ob ir">'storages',</strong></span><span id="d54c" class="nm mc iq ob b gy om oi l oj ok">    'images'<br/>]</span></pre><p id="4a5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们已经拥有了在S3上设置静态和媒体存储所需的所有组件。转到iotd/settings.py文件，我们将添加一些设置来完成设置。</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="2ec8" class="nm mc iq ob b gy oh oi l oj ok">STATIC_URL = '/static/'<br/>STATIC_ROOT = os.path.join(BASE_DIR, "static")</span><span id="0e00" class="nm mc iq ob b gy om oi l oj ok">### Django storages - use this for production<br/>STATICFILES_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'</span><span id="0337" class="nm mc iq ob b gy om oi l oj ok">MEDIA_URL = '/media/'<br/>MEDIA_ROOT = os.path.join(BASE_DIR, 'media')</span><span id="22ea" class="nm mc iq ob b gy om oi l oj ok">### Django storages - use in production<br/>DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'</span></pre><p id="19d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在本地运行，不想每次都把改变推给S3，在运行<code class="fe ny nz oa ob b">collectstatic</code>或上传本地媒体文件之前，注释掉<code class="fe ny nz oa ob b">STATICFILES_STORAGE</code>和<code class="fe ny nz oa ob b">DEFAULT_FILE_STORAGE</code>。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="2db7" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">环境变量—控制台与CLI</h1><p id="2c94" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">我们需要添加环境变量，以便<code class="fe ny nz oa ob b">os.environ</code>可以填充我们需要的值。有几种方法可以做到这一点。最直接的方法是导航到你的豆茎→ &lt;你的环境&gt; →配置→软件→环境变量。你可以在这里手动添加它们，但是在我看来，这需要太多的时间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/78113200c57714a0081956f20eaf982b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DWmlMF5eCnD6KaQFRTnr4w.png"/></div></div></figure><p id="b8ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我更喜欢使用<code class="fe ny nz oa ob b">eb setenv</code>命令。您可以在一个命令中设置任意数量的环境变量。<a class="ae kv" href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-setenv.html" rel="noopener ugc nofollow" target="_blank">此处文档</a>。</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="6297" class="nm mc iq ob b gy oh oi l oj ok">eb setenv \<br/>AWS_S3_REGION_NAME='us-west-2' \<br/>AWS_STORAGE_BUCKET_NAME='iotd-static'</span></pre><p id="f379" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果到目前为止您已经完成了所有工作，那么您将希望通过命令行或控制台添加以下环境变量:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="5fcf" class="nm mc iq ob b gy oh oi l oj ok">AWS_ACCESS_KEY_ID<br/>AWS_SECRET_ACCESS_KEY<br/>AWS_STORAGE_BUCKET_NAME<br/>AWS_S3_REGION_NAME</span></pre><p id="b567" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从获取您的访问密钥和秘密访问密钥。你之前下载的csv。存储桶名称是您命名的S3存储桶的名称，区域名称是您的Beanstalk环境所在的区域——我的是<code class="fe ny nz oa ob b">us-west-2</code>。</p><p id="5e01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦添加了这些，确保您已经将更改提交给Git并运行<code class="fe ny nz oa ob b">eb deploy</code>。如果有任何问题，首先检查本文前面提到的三个日志文件，以找到错误消息。否则，尝试<code class="fe ny nz oa ob b">eb open</code>并导航至<code class="fe ny nz oa ob b">/api/</code>。</p><p id="0e79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然我们现在有了样式，让我们测试媒体上传。上传一张图片并给它命名，点击发布。当页面重新加载时，单击图像链接，您应该会看到您的图像。请注意，图像URL来自您的S3桶。</p><p id="ab7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">恭喜你！我们现在已经将我们的应用程序部署到Beanstalk，并设置了生产静态和媒体文件。只剩下一件事要做了。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="8ff7" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">将您的数据库配置为在Beanstalk中使用Postgres</h1><p id="1605" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">到目前为止，我们的数据库是一个本地db.sqlite3，它与其他文件一起位于我们的项目目录中。这在开发环境中工作得很好，但是在生产环境中却不是一个好主意。本教程的最后一步是在beanstalk中建立一个Postgresql数据库，并配置Django来做所有与数据库相关的事情。</p><h2 id="ad42" class="nm mc iq bd md nn no dn mh np nq dp ml lf nr ns mn lj nt nu mp ln nv nw mr nx bi translated">创建一个Beanstalk数据库</h2><p id="5930" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">首先，用<code class="fe ny nz oa ob b">eb console</code>打开控制台设置并导航至配置。滚动到底部，直到找到“数据库”，然后单击“编辑”应用以下设置:</p><ul class=""><li id="5b23" class="mt mu iq ky b kz la lc ld lf oo lj op ln oq lr or nb nc nd bi translated"><strong class="ky ir">引擎</strong> : Postgres</li><li id="c174" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr or nb nc nd bi translated"><strong class="ky ir">引擎版本</strong>:默认</li><li id="0004" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr or nb nc nd bi translated"><strong class="ky ir">实例类</strong>:我推荐免费层db.t2.micro</li><li id="62d7" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr or nb nc nd bi translated"><strong class="ky ir">存储</strong>:我推荐5 GB，但选择有意义的</li><li id="ec16" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr or nb nc nd bi translated"><strong class="ky ir">用户名/密码</strong>:随意设置</li><li id="0178" class="mt mu iq ky b kz ne lc nf lf ng lj nh ln ni lr or nb nc nd bi translated"><strong class="ky ir">保留</strong>:如果希望数据库在环境终止时创建快照，请选择创建快照。否则，选择删除。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/912a4cf660cfbddf9ecd8c23c87d53d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHDVRi8fDYHf-EheXtc2vg.png"/></div></div></figure><p id="1410" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成所有设置后，单击Apply，Beanstalk将为您创建数据库。在创建过程中，让我们配置设置以查看新的数据库。</p><h2 id="4ac6" class="nm mc iq bd md nn no dn mh np nq dp ml lf nr ns mn lj nt nu mp ln nv nw mr nx bi translated">更新数据库设置</h2><p id="cd02" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">首先，我们需要安装<code class="fe ny nz oa ob b">psycopg2</code>:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="fb9d" class="nm mc iq ob b gy oh oi l oj ok">pipenv install pyscopg2-binary</span></pre><p id="fc3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将以下内容添加到settings.py文件中，并删除默认的<code class="fe ny nz oa ob b">DATABASE</code>配置:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="eba6" class="nm mc iq ob b gy oh oi l oj ok"><em class="ls">if </em>'RDS_DB_NAME' <em class="ls">in </em>os.environ:<br/>    DATABASES = {<br/>        'default': {<br/>            'ENGINE': 'django.db.backends.postgresql_psycopg2',<br/>            'NAME': os.environ['RDS_DB_NAME'],<br/>            'USER': os.environ['RDS_USERNAME'],<br/>            'PASSWORD': os.environ['RDS_PASSWORD'],<br/>            'HOST': os.environ['RDS_HOSTNAME'],<br/>            'PORT': os.environ['RDS_PORT'],<br/>        }<br/>    }<br/><em class="ls">else</em>:<br/>    DATABASES = {<br/>        'default': {<br/>            'ENGINE': 'django.db.backends.postgresql_psycopg2',<br/>            'NAME': 'iotd',<br/>            'USER': 'iotd',<br/>            'PASSWORD': 'iotd',<br/>            'HOST': 'localhost',<br/>            'PORT': '5432',<br/>        }<br/>    }</span></pre><p id="b18d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">提交您的更改并再次运行<code class="fe ny nz oa ob b">eb deploy</code>，这将把您的数据库从MySQL交换到Postgresql！<em class="ls">注意:您在上一步中所做的数据库更改需要一分钟的时间来完成——在完成之前，您将无法部署。</em></p><h2 id="1606" class="nm mc iq bd md nn no dn mh np nq dp ml lf nr ns mn lj nt nu mp ln nv nw mr nx bi translated">本地PostgreSQL</h2><p id="2ec6" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">如果您已经从本教程开头提到的repo中克隆了，那么其中包含了一个<em class="ls"> docker-compose.yml </em>，它将作为本地PostgreSQL数据库进行开发。确保您已经安装并运行了Docker，并在项目的根目录下运行以下命令:</p><pre class="kg kh ki kj gt od ob oe of aw og bi"><span id="b969" class="nm mc iq ob b gy oh oi l oj ok">docker-compose up -d</span></pre><p id="ba19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将使用<code class="fe ny nz oa ob b">iotd.settings.base</code>中的数据库设置自动启动PostgreSQL容器。这将允许您轻松地在本地使用PostgreSQL！</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="1504" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">清除</h1><p id="1194" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">要删除您的beanstalk环境，您需要做的就是运行<code class="fe ny nz oa ob b">eb terminate</code>，aws将为您清理！</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="955d" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论</h1><p id="1864" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">惊人的工作！我们在本教程中讨论了很多，并通过Beanstalk在web上获得了我们的应用程序。很快，我将使用Vue.js构建一个前端，并使用这个API作为后端——请留意！</p></div></div>    
</body>
</html>