<html>
<head>
<title>How to Use DALL-E API With C#.NET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C#如何使用DALL-E API？网</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-text-to-image-generator-using-dall-e-api-in-c-net-7df58d940e79?source=collection_archive---------2-----------------------#2022-11-07">https://betterprogramming.pub/create-a-text-to-image-generator-using-dall-e-api-in-c-net-7df58d940e79?source=collection_archive---------2-----------------------#2022-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="66dd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">制作文本到图像生成器的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/af08ce415c1aa0c3fc74fb1bdde9c95b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GNusy6z5P2EPBtxY.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:<a class="ae kr" href="https://openai.com/blog/dall-e/" rel="noopener ugc nofollow" target="_blank">https://openai.com/blog/dall-e</a></p></figure><p id="fcf3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">DALL-E是一个人工智能系统，可以将自然语言或文本描述转换为现实的图像和艺术。DALL-E非常棒。它发布后，我在网上看到了无数的讨论。从开发者到艺术家到艺术爱好者，他们中的大多数都同意这项技术确实处于下一个水平。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f5a9e6dc4ef427201c4f5a84e17d4bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6KYQ0WqC4UnnKjTt.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特——使用DALL-E预览应用程序生成</p></figure><p id="db7c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">上周五，2022年11月4日，我收到了一封来自OpenAI的电子邮件，宣布DALL-E API的可用性。从去年开始我就一直在等这个。现在这个API已经可以使用了，我很高兴能尝试一下。</p><p id="064c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我访问了<a class="ae kr" href="https://beta.openai.com/docs/guides/images" rel="noopener ugc nofollow" target="_blank">网站</a>并寻找文档。我找到了支持Node.js、Python和curl的API文档。我是一名. NET开发人员，找不到。所以我决定和你分享我如何在我的NetCore项目中使用DALL-E API。</p><p id="0306" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在本演示中，您不需要在Netcore中制作项目。我用的是纯的。NET库，所以不管你用NET Standard还是NetCore，两者都支持。现在让我们创建一个项目，好吗？:)</p><p id="54d2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这个演示中，我使用Visual Studio 2022预览版创建了这个项目。<br/>该项目是一个ASP.Net核心Web应用程序(MVC)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/95d2d5d5cab854445fc16d6c31020afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sHFbMykR_7fwJDX8.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><p id="cefa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我准备把它命名为<code class="fe lo lp lq lr b">DALLEAPIDemo</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/79436338cae591f28e62a658b70147e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WLwUGE9clGTM9qmu.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><p id="6bbf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">框架是. NET6.0，那么剩下的我就不做改动了。然后点击“创建”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/f1b3743c1e1df9debd23fe7f48f02074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nshHbzT7HfFmgNhP.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><p id="8771" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">创建项目后。左侧是“解决方案资源管理器”<br/>右键单击依赖项&gt;管理Nuget包&gt;浏览选项卡&gt;搜索Newtonsoft.json &gt;选择第一个，如下图所示&gt;单击浏览选项卡最右边的安装按钮。</p><p id="563e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">*在下图中,“安装”按钮标记为“卸载”,因为它已经安装。我们将使用Newtonsoft库来序列化和反序列化对象。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi kf"><img src="../Images/df7b55dce18c3a115584523100af3c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Opn5gIjTrm2emkx6.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><h2 id="2c6a" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">打开API密钥</h2><p id="4c02" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">才能调用DALL-E API。首先，我们需要保护一个API密钥，因为需要将它包含在我们的头中，这样API就知道是谁在发送请求。</p><p id="1da9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">要获得API密钥，我们需要一个OpenAI帐户。可以在这里报名<a class="ae kr" href="https://auth0.openai.com/u/signup/identifier?state=hKFo2SA3RHllVjFhdkFxdlo1MWtXUV9xTnhkUHAxZGxoaDJHM6Fur3VuaXZlcnNhbC1sb2dpbqN0aWTZIElvcm0tMDg3cXVvQVZJNU9XOXV6OVI4ci1xaG5FY200o2NpZNkgRFJpdnNubTJNdTQyVDNLT3BxZHR3QjNOWXZpSFl6d0Q" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="46f9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">成功创建帐户后。登录您的帐户，单击您的个人资料图标，单击下拉菜单中的查看API密钥，然后单击“+创建新密钥”按钮。</p><p id="5dbe" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">复制API密钥并临时保存在某个地方，例如，在记事本中。我们以后会用到它。</p><ul class=""><li id="52dd" class="mu mv iq ku b kv kw ky kz lb mw lf mx lj my ln mz na nb nc bi translated">使用DALL-E API生成图像不是免费的，但是价格非常合理。请参考文档的定价部分。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/aa08800d4faae217cb1c8e9a82b7a105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vXVz30M0d5k0NkA8.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><p id="922a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在让我们编码。</p><h2 id="737b" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">应用程序设置. json</h2><p id="6807" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">添加一个<code class="fe lo lp lq lr b">OPEN_API_KEY</code>项，然后将值设置为您之前保存的API键。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="7a29" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">模特们</h2><p id="f879" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">在解决方案浏览器中，打开<code class="fe lo lp lq lr b">Models</code>文件夹，创建一个新项目<code class="fe lo lp lq lr b">ResponseModel.cs</code>，并在作为我们输入模型的<code class="fe lo lp lq lr b">input</code>、<code class="fe lo lp lq lr b">Link</code>和<code class="fe lo lp lq lr b">ResponseModel</code>中创建三个模型类，其中<code class="fe lo lp lq lr b">ResponseModel</code>将用于映射DALL-E API响应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="fd1a" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">控制器</h2><p id="5876" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">在解决方案资源管理器中展开<code class="fe lo lp lq lr b">Controllers</code>文件夹，并查找<code class="fe lo lp lq lr b">HomeController.cs</code>。</p><p id="a35f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">创建一个字符串变量<code class="fe lo lp lq lr b">APIKEY</code>并将其值设置为空。在构造函数中，注入<code class="fe lo lp lq lr b">IConfiguration</code>接口，这样我们就可以访问<code class="fe lo lp lq lr b">appsettings.json</code>中的元素，然后设置<code class="fe lo lp lq lr b">APIKEY</code>的值。</p><pre class="kg kh ki kj gt nf lr ng nh aw ni bi"><span id="1053" class="lw lx iq lr b gy nj nk l nl nm">string APIKEY = string.Empty;<br/>        public HomeController(IConfiguration conf)<br/>        {<br/>            APIKEY = conf.GetSection("OPENAI_API_KEY").Value;<br/>        }</span></pre><p id="c40e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在，让我们创建一个<code class="fe lo lp lq lr b">HTTP POST</code>动作并将其命名为<code class="fe lo lp lq lr b">GenerateImage</code>，它接受输入模型作为来自请求体的参数。</p><p id="a6d8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在<code class="fe lo lp lq lr b">GenerateImage</code>方法中，我们创建一个<code class="fe lo lp lq lr b">ResponseModel</code>的实例，并将其命名为<code class="fe lo lp lq lr b">resp</code>。然后我们将创建一个新的<code class="fe lo lp lq lr b">HttpClient</code>实例。接下来，我们将清除默认头，因为我们不希望请求有不必要的头。然后，我们将添加一个授权头，从这里开始，我们将使用<code class="fe lo lp lq lr b">APIKEY</code>。</p><p id="2b61" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然后，我们将使用apipath和使用<code class="fe lo lp lq lr b">JsonConvert.SerializeObject</code>作为主体的序列化输入模型调用<code class="fe lo lp lq lr b">client.PostAsync</code>方法，并将其contentType设置为“application/json”</p><p id="ba7e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果响应代码成功，我们将读取内容，并使用来自<code class="fe lo lp lq lr b">Newtonsoft.json</code>的<code class="fe lo lp lq lr b">JsonConvert.DeserializeObject</code>类从内容的反序列化值中设置<code class="fe lo lp lq lr b">resp</code>的值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="6436" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">完整的<code class="fe lo lp lq lr b">HomeController</code>应该是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="c5f2" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">景色</h2><p id="478d" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">在您的右侧，解决方案资源管理器&gt;视图&gt;主页&gt;打开<code class="fe lo lp lq lr b">Index.cshtml</code></p><p id="3291" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">观点很简单。我们将添加一个页面标题“DALL-E API in .NET”，然后我们将添加一个文本区域<code class="fe lo lp lq lr b">txt</code>用于提示，一个接受数字<code class="fe lo lp lq lr b">quantity</code>的输入，该数字用于表示您想要生成的图像的数量，一个组合框/选择<code class="fe lo lp lq lr b">sel</code>用于用户选择图像大小，一个按钮<code class="fe lo lp lq lr b">btn</code>，以及一个div <code class="fe lo lp lq lr b">display</code>用于显示图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="9a00" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">JavaScript</h2><p id="e68d" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">在您的解决方案浏览器上，展开<code class="fe lo lp lq lr b">wwwroot</code>文件夹、<code class="fe lo lp lq lr b">js</code>文件夹，然后打开<code class="fe lo lp lq lr b">site.js</code>。</p><p id="1827" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这里，我们将创建一个按钮点击事件监听器，并实例化一个<code class="fe lo lp lq lr b">input</code>对象作为我们的请求体。然后我们将向home controller&gt;generate image方法发送一个post请求，并将<code class="fe lo lp lq lr b">input</code>对象作为参数。</p><p id="9152" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果请求成功，我们将得到JSON格式的响应，然后我们将遍历包含图像URL的数据对象。之后，我们将创建一个带有img元素的div并从DALL-E API生成的响应URL中设置其来源，并将其追加到<code class="fe lo lp lq lr b">display</code> div中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="8bdf" class="lw lx iq bd ly lz ma dn mb mc md dp me lb mf mg mh lf mi mj mk lj ml mm mn mo bi translated">输出</h2><p id="08e9" class="pw-post-body-paragraph ks kt iq ku b kv mp jr kx ky mq ju la lb mr ld le lf ms lh li lj mt ll lm ln ij bi translated">运行应用程序，输入你的文本，输入你想要生成的图像数量，选择图像大小，然后点击生成按钮，瞧！这是你的文本到图像生成器。NET与DALL-E API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi nn"><img src="../Images/4ed7aefabf70d24fca055510d15fc362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KeojQvH1AUihTRReR2yljA.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">摄影:漫威·德兰特</p></figure><p id="f58f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">令人着迷的是。NET也可以使用DALL-E API。通过这个演示项目，我们可以探索将DALL-E嵌入到各种应用中的其他可能性。Net项目，如桌面、移动和其他。网络应用之外的网络应用。</p><p id="c5a8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果你喜欢技术和编码主题，请欣赏我更多的作品。这将是我写更多的动力。</p><p id="610d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">谢谢您们。</p><p id="2e90" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">各位编码愉快。</p></div></div>    
</body>
</html>