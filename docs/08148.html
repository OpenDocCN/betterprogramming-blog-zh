<html>
<head>
<title>How To Make Your Python Web Scraper 10X Faster With Multi-Threading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何利用多线程将Python Web Scraper速度提高10倍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/make-your-web-scraper-10x-faster-with-multi-threadings-223708c39016?source=collection_archive---------7-----------------------#2021-03-31">https://betterprogramming.pub/make-your-web-scraper-10x-faster-with-multi-threadings-223708c39016?source=collection_archive---------7-----------------------#2021-03-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5072" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建一个股市网络机器人，它可以更快地获取价格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1c3bef6c3a10eeec40c47a9b53e675a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JA0j5bx_s6h8PMJj"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@vladhilitanu" rel="noopener ugc nofollow" target="_blank">弗拉德·希利塔努</a>在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="8ba6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的上一篇文章中，我们讨论了Python web抓取。现在，我们能够从页面中获取我们想要的任何数据。</p><p id="2f6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果我们想从多个页面获取数据，需要多长时间？答案是，你想抓取的页面越多，需要的时间就越长。今天，我将向你展示所有酷孩子是如何大大加快整个过程的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6d85" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">获取多只股票的当前价格</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/3335692c8ab1db6f3dbfeb04ac7f5bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3BEuCUGOwwXAqY01bJfGyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图来自<a class="ae ky" href="https://finance.yahoo.com/" rel="noopener ugc nofollow" target="_blank">雅虎财经</a>。</p></figure><p id="1c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想要获得上面截图中所有股票的当前价格。最直观的方法是运行一个<code class="fe mv mw mx my b">for</code>循环，最后收集所有返回值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/4b4b183f10855ddecb2024b161963131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*on1Tw4Vl1XE0Fe3044_j2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出和经过时间</p></figure><p id="3869" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们的第一种方法。我计算了获得所有这些价格所需的时间。现在是11.34秒，<strong class="lb iu"> </strong>如果你想获得更多的当前价格，可能需要更长的时间。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><h2 id="faab" class="nc md it bd me nd ne dn mi nf ng dp mm li nh ni mo lm nj nk mq lq nl nm ms nn bi translated">我是如何抓取当前价格的</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/80e8ed0f79f18add063410b0e21c1675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMD6DV5zXI5Vr6NOaem3ww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检查页面以定位我们的目标。</p></figure><p id="b38f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们深入多线程之前，我想充分解释一下我是如何获得当前价格数据的。</p><p id="98e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你点击<code class="fe mv mw mx my b">inspect</code>，你会看到当前的价格数据在这里:<code class="fe mv mw mx my b">&lt;span class=”Trsdu(0.3s) Fw(b) Fz(36px) Mb(-4px) D(ib)” data-reactid=”50"&gt;2,055.54&lt;/span&gt;</code>。我们可以使用class属性直接访问这一行，因为当前价格(2，055.54)应用的样式在整个页面上是唯一的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="74f1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">是时候加入我们的魔法酱了——多线程</h1><p id="e7ca" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">如果我们的第一种方法是一场接力赛，你只能在一个车道上跑，那么多线程就像是让你想跑多少就跑多少，在不同的车道上跑。每个线程都被分配了一项任务，但多线程允许您同时完成所有任务，而不是一个接一个地完成任务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2dd020e50fa0e1d878dc7d5b4ff5b6cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7PQl9Z5gaWt4__yl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@mattlee" rel="noopener ugc nofollow" target="_blank">马特·李</a>在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="62d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在只需要1.74秒！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/6334c41cd1a6d222f4c5da56c79ebf6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76Tr4H5nQc7GS6Gyi3dQAg.png"/></div></div></figure><p id="9ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想先指出结果，因为没有理由不使用多线程。快了差不多十倍！要应用这项技术，我们只需调整<code class="fe mv mw mx my b">current_price_fetcher</code>功能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="b590" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第17行，我们给每个线程分配一个任务，并将返回值存储在一个队列中。一旦我们完成赋值，我们就可以告诉线程开始运行。在第20-21行，我们等待这些线程穿过终点线并加入它们。最后，在第22-23行，我们<code class="fe mv mw mx my b">get</code>了队列中的所有数据，并将它们附加到我们的价格表中。</p><p id="7502" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就对了。我们刚刚优化了我们的网络机器人，现在它的运行速度比以前快了十倍！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1f32" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考</h1><ol class=""><li id="114e" class="nv nw it lb b lc np lf nq li nx lm ny lq nz lu oa ob oc od bi translated"><a class="ae ky" href="https://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#arg-attrs" rel="noopener ugc nofollow" target="_blank">美汤文档</a></li><li id="40c8" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">堆栈溢出— <a class="ae ky" href="https://stackoverflow.com/questions/6893968/how-to-get-the-return-value-from-a-thread-in-python" rel="noopener ugc nofollow" target="_blank">如何在python中获取线程的返回值？</a></li></ol></div></div>    
</body>
</html>