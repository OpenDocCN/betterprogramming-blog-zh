<html>
<head>
<title>How GitOps Makes Software Development Processes More Efficient</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitOps如何提高软件开发过程的效率</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-gitops-makes-software-development-processes-more-efficient-8a22a99f718c?source=collection_archive---------10-----------------------#2021-10-04">https://betterprogramming.pub/how-gitops-makes-software-development-processes-more-efficient-8a22a99f718c?source=collection_archive---------10-----------------------#2021-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="18c1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">强大的GitOps概念通过自动化加速开发</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5c17ff6262f8d883a45a68b93ad57be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kddnXkiDGsjZ0YT9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jacksloop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰克单桅帆船</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="ea03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据Puppet的"【2020年DevOps报告状态，"超过40%的高级DevOps 公司已经在使用<a class="ae ky" href="http://seekoapp.io/61583362efc5be000997fbc8" rel="noopener ugc nofollow" target="_blank"> GitOps </a>概念来启用"自助式开发团队"</p><p id="8c32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新方法的使用提高了IT运营的效率并加快了流程。值得注意的是，DevOps方法代表了一个重大进步，因为它允许开发人员和It运营人员更紧密地合作。这种方法只会影响企业文化。只有几个具体的例子。<a class="ae ky" href="http://seekoapp.io/61583360efc5be000997fbc4" rel="noopener ugc nofollow" target="_blank">持续集成</a> (CI)或<a class="ae ky" href="http://seekoapp.io/61583361efc5be000997fbc6" rel="noopener ugc nofollow" target="_blank">持续交付</a> (CD)是自动化流程的两个最佳实践。</p><p id="eb3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps是一种完全不同的方法，用于自动化软件应用程序的操作，使IT操作的任务对开发团队来说很容易获得。</p><h2 id="dd65" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是GitOps？</h2><p id="1f1f" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这种方法依赖于目标状态的声明性描述，通过特殊软件不断与实际状态进行比较。</p><p id="cb1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，就有可能自动纠正差异和错误以产生目标状态。</p><p id="ed7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">原则上，没有DevOps的GitOps是可能的，没有GitOps的DevOps也是可能的，但这两种方法完美地互补，一起使用是有意义的。</p><p id="872a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单来说，GitOps是一套独特的管理Kubernetes和类似平台的方法。亚历克西斯·理查森创造了“GitOps”这个术语。他是<a class="ae ky" href="http://seekoapp.io/61582ee1d803b60008b3c961" rel="noopener ugc nofollow" target="_blank"> Weaveworks </a>的联合创始人兼CEO。</p><p id="e37d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Weaveworks将GitOps描述为Kubernetes和云原生开发中使用的其他技术的操作模型。根据声明，GitOps提供了一套统一部署、管理和监控容器集群和应用程序的最佳实践。</p><p id="8712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我以一种开发人员友好的方式对其进行总结，以管理应用程序，并为运营和开发实现端到端的CI/CD管道和g it工作流。</p><h1 id="a92d" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">GitOps对CIOps</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/46f428f155cbb9b0e1284780d16a436a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Aa64KwD2eGbyfTQK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@yawan_sahu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">雅万萨胡</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2df1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">术语GitOps源自版本管理软件Git。</p><p id="1c43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与DevOps方法相比，Ops是“操作”的缩写</p><p id="a9be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps的目标是使开发人员能够高效地执行IT运营领域的任务。与CI/CD管道的经典实现相比，这一概念得到了最好的说明，现在称为CIOps，以便更好地将其与GitOps区分开来。</p><p id="b261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在CIOps管道中，CI服务器执行到操作环境的部署。</p><p id="c3ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不同阶段的实现可以通过使用Git中的分支来完成，其中开发分支包含集成开发状态，主分支包含生产版本。</p><p id="48e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一个简单的CD策略中，每次推进开发都会导致部署准备阶段，而推进主阶段会导致生产阶段。因此，试运行中的最后一个集成版本可以用于测试，然后main上的一个pull请求可以开始将该版本部署到生产环境中。</p><p id="b9fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个程序还有改进的余地。CI服务器必须为每个部署运行构建。这意味着一个版本必须在所描述的方法中构建两次。</p><p id="9373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，相同的工件可以用于所有阶段。这就是GitOps的用武之地，它允许CI服务器执行构建，存储工件，然后用于不同阶段的部署。</p><p id="3649" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps操作者不断地将目标阶段的状态与Git存储库中描述的实际阶段进行比较。不匹配将被自动纠正。</p><h1 id="11c7" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">实际实施GitOps的工具</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/16a875a2d5701902bccdda3161222d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8IFjshAueCARut7o"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@nhoizey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">尼古拉斯·霍伊泽</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f722" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps起源于Kubernetes环境，这是它被最广泛采用的地方，尽管现在也有在其他环境中使用该应用程序的方法。</p><p id="c472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Kubernetes中，GitOps的实现是通过上面提到的操作符来完成的，这些操作符也称为定制控制器。GitOps操作符在一个<a class="ae ky" href="http://seekoapp.io/6158335cefc5be000997fbc0" rel="noopener ugc nofollow" target="_blank"> K8s集群</a>上运行，并执行一个协调循环，其中描述的目标状态与集群的实际状态永久协调并同步。这确保了系统对应于Git中所示的状态。</p><p id="21d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://seekoapp.io/6158335cefc5be000997fbbe" rel="noopener ugc nofollow" target="_blank"> Flux </a>和<a class="ae ky" href="http://seekoapp.io/6158335aefc5be000997fbbc" rel="noopener ugc nofollow" target="_blank"> Argo </a> CD是最流行和最广泛使用的<a class="ae ky" href="http://seekoapp.io/6158335aefc5be000997fbba" rel="noopener ugc nofollow" target="_blank">云原生计算基础</a> (CNCF)实现。CNCF的最终用户社区将Flux 2020评为“可部署”，因此推荐它。</p><p id="3b11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitOps上下文中的其他操作符包括<a class="ae ky" href="http://seekoapp.io/61583359efc5be000997fbb8" rel="noopener ugc nofollow" target="_blank"> Fleet </a>、<a class="ae ky" href="http://seekoapp.io/61583359efc5be000997fbb6" rel="noopener ugc nofollow" target="_blank"> Jenkins-X </a>和<a class="ae ky" href="http://seekoapp.io/61583358efc5be000997fbb4" rel="noopener ugc nofollow" target="_blank"> werf </a>。</p><ul class=""><li id="5928" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">Fleet旨在能够管理不止一个集群，而是整个集群。</li><li id="a1f4" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">Jenkins-X是一个完整的CI/CD应用程序。与Flux和ArgoCD不同，它不需要额外的CI服务器，而且其功能要丰富得多，因此不太灵活。</li><li id="d568" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">相比之下，<code class="fe nt nu nv nw b">werf</code>代表了GitOps操作符和经典CIOps方法之间的一种折衷。该工具在集群之外运行，但仍然可以像操作者一样将来自Git的Kubernetes资源应用到集群。但是，这不允许pull原则在集群中实现，从Git中拉出它的目标状态。</li></ul><p id="73ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过声明性地描述GitOps中的状态，有些东西不能直接实现，这就需要额外的操作符。这些用所谓的<a class="ae ky" href="http://seekoapp.io/61583357efc5be000997fbb2" rel="noopener ugc nofollow" target="_blank">定制资源定义</a> (CRDs)扩展了Kubernetes API服务器，并提供了<a class="ae ky" href="http://seekoapp.io/61583356efc5be000997fbb0" rel="noopener ugc nofollow" target="_blank">定制资源</a> (CRs)，支持状态的声明性描述。</p><p id="1a30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模板工具<a class="ae ky" href="http://seekoapp.io/61583355efc5be000997fbae" rel="noopener ugc nofollow" target="_blank"> Helm </a>和<a class="ae ky" href="http://seekoapp.io/61583354efc5be000997fbac" rel="noopener ugc nofollow" target="_blank"> Kustomize </a>仍然可以通过CR使用，即使是声明性描述，例如使用Flux。</p><p id="4840" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将CR应用到集群时，Helm或Kustomize操作符处理模板和覆盖。此外，还有其他GitOps运营商用于实现不同的部署策略，如蓝/绿部署、金丝雀发布或A/B测试，概括为所谓的“渐进交付”</p><p id="28e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，这里的解决方案是<a class="ae ky" href="http://seekoapp.io/61583353efc5be000997fbaa" rel="noopener ugc nofollow" target="_blank"> flagger </a>或<a class="ae ky" href="http://seekoapp.io/61583352efc5be000997fba8" rel="noopener ugc nofollow" target="_blank"> Argo rollouts </a>。</p><h1 id="6d8a" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">GitOps更安全</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/3894348eaf068a27be554998ea2e49bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ynLPmuXH4MHg-zQx"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@franckinjapan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗兰克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="36a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他运营商也可以克服在安全性方面存在的挑战。</p><p id="d597" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将整个状态存储在Git中，需要加密和解密的秘密也随之结束。例如，Bitnami 的<a class="ae ky" href="http://seekoapp.io/61583351efc5be000997fba6" rel="noopener ugc nofollow" target="_blank"> Sealed Secrets操作员管理集群中的密钥材料，其中存在用于加密的命令行，这需要连接到集群。</a></p><p id="3dfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Mozilla开发的<a class="ae ky" href="http://seekoapp.io/61583350efc5be000997fba4" rel="noopener ugc nofollow" target="_blank"> SOPS </a>，密钥材料来自自我管理的PGP密钥、云提供商的<a class="ae ky" href="http://seekoapp.io/61583350efc5be000997fba2" rel="noopener ugc nofollow" target="_blank">密钥管理</a>系统(KMS)或其自己的<a class="ae ky" href="http://seekoapp.io/6158334fefc5be000997fba0" rel="noopener ugc nofollow" target="_blank"> HashiCorp保险库</a>。</p><p id="5e77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SOPS不包含操作符，但是可以使用Flux v2之类的插件将它集成到GitOps中。</p><p id="dd4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相比之下，Kamus提供一个运营商，从提供商的KMS获得密钥材料或管理它。</p><h1 id="5d70" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">GitOps优势</h1><p id="6bc3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">总的来说，GitOps对于开发团队来说相对容易使用，因为他们可以使用他们已经知道的工具，除了操作员，他们必须学习新的方法和软件。</p><p id="d013" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们还可以直接从代码库中管理软件产品。</p><p id="bd45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为GitOps是从集群内部运行的，所以从外部对集群的写访问很少与集群自动与Git同步相关联。</p><p id="140e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，不需要在CI服务器上存储任何凭证，因为它不需要访问群集。</p><p id="58cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一般来说，访问Git比访问API服务器要容易得多，因为您不需要激活防火墙。</p><h1 id="1ea8" class="mt lw it bd lx mu mv mw ma mx my mz md jz na ka mg kc nb kd mj kf nc kg mm nd bi translated">试试GitOps</h1><p id="af45" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">您可能很难理解GitOps原理及其许多不同的操作符。但我能给你的最好建议是——尝试一下。</p><p id="d760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个在<a class="ae ky" href="http://seekoapp.io/6158334fefc5be000997fb9e" rel="noopener ugc nofollow" target="_blank">cloud ogu/GitOps-playground</a>实现GitOps的示例。</p><p id="e00c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此repo包含一个完整的可复制GitOps基础架构。它使用一个Kubernetes集群、一个CI服务器(Jenkins)、一个源代码管理(SCM manager)和不同的GitOps操作符(Flux和Argo CD)，在这些组件上已经预先配置了示例应用程序。</p></div></div>    
</body>
</html>