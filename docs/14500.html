<html>
<head>
<title>Preventing Jailbreak in iOS Apps: Best Practices and Techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">防止iOS应用程序越狱:最佳实践和技术</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/preventing-jailbreak-in-ios-apps-best-practices-and-techniques-c1364c833c08?source=collection_archive---------7-----------------------#2022-12-26">https://betterprogramming.pub/preventing-jailbreak-in-ios-apps-best-practices-and-techniques-c1364c833c08?source=collection_archive---------7-----------------------#2022-12-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="da64" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">保护您的应用和业务</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/43ac31cb07b880e0d1289bbba97ddbac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nt_jRltzfFUGIjAJ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@emilianobar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">埃米利亚诺酒吧</a>拍摄的照片</p></figure><p id="7421" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">越狱是一个允许用户访问其iOS设备的根文件系统并安装未经授权的应用程序和修改的过程。这通常是通过利用操作系统中的漏洞并应用内核补丁来消除制造商强加的软件限制来实现的。</p><p id="1755" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过越狱他们的设备，用户可以访问根文件系统，这通常仅限于操作系统和授权的应用程序。这使得他们可以安装和运行未经批准的软件，无法通过应用商店，并修改操作系统及其行为。<br/>这个过程类似于在Android设备中扎根，允许用户获得对各种Android子系统的特权控制或根访问。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="64f0" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">越狱的好处</h1><ul class=""><li id="6151" class="mr ms iq ky b kz mt lc mu lf mv lj mw ln mx lr my mz na nb bi translated"><strong class="ky ir">定制</strong>:越狱允许用户定制他们设备的外观和感觉，以及添加App Store不提供的新特性和功能。例如，网飞iOS应用程序的用户可能想要越狱他们的设备，以安装自定义主题或添加一个功能，允许他们下载并离线观看他们最喜欢的系列或电影，而无需订阅。</li><li id="61f2" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">访问替代应用商店/黑色应用商店</strong>:越狱可以让用户访问替代应用商店，这些商店提供更全面的应用和游戏选择，包括那些由于苹果严格的指导方针而可能无法在应用商店上获得的应用和游戏。</li><li id="ef96" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">性能提升:</strong>一些用户可能会越狱他们的设备以优化其性能，并删除制造商可能安装的任何不必要的膨胀软件。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d7b8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">越狱的潜在风险和弊端</h1><ul class=""><li id="3bb7" class="mr ms iq ky b kz mt lc mu lf mv lj mw ln mx lr my mz na nb bi translated"><strong class="ky ir">取消保修:</strong>越狱iOS设备通常会取消设备的保修，这意味着如果设备出现问题，用户可能无法从制造商那里获得免费维修或支持。</li><li id="91b3" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">安全问题:</strong>越狱会使设备暴露于非越狱设备中可能不存在的漏洞。例如，安装来自不可信来源的未经批准的应用程序或修改可能会增加恶意软件或其他安全威胁的风险。</li><li id="d21e" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">兼容性问题:</strong>一些应用和功能可能无法在越狱设备上正常工作，因为它们可能依赖于不可用的或已被越狱修改的系统级功能。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1cda" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">开发人员可以采取的措施，以检测和防止其iOS应用程序中的越狱</h1><p id="970e" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated"><strong class="ky ir">检查特定文件或目录的存在:</strong>检测越狱的一种方法是检查越狱工具常用的特定文件或目录。例如，Swift中的以下代码片段检查<code class="fe nk nl nm nn b">/Applications/Cydia.app</code>目录是否存在，该目录通常出现在越狱设备上:</p><pre class="kg kh ki kj gt no nn np bn nq nr bi"><span id="56c2" class="ns ma iq nn b be nt nu l nv nw">if FileManager.default.fileExists(atPath: "/Applications/Cydia.app") {<br/> // Device is jailbroken<br/>} else {<br/> // Device is not jailbroken<br/>}</span></pre><p id="48fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nk nl nm nn b">/Applications/Cydia.app</code>目录经常出现在越狱设备上，因为Cydia应用程序，一个流行的越狱设备包管理器，使用它。Cydia允许用户浏览和安装App Store上没有的第三方应用和修改。</p><p id="5ddb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">使用苹果提供的API:</strong>苹果提供了很多API，可以用来检测越狱。例如，<code class="fe nk nl nm nn b">UIApplication</code>类的<code class="fe nk nl nm nn b">canOpenURL()</code>函数可以用来检查设备是否可以打开一个已知被越狱工具使用的URL。Swift中的以下代码片段检查设备是否可以打开Cydia URL，这是越狱工具经常使用的:</p><pre class="kg kh ki kj gt no nn np bn nq nr bi"><span id="a92a" class="ns ma iq nn b be nt nu l nv nw">if UIApplication.shared.canOpenURL(URL(string: "cydia://package/com.example.package")!) {<br/>    // Device is jailbroken<br/>} else {<br/>    // Device is not jailbroken<br/>}</span></pre><p id="cf08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nk nl nm nn b">canOpenURL()</code>功能作为一种越狱检测方法，因为越狱工具经常修改操作系统，以允许安装和执行未经授权的应用程序和修改。因此，越狱设备可能能够打开在非越狱设备上通常无法访问的URL。通过检查设备是否能打开<code class="fe nk nl nm nn b">cydia://package/com.example.package</code> URL，开发者可以推断设备已经越狱，可能修改了系统级函数。</p><p id="7ad4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">实现自定义检查:</strong>开发者也可以实现自己的检查来检测越狱。例如，他们可以检查非越狱设备上通常不存在的特定系统库或框架。Swift中的以下代码片段演示了如何检查<code class="fe nk nl nm nn b">libsubstrate.dylib</code>库的存在，越狱工具经常使用该库:</p><pre class="kg kh ki kj gt no nn np bn nq nr bi"><span id="5e27" class="ns ma iq nn b be nt nu l nv nw">let libraryPath = "/Library/MobileSubstrate/MobileSubstrate.dylib"<br/>if FileManager.default.fileExists(atPath: libraryPath) {<br/>    // Device is jailbroken<br/>} else {<br/>    // Device is not jailbroken<br/>}</span></pre><p id="6b8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不仅仅是这种文件检查，还有许多文件和目录可供开发人员检查，以检测iOS设备中的越狱。这里有几个例子:</p><ul class=""><li id="c064" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr my mz na nb bi translated">这个目录经常出现在越狱设备上，由Cydia应用程序使用，这是一个流行的越狱设备包管理器。</li><li id="c12b" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><code class="fe nk nl nm nn b">/usr/libexec/ssh-keysign</code>:这个文件经常出现在越狱设备上，由OpenSSH包使用，OpenSSH包通常由越狱工具安装。</li><li id="d62e" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><code class="fe nk nl nm nn b">/usr/libexec/sftp-server</code>:这个文件经常出现在越狱设备上，由OpenSSH包使用，OpenSSH包通常由越狱工具安装。</li><li id="b1a8" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><code class="fe nk nl nm nn b">/var/lib/apt</code>:这个目录经常出现在越狱设备上，由高级打包工具(APT)使用，APT是越狱工具经常使用的一个包管理系统。</li><li id="2ff6" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><code class="fe nk nl nm nn b">/etc/apt</code>:这个目录经常出现在越狱设备上，由高级打包工具(APT)使用，APT是一个越狱工具经常使用的包管理系统。</li></ul><pre class="kg kh ki kj gt no nn np bn nq nr bi"><span id="bf89" class="ns ma iq nn b be nt nu l nv nw">    static var suspiciousSystemPathsToCheck: [String] {<br/>        return ["/Library/MobileSubstrate/DynamicLibraries/LiveClock.plist",<br/>                "/Library/MobileSubstrate/DynamicLibraries/Veency.plist",<br/>                "/private/var/lib/apt",<br/>                "/private/var/lib/apt/",<br/>                "/private/var/lib/cydia",<br/>                "/private/var/mobile/Library/SBSettings/Themes",<br/>                "/private/var/stash",<br/>                "/private/var/tmp/cydia.log",<br/>                "/System/Library/LaunchDaemons/com.ikey.bbot.plist",<br/>                "/System/Library/LaunchDaemons/com.saurik.Cydia.Startup.plist",<br/>                "/usr/bin/sshd",<br/>                "/usr/libexec/sftp-server",<br/>                "/usr/sbin/sshd",<br/>                "/etc/apt",<br/>                "/bin/bash",<br/>                "/Library/MobileSubstrate/MobileSubstrate.dylib"<br/>        ]<br/>    }<br/><br/>    static func isSuspiciousSystemPathsExists() -&gt; Bool {<br/>        for path in suspiciousSystemPathsToCheck {<br/>            if FileManager.default.fileExists(atPath: path) {<br/>                return true<br/>            }<br/>        }<br/>        return false<br/>    }</span></pre><p id="e050" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得注意的是，这些文件和目录可能不会出现在所有越狱设备上，熟练的黑客可能能够修改或隐藏它们，以绕过越狱检测措施。因此，有必要考虑这些检查的潜在风险和局限性，并将其作为更大的越狱检测策略的一部分来实施。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a394" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">附加支票</h1><pre class="kg kh ki kj gt no nn np bn nq nr bi"><span id="ae20" class="ns ma iq nn b be nt nu l nv nw">    static var isSimulator: Bool {<br/>        #if targetEnvironment(simulator)<br/>            return true<br/>        #else<br/>            return false<br/>        #endif<br/>    }<br/>    <br/>    static var isOnMac: Bool {<br/>        if #available(iOS 14.0, *), ProcessInfo.processInfo.isiOSAppOnMac {<br/>            return true<br/>        }<br/>        return false<br/>    }</span></pre><ul class=""><li id="f8c7" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr my mz na nb bi translated"><code class="fe nk nl nm nn b">isSimulator</code>:该函数使用<code class="fe nk nl nm nn b">targetEnvironment</code>编译器指令来检查应用程序是否正在为模拟器编译。这对于希望根据应用程序是在实际设备上运行还是在模拟器上运行来执行不同操作的开发人员来说非常有用。</li><li id="ea6c" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><code class="fe nk nl nm nn b">isOnMac</code>:该函数使用iOS 14及更高版本中可用的<code class="fe nk nl nm nn b">ProcessInfo</code>类的<code class="fe nk nl nm nn b">isiOSAppOnMac</code>属性来检查应用程序是否在Mac上运行。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0bf4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="51fe" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">越狱iOS设备允许用户访问根文件系统，安装未经授权的应用程序和修改。尽管如此，它也带来了风险和缺点，如使设备的保修无效，并使其暴露于安全漏洞。开发人员可以在他们的应用程序中实施检测和防止越狱的措施，但需要注意的是，这些措施可能不是万无一失的。</p><p id="af78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得注意的是，熟练的黑客可以绕过或击败越狱检测技术，因此必须考虑这些措施的潜在风险和局限性。正如《权力的游戏》中的山姆威尔·塔利所说，“对于一个天才的傻瓜来说，没有什么是万无一失的。”然而，实施越狱检测措施可以为您的应用程序和业务提供额外的安全性和保护。</p><div class="oa ob gp gr oc od"><a href="https://github.com/Nikilicious09/Preventing-Jailbreak-in-iOS/blob/main/SecurityUtils.swift" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">防止在iOS中越狱/security utils . swift at main nikilicious 09/防止在iOS中越狱</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">开发人员如何保护您的应用和业务免受越狱威胁的实用指南…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div></div></div>    
</body>
</html>