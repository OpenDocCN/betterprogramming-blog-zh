<html>
<head>
<title>Subscribe to the Window’s Dimensions With React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React挂钩订阅窗口的尺寸</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/short-and-sweet-react-hook-to-subscribe-to-the-windows-dimensions-d791745fdfc8?source=collection_archive---------22-----------------------#2020-07-15">https://betterprogramming.pub/short-and-sweet-react-hook-to-subscribe-to-the-windows-dimensions-d791745fdfc8?source=collection_archive---------22-----------------------#2020-07-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a366" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你曾经需要在一个组件中读取窗口的尺寸吗？嗯，这个钩子可以做到这一点</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1474db9580fab50b02c33976d4cae6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wJ28DhWJCJzIzNHh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Pierre chtel-Innocenti在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="0c86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">注意:这段代码是用TypeScript编写的。</em></p><p id="e958" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从定义我们最终希望钩子的消费者接收到的状态开始。我们用形状<code class="fe lt lu lv lw b">{ x: number; y: number }</code>来定义它，并将默认值分别设置为窗口的当前(第一次调用钩子时)内部宽度和高度:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/828628daafacb7735fa3263ef63e5494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HKyJzknH40Wny6zsKpSDg.png"/></div></div></figure><p id="41c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面，我们定义一个函数，负责将状态设置为窗口的当前内部宽度和高度:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/706f0be2020ea54284a2f08444354fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*s8AgmreGUmgtGUDGvOcVKA.png"/></div></figure><p id="43e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们创建一个负责订阅<code class="fe lt lu lv lw b">resize</code>事件的效果，这样我们就可以在DOM调度它时运行我们的任意函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/8a377fb8f478c33c63ad8d1e3b43bff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*2wMVCjCWirlFByFfWV9imw.png"/></div></figure><p id="71b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在清理效果时，我们通过将<em class="ls"> </em>相同的引用传递给我们首先订阅的函数来移除监听器。最后，我们返回<code class="fe lt lu lv lw b">dimensions</code>。</p><p id="c63d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">注意:如果我们没有把</em> <code class="fe lt lu lv lw b"><em class="ls">eventCallback</em></code> <em class="ls">包在</em> <code class="fe lt lu lv lw b"><em class="ls">useCallback</em></code> <em class="ls">里面，</em> <code class="fe lt lu lv lw b"><em class="ls">useEffect</em></code> <em class="ls">钩子的依赖关系会在每次渲染时改变。</em></p><p id="dfc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">同样，向</em> <code class="fe lt lu lv lw b"><em class="ls">resize</em></code> <em class="ls">事件监听器的添加器和移除器传递相同的匿名函数也不会移除监听器！不要做如下所示:</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/476d9ee87559be398063be32fce3b193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wLLzSF80-wwBvx6YncXb5g.png"/></div></div></figure><p id="0cd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终文件如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/cbc01582c760d80a6eb15a1f07da552c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*Bz_19FuwR1zgvuj916HikQ.png"/></div></figure><p id="c3a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">消耗我们钩子的一个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/0fcbb361bac7a0e8ca4452c498bee84f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*m8dKzQQMwvP2m0IFz2jABg.png"/></div></figure><p id="5d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi md"><img src="../Images/b7683fa1d32fe41ef9d258c2906d4b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*f_3rC6Yf1ywcJN0xPUDx-Q.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi me"><img src="../Images/14cd5e51258efd116aea4bdce4cf75da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*5DFdVk_lHJmj4crlQGiv6Q.png"/></div></figure><p id="c4a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。感谢阅读！</p></div></div>    
</body>
</html>