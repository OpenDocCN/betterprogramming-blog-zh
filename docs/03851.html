<html>
<head>
<title>How to Handle Forms With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用React处理表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/handling-forms-with-react-26cae6c21427?source=collection_archive---------8-----------------------#2020-03-09">https://betterprogramming.pub/handling-forms-with-react-26cae6c21427?source=collection_archive---------8-----------------------#2020-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0690" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过编写受控组件来处理输入更改</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/63d946c4f2ba3879c6dc53b62704ac02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jl27OuZC69abgg70"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">朱利安·莫罗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2b03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将看看如何用React处理表单。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6cae" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">表单处理</h1><p id="827f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">处理表单输入值更改的标准方法是用React处理它们。这是一种叫做<em class="mz">受控组件</em>的技术。</p><p id="3e8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用<code class="fe na nb nc nd b">input</code>、<code class="fe na nb nc nd b">textarea</code>和<code class="fe na nb nc nd b">select</code>元素创建受控组件。它们维护自己的状态，并根据用户输入进行更新。</p><p id="10b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和其他事情一样，组件状态用<code class="fe na nb nc nd b">setState()</code>更新。这意味着我们必须用输入元素的值来调用它，以便用输入的值来更新状态。</p><p id="fb1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要用输入的值更新状态，我们可以编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="03cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们有一个<code class="fe na nb nc nd b">input</code>元素，它有一个设置为<code class="fe na nb nc nd b">this.handleChange</code>的<code class="fe na nb nc nd b">onChange</code>处理程序。<code class="fe na nb nc nd b">handleChange</code>方法具有用最新输入值更新<code class="fe na nb nc nd b">this.state.name</code>的代码。<code class="fe na nb nc nd b">event.target.value</code>有最新值。</p><p id="55db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们在表单上附加了一个<code class="fe na nb nc nd b">onSubmit</code>处理程序，它被设置为<code class="fe na nb nc nd b">this.handleSubmit</code>。</p><p id="152d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们调用<code class="fe na nb nc nd b">event.preventDefault</code>来阻止默认的提交动作，因此我们可以在处理程序中运行JavaScript代码来显示带有最新输入值的警告框。</p><p id="a9e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理程序方法使得处理输入验证变得容易。我们也可以在那里操纵它。例如，我们可以在更新状态之前更改输入值，如下所示:</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="2c05" class="nk md it nd b gy nl nm l nn no">handleChange(event) {<br/>  this.setState({name: event.target.value.toLowerCase()});<br/>}</span></pre><p id="7fed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在将输入设置为<code class="fe na nb nc nd b">this.state.name</code>之前，我们不必创建额外的函数来将输入转换为小写。</p><p id="8efa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe na nb nc nd b">value</code>属性将值设置为最新状态，这样我们就可以看到我们输入的值。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f1a4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">textarea标签</h1><p id="8ea2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">像处理<code class="fe na nb nc nd b">input</code>元素一样，我们可以用同样的方式处理<code class="fe na nb nc nd b">textarea</code>元素的值变化。</p><p id="c0ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以编写以下代码，将状态设置为最新输入的值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="925e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与处理来自<code class="fe na nb nc nd b">input</code>元素的输入值的代码非常相似，但是我们用一个<code class="fe na nb nc nd b">textarea</code>元素来代替。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="00a2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">选择标签</h1><p id="abdd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">元素创建了一个下拉菜单，我们可以从中选择更多的值。</p><p id="5ba3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以编写以下代码从下拉列表中获取选择，并将其设置为状态:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="74c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，它几乎和其他例子一样，除了我们有一个包含<code class="fe na nb nc nd b">option</code>元素的<code class="fe na nb nc nd b">select</code>元素。</p><p id="b3fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe na nb nc nd b">select</code>元素也有助于获得多重选择。我们可以通过获取可用的选项，获取选中的选项，并将它们放入一个数组来更新所有选择的状态，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="0794" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在代码中，我们有:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="fd9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在函数的第一行，我们有:</p><pre class="kj kk kl km gt ng nd nh ni aw nj bi"><span id="39cb" class="nk md it nd b gy nl nm l nn no">const options = event.target.options;</span></pre><p id="14e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它拥有来自<code class="fe na nb nc nd b">select</code>元素的所有选项。</p><p id="7748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以循环遍历<code class="fe na nb nc nd b">options</code>并检查每个的<code class="fe na nb nc nd b">selected</code>属性，如果<code class="fe na nb nc nd b">selected</code>为<code class="fe na nb nc nd b">true</code>，则将它们推送到数组中。然后我们用<code class="fe na nb nc nd b">fruits</code>调用<code class="fe na nb nc nd b">setState</code>，用最新选择的值更新状态。</p><p id="ade2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe na nb nc nd b">handleSubmit</code>中，我们可以用逗号对<code class="fe na nb nc nd b">this.state.fruits</code>和<code class="fe na nb nc nd b">join</code>进行调用，将其转换成逗号分隔的字符串。</p><p id="fd23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，<code class="fe na nb nc nd b">select</code>元素的<code class="fe na nb nc nd b">value</code>属性采用数组而不是字符串。React足够智能，可以解析数组并呈现所选的值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/34e8badef9aef252a49cca9208ce6405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7gbptrhRMSgONC0O"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@brookelark?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁克·拉克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5c62" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">处理多个输入</h1><p id="a19b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当我们需要处理多个输入时，我们不想为每个输入创建一个新的<code class="fe na nb nc nd b">onChange</code>处理函数。所以，我们想做一个可以设置所有值的函数。</p><p id="10a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="53fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们有下面的<code class="fe na nb nc nd b">handleChange</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="544a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们获取<code class="fe na nb nc nd b">event.target</code>对象，并将其设置为<code class="fe na nb nc nd b">target</code>。<code class="fe na nb nc nd b">target</code>具有<code class="fe na nb nc nd b">name</code>和<code class="fe na nb nc nd b">value</code>属性，它们分别具有输入的name和value属性值。</p><p id="9d4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们可以利用ES6的动态对象属性特性，调用<code class="fe na nb nc nd b">setState</code>，用<code class="fe na nb nc nd b">name</code>作为属性名，用<code class="fe na nb nc nd b">value</code>作为值来更新状态。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d469" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="9030" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们应该通过编写受控组件来处理输入变化。为此，我们为<code class="fe na nb nc nd b">onChange</code>事件附加了一个事件处理函数。</p><p id="551a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了处理表单提交，我们将一个<code class="fe na nb nc nd b">onSubmit</code>事件处理程序附加到表单上，然后从参数中获取<code class="fe na nb nc nd b">event</code>对象并在其中调用<code class="fe na nb nc nd b">event.preventDefault</code>，这样我们就可以在处理程序中运行JavaScript代码。</p><p id="bb04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了用一个<code class="fe na nb nc nd b">onChange</code>处理程序处理多个输入变化，我们从处理程序的参数中从<code class="fe na nb nc nd b">event.target</code>获取<code class="fe na nb nc nd b">name</code>和<code class="fe na nb nc nd b">value</code>属性，并用从ES6开始可用的动态属性名特性更新它。</p></div></div>    
</body>
</html>