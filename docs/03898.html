<html>
<head>
<title>Unlock the 4 Mysteries of self in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中解开自我的4个秘密</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/unlock-the-4-mysteries-of-self-in-python-d1913fbb8e16?source=collection_archive---------4-----------------------#2020-03-11">https://betterprogramming.pub/unlock-the-4-mysteries-of-self-in-python-d1913fbb8e16?source=collection_archive---------4-----------------------#2020-03-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d3de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python中使用self</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6d47f824ade8011aa83343e320ab09e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xnli-f_psWRhmFDv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">兰迪·雅各布在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="eb86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几乎没有例外，每门结构化的Python课程都有一个关于类的讲座——类是Python和任何其他面向对象编程语言的基本构建块之一。</p><p id="dacd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您通过一些例子学习它时，您会注意到Python类中定义的许多函数都将<code class="fe lv lw lx ly b">self</code>作为它们的第一个参数。例如，在下面的代码片段中，我们声明了一个名为<code class="fe lv lw lx ly b">Student</code>的类，它的<code class="fe lv lw lx ly b">greet()</code>方法将<code class="fe lv lw lx ly b">self</code>作为第一个参数。更何况函数体根本不用<code class="fe lv lw lx ly b">self</code>，这是很多初学者的第一个不解之谜。这到底是什么？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="d2e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">奇怪的是，我们在使用这个函数的时候，并没有给<code class="fe lv lw lx ly b">self</code>参数设置任何东西，这也是困扰我的另一个谜团。当我进一步探索Python中的<code class="fe lv lw lx ly b">self</code>时，我发现了更多的秘密，但最终能够弄清楚它是什么。因此，在这篇文章中，我想在一些Python学习者中分享这些普遍的奥秘。更重要的是，让我们一起来解开这些谜团。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mb"><img src="../Images/8f0c7464f7843a3452f2a0f98d57a7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMGoEQaHtxNKRW8UITFD1w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像由<a class="ae ky" href="https://pixabay.com/users/intographics-2633886/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1599527" rel="noopener ugc nofollow" target="_blank">转化为来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1599527" rel="noopener ugc nofollow" target="_blank">像素库</a>的图形</a>。</p></figure></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="4168" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">1.它代表什么？</h1><p id="1287" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在我们开始解决这个谜之前，我们需要理解两个相关的基本概念:类和实例。当然，解决所有这些谜团需要除了类和实例之外的额外知识，这一点我将在我们继续前进时阐明。如果你对这两个都很了解，你可以跳过下一段，这只是对这两个概念的简单概述。</p><p id="9a93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建Python类就是声明一种新的对象类型，它提供了一种将数据和功能捆绑在一起的机制。在上面的例子中，我们创建了一个名为<code class="fe lv lw lx ly b">Student</code>的类，使用它我们创建了一个名为<code class="fe lv lw lx ly b">student</code>的<code class="fe lv lw lx ly b">Student</code>类型的对象。这个对象被称为<code class="fe lv lw lx ly b">Student</code>类的一个实例。除此之外，这个类还可以提供一些特定的功能，一般称为属性，比如例子中的<code class="fe lv lw lx ly b">greet()</code>函数。我们使用三个内省(参见我的<a class="ae ky" href="https://medium.com/better-programming/the-5-most-useful-introspection-functions-in-python-7084e3bf9f01" rel="noopener">上一篇文章</a>关于Python的内省)函数(<code class="fe lv lw lx ly b">type()</code>、<code class="fe lv lw lx ly b">isinstance()</code>和<code class="fe lv lw lx ly b">hasattr()</code>)来检查相关信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="e0f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不用走太远，我可以告诉你<code class="fe lv lw lx ly b">greet()</code>函数中的<code class="fe lv lw lx ly b">self</code>参数就是上面例子中的实例<code class="fe lv lw lx ly b">student</code>。更一般地说，是实例调用这个函数。以下是支持证据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="4e7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们修改了<code class="fe lv lw lx ly b">greet()</code>函数，要求它使用内省<code class="fe lv lw lx ly b">id()</code>函数向我们显示<code class="fe lv lw lx ly b">self</code>参数的内存地址。如您所见，<code class="fe lv lw lx ly b">self</code>参数和实例<code class="fe lv lw lx ly b">student</code>是同一个对象，因为它们有相同的内存地址。</p><p id="e154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ng">解锁之谜:</em> <strong class="lb iu"> <em class="ng"> </em> </strong> <em class="ng">函数声明中的</em> <code class="fe lv lw lx ly b"><em class="ng">self</em></code> <em class="ng">自变量是指调用该函数的实例对象。</em></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="a08b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">2.为什么不需要在函数调用中设置？</h1><p id="1d39" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">继续上一节中显示的例子，当我们使用实例<code class="fe lv lw lx ly b">student</code>调用<code class="fe lv lw lx ly b">greet()</code>函数时，这个函数通常被称为实例方法——一个可用于某个类的实例的函数。但是，如果我们检查这个属性的类型，将会显示一些不同的内容。</p><pre class="kj kk kl km gt nh ly ni nj aw nk bi"><span id="06f4" class="nl mk it ly b gy nm nn l no np">&gt;&gt;&gt; student = Student()<br/>&gt;&gt;&gt; student.greet<br/>&lt;bound method Student.greet of &lt;__main__.Student object at 0x10eff5750&gt;&gt;</span></pre><p id="f27b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所述，实例<code class="fe lv lw lx ly b">student</code>的<code class="fe lv lw lx ly b">greet</code>属性被称为绑定方法。具体来说，它绑定到了类<code class="fe lv lw lx ly b">Student</code>的<code class="fe lv lw lx ly b">greet</code>属性。</p><p id="b6a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了准确理解这意味着什么，让我们看看下面的代码:</p><pre class="kj kk kl km gt nh ly ni nj aw nk bi"><span id="bf5b" class="nl mk it ly b gy nm nn l no np">&gt;&gt;&gt; Student.greet(student, 'John')<br/>Good Morning, John</span></pre><p id="416c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结合开头的示例，您可能已经注意到了这段代码中的三点:</p><ul class=""><li id="10e3" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">这个函数的调用者是类<code class="fe lv lw lx ly b">Student</code> —而不是实例<code class="fe lv lw lx ly b">student</code>。</li><li id="618f" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">在这个调用中，<code class="fe lv lw lx ly b">self</code>和<code class="fe lv lw lx ly b">name</code>参数都被设置，不像最初的函数调用是由<code class="fe lv lw lx ly b">student</code>进行的，其中省略了<code class="fe lv lw lx ly b">self</code>参数。</li><li id="120a" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">两个函数调用产生了相同的输出。它们本质上使用的是相同的功能。</li></ul><p id="0003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过了解这些信息，您可能已经猜到当我们使用实例<code class="fe lv lw lx ly b">student</code>调用<code class="fe lv lw lx ly b">greet()</code>函数时，幕后发生了什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0761954be0fc1b25a0798b3e23327bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ll6tZNIqomBk1xwE0pwEUQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">调用greet()方法。</p></figure><p id="46b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上图所示，当实例<code class="fe lv lw lx ly b">student</code>调用<code class="fe lv lw lx ly b">greet(‘John’)</code>方法时，这个函数调用被解释器处理为类<code class="fe lv lw lx ly b">Student</code>发送调用者(即实例<code class="fe lv lw lx ly b">student</code>)和<code class="fe lv lw lx ly b">name</code>参数(即<code class="fe lv lw lx ly b">‘John’</code>)给<code class="fe lv lw lx ly b">greet(self, name)</code>函数，输出“早安，John”</p><p id="a10f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于感兴趣的读者来说，这里有几个需要知道的事情，可以帮助你对这个谜团有更深入的了解。当一个Python类被创建时，它声明的函数就是该类的属性(称为<a class="ae ky" href="https://medium.com/swlh/everything-is-an-object-in-python-learn-to-use-functions-as-objects-ace7f30e283e" rel="noopener">函数对象</a>)。换句话说，这个类“拥有”这些函数。类的实例不会直接实现这些函数。相反，它们将具有相同的属性(也称为实例方法),这些属性绑定到在它们的类中实现的相应函数。</p><p id="6961" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ng">未解之谜:实例对象在调用实例方法时会自动设置为</em> <code class="fe lv lw lx ly b"><em class="ng">self</em></code> <em class="ng">参数。</em></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="57f4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">3.自我是关键词吗？</h1><p id="9574" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">似乎在所有这些定义的函数中，我们使用<code class="fe lv lw lx ly b">self</code>作为它们的第一个参数。有人可能会误以为<code class="fe lv lw lx ly b">self</code>是Python为这些用例保留的关键字。然而，事实并非如此。请看下面一个简单的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="0bba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能知道，<code class="fe lv lw lx ly b">def</code>和<code class="fe lv lw lx ly b">class</code>是Python中我们不能用作变量名的关键字。然而，我们可以在定义函数的上下文之外使用<code class="fe lv lw lx ly b">self</code>作为变量名，这表明它不是Python中的保留关键字。</p><p id="d42b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ng">解开谜团:</em> <code class="fe lv lw lx ly b"><em class="ng">self</em></code> <em class="ng">这个词在Python中并不是关键词。</em></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="a3eb" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">4.我们必须在这些函数声明中使用self吗？</h1><p id="d552" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在上面的例子中，我们反复提到了<code class="fe lv lw lx ly b">greet()</code>函数。正如我们已经讨论过的，我们将这个函数实现为一个实例方法，这样它就可以被这个<code class="fe lv lw lx ly b">Student</code>类的所有实例使用。在这种情况下，需要<code class="fe lv lw lx ly b">self</code>。请看下面的一些证据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="981e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一些分析。如前所述，当实例<code class="fe lv lw lx ly b">teacher</code>调用<code class="fe lv lw lx ly b">say_hello()</code>方法时，所发生的是执行<code class="fe lv lw lx ly b">Teacher.say_hello()</code>函数，实例对象<code class="fe lv lw lx ly b">teacher</code>和<code class="fe lv lw lx ly b">‘John’</code>被设置为函数调用。这就是错误显示“给出了2个”的原因这与函数的定义相反，函数的定义只有一个参数(<code class="fe lv lw lx ly b">name</code>)。</p><p id="5110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，还有两件事与这个谜有关，你可能想知道:</p><ul class=""><li id="4f05" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">尽管声明一个实例方法需要包含<code class="fe lv lw lx ly b">self</code>参数，但它不必被命名为<code class="fe lv lw lx ly b">self</code>。在这个场景中使用这个名称只是每个Python程序员都能理解的惯例。这里有一个例子告诉你，它可以被命名为其他名称，而不会引起任何问题。尽管这在语法上是正确的，但不建议这样做，因为这只会让其他Python程序员感到困惑:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><ul class=""><li id="64a0" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">当我们声明其他函数时，比如类和静态方法，我们不需要使用<code class="fe lv lw lx ly b">self</code>参数。对类和静态方法的清晰解释可以成为以后文章的主题。但是我这里可以给大家展示的是，当我们声明一个类方法的时候，函数确实有类似于<code class="fe lv lw lx ly b">self</code>在实例方法中的用法，习惯上称为<code class="fe lv lw lx ly b">cls</code>指的是类对象本身。与具体实例无关。下面给出一个例子:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="95de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ng">解锁之谜:</em> <code class="fe lv lw lx ly b"><em class="ng">self</em></code> <em class="ng">参数对于声明实例方法是必需的，对于类和静态方法不是必需的。</em></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="e240" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">外卖食品</h1><p id="76bf" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这四个谜团代表了Python程序员关于Python中<code class="fe lv lw lx ly b">self</code>的一些常见问题。看完这篇文章，我打赌你对<code class="fe lv lw lx ly b">self</code>及其预期用途有了更好的理解。</p><p id="a575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您阅读本文，并享受用Python编码的乐趣。</p></div></div>    
</body>
</html>