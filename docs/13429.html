<html>
<head>
<title>Over-Engineering the Infinite Loop in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">过度设计Python中的无限循环</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/over-engineering-the-infinite-loop-in-python-53450cb52132?source=collection_archive---------9-----------------------#2022-08-25">https://betterprogramming.pub/over-engineering-the-infinite-loop-in-python-53450cb52132?source=collection_archive---------9-----------------------#2022-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8b8b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python中创建无限循环的7种方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c613254c135b575455ddd778c11d2488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hhYIbyBz2ETXzbra"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">飞:D </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python以高度灵活的编程语言而闻名。它提供了无数实现同一目标的方法——一些比另一些更合理。</p><p id="2f23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示在Python中实现无限循环的七种方法，从最常见的方法开始，逐渐过渡到更复杂和奇特的技术。</p><h1 id="72be" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">经典而真实</h1><p id="57f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">处理无限循环最Pythonic化的方法是使用一个while循环，它有一个恒定的真值:<code class="fe ms mt mu mv b">True</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="e5ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很直白吧？但同时也很无聊。让我们用下一个技术变得更有趣。</p><h1 id="21b2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">无限递归列表</h1><p id="f61d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在编程中，没有函数的无限递归这种东西，因为那会导致<a class="ae ky" href="https://en.wikipedia.org/wiki/Stack_overflow" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>。然而，数据结构可以毫无问题地引用自己。</p><p id="ab54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，我们定义了一个空列表，并将其附加到自身。如果我们试图遍历嵌套列表，我们将永远不会到达末尾。这一事实可被利用来创建无限循环并在其主体中执行代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="b5bd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">无限for循环</h1><p id="a957" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">除了无限循环，for循环在Python中无处不在。你不能仅仅用<code class="fe ms mt mu mv b">for i in range(math.inf):</code>遍历一个无限的范围。然而，如果你知道Python迭代器是如何工作的，你可以写你自己的无限迭代器。</p><p id="72d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">for-in循环的工作原理是为每个新的迭代调用iterable对象的<code class="fe ms mt mu mv b">__next__()</code>方法(例如<code class="fe ms mt mu mv b">range</code>、<code class="fe ms mt mu mv b">list</code>、<code class="fe ms mt mu mv b">str</code>……)。如果iterable已被完全消耗，则会引发一个<code class="fe ms mt mu mv b">StopIteration</code>异常。所以，无限循环的诀窍是永远不要引发<code class="fe ms mt mu mv b">StopIteration</code>。这里有一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="76e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，在<code class="fe ms mt mu mv b">__next__()</code>方法中没有<code class="fe ms mt mu mv b">StopIteration</code>。我敢打赌，你从来没有使用过，甚至没有听说过Python中的无限for循环。从现在开始，事情会变得更加奇特。</p><h1 id="ce25" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">转到循环</h1><p id="9ab0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">乍一看，你们中的一些人的反应可能是:“什么？Python什么时候有goto语句了？”。</p><p id="78cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2004年4月1日，一个名为<code class="fe ms mt mu mv b">goto</code>的模块作为一个愚人节玩笑发布了。正如您所料，它的目的是为Python添加goto特性。虽然这只是一个玩笑，不应该在真正的代码中使用，但它仍然有效。</p><p id="8178" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个模块很旧，与Python3不兼容，但我发现它与最新版本的Python2兼容得很好。你可以在<a class="ae ky" href="http://entrian.com/goto/" rel="noopener ugc nofollow" target="_blank">这个链接</a>找到<code class="fe ms mt mu mv b">goto</code>模块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="a852" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些开发者也写了这个模块的Python3兼容版本，但是由于某些原因我不能让它工作，所以我不会提到它。</p><h1 id="8f6c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">统计无限循环</h1><p id="1116" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">到目前为止，我们只看到了在任何情况下都不会停止的真正无限循环。以下示例显示了一个中断概率极低但不完全为零的循环。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="6330" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">循环条件是<code class="fe ms mt mu mv b">total</code>变量小于一个大数。在循环内部，<code class="fe ms mt mu mv b">total</code>变量增加、减少或保持不变的机会不相等。从统计学上来说，<code class="fe ms mt mu mv b">total</code>应该保持在零左右，加上或减去一些随机波动，这些波动加起来不太可能是这个条件下的大数字。</p><h1 id="7b6e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">无限移位链接队列</h1><p id="a0e8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">除了听起来像一些奇怪的编程动画角色的特殊举动，这也是一种通过从队列中弹出一个元素并立即将其添加回来实现无限循环的技术。</p><p id="8501" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">名称中的“链接”部分是因为这个队列是通过一个链表实现的，这是必要的，因为Python不允许常规列表有这种行为。</p><p id="0064" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是链接队列的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="c9ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你在循环中使用它的方式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="3324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为每次从队列中弹出一个元素时，它都会被推回队列中，<code class="fe ms mt mu mv b">node</code>永远不会是<code class="fe ms mt mu mv b">None</code>，从而实现了一个无限循环。或者，您可以通过<code class="fe ms mt mu mv b">__iter__()</code>和<code class="fe ms mt mu mv b">__next__()</code>魔术方法使这个类可迭代，并使用for-in循环来代替。</p><p id="38f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个例子还说明了为什么在遍历一个结构时不应该修改它，因为这可能会导致不必要的行为。</p><h1 id="ff28" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">无限无理数循环</h1><p id="a2f4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在让我们从数据结构跳到数学。在数学中，无理数是那些不能表示为两个整数之比的实数。无理数的另一个重要特性是它们在小数点右边有无穷多(不重复)的数字。</p><p id="92c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为这种“数字无止境”，无理数有无限的小数位，因此需要无限的时间和运算来精确计算。我们可以利用这个事实，把要重复的代码注入到无理数的计算中。</p><p id="9b6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下函数计算给定数字的平方根，没有小数近似值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="8a78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，如果我们给它一个平方根是无理数的数，它将永远需要计算答案，从而实现一个无限循环，因为数学。比如我们可以尝试计算<code class="fe ms mt mu mv b">2</code>的平方根，我们知道它是无理数:</p><pre class="kj kk kl km gt my mv mz na aw nb bi"><span id="51e0" class="nc lw it mv b gy nd ne l nf ng">sqrt(2)</span></pre><p id="8cad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除非注入的代码返回，否则函数永远不会返回。</p><h1 id="05df" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="9f4f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">用Python编程非常灵活，有无数种方法可以达到同样的效果。虽然有些方法有意义，但其他方法只是过度设计的技术，只是为了证明概念或进行编码练习。</p><blockquote class="nh"><p id="88ad" class="ni nj it bd nk nl nm nn no np nq lu dk translated">无限只是一种错觉。当计算机最终被时间的镰刀割掉时，即使是“虽然真实”也会结束。</p></blockquote><p id="2114" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">我希望你喜欢这篇文章。如果你知道任何其他有趣的在Python中实现无限循环的方法，请在评论中分享。感谢阅读！</p><p id="3f75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是本系列的第四篇文章，在这篇文章中，我探索了用Python实现简单任务的各种有趣的、过度设计的方法。如果你错过了最后一个故事，你可以在下面找到它:</p><div class="nw nx gp gr ny nz"><a rel="noopener  ugc nofollow" target="_blank" href="/over-engineering-the-hello-world-in-python-352844417d37"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">在Python中过度设计“Hello World”</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">不使用print()打印到控制台的7种方式</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">better编程. pub</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div></div></div>    
</body>
</html>