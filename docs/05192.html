<html>
<head>
<title>How to Send Push Notifications to Your Phone From Any Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从任何脚本向您的手机发送推送通知</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-send-push-notifications-to-your-phone-from-any-script-6b70e34748f6?source=collection_archive---------0-----------------------#2020-06-19">https://betterprogramming.pub/how-to-send-push-notifications-to-your-phone-from-any-script-6b70e34748f6?source=collection_archive---------0-----------------------#2020-06-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="271b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">任务完成时获得通知</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5d29e473d3ac7dae5bf72f97b554a887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XvAVWNCFal8Z8sMm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="ba6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为程序员，我们经常需要启动长时间运行的任务和脚本。这可能包括:</p><ul class=""><li id="091c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">传输或复制大文件</li><li id="75d8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">处理大数据集</li><li id="f302" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">冗长的编译过程</li></ul><p id="812c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于任何一种耗时的脚本，知道脚本何时结束是很方便的，如果不是必要的话。我们还想知道这个过程是成功还是失败。</p><p id="0e9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然有些软件内置了这类通知，但大多数命令行工具没有。此外，理想情况下，我们希望无论身在何处都能获得通知，而不仅仅是在运行脚本的设备上。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0a32" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用IFTTT</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/0496f7dc4d07c9549453143d56d5dd2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4XOBPuKMs2SEQrmJPZ-9TQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由作者提供</p></figure><p id="9af0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过web服务<a class="ae ky" href="https://ifttt.com" rel="noopener ugc nofollow" target="_blank"> IFTTT </a>，可以轻松实现向任何移动设备发送推送通知。这可用于将发送到给定URL的web请求连接到安装在移动设备上的配套应用程序。</p><p id="ab52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是实现这一目标的步骤:</p><ol class=""><li id="d04a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">访问<a class="ae ky" href="http://ifttt.com" rel="noopener ugc nofollow" target="_blank">http://ifttt.com</a>并注册账户。</li><li id="b17a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">点击您的账户图标(右上角)，然后点击创建<strong class="lb iu">。</strong></li><li id="6c38" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">点击If+图标，在搜索框中输入“Webhooks”。</li><li id="be5b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">选择Webhooks →接收Web请求，并为您的事件名称键入“notify”。</li><li id="5af2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">接下来，单击+图标，并在搜索框中键入“通知”。</li><li id="5f19" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">选择“从IFTTT应用程序发送通知”</li><li id="e6e8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">在消息框中键入以下文本:</li></ol><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="bed8" class="np mr it nl b gy nq nr l ns nt">Notification: {{Value1}}</span></pre><p id="c13c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">8.点击“创建操作”，然后为您的操作命名，例如“推送通知”然后点击完成。</p><p id="7464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！您现在已经创建了一个IFTTT操作。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="55fd" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">测试通知</h1><p id="8aa3" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">要测试通知，您需要在移动设备上下载IFTTT应用程序，并使用您的帐户登录。它会提示您是否希望接收通知—选择“是”</p><p id="05fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设应用程序已正确安装在您的设备上，我们现在可以返回网络浏览器，找到我们的小程序的URL。</p><p id="7269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，请访问<a class="ae ky" href="https://ifttt.com" rel="noopener ugc nofollow" target="_blank">https://ifttt.com</a>，然后:</p><ol class=""><li id="ec66" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">点击您的帐户图标(右上角)，然后点击我的服务。</li><li id="77f9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">从列表中选择Webhooks，然后点击Documentation。</li></ol><p id="bb4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应该显示一个屏幕，显示您的API URL以及通过POST请求传递值的一些字段。</p><ol class=""><li id="cae7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nj mb mc md bi translated">在事件框中键入“notify”(我们事件的名称)。</li><li id="3309" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nj mb mc md bi translated">在值1框中键入“test”。</li></ol><p id="1917" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">底部产生的命令应该如下所示:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="cb8e" class="np mr it nl b gy nq nr l ns nt">curl -X POST -H "Content-Type: application/json" -d '{"value1":"test"}' https://maker.ifttt.com/trigger/notify/with/key/123jhkjh3k4h24j343</span></pre><p id="eeb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你点击测试它，你应该很快就会在你的手机上收到通知。</p><p id="27c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在60秒内没有收到通知，请尝试重新启动您的设备，以强制应用程序提示通知授权。</p><p id="1431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果还是不行，我推荐在<a class="ae ky" href="https://www.reddit.com/r/ifttt/" rel="noopener ugc nofollow" target="_blank"> IFTTT Reddit </a>上发帖。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3cc3" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">从脚本发送通知</h1><p id="f9eb" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">好了，我们有了IFTTT。现在是有趣的部分！我们将编写一个简单的bash脚本，让我们从命令行向手机发送通知。这一部分可以在任何类似Unix的系统上工作，比如Windows上的Linux、macOS或Cygwin。</p><p id="6b5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开一个终端，然后创建一个名为<code class="fe nz oa ob nl b">notify</code>的新文本文件。粘贴以下内容，用Webhook文档中的密钥替换<code class="fe nz oa ob nl b">&lt;your key&gt;</code>:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="b8da" class="np mr it nl b gy nq nr l ns nt">#!/bin/bash</span><span id="f82a" class="np mr it nl b gy oc nr l ns nt">arg=$(echo $1 | sed 's/ /%20/g')<br/>curl -s -o /dev/null "<a class="ae ky" href="https://maker.ifttt.com/trigger/notification/with/key/cr52Z4jcfAKtL1uKCnbp5SCSXdddCi1yU46ATdasvvf?value1=$arg" rel="noopener ugc nofollow" target="_blank">https://maker.ifttt.com/trigger/notify/with/key/&lt;your key&gt;?value1=$arg</a>"</span></pre><p id="3ce0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在保存脚本并使其可执行。这通常可以通过以下方式实现:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="988f" class="np mr it nl b gy nq nr l ns nt">$ chmod +x notify</span></pre><p id="7bc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以从命令行测试我们的脚本了:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="92e1" class="np mr it nl b gy nq nr l ns nt">$ ./notify "important stuff"</span></pre><p id="1a62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一切正常，你应该很快就会在你的移动设备上收到“通知:重要的东西”的短信。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="6147" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">付诸实践</h1><p id="7044" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在我们有了一个可以轻松发布通知的脚本，我们首先需要把它放在系统可以轻松运行它的地方。这种事情我一般用<code class="fe nz oa ob nl b">/usr/local/bin</code>，所以:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="f150" class="np mr it nl b gy nq nr l ns nt">$ sudo mv notify /usr/local/bin</span></pre><p id="7846" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设<code class="fe nz oa ob nl b">/usr/local/bin</code>在您的<code class="fe nz oa ob nl b">PATH</code>中，那么您现在应该能够简单地从任何目录键入<code class="fe nz oa ob nl b">notify "blah"</code>并且它将工作。</p><p id="c691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能用这个做什么？当使用<code class="fe nz oa ob nl b">&amp;&amp;</code> shell操作符完成另一个命令时，可以执行任何Unix命令。这在“<a class="ae ky" href="https://www.thegeekdiary.com/6-bash-shell-command-line-chaining-operators-in-linux/" rel="noopener ugc nofollow" target="_blank">6 Linux中的Bash Shell命令行链接操作符</a>中有所解释</p><p id="8f42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以这样写:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="a3d5" class="np mr it nl b gy nq nr l ns nt">cp my_big_file /some/folder &amp;&amp; notify "File copied successfully"</span></pre><p id="8e0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="38bf" class="np mr it nl b gy nq nr l ns nt">make &amp;&amp; notify "Code compiled"</span></pre><p id="5ab6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，我们常常不仅想知道某件事是否成功，还想知道它是否失败。这里我们可以使用<code class="fe nz oa ob nl b">||</code>运算符，例如:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="174b" class="np mr it nl b gy nq nr l ns nt">make &amp;&amp; notify "Compile successful" || notify "Compile failed"</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2ca4" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用From代码</h1><p id="5b17" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">除了来自shell的命令行通知之外，我们可能还想从代码中发送通知。大多数语言都支持向web服务发送请求，无论是在语言标准库内部还是通过第三方框架。</p><p id="22aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，使用Python，我们可以如下使用<code class="fe nz oa ob nl b"><a class="ae ky" href="https://docs.python.org/3/library/urllib.request.html" rel="noopener ugc nofollow" target="_blank">urllib.request</a></code>模块:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="a211" class="np mr it nl b gy nq nr l ns nt">from urllib import request</span><span id="9344" class="np mr it nl b gy oc nr l ns nt">key = "&lt;your key&gt;"<br/>message = "something"</span><span id="a94f" class="np mr it nl b gy oc nr l ns nt">request.urlopen("<a class="ae ky" href="https://maker.ifttt.com/trigger/notification/with/key/cr52Z4jcfAKtL1uKCnbp5SCSXdddCi1yU46ATdasvvf?value1=$arg" rel="noopener ugc nofollow" target="_blank">https://maker.ifttt.com/trigger/notify/with/key/%s?value1=</a>%s" % (key,message))</span></pre><p id="d9b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们只是向一个URL发送一个GET请求。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="f445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对脚本通知的有用应用有任何想法，我很乐意在评论中听到。</p></div></div>    
</body>
</html>