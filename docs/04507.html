<html>
<head>
<title>Build an iOS Activity Indicator in the Form of a Snake</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以蛇的形式构建一个iOS活动指示器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/ios-activity-indicator-in-the-form-of-a-snake-7dd85c1baec9?source=collection_archive---------7-----------------------#2020-04-17">https://betterprogramming.pub/ios-activity-indicator-in-the-form-of-a-snake-7dd85c1baec9?source=collection_archive---------7-----------------------#2020-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f05f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用SwiftUI使您的活动指示器不同于所有其他指示器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ae052ee67b9eee07bbd8eaaa992dcb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nGQ39goAX9yFLn0byNkGTA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jeffgry?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">奥占·阿克多安</a>在<a class="ae kv" href="https://unsplash.com/s/photos/loading-screen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="2cc3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="553b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在过去的几年里，开发者一直在使用活动指示器来让用户知道他们需要等待应用程序做一些事情。为了照亮这段时间并脱颖而出，开发人员定制了他们的活动指示器。在本文中，我们将使用SwiftUI创建自己的活动指示器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/3adf4b14c7019ae5ad2bebfce3cac91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/1*5dEYwuZaIVXSdJb0_-7SMg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">活动指示器</p></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="66a7" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">履行</h1><p id="880a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">该任务可以分为两个子任务:</p><ul class=""><li id="0a62" class="mx my iq lq b lr mz lu na lx nb mb nc mf nd mj ne nf ng nh bi translated">创建活动指示器的形状。</li><li id="c86d" class="mx my iq lq b lr ni lu nj lx nk mb nl mf nm mj ne nf ng nh bi translated">添加动画。</li></ul></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="e7c9" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">让我们从创建形状开始。为此，创建一个<code class="fe nq nr ns nt b">ActivityIndicatorShape</code>结构，并使其符合<code class="fe nq nr ns nt b">Shape</code>协议:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d212" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated"><code class="fe nq nr ns nt b">path(in: CGRect) -&gt; Path</code>函数是描述形状所必需的。这是符合<code class="fe nq nr ns nt b">Shape</code>协议所需的功能。</p><p id="5f37" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">为了绘制我们的形状，我们将把它分成五行，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7c9d589b34bd592d06ab90cddc92504e.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*DlsKtYx679amYA2kpr90eA.png"/></div></figure><p id="ebcf" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">活动指示器周围的黑线是我们视图的边界。五行中每一行的长度等于视图的宽度除以五。然后你可以初始化每一行的起点，还有第六个点，也就是第五行的终点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b656" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">接下来，我们连接这些线，使线宽为10，并添加舍入:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="0d1d" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">我们的形状采用以下形式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3da008744392002231ae5666b36c8cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*vNxRp30pQJGdP5A5p68UpQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">活动指示器</p></figure><p id="47e6" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">您可能会注意到，一些线条的边缘看起来并不完全符合我们的需要。这是因为视图切断了超出它的一切。原来我们需要把左、上、右、下的线减少舍入半径的大小。这个半径等于线宽的一半，在我们的例子中是5。因此，我们的代码采用以下形式:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c30a" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">形状现在看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/9018a7046dc83d22c8128135de7a0065.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*2PqXnvtY0cQpvo78XdHCxA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">活动指示器形状</p></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="caed" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">在成功实现第一部分后，我们开始制作动画。</p><p id="1db5" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">有很多方法可以实现这个动画。我将描述其中之一。</p><p id="5b68" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">首先，我们在彼此下面画两个<code class="fe nq nr ns nt b">ActivityIndicator</code>,并给它们不同的颜色:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="ba20" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">所以我们画了一个活动指示器，看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/7554102a993f1562e447d0a94ea830f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*5ZTcuK3_A10KPBrwB1msnw.png"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="340e" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">然后，我们在第一个活动指标下绘制第二个活动指标。我们的活动指标将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/75beaf56ad00a88bb2003608f4234463.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*eTWIc5okIyjU-dJs_3xrOw.png"/></div></figure><p id="c816" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">请注意，活动指示器的颜色略有变化。这是因为我们看到第二个有不同的颜色，第一个在它下面的层上。</p><p id="ffc4" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">接下来，我们需要限制第二个活动指标的可见区域:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="8b25" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">结果看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7f2a6a3cbb6a86520c81f260d164f834.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*j0Ok50VMPodtDYHaxI6hkQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">活动指示器</p></figure><p id="84c5" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">我们已经学习了如何显示第二个活动指示器的一部分。我们所要做的就是将可见部分动画化。这可以通过以下方式实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="faa4" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">我们已经创建了<code class="fe nq nr ns nt b">struct Animation</code>，添加了<code class="fe nq nr ns nt b">repeatForever</code>，并在<code class="fe nq nr ns nt b">func animation(_ animation: Animation?)</code><strong class="lq ir"><em class="oc">-&gt;</em></strong><code class="fe nq nr ns nt b">some View</code><strong class="lq ir"><em class="oc">中传递了它。<br/> </em> </strong>可见部分的移动是用offset实现的。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="6025" class="kw kx iq bd ky kz ms lb lc ld mt lf lg jw mu jx li jz mv ka lk kc mw kd lm ln bi translated">结论</h1><p id="e52a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本教程中，我们研究了一种创建自己的活动指示器的方法。乍一看好像很复杂，其实不然！</p><p id="ee9d" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">使用SwiftUI的这个活动指示器的完整源代码可以在这个GitHub <a class="ae kv" href="https://github.com/VPavelDm/ProgressBar" rel="noopener ugc nofollow" target="_blank">存储库</a>中找到。</p><p id="b562" class="pw-post-body-paragraph lo lp iq lq b lr mz jr lt lu na ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">我希望你喜欢阅读本教程。</p></div></div>    
</body>
</html>