<html>
<head>
<title>Understanding and Applying Closures in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解和应用JavaScript中的闭包</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/understanding-and-applying-closures-in-javascript-c0a321e59f1f?source=collection_archive---------9-----------------------#2021-03-23">https://betterprogramming.pub/understanding-and-applying-closures-in-javascript-c0a321e59f1f?source=collection_archive---------9-----------------------#2021-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="849b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">尽可能用最简单的方式学习闭包</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/929dc08f267e02f73fa8dd01b941fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TJcTJMGD4ma0_zYx"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@dragos126?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dragos Gontariu </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="1965" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我记得我第一次遇到术语<em class="ls">闭包</em>。<strong class="ky ir"> </strong> It <strong class="ky ir"> </strong>在Instagram上发布了一些重要的JavaScript话题。</p><p id="90b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看到这个帖子后，我试着找了一个关于闭包的简单教程。我看了这么多例子，但我还是不明白。我在网上遇到的大多数教程都没有给出可以轻松实现的真实例子。这让我很难知道如何以及在哪里使用闭包。</p><p id="f56c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在某些时候，我想到了忘记这个主题，转到其他JavaScript主题。关闭可能确实看起来势不可挡。</p><p id="7339" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，一旦你掌握了其中的诀窍，你会立刻成为一名更好的程序员。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="a9c1" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">闭包到底是什么</h1><p id="0a65" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">闭包是JavaScript上的一个特性，它允许您从嵌套函数或子函数中访问父函数的作用域。</p><p id="9205" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最简单的形式是，闭包是保存数据的函数。每次创建函数时都会创建一个闭包。</p><p id="fb5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">闭包让我们能够将数据存储在一个单独的范围内，只在需要的时候访问它。</p><p id="1a7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要闭包的一个简单原因是为了给我们的一些数据隐私。有时，我们希望定义只能从脚本的特定部分访问的变量。闭包最适合这种情况。</p><h2 id="1cb1" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">简单的例子</h2><p id="b577" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在本例中，我们将创建一个嵌套在另一个函数中的函数。子函数访问存储在父函数中的变量:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="058c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们有一个名为<code class="fe nl nm nn no b">returnMsg</code>的函数，它可以访问父函数<code class="fe nl nm nn no b">writeMsg</code>的变量。这意味着<code class="fe nl nm nn no b">returnMsg</code>可以访问<code class="fe nl nm nn no b">msg</code>变量。在这个例子中，<code class="fe nl nm nn no b">returnMsg</code>是闭包。</p><h2 id="60d4" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">实际例子</h2><p id="5075" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">当您想要将数据与操作该数据的函数相关联时，闭包会非常方便。这类似于面向对象的编程，其中对象允许您将对象的属性与一个或多个方法相关联。</p><p id="4af2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，您可以在任何通常只使用一个方法的地方使用闭包。</p><p id="aa06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能希望这样做的情况很常见。用frontend JavaScript编写的大部分代码都是基于事件的(只有当用户以某种方式与网页交互时才生效)。您定义一些行为，然后将它附加到由用户启动的事件(如单击或双击)。代码作为回调(响应事件而执行的单个函数)附加。</p><p id="41a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，假设我们想在页面上添加按钮，以便在用户点击任何按钮时调整<code class="fe nl nm nn no b">div</code>元素的宽度和高度:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6dae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，宽度和高度首先分别设置为60px和50px。我们创建了三个按钮。每当用户点击时，它们都会将<code class="fe nl nm nn no b">div</code>元素增大到一个特定的大小。每个按钮调用一个功能。</p><p id="77ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">增量由<code class="fe nl nm nn no b">adjust</code>函数中的<code class="fe nl nm nn no b">adjustOne</code>、<code class="fe nl nm nn no b">adjustTwo</code>和<code class="fe nl nm nn no b">adjustThree</code>函数完成。</p><h2 id="7b22" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">另一个例子</h2><p id="19a3" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">假设我们想要创建一个计数器，当用户点击一个按钮时，它增加拍手的次数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5796" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建自调用的父箭头功能。拍手次数首先在父函数<code class="fe nl nm nn no b">addClap</code>中初始化为<code class="fe nl nm nn no b">0</code>。子函数用于在用户点击按钮时将计数器加1。</p><p id="9930" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由此，我们可以看到<code class="fe nl nm nn no b">clapCounter</code>变量是在子函数外部声明的，但是我们能够从内部访问它。</p><p id="cea9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这基本上是最简单的闭包形式。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="4d70" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">关闭范围系列</h1><p id="354f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">一个闭包有三个范围系列:</p><ul class=""><li id="484e" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated">词法范围或静态范围。这个作用域访问它自己的变量。</li><li id="fd3e" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">父函数范围。该作用域访问其父函数的变量。</li><li id="4c24" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">全球范围。这将访问函数之外的任何变量(即全局变量)。</li></ul><h2 id="a3a8" class="mx mb iq bd mc my mz dn mg na nb dp mk lf nc nd mm lj ne nf mo ln ng nh mq ni bi translated">词汇范围</h2><p id="c312" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">词法范围意味着在一个函数外部定义的变量可以在另一个函数内部访问。然而，反之则不成立。在内部函数中定义的变量不能在该函数外部访问。</p><p id="4c48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着父函数的变量可以被它们的子函数访问，但是子函数的变量不能被父函数访问。</p><p id="4430" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我有一个内部定义了变量的父函数<code class="fe nl nm nn no b">x</code>和一个内部也定义了变量的子函数<code class="fe nl nm nn no b">y</code>。<code class="fe nl nm nn no b">y</code>的变量只能在<code class="fe nl nm nn no b">y</code>内部访问。它是私有的，而<code class="fe nl nm nn no b">x</code>的变量可以在<code class="fe nl nm nn no b">x</code>和<code class="fe nl nm nn no b">y</code>两个函数中访问。</p><p id="332c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">词法范围也称为静态范围。词法范围的概念在闭包中被广泛使用。</p><p id="4aa9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个演示词法范围的简单示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="f5b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码片段中，创建了两个函数:<code class="fe nl nm nn no b">myFunction()</code>和<code class="fe nl nm nn no b">mySecondFunc()</code>。<code class="fe nl nm nn no b">myFunction()</code>是具有函数作用域的父函数，而<code class="fe nl nm nn no b">mySecondFunc()</code>是具有词法作用域的子函数。两个函数内部都定义了变量(分别为<code class="fe nl nm nn no b">age</code>和<code class="fe nl nm nn no b">hobby</code>)。</p><p id="1ada" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nl nm nn no b">age</code>变量可以从两个函数内部访问，但是<code class="fe nl nm nn no b">hobby</code>变量只能在<code class="fe nl nm nn no b">mySecondFunc()</code>函数内部访问。</p><p id="e9b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nl nm nn no b">name</code>变量具有全局作用域，因此可以从脚本中的任何地方访问它。</p><p id="8cd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">提示:避免使用全局变量。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="54df" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="370b" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这就是我对闭包的概述。您可能一直在使用闭包，甚至没有意识到这一点，但是如果您没有，请尝试一下。</p><p id="e21c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从现在开始，当你在你的代码或者任何你在网上看到的代码中看到闭包时，你可以很容易地指出它们，看到它们在做什么，以及为什么它们被使用。</p><p id="4d0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了练习，别无他法。你现在已经有了基本的知识。深入研究一些现有的代码——无论是您的代码还是您能找到的任何代码——并尝试识别闭包以及为什么使用它们。使用闭包练习得越多，对主题的理解就越好。</p><p id="47eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。我希望这篇文章能帮助您更好地理解闭包。</p><p id="63bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有任何问题，请在评论中向我提问！</p></div></div>    
</body>
</html>