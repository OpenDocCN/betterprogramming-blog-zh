<html>
<head>
<title>Create a Blog App With Next.js and Contentful API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Next.js和Contentful API创建博客应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-blog-app-with-nextjs-and-contentful-api-7927af49b3b?source=collection_archive---------2-----------------------#2019-10-02">https://betterprogramming.pub/create-a-blog-app-with-nextjs-and-contentful-api-7927af49b3b?source=collection_archive---------2-----------------------#2019-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="35c0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个如何在Next.js网站上用内容丰富的headless CMS构建博客功能的例子</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4550dbf3c7db1b54707c5228abe1d346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zU3iyPJoy10rgGNXxyRUkg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Next.js和Contentful</p></figure><p id="9233" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我有使用React和<a class="ae lr" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>框架构建web应用程序的丰富经验。我最近写了一篇关于使用Docker建立一个<a class="ae lr" href="https://palletsprojects.com/p/flask/" rel="noopener ugc nofollow" target="_blank"> Flask </a>和Next.js应用程序的文章。</p><p id="1afa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这一次，在这篇文章中，我将分享一个使用Next.js和<a class="ae lr" href="https://www.contentful.com/" rel="noopener ugc nofollow" target="_blank"> Contentful </a>构建简单博客应用程序的教程。我在这里描述的步骤类似于我在<a class="ae lr" href="https://passporr.com/blog" rel="noopener ugc nofollow" target="_blank"> Passporr </a>中显示博客内容的步骤。</p><p id="8f25" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请继续关注，希望这篇教程能帮助你在你的网站上展示博客，而不会有太多的麻烦。</p><p id="fa08" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我从我的经验中了解到，为了让你的网站在SEO排名中变得更好，你必须为你的网站建立大量的内容。有什么比通过博客产生大量内容更好的方法呢？</p><p id="d3d3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是，如果你建立了一个网站或应用程序，并不打算显示博客。例如，您使用<code class="fe ls lt lu lv b">create-react-app</code>模板创建了一个website/ <a class="ae lr" href="https://sass-lang.com/" rel="noopener ugc nofollow" target="_blank"> Sass </a>产品，随着时间的推移，您希望添加显示博客内容的功能。</p><p id="d2e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">除非你用一个已经准备好的平台(例如<a class="ae lr" href="https://wordpress.com/" rel="noopener ugc nofollow" target="_blank"> Wordpress </a>、<a class="ae lr" href="https://ghost.org/" rel="noopener ugc nofollow" target="_blank"> Ghost.js </a>或许多其他CMS)来建立你的网站，否则你可能需要:</p><ul class=""><li id="3c01" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">从头开始构建您自己的简单CMS。</li><li id="2f29" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">使用现有的CMS建立一个完整的博客功能，并在您的子域下发布。</li></ul><p id="8ec3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你不着急或者想抓住机会学习更多关于构建CMS的知识，第一种选择可能是可行的。第二个选择可以很快完成，但是你会错过你的主域的有机交通。</p><p id="e4b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，还有第三种选择，使用无头CMS。根据<a class="ae lr" href="https://en.wikipedia.org/wiki/Headless_content_management_system" rel="noopener ugc nofollow" target="_blank">维基百科</a>，</p><blockquote class="mk ml mm"><p id="7c2c" class="kv kw mn kx b ky kz jr la lb lc ju ld mo lf lg lh mp lj lk ll mq ln lo lp lq ij bi translated"><em class="iq">无头内容管理系统(headless content management system，简称CMS)是一个后端内容管理系统(CMS ),作为一个内容存储库从头开始构建，可通过RESTful API访问内容，以便在任何设备上显示。</em></p></blockquote><p id="eb53" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，它基本上是一个完整的后端服务，包括数据库、编辑器和为您设置的一切，没有任何视图表示。有几个无头CMS的例子。</p><p id="7de6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，在这篇文章中，我将展示一个如何在Next.js网站中用Contentful headless CMS构建博客功能的例子。这就是我们将在本教程中开发的内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/fd0dd441c7449db4608f286e34d1e3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KK2gIO__PEjzHLe8.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">简单的博客应用程序</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="5135" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">创建一个令人满意的帐户</h1><p id="3892" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">在开始之前，我们先为它设置一下后端。你需要注册一个内容丰富的帐户，并创建一个内容丰富的基本博客模板。</p><p id="4132" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注册后，你会被要求创建一个新的空间，这基本上是一个项目的地方，你的后端。让我们选择现有的空间模板，现在，博客的例子。</p><ul class=""><li id="8bca" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">选择可用空间。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/a9cf0d05a9e4e3aa6095f4753e227000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*va6dqUpcKLGKyB2r.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创造新空间</p></figure><ul class=""><li id="77be" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">命名空间，并选择一个示例空间。从选项中点击<em class="mn">博客</em>标签。对于这个例子，我将空间命名为<code class="fe ls lt lu lv b">blog-tutorial</code>。然后，确认一下。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/996ed032efecf9e6abdf8b6f0450d8fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F_LexA1Vbnst2tXO.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">选择示例空间</p></figure><p id="3923" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在您确认创建空间后，Contentful将为您创建空间。这个博客空间将包含一个简单的博客结构和四篇博文的样本。</p><p id="a2d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">创建空间后，您将被重定向到主页，在那里您可以在导航栏中看到一个菜单。在这里，您可以在<em class="mn">内容模型</em>菜单中看到您博客的数据结构，在<em class="mn">内容</em>中看到博客文章的样本。</p><p id="078e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如您所看到的，一切都为您设置好了，包括一个WYSIWYG编辑器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/ee1a37b0e8e684b4324a4f9ac6ea0d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eJI79OnUzZzkCBMM.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">心满意足的邮报编辑</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="a0d8" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">创建内容丰富的API令牌</h1><p id="ef72" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">在我们继续之前，我们还需要为Next.js应用程序创建一个API令牌。</p><p id="ca42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以通过选择<em class="mn">设置</em>，然后选择<em class="mn"> API键</em>来完成此操作。在API密钥页面上，点击<em class="mn">添加API密钥</em>。在API Key页面上，您可以填写所有的文本框。</p><p id="153e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您需要记下的是<em class="mn">空间ID </em>和<em class="mn">内容交付API -访问令牌。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/1afb4898244fea260974bd605e554b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iSPa1B1VB7yirhVp.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建新的API访问令牌</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="29c3" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">索引页</h1><p id="15e9" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">对于下一个. js应用程序，我们将使用我之前设置的starter项目开始构建应用程序。<a class="ae lr" href="https://github.com/martindavid/nextjs-typescript-starter" rel="noopener ugc nofollow" target="_blank">初学者工具包</a>将包含一个基本的Next.js应用程序，带有已经为您设置好的类型脚本、<a class="ae lr" href="https://www.styled-components.com/" rel="noopener ugc nofollow" target="_blank">样式组件</a>和Docker。</p><p id="42c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，让我们将回购克隆到我们的机器中(您可以将<code class="fe ls lt lu lv b">&lt;project name&gt;</code>更改为您想要命名的文件夹)。我们还将安装项目所需的依赖项。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="a9f5" class="oe na iq lv b gy of og l oh oi"><em class="mn"># clone the initial project repo</em><br/>$ git clone git@github.com:martindavid/nextjs-typescript-starter.git &lt;project name&gt;</span><span id="f643" class="oe na iq lv b gy oj og l oh oi"><em class="mn"># install dependencies package</em><br/>$ npm i — save contentful moment</span></pre><p id="3906" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的代码和步骤将向我们展示如何将博客组件添加到下一个应用程序中。</p><p id="9cfa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们将在<code class="fe ls lt lu lv b">next.config.js</code>中添加一个环境变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内容丰富的API的环境变量</p></figure><p id="50fe" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们设置好环境变量后，在<em class="mn"> pages </em>下创建一个新文件夹，命名为<em class="mn"> blog </em>，之后在blog下添加一个名为<code class="fe ls lt lu lv b">index.tsx</code>的新文件。</p><p id="4214" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe ls lt lu lv b">index.tsx</code>中，我们将编写一个基本的React组件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">index.tsx</p></figure><p id="6a47" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">目前，它只会显示一个带有文本的标题。在为Contentful设置服务类之后，我们将向组件中添加更多内容。</p><p id="b347" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，让我们创建一个服务类，它将调用Contentful API并获取数据。这是我目前在所有工作中使用的模式，用于将API调用集中到一个服务类中。</p><p id="37b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe ls lt lu lv b">services</code>文件夹中，我将创建两个文件，<code class="fe ls lt lu lv b">blog.ts</code>和<code class="fe ls lt lu lv b">blog.types.ts</code>。在<code class="fe ls lt lu lv b">services/blog.types.ts</code>中，我们将存储来自Contentful API的响应类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="f0cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，在<code class="fe ls lt lu lv b">services/blog.ts</code>中，我们将添加服务类来调用Contentful API。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5df2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这里，我们创建一个类名<code class="fe ls lt lu lv b">BlogApi</code>。这个类导入了<code class="fe ls lt lu lv b">ContentfulClientApi</code>类型和<code class="fe ls lt lu lv b">createClient</code>方法，这样我们可以用它在构造函数中实例化Contentful客户端。</p><p id="19e9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe ls lt lu lv b">BlogApi</code>类中，我们添加了两个新方法来获取所有博客条目，并使用slug获取一篇博客文章。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="15ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们将在<code class="fe ls lt lu lv b">BlogApi</code>类中添加一个helper方法，将来自API的响应映射到我们的类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="61f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们回到<code class="fe ls lt lu lv b">blog/index.tsx</code>，添加<code class="fe ls lt lu lv b">BlogApi</code>并获取那里的博客文章列表。在<code class="fe ls lt lu lv b">blog/index.tsx</code>中，我们将添加<code class="fe ls lt lu lv b">getInitialProps</code>方法，这样它将实现SSR并服务于内容服务器端。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="d504" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还想修改<code class="fe ls lt lu lv b">render</code>方法来呈现博客文章列表。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="70f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从上面的代码清单中可以看出，我创建了一个助手方法来呈现<code class="fe ls lt lu lv b">entry</code>的集合。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="0313" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">详细页面</h1><p id="f49c" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">我们已经完成了博客申请的一半。</p><p id="3066" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这一部分，我们将为一篇博客文章构建细节。如果你回头看看内容菜单中的Contentful页面，你可以看到博客内容是以markdown格式编写的。</p><p id="7647" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们将安装新的<a class="ae lr" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>包，这些包将在博客的React组件中呈现markdown内容。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="ff9a" class="oe na iq lv b gy of og l oh oi">$ npm i — save react-markdown</span></pre><p id="da19" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，我们需要在名为<code class="fe ls lt lu lv b">[slug].tsx</code>的<em class="mn"> blog </em>文件夹下添加一个新的Next.js页面。我们还需要添加一个名为<code class="fe ls lt lu lv b">BlogDetail</code>的新组件，它将接受一个单独的<code class="fe ls lt lu lv b">post</code>作为道具。</p><p id="d5f1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe ls lt lu lv b">BlogDetail</code>是一个基本上只使用<code class="fe ls lt lu lv b">react-markdown</code>渲染内容的功能组件。同样感谢Next.js的动态路由，我们可以传递博客条目slug，<code class="fe ls lt lu lv b">[slug].tsx</code>会自动将其解析为查询对象。</p><p id="dc33" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用Next.js中的动态路由，我们可以有一个类似于<code class="fe ls lt lu lv b">/blog/&lt;slug&gt;</code>的URL，而不是在我们的URL中有一个查询字符串。这也将提高我们网站的搜索引擎优化。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="ec2f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，为了完成我们的博客详细页面，我们将修改代码以包含<code class="fe ls lt lu lv b">BlogDetail</code>组件，并调用服务类来获取单个博客条目。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="2f7e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们将测试我们的网站。您需要将<code class="fe ls lt lu lv b">CONTENTFUL_SPACE_ID</code>和<code class="fe ls lt lu lv b">CONTENTFUL_ACCESS_TOKEN</code>作为环境变量传递。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="9f5f" class="oe na iq lv b gy of og l oh oi">$ CONTENTFUL_SPACE_ID=&lt;space_id&gt; CONTENTFUL_ACCESS_TOKEN=&lt;access_token&gt; npm run dev</span></pre><p id="bde6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将<code class="fe ls lt lu lv b">&lt;space_id&gt;</code>和<code class="fe ls lt lu lv b">&lt;access_token&gt;</code>替换为您从Contentful网站获得的值。现在，您可以从<code class="fe ls lt lu lv b"><a class="ae lr" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>访问应用程序。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="cfac" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">部署到现在</h1><p id="ce54" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">为了方便上网，你可以使用云服务，比如带有CLI的<a class="ae lr" href="https://zeit.co/" rel="noopener ugc nofollow" target="_blank"> Zeit </a>。要将它发布到现在，您可以运行:</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="9deb" class="oe na iq lv b gy of og l oh oi">now -e CONTENTFUL_SPACE_ID=&lt;space_id&gt; -e CONTENTFUL_ACCESS_TOKEN=&lt;access_token&gt;</span></pre><p id="4c2d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">成功发布后，您可以通过它生成的URL访问它。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="e229" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">好处:将SEO集成到Next.js应用程序中</h1><p id="add7" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">在这篇文章的开始，我提到了在我们的网站上建立博客的原因之一是为了增加我们的SEO排名。</p><p id="ea4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们已经为自己准备好了博客，现在让我们做一个小的修改，为我们的网站提供一个SEO标签和元数据。为此，我们需要向我们的内容丰富的博客结构中添加一个字段，并使用<code class="fe ls lt lu lv b">next-seo</code>将元标签放置到位。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="c3f9" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">在Contentful中添加元数据字段</h1><p id="ced9" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">在Contentful dashboard页面中，点击<em class="mn">内容模型</em>菜单并选择<em class="mn">博客文章</em>模型。</p><ol class=""><li id="d060" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq om mc md me bi translated">点击<em class="mn">添加字段</em>按钮，添加一个新的文本字段。我们把它命名为<code class="fe ls lt lu lv b">Meta Title</code>，然后创建它。添加另一个文本字段，并将其命名为<code class="fe ls lt lu lv b">Meta Description</code>。</li><li id="66e4" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq om mc md me bi translated">添加另一个新字段，选择一个媒体类型，并将其命名为<code class="fe ls lt lu lv b">Meta Image</code>。</li><li id="5951" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq om mc md me bi translated">更新博客的一个内容，并填写<code class="fe ls lt lu lv b">Meta Title</code>和<code class="fe ls lt lu lv b">Meta Description</code>的值，还为<code class="fe ls lt lu lv b">Meta Image</code>字段上传一张图片。</li></ol></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="dc1a" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">将SEO付诸实践</h1><p id="1980" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">由于Contentful数据结构中新增了三个字段，我们还需要修改Next.js应用程序来反映这些变化。首先，我们将在<code class="fe ls lt lu lv b">blog.types.ts</code>中添加新的字段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="1395" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要更新<code class="fe ls lt lu lv b">convertPost</code>方法来映射meta标签字段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="e733" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们更新服务类之后，接下来，我们需要更新博客详细信息页面以包含meta标记。为此，我们将使用<code class="fe ls lt lu lv b"><a class="ae lr" href="https://www.npmjs.com/package/next-seo" rel="noopener ugc nofollow" target="_blank">next-seo</a></code>包。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="d60a" class="oe na iq lv b gy of og l oh oi">$ npm i — save next-seo</span></pre><p id="2aa9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们需要更新<code class="fe ls lt lu lv b">_app.tsx</code>来包含一个默认的SEO配置。我们可以使用<code class="fe ls lt lu lv b">next-seo</code>组件覆盖每个页面的默认配置。我们将为默认的SEO配置创建一个新的常量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="0f55" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要更新这个组件的渲染方法。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="7318" class="oe na iq lv b gy of og l oh oi"><em class="mn">// import the component on the top</em><br/>import {DefaultSeo} from ‘next-seo’;</span><span id="40f1" class="oe na iq lv b gy oj og l oh oi"><em class="mn">// Update the return from the render method</em><br/>return (<br/>  &lt;&gt;<br/>    &lt;DefaultSeo {...DEFAULT_SEO} /&gt;<br/>    &lt;Component {...pageProps} /&gt;;<br/>  &lt;/&gt;<br/>);</span></pre><p id="4bbb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们更新了<code class="fe ls lt lu lv b">_app.tsx</code>之后，如果你检查元素并查看<code class="fe ls lt lu lv b">&lt;head&gt;</code>部分，你现在可以看到正在呈现的元描述。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/7e3371aa82967d57894963156878cf89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*65xMIq4gZfdX-102.png"/></div></figure><p id="5f4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们需要更新<code class="fe ls lt lu lv b">[slug].tsx</code>来覆盖默认的SEO配置，以反映单个博客条目的meta标签字段。</p><pre class="kg kh ki kj gt oa lv ob oc aw od bi"><span id="4017" class="oe na iq lv b gy of og l oh oi"><em class="mn">// Import the NextSeo component on top of the file</em><br/>import {NextSeo} from ‘next-seo’;<br/></span><span id="9b55" class="oe na iq lv b gy oj og l oh oi"><em class="mn">// Update the render method to include the NextSeo component</em><br/>&lt;NextSeo<br/>  openGraph={{<br/>    type: 'article',<br/>    title: post.metaTitle,<br/>    description: post.metaDescription,<br/>    images: [<br/>      {<br/>        url: post.metaImage,<br/>        width: 850,<br/>        height: 650,<br/>        alt: post.metaTitle,<br/>      },<br/>    ],<br/>  }}<br/>  title={post.metaTitle}<br/>  description={post.metaDescription}<br/>/&gt;</span></pre></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="e416" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">摘要</h1><p id="d3b9" class="pw-post-body-paragraph kv kw iq kx b ky nr jr la lb ns ju ld le nt lg lh li nu lk ll lm nv lo lp lq ij bi translated">为了让你的网站有一个好的搜索引擎优化策略，我们需要在我们的网站上有很多好的内容。获得这些内容的方法之一是通过博客。</p><p id="039e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在现有网站上集成CMS可能需要时间和精力。如果我们使用当前的CMS解决方案，我们可能需要在不同的子域中设置它。</p><p id="e4b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我向您展示了如何使用Next.js和Contentful headless CMS构建一个简单的博客应用程序。像Contentful这样的无头CMS是一个平台，它消除了创建内容管理系统的所有麻烦。</p><p id="908d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它还提供了设置我们需要的内容结构和我们想要的博客视图的灵活性。我希望这篇教程能让你知道如何轻松地将博客整合到你的网站中。</p><p id="4ef2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此应用程序的源代码可从<a class="ae lr" href="https://github.com/martindavid/nextjs-contentful-app" rel="noopener ugc nofollow" target="_blank">这里</a>获得</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="9c19" class="mz na iq bd nb nc nd ne nf ng nh ni nj jw nk jx nl jz nm ka nn kc no kd np nq bi translated">资源</h1><ul class=""><li id="6f79" class="lw lx iq kx b ky nr lb ns le oo li op lm oq lq mb mc md me bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Headless_content_management_system" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Headless _ content _ management _ system</a></li><li id="d767" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><a class="ae lr" href="https://moz.com/learn/seo/url" rel="noopener ugc nofollow" target="_blank">https://moz.com/learn/seo/url</a></li></ul></div></div>    
</body>
</html>