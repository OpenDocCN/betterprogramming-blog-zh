<html>
<head>
<title>Helpful Commands for Cleaning Data in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清理R中数据的有用命令</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/tip-commands-for-data-cleaning-in-r-8a5ad8d96d2b?source=collection_archive---------1-----------------------#2020-11-01">https://betterprogramming.pub/tip-commands-for-data-cleaning-in-r-8a5ad8d96d2b?source=collection_archive---------1-----------------------#2020-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="07a8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用R和tidyverse使您的工作更轻松的命令</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7fa31ea0dedf76361092411c47012ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z_RMgBsuQluJP9P9.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.tidyverse.org" rel="noopener ugc nofollow" target="_blank">https://www.tidyverse.org</a></p></figure><div class="kz la gp gr lb lc"><a href="https://jorgepit-14189.medium.com/membership" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">用我的推荐链接加入媒体-乔治皮皮斯</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">阅读乔治·皮皮斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">jorgepit-14189.medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq ks lc"/></div></div></a></div><p id="3a95" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我发现以下命令在任何数据科学项目的EDA部分都非常有用。我们将使用<a class="ae ky" href="https://www.tidyverse.org/packages/" rel="noopener ugc nofollow" target="_blank"> tidyverse </a>包，其中我们只需要dplyr和ggplot2，并使用<a class="ae ky" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank"> iris数据集</a>。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="021e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">select_if | rename_if</h1><p id="e6f6" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated"><code class="fe nr ns nt nu b">select_if</code>函数属于dply，在我们想要根据一些条件选择一些列时非常有用。我们还可以添加一个适用于列名的函数。</p><p id="ac06" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">示例</strong>:假设我只想选择数字变量，并在它们的列名中添加前缀“numeric_”。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="4fd0" class="nz mv it nu b gy oa ob l oc od">library(tidyverse) <br/>iris%&gt;%select_if(is.numeric, list(~ paste0("numeric_", .)))%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ca25686b26648c91e835abf0d0e78c5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EWfs30ehsHRX78GS.png"/></div></div></figure><p id="27f0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">注意，我们也可以以同样的方式使用<code class="fe nr ns nt nu b">rename_if</code>。需要注意的是，<code class="fe nr ns nt nu b">rename_if()</code>、<code class="fe nr ns nt nu b">rename_at()</code>和<code class="fe nr ns nt nu b">rename_all()</code>已经被<code class="fe nr ns nt nu b">rename_with()</code>取代。匹配的select语句已经被一个<code class="fe nr ns nt nu b">select()</code> + <code class="fe nr ns nt nu b">rename_with()</code>的组合所取代。</p><p id="8c30" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这些功能被取代是因为<code class="fe nr ns nt nu b">mutate_if()</code>和好友被<code class="fe nr ns nt nu b">across()</code>取代。<code class="fe nr ns nt nu b">select_if()</code>和<code class="fe nr ns nt nu b">rename_if()</code>已经使用了整齐选择，所以它们不能被<code class="fe nr ns nt nu b">across()</code>替换，相反，我们需要一个新的函数。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7196" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">在哪里</h1><p id="65c3" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated">我们可以通过选择函数返回<code class="fe nr ns nt nu b">TRUE</code>的变量，使用<code class="fe nr ns nt nu b">where</code>来<code class="fe nr ns nt nu b">select</code>或<code class="fe nr ns nt nu b">rename</code>列。我们将使用与上面相同的例子。</p><p id="a32a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">示例</strong>:假设我只想选择数字变量，并在它们的列名前加上前缀“numeric_”。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="aeb1" class="nz mv it nu b gy oa ob l oc od">iris%&gt;%rename_with(~ paste0("numeric_", .), where(is.numeric))%&gt;%<br/>       select(where(is.numeric))%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/9ef087d463f498320cd72a2788d39f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GG_4Ebx7em2OknyskM76vA.png"/></div></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0006" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">一切</h1><p id="7d4a" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated">在许多数据科学项目中，我们希望一个特定的列(通常是因变量<em class="of"> y </em>)出现在数据集中的第一个或最后一个。我们可以使用dplyr包中的<code class="fe nr ns nt nu b">everything()</code>来实现这一点。</p><p id="0109" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">示例</strong>:假设我希望列种类在我的数据集中首先出现<strong class="lt iu"/>。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="aead" class="nz mv it nu b gy oa ob l oc od">mydataset&lt;-iris%&gt;%select(Species, everything()) <br/>mydataset%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/db2edcb4c01f80cd759016378f39fd4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tFBwqS3BwnDO51bx.png"/></div></div></figure><p id="5f65" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">示例</strong>:假设我希望列种类出现在我的数据集中最后的<strong class="lt iu">处。</strong></p><p id="4c1f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这有点棘手。看看下面我们如何做到这一点。我们将使用第一列出现的<code class="fe nr ns nt nu b">mydataset</code>，我们将把它移到最后一列。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="e2ef" class="nz mv it nu b gy oa ob l oc od">mydataset%&gt;%select(-Species, everything())%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/d7d310dba2074636ffd9b39cca2c3271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iTX2Zh95BpG2kyew.png"/></div></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="2210" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">重新安置</h1><p id="573c" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated"><code class="fe nr ns nt nu b">relocate()</code>是dplyr 1.0.0中的新增功能。您可以使用<strong class="lt iu"> </strong> <code class="fe nr ns nt nu b">.before</code>或<code class="fe nr ns nt nu b">.after</code>指定列的确切位置。</p><p id="e345" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">例:</strong>假设我想要花瓣。出现在Sepal.Width旁边的宽度列</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="414f" class="nz mv it nu b gy oa ob l oc od">iris%&gt;%relocate(Petal.Width, .after=Sepal.Width)%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/489fd0731a591c48d83c861713640f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hb9OudKRLvU0F5FY.png"/></div></div></figure><p id="03bc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">注意，我们也可以设置在最后一列之后出现。</p><p id="89d6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">例子</strong>:假设我想要花瓣。最后一列的宽度。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="9027" class="nz mv it nu b gy oa ob l oc od">iris%&gt;%relocate(Petal.Width, .after=last_col())%&gt;%head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/94579e33e7f2637f340cfa1cd1abae45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nxgugZgB_QwGTqWM.png"/></div></div></figure><p id="0b01" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以在文档中找到更多信息。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="902e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">拉</h1><p id="a08c" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated">当我们处理数据框并选择单个列时，有时我们希望输出为<code class="fe nr ns nt nu b">as.vector</code>。我们可以用<code class="fe nr ns nt nu b">pull()</code>来实现这个，它是dplyr的一部分。</p><p id="dd1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">示例:</strong>假设我想在萼片中运行t.test。setosa对virginica的长度。注意<code class="fe nr ns nt nu b">t.test</code>函数需要数字向量。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="2fc0" class="nz mv it nu b gy oa ob l oc od">setosa_sepal_length&lt;-iris%&gt;%filter(Species=='setosa')%&gt;%select(Sepal.Length)%&gt;%pull()</span><span id="ee1c" class="nz mv it nu b gy ok ob l oc od">virginica_sepal_length&lt;-iris%&gt;%filter(Species=='virginica')%&gt;%select(Sepal.Length)%&gt;%pull()</span><span id="b5ad" class="nz mv it nu b gy ok ob l oc od">t.test(setosa_sepal_length,virginica_sepal_length)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8647ed24b67271a964c4c49cd5a8da93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Iv64LiTB0QOBbCRJ.png"/></div></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0540" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">重新排序</h1><p id="b0eb" class="pw-post-body-paragraph lr ls it lt b lu nm ju lw lx nn jx lz ma no mc md me np mg mh mi nq mk ml mm im bi translated">当您使用ggplot2时，当您必须根据某些条件对因子进行重新排序时，有时会令人沮丧。假设我们想要显示萼片的箱线图。物种宽度。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="aeaf" class="nz mv it nu b gy oa ob l oc od">iris%&gt;%ggplot(aes(x=Species, y=Sepal.Width))+geom_boxplot()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/839a523b755288b8306de58743166fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U8AeyneNJduYRwoB.png"/></div></div></figure><p id="f62b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">例子</strong>:假设我们想根据物种的中位数对箱线图重新排序。</p><p id="8363" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以通过<code class="fe nr ns nt nu b">stats</code>包中的<code class="fe nr ns nt nu b">reorder()</code>轻松做到这一点。</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="7e81" class="nz mv it nu b gy oa ob l oc od">iris%&gt;%ggplot(aes(x=reorder(Species,Sepal.Width, FUN = median), y=Sepal.Width))+geom_boxplot()+xlab("Species")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/793e66308aaf4f9cbc8ecbc75088bc7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/0*nx7jZprd9L_r4cwY.png"/></div></figure></div></div>    
</body>
</html>