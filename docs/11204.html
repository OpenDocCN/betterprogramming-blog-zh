<html>
<head>
<title>AWS S3 Buckets With Python Tutorial: Uploading, Deleting, and Managing the Files in Buckets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的AWS S3桶教程:上传、删除和管理桶中的文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/aws-s3-buckets-with-python-tutorial-uploading-deleting-and-managing-the-files-in-buckets-dd90d4fd45fe?source=collection_archive---------1-----------------------#2022-02-26">https://betterprogramming.pub/aws-s3-buckets-with-python-tutorial-uploading-deleting-and-managing-the-files-in-buckets-dd90d4fd45fe?source=collection_archive---------1-----------------------#2022-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9b45" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">初学者清晰的概念性指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/476cdd8bf44d60dea3353fe2c9a69ded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aftqpCquz987A2WI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">埃米尔·佩龙在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7cda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亚马逊上的S3存储桶是你可以存储文本文件、音频文件、视频文件、图像和任何其他你喜欢的材料的地方。</p><p id="f611" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">S3有API，可以调用这些API来完成所有可以在数据库上完成的操作。</p><h1 id="cf60" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.创建与S3联系的资源</h1><p id="ee9b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">有两种方法可以连接到S3。</p><ol class=""><li id="b9f3" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">客户端:与资源相比，旧版本的编码更详细。</li><li id="ab8b" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Resource:客户端的新版本，提供了更多处理操作的方法，减少了冗长的编码实践。</li></ol><p id="430f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们坚持使用资源来连接这里。我正在为每个任务开发函数，所以最后，我们将在一个类中收集所有的函数。这样，我们可以增加它的可重用性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一个类和一个构造函数</p></figure><p id="b9b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要拥有代码中提到的三个凭证。如果你想创建一个S3账户，请按照这个<a class="ae kv" href="https://rockstarhelpdesk.com/knowledge-base/how-to-create-your-amazon-s3-account-and-bucket/" rel="noopener ugc nofollow" target="_blank">教程</a>操作。</p><p id="51db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将在这里使用一个已经在S3创建的桶。我的桶名存储在我从S3账户得到的<code class="fe nf ng nh ni b">bucket_name</code> <em class="nj"> </em>中。有一些资源方法可以从python创建bucket，但是为了简单起见，我将使用一个现有的bucket。</p><h1 id="2b6c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.使用自动多部分将数据上传到存储桶</h1><p id="1205" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果文件很大，例如1GB，S3存储桶允许并行线程同时上传文件块，以减少上传时间。如果数据小于1GB，单个线程将完成上传。</p><p id="8730" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多线程和单线程之间的切换是自动的。数据阈值需要如上设置，例如我使用1GB。</p><p id="f1fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">阈值将由您设置，因此您将根据任务调整它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">上传数据的功能</p></figure><p id="289c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">强制参数:</p><ol class=""><li id="858c" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">bucket_name (String)</code>:S3桶名</li><li id="63f0" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">data (byte string)</code>:字节字符串对象<strong class="ky ir">。</strong></li></ol><p id="683a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意上传方法的名称，它的upload_fileobj()。此方法用于上载二进制类型的对象。这意味着如果文件驻留在您的本地系统中，它将不会是二进制形式。你必须使用:</p><pre class="kg kh ki kj gt nk ni nl nm aw nn bi"><span id="da17" class="no lt iq ni b gy np nq l nr ns">with open('filename', 'rb') as data:         <br/>     s3.upload_fileobj(data, 'mybucket', 'mykey')</span></pre><p id="bd41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b">filename</code>是文件在系统上的路径。<code class="fe nf ng nh ni b">rb</code>意为读写二进制。</p><p id="a30d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果数据是从外部URL检索的，那么它已经是二进制形式，因此该方法无需任何额外的更改就可以工作。</p><p id="4249" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想了解更多关于数据如何在网络上传输以及字节字符串和简单字符串之间的区别，请阅读我在参考资料一节中的文章。</p><p id="3e89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.<code class="fe nf ng nh ni b">file_name (String)</code>:你喜欢的任何文件名。这将是S3桶中的文件名，并且将是文件的标识。因此写一个有意义的名字。</p><p id="4329" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">次要参数:</p><p id="c3f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.<code class="fe nf ng nh ni b">file_size (String/int)</code>:我们要上传的文件的大小。在<code class="fe nf ng nh ni b">ProgressPercentage(file_name,file_size)</code>函数中，类型变成了浮点型，因此字符串和整数都有效。</p><p id="f763" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.<code class="fe nf ng nh ni b">content_type (String)</code> : <strong class="ky ir"> </strong>数据的类型；。pdf、mp4等。</p><p id="fc4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b">TransferConfig</code>是配置文件，其中:</p><ol class=""><li id="28ec" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">multipart_threshold</code>:多线程激活的上限。</li><li id="51f3" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">max_concurrency</code>:螺纹数量。默认值为10。</li><li id="e759" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">multipart_chunksize</code>:每个线程中数据的大小。</li><li id="28c4" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><code class="fe nf ng nh ni b">use_threads</code>:启用线程。</li></ol><h1 id="4944" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.查看存储桶内容</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2473" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">bucket中的每个对象都有我们可以使用的属性。<code class="fe nf ng nh ni b">obj.key</code>显示了我们上传的数据的<code class="fe nf ng nh ni b">file_name</code>。其他有用的属性可以在S3的官方文档中找到，链接在本教程的底部。</p><h1 id="a34b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.最后一节课有更多有用的方法</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">进度百分比是由boto3 S3提供的内部类。这在上传大文件时非常有用，因为它显示了加载进度。因此，我们可以看到一个带有数字的进度条，而不是一个空白屏幕。</p><p id="86c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经修改了这个类，使它将<code class="fe nf ng nh ni b">file_size</code>作为输入，而不是从操作系统库本身进行计算。因为我使用的是外部URL，所以我必须自己给出文件大小。</p><p id="3b24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以使用这个类，随心所欲地制作对象，玩水桶。</p><p id="27d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过使用这个类，您还可以用一个连接创建多个存储桶。此外，您不需要在上传/下载后关闭连接，因为连接是Http 1.1，它会在一段时间后由boto3自动关闭。</p><h1 id="87df" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">资源</strong></h1><div class="nt nu gp gr nv nw"><a href="https://www.kite.com/python/docs/boto3.s3.inject.upload_fileobj" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">通过代码行完成、无云处理来加快编码速度</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">Kite是为Python开发者提供的免费自动完成工具。使用Kite插件为您的代码编辑器更快地编码，具有…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.kite.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok kp nw"/></div></div></a></div><div class="nt nu gp gr nv nw"><a href="https://docs.aws.amazon.com/sdk-for-ruby/v2/api/Aws/S3/ObjectSummary.html" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">类别:Aws::S3::对象摘要</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">从亚马逊S3检索对象。要使用GET，您必须拥有对象的读取权限。如果您授予对…的读取权限</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">docs.aws.amazon.com</p></div></div></div></a></div><div class="nt nu gp gr nv nw"><a href="https://medium.com/@hatim.zahid/serialization-and-deserialization-how-data-travels-in-a-computer-network-13f61dc225c4" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">序列化和反序列化:数据如何在计算机网络中传输？</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">为什么选择JSON？什么是TCP？什么是字节串和字节流？</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="ol l oh oi oj of ok kp nw"/></div></div></a></div></div></div>    
</body>
</html>