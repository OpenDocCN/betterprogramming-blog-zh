<html>
<head>
<title>9 Pandas Functions That Will Do Most Data Analytic Tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">9个熊猫功能将完成大多数数据分析任务</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/9-pandas-functions-that-will-do-99-of-any-analytics-task-e6b6fb1b16bf?source=collection_archive---------1-----------------------#2022-01-30">https://betterprogramming.pub/9-pandas-functions-that-will-do-99-of-any-analytics-task-e6b6fb1b16bf?source=collection_archive---------1-----------------------#2022-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e850" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">删除值，更改列名，等等</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/23191f3d3f095fa9d8c98df842abe0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IffysXlBJwO5HdQvNr2KAw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@sincerelymedia?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">真诚媒体</a>在<a class="ae kv" href="https://unsplash.com/s/photos/cooking-cake?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="24eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我总是对我的数据科学/分析学生说:</p><blockquote class="ls"><p id="8b2e" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">大多数情况下，执行数据分析任务就像遵循蛋糕食谱一样</p></blockquote><p id="2892" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">为了做蛋糕，你需要一些工具，不是吗？比如搅拌机，勺子，烤箱…</p><p id="dfdf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了熊猫，你就有了完成任何数据分析任务的必备工具，让我们来了解一下你的“厨房”里不能缺少什么？</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="d2b8" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">读取数据文件</h1><p id="2bcb" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">好吧！重要的事情先来。这一步就像:让我看看我的冰箱里有什么！</p><p id="2b8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我将读取一个Excel文件，它存储在一个名为“dados”的文件夹中，在我的实际文件夹之外。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="f918" class="nq mp iq nm b gy nr ns l nt nu">import pandas as pd</span><span id="3b36" class="nq mp iq nm b gy nv ns l nt nu">import numpy as np </span><span id="fae2" class="nq mp iq nm b gy nv ns l nt nu">#Reading an Excel File</span><span id="51fa" class="nq mp iq nm b gy nv ns l nt nu">df = pd.read_excel('../dados/Olist-full.xlsx')</span></pre><p id="5b1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我使用的是静态文件，这一点很重要。对我来说，如果你正在执行一个初步的探索性分析，这是最好的开始方式。</p><p id="6f73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，在这之后，您可以将代码直接连接到数据湖。</p><h1 id="4035" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">更改列名</h1><p id="b7cc" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">首先，使用<code class="fe ob oc od nm b">.columns</code>方法，让我们看看我们的列名是什么:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="1e18" class="nq mp iq nm b gy nr ns l nt nu">#Showing columns names<br/>df.columns</span></pre><p id="4ec4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，在我的例子中，打印最后一行，返回这一列的名称:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="7939" class="nq mp iq nm b gy nr ns l nt nu">Index(['Unnamed: 0', 'order_id', 'customer_id', 'order_status',<br/>       'order_purchase_timestamp', 'order_approved_at',<br/>       'order_delivered_carrier_date', 'order_delivered_customer_date',<br/>       'order_estimated_delivery_date', 'order_item_id', 'product_id',<br/>       'seller_id', 'shipping_limit_date', 'price', 'freight_value',<br/>       'payment_sequential', 'payment_type', 'payment_installments',<br/>       'payment_value', 'review_id', 'review_score', 'review_comment_title',<br/>       'review_comment_message', 'review_creation_date',<br/>       'review_answer_timestamp', 'product_name_lenght',<br/>       'product_description_lenght', 'product_photos_qty', 'product_weight_g',<br/>       'product_length_cm', 'product_height_cm', 'product_width_cm',<br/>       'product_category_name_english', 'customer_unique_id',<br/>       'customer_zip_code_prefix', 'customer_city', 'customer_state',<br/>       'seller_zip_code_prefix', 'seller_city', 'seller_state'],<br/>      dtype='object')</span></pre><p id="8913" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，如果我想更改一个或多个列的名称，该怎么办呢？我们可以使用<code class="fe ob oc od nm b">rename()</code>函数，并在其上传递一个字典。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="0dd3" class="nq mp iq nm b gy nr ns l nt nu">#Changing columns names<br/>df = df.rename(columns = {<br/>    'order_id': 'id_order_number',<br/>    'customer_id': 'customer_number'<br/>})</span></pre><p id="b396" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们再次打印列名，我们将得到:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="c75e" class="nq mp iq nm b gy nr ns l nt nu">Index(['Unnamed: 0', 'id_order_number', 'customer_number', 'order_status',<br/>       'order_purchase_timestamp', 'order_approved_at',<br/>       'order_delivered_carrier_date', 'order_delivered_customer_date',<br/>       'order_estimated_delivery_date', 'order_item_id', 'product_id',<br/>       'seller_id', 'shipping_limit_date', 'price', 'freight_value',<br/>       'payment_sequential', 'payment_type', 'payment_installments',<br/>       'payment_value', 'review_id', 'review_score', 'review_comment_title',<br/>       'review_comment_message', 'review_creation_date',<br/>       'review_answer_timestamp', 'product_name_lenght',<br/>       'product_description_lenght', 'product_photos_qty', 'product_weight_g',<br/>       'product_length_cm', 'product_height_cm', 'product_width_cm',<br/>       'product_category_name_english', 'customer_unique_id',<br/>       'customer_zip_code_prefix', 'customer_city', 'customer_state',<br/>       'seller_zip_code_prefix', 'seller_city', 'seller_state'],<br/>      dtype='object')</span></pre><p id="c023" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更改列名是很重要的，因为我们的代码需要对使用它的每个人都是可读和可理解的。记住，帮助你未来的同事，他可能要在你今天开发的代码上工作。选择有意义的名称，不仅对列有意义，对变量也有意义。</p><h1 id="0e45" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">检查和描述</h1><p id="9382" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">现在我们将检查我们的数据帧。我总是从<code class="fe ob oc od nm b">info()</code>函数开始，以了解我们正在处理的列中变量的类型。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2351" class="nq mp iq nm b gy nr ns l nt nu">#Basic information about our dataframe<br/>df.info()</span><span id="af4a" class="nq mp iq nm b gy nv ns l nt nu">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 119143 entries, 0 to 119142<br/>Data columns (total 40 columns):<br/> #   Column                         Non-Null Count   Dtype  <br/>---  ------                         --------------   -----  <br/> 0   Unnamed: 0                     119143 non-null  int64  <br/> 1   id_order_number                119143 non-null  object <br/> 2   customer_number                119143 non-null  object <br/> 3   order_status                   119143 non-null  object <br/> 4   order_purchase_timestamp       119143 non-null  object <br/> 5   order_approved_at              118966 non-null  object <br/> 6   order_delivered_carrier_date   117057 non-null  object <br/> 7   order_delivered_customer_date  115722 non-null  object <br/> 8   order_estimated_delivery_date  119143 non-null  object <br/> 9   order_item_id                  118310 non-null  float64<br/> 10  product_id                     118310 non-null  object <br/> 11  seller_id                      118310 non-null  object <br/> 12  shipping_limit_date            118310 non-null  object <br/> 13  price                          118310 non-null  float64<br/> 14  freight_value                  118310 non-null  float64<br/> 15  payment_sequential             119140 non-null  float64<br/> 16  payment_type                   119140 non-null  object <br/> 17  payment_installments           119140 non-null  float64<br/> 18  payment_value                  119140 non-null  float64<br/> 19  review_id                      118146 non-null  object <br/> 20  review_score                   118146 non-null  float64<br/> 21  review_comment_title           119143 non-null  object <br/> 22  review_comment_message         119143 non-null  object <br/> 23  review_creation_date           118146 non-null  object <br/> 24  review_answer_timestamp        118146 non-null  object <br/> 25  product_name_lenght            116601 non-null  float64<br/> 26  product_description_lenght     116601 non-null  float64<br/> 27  product_photos_qty             116601 non-null  float64<br/> 28  product_weight_g               118290 non-null  float64<br/> 29  product_length_cm              118290 non-null  float64<br/> 30  product_height_cm              118290 non-null  float64<br/> 31  product_width_cm               118290 non-null  float64<br/> 32  product_category_name_english  116576 non-null  object <br/> 33  customer_unique_id             119143 non-null  object <br/> 34  customer_zip_code_prefix       119143 non-null  int64  <br/> 35  customer_city                  119143 non-null  object <br/> 36  customer_state                 119143 non-null  object <br/> 37  seller_zip_code_prefix         118310 non-null  float64<br/> 38  seller_city                    118310 non-null  object <br/> 39  seller_state                   118310 non-null  object <br/>dtypes: float64(15), int64(2), object(23)<br/>memory usage: 36.4+ MB</span></pre><p id="8842" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您可以注意到<code class="fe ob oc od nm b">dtypes</code>值，看看它们是否符合您的期望。在这里我可以看到，我期待的是<code class="fe ob oc od nm b">order_purchase_timestamp</code> <em class="oe">，</em>的<code class="fe ob oc od nm b">datetime</code>值，但我得到的是对象1。你会进一步看到我们如何改变这种情况。</p><p id="7715" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里很重要的一点是，你要看看你的变量是如何表现的。于是我们有了两个强大的熊猫功能，<code class="fe ob oc od nm b">describe()</code> <em class="oe"> </em>和<code class="fe ob oc od nm b">value_counts()</code> <em class="oe">。</em>第一个是变量数量，第二个是分类变量数量。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="337d" class="nq mp iq nm b gy nr ns l nt nu">#Describing the 'price' variable<br/>df['price'].describe()</span></pre><p id="4518" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我描述价格变量，它返回给我:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="277d" class="nq mp iq nm b gy nr ns l nt nu">count    118310.000000<br/>mean        120.646603<br/>std         184.109691<br/>min           0.850000<br/>25%          39.900000<br/>50%          74.900000<br/>75%         134.900000<br/>max        6735.000000<br/>Name: price, dtype: float64</span></pre><p id="6700" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，我就可以了解我的变量在孔数据集中的行为，以及平均值、标准差、最小值和最大值等重要测量值。</p><p id="6718" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe ob oc od nm b">value_counts()</code>函数，我可以探索分类变量的行为，比如<code class="fe ob oc od nm b">payment_type</code>。这里我可以看到原始结果和归一化结果，只是改变了一个参数。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="664d" class="nq mp iq nm b gy nr ns l nt nu">#Describing the 'price' variable<br/>df['payment_type'].value_counts()</span><span id="a66a" class="nq mp iq nm b gy nv ns l nt nu">#Describing the 'payment_type' variable<br/>df['payment_type'].value_counts(normalize = True)</span></pre><p id="12ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看结果，首先是原始结果:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5917" class="nq mp iq nm b gy nr ns l nt nu">credit_card    87776<br/>boleto         23190<br/>voucher         6465<br/>debit_card      1706<br/>not_defined        3<br/>Name: payment_type, dtype: int64</span></pre><p id="5864" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是正常化的:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="ca61" class="nq mp iq nm b gy nr ns l nt nu">credit_card    0.736747<br/>boleto         0.194645<br/>voucher        0.054264<br/>debit_card     0.014319<br/>not_defined    0.000025<br/>Name: payment_type, dtype: float64</span></pre><p id="1cf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我可以看到(再次)我的洞数据集，我有73.67%的付款，由信用卡支付。</p><h1 id="86b0" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">丢弃值</h1><p id="7d69" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">降低价值就像扔掉冰箱里的臭鸡蛋。为此，我们有一些可能性。</p><p id="07ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们使用<code class="fe ob oc od nm b">isna()</code>函数检查我们的数据帧中是否有NaN值。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="9646" class="nq mp iq nm b gy nr ns l nt nu">#Checking if we have any NaN value<br/>df.isna().any()</span></pre><p id="66b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它返回给我们以下内容:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="e4cc" class="nq mp iq nm b gy nr ns l nt nu">Unnamed: 0                       False<br/>id_order_number                  False<br/>customer_number                  False<br/>order_status                     False<br/>order_purchase_timestamp         False<br/>order_approved_at                 True<br/>order_delivered_carrier_date      True<br/>order_delivered_customer_date     True<br/>order_estimated_delivery_date    False<br/>order_item_id                     True<br/>product_id                        True<br/>seller_id                         True<br/>shipping_limit_date               True<br/>price                             True<br/>freight_value                     True<br/>payment_sequential                True<br/>payment_type                      True<br/>payment_installments              True<br/>payment_value                     True<br/>review_id                         True<br/>review_score                      True<br/>review_comment_title             False<br/>review_comment_message           False<br/>review_creation_date              True<br/>review_answer_timestamp           True<br/>product_name_lenght               True<br/>product_description_lenght        True<br/>product_photos_qty                True<br/>product_weight_g                  True<br/>product_length_cm                 True<br/>product_height_cm                 True<br/>product_width_cm                  True<br/>product_category_name_english     True<br/>customer_unique_id               False<br/>customer_zip_code_prefix         False<br/>customer_city                    False<br/>customer_state                   False<br/>seller_zip_code_prefix            True<br/>seller_city                       True<br/>seller_state                      True<br/>dtype: bool</span></pre><p id="f6d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以做一个决定，删除具有NaN值的列中的行，例如在<code class="fe ob oc od nm b">product_id</code>上。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5d25" class="nq mp iq nm b gy nr ns l nt nu">#Droping NaN values of the product_id column<br/>df = df.dropna(subset = ['product_id'])</span></pre><h1 id="369e" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">更改列类型</h1><p id="888a" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">正如我们在上面看到的，<code class="fe ob oc od nm b">order_purchase_timestamp</code>是一个对象列，但它应该是一个日期时间列，那么，我们该如何做呢？</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2c37" class="nq mp iq nm b gy nr ns l nt nu">#Changing the dtype of the order_purchase_timestamp</span><span id="6a05" class="nq mp iq nm b gy nv ns l nt nu">df['order_purchase_timestamp'] = pd.to_datetime(df['order_purchase_timestamp'])</span></pre><p id="fc1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还可以使用其他函数，比如<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html" rel="noopener ugc nofollow" target="_blank"> to_numeric() </a>！</p><h1 id="c447" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">使用日期和时间</h1><p id="7d7d" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">知道如何操作日期和时间很重要！</p><p id="0731" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如何只获取特定日期时间列的年份或月份？理解数据框架中的圆对我们来说至关重要。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2e40" class="nq mp iq nm b gy nr ns l nt nu">#Create a new column with the month of the order<br/>df['order_month'] = df['order_purchase_timestamp'].dt.month</span></pre><p id="a75e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以得到，天，年，小时…</p><h1 id="36b3" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">分组</h1><p id="a959" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">分组对于任何数据分析都是必不可少的。我在这里发表了一篇<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/the-best-way-to-group-data-in-pandas-7f446a1fc7fa">文章</a>，向你展示了使用Pandas对你的数据框进行分组的最佳方式。</p><p id="8c9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看一个非常好的例子！我想要特定时间段内不同列的一些测量值，每个时间段3个月:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2407" class="nq mp iq nm b gy nr ns l nt nu">#Grouping for each 3 months by customer_state<br/>buys_3m = df.groupby([pd.Grouper(key = 'order_purchase_timestamp', freq = '3M'), 'customer_state']).agg({<br/>    'id_order_number': 'nunique',<br/>    'price': ['sum', 'mean', 'max'],<br/>    'freight_value': ['mean', 'median'],<br/>}).reset_index()</span><span id="6183" class="nq mp iq nm b gy nv ns l nt nu">buys_3m.columns = ['_'.join(col) for col in buys_3m.columns]</span></pre><p id="1988" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且，它返回…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/80055bea2ba3e6d771e75fd8baa9b969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOzmq8PPwUtXtsO2yOAcYA.png"/></div></div></figure><h1 id="9493" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">过滤</h1><p id="83f1" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">过滤数据可以让我们对真正重要的数据进行个性化处理。假设我只想选择特定销售类型的数据，这些数据来自特定的州，并且高于某个值，我们该如何做呢？</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="a13f" class="nq mp iq nm b gy nr ns l nt nu">#Filtering for SP state and price up or equal 115<br/>sp_above_mean = df[(df['price'] &gt;= 115) &amp; (df['seller_state'] == 'SP')]</span></pre><p id="c231" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将返回一个新的<code class="fe ob oc od nm b">dataframe</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/aac211365463fa89f3e9863b1d36b4b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-T4guyWCd6g0AV5gz_b5Q.png"/></div></div></figure><p id="d258" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以使用过滤器来移除异常值:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="973a" class="nq mp iq nm b gy nr ns l nt nu">#Filtering by the quantile - we can remove outliers with this<br/>q1 = df['price'].quantile(0.01)<br/>q2 = df['price'].quantile(0.99)</span><span id="8b8b" class="nq mp iq nm b gy nv ns l nt nu">df_price_outliers = df[(df['price'] &gt;= q1) &amp; (df['price'] &lt;= q2)]</span></pre><h1 id="df30" class="mo mp iq bd mq mr nw mt mu mv nx mx my jw ny jx na jz nz ka nc kc oa kd ne nf bi translated">通过应用和映射进行个性化</h1><p id="8b6b" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">我们还可以使用<code class="fe ob oc od nm b">apply()</code>函数和<code class="fe ob oc od nm b">map()</code> <em class="oe"> </em>函数进一步定制我们的分析。看到了。</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5530" class="nq mp iq nm b gy nr ns l nt nu">#Creating a new column with apply<br/>df['price_status'] = df['price'].apply(lambda x: 'UP' if x &gt;= df['price'].mean() else 'DOWN')<br/>#Creating a new column using map<br/>df['seller_by_payment'] = df['payment_type'].map(credit_cards)</span></pre><p id="03b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这为我们创造了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/c0bd105af70e28c3b8e4dc245cf23a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGfJDiFCTxwCI8wZnCbeSg.png"/></div></div></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="8412" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是完整的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="8a66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经到了这个蛋糕食谱的末尾，你已经有了一个非常完整的，但是是初始的代码，它将能够指导你进行数据分析。有了我给你的这些工具，你一定能满足需求！</p><p id="6787" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢它！</p><p id="6aa6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">.</p><p id="3c8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">.</p><p id="194b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi">.</p><p id="f640" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想了解更多，请点击这里查看我的指导课程:<a class="ae kv" href="https://mentorcruise.com/mentor/NathanLara/" rel="noopener ugc nofollow" target="_blank">https://mentorcruise.com/mentor/NathanLara/</a></p></div></div>    
</body>
</html>