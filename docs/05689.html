<html>
<head>
<title>Animate Views in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI中的动画视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/animate-views-in-swiftui-5a9e7a2be21?source=collection_archive---------8-----------------------#2020-07-28">https://betterprogramming.pub/animate-views-in-swiftui-5a9e7a2be21?source=collection_archive---------8-----------------------#2020-07-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce66" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何用SwiftUI构建简单但漂亮的动画</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/11be60b7c06ede41f91db616c5203dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Cyt8oKAp3z_CW_EnYEa4Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@maxcodes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">麦克斯韦·纳尔逊</a>在<a class="ae ky" href="https://unsplash.com/s/photos/swift?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="f7b5" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">先决条件</strong></h2><ul class=""><li id="8006" class="lv lw it lx b ly lz ma mb li mc lm md lq me mf mg mh mi mj bi translated">迅速发生的</li><li id="bfb4" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated">斯威夫特伊</li><li id="b21c" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated">Xcode 12 beta 2</li></ul></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="a2be" class="mw la it bd lb mx my mz le na nb nc lh jz nd ka ll kc ne kd lp kf nf kg lt ng bi translated">介绍</h1><p id="7dca" class="pw-post-body-paragraph nh ni it lx b ly lz ju nj ma mb jx nk li nl nm nn lm no np nq lq nr ns nt mf im bi translated">构建一个复杂的动画起初可能看起来令人生畏，但是，像计算机科学中的任何其他问题一样，您可以通过使用分而治之的方法来简化它。这是我们将要建造的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/36917d78b37315f89c25dbbcf85d0a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*WOE8r63QtFJkFLi-kFQkiw.gif"/></div></figure><p id="8568" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">如果你不想跟随整篇文章，跳到你能找到GitHub链接的结尾。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="33bb" class="mw la it bd lb mx my mz le na nb nc lh jz nd ka ll kc ne kd lp kf nf kg lt ng bi translated">第一</h1><p id="595e" class="pw-post-body-paragraph nh ni it lx b ly lz ju nj ma mb jx nk li nl nm nn lm no np nq lq nr ns nt mf im bi translated">让我们从一些基本的开始。我们要做的是画一个矩形，并使角落变圆。与UIKit相比，这在SwiftUI中相当简单——只有一行代码:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="0f0d" class="kz la it ob b gy of og l oh oi">RoundedRectangle(cornerRadius: 25.0, style: .continuous)</span></pre><p id="4cd2" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">我们画了一个长方形。</p><p id="ab99" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">现在，我们要添加一些颜色和旋转效果。然后，我们将通过一个按钮来触发旋转。我们将使用SwiftUI中的工具，如<code class="fe oj ok ol ob b">VStack</code>、<code class="fe oj ok ol ob b">Button</code>、<code class="fe oj ok ol ob b">@State</code>、<code class="fe oj ok ol ob b">@Binding</code>。如果你不熟悉这些词，你可能想刷新你的SwiftUI知识！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="028f" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">当您运行这段代码时，您会看到矩形旋转了，但是动画效果并不平滑。在SwiftUI中，有一个完美的修改器来制作这样的过渡动画。只需在第14行之后，在<code class="fe oj ok ol ob b">.rotationEffect(..)</code>之后添加下面的代码。您也可以将<code class="fe oj ok ol ob b">rotationDegree</code>改为360°进行全旋转:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="ed3b" class="kz la it ob b gy of og l oh oi">.animation(.easeInOut)</span><span id="dc09" class="kz la it ob b gy oo og l oh oi">You can also make your view animate forever (Well, not forever of course). Here is how to do it.</span><span id="ae18" class="kz la it ob b gy oo og l oh oi">.animation(Animation.easeInOut.repeatForever(autoreverses: <strong class="ob iu">true</strong>))</span></pre><p id="44ca" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">我们将<code class="fe oj ok ol ob b">autoreverses</code>设置为true，这样当动画完成时，视图也可以返回到原始状态。现在，我们有一个连续旋转的矩形视图。</p><p id="79ee" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">为了实现gif格式的动画，我们应该旋转3D视图:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="a3d2" class="kz la it ob b gy of og l oh oi">.rotation3DEffect(Angle.degrees(60), axis: (x: 1, y: 0, z: 0))</span></pre><p id="3296" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">这段代码将我们的视图在x轴上旋转60度。它应该看起来好像我们的对象是躺在一个平面上。我不确定如何准确地描述它，但它看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/48c38012e26d67f908839f14054d43c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2NbZPLp4iebgtGMF_DB8A.png"/></div></div></figure><p id="9a73" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">由于我们有一个旋转视图，我们将使用该视图的多个实例。但是我们必须首先修改我们的视图，以便它能够动态地工作。我的意思是我们的视图需要知道什么时候开始旋转。这里有两个要点。第一个是点击动作，告诉视图开始旋转。另一个是延迟机制。如果我们不使用延迟机制，我们的视图将一起旋转，看起来完全一样。我们需要的是一个绑定属性和一个索引。我们将这样使用它:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="3c8f" class="kz la it ob b gy of og l oh oi">RectangleView(isRotated: $isRotated, index: index)</span></pre><p id="7e64" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated"><code class="fe oj ok ol ob b">ContentView</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="a6c0" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated"><code class="fe oj ok ol ob b">RectangleView</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="1b44" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">我们就快到了，只差几步了。如果你跟踪了一切，你会看到我们的视角如预期的那样旋转。但是他们彼此远离。为了解决这个问题，我们使用了<code class="fe oj ok ol ob b">.offset</code>修改器。我们将在Y轴上拉近它们，这样会好得多。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="1c91" class="kz la it ob b gy of og l oh oi"><strong class="ob iu">var</strong> yOffset: CGFloat = -60</span><span id="6c51" class="kz la it ob b gy oo og l oh oi">.offset(x: 0, y: yOffset * CGFloat(index))</span></pre><p id="dfec" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">我知道——这看起来有点奇怪，当你运行它时，动画甚至没有接近我在Gif中承诺的那样。相信我，会好起来的。</p><p id="48a9" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">问题是所有视图都在同一Z轴上:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/9439388d0ef58376f4260e766baf7ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*05h3i9q9CCYRW3468GCSSg.png"/></div></figure><p id="c48c" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">为了解决这个问题，我们将使用<code class="fe oj ok ol ob b">.zIndex</code>来控制哪个视图出现在前面或后面。把它想象成你在Z轴上插入。任何具有更大<code class="fe oj ok ol ob b">zIndex</code>的视图都将在最前面。为了简单起见，我使用了一个带有负值的数组索引:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="0fbd" class="kz la it ob b gy of og l oh oi">.zIndex(Double(-index))</span></pre></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="64e8" class="mw la it bd lb mx my mz le na nb nc lh jz nd ka ll kc ne kd lp kf nf kg lt ng bi translated">最后</h1><p id="8fb8" class="pw-post-body-paragraph nh ni it lx b ly lz ju nj ma mb jx nk li nl nm nn lm no np nq lq nr ns nt mf im bi translated">我们完了！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="1f7c" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">让我们美化它并添加一些颜色，将这条线从<code class="fe oj ok ol ob b">.green</code>改为<code class="fe oj ok ol ob b">color[index]</code>:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="79d5" class="kz la it ob b gy of og l oh oi">.foregroundColor(color[index]).brightness(0 + (0.04 * Double(index)))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/1811e88c7441fb20cf5cff5c5e47d306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*wvCEQ1tQw4YYA-e7EqQ9LQ.gif"/></div></div></figure></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="d943" class="mw la it bd lb mx my mz le na nb nc lh jz nd ka ll kc ne kd lp kf nf kg lt ng bi translated">结论</h1><p id="bd44" class="pw-post-body-paragraph nh ni it lx b ly lz ju nj ma mb jx nk li nl nm nn lm no np nq lq nr ns nt mf im bi translated">Gif质量不如视频质量——在模拟器中看起来好很多，也更流畅。</p><p id="158a" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">借助SwiftUI的强大功能，构建UI动画变得前所未有的简单。你可以把小的动画放在一起，创造出漂亮的动画。尝试不同的组合——值得你花时间。</p><p id="ed1b" class="pw-post-body-paragraph nh ni it lx b ly nv ju nj ma nw jx nk li nx nm nn lm ny np nq lq nz ns nt mf im bi translated">感谢阅读！如果您有任何问题或反馈，请联系我们。您可以通过下面的链接找到该项目:</p><div class="os ot gp gr ou ov"><a href="https://github.com/ibrahimoktay/SwiftUIAnimation" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">ibrahimoktay/SwiftUIAnimation</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">在GitHub上创建一个帐户，为ibrahimoktay/SwiftUIAnimation开发做贡献。</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">github.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div></div></div>    
</body>
</html>