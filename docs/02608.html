<html>
<head>
<title>How to Use One Command to Create RESTful APIs with TypeORM CLI on Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用一个命令在Node.js上用TypeORM CLI创建RESTful APIs</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/get-started-with-typeorm-mysql-and-express-js-653270a6a078?source=collection_archive---------3-----------------------#2019-12-12">https://betterprogramming.pub/get-started-with-typeorm-mysql-and-express-js-653270a6a078?source=collection_archive---------3-----------------------#2019-12-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0247" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开始使用TypeORM、MySQL和Express.js</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/76d3011095ffe9a05e41cf9343ece17e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PqJxmqKp1IS5T9jRYWuJNA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@amyshamblen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Amy Shamblen </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的原图。由<a class="ae ky" href="http://www.songthamtung.com" rel="noopener ugc nofollow" target="_blank">song tham Tungkitkancharoen</a>修改。</p></figure><p id="6871" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">TypeORM将应用程序连接到数据库。在本文中，我将向您展示如何快速创建一个新的RESTful API microservice on Express(NodeJS ),它使用TypeORM与MySQL集成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0569d103c38c3516e06d3652c52a2c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*OnnqK8xBIxjbfjO6wP7q3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ORM是API和数据库之间的桥梁</p></figure><p id="29b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您已经熟悉ORM的使用，让我们跳到一个命令行。</p><h2 id="45b5" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">概述</h2><ol class=""><li id="f390" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu mw mx my mz bi translated">定义</li><li id="78ce" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated">先决条件</li><li id="336f" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated">一个内衬</li><li id="65cc" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated">测试</li></ol></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="bfc2" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">定义</h1><ul class=""><li id="fa19" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu nx mx my mz bi translated"><strong class="lb iu">TypeORM</strong>——根据他们<a class="ae ky" href="https://typeorm.io/#/" rel="noopener ugc nofollow" target="_blank">网站</a>，“type ORM是一种可以在NodeJS、Browser、Cordova、PhoneGap、Ionic、React Native、NativeScript、Expo、Electron平台运行的ORM，可以和TypeScript、JavaScript (ES5、ES6、ES7、ES8)一起使用。”</li><li id="16d5" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><strong class="lb iu">对象关系映射(ORM) </strong> —将应用程序连接到数据库。你可以把它想象成使用应用程序级别的代码来执行查询。</li><li id="87dd" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated">MySQL  —一个流行的开源关系数据库。</li><li id="881e" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><strong class="lb iu">Express</strong>—NodeJS的web框架。</li><li id="c557" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><strong class="lb iu"> RESTful API </strong> —参见“<a class="ae ky" href="https://read.acloud.guru/tech-talk-api-74075a21d1ef" rel="noopener ugc nofollow" target="_blank"> WTF是API？</a>”</li></ul></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="351b" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">先决条件</h1><ul class=""><li id="b2f2" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu nx mx my mz bi translated">NPM</li><li id="10f3" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated">关系型数据库</li><li id="6cb3" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated">Docker(如果你没有MySQL)</li></ul></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="4508" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">一个内衬</h1><h2 id="4834" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">1.安装类型</h2><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="44e9" class="lw lx it nz b gy od oe l of og">npm install typeorm</span></pre><h2 id="a242" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">2.初始化</h2><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="a983" class="lw lx it nz b gy od oe l of og">typeorm init --name user-microservice --database mysql --express</span></pre><p id="fdaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解释:</strong>该命令创建一个名为<code class="fe oh oi oj nz b">user-microservice</code>的新TypeORM项目，并移植必要的代码以使用Express和MySQL。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/a39b890ff75ee525d9ebde41fcb76ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*oyi_rIbWUYH2ZTC4UMErhA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">轻松点。我们刚刚创建了一个Node.js项目，其中包括路由、控制器和实体</p></figure><p id="9883" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解释:</strong> <code class="fe oh oi oj nz b">routes.ts</code>是API的入口点。<strong class="lb iu"/><code class="fe oh oi oj nz b">UserController.ts</code>是路线和实体之间的协调者。<code class="fe oh oi oj nz b">User.ts</code> <strong class="lb iu"> </strong>是为数据库定义表模式的实体。</p><p id="05e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">暂停一分钟，看看每个文件中的代码，看看每个部分是如何相互连接的。注意到什么模式了吗？</p><h2 id="f233" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">3.安装软件包</h2><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="fe95" class="lw lx it nz b gy od oe l of og">cd user-microservice<br/>npm install</span></pre><h2 id="134f" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">4.数据库配置</h2><p id="5138" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">如果你已经有了MySQL，运行它的一个本地实例，并在<code class="fe oh oi oj nz b">ormconfig.json</code>中更新连接设置。</p><p id="f73a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">否则，使用以下Docker命令:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="dbc2" class="lw lx it nz b gy od oe l of og">docker run --name songtham-mysql -e MYSQL_ROOT_PASSWORD=test -e MYSQL_USER=test -e MYSQL_PASSWORD=test -e MYSQL_DATABASE=test -p 3306:3306 -d mysql:latest --default-authentication-plugin=mysql_native_password</span></pre><p id="1431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解释:</strong>这个Docker命令抓取最新的MySQL版本，并在你的计算机上本地运行。注意:如果你运行这个，你不需要对<code class="fe oh oi oj nz b">ormconfig.json</code>做任何改变，因为它已经被映射到默认的配置文件。</p><h2 id="7a26" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">5.开始</h2><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="c152" class="lw lx it nz b gy od oe l of og">npm start</span></pre></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="6989" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">测试</h1><p id="a515" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">如果您做的一切都正确，您应该会看到以下消息:</p><blockquote class="oo op oq"><p id="fbc2" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">Express server已在端口3000上启动。打开<a class="ae ky" href="http://localhost:3000/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/users</a>查看结果</p></blockquote><h2 id="55c8" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">得到</h2><p id="93b8" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">导航到<a class="ae ky" href="http://localhost:3000/users" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/users，</a>您将在页面上看到:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="fbcf" class="lw lx it nz b gy od oe l of og">[{"id":1,"firstName":"Timber","lastName":"Saw","age":27},{"id":2,"firstName":"Phantom","lastName":"Assassin","age":24}]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/f2113b956314d3069b2a99cc259ff7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_f7MnL_Gi9kjxN-u4RLGg.png"/></div></div></figure><p id="8b3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能想知道，“这些用户是如何出现在数据库中的？”</p><p id="a388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您查看一下<code class="fe oh oi oj nz b">index.ts</code>、<strong class="lb iu">、</strong>内部，您可以看到启动服务器使用以下代码行创建用户:</p><blockquote class="oo op oq"><p id="f675" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">//插入新用户进行测试</p><p id="1ad6" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">等待connection . manager . save(connection . manager . create(User，{</p><p id="76bb" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">名字:“木材”，</p><p id="2957" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">姓氏:“锯子”，</p><p id="4741" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">年龄:27岁</p><p id="76f7" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi">}));</p><p id="d5e3" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">等待connection . manager . save(connection . manager . create(User，{</p><p id="0839" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">名字:“幻影”，</p><p id="ea38" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">姓氏:“刺客”，</p><p id="5d1c" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi translated">年龄:24岁</p><p id="194f" class="kz la or lb b lc ld ju le lf lg jx lh os lj lk ll ot ln lo lp ou lr ls lt lu im bi">}));</p></blockquote><h2 id="42d1" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">邮政</h2><p id="fdf0" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">要向users表添加新记录，请运行以下CURL命令:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="8da7" class="lw lx it nz b gy od oe l of og">curl -d ‘{“firstName”:”Bob”, “lastName”:”Ross”, “age”:”52"}’ -H “Content-Type: application/json” -X POST <a class="ae ky" href="http://localhost:3000/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/users</a></span></pre><p id="43bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果操作正确，您应该在数据库中获得一个新条目，如果您转到<a class="ae ky" href="http://localhost:3000/users" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/users</a>，您会看到相同的条目。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="dd90" class="lw lx it nz b gy od oe l of og">[{"id":1,"firstName":"Timber","lastName":"Saw","age":27},{"id":2,"firstName":"Phantom","lastName":"Assassin","age":24},{"id":3,"firstName":"Bob","lastName":"Ross","age":52}]</span></pre></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="bb7a" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">关闭</h1><p id="7dd3" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">TypeORM是一个易于使用的ORM，只需一行代码就可以搭建连接到数据库的新应用程序。您可以使用它来快速创建新项目和/或微服务。</p><p id="eaa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本指南涵盖了使用CLI初始化新应用程序、将其连接到MySQL以及执行GET和POST API请求的基础知识。还有更高级的特性，比如<a class="ae ky" href="https://medium.com/better-programming/typeorm-migrations-explained-fdb4f27cb1b3" rel="noopener">迁移</a>、固定装置和实体关系，我将在以后的文章中介绍。敬请关注。</p><p id="7e08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="aa03" class="nm lx it bd ly nn no np mb nq nr ns me jz nt ka mh kc nu kd mk kf nv kg mn nw bi translated">资源</h1><ul class=""><li id="1b21" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu nx mx my mz bi translated"><a class="ae ky" href="http://www.typeorm.io" rel="noopener ugc nofollow" target="_blank"> www.typeorm.io </a></li><li id="b543" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><a class="ae ky" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank">www.mysql.com</a></li><li id="6c94" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><a class="ae ky" href="http://www.docker.com" rel="noopener ugc nofollow" target="_blank">www.docker.com</a></li><li id="a21b" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><a class="ae ky" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank">www.npmjs.com</a></li><li id="d4de" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nx mx my mz bi translated"><a class="ae ky" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank">www.expressjs.com</a></li></ul></div></div>    
</body>
</html>