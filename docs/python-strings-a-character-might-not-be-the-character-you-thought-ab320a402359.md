# Python 字符串:一个字符可能不是您想象的字符

> 原文：<https://betterprogramming.pub/python-strings-a-character-might-not-be-the-character-you-thought-ab320a402359>

## 对 Python 字符串有更深的理解

![](img/31962eca8905187741790b58b460be6d.png)

照片由[马库斯·温克勒](https://unsplash.com/@markuswinkler?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

文本信息是几乎每个应用程序中最常见的数据形式。在 Python 中，文本数据通常通过使用带有`str`类的字符串来表示。使用 Python 一段时间的人应该对基本的字符串特性有很好的理解。其中一个特征是 Python 字符串是字符序列，这种说法是如此自然，以至于我们可能认为这是理所当然的。但是，您有没有想过字符串中的字符到底是什么意思？

我们先来看下面这个例子。想猜猜绳子`text`的长度吗？

```
text = 'è'
print(len(text))
```

如果你在你的控制台上运行代码，你会发现`'è'`的长度是 2。这让你吃惊吗？

大概是的？如果您不确定结果，可以考虑通过传递字符串来创建一个 list 对象，如下所示。这个操作是合法的，因为字符串是字符的可迭代对象，list 构造函数可以接受一个可迭代对象。

```
>>> list('è')
['e', '̀']
```

您将看到文本字符串中有两个字符，它们形成了一个两项列表，如上所示。第二个字符看起来很有趣，因为它应用在第一个单引号的上面，而不是占据单引号之间的位置。想知道为什么会发生这种情况吗？我们继续吧。

# 字符 Unicode 码位

在讨论我们看到的代码之前，有必要知道 Python 字符串由字符组成，而这些字符实际上是 Unicode 字符，或者更准确地说，是代码点。

如果您不知道，Unicode 是一种被广泛采用的表示和处理文本数据的标准。Unicode 系统可以编码超过 100，000 个字符，几乎涵盖了所有的书面语言。一个 Unicode 字符通常被称为 Unicode 码位，它被表示为 U+后跟四到六个十六进制值。

在 Python 中，当我们创建一个字符串时，可以直接使用 Unicode 码位。语法是我们使用`'\u'`作为代码点值的前缀。观察下面的一些例子。

```
>>> '\u0045'
'E'
>>> '\u0065'
'e'
>>> '\u2660'
'♠'
```

如您所见，所有这些 Unicode 点都被正确地转换为它们所代表的相应字符。尽管这些字符串变量看起来不止一个字符，但是如果您检查它们的长度，您会发现事实并非如此。

```
>>> len('\u0045')
1
>>> len('\u0065')
1
>>> len('\u2660')
1
```

如你所见，所有这些字符串的长度都是 1。原因很简单:每个字符串只有一个 Unicode 码位，相当于一个字符。

# 特殊字符

我们知道 Python 中有一些我们使用的特殊字符，它们通常有一个反斜杠前缀。例如，`\t`代表水平标签，`\n`代表新的一行。你有没有想过它们是否是单个字符(长度为一)？

```
>>> tab = "\t"
>>> len(tab)
1
>>> newline = "\n"
>>> len(newline)
1
```

如上所示，它们都是单个字符。到目前为止，如果您了解 Python 字符串中的字符是 Unicode 字符，您可能会认为这些特殊字符应该有相应的 Unicode 码位。更重要的是，您可以预测它们是等价的，因为在幕后，它们都是 Unicode 码位。观察下面的效果。

```
>>> "\u0009" == tab == "\t"
True
>>> "\u000A" == newline == "\n"
True
```

因此，我们应该理解，特殊字符的特殊之处在于，它们并不意味着它们看起来是什么(而不是带有字母 *t* 或 *n* 的反斜杠)。然而，特殊字符并不特别，因为它们和其他常规字符一样是 Unicode 码位。

# 解决问题

现在我们准备解决开始时提出的问题:为什么一个字符串`'è'`的长度是 2？

对于这个问题，我想你大概可以有一个很好的答案或者猜测。很可能是字符串`'è'`有两个 Unicode 码位。

信不信由你，一个字符(从表面上看，比如`'è'`)可以由两个基本的 Unicode 字符组成。为了找出底层的代码点，我们可以使用内置的`ord`函数。该函数返回传递给该函数的 Unicode 字符的码位的整数值，如下所示。请注意，如上所述，字符串`'è'`有两个字符，因此我们将对这两个字符分别运行函数。

```
>>> ord('è'[0])
101
>>> ord('è'[1])
768
```

如果你查找任何在线 Unicode 表，你会发现这两个码位被命名为拉丁文小写字母 E 和组合重音符，它们对应的十六进制值分别是 65 和 300。有了这些值，我们可以用 Unicode 码位重构字符串。

```
>>> "\u0065\u0300"
'è'
>>> 'è' == "\u0065\u0300"
True
```

作为一个旁注，代码点结合重音符有点不寻常，因为它将在适用的地方结合它的前一个字符。为此，`“\u0065\u0300”`恢复一个角色的样子。

# 不要被外表所迷惑

我们一直在使用字符串`'è'`的例子。可能有些人会认为这是带有重音符的拉丁字母 *e* 。虽然它们看起来是一样的，但是 Python 对它们的解释是不同的。

```
>>> 'è' == 'è'
False
```

这个结果应该不会让您感到惊讶，因为带有重音符的拉丁字母 *e* 是一个单一的 Unicode 码位，如下所示。

```
>>> '\u00E8'
'è'
```

将 Python 字符串理解为 Unicode 码位序列后，看到`‘è’ == ‘è’`就不会奇怪了，因为前者有两个码位，而后者只有一个。

# 结论

在本文中，我们回顾的中心思想是 Python 字符串中的字符是 Unicode 码位。尽管它们看起来可能是一个或多个字符，但它们对基础 Unicode 码位的实际表示决定了它们是单个字符还是多个字符。