<html>
<head>
<title>How to detect Emojis With JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript检测表情符号</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-detect-emojis-with-javascript-1a0342be9af7?source=collection_archive---------8-----------------------#2022-02-08">https://betterprogramming.pub/how-to-detect-emojis-with-javascript-1a0342be9af7?source=collection_archive---------8-----------------------#2022-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用正则表达式匹配字符串中的表情符号</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b276bb2f8822757fd1bc8da3387cf603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5GJcMOjF666Ou-LUUqz_w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/two-yellow-emoji-on-yellow-case-207983/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae ky" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a>拍摄</p></figure><p id="3971" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近过滤了一个巨大的Twitter时间轴，使用深度神经网络进行分析。如你所知，推文可以包含不同种类的内容，包括表情符号。因此，第一步是清理数据，在这种情况下，从时间线中删除所有表情符号。</p><p id="4ce6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这可以用很多方法来实现，但我将展示如何用JavaScript来实现，因为它简单快捷，所以让我们开始吧。</p><p id="cdd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你可能从这篇文章的副标题中猜到的那样，我们将使用正则表达式来做这件事。</p><p id="54d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现代浏览器支持Unicode属性，允许你根据表情符号在表情符号Unicode类别中的归属来匹配表情符号。例如，您可以使用类似于<code class="fe lv lw lx ly b"><strong class="lb iu">\p</strong>{Emoji}</code> <strong class="lb iu"> </strong>或<code class="fe lv lw lx ly b">\P{Emoji}</code> <strong class="lb iu"> </strong>的Unicode属性转义来匹配/不匹配表情符号字符。请注意，0123456789#*和其他字符被解释为使用之前的Unicode类别的表情符号。因此，更好的方法是使用<code class="fe lv lw lx ly b"><strong class="lb iu">{Extended_Pictographic}</strong></code> Unicode类别，表示所有通常被理解为表情符号的字符，而不是使用<code class="fe lv lw lx ly b">{Emoji}</code> <strong class="lb iu"> </strong>类别。</p><p id="1e99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一些例子。</p><h2 id="5c69" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">使用\p{}匹配Unicode字符</h2><p id="fb8a" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">如果您使用“表情符号”Unicode类别，您可能会得到不正确的结果:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="b466" class="lz ma it ly b gy nb nc l nd ne">const withEmojis = /\p{Emoji}/u<br/>withEmojis.test('😀');  <br/>//true</span><span id="181c" class="lz ma it ly b gy nf nc l nd ne">withEmojis.test('ab');<br/>//false</span><span id="cb29" class="lz ma it ly b gy nf nc l nd ne">withEmojis.test('1');  <br/>//true  <strong class="ly iu">opps!</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a7e479507bdd2fc6ab9fdebe8e2b856d.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*wR4ZF_O9pGAuVeDU770jhg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例1</p></figure><p id="2aab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，如前所述，最好使用扩展象形图:</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="e919" class="lz ma it ly b gy nb nc l nd ne">const withEmojis = /\p{<!-- -->Extended_Pictographic<!-- -->}/u<br/>withEmojis.test('😀😀'); <br/>//true</span><span id="7dc6" class="lz ma it ly b gy nf nc l nd ne">withEmojis.test('ab');<br/>//false</span><span id="8c42" class="lz ma it ly b gy nf nc l nd ne">withEmojis.test('1');<br/>//false</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/fbfe2c0f39a1dd723799b81f11f5964b.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*nx1vBOJLxjqaMrIxJLHJeQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例2</p></figure><h2 id="27da" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">使用\P{}来否定匹配。</h2><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="9691" class="lz ma it ly b gy nb nc l nd ne">const noEmojis = /\P{<!-- -->Extended_Pictographic<!-- -->}/u<br/>noEmojis.test('😀'); <br/>//false</span><span id="aba9" class="lz ma it ly b gy nf nc l nd ne">noEmojis.test('1212');<br/>//false</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6b954392a7dc9bbf4531547ce63df085.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*YBECnpx8k1VaR8IYiJhcbA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例3</p></figure><p id="d329" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，这是一种检测表情符号的简单方法，但是如果你使用我们之前的<code class="fe lv lw lx ly b">withEmojis</code>正则表达式和分组表情符号，你会对结果感到惊讶。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="6194" class="lz ma it ly b gy nb nc l nd ne">const withEmojis = /\p{Extended_Pictographic}/ug</span><span id="5855" class="lz ma it ly b gy nf nc l nd ne">const familyEmoji = '👨‍👩‍👧' </span><span id="f496" class="lz ma it ly b gy nf nc l nd ne">console.log(familyEmoji.length) <br/>//8</span><span id="05d5" class="lz ma it ly b gy nf nc l nd ne">console.log(withEmojis.test(familyEmoji))<br/>//true</span><span id="e408" class="lz ma it ly b gy nf nc l nd ne">console.log(familyEmoji.match(withEmojis))<br/>//(3) ['👨', '👩', '👧']</span><span id="3b2c" class="lz ma it ly b gy nf nc l nd ne"><strong class="ly iu">familyEmoji.replaceAll(withEmojis,'*');</strong><br/>//*** <strong class="ly iu">opps!</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/cf48c149f0dd890cf33d8368bae9d829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*1Kgj1E4NtwBLLex5GVd_Jw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实例4</p></figure><p id="c3f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的，如果您对我们的regex表达式使用“replaceAll”方法，您将获得三个:而不是一个“出现这种行为是因为分组的表情符号被呈现为单个符号，但由多个代码点组成。</p><h1 id="0462" class="nk ma it bd mb nl nm nn me no np nq mh jz nr ka mk kc ns kd mn kf nt kg mq nu bi translated">最终通过</h1><p id="178d" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">为了避免这种和其他罕见的行为，你可以使用像<a class="ae ky" href="https://github.com/mathiasbynens" rel="noopener ugc nofollow" target="_blank">马蒂亚斯·拜能</a> s的<a class="ae ky" href="https://github.com/mathiasbynens/emoji-regex" rel="noopener ugc nofollow" target="_blank"> emoji-regex </a>这样的库。这个库提供了一个正则表达式，根据Unicode标准匹配所有emoji符号和序列(包括emoji的文本表示)。</p><p id="5d60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，可以考虑通过我的<a class="ae ky" href="https://kesk.medium.com/membership" rel="noopener">个人资料</a>订阅Medium。谢谢大家！</p><h1 id="0bb8" class="nk ma it bd mb nl nm nn me no np nq mh jz nr ka mk kc ns kd mn kf nt kg mq nu bi translated">参考</h1><div class="nv nw gp gr nx ny"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">正则表达式- JavaScript | MDN</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">正则表达式是用于匹配字符串中字符组合的模式。在JavaScript中，正则表达式…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">developer.mozilla.org</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><p id="1d02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/mathiasbynens/emoji-regex" rel="noopener ugc nofollow" target="_blank">https://github.com/mathiasbynens/emoji-regex</a></p></div></div>    
</body>
</html>