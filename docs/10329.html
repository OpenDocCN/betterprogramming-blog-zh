<html>
<head>
<title>How to Add Razorpay Payments in Android Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android应用中添加Razorpay支付</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-add-razorpay-payments-in-android-apps-7bd908666205?source=collection_archive---------6-----------------------#2021-12-28">https://betterprogramming.pub/how-to-add-razorpay-payments-in-android-apps-7bd908666205?source=collection_archive---------6-----------------------#2021-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="675f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索Android中的Razorpay标准结账</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e62cb5ff8d3dd4b4b13c8a7ca551fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JVC6Smn0EFBmGoHG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@techdailyca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">科技日报</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="cc68" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="4694" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在现代技术时代，移动应用是在几天内接触数百万用户的重要方式之一。通过人工智能和ML，移动应用程序的能力在行为编程方面出现了激增。</p><p id="93e3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">借助这些可怕的发展带来了隐私和基于行为的广告建议的威胁。苹果是第一家采取措施，通过限制IDFA(广告商的标识符)来防止这种情况的公司。虽然这对客户非常有用，但它确实对像谷歌、脸书等收入主要来自广告的移动应用公司产生了重大影响。</p><p id="f5a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从移动应用中获取收入的最佳选择之一是订阅和付费服务。实现支付涉及许多复杂的事情，如安全网络、支持首选支付模式、货币兑换、退款、支付验证等。</p><p id="c1ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在android应用中实现支付的最佳选择之一是使用Razorpay这样值得信赖的合作伙伴。Razorpay提供多种支付模式，如UPI、VPA、网上银行、信用卡/借记卡、钱包等。</p><p id="8b11" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们立即从android中的Razorpay SDK集成开始。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="d3f7" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">综合</h1><p id="2849" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Razorpay在maven central中托管SDK，所以我们需要实现maven central，然后在app级<code class="fe ne nf ng nh b">build.gradle</code>文件中集成Razorpay SDK。</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="dc36" class="nm la it nh b gy nn no l np nq">repositories {<br/>    mavenCentral()<br/>}</span><span id="b385" class="nm la it nh b gy nr no l np nq">dependencies {<br/>    implementation 'com.razorpay:checkout:1.6.12'<br/>}</span></pre><p id="e31c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">作为替代，开发者可以<a class="ae ky" href="https://mvnrepository.com/artifact/com.razorpay/checkout" rel="noopener ugc nofollow" target="_blank">下载</a>razor pay SDK的AAR文件，放在libs文件夹下。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ccf1" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">生成Razorpay密钥</h1><p id="2739" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下一步是从Razorpay控制台获取密钥。导航到Razorpay仪表板并创建帐户。成功创建帐户后，您将被导航至Razorpay仪表盘。</p><p id="a1a0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后单击左侧面板中的设置，并选择API密钥选项卡。然后点击生成密钥选项。这将为您提供在项目中使用所需的键。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/452624dc8ff2e8e189060e1e99f730d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*LXfkkFtTsYBhA1alzChTSg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">生成Razorpay API密钥—来源:Razorpay</p></figure><p id="0f6b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您还可以在设置选项卡下更新公司名称、徽标等，该选项卡将在结账屏幕上显示给用户。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="e553" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">Razorpay标准结账</h1><h2 id="2939" class="nm la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">创建订单</h2><p id="ca08" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">必须使用Orders API通过使用API密钥的基本验证从服务器端创建订单id，并将其传递给Android、IOS和Web等客户端。要创建订单，您需要传递货币、金额、收据(此订单的收据id)等，如下所示:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="d435" class="nm la it nh b gy nn no l np nq"><strong class="nh iu">try</strong> {<br/>   JSONObject orderRequest = <strong class="nh iu">new</strong> JSONObject();<br/>   orderRequest.put("<strong class="nh iu">amount</strong>", 50000);<br/> <em class="oe">// amount in the smallest currency unit<br/></em>   orderRequest.put("<strong class="nh iu">currency</strong>", "INR");<br/>   orderRequest.put("<strong class="nh iu">receipt</strong>", "order_rcptid_11");<br/>    Order order = razorpay.Orders.create(orderRequest);<br/> } <strong class="nh iu">catch</strong> (RazorpayException e) {<br/>   <em class="oe">// Handle Exception<br/></em>   System.out.println(e.getMessage());<br/> }</span></pre><h2 id="57d0" class="nm la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">预加载检验</h2><p id="1fcb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">建议预装Razorpay checkout，以便为用户提供顺畅、快速的结账流程。通常情况下，建议在支付活动的<code class="fe ne nf ng nh b">onCreate</code>功能中进行:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><h2 id="0059" class="nm la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">付款结帐</h2><p id="ced0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦用户点击支付按钮，我们需要从服务器获取订单id并创建Razorpay checkout对象。然后，我们需要使用<code class="fe ne nf ng nh b">open</code>函数通过JSON对象将金额、货币、order_id、货币、电子邮件、联系人等字段传递给checkout对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="76c1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ne nf ng nh b">checkout.open</code>开启一个Razorpay活动，用户可以用首选模式结账。</p><p id="1da3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还可以配置重试选项，比如用户可以重试支付多少次，以及Razorpay是否显示重试选项。看一看:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="047b" class="nm la it nh b gy nn no l np nq">JSONObject retryObj = new JSONObject(); <br/> retryObj.put(“enabled”, true); <br/> retryObj.put(“max_count”, 4); <br/> options.put(“retry”, retryObj);</span></pre><h2 id="6849" class="nm la it bd lb nt nu dn lf nv nw dp lj ma nx ny ll me nz oa ln mi ob oc lp od bi translated">Razorpay回调</h2><p id="496c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一旦用户完成支付，Razorpay通过<strong class="lt iu"> PaymentResultListener提供几个回调<code class="fe ne nf ng nh b"><strong class="lt iu">onPaymentSuccess</strong></code> <strong class="lt iu"> </strong>和<strong class="lt iu"> </strong> <code class="fe ne nf ng nh b"><strong class="lt iu">onPaymentError</strong></code> <strong class="lt iu"> </strong>。</strong>开发人员可以通过使用监听器扩展活动来覆盖这些功能，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="c97a" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">进步规则</h1><p id="77d7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果项目混淆了代码，那么开发人员需要在他们的proguard规则文件中添加一些与Razorpay SDK相关的Proguard规则。看一看:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="783e" class="nm la it nh b gy nn no l np nq">-keepclassmembers class * {<br/>    <a class="ae ky" href="http://twitter.com/android" rel="noopener ugc nofollow" target="_blank">@android</a>.webkit.JavascriptInterface &lt;methods&gt;;<br/>}</span><span id="b845" class="nm la it nh b gy nr no l np nq">-keepattributes JavascriptInterface<br/>-keepattributes *Annotation*</span><span id="dd9c" class="nm la it nh b gy nr no l np nq">-dontwarn com.razorpay.**-keep <br/>class com.razorpay.** {*;}</span><span id="d2f5" class="nm la it nh b gy nr no l np nq">-optimizations !method/inlining/*</span><span id="b5af" class="nm la it nh b gy nr no l np nq">-keepclasseswithmembers class * {  <br/>   public void onPayment*(...);<br/>}</span></pre><p id="be1f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">仅此而已，现在客户可以通过多种支付模式为您通过android应用程序提供的服务付费，而无需您进行任何人工操作。</p><p id="1224" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">即将发布:</strong>在下一篇文章中，我们将探讨如何在遵循新的RBI指南的同时，使用自定义UI实现Razorpay储值卡功能。</p><p id="e3f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">更新时间:2022年1月4日:</strong></p><div class="oh oi gp gr oj ok"><a href="https://sgkantamani.medium.com/card-tokenisation-with-razorpay-cfa7d5f315d0" rel="noopener follow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">使用Razorpay进行卡令牌化</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">了解如何在遵守新的RBI准则的同时实施储值卡功能</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">sgkantamani.medium.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ks ok"/></div></div></a></div><p id="e44c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读。</p><div class="oh oi gp gr oj ok"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-integrate-google-pay-into-your-existing-android-app-d75b269cd623"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd iu gy z fp op fr fs oq fu fw is bi translated">如何将Google Pay集成到您现有的Android应用程序中</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">开始通过GPay接受付款</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">better编程. pub</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy ks ok"/></div></div></a></div></div></div>    
</body>
</html>