<html>
<head>
<title>Advanced Debugging — Part 1: LLDB Console</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高级调试—第1部分:LLDB控制台</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/advanced-debugging-part-1-lldb-console-5fe8cff13a93?source=collection_archive---------8-----------------------#2019-09-12">https://betterprogramming.pub/advanced-debugging-part-1-lldb-console-5fe8cff13a93?source=collection_archive---------8-----------------------#2019-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/cfed13f017784e5e95ee694461590113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wNStmi8TFKx9cLtJG8GDCQ.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">米哈伊尔·瓦西里耶夫在<a class="ae kf" href="https://unsplash.com/photos/Vf1JrKMUS0Q" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="a172" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">注意事项</strong></h1><p id="9ffc" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">开发人员花大量时间修复bug，或者换句话说，<em class="mc">调试</em>。事实上，有时我们花在修复bug上的时间比实际开发新功能的时间还多。因此，调试技能对于开发人员的成功至关重要，在下面的文章中，我们将通过学习xCode提供的工具来尝试利用我们的调试技能。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="0c79" class="kg kh it bd ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld bi translated"><strong class="ak">什么是LLDB？</strong></h1><p id="9393" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">低级调试器(LLDB)是Xcode中使用的默认调试器，是LLVM项目的一部分。LLDB在XCode 5中取代了GDB，它有几个优点，比如性能和可脚本化。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="dda5" class="kg kh it bd ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld bi translated"><strong class="ak">用表达式</strong>评估控制台中的代码</h1><p id="e9d0" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">LLDB中最有用和最强大的命令之一是<code class="fe mp mq mr ms b">expression</code>。<code class="fe mp mq mr ms b">expression</code>让您在控制台中评估代码，节省您调试和测试代码的宝贵时间。您不仅可以运行代码，还可以修改现有变量，而无需重新编译项目。</p><p id="1abb" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">看一下下面的例子:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi my"><img src="../Images/527d3500a14f0cb29dd508108c2e8604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*tDXn1x9TRfnF2aIZYgVFpA.png"/></div></figure><p id="bde0" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">在上面的例子中，我们有一个名为<code class="fe mp mq mr ms b">person</code>的结构，有两个名为<code class="fe mp mq mr ms b">name</code>和<code class="fe mp mq mr ms b">age</code>的字段。我们用一个断点停止了程序，并将<code class="fe mp mq mr ms b">age</code>从<code class="fe mp mq mr ms b">39</code>改为<code class="fe mp mq mr ms b">40</code>。</p><p id="ee86" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">现在，当我们再次打印它时，我们看到实际值在运行时被修改了。这在处理应用程序中的某些任务时非常有用，例如动画、颜色或只是查看应用程序行为的值。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="1b22" class="kg kh it bd ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld bi translated"><strong class="ak">通过创建别名</strong>，让您在控制台中的生活更加轻松</h1><p id="502b" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">整天在控制台打字手指会疼吗？您可以轻松定义一个别名，让您的生活更轻松！</p><p id="5feb" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">假设我们想要创建一个别名，将<code class="fe mp mq mr ms b">person</code>的年龄属性增加1:</p><p id="c9e9" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated"><code class="fe mp mq mr ms b">(lldb) command alias a1 expression person.age += 1</code></p><p id="7c67" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">因此，创建别名的lldb命令格式是:</p><p id="9aa7" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">"命令别名"+ <name of="" alias=""> + <actual command=""/></name></p><h1 id="3fb1" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">用PO和P很好地打印变量</strong></h1><p id="b8bf" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><code class="fe mp mq mr ms b">PO</code>是开发人员在LLDB中调试时最常用的命令。那么<code class="fe mp mq mr ms b">PO</code>到底是什么？</p><p id="0ae9" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">嗯，我们已经知道什么是T0，什么是T1。所以<code class="fe mp mq mr ms b">PO</code>是一个很好地打印变量的<code class="fe mp mq mr ms b">alias</code>，它:</p><p id="12f2" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">表情-O -l斯威夫特— <name of="" variable=""/></p><p id="af21" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">我们所说的“很好”是什么意思？每个对象都可以有一个文本表示，您可以通过实现一个名为<code class="fe mp mq mr ms b">CustomDebugStringConvertible</code>的协议来覆盖它。</p><p id="3b6c" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">这个协议有一个您需要覆盖的变量叫做<code class="fe mp mq mr ms b">debugDescription</code>，它的返回值出现在控制台和调试器中。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="9b11" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated"><code class="fe mp mq mr ms b">PO</code>命令并不孤单——我们还有<code class="fe mp mq mr ms b">P</code>命令。<code class="fe mp mq mr ms b">P</code>用于打印变量——这些变量大多不是带有内部格式化程序的对象。</p><p id="a8c9" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">如果你试图<code class="fe mp mq mr ms b">PO</code>一个不是真实对象的东西(比如<code class="fe mp mq mr ms b">Int</code>，你会得到一个不相关的objective-c对象的结果。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="7861" class="kg kh it bd ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld bi translated"><strong class="ak">用V命令更快地打印变量</strong></h1><p id="3b09" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我们理解<code class="fe mp mq mr ms b">V</code>命令做什么之前，我们需要理解<code class="fe mp mq mr ms b">PO</code>和<code class="fe mp mq mr ms b">P</code>是如何工作的。</p><p id="229f" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">当您在LLDB中调用一个<code class="fe mp mq mr ms b">PO</code>命令时，它会生成一小段代码来评估您编写的表达式。之后，它编译代码，执行代码，并将其移动到某个数据格式化程序(在<code class="fe mp mq mr ms b">P</code>的情况下)或运行<code class="fe mp mq mr ms b">debugDescription</code>方法(在<code class="fe mp mq mr ms b">PO</code>的情况下)以在控制台中打印。</p><p id="df71" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated"><code class="fe mp mq mr ms b">V</code>命令跳过代码评估，只访问变量存储器，并将在那里找到的数据传递给数据格式化程序，以便在控制台中打印出来。这意味着使用<code class="fe mp mq mr ms b">V</code>比<code class="fe mp mq mr ms b">PO</code>和<code class="fe mp mq mr ms b">P</code>要快得多，因为它在调试期间不需要代码进化。</p><p id="4c5f" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">但是<code class="fe mp mq mr ms b">V</code>命令有一个缺点——因为<code class="fe mp mq mr ms b">V</code>不编译代码，它只能访问当前堆栈帧上的变量。此外，它不能打印计算的属性，因为它需要为此编译代码。</p><p id="be03" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated"><code class="fe mp mq mr ms b">V</code>命令仅在XCode 10.2及更高版本中可用，它是帧表达式的别名。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="a5e9" class="kg kh it bd ki kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld bi translated">摘要</h1><p id="ed16" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用控制台是调试时的一项重要技能，因为它可以通过在断点中注入代码来节省您的宝贵时间，并且它可以通过轻松打印变量值来反映您的应用程序状态。</p><p id="d277" class="pw-post-body-paragraph le lf it lg b lh mt lj lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">但是调试并没有到此结束。在接下来的章节中，我将尝试给出更多的技巧和工具来使你的调试过程更加流畅和简短。</p></div></div>    
</body>
</html>