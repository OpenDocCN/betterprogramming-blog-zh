<html>
<head>
<title>An Intro to Realm for iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS领域介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/an-intro-to-realm-for-ios-2633162952f1?source=collection_archive---------8-----------------------#2020-05-04">https://betterprogramming.pub/an-intro-to-realm-for-ios-2633162952f1?source=collection_archive---------8-----------------------#2020-05-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cd59" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">立即将非核心数据的数据库添加到您的应用中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2e4d3ac1e86092bfb2a0176c273cdab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWVGoQDDWZEIHPyXsHKv_g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://realm.io/" rel="noopener ugc nofollow" target="_blank">境界</a>标志</p></figure><p id="9b0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Realm mobile database是一个用于移动和web开发的数据存储解决方案。在撰写本文时，Realm为Java、Kotlin、Swift、Obj-C、JavaScript和. NET提供了一个解决方案。正如文章标题所示，我们将重点关注iOS——特别是Swift。本文假设您对Swift和iOS开发有基本的了解。</p><p id="2840" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在撰写本文时，您可以使用Swift Package Manager (SPM)、CocoaPods或Carthage将Realm添加到您的项目中。在本指南中，我将使用SPM，因为这是最快捷、最简单的入门方式。如果你之前没有用过SPM，可以从下面的YouTube <a class="ae kv" href="https://www.youtube.com/watch?v=ZxHndSGmWcE&amp;t=324s" rel="noopener ugc nofollow" target="_blank">视频</a>中学习如何使用。</p><p id="deca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了遵循这个指南，我建议在这里下载完整的项目<a class="ae kv" href="https://github.com/atticus183/IntroToRealm" rel="noopener ugc nofollow" target="_blank">，并让这篇文章与项目并排打开。</a></p><p id="2d3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在移动设备或Windows PC上，只需知道所有执行的动作都将在初始视图控制器的<code class="fe ls lt lu lv b">viewDidLoad</code>中。您会注意到几个写事务在它们自己的私有方法中。这是为了保持<code class="fe ls lt lu lv b">viewDidLoad</code>相对干净，并执行检查，以确保我们的测试数据不会在每次运行应用程序时重复。</p><p id="804f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你下载了项目并打开它，点击<code class="fe ls lt lu lv b">Cmd+B</code>来构建项目。这可能需要几分钟才能完成。</p><p id="5954" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本指南中，我们的数据模型将代表一家银行、其经理和客户。这样，我可以说明一对一和一对多的关系。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="3ec4" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">什么是境界？</h1><p id="9632" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">Realm是一个对象数据库，支持对象之间的关系。如果您来自SQL世界，Realm对您来说会非常熟悉。在本指南的后面，我们将启动Realm Studio，您将能够看到代表每个类的表和代表每个对象的行。</p><p id="6a8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您想要更新一个对象的值时，您可以在一个<code class="fe ls lt lu lv b">write</code>事务中直接对对象本身进行更改。Realm mobile数据库被认为是SQLite和核心数据的替代品。</p><p id="014b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，一个<em class="na">领域</em>是存储和管理数据的地方。您可以在一个项目中使用多个领域，但是对于本文来说，让它保持基本。让我们开始吧。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="10f3" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">下载Realm Studio</h1><p id="a203" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">首先推荐下载<a class="ae kv" href="https://realm.io/products/realm-studio" rel="noopener ugc nofollow" target="_blank"> Realm Studio </a>并安装。这将允许您查看保存到本地领域的数据。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e760" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">默认领域入门</h1><p id="ebb4" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">创建一个默认的本地领域非常简单。打开您的项目，导航到<code class="fe ls lt lu lv b">ViewController.swift</code>文件，导入<code class="fe ls lt lu lv b">RealmSwift</code> <em class="na">，</em>并将以下内容放在<code class="fe ls lt lu lv b">ViewController</code>类中(最好在顶部):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="dd9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在在模拟器中运行您的项目(<code class="fe ls lt lu lv b">Cmd + R</code>)。应用程序启动后，将创建默认领域。您只需要这一行代码就可以开始了。</p><p id="9088" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>在本指南或您自己的开发过程中，您可能需要从模拟器中删除应用程序，以移除之前的领域并强制创建新的领域。当您删除领域模型所期望的持久化属性时，通常会发生这种情况。您可以在Realm docs中的处找到更多信息<a class="ae kv" href="https://realm.io/docs/swift/latest/#realms" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="441e" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">自定义领域配置</h2><p id="fd10" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">虽然您可以从上面的一行代码开始，但是您可以在<code class="fe ls lt lu lv b">Realm.Configuration</code>结构上设置几个选项。由于本指南是对Realm的介绍，我们不会深入细节，但是下面的截图显示了几个不同的选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/a5380e3c466596e77166861dd5950517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzHw8I8ANbloQDXr-ttyfQ.png"/></div></div></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="cbc8" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">查看模型和数据库内容</h1><p id="6b88" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">将以下内容添加到<code class="fe ls lt lu lv b">viewDidLoad</code>方法的末尾:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="16bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将把位置打印到调试区域。复制外景链接(不含<code class="fe ls lt lu lv b">file://</code> ) <strong class="ky ir"> </strong>，打开境界工作室。点击打开领域文件，点击<code class="fe ls lt lu lv b">Cmd+Shift+G</code>，在对话框中粘贴链接。点击<code class="fe ls lt lu lv b">default.realm</code>文件，然后点击打开。这个领域还没有任何数据，但我们很快就会知道。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="cab0" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">关系</h1><h2 id="73d7" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">一对一</h2><p id="4df0" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要创建一对一的关系，请将属性设置为您想要关联的Realm类。在我们的例子中，每个银行可以有一个分行经理。请确保此类型是可选的。下面的属性将是<code class="fe ls lt lu lv b">Bank</code>类的一部分。</p><pre class="kg kh ki kj gt nq lv nr ns aw nt bi"><span id="57de" class="nd me iq lv b gy nu nv l nw nx">@objc dynamic var branchManager: BranchManager?</span></pre><h2 id="cb15" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">一对多</h2><p id="b8df" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要创建一个<em class="na">一对多</em>关系，请将该属性设置为<code class="fe ls lt lu lv b">many</code>类的特定于领域的<code class="fe ls lt lu lv b">List</code>类型。在我们的例子中，每家银行可以有许多客户。以下将是<code class="fe ls lt lu lv b">Bank</code>类的一部分。</p><pre class="kg kh ki kj gt nq lv nr ns aw nt bi"><span id="d28b" class="nd me iq lv b gy nu nv l nw nx">let customers = List&lt;Customer&gt;()</span></pre><h2 id="5cdc" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">多对多</h2><p id="e4ea" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我们不会在我们的例子中涉及这个，但是知道它是可用的。以下是来自领域文档的内容:</p><blockquote class="ny nz oa"><p id="711a" class="kw kx na ky b kz la jr lb lc ld ju le ob lg lh li oc lk ll lm od lo lp lq lr ij bi translated">"您可以使用<code class="fe ls lt lu lv b">List</code>属性创建与任意数量的对象或支持的原始值的关系"</p></blockquote><p id="7467" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在他们的<a class="ae kv" href="https://realm.io/docs/swift/latest/#many-to-many" rel="noopener ugc nofollow" target="_blank">文档</a>中找到更多关于Realm的<em class="na">多对多</em>关系的信息。</p><h2 id="bee2" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">相反的</h2><p id="7828" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要创建一个<em class="na">反向</em>关系，请使用领域特定的<code class="fe ls lt lu lv b">LinkObjects</code>结构。在我们的示例中，我们希望能够找到每个客户是哪家银行的成员。以下将是<code class="fe ls lt lu lv b">Customer</code>类的一部分。确保<code class="fe ls lt lu lv b">init</code>属性字符串匹配<code class="fe ls lt lu lv b">Bank</code>类中的<code class="fe ls lt lu lv b">many</code>属性。</p><pre class="kg kh ki kj gt nq lv nr ns aw nt bi"><span id="a4b6" class="nd me iq lv b gy nu nv l nw nx">let bank = LinkingObjects(fromType: Bank.self, property: "customers")</span></pre><h1 id="5222" class="md me iq bd mf mg oe mi mj mk of mm mn jw og jx mp jz oh ka mr kc oi kd mt mu bi translated">创建数据模型</h1><p id="7f6f" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">类用于创建模型对象和<code class="fe ls lt lu lv b">must</code>子类对象。模型类型不支持结构和枚举。创建一个类的属性必须是一个<code class="fe ls lt lu lv b">var</code>并带有前缀<code class="fe ls lt lu lv b">@objc dynamic</code>。属性必须给定一个初始值或者是可选的。</p><h2 id="c14b" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">支持的类型</h2><p id="49b6" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">支持<code class="fe ls lt lu lv b">Bool</code>、<code class="fe ls lt lu lv b">Int</code>、<code class="fe ls lt lu lv b">Int8</code>、<code class="fe ls lt lu lv b">Int16</code>、<code class="fe ls lt lu lv b">Int32</code>、<code class="fe ls lt lu lv b">Int64</code>、<code class="fe ls lt lu lv b">Double</code>、<code class="fe ls lt lu lv b">Float</code>、<code class="fe ls lt lu lv b">String</code>、<code class="fe ls lt lu lv b">Date</code>、<code class="fe ls lt lu lv b">Data</code>。所有这些属性都是可选的。Realm的文档提供了一个极好的备忘单:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/fc3cf754223a1c26c28b4f810ac28140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkItPbiLYAqJsnfCm-31oA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://realm.io/docs/swift/latest/#models" rel="noopener ugc nofollow" target="_blank">领域文档</a></p></figure><h2 id="a1b7" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">创建我们的模型</h2><p id="fba1" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">在本指南中，我们将创建一个代表银行的模型。我们的模型将由三个类组成:<code class="fe ls lt lu lv b">Bank</code>、<code class="fe ls lt lu lv b">branchManager</code>和<code class="fe ls lt lu lv b">Customer. </code>这些模型类将被添加到<code class="fe ls lt lu lv b">Model.swift</code>文件中。</p><p id="6d45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">银行</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ff0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个细目分类:</p><ul class=""><li id="78b1" class="ok ol iq ky b kz la lc ld lf om lj on ln oo lr op oq or os bi translated">每个银行将有一个由<code class="fe ls lt lu lv b">UUID().uuidString</code>生成的唯一ID</li><li id="b7ee" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">每个<code class="fe ls lt lu lv b">Bank</code>将有一个<code class="fe ls lt lu lv b">branchManager</code></li><li id="1aea" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">每个<code class="fe ls lt lu lv b">Bank</code>都会有很多顾客</li><li id="54ea" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">银行可以是信用合作社、中央银行或零售银行。如代码中所述，Realm将忽略嵌套的枚举。</li><li id="446f" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">领域将忽略<code class="fe ls lt lu lv b">CLLocation</code>计算属性</li></ul><p id="b28d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分公司经理</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="bbda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个细目分类:</p><ul class=""><li id="656e" class="ok ol iq ky b kz la lc ld lf om lj on ln oo lr op oq or os bi translated">每个<code class="fe ls lt lu lv b">BranchManager</code>将有一个唯一的ID。把这个当做一个员工ID。</li><li id="cee8" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">这个类没有什么特别的</li></ul><p id="76d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">客户</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="f535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个细目分类:</p><ul class=""><li id="4f0a" class="ok ol iq ky b kz la lc ld lf om lj on ln oo lr op oq or os bi translated">每个<code class="fe ls lt lu lv b">Customer</code>将有一个唯一的账号</li><li id="7f34" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">属性跟踪它们的起始余额和当前余额</li><li id="f2c8" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">持有他们成为银行成员的日期的财产</li><li id="1bbc" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">帮助提供全名的计算属性</li><li id="7ed8" class="ok ol iq ky b kz ot lc ou lf ov lj ow ln ox lr op oq or os bi translated">与<code class="fe ls lt lu lv b">Bank</code>成反比。稍后我将向您展示如何从这个逆属性中检索客户的银行。</li></ul><h2 id="4b3f" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">主键</h2><p id="9a2d" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">如果您熟悉关系数据库，您可能想知道Realm是否支持自动递增id或检索特定项的方法。它们不支持自动递增id；但是，它们支持主键。请记住，一旦设置了主键，就不能更改。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="c3a0" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">创建模型对象</h1><p id="5eac" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">最后，让我们创建一个持久存储到数据库的对象。在本指南的这一部分，您应该已经创建了默认领域和三个模型类。</p><p id="77a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每当您想要创建一个新对象或更改一个现有对象时，您必须在一个Realm <code class="fe ls lt lu lv b">write</code>事务中。一个<code class="fe ls lt lu lv b">write</code>事务看起来是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3f63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，在生产应用程序中，您应该将它包装在一个<code class="fe ls lt lu lv b">do catch</code>块中，以捕捉任何潜在的错误。</p><h2 id="fd80" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">创建两个客户和一个分行经理</h2><p id="c8d2" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">让我们创建几个客户和一个分行经理。我们可以将这个<code class="fe ls lt lu lv b">write</code>事务添加到<code class="fe ls lt lu lv b">viewDidLoad</code>方法中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="d29a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">构建并运行项目。您应该有三个对象持久存储到您的领域数据库中。我们将使用这些对象与<code class="fe ls lt lu lv b">Bank</code>类相互关联。现在，每次运行项目时，这些对象都可以使用了。</p><h2 id="49e5" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">创建银行</h2><p id="2514" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">现在让我们创建<code class="fe ls lt lu lv b">Bank</code>对象。我们可以将这个<code class="fe ls lt lu lv b">write</code>事务添加到<code class="fe ls lt lu lv b">viewDidLoad</code>方法中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="0b89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在本指南的后面介绍如何添加客户和分行经理关系，因为这需要您知道如何从数据库中查询项目。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="9989" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">正在检索项目</h1><p id="145e" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">从领域中检索对象的主要方法是使用<code class="fe ls lt lu lv b">Results</code>类。这个类符合<code class="fe ls lt lu lv b">RealmCollection</code>协议，所以你迭代每个条目，通过索引检索一个条目，等等。我们将在<code class="fe ls lt lu lv b">viewDidLoad</code>中添加以下内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="8269" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于我们的数据集中只有一个分行经理和一家银行，我们可以安全地调用<code class="fe ls lt lu lv b">.first!</code>来检索分行经理和银行。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="067a" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">修改对象</h1><p id="2ba7" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">修改对象的属性非常简单。从领域中检索一个对象，并在一个<code class="fe ls lt lu lv b">write</code>事务中直接修改属性。</p><p id="55aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的例子中，假设分行经理结婚了，并将她的姓从<code class="fe ls lt lu lv b">Scott</code>改为<code class="fe ls lt lu lv b">Miller</code>。使用我们上面检索的<code class="fe ls lt lu lv b">branchManager</code>对象，让我们更改她的姓氏。我们将以下内容添加到<code class="fe ls lt lu lv b">viewDidLoad</code>中，就在我们检索银行、客户和分行经理的位置下方:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ea93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！这就是改变一个对象的值所要做的一切。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="b816" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">添加关系</h1><p id="6e36" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">这三个常量都是类型<code class="fe ls lt lu lv b">Result</code>，如上所述，它们合在一起就是一个Realm集合。</p><p id="a106" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建银行和分行经理之间的关系，然后创建银行和客户之间的关系。在<code class="fe ls lt lu lv b">viewDidLoad</code>的结尾，我们将添加以下内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="65de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，上面的动作是在一个领域<code class="fe ls lt lu lv b">write</code>事务中。我们在银行和分行经理之间设置了一对一的关系。然后，我们通过将每个客户附加到银行的customer <code class="fe ls lt lu lv b">List</code>类型来设置银行与其客户之间的一对多关系。如果您在Realm Studio中打开领域，您将能够看到已经建立的关系。</p><h2 id="5b00" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">从反向关系中检索客户的银行</h2><p id="3f76" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">为了从<code class="fe ls lt lu lv b">Customer</code>类中检索客户的银行，您在<code class="fe ls lt lu lv b">bank</code>属性上调用<code class="fe ls lt lu lv b">.first!</code>。将以下内容添加到您添加关系的部分下方的<code class="fe ls lt lu lv b">viewDidLoad</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4973" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于银行与客户的关系是<strong class="ky ir">一对多的，</strong>我们可以放心地对逆属性<code class="fe ls lt lu lv b">bank</code>调用<code class="fe ls lt lu lv b">.first!</code>。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="9623" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">过滤结果</h1><p id="a7ec" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">可以使用<code class="fe ls lt lu lv b">.filter</code>高阶函数过滤领域集合。您可以使用美元语法或创建一个<code class="fe ls lt lu lv b">NSPredicate</code>。来自Core Data的开发人员应该很高兴听到您可以使用<code class="fe ls lt lu lv b">NSPredicate</code>来过滤领域集合。在<code class="fe ls lt lu lv b">viewDidLoad</code>的末尾增加以下内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="83a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">常量<code class="fe ls lt lu lv b">jonCustomer</code>应该包括名字为<code class="fe ls lt lu lv b">Jon</code>的所有客户。在我们的例子中，只有一个，所以我们可以使用<code class="fe ls lt lu lv b">.first?</code>来检索<code class="fe ls lt lu lv b">Jon Smith</code>客户对象。</p><h2 id="6d60" class="nd me iq bd mf ne nf dn mj ng nh dp mn lf ni nj mp lj nk nl mr ln nm nn mt no bi translated">断言</h2><p id="bc4c" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">为了执行高级过滤，支持几个谓词:<code class="fe ls lt lu lv b">IN</code>、<code class="fe ls lt lu lv b">BETWEEN</code>、<code class="fe ls lt lu lv b">AND</code>、<code class="fe ls lt lu lv b">OR</code>、<code class="fe ls lt lu lv b">NOT</code>、<code class="fe ls lt lu lv b">BEGINSWITH</code>、<code class="fe ls lt lu lv b">CONTAINS</code>、<code class="fe ls lt lu lv b">ENDSWITH</code>、<code class="fe ls lt lu lv b">LIKE</code>、<code class="fe ls lt lu lv b">ANY</code>、<code class="fe ls lt lu lv b">NONE</code>和<code class="fe ls lt lu lv b">@count</code>。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="161b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">在生产应用程序中使用领域</h1><p id="cc72" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我在我的个人财务应用程序<a class="ae kv" href="https://apps.apple.com/app/seventytwo/id1449439220" rel="noopener ugc nofollow" target="_blank"> seventytwo </a>中使用与Realm Cloud配对的Realm移动数据库。我没有注意到Realm Cloud有任何停机时间，它非常可靠。在设备之间同步数据所需的时间几乎是瞬间的。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="4b19" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="cc1a" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">如果您正在寻找一个移动数据库解决方案，Realm是一个很好的选择。更好的是，Realm还有一个名为Realm Cloud的产品，它允许你将数据保存到多个设备上，并将用户的数据存储在云中。请注意，MongoDB在2019年购买了Realm。如果你有兴趣了解更多关于Realm的方向，请看这里的路线图。</p><p id="5cbd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在GitHub上点击查看整个项目。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="cc76" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">资源</h1><div class="oy oz gp gr pa pb"><a href="https://realm.io/docs/swift/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd ir gy z fp pg fr fs ph fu fw ip bi translated">领域:在短时间内创建反应式移动应用</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">XCode 10.0或更高版本目标iOS 9或更高版本、macOS 10.9或更高版本，或者任何版本的tvOS或watchOS，如果您…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">realm.io</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp kp pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a href="https://github.com/realm/realm-cocoa/releases" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd ir gy z fp pg fr fs ph fu fw ip bi translated">领域/领域-可可</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">Realm是一个移动数据库:核心数据的替代品&amp; SQLite - realm/realm-cocoa</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">github.com</p></div></div><div class="pk l"><div class="pq l pm pn po pk pp kp pb"/></div></div></a></div></div></div>    
</body>
</html>