<html>
<head>
<title>Create a Simple and Maintainable iOS Network Layer With Async/Await</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Async/Await创建一个简单且可维护的iOS网络层</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-simple-and-maintainable-ios-network-layer-with-async-await-4d4f7c6b7229?source=collection_archive---------4-----------------------#2022-03-10">https://betterprogramming.pub/create-a-simple-and-maintainable-ios-network-layer-with-async-await-4d4f7c6b7229?source=collection_archive---------4-----------------------#2022-03-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c0a9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用async/await为低于15的iOS版本创建一个具有良好可扩展性的网络层</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6b3e5a15e1c6dbd33207ec073c9ec596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGpBZsHLwmSW30RASP4OVg.png"/></div></div></figure><p id="09f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该材料将是有用的，无论是对初学者还是一个老练的游客，我想你可以找到一些有趣的东西</p><p id="6c03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这一切都是从苹果宣布<strong class="kt ir">异步</strong> / <strong class="kt ir">等待</strong>开始的，我想在行动中尝试一下。由于当时对于这项技术的提议没有现成的解决方案，所以决定提出一些易于扩展、便于调试和任意更改的解决方案</p><p id="f115" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从<code class="fe ln lo lp lq b">URLRequest</code>扩展开始，因为标准组件没有方便的工具来处理网络请求方法</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="bcca" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是协议:</p><ul class=""><li id="769b" class="lt lu iq kt b ku kv kx ky la lv le lw li lx lm ly lz ma mb bi translated"><code class="fe ln lo lp lq b">NetConfigType</code> —配置网络层，</li><li id="9e91" class="lt lu iq kt b ku mc kx md la me le mf li mg lm ly lz ma mb bi translated"><code class="fe ln lo lp lq b">NetRoutes</code> —用实现的方法服务请求工厂，组装请求</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="1d21" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了更加方便，我们添加了一个模型，它将允许我们方便地呈现网络请求的响应，以便进行后续处理:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="888d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们描述一下未来请求的入口点和未来网络层的核心:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="24cf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们通过用协议关闭实现来实现请求工厂:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="fd56" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">万岁！我们的网络层准备好了</p><p id="51b3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用嵌套<code class="fe ln lo lp lq b">enum</code>可以轻松扩展该工厂:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="cfba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用所描述的网络层非常简单，可以归结为调用一个方法。大概是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="4a8a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种解决方案被证明是相当轻量级的，易于扩展，它足以取代网络请求的实现，您可以通过Publisher获得一种反应式方法，或者您可以通过闭包使用标准方法。</p></div></div>    
</body>
</html>