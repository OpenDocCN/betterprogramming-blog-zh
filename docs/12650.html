<html>
<head>
<title>How to Use Rest Assured and Spring Boot Test For API Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用放心和Spring Boot测试进行API测试</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/combination-of-rest-assured-and-spring-boot-tests-a005788dd32b?source=collection_archive---------6-----------------------#2022-06-20">https://betterprogramming.pub/combination-of-rest-assured-and-spring-boot-tests-a005788dd32b?source=collection_archive---------6-----------------------#2022-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9f2e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">结合使用放心测试和Spring Boot测试</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/897b6a669f4382c7ba82592db204de11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UYI7Y0LX1pID4LI5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">安妮·斯普拉特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="28cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">REST API开发是一项常见的任务。开发人员要编写许多端点代码，并遵循一系列标准操作:开发一个端点，在本地机器上运行他们的应用程序并测试它，创建单元测试并运行它们，将端点发布到开发环境并测试它，将端点发布到预运行环境并测试它。端点真的有很多工作要做。</p><p id="39f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以用Swagger或者Postman来简化工作。但是许多开发人员更喜欢用Java的方式自动化检查过程。</p><p id="cb6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们必须选择合适的技术并创建必要的测试。这种技术的一个很好的例子是放心测试和Spring Boot测试的结合。在这篇文章中，我们将演示如何为一个API快速创建有用的测试。我们将使用放心测试我们的API和Spring Boot测试来为任何环境设置放心。</p><p id="7fd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须了解我们想要测试什么样的环境，以及我们的应用程序具有什么类型的认证。让我们将一台本地机器和一个dev env作为我们的环境，并将基本身份验证作为一种身份验证。</p><p id="d30c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须使用属性文件创建一个环境配置。</p><p id="78aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用spring profiles来区分不同的环境:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="ddf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并为这些属性添加配置类:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="531d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二步，用<code class="fe lu lv lw lx b">RestAssured</code>设置主抽象测试类。</p><p id="a0ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以利用Spring Boot测试的强大功能来提高配置的灵活性:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="ca9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以将主逻辑与认证和规范的逻辑分开:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="809b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们可以创建第一个单元测试类并检查我们的端点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="4f93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单元测试可以帮助我们检查端点<code class="fe lu lv lw lx b">/api/endpoint</code>并验证<code class="fe lu lv lw lx b">HttpStatus.OK</code>响应。我们已经测试了端点，但是我们可以看到一个问题。我们希望检查特定的JSON数据，不同的环境可以提供不同的数据。</p><p id="57be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了解决这种情况，我们可以添加一个解析器来将JSON数据转换到同一个视图中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="26b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了灵活起见，我们增加了几个变量。</p><p id="ede0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个是<code class="fe lu lv lw lx b">activeProfile</code>，用于为弹簧轮廓选择正确的文件。</p><p id="6e5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二个是<code class="fe lu lv lw lx b">caseName</code>，用于选择相应测试所需的文件。最后一步是使用文件结构创建文件:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/2dcab4fc3ad2844c9fcca6adcc208197.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*IwMpPJ5UZSnEzwNUTmGofg.png"/></div></figure><p id="6fbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们可以回到我们的单元测试，并添加一些更改:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="4105" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。现在，我们可以使用示例添加所有必需的单元测试。</p><h1 id="66da" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">总结</strong></h1><p id="d949" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们开发了一个演示应用程序，用于在不同的服务器上测试相同的REST API。我们创建了两个抽象的配置类，将特定的设置转移到它们中，并使单元测试更加简单和清晰。我们还学习了一种验证JSON对象的方法。</p><p id="0bcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">应用程序只是分离环境测试逻辑的一个想法，我们可以扩展项目或实现类似的东西。主要的想法是证明我们的代码可以在任何可能的时候重用，这当然简化了我们的工作！</p></div></div>    
</body>
</html>