<html>
<head>
<title>A Simple Way to Understand OAuth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解OAuth的简单方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-simple-way-to-understand-oauth-169d49e0b328?source=collection_archive---------7-----------------------#2020-06-26">https://betterprogramming.pub/a-simple-way-to-understand-oauth-169d49e0b328?source=collection_archive---------7-----------------------#2020-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b28" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当你使用你最喜欢的服务登录时会发生什么？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/18c5005065b93d132169f29a9fca3882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pyiUnLTqlTKkojSD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">汤姆·陈在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a889" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth是一个开放标准的授权协议或框架，它为应用程序提供了“安全指定访问”的能力例如，你可以告诉脸书，Medium.com可以访问你的个人资料或更新你的时间表，而不必向媒体提供你的脸书密码。这在很大程度上最小化了风险:如果介质遭到破坏，您的脸书密码仍然是安全的。</p><p id="d6fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth不共享密码数据，而是使用授权令牌来证明消费者和服务提供商之间的身份。OAuth是一种身份验证协议，允许您批准一个应用程序代表您与另一个应用程序进行交互，而无需泄露您的密码。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e447" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">SAML对OAuth</h1><p id="1c27" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="https://www.varonis.com/blog/what-is-saml/" rel="noopener ugc nofollow" target="_blank"> SAML(安全断言标记语言)</a>是一种替代的联合身份验证标准，许多企业将其用于单点登录(SSO)。SAML使企业能够监控谁有权访问公司资源。</p><p id="0054" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SAML和OAuth有很多不同之处。SAML使用XML传递消息，OAuth使用JSON。OAuth提供了更简单的移动体验，而SAML则面向企业安全。最后一点是一个关键的区别点:OAuth广泛使用API调用，这就是为什么移动应用程序、现代web应用程序、游戏控制台和物联网(IoT)设备发现OAuth为用户提供了更好的体验。另一方面，SAML在浏览器中放置一个会话cookie，允许用户访问某些网页——对于短暂的工作日来说很好，但对于每天都必须登录恒温器的情况来说就不那么好了。</p><h2 id="ea6a" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">OAuth示例</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/8ca5124b79dc0e54f4158399eb79af0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*83VCsqMb0vBIyF1u"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@30daysreplay?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">30天回放</a>上的<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c047" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth最简单的例子是一个网站说“嘿，你想用其他网站的登录信息登录我们的网站吗？”在这种情况下，第一个网站——让我们将该网站称为<em class="nm">消费者</em>——想要知道的唯一事情是，用户在两个网站上都是相同的用户，并且已经成功登录到服务提供商——这是用户最初登录的网站，而不是消费者。</p><p id="707c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">脸书应用程序是一个很好的OAuth用例示例。假设你正在使用脸书上的一款应用，它会要求你分享你的个人资料和照片。在这种情况下，脸书是服务提供商:它有你的登录数据和照片。应用程序是消费者，作为用户，你想用应用程序来处理你的图片。你特别授权这个应用程序访问你的照片，OAuth在后台管理这些照片。</p><p id="6d0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的智能家居设备——烤面包机、恒温器、安全系统等。—可能使用某种登录数据来彼此同步，并允许您从浏览器或客户端设备管理它们。这些设备使用OAuth所谓的<em class="nm">机密授权</em>。这意味着他们持有密钥信息，所以你不必一次又一次地登录。</p><h2 id="915a" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">OAuth解释道</h2><p id="7486" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">OAuth是关于授权而不是认证的。授权是请求允许做某事。认证就是证明你是正确的人，因为你知道事情。OAuth不在消费者和服务提供商之间传递认证数据，而是充当某种授权令牌。</p><p id="852c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在研究OAuth时，我见过的一个常见的类比是你汽车的代客钥匙。代客钥匙允许代客启动和移动汽车，但不能让他们进入行李箱或手套箱。</p><p id="e6db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth令牌就像是代客钥匙。作为一个用户，你可以告诉消费者他们可以使用和不可以使用每个服务提供商提供的服务。您可以给每位消费者一把不同的代客钥匙。他们从来没有完整的密钥或任何可以让他们访问完整密钥的私有数据。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f7b0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">OAuth如何工作</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/1b9606a74fe56a7d3f64269ce9bfdb55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uroNwytZtdw3UkMG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@sctgrhm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="dedc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth事务中有三个主要角色:用户、消费者和服务提供者。这三人组被亲切地认为是奥特三角恋爱。</p><p id="d07f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，卫莱是用户，比特里是消费者，Twitter是控制卫莱的安全资源(他的Twitter流)的服务提供者。卫莱希望比特能够在他的信息流中发布缩短的链接。它是这样工作的:</p><h2 id="75da" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">步骤1:用户表明意图</strong></h2><ul class=""><li id="1cb6" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated"><strong class="lb iu">卫莱(用户):</strong>“嘿，比特，我希望你能把链接直接发到我的推特上。”</li><li id="a680" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu"> Bitly(消费者):</strong>“太好了！让我去征求许可。”</li></ul><h2 id="9c16" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">第二步:消费者获得许可</strong></h2><ul class=""><li id="60db" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated"><strong class="lb iu"> Bitly: </strong>“我有一个用户希望我发布到他的流中。能给我一个请求令牌吗？”</li><li id="aa31" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu">推特(服务商):</strong>“当然。这里有一个令牌和一个秘密。”</li></ul><p id="86e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该秘密用于防止伪造请求。消费者使用这个秘密对每个请求进行签名，这样服务提供者就可以验证它确实来自消费者应用程序。</p><h2 id="cb2b" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">步骤3:用户被重定向到服务提供商</strong></h2><ul class=""><li id="2582" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated"><strong class="lb iu">小点声:</strong>“好的，卫莱。我把你发到推特上，这样你就可以批准了。你带着这个信物。”</li><li id="6e4c" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">卫莱:“好的！”</li></ul><p id="5182" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nm"> Bitly指示卫莱</em> </strong> <em class="nm"> </em> <strong class="lb iu"> <em class="nm">到Twitter进行授权。</em> </strong></p><p id="55e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是可怕的部分。如果Bitly是超级黑幕邪恶公司，它会弹出一个看起来像Twitter的窗口，但实际上是对你的用户名和密码的网络钓鱼。始终确保验证您被定向到的URL实际上是服务提供商(在这种情况下是Twitter)。</p><h2 id="ca58" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">第四步——用户给予许可</strong></h2><ul class=""><li id="f02e" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated">卫莱:“推特，我想授权比特利给我的这个请求令牌。”</li><li id="6ef0" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu"> Twitter: </strong>“好吧，只是为了确定一下，你想授权Bitly用你的Twitter账号做X，Y，Z的事？”</li><li id="6407" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">卫莱:“是的！”</li><li id="8f13" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">Twitter: “好的，你可以回去告诉Bitly，他们有权限使用他们的请求令牌。”</li></ul><p id="c149" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Twitter将请求令牌标记为“可以使用”，因此当消费者请求访问时，它将被接受(只要它是使用他们的共享秘密签名的)。</p><h2 id="f35a" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">步骤5:消费者获得访问令牌</strong></h2><ul class=""><li id="0b46" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated">Bitly:“Twitter，我能把这个请求令牌换成访问令牌吗？”</li><li id="9485" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu">推特:</strong>“当然。这是您的访问令牌和密码。”</li></ul><h2 id="5383" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">步骤6:消费者访问受保护的资源</strong></h2><ul class=""><li id="a1b1" class="no np it lb b lc mu lf mv li nq lm nr lq ns lu nt nu nv nw bi translated">“我想把这个链接贴到卫莱的博客上。这是我的访问令牌！”</li><li id="8cd4" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><strong class="lb iu">推特:</strong>“搞定！”</li></ul><p id="9ea0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的场景中，卫莱从来不需要与比特分享他的Twitter证书。他只是以一种安全的方式使用OAuth委托访问。卫莱可以在任何时候登录Twitter，查看他授予的访问权限，并在不影响其他人的情况下撤销特定应用程序的令牌。OAuth还允许细粒度的权限级别。你可以给Bitly向你的Twitter账户发帖的权利，但是把LinkedIn限制为只读访问。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b2c8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">OAuth 1.0与OAuth 2.0</h1><p id="4416" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">OAuth 2.0是OAuth 1.0的完全重新设计，两者不兼容。如果您现在创建一个新的应用程序，请使用OAuth 2.0。这个博客只适用于OAuth 2.0，因为OAuth 1.0已经过时了。</p><p id="534d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OAuth 2.0实现起来更快更容易。OAuth 1.0使用复杂的加密要求，只支持三个流，并且不可伸缩。</p><p id="7041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，OAuth 2.0对于不同类型的应用程序和要求有六个流，并允许通过HTTPS签署秘密。在2.0中，OAuth令牌不再需要在端点上加密，因为它们是在传输过程中加密的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b5ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想现在你对OAuth有所了解了。我希望你觉得这篇文章有趣。</p></div></div>    
</body>
</html>