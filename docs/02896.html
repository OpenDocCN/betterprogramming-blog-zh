<html>
<head>
<title>EXC_BAD_ACCESS Crash Errors: Understanding and Solving Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EXC _坏_访问崩溃错误:理解和解决它们</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exc-bad-access-crash-error-understanding-and-solving-it-ba1fa424b748?source=collection_archive---------17-----------------------#2020-01-07">https://betterprogramming.pub/exc-bad-access-crash-error-understanding-and-solving-it-ba1fa424b748?source=collection_archive---------17-----------------------#2020-01-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="63fc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解Swift、地址杀毒器和线程杀毒器中的僵尸对象，并解决那些令人沮丧的崩溃</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b92922fd5d00dc2abfb20c5d8b4d76be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVJ7MffQEeJ1IYNt0PcvoQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·科尔派在<a class="ae ky" href="https://unsplash.com/s/photos/mac?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3af3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建应用程序一开始一切顺利。你正在从头开始开发一个应用程序，它稳定且运行良好。在发布第一个版本后，你得到了关于正在发生的崩溃的第一个见解，其中一个被标记为EXC _坏_访问错误。寻找真相的旅程从这里开始。</p><p id="d42c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个挑战是重现崩溃，这可能是困难的。当你做到这一点，它仍然是一个完整的另一个挑战，找出原因和解决办法。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b10b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">EXC机场是什么意思？</h1><p id="7259" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">EXC _坏_访问是由于访问坏内存而引发的异常。我们一直在使用指向Swift中某个内存地址的内存指针。每当我们试图访问无效或不再存在的指针时，应用程序就会崩溃。这种指针也称为“悬空指针”。</p><p id="9905" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种糟糕的记忆的根本原因可能不同。引用内存可以被删除或释放，而指针的值永远不会更新。指针仍然指向被释放的内存的内存位置—它变成了一个悬空指针。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f48e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何解决不良访问异常</h1><p id="06f8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Swift中的EXC _坏_访问错误经常令人沮丧。事故的原因可能还不清楚。但是，如果您知道可能的原因，就很有可能快速找到不良访问异常的根本原因。</p><h2 id="5b1b" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">如果你不知道如何重现崩溃</h2><p id="bd2d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果你不知道如何重现崩溃，它就很难修复——这意味着你无法证实你真的修复了它。你可能知道崩溃发生在哪里，但你无法在你的应用程序中找到同样的崩溃。</p><p id="cfe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保运行完全相同的崩溃配置。如果可能，在相同的iOS和设备上安装正确的应用程序版本。这至少排除了由于配置不匹配导致崩溃不可重现。</p><p id="16b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您仍然无法重现崩溃，请尝试以下方法之一:</p><ul class=""><li id="a5d7" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">看看崩溃的面包屑，例如，在<a class="ae ky" href="https://www.avanderlee.com/workflow/firebase-crashlytics-breadcrumbs/" rel="noopener ugc nofollow" target="_blank"> Firebase </a></li><li id="a267" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">联系发生崩溃的用户，要求提供诊断报告。在我的博客文章<a class="ae ky" href="https://www.avanderlee.com/workflow/fixing-crashes-bugs/" rel="noopener ugc nofollow" target="_blank"> 4个让修复崩溃和错误变得更容易的技巧</a>中阅读更多信息</li><li id="a88c" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">观看WWDC 2018的<a class="ae ky" href="https://developer.apple.com/videos/play/wwdc2018/414/" rel="noopener ugc nofollow" target="_blank">了解碰撞和碰撞日志</a>会议，找出原因</li></ul><h2 id="22f3" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">使用地址杀毒软件</h2><p id="b1a9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦您能够在本地重现崩溃，就该运行一些检查来验证您的代码不包含任何内存问题了。</p><p id="8e83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">地址杀毒程序，也称为ASan，在运行时发现内存损坏和其他内存错误。苹果甚至建议在开发过程中持续使用ASan:</p><blockquote class="nz oa ob"><p id="df85" class="kz la oc lb b lc ld ju le lf lg jx lh od lj lk ll oe ln lo lp of lr ls lt lu im bi translated">内存问题经常是安全漏洞的原因。强烈建议您将地址杀毒软件作为软件鉴定流程的一部分。</p></blockquote><p id="fad4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以在诊断下的方案设置中启用地址清除器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3e880d55cbbe2f6d6c117d747809954a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gFI2RU3ranEGMwYr.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">启用地址清除器来查找EXC访问崩溃的原因</p></figure><p id="0b55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦启用，您将再次开始再现崩溃。每当地址杀毒软件检测到内存问题时，它都会暂停应用程序。查看它是否发现任何内存问题，解决它，并验证EXC _坏_访问是否仍然发生。</p><h2 id="ea57" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">由于竞争条件，访问不良</h2><p id="a622" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">数据竞争可能是坏的内存访问的另一个原因。因此，验证您的应用程序不包含任何线程问题是值得的。你可以使用Thread Sanitizer来做这件事，这在我的博客文章<a class="ae ky" href="https://www.avanderlee.com/swift/thread-sanitizer-data-races/" rel="noopener ugc nofollow" target="_blank"> Thread Sanitizer解释:Swift中的数据竞争</a>中有详细的解释。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1fee" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">僵尸物件怎么样？</h1><p id="4821" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">经历过Objective-C和bad访问异常的开发人员可能会想到僵尸对象来解决内存问题。僵尸对象可以从与我们之前启用地址杀毒程序相同的诊断设置中启用。它使被释放的对象保持活动状态，如果与访问被释放的实例有关，这有助于找到内存问题的根本原因。</p><p id="5947" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与Objective-C相比，Swift在防止内存问题发生方面做得更多。您更有可能遇到崩溃，比如“试图读取一个无主引用”,而不是像在Objective-C中访问被释放的实例那样遇到糟糕的访问异常。在这种情况下，您可以启用僵尸对象，这样您仍然可以读取正在被访问的已释放内存的内存地址。</p><p id="943b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在Swift中使用不受管理和不安全的指针，您更有可能遇到与内存相关的崩溃。干扰Objective-C框架也可能导致这些崩溃更频繁地发生。如果是这样，尝试在启用僵尸对象的情况下再次重现崩溃，并查看它是否会为您提供更多信息来修复崩溃。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="329d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="afa8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">尽管EXC _坏_访问在Swift中比在Objective-C中发生得少得多，但它仍然是一个常见的崩溃。希望在读完这篇文章后，你能够更容易地解决这些问题。</p><p id="f5dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想进一步提高您的Swift知识，请查看<a class="ae ky" href="https://www.avanderlee.com/category/swift/" rel="noopener ugc nofollow" target="_blank"> Swift类别页面</a>。</p><p id="27c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢！</p></div></div>    
</body>
</html>