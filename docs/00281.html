<html>
<head>
<title>How To Set Up a Powerful API With GraphQL, Koa, and MongoDB — CRUD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用GraphQL、Koa和MongoDB建立一个强大的API——CRUD</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-set-up-a-powerful-api-with-graphql-koa-and-mongodb-crud-4459fc0720d4?source=collection_archive---------0-----------------------#2019-01-30">https://betterprogramming.pub/how-to-set-up-a-powerful-api-with-graphql-koa-and-mongodb-crud-4459fc0720d4?source=collection_archive---------0-----------------------#2019-01-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/eb3f47d114a2f76f9b81566eca8505cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQneAcO1GBVPIkucIZe41g.png"/></div></div></figure><p id="7ce0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个系列中，我们将学习如何用<a class="ae kz" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>、<a class="ae kz" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank"> Koa </a>和<a class="ae kz" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> Mongo </a>建立一个强大的API。主要焦点将放在GraphQL上。如果您还没有，请查看本系列文章的第一部分。</p><div class="la lb gp gr lc ld"><a href="https://medium.com/free-code-camp/how-to-setup-a-powerful-api-with-graphql-koa-and-mongodb-339cfae832a1" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">如何用GraphQL、Koa和MongoDB建立一个强大的API</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">构建一个API超级好玩！尤其是当您可以利用Koa、GraphQL和MongoDB等现代技术时。</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jz ld"/></div></div></a></div></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="81bd" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">突变</h1><p id="a0ef" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">到目前为止，我们可以读取我们的数据，但很有可能我们需要编辑我们的数据记录/文档。任何完整的数据平台都需要一种修改服务器端数据的方法。</p><p id="edba" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">想象一下，一家公司推出了一个新玩意。我们如何用GraphQL将记录添加到数据库中呢？</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="f66d" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">什么是突变？</h1><p id="e85a" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">想想像<code class="fe nc nd ne nf b">POST</code>或<code class="fe nc nd ne nf b">PUT</code> REST动作这样的突变。设置突变非常简单。</p><p id="a5bb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们跳进来吧！</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="f010" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">向我们的数据库添加记录</h1><p id="5f37" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">创建一个文件<code class="fe nc nd ne nf b">graphql/mutations.js</code>。</p><p id="e02e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在文件中，我们将放置突变。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><ul class=""><li id="77d8" class="nm nn it kd b ke kf ki kj km no kq np ku nq ky nr ns nt nu bi translated">我们将从GraphQL库中导入<code class="fe nc nd ne nf b">GraphQLObjectType</code>和<code class="fe nc nd ne nf b">GraphQLObjectType</code>对象。</li><li id="83ed" class="nm nn it kd b ke nv ki nw km nx kq ny ku nz ky nr ns nt nu bi translated">为<code class="fe nc nd ne nf b">gadget</code>导入GraphQL类型。</li><li id="fb0a" class="nm nn it kd b ke nv ki nw km nx kq ny ku nz ky nr ns nt nu bi translated">导入<code class="fe nc nd ne nf b">gadget</code>猫鼬模型。</li></ul><p id="a36c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">导入我们需要的东西后，我们可以创造变异。</p><p id="9e99" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">突变只是一个普通的<code class="fe nc nd ne nf b">GraphQLObjectType</code>，就像我们之前的查询一样。它有两个我们感兴趣的主要特性。</p><ol class=""><li id="6286" class="nm nn it kd b ke kf ki kj km no kq np ku nq ky oa ns nt nu bi translated">这种突变的名字出现在<code class="fe nc nd ne nf b">graphiql</code>文档中。</li></ol><p id="66e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2.字段是我们放置变异逻辑的地方。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="6121" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意，我在<code class="fe nc nd ne nf b">fields</code>对象中添加了一个新对象。它被称为<code class="fe nc nd ne nf b">addGadget</code>，它会做它所说的事情。</p><p id="9eaa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe nc nd ne nf b">addGadget</code>中，我们可以访问三个属性，<code class="fe nc nd ne nf b">type</code>、<code class="fe nc nd ne nf b">args</code>和<code class="fe nc nd ne nf b">resolve()</code>。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="c9b3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">addGadget</code>类型为<code class="fe nc nd ne nf b">gadgetGraphQLType</code>。小工具只能具有我们之前声明的<code class="fe nc nd ne nf b">gadgetGraphQLType</code>类型中允许的属性。</p><p id="fa94" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">addGadget</code>是一个接受参数的查询。需要这些参数来指定要将哪个小工具添加到数据库中。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="1c94" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们预先声明查询接受哪些参数，以及参数的类型。</p><p id="4de2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后—查询会发生什么？这正是我们拥有<code class="fe nc nd ne nf b">resolve()</code>功能的原因。</p><p id="6084" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">记住<code class="fe nc nd ne nf b">resolve()</code>函数有两个参数:<code class="fe nc nd ne nf b">parent</code>和<code class="fe nc nd ne nf b">args</code>。我们对<code class="fe nc nd ne nf b">args</code>感兴趣，因为这些是我们传递给查询的值。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="bef5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在resolve中，我们放置了创建新Mongo记录的逻辑。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="522f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们创建了我们的<code class="fe nc nd ne nf b">Gadget</code>mongose模型的一个新实例，将我们从GraphQL收到的属性作为新字段传递，最后<a class="ae kz" href="https://mongoosejs.com/docs/api.html#model_Model-save" rel="noopener ugc nofollow" target="_blank">保存</a>记录。</p><p id="f3e0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是完整的突变的样子:</p><p id="4d72" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">graphl/mutations.js</code></p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="2172" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">瞧啊。我们需要做的就是将突变导入到我们的<code class="fe nc nd ne nf b">schema.js</code>文件中。</p><p id="530e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">graphl/schema.js</code></p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="56cf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果一切顺利，我们应该会在图表上看到以下内容:</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4b4d73ad80668099384ea1823c96af14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gTjqU28uSLDV_G_L.png"/></div></figure><p id="94a2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们点击它:</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0caa6c76bbf6e0da97dc6dd820c8c3d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/0*-9peysK2P5SYc7BP.png"/></div></figure><p id="e222" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意GraphQL是如何自动创建自我文档的。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="55bb" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">启动变异查询</h1><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/67b9a7c04db63a2280d14005b2a414c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yQOhpWSRNGxfpwbk.png"/></div></div></figure><p id="a710" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">变异只是一个普通的GraphQL查询，它接受我们的参数，将其保存到Mongo数据库，并返回我们想要的属性。</p><p id="1b19" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里有个问题——每个突变都需要标记为<code class="fe nc nd ne nf b">mutation</code>:</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/29e064bda50048add8de04ede2f8ec3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dl8MpiYhpgl4DR5t.png"/></div></div></figure><p id="91de" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们已经成功地创建了一个新的小工具并将其插入到我们的Mongo数据库中。</p><p id="2dd0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你去mLab 或者任何你正在使用的提供商，你应该会看到新的记录。</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/321a3f02dbd4702bce377c9b762378e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bH3lnA5Yab39w_Be.png"/></div></div></figure><p id="e87d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是我们突变的完整查询。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="911d" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">编辑我们在数据库中的记录</h1><p id="4840" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">如果我们想编辑预先存在的记录呢？我们不能指望永远不出错，或者价格发生变化怎么办？</p><p id="19e5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">编辑记录也是一种变异。记住，每次我们想要更改/添加新记录时，都是GraphQL的突变！</p><p id="93cf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">打开<code class="fe nc nd ne nf b">graphql/mutations</code>文件并创建另一个变异。变异只是一个普通的物体。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="84b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意，新的突变叫做<code class="fe nc nd ne nf b">updateGadget</code>。这几乎是之前变异的翻版。请注意额外的参数<code class="fe nc nd ne nf b">id</code>——这是因为我们需要找到现有的小工具并对其进行更改。我们可以通过id找到这个小工具。</p><p id="6315" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">resolve()</code>函数是它变得更有趣的地方。理想情况下，我们希望通过id找到小工具，更改道具，并保存它。我们将如何着手做这件事？</p><p id="8e0d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Mongoose给了我们一个做这个的方法，叫做<code class="fe nc nd ne nf b">findById</code>。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="7ce9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这回报了一个承诺。如果我们<code class="fe nc nd ne nf b">console.log</code>承诺，我们可以看到一个巨大的财产滴附在它上面。我们能对承诺做的，是用一种<code class="fe nc nd ne nf b">then()</code>方法把它锁住。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="b6b3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以，我们找到小工具，改变道具，保存它。但这又带来了另一个我们需要解决的承诺。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="e5c5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe nc nd ne nf b">.catch()</code>用于错误处理，以防我们遇到错误。记住，你可以通过<code class="fe nc nd ne nf b">pm2 logs</code>命令监控你的<code class="fe nc nd ne nf b">pm2</code>日志。如果遇到错误，这些错误将被记录到pm2记录器中。</p><p id="20bb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">仅此而已！查询时间。查看你的Mongo表并从中随机选择一个<code class="fe nc nd ne nf b">id</code>，然后编辑相应的小工具。</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/ac6d7b09eb70b3b0933f73b6b8ff77b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*caCg1f0eMIUN7Zov.png"/></div></div></figure><p id="1046" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们检查数据库，我们应该看到编辑过的记录。</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/89258801295a0f641fa94297820cb7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EMpyAOVrC-bzy7G8.png"/></div></div></figure><p id="fb75" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">成功！</p><p id="b0b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是对<code class="fe nc nd ne nf b">updateGadget</code>突变的查询。</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="7fb3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">好的，到目前为止我们有了<code class="fe nc nd ne nf b">Create</code>、<code class="fe nc nd ne nf b">Read</code>和<code class="fe nc nd ne nf b">Update</code>，但是我们缺少最后的<code class="fe nc nd ne nf b">d</code> (elete)。</p><p id="9066" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从Mongo数据库中删除记录非常简单。我们所需要的是另一个突变，因为我们实际上是在突变数据库。</p><p id="fe70" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于删除记录，Mongoose给了我们一个叫做<code class="fe nc nd ne nf b">findOneAndDelete</code>的简便方法——你可以在这里阅读<a class="ae kz" href="https://mongoosejs.com/docs/api.html#model_Model.findOneAndDelete" rel="noopener ugc nofollow" target="_blank">更多关于findOneAndDelete的内容。</a></p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="51b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">删除记录只需要一个参数—id。我们通过id找到小工具，删除它，然后返回。如果有错误，我们会记录下来。</p><figure class="ng nh ni nj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/73eeeef5f140d10a7da784fc9dc20800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fNcHgoZnMSHKbWIS.png"/></div></div></figure><p id="392f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">和查询:</p><figure class="ng nh ni nj gt ju"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="dd06" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意:确保<code class="fe nc nd ne nf b">id</code>是正确的，并且存在于数据库中，否则无法工作。</p><p id="0769" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们去我们的数据库并检查它——确实记录从我们的数据库中被删除了。</p><p id="8604" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">干得好，我们已经实现了基本的<code class="fe nc nd ne nf b">CRUD</code>功能。注意GraphQL是我们的数据库和视图之间的一个薄层。它不应该取代数据库，而是使数据处理、获取和操作变得更容易。</p><p id="f8d3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你对GraphQL感兴趣，我推荐你阅读《<a class="ae kz" href="https://amzn.to/2K5PfdE" rel="noopener ugc nofollow" target="_blank"> <em class="og">通往GraphQL之路</em> </a>》一书，以获得更深入的了解。</p><p id="ccc5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是源代码:</p><div class="la lb gp gr lc ld"><a href="https://github.com/wesharehoodies/koa-graphql-mongodb/tree/part-2" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">wesharehoodies/KOA-graph QL-MongoDB</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">教程如何用graphql和mongodb设置KOA-wesharehoodies/KOA-graph QL-MongoDB</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="lm l"><div class="oh l lo lp lq lm lr jz ld"/></div></div></a></div><p id="db81" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不要错过第三部分，我们将做更多精彩的事情:</p><div class="la lb gp gr lc ld"><a href="https://medium.com/@wesharehoodies/how-to-set-up-a-powerful-api-with-graphql-koa-and-mongodb-scalability-and-testing-4447c3bf5925" rel="noopener follow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd iu gy z fp li fr fs lj fu fw is bi translated">如何用GraphQL、Koa和MongoDB建立一个强大的API可伸缩性和测试</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">到目前为止，我们实现了基本的CRUD功能。</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jz ld"/></div></div></a></div><p id="8a11" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">感谢阅读！</p></div></div>    
</body>
</html>