<html>
<head>
<title>How to Automatically Resize an iframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何自动调整iframe的大小</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-automatically-resize-an-iframe-7be6bfbb1214?source=collection_archive---------0-----------------------#2019-07-16">https://betterprogramming.pub/how-to-automatically-resize-an-iframe-7be6bfbb1214?source=collection_archive---------0-----------------------#2019-07-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3eac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用HTML和JavaScript创建动态iframes，就像它们是父窗口的一部分一样</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/19c1a8948db21f219584d43dd4ecb3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TNl69IpXWa701dmX3G_1KA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@agkdesign?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>在<a class="ae ky" href="https://unsplash.com/search/photos/laptop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="3eba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">&lt;iframe&gt;</code>允许web开发者将一个HTML页面嵌入到另一个页面中。它非常有用，因为它们是HTML的一部分，所以你几乎可以在任何地方使用它们——在Wix和Squarespace这样的网站构建器中，或者在你的下一个全栈项目中。</p><p id="84f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">YouTube使用iframesss来允许嵌入视频，Google使用iframe来进行身份验证，SaaS的Mailchimp、Typeform和Outgrow等公司也使用iframe来提供嵌入内容。</p><p id="1f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，iframes也会引起一些问题，我们将在本文中讨论一些最常见的问题。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="93b3" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">问题是</h1><p id="574a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">默认情况下，iframes具有固定的高度。如果你的内容也有一个固定的高度，这没什么，但是如果你的内容的高度改变了，你很容易就会看到一个像这样的双滚动条怪物:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/6ff201104e5b385eb29e96bafc297617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TguFFfDnqAzcQlGVBfGfCg.png"/></div></div></figure><p id="d2e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们希望我们的iframe表现得像普通的HTML元素一样，内容垂直换行，那该怎么办？</p><p id="a7e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们需要动态地改变iframe的高度，但是安全考虑意味着父窗口不可能访问iframe中的元素。</p><p id="cdba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将解释一种实现这种效果的简单方法，使用普通的JavaScript。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="08b9" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">解决方案</h1><p id="aff9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">window.postMessage()</code>方法，我们可以安全地在iframe和父窗口之间通信。这样，我们可以从iframe向父窗口发送一个高度值。然后，在父窗口中，我们可以设置一个简单的脚本来动态更新iframe的高度。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="c96a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">代码</h1><p id="feb0" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">对于本教程，我们需要两个HTML文件:一个放iframe的父文件，一个包含iframe内容的子文件。</p><h2 id="ff78" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">child.html</h2><p id="dd14" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们的子文件将包含一个简单的虚拟文本生成器，人们可以单击一个按钮来添加另一段<em class="nq"> lorem ipsum </em>文本。</p><p id="0140" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于本教程是关于iframe的，而不是它的功能，请随意复制并粘贴以下内容到<code class="fe lv lw lx ly b">child.html</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2b69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在这个<a class="ae ky" href="https://codepen.io/" rel="noopener ugc nofollow" target="_blank">代码笔</a>中尝试上面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt ns l"/></div></figure><h2 id="2a76" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">parent.html</h2><p id="77bf" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们现在可以将iframe插入到<code class="fe lv lw lx ly b">parent.html</code>中。</p><p id="c2ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加通常的HTML5样板代码，然后在body标记之间插入以下内容:</p><pre class="kj kk kl km gt nu ly nv nw aw nx bi"><span id="12b2" class="ne mh it ly b gy ny nz l oa ob">&lt;iframe id="iframe" src="child.html" style="width:100%;border:none;"&gt;&lt;/iframe&gt;</span></pre><p id="2edd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这里我们遇到了我们的问题。因为我们设置了<code class="fe lv lw lx ly b">overflow: hidden</code>，按钮和第一段的一半消失了。</p><p id="49b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们没有设置<code class="fe lv lw lx ly b">overflow: hidden</code>，我们会看到两个滚动条，如上图所示。为了解决这个问题，我们需要从<code class="fe lv lw lx ly b">child.html</code>向父窗口发送post消息！</p><h2 id="d835" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">child.html</h2><p id="b731" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">因此，回到<code class="fe lv lw lx ly b">child.html</code>，我们需要向脚本部分添加新的事件监听器。</p><p id="e42e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要通知父元素iframe的高度:</p><ul class=""><li id="3674" class="oc od it lb b lc ld lf lg li oe lm of lq og lu oh oi oj ok bi translated">每次加载的时候，</li><li id="f204" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">每当调整窗口大小时，以及</li><li id="5060" class="oc od it lb b lc ol lf om li on lm oo lq op lu oh oi oj ok bi translated">每当按下按钮时。</li></ul><p id="d642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当这些事件发生时，我们将触发一个名为<code class="fe lv lw lx ly b">sendPostMessage</code>的函数。</p><p id="c6ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将以下代码放在结束的<code class="fe lv lw lx ly b">&lt;script&gt;</code>标签之前:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3d39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们创建我们的<code class="fe lv lw lx ly b">sendPostMessage()</code>函数。</p><p id="40f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想要测量id为<code class="fe lv lw lx ly b">container</code>的元素的高度。如果(且仅当)高度发生变化，我们要向父窗口发送一条名为<code class="fe lv lw lx ly b">frameHeight</code>的消息，通知它发生了更新。</p><p id="3cb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码应该在我们刚刚写的代码之上:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4a54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">postMessage</code>方法的第二个参数代表目标原点:父窗口的主机名。</p><p id="c0ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这对于安全性很有用，确保消息只发送到特定的域，但是出于开发目的，我们可以将目标源设置为<code class="fe lv lw lx ly b">'*'</code>。这意味着任何父窗口都将收到该消息。</p><p id="3200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，<code class="fe lv lw lx ly b">child.html</code>的代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="cb12" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">parent.html</h2><p id="29cd" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们在浏览器中加载<code class="fe lv lw lx ly b">parent.html</code>并打开控制台(在Google Chrome中按<code class="fe lv lw lx ly b">CTRL</code> + <code class="fe lv lw lx ly b">Shift</code> + <code class="fe lv lw lx ly b">J</code>)。</p><p id="275d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当我们调整窗口大小时，我们现在应该看到值出现在控制台中。最后一步是每当发送这些值中的一个时，使用它们来设置iframe高度。</p><p id="df90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要监听消息事件，每当我们接收到一个消息事件时，我们应该使用它来设置iframe的height属性(加上一点填充):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3dd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，您的<code class="fe lv lw lx ly b">parent.html</code>文件应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="f11d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您按照正确的步骤，您的iframe现在将自动调整大小，就像它的内容是父窗口的一部分一样！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="a0d4" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">缩小</h1><p id="5f48" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">最后一步，您可以缩减上面的代码，以便非开发人员可以轻松地复制并粘贴到他们的HTML中:</p><pre class="kj kk kl km gt nu ly nv nw aw nx bi"><span id="e236" class="ne mh it ly b gy ny nz l oa ob">&lt;iframe id="i" src="child.html" style="width:100%;border:none;"&gt;&lt;/iframe&gt;&lt;script&gt;window.onmessage=e=&gt;{e.data.hasOwnProperty("frameHeight")&amp;&amp;(document.getElementById("i").style.height=`${e.data.frameHeight+30}px`)}&lt;/script&gt;</span></pre><p id="cda9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你在线托管你的<code class="fe lv lw lx ly b">child.html</code>文件(使用类似<a class="ae ky" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或<a class="ae ky" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>的服务)，你可以把你的新URL插入到上面代码的<code class="fe lv lw lx ly b">src</code>属性中并发送给任何人。现在，任何人都可以将您的内容作为动态iframe嵌入！</p><p id="d896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你觉得这个教程有用！感谢阅读。</p></div></div>    
</body>
</html>