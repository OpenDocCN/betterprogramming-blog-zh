<html>
<head>
<title>AR Face Tracking in an Agora iOS Conference Call</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Agora iOS电话会议中的AR人脸跟踪</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/ar-face-tracking-in-an-agora-ios-conference-call-fb85b40c1fe0?source=collection_archive---------8-----------------------#2019-07-17">https://betterprogramming.pub/ar-face-tracking-in-an-agora-ios-conference-call-fb85b40c1fe0?source=collection_archive---------8-----------------------#2019-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d92" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用AR面部跟踪使多人通话比普通电话会议更具参与性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4ef8fef4d858e085fa9f3f2a967e469f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60HBrh6iA-ULTFU7k5kFOg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/close-up-photo-of-smiling-woman-sitting-on-sofa-using-smartphone-1919238/" rel="noopener ugc nofollow" target="_blank"> Raxpixel </a>在<a class="ae ky" href="https://www.pexels.com/photo/close-up-photo-of-smiling-woman-sitting-on-sofa-using-smartphone-1919238/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="76e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用AR人脸跟踪来增强实时虚拟家庭聚会对话的真实性是一种虚拟实验的好方法。这也是一种很好的方式，你可以戴着虚拟的派对面具和你的朋友在网上玩啤酒乒乓，或者参与其他网络恶作剧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a19d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置Agora的iOS SDK</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/2b7eea6b95e71dc30d35001c5534ac7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*CuJmKrqgprkQ_U9thbWnyQ.png"/></div></figure><p id="0d33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置Agora的iOS SDK真的很简单。核心是一个Singleton，您可以随意使用它来实现Agora功能。简而言之:您在目录上运行Cocoapods，向AppDelegate.swift添加一个AppID，并添加摄像头和麦克风权限(别忘了这一步！).然后，将<code class="fe mv mw mx my b">AgoraRtcEngineKit</code>导入视图控制器，添加设置本地和远程视频的功能，加入通道，并设置代理。您可以一步一步地完成集成。</p><h2 id="a455" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">第一步:椰子</h2><p id="476c" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">导航到根目录。如果你还没有酝酿好，现在就是开始的好时机。如果没有安装Cocoapods，运行:<code class="fe mv mw mx my b">brew install cocoapods</code>。如果有，跑:<code class="fe mv mw mx my b">pod init</code>。</p><p id="ec0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，将以下内容添加到您的<code class="fe mv mw mx my b">Podfile</code>:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="27df" class="mz md it my b gy nu nv l nw nx">platform :ios, ‘9.0’<br/>use_frameworks!<br/>   target ‘Your App’ do<br/>   pod ‘AgoraRtcEngine_iOS’<br/>end</span></pre><p id="5a21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更新您的本地Cocoapods库:</p><p id="48b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">pod update</code></p><p id="854e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更新pod后，安装:</p><p id="bc00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">pod install</code></p><p id="e5f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开你的应用程序:</p><p id="798d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">open YourApp.xcworkspace</code></p><p id="1753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，添加摄像头和麦克风的权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/4544cbb0cf37d2b041ebba8ffb783540.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*Oc1iXaiCGeKtM9YDMd7kqA.png"/></div></figure><h2 id="4780" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">第二步:应用程序委托和单例</h2><p id="0387" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">在你的<code class="fe mv mw mx my b">AppDelegate.swift</code>顶部添加一个常量:</p><p id="1479" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b"><strong class="lb iu">let</strong> AppID = “”</code></p><p id="096d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在那里加上你的<code class="fe mv mw mx my b">AppID</code>。</p><p id="2629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，转到您的视图控制器文件。在这里，您需要在顶部添加以下内容:</p><p id="cce1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">import AgoraRtcEngineKit</code></p><p id="2cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Agora用于调用<code class="fe mv mw mx my b">AgoraRtcEngine</code>实例的<code class="fe mv mw mx my b">Singleton</code>设计模式是通过调用<code class="fe mv mw mx my b">sharedEngine:withAppID:delegate</code>方法触发的，其中<code class="fe mv mw mx my b">agoraKit.enableWebSdkInteroperability(<strong class="lb iu">true</strong>)</code>。</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="303e" class="mz md it my b gy nu nv l nw nx">func initializeAgoraEngine() {<br/>    agoraKit = AgoraRtcEngineKit.sharedEngine(withAppId: AppID, delegate: self)<br/>    agoraKit.enableWebSdkInteroperability(<strong class="my iu">true</strong>)<br/>}</span></pre><h2 id="8df1" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">第三步:设置视频</h2><ul class=""><li id="e84b" class="nz oa it lb b lc nl lf nm li ob lm oc lq od lu oe of og oh bi translated">启用视频:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="7acc" class="mz md it my b gy nu nv l nw nx">func setupVideo() {</span><span id="c178" class="mz md it my b gy oi nv l nw nx">    agoraKit.enableVideo()<br/>       agoraKit.setVideoEncoderConfiguration(AgoraVideoEncoderConfiguration(size: AgoraVideoDimension640x360, frameRate: .fps15, bitrate: AgoraVideoBitrateStandard, orientationMode: .adaptative) ) // Default video profile is 360P </span><span id="ab51" class="mz md it my b gy oi nv l nw nx">}</span></pre><ul class=""><li id="7891" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">加入频道:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="3e38" class="mz md it my b gy nu nv l nw nx">func joinChannel() {<br/>    agoraKit.setDefaultAudioRouteToSpeakerphone(true)<br/>    agoraKit.joinChannel(byToken: nil, channelId: “demoChannel1”, info:nil, uid:0){[weak self] (sid, uid, elapsed) -&gt; Void in<br/>    // Join channel “demoChannel1”<br/>    }<br/>   UIApplication.shared.isIdleTimerDisabled = true<br/>}</span></pre><ul class=""><li id="643d" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">调用<code class="fe mv mw mx my b">viewDidLoad()</code>中的方法:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="32cd" class="mz md it my b gy nu nv l nw nx">override func viewDidAppear(_ animated: Bool) {           <br/>    super.viewDidAppear(animated)<br/>    <br/>    initializeAgoraEngine()<br/>    setupVideo()<br/>    showJoinAlert()<br/>}</span><span id="51c8" class="mz md it my b gy oi nv l nw nx">func showJoinAlert() {<br/>    let alertController = UIAlertController(title: nil, message: “Ready to join channel.”, preferredStyle: .alert)<br/>    let action = UIAlertAction(title: “Join”, style: .destructive) { (action:UIAlertAction) in<br/>    self.joinChannel()<br/>  }<br/>  alertController.addAction(action)<br/>  present(alertController, animated: true, completion: nil)</span><span id="fd67" class="mz md it my b gy oi nv l nw nx">}</span></pre><ul class=""><li id="00c5" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">代理分机:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="d9e5" class="mz md it my b gy nu nv l nw nx">extension VideoCallViewController: AgoraRtcEngineDelegate {<br/>   func rtcEngine(_ engine: AgoraRtcEngineKit,      <br/>   firstRemoteVideoDecodedOfUid uid:UInt, size:CGSize, elapsed:Int) {<br/>   if (remoteVideo.isHidden) {<br/>   remoteVideo.isHidden = false<br/>}</span><span id="624c" class="mz md it my b gy oi nv l nw nx">let videoCanvas = AgoraRtcVideoCanvas()<br/>    videoCanvas.uid = uid<br/>    videoCanvas.view = remoteVideo<br/>    videoCanvas.renderMode = .hidden<br/>    agoraKit.setupRemoteVideo(videoCanvas)<br/>}</span><span id="2290" class="mz md it my b gy oi nv l nw nx">internal func rtcEngine(_ engine: AgoraRtcEngineKit, didOfflineOfUid uid:UInt, reason:AgoraUserOfflineReason) {</span><span id="3f1a" class="mz md it my b gy oi nv l nw nx">self.remoteVideo.isHidden = true<br/>}</span><span id="cf1c" class="mz md it my b gy oi nv l nw nx">func rtcEngine(_ engine: AgoraRtcEngineKit, didVideoMuted muted:Bool, byUid:UInt) {</span><span id="d137" class="mz md it my b gy oi nv l nw nx">remoteVideo.isHidden = muted<br/>    remoteVideoMutedIndicator.isHidden = !muted<br/>    }<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f8000c9fb175df7d0034303a538ad48c.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*BYQR236Y7dhCjmKFN6jXKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿尔基特</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9c15" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">电话会议</h1><p id="7bc1" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">将Agora SDK连接到ARKit可以在实时电话会议中实现增强现实。正如ARSCNView文档中所描述的:“视图自动呈现来自设备摄像机的实时视频作为场景背景。”在我们的AR人脸跟踪实现中，我们将设置ARKit在本地而不是远程跟踪我们的人脸。</p><h2 id="fbb9" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">阿尔基特</h2><p id="d4ab" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">要启用本地视频的AR人脸跟踪，请将本地视频方法配置到<code class="fe mv mw mx my b">ARSCNView()</code>。然后，配置视图控制器，通过以下方式检查是否支持AR:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="8961" class="mz md it my b gy nu nv l nw nx">func setupLocalVideo(uid: UInt) {<br/>        <br/>        <br/>        let videoView = ARSCNView()<br/>        videoView.tag = Int(uid)<br/>        videoView.backgroundColor = UIColor.orange<br/>        <br/>//        let videoCanvas = AgoraRtcVideoCanvas()<br/>//        videoCanvas.uid = uid<br/>//        videoCanvas.view = videoView<br/>//        videoCanvas.renderMode = .hidden<br/>//        agoraKit.setupLocalVideo(videoCanvas)</span><span id="ea51" class="mz md it my b gy oi nv l nw nx">        self.sceneView = videoView<br/>        self.sceneView?.delegate = self<br/>        <br/>        if isARSupported {<br/>            let configuration = ARFaceTrackingConfiguration()<br/>            sceneView?.session.run(configuration)<br/>        }<br/>        <br/>        let tapGuesture = UITapGestureRecognizer(target: self, action: #selector(handleTap(_:)))<br/>        tapGuesture.numberOfTapsRequired = 1<br/>        self.sceneView?.addGestureRecognizer(tapGuesture)</span><span id="da92" class="mz md it my b gy oi nv l nw nx">stackView.addArrangedSubview(videoView)<br/>    }</span></pre><p id="49fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使ARSCNView()能够显示表情符号，您必须采取一些额外的步骤。Ray Wenderlich的博客文章详细介绍了这些步骤。</p><p id="cb44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，让我们在这里回顾一下这些步骤:</p><ul class=""><li id="b871" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">导入ARKit:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="fb0e" class="mz md it my b gy nu nv l nw nx">import ARKit </span></pre><ul class=""><li id="d5e7" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">添加配置:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="42a9" class="mz md it my b gy nu nv l nw nx">override func viewWillAppear(_ animated: Bool) {<br/>  super.viewWillAppear(animated)<br/>        <br/>  // 1<br/>  let configuration = ARFaceTrackingConfiguration()<br/>        <br/>  // 2<br/>  sceneView.session.run(configuration)<br/>}<br/>    <br/>override func viewWillDisappear(_ animated: Bool) {<br/>  super.viewWillDisappear(animated)<br/>        <br/>  // 1<br/>  sceneView.session.pause()<br/>}</span></pre><ul class=""><li id="b0ad" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">添加网格遮罩:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="049a" class="mz md it my b gy nu nv l nw nx">// 1<br/>extension Bling: ARSCNViewDelegate {<br/>  // 2<br/>  func renderer(_ renderer: SCNSceneRenderer, nodeFor anchor: ARAnchor) -&gt; SCNNode? {<br/>    <br/>    // 3<br/>    guard let device = sceneView.device else {<br/>      return nil<br/>    }<br/>    <br/>    // 4<br/>    let faceGeometry = ARSCNFaceGeometry(device: device)<br/>    <br/>    // 5<br/>    let node = SCNNode(geometry: faceGeometry)<br/>    <br/>    // 6<br/>    node.geometry?.firstMaterial?.fillMode = .lines<br/>    <br/>    // 7<br/>    return node<br/>  }<br/>}</span></pre><ul class=""><li id="6643" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">将以下代码添加到<code class="fe mv mw mx my b">viewDidLoad()</code>:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="3425" class="mz md it my b gy nu nv l nw nx">sceneView.delegate = self</span></pre><ul class=""><li id="11ba" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">更新网格遮罩:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="7bc0" class="mz md it my b gy nu nv l nw nx">// 1<br/>func renderer(<br/>  _ renderer: SCNSceneRenderer, <br/>  didUpdate node: SCNNode, <br/>  for anchor: ARAnchor) {<br/>   <br/>  // 2<br/>  guard let faceAnchor = anchor as? ARFaceAnchor,<br/>    let faceGeometry = node.geometry as? ARSCNFaceGeometry else {<br/>      return<br/>  }<br/>    <br/>  // 3<br/>  faceGeometry.update(from: faceAnchor.geometry)<br/>}</span></pre><ul class=""><li id="6ea6" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">添加表情符号bling:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="8af4" class="mz md it my b gy nu nv l nw nx">let noseOptions = ["👃", "🐽", "💧", " "]</span></pre><ul class=""><li id="8545" class="nz oa it lb b lc ld lf lg li oj lm ok lq ol lu oe of og oh bi translated">添加表情符号节点:</li></ul><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="f7e4" class="mz md it my b gy nu nv l nw nx">// 1<br/>node.geometry?.firstMaterial?.transparency = 0.0<br/><br/>// 2<br/>let noseNode = EmojiNode(with: noseOptions)<br/><br/>// 3<br/>noseNode.name = "nose"<br/><br/>// 4<br/>node.addChildNode(noseNode)<br/><br/>// 5<br/>updateFeatures(for: node, using: faceAnchor)</span></pre><p id="6238" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建并运行应用程序。如果一切工作正常，那么你有一个本地视频的网格遮罩。点击它可以从表情数组中的一个元素添加一个手势！如果你需要代码库的精确副本，那么就在<a class="ae ky" href="https://pastebin.com/0ZrSb1aX" rel="noopener ugc nofollow" target="_blank">的剪贴板</a>上查看。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/56cb5d443dd8d7bc057beb4a29a91a15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*kJRIWlGVmGkK1EYruajtqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">iPhone X iOS上的ARKit网络视频通话</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c935" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ARKit的其他面部跟踪集成</h1><p id="3606" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">使用以下系列为您的眼睛、嘴巴或头部添加新选项:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="e6c6" class="mz md it my b gy nu nv l nw nx">let eyeOptions = ["👁", "🌕", "🌟", "🔥", "⚽️", "🔎", " "]<br/>let mouthOptions = ["👄", "👅", "❤️", " "]<br/>let hatOptions = ["🎓", "🎩", "🧢", "⛑", "👒", " "]</span></pre><p id="0f91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的<code class="fe mv mw mx my b">renderer(_:nodeFor:)</code>中添加详细信息:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="dbbf" class="mz md it my b gy nu nv l nw nx">let leftEyeNode = EmojiNode(with: eyeOptions)<br/>leftEyeNode.name = "leftEye"<br/>leftEyeNode.rotation = SCNVector4(0, 1, 0, GLKMathDegreesToRadians(180.0))<br/>node.addChildNode(leftEyeNode)<br/>    <br/>let rightEyeNode = EmojiNode(with: eyeOptions)<br/>rightEyeNode.name = "rightEye"<br/>node.addChildNode(rightEyeNode)<br/>    <br/>let mouthNode = EmojiNode(with: mouthOptions)<br/>mouthNode.name = "mouth"<br/>node.addChildNode(mouthNode)<br/>    <br/>let hatNode = EmojiNode(with: hatOptions)<br/>hatNode.name = "hat"<br/>node.addChildNode(hatNode)</span></pre><p id="de3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要索引这些功能，请添加以下内容:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="424f" class="mz md it my b gy nu nv l nw nx">let features = ["nose", "leftEye", "rightEye", "mouth", "hat"]<br/>let featureIndices = [[9], [1064], [42], [24, 25], [20]]</span></pre><p id="a00d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用以下代码更新<code class="fe mv mw mx my b">updateFeatures(for:using:)</code>方法:</p><pre class="kj kk kl km gt nq my nr ns aw nt bi"><span id="4fff" class="mz md it my b gy nu nv l nw nx">// 1<br/>for (feature, indices) in zip(features, featureIndices)  {<br/>  // 2<br/>  let child = node.childNode(withName: feature, recursively: false) as? EmojiNode<br/>  <br/>  // 3<br/>  let vertices = indices.map { anchor.geometry.vertices[$0] }<br/>  <br/>  // 4<br/>  child?.updatePosition(for: vertices)<br/>}</span></pre><p id="3e51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正确地实现了本节中的代码片段，您应该能够添加眼睛、嘴巴或帽子。以下是视图控制器的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ViewController的代码库</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="12eb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">下一步是什么？</h1><p id="e3de" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">AR人脸跟踪是一种很好的方式，可以让多成员通话比一般的电话会议更活跃。如果你喜欢美容产品、服装或其他类型的购物，那么你和你的朋友可能会喜欢尝试AR化妆、染发、皮肤光滑、光泽、口红、牙齿美白或面部整形。有很多不同的方法可以集成AR人脸跟踪以实现实时互动。</p></div></div>    
</body>
</html>