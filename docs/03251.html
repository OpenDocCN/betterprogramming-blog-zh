<html>
<head>
<title>In Defense of the Simple For Loop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为了保护简单的For循环</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/in-defense-of-the-simple-for-loop-a03a4ad951f1?source=collection_archive---------19-----------------------#2020-01-29">https://betterprogramming.pub/in-defense-of-the-simple-for-loop-a03a4ad951f1?source=collection_archive---------19-----------------------#2020-01-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="550d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Map、filter和reduce都很棒，但是简单的for循环仍然是JavaScript程序员的好工具</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/77aa38f3c9b2199fd6f30a8186b1b807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7vklwoG9ZsUjMjGz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">彼得·托马斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7e0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近读了很多文章，推荐开发人员“停止使用<code class="fe lv lw lx ly b">for</code>循环”,转而使用更专业的循环技术，如<code class="fe lv lw lx ly b">map</code>、<code class="fe lv lw lx ly b">filter</code>、<code class="fe lv lw lx ly b">reduce</code>、<code class="fe lv lw lx ly b">forEach</code>等。</p><p id="6b55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在某种程度上同意这个建议。<code class="fe lv lw lx ly b">Map</code>、<code class="fe lv lw lx ly b">filter</code>和<code class="fe lv lw lx ly b">reduce</code>是很棒的工具，我在自己的程序中使用它们获得了很多价值。</p><p id="f5d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但另一方面，简单的<code class="fe lv lw lx ly b">for</code>循环也没什么不好。For循环在很多情况下和<code class="fe lv lw lx ly b">map</code>、<code class="fe lv lw lx ly b">filter</code>、<code class="fe lv lw lx ly b">reduce</code>一样好。在其他一些情况下，普通的<code class="fe lv lw lx ly b">for</code>循环可能是最佳选择。</p><p id="215d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将探讨简单的<code class="fe lv lw lx ly b">for</code>循环仍然是一个好选择的四种情况。下面的例子是用JavaScript编写的，但是一般原则也适用于其他编程语言。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="bfe6" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">1.当你不迭代一个数组的时候</h1><p id="1bfc" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">循环通常用于迭代数组，但这不是使用它们的唯一方式。有时候，你只是想从一个数字开始向上或向下计数，并对该范围内的每个数字做一些事情。</p><p id="4ee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过一个简单的<code class="fe lv lw lx ly b">for</code>循环，这很容易:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="e99f" class="nh mh it ly b gy ni nj l nk nl">for (let i = 99; i &gt; 0; i--) {<br/>  console.log(`${i} bottles of beer on the wall...`)<br/>}</span></pre><p id="9a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，用数组方法实现这一点更麻烦:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="1062" class="nh mh it ly b gy ni nj l nk nl">[...Array(99).keys()]<br/>  .map(index =&gt; 99 - index)<br/>  .forEach(i =&gt; console.log(`${i} bottles of beer on the wall...`))</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="09e7" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">2.当性能是关键考虑因素时</h1><p id="1c7d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">简单的<code class="fe lv lw lx ly b">for</code>循环执行速度非常快，可以用来加速将性能放在首位的应用程序。这些可能包括以下内容:</p><ol class=""><li id="d29d" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">处理大量数据的程序。</li><li id="2752" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">具有多维数组的程序，这些数组要求循环嵌套在循环嵌套中。</li><li id="ae9c" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">非常短的时间间隔对企业运营非常重要的任何情况。想想高频金融交易系统。</li></ol><p id="a4b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">For循环几乎总是在性能上占优势，因为它们没有创建回调函数的开销。</p><p id="32f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:<strong class="lb iu"> </strong>这可能不适用于大多数运行JavaScript的应用或网站！</p><p id="30f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数应用程序都有更大的目标来优化它们的性能，比如最小化静态资产、减少数据库查询、实现智能缓存等。</p><p id="00a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">循环迭代速度是你通常需要担心的最后一件事！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0ccc" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">3.当你执行“副作用”时</h1><p id="6ac2" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">Map</code>、<code class="fe lv lw lx ly b">filter</code>和<code class="fe lv lw lx ly b">reduce</code>是高阶函数，它们需要一个回调函数作为参数。</p><p id="edf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个回调函数应该使用所提供的参数来返回值，并且不应该做任何其他事情(它应该是一个“纯”函数)。例如，您不会希望它做诸如改变浏览器DOM或写入服务器日志文件之类的事情。这类事情被称为“副作用”。</p><p id="32f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">副作用不适用于函数数组方法，但它们仍然是JavaScript程序的重要组成部分，有时需要在循环中完成。</p><p id="9365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当需要这样做时，一个简单的<code class="fe lv lw lx ly b">for</code>循环是一个不错的选择:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="8757" class="nh mh it ly b gy ni nj l nk nl">const root = document.getElementById('root')<br/>const names = ['Lisa', 'Bart', 'Maggie']<br/>for (let name of names) {<br/>  root.innerHTML += `&lt;li&gt;${name}&lt;/li&gt;`<br/>}</span></pre><p id="407d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Map</code>可以用来做同样的事情，但是以这种方式使用它通常是不可取的，原因如上所述:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="209f" class="nh mh it ly b gy ni nj l nk nl">const root = document.getElementById('root')<br/>const names = ['Lisa', 'Bart', 'Maggie']<br/>names.map(name =&gt; {<br/>  // not a pure function!<br/>  root.innerHTML += `&lt;li&gt;${name}&lt;/li&gt;`<br/>})</span></pre><p id="d1d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，您可以将副作用从回调函数中移除，并在这个带有<code class="fe lv lw lx ly b">reduce</code>的特定示例中获得类似的结果。</p><p id="63c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这被认为是对上述示例的改进，但比简单的<code class="fe lv lw lx ly b">for</code>循环示例需要更多的工作:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="e5b1" class="nh mh it ly b gy ni nj l nk nl">const root = document.getElementById('root')<br/>const names = ['Lisa', 'Bart', 'Maggie']<br/>root.innerHTML = names.reduce((html, name) =&gt; {<br/>  return `${html}&lt;li&gt;${name}&lt;/li&gt;`<br/>}, '')</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="038c" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">4.当你编写独特而复杂的算法，不适合任何特定的数组方法时</h1><p id="9d80" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">有经验的程序员知道一个程序运行的方式是没有数量限制的。这适用于我们在全球范围内的应用程序，也适用于特定算法在较小范围内的运行方式。</p><p id="93d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们正在编写一个接受一组值的算法，并且需要对该组中的每个值应用一个公共转换(“映射”)，那么使用像<code class="fe lv lw lx ly b">map</code>这样的工具可能是完美的。</p><p id="b47b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们正在编写一个接受一组值的算法，并且需要“过滤”掉该组中的特定值，那么使用像<code class="fe lv lw lx ly b">filter</code>这样的工具可能会很好。</p><p id="7cde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们正在编写一个算法，该算法接受一组值，并需要将该组值“简化”为特定值(例如，将物料清单简化为总成本，或将一组考试分数简化为班级平均值)，那么使用类似<code class="fe lv lw lx ly b">reduce</code>的工具是理想的。</p><p id="b8ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Map</code>、<code class="fe lv lw lx ly b">filter</code>、<code class="fe lv lw lx ly b">reduce</code>等数组方法对于解决特定类型的问题非常优秀，但它们并不是为解决所有可以想象的问题而设计的。</p><p id="abb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，简单的<code class="fe lv lw lx ly b">for</code>循环不是为任何特定类型的算法定制的，它给了开发人员很多控制权。这使得它成为处理那些用现成的数组方法不容易处理的棘手的小问题的一个很好的工具。</p><p id="7313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它甚至附带了一些不错的小关键字，比如<code class="fe lv lw lx ly b">continue</code>可以让你跳过一次迭代，或者<code class="fe lv lw lx ly b">break</code>可以让你完全终止循环。</p><p id="cc8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，<code class="fe lv lw lx ly b">reduce</code>也非常灵活，可以用来解决大多数(所有？)数组算法。但是仅仅因为你能，并不意味着你应该。</p><p id="24a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Reduce</code>应在语义上使用。一些算法可能采用输入值的一个小而简单的子集，并将其转换为一组更大、更复杂的输出值。</p><p id="5dc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，说输入数组被“简化”为输出数组有意义吗？不会的。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3e98" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">摘要</h1><p id="6335" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">作为一名开发人员，在您的工具包中拥有<code class="fe lv lw lx ly b">map</code>、<code class="fe lv lw lx ly b">filter</code>、<code class="fe lv lw lx ly b">reduce</code>和其他数组方法是很好的，但是仍然有简单的<code class="fe lv lw lx ly b">for</code>循环的空间。ES6甚至引入了<code class="fe lv lw lx ly b">for...of</code>循环和<code class="fe lv lw lx ly b">for...in</code>循环来支持经典的增量版本。</p><p id="c76d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算编程是一门非常微妙的手艺，当你深入研究时，许多关于最佳实践的规则都有例外。</p><p id="66d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">高阶数组方法通常是提高代码质量的好方法，但在以下情况下，简单的<code class="fe lv lw lx ly b">for</code>循环可能是正确的选择:</p><ol class=""><li id="8bcb" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">你不是在一个数组上迭代——你只需要一个递增的整数。</li><li id="e06c" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">你需要循环尽可能快。</li><li id="1b8c" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">你需要在循环中产生副作用。</li><li id="9cb8" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">您正在处理一个独特或复杂的算法，没有一个可用的数组方法非常适合它。</li></ol></div></div>    
</body>
</html>