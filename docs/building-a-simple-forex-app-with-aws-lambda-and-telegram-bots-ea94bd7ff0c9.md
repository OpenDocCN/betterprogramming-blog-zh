# 用 AWS Lambda 和 Telegram 机器人构建一个简单的外汇应用

> 原文：<https://betterprogramming.pub/building-a-simple-forex-app-with-aws-lambda-and-telegram-bots-ea94bd7ff0c9>

![](img/95e37676e93cd69d41d9e28b115653a4.png)

由[约书亚·梅奥](https://unsplash.com/@mayofi?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

如果你是数字经济领域的自由职业者，在寻找新的潜在客户和合作者时，你很可能具有全球视野。一个巨大的，世界范围内的潜在客户和机会池对你来说是可用的。因此，设计师、营销专家、网站开发人员或销售代表与不同国家的商业伙伴合作并不罕见。

有时，客户可能只愿意用当地货币向你付款。当然，这有点不方便，但毕竟，建立一个多货币账户通常很容易，也不贵，所以最好接受这种安排，并计划以后兑换货币。

*编者按:本文并非投资建议，仅供娱乐和教育之用。*

# 问题是

这正是我几个月前的处境:我在工作，我每月开发票，我得到报酬。没有什么值得大书特书的。然而，在几次迭代之后，我开始注意到这种方法的一些问题。显然，我不时需要将小额货币兑换成当地货币来买东西，而且以有利的汇率兑换可不是小事:

*   每当我需要现金时，不看当前汇率就进行转换是不明智的:像`USD/EUR`或`USD/GBP`这样的货币对波动很大，仅仅几个*价格-利息点*(又名[点](https://www.investopedia.com/terms/p/pip.asp))的差异就可能给你的银行账户带来非常不同的结果。为什么把钱留在桌子上？
*   转换货币总是有成本的:可变费用、差价和平台订阅。不管怎么做，经纪人总会想办法拿到自己的那份。
*   出于财务目的，唯一重要的汇率是我创建发票时使用的汇率。然而，当我拿到报酬并想在几天后转账时，市场已经在以完全不同的速度运行了。不幸的是，税务员并不关心在过去的两年里，经济是否像过山车一样疯狂，历史上强势的货币是否暴跌——他只想要他的钱。

如你所见，这里有许多不同的变量在起作用，大多对我不利。我不喜欢它。该死的。我以为我是个工程师，如果有机会赚点啤酒钱，我会想办法解决的！

# 解决方案

![](img/1aac082d7b81a136445888a02e87cab4.png)

好吧，如何扭转局面对我有利？让我们从几个假设开始。残酷的现实是，外汇交易是复杂和高风险的。我本可以投入数百个小时来自学，试图想出聪明的策略来获得市场优势。然而，这种方法需要大量的时间和金钱，作为一个散户投资者很难做到，而且这也不是我的强项。我的结论是，我会坚持一个天真的价格策略:低买高卖。

其次，我需要一种方法来持续监控当前汇率，并在方便兑换货币时根据汇率采取行动。最初，我会访问 TradingView 等网站浏览货币对汇率。然而，作为一个卑微的人类，我很快厌倦了这种重复而无聊的工作:事实上，我意识到，机器人会更乐意做这种工作！

# 机器人

这个策略很简单:每两个小时发送一个通知，告诉我当前的价格和我在那个时间点可能的收益或损失。最关键的部分是获得关于交易所的正确、及时的数据:有无数的 API 可以帮助这一点，我只是选择了阻力最小的路径，并实现了 APILayer 的[汇率数据 API](https://apilayer.com/marketplace/exchangerates_data-api) ，因为它是免费和简单的，但老实说，任何 API 都可以工作得很好。我的`fetchRate`函数应该是这样的:

显然，`from`和`to`参数代表我感兴趣的任何货币对。一旦我有了当前汇率，计算与我的平均价格的[点](https://www.investopedia.com/terms/p/pip.asp)差就变得微不足道了。

最后，我只需要一种方法，用这个有趣的信息给自己发一条信息。同样，没有必要把事情复杂化:Telegram API 可以很好地服务于这个目的，并且设置起来非常简单。在向[@机器人父亲](https://t.me/botfather)请求一个私人机器人朋友后，我准备发布消息:

# 在 Lambda 上部署

有一个个人外汇机器人是非常有用的，只有当它总是启动和运行。AWS Lambda 是一个几乎免费的解决方案，可以托管像我这样的简单程序(甚至是小型微服务架构)，所以我重构了我的代码，使其作为无服务器函数运行。不过也有一些丑陋的部分，比如 Golang 不支持某些特性，并且需要创建一个 zip 存档来上传文件(eww)。

然而，Lambda 函数具有很大的灵活性，可以由 cronjob 任务、SQS 消息甚至 API 调用来触发。对于我的用例，我决定设置一个 bihourly cronjob，并添加一个简单的 JSON 有效负载来指定一些输入变量

让钱流入！💸💸💸

[加入我的时事通讯，了解更多类似的故事](https://blog.lorisocchipinti.com)

# 参考

*   【github.com forex-bot 回购
*   [什么是外汇交易中的点，它们的价值是什么？](https://www.investopedia.com/terms/p/pip.asp)
*   [用于 Go 的 AWS Lambda 文档](https://docs.aws.amazon.com/lambda/latest/dg/lambda-golang.html)
*   [如何设置电报机器人](https://core.telegram.org/bots)
*   [汇率数据 API](https://apilayer.com/marketplace/exchangerates_data-api)