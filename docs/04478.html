<html>
<head>
<title>Deploying Your First AWS Lambda Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署您的第一个AWS Lambda函数</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/deploy-your-first-lambda-function-4f7e54f75001?source=collection_archive---------12-----------------------#2020-04-15">https://betterprogramming.pub/deploy-your-first-lambda-function-4f7e54f75001?source=collection_archive---------12-----------------------#2020-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a1a0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用命令行</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61fa23add470bcdbfcf36ba60940cf56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBf-Ry_KWhdw2Ak50P1vpg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">柴坦尼亚·马赫什瓦里在<a class="ae ky" href="https://unsplash.com/s/photos/command-line?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fa30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为开发人员，您经常需要创建API来与各种系统和集成进行交互。传统上，这需要大量的工作，包括开发基础设施和在本地或云服务器(如EC2)上部署代码。</p><p id="c212" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这种方法速度慢且成本高。</p><p id="4388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，无服务器计算的概念在过去的几年里变得流行起来。</p><p id="1bbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无服务器服务的一个例子是<a class="ae ky" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank">AWSλ</a>。Lambda的工作方式类似于API端点，只要你可以访问一个函数，你就可以调用这个函数。</p><p id="30a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该服务仅在需要时执行代码，并根据需要自动调整每天的请求。当与API网关结合使用来开发一个最佳解决方案时，它会很方便。</p><p id="f32a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS API Gateway 本身是一个完全托管的服务，允许开发人员创建、发布、监控和维护任何规模的API。</p><p id="a15f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你把它和Lambda函数结合起来，你现在就有了所谓的FaaS(函数即服务)。这使得开发人员可以用经济高效的无服务器解决方案取代缓慢的传统后端开发过程。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1f7a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用Lambda的好处</h1><p id="fe00" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">使用无服务器技术有几个好处。</p><p id="a8de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开发层面，Lambda使得管理系统复杂性和进行集成测试变得更加容易。简而言之，Lambda使工程师能够完全专注于业务逻辑，因为它处理缩放、日志记录、错误跟踪和授权。</p><p id="aa99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Lambda的一些最重要的优势如下:</p><h2 id="bc53" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">内置日志</strong></h2><p id="1dfd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您是否曾经开发过一个基础设施，并意识到您需要投入相当多的时间来包含日志记录和错误跟踪？</p><p id="cc47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Lambda为你做了这一切。您可以在AWS管理控制台中看到您的所有日志。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/282294b4a3cdaa696caa01432b40ae0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNAkWooamwxffooA3618GQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为我们的测试函数记录日志</p></figure><h2 id="68c9" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">可扩展性</strong></h2><p id="6725" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">另一个有趣的特性是AWS Lambda会自动缩放您的应用程序。</p><p id="fbaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它运行您的代码来响应每个请求，然后与正在运行的代码并行地单独处理每个请求。这样，触发器就可以根据整个工作负载的大小进行精确的扩展。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b225" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用API Gateway开发你的第一个Lambda函数</h1><p id="970d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">考虑到所有的好处，让我们来讨论如何设置一个AWS Lambda函数。</p><p id="b791" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们先来看看下面的函数。这是一个标准的“Hello World”风格的函数。您还会注意到我们正在使用Python，这对于稍后配置您的设置非常重要。</p><p id="10c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想把这个基本功能推到AWS Lambda上。与您的标准“Hello World”函数不同，您可能只传入一个变量，这个函数将接受一个引用“事件”的参数。这将包含我们将在HTTP请求中传递的数据。</p><p id="3b98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些数据将被解析，并提取出请求体中的任何参数，然后根据我们的需要设置它们。在这种情况下，只有“名称”变量。</p><p id="434b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将用它发回“Hello”+name和一个状态代码200。这将表示函数成功返回。</p><h2 id="59d1" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">第一步:Python代码</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="1ce2" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">步骤2: Serverless.yml文件</h2><p id="9922" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使用命令行轻松地将这个函数推送到Lambda，我们还将创建一个<code class="fe no np nq nr b">serverless.yml</code>文件。</p><p id="24af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个文件将提供一些参数，比如运行时使用哪种编程语言、区域、您的凭证，以及实际的函数和所需的参数。</p><p id="464d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这有助于配置Lambda函数，因此很容易通过命令行将其推送到云中。</p><p id="77d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的文件是我们将要使用的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="2685" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">第三步:安装无服务器</strong></h2><p id="9f2f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们有了基本的函数和一个<code class="fe no np nq nr b">serverless.yml</code>文件，将这个函数部署到Lambda的下一步是<a class="ae ky" href="https://www.npmjs.com/package/serverless-lambda?activeTab=readme" rel="noopener ugc nofollow" target="_blank"> npm安装无服务器</a>，这将允许您访问<code class="fe no np nq nr b">sls</code>命令。</p><p id="d8c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的命令将帮助您安装此服务。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="5362" class="mz md it nr b gy nw nx l ny nz">npm install -g serverless<br/>npm i -D serverless-dotenv-plugin<br/>sls plugin install -n serverless-python-requirements</span></pre><h2 id="a45f" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">步骤4:部署功能</h2><p id="f8c0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">安装无服务器后，您现在可以访问<code class="fe no np nq nr b">sls</code>命令。这将允许您使用一个命令部署无服务器功能。</p><p id="c954" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，你需要确保你在你的<code class="fe no np nq nr b">serverless.yml</code>和<code class="fe no np nq nr b">test_function.py</code>所在的文件夹中。确保文件夹里只有这些东西。</p><p id="b375" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很重要，因为当您运行deploy命令时，您的整个文件都将被部署。您不希望意外部署500GB的随机文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/b860ef17c4db88250ece8dec8da19dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9D_FuNKXtfgXmtcz-k_dEg.png"/></div></div></figure><p id="fce1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦您确保只有您想要部署的文件在您的文件夹中，您就可以在您的终端中运行下面的命令。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="d4ac" class="mz md it nr b gy nw nx l ny nz">sudo sls deploy</span></pre><p id="28b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之后，<code class="fe no np nq nr b">sls</code>会将您的代码部署到AWS。最终，您应该能够在AWS管理控制台中自动找到它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/008cd79bdf10741d9b5be0d79cb3694d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s9rMXbUebcx934KV0GAAnA.png"/></div></div></figure><p id="6dc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你。您已经启动了第一个无服务器功能。</p><h2 id="66f3" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated"><strong class="ak">步骤5:测试您的功能</strong></h2><p id="2fd9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了测试这个函数，我们将使用一个JSON文件来传递参数。这将代表一个基本的HTTP请求。</p><p id="3819" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个我们称之为<code class="fe no np nq nr b">event.json</code>的文件，你将需要它。请注意，它只有一个“name”参数，但是在将来，您可以使您的无服务器函数变得更加复杂，从而拥有更多的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0968" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦设置了这个JSON文件，就可以使用下面的命令在命令行中测试这个函数。</p><pre class="kj kk kl km gt ns nr nt nu aw nv bi"><span id="5f38" class="mz md it nr b gy nw nx l ny nz">sudo sls invoke — function get-hello — path event.json</span></pre><p id="40a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个函数后，您将得到如下所示的输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/d55b333ac7727dccd861ffc7582eff48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_qO-0i-TYPJmqtj-4tUgA.png"/></div></div></figure><p id="3422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您要在基础架构中实现这种无服务器功能，您将会得到这样的响应。</p><p id="88b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经使用命令行启动并测试了您的第一个Lambda函数。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d989" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">最后的话</h1><p id="9c4d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">AWS Lambda是一个高度可伸缩的、事件驱动的、无服务器的服务，让开发人员可以快速开发功能。软件开发人员可以使用它来创建端点，数据工程师也大量使用它来开发AWS组件之间的数据管道，如<a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3 </a>、<a class="ae ky" href="https://aws.amazon.com/kinesis/" rel="noopener ugc nofollow" target="_blank"> Kinesis </a>和<a class="ae ky" href="https://aws.amazon.com/redshift/" rel="noopener ugc nofollow" target="_blank">红移</a>。</p><p id="421b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Lambda减少开发基础设施所需时间的能力使得Lambda的使用日益流行。更不用说，由于所有这些昂贵的EC2成本，只为函数的每次调用付费的能力使得Lambda成为一个非常诱人的解决方案。</p><p id="22c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总而言之，这种FaaS(功能即服务)对开发者来说非常棒，可以帮助你简化开发过程。</p></div></div>    
</body>
</html>