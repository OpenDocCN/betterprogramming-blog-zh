<html>
<head>
<title>Serverless Cloud: A First Look</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器云:初步观察</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/serverless-cloud-a-first-look-7abb3cd04cf7?source=collection_archive---------11-----------------------#2022-03-25">https://betterprogramming.pub/serverless-cloud-a-first-look-7abb3cd04cf7?source=collection_archive---------11-----------------------#2022-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b945" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">知道使用无服务器云可以做什么吗</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cc5ce1569c6c50c7e1ea29a3932e9048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zwtLMbhRt7JA-kyC"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@bendavisual?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本杰明·戴维斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="66e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器云第一次引起我的注意是在2021年无服务器峰会期间，当时AWS无服务器英雄<a class="ae kv" href="https://www.jeremydaly.com/" rel="noopener ugc nofollow" target="_blank">杰里米·戴利</a>展示了他一直在帮助自己构建的产品。</p><p id="e8af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于任何对无服务器感兴趣的人来说，如果他之前没有遇到过杰里米，我肯定他不会介意我链接到他的内容，我强烈建议订阅他的时事通讯“Off-by-none ”,过去几年我一直用它来了解无服务器世界。</p><p id="a3d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们回答房间里的大象:什么是无服务器云？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/4b31a7c5c1b2e5df4b6f01a363fa7cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*C2geiB0p4m2QxECBgvchrg.png"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="28db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器云允许您构建您的应用程序，而不必担心云服务的创建和管理，让开发人员有更多时间专注于他们最擅长的事情；写代码。它通过一个接口抽象云服务来做到这一点，您可以将该接口作为依赖项添加到您的应用程序中，让无服务器云来完成所有繁重的工作。</p><p id="1282" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器云还提供了一个仪表板，允许您使用现成的指标和日志来监控您的应用程序。它还允许您直接从仪表板调用您的端点，从而不再需要像Postman这样的工具来执行相同的功能。</p><p id="6471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在到了有趣的部分:我可以用无服务器云做什么？</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="0c38" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">储存；储备</h1><p id="37ef" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">无服务器存储使您能够存储文件，而不必将基础架构编写为代码代码来自己创建和管理S3存储桶，您甚至不需要将存储桶的链接传递到您的应用程序中。</p><p id="a447" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">存储是现代软件应用程序中非常常见的用例。在下面的例子中，你可以看到我调用存储API来存储一个雇员的简历，并获取我在响应中返回的文件的下载URL。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="7ada" class="nc mb iq my b gy nd ne l nf ng">import { api, data, storage, schedule, events } from "@serverless/cloud";</span><span id="93ee" class="nc mb iq my b gy nh ne l nf ng">api.post("/employees/:id/cv", async (req, res) =&gt; {</span><span id="db91" class="nc mb iq my b gy nh ne l nf ng">let key = "employee:" + req.params.id;<br/>let employee = await data.get(key);<br/>let filepath: string = '/cv/' + req.params.id + '.txt';</span><span id="c428" class="nc mb iq my b gy nh ne l nf ng">await storage.write(filepath, req.body);</span><span id="f4fc" class="nc mb iq my b gy nh ne l nf ng">let downloadUrl = await storage.getDownloadUrl(filepath);   employee.cvUrl = downloadUrl;</span><span id="03b6" class="nc mb iq my b gy nh ne l nf ng">await data.set(key, employee, true);</span><span id="2ee2" class="nc mb iq my b gy nh ne l nf ng">res.send({ downloadUrl });<br/>});</span></pre><p id="c2a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">storage service的另一个很酷的特性是能够为bucket中的任何变化添加监听器。这非常酷，你通常必须在你的配置中处理这些事件，例如当你的桶中有任何变化时调用一个lambda。</p><p id="968a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码会在我的bucket中存储带有前缀<code class="fe ni nj nk my b">cv</code>的文件时写一条日志消息。您可以使用此功能来构建异步任务的管道，例如，在从应用程序中检索文件之前，扫描上传的文件中的病毒或编辑文件中的敏感数据。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="99ad" class="nc mb iq my b gy nd ne l nf ng">import { api, data, storage, schedule, events } from "@serverless/cloud";</span><span id="fcd0" class="nc mb iq my b gy nh ne l nf ng">storage.on("write:cv/*", async (event) =&gt; { </span><span id="25dc" class="nc mb iq my b gy nh ne l nf ng">console.log('File has been uploaded, scanning for virus: ' + event.path);</span><span id="987a" class="nc mb iq my b gy nh ne l nf ng">});</span></pre><p id="a531" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里看到存储服务<a class="ae kv" href="https://www.serverless.com/cloud/docs/apps/blob-storage" rel="noopener ugc nofollow" target="_blank">的其他功能。</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="f390" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">数据</h1><p id="ab3e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">无服务器数据使您能够将应用程序数据存储在键/值数据存储中，而不必管理数据库访问、维护、调整，甚至不必将连接字符串传递给应用程序。</p><p id="3ae9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据是软件的基石，因此通过调用方法来存储和检索应用程序数据有可能减少团队的大量开发时间。在下面的例子中，你可以看到我是如何检索所有雇员的列表、获取单个雇员并存储一个雇员的。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e3b9" class="nc mb iq my b gy nd ne l nf ng">import { api, data, storage, schedule, events } from "@serverless/cloud";<br/>import { Employee } from "./models/Employee";<br/>import { v4 as uuidv4 } from 'uuid';</span><span id="652e" class="nc mb iq my b gy nh ne l nf ng">api.get("/employees", async (req, res) =&gt; {</span><span id="620c" class="nc mb iq my b gy nh ne l nf ng">let result = await data.get("employee:*", true);</span><span id="992f" class="nc mb iq my b gy nh ne l nf ng">res.send({ employees: result.items });<br/>});</span><span id="f5f6" class="nc mb iq my b gy nh ne l nf ng">api.get("/employees/:id", async (req, res) =&gt; {<br/>let key = "employee:" + req.params.id;</span><span id="b565" class="nc mb iq my b gy nh ne l nf ng">let result = await data.get(key);</span><span id="a5ba" class="nc mb iq my b gy nh ne l nf ng">res.send({ employee: result });<br/>});</span><span id="7aa6" class="nc mb iq my b gy nh ne l nf ng">api.post("/employees", async (req, res) =&gt; {<br/>let employee: Employee = req.body;<br/>let id: number = uuidv4();</span><span id="cab9" class="nc mb iq my b gy nh ne l nf ng">await data.set('employee:' + id, employee);</span><span id="3580" class="nc mb iq my b gy nh ne l nf ng">events.publish("employee.created", {    name: employee.name  });</span><span id="051b" class="nc mb iq my b gy nh ne l nf ng">res.send({ employeeId: id });<br/>});</span></pre><p id="09ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里看到数据服务<a class="ae kv" href="https://www.serverless.com/cloud/docs/apps/data" rel="noopener ugc nofollow" target="_blank">的其他特性。</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="10a1" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">事件</h1><p id="2ed3" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">无服务器事件允许您发布事件，然后异步处理它们，可以立即处理，也可以在一段时间后处理。同样，这允许您构建任务的异步管道，而不必创建队列和配置lambda调用。</p><p id="db45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下面的例子中，您可以看到我是如何在创建一个员工时发布一个事件，然后异步获取该事件的。您可以使用它来发送欢迎电子邮件，或者让应用程序的其他集成(如工资系统)知道这个新员工已经创建。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="554d" class="nc mb iq my b gy nd ne l nf ng">import { api, data, storage, schedule, events } from "@serverless/cloud";<br/>import { Employee } from "./models/Employee";<br/>import { v4 as uuidv4 } from 'uuid';</span><span id="3ef4" class="nc mb iq my b gy nh ne l nf ng">api.post("/employees", async (req, res) =&gt; {<br/>let employee: Employee = req.body;<br/>let id: number = uuidv4();</span><span id="624a" class="nc mb iq my b gy nh ne l nf ng">await data.set('employee:' + id, employee);</span><span id="9e19" class="nc mb iq my b gy nh ne l nf ng">events.publish("employee.created", {    name: employee.name  });</span><span id="2709" class="nc mb iq my b gy nh ne l nf ng">res.send({ employeeId: id });<br/>});</span><span id="e8b4" class="nc mb iq my b gy nh ne l nf ng">events.on("employee.created", async ({ body }) =&gt; {  </span><span id="6e8d" class="nc mb iq my b gy nh ne l nf ng">console.log('Send welcome email to ' + body.name);</span><span id="ea2f" class="nc mb iq my b gy nh ne l nf ng">});</span></pre><p id="0ec0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里看到事件服务<a class="ae kv" href="https://www.serverless.com/cloud/docs/apps/events" rel="noopener ugc nofollow" target="_blank">的其他特性。</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="88a2" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">计划任务</h1><p id="b530" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们都参与过需要运行cron作业来运行清理脚本或触发数据更新的项目。有了无服务器云，您只需定义一个函数，就可以随时运行，无需配置cron作业在您的环境中运行。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e205" class="nc mb iq my b gy nd ne l nf ng">import { api, data, storage, schedule, events } from "@serverless/cloud";</span><span id="2e61" class="nc mb iq my b gy nh ne l nf ng">schedule.every("1 day", () =&gt; {</span><span id="6a56" class="nc mb iq my b gy nh ne l nf ng">console.log("Doing some sort of cleanup task every night!");</span><span id="05de" class="nc mb iq my b gy nh ne l nf ng">});</span></pre><p id="b400" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在这里看到调度任务服务<a class="ae kv" href="https://www.serverless.com/cloud/docs/apps/schedule" rel="noopener ugc nofollow" target="_blank">的其他特性。</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="a94d" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">应用和实例</h1><p id="02cb" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">无服务器云遵循隔离模型。你有一个组织，你可以在其中创建许多应用程序，这些应用程序可以是多栈或独立的服务。每个应用程序可以有许多实例，一个实例可以是一个环境，如生产或测试环境，每个实例都有自己的一组资源，如数据和存储。</p><p id="301d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法让你在几秒钟内就可以在云中运行你的应用程序，几乎快得令人难以置信。</p><p id="c211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想要在云中运行您的应用程序吗？只需键入<code class="fe ni nj nk my b">cloud</code></p><p id="d3d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想要与团队成员分享您的当前状态以进行测试吗？只需输入<code class="fe ni nj nk my b">cloud share</code></p><p id="fd02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想要部署到测试环境吗？只需键入<code class="fe ni nj nk my b">cloud deploy test</code></p><p id="0748" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想要将测试环境中的应用程序版本升级到生产环境中吗？只需键入<code class="fe ni nj nk my b">cloud promote test prod</code></p><p id="afe5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这几乎太容易了。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="3af3" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">当前的限制</h1><p id="1c98" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">无服务器云仍在开发中(撰写本文时版本为2.8.2 ),因此仍有许多功能尚未推出，所以我希望在未来的版本中看到以下内容:</p><ul class=""><li id="fc55" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">能够选择部署云服务的区域。目前，所有数据都存储在<code class="fe ni nj nk my b">us-east-1</code>地区，但是许多公司可能会受到法律约束，不得将数据传输到其所在国家/地区之外，因此他们无法使用无服务器云。</li><li id="a34b" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">组织内部的细粒度访问控制。目前，您存储应用程序和数据的组织内没有基于角色的访问控制，这意味着如果您想要锁定对生产数据的访问，您必须创建一个单独的组织来托管它，这将允许您使用cool promote功能。</li><li id="ac49" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">对底层云资源的访问。我认为无服务器云面临的最大挑战之一是建立一种声誉，让顾客、客户和企业在移交数据控制权时感到安全。我认为需要有一个中间地带，客户可以在需要时访问底层云服务。</li></ul></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="877a" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">最后的想法</h1><p id="48b0" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我非常喜欢使用无服务器云的体验，我将继续使用它来部署个人和概念验证应用程序。在未来，我希望上述几点能够得到解决，这将使我能够在组织内推动无服务器云的使用。</p><p id="7e23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想看看上面链接的项目代码，你可以在这里找到<a class="ae kv" href="https://github.com/shaunganley/serverless-cloud-typescript-api-demo" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="705a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器云有一个很棒的Slack社区，它会很乐意回答你的任何问题，解决你可能遇到的任何问题，你可以在这里加入那个<a class="ae kv" href="https://serverless-contrib.slack.com/join/shared_invite/zt-d5qzowja-pnOerTzAIZUrN18hWYUIHA" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="ccbe" class="nc mb iq my b gy nd ne l nf ng"><strong class="my ir">Want to Connect?</strong></span><span id="8eda" class="nc mb iq my b gy nh ne l nf ng">If you have any comments about this blog or want to have a chat you can find me on LinkedIn <a class="ae kv" href="https://www.linkedin.com/in/shaun-ganley-8068aa82/" rel="noopener ugc nofollow" target="_blank">here</a>.</span></pre></div></div>    
</body>
</html>