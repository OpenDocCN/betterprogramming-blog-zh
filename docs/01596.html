<html>
<head>
<title>Use GraphQL Query Hooks With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用带有React的GraphQL查询挂钩</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/use-graphql-query-hooks-with-react-d440c6dcb57d?source=collection_archive---------15-----------------------#2019-09-26">https://betterprogramming.pub/use-graphql-query-hooks-with-react-d440c6dcb57d?source=collection_archive---------15-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="029a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">钩子减少了React应用程序的样板文件，同样的事情也可以用React为Apollo做</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c026dc95a1b8b9d3e299beca8d47c144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VXJ-uRGa58_Bsk_TLddoqA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">https://unsplash.com/photos/c0VRNWVEjOA<a class="ae ky" href="https://unsplash.com/photos/c0VRNWVEjOA" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="fb7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GraphQL和Apollo<strong class="lb iu">T5是与React一起使用的很好的工具组合！GraphQL 使得从服务器获取、修改或获得实时数据变得更加容易。它也是完全开源的标准。</strong></p><p id="227a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/apollographql/react-apollo" rel="noopener ugc nofollow" target="_blank"> Apollo </a>提供了一套简单的工具来实现React中与GraphQL相关的一切，它也是GitHub上托管的开源工具。</p><p id="c2ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，Apollo发布了一个<a class="ae ky" href="https://blog.apollographql.com/apollo-client-now-with-react-hooks-676d116eeae2" rel="noopener ugc nofollow" target="_blank">更新</a>，引入了React挂钩，这大大减少了使用GraphQL所需的代码，使得在React中使用<a class="ae ky" href="https://blog.apollographql.com/apollo-client-now-with-react-hooks-676d116eeae2?gi=23e6c378834c" rel="noopener ugc nofollow" target="_blank">查询、订阅和变异</a>简单了十倍。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dbc1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">决赛成绩</h1><p id="508c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将建立一个简单的网页，按照时间顺序列出所有的星球大战电影:</p><ul class=""><li id="19be" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">前端将是一个用阿波罗客户端制作的<a class="ae ky" href="https://github.com/Giorat/graphql_react_hooks/tree/master/" rel="noopener ugc nofollow" target="_blank"> React app。</a></li><li id="d5ed" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">后端将是一个公共的GraphQL星球大战API。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd"><div class="gh gi nn"><img src="../Images/789ac80360e203dcd4a77f072d439b2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_zS0lG_BjFUS8BhNV8ihA.png"/></div></a></figure><p id="c001" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在此获得最终应用程序:</p><ul class=""><li id="5511" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><a class="ae ky" href="https://github.com/Giorat/graphql_react_hooks/tree/master/" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="a244" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">代码沙盒</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9edfd5a41e9c2e22de9c27aee7a2c781.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/0*Sel-BrKGGUaPBnrB.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8572" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">先决条件</h1><p id="f692" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你需要一个可用的React应用程序，你可以从以下样板文件中找到一个:</p><ul class=""><li id="e237" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><a class="ae ky" href="https://codesandbox.io/s/l4w3o6my59" rel="noopener ugc nofollow" target="_blank">使用反应脚本</a>进行反应。</li><li id="a060" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://codesandbox.io/s/03jy316xqp" rel="noopener ugc nofollow" target="_blank">使用包裹</a>进行反应。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d70d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">阿波罗依赖</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6581cbe23af4f59b2bd309777241cb2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/0*wsMoJC24G1ArJJY0.png"/></div></figure><p id="7d9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Apollo需要一些依赖项来提供GraphQL所需的所有工具，您需要打开终端并键入:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="c115" class="nv md it nr b gy nw nx l ny nz">npm install apollo-boost @apollo/react-hooks graphql</span></pre><p id="86a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些软件包带来的功能有:</p><ul class=""><li id="4479" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><code class="fe oa ob oc nr b">apollo-boost</code>:包含设置Apollo客户端所需的一切的包。</li><li id="22e7" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe oa ob oc nr b">@apollo/react-hooks</code>:基于React Hooks的视图层集成。</li><li id="dba7" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><code class="fe oa ob oc nr b">graphql</code>:解析你的GraphQL查询。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8174" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">阿波罗客户端</h1><p id="3106" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了在我们的项目中启用Apollo，我们创建了一个Apollo客户端，并使用<code class="fe oa ob oc nr b">ApolloProvider</code>将其注入到我们的组件树中:</p><ul class=""><li id="cf3a" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">在本例中，我们使用远程GraphQL的URL创建客户端:<a class="ae ky" href="https://api.graph.cool/simple/v1/swapi" rel="noopener ugc nofollow" target="_blank">https://API . graph . cool/simple/v1/swapi</a>。你可以在第十行看到它。</li><li id="7c67" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">然后，我们添加了<code class="fe oa ob oc nr b">ApolloProvider</code>，它的强大之处在于，客户端将在app组件内的每个组件上自动作为单例被传递。</li></ul><p id="083f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oa ob oc nr b"><a class="ae ky" href="https://github.com/Giorat/graphql_react_hooks/blob/master/src/index.js" rel="noopener ugc nofollow" target="_blank">src/index.js</a></code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a84f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我应该查询什么？</h1><p id="0992" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">添加客户端后，我们需要考虑我们可能希望从这个GraphQL端点<a class="ae ky" href="https://api.graph.cool/simple/v1/swapi" rel="noopener ugc nofollow" target="_blank">请求哪些数据，我们可以在那里轻松完成。</a></p><p id="1e1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能想要请求前三部或六部电影，更改参数“first”，然后选择不同的信息，如标题或上映日期。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://api.graph.cool/simple/v1/swapi"><div class="gh gi og"><img src="../Images/6ef56c17a037be986774e29c494ebfd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LfV-ssZSof4e_EralGQ1LA.png"/></div></a></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3c7a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">获取并显示数据</h1><p id="06bf" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">然后，我们必须进行最后，也是最漂亮的一步:</p><ul class=""><li id="53e9" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">首先，我们声明在上一部分中创建的查询，以在第6到13行获得前六部电影作为常量变量<code class="fe oa ob oc nr b">STAR_WARS_FILMS</code> <strong class="lb iu"> </strong>。</li><li id="5021" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">我们在第18行应用了<code class="fe oa ob oc nr b">useQuery</code>，在重命名为<code class="fe oa ob oc nr b">dataFilms</code>的数据变量中取回电影的数据，使其更具可读性。然后我们使用<code class="fe oa ob oc nr b">dataFilms</code>作为一个简单的JavaScript数组。</li><li id="3967" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">我们在渲染返回中显示这些标题或信息。</li><li id="7bbf" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">您还可以使用error或loading变量来了解来自服务器的数据是正在加载还是返回了错误。</li></ul><p id="d7dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oa ob oc nr b"><a class="ae ky" href="https://github.com/Giorat/graphql_react_hooks/blob/master/src/App.js" rel="noopener ugc nofollow" target="_blank">src/App.js</a></code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="e0b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧！我们的<a class="ae ky" href="https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd" rel="noopener ugc nofollow" target="_blank">应用</a>现在运行得非常好！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd"><div class="gh gi oh"><img src="../Images/ff8c9947b2de2c4c11b9e62068e430f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*7NajZZsJW0rZtSkYdfKc-g.png"/></div></a><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd" rel="noopener ugc nofollow" target="_blank">https://code sandbox . io/s/graph QL-hooks-with-react-16-ixnpdhttps://851 JM . csb . app/</a></p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="731e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如果你想了解更多关于钩子的知识</h1><p id="ee54" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当我开始使用钩子时，我曾亲自阅读过React钩子，它帮助我理解它们如何使用工具，例如来自Apollo React的工具</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3faa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考资料和资源</h1><ul class=""><li id="7d95" class="mz na it lb b lc mu lf mv li oi lm oj lq ok lu ne nf ng nh bi translated"><a class="ae ky" href="https://api.graph.cool/simple/v1/swapi" rel="noopener ugc nofollow" target="_blank">https://API . graph . cool/simple/v1/swapi</a></li><li id="1546" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/graphql-hooks-with-react-16-ixnpd</a></li><li id="7ed5" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://github.com/Giorat/graphql_react_hooks/tree/master/" rel="noopener ugc nofollow" target="_blank">https://github.com/Giorat/graphql_react_hooks/tree/master/</a></li><li id="a4d3" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://www.graphqlbin.com/v2/6RQ6TM" rel="noopener ugc nofollow" target="_blank">https://www.graphqlbin.com/v2/6RQ6TM</a></li><li id="6782" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://codesandbox.io/s/graphql-query-in-react-ixnpd" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/graphql-query-in-react-ixnpd</a></li><li id="0e8e" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://www.apollographql.com/docs/react/" rel="noopener ugc nofollow" target="_blank">https://www.apollographql.com/docs/react/</a></li><li id="4009" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://amzn.to/2Y8hoX9" rel="noopener ugc nofollow" target="_blank">https://amzn.to/2Y8hoX9</a></li></ul></div></div>    
</body>
</html>