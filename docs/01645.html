<html>
<head>
<title>How To Optimise Angular Bundle Size When Using Font Awesome</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用字体Awesome时如何优化角度束大小</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-optimise-angular-bundle-size-if-you-use-font-awesome-ef774f629c35?source=collection_archive---------5-----------------------#2019-10-01">https://betterprogramming.pub/how-to-optimise-angular-bundle-size-if-you-use-font-awesome-ef774f629c35?source=collection_archive---------5-----------------------#2019-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0935" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有两种方法可以让你的包裹体积缩小两倍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a64643ef601dd9f12f3af92a6cb41e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efpYs8lEEUB7cGhQnKCZkQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@balazsketyi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Balázs Kétyi </a>在<a class="ae ky" href="https://unsplash.com/s/photos/icons?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="95b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">TL；</strong> : <code class="fe lv lw lx ly b">addIconPacks</code>博士不好。这将花费你1Mb以上的空间(压缩)。<code class="fe lv lw lx ly b">addIcons</code>好。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="7a1f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">棱角分明的字体真棒</h1><p id="4ede" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">大家都喜欢<a class="ae ky" href="https://fontawesome.com/" rel="noopener ugc nofollow" target="_blank">字体牛逼</a>图标库。它有一个令人敬畏的名字，图标做得非常好，他们的网站简单而酷。所以，长话短说，我们说服我们的项目经理买了一个pro-pack，并开始在任何地方使用它。我们更喜欢SVG图标，因为它们在任何地方都受支持，而且非常容易编写，因此可以创建更多的图标。我们使用Angular作为框架，所以很自然地，我们得到了一个官方的<a class="ae ky" href="https://github.com/FortAwesome/angular-fontawesome" rel="noopener ugc nofollow" target="_blank"> angular-fontawesome </a>库。</p><p id="eee7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该库添加了一个<code class="fe lv lw lx ly b">fa-icon</code>组件，并允许您以如下方式使用图标:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="da20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的想法是<em class="nf">好吧，让我们添加它并开始使用它，它可能会处理树抖动等问题</em>。因此，我们创建了一个图标模块，并像这样导入图标包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="f8dc" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">问题是</h1><p id="3cb2" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">每当我向一个项目添加一个新的库时，以及每隔几周，我通常会做一次包大小检查。为此，我使用了webpack Bundle Analyzer，这是一个很棒的工具，可以可视化所有模块的大小。我是这样运行的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d7ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令我惊讶的是，当我查看统计数据时，我发现字体Awesome占了包的很大一部分！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/3ad7e9a39be0a7736e6cd35918334916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bX5EI-6qAynp_O2ucBA6Fg.png"/></div></div></figure><p id="a639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你不必像唐纳德·克努特一样明白<code class="fe lv lw lx ly b">icons.module.ts</code>可能会使用一些优化。1.9 Mb的gzipped，对于我们在一个项目中使用的大约60个SVG图标来说太多了。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="fa4e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">解决方案</h1><p id="9989" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">长话短说，<code class="fe lv lw lx ly b">addIconsPack</code>并没有做一个很好的摇树工作。所以，除非你打算在你的项目中使用成千上万个不同的图标，否则你需要清除它们。有两种主要的方法来导入图标。</p><h2 id="85de" class="nh mh it bd mi ni nj dn mm nk nl dp mq li nm nn ms lm no np mu lq nq nr mw ns bi translated">含蓄的方法</h2><p id="d780" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用隐式方法，您将删除模块文件中的<code class="fe lv lw lx ly b">FaIconLibrary.addIconsPack</code>，然后使用<code class="fe lv lw lx ly b">FaIconLibrary.addIcons</code>函数列出您使用的图标，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="af3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意我是如何从包中导入图标的:<code class="fe lv lw lx ly b">import {faBalanceScale} from ‘<a class="ae ky" href="http://twitter.com/fortawesome/pro-solid-svg-icons" rel="noopener ugc nofollow" target="_blank">@fortawesome/pro-solid-svg-icons</a>’</code>而不是<code class="fe lv lw lx ly b">import {faBalanceScale} from ‘<a class="ae ky" href="http://twitter.com/fortawesome/pro-solid-svg-icons" rel="noopener ugc nofollow" target="_blank">@fortawesome/pro-solid-svg-icons</a>/faBalanceScale’</code>。两种方式都是完全合法的，而且都是完全可以动摇的。第一种方法更容易阅读，它不依赖于实现，并且需要输入的符号更少，所以我们将坚持使用它。</p><p id="9588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这种方法，你可以像以前一样继续使用你的图标，使用字符串常量，比如<code class="fe lv lw lx ly b">&lt;fa-icon [icon]=”[‘fas’, ‘coffee’]” size=”xs”&gt;&lt;/fa-icon&gt;</code>。请注意，如果您忘记在模块中添加某个图标，没有人会在编译时通知您这个错误。运行时控制台会弹出错误，大家看到的是空白的地方，而不是你漂亮的图标。</p><p id="ae7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，确保你总是看结果和测试你的代码，咄。这是我们应用这种优化时包大小的差异(所有大小都以Mb为单位)。请注意，<strong class="lb iu"> Stats </strong>列具有连接、缩小和树抖动发生之前的原始大小。<strong class="lb iu">解析后的</strong>是拼接、缩小、树抖动后的大小。<strong class="lb iu"> Gzipped </strong>是用gzip算法压缩的最终结果。我们的包大小现在小了两倍——对于仅仅一个优化来说还不错。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/8c16d1df8521c99dd2ffd3dfaef0bcd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*75G8e-xQwzqqt7VJ.png"/></div></div></figure><h2 id="be17" class="nh mh it bd mi ni nj dn mm nk nl dp mq li nm nn ms lm no np mu lq nq nr mw ns bi translated">显式方法</h2><p id="11c7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">显式方法要求您停止使用图标名称的字符串常量，转而使用您将在组件中导入的图标变量。因此<code class="fe lv lw lx ly b">[icon]=”[‘fas’, ‘coffee’]</code>将成为模板中的<code class="fe lv lw lx ly b">[icon]="faCoffee"</code>，并且您将在组件类中创建一个新的字段<code class="fe lv lw lx ly b">faCoffee</code>。</p><p id="f48c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显式方法遵循TypeScript的精神，并允许您的IDE快速查看使用某个图标的所有代码片段，而不依赖于自由文本搜索。现在所有的错误都会在编译时被报告，只要你总是使用显式方法。</p><p id="a137" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不利的一面是，你将在每个使用图标的组件中结束大量的代码，这将导致包的大小稍微大一点，而且看起来不太舒服。</p><p id="0ecf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我在我们的项目中应用显式方法后得到的结果，我们使用了大约70个不同的图标(大小以Mb为单位)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/3fa2e80fec433da65d4b565051a51520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YP4ajOQd8AFRkKVK.png"/></div></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="2a4b" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">分析</h1><p id="1ab6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我试图证明不应该使用方法<code class="fe lv lw lx ly b">IconLibrary.addIconsPack</code>,因为它会导致包大小膨胀。为了解决这个问题，你应该单独导入图标，我们看到了两种主要的方法。</p><p id="683e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，隐式方法带来了更好的压缩效果。根据您的项目，您可能更喜欢显式方法，尤其是如果您有一个大项目，并且图标集总是在变化。</p><p id="4b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进一步优化:对于真正大的应用程序，你可能想创建多个图标惰性模块，只把它们导入你需要它们的地方。</p></div></div>    
</body>
</html>