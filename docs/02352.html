<html>
<head>
<title>Redux Setup for Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React应用程序的Redux设置</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/redux-setup-for-your-react-app-d003ec03aedf?source=collection_archive---------8-----------------------#2019-11-25">https://betterprogramming.pub/redux-setup-for-your-react-app-d003ec03aedf?source=collection_archive---------8-----------------------#2019-11-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="99cd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何开始使用减速器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f90c35636c10bee5167aa38425b91218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T_-NaFaHus_yTblauq3QWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">归功于<a class="ae ky" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank">https://redux.js.org/</a></p></figure><p id="07d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本指南将涵盖你的<a class="ae ky" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a>应用的基本和简单的设置。本指南不会深入解释Redux的概念。让我们从安装几个库开始:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="42e7" class="ma mb it lw b gy mc md l me mf">npm install redux</span><span id="8e4a" class="ma mb it lw b gy mg md l me mf">npm install react-redux</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="e736" class="mo mb it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">1.创建一个教育工作者文件夹</h1><p id="a7f4" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">在<code class="fe nk nl nm lw b">src</code>文件夹中，创建一个名为<code class="fe nk nl nm lw b">reducers</code>的文件夹。在reducers文件夹中，创建一个名为<code class="fe nk nl nm lw b">reducer.js</code>的文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/87198188b11192eae102ed4a7c0e2c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*0e7fsOitRaVc27Hm9iQ2xQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">反应文件结构</p></figure><p id="31b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nk nl nm lw b">reducer.js</code>文件中，我们将定义两件事:</p><ol class=""><li id="f3b2" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated"><code class="fe nk nl nm lw b">defaultState</code>。</li><li id="4da7" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><code class="fe nk nl nm lw b">reducer</code>功能。</li></ol><p id="92b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm lw b">defaultState</code>将包含我们想要存储的字段。在本例中，我们只想存储当前用户。</p><p id="52f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm lw b">reducer</code>函数将接受两个参数:</p><ul class=""><li id="c536" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu oc nu nv nw bi translated"><code class="fe nk nl nm lw b">state</code>，它将默认为我们定义的<code class="fe nk nl nm lw b">defaultState</code>。</li><li id="4974" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu oc nu nv nw bi translated"><code class="fe nk nl nm lw b">action</code>，表示将要发送的派单。</li></ul><p id="b25a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">动作本身将表示一个带有两个键的对象:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7a06" class="ma mb it lw b gy mc md l me mf">{</span><span id="db2c" class="ma mb it lw b gy mg md l me mf">   action: "SAMPLE",<br/>   payload: data</span><span id="8b07" class="ma mb it lw b gy mg md l me mf">}</span></pre><p id="869c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm lw b">switch</code>语句在减速器功能中是有益的。随着app变大，会有不同的动作类型。根据动作类型，将返回一个对象。</p><p id="60ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了分解被返回的对象，它将包含前一状态的内容，改变一个键的值。在这种情况下，动作<code class="fe nk nl nm lw b">“SET_USER”</code>将改变<code class="fe nk nl nm lw b">currentUser</code>值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/038ffdb42af4b590711d6006c7b9a989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hivgXrSgfrPTjremPRifeA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">reducer.js</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="99cb" class="mo mb it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">2.在index.js文件中实现Redux</h1><p id="dc9b" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">我们将把以下内容导入到我们的<code class="fe nk nl nm lw b">index.js</code>中:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3f8d" class="ma mb it lw b gy mc md l me mf">import {Provider} from 'react-redux';</span><span id="f3e6" class="ma mb it lw b gy mg md l me mf">import {createStore} from 'redux'</span><span id="a768" class="ma mb it lw b gy mg md l me mf">import reducer from './reducers/reducer'</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/dc55d3f6e9a2cf892e13b23092e77a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCiRk0iG0dkfkesOaLYQxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">索引. js</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="e279" class="mo mb it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">3.连接组件</h1><p id="5a65" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">现在，我们将想要的组件连接到我们在<code class="fe nk nl nm lw b">index.js</code>中创建的商店。我们将重点关注<code class="fe nk nl nm lw b">App</code>组件。使用<a class="ae ky" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank"> React Redux </a>中的连接方法包装组件。</p><p id="8e7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们导入:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e288" class="ma mb it lw b gy mc md l me mf">import {connect} from 'react-redux'</span></pre><p id="5caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并连接组件:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6b5c" class="ma mb it lw b gy mc md l me mf">export default connect()(App)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/3c1330fb3e88067c7519871e5098af25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmnW4b4Btv8p5gl5HfYGsA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">App.js</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="ed0f" class="mo mb it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">4.将状态映射到道具</h1><p id="d3e5" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">一旦我们建立了一个连接，让我们将状态作为道具添加到这个组件中。在<code class="fe nk nl nm lw b">App</code>组件中，让我们创建一个名为<code class="fe nk nl nm lw b">mapStateToProps</code>的函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/12be558253499633c28fb13bc78c8872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bRYa2RRzOUpI_vf3HPGbug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mapStateToProps</p></figure><p id="693f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将键<code class="fe nk nl nm lw b">currentUser</code>添加到props中，并将其设置为状态值<code class="fe nk nl nm lw b">currentUser</code>。我建议保持名字相似。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="8fe9" class="mo mb it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">5.地图分派到道具</h1><p id="28b5" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">现在，让我们更改state中的值。我们在<code class="fe nk nl nm lw b">App</code>内部设置了另一个函数，名为<code class="fe nk nl nm lw b">mapDispatchToProps</code>。</p><p id="9084" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于<code class="fe nk nl nm lw b">mapStateToProps</code>，我们返回一个对象，但是<code class="fe nk nl nm lw b">setUser</code>的键被设置为一个函数的值，这个函数将发送一个调度给reducer。</p><p id="ae0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个实例中，当我们通过props调用<code class="fe nk nl nm lw b">setUser</code>时，它需要一个使用回调函数<code class="fe nk nl nm lw b">dispatch</code>的用户对象参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/8ca9bb1bab277d99b4c6d85ddb493fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iVMrLY7u3NtzJoUDunS8FQ.png"/></div></div></figure><p id="9ca5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这调用了<em class="oi">减速器功能</em>，我们在前面的<code class="fe nk nl nm lw b">reducer.js</code>中设置了这个功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/eb8eb87a3717a558b5bed11de03cd388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x92dvzxidtiwtCxtkLPtyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">减速器功能</p></figure><p id="9332" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在<code class="fe nk nl nm lw b">App</code>组件已经连接，让我们通过在<code class="fe nk nl nm lw b">App</code>加载时改变我们状态下的<code class="fe nk nl nm lw b">currentUser</code>值来测试它。</p><p id="3c46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在app中，我们添加<code class="fe nk nl nm lw b">componentDidMount</code>，调用<code class="fe nk nl nm lw b">setUser</code>函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/dc3a544e87623617c1cd477010db8f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64yy5eKuR9wkd7F-kXUT6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">组件安装</p></figure><p id="21b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在页面加载时，<code class="fe nk nl nm lw b">setUser</code>被调用，它接受定义的用户对象，并被重定向到<code class="fe nk nl nm lw b">reducer.js</code>中的reducer函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/22944e4087c28c20de90cad4e41d48e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kw1PEyR9QU3H6mdpQkX6SA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">减速器功能与动作内容</p></figure><p id="1878" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的初始状态<code class="fe nk nl nm lw b">currentUser</code>被设置为一个空对象。要查看更改，让我们从<code class="fe nk nl nm lw b">App</code>组件中注销状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/85b9ea7cf5d6c2e5806f7f4cf9a4010a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sj_ocD2KKhix9KAEeH1iWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">应用程序组件呈现</p></figure><p id="e5a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们运行应用程序:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="755a" class="ma mb it lw b gy mc md l me mf">npm run start</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/9f4d693dcb9490583806b3192bb5400f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xebm6VHTZd3O8TKUbsTUeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从状态注销当前用户</p></figure><p id="da89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你知道了。<code class="fe nk nl nm lw b">App</code>组件连接到<a class="ae ky" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>存储。</p><p id="b6a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在特定组件只需要<em class="oi">将分派映射到属性</em>而不需要<em class="oi">将状态映射到属性</em> <strong class="lb iu">、</strong>的情况下，连接的结构必须稍有不同。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="97b5" class="ma mb it lw b gy mc md l me mf">export default (null, mapDispatchToProps)(App)</span></pre><p id="ba0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Connect期望结构的第一个参数是<code class="fe nk nl nm lw b">mapStateToProps</code>，第二个参数是<code class="fe nk nl nm lw b">mapDispatchToProps</code>。不能将地图分派到道具作为唯一或第一个参数。</p><p id="f315" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。代码请参考我的GitHub库:</p><div class="oo op gp gr oq or"><a href="https://github.com/reireynoso/react-redux-practice" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">reireynoso/react-redux-练习</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">这个项目是用Create React App引导的。在项目目录中，您可以运行:在…中运行应用程序</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">github.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div></div></div>    
</body>
</html>