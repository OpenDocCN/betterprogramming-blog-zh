<html>
<head>
<title>SwiftUI Previews: How to Validate Views in Different States</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI预览:如何在不同状态下验证视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swiftui-previews-how-to-validate-views-in-different-states-9f0d7cfc26ad?source=collection_archive---------18-----------------------#2020-04-14">https://betterprogramming.pub/swiftui-previews-how-to-validate-views-in-different-states-9f0d7cfc26ad?source=collection_archive---------18-----------------------#2020-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="073b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">充分利用SwiftUI预览</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/58eb74fba4d331107db1b4fe0f9a62b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q96wapiTqq4bC7MlaDyRPg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">沃纳·杜·普莱西斯在<a class="ae ky" href="https://unsplash.com/s/photos/future?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e77d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI预览让我们的开发速度大大加快，因为我们现在可以在Xcode中实时预览视图。每当我们更改一段代码时，我们的预览就会更新，显示所呈现的更改。</p><p id="2a50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们开发一个不同状态有不同外观的视图时，能够同时预览多个状态是很有帮助的。如果你意识到你可以用现有应用程序的<a class="ae ky" href="https://www.avanderlee.com/xcode/xcode-previews/" rel="noopener ugc nofollow" target="_blank"> UIKit视图做同样的事情，那么知道如何用Xcode预览做这件事就更有价值了。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b028" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Xcode中SwiftUI预览的默认状态</h1><p id="2e19" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本例中，我们将检查我们为Collect by WeTransfer应用程序定义的共享按钮的状态。这是我在日常工作中开发的应用程序，它有几个不同的状态需要考虑:</p><ul class=""><li id="8938" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">在黑暗模式下，颜色需要稍微更新。</li><li id="7544" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">“share”文本标签已本地化，需要转换为荷兰语“deel”。</li><li id="16d7" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">由于这是一个行动号召，我们希望确保它能正确地调整动态字体大小。</li></ul><p id="217a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该按钮的SwiftUI代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="9c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个圆形按钮，有一点填充，背景颜色为蓝色。默认预览如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/e51ce88a64dd254cc3e88484ffc486c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*b0Zxhc0ih2H34OiL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">默认显示的SwiftUI预览</p></figure><p id="f58e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，我们有一个蓝色的按钮，默认情况下标题会翻译成英语。它也显示在iPhone显示屏上，这并不真正符合我们的需求，因为它有很多不必要的空白。</p><p id="2789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候改进我们的按钮预览了——让我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1287" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用自定义大小的SwiftUI预览</h1><p id="a105" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以做的第一件事是为SwiftUI预览使用自定义大小。对此，我们有几种选择:</p><ul class=""><li id="e144" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">使用<code class="fe nq nr ns nt b">previewDevice(_:)</code>选择不同的设备型号进行预览。</li><li id="706d" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">通过使用<code class="fe nq nr ns nt b">previewLayout(_:)</code>和<code class="fe nq nr ns nt b">PreviewLayout.fixed(width:height:)</code>设置自定义框架尺寸。</li><li id="1673" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">通过使用<code class="fe nq nr ns nt b">previewLayout(_:)</code>和<code class="fe nq nr ns nt b">PreviewLayout.sizeThatFits</code>来调整视图尺寸。</li></ul><p id="5348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在某些情况下，每个选项都是有价值的。在我们的例子中，我们想调整它的大小，用一些填充物来适应。为此，我们将预览代码更改如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="ec68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了可读性，我们还添加了一个自定义的显示名称，显示在预览的正下方。这已经是一个很大的改进，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/ce1a4136d6529e713038f77f69334ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dboUyAphfkPfNleh.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">调整SwiftUI预览的大小，使其内容略加填充</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c985" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在Xcode中显示多个预览</h1><p id="2ebd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们继续添加SwiftUI按钮的多个状态的预览之前，我们需要能够显示多个预览。</p><p id="c916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将预览视图嵌入到组视图中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="01a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将在现有预览的正下方添加另一个预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/d33008ba06bb8ee24dfadbeba13f76de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eSJHE8WXNERdy-q7.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Xcode中一次显示一组视图</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2a53" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在SwiftUI预览中显示黑暗模式</h1><p id="7d3b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们知道了如何一次显示多个预览，是时候给舞台添加一个不同的状态了。我们添加的第一个状态是使用黑暗模式环境的预览，因此我们可以很容易地并排看到两个视图状态。</p><p id="05a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nu">如果你是第一次为你的应用程序添加黑暗模式支持，你可能想看看我的博客文章:</em> <a class="ae ky" href="https://www.avanderlee.com/swift/dark-mode-support-ios/" rel="noopener ugc nofollow" target="_blank"> <em class="nu">黑暗模式:在Swift </em> </a>中为你的应用程序添加支持。</p><p id="768d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们需要改变预览的环境。为此，我们将使用环境值，我们可以从<a class="ae ky" href="https://developer.apple.com/documentation/swiftui/environmentvalues" rel="noopener ugc nofollow" target="_blank">大选项列表</a>中进行选择。在这种情况下，我们将使用<code class="fe nq nr ns nt b">colorScheme</code>环境值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5aae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们还更新了背景色，以使用系统背景色。这是为了确保我们的预览也采用黑暗模式，显示黑色背景色。</p><p id="565b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将最终导致以下预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/eab75159b99830a59ea91b7583cc17dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*czxiGQa0EPPiiKyk.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在SwiftUI预览中预览黑暗模式</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b9f7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在Xcode预览中预览不同的语言环境</h1><p id="428f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">视图通常在不同的地区使用，因此它们需要调整以显示不同大小的副本。因此，能够在不同的地区预览视图是非常好的。</p><p id="4a44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以手动将每个地区添加到我们的列表中，但自动化过程更有效。为此，我们遍历项目的区域设置，并为每个区域添加一个预览。每当我们添加一个新的地区，一个新的预览将自动添加！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="70ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们过滤掉了基本本地化，因为这将与我们的英语翻译相同。我们遍历每个地区，并通过设置<code class="fe nq nr ns nt b">locale</code>环境来更新我们的预览。我们还更新了我们的预览显示名称，以显示所使用的语言。在我们的示例中，这将导致英语和荷兰语的预览:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/69b96c841fe163a89c64a0082822c572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KkpEfZt_hcNSSxbJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为每个本地化自动创建表示</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="934f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为每个动态文字大小创建预览</h1><p id="453b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们添加预览的最后一个状态是验证不同的动态类型大小。有相当多的<a class="ae ky" href="https://developer.apple.com/design/human-interface-guidelines/ios/visual-design/typography/#Dynamic_Type_Sizes" rel="noopener ugc nofollow" target="_blank">尺寸支持</a>，所以你可能不想自动化这个过程。相反，最好选择几个尺寸相差足够大的尺寸，以验证较大的尺寸是否好看。</p><p id="e949" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中，我们将显示类别“超小”、“大”和“超超超大”的预览我们通过迭代这些大小类别的数组、更新<code class="fe nq nr ns nt b">sizeCategory</code>环境值以及更新预览显示名称来实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="7bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这为我们的按钮创建了三种不同的状态，并直接向我们展示了我们的按钮标题如何适应不同的文本设置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/b59ed390ca59e75bbefdfdacd5140ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M9X7xygyPYSkeW77.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Xcode预览中预览不同的动态文字大小</p></figure><p id="d9d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这太棒了！我们现在可以并排看到每个动态类型的大小，并开发我们的按钮，同时确保我们的标题标签相应地调整。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="bfad" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为用户界面元素创建通用预览</h1><p id="5037" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">开发一个应用程序时，你可能会同时创建许多不同的视图。向每个元素添加SwiftUI预览的不同状态是浪费时间。</p><p id="7cc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解决这一问题，我们可以创建一个通用的解决方案，它接受您的视图，并显示我们想要检查的每个状态的预览。这是它的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f20f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个类包含了我们在这篇博文中采取的所有步骤:</p><ul class=""><li id="193a" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">显示默认大小的预览。</li><li id="3bd2" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">启用黑暗模式的预览。</li><li id="d077" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">我们项目的每个本地化应用于一个预览。</li><li id="7f9f" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">三种不同的动态类型大小应用于我们的元素。</li></ul><p id="f292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的<code class="fe nq nr ns nt b">ShareButtonView</code>预览代码可以简化为以下代码行:</p><pre class="kj kk kl km gt nv nt nw nx aw ny bi"><span id="106b" class="nz md it nt b gy oa ob l oc od">struct ContentView_Previews: PreviewProvider {<br/><br/>    static var previews: some View {<br/>        UIElementPreview(ShareButtonView())<br/>    }<br/>}</span></pre><p id="4cd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这比从一个视图到另一个视图复制我们所有的预览设置要少得多！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a7cb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="19fa" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">SwiftUI预览帮助我们更快地开发定制视图。我们可以设置我们的环境来并排显示每个状态，并快速捕捉UI问题。本地化、黑暗模式和动态字体大小会影响视图的显示方式，并且会增加创建视图所需的时间。有了正确的预览设置，我们可以加快这个过程，并通过我们的自定义预览视图快速应用每个环境。</p><p id="7589" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想进一步提高你的SwiftUI知识，请查看<a class="ae ky" href="https://www.avanderlee.com/category/swiftui/" rel="noopener ugc nofollow" target="_blank"> SwiftUI类别页面</a>。如果您有任何其他建议或反馈，请随时<a class="ae ky" href="mailto:contact@avanderlee.com" rel="noopener ugc nofollow" target="_blank">联系我</a>。</p><p id="f4b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢！</p></div></div>    
</body>
</html>