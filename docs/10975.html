<html>
<head>
<title>The Beginner’s Guide to Selenium With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python学习Selenium的初学者指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-beginners-guide-to-selenium-with-python-cde1937585c6?source=collection_archive---------9-----------------------#2022-02-08">https://betterprogramming.pub/the-beginners-guide-to-selenium-with-python-cde1937585c6?source=collection_archive---------9-----------------------#2022-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a6f8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开始使用Selenium的分步教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eb0b9f704d8a44faf3468fc852d18b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TvfRgTpNEplXK60M"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@clemhlrdt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克莱门特·赫拉尔多</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="ed77" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">硒是什么？</h1><p id="8609" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">从其正式定义来看，“Selenium是一套自动化web浏览器的工具”，事实也确实如此。虽然我认为有些人可能会像我最初一样将其误解为一种测试工具，但我已经认识到Selenium更像是一种通用工具，可以用于浏览器测试。事实上，对于您发现自己在做的任何重复性的基于web的任务，您都应该让Selenium来为您做！</p><blockquote class="mn mo mp"><p id="652c" class="lr ls mq lt b lu mr ju lw lx ms jx lz mt mu mc md mv mw mg mh mx my mk ml mm im bi translated">事实上，我自己创建了一个名为Readminder的项目，它可以帮助我自动搜索最新章节和/或我最喜欢的网络漫画的章节，并给我发送电子邮件提醒。看看这里的<a class="ae ky" href="https://github.com/steffy-lo/Readminder" rel="noopener ugc nofollow" target="_blank"/>！</p></blockquote><h1 id="d88e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">入门指南</h1><p id="e01f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们开始之前，设置Selenium有三个重要步骤:</p><p id="9850" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">1) <a class="ae ky" href="https://www.selenium.dev/documentation/webdriver/getting_started/install_selenium_library/" rel="noopener ugc nofollow" target="_blank">为您想要的编程语言安装</a>Selenium库</p><p id="6762" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">Selenium目前支持多达6种不同的编程语言:Java、Python、C# Ruby、JavaScript和Kotlin。我在这里选择了Python，因为它是自动化/脚本语言，不可否认它是我最喜欢的语言:)</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a582" class="ne la it na b gy nf ng l nh ni">pip install selenium</span></pre><p id="f63f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">2) <a class="ae ky" href="https://www.selenium.dev/documentation/webdriver/getting_started/install_drivers/" rel="noopener ugc nofollow" target="_blank">下载</a>与您的浏览器驱动程序匹配的版本</p><p id="3b14" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">我选择Chrome是因为它是最流行的网络浏览器。首先，进入<code class="fe nj nk nl na b">chome://version</code>，确保您正在下载正确版本的驱动程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5627b3fc5c390c3f935f733a9ef9c519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NZw1I84L9hfsLANq"/></div></div></figure><p id="145f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">在这里，你可以看到我的版本是<code class="fe nj nk nl na b">97.0.4692.71</code>，你的可能会有所不同。如果中没有列出完全匹配的版本<a class="ae ky" href="https://chromedriver.storage.googleapis.com/index.html" rel="noopener ugc nofollow" target="_blank">，也不用担心。选择最接近的版本。可能要选择的是最后两个数字不匹配的地方，这很好。</a></p><p id="ee7c" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">3)为驱动程序设置必要的路径</p><p id="57d1" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">取决于你的系统，你如何将你的驱动程序的位置添加到你的<code class="fe nj nk nl na b">PATH</code>环境变量看起来会有一些不同。</p><h2 id="8ad0" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">尝试</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="e22d" class="ne la it na b gy nf ng l nh ni">echo 'export PATH=$PATH:/path/to/driver' &gt;&gt; ~/.bashrc<br/>source ~/.bashrc</span></pre><h2 id="efa4" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">Zsh</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c2e1" class="ne la it na b gy nf ng l nh ni">echo 'export PATH=$PATH:/path/to/driver' &gt;&gt; ~/.zshrc<br/>source ~/.zshrc</span></pre><h2 id="667b" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">Windows操作系统</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="945c" class="ne la it na b gy nf ng l nh ni">setx PATH "%PATH%;C:\path\to\driver"</span></pre><p id="32ed" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">一旦以上步骤完成，你现在就可以开始自动化你的浏览器了！</p><h1 id="6c64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">自动化您的浏览体验</h1><p id="c826" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们来看看使用Selenium自动化浏览器时可以采取的8个基本步骤或行动。</p><h1 id="96be" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤1:开始会话</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="abec" class="ne la it na b gy nf ng l nh ni">driver = webdriver.Chrome()</span></pre><h1 id="1caf" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤2:在浏览器上采取行动</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5635" class="ne la it na b gy nf ng l nh ni">driver.get("http://www.google.com")</span></pre><p id="2673" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">您可以采取的最常见的web浏览器操作是导航到网页。在上面的例子中，我们打开了一个URL为<code class="fe nj nk nl na b">http://www.google.com</code>的网页。其他一些有用的web浏览器操作包括:</p><h2 id="2501" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">其他浏览器导航</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="19b9" class="ne la it na b gy nf ng l nh ni">driver.back()    # Clicks the browser’s back button<br/>driver.forward()    # Clicks the browser’s forward button<br/>driver.refresh()    # Refreshes the current browser's page</span></pre><h2 id="7e21" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">添加或删除Cookie</h2><p id="d101" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Cookies对于存储和加载用户信息非常有用。要将cookie添加到当前浏览上下文中，我们可以使用接受cookie可序列化JSON对象的<code class="fe nj nk nl na b">add_cookie</code>函数。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="fac3" class="ne la it na b gy nf ng l nh ni">driver.add_cookie({"name": "key", "value": "value"})</span></pre><p id="9627" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">下面的<a class="ae ky" href="https://www.w3.org/TR/webdriver1/#cookies" rel="noopener ugc nofollow" target="_blank">表</a>描述了序列化cookie的字段，以及在提供添加cookie时是否可选。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/0de77ca59537529479c4ca05a71ad00d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mHFsWxZz0ZHca5th.png"/></div></div></figure><h2 id="26be" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">使用窗口和标签</h2><p id="33c7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每个窗口和标签都有一个窗口句柄，用来唯一地标识它。要获取当前窗口或选项卡的窗口句柄，我们可以使用以下属性:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ed34" class="ne la it na b gy nf ng l nh ni">driver.current_window_handle</span></pre><p id="8ef4" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">当我们创建一个新的选项卡或窗口时，焦点将转移到屏幕上的新窗口或选项卡上</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="3e20" class="ne la it na b gy nf ng l nh ni">driver.switch_to.new_window('tab')    # Switch to a new tab<br/>driver.switch_to.new_window('window')    # Switch to a new window</span></pre><p id="3f91" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">要切换回我们原来的窗口，我们可以简单地使用一个变量来存储我们原来存储的窗口句柄并切换回它。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ed05" class="ne la it na b gy nf ng l nh ni">original_window = driver.current_window_handle<br/>...<br/>some window/tab switching logic...<br/>...<br/>driver.switch_to.window(original_window)</span></pre><p id="4c6e" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">最后，要关闭当前窗口或标签，我们可以调用:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1eb2" class="ne la it na b gy nf ng l nh ni">driver.close()</span></pre><h1 id="4991" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤3:请求浏览器信息</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c8bd" class="ne la it na b gy nf ng l nh ni">driver.title          # get title<br/>driver.current_url    # get current URL</span></pre><p id="458a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">除了标题和当前URL之外，您还可以请求许多类型的浏览器信息，包括以下内容:</p><h2 id="2c42" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">饼干</h2><p id="0766" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果我们之前添加了一个cookie，我们可以通过<code class="fe nj nk nl na b">get_cookie</code>函数根据它的名称获取它的详细信息，如下所示:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b76e" class="ne la it na b gy nf ng l nh ni">driver.get_cookie("foo")    # Get details of a cookie named 'foo'</span></pre><h2 id="8edd" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">窗口大小</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="6134" class="ne la it na b gy nf ng l nh ni">size = driver.get_window_size()<br/>width = size.get("width")<br/>height = size.get("height")</span></pre><h2 id="02b3" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">窗口位置</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2271" class="ne la it na b gy nf ng l nh ni">position = driver.get_window_position()<br/>x1 = position.get('x')<br/>y1 = position.get('y')</span></pre><h1 id="c60a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第四步:建立等待策略</h1><p id="380d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通常，我们希望建立一个等待策略，以便在中的元素被加载并准备好进行交互时，与该元素进行交互。让我们来看看两种等待策略。</p><h2 id="1e9b" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">隐式等待</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="d694" class="ne la it na b gy nf ng l nh ni">driver.implicitly_wait(10)</span></pre><p id="0dee" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">最简单的策略是隐式等待策略。当试图查找元素时，它告诉WebDriver在指定的时间内轮询或重复检查DOM，如果在指定的时间内找到了元素，那么我们继续，而不等待整个持续时间(在上面的例子中是10秒)。这种等待策略主要用于确保我们等到元素准备好，如果它们不能立即可用的话。</p><h2 id="0a89" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">显式等待</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a59c" class="ne la it na b gy nf ng l nh ni">from selenium.webdriver.support import expected_conditions as EC<br/>wait = WebDriverWait(driver, timeout=10)<br/>element = wait.until(EC.element_to_be_clickable((By.ID, 'someid')))</span></pre><p id="07b3" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">当您需要更大的灵活性来定义您希望WebDriver等待多长时间时，显式等待策略就出现了。这种等待策略允许您的代码暂停程序执行或冻结线程，直到您指定的条件解决。这意味着在超时(在上面的例子中是10秒)过去之前，它将继续尝试并等待条件，直到它返回一个<code class="fe nj nk nl na b">true</code>值。</p><blockquote class="mn mo mp"><p id="0f83" class="lr ls mq lt b lu mr ju lw lx ms jx lz mt mu mc md mv mw mg mh mx my mk ml mm im bi translated">注意，结合使用隐式和显式等待策略会导致不可预测的等待时间，因为隐式等待没有预定义的等待时间。例如，将隐式等待时间设置为10秒，显式等待时间设置为15秒，可能会导致超时发生在20秒后，而不是25秒后。</p></blockquote><h1 id="d35d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第五步:找到一个元素</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="27e7" class="ne la it na b gy nf ng l nh ni">from selenium.webdriver.common.by import By<br/>search_box = driver.find_element(By.NAME, "q")<br/>search_button = driver.find_element(By.NAME, "btnK")</span></pre><p id="518c" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">在与元素交互之前，我们必须首先找到元素。这种搜索是通过指定和过滤所需元素的属性来完成的。在上面的例子中，我们通过<code class="fe nj nk nl na b">name</code>属性进行过滤。By类的其他可用属性如下:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9fca" class="ne la it na b gy nf ng l nh ni">ID = "id"<br/>XPATH = "xpath"<br/>LINK_TEXT = "link text"<br/>PARTIAL_LINK_TEXT = "partial link text"<br/>NAME = "name"<br/>TAG_NAME = "tag name"<br/>CLASS_NAME = "class name"<br/>CSS_SELECTOR = "css selector"</span></pre><blockquote class="mn mo mp"><p id="4cb6" class="lr ls mq lt b lu mr ju lw lx ms jx lz mt mu mc md mv mw mg mh mx my mk ml mm im bi translated">如果您想通过指定的属性查找多个元素，还有一个<code class="fe nj nk nl na b">find_elements()</code>方法。该方法将返回找到的元素列表。</p></blockquote><h1 id="bc61" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤6:对元素采取行动</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="d248" class="ne la it na b gy nf ng l nh ni">from selenium.webdriver.common.keys import Keys<br/>search_box.clear()<br/>search_box.send_keys("Selenium" + Keys.ENTER)<br/>search_button.click()</span></pre><p id="8507" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">有4种基本类型的命令可以在元素上执行。</p><p id="6e17" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">send_keys()</code> —将提供的密钥键入可编辑的元素中。</p><p id="6438" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">click()</code> —在元素中心执行点击命令。</p><p id="4b24" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">clear()</code> —重置元素的内容。</p><p id="613e" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">select</code> —有一个选择类可以更容易地对<code class="fe nj nk nl na b">&lt;select&gt;</code>元素采取行动。首先，使用引用了<code class="fe nj nk nl na b">&lt;select&gt;</code>元素的<code class="fe nj nk nl na b">WebElement</code>创建一个选择对象。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b59e" class="ne la it na b gy nf ng l nh ni">from selenium.webdriver.support.select import Select<br/>select_element = driver.find_element(By.ID, 'selectElementID')<br/>select_object = Select(select_element)</span></pre><p id="353f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">然后使用以下方法之一选择一个选项:</p><h2 id="713e" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">1.基于<code class="fe nj nk nl na b">&lt;select&gt;</code>元素的内部索引选择一个<code class="fe nj nk nl na b">&lt;option&gt;</code></h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f769" class="ne la it na b gy nf ng l nh ni">select_object.select_by_index(1)</span></pre><h2 id="0496" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">2.根据其值属性选择一个<code class="fe nj nk nl na b">&lt;option&gt;</code></h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="6698" class="ne la it na b gy nf ng l nh ni">select_object.select_by_value('value')</span></pre><h2 id="fb5b" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">3.根据文本选择一个<code class="fe nj nk nl na b">&lt;option&gt;</code></h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="e958" class="ne la it na b gy nf ng l nh ni">select_object.select_by_visible_text('text')</span></pre><p id="31d2" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">或者，如果您只是对<code class="fe nj nk nl na b">&lt;select&gt;</code>元素包含哪些<code class="fe nj nk nl na b">&lt;option&gt;</code>元素以及选择了哪些<code class="fe nj nk nl na b">&lt;option&gt;</code>元素感兴趣:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="94fe" class="ne la it na b gy nf ng l nh ni">all_available_options = select_object.options<br/>all_selected_options = select_object.all_selected_options</span></pre><h1 id="95fe" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤7:请求要素信息</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="e222" class="ne la it na b gy nf ng l nh ni">driver.find_element(By.NAME, "q").get_attribute("value")</span></pre><p id="6a56" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">元素包含我们可以从中提取的信息。请注意，在上面的例子中，我们是如何直接定位元素并向其请求value属性的。</p><p id="b51b" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">很多时候，我们需要在请求元素信息之前重新定位元素，因为自从我们第一次定位它以来，DOM已经发生了变化。现在，我们可以从4个常见类别中查询元素信息:</p><h2 id="688f" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">1.属性和特性</h2><p id="3a0c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用<code class="fe nj nk nl na b">get_attribute</code>和<code class="fe nj nk nl na b">get_property</code>方法，我们可以从元素中获取我们想要的属性和特性。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="0818" class="ne la it na b gy nf ng l nh ni">link_text.get_attribute("href")<br/>img.get_attribute("src")<br/>search_input.get_property("value")</span></pre><h2 id="a5e2" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">2.文本内容</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="3f79" class="ne la it na b gy nf ng l nh ni">text = driver.find_element(By.CSS_SELECTOR, "h1").text</span></pre><h2 id="531d" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">3.CSS值</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4c14" class="ne la it na b gy nf ng l nh ni">cssValue = driver.find_element(By.LINK_TEXT, "See More").value_of_css_property('color')</span></pre><h2 id="7f5d" class="ne la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">4.州</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="eaf9" class="ne la it na b gy nf ng l nh ni">isDisplayed = driver.find_element(By.ID, 'textLbl').is_displayed()</span></pre><p id="f726" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">is_displayed</code>检查元素是否可见。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c27f" class="ne la it na b gy nf ng l nh ni">isSelected = driver.find_element(By.CSS_SELECTOR, "input[type='checkbox']").is_selected()</span></pre><p id="e6fb" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">is_selected</code>检查元素是否被选中。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="e16d" class="ne la it na b gy nf ng l nh ni">isEnabled = driver.find_element(By.NAME, 'btnK').is_enabled()</span></pre><p id="071d" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated"><code class="fe nj nk nl na b">is_enabled</code>检查元件是启用还是禁用。这些方法返回一个布尔值。如果检查通过，则为True，否则为False。</p><h1 id="6c0b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">步骤8:结束会话</h1><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="13a3" class="ne la it na b gy nf ng l nh ni">driver.quit()</span></pre><p id="f27d" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">默认情况下，这将退出浏览器，并且该会话的自动化结束。</p><p id="05b6" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">就是这样！使用这8个简单的步骤，你应该能够用Python中的Selenium在你的浏览器上自动化任何事情！</p><p id="a1ea" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mu mc md me mw mg mh mi my mk ml mm im bi translated">希望本指南对您有所帮助，一如既往地感谢您的阅读！</p></div></div>    
</body>
</html>