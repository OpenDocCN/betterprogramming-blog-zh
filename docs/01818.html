<html>
<head>
<title>Event Delegation in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的事件委托</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/event-delegation-in-javascript-boost-your-app-performance-5f10f25cec96?source=collection_archive---------13-----------------------#2019-10-15">https://betterprogramming.pub/event-delegation-in-javascript-boost-your-app-performance-5f10f25cec96?source=collection_archive---------13-----------------------#2019-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f419" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提升你的应用性能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/061b191b8d22fca63e84ac94505f15be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LmLfPdDTidN7Kao-l0tMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">事件委托</p></figure><p id="d7eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事件委托是在我们的web应用程序中处理事件的一种更好的技术。这是可能的，因为JavaScript在DOM树的层次结构中有一个冒泡(传播)的事件。</p><p id="7fc1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事件委托的概念来自事件冒泡。这意味着如果事件冒泡是可能的，那么事件委托也是可能的。</p><p id="60d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您在应用程序中使用事件，那么您应该了解事件委托，并且只使用一个事件侦听器，而不是编写更多的事件侦听器。</p><p id="cb62" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，在了解事件委托之前，您必须了解事件冒泡。我写了一篇关于<a class="ae lu" href="https://medium.com/@svsh227/event-bubbling-in-javascript-a-better-understanding-9c7e0096a7e9" rel="noopener">事件冒泡</a>的文章，所以请先阅读这篇文章，然后再回到这里。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="70bc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">事件委托</h1><p id="ba71" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">一般来说，在我们的网页上，我们有很多处理所有事情的事件，像点击、击键、输入、鼠标事件，很多随机事件。</p><p id="d768" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们的应用程序增长时，如果我们遵循相同的方法，我们需要添加更多的事件，然后事件的数量不断增加，我们的web应用程序不断加载大量的事件处理程序。</p><p id="2e9b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在某些时候，它会导致性能问题，我们的web应用程序会变慢。</p><p id="72d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如:</p><p id="a9d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们有一个包含五个类别的网页，并且这五个类别都附带了事件处理程序。当我们点击一个类别，然后一个警告框将与信息打开。我们可以在这个点击上执行任何操作，比如重定向到一个单独的网页、控制台、调用一个函数等等。</p><p id="6048" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看上面场景的代码实现。在文件<code class="fe mz na nb nc b">index.html</code>中编写以下代码，并在浏览器中打开。</p><p id="804b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mz na nb nc b">index.html</code>:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="222a" class="nh md it nc b gy ni nj l nk nl">&lt;!DOCKTYPE HTML&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Event Bubbling&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;</span><span id="47d5" class="nh md it nc b gy nm nj l nk nl">    &lt;div class="container"&gt;<br/>      &lt;ul id="fruits"&gt;<br/>        &lt;li id="apple"&gt;Apple&lt;/li&gt;<br/>        &lt;li id="banana"&gt;Banana&lt;/li&gt;<br/>        &lt;li id="guavava"&gt;Guavava&lt;/li&gt;<br/>        &lt;li id="greps"&gt;Greps&lt;/li&gt;<br/>       &lt;li id="orange"&gt;Orange&lt;/li&gt;<br/>    &lt;/ul&gt;</span><span id="41d3" class="nh md it nc b gy nm nj l nk nl">  &lt;/body&gt;<br/>  <br/>  &lt;script&gt;</span><span id="d2d7" class="nh md it nc b gy nm nj l nk nl"><em class="nn">    // Bind an event listener for apple.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#apple');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log("Apple clicked");<br/>      alert("Apple clicked");<br/>    });</span><span id="2db5" class="nh md it nc b gy nm nj l nk nl"><em class="nn">    // Bind an event listener for Banana.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#banana');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log("Banana clicked");<br/>     alert("Banana clicked");<br/>    });</span><span id="4d18" class="nh md it nc b gy nm nj l nk nl"><em class="nn">    // Bind an event listener for Guavava.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#guavava');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log("Guavava clicked");<br/>      alert("Guavava clicked");<br/>    });</span><span id="2ad9" class="nh md it nc b gy nm nj l nk nl"><em class="nn">    // Bind an event listener for Greps.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#greps');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log("Greps clicked");<br/>      alert("Greps clicked");<br/>    });</span><span id="11fe" class="nh md it nc b gy nm nj l nk nl"><em class="nn">    // Bind an event listener for orange.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#orange');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log("Orange clicked");<br/>      alert("Orange is 250/- per KG");<br/>    });<br/>  &lt;/script&gt;<br/>&lt;/html&gt;</span></pre><p id="7d08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在浏览器中打开这个文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a7465fdf18a5b2a0e1254ece8b73b70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*z30ly2tWlSU7S59QlQTkrw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在浏览器中打开的文件</p></figure><p id="fbef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太好了，它工作正常...但是我们上面的代码有什么问题呢？</p><p id="f929" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的代码没有问题，但问题是我们有五个<code class="fe mz na nb nc b">&lt;li&gt;</code>元素，并且我们给它附加了五个事件处理程序。</p><p id="8198" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果将来我们的类别增加到<em class="nn"> N </em>会怎么样？我们会写<em class="nn"> N </em>事件处理程序吗？</p><p id="609f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样在这段代码中:</p><ul class=""><li id="bf05" class="np nq it la b lb lc le lf lh nr ll ns lp nt lt nu nv nw nx bi translated">我们能去掉一些代码吗？</li><li id="5512" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">能不能去掉一些事件处理程序，达到我们想要的效果？</li><li id="5b8a" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">这项任务可以通过编写更少的代码来完成吗？</li><li id="6d30" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">我们能优化代码吗？</li></ul><p id="c143" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">答案是:“是的，我们可以。”通过使用事件委托，我们可以编写更少的代码并获得我们想要的结果。</p><p id="47ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事件委托不是将事件处理程序分别附加到每个子元素或HTML元素，而是将事件直接附加到其父元素。因此，由于JavaScript中的事件冒泡，这是可能的，可以完成事件委托。</p><p id="2d4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将事件附加到其父元素后会有什么变化？发生的事件是子元素将传播(冒泡)到它的父元素，父元素的附加事件处理程序将侦听并调用处理程序函数。</p><p id="245c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在代码中实现这一点。我们将对我们的<code class="fe mz na nb nc b">index.html</code>做一些修改，所以现在我们的<code class="fe mz na nb nc b">index.html</code>将有如下代码:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="804f" class="nh md it nc b gy ni nj l nk nl">&lt;!DOCKTYPE HTML&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Event Delegation&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  <br/>  &lt;body&gt;<br/>    &lt;div class="container"&gt;<br/>      &lt;ul id="fruits"&gt;<br/>        &lt;li id="apple"&gt;Apple&lt;/li&gt;<br/>        &lt;li id="banana"&gt;Banana&lt;/li&gt;<br/>        &lt;li id="guavava"&gt;Guavava&lt;/li&gt;<br/>        &lt;li id="greps"&gt;Greps&lt;/li&gt;<br/>        &lt;li id="orange"&gt;Orange&lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/body&gt;</span><span id="b406" class="nh md it nc b gy nm nj l nk nl">  &lt;script&gt;</span><span id="a920" class="nh md it nc b gy nm nj l nk nl"><em class="nn"><br/>    // Bind an event listener to parents which is fruits.<br/>    </em><strong class="nc iu">var</strong> apple = document.querySelector('#fruits');<br/>    apple.addEventListener('click', (event) <strong class="nc iu">=&gt;</strong> {<br/>      console.log(event.target.id + " clicked");<br/>      alert(event.target.id + " clicked");<br/>    });<br/>  &lt;/script&gt;<br/>&lt;/html&gt;</span></pre><p id="d85f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们可以在上面的代码中看到，我已经从前面的代码中删除了所有的事件处理程序，只写了一个事件处理程序给父元素，它就是<code class="fe mz na nb nc b">fruits</code>。</p><p id="47a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个事件处理程序做的事情与前面五个处理程序分别做的事情相同。</p><p id="f045" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在浏览器中打开这个文件(<code class="fe mz na nb nc b">index.html</code>)并查看结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/f3e9625d01ce1b2dbe7f57da920b63df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*LB8UAK24QQQKP0VF96Ju8w.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">优化(事件委托)代码执行</p></figure><p id="15d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是我们如何使用事件委托优化代码并提高代码质量的方法。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b8db" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">事件委托的利弊</h1><h2 id="f06f" class="nh md it bd me od oe dn mi of og dp mm lh oh oi mo ll oj ok mq lp ol om ms on bi translated"><strong class="ak">优点</strong></h2><ul class=""><li id="580d" class="np nq it la b lb mu le mv lh oo ll op lp oq lt nu nv nw nx bi translated">代码质量:我们可以提高我们的代码质量，维护会很容易。</li><li id="6250" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">内存:在我们的代码中包含更多的事件将会占用大量的内存，而使用事件委托将会节省内存。</li><li id="69da" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">性能:事件委托将提高应用程序的性能。</li><li id="4060" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">DOM操作:如果我们在每个子元素上实现事件处理程序，并且我们有无限滚动，那么每次动态添加子元素时，DOM都会更新。使用事件委托，DOM操作会更少。</li></ul><h2 id="b61d" class="nh md it bd me od oe dn mi of og dp mm lh oh oi mo ll oj ok mq lp ol om ms on bi translated"><strong class="ak">缺点</strong></h2><ul class=""><li id="0a84" class="np nq it la b lb mu le mv lh oo ll op lp oq lt nu nv nw nx bi translated">并非所有的事件都会发生。有些事件不会冒泡，比如模糊、聚焦、调整窗口大小或滚动。在这种情况下，使用事件委托会很困难。</li><li id="0260" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">子代停止传播。有时，HTML元素使用<code class="fe mz na nb nc b">stopPropagation()</code>T9停止事件传播。在这种情况下，事件传播将停止，不会在层次结构中冒泡。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d297" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="57d5" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">结论是，我们不需要将事件处理程序附加到所有的子元素上。相反，我们可以只将一个事件处理程序附加到它的父级，并处理实现目标的函数。</p><p id="4e92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。</p></div></div>    
</body>
</html>