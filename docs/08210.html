<html>
<head>
<title>Optimize Your iOS App by Using Copied Images in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过使用Swift中复制的图像优化您的iOS应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/optimize-your-ios-app-by-using-copied-images-in-swift-8338782250ef?source=collection_archive---------16-----------------------#2021-04-06">https://betterprogramming.pub/optimize-your-ios-app-by-using-copied-images-in-swift-8338782250ef?source=collection_archive---------16-----------------------#2021-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c32d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有了复制的图像，我们可以让图像在我们的项目中更有表现力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/261b85002572c8ccec30398a65ac4609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_JGxugr1blIKcz_IVIGMCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="9166" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">iOS和macOS支持许多图像格式，如JPEG和PNG，但偶尔我们作为开发人员，不得不在我们的项目中使用iOS和macOS不支持的格式。例如，当您从无法确定来源的API获取数据时，就会发生这种情况。</p><p id="fcbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当您试图直接在屏幕上显示图像，而iOS或macOS不支持其格式时，您可能会遇到非常值得注意的性能问题。在这种情况下，复制的图像可以帮助我们。</p><p id="8e61" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我们将学习如何使用复制的图像，以及如何转换和使用我们想要的方式不支持的图像。</p><p id="9d60" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">注意:</strong>你可以<a class="ae lu" href="https://github.com/SwiftDeeply/Copied-Images-in-Swift" rel="noopener ugc nofollow" target="_blank">在GitHub上下载本文的示例项目和源代码</a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8fa3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">让我们看看这个例子</h1><p id="10a0" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">首先，我们有一个非常基本的项目:它只涉及使用一个<code class="fe mz na nb nc b">UImage</code>对象。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="a34e" class="nh md it nc b gy ni nj l nk nl"><strong class="nc iu">class</strong> ViewController: UIViewController {<br/><br/>    // MARK: - UI Elements<br/>    <strong class="nc iu">let </strong>imageView = UIImageView()<br/><br/>    // MARK: - Life Cycle<br/>    <strong class="nc iu">override</strong> <strong class="nc iu">func</strong> viewDidLoad() {<br/>        <strong class="nc iu">super</strong>.viewDidLoad()<br/><br/>        imageView.translatesAutoresizingMaskIntoConstraints = <strong class="nc iu">false</strong><br/>        imageView.contentMode = .scaleAspectFit<br/>        view.addSubview(imageView)<br/><br/>        NSLayoutConstraint.activate([<br/>            imageView.centerXAnchor.constraint(equalTo: view.centerXAnchor),<br/>            imageView.centerYAnchor.constraint(equalTo: view.centerYAnchor),<br/>            imageView.widthAnchor.constraint(equalToConstant: 300),<br/>            imageView.heightAnchor.constraint(equalToConstant: 300)<br/>        ])<br/><br/>        imageView.image = UIImage(named: "example.tif")<br/>    }<br/>}</span></pre><p id="f88f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如你所见，我们在<code class="fe mz na nb nc b">UIImage</code>对象上使用了一个TIF格式的图像文件。iOS和macOS不支持此文件格式。这就是为什么我们的图像对象现在很难绘制。在真正的iOS或macOS应用程序中，这可能会造成相当困难的性能问题。</p><p id="4b56" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么我们怎么知道iOS或macOS不支持这种图像格式呢？(毕竟，很有可能记住每一种不支持的文件格式。)答案是Xcode的调试模式。</p><p id="e2e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在模拟器中运行我们的应用程序后，当我们在菜单栏的“调试”选项卡中单击“颜色复制的图像”按钮时，需要很长时间渲染的UI元素的颜色会发生变化。如果图画有大问题，一些会是红色的，如果问题不大，一些会是蓝色的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/fe4a59faf62797266b82c2ccadfb07b9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*I_eMxI6MUQoC7vOqtS3lFA.png"/></div></figure><p id="b460" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">解决问题的唯一方法是重新绘制我们的图像元素。以下函数将适用于此。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="49a2" class="nh md it nc b gy ni nj l nk nl">// MARK: - Methods<br/><strong class="nc iu">func</strong> redraw(for image: UIImage) -&gt; UIImage {<br/>    <strong class="nc iu">let</strong> renderer = UIGraphicsImageRenderer(size: image.size)<br/>        <br/>    <strong class="nc iu">return</strong> renderer.image { <strong class="nc iu">_ in</strong><br/>        image.draw(at: .zero)<br/>    }<br/>}</span></pre><p id="4dc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，用这个方法，我们可以如下定义<code class="fe mz na nb nc b">UIImageView</code>对象的图像属性。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="e853" class="nh md it nc b gy ni nj l nk nl"><strong class="nc iu">let</strong> image = UIImage(named: "bad-image.tif")!<br/><strong class="nc iu">let</strong> renderedImage = redraw(for: image)<br/>imageView.image = renderedImage</span></pre><p id="7308" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于这种方法，我们的图像对象将复制本地缓存，所以它不会降低性能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1535" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="a04b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">现在您知道了如何在iOS或macOS项目中使用拷贝的图像。如果你想让我写更多关于优化主题的文章，如果你在评论区写下你想要的主题，我会很乐意的。</p><p id="a7bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。</p><h2 id="4ac9" class="nh md it bd me nn no dn mi np nq dp mm lh nr ns mo ll nt nu mq lp nv nw ms nx bi translated"><strong class="ak">我的其他文章</strong></h2><ul class=""><li id="6cbf" class="ny nz it la b lb mu le mv lh oa ll ob lp oc lt od oe of og bi translated"><a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/whats-new-in-swift-5-4-88949071d538">“Swift 5.4有什么新功能？</a>”</li><li id="50ce" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated"><a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/create-a-custom-alert-object-in-swiftui-bddf98923a1">“在SwiftUI中创建自定义预警对象</a></li><li id="cb85" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated"><a class="ae lu" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-onboarding-screens-in-your-ios-app-e41b518db31f">“如何在您的iOS应用程序中创建入职屏幕</a>”</li></ul></div></div>    
</body>
</html>