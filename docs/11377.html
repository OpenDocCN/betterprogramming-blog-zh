<html>
<head>
<title>What Is Helm? A Quickstart Tutorial for Kubernetes Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是头盔？Kubernetes初学者快速入门教程</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-helm-a-quickstart-tutorial-for-kubernetes-beginners-24fecce1b0eb?source=collection_archive---------13-----------------------#2022-03-14">https://betterprogramming.pub/what-is-helm-a-quickstart-tutorial-for-kubernetes-beginners-24fecce1b0eb?source=collection_archive---------13-----------------------#2022-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="27d5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">教你如何处理应用程序包，升级和回滚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c6d95f8c9400060a719716159864db3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4TVr1bmfbZCR6nzA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">凯尔·辛克森在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0189" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，Kubernetes成为DevOps从业者编排容器的必备工具。一旦有了应用程序的Docker映像，就必须编写YAML清单来定义Kubernetes的工作负载。接下来，用<a class="ae kv" href="https://kubernetes.io/docs/reference/kubectl/" rel="noopener ugc nofollow" target="_blank"> kubectl </a>命令部署它们。</p><p id="5950" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种部署方式适用于只有一个应用程序的情况。当您开始拥有许多应用程序和多个环境时，它会变得不堪重负。通常，90%的情况下，您都会定义相同的YAML文件。</p><p id="d535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们将重点讨论如何使用Helm智能地管理应用程序。</p><h1 id="a823" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是头盔？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/b4b0e0c7f428462e9f914563bada8fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/0*cB9_Z3doNnphE2LJ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来自<a class="ae kv" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank">https://helm.sh/</a>的掌舵标志</p></figure><p id="61cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Helm 是Kubernetes的软件包经理。Helm是一个开源项目，最初由<a class="ae kv" href="https://deislabs.io/" rel="noopener ugc nofollow" target="_blank">dei blasts</a>创建，并捐赠给<a class="ae kv" href="https://www.cncf.io/" rel="noopener ugc nofollow" target="_blank">云原生基金会</a> ( <em class="ml"> CNCF </em>)。CNCF现在维持并完成了该项目。这意味着它是成熟的，而不仅仅是一种时尚。</p><p id="349e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">包管理在软件行业中并不是一个新概念。在Linux发行版上，你可以用包管理器来管理软件的安装和卸载，比如<a class="ae kv" href="https://www.redhat.com/sysadmin/how-manage-packages" rel="noopener ugc nofollow" target="_blank"> YUM/RPM </a>或者<a class="ae kv" href="https://ubuntu.com/server/docs/package-management" rel="noopener ugc nofollow" target="_blank"> APT </a>。在Windows上，你可以在Mac上使用<a class="ae kv" href="https://chocolatey.org/" rel="noopener ugc nofollow" target="_blank"> Chocolatey </a>或<a class="ae kv" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank"> Homebrew </a>。</p><p id="8cab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Helm允许您在Kubernetes中打包和部署完整的应用程序。一个包被称为一个“<em class="ml">图表”</em> Helm使用一个基于<a class="ae kv" href="https://pkg.go.dev/html/template" rel="noopener ugc nofollow" target="_blank"> Go模板</a>的模板系统从图表中呈现Kubernetes清单。图表是分离模板和值的一致结构。</p><p id="2114" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个包，图表还可以管理与其他图表的依赖关系。例如，如果您的应用程序需要一个MySQL数据库来工作，您可以将图表作为一个依赖项包含进来。当Helm在图表目录的顶层运行时，它会安装整个依赖项。您只需要一个命令就可以将您的应用程序呈现并发布到Kubernetes。</p><p id="9de8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Helm charts使用版本来跟踪清单中的变化，因此您可以为特定的基础架构配置安装特定的图表版本。Helm将所有已部署图表的发布历史记录保存在一个专用的工作区中。如果发生错误，这使得应用程序更新和回滚变得更加容易。</p><p id="64da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Helm允许你压缩图表。其结果是一个可与Docker图像相媲美的伪像。然后，您可以将它发送到远处的存储库，以便重用和共享。</p><h1 id="98e0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用Helm有什么好处？</h1><ul class=""><li id="d4d1" class="mm mn iq ky b kz mo lc mp lf mq lj mr ln ms lr mt mu mv mw bi translated">Helm为您提供了用一个命令安装应用程序的能力。一个图表可以包含其他图表作为依赖关系。因此，您可以使用Helm部署整个堆栈。你可以像使用<a class="ae kv" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"> docker-compose </a>一样使用Helm，但是对于Kubernetes。</li><li id="1559" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">图表包括各种Kubernetes资源的模板，以形成一个完整的应用程序。这降低了微服务的复杂性，并简化了它们在Kubernetes中的管理。</li><li id="4c11" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">图表可以被压缩并发送到远处的存储库。这为Kubernetes创建了一个应用程序构件。您还可以从存储库中获取和部署现有的舵图。这是可重用性和共享性的一个优点。</li><li id="1cd7" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">Helm在Helm工作区中维护已部署发布版本的历史记录。当出现问题时，回滚到以前的版本很简单——canary release通过Helm实现了零停机部署。</li><li id="3ef3" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">Helm使得部署高度可配置。在部署期间，可以动态定制应用程序。通过更改参数，您可以将同一个图表用于多个环境，如开发、试运行和生产环境。</li><li id="fb37" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">简化CI/CD渠道—推进GitOps最佳实践。</li></ul><h1 id="c46e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">快速查看Helm解决的问题</h1><p id="1464" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">Kubernetes的基本做法是手工编写YAML清单。我们将创建最少的YAML文件来在Kubernetes中部署NGINX。</p><p id="05e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是将创建pod的部署:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="804d" class="nk lt iq ng b gy nl nm l nn no">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  name: nginx<br/>spec:<br/>  selector:<br/>    matchLabels:<br/>      app: nginx<br/>  replicas: 1<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: nginx<br/>    spec:<br/>      containers:<br/>      - name: nginx<br/>        image: nginx:1.21.6<br/>        ports:<br/>        - containerPort: 80</span></pre><p id="4b59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该服务向外部公开NGINX。通过选择器完成与pod的链接:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="93cb" class="nk lt iq ng b gy nl nm l nn no">apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: nginx<br/>spec:<br/>  selector:<br/>    app: nginx<br/>  ports:<br/>    - protocol: TCP<br/>      port: 80<br/>      targetPort: 8080</span></pre><p id="3e1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们必须用下面的kubectl命令创建前面的资源:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="4707" class="nk lt iq ng b gy nl nm l nn no">$ kubectl create -f deployment.yaml <br/>$ kubectl create -f service.yaml</span></pre><p id="7fb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们检查所有资源是否启动并运行:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="2026" class="nk lt iq ng b gy nl nm l nn no">$ kubectl get deployment -l app=nginx<br/>NAME    READY   UP-TO-DATE   AVAILABLE   AGE<br/>nginx   1/1     1            1           8m29s<br/>$ kubectl get pods -l app=nginx                                                                                      <br/>NAME                     READY   STATUS    RESTARTS   AGE<br/>nginx-65b89996ff-dcfs9   1/1     Running   0          2m26s<br/>$ kubectl get svc -l app=nginx <br/>NAME    TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE<br/>nginx   ClusterIP   10.106.79.171   &lt;none&gt;        80/TCP    4m58s</span></pre><ul class=""><li id="0202" class="mm mn iq ky b kz la lc ld lf np lj nq ln nr lr mt mu mv mw bi translated">YAML清单中的特定值是硬编码的，不可重用。</li><li id="89cf" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">要指定的冗余信息(如标签和选择器)会导致潜在的错误。</li><li id="535c" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">Kubectl不处理执行后的潜在错误。您必须一个接一个地部署每个文件。</li><li id="5aac" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">没有变更可追溯性。</li></ul><h1 id="3ace" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">从头开始创建舵图</h1><p id="19f1" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">Helm可以在一个命令行中创建图表结构:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="9173" class="nk lt iq ng b gy nl nm l nn no">$ helm create nginx</span></pre><h2 id="cde2" class="nk lt iq bd lu ns nt dn ly nu nv dp mc lf nw nx me lj ny nz mg ln oa ob mi oc bi translated">理解舵图的结构</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/fad98eec3b547f1306a79f281b5dae4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qsbErzoB3tT9s4GQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">舵图的树形结构</p></figure><ul class=""><li id="64f3" class="mm mn iq ky b kz la lc ld lf np lj nq ln nr lr mt mu mv mw bi translated"><code class="fe oe of og ng b">Chart.yaml</code>:包含图表信息的YAML文件。</li><li id="b649" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">charts</code>:包含该图表所依赖的任何图表的目录。</li><li id="a0f5" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">templates</code>:Helm在这里为您的服务、部署和其他Kubernetes对象找到YAML定义。您可以为自己添加或替换生成的YAML文件。</li><li id="f6ed" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">templates/NOTES.txt</code>:这是一个模板化的纯文本文件，在图表成功部署后打印出来。这是简要描述使用图表的后续步骤的有用位置。</li><li id="df79" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">templates/_helpers.tpl</code>:该文件是模板片段的默认位置。文件名以下划线开头的文件被认为是<em class="ml">而不是</em>包含清单。这些文件不会呈现到Kubernetes对象定义中，但在其他图表模板中随处可见。</li><li id="12d3" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">templates/tests</code>:测试验证您的图表在安装后是否按预期工作</li><li id="d61d" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated"><code class="fe oe of og ng b">values.yaml</code>:该图表的默认配置值</li></ul><h2 id="e4e5" class="nk lt iq bd lu ns nt dn ly nu nv dp mc lf nw nx me lj ny nz mg ln oa ob mi oc bi translated">自定义模板</h2><p id="215c" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">默认情况下，部署图表时会自动加载<code class="fe oe of og ng b">values.yaml</code>。这里我们将图像标签设置为<code class="fe oe of og ng b">1.21.5</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><blockquote class="oj ok ol"><p id="0663" class="kw kx ml ky b kz la jr lb lc ld ju le om lg lh li on lk ll lm oo lo lp lq lr ij bi translated">您可以指定一个特定的<code class="fe oe of og ng b">values.yaml</code>文件来为特定于环境的设置定制部署</p></blockquote><h1 id="4d8d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">安装舵图</h1><p id="1ea5" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">如果你做了更新，在部署舵图之前运行linter是一个好建议:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="7997" class="nk lt iq ng b gy nl nm l nn no">$ helm lint nginx<br/>==&gt; Linting nginx<br/>[INFO] Chart.yaml: icon is recommended<br/><br/>1 chart(s) linted, 0 chart(s) failed</span></pre><p id="c0f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行Helm，在模拟和调试模式下安装图表，以确保一切正常:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="1dde" class="nk lt iq ng b gy nl nm l nn no">$ helm install --debug --dry-run nginx nginx</span></pre><blockquote class="oj ok ol"><p id="aedd" class="kw kx ml ky b kz la jr lb lc ld ju le om lg lh li on lk ll lm oo lo lp lq lr ij bi translated">使用helm linter和带调试模式的预演安装将节省您开发过程中的宝贵时间。</p></blockquote><p id="f8b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要安装图表，请移除<code class="fe oe of og ng b">--dry-run</code>标志:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="d9d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以看到<code class="fe oe of og ng b">NOTES.txt</code>的模板化内容，解释如何连接到应用程序。</p><p id="1d51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您可以在Helm工作区中检索版本:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="3d78" class="nk lt iq ng b gy nl nm l nn no">$ helm list               <br/>NAME    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART           APP VERSION<br/>nginx   default         1               2022-03-14 12:01:46.926038 +0100 CET    deployed        nginx-0.1.0     1.0.0</span></pre><h1 id="0159" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">升级舵释放</h1><p id="e18a" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">假设出于测试目的，您想要将容器映像升级到<code class="fe oe of og ng b">1.21.6</code>。</p><p id="f1b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将从命令行更改设置，而不是创建一个新的<code class="fe oe of og ng b">values.yaml</code>。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="577c" class="nk lt iq ng b gy nl nm l nn no">$ helm upgrade nginx nginx --set image.tag=1.21.6<br/>Release "nginx" has been upgraded. Happy Helming!<br/>NAME: nginx<br/>LAST DEPLOYED: Mon Mar 14 12:04:40 2022<br/>NAMESPACE: default<br/>STATUS: deployed<br/>REVISION: 2<br/>NOTES:<br/>1. Get the application URL by running these commands:<br/>  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=nginx,app.kubernetes.io/instance=nginx" -o jsonpath="{.items[0].metadata.name}")<br/>  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")<br/>  echo "Visit <a class="ae kv" href="http://127.0.0.1:8080" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8080</a> to use your application"<br/>  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT</span></pre><p id="e0a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">pod也使用新的容器图像:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="542d" class="nk lt iq ng b gy nl nm l nn no">$ kubectl get pod -l app.kubernetes.io/name=nginx -o jsonpath='{.items[0].spec.containers[0].image}'<br/>nginx:1.21.6</span></pre><p id="ad08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">升级在图表历史中可见:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="c22e" class="nk lt iq ng b gy nl nm l nn no">$ helm history nginx                                                   <br/>REVISION        UPDATED                         STATUS          CHART           APP VERSION     DESCRIPTION     <br/>1               Mon Mar 14 12:07:33 2022        superseded      nginx-0.1.0     1.0.0           Install complete<br/>2               Mon Mar 14 12:08:25 2022        deployed        nginx-0.1.0     1.0.0           Upgrade complete</span></pre><p id="5063" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe oe of og ng b">helm diff</code>可以检查变化:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="6649" class="nk lt iq ng b gy nl nm l nn no">$ helm diff revision nginx 1 2<br/>default, nginx, Deployment (apps) has changed:<br/>  # Source: nginx/templates/deployment.yaml<br/>  apiVersion: apps/v1<br/>  kind: Deployment<br/>  metadata:<br/>    name: nginx<br/>    labels:<br/>      helm.sh/chart: nginx-0.1.0<br/>      app.kubernetes.io/name: nginx<br/>      app.kubernetes.io/instance: nginx<br/>      app.kubernetes.io/version: "1.0.0"<br/>      app.kubernetes.io/managed-by: Helm<br/>  spec:<br/>    replicas: 1<br/>    selector:<br/>      matchLabels:<br/>        app.kubernetes.io/name: nginx<br/>        app.kubernetes.io/instance: nginx<br/>    template:<br/>      metadata:<br/>        labels:<br/>          app.kubernetes.io/name: nginx<br/>          app.kubernetes.io/instance: nginx<br/>      spec:<br/>        serviceAccountName: nginx<br/>        securityContext:<br/>          {}<br/>        containers:<br/>          - name: nginx<br/>            securityContext:<br/>              {}<br/>-           image: "nginx:1.21.5"<br/>+           image: "nginx:1.21.6"<br/>            imagePullPolicy: IfNotPresent<br/>            ports:<br/>              - name: http<br/>                containerPort: 80<br/>                protocol: TCP<br/>            livenessProbe:<br/>              httpGet:<br/>                path: /<br/>                port: http<br/>            readinessProbe:<br/>              httpGet:<br/>                path: /<br/>                port: http<br/>            resources:<br/>              {}</span></pre><h1 id="5451" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">回滚舵释放</h1><p id="4b3b" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">升级不确定，您想返回。由于Helm保留所有更改，回滚非常简单:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="38bb" class="nk lt iq ng b gy nl nm l nn no">$ helm rollback nginx 1<br/>Rollback was a success! Happy Helming!</span></pre><p id="4bd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">pod现在回到<code class="fe oe of og ng b">1.21.5</code>容器图像:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="8d60" class="nk lt iq ng b gy nl nm l nn no">$ kubectl get pod -l app.kubernetes.io/name=nginx -o jsonpath='{.items[0].spec.containers[0].image}'<br/>nginx:1.21.5</span></pre><h1 id="17ca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">卸载舵图</h1><p id="345e" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">卸载舵图和安装一样简单:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="653f" class="nk lt iq ng b gy nl nm l nn no">$ helm uninstall nginx</span></pre><h1 id="d25f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">重用现有的舵图</h1><p id="ac14" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">许多著名的项目提供了舵图，使集成更加用户友好。他们通过存储库提供图表。你只要把它加在你这边:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="0c30" class="nk lt iq ng b gy nl nm l nn no">$ helm repo add bitnami <a class="ae kv" href="https://charts.bitnami.com/bitnami" rel="noopener ugc nofollow" target="_blank">https://charts.bitnami.com/bitnami</a></span></pre><p id="7b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加后，更新您的本地缓存以与远程存储库同步信息:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="2273" class="nk lt iq ng b gy nl nm l nn no">$ helm repo update</span></pre><p id="8b79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在可以在Kubernetes集群上安装图表了:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="3f5c" class="nk lt iq ng b gy nl nm l nn no">$ helm install nginx bitnami/nginx</span></pre><p id="b422" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图表使用默认值进行部署。您可以启发并指定一个定制<code class="fe oe of og ng b">values.yaml</code>来满足您的需求！</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="9387" class="nk lt iq ng b gy nl nm l nn no">$ helm install my-release bitnami/nginx -f values.yaml</span></pre></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><p id="9d59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！🙏我希望这篇文章是有帮助的。想了解更多关于DevOps的知识？看看下面更多类似的文章吧！⬇️</p><div class="ow ox gp gr oy oz"><a href="https://getbetterdevops.io" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ir gy z fp pe fr fs pf fu fw ip bi translated">Getbetterdevops</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">Getbetterdevops是一个devops博客，帮助学习现代基础设施和云技术，如Kubernetes…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">getbetterdevops.io</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn kp oz"/></div></div></a></div></div></div>    
</body>
</html>