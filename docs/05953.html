<html>
<head>
<title>How to Display PDFs but Prevent Them From Downloading in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中显示pdf但阻止下载</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-display-pdfs-but-prevent-them-from-downloading-in-react-2e77292ca9a5?source=collection_archive---------0-----------------------#2020-08-20">https://betterprogramming.pub/how-to-display-pdfs-but-prevent-them-from-downloading-in-react-2e77292ca9a5?source=collection_archive---------0-----------------------#2020-08-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8af7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">寻求删除不需要的功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/467ebe80dea68f9c9d1380a6bc681233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XprUNtUxnDOz8rTY"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@cleovermij?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Cleo Vermij </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="c1d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在你的网站上嵌入一个PDF文件很容易，但是这可能会给你的用户更多的访问权限。</p><p id="1ec3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也许你想在你的网站上展示你的书，但是你不想让用户下载它，因为这会减少你的广告收入。也许您希望向站点成员显示一个文档，但不希望他们与非成员共享该文档。</p><p id="00d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无论你的理由是什么，本教程将向你展示如何在你的React应用程序中阻止PDF下载。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9740" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">用户下载pdf的每一种方式</h1><p id="74fc" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在解决任何问题之前，我们需要更好地定义问题是什么。</p><h2 id="4d0f" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated"><strong class="ak">用户可以通过三种主要方式下载pdf文件</strong></h2><ol class=""><li id="9c14" class="ni nj iq ky b kz mr lc ms lf nk lj nl ln nm lr nn no np nq bi translated">单击浏览器的PDF查看器上的下载按钮。</li><li id="0d31" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">右键单击PDF并选择“另存为”</li><li id="5c68" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">打印网页并选择“另存为PDF”</li></ol><p id="792b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将探索所有这些方法的解决方案！</p><h2 id="6b76" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">限制</h2><p id="1ebf" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我想坦率地指出本教程的局限性。由于您的网站上的信息是在公共网站上，总会有一些方法让用户通过您网站上的数据检索或重新创建PDF。本教程只是防止“普通用户”下载您的pdf，而不是“专家用户”或开发者。本教程也不阻止截图，因为这是在操作系统的控制下，不会受到浏览器中运行的代码的影响。</p><p id="6993" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经解决了技术问题，让我们开始吧！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6c12" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">移除下载按钮</h1><p id="8589" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在网站上嵌入PDF的最简单方法是使用<code class="fe nw nx ny nz b">&lt;embed&gt;</code>标签:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="b14f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，这使用浏览器的内置PDF查看器，它通常为用户提供下载选项:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/52d9ef8b231881df3b422c2f58c53164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*hfvdCHQFhH7ocZUjpxAVsA.png"/></div></figure><p id="ded0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以通过在PDF的内容中添加<code class="fe nw nx ny nz b">#toolbar=0</code>来解决这个问题:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="89d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将删除整个工具栏，并因此删除下载按钮:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ede7543b800a4eacbdac64971a518cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*hgzP25bl750XTBAPyyGQBw.png"/></div></figure><p id="7760" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您选择嵌入带有<code class="fe nw nx ny nz b">iframe</code>的PDF，这也是同样的方式:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="736c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe nw nx ny nz b">&lt;embed&gt;</code>或<code class="fe nw nx ny nz b">&lt;iframe&gt;</code> web组件时，用户仍然可以右键单击文档并选择“另存为”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/add95aba92d9c067f9f2212486ee690d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*FuXM2h2RZb-lGB0u9ESL8A.png"/></div></figure><p id="b4fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这很不幸，因为这仍然是用户下载PDF的一个非常简单的方法。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8dce" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">防止右键单击</h1><p id="19cf" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">如果你曾经使用过<code class="fe nw nx ny nz b">onClick</code>事件处理程序，阻止右键点击会让你感觉像在家里一样。我们只是使用了<code class="fe nw nx ny nz b">onContextMenu</code>事件处理程序！</p><p id="a20c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">默认情况下，右键单击元素将显示上下文菜单，该菜单为用户提供了几个选项:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3c395410eae8b60f8a8fdad2ffa3034b.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*AgpEdFPvxQ6L9dXaljRGrw.png"/></div></figure><p id="abaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以通过阻止右键单击事件的默认事件处理程序来阻止上下文菜单显示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="db90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将阻止上下文菜单出现。我省略了一个截图，因为没什么可展示的。右键单击时，不会显示任何内容。</p><p id="74b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">唯一的问题是有一些web组件不支持<code class="fe nw nx ny nz b">onContextMenu</code>。可悲的是，这包括<code class="fe nw nx ny nz b">&lt;embed&gt;</code>和<code class="fe nw nx ny nz b">&lt;iframe&gt;</code>。重申一下，您无法阻止右键单击显示PDF的<code class="fe nw nx ny nz b">&lt;embed&gt;</code>或<code class="fe nw nx ny nz b">&lt;iframe&gt;</code>，所以我们需要找到另一个选项。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5fbf" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">react-pdf简介</h1><p id="8461" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在这一点上，我们不能再使用<code class="fe nw nx ny nz b">&lt;embed&gt;</code>或<code class="fe nw nx ny nz b">&lt;iframe&gt;</code>，因为它们不提供禁用右击的灵活性。我们将使用一个名为<a class="ae kv" href="https://www.npmjs.com/package/react-pdf" rel="noopener ugc nofollow" target="_blank"> react-pdf </a>的npm模块。</p><p id="e525" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个模块是pdf.js的包装器，pdf . js是Mozilla开发的一个开源项目，以HTML格式显示pdf。就基本web组件而言，react-pdf在一个<code class="fe nw nx ny nz b">&lt;canvas&gt;</code>标签中呈现pdf，该标签支持<code class="fe nw nx ny nz b">onContextMenu</code>事件处理程序。</p><p id="356b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要安装该模块，运行<code class="fe nw nx ny nz b">yarn add react-pdf</code>。如果使用npm，运行<code class="fe nw nx ny nz b">npm install react-pdf --save</code>。</p><p id="8881" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是react-pdf的一个简单例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="3986" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在页面上清晰地呈现PDF，而无需浏览器的默认PDF查看器。因此，不同浏览器的浏览体验更加一致，并且不包含工具栏。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/29cc1f38484ab87b7770f4b90542350e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*sBKkuI27vng-pNCqgaz1pA.png"/></div></figure><p id="011e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在后台，react-pdf将您的pdf转换为图像，然后在网页上显示该图像。默认情况下，浏览器仍会提供保存此图像的选项:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/06dda29e77cb32e365afe0027f8b984d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*G0fQ-1nQp4alc67fChTDGA.png"/></div></figure><p id="78c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为这会呈现一个<code class="fe nw nx ny nz b">&lt;canvas&gt;</code> web组件，所以阻止上下文菜单出现是很简单的。我们可以只应用<code class="fe nw nx ny nz b">onContextMenu</code>事件处理程序:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="10da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很不错，对吧？</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9d65" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">阻止打印和“另存为PDF”</h1><p id="c903" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在，用户仍然很容易通过简单地将网页保存为PDF来保存PDF的副本。这可以通过打印当前网页并选择打印目的地“另存为PDF”来完成:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/d271b312d787c9e51147186cb863c42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OI_IDs9uHcxWtygHCx6SXQ.png"/></div></div></figure><p id="acce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了防止这种情况，我们可以利用CSS媒体查询。媒体查询允许您根据媒体类型定义某些样式，例如<code class="fe nw nx ny nz b">screen</code>、<code class="fe nw nx ny nz b">speech</code>或(出于我们的目的)<code class="fe nw nx ny nz b">print</code>。确保向您的组件添加一个<code class="fe nw nx ny nz b">className</code>并导入您的CSS文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="256a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我创建了一个名为<code class="fe nw nx ny nz b">App.css</code>的CSS文件，并添加了媒体查询:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="1254" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果您尝试打印该页面，PDF不会出现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/7603c9f944c99f97c7ee91a35b5a2b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9Pv49v5Q5uPZPUCXVB_MA.png"/></div></div></figure><p id="7ee5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！现在，我们让用户很难下载你在网站上展示的pdf文件。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6882" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">更强大的PDF查看器</h1><p id="89b9" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">到目前为止，我们的代码非常简单，应该足以让你开始在你的网站上添加这个功能。然而，为了尽可能彻底，我想包括一个完整的PDF查看器的例子，所以在这里！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/83ae1a68029ff800fa44af704d114f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fJTPITSLw5ygwD0Ps13j4A.gif"/></div></div></figure><p id="1c8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个示例项目的代码可以从GitHub 上的<a class="ae kv" href="https://github.com/alexanderqchen/pdf-viewer" rel="noopener ugc nofollow" target="_blank">获得。该链接还包括如何设置它并让它在您的机器上工作的说明。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1d8b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="1892" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我希望这篇教程对你有所帮助，并且你在这个过程中学到了一些东西。如果你有任何问题，不要犹豫地问。我喜欢帮助我的开发伙伴，并将更新文章中任何有用的信息。如果你喜欢阅读，想要小块的、可消费的内容，你应该关注我的推特。</p><p id="b93f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">祝你好运，并获得编码！</p></div></div>    
</body>
</html>