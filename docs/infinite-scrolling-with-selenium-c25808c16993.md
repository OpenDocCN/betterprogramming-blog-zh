# 硒无限滚动

> 原文：<https://betterprogramming.pub/infinite-scrolling-with-selenium-c25808c16993>

## 如何在包含无限数据的页面上自动导航

![](img/0a0ecdc4ac50b022210aec1bc26167cc.png)

丹·席马利尼在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄的照片。

硒太神奇了！它让你有机会非常简单地获得你想要的一切。根据[它的文档](https://www.selenium.dev/documentation/en/)，*“*它提供了模拟用户与浏览器交互的扩展。”此外，它还受到多种编程语言的支持，每个浏览器都有一个名为 WebDriver 的接口，可以实现自动化。

任何试图从页面获取数据的人都注意到，HTML 元素可以根据它们被请求的时间出现在页面上。换句话说，一个曾经包含大量数据的网站不可能同时代表所有的数据。因此，可能需要一步一步地请求数据的表示，滚动页面。

这个问题我已经处理过好几次了。我每次解决的方法都不一样，所以我想向您展示从需要不同元素的页面中获取数据的最简单、最快和最有效的方法，方法是滚动页面本身或页面的一部分。

首先，我们需要从 Selenium 导入三个特定的模块:

第一个用于定义 WebDriver 接口，该接口允许您与特定的浏览器自动交互。第二种是中断 WebDriver 的执行，以等待一个特定的事件(在我们的例子中，就是滚动页面)。

现在，如果我们选择 [Chrome WebDriver](https://chromedriver.chromium.org/downloads) ，我们需要用二进制文件所在的路径来定义它。然后，我们选择要从中提取数据的网站，并使用 WebDriver 启动它:

现在是时候了解你需要滚动页面的哪一部分了。使用任何浏览器提供的检查工具，我们可以复制元素的 JavaScript 路径，并考虑该元素而不是页面的主体。为了简单起见，我们将只考虑主页面的滚动(因此也是主体的滚动)，在 JavaScript 中标识为`document.body`。但是我说过，这条路是可以改变的。

在其他指南中，我看到滚动通常是根据一定的时间间隔来完成的。在这种情况下，我们将使用基于特定事件发生的方法。允许滚动特定元素的事件将是滚动本身。当 WebDriver 意识到页面大小增加了，就会滚动，等待事件在我们选择的某个时间范围内发生。

为此，有必要定义一个类，我们将命名为`infinite_scroll`:

这个类的`__call__`方法对于检查滚动是否发生很有用。

无限滚动的主要部分是`While`循环，它将迭代到页面的末尾。然而，在开始循环之前，必须用初始页面大小初始化`last_height`变量:

这样，进程至少等待十秒钟来滚动页面，之后它将引发一个异常，通知用户他们已经到达了页面的结尾或滚动时可能出现的阻塞。

请记住，web 服务器接受的请求数量是有限的，因此您可能永远也不会到达页面的末尾，而是会由于托管您正在抓取数据的页面的服务器的 429 错误而被卡住。