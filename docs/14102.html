<html>
<head>
<title>This Is a Simple yet Powerful Three.js Boilerplate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这是一个简单而强大的Three.js样板文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/this-is-a-simple-yet-powerful-three-js-boilerplate-cbf8ee968c26?source=collection_archive---------1-----------------------#2022-11-06">https://betterprogramming.pub/this-is-a-simple-yet-powerful-three-js-boilerplate-cbf8ee968c26?source=collection_archive---------1-----------------------#2022-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b2c8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用我的开源库，在您的项目中轻松使用Three.js</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/70b56a553ef9ac4eebe5a38083ea4f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IjXEsLujHCsDSyRk"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="kv">该样板文件使用的样本场景</em></p></figure><p id="006f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您开始一个新的Three.js项目时，您通常会厌倦复制粘贴所有样板文件来做相同的场景、摄像机等设置。我完全理解，因为这也是我的故事。这就是为什么我开始开发我自己的Three.js样板代码，感觉就像在家里一样。</p><p id="f7a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将分享一个我正在使用并且还在完善的。一开始你可能会觉得有点难以理解，但是如果你花时间去理解它，并且多使用几次，你会发现开始一个新的Three.js项目毫不费力！</p><h1 id="ad16" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">该样板文件的主要特点</h1><ul class=""><li id="64d3" class="mk ml iq ky b kz mm lc mn lf mo lj mp ln mq lr mr ms mt mu bi translated">为您执行所有常用的Three.js设置代码，以便您可以专注于自己的场景和对象。</li><li id="6a30" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">使用async/await加载纹理/图像，这样场景只有在所有资源都加载后才会显现。你再也不会看到像纹理这样的东西突然出现在你的物体上了！</li><li id="3120" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">使用配置最少的包裹，因此您不需要关心设置捆扎机。</li></ul><h1 id="cdf5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">我的GitHub回购</h1><p id="8cf7" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated"><a class="ae nd" href="https://github.com/franky-adl/threejs-starter-template" rel="noopener ugc nofollow" target="_blank">https://github.com/franky-adl/threejs-starter-template</a>是回购的链接。随意叉或者拉请求！</p><p id="2272" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要在本地运行repo，请按顺序执行以下命令。构建在几秒钟内完成后，将会为您打开一个新的浏览器选项卡:</p><ol class=""><li id="6e9b" class="mk ml iq ky b kz la lc ld lf ne lj nf ln ng lr nh ms mt mu bi translated"><code class="fe ni nj nk nl b">npm i</code></li><li id="7ff5" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr nh ms mt mu bi translated"><code class="fe ni nj nk nl b">make dev</code></li></ol><h1 id="6733" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包裹</h1><p id="ed6b" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">在我的旧版本Three.js样板文件中，我使用了<code class="fe ni nj nk nl b">webpack</code>作为捆绑工具。它是一个多用途和受欢迎的捆绑器，但我认为它的构建时间较慢，并且对于简单的项目来说太复杂了。</p><p id="c916" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近我开始用<a class="ae nd" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">包</a>，用起来真的很简单。几乎没有入门成本，跟着用Parcel构建web apps的教程走；只需要五分钟就能上手！</p><p id="21ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Parcel会为您完成所有的JavaScript传输配置。您需要指定您希望您的应用程序在什么目标浏览器上运行。例如，在您的<code class="fe ni nj nk nl b">package.json</code>文件中提供这一行，package会为您完成所有的脏工作:</p><pre class="kg kh ki kj gt nm nl nn no aw np bi"><span id="c6c3" class="nq lt iq nl b gy nr ns l nt nu">"browserslist": "&gt; 0.5%, last 2 versions, not dead"</span></pre><h1 id="b929" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">样板代码解释</h1><p id="3f4a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">这会有点长。如果您更喜欢亲自动手，只需阅读代码中的文档字符串并尝试一下！无论如何，我将解释的大部分内容都记录在代码中。</p><p id="5a27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不会在<code class="fe ni nj nk nl b">index.html</code>文件上花太多时间，因为这只是导入<code class="fe ni nj nk nl b">index.js</code>文件的标准设置。我添加的一个额外的东西是面纱，只有当所有耗时的资源(例如，图像/纹理)都加载到场景中时，它才会揭开面纱。</p><p id="1145" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ni nj nk nl b">index.js</code>文件是你放置大部分场景构建代码的地方。这个样板文件的本质是我在<code class="fe ni nj nk nl b">core-utils.js</code>中写的便利方法，这些方法被<code class="fe ni nj nk nl b">index.js</code>使用。<code class="fe ni nj nk nl b">index.js</code>文件有三个主要部分，您也可以在代码中通过编号的注释部分看到:</p><ol class=""><li id="3458" class="mk ml iq ky b kz la lc ld lf ne lj nf ln ng lr nh ms mt mu bi translated">正在初始化核心Three.js组件</li><li id="6ba7" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr nh ms mt mu bi translated">构建您的场景</li><li id="85c0" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr nh ms mt mu bi translated">运行应用程序</li></ol><p id="5e23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有第0部分，你可以为你的场景定义可调整的参数，这些参数也可以在右上角的GUI控制面板中进行调整。例如，如果我想改变一种特殊的颜色或材料的粗糙度/金属度，我喜欢把参数分组放在那里，这样我就不必在整个代码中滚动查找它们。</p><h1 id="3c5e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第1部分—初始化Core Three.js组件</h1><p id="5c6a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">这里我们使用<code class="fe ni nj nk nl b">core-utils.js</code>中的以下便利方法(如果没有参数传递给它们，则设计为使用默认值)来创建基本的Three.js组件:</p><ul class=""><li id="bce7" class="mk ml iq ky b kz la lc ld lf ne lj nf ln ng lr mr ms mt mu bi translated"><code class="fe ni nj nk nl b">createRenderer(rendererProps, configureRenderer)</code>，默认为你设置像素比例和渲染器大小。您可以在第一个参数(例如<code class="fe ni nj nk nl b">{ antialias: true}</code>)传递额外的配置属性，并在第二个参数传递一个回调来进一步配置渲染器。</li><li id="eb86" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated"><code class="fe ni nj nk nl b">createCamera(fov, near, far, camPos, camLookAt, aspect)</code>，默认情况下，它使用<code class="fe ni nj nk nl b">PerspectiveCamera</code>并为您设置相机的位置和观察点。如果您没有传入这些参数中的任何一个，您也可以看到默认的摄像机值。</li><li id="9a44" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated"><code class="fe ni nj nk nl b">createComposer(renderer, scene, camera, extraPasses)</code>，默认情况下，它会创建<code class="fe ni nj nk nl b">EffectComposer</code>并为您添加<code class="fe ni nj nk nl b">RenderPass</code>，因此您只需关注您想要通过<code class="fe ni nj nk nl b">extraPasses</code>回调添加什么后处理走刀即可。</li></ul><h1 id="3041" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第2部分—构建场景</h1><p id="2f67" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">我们需要用一个<code class="fe ni nj nk nl b">initScene</code>方法定义一个<code class="fe ni nj nk nl b">app</code>对象。这里的对象结构与样板代码非常紧密地耦合在一起，但是我发现一旦您习惯了它，它会非常方便。如果你的场景需要动画，定义一个额外的<code class="fe ni nj nk nl b">updateScene</code>方法来托管你的动画代码。</p><ul class=""><li id="f7e0" class="mk ml iq ky b kz la lc ld lf ne lj nf ln ng lr mr ms mt mu bi translated"><code class="fe ni nj nk nl b">initScene()</code>:这个函数在一个基本的Three.js环境建立之后被调用，这样你就可以放置你的场景构建代码(例如，添加<code class="fe ni nj nk nl b">OrbitControls</code>、添加灯光、添加球体或盒子、GUI控件、FPS统计等等)。)在这里。注意这个函数有<code class="fe ni nj nk nl b">async</code>前缀，所以你可以在其中使用<code class="fe ni nj nk nl b">await</code>来加载纹理和耗时的东西。这里的默认模板机制只会揭开你的场景，一旦你在<code class="fe ni nj nk nl b">initScene</code>中的所有东西被同步加载，就开始制作动画。这一点很重要，因为我们不希望渲染的对象在纹理突然出现之前必须等待一两秒钟，这看起来很不专业。</li><li id="ff5b" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated"><code class="fe ni nj nk nl b">updateScene(interval, elapsed)</code>:这是你设置场景动画的地方(例如，更新轨道控制，更新FPS统计，旋转/移动你的网格)。注意，您不需要调用<code class="fe ni nj nk nl b">requestAnimationFrame</code>方法，因为它在<code class="fe ni nj nk nl b">core-utils.js</code>中处理。您还有两个与时间相关的参数可以使用:<br/> 1。<code class="fe ni nj nk nl b">interval</code>:两帧之间经过的时间<br/> 2。<code class="fe ni nj nk nl b">elapsed</code>:应用程序启动后经过的总时间</li></ul><h1 id="16d0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第3部分—运行应用程序</h1><p id="67ec" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">最后，在第3节中，您调用<code class="fe ni nj nk nl b">runApp</code>来启动应用程序，以在浏览器中显示渲染的场景。在运行<code class="fe ni nj nk nl b">app.initScene()</code>和稍后的动画之前，这将为您设置通常的HTML容器、窗口调整监听器和鼠标移动/触摸监听器。</p><p id="b0ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你的场景是静态的，你不希望应用程序每秒运行60次无用的帧重绘，你可以跳过定义<code class="fe ni nj nk nl b">app.updateScene</code>并将<code class="fe ni nj nk nl b">false</code>传递给<code class="fe ni nj nk nl b">runApp</code>处的<code class="fe ni nj nk nl b">enableAnimation</code>参数。</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="3032" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是所有的解释和展示。如果你一直读到这一行，我真的很感激！老实说，我认为初学者一开始会发现这个样板文件非常复杂。</p><p id="715d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我总是乐于接受建议和改进！</p><p id="5f6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你喜欢，觉得有用💪🏼。</p></div></div>    
</body>
</html>