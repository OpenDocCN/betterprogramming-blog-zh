<html>
<head>
<title>Build a Modern Android Splash Screen</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个现代的Android闪屏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/android-splash-screen-69723a820a06?source=collection_archive---------12-----------------------#2022-01-03">https://betterprogramming.pub/android-splash-screen-69723a820a06?source=collection_archive---------12-----------------------#2022-01-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a156" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用最新API的方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/99fdad6425a61d585c113e84d39f112d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ky7BAnlkQkMhsATLqHslPg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">闪屏剖析</p></figure><p id="f796" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Android发布官方支持显示闪屏。</p><p id="7db5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这种新的闪屏支持是在Android 12中添加的，但同样可以在早期版本的Android中使用<a class="ae lr" href="https://androidx.tech/artifacts/core/core-splashscreen/" rel="noopener ugc nofollow" target="_blank">闪屏支持库</a>。</p><p id="9b0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了演示闪屏API的各个方面，我用Jetpack Compose创建了一个<a class="ae lr" href="https://github.com/sridhar-sp/android-splash-screen-demo" rel="noopener ugc nofollow" target="_blank">示例应用</a>(<a class="ae lr" href="https://raw.githubusercontent.com/sridhar-sp/android-splash-screen-demo/main/docs/images/splash_preview.png" rel="noopener ugc nofollow" target="_blank">最终闪屏预览</a>)。</p><p id="663d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们开始吧！</p><h1 id="f52a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第一步</h1><p id="803e" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们从添加闪屏<a class="ae lr" href="https://androidx.tech/artifacts/core/core-splashscreen/" rel="noopener ugc nofollow" target="_blank">依赖关系</a>开始。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="bf29" class="mu lt iq mq b gy mv mw l mx my">implementation 'androidx.core:core-splashscreen:1.0.0-alpha02'</span></pre><h1 id="ef86" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第二步</h1><p id="029c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">接下来的步骤是创建一个闪屏图标和一个可选的品牌形象。</p><p id="a4e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将在后面讨论如何创建闪屏图标，并使它出现在屏幕的中心——在屏幕底部的<code class="fe mz na nb mq b">Extras</code>部分。</p><h1 id="dce8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第三步</h1><p id="0d8a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">一旦我们准备好图像资产，我们就可以使用闪屏主题来应用它。</p><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="cd5f" class="nf lt iq mq b be ng nh l ni my">&lt;style name="Theme.Splash.Starting" parent="Theme.SplashScreen"&gt;<br/>    &lt;item name="windowSplashScreenBackground"&gt;<br/>        @color/splash_screen_background<br/>    &lt;/item&gt;<br/>    &lt;item name="windowSplashScreenAnimatedIcon"&gt;<br/>        @drawable/ic_splash_icon<br/>    &lt;/item&gt;<br/>    &lt;item name="windowSplashScreenAnimationDuration"&gt;<br/>        @integer/splash_screen_animation_duration<br/>    &lt;/item&gt;<br/>    &lt;item name="postSplashScreenTheme"&gt;<br/>        @style/Theme.App.NoActionBar<br/>    &lt;/item&gt;<br/>    &lt;!--Android 12 specific styles (put this in values-v31) --&gt;<br/>    &lt;item name="android:windowSplashScreenBrandingImage"&gt;<br/>        @drawable/ic_brand_icon<br/>    &lt;/item&gt;<br/>    &lt;!--Android 12 specific styles (put this in values-v31) --&gt;<br/>&lt;/style&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3e4d91dc74a8482717557d8771f0c3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqE8O2dE7PYMZdb0DZ7hUA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">闪屏剖析</p></figure><p id="888f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们来看看风格属性。</p><p id="0867" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mz na nb mq b">windowSplashScreenBackground </code> —你可能已经猜到了，占据整个屏幕的是背景色。</p><p id="dce2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mz na nb mq b">windowSplashScreenAnimatedIcon </code> —这可以是一个普通的矢量图标，也可以是一个动画矢量图标。注意:一个动画矢量图标将只在Android 12+设备上显示动画，旧的API设备将只显示静态图标而没有任何动画。</p><p id="ec0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mz na nb mq b">windowSplashScreenAnimationDuration </code> —动画图标的持续时间。建议的持续时间为1000毫秒。</p><p id="5a4b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mz na nb mq b">postSplashScreenTheme </code> —该主题在应用程序加载后使用。<br/>这是必需的，因为我们将在应用程序清单中将启动器活动主题设置为<code class="fe mz na nb mq b">Theme.SplashScreen</code>——这对于显示闪屏、动画徽标和品牌图标非常有用。然而，一旦应用程序被加载，如果我们不使用<code class="fe mz na nb mq b">Theme.AppCompat</code>或<code class="fe mz na nb mq b">Theme.MaterialComponents</code>，我们会得到一个异常。因此，这个属性来拯救。</p><p id="480f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mz na nb mq b">windowSplashScreenBrandingImage</code> —显示在屏幕底部的品牌图像(仅适用于Android 12)。</p><h1 id="f642" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第四步</h1><p id="9157" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">现在设置启动器活动主题为<code class="fe mz na nb mq b"><strong class="kx ir">Theme.Splash.Starting</strong></code></p><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="a842" class="nf lt iq mq b be ng nh l ni my">&lt;activity<br/>    android:name=".MainActivity"<br/>    android:exported="true"<br/>    android:label="@string/app_name"<br/>    android:theme="@style/Theme.Splash.Starting"&gt;<br/>    &lt;intent-filter&gt;<br/>        &lt;action android:name="android.intent.action.MAIN" /&gt;<br/><br/>        &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br/>    &lt;/intent-filter&gt;<br/>&lt;/activity&gt;</span></pre><h1 id="a03c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第五步</h1><p id="1f50" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">最后在MainActivity <code class="fe mz na nb mq b">onCreate</code>方法中添加<code class="fe mz na nb mq b"><strong class="kx ir"><em class="nj">installSplashScreen()</em></strong></code></p><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="4741" class="nf lt iq mq b be ng nh l ni my">override fun onCreate(savedInstanceState: Bundle?) {<br/>    super.onCreate(savedInstanceState)<br/><br/>    installSplashScreen()<br/><br/>    setContent {<br/>        AndroidSplashScreenTheme {<br/>             Greeting("Android splash screen demo")<br/>        }<br/>    }<br/>}</span></pre><h1 id="cc1c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">其他功能</h1><p id="4bfa" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">既然我们已经完成了新Android闪屏的设置，现在我们可以看看它附带的其他功能了。</p><h2 id="ca3d" class="mu lt iq bd lu nk nl dn ly nm nn dp mc le no np me li nq nr mg lm ns nt mi nu bi translated">控制闪屏可见性。</h2><p id="3624" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">闪屏API提供支持，只要我们需要，闪屏就保持可见。</p><p id="2f01" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们需要获取一些对渲染屏幕至关重要的资源，没有这些资源，显示UI就没有任何意义。在这种情况下，我们可以推迟显示应用程序的UI，直到我们的资源被获取并准备好。</p><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="1d96" class="nf lt iq mq b be ng nh l ni my">installSplashScreen().setKeepVisibleCondition {<br/>    mainViewModel.isScreenLoading.value<br/>}</span></pre><h2 id="73c8" class="mu lt iq bd lu nk nl dn ly nm nn dp mc le no np me li nq nr mg lm ns nt mi nu bi translated">setKeepVisibleCondition</h2><p id="aa6c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这个方法接受一个回调函数，该函数返回一个布尔值来决定是否保持屏幕打开。True值表示启动画面应该保持原样，False值表示关闭启动画面。</p><p id="14f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SplashScreen API会定期调用这个回调来检查是保留闪屏还是解除闪屏。</p><h2 id="b8e9" class="mu lt iq bd lu nk nl dn ly nm nn dp mc le no np me li nq nr mg lm ns nt mi nu bi translated">闪屏消失时动画显示屏幕内容</h2><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="e901" class="nf lt iq mq b be ng nh l ni my">installSplashScreen()<br/>.setOnExitAnimationListener { splashScreenViewProvider -&gt;<br/>    // Animation code<br/>}</span></pre><h1 id="6c5c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">临时演员</strong></h1><p id="ac4c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们讨论如何创建闪屏图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3e4d91dc74a8482717557d8771f0c3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqE8O2dE7PYMZdb0DZ7hUA.png"/></div></div></figure><p id="7116" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如我们在闪屏图标中看到的，<code class="fe mz na nb mq b">section 1</code>被<code class="fe mz na nb mq b">section 3</code>屏蔽了</p><p id="2a12" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们按原样应用我们的图标，它会缩小和伸展。</p><p id="ccee" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么我们如何解决这个问题呢？我们需要创建一个图标来迎合这种掩盖填充。</p><p id="a574" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们有一个<code class="fe mz na nb mq b">54x54</code>的闪屏图标，那么我们将创建一个大小为<code class="fe mz na nb mq b">108x108</code>(实际图标的两倍)的包装层，并将图标内容放在它的中心。</p><h2 id="6f0c" class="mu lt iq bd lu nk nl dn ly nm nn dp mc le no np me li nq nr mg lm ns nt mi nu bi translated">例子</h2><pre class="kg kh ki kj gt mp mq nc bn nd ne bi"><span id="96ff" class="nf lt iq mq b be ng nh l ni my">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;vector<br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    android:name="vector"<br/>    android:width="108dp"<br/>    android:height="108dp"<br/>    android:viewportWidth="108"<br/>    android:viewportHeight="108"&gt;<br/>    &lt;!--Optional background spanning full 108x108 dp--&gt;<br/>    &lt;path<br/>        android:name="background"<br/>        android:pathData="M 0 0 L 108 0 L 108 108 L 0 108 Z"<br/>        android:fillColor="@color/splash_icon_background"<br/>        android:strokeWidth="1"/&gt;<br/>   &lt;!--Splash screen icon placed in the centre of the screen--&gt;<br/>    &lt;group<br/>        android:name="group_icon"<br/>        android:pivotX="54"<br/>        android:pivotY="54"&gt;<br/>        &lt;path<br/>            android:name="path_pi"<br/>            android:pathData="M 30 44.591 L......."<br/>            android:fillColor="@color/splash_icon_color"<br/>            android:strokeWidth="1"/&gt;<br/>    &lt;/group&gt;<br/>&lt;/vector&gt;</span></pre><p id="ebae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就这样了，伙计们。感谢阅读。</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h1 id="ca60" class="ls lt iq bd lu lv oc lx ly lz od mb mc jw oe jx me jz of ka mg kc og kd mi mj bi translated">源代码</h1><div class="oh oi gp gr oj ok"><a href="https://github.com/sridhar-sp/android-splash-screen-demo" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">GitHub-srid har-sp/Android-splash-screen-demo:演示各种特性的示例应用程序…</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">github.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kp ok"/></div></div></a></div></div></div>    
</body>
</html>