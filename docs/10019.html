<html>
<head>
<title>Text Recognition on SwiftUI Canvas With Vision in iOS 15</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS 15中使用Vision在SwiftUI画布上进行文本识别</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/text-recognition-on-swiftui-canvas-with-vision-in-ios-15-a838318f20d2?source=collection_archive---------9-----------------------#2021-11-15">https://betterprogramming.pub/text-recognition-on-swiftui-canvas-with-vision-in-ios-15-a838318f20d2?source=collection_archive---------9-----------------------#2021-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1260" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将SwiftUI中的Canvas与Vision一起使用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/18640861559012771143b4b1db3750f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XuAQ1gJpGTUihS53"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@imkirk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊韦克·诺斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="07b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1993年，苹果推出了一款产品，我确信它是iPad的前身。用他们需要的技术让它真正工作，可悲的是还有点太年轻。有问题的产品是苹果牛顿。</p><p id="0833" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它被作为一款带有手写识别功能的个人数字助理推向市场。当时它的显著特征之一。不幸的是，如果我相信媒体的话，这个功能做得不够好。牛顿注定要成为苹果柠檬。</p><p id="bb9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">快进到2021年，我注意到Vision框架有一个识别图像中的文本和数字的模块。</p><p id="b24f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你知道手写识别——牛顿的特性，据说是它的败笔。加入我的探索之旅，看看我是否可以利用今天的技术来教iPad使用视觉框架进行手写识别，变得更好——这可能是成为牛顿之子的第一步。</p><h1 id="c64e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">案情摘要</h1><p id="63ab" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">好的——退一步说，这里的挑战是什么，我打算怎么做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/536a13fc91a81b472cad515ab6a3805e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rEQPBzBueywrp7fl8gVA5A.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">视频加速播放，在这个单词的美国拼写下的微小文本中显示识别的数字</p></figure><p id="6c0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想使用最新的技术，所以在iOS 15中使用SwiftUI。我需要一个函数来保存我的画布——说起来容易做起来难——并且需要一个函数在我在画布上写了东西后清理/过滤噪声。所以图像过滤。一旦清理完毕，我计划使用视觉框架和机器学习模块<code class="fe mt mu mv mw b"><a class="ae ky" href="https://en.wikipedia.org/wiki/MNIST_database" rel="noopener ugc nofollow" target="_blank">MNISTClassifier</a></code>来识别数字并报告它所看到的。</p><h1 id="d20d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">主循环</h1><p id="f7dc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了与编码原则保持一致，前几周我讲道——写完代码后，我花了一些时间来重构这段代码。原则循环归结为六个方法，其中几个引用了包含绘图坐标的已发布类。同样的结构包含一个Bool来指示笔是刚刚碰到了页面还是在页面上移动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="ac09" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">画布视图</h1><p id="3127" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在过去的一两个月里，我已经发表了半打关于这个主题的论文——所以让画布视图运行起来相当简单。也就是说，我将视图构建为一个变量，这样我就可以用快照代码来引用它。一个视图，我在其中添加了一个拖动手势来拾取用于绘图的笔事件。相当于UIKit中touch的SwiftUI。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="33d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的秘密是在钢笔上绘制线条和椭圆，在我的页面上得到一条看起来有点像记号笔的线条。</p><h1 id="ab94" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">拍摄视图快照</h1><p id="718f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我会说我很幸运地找到了这段代码——尽管在这个过程中我确实发现了iOS中的一个bug。</p><p id="4e53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我本想将画布导出为图像，并对其直接应用滤镜——但是应该返回指针的代码却没有返回任何内容。与此同时，我很幸运地找到了这段代码，在<a class="ae ky" href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-convert-a-swiftui-view-to-an-image" rel="noopener ugc nofollow" target="_blank">这个网站</a>上抓拍了一个视图。几乎开箱即用的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="f226" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我说几乎是因为我需要在画布中包含标签<code class="fe mt mu mv mw b">.ignoreSafeArea</code>和标签<code class="fe mt mu mv mw b">.frame</code>。</p><h1 id="9270" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">理解图像</h1><p id="08e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对我来说，这是项目中最有趣的部分——也许因为我本质上是一名计算机科学家——解密/清理png图像正合我意，需要很好地理解按位运算符，如and、or和XOR，以及核心图像和PNG格式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="47d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将我认为做另一篇文章致力于这一方法。如你所见，这里有相当多的代码被注释掉了。你需要知道的是，这种方法不仅将图像缩小到一个通道，即红色通道，还将它反转。</p><h1 id="8da7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">其他观点</h1><p id="011c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">管理应用程序的少数其他视图，这里没有火箭科学。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="8072" class="mz lw it bd lx na nb dn mb nc nd dp mf li ne nf mh lm ng nh mj lq ni nj ml nk bi translated"><strong class="ak">实施视觉模块</strong></h2><p id="018c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我在这里也有第二次运气，在这个主题的<a class="ae ky" href="https://www.youtube.com/watch?v=NNKPbdT9gXU&amp;list=PLY1P2_piiWEY761sVFoZAdbqp_B524Y17" rel="noopener ugc nofollow" target="_blank">播放列表</a>上有一系列优秀的视频——这个实现只需要一点点修补就可以让它工作，因为它是基于UIKit的，我们正在为SwiftUI而努力。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="be97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在这里跳过了一点——实际上忽略了所有的异常，您应该适当地多做一点努力。</p><h2 id="993b" class="mz lw it bd lx na nb dn mb nc nd dp mf li ne nf mh lm ng nh mj lq ni nj ml nk bi translated">视觉框架处理程序</h2><p id="9253" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">将所有这些整合在一起的最后一段代码是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="ef3b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="bf5c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当然，我只是触及了苹果牛顿在这里所能做的表面——我相信有人读到这里会告诉我——但看看苹果在过去三十年里在这个问题上走了多远是一件有趣的事情。当然，我过分简化了这个项目，追求个位数的识别，尽管实际上做更多对一篇中型文章来说太长了。</p><p id="2e4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">试用代码；它工作得相当好——尽管我注意到它与数字6的斗争远远超过了我的期望。</p><h1 id="d86e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">将来的</h1><p id="0524" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我已经提到，视觉框架似乎也可以识别文本，去更新项目并实现它，您可以在此处找到其参考资料<a class="ae ky" href="https://developer.apple.com/documentation/vision/recognizing_text_in_images/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="6abe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">免责声明——虽然我已经老到可以拥有一台苹果牛顿了，但我从来没有拥有过。作为一名90年代初刚从大学毕业的初级系统工程师，我并不需要PDA——当时我关注的是这个星球上最快的图形计算机，Silicon Graphics，一家伟大的公司。</p></div></div>    
</body>
</html>