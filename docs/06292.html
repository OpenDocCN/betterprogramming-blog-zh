<html>
<head>
<title>Best Practices to Control Your Errors in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">控制JavaScript错误的最佳实践</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/best-practices-to-control-your-errors-in-javascript-4cf9f3c9b923?source=collection_archive---------10-----------------------#2020-09-17">https://betterprogramming.pub/best-practices-to-control-your-errors-in-javascript-4cf9f3c9b923?source=collection_archive---------10-----------------------#2020-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="50a2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">扩展错误类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a973c67c75a144c9f303bcb44c5d8e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AcIU2ztAQEASN6Dlea8BJQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/s/photos/corrections-and-errors?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@woodies11?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">rom son preech wit</a>拍摄。</p></figure><p id="5c89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在编写代码时，考虑可能发生错误的不同情况是很重要的。它们在您的web应用程序中起着不可或缺的作用，因为您可以避免致命的情况(比如您的应用程序完全崩溃)，如果不处理这些情况，这些情况是无法避免的。</p><p id="9731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将介绍一些在JavaScript中控制和处理错误的最佳实践。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0ed8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">扩大误差</h1><p id="6b03" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在错误处理程序中提供更具描述性的错误通常很有用。我的意思不仅仅是把你的错误信息写得更清楚。我指的是扩展<code class="fe mz na nb nc b">Error</code>类。</p><p id="f248" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这样做，您可以定制对调试有用的<code class="fe mz na nb nc b">name</code>和<code class="fe mz na nb nc b">message</code>属性，以及附加需要它的定制getters、setters和方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="38ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以提供更流畅的调试体验——尤其是当您有多个类似抛出的代码块时。当代码中的多个场景由于相同的原因抛出并需要一些额外的上下文时，在没有实用程序的情况下返回并找出抛出的确切原因会变得有点困难(当然，这取决于错误的类型)。</p><p id="fabf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们回顾一下这个变得有用的场景。</p><p id="8c47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您有一个接受解析器函数列表的函数。该函数接受一个参数，当它运行时，它将遍历解析器并将参数传递给每个函数。如果函数返回一个结果，那么它停止循环并返回结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="adbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，假设我们正在构建一个页面，它会提示用户输入他们的出生年份，然后根据他们的年龄将他们分配到某个组:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码提示用户，当他们点击<em class="nf"> OK </em>时，他们的年龄被分配给<code class="fe mz na nb nc b">userInput</code>，并作为参数发送给<code class="fe mz na nb nc b">composeResolvers</code>生成的函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/db56514c5517d1a1df60bbe49ffc411d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ofr0R_dBmOR8Gen7.png"/></div></div></figure><p id="8527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当它完成时，它运行<code class="fe mz na nb nc b">window.alert</code>向用户显示计算出的组:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/150eba92bb5d9641392274f864e5380c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aXoP7IgAZTzyt40i.png"/></div></div></figure><p id="4528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很好，但是如果用户<em class="nf">没有使用Chrome浏览器呢？这意味着这条线不会运行:</em></p><pre class="kj kk kl km gt ni nc nj nk aw nl bi"><span id="ae0b" class="nm md it nc b gy nn no l np nq">resolvers.push(someResolverFn)</span></pre><p id="bc21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这产生了一个令人尴尬的意外结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/5d8ce57091fb66a23224988de1c92671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Bty-meAMNdN5nagO.png"/></div></div></figure><p id="0144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过抛出一个普通的<code class="fe mz na nb nc b">Error</code>来防止像这样的未处理的错误，或者我们可以使用更具体的<code class="fe mz na nb nc b">BadParametersError</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c3d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，用户发现错误的机会就小得多，并且让开发人员修复错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/a6d20c435facf0a7e306c2baf8a3689e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U4EN-EQuC_7EcvZV.png"/></div></div></figure><p id="b76c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果多个函数使用这种策略并附加了一个类似<code class="fe mz na nb nc b">recommended</code>的属性，调试体验会变得容易得多。</p><p id="9365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在可以写成这样，这是一种更好的防御机制:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f698" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用一个<code class="fe mz na nb nc b">TypeError</code></h1><p id="44a4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们经常通过抛出<code class="fe mz na nb nc b">Error</code>来处理错误。但是，当内置的JavaScript错误可用于缩小机会到来时的场景时，利用它们是有用的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="30a8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">测试</h1><p id="dcdb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">通过利用派生的<code class="fe mz na nb nc b">Errors</code>，测试变得更加健壮，因为您能够直接使用它们来做出您的断言:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5e74" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">做过头了</h1><p id="7bfd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">知道它有多有用之后，为你能想到的每一个可能的场景创建一堆自定义错误也变得很有诱惑力——尤其是当你刚刚开始学习JavaScript的时候。因此，如果您有一个中小型应用程序，并最终处于这样的情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e29c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后你可能会重新考虑这种方法，并决定你是否真的需要这样做。很多时候，提供更清晰的错误<code class="fe mz na nb nc b">message</code>就足够了。只有当您需要添加一些额外的上下文时，对自定义错误进行断言才能提供最大的好处(例如，对超时请求进行重试的令牌):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5de4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="c795" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">控制你的错误就能控制你的应用。这也为你节省了时间和金钱。</p><p id="84d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这标志着文章的结束。希望你觉得有用。以后多多关照！</p></div></div>    
</body>
</html>