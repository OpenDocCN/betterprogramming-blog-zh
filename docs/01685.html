<html>
<head>
<title>Migrating to the Cloud Without Screwing It Up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移到云而不搞砸它</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/migrating-to-the-cloud-without-screwing-it-up-ee8455ca0c9e?source=collection_archive---------9-----------------------#2019-10-04">https://betterprogramming.pub/migrating-to-the-cloud-without-screwing-it-up-ee8455ca0c9e?source=collection_archive---------9-----------------------#2019-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46e4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用AWS示例，以最短的停机时间迁移到云服务的实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fcfaadacc0ddce372b8b9c89d7f3baad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J4vxw9g8bcyuaXt1To-pdQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@dallasreedy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">达拉斯里德</a>在<a class="ae ky" href="https://unsplash.com/s/photos/cloud?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5e17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于一个随时可以扩展的应用程序来说，现在不使用托管云架构就像坚持自己挖井取水一样。这需要更多的劳动力，需要购买所有自己的设备，需要更多的时间，而且你出错的可能性更大，因为你个人没有太多挖井的经验。</p><p id="5d03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说——让我们先解决这个问题——没有云。只是别人的电脑。</p><p id="d17d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，如今，云服务已经远远超出了我们对单台电脑的期望。除了能够快速设置和利用以前需要新的办公室租赁协议才能容纳的那种计算能力之外，现在我们的指尖上有大量的监控、管理和分析工具。虽然理解云并非在所有情况下都是更好的选择很重要，但对于可以利用云的应用程序，我们可以做得更多、更快，并且比我们坚持构建自己的内部基础架构花费更少的钱。</p><p id="2ee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很好，说起来容易；然而，迁移到云从一开始就看起来是一项非常艰巨的任务。确切地说，我们如何着手将可能是多年的内部数据和构建的系统转移到其他人的计算机上？你知道，没有能够看到它，触摸它，没有完全搞砸我们的东西。</p><p id="9188" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这可能比在内部建立或维护相同的架构需要更少的工作和资金，但最初迁移到云确实需要一些工作。重要的是，我们的应用程序要做好迁移准备，并且一旦迁移成功，就能够利用云服务的优势。为了实现这一点和平稳过渡，准备是关键。事实上，这很像搬新房子。</p><p id="6d92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将从较高的层次来了解将本地或自托管应用程序迁移到云的一般阶段。本指南旨在作为针对您的特定情况设计适当流程的起点，并帮助您更好地理解云迁移流程。虽然云迁移对于某些应用程序来说可能不是最佳选择，例如没有可扩展架构的应用程序或需要大量计算资源的应用程序，但是大多数模块化的现代应用程序都会从向云的迁移中受益。</p><p id="5ed2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我在亚马逊网络服务(AWS)解决方案架构师最近举办的一次活动中发现的那样，平稳高效地迁移，对客户的可用性损失几乎为零，这是完全可能的。我会具体参考AWS提供的一些服务；然而，其他云提供商也有类似的功能。我发现AWS的产品在范围上令人愉快地模块化，这就是为什么我自己使用它们，也是为什么它们是讨论一般概念的好例子。</p><p id="c9d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让我们的搬迁尽可能顺利，我们需要考虑以下事项:</p><ol class=""><li id="292f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们正在采取的行动</li><li id="30e2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们要带走的东西和我们要清理的东西</li><li id="af1c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何为我们要迁移的基础架构选择正确的类型和规模</li><li id="7b0b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何为重要的一天做测试练习</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9e2d" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">1.我们正在采取的行动</h1><p id="72c9" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">虽然理解我们为什么要将应用程序迁移到云服务很重要，但是我们也应该知道我们希望应用程序迁移到云服务时是什么样子。迁移到云有三种主要方式:重新托管、重新平台化或重构。</p><h2 id="ee6b" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">重新主持</h2><p id="ebc2" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">重新托管是最直接的移动方式。它不涉及我们的应用程序的构建方式或运行方式的改变。例如，如果我们目前使用Python代码，使用PostgreSQL，并使用Apache为我们的应用程序提供服务，那么主机迁移将意味着我们使用所有相同的组件，以相同的方式组合，只是现在它们在云中。这很像搬进一个新房子，它的平面图和现在的一模一样。所有的家具都放在同一个房间里，当我们到达那里时，会感觉很熟悉。</p><p id="ca42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">迁移主机的主要好处是，它可以提供最少的复杂性，以便利用云优势。例如，可伸缩的应用程序可以获得自动管理必要应用程序资源的能力。</p><p id="51b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然重新托管使伸缩更加自动化，但重要的是要注意，它本身并不会使应用程序可伸缩。如果应用程序基础结构的组织方式不能让它具有伸缩能力，那么重构可能是必要的。</p><h2 id="51f8" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">重新搭建平台</h2><p id="99f3" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果我们当前应用程序设置的某个组件不适合我们，我们可能会想要重新构建平台。在这种情况下，我们对架构的至少一个组件进行了更改，例如，将我们的数据库从Oracle切换到Amazon关系数据库服务(RDS)上的MySQL。</p><p id="bfc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像从东京的一个小公寓搬到纽约的一个同样小的公寓一样，一个重新搭建的平台不会改变我们的应用程序的基本性质，但是它会改变它的外观和环境。在数据库变更示例中，我们将拥有所有相同的数据，只是组织或格式稍有不同。在大多数情况下，我们不必手动进行这些更改。像亚马逊数据库迁移服务(DMS)这样的工具可以帮助我们无缝地将数据转移到新的数据库。</p><p id="9904" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能会重新搭建平台，以便能够更好地满足未来的业务需求，例如向上扩展、与其他技术组件集成，或者选择更现代的技术堆栈。</p><h2 id="4f67" class="nn mr it bd ms no np dn mw nq nr dp na li ns nt nc lm nu nv ne lq nw nx ng ny bi translated">重构</h2><p id="7cf3" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们重构应用程序的步骤必然比我们的其他选择更复杂。然而，它可能为有理由进行这种迁移的公司或应用程序提供最大的整体利益。与代码一样，当为了让我们的应用程序满足业务需求而需要进行根本性的改变时，就要进行重构。具体细节必然会因情况而异，但通常会涉及到架构组件或这些组件如何相互关联的更改。这种类型的迁移还可能涉及更改应用程序代码，以便优化应用程序在云环境中的性能。</p><p id="d3be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以把它想象成从父母在郊区的地下室里搬出去，在城市里得到一栋漂亮的联排别墅。我们不可能拿走那张旧沙发，所以我们需要一些新家具，为了邻居的缘故，可能还需要窗饰。</p><p id="f410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重构可以让我们更新一个过时的应用程序，或者让它更有效率。随着效率的提高，我们可以更好地利用云提供商通常提供的服务，如爆发资源或获得深入的分析洞察力。</p><p id="93bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果重构是必要的，但是时间有限，那么最好先重新托管或重新搭建平台，然后再重构。这样，我们就可以在以后很好地完成工作，而不是很快地进行草率、拙劣的迁移(以及更多的问题)。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="6733" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">2.带走什么，清理什么</h1><p id="8a7e" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在一个地方生活多年后，东西往往会堆积在不为人知的角落和缝隙里。搬家时，这通常是一个很好的机会来整理所有的东西，决定哪些东西足够有用可以保留，哪些东西应该丢弃或送人。对于我们的应用程序来说，迁移到云也是一个做同样事情的好机会。</p><p id="e632" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然云存储现在很便宜，但有些东西可能不再存储有意义，或者至少不要与我们的主要应用程序一起存储。如果由于政策或法规而无法丢弃数据，我们可能会选择不同的存储类别来存放我们预计不会在主应用程序之外很快需要的数据。</p><p id="1c34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在亚马逊的简单存储服务(S3)中，我们可以选择使用不同的存储类来实现这个目标。虽然我们的业务每天所依赖的数据可以利用标准类99.99%的可用性，但意味着长期冷存储的数据(如归档备份)可以放入Glacier类，该类具有更长的检索时间和更低的成本。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9b10" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">3.正确的类型和尺寸</h1><p id="0368" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">选择适合我们业务的云基础架构的类型和规模通常是最令人困惑的部分。我们应该如何预测，在一个新的环境中或者对于一个成长中的公司，我们将需要的计算能力？</p><p id="f033" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不自行采购硬件的好处之一是，我们不必做出这样的预测。使用云存储和实例，扩展或缩减资源可以在几分钟甚至几秒钟内完成。借助托管服务，我们甚至可以自动完成这项工作。在我们的应用程序中有了对可伸缩性的适当支持，就像有了一个神奇的房子，可以立即生成我们当时需要的任何类型的房间和设施。持续确保我们使用适当的、经济高效的资源的能力唾手可得，并且通常在图表和仪表盘中清晰可见。</p><p id="4c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于新的云应用程序，一些实验的余地可能是必要的。虽然云服务使我们能够快速启动并尝试不同的架构，但不能保证所有这些设置都适用于我们的应用程序。例如，运行单个实例可能比不运行服务器更便宜，但是在我们尝试之前，我们很难知道这一点。</p><p id="078d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们只需要足够的存储和计算能力来支持当前运行的应用程序。例如，在存储方面，考虑当前数据库的大小，即实际的数据库数据，而不是本地硬件的总存储容量。对于详细的成本探索，AWS甚至提供了一个简单的月度计算器，其中包含用例样本，以帮助指导预期。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d405" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">4.在重要的日子之前进行测试</h1><p id="5df7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">运行试用云迁移可能是一个奇怪的概念，但它是确保迁移按计划进行且服务中断最小化的一个重要组成部分。想象一下，如果我们能够自动化测试运行，在移动房屋的例子中会节省多少时间和精力！总有一些盒子或仍然挂着的照片被遗忘在主卡车外面，需要乘坐其他车辆进行额外的旅行。我们有多种机会来确保一切顺利，从而最大限度地降低了我们的行动对日常业务造成任何影响的可能性。</p><p id="85f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，为了进行测试运行，我们创建应用程序的一个复制版本。我们复制的越多，测试运行就越彻底，尤其是当我们的数据特别大的时候。虽然复制可能看起来很乏味，但是使用我们打算迁移的实际组件对于确保迁移按计划进行是至关重要的。毕竟，如果我们只用一个盒子做搬家测试，那就不太具有代表性。</p><p id="e087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试运行有助于针对我们可能遇到的任何挑战来验证我们的迁移计划。这些挑战可能包括:</p><ul class=""><li id="cf7b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nz mb mc md bi translated">停工限制</li><li id="d97f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">对传输中的数据以及静止在目标上的数据立即进行加密</li><li id="d587" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">到新目标模式的模式转换</li><li id="c788" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">对数据库的访问，如通过防火墙或VPN</li><li id="4877" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">开发一个流程来确保所有数据成功迁移，例如通过使用哈希函数</li></ul><p id="78b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试运行还有助于我们更准确地了解迁移所需的总时间，并为我们提供微调的机会。可能影响迁移总体速度的因素包括:</p><ul class=""><li id="7a4a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nz mb mc md bi translated">源实例和目标实例的大小</li><li id="7e79" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">移动数据的可用带宽</li><li id="ea13" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">架构配置</li><li id="109f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nz mb mc md bi translated">源上的事务压力，例如数据的更改和传入事务的数量</li></ul><p id="3649" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦通过一个或多个选项迁移了重复的应用程序，我们就对现在运行在云中的应用程序进行测试，以确保它按预期执行。理想情况下，在重要的一天，我们会遵循相同的一般流程来移动最新的重复数据，然后无缝地将实际的应用程序或网址指向云中的新位置。这意味着我们的客户几乎没有停机时间；本质上，仅仅是位置指向的变化需要传播到他们的设备的时间量。</p><p id="7a51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在有许多组件或许多团队同时一起工作的非常大或复杂的应用程序的情况下，更渐进的方法可能比大爆炸方法更合适，并且可能有助于减轻任何中断的风险。这意味着分阶段、一个组件接一个组件地进行迁移，并在不同阶段之间运行测试，以确保应用程序的所有部分都按照预期相互通信。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="4613" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">准备工作对于顺利迁移至关重要</h1><p id="ac23" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我希望这篇文章对如何实现云迁移有了更实际的理解。有了充分的准备，就有可能利用云所提供的一切优势，并以最少的麻烦达到目的。</p></div></div>    
</body>
</html>