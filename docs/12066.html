<html>
<head>
<title>Building a Custom Alexa Skill — Order Me a Coffee</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立一个定制的Alexa技能——给我点一杯咖啡</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-custom-alexa-skill-challenges-faced-and-whats-the-solution-part-1-2948e2578563?source=collection_archive---------13-----------------------#2022-05-09">https://betterprogramming.pub/building-a-custom-alexa-skill-challenges-faced-and-whats-the-solution-part-1-2948e2578563?source=collection_archive---------13-----------------------#2022-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a292" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第1部分:面临挑战的完整解决方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c93c478da4f3a96e42e85a3bd60da340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ty0uj3gI5yAdOxX5vgvo1g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">echo Dot——支持Alexa的设备</p></figure><p id="9f51" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将是一个多部分的系列，我将分享我应对挑战的经验，例如:</p><ol class=""><li id="8480" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">如果您正在考虑扩展您的技能客户群，则需要掌握支持不同语言的不同地区的多语言技能</li><li id="dc62" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用实时位置进行反向地理编码以获得位置敏感技能</li><li id="6385" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">如何解决延迟问题以改善用户体验等等</li></ol><p id="590b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这部分将是所有关于自定义Alexa技能的基础建筑师。</p><p id="263b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好吧，我们开始吧。尽情享受吧！</p><h1 id="672d" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">Alexa技能介绍</h1><p id="fb9f" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">好吧，让我们从基础开始:什么是Alexa技能？</p><p id="8961" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就像你可以使用谷歌Play商店中的应用程序一样，技能商店中也有专门针对Alexa设备所在地区的技能。您可以使用这些命令执行多组操作。就是这样。</p><p id="db05" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，假设我在本地商店的Alexa设备中有一项名为“咖啡太妃糖”的技能。我可以转到该技能，启用它并检查它是如何被调用和使用的。可以通过说“Alexa，附近有咖啡太妃糖店吗？”你可以通过说“点一杯卡布奇诺”来点一杯咖啡，并在旅途中使用。</p><h1 id="1310" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">获得Alexa自定义技能基础架构️</h1><p id="0fd2" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">以下是你创建自己的Alexa技能的步骤。(我们也要这么做):</p><ol class=""><li id="76cc" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">规划和设计你的技能</li><li id="3c74" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">在开发者控制台中设置技能</li><li id="ac74" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用声音设计来构建您的交互模型</li><li id="887b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">编码并测试您的技能</li><li id="ca83" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">测试你的技能</li><li id="6217" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">提交您的技能进行认证</li></ol><h1 id="e638" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">规划和设计你的技能</h1><p id="6ca1" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">首先，确定你的技能的价值主张:你的技能将为客户提供什么价值？“我们的技能将是‘咖啡太妃糖’，所以我们将帮助我们的顾客在旅途中点他们最喜欢的咖啡。</p><p id="7e54" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，直奔设计，设计一个语音用户界面。这映射出了交互以及你的用户将如何与你的技能交互。</p><h1 id="e3b2" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">在开发人员控制台中设置技能</h1><p id="02a2" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">首先，在开发人员控制台中创建一个新技能。我使用了以下内容:</p><ul class=""><li id="c041" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq nc lx ly lz bi translated">“咖啡太妃糖”作为我的技能名称</li><li id="aadf" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">主要区域设置英语(输入)</li><li id="be96" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">为我的技能定制模型</li><li id="ebf9" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">Alexa托管的(Python)资源为我的技能的后端资源</li><li id="fedf" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">托管区域欧盟(爱尔兰)</li><li id="e706" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">没有模板(从头开始)</li></ul><p id="ca87" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在使用Alexa托管的资源时遇到问题，因为它们是有限的。我建议创建你自己的AWS帐户，并使用它作为后端资源，因为它为你提供了更多的灵活性和尽可能多的资源。</p><h1 id="57bc" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">使用声音设计来构建您的交互模型</h1><p id="0734" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">交互模型指的是您的调用名、意图集合、示例语句和插槽。</p><ul class=""><li id="c841" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq nc lx ly lz bi translated">调用<code class="fe nd ne nf ng b">name</code>——你在Alexa中用来调用技能的名字，比如咖啡太妃糖</li><li id="11d0" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated"><code class="fe nd ne nf ng b">Intents </code> —你的技能可以处理的请求，比如点一杯咖啡</li><li id="0df5" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">示例话语——它将意图映射到用户可以说的单词和短语，以与您的技能进行交互，如“我想点一杯卡布奇诺”、“为我点一杯卡布奇诺”、“为我点一杯卡布奇诺”等等</li><li id="dfc2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq nc lx ly lz bi translated">你的意图可以选择性地包含称为老虎机的参数，例如，“我要一杯卡布奇诺”，“我要一杯浓缩咖啡”，或者“我要一杯拿铁咖啡”我们看到，咖啡饮料是一个论证，即<code class="fe nd ne nf ng b">slot</code>在这个特定的意向中。</li></ul><p id="8e4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我使用开发人员控制台，构建→交互模型→意图，并添加意图、示例语句和花括号{}中的位置。当创建话语时，您可以使用预定义的类型，如槽类型的<code class="fe nd ne nf ng b">AMAZON.Person</code>。这使用一个人的名字或创建一个自定义的名字，就像我们正在做的通过在槽类型中创建槽类型，然后在意向中分配它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/6fc6432a62ab1132392b5b16fa1b5c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1A3aQGSosL9UfwLPmxTaRQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加意图、示例话语和时段</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/9ab65557d6e02856373de7fff982091d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zvOrMv9w_QDB-W-shdFTIg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">定义自定义插槽及其值</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/5e30e0098252c8a876259aa71ce8716b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_H5-8K0HV9nDWikVO919SQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">指定插槽及其对应的类型</p></figure><p id="493a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以进入交互模型→JSON编辑器来检查为您对应的语音交互模型生成的JSON。下面是一些代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">JSON编辑器</p></figure><p id="7b4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以利用JSON编辑器、开发人员控制台或CLI来创建您的交互模型；这完全取决于你是否方便。</p><h1 id="d40e" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">编码并测试您的技能</h1><p id="f856" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">让我们来看看开发人员控制台中的代码部分，</p><p id="11c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们被提供了一个AWS Lambda(一个<a class="ae nm" href="http://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> Amazon Web Services </a>产品)，它让我们可以在云中运行代码，而无需管理服务器。</p><p id="cc80" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您的技能的主要编码任务是创建一个可以接受来自Alexa服务的请求并发回响应的服务，这是我们利用类的帮助实现的。</p><p id="a8af" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们为我们从Alexa服务中收到的每一种类型的请求创建类，这取决于我们为我们的技能指定的意图。此外，我们为启动请求预定义了几个类，并内置了支持我们技能的<code class="fe nd ne nf ng b">intents</code>。</p><p id="420a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每个类有两个主要功能，即:</p><ol class=""><li id="7b98" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><code class="fe nd ne nf ng b">can_handle</code> —检查已定义的目的名称</li><li id="85c5" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><code class="fe nd ne nf ng b">handle</code> —它利用从Alexa服务发送的请求及其属性向用户发送适当的响应</li></ol><p id="60cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于我们的订单咖啡意向处理程序，您可以在<code class="fe nd ne nf ng b">can_handle</code>函数中看到以下内容:</p><ol class=""><li id="1112" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">使用<code class="fe nd ne nf ng b">is_intent_name</code>检查其定义的意图是否为“订购咖啡意图”</li><li id="377a" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">然后在<code class="fe nd ne nf ng b">handle</code>中，它使用<code class="fe nd ne nf ng b">handler_input. request_envelope. request. intent. slots[‘coffeedrink’] .value</code>获取“coffeedrink”槽的槽值</li><li id="f8ce" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">然后使用来自用户输入的值，它为用户构建输出，同时使用<code class="fe nd ne nf ng b">handler_input. response_builder. speak(speak_output). set_should_end_session(True)</code>结束该技能的特定会话</li><li id="bd39" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">然后它返回相同的响应</li></ol><p id="a665" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="a5aa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您想知道我们是如何访问这些值的，您可以查看从Alexa服务发送的示例请求。看看我们是如何从JSON请求中的<code class="fe nd ne nf ng b">request. intent. slots[‘coffeedrink’]. value</code>之后的请求中访问槽值的。</p><p id="6df3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是更多代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="b9f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后我们将每个请求处理程序添加到技能的最后；那是非常重要的。我已经按照我的意图编写了代码，但我没有触及内置意图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AWS Lambda代码</p></figure><p id="6faf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您在开发人员控制台中使用自定义AWS资源，请使用您的端点(例如，Lambda ARN)更新您的技能。</p><p id="a5ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后我们直接进入测试部分，在那里我们检查我们的技能是否有效。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/eae4df3d4bfe7b96509e0549b8c19f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPru2D8PHnZ7Oq-qTVsqqg.png"/></div></div></figure><p id="60dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这对我们来说很好。</p><h1 id="3836" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">测试你的技能</h1><p id="ea06" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">一旦你的技能完成，你可以选择为你的技能设置一个测试。通过beta测试，您可以将您的技能提供给您个人选择的有限的测试人员群体，而不是普通大众。</p><p id="ebe9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们来看看开发人员控制台中的分发会话。</p><p id="7f79" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的语言环境的技能预览中，添加一句话的描述、详细描述、示例短语(意图)、小技能图标、大技能图标、类别、关键字和隐私策略URL。对该技能的隐私和法规遵从性部分进行同样的操作。</p><p id="546a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后在“可用性”部分，授予公共访问权限。在beta测试中，添加beta测试管理员的电子邮件地址，然后添加测试人员的电子邮件地址，用“，”分隔。输入测试人员的电子邮件地址后，启用beta测试。</p><p id="01d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你跳过任何选项，你可能无法对你的技能进行测试，因为所有这些都是Alexa技能商店所需要的。</p><p id="6d53" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，测试人员会收到一封邀请邮件，邀请他们对技能进行beta测试，并且可以选择在邮件中启用该技能。做必要的，然后做测试。</p><p id="8849" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你点击“更多”，然后前往你的Alexa的活动部分，你可以看到你的声音历史。它看起来会像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/a866b713ccd202bc4415cca24565daf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Lq56Q-B8hkDNI8KkGh_uQ.jpeg"/></div></div></figure><p id="fc29" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后你继续增加更多的技能。当您认为您的技能可以向公众发布时，您可以提交您的技能进行认证。这有一个清单；你可以在这里找到更多相关信息。</p><div class="np nq gp gr nr ns"><a href="https://developer.amazon.com/en-US/docs/alexa/custom-skills/steps-to-build-a-custom-skill.html" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">构建自定义技能的步骤| Alexa技能包</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">本指南提供了创建新的自定义技能的步骤。自定义交互模型是否适合您…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">developer.amazon.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kp ns"/></div></div></a></div></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="568a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好了，暂时就这样了。我很快会带着同一系列的另一部分回来。</p></div></div>    
</body>
</html>