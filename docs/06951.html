<html>
<head>
<title>Create Your Own Text Replacement Tool With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python创建自己的文本替换工具</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-your-own-text-replacement-tool-with-python-60a9e4ee8461?source=collection_archive---------8-----------------------#2020-11-19">https://betterprogramming.pub/how-to-create-your-own-text-replacement-tool-with-python-60a9e4ee8461?source=collection_archive---------8-----------------------#2020-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e12a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">自动化生活的简单宏(第1部分)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bf1c31e0c8c228442a82f11fbde0d60e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2xpFi7HrbwX8Mq892lBfA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">约翰尼斯·普莱尼奥在Unsplash<a class="ae kv" href="https://unsplash.com/s/photos/future?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a></p></figure><p id="f841" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">文本替换、<em class="ls">或宏、</em>是你日常使用电脑时最简单、最方便的工具。你是否发现自己一整天都在一遍又一遍地输入同样的东西？使用宏就像让机器人替你做枯燥和重复的事情，帮助你节省时间和精神带宽。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/899b4a9373655b0d86402dd32d138ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/1*VeH6V_ZcFjee6xN3UXucNA.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">宏类型和替换示例</p></figure><p id="f1d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们考虑一个简单的例子:你输入<em class="ls"> #myname，</em>按<em class="ls"> space </em>，文本被替换为你的名和姓——酷吧？用不到40行代码，你就可以用Python创建自己的文本替换工具。所以让我们开始吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/4e76f7c414872bd443c099a2dc1ba396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VapNniGKyf_2yoKTnAwYRg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="lv lw ep" href="https://medium.com/u/5c7773c5a002?source=post_page-----60a9e4ee8461--------------------------------" rel="noopener" target="_blank">像素</a>用户:<a class="ae kv" href="https://www.pexels.com/@negativespace" rel="noopener ugc nofollow" target="_blank">负空间</a></p></figure><p id="48a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简而言之，我们想要键入一个将被其<code class="fe lx ly lz ma b">replacement</code> <em class="ls">替换的关键字。</em>我们输入的单词就是我们的候选关键词<em class="ls">。</em>如果候选关键字存在于我们的替换列表中，我们将替换它。</p><p id="d9db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本教程分为六个部分:</p><ol class=""><li id="bdd9" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated"><a class="ae kv" href="#c1e0" rel="noopener ugc nofollow">设置项目</a></li><li id="bdc8" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="#4ab8" rel="noopener ugc nofollow">定义<em class="ls">关键字</em>和<em class="ls">替换</em>和</a></li><li id="8528" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="#8289" rel="noopener ugc nofollow">检测键盘输入</a></li><li id="0c97" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="#eee8" rel="noopener ugc nofollow">识别<em class="ls">候选关键字</em> </a></li><li id="8cf5" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="#9a40" rel="noopener ugc nofollow">对照<em class="ls">替换</em>字典</a>检查<em class="ls">候选</em></li><li id="cfbd" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="#0c14" rel="noopener ugc nofollow">用<em class="ls">替换</em> </a>替换<em class="ls">候选关键字</em></li></ol><p id="b543" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们把手弄脏吧！</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="c1e0" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">1.设置项目</h1><p id="8c55" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">为了<em class="ls">检测</em>和<em class="ls">在Python中发送</em>键盘输入，我们将分别使用<code class="fe lx ly lz ma b"><a class="ae kv" href="https://pypi.org/project/pynput/" rel="noopener ugc nofollow" target="_blank">pynput</a></code>和<code class="fe lx ly lz ma b"><a class="ae kv" href="https://pypi.org/project/PyAutoGUI/" rel="noopener ugc nofollow" target="_blank">pyautogui</a></code>。通过pip安装，如下所示:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="4053" class="nx mx iq ma b gy ny nz l oa ob">pip install pynput<br/>pip install pyautogui</span></pre><p id="ce97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">如果你想了解更多关于pip的知识，可以看看Jessica Saini的文章，</em> <a class="ae kv" href="https://medium.com/swlh/heres-a-quick-way-to-learn-about-pip-in-python-18617d466c59" rel="noopener"> <em class="ls">这里有一个快速了解Python中PIP的方法</em> </a></p><p id="8b30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装好这两个模块后，让我们开始编码。新建一个Python脚本，从<code class="fe lx ly lz ma b">pynput.keyboard</code>导入<code class="fe lx ly lz ma b">Key</code><code class="fe lx ly lz ma b">Listener</code><em class="ls"/>以及整个<code class="fe lx ly lz ma b">pyautogui</code> <em class="ls"> </em>模块。</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="b6e9" class="nx mx iq ma b gy ny nz l oa ob">#text_replacer.py</span><span id="2ca5" class="nx mx iq ma b gy oc nz l oa ob">from pynput.keyboard import Key, Listener<br/>import pyautogui</span></pre></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="4ab8" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">2.定义关键字和替换</h1><p id="ea88" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">我们将在一个<a class="ae kv" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries" rel="noopener ugc nofollow" target="_blank">字典</a>类型变量中定义我们的替换。将我们的<code class="fe lx ly lz ma b">Keyword</code> s <em class="ls"> </em>和<code class="fe lx ly lz ma b">Replacement</code> s <em class="ls"> </em>保存为词典中的<code class="fe lx ly lz ma b">key</code> s <em class="ls"> </em>和<code class="fe lx ly lz ma b">values</code> <em class="ls"> </em>将允许我们以后方便地引用它们。将以下内容添加到Python文件中:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="5efd" class="nx mx iq ma b gy ny nz l oa ob">replacements = {"myname": "Firstname Lastname",<br/>                "mymail": "abc@def.com",<br/>               }</span></pre><p id="e84b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们定义了两个替换。每当我们输入<code class="fe lx ly lz ma b">myname</code>，我们的脚本就会用<code class="fe lx ly lz ma b">Firstname Lastname</code> <em class="ls">、</em>替换它，同样的还有<code class="fe lx ly lz ma b">mymail</code> <em class="ls"> </em>和<code class="fe lx ly lz ma b">abc@def.com</code> <em class="ls">。还没有，还有一些其他的工作要做，但是我们会完成的！</em></p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="8289" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">3.检测键盘输入</h1><p id="a7b4" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">为了让Python程序检测我们输入的内容，我们需要监听键盘事件。幸运的是，使用<code class="fe lx ly lz ma b">pynput</code>很容易做到这一点。</p><p id="4eb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们首先定义<code class="fe lx ly lz ma b">on_press()</code>函数，每次<code class="fe lx ly lz ma b">pynput</code>检测到按键时都会调用该函数。该方法将<code class="fe lx ly lz ma b">key</code> <em class="ls"> </em>作为参数。现在，我们将只打印控制台的密钥，以验证一切工作正常:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="5ddf" class="nx mx iq ma b gy ny nz l oa ob">def on_press(key):<br/>    Print(key)</span></pre><p id="8334" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要设置一个监听器，这个监听器将<em class="ls">监听</em>我们的键盘按键。如下定义您的监听器方法:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="9127" class="nx mx iq ma b gy ny nz l oa ob">with Listener(on_press=on_press) as listener:<br/>    listener.join()</span></pre><p id="e92e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有很多事情正在进行，但是<code class="fe lx ly lz ma b">pynput</code>处理了其中的大部分。我们只需要知道这个监听器会在一个键被按下的时候调用<code class="fe lx ly lz ma b">on_press()</code> <em class="ls"> </em>并把这个键作为参数传递。您已经可以运行这个脚本，并检查您按下的所有键是否都打印在控制台中。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="eee8" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">4.识别<em class="od">候选关键字</em></h1><p id="d53f" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">现在我们的程序只是读取每一个按键并将它们打印到控制台，但这远不是我们想要实现的。理想情况下，我们希望将这些按键转换成单词，或<em class="ls"> </em> <code class="fe lx ly lz ma b"><em class="ls">Candidate Keywords</em></code>，并对照我们的<code class="fe lx ly lz ma b">replacements</code>列表检查它们。</p><p id="ac73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了容易地识别候选单词，我们需要定义一个宏的开始和结束时间或位置。我们开始用一个<code class="fe lx ly lz ma b">macro_starter</code> <em class="ls">来定义我们的宏。然后，我们键入候选关键字，并以<code class="fe lx ly lz ma b">macro_ender</code>结束。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/aafb5ea87caf7f1889c50a30a8e0fa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*z1LLq8XuA8Kp6FBOgg9TcA.png"/></div></figure><blockquote class="of og oh"><p id="137e" class="kw kx ls ky b kz la jr lb lc ld ju le oi lg lh li oj lk ll lm ok lo lp lq lr ij bi translated">考虑我们键入' #myname '并按空格键提交宏的例子。hashtag(#)是我们的<strong class="ky ir">macro _ starter</strong>,‘my name’是我们的<strong class="ky ir"> candidate_keyword </strong>并且宏是按空格键提交的，所以空格键盘是我们的<strong class="ky ir"> macro_ender </strong>。</p></blockquote><p id="3f46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在键入一个宏启动程序后，我们将在一个名为<code class="fe lx ly lz ma b">typed_keys</code> <em class="ls">的列表中跟踪所有作为字符键入的字母数字键。当空间被占用时，我们将停止保存按键。</em></p><p id="375d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe lx ly lz ma b">on_press</code> <em class="ls"> </em>方法定义和<code class="fe lx ly lz ma b">listener</code>之间添加以下代码行:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="5355" class="nx mx iq ma b gy ny nz l oa ob">macro_starter = '#'<br/>macro_ender = Key.space<br/>typed_keys = []<br/>listening = True</span></pre><p id="cfad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将修改<code class="fe lx ly lz ma b">on_press</code>来做我们上面解释的事情:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="d10e" class="nx mx iq ma b gy ny nz l oa ob">def on_press(key):<br/>    global typed_keys<br/>    global listening</span><span id="0408" class="nx mx iq ma b gy oc nz l oa ob">    key_str = str(key).replace('\'', '')</span><span id="1f93" class="nx mx iq ma b gy oc nz l oa ob">    if key_str == macro_starter:<br/>        typed_keys = []<br/>        listening = True</span><span id="8108" class="nx mx iq ma b gy oc nz l oa ob">    if listening:<br/>        if key_str.isalpha():<br/>            typed_keys.append(key_str)</span><span id="224b" class="nx mx iq ma b gy oc nz l oa ob">        if key == macro_ender:<br/>            candidate_keyword = ""<br/>            candidate_keyword = <em class="ls">candidate_keyword</em>.join(typed_keys)<br/>            if <em class="ls">candidate_keyword</em> != "":<br/>                #logic for replacements in next chapter</span></pre><blockquote class="of og oh"><p id="1df5" class="kw kx ls ky b kz la jr lb lc ld ju le oi lg lh li oj lk ll lm ok lo lp lq lr ij bi translated">这是一大堆代码，记住每次按键都会运行这段代码，所以让我们一步一步地分析它:</p></blockquote><p id="c207" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一行获取<code class="fe lx ly lz ma b">key object</code>并将其作为字符串返回。这将允许我们从所有按下的键中创造一个单词。</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="c620" class="nx mx iq ma b gy ny nz l oa ob"><em class="ls">key_str = str(key).replace(‘\’’, ‘’)</em></span></pre><p id="00d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，如果按下的键与我们的<code class="fe lx ly lz ma b">macro_starter</code>(本例中为#键)相同，我们清空<code class="fe lx ly lz ma b">typed_keys</code>变量并将<code class="fe lx ly lz ma b">listening</code>设置为<code class="fe lx ly lz ma b">True</code>。</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="b6db" class="nx mx iq ma b gy ny nz l oa ob"><em class="ls">if key_str == macro_starter:<br/>    typed_keys = []<br/>    listening = True</em></span></pre><p id="64b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果在按下next键时listening为真，我们要检查该键是否是字母数字(a-Z，0–9)。如果是这样，我们把它添加到我们的类型化键列表中。</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="6a95" class="nx mx iq ma b gy ny nz l oa ob"><em class="ls">if listening:<br/>    if key_str.isalpha():<br/>        typed_keys.append(key_str)</em></span></pre><p id="5416" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后但同样重要的是，一旦我们按下宏ender键，我们将通过加入<code class="fe lx ly lz ma b">typed_keys</code> <em class="ls">列表来定义我们的<code class="fe lx ly lz ma b">candidate_keyword</code>。这将把一列字母转换成一个格式整齐的单词。然后，在继续之前，我们确保关键字不为空:</em></p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="f54c" class="nx mx iq ma b gy ny nz l oa ob"><em class="ls">if key == macro_ender:<br/>    candidate_keyword = ""<br/>    candidate_keyword = candidate_keyword.join(typed_keys)<br/>        if candidate_keyword != "":<br/>            #logic for replacements</em></span></pre><p id="e56d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将根据我们创建的替换字典检查这个候选关键字，看它是否匹配有效的宏替换！</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="9a40" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">5.对照替换词典检查候选项</h1><p id="84ff" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">在我们继续向程序中输入任何代码之前，让我们看看我们所处的位置以及我们需要什么。</p><p id="7fb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在有一个<code class="fe lx ly lz ma b">candidate_keyword</code>，我们需要检查它是否作为一个键存在于我们的<code class="fe lx ly lz ma b">replacements</code> <em class="ls"> </em>字典中。Python用<code class="fe lx ly lz ma b"><em class="ls">if candidate_keyword in replacements.keys():</em></code> <em class="ls">简化了这一点。</em></p><p id="425d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个简单的行将检查我们的<code class="fe lx ly lz ma b">candidate_keyword</code>是否匹配<code class="fe lx ly lz ma b">replacements</code>中的任何键。</p><p id="6d7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你创建了和我们一样的例子，我们的键是<code class="fe lx ly lz ma b">myname</code> <strong class="ky ir"> </strong>和<strong class="ky ir"> mymail </strong>，它的值是<code class="fe lx ly lz ma b">Firstname</code>、<strong class="ky ir"> </strong> <code class="fe lx ly lz ma b">Lastname</code>、<strong class="ky ir"> </strong>和<code class="fe lx ly lz ma b">abc@def.com</code>。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="0c14" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">6.用替换项替换候选关键字</h1><p id="b421" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">在我们继续之前，让我们分解一下接下来需要发生的事情:</p><ol class=""><li id="5f4a" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">删除我们键入的内容</li><li id="7d44" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">键入替换文本</li></ol><p id="e2b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了删除我们输入的内容，我们用<em class="ls"> </em> <code class="fe lx ly lz ma b"><em class="ls">len(candidate_keyword)</em></code> <em class="ls"> </em>加上<code class="fe lx ly lz ma b">2</code>来计算<code class="fe lx ly lz ma b">candidate_keyword</code>有多长。一个用于<code class="fe lx ly lz ma b">#</code>一个用于我们键入的空格<em class="ls">开始检测</em>和<em class="ls">提交</em>宏。我们现在需要多次按下<em class="ls">退格键</em>。我们将使用<code class="fe lx ly lz ma b">pyautogui</code>的<code class="fe lx ly lz ma b">press()</code>，它将一个<em class="ls">键</em>和一个<em class="ls">按压次数</em>作为参数<code class="fe lx ly lz ma b"><em class="ls">pyautogui.press('backspace', presses=len(candidate_keyword)+2)</em></code> <em class="ls">。</em></p><p id="fb93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们只需键入替换文本。我们用<code class="fe lx ly lz ma b"><em class="ls">replacements[candidate_keyword]</em></code>从我们的字典中获取替换。Pyaytogui有一个名为<code class="fe lx ly lz ma b">typewrite()</code>的简洁方法，它模拟键盘输入您作为参数传入的任何内容。所以我们把打字机和我们的替换物叫做<code class="fe lx ly lz ma b"><em class="ls">pyautogui.typewrite(replacements[candidate_keyword])</em></code> <em class="ls">。</em></p><p id="3508" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们得到我们在第5和第6节中涉及的所有内容，并继续我们的代码。删除我们在第4节<code class="fe lx ly lz ma b"><em class="ls">#logic for replacements in next chapter</em></code> <em class="ls"> </em>中留下的注释，并将整个块粘贴到下面:</p><pre class="kg kh ki kj gt nt ma nu nv aw nw bi"><span id="4a26" class="nx mx iq ma b gy ny nz l oa ob">if candidate_keyword in replacements.keys():<br/>    pyautogui.press('backspace', presses=len(candidate_keyword)+2)<br/>    pyautogui.typewrite(replacements[candidate_keyword])<br/>    listening = False</span></pre><p id="f974" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在运行你的Python脚本，导航到任何你可以输入文本的地方，输入<code class="fe lx ly lz ma b">#myname</code>，然后按空格键。你的小程序要删除宏，换成<code class="fe lx ly lz ma b">Firstname</code> <em class="ls"> </em> <code class="fe lx ly lz ma b">Lastname</code>。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="9fd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">恭喜你，你做到了！你可以把<code class="fe lx ly lz ma b"><em class="ls">macro_starter</em></code>和<code class="fe lx ly lz ma b"><em class="ls">macro_ender</em></code>改成任何适合你需要的，或者在<code class="fe lx ly lz ma b">replacements</code> <em class="ls"> </em>字典中添加<code class="fe lx ly lz ma b">keywords</code> <em class="ls"> </em>和<code class="fe lx ly lz ma b">replacements</code>，这段代码是这个项目非常基本的基础，你可以随意使用它！</p><p id="3f84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这绝不是好代码。它迫切需要一些重构、注释，并且可以被简化。同一Python脚本中的字典很难成为存储我们的<code class="fe lx ly lz ma b">keywords</code> <em class="ls"> </em>和<code class="fe lx ly lz ma b">replacements</code><em class="ls"/>以及一些额外的可用性和功能性的最佳解决方案。</p><p id="795a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在接下来的章节中，我们将介绍:</p><ul class=""><li id="b7d7" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr ol mh mi mj bi translated">重构和注释</li><li id="0dec" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr ol mh mi mj bi translated">保存和加载JSON</li><li id="9423" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr ol mh mi mj bi translated">通过命令行修改设置</li><li id="b20c" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr ol mh mi mj bi translated">添加和删除<em class="ls">关键字</em>和<em class="ls">替换</em></li></ul><p id="577a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一章中，我们将重构我们的代码并将我们的<code class="fe lx ly lz ma b">replacements</code> <em class="ls"> </em>移动到一个JSON文件中。</p><p id="ee24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在<a class="ae kv" href="https://github.com/Khalanar/Simple-Macros-with-Python/blob/main/part_1/text_replacer.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到本教程各部分的代码。</p></div></div>    
</body>
</html>