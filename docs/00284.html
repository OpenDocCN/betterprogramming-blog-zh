<html>
<head>
<title>How to Highlight and Multi-Select Items in a FlatList Component- React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何突出显示和多选平面列表组件中的项目</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-highlight-and-multi-select-items-in-a-flatlist-component-react-native-1ca416dec4bc?source=collection_archive---------1-----------------------#2019-02-04">https://betterprogramming.pub/how-to-highlight-and-multi-select-items-in-a-flatlist-component-react-native-1ca416dec4bc?source=collection_archive---------1-----------------------#2019-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0331" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">操纵平面列表中的项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7dbdd86c7cadf6767c6c234d48424eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juZZe0SbI8E_QPd74Ax9uA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马克斯·尼尔森在<a class="ae ky" href="https://unsplash.com/photos/taiuG8CPKAQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="7adb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在使用<a class="ae ky" href="http://www.reactnative.com/" rel="noopener ugc nofollow" target="_blank"> React native </a>处理来自API或表单字段的各种客户端数据和细节的列表，那么您可能听说过一个<code class="fe lv lw lx ly b">Flatlist</code>组件。基本上，<code class="fe lv lw lx ly b">Flatlist</code>是一个核心组件，用于高效显示变化数据的垂直滚动列表。它是0.43版本之后React native中出现的一个组件。它取代了<code class="fe lv lw lx ly b">ListView</code>组件，增强了开发者更容易处理列表的能力。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/bf81bc95c2d7eae5972dba16c2e46c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*_cuGdhKvwBN7ycBJqWk07g.png"/></div></figure><h2 id="0300" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated">什么是Flatlist？我们如何用它来显示动态或静态列表？</h2><p id="85f9" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated"><code class="fe lv lw lx ly b">FlatList</code>是一个简单的组件，引入它是为了消除<code class="fe lv lw lx ly b">ListView</code>组件的限制。处理一个<code class="fe lv lw lx ly b">Flatlist</code>需要的基本道具是<code class="fe lv lw lx ly b">data </code>和<code class="fe lv lw lx ly b">renderItem</code> <strong class="lb iu">。</strong>为了简单起见，<code class="fe lv lw lx ly b">data </code>只是一个普通的数组，而<code class="fe lv lw lx ly b">renderItem </code>呈现这个数据数组并向开发者提供类似<code class="fe lv lw lx ly b">index</code>等的元数据。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="ce76" class="ma mb it ly b gy nc nd l ne nf">&lt;FlatList   <br/>  data={this.state.dataSource}<br/>  renderItem={({item}) =&gt; &lt;Text&gt;{item.key}&lt;/Text&gt;<br/> /&gt;</span></pre><h2 id="ecbb" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated">使用FlatList显示项目列表</h2><p id="92d7" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">如果您是React Native的新手，我建议您通读这篇文章，并尝试学习基本结构。然后回来，这样你可以更好地理解<code class="fe lv lw lx ly b">FlatList</code></p><div class="ng nh gp gr ni nj"><a href="https://medium.com/@sudhirKr/react-native-navigating-between-the-screens-and-code-structure-for-beginners-6b815ee8f79" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">反应导航初学者(高级版-3)</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">几个月前我开始和react native一起工作，我必须说这是一个从全职…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ks nj"/></div></div></a></div><p id="c0a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何使用<code class="fe lv lw lx ly b">FlatList</code>从一个虚拟API获取数据并使用它显示一个带有图像的项目列表的逐步指南。</p><p id="26c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是从react-native库中导入<code class="fe lv lw lx ly b">Flatlist</code>组件。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="61f3" class="ma mb it ly b gy nc nd l ne nf">import { FlatList } from "react-native";</span></pre><p id="8d51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们已经导入了组件，是时候在<code class="fe lv lw lx ly b">render </code>函数中使用这个组件了。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="a5f9" class="ma mb it ly b gy nc nd l ne nf">&lt;FlatList <br/>  data={this.state.dataSource}<br/>  ItemSeparatorComponent={this.FlatListItemSeparator}<br/>  renderItem={item =&gt; this.renderItem(item)} <br/>  keyExtractor={item =&gt; item.id.toString()}<br/>/&gt;</span></pre><h2 id="901b" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated">思考要点</h2><ol class=""><li id="a613" class="ny nz it lb b lc mt lf mu li oa lm ob lq oc lu od oe of og bi translated"><code class="fe lv lw lx ly b">data </code> prop从<code class="fe lv lw lx ly b">{this.state.dataSource} </code>获取数据，并为我们提供一个对象数组。</li><li id="dac4" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated"><code class="fe lv lw lx ly b">ItemSeparatorComponent </code>在列表中显示时，有助于分隔列表项目。</li><li id="6396" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated"><code class="fe lv lw lx ly b">renderItem<strong class="lb iu"> </strong></code>方法是<code class="fe lv lw lx ly b">FlatList</code>中最重要的部分。它以一种可以按照数据&amp;设计要求开发的方式呈现数组数据。</li><li id="d4e4" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated">由于我们在这里处理的是一个数组，<code class="fe lv lw lx ly b">keyExtractor </code> prop提供了需要一个唯一的键来根据需要单独处理列表项。</li><li id="69cb" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated">还有一个更重要的道具叫做<code class="fe lv lw lx ly b">extraData </code>，我将在本文后面描述它。</li></ol><p id="c2dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你对<code class="fe lv lw lx ly b">Flatlist</code>的工作原理有了基本的了解。是时候用代码实现这些知识和逻辑了。由于我们使用来自API的数据，我会添加一个指示器来显示加载器，直到数据加载到后端。是时候获取数据并将其呈现在列表中了。如果你想了解更多关于从API获取数据的信息，你可以阅读这篇文章。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/992c7faaf037ee18ec81cf713d4ac6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*uw3XfzdJS4NpetlWQDIgLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不带项目分隔符呈现的列表</p></figure><p id="3d9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们已经处理了<code class="fe lv lw lx ly b">data </code>和<code class="fe lv lw lx ly b">renderItem </code>方法。现在是时候探索剩下的方法了。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="0a81" class="ma mb it ly b gy nc nd l ne nf">FlatListItemSeparator = () =&gt; &lt;View style={styles.line} /&gt;;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/1377c78da79ae2765cdad3af4753af31.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*0afxdaBAR1ADFOVZWjmlcA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用项目分隔符呈现的列表</p></figure><p id="2830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以根据您的设计提供样式，并更改此样式类。如果您想使用我版本的样式，您可以在本文末尾找到我使用的代码。</p><p id="201e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在,<code class="fe lv lw lx ly b">key extractor</code>方法基本上是针对商品的唯一ID。最好使用上面的确切代码来处理任何警告。</p><h2 id="708b" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated">现在有趣的部分来了</h2><p id="d4bd" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">有时，您需要选择列表中的多个项目并高亮显示它们。在营销应用或待办事项列表中尤其如此，你需要从列表中的数百个项目中进行选择。下面是从各种其他项目中选择一个项目的代码。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="c7bb" class="ma mb it ly b gy nc nd l ne nf">selectItem = data =&gt; {<br/>  data.item.isSelect = !data.item.isSelect;<br/>  data.item.selectedClass = data.item.isSelect<br/>   ? styles.selected: styles.list;<br/> <br/>const index = this.state.dataSource.findIndex(<br/>   item =&gt; data.item.id === item.id<br/>);</span><span id="230c" class="ma mb it ly b gy oq nd l ne nf">this.state.dataSource[index] = data.item;<br/> this.setState({<br/>   dataSource: this.state.dataSource<br/> });<br/>};</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/145a2ed11dfabfe492d796ff671233ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*evIzPu0A1L_lgPmaJNg73w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列表中的选定项目</p></figure><p id="e69d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们看到的是一个屏幕，其中选中的项目以亮色突出显示，而列表中的其他项目被设置为默认样式。为了更清楚地理解逻辑，让我们来看看fetch组件。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="9f51" class="ma mb it ly b gy nc nd l ne nf">.then(responseJson =&gt; {<br/> responseJson = responseJson.map(item =&gt; {<br/>   item.isSelect = false;<br/>   item.selectedClass = styles.list;<br/>   return item;<br/> });</span></pre><p id="8d21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们将<code class="fe lv lw lx ly b">item.isSelect </code>指定为<code class="fe lv lw lx ly b">false </code>，而<code class="fe lv lw lx ly b">selectedClass </code>被指定为默认的样式类<code class="fe lv lw lx ly b">list.</code>，这背后的原因是现在我们列表中的每一个项目都将拥有这两个属性<strong class="lb iu"> </strong>，它们可以用来唯一地获取项目并操作它。现在在我们的<code class="fe lv lw lx ly b">selectItem()<em class="os"> </em></code>函数中，我们添加了一个渲染条件如下:</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="0d86" class="ma mb it ly b gy nc nd l ne nf">selectItem = data =&gt; {<br/>  data.item.isSelect = !data.item.isSelect;<br/>  data.item.selectedClass = data.item.isSelect<br/>   ? styles.selected: styles.list;</span></pre><p id="d09b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，当我们点击我们的<code class="fe lv lw lx ly b">FlatList</code>中的任何项目时，<code class="fe lv lw lx ly b">selectItem </code>函数被渲染，它将该项目的样式更改为一个突出显示的类，比如这里的selected class，其余的列表项目具有来自类列表的默认样式。</p><h2 id="3e0b" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated">重要的部分来了</h2><p id="0e45" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">FlatList有一个名为<code class="fe lv lw lx ly b">extraData </code>的道具，只要使用状态有任何变化，它就会重新渲染<code class="fe lv lw lx ly b">FlatList</code>。该功能重新呈现我们的<code class="fe lv lw lx ly b">selectItem </code>和<code class="fe lv lw lx ly b">renderItem </code>功能，并突出显示所选项目。否则，只有一个项目将被选中，因为<code class="fe lv lw lx ly b">FlatList</code>在组件加载开始时被渲染，并且即使状态和数据改变状态也保持不变。</p><h2 id="d0dd" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated"><code class="fe lv lw lx ly b">extraData</code></h2><p id="f23d" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">这是一个标记属性，用于告诉列表重新呈现(因为它实现了<code class="fe lv lw lx ly b">PureComponent</code>)。</p><pre class="kj kk kl km gt my ly mz na aw nb bi"><span id="1e19" class="ma mb it ly b gy nc nd l ne nf">extraData={this.state}</span></pre><p id="600c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你所要做的就是将它添加到<code class="fe lv lw lx ly b">FlatList</code>组件中，这样我们就完成了列表中多个项目的高亮显示。</p><p id="57bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望本文对您有所帮助，增强您轻松应对这一需求的能力。如果你想用它作为例子，我在这里分享完整的代码片段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/d7f67561dc5b82b7388bab277e4531ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/1*JdgZ8fX00EoEfixDrg2xpQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有选定和未选定项目的屏幕</p></figure><h2 id="88f2" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated"><strong class="ak">完整代码在此</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><h2 id="0bf5" class="ma mb it bd mc md me dn mf mg mh dp mi li mj mk ml lm mm mn mo lq mp mq mr ms bi translated"><strong class="ak">谢谢。不断学习分享！</strong></h2><p id="2981" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">在此与我联系:</p><p id="ce29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.instagram.com/navigatorkumar/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/navigatorkumar/</a></p></div></div>    
</body>
</html>