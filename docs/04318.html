<html>
<head>
<title>Deep Linking in Flutter With Firebase Dynamic Links</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Firebase动态连接进行颤振的深度连接</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/deep-linking-in-flutter-with-firebase-dynamic-links-8a4b1981e1eb?source=collection_archive---------2-----------------------#2020-04-06">https://betterprogramming.pub/deep-linking-in-flutter-with-firebase-dynamic-links-8a4b1981e1eb?source=collection_archive---------2-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0d46" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用深度链接提高用户保留率、参与度和用户体验</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c528fc6f4d52c52b9dd11b2fb71ec4a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpmgmlZOaG9Ssl7RgHbrWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">摘自https://youtu.be/LvY1JMcrPF8<a class="ae ky" href="https://youtu.be/LvY1JMcrPF8" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="de19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">深度链接用于通过社交媒体活动推广应用程序或与其他用户共享数据，以链接到特定应用程序中的特定内容，无论您的应用程序是否已安装。</p><p id="ce74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://firebase.google.com/docs/dynamic-links" rel="noopener ugc nofollow" target="_blank"> Firebase动态链接</a>为处理应用程序和网站的深度链接提供了丰富的功能。最棒的是，Firebase深度链接对任何规模都是免费的。</p><p id="b610" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将解释如何在<a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>中创建和使用动态链接。如果您希望了解更多关于Firebase动态链接的信息，您可以查看以下视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="c60b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Firebase动态链接处理以下情况:</p><ol class=""><li id="954f" class="lx ly it lb b lc ld lf lg li lz lm ma lq mb lu mc md me mf bi translated">当用户打开动态链接时，如果您的应用程序未安装，用户将被重定向到Play Store或App Store以安装您的应用程序。</li><li id="4ab3" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">如果您的应用程序已安装，但未在前台/后台打开，则该应用程序会在设备上打开。</li><li id="a539" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu mc md me mf bi translated">如果应用程序在前台/后台，那么用户可以在注册的侦听器中获得一个动态链接。</li></ol><p id="6292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要按照以下步骤创建和接收动态链接。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="20e4" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">1.在Firebase控制台中设置URL P <strong class="ak"> refix </strong></h1><ul class=""><li id="cfee" class="lx ly it lb b lc nk lf nl li nm lm nn lq no lu np md me mf bi translated">打开<a class="ae ky" href="https://console.firebase.google.com/u/0/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>并选择您想要添加深度链接的Firebase项目。</li><li id="0df3" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">在Firebase项目中创建一个Android和IOS应用程序。</li><li id="e8e1" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">从侧面抽屉的<em class="nq">增长</em>部分打开<em class="nq">动态链接</em>。</li><li id="4b0a" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">为链接创建一个域，点击<em class="nq">开始</em> <strong class="lb iu"> </strong>按钮。</li><li id="2ab9" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">然后，创建一个<em class="nq"> URL前缀</em>。URL前缀是使用动态链接的域名。</li><li id="309d" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">创建一个选项卡，添加应用程序的自定义唯一域名。比如test.page.link，这里域名后面加了<code class="fe nr ns nt nu b">page.link</code>。</li><li id="7765" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">然后，按照:配置→验证→完成步骤。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/96ff921a8552f83ae23194caeba1d0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*NW69MKdV8V4OmYRMhYvaxQ.png"/></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="d87d" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">2.iOS应用程序的配置</h1><ul class=""><li id="9bbb" class="lx ly it lb b lc nk lf nl li nm lm nn lq no lu np md me mf bi translated">在Firebase控制台打开<em class="nq">项目设置</em>，选择<em class="nq"> iOS </em>应用。</li><li id="02a2" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">添加应用程序的<em class="nq">应用商店Id </em>。您可以在应用的URL中找到您的应用商店ID。在下面的例子中，<code class="fe nr ns nt nu b">123456789</code>是应用商店ID。<a class="ae ky" href="https://itunes.apple.com/us/app/yourapp/id123456789" rel="noopener ugc nofollow" target="_blank">https://itunes.apple.com/us/app/yourapp/id<strong class="lb iu">123456789</strong>T31】</a></li><li id="84c0" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">如果您的应用程序尚未发布，您可以使用另一个已发布的应用程序ID进行测试(注意:当您的应用程序上线时，不要忘记用另一个项目ID替换它)。</li><li id="139b" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">添加<em class="nq">团队Id </em>。您可以在Apple会员中心的预置描述文件下找到您的团队ID。</li></ul><p id="bfb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要在Xcode中添加一些配置。遵循以下步骤。</p><ul class=""><li id="0fe6" class="lx ly it lb b lc ld lf lg li lz lm ma lq mb lu np md me mf bi translated">在<em class="nq">签名&amp;功能</em> <strong class="lb iu"> </strong>选项卡下，您想要打开一个关联的域并将该域添加到列表中。你的域名看起来是这样的:applinks:test . page . link .<strong class="lb iu"/>这里的<code class="fe nr ns nt nu b">test.page.link</code> <strong class="lb iu"> </strong>是我们已经在Firebase控制台中创建的URL域。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/06d80db3dfe0f6913d78ddc481963dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pE_GHOQfI8b3n6lJv7nsUw.png"/></div></div></figure><p id="c083" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:确保您的预配配置文件支持相关域的功能。</p><ul class=""><li id="93d7" class="lx ly it lb b lc ld lf lg li lz lm ma lq mb lu np md me mf bi translated">在项目的<em class="nq">信息选项卡</em>中，创建一个新的<em class="nq"> URL类型</em>，它将被动态链接使用。</li><li id="49be" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">添加<em class="nq">标识符</em> <strong class="lb iu"> </strong>字段<strong class="lb iu"> </strong>作为<em class="nq">包ID </em>和<em class="nq"> URL模式</em>作为您的包ID，类似于<code class="fe nr ns nt nu b">com.example.test</code> <em class="nq">。</em></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/606f88869a536d6e85686d5d84bf5662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vchm44-DP-ciM2C0xZFoNw.png"/></div></div></figure><p id="bf25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过打开托管在动态链接域中的<code class="fe nr ns nt nu b">apple-app-site-association</code>文件来确认Firebase项目是否正确配置为在应用程序中使用动态链接。例如:</p><pre class="kj kk kl km gt ny nu nz oa aw ob bi"><span id="dc37" class="oc mt it nu b gy od oe l of og"><a class="ae ky" href="https://test.page.link/apple-app-site-association" rel="noopener ugc nofollow" target="_blank">https://test.page.link/apple-app-site-association</a></span></pre><p id="5cbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的应用程序已连接，则该文件包含对您的应用程序的App Store ID和捆绑包ID的引用。例如:</p><pre class="kj kk kl km gt ny nu nz oa aw ob bi"><span id="ee29" class="oc mt it nu b gy od oe l of og">{"applinks":{"apps":[],<br/>"details":[{"appID":"1234567890.com.example.test","paths":["/*"]}]}}</span></pre><p id="aa54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:在Android应用中使用动态链接不需要额外的配置。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="9177" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">3.在Flutter项目中添加依赖性</h1><p id="9539" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li oh lk ll lm oi lo lp lq oj ls lt lu im bi translated">你必须包含插件才能使用动态链接。在<code class="fe nr ns nt nu b">pubspec.yaml</code> <strong class="lb iu"> </strong>文件中添加<a class="ae ky" href="https://pub.dev/packages/firebase_dynamic_links#-readme-tab-" rel="noopener ugc nofollow" target="_blank"> firebase_dynamic_links </a>插件。</p><pre class="kj kk kl km gt ny nu nz oa aw ob bi"><span id="40c9" class="oc mt it nu b gy od oe l of og">dependencies:<br/>  firebase_dynamic_links: ^0.5.0+11</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="fbdc" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">4.创建动态链接</h1><p id="5b73" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li oh lk ll lm oi lo lp lq oj ls lt lu im bi translated">有四种方法可以创建动态链接。在这里，我将解释两种创建链接的方法。关于其他方式的更多细节，请参考<a class="ae ky" href="https://firebase.google.com/docs/dynamic-links/create-links" rel="noopener ugc nofollow" target="_blank"> Firebase文档</a>。</p><h2 id="b6ca" class="oc mt it bd mu ok ol dn my om on dp nc li oo op ne lm oq or ng lq os ot ni ou bi translated"><strong class="ak">使用Firebase控制台</strong>创建动态链接</h2><ul class=""><li id="ab00" class="lx ly it lb b lc nk lf nl li nm lm nn lq no lu np md me mf bi translated">从侧面抽屉的<em class="nq">增长</em>部分选择<strong class="lb iu"> </strong> <em class="nq">动态链接</em>，然后点击<em class="nq">新动态链接</em>。</li><li id="96c5" class="lx ly it lb b lc mg lf mh li mi lm mj lq mk lu np md me mf bi translated">遵循下图中给出的所有步骤。在那之后，你得到这样一个最后的链接:<a class="ae ky" href="https://sticksstage.page.link/FwrkDiHgDyrHosFC6" rel="noopener ugc nofollow" target="_blank">https://test.page.link/FwrkDi</a>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/a45fb65f227e112ef0b6af9b23b09d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qI8_IoLqbtYsbRfD.png"/></div></div></figure><h2 id="f820" class="oc mt it bd mu ok ol dn my om on dp nc li oo op ne lm oq or ng lq os ot ni ou bi translated"><strong class="ak">以编程方式创建动态链接</strong></h2><p id="38fa" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li oh lk ll lm oi lo lp lq oj ls lt lu im bi translated">您可以通过设置以下参数并使用<code class="fe nr ns nt nu b">DynamicLinkParameters.buildUrl()</code>方法以编程方式创建一个链接。要创建一个短链接，使用<code class="fe nr ns nt nu b">DynamicLinkParameters.buildShortLink()</code>方法。</p><p id="c01f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以像<strong class="lb iu">一样传递多个参数？userId=1 &amp;类别=教育</strong>。如果不想在链接中传递参数，则移除<strong class="lb iu">？来自URL的userId=1 </strong>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="ffee" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">5.<strong class="ak">接收应用程序中的</strong>链接</h1><p id="84b3" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li oh lk ll lm oi lo lp lq oj ls lt lu im bi translated">现在，要在应用程序中获得一个链接，需要在应用程序的主要小部件中初始化动态链接。</p><p id="0be7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要接收一个动态链接，从<code class="fe nr ns nt nu b">FirebaseDynamicLinks</code>调用<code class="fe nr ns nt nu b">getInitialLink()</code>方法，获取打开应用程序的链接(如果不是通过动态链接打开的，则为空)。你需要添加两到三秒的延迟，因为有时候，当应用程序第一次打开时，链接会变得无效。</p><p id="8f34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当应用程序在前台或后台调用<code class="fe nr ns nt nu b">onLink</code>时，为链接回调配置监听器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="c2c9" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">就这样</h1><p id="49f0" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li oh lk ll lm oi lo lp lq oj ls lt lu im bi translated">我们已经看到了如何创建和接收Firebase动态链接。我希望你已经从中看到了Firebase动态链接的好处，以及它是多么容易设置！</p></div></div>    
</body>
</html>