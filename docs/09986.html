<html>
<head>
<title>How To Manage State in Flutter With Provider</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用提供者管理Flutter中的状态</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-manage-state-in-flutter-with-provider-661ff322dd22?source=collection_archive---------5-----------------------#2021-11-10">https://betterprogramming.pub/how-to-manage-state-in-flutter-with-provider-661ff322dd22?source=collection_archive---------5-----------------------#2021-11-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2a9c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">一个关于Flutter最受欢迎的国家经理的三集系列</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/6ef165780c9d8816befad208c0beeb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aeY6MqDjeCxfjRTYZ2dpg.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@fabiraw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Fabian Albert </a>在<a class="ae kw" href="https://unsplash.com/s/photos/mobile-device?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7c61" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Flutter 是一个很酷的新人——或者说现在已经十几岁了。Google的UI套件使你能够从单一代码库构建本地的高性能移动和网络应用。除此之外，大量可用的<a class="ae kw" href="https://flutter.dev/docs/development/ui/widgets/material" rel="noopener ugc nofollow" target="_blank">小部件</a>带来了快速而愉快的开发体验。</p><p id="1255" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">被Flutter的潜力所吸引，我最近一头扎进了我的第一个Flutter项目。我的热情没有消退。Flutter兑现了它的所有承诺。但是新工具提供的机会也带有一些风险。</p><p id="1c00" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">摆弄新玩具时，阅读说明书通常是个好主意。由于Flutter只是在最近几年才开始流行，它的使用手册还在编写中。</p><p id="6dca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">清晰简洁的指南会让我的第一个Flutter项目变得更好。尤其是为国家管理选择正确的工具绝不是一件容易的事情。选项很多，但它们之间往往缺乏明确的比较。</p><p id="fbc5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在我看来，国家管理者之间的比较是非常必要的。一旦你的应用程序的状态与一个状态管理器纠缠在一起，切换到另一个工具就不是一件容易的事情了。因此，为了帮助您第一次就正确理解，我将在一个由三部分组成的系列中比较Flutter最受欢迎的状态管理器。</p><ul class=""><li id="c7aa" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><em class="mc">第1部分:您是否需要一个状态管理器来管理提供者的状态</em></li></ul><h2 id="3257" class="md me iq bd mf mg mh dn mi mj mk dp ml lg mm mn mo lk mp mq mr lo ms mt mu mv bi translated">你需要一个州经理吗？</h2><p id="798b" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">在开始比较各种状态管理器选项之前，您应该问自己:</p><p id="f1b6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">"T15我甚至需要一个状态管理器吗？"</p><p id="0fc2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果您的应用程序在设计上非常扁平，并且状态很少在窗口小部件树中上下移动超过一级，那么通过属性和回调传递状态可能会为您节省很多样板文件。</p><p id="f305" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在下面的例子中，<code class="fe nb nc nd ne b">Parent</code>向<code class="fe nb nc nd ne b">Child</code>传递一个回调，以跟踪<code class="fe nb nc nd ne b">TextButton</code>被点击的次数:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="6e9a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，如果您发现自己通过部件树的多个级别传递回调，那么以这种方式管理状态很快就会变得麻烦和混乱。在这种情况下，可以肯定您需要一种更强大的方式来管理状态。但是什么才是适合这项工作的工具呢？</p><h2 id="8f7f" class="md me iq bd mf mg mh dn mi mj mk dp ml lg mm mn mo lk mp mq mr lo ms mt mu mv bi translated">使用<a class="ae kw" href="https://pub.dev/packages/provider" rel="noopener ugc nofollow" target="_blank">提供者</a>管理状态</h2><p id="2eca" class="pw-post-body-paragraph kx ky iq kz b la mw jr lc ld mx ju lf lg my li lj lk mz lm ln lo na lq lr ls ij bi translated">在Flutter应用程序中，有大量的<a class="ae kw" href="https://flutter.dev/docs/development/data-and-backend/state-mgmt/options" rel="noopener ugc nofollow" target="_blank">选项</a>来管理你的状态。供应商是最受欢迎的州经理之一。这个社区创建的工具依赖于三个核心概念:</p><ol class=""><li id="905a" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls nh lz ma mb bi translated"><code class="fe nb nc nd ne b">ChangeNotifier</code>:存储您的状态，从该状态开始更新状态，并通知使用该状态的微件。</li><li id="7494" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls nh lz ma mb bi translated"><code class="fe nb nc nd ne b">ChangeNotifierProvider</code>:这个小部件使得树中的底层小部件可以访问<code class="fe nb nc nd ne b">ChangeNotifier</code>。</li><li id="065a" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls nh lz ma mb bi translated"><code class="fe nb nc nd ne b">Consumer</code>:监听状态变化并相应更新UI的小部件。</li></ol><p id="6d22" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是一个使用提供者模式更新点击计数的示例:</p><ul class=""><li id="87fe" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">状态由存储<code class="fe nb nc nd ne b">_count</code>的<code class="fe nb nc nd ne b">DataProvider</code>类存储和处理。</li><li id="3290" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">通过点击按钮调用<code class="fe nb nc nd ne b">IncrementCount</code>，从<code class="fe nb nc nd ne b">Child</code>小部件更新<code class="fe nb nc nd ne b">_count</code>。</li><li id="78d5" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated"><code class="fe nb nc nd ne b">NotifyListeners()</code>确保通过<code class="fe nb nc nd ne b">Consumer</code>访问状态的<code class="fe nb nc nd ne b">Parent</code>小部件得到相应的更新。</li></ul><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="edb4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">那么，Provider是状态管理的最佳工具吗？</p><p id="f2f7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">优点</strong></p><ul class=""><li id="c9e2" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">维护良好且久经考验的套件。</li><li id="b421" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">单向状态管理的完整工具包。</li></ul><p id="bb64" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">缺点</strong></p><ul class=""><li id="fca6" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">总共有令人印象深刻的九个不同的提供商，要正确理解提供商并不容易。</li><li id="778a" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">不必要的重建不容易避免。默认情况下，<code class="fe nb nc nd ne b">Consumer</code>会更新它所有的子部件，即使状态中不相关的部分已经被更新。</li><li id="fa16" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated"><code class="fe nb nc nd ne b">Provider</code>依赖于Flutter SDK，让你的业务逻辑和框架密不可分。这在建筑设计中被认为是一种不好的做法。</li><li id="77b9" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">状态更新不是基于事件的。所以在上面的例子中，我们知道<code class="fe nb nc nd ne b">_count</code>已经被更新，但是我们只能猜测改变的起源。这使得跟踪和理解应用程序中的状态变化变得复杂。</li></ul><p id="3e7d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">综上所述，我认为<code class="fe nb nc nd ne b">Provider</code>对于<em class="mc">经验丰富的</em> Flutter开发者来说是一个很好的选择，他们正在构建一个具有简单状态需求的应用。<code class="fe nb nc nd ne b">Provider</code>易于学习但难以掌握，此外，缺乏更复杂应用程序所需的基于事件的状态跟踪。</p></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="d9c8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本系列的下一部分中，我将使用BLoC模式研究状态管理。</p><h1 id="5f08" class="nu me iq bd mf nv nw nx mi ny nz oa ml jw ob jx mo jz oc ka mr kc od kd mu oe bi translated">资源</h1><ul class=""><li id="266b" class="lt lu iq kz b la mw ld mx lg of lk og lo oh ls ly lz ma mb bi translated">扑:【https://flutter.dev/】T4</li><li id="a5d1" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">Flutter的widget目录:<a class="ae kw" href="https://flutter.dev/docs/development/ui/widgets" rel="noopener ugc nofollow" target="_blank">https://flutter.dev/docs/development/ui/widgets</a></li><li id="71e0" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">Flutter的状态管理选项:<a class="ae kw" href="https://flutter.dev/docs/development/data-and-backend/state-mgmt/options" rel="noopener ugc nofollow" target="_blank">https://Flutter . dev/docs/development/data-and-back end/state-mgmt/options</a></li><li id="2f59" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">提供商包:<a class="ae kw" href="https://pub.dev/packages/provider" rel="noopener ugc nofollow" target="_blank">https://pub.dev/packages/provider</a></li><li id="1124" class="lt lu iq kz b la ni ld nj lg nk lk nl lo nm ls ly lz ma mb bi translated">九种不同类型的提供者:<a class="ae kw" href="https://pub.dev/documentation/provider/latest/provider/provider-library.html" rel="noopener ugc nofollow" target="_blank">https://pub . dev/documentation/provider/latest/provider/provider-library . html</a></li></ul></div></div>    
</body>
</html>