<html>
<head>
<title>How to Create a Python Wrapper for C/C++ Shared Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为C/C++共享库创建Python包装器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-python-wrapper-for-c-c-shared-libraries-35ffefcfc10b?source=collection_archive---------1-----------------------#2020-04-13">https://betterprogramming.pub/how-to-create-a-python-wrapper-for-c-c-shared-libraries-35ffefcfc10b?source=collection_archive---------1-----------------------#2020-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="27d0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用ctypes模块调用Python中的C/C++函数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2eb1ab5001659bcb92ff615d2ab4f3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YaueU4meqq-bCM8y3OlkQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@cdr6934?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae ky" href="https://unsplash.com/s/photos/programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="d3a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过阅读本文，您将学习创建和实现一个包装器类，以便直接用Python调用C/C++函数。我们将使用一个名为<code class="fe lv lw lx ly b">ctypes</code>的内置模块。根据官方<a class="ae ky" href="https://docs.python.org/3.8/library/ctypes.html" rel="noopener ugc nofollow" target="_blank">文档</a>，ctypes是</p><blockquote class="lz ma mb"><p id="dbdb" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated">“Python的外来函数库。它提供C兼容的数据类型，并允许调用dll或共享库中的函数。可以用纯Python来包装这些库。”</p></blockquote><p id="6f20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程分为三个部分:</p><ol class=""><li id="6500" class="mg mh it lb b lc ld lf lg li mi lm mj lq mk lu ml mm mn mo bi translated">设置</li><li id="5b70" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ml mm mn mo bi translated">履行</li><li id="b5b3" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ml mm mn mo bi translated">结论</li></ol><p id="b8e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续下一节，设置本教程所需的材料。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="6bf8" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">1.设置</h1><p id="4167" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在本教程中，我将使用Python 3.7.4。只要能调用内置模块<code class="fe lv lw lx ly b">ctypes</code>，可以随意使用其他版本的Python。强烈建议为此项目创建一个虚拟环境。</p><p id="3096" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保您有一个<code class="fe lv lw lx ly b">dll</code>，可以被我们的Python文件使用。您只需要<code class="fe lv lw lx ly b">dll</code>文件来创建包装器。如果您可以访问并知道可用的函数和参数，头文件是可选的。如果您使用第三方库，请确保在编写Python包装器时获得相应的头文件以供参考。</p><p id="7efb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你打算编译你自己的DLL，请查看我的关于如何在Windows中创建C/C++动态链接库的教程。</p><p id="bf7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在与<code class="fe lv lw lx ly b">dll</code>文件相同的目录下创建一个新的Python文件。我就把它命名为<code class="fe lv lw lx ly b">add_wrapper.py</code>。请根据您自己的喜好随意命名该文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/de715f3395113bcc43c465e447ab556e.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*XhBUUetnTdegK4C68s6-Cg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1dae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续下一节，开始写一些Python代码。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="fe8e" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">2.履行</h1><h2 id="baa2" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">导入</h2><p id="c4dd" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在文件顶部导入以下模块:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="409e" class="nz nc it ly b gy op oq l or os">from ctypes import *<br/>from sys import platform</span></pre><ul class=""><li id="2b26" class="mg mh it lb b lc ld lf lg li mi lm mj lq mk lu ot mm mn mo bi translated"><code class="fe lv lw lx ly b">ctypes</code> —这是加载共享库并调用其中函数的基本模块。</li><li id="81ad" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ot mm mn mo bi translated"><code class="fe lv lw lx ly b">sys</code> —我们将使用此模块来确定操作系统并加载适当的库。</li></ul><h2 id="f3b5" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">加载库</h2><p id="eedf" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">假设您有两个用于Windows和Linux操作系统的共享库，添加以下代码来加载适用于您的操作系统的库。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="a048" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面给出的代码将对库的引用存储在一个名为<code class="fe lv lw lx ly b">add_lib</code>的变量中。稍后我们将使用它来调用可用的函数。</p><p id="8590" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行Python文件时，您应该会看到以下输出:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="15ef" class="nz nc it ly b gy op oq l or os">&lt;CDLL './add.dll', handle ... at ...&gt;</span></pre><h2 id="dd59" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">页眉</h2><p id="2be9" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">让我们来看看这个<code class="fe lv lw lx ly b">dll</code>的头文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="b8c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它是用C++编写的，有三个可用的函数。所有的函数都接受两个整型参数并返回一个整型变量。在真实的用例中，它要复杂得多，有复杂的数据类型和指针。</p><h2 id="ec61" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">数据类型</h2><p id="2989" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在我们继续之前，让我们看看<code class="fe lv lw lx ly b">ctypes</code>提供的可用数据类型，它代表了C编程中的相同数据类型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/36a4b7eb274ec30053b84be02769728a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOc7pV7RlnKxvqsvl1QSKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://docs.python.org/3.8/library/ctypes.html" rel="noopener ugc nofollow" target="_blank"> Python </a></p></figure><p id="7b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以按如下方式初始化数据类型:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="7b0e" class="nz nc it ly b gy op oq l or os">a = c_int()</span></pre><p id="b4b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你把它打印出来的时候，你会得到下面的输出，表明它是一个值为0的<code class="fe lv lw lx ly b">long</code>。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="5c08" class="nz nc it ly b gy op oq l or os">c_long(0)</span></pre><p id="9516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果输出不是一个<code class="fe lv lw lx ly b">int</code>，不要感到惊讶。根据官方文件，</p><blockquote class="lz ma mb"><p id="8228" class="kz la mc lb b lc ld ju le lf lg jx lh md lj lk ll me ln lo lp mf lr ls lt lu im bi translated">“在<code class="fe lv lw lx ly b">sizeof(long) == sizeof(int)</code>的平台上，它是<code class="fe lv lw lx ly b">c_long</code>的别名。所以，如果你期待<code class="fe lv lw lx ly b">c_int</code>，你不应该对<code class="fe lv lw lx ly b">c_long</code>被打印感到困惑——它们实际上是同一类型的。”</p></blockquote><p id="0d4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以传入一个参数作为初始值。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="1fd4" class="nz nc it ly b gy op oq l or os">a = c_int(25)</span></pre><p id="f0ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得实际值，必须使用<code class="fe lv lw lx ly b">value</code>属性。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="5f29" class="nz nc it ly b gy op oq l or os">print(a.value)</span></pre><p id="9256" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该得到<code class="fe lv lw lx ly b">25</code>作为输出。</p><p id="a9f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于特殊的数据类型，比如带有空终止符的<code class="fe lv lw lx ly b">char</code>(在Python中表示字符串)，您必须使用下面的代码。这种语法将在后面的<code class="fe lv lw lx ly b">Array</code>小节中进一步讨论。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="2b7a" class="nz nc it ly b gy op oq l or os">serialNumber = c_char * 13</span></pre><h2 id="f1c4" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">功能</h2><p id="39cd" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我们将利用之前定义的<code class="fe lv lw lx ly b">add_lib</code>变量来调用适当的函数。记住，根据头文件，我们只有三个可用的函数:</p><ul class=""><li id="f0b6" class="mg mh it lb b lc ld lf lg li mi lm mj lq mk lu ot mm mn mo bi translated"><code class="fe lv lw lx ly b">add</code></li><li id="febf" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ot mm mn mo bi translated"><code class="fe lv lw lx ly b">sub</code></li><li id="95b7" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ot mm mn mo bi translated"><code class="fe lv lw lx ly b">mul</code></li></ul><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="5b92" class="nz nc it ly b gy op oq l or os">add_lib.add(2, 5)</span></pre><p id="631f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数的名称和输入函数的数据类型应该与头文件完全相同。如果您尝试调用一个不可用的函数，您会看到以下错误消息:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="cae0" class="nz nc it ly b gy op oq l or os">AttributeError: function 'test' not found</span></pre><p id="22a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用错误的数据类型将导致以下错误:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="4f76" class="nz nc it ly b gy op oq l or os">ctypes.ArgumentError: argument 1 : &lt;class: TypeError&gt;</span></pre><p id="46aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有些数据类型，比如<code class="fe lv lw lx ly b">int</code>，可以直接使用，不需要声明为<code class="fe lv lw lx ly b">ctypes </code>数据类型，但是强烈建议这样做。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="e043" class="nz nc it ly b gy op oq l or os">a = c_int(25)<br/>b = c_int(10)<br/>add_lib.sub(a, b)</span></pre><p id="b426" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该得到<code class="fe lv lw lx ly b">15</code>作为输出。</p><h2 id="efdf" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">返回类型</h2><p id="072d" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">默认情况下，<code class="fe lv lw lx ly b">int</code>作为数据类型返回。您必须使用<code class="fe lv lw lx ly b">restype</code>属性手工定义返回类型。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="8067" class="nz nc it ly b gy op oq l or os">result = add_lib.mul<br/>result.restype = c_int<br/>result(a, b)</span></pre><p id="c6b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，使用错误的类型会影响其中的值。您必须遵循与头文件中相同的数据类型。如果您打算从中获取其他数据类型，只需在获得结果后对其进行强制转换。</p><h2 id="b4e2" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">指针</h2><p id="dbc5" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">您可以使用以下代码创建一个新指针:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="5a8a" class="nz nc it ly b gy op oq l or os">temperature = c_int(25)<br/>temperature_p = pointer(temperature)</span></pre><p id="0a15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您必须使用<code class="fe lv lw lx ly b">contents</code>属性来访问指针内部的内容。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="a353" class="nz nc it ly b gy op oq l or os">temperature_p.contents</span></pre><p id="113f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该得到<code class="fe lv lw lx ly b">c_long(25)</code>作为输出值。您可以将它与<code class="fe lv lw lx ly b">value</code>属性结合起来访问所需的值。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="7cfa" class="nz nc it ly b gy op oq l or os">temperature_p.contents.value</span></pre><p id="f3b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你实际上并不需要指针，只是想用它来输入参数，<code class="fe lv lw lx ly b">ctypes</code>为我们提供了<code class="fe lv lw lx ly b">byref</code>函数，用来通过引用传递参数。以下代码仅供参考，不能与<code class="fe lv lw lx ly b">add_lib</code> <code class="fe lv lw lx ly b">dll</code>一起运行。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="1249" class="nz nc it ly b gy op oq l or os">temperature = c_int(25)<br/>result = example_lib.calc_temp(byref(temperature))</span></pre><h2 id="d9b5" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">结构和联合</h2><p id="eb8e" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">当处理struct时，你必须使用下面的代码。确保相应的数据类型与头文件中定义的原始数据类型相匹配。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="c2fd" class="nz nc it ly b gy op oq l or os">class lib_sdk_info(Structure):<br/>    _fields_ = [("sdk_version_major", c_uint8),<br/>    ("sdk_version_minor", c_uint8),<br/>    ("sdk_build_major", c_uint8),<br/>    ("sdk_build_minor", c_uint8)]</span></pre><p id="1c09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用下列程式码建立新的结构:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="b38d" class="nz nc it ly b gy op oq l or os">info = lib_sdk_info()</span></pre><p id="299e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按如下方式访问其中的字段:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="c0e5" class="nz nc it ly b gy op oq l or os">info.sdk_build_minor</span></pre><p id="a2fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要打印结构中的所有信息，建议您通过下面的<code class="fe lv lw lx ly b">for loop</code>来完成:</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="1a85" class="nz nc it ly b gy op oq l or os">for field_name, field_type in info._fields_:<br/>    print(field_name, getattr(info, field_name))</span></pre><h2 id="65b7" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">排列</h2><p id="da20" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">创建数组的最佳方式是将数据类型乘以一个整数。您可以根据您的用例创建一个结构数组。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="0f7c" class="nz nc it ly b gy op oq l or os">phoneArray = c_int * 10</span></pre><p id="47dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以创建数组的新实例，并像使用列表一样使用它。</p><pre class="kj kk kl km gt ol ly om on aw oo bi"><span id="00b9" class="nz nc it ly b gy op oq l or os">phone_list = phoneArray()</span><span id="9338" class="nz nc it ly b gy ox oq l or os">phone_list[0] = 32</span><span id="b8c3" class="nz nc it ly b gy ox oq l or os">for i in phone_list:<br/>    print(i)</span></pre></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="5b3c" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">3.结论</h1><p id="ed1a" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">让我们回顾一下今天所学的内容。</p><p id="8e67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从对<code class="fe lv lw lx ly b">ctypes</code>的简单解释开始，并设置了我们教程中需要使用的<code class="fe lv lw lx ly b">dll</code>。</p><p id="d998" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们加载了基于操作系统的共享库，并深入研究了模块提供的可用数据类型。之后，我们根据头文件的引用调用了<code class="fe lv lw lx ly b">dll</code>中可用的函数。</p><p id="8ca0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还测试了指针的创建，并通过<code class="fe lv lw lx ly b">byref</code>函数将它发送给一个函数。此外，我们创建了相应的<code class="fe lv lw lx ly b">Structure</code>和<code class="fe lv lw lx ly b">Array</code>对象，它们可以在我们的Python文件中正常使用。</p><p id="0eae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读这篇文章。希望在下一篇文章中再见到你！</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="9d5c" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">参考</h1><ul class=""><li id="1c25" class="mg mh it lb b lc nt lf nu li oy lm oz lq pa lu ot mm mn mo bi translated"><a class="ae ky" href="https://docs.python.org/3.8/library/ctypes.html" rel="noopener ugc nofollow" target="_blank"> ctype文档</a></li><li id="0c0a" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ot mm mn mo bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/archive/blogs/yizhang/calling-c-functions-from-python-part-1-using-ctypes" rel="noopener ugc nofollow" target="_blank">从Python调用C函数—微软教程</a></li><li id="91ca" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ot mm mn mo bi translated"><a class="ae ky" href="https://medium.com/@ngwaifoong92/how-to-create-c-c-dynamic-link-libraries-in-windows-28abefc988c9" rel="noopener">如何在Windows中创建C/C++动态链接库</a></li></ul></div></div>    
</body>
</html>