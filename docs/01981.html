<html>
<head>
<title>Turning Your Existing App Into a Progressive Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将您现有的应用程序转变为渐进式网络应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/turning-your-existing-application-into-a-pwa-776d65b0aa12?source=collection_archive---------12-----------------------#2019-10-28">https://betterprogramming.pub/turning-your-existing-application-into-a-pwa-776d65b0aa12?source=collection_archive---------12-----------------------#2019-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c0c738b8cd5f9aa45be36f3bcdd86c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xRCaOsTKuCDNxCoH"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@frostroomhead?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">罗迪翁·库察耶夫</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="d79c" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">让我们深入了解什么是PWA，如何实现它，以及它的局限性</h2></div><p id="4d80" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你正在考虑将一个web应用程序重构为一个移动应用程序，在重写整个前端代码库之前，你需要评估几件事情。</p><p id="ccf0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你也许可以用一个简单得多的解决方案、先进的网络应用程序和服务人员来实现你的目标。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="7973" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">什么是PWA？</h1><p id="69f1" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">渐进式网络应用有许多技术定义，但最简单的说法是，它是一个可以直接从浏览器下载的网站。</p><p id="7d3a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它给你建立一个移动应用程序的便利的常规网站的所有好处。</p><p id="a8ea" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这也意味着它允许您的应用程序发送通知，并在所有支持的设备上以离线模式工作，就像普通应用程序一样[1]。只要你的网站响应迅速，你的应用程序就可以为所有移动用户所用，这些用户代表了今天大多数的在线用户。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="1ef0" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">使用PWA的优势</h1><p id="814b" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">Twitter和全球速卖通[2]等公司最近向使用PWAs过渡了很多。</p><p id="8d0f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PWAs作为手机app有自己的优势。应用程序是下载的，但没有安装，所以没有必要提交给任何移动应用程序商店。这使得它们以更快的方式提供给用户，允许客户绕过产品生命周期中的许多瓶颈，例如更新的批准等待[2]。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="1911" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">服务人员</h1><p id="634d" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">所有这一切都是由浏览器的服务人员促成的。它们由浏览器运行与其他服务器通信的脚本组成，很像代理服务器[3]。出于安全原因，服务人员只在HTTPS上运行，因为他们有能力拦截网络请求和修改响应。</p><p id="cbf9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些脚本，很像web workers，允许你的浏览器运行异步的、基于事件的功能，而不中断或阻塞你的应用程序，大量使用承诺，并在一个独立于主线程的线程中运行[3]。这些工人不能直接访问DOM，所以他们不能使用浏览器的本地存储。因此，服务人员使用缓存API。高速缓存允许您保存相关文件和数据，并模拟离线模式。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="0c77" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">设立公共工程局</h1><h2 id="b7a9" class="my mc jj bd md mz na dn mh nb nc dp ml lh nd ne mn ll nf ng mp lp nh ni mr nj bi translated">第一步</h2><p id="1836" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">首先，您需要在您的目录中建立一个<code class="fe nk nl nm nn b">.webmanifest</code>文件，并在HTML中添加一个链接来访问您的web清单文件，类似于您对CSS样式表所做的，在<code class="fe nk nl nm nn b">head</code>标记中。</p><p id="f132" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">web manifest是一个JSON对象，它将作为浏览器下载应用程序的向导。它应该包含你的应用程序的基本信息，如名称，网址，图标等。</p><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="f0ff" class="my mc jj bd md mz na dn mh nb nc dp ml lh nd ne mn ll nf ng mp lp nh ni mr nj bi translated">第二步</h2><p id="6929" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">下一步是检查浏览器是否支持服务人员，如果支持，就注册它。</p><p id="58b7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有几种方法可以完成这一步。如果您使用的是普通JS，您将在加载时添加一个事件监听器来运行检查，然后注册服务工作器。在使用框架的实例中，比如React，你将在主HTML文件中添加一个运行类似逻辑的脚本，在<code class="fe nk nl nm nn b">body</code>标签之外。</p><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="0bdc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最佳做法是在开发模式下每次重新加载浏览器时更新您的服务人员，因此请确保在浏览器的开发人员工具上进行检查。</p><h2 id="df23" class="my mc jj bd md mz na dn mh nb nc dp ml lh nd ne mn ll nf ng mp lp nh ni mr nj bi translated">第三步</h2><p id="5440" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">最后，您将设置您的服务人员。首先，您将在您的项目目录中创建一个<code class="fe nk nl nm nn b">serviceWorker.js</code>文件。在这个文件中，您将为您的服务人员添加所有主要功能。为了跟踪服务工作者的生命周期，您需要三个主要的事件侦听器。请记住，您可以随时添加更多内容来配置您的服务人员。</p><p id="78d0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 3.1 —安装</strong></p><p id="1b87" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您的服务人员将收听的第一个事件是<code class="fe nk nl nm nn b">install</code>，这是它注册后做的第一件事。在这里，您将在浏览器中创建一个缓存，并存储所有静态文件，允许您的应用程序离线运行。</p><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="68bf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，这里的关键字<code class="fe nk nl nm nn b">self</code>让您可以访问服务工作器的全局范围以及它可用的方法和对象。</p><p id="2a44" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 3.2 —激活</strong></p><p id="23e6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">服务人员将收听的第二个事件是<code class="fe nk nl nm nn b">activate</code>，它在安装完成后立即被触发。虽然它被激活了，但是应用程序只会在下次重新加载时使用它。</p><p id="f902" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确保服务工作者在当前会话中被使用，您必须使用<code class="fe nk nl nm nn b">clients</code>对象，它允许您访问当前可执行上下文中的方法。通过调用方法<code class="fe nk nl nm nn b">claim</code>，服务工作者成为该上下文的控制器。</p><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="e8ec" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 3.3 —获取</strong></p><p id="42ca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，您将为<code class="fe nk nl nm nn b">fetch</code>请求添加一个事件监听器，在这里您的服务人员将请求定向到网络或您的缓存，模拟离线模式。</p><p id="9ba2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个事件，通过检查从哪里请求信息来分解流量。如果是来自您自己的应用程序的数据，比如您的静态文件，就从您之前创建的缓存中提供它们。在所有其他情况下，它需要来自网络的数据，这时您需要为离线模式添加条件语句。这将使您的服务人员在网络无法响应的情况下从缓存中获取数据。</p><figure class="no np nq nr gt iv"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d06c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在所有这些步骤中，通过检查你的浏览器的开发者工具应用程序标签来实现这一点是很重要的，这样你就可以更好地理解他们每个人实际上在做什么。</p><p id="954e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将能够看到您的服务人员、缓存存储和清单。完成后，你可以点击开发者工具中应用清单上的“添加到主屏幕”链接，将应用添加到主屏幕。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="5446" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated"><strong class="ak">结论</strong></h1><p id="395c" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">与任何工程解决方案一样，也有缺点。</p><p id="e5e5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PWAs无法让您充分利用本地移动环境中的所有功能[4]。这意味着它不能提供具有最佳性能和响应能力的用户界面。如果那是你正在寻找的，坚持使用特定于移动环境的框架，比如React Native。</p><p id="3dd0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您选择将您的web应用程序转变为PWA，通过简单的设置，您将拥有一个可下载的应用程序，可以在任何平板电脑或智能手机上访问，并为您的所有移动用户提供令人惊叹的新功能。</p><p id="a9b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此设置仅允许您使用离线模式，但请记住，您可以向服务人员添加许多其他配置，以使您的应用程序的用户体验更好，如推送通知和定期后台同步。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="5ffe" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">参考资料和有用的链接:</h1><blockquote class="nu nv nw"><p id="a65f" class="ky kz nx la b lb lc kk ld le lf kn lg ny li lj lk nz lm ln lo oa lq lr ls lt im bi translated">[1]<a class="ae jg" href="https://medium.com/@deepusnath/4-points-to-keep-in-mind-before-introducing-progressive-web-apps-pwa-to-your-team-8dc66bcf6011" rel="noopener">https://medium . com/@ deepusnath/4-points-to-keep-in-mind-before-introducing-progressive-web-apps-pwa-to-your-team-8dc 66 BCF 6011</a></p><p id="9be7" class="ky kz nx la b lb lc kk ld le lf kn lg ny li lj lk nz lm ln lo oa lq lr ls lt im bi translated">[2]<a class="ae jg" href="https://apiumhub.com/tech-blog-barcelona/progressive-web-apps/" rel="noopener ugc nofollow" target="_blank">https://apiumhub . com/tech-blog-Barcelona/progressive-we b-apps/</a></p><p id="33ca" class="ky kz nx la b lb lc kk ld le lf kn lg ny li lj lk nz lm ln lo oa lq lr ls lt im bi translated">[3]<a class="ae jg" href="https://developers.google.com/web/fundamentals/primers/service-workers" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/fundamentals/primers/service-workers</a></p><p id="685b" class="ky kz nx la b lb lc kk ld le lf kn lg ny li lj lk nz lm ln lo oa lq lr ls lt im bi translated"><a class="ae jg" href="https://www.kirupa.com/apps/pwa_vs_react_native.htm" rel="noopener ugc nofollow" target="_blank">https://www.kirupa.com/apps/pwa_vs_react_native.htm</a></p><p id="b0e5" class="ky kz nx la b lb lc kk ld le lf kn lg ny li lj lk nz lm ln lo oa lq lr ls lt im bi translated"><a class="ae jg" href="https://www.youtube.com/watch?v=E8BeSSdIUW4" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=E8BeSSdIUW4</a></p></blockquote></div></div>    
</body>
</html>