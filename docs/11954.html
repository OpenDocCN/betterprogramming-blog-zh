<html>
<head>
<title>I Built a Password Generator Using Python — and It’s Safe From Key Loggers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我使用Python构建了一个密码生成器——它不会受到键盘记录器的攻击</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/passwords-that-are-safe-even-from-key-loggers-708b002d27a8?source=collection_archive---------5-----------------------#2022-04-29">https://betterprogramming.pub/passwords-that-are-safe-even-from-key-loggers-708b002d27a8?source=collection_archive---------5-----------------------#2022-04-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9bde" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解我为什么构建它，以及您如何构建和定制它</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/34b5ec6d71d0e7424af602434a3364d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2QG-E2XFClgCaNfV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@bermixstudio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bermix工作室</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a6aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我是偏执狂。我不想与密码管理员共享我的密码。我不想把它们写下来或打在任何地方。</p><p id="6c2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我甚至不想亲眼看到它们，永远。</p><p id="a058" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不想记住他们。我希望每个人都有独特的17个字符，所有那些有趣的规则，至少有一个大写字母，一个小写字母，一个数字，一个特殊字符，等等。</p><p id="bcd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不希望键盘记录程序能够截获我的密码。我也不想丢失任何密码。</p><p id="953d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我要求的太多了吗？</p><h2 id="69d1" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">啊哈！</h2><p id="6467" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">最近，在研究Python编程思想时，我又一次灵光一现“啊哈！”瞬间，本文中的代码就诞生了。是的，它符合上面提到的所有要求。让我解释一下。</p><h1 id="7b81" class="mu lx it bd ly mv mw mx mb my mz na me jz nb ka mh kc nc kd mk kf nd kg mn ne bi translated">一些背景</h1><p id="d9bc" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">首先，在我开始解释这个程序之前，这里有一个你如何使用它的例子。</p><p id="1245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当系统提示您输入密码时，请将您所在网页的完整URL复制到剪贴板中。</p><p id="153c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行<code class="fe nf ng nh ni b">urlpassword.py</code>程序。它会活过来，向你要一个简短的个人密钥，然后很快消失，屏幕上除了你的密钥之外，没有任何密码或任何东西。最后，只需从剪贴板粘贴到密码字段，你就完成了。</p><h1 id="d802" class="mu lx it bd ly mv mw mx mb my mz na me jz nb ka mh kc nc kd mk kf nd kg mn ne bi translated">它是如何工作的</h1><p id="5e39" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">几乎在所有情况下，密码对于您登录的域都是唯一的。</p><p id="93a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你登录到某个地方时，在你的浏览器中查看URL或网址行，你会看到核心域地址前面有类似于<code class="fe nf ng nh ni b">https://</code>的东西，后面是一些额外的数据，确切地定义了你在那个域中的位置。</p><p id="2776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比如你登录亚马逊，核心域名是<code class="fe nf ng nh ni b"><a class="ae ky" href="http://www.amazon.com" rel="noopener ugc nofollow" target="_blank">www.amazon.com</a></code>，对于谷歌是<code class="fe nf ng nh ni b"><a class="ae ky" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank">www.google.com</a></code>等等。使用Python，很容易从完整URL中提取核心域字符串，不管它是什么。但是域名只是用来生成你的唯一密码的一部分。</p><p id="b35b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个<code class="fe nf ng nh ni b">urlpassword.py</code>程序是专门为你修改的。更改代码非常简单，我稍后将向您展示如何以及在哪里更改代码。</p><p id="34cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有人从你的电脑上获得你的程序，他们仍然需要知道你的密钥(银行密码是理想的，但任何易于输入和记忆的短字符串都是完美的)，否则他们将生成一个完全不同的密码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/118f3b8ac6e94ae44aeede8534556d94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D_1FhBGdti4QVO-o"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@minutekey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">分钟键</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="9e18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，一个坏人通过一个键盘记录程序窃取了你的钥匙，他仍然需要从你的电脑上获得这个程序的拷贝。破解你的密码需要两个部分。</p><h1 id="941f" class="mu lx it bd ly mv mw mx mb my mz na me jz nb ka mh kc nc kd mk kf nd kg mn ne bi translated">urlpassword.py代码</h1><p id="e19c" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这是这个程序的主要源代码。请注意，它导入了另外两个模块，我将在接下来解释这些模块。</p><pre class="kj kk kl km gt nk ni nl nm aw nn bi"><span id="c5e0" class="lw lx it ni b gy no np l nq nr">import pyperclip<br/>from prb import *</span><span id="9950" class="lw lx it ni b gy ns np l nq nr">url = pyperclip.paste()<br/>domain = url.split("/")[2].lower()<br/>key = input(f"{domain} ... Enter your key: ")<br/>prb = Prb(domain + key)<br/>a1 = "abcdefghijklmnopqrstuvwxyz"<br/>a2 = a1.upper()<br/>a3 = "1234567890"<br/>a4 = "!#$%*^&amp;@~"<br/>a5 = a1 + a2 + a3 + a4<br/>pw = []<br/>pw.append(a1[prb.next_byte() % len(a1)])<br/>pw.append(a2[prb.next_byte() % len(a2)])<br/>pw.append(a3[prb.next_byte() % len(a3)])<br/>pw.append(a4[prb.next_byte() % len(a4)])<br/>n = 0<br/>while len(pw) &lt; 17:<br/>    n += prb.next_byte(n)<br/>    n %= len(a5)<br/>    pw.insert(prb.next_byte() % (len(pw) + 1), a5[n])<br/>pw = "".join(pw)<br/>pyperclip.copy(pw)</span></pre><p id="75bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">URL字符串是从系统剪贴板中获取的，在前几行中提取域。</p><p id="d12a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一行提示您输入您的密钥，域字符串和您的密钥的组合用于初始化<code class="fe nf ng nh ni b">Prb</code>对象(伪随机字节)。</p><p id="89f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能希望在新密码中使用的所有字符都存储在字符串<code class="fe nf ng nh ni b">a1</code>到<code class="fe nf ng nh ni b">a4</code>中。</p><p id="d676" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想添加或删除任何字符，请在这里随意操作。列表<code class="fe nf ng nh ni b">pw</code>是通过首先从这些字符串中的每一个添加一个字符来构建的。这保证了每组中至少有一个。</p><p id="1dbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">while循环使用伪随机字节在随机位置将额外的字符插入到<code class="fe nf ng nh ni b">pw</code>列表中，直到列表中有17个字符。</p><p id="ac0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随意将<code class="fe nf ng nh ni b">17</code>改成你想要的任意长度的密码。最后，这个列表被连接成一个单独的密码字符串，然后被塞进系统剪贴板，等待您粘贴。</p><h1 id="a931" class="mu lx it bd ly mv mw mx mb my mz na me jz nb ka mh kc nc kd mk kf nd kg mn ne bi translated">Pyperclip</h1><p id="60e2" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">注意<code class="fe nf ng nh ni b">pyperclip</code>模块是由这个程序导入的。</p><p id="aa9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个简单且一次性的<code class="fe nf ng nh ni b">pip install pyperclip</code>将这个库添加到您的Python安装中。</p><p id="e869" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在<code class="fe nf ng nh ni b">pyperclip</code>的<a class="ae ky" href="https://pypi.org/project/pyperclip/" rel="noopener ugc nofollow" target="_blank"> Pypi页面这里</a>了解更多关于<code class="fe nf ng nh ni b">pyperclip</code>的信息。基本上，这增加了从剪贴板中抓取数据并将数据放回其中的能力。我在很多实用Python程序中一直使用它。</p><h2 id="c79d" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">伪随机字节有多好？</h2><p id="90ac" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated"><code class="fe nf ng nh ni b">Prb</code>类也被导入到<code class="fe nf ng nh ni b">prb.py</code>模块中。在我解释之前，下面是代码清单:</p><pre class="kj kk kl km gt nk ni nl nm aw nn bi"><span id="c793" class="lw lx it ni b gy no np l nq nr">class Prb:<br/>    def __init__(self, seed):<br/>        id = "<a class="ae ky" href="https://craigware.com" rel="noopener ugc nofollow" target="_blank">J</a>ohnClarkCraig"<br/>        unique = "NbROtW62oDiJH9y0*p20F1Bj2*bQyj&amp;IcA"<br/>        unique_seed = seed + id + unique<br/>        len_unique_seed = len(unique_seed)<br/>        self.p, self.q = 0, 0<br/>        self.buf = list(range(256))<br/>        for i in range(9973):<br/>            n = ord(unique_seed[i % len_unique_seed])<br/>            self.next_byte(n + self.next_byte())</span><span id="b1dc" class="lw lx it ni b gy ns np l nq nr">    def next_byte(self, b=0):<br/>        self.p = (self.buf[self.p] + b + 1) % 256<br/>        self.q = (self.buf[self.q] + b + 2) % 256<br/>        self.buf[self.p], self.buf[self.q] = <br/>                self.buf[self.q], self.buf[self.p]<br/>        return self.p ^ self.q</span></pre><p id="b955" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个类维护一个名为<code class="fe nf ng nh ni b">buf</code>的列表，包含从0到255的256个整数。变量<code class="fe nf ng nh ni b">p</code>和<code class="fe nf ng nh ni b">q</code>是这个列表的索引。</p><p id="9537" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每次调用<code class="fe nf ng nh ni b">next_byte()</code>时，列表项的索引和顺序都会根据可选的传递整数<code class="fe nf ng nh ni b">b</code>进行随机化。</p><p id="fcca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使改变传递到这个方法中的数字b的一位，输出字节的序列也会完全改变。</p><h1 id="6381" class="mu lx it bd ly mv mw mx mb my mz na me jz nb ka mh kc nc kd mk kf nd kg mn ne bi translated">专为您定制</h1><p id="ba89" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">回想一下，用于初始化这个伪随机字节生成器的种子字符串是从主程序传递过来的，它包含当前域和您的密钥。</p><p id="54d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与上面显示的<code class="fe nf ng nh ni b">id</code>字符串结合在一起，它明确地标识了您的唯一性，以及您想要通过名为unique的字符串加入的一组或多或少随机的字符。</p><p id="9614" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，这个长的组合字符串被一遍又一遍地输入到<code class="fe nf ng nh ni b">next_byte()</code>方法中，将生成器初始化为一个绝对唯一的状态。(可用的独特状态比已知宇宙中的电子还多。到目前为止。)</p><p id="e40c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，我已经将<code class="fe nf ng nh ni b">Prb</code>代码提交给了一些专家，他们说它非常好。</p><p id="8213" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，在使用各种众所周知的伪随机字节测试程序进行了大量广泛的测试后，它已顺利通过。当然，它不是经过专业认证的加密算法，但对于个人密码保护来说，它非常有效，你可以相信它不会有任何后门或神秘的代码。</p><p id="650d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个程序生成的密码对暴力攻击有很强的抵抗力。黑客需要得到你的程序的唯一拷贝，然后通过你可能选择的所有可能的快捷键进行暴力破解。</p><p id="3c0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这在理论上是可能发生的，但是比较一下通过键盘记录器、在线密码管理程序攻击或其他你无法控制的邪恶事件攻击你的密码的可能性。</p><p id="0b3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议通过更改<code class="fe nf ng nh ni b">Prb</code>类中显示的字符串来定制您的程序副本，然后不要再更改它们。任何微小的改变都会导致你所有的密码都不一样。将程序的纸质副本保存在安全的地方，以防您出于任何原因需要恢复它。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt nk ni nl nm aw nn bi"><span id="53b8" class="lw lx it ni b gy no np l nq nr"><strong class="ni iu">Want to Connect?</strong></span><span id="2a6b" class="lw lx it ni b gy ns np l nq nr">John’s passion and mission are sharing Python code to help demystify life’s challenges and to have fun. John is the author of <a class="ae ky" href="https://amzn.to/3k4O39j" rel="noopener ugc nofollow" target="_blank">Python for Numworks</a> , <a class="ae ky" href="https://amzn.to/3mHK0Br" rel="noopener ugc nofollow" target="_blank">Python for OpenSCAD</a>, <a class="ae ky" href="https://read.amazon.com/kp/embed?asin=B09DJ7MRDX&amp;preview=newtab&amp;linkCode=kpe&amp;ref_=cm_sw_r_kb_dp_Z6AHQNW2MQBZHCNKC38G&amp;tag=solarproud-20" rel="noopener ugc nofollow" target="_blank">Python for the TI-Nspire CX II</a>, <a class="ae ky" href="https://read.amazon.com/kp/embed?asin=B09GJMBDMF&amp;preview=newtab&amp;linkCode=kpe&amp;ref_=cm_sw_r_kb_dp_Z6AHQNW2MQBZHCNKC38G&amp;tag=solarproud-20" rel="noopener ugc nofollow" target="_blank">Python for the TI-84 Plus CE Python calculator</a> , and <a class="ae ky" href="http://johnclarkcraig.com/" rel="noopener ugc nofollow" target="_blank">many other titles</a>.</span></pre></div></div>    
</body>
</html>