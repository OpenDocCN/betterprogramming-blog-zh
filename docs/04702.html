<html>
<head>
<title>Create Easy Disk Snapshots With AWS Data Lifecycle Manager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS数据生命周期管理器创建简单的磁盘快照</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/easy-disk-snapshots-with-aws-data-lifecycle-manager-9e36bf66019b?source=collection_archive---------13-----------------------#2020-04-30">https://betterprogramming.pub/easy-disk-snapshots-with-aws-data-lifecycle-manager-9e36bf66019b?source=collection_archive---------13-----------------------#2020-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="084c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">立即备份您的数据，不要在以后付出代价</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e43287555d4727fb9470e3f573ee45d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sZeLENcDRLJUR6TRikTuBg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@0asa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">文森特·博塔</a>在<a class="ae ky" href="https://unsplash.com/s/photos/hard-drive?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="e820" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几乎任何人都可以在Amazon AWS上快速开始构建基础设施。只需点击一个按钮，您就可以启动新的虚拟机并添加大量存储。快速创建机器的能力是有用的，但是如何保护所有这些数据呢？</p><p id="291a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在过去，设置不同的备份/快照策略是一项繁琐的工作，需要配置笨重的脚本或重复的任务来保护您的数据。手动管理快照策略一点也不好玩，只会妨碍完成工作。</p><p id="5c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">亚马逊推出了<a class="ae ky" href="https://docs.aws.amazon.com/dlm/latest/APIReference/Welcome.html" rel="noopener ugc nofollow" target="_blank">数据生命周期管理器</a> (DLM)，让事情变得简单多了。使用DLM，您可以配置一个定期计划来拍摄实例或卷快照。数据保留策略也很简单，只需设置要保留数据的数量或最长期限。</p><p id="0620" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何在卷上设置新策略。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5c41" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">生命周期管理器策略</h1><p id="4fee" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">创建新的生命周期策略非常简单，只需要几个简单的配置项目。访问AWS中的EC2控制台。在EBS部分，您应该看到“生命周期管理器”<em class="mz"> </em>项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/2ab36a2c88ee366d0a5b698b3736d33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*lMTiKNwTVKsZ8yVj6ZmfBA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示生命周期管理器菜单项的EC2控制台。</p></figure><p id="dfdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入生命周期管理器后，单击“创建快照生命周期策略”这将开始设置一个新策略，让您决定何时保留磁盘快照以及保留多长时间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/84101924e2c5853eb731572ba5c155d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AUjdE7vRvxyh3tBV-kbVw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在DLM创造新政策。</p></figure><p id="8b77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开始创建新策略后，您有两种选择来创建快照类型:一个<em class="mz">卷</em>或<em class="mz">实例</em>类型。实例类型将拍摄整个EC2实例的快照，而卷将拍摄EBS卷的快照。</p><p id="3240" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本例，让我们选择卷选项，并为新策略命名。在大多数情况下，您将只关心实例的关联卷，而不是实例本身。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7815" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">把…作为目标</h1><p id="f402" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">“使用这些标记的目标”部分控制要拍摄快照的卷。您可以使用您喜欢的任何标记来定位卷。在本例中，我选择仅将名为<code class="fe nc nd ne nf b">TEST_VOLUME</code>的卷作为目标。</p><p id="54a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在实际情况下，您可能希望将一个标记应用于多个卷，并以该标记为目标。这样，当您想要向快照策略添加更多卷时，只需向卷添加标记。像这样的标签可能是:</p><pre class="kj kk kl km gt ng nf nh ni aw nj bi"><span id="ea57" class="nk md it nf b gy nl nm l nn no">MySnapshotPolicy: true</span></pre><p id="a443" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何具有该标记的卷都将根据策略开始拍摄快照。但是对于这个示例策略，我们只是直接以单个卷的名称为目标，只是为了进行测试。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3a7f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">计划和保留</h1><p id="c9c4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在下一部分中，您将为旧快照配置策略计划和保留期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/ae50c37a316c27e4282b0d7c0ab17f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a452y0baEHHEPE6RQO9Q_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DLM的政策时间表。</p></figure><p id="cb59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先为新策略命名，然后选择何时运行该策略。这是一个周期性的计划，所以你可以选择不同的小时增量，如12或24。对于图中的策略，我们已经设置了一个每日时间表，从UTC时间每天上午9:00开始。</p><p id="d45c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保选择非工作时间拍摄快照。一般来说，选择在夜间拍摄是个好主意，这样你就不会在繁忙的使用时段拍摄快照。UTC时间上午9:00对应于PDT时间上午2:00，这非常适合这个场景。</p><p id="85a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，选择保留类型。这可以是对要保留的快照数量的简单计数，也可以是按天数、周数、月数或年数进行的计数。此策略将保留最后五个快照，在本例中为最后五天。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b720" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">磨尖</h1><p id="4dbe" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">完成计划设置后，您有机会向新快照添加标记。为所有新快照配置“Name”标记是一个好主意，这样您就可以在查看快照控制台时区分它们。</p><p id="3f51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以复制策略将拍摄快照的卷上出现的任何标记。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/4094be07740817c9a0eb7c87cf852f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8YdqUFNeNw_hmfTR-fukyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DLM策略中的快照标记信息。</p></figure><p id="156e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除非您需要快照包含与卷相同的标记，否则可以不选中“从卷复制标记”选项。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3cf0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">完成安装</h1><p id="0a63" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">随着您继续完成策略设置的其余部分，您将有机会配置可选功能，如“快速快照恢复”或“跨区域拷贝”<em class="mz"> </em>除非你对这些东西有特定的需求，否则可以让它们禁用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/1a04cf70ac775c87aec10371b218f2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgDGBpMH5uKSthiWVcpL7w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在DLM配置IAM角色。</p></figure><p id="08cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保留默认的IAM角色，除非您事先为此策略预配置了特定的权限角色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/07ba5787ea5daf8d9a4bcec27f71159d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DJ3w7twUUB3mYXGA72hqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完成DLM的新策略设置。</p></figure><p id="d561" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保策略摘要准确反映您希望如何拍摄和保留快照。对整体配置感到满意后，单击“创建策略”。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="7be7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！您刚刚创建了第一个数据生命周期管理器策略。您的目标卷应该会根据您的计划自动开始拍摄快照。</p><p id="e41f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在拍摄第一张快照后，最好在快照控制台中快速直观地确认一切设置正确。确认标签如预期的那样被应用，并且时间表正常工作，可以省去您以后的麻烦。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="fc71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">感谢阅读！我希望您喜欢更多地了解AWS中的数据生命周期策略。</em></p></div></div>    
</body>
</html>