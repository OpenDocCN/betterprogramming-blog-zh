<html>
<head>
<title>Build a SwiftUI Contacts Search Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建SwiftUI联系人搜索应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-swiftui-contacts-search-application-d41b414fe046?source=collection_archive---------9-----------------------#2020-06-19">https://betterprogramming.pub/build-a-swiftui-contacts-search-application-d41b414fe046?source=collection_archive---------9-----------------------#2020-06-19</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="8118" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">利用SwiftUI的强大功能及其与UIKit的互操作性</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/a6468dd4d3c6be96d79e95291ba72b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7IpvXRXAIgwg_DE7ruOM0g.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">马库斯·温克勒在<a class="ae kz" href="https://unsplash.com/s/photos/search?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7103" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着SwiftUI完成一年，WWDC 2020有很多值得期待的地方。拥有一个现成的搜索栏功能应该是每个人的愿望。</p><p id="bfe1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在那之前，我们可以利用SwiftUI-UIKit互操作性来构建一个定制的搜索栏。</p><p id="d88f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在接下来的部分中，我们将构建一个用于搜索联系人的SwiftUI应用程序。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="05e7" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">行动（或活动、袭击）计划</h1><ul class=""><li id="52a7" class="mv mw iu lc b ld mx lg my lj mz ln na lr nb lv nc nd ne nf bi translated">使用联系人框架来获取您的电话联系人。</li><li id="b671" class="mv mw iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">在SwiftUI列表中填充它们。</li><li id="6f0b" class="mv mw iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">使用<code class="fe nl nm nn no b">UIViewRepresentable</code>协议为SwiftUI创建一个<code class="fe nl nm nn no b">UISearchBar</code>包装器。</li><li id="8641" class="mv mw iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">根据搜索文本过滤SwiftUI联系人列表。</li></ul></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="f29f" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">开始—添加隐私描述</h1><p id="3844" class="pw-post-body-paragraph la lb iu lc b ld mx jv lf lg my jy li lj np ll lm ln nq lp lq lr nr lt lu lv in bi translated">联系人框架让您无需做任何更改即可读取信息。为了在您的应用程序中访问它，我们首先需要在<code class="fe nl nm nn no b">info.plist</code>文件中设置隐私使用描述。只需添加带有字符串值的<code class="fe nl nm nn no b">NSContactsUsageDescription</code>键，解释对权限的需求。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ns"><img src="../Images/223158fc9788ed7238c250ba4476e6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*kHWE5rxXOc1zkf5KXndHxw.png"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="8e96" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">用UIViewRepresentable和Coordinators包装UISearchBar</h1><p id="da8e" class="pw-post-body-paragraph la lb iu lc b ld mx jv lf lg my jy li lj np ll lm ln nq lp lq lr nr lt lu lv in bi translated">SwiftUI没有内置搜索栏功能。因此，我们需要使我们的结构符合<code class="fe nl nm nn no b">UIViewRepresentable</code>协议，并在其中初始化UIKit的<code class="fe nl nm nn no b">UISearchBar</code>实例，如下所示:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="9503" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nl nm nn no b">makeCoordinator()</code>函数让我们创建一个<code class="fe nl nm nn no b">Coordinator</code>类，它负责从我们的UIKit视图向SwiftUI接口传递更改。让我们定义<code class="fe nl nm nn no b">Coordinator</code>类，它也声明了<code class="fe nl nm nn no b">UISearchBarDelegate</code>协议:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="9d05" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">创建一个用于获取联系人的ObservableObject类</h1><p id="8406" class="pw-post-body-paragraph la lb iu lc b ld mx jv lf lg my jy li lj np ll lm ln nq lp lq lr nr lt lu lv in bi translated"><code class="fe nl nm nn no b">ObservableObject</code>协议是Combine框架的一部分，用于通过<code class="fe nl nm nn no b">@Published</code> <strong class="lc iv"> </strong>属性包装器在SwiftUI视图中宣布变更。</p><p id="ece2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在下面的代码中，我们在确保权限被授予后获取联系人，然后将他们存储在一个<code class="fe nl nm nn no b">Published</code>属性包装数组中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="9b50" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">SwiftUI需要一种唯一识别每个联系人的方法。为了做到这一点，我们在末尾创建了一个符合<code class="fe nl nm nn no b">Identifiable</code>协议的扩展。</p><p id="a2b8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我们已经准备好在SwiftUI视图中集成搜索栏包装器和<code class="fe nl nm nn no b">ObservableObject</code>类实例。让我们开始吧。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="66f3" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">构建SwiftUI视图</h1><p id="28c2" class="pw-post-body-paragraph la lb iu lc b ld mx jv lf lg my jy li lj np ll lm ln nq lp lq lr nr lt lu lv in bi translated">我们将使用一个<code class="fe nl nm nn no b">@EnvironmentObject</code>来检索联系人。属性包装器允许您访问整个应用程序中的共享数据。</p><p id="9af2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在下面的代码中，通过使用SwiftUI列表，我们能够填充联系人，并基于<code class="fe nl nm nn no b">searchText</code>值的变化使用<code class="fe nl nm nn no b">filter</code>更新他们。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="f1f9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是我们在一个包含一些虚拟触点的模拟器上运行应用程序时的情况:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nv"><img src="../Images/78a52cecf55cb392ff1bf1cfcb85f5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/1*ZbBXm9NL4WD4Nn976tBnBw.gif"/></div></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="0df2" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">结论</h1><p id="a454" class="pw-post-body-paragraph la lb iu lc b ld mx jv lf lg my jy li lj np ll lm ln nq lp lq lr nr lt lu lv in bi translated">尽管SwiftUI不支持内置搜索栏，但我们还是很快成功地建立了一个具有搜索功能的SwiftUI联系人应用程序。</p><p id="c260" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">用<code class="fe nl nm nn no b">UITableView</code>和<code class="fe nl nm nn no b">UISearchBar</code>做同样的事情会花费大量的时间、精力和代码。我们希望在2020年WWDC奥运会上看到SwiftUI 2.0增加新功能。</p><p id="90df" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以从<a class="ae kz" href="https://github.com/anupamchugh/iowncode/tree/master/SwiftUIContactSearch" rel="noopener ugc nofollow" target="_blank"> Github资源库</a>下载完整的源代码。</p><p id="0473" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这一次到此为止。感谢阅读。</p></div></div>    
</body>
</html>