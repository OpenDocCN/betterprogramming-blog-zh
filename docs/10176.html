<html>
<head>
<title>How to Change Scroll View Color in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中更改滚动视图颜色</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-change-scroll-view-color-in-swiftui-4b6b84f4a305?source=collection_archive---------8-----------------------#2021-12-08">https://betterprogramming.pub/how-to-change-scroll-view-color-in-swiftui-4b6b84f4a305?source=collection_archive---------8-----------------------#2021-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3e8b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这比想象的要难</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7e9bd506aec6b380b1cd539c969deae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kvJzoOC6HNfs32Zz"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@docusign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">医生</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f486" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">iOS 15的发布为SwiftUI带来了一些急需的改进。我们现在有了原生搜索栏，甚至对文本视图的标记支持。</p><p id="c91e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是不知何故，SwiftUI <code class="fe ls lt lu lv b">ScrollView</code>仍然有点混乱。这个来自Reddit的家伙说得很好:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/4ec0881b60aac430932af24fdf38ed37.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*Rd3NZ7FHaWLIjFwz5YO8RA.png"/></div></figure><p id="173a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像改变SwiftUI <code class="fe ls lt lu lv b">ScrollView</code>的背景颜色仍然是一个相当大的挑战。直观的做法是直接在<code class="fe ls lt lu lv b">ScrollView</code>上使用<code class="fe ls lt lu lv b">.background</code>修改器，就像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/7bd332cac5ac7cf0098cece835fc8778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DGyHtAWQxn7oMIXqT_RLnQ.png"/></div></div></figure><pre class="kg kh ki kj gt ly lv lz ma aw mb bi"><span id="d633" class="mc md iq lv b gy me mf l mg mh">ScrollView {<br/>    Text(“Hello, World”)<br/>}<br/>.background(Color.purple)</span></pre><p id="3295" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我发现这在某些情况下确实有效，但有一些注意事项。</p><ol class=""><li id="a305" class="mi mj iq ky b kz la lc ld lf mk lj ml ln mm lr mn mo mp mq bi translated">你的<code class="fe ls lt lu lv b">ScrollView</code>必须直接在一个<code class="fe ls lt lu lv b">NavigationView</code>里面(不是导航到的)</li><li id="479b" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">您的<code class="fe ls lt lu lv b">ScrollViews</code>内容必须使用带有<code class="fe ls lt lu lv b">Spacers</code>的<code class="fe ls lt lu lv b">HStack</code>水平缩放，以强制<code class="fe ls lt lu lv b">ScrollView</code>填充屏幕宽度(或手动设置其框架)</li></ol></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="ba69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果这些警告中的任何一个没有被满足，你将会以不想要的行为结束。</p><p id="e29d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要么你的<code class="fe ls lt lu lv b">ScrollView</code>以不同于实际视图背景的颜色显示在中间(问题较少)，要么如果你没有将<code class="fe ls lt lu lv b">ScrollView</code>直接用<strong class="ky ir"> </strong>包裹在<code class="fe ls lt lu lv b">NavigationView</code>中，<code class="fe ls lt lu lv b">ScrollView</code>不会自动折叠导航栏—<em class="nd">—它在下面— </em>，就好像导航栏是透明的一样。</p><blockquote class="ne nf ng"><p id="2597" class="kw kx nd ky b kz la jr lb lc ld ju le nh lg lh li ni lk ll lm nj lo lp lq lr ij bi translated"><em class="iq">绝对不是理想的解决方案！</em></p></blockquote><p id="a557" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我自己的用例中，我发现自己在一个细节屏幕中使用了一个<code class="fe ls lt lu lv b">ScrollView</code>(从另一个屏幕导航到)。</p><p id="3586" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着我没有办法在<code class="fe ls lt lu lv b">ScrollView</code>周围使用另一个<code class="fe ls lt lu lv b">NavigationView</code>(参见警告2)。还有把我的<code class="fe ls lt lu lv b">ScrollView</code>包在两层<code class="fe ls lt lu lv b">NavigationViews</code>(也许还藏了一层？)就是不给我喊稳定。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="14d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你像我一样在谷歌上搜索这些问题，你可能会遇到使用<code class="fe ls lt lu lv b">appearance()</code>修饰语的解决方案。</p><p id="c84e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，当我希望我的<code class="fe ls lt lu lv b">ScrollViews</code>背景变成粉红色时，会出现如下情况:</p><pre class="kg kh ki kj gt ly lv lz ma aw mb bi"><span id="3e5a" class="mc md iq lv b gy me mf l mg mh">UIScrollView.appearance().backgroundColor = UIColor.systemPink</span></pre><p id="8603" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">乍一看，一切都很好。你可以从UIKit <code class="fe ls lt lu lv b">ScrollView</code>中得到你所期望的行为。导航栏折叠，一切正常…</p><p id="8781" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直到你尝试用一个<code class="fe ls lt lu lv b">TextField</code>。编辑<code class="fe ls lt lu lv b">TextField</code>时，您的<code class="fe ls lt lu lv b">TextField</code>的背景颜色会变成您的<code class="fe ls lt lu lv b">ScrollView</code>的颜色。你可以在下面(右)看到一个例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/e0f166a0bbc317d53e6c336393bb299b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joGcubUFQe0JDmXFoHmSKw.png"/></div></div></figure><p id="5bc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么会这样？我不知道。使用<code class="fe ls lt lu lv b">appearance()</code>修饰符有点令人不快，但这是在SwiftUI中让一些东西工作的唯一方法。</p><p id="0b90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不管怎样，它也应该改变完全不相关的组件的颜色是没有意义的。</p><p id="4fc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像这样使用<code class="fe ls lt lu lv b">appearance()</code>修饰符可以改变<code class="fe ls lt lu lv b">TextFields</code>的背景颜色(当编辑它们的时候)以及(以某种方式)键盘自动更正区域。我猜这和某种神奇的SwiftUI巫毒术有关。</p><p id="8b1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们越来越接近了，但如果你必须破坏应用程序中的每个文本字段才能让它工作，这并不是一个真正的解决方案。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="3056" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经过一大堆摆弄和测试，我发现了一个<code class="fe ls lt lu lv b">appearance()</code>修改器，似乎包含了伤害。</p><p id="2566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您实际上可以为<code class="fe ls lt lu lv b">appearance</code>修饰符指定条件。这对于UIKit很有用，因为您可以指定想要应用样式的视图控制器。您还可以指定一个<code class="fe ls lt lu lv b">UITraitCollection</code>来进一步过滤应用样式的地方。</p><p id="4364" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经过反复试验，我发现了一个非常有效的组合:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="fe09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这包括两个部分:</p><p id="b6d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们指定<code class="fe ls lt lu lv b">userInterfaceLevel</code>仅适用于接口级别被视为<code class="fe ls lt lu lv b">base</code>的区域。</p><p id="39dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">苹果文档说这基本上只是你的windows主要内容。还有<code class="fe ls lt lu lv b">elevated</code>的值，我只能假设是<code class="fe ls lt lu lv b">Alerts</code>或<code class="fe ls lt lu lv b">Sheets</code>。</p><p id="f029" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们指定<code class="fe ls lt lu lv b">whenContainedInInstancesOf</code>属性为:</p><pre class="kg kh ki kj gt ly lv lz ma aw mb bi"><span id="7f57" class="mc md iq lv b gy me mf l mg mh">...whenContainedInInstancesOf: [UINavigationController.self]...</span></pre><p id="928d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些条件的结合阻止了滚动视图<code class="fe ls lt lu lv b">appearance()</code>修改器破坏我们的<code class="fe ls lt lu lv b">TextFields</code>和键盘。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="ffdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">指定<code class="fe ls lt lu lv b">whenContainedInInstancesOf</code>属性会将键盘自动校正颜色固定为默认灰色。我猜这是因为键盘不包含在导航控制器中，因为它不是我们应用程序的一部分(它是由iOS提供的)。</p><p id="c5a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，指定<code class="fe ls lt lu lv b">userInterfaceLevel</code>固定<code class="fe ls lt lu lv b">TextField</code>背景。我不确定这是为什么。你会认为你的应用程序中的任何视图都可以被认为是一个<code class="fe ls lt lu lv b">base</code>用户界面级别。也许<code class="fe ls lt lu lv b">TextField</code>改变背景颜色的部分被认为是<code class="fe ls lt lu lv b">elevated</code>。</p><p id="7421" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个不幸的副作用是，这将改变你的应用程序中每个<code class="fe ls lt lu lv b">ScrollView</code>的颜色。但是如果你的应用有一致的风格，那么这个解决方案可能就是你要找的。</p><p id="5448" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用它，把外观修改器放在你的根视图中，或者如果你想保持它是独立的，你可以使用一个类似我做的辅助视图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="0565" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这篇文章能帮助您在SwiftUI这个复杂多变的世界中导航。希望iOS 16中情况有所改善(敲敲木头)。</p><p id="963d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p><pre class="kg kh ki kj gt ly lv lz ma aw mb bi"><span id="54c6" class="mc md iq lv b gy me mf l mg mh"><strong class="lv ir">Want to Connect With the Author?</strong></span><span id="bd1c" class="mc md iq lv b gy nm mf l mg mh">Give me a follow on <a class="ae kv" href="https://twitter.com/iamzanecarter" rel="noopener ugc nofollow" target="_blank">Twitter</a> to see what I’m working on.</span></pre></div></div>    
</body>
</html>