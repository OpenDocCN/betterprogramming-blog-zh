<html>
<head>
<title>Understanding MapReduce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解MapReduce</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/understanding-mapreduce-303c02fcbd9?source=collection_archive---------10-----------------------#2020-09-28">https://betterprogramming.pub/understanding-mapreduce-303c02fcbd9?source=collection_archive---------10-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9457" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解这个编程模型和框架的所有信息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0afa5941295047c8621f508b2fbbee61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRnjuRBHgtkZ828tY85a8A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安德鲁·舒尔茨在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="9efd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">MapReduce</code>是一种在集群上使用并行分布式算法处理大数据的计算模型。</p><p id="657c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它是由谷歌发明的，自2004年以来已在行业中大量使用。很多应用都是基于<code class="fe lv lw lx ly b">MapReduce</code>的，比如分布式基于模式的搜索、分布式排序、web索引系统等。</p><p id="f187" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">MapReduce</code>的灵感来自于函数式编程中常用的<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">reduce</code>函数。<code class="fe lv lw lx ly b">Map</code>和<code class="fe lv lw lx ly b">Reduce</code>不是新的编程术语。它们是来自1956年发明的Lisp的操作符。</p><p id="8548" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从编程语言中的这些操作符开始，然后继续讨论分布式计算中的<code class="fe lv lw lx ly b">MapReduce</code>。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="019c" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在Python中映射和减少</h1><p id="85b1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这里有一条有趣的推文，展示了这些术语的含义:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2eaa432de0c9f327e065619ab610a3fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/0*0iA7B2G8kObQCu7a.png"/></div></figure><h2 id="5d36" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">地图</h2><p id="8a6b" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在函数式编程中，<code class="fe lv lw lx ly b">Map</code>将另一个函数应用于一个列表，将每个元素转换为另一个值，然后最终返回一个新的列表。我们可以对任何序列类型的数据结构使用<code class="fe lv lw lx ly b">map</code>，比如一个数组。</p><p id="7064" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想将列表中的每个元素乘以2。这可以用Python来完成:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="3330" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用输入运行它之后，我们将得到另一个列表:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="015b" class="ne mh it ly b gy nw nx l ny nz">lst = [1,2,3,4,5,6,7,8]<br/>print num2(lst)</span><span id="b3a6" class="ne mh it ly b gy oa nx l ny nz">=&gt; [2, 4, 6, 8, 10, 12, 14, 16]</span></pre><p id="d718" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python有针对这类任务的内置函数<code class="fe lv lw lx ly b">map</code>:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="0cc7" class="ne mh it ly b gy nw nx l ny nz">def num2(x):<br/>  return x * 2</span><span id="7887" class="ne mh it ly b gy oa nx l ny nz">print map(num2, lst)<br/>=&gt; [2, 4, 6, 8, 10, 12, 14, 16]</span></pre><h2 id="8c7f" class="ne mh it bd mi nf ng dn mm nh ni dp mq li nj nk ms lm nl nm mu lq nn no mw np bi translated">减少</h2><p id="7f74" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">类似地，<code class="fe lv lw lx ly b">reduce</code>对列表中的每两个元素应用一个函数，但是它返回一个聚合结果。在某些编程语言中被称为<code class="fe lv lw lx ly b">fold</code>。</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="5cd2" class="ne mh it ly b gy nw nx l ny nz">lst = [1,2,3,4,5,6,7,8]<br/>def sum2(x, y):<br/>    return x + y</span><span id="58ed" class="ne mh it ly b gy oa nx l ny nz">print reduce(sum2, lst, 0)<br/>=&gt; 36</span></pre><p id="dd01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以像这样从头实现它:</p><pre class="kj kk kl km gt ns ly nt nu aw nv bi"><span id="603c" class="ne mh it ly b gy nw nx l ny nz">def reduce(function, sequence, initial=None):<br/>    result = initial<br/>    for x in sequence:<br/>        result = function(result,x)<br/>    return result</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="5410" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">编程模型:MapReduce</h1><p id="b4e8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">当然，<code class="fe lv lw lx ly b">MapReduce</code>比上面两个函数要复杂得多，尽管它们有一些相同的核心思想。</p><p id="3e97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">MapReduce</code>是一个编程模型和框架，用于在分布式服务器中处理大数据集，并行运行各种任务。</p><p id="6b4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一项为解决大数据问题而发明的技术。如今，数据量如此之大，我们无法在一台服务器上解决它。</p><p id="1468" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">MapReduce</code>的整体思想是一种分割-应用-组合策略。我们将大数据集分成多个部分，在多个服务器上并行处理，然后将结果与服务器的所有输出相结合。</p><p id="3814" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们打个比方。我们有很多配料。经过切碎和重组的程序后，我们做了很多三明治:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/33ae7880a37ccd6f4f781409052e7d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gs5W4FTl1lcv3wvQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2来自<a class="ae ky" href="https://reberhardt.com/cs110" rel="noopener ugc nofollow" target="_blank"> Ryan Eberhardt </a>。</p></figure><p id="f85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，<code class="fe lv lw lx ly b">MapReduce</code>的用户会实现<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">reduce</code>功能，框架会在大型机器集群上调用它们。</p><p id="7516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在实际操作中，除了<code class="fe lv lw lx ly b">map</code>和<code class="fe lv lw lx ly b">reduce</code>之外，整个程序中还有其他一些加工阶段，包括<code class="fe lv lw lx ly b">split</code>、<code class="fe lv lw lx ly b">combine</code>、<code class="fe lv lw lx ly b">shuffle</code>、<code class="fe lv lw lx ly b">sort</code>等。</p><p id="fbda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想从一大段内容中统计每个单词的数量。我们将文件拆分成三个子文件，在每个服务器中完成字数统计任务，将单词作为混排的键，最后将来自同一个键的结果组合起来。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/628a7464c084fa943969d7ac9bb8a303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nF4NrqllCd1YJUYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3来自<a class="ae ky" href="https://dreamshutter.tistory.com/24" rel="noopener ugc nofollow" target="_blank">梦幻快门</a>。</p></figure><p id="86e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该框架还将支持冗余和容错，因为错误可能发生在任何服务器上。在Google最初的实现中，他们使用主-工人模式的架构。主节点将作业分配给工人并维护他们的状态。</p><p id="9cb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主服务器会定期pings每个工人。如果在一定时间内没有收到来自工作器的响应，则主设备将该工作器标记为失败。然后，它会为另一个健康的工人重新安排工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/4fcc7b5baa8f524a899179623cd1a68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iG3fSVJAsmS0VRBT.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4来自<a class="ae ky" href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf" rel="noopener ugc nofollow" target="_blank"> MapReduce 2004论文:大型集群上的简化数据处理</a>。</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="1c25" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">最后的想法</h1><p id="9696" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">近年来，谷歌已经转向其他一些提供流数据操作而不是批处理的技术，但仍有Hadoop等现有软件使用<code class="fe lv lw lx ly b">MapReduce</code>计算模型。</p><p id="1821" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">MapReduce</code>的主要贡献是一个简单而强大的接口，支持自动并行化和大规模计算的分布。</p><p id="a3bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拆分-应用-组合是分布式计算世界中的一个通用策略，而<code class="fe lv lw lx ly b">MapReduce</code>是一个很好的例子，它证实了以下概念:技术来来去去，但原则往往保持不变。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="653a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">参考</h1><ul class=""><li id="e235" class="oe of it lb b lc my lf mz li og lm oh lq oi lu oj ok ol om bi translated"><a class="ae ky" href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf" rel="noopener ugc nofollow" target="_blank">纸张:MapReduce </a></li><li id="ac17" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/MapReduce" rel="noopener ugc nofollow" target="_blank">MapReduce的维基百科</a></li><li id="62a6" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated"><a class="ae ky" href="https://reberhardt.com/cs110/summer-2018/lecture-notes/lecture-14/" rel="noopener ugc nofollow" target="_blank"> MapReduce:构建搜索引擎索引</a></li></ul></div></div>    
</body>
</html>