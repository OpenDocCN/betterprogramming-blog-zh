<html>
<head>
<title>Implement Your Own Dependabot for Flutter From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始为Flutter实现你自己的依赖机器人</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/implement-your-own-dependabot-for-flutter-from-scratch-7f22b780ff68?source=collection_archive---------16-----------------------#2020-03-02">https://betterprogramming.pub/implement-your-own-dependabot-for-flutter-from-scratch-7f22b780ff68?source=collection_archive---------16-----------------------#2020-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="61b6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">跳过等待官方支持红灯，保持你的颤振依赖最新</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6e395a705987985da4925876de25f70b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yM7a6wnhcBcC-mcsFNh81g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/更新-飘动-包裹</a>的横幅。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="cff7" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">自动化的依赖性升级在2020年是必须的</h1><p id="8cb8" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">2020年，web、移动和机器学习开发已经变得难以置信地模块化，这意味着大多数项目依赖于大量的包。</p><p id="dcae" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">尽管模块化提供了可重用性，但是维护最新的依赖关系可能是乏味的。</p><p id="2739" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">为了减少管理依赖项所浪费的时间，引入了<a class="ae ky" href="https://dependabot.com/" rel="noopener ugc nofollow" target="_blank">dependent bot</a>(一个自动化依赖项升级的实用程序)。更多关于Dependabot的细节请看<a class="ae ky" href="https://medium.com/better-programming/auto-magic-dependency-management-for-monorepo-projects-using-dependabot-f5796f4d6c28" rel="noopener">我的上一篇</a>。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="89e3" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">Dependabot非常优秀，但在支持新工具方面可能会比较慢</h1><p id="d36f" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">作为一款千人使用的产品，Dependabot在构建新功能时要考虑很多边角情况，所以在支持新语言/框架方面会相对较慢。</p><p id="95ee" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">因此，根据<a class="ae ky" href="https://github.com/dependabot/feedback/issues/430" rel="noopener ugc nofollow" target="_blank">本期</a>(已闲置一段时间)仍然不支持Dart/Flutter。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="2424" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">GitHub Action提供了构建依赖型机器人的所有构件</h1><p id="8964" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">如果有一个你想要但不存在的工具，那么我们应该创造它。</p><p id="df80" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">幸运的是，作为一个自动化平台，GitHub Action提供了我们构建Dependabot所需的所有构件。</p><p id="5c81" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">让我们一起一步一步地建立一个可靠的机器人。</p><p id="7aff" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">注意:我借用了我的副业项目Flutter Package Updater(Flutter的Dependabot替代方案)的代码，它位于这个库:</p><div class="mz na gp gr nb nc"><a href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">天昊95/更新-扑-包</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">Dependabot是一个自动保持依赖关系最新的好方法，但是对Flutter的支持仍然处于…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><p id="4ee6" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">下面是GitHub Marketplace中的即插即用操作:</p><div class="mz na gp gr nb nc"><a href="https://github.com/marketplace/actions/flutter-package-updater" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">Flutter包更新程序- GitHub市场</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">GitHub Action Dependabot是自动保持依赖关系最新的好方法，但是对Flutter的支持是…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nr l nn no np nl nq ks nc"/></div></div></a></div><p id="d7c7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">要了解它在真实的Flutter项目中是如何工作的，请查看<a class="ae ky" href="https://medium.com/i-want-5" rel="noopener"> 5%应用</a>库:</p><div class="mz na gp gr nb nc"><a href="https://github.com/tianhaoz95/iwfp" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">天昊95/iwfp</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">5% App是一个帮助信用卡用户跨多张信用卡最大化返现奖励的实用程序。快速浏览一下…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="ns l nn no np nl nq ks nc"/></div></div></a></div></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="930a" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤1:初始化JS GitHub动作</h1><p id="6ba0" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">每个GitHub动作都需要一个<code class="fe nt nu nv nw b">action.yml</code>供GitHub识别:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/69f8e3c2d5faccd7326d1d36bef391e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIg3w6pyy40NmQFq-3r-gg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure><p id="206d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在<code class="fe nt nu nv nw b">action.yml</code>中，我们需要定义我们需要从用户那里得到的信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/fdcf146ad9d84f927b891b84b5643d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kkjNDQUxrdzX-0Kjs7m60w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure><p id="e942" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">以下是重要信息:</p><ul class=""><li id="e3e4" class="ny nz it ma b mb mu me mv mh oa ml ob mp oc mt od oe of og bi translated">GitHub凭证，用于提交更改并打开pull请求。</li><li id="ab46" class="ny nz it ma b mb oh me oi mh oj ml ok mp ol mt od oe of og bi translated">分支的首选名称和拉请求标题/内容。</li></ul></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="882f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤2:从动作输入中检索所需的值</h1><p id="ef39" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">GitHub Action toolkit提供了一个实用函数来以编程方式检索用户定义的值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/640bd5c8ae9f2818c9e74ff560fdad99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aKIbC9f7RgqnmONCzCqbCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="5868" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤3:实现软件包升级</h1><p id="0b5b" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">GitHub Action toolkit还提供了一种轻松执行bash命令的方法:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d107d04e41f84cf5d393f34603bc4c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJYshDOWj_pYnnQE50UCYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure><p id="7614" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如上所示，这里我们首先运行<code class="fe nt nu nv nw b">git branch -b $target_branch</code>来创建一个新的分支，在这里我们升级<code class="fe nt nu nv nw b">pubspec.yml</code>文件。然后我们执行<code class="fe nt nu nv nw b">flutter pub upgrade</code>来升级<code class="fe nt nu nv nw b">pubspec.yml</code>中的包。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="f527" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤4:提交升级的包并推送更新</h1><p id="0429" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">有了<code class="fe nt nu nv nw b">pubspec.yml</code>中保存的升级，我们需要将更改提交到我们的目标分支:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/67771139440f24b3d4a81aca6ef9e4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPG4-zBoq70FIPA5MpLW9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="5f16" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤5:向主分支机构发出一个拉请求</h1><p id="36a3" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">最后，随着变更的提交和推送，我们需要打开一个pull请求来通知所有者。为此，我们可以使用GitHub API库<a class="ae ky" href="https://octokit.github.io/rest.js/v17" rel="noopener ugc nofollow" target="_blank"> Octokit </a>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/03a3e4fb0452a11ac6d7ad18b48e74fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mv8CDwX-p6T-JyBFxmqLag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:来自<a class="ae ky" href="https://github.com/tianhaoz95/update-flutter-packages" rel="noopener ugc nofollow" target="_blank">天昊95/update-flutter-packages </a>的代码片段。</p></figure><p id="d52e" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">完成后，每次有新的软件包发布时，都会出现这样的拉请求:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/e9d495e94b1240d29ed475434d29c23e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ElIxpbpw7CMmNY_Tnrk3w.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/3eec0b74756e96a69fa53f18dc3c0555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZqeIXliWG4s07T6CZbNsbA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/178863bc9ecc13106137f2b5800cf74b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLO9-VZbrj8L_8xEvX1TZw.png"/></div></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="896f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">结论</h1><p id="a1b7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">有了Flutter的Dependabot，您可以节省依赖管理的时间，并构建新的特性。</p></div></div>    
</body>
</html>