<html>
<head>
<title>How to Use Async / Await in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Go中使用异步/等待</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-async-await-in-go-b595f950aa6?source=collection_archive---------1-----------------------#2021-10-23">https://betterprogramming.pub/how-to-use-async-await-in-go-b595f950aa6?source=collection_archive---------1-----------------------#2021-10-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="848e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有了渠道，就简单了！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/24a2c5537aaa6fa68307ed471c5afdcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kmujP8KHFQtJLndO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">昆汀·德格拉夫在<a class="ae ky" href="https://images.unsplash.com/photo-1507823690283-48b0929e727b?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1170&amp;q=80" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你使用多种语言，其中一种是Go，你可能会想是否有一种Go等同于其他语言中一直流行的<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>。</p><p id="d89d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果你最近用JavaScript、Python或另一种现代语言编程，你可能已经见过用于编写非阻塞函数的<code class="fe lv lw lx ly b">async</code>和<code class="fe lv lw lx ly b">await</code>。</p><p id="430b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个JavaScript的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="45ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中，模式非常相似:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="0023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这太棒了。它使程序员能够编写并发的<strong class="lb iu"> </strong>代码<em class="mb">，而</em>不必使用回调函数、特殊框架或并行性。这是对比<strong class="lb iu">并发性</strong>(可以同时在多个地方运行的代码)和<strong class="lb iu">并行性</strong>(一次运行多个自身副本的代码)的最佳方式。并行是实现并发的一种方式。不是不好，只是复杂。我们可以通过多线程或多处理来实现。</p><p id="9792" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">旁注:并发性与并行性一直出现在面试问题中。知道这两个概念之间的区别，并且能够举出一个具体的例子来展示你的知识，这是一个很好的想法。</p><p id="f927" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举例来说，想象一个脚本调用<code class="fe lv lw lx ly b">my_asynchronous_function </code>(来自上面的例子)一次，然后退出。如果您需要这样做100次，但是想要节省时间，您可以并行运行这个脚本100次。想想看，这就是平行。但是，由于这是一个异步函数，您可以从同一个脚本中调用该函数100次，这些函数调用可以在等待网络上的API响应的同时进行计算。相比之下，这就是并发性。</p><p id="b017" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>对于并发编程如此有用，那么为什么它没有出现在Go的语言规范中呢？毕竟，Go是一种非常并发友好的语言。</p><p id="0e70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案在于Go语言的一个更加实用的特性:通道。</p><p id="742e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通道就像在并发代码中进行通信的共享信息管道。可以跨多个goroutines以最小的开销读取或写入通道。等待一个值出现在通道上类似于JavaScript中的承诺或Python中的协程。如果你还没看的话，看看<a class="ae ky" href="https://tour.golang.org/concurrency/2" rel="noopener ugc nofollow" target="_blank">官方的解释吧。通过通道，Go可以模仿<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>模式，同样简单，如下所示:</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="5c12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，本例中的大部分复杂性都存在，因为Go是一种系统编程语言，所以我们必须手工关闭和读取请求。然而，并发性是用<code class="fe lv lw lx ly b">go</code> / <code class="fe lv lw lx ly b">&lt;-</code>简洁地实现的。这是相当于<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>的围棋。</p><p id="6287" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你曾希望在Go中使用<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>模式，只需遵循以下步骤，就能获得清晰、等效的结果:</p><ol class=""><li id="5ca4" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">创建一个通道来接收来自“异步”函数的响应</li><li id="1e87" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">使用<code class="fe lv lw lx ly b">go</code>关键字作为goroutine运行您的“async”函数</li><li id="95ba" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">使用<code class="fe lv lw lx ly b">&lt;-</code>从您的渠道“等待”结果</li></ol><p id="bda1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">来自Python和JavaScript背景，我发现这个翻译非常有帮助，因为我经常用<code class="fe lv lw lx ly b">async</code>和<code class="fe lv lw lx ly b">await</code>来思考。有趣的是，它有时也反过来起作用。当我阅读Go代码时，有时我会想到<code class="fe lv lw lx ly b">go</code>就像我会想到<code class="fe lv lw lx ly b">async</code>一样，想到<code class="fe lv lw lx ly b">&lt;-</code>就像我会想到<code class="fe lv lw lx ly b">await</code>一样。</p><p id="d22c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并不完美，因为<code class="fe lv lw lx ly b">go</code>和<code class="fe lv lw lx ly b">&lt;-</code>并不像<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>那样紧密合作。在Go中可以有一个而没有另一个，goroutines和channels有很多其他的用途，不像上面简单的一个。不过，我希望这是一个有用的技巧，可以帮助您思考Go中的并发模式，或者至少更好地理解其他人可能是如何做的。</p><p id="7834" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">毕竟，现代程序员必须利用多种语言的专业知识，将一种语言的惯用模式翻译成另一种语言的常见结构。希望我已经帮助说明了<code class="fe lv lw lx ly b">async</code> / <code class="fe lv lw lx ly b">await</code>不仅仅是一种语言结构，而是一种精神工具，即使在没有这些关键字的语言中也可以利用。</p><p id="fd04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一如既往，<strong class="lb iu">勇往直前，勇往直前！</strong></p></div></div>    
</body>
</html>