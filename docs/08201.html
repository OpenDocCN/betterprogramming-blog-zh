<html>
<head>
<title>Observing Keyboard Changes in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">观察SwiftUI中的键盘变化</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/observing-keyboard-changes-in-swiftui-96dd06a2b952?source=collection_archive---------7-----------------------#2021-04-06">https://betterprogramming.pub/observing-keyboard-changes-in-swiftui-96dd06a2b952?source=collection_archive---------7-----------------------#2021-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3b4b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Combine的ObservableObject根据键盘的状态调整UI</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e54bb70bb038da6e005bc446641e47c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XFT_wOHVZk1WkTCh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@mylifeasaryan_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">雅利安·迪曼</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1886" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将学习如何在SwiftUI中观察键盘，以及如何相应地调整我们的UI。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5f34" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们开始吧</h1><p id="fe11" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">考虑一个简单的用户注册屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/efc2295e99e3b8dcab1b9761f265da87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqyzoOlARqpjdYqIJFsbQA.png"/></div></div></figure><p id="aacc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="694a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们有一个主<code class="fe nc nd ne nf b">VStack</code>，它包含一个<code class="fe nc nd ne nf b">Button</code>和另一个由三个<code class="fe nc nd ne nf b">TextField</code>组成的<code class="fe nc nd ne nf b">VStack</code></p><p id="a60e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们点击一个<code class="fe nc nd ne nf b">TextField</code>时，我们看到键盘与我们的用户界面部分重叠(在iPhone X上):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/68ec86af40cb821c2f0f7fbb8079a0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3G62L6dBttjDYvG_bdobA.png"/></div></div></figure><p id="f662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要观察键盘，并在它出现时调整我们的UI。让我们创建一个负责键盘观察的组件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fb47" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">键盘管理器</h1><p id="3bad" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">从一个符合<code class="fe nc nd ne nf b"><a class="ae ky" href="https://medium.com/cleansoftware/what-is-the-observableobject-protocol-in-swifts-combine-b6ad3102ccd4" rel="noopener">ObservableObject</a></code>协议的<code class="fe nc nd ne nf b">KeyboardManager</code>类开始，它包含两个<code class="fe nc nd ne nf b">Published</code>属性和一个<code class="fe nc nd ne nf b">Cancellable</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8515" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们将实际的观察逻辑添加到初始化器中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="9f41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如我们所见，我们获得了<code class="fe nc nd ne nf b">keyboardWillShow</code>通知的发布者。然后我们获得键盘的框架，并设置我们的<code class="fe nc nd ne nf b">keyboardHeight</code>和<code class="fe nc nd ne nf b">isVisible</code>属性。</p><p id="7d52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了，让我们把<code class="fe nc nd ne nf b">KeyboardManager</code>放到<code class="fe nc nd ne nf b">RegisterView</code>里面工作吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d6bb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">注册视图</h1><p id="5d32" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们更新<code class="fe nc nd ne nf b">RegisterView.swift</code>文件如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="a54e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将一个<code class="fe nc nd ne nf b">KeyboardManager</code>初始化为一个<code class="fe nc nd ne nf b">ObservedObject</code>属性。然后，我们给主<code class="fe nc nd ne nf b">VStack</code>添加了<code class="fe nc nd ne nf b">.padding</code>和<code class="fe nc nd ne nf b">.edgesIgnoringSafeArea</code>修改器。</p><p id="67d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要修改符<code class="fe nc nd ne nf b">.edgesIgnoringSafeArea</code>是因为我们需要考虑有安全区域的设备，比如iPhone X。</p><p id="1ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果正是我们想要实现的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/caf9edbc38ba22e82f557e5296d37db5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/1*KY8f0-_97EOqIvN-MyXP8w.gif"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="ae01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>