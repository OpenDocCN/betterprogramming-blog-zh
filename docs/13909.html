<html>
<head>
<title>How To Find All Fully Visible Cells in Table and Collection View</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在表格和集合视图中找到所有完全可见的单元格</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-find-all-fully-visible-cells-in-table-and-collection-view-d53ebdbb3c20?source=collection_archive---------6-----------------------#2022-10-12">https://betterprogramming.pub/how-to-find-all-fully-visible-cells-in-table-and-collection-view-d53ebdbb3c20?source=collection_archive---------6-----------------------#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0090" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不… <code class="fe ki kj kk kl b">indexPathsForVisibleRows</code>不是解决办法</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/a96e9983719ed7f465e1a28f273bba6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZ26OZTs9ZOsqrT26CnrIw.jpeg"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="3771" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">假设您有一项任务，要找出哪些表格视图单元格当前在屏幕上完全可见。所以你启动Xcode，访问<code class="fe ki kj kk kl b">UITableView</code>的<code class="fe ki kj kk kl b">indexPathsForVisibleRows</code>,并期望它能完成工作。</p><p id="d13f" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">很快，你会发现有些事情不对劲。你得到的结果有点偏差。屏幕上部分可见的单元格也会包含在结果中，这不是您想要的。你应该怎么做呢？</p><p id="b253" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">解决方案其实很简单:你需要做的就是跳出框框思考。让我告诉你怎么做。</p><h1 id="c6b8" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">获取UITableView的索引路径</h1><p id="7b3d" class="pw-post-body-paragraph lc ld it le b lf mq ju lh li mr jx lk ll ms ln lo lp mt lr ls lt mu lv lw lx im bi translated">为了找到所有完全可见单元格的索引路径，我们必须首先有一种方法来确定一个单元格是否基于其索引路径完全可见。</p><p id="c534" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">那么“细胞完全可见”的另一种说法是什么呢？</p><p id="cbab" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">其内容视图与表格视图完全相交的单元格被视为完全可见的单元格。</p><p id="bb94" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">考虑到这一点，我们将上述语句翻译成如下代码:</p><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="e76a" class="mz lz it kl b gy na nb l nc nd">let cellFrame = tableView.rectForRow(at: indexPath)<br/>let isCellFullyVisible = tableView.bounds.contains(cellFrame)</span></pre><p id="8312" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">一旦我们能够根据单元格的索引路径确定单元格是否完全可见，获取所有完全可见单元格的索引路径就变得相当简单了。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="f7e9" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">表视图到此为止！接下来，集合视图！</p><h1 id="060b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">获取UICollectionView的索引路径</h1><p id="0bc9" class="pw-post-body-paragraph lc ld it le b lf mq ju lh li mr jx lk ll ms ln lo lp mt lr ls lt mu lv lw lx im bi translated">就集合视图而言，一般的方法基本上是相同的。然而，集合视图的工作方式与表格视图略有不同，我们不能直接获得集合视图单元格的框架。我们必须通过布局属性访问单元格的框架，如下所示:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="4b90" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">过滤部分与表格视图基本相同，只是要确保使用<code class="fe ki kj kk kl b">indexPathsForVisibleItems</code>而不是<code class="fe ki kj kk kl b">indexPathsForVisibleRows</code>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h1 id="a987" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">更进一步</h1><p id="6ba6" class="pw-post-body-paragraph lc ld it le b lf mq ju lh li mr jx lk ll ms ln lo lp mt lr ls lt mu lv lw lx im bi translated">作为优秀的开发人员，我们应该始终致力于编写干净且可重用的代码。因此，让我们编写我刚才向您展示的代码，它是表视图和集合视图功能的扩展。它看起来是这样的:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cbbb" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">有了这些，获取所有完全可见单元格的索引路径就变得简单了，就像:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="40a9" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">很干净，不是吗？</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><pre class="kn ko kp kq gt mv kl mw mx aw my bi"><span id="318e" class="mz lz it kl b gy na nb l nc nd"><strong class="kl iu">Want to Connect?</strong></span><span id="24c3" class="mz lz it kl b gy nn nb l nc nd">You can also follow me on <a class="ae no" href="https://twitter.com/Lee_Kah_Seng" rel="noopener ugc nofollow" target="_blank">Twitter</a> so you won’t miss out any of my upcoming iOS development-related articles.</span></pre><p id="ccf0" class="pw-post-body-paragraph lc ld it le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">感谢阅读。👨🏻‍💻</p></div></div>    
</body>
</html>