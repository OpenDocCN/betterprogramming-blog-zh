<html>
<head>
<title>How to Write Log Files That Save You Hours of Time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何写日志文件来节省你的时间</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-write-log-files-that-save-you-hours-of-time-1ff0cd9ae2ed?source=collection_archive---------2-----------------------#2020-05-11">https://betterprogramming.pub/how-to-write-log-files-that-save-you-hours-of-time-1ff0cd9ae2ed?source=collection_archive---------2-----------------------#2020-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b93" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用更周到和描述性的错误进行更简单的调试</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c65c5fba72e686e1cab48891933b73f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iqdOil183vfy81IT"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@pietrozj?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pietro Jeng </a>拍摄的照片。</p></figure><p id="3b81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我需要在这里大声疾呼:我在工作中维护的程序有许多可爱的怪癖。<em class="lv">谓发生了错误</em>不在其列。这不仅仅是错误信息开始的方式。这也是它的结局。</p><p id="a7a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者“关于错误的信息存储在服务器日志中”，但是没有指示哪个服务器实际抛出了该异常？</p><p id="51ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章是关于如何写不糟糕的日志和错误信息。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a398" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">你真的需要这个吗？</h1><p id="ed0f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这篇文章的大部分是关于给<em class="lv">更多的</em>信息。但是就一会儿，让我们来看一些可以安全剪切的日志消息。为什么？好吧，当你不得不通读一英里长的日志文件时，你会感谢没有消耗你的理智和注意力的一切。</p><ul class=""><li id="1fb4" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">“一切都好”记录循环中每一次迭代的条目。只要我知道程序开始得很好，现在可能要进入那个循环，我真正关心的是错误。</li><li id="5fa6" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">当我不进行性能测试时，随机记录性能日志。</li><li id="b083" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">记录函数/计算的每一步。当您已经在记录“a+b=c”时，您实际上不需要记录“a”和“b”</li></ul><p id="d99e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我所说的，在大多数情况下，拥有比你需要的更多的信息要比太少的好，但仍然值得记住，以避免从另一端掉下来。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="e919" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">请告诉我错误是什么</h1><p id="948d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们在日常生活中处理的大多数异常都没有被显式处理，这意味着我们经常会得到一个堆栈回溯，它告诉我们到底发生了什么，在哪里，什么时候。那很好。这不是特别可读，但至少你可以追踪到源头。</p><p id="08cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果您要捕获一个异常，然后使用catch块将“Something not work yo”打印到控制台，甚至不将其打印到日志文件中，请不要这样做。如果你写了一个定制的异常处理程序，那么就花额外的时间来解释错误是什么。是不是一个错误的数据库条目，比如一个格式不正确的名字？很好，现在我不必克隆回购和调试，只需立即修复数据库中的条目即可。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="e37b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">请告诉我错误源自哪里</h1><p id="9dae" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这是我在修复bug时最大的痛点:我们每天都在监控错误消息，但是即使写得再好的错误消息也不会让我走得太远，因为我甚至不知道它来自哪里。只要写下这样的话:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c145" class="nt me it np b gy nu nv l nw nx">fatal error: invalid cast at serverIWouldLikeToSlaughter</span></pre><p id="1c52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我也开心多了。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="c505" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">给我一些额外的参数</h1><p id="21fa" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">坚持前面的例子，当你写错误消息的时候，你可能手头上有所有的信息，那么你为什么不把它给我呢？只需打印出客户ID、账单号、电子邮件地址，这些都是不能反序列化的。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a0a7" class="nt me it np b gy nu nv l nw nx">Fatal error: Invalid cast type Boolean to Integer numberOfSwearwords at serverIWouldLikeToSlaughter </span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="077a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">仅重载特定的异常</h1><p id="1118" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果您想为错误的数据类型或类似的东西抛出异常，您应该挂钩到<code class="fe ny nz oa np b">invalidCastException</code>或类似的东西——而不是“异常”这样，最常见的错误将会有一个很棒的错误消息，带有一个有声的名称和描述。但是当任何不寻常的事情发生时，您仍然记录完整的堆栈跟踪，它不会丢失。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ac20" class="nt me it np b gy nu nv l nw nx">Try{thisOrthat();}<br/>Catch castEx as InvalidCastException{<br/>  log.error("detailed description of erro");<br/>}<br/>Catch ex as Exception{<br/>  log.error(ex.stacktrace);<br/>}</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ec1a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">让我们看一些日志文件的例子，好吗？</h1><p id="1b3f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">以下是我认为有用的日志条目的一些随机选择的示例——可以更容易地理解错误源自哪里以及如何修复错误:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ab27" class="nt me it np b gy nu nv l nw nx"><em class="lv">-booting up server1 application4 <br/>-Connecting to otherServer at Port 1337…ok<br/>-Checking database Connection to databaseServer5 Error 400:Of course it doesn’t work, your credentials are outdated but not even the database admins have a clue what the new one are.<br/>-program shut down at 00:34 pm, 1234 files processed successfully, 23 unsuccessful, 45 skipped<br/>-Can't access file asdfadsfa.txt because the file is open in another process<br/>-error updating database table tb_xyz, maximum column length of 50 exceeded at column "name"<br/>-processing HTML text box failed, this is often caused by formatting issues on the database side. Check with database admins, the following value was retrieved from DB: &lt;a\"&gt;helloworld\"&lt;/a&gt;</em></span></pre><p id="2582" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与根本不记录或者以无效的方式记录相比，这些错误消息中的每一条都可以节省我半个小时查找特定bug的时间。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="40d8" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">外卖食品</h1><p id="4c63" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">你的一分钟可以为你节省几个小时。</p><p id="d642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你觉得这篇文章很有趣。这是一个看起来很小很迂腐的问题，直到你已经修复了几年的bug，并且看到了日志记录可能出错的所有方式。</p></div></div>    
</body>
</html>