<html>
<head>
<title>Three Ways To Publish Sphinx Documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发布Sphinx文档的三种方式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/three-ways-to-publish-sphinx-documentation-c276ffb22e5b?source=collection_archive---------11-----------------------#2022-09-21">https://betterprogramming.pub/three-ways-to-publish-sphinx-documentation-c276ffb22e5b?source=collection_archive---------11-----------------------#2022-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2d42" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与GitHub操作集成并自动发布</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2a329a01a085b5c8f8dbfc6e159cbffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99JYFpzMW6MkNojelwzYTg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将Sphinx文档发布到三个不同的平台。</p></figure><p id="4e0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在之前的<a class="ae lr" rel="noopener ugc nofollow" target="_blank" href="/quickly-generate-documentation-with-sphinx-cli-tools-99db0cb5994c">文章</a>中，我们讨论了如何使用Sphinx CLI工具快速生成文档。在本文中，我将展示发布Sphinx文档的三种不同方式。因此，任何拥有该URL的人都可以查看您的文档。</p><p id="cc14" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我还将发布过程集成到GitHub动作中，这样发布过程将完全自动化。</p><h1 id="79ce" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">发布到GitHub页面</h1><p id="2781" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">GitHub Pages是托管静态网站的好工具，例如Sphinx文档。我使用这个GitHub动作，<a class="ae lr" href="https://github.com/peaceiris/actions-gh-pages" rel="noopener ugc nofollow" target="_blank"> actions-gh-pages </a>，将我的文档部署到GitHub页面。</p><p id="9ba6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">用起来真的很简单。您只需要提供您的文档的路径，例如<code class="fe mp mq mr ms b">docs/build</code>，然后这个操作将帮助您处理剩下的步骤！</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="ad5c" class="mx lt iq ms b gy my mz l na nb">- name: Publish to GitHub Pages<br/>  uses: peaceiris/actions-gh-pages@v3<br/>  with:<br/>    github_token: ${{ secrets.GITHUB_TOKEN }}<br/>    publish_dir: docs/build</span></pre><p id="8cda" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完成后，您可以从<code class="fe mp mq mr ms b">https://&lt;username&gt;.github.io/&lt;repository_name&gt;/</code>查看发布的文档。</p><p id="4e9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很简单，对吧？让我们转到下一个平台。</p><h1 id="ed93" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">发布到GCP云存储</h1><p id="1cb9" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我推荐使用<a class="ae lr" href="https://github.com/google-github-actions/upload-cloud-storage" rel="noopener ugc nofollow" target="_blank">upload-cloud-storage</a>GitHub action将您的文档上传到GCS。使用此操作有三个步骤。首先，设置您的作业的权限，这样呼叫者就有权限访问GitHub机密。因为我也使用<a class="ae lr" href="https://github.com/stefanzweifel/git-auto-commit-action" rel="noopener ugc nofollow" target="_blank"> git-auto-commit-action </a>进行提交更改，所以<code class="fe mp mq mr ms b">contents</code>也应该设置为<code class="fe mp mq mr ms b">write</code>。</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="80ac" class="mx lt iq ms b gy my mz l na nb">permissions:<br/>  contents: ‘write’<br/>  id-token: ‘write’</span></pre><p id="8cfc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第二，用<a class="ae lr" href="https://github.com/google-github-actions/auth" rel="noopener ugc nofollow" target="_blank">Google-github-actions/auth</a>认证action，这样我们就可以上传文件到GCS。最后，指定文档的目录和目标bucket，例如<code class="fe mp mq mr ms b">my-sample-bucket-123</code>。</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="d7ee" class="mx lt iq ms b gy my mz l na nb">- name: Gcloud Auth<br/>  uses: ‘google-github-actions/auth@v0’<br/>  with:<br/>    credentials_json: ${{ secrets.GCP_CREDENTIALS }}<br/>- name: Upload documentation to GCS<br/>  uses: ‘google-github-actions/upload-cloud-storage@v0’<br/>  with:<br/>    path: ‘docs/build’<br/>    destination: ‘my-sample-bucket-123’</span></pre><p id="c7fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一步，我们需要公开<code class="fe mp mq mr ms b">my-sample-bucket-123</code>下的所有对象。因此，人们可以在互联网上阅读文档。你可以在这里找到步骤<a class="ae lr" href="https://cloud.google.com/storage/docs/hosting-static-website#sharing" rel="noopener ugc nofollow" target="_blank"/>。现在，您可以通过<code class="fe mp mq mr ms b">https://storage.googleapis.com/&lt;bucket-name&gt;/build/index.html</code>查看您的文档。</p><p id="e7f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是，GCS不支持自定义域。您可以在GCS前设置一个<a class="ae lr" href="https://cloud.google.com/storage/docs/hosting-static-website#lb-ssl" rel="noopener ugc nofollow" target="_blank">负载平衡器</a>。但这已经超出了本文的讨论范围，所以这里就不讨论了。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="fa8f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是完整的工作流程。每当生成文档时，该工作流会自动将我们的文档发布到GitHub页面和GCS。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h1 id="7f51" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">发布到ReadTheDocs</h1><p id="86e7" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">与其他两种方式不同，在您按照<a class="ae lr" href="https://sphinx-rtd-tutorial.readthedocs.io/en/latest/read-the-docs.html" rel="noopener ugc nofollow" target="_blank">的指令</a>将项目导入到<a class="ae lr" href="https://readthedocs.org/" rel="noopener ugc nofollow" target="_blank"> readthedocs </a>之后，它会自动构建文档并在您更改存储库时触发构建。</p><p id="cf05" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">导入项目后，需要进入<code class="fe mp mq mr ms b">Admin</code> &gt; <code class="fe mp mq mr ms b">Advanced Settings</code>，在<code class="fe mp mq mr ms b">Default settings</code>下，指定需求文件的路径和<code class="fe mp mq mr ms b">conf.py</code>的路径，这样就可以正确的构建文档了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl nl"><img src="../Images/e6db75eb312ac13cca3411107be4b0f1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*sflP0hq2As2NS0bs7PfUeA.png"/></div></figure><p id="3c8b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当您在<code class="fe mp mq mr ms b">Builds</code>选项卡下看到<code class="fe mp mq mr ms b">Passed</code>时，意味着文档已经成功构建！点击<code class="fe mp mq mr ms b">View Docs</code>查看文档。公共URL应该是<code class="fe mp mq mr ms b">https://&lt;project-name&gt;.readthedocs.io</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl nl"><img src="../Images/8646541f6e5f9827775aa97f625d0818.png" data-original-src="https://miro.medium.com/v2/format:webp/1*wbhB5P16pgJ1rp77vPVdUA.png"/></div></figure><h1 id="3b0e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="daf0" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在上一篇文章中，我们构建了一个脚本来生成好看的文档，并将其与GitHub操作集成在一起。在本文中，我们演示了三种自动发布文档的方法。因此，现在我们有了生成和托管文档的完整管道！我希望这两篇文章对构建您的文档管道有所帮助。</p><p id="2e7e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以在这个<a class="ae lr" href="https://github.com/Shawnice/sphinx-example" rel="noopener ugc nofollow" target="_blank">资源库</a>中找到完整的示例。</p></div></div>    
</body>
</html>