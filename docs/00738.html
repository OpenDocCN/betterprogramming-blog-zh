<html>
<head>
<title>How to Make a Cross-Platform Image Classifying App With Flutter and Fastai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Flutter和Fastai做一个跨平台的图片分类App</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-make-a-cross-platform-image-classifying-app-with-flutter-and-fastai-2a6af6701535?source=collection_archive---------5-----------------------#2019-07-08">https://betterprogramming.pub/how-to-make-a-cross-platform-image-classifying-app-with-flutter-and-fastai-2a6af6701535?source=collection_archive---------5-----------------------#2019-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e02b7706416738737f9e6a3808b9c956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNNHtFJLI41fzaiG_InclA.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">我的工作站，而建立这个应用程序。</p></figure><p id="6e96" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在本文中，我将解释如何使用API来构建跨平台的移动应用程序，该应用程序使用神经网络对图像进行分类。我将使用我在以前的一篇文章中构建的模型，但本教程将适用于任何单标签图像分类模型。</p><div class="ld le gp gr lf lg"><a href="https://medium.com/better-programming/how-i-used-a-convolutional-neural-network-to-classify-cricket-shots-d44197e79aff" rel="noopener follow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd iu gy z fp ll fr fs lm fu fw is bi translated">我如何使用卷积神经网络对板球击球进行分类</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">我最近深入研究了深度学习的世界，更具体地说，是图像分类。完成后…</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">medium.com</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu jz lg"/></div></div></a></div><p id="6939" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个应用程序有两个组件:一个是我们创建的API，它也将作为一个web应用程序，另一个是Flutter移动应用程序本身。所以我们开门见山吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="96e6" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">准备构建Web应用程序</h1><ul class=""><li id="0b6a" class="na nb it kh b ki nc km nd kq ne ku nf ky ng lc nh ni nj nk bi translated"><a class="ae nl" href="https://github.com/render-examples/fastai-v3" rel="noopener ugc nofollow" target="_blank">我们将使用这个GitHub存储库，所以请将它转到您的GitHub帐户。</a></li><li id="f3a2" class="na nb it kh b ki nm km nn kq no ku np ky nq lc nh ni nj nk bi translated">上传你的模型的pickle文件(。pkl)到Google Drive并复制该文件的共享链接。</li><li id="7e7f" class="na nb it kh b ki nm km nn kq no ku np ky nq lc nh ni nj nk bi translated"><a class="ae nl" href="https://www.wonderplugin.com/online-tools/google-drive-direct-link-generator/" rel="noopener ugc nofollow" target="_blank">转到该网站将共享链接转换为下载链接。将下载链接保存在安全的地方；我们很快就会需要它。</a></li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5e1f" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">构建Web应用程序</h1><p id="23be" class="pw-post-body-paragraph kf kg it kh b ki nc kk kl km nd ko kp kq nr ks kt ku ns kw kx ky nt la lb lc im bi translated">在构建web应用程序时，我们将主要关注存储库中已经分叉的<code class="fe nu nv nw nx b">server.py</code>文件。</p><p id="bf58" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">server.py代码是应用程序的核心。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="8874" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们关注的行如下:</p><pre class="ny nz oa ob gt oe nx of og aw oh bi"><span id="144c" class="oi md it nx b gy oj ok l ol om">export_file_url = 'DOWNLOAD_URL'#Download_url for the .pkl file<br/>export_file_name = 'export.pkl'<br/>classes = ['sweep', 'coverdrive', 'straightdrive', 'helicopter', 'scoop', 'pull']</span></pre><p id="f742" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在显示DOWNLOAD_URL的地方，只需粘贴export.pkl文件的下载URL，并用您自己模型的标签替换这些类。该应用程序现在可以部署了！</p><p id="c692" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是，还是有一些整容的东西需要改变。在<code class="fe nu nv nw nx b">view</code>文件夹中，编辑<code class="fe nu nv nw nx b">index.html</code>文件来代表你的模型和你的模型是做什么的，大概不是泰迪熊的分类吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b0ce" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">代码中的其他内容是什么？</h1><p id="81ba" class="pw-post-body-paragraph kf kg it kh b ki nc kk kl km nd ko kp kq nr ks kt ku ns kw kx ky nt la lb lc im bi translated">既然我们已经确保了应用程序可以运行，那么在告诉您如何部署它之前，我将带您了解代码的实际含义。我们已经介绍了export_file和classes代码，这些导入是不言自明的。我们将从检查以下代码块开始:</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="bfc4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">虽然这看起来需要消化很多东西，但是它做的事情非常简单。首先，它初始化应用程序，然后挂载静态文件夹以获取web应用程序的所有CSS和Javascript，最后，它定义了两个函数。这两个功能对于整个web应用程序来说都非常重要。第一个，<code class="fe nu nv nw nx b">download_file,</code>将用于下载您的机器学习模型，而第二个，<code class="fe nu nv nw nx b">setup_learner,</code>将设置您创建的机器学习模型。</p><p id="ee8b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">继续下一个代码块:</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="8a5f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">该代码块定义了应用程序的两条<em class="on">路径</em>。一个是主页，它将<code class="fe nu nv nw nx b">index.html</code>文件作为HTML响应返回。下一条路线，<code class="fe nu nv nw nx b">/analyze,</code>非常重要，因为这是所有魔法发生的地方。它通过<code class="fe nu nv nw nx b">index.html</code>文件中的表单收集图像，将模型应用于图像，保存预测，最后将预测作为JSON响应返回。这将使我们在开发移动应用程序时变得更加容易。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fd4c" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">部署Web应用程序</h1><p id="f061" class="pw-post-body-paragraph kf kg it kh b ki nc kk kl km nd ko kp kq nr ks kt ku ns kw kx ky nt la lb lc im bi translated">现在，我们不能将我们创建的web应用程序作为API使用，除非我们部署它，所以让我们开始吧！</p><ol class=""><li id="e9b3" class="na nb it kh b ki kj km kn kq oo ku op ky oq lc or ni nj nk bi translated"><a class="ae nl" href="https://dashboard.render.com/" rel="noopener ugc nofollow" target="_blank">前往render.com</a>并使用您的GitHub帐户登录。</li><li id="7f95" class="na nb it kh b ki nm km nn kq no ku np ky nq lc or ni nj nk bi translated">创建一个新的web服务，并使用我们在本教程中一直使用的存储库。</li><li id="e7c5" class="na nb it kh b ki nm km nn kq no ku np ky nq lc or ni nj nk bi translated">选择Docker作为环境，并命名您的服务。</li><li id="9e68" class="na nb it kh b ki nm km nn kq no ku np ky nq lc or ni nj nk bi translated">单击保存web服务。</li></ol><p id="cd22" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">耶！我们已经完成了部署—非常简单，对吗？现在，当您等待Render启动并运行您的web应用程序时，让我们开始处理移动应用程序。当然，如果您不想构建移动应用程序，如果您想使用移动应用程序，您可以在这里停下来，然后再回来！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7222" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">准备构建Flutter应用程序</h1><h2 id="154c" class="oi md it bd me os ot dn mi ou ov dp mm kq ow ox mq ku oy oz mu ky pa pb my pc bi translated">你需要什么:</h2><ul class=""><li id="a97e" class="na nb it kh b ki nc km nd kq ne ku nf ky ng lc nh ni nj nk bi translated">安卓工作室</li><li id="ac6d" class="na nb it kh b ki nm km nn kq no ku np ky nq lc nh ni nj nk bi translated">颤振SDK</li><li id="4f62" class="na nb it kh b ki nm km nn kq no ku np ky nq lc nh ni nj nk bi translated">AVD管理器(安装在Android Studio旁边)</li></ul><p id="c73f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你还没有为flutter开发准备好Android Studio，请遵循本教程:</p><div class="ld le gp gr lf lg"><a href="https://flutter.dev/docs/get-started/editor?tab=androidstudio" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab fo"><div class="li ab lj cl cj lk"><h2 class="bd iu gy z fp ll fr fs lm fu fw is bi translated">设置编辑器</h2><div class="ln l"><h3 class="bd b gy z fp ll fr fs lm fu fw dk translated">您可以使用任何文本编辑器结合我们的命令行工具来构建Flutter应用程序。但是，我们建议使用…</h3></div><div class="lo l"><p class="bd b dl z fp ll fr fs lm fu fw dk translated">颤振. dev</p></div></div><div class="lp l"><div class="pd l lr ls lt lp lu jz lg"/></div></div></a></div><p id="1fa9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">好了，是时候开始了！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3fa0" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">设置相关性</h1><p id="bfba" class="pw-post-body-paragraph kf kg it kh b ki nc kk kl km nd ko kp kq nr ks kt ku ns kw kx ky nt la lb lc im bi translated">打开Android Studio<em class="on">开始新的Flutter项目。</em></p><figure class="ny nz oa ob gt ju gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/995bd5c4f31ef69854d224d7a6b77620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*1j7JJadhAgcb_H-m8jzJUA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">创建新的颤振项目</p></figure><p id="6de5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在打开<code class="fe nu nv nw nx b">pubspec.yaml</code>文件，编辑依赖部分，如下所示:</p><pre class="ny nz oa ob gt oe nx of og aw oh bi"><span id="3077" class="oi md it nx b gy oj ok l ol om"><strong class="nx iu">dependencies:<br/>  flutter:<br/>    sdk: </strong>flutter<br/>  <strong class="nx iu">image_picker:<br/>  http:</strong></span></pre><p id="4f06" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在打开终端并运行以下命令:</p><pre class="ny nz oa ob gt oe nx of og aw oh bi"><span id="9a0c" class="oi md it nx b gy oj ok l ol om">flutter pub get</span></pre><p id="96c6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这将确保安装所有必需的包，并且代码不会有任何导入错误。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="92a6" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">制作应用程序</h1><p id="c353" class="pw-post-body-paragraph kf kg it kh b ki nc kk kl km nd ko kp kq nr ks kt ku ns kw kx ky nt la lb lc im bi translated">要创建应用程序，我们需要编辑<code class="fe nu nv nw nx b">main.dart</code>文件。用以下代码替换<code class="fe nu nv nw nx b">main.dart</code>中的当前代码:</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="51e1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">将基本URL更改为您之前创建的渲染服务的URL，并根据需要自定义应用程序的其余部分。</p><p id="efea" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在您的android虚拟设备上运行上面的代码，它应该运行良好！</p><p id="c8b5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是代码在我屏幕上的样子；显然，您可能需要编辑文本来更好地表示您的模型:</p><figure class="ny nz oa ob gt ju gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/61936d8a34ebe5f3018b1622c820c315.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*I88_93Z3lFkbfeb_cx9w_w.png"/></div></figure><p id="624a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们完了！你刚刚建立了一个跨平台的移动应用程序，可以对图像进行分类！</p><p id="2f63" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你喜欢这篇文章，考虑注册我的时事通讯，每周日都能收到精彩内容:<a class="ae nl" href="https://mailchi.mp/35c069691d2c/newsletter-signup" rel="noopener ugc nofollow" target="_blank">https://mailchi.mp/35c069691d2c/newsletter-signup</a>。</p></div></div>    
</body>
</html>