<html>
<head>
<title>Working With Combine Publishers in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中使用联合发布者</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/working-with-combine-publishers-in-swiftui-cb85257807e3?source=collection_archive---------8-----------------------#2021-02-15">https://betterprogramming.pub/working-with-combine-publishers-in-swiftui-cb85257807e3?source=collection_archive---------8-----------------------#2021-02-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="643e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在SwiftUI中使用Just、Sequence、Record和Future</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e302efda559ab4d3be34cedf1c11afcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ODZ4cF_WsBHHUC4upX-dHQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者GIF。</p></figure><p id="d913" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">发行商是Combine框架的命脉，他们有十几个甚至更多。在本文中，我想通过使用一些主要的发行商来尝试改变“Hello World”问候语的背景色。</p><p id="2432" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我不认为这是完成任务的正确或最好的方法。这更像是理解这些出版商如何工作以及你如何让他们为你工作的一个练习。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="9c1d" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">序文</h1><p id="388e" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">使用发布者最困难的一个方面是，如果不小心，您可能会终止流——特别是使用SwiftUI作为端点。相反，无法终止它有时也同样具有挑战性。请继续读下去。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="655d" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">任务</h1><p id="e6ba" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我给自己设定了一个任务，改变经典的“Hello World”问候语的背景颜色。我想改变背景四次:在不超过12秒的短时间内，变成红色、蓝色、绿色，最后变成橙色。我用了四个不同的出版商。他们中的一些人比其他人更适合这项工作。我还发现自己在most中使用SwiftUI <code class="fe my mz na nb b">Subject</code>(第五元素和发布者)。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="0742" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">将来的</h1><p id="36ec" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><code class="fe my mz na nb b">future</code>发布器的基本语法如下所示。作为发布者，您实际上是在使用它预加载值。在口语中许下承诺。下面显示的代码延迟两秒钟将红色传递给发布者:</p><pre class="kj kk kl km gt nc nb nd ne aw nf bi"><span id="ce92" class="ng mc it nb b gy nh ni l nj nk">let future1 = Future&lt;Color, Never&gt; { promise1 in<br/>  DispatchQueue.main.asyncAfter(deadline: .now() + 2) {<br/>    promise1(.success(Color.red))<br/>  }<br/>}</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6509" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在四家出版商中，使用<code class="fe my mz na nb b">future</code>实现挑战是最困难的。真正的变化是，每次我重新加载视图时，<code class="fe my mz na nb b">future</code>都会重置自己，这就是为什么我在使用它之后引入了一个布尔值来屏蔽发布者。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="57d2" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">仅仅</h1><p id="925f" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><code class="fe my mz na nb b">just</code>发布者的基本语法如下所示。作为一个发布者，我遇到的主要问题是它会在完成时自行终止。这就是为什么我最终不得不创建另外四个(<code class="fe my mz na nb b">subject</code>)出版商。再加上<code class="fe my mz na nb b">future</code>，看起来真的不是解决这个挑战的好选择。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="4203" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">顺序</h1><p id="e734" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><code class="fe my mz na nb b">sequence</code>发布器的基本语法如下所示。作为发布者，您实际上又一次预加载了值——这次强调的是它们的顺序。与前两者斗争之后，就容易多了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6dc2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让它工作的主要变化是试图让它慢下来。我通过再次使用第二个发布者(<code class="fe my mz na nb b">subject</code>)解决了这个问题，我用一个计算好的延迟调用了一个<code class="fe my mz na nb b">DispatchQueue</code>。我确实试图直接拖延它，但没有成功。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="6281" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">记录</h1><p id="949b" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><code class="fe my mz na nb b">record</code>发布器的基本语法如下所示。与前面提到的两个发布者一样，您实际上预先加载了值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="158e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个解决方案是找到有效语法的最简单的方法。事实上，它看起来非常适合这个挑战，尽管使用<code class="fe my mz na nb b">sequence</code>效果也很好。</p><p id="9827" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望这篇文章对你的工作和我的工作一样有用。保持冷静，继续编码。</p></div></div>    
</body>
</html>