<html>
<head>
<title>How the Internet Works Under the Hood</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">互联网是如何在幕后运作的</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/internet-mechanics-c77f998e7853?source=collection_archive---------5-----------------------#2020-04-17">https://betterprogramming.pub/internet-mechanics-c77f998e7853?source=collection_archive---------5-----------------------#2020-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6602" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">互联网机制</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/9c44effcd078798821b00c2e51b46a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*WVSkQIpwgpzkiu5x"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">网络的网络图(来源:Kurose和Ross的<a class="ae kr" href="https://www.net.t-labs.tu-berlin.de/teaching/computer_networking/01.01.htm" rel="noopener ugc nofollow" target="_blank">计算机网络</a></p></figure><p id="7751" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">简而言之，互联网是子网的<em class="lo">网络</em>。这些子网通过路由器相互通信，我将在本文<strong class="ku ir">稍后解释这一点。</strong></p><p id="6780" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">网络</strong>:为了传输数据而连接的两个或多个设备。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/0f3e3494d7b3ee43b81df2446199ae72.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*x1ySyRu2QE66cGSo.jpg"/></div></figure><p id="71e1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">网络可以归结为两台互相交换数据的设备。当然，网络已经变得比这复杂得多。随着网络复杂性的增加，数据只需要发送到网络上的某些计算机，图中这样简单的配置不再实用。</p><p id="1ad7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例如，将四台设备直接连接到网络将导致以下配置:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/bc9c060c742879305c6f950b2e4079f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/0*dfqWoJOPRSiTiXQv.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">四台设备局域网:直接连接</p></figure><p id="d611" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">那还不算太糟。每个设备都直接连接到另一个设备，在中心形成交叉连接。每个设备都能够通过一个<em class="lo"> MAC地址</em>引用另一个设备。</p><p id="bd84" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> MAC地址</strong>:是<em class="lo">媒体访问控制地址</em>的首字母缩写——别名<em class="lo">物理地址</em>，是一个十六进制数字“烧入”到网络接口控制器(NIC)的六位地址。该地址没有等级之分，因此数字序列不能给出该设备与其它设备之间关系的信息。例如:30–65-EC-6F-C4–58。</p><p id="3da5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，随着我们向局域网添加更多的设备，这种系统变得不切实际:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/e6c2ae87ae8e8b60c28de133e0deffcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/0*iaays5f0L62kzbwY.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">六设备局域网:直接连接</p></figure><p id="a6eb" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">当只向网络中添加两台设备时，网络的复杂性会急剧增加。当您将它与一个8台设备的网络进行比较时，就很明显为什么需要一个新的策略了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/6f8196836ac47fb42a80ccef1d3a698b.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/0*Bpkuau4sgrUODhza.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">八台设备局域网:直接连接</p></figure><p id="c517" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这就是<em class="lo">中枢</em>发挥作用的地方。集线器作为网络的<em class="lo">节点</em>，在<em class="lo">数据包转发</em>中发挥着关键作用。</p><p id="882a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">包转发</strong>:通过节点将网段从一个网段中继到另一个网段</p><p id="d5ec" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">节点</strong>:重分发点或通信端点</p><p id="c7a0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> Hub </strong>:通过端口将多个以太网设备连接在一起的网络设备。当数据包到达某个端口时，该端口会将数据包转发到集线器的所有其它端口。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/d9c98040f498d997b24aa3bad04de2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/0*g_wtBmdS0VNEu13K.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">具有数据包转发功能的以集线器为中心的局域网</p></figure><p id="b831" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">集线器将数据包分发给连接到其端口的所有设备。<strong class="ku ir"> </strong>这意味着设备1，即发送网络数据包的设备(数据包的来源)，将数据包发送到集线器，每个设备都将接收数据包。当数据只针对单个特定设备时，这就产生了问题。<em class="lo">来源</em>和<em class="lo">目的地报头</em>就是这个问题的解决方案。</p><p id="e5d9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">源头:这是最初发送数据包的计算机的MAC地址。如果发送数据包的计算机的MAC地址为30–65-EC-6F-C4–58，则发送的数据包将包含30–65-EC-6F-C4–58的源报头。</p><p id="a8c9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">目的地报头</strong>:这是数据包要发送到的计算机的MAC地址。如果数据包需要发送到的计算机的MAC地址是00:1B:44:11:3A:B7，则数据包的目的报头是00:1B:44:11:3A:B7。</p><p id="2e84" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">发送数据包时，元数据以<strong class="ku ir">报头</strong>的形式附加。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/bb46922bb8bdccbd77e68bc2700a2519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/0*z7TRhIPxZVKkkonk.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">IP数据包报头(来源:<a class="ae kr" href="https://www.quora.com/What-is-ip-packet" rel="noopener ugc nofollow" target="_blank"> Quora </a>)</p></figure><p id="c839" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">暂时忽略额外的字段，注意数据包底部的源和目的地报头。这些是任何数据包都需要的组件。</p><p id="e02f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">请注意标题名称中的IP地址。我将在本文的稍后部分解释这种用法，但是现在，我使用MAC地址来演示本地区域和网络间通信环境中的MAC和IP地址功能。</p><p id="03e2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">当带有源/目的地报头的数据包被发送到集线器时，该数据包仍然由集线器分发给集线器端口上的所有设备。然而，每个设备将遵循一个<em class="lo">协议</em> <strong class="ku ir"> </strong>，告诉它如果目的地报头与设备地址不匹配，则忽略数据包。</p><p id="71ca" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">协议</strong>:管理数据传输的一组规则</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/02edc896f1f30d6e46fde97d230fc0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*LwzHx3fLyNHjmb62.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">带源/目的地接头的八设备局域网</p></figure><p id="61d9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">一个更优雅的解决方案从集线器发展而来:<em class="lo">交换机。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/3af0fc6c8854186bcf1291573e712e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:60/0*OCXd140cmNS593u9"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/3df1eb97e615f846103c3f4a4637ba1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/0*L5gqCFXK_KAaoOQp"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">局域网:用以太网电缆和交换机连接的计算机</p></figure><p id="ac02" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">交换机:</strong>一个<strong class="ku ir"> </strong>使用目的地址转发数据包的网络桥接设备。交换机将拥有连接到其端口的所有设备的MAC地址，并将给定的数据包转发到匹配目的地址的端口。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/023cd3dcd99db78476373aecfa6c2346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*otlbwuFk3ZiAyOUY.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">带交换机的八台设备局域网</p></figure><p id="eb47" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在此图中，交换机从设备1收到一个数据包。该分组包含目的地报头7。交换机将获取目的报头，并搜索地址为7的设备。当找到一个设备时，数据包将从对应于目的设备的端口发送出去。</p><p id="fc65" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在本例中，目的设备是7，因此数据包从连接到设备7的端口发出。网络上的其他设备不会收到数据包，它们所占用的网段也不会受到影响。</p><p id="0fba" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">到目前为止，我们已经了解了使用物理网络电缆连接的网络设备。由于使用网络电缆的限制，这些设备通常在地理上也很接近。网络电缆的使用和设备的近距离是局域网(LAN)的一个特征。</p><p id="25ca" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">互联网比这要大得多，在下面的章节中，我将描述用来创建现在的现代互联网的网络策略。</p><p id="bf38" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">家庭和办公室中的设备在局域网(LAN)内连接。这就是该网络中的设备相互连接和通信的方式。但是，这些设备如何与不同网络中的另一台设备通信呢？这是网络间通信，也是互联网最常见的功能。</p><p id="0d30" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了实现网络间通信，一个新的设备被添加到这个难题中:一个<em class="lo">路由器</em>。</p><p id="1f8d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">路由器</strong>:用于连接两个或多个网络的网络桥接设备</p><p id="2e62" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">路由器是一个网络与外部网络/设备通信的桥梁。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/3772996213b2c4607f896876eeb6fa15.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/0*IufkZyWN3YBzbNyc.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">带路由器的局域网</p></figure><p id="f56f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">本地网络设备现在可以向不同网络上的设备发送数据包。数据包被发送到交换机，交换机将数据转发到路由器，然后路由器将流量路由到另一台路由器。将数据包转发到互联网上的另一个路由器被认为是一个<em class="lo">网络跳</em>。</p><p id="42a4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">一个数据包要经过几跳才能沿着不同的互联网路由器到达目的地。</p><p id="9cf3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">网络中继段:</strong>一段数据在到达目的地的途中，从一个互联网节点到另一个互联网节点所需的时间。</p><p id="1f47" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">互联网非常繁忙，有时这些路由器会因试图通过它的大量数据而不堪重负。当路由器不堪重负时(当它的缓冲区<em class="lo"> </em>已满时)，它将丢弃它收到的所有传入数据包，直到缓冲区中的足够数据得到处理，为传入数据包腾出空间。</p><p id="afd9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">此外，数据包还包含另一个字段，即TTL(生存时间)。此字段指定数据包在被其中一个互联网路由器丢弃之前，允许在互联网上停留多长时间。每个网络跃点都将该值减1。如果TTL字段达到0，则认为数据包闲置时间过长，因此会被丢弃。</p><p id="94dd" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这让互联网变得极其不可靠。这就是为什么已经采用协议来说明这种不可靠的性质。</p><p id="ece0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><em class="lo"> TCP(传输控制协议)</em> <strong class="ku ir"> </strong>就是这样一种协议，大多数软件工程师选择的协议。</p><p id="925c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> (TCP)传输控制协议:</strong>面向连接的协议，为网络的周围环境提供各种服务，确保:</p><ul class=""><li id="52af" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated">数据包没有被复制</li><li id="73d4" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">所有数据包都已到达目的地</li><li id="4b04" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">这些包没有被篡改过</li><li id="1a8d" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">网络上没有太多网络无法处理的数据。(<em class="lo">拥堵回避)</em></li><li id="8226" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">发送者不会用太多的数据淹没接收者。(<em class="lo">流量控制</em>)</li><li id="42ff" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">数据包的顺序正确。</li></ul><p id="13a0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">面向连接:</strong>在交换数据之前，必须建立一个安全的连接。</p><p id="896b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">TCP使用<em class="lo">三次握手创建安全连接。</em></p><p id="fbe2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">三次握手:</strong>TCP用于建立安全客户端-服务器连接的三步<strong class="ku ir"> </strong>方法。交换具有标志SYN、SYN-ACK和ACK的数据分组)。此方法在任何数据交换发生之前执行。</p><p id="d3c6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">第一步。SYN:客户端向服务器发送一条消息，表示要开始消息交换。</p><p id="9354" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">第二步。SYN + ACK:服务器向客户端发送一条消息，表明它已经收到请求，准备接收数据。</p><p id="fe24" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">第三步。ACK:客户端发送一个数据包，表示它即将发送数据。已经建立了连接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/a635381a00b7f7329d4ed7e971d0ce08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/0*k1H6UELN507E9iNp.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">TCP握手的事件序列</p></figure><p id="686e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">由于TCP提供了许多具有移动部分的功能，它极大地增加了网络的<em class="lo">延迟</em>。</p><p id="67f8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">延迟</strong>:数据包从一个位置传输到另一个位置所需的时间。</p><p id="eb79" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">换句话说，TCP让事情变得更慢，为了安全牺牲了速度。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="0477" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">有些应用程序不需要TCP的所有功能，这会降低数据传输速率。这种应用的一个例子是苹果的FaceTime应用:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/e9628df78f69cfabb11a959b9330b76c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kXaPtEpJDvI2fW6v.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">苹果的FaceTime视频聊天应用</p></figure><p id="d453" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">特别是有了新的群组视频聊天功能，当客户需要通过互联网以实时视频流的形式快速发送数据时，视频流的视频中断中的一些小故障是可以接受的。</p><p id="2287" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这就是像<em class="lo"> UDP(用户数据报协议)</em>这样的协议发挥作用的地方。与TCP之类的协议相比，UDP去掉了许多功能。</p><p id="aa5a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> (UDP)用户数据报协议</strong>不保证:</p><ul class=""><li id="f1f3" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated">数据已经到达目的地</li><li id="47b0" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">数据是有序的</li><li id="4312" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">接收器不会被数据淹没</li><li id="21a3" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">网络不会被过多的数据淹没</li></ul><p id="9d61" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在UDP中，数据可能会被丢弃。</p><p id="4680" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">由于功能较少，UDP比TCP更快、更灵活。UDP是优先考虑快速传输不敏感数据的应用程序的首选协议。实施拥塞避免来防止高流量期间的大量数据丢失仍然被认为是最佳实践。</p><p id="980e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">一旦建立了协议，并且执行了TCP握手(如果适用),就可以进行数据交换了。</p><p id="a9d9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，在继续之前，重要的是要知道是什么启动了这种数据交换。</p><p id="b5a8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">客户端通常是一个web浏览器。在这个网络浏览器上，用户可以输入一个URL，浏览器将<em class="lo">解析</em>。</p><p id="00fc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">解析URL </strong>:将一个URL分成</p><ul class=""><li id="4e6a" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated">scheme:告诉客户端如何访问资源</li><li id="fffe" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">主机:指定资源(域名)的位置(服务器)</li><li id="d4bf" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">路径:资源在主机中的位置</li></ul><p id="b44c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在解析过程中，会遇到主机名。这是对互联网上某处服务器的引用。服务器通过IP地址来识别，但是大多数URL都有一个格式为<code class="fe nb nc nd ne b">www.apple.com</code>的主机名。</p><p id="68ee" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">有没有地址为<code class="fe nb nc nd ne b">www.apple.com</code>的服务器？不尽然——这就是<em class="lo"> DNS </em> <strong class="ku ir"> </strong> ( <em class="lo">域名系统</em>)进入竞争领域的地方。</p><p id="c01c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> (DNS)域名系统:</strong>用于将人类可读的域名翻译成IP地址的分层命名系统。DNS服务器将接受客户端发送给它的域名，并返回该服务器的IP地址。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nf"><img src="../Images/5e24786e331092557c1af0e26e31b278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yhaGCUbpEdocv-fA.png"/></div></div></figure><p id="e798" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">当从DNS服务器中检索到IP地址时，客户端会将IP地址和端口号结合起来，创建一个<em class="lo">套接字</em> <strong class="ku ir"> ( </strong> IP地址+端口号=套接字<strong class="ku ir"> ) </strong>。</p><p id="88fc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">套接字是一个逻辑通信端点，它使用IP地址和端口号的组合来声明数据的目的地。端口号定义了设备内要发送的数据的位置。与IP地址相比，IP地址定义了设备在网络中的位置。</p><p id="bb68" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> Socket: </strong>结合IP地址和端口号形成的应用程序的逻辑通信端点。例如:66.249.75.195:83</p><p id="2eb3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">端口:</strong>设备内待发送数据的逻辑端点。端口号与web浏览器和其他互联网通信web应用程序相关联。</p><p id="b2db" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然后<strong class="ku ir"> </strong>套接字被传递到<em class="lo">传输层</em> <strong class="ku ir">、</strong>，在那里它将经历数据封装。请注意，以下过程发生在网络设备中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/769e7acf7874fe548b3778a73e5ecaff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*RQm78h0iumJiIj_y.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">套接字从段-&gt;包-&gt;传输转换的过程</p></figure><p id="c311" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">回到TCP握手的完成，根据URL的方案，可能需要进行另一次交换。如果方案指定了<code class="fe nb nc nd ne b">https</code>协议，那么必须发生<em class="lo"> TLS握手</em> <strong class="ku ir"> </strong>。</p><p id="6fea" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> TLS握手:</strong>客户端和服务器的方法:</p><ul class=""><li id="3d5c" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated">就要使用的TLS版本达成一致</li><li id="d4a2" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">同意在<em class="lo">密码套件</em>中使用<em class="lo">密码</em></li><li id="047b" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">对称加密的交换密钥</li><li id="2df4" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">验证主机证书的有效性</li></ul><p id="e49c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">密码</strong>:执行加密和解密的一组步骤</p><p id="1248" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">密码套件</strong>:一组密码</p><p id="9b6c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">该方法执行以下步骤:</p><ul class=""><li id="2371" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated">第一步。<code class="fe nb nc nd ne b">ClientHello</code>:客户端指定其支持的TLS版本和密码套件，然后发送给服务器。</li><li id="df46" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">第二步。<code class="fe nb nc nd ne b">ServerHello</code>:服务器验证可以使用指定的TLS版本和密码套件。它提供它的证书和公钥，然后发送<code class="fe nb nc nd ne b">ServerHelloDone</code>。</li><li id="89ab" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated">第三步。密钥交换:客户端和服务器交换对称加密的密钥数据。</li></ul><p id="92da" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在TLS握手之后(如果URL方案是<code class="fe nb nc nd ne b">https</code>)，从浏览器发送一个HTTP请求:</p><pre class="kg kh ki kj gt nh ne ni nj aw nk bi"><span id="c83e" class="nl nm iq ne b gy nn no l np nq">GET /home HTTP/1.1<br/>Host: <a class="ae kr" href="http://www.amazon.com" rel="noopener ugc nofollow" target="_blank">www.amazon.com</a></span></pre><p id="3a16" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在上面的请求中，GET请求包含以下组件:</p><ul class=""><li id="ca24" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated"><strong class="ku ir">方法</strong> : GET(告诉服务器要执行什么动作)</li><li id="d643" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated"><strong class="ku ir">路径:</strong> /home(所需资源的位置)</li><li id="1f6f" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated"><strong class="ku ir">主机:</strong><a class="ae kr" href="http://www.amazon.com/" rel="noopener ugc nofollow" target="_blank">www.amazon.com</a>(表示应用服务器的位置)</li></ul><p id="a963" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">服务器在处理完HTTP请求后，将发送HTTP响应:</p><pre class="kg kh ki kj gt nh ne ni nj aw nk bi"><span id="857e" class="nl nm iq ne b gy nn no l np nq">HTTP/1.1 200 OK<br/>Connection: close</span></pre><p id="fce6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">该请求包含以下内容:</p><ul class=""><li id="369b" class="ma mb iq ku b kv kw ky kz lb mc lf md lj me ln mf mg mh mi bi translated"><strong class="ku ir">版本:</strong> HTTP/1.1</li><li id="e54c" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated"><strong class="ku ir">状态代码:</strong> 200(必需组件)</li><li id="0261" class="ma mb iq ku b kv mj ky mk lb ml lf mm lj mn ln mf mg mh mi bi translated"><strong class="ku ir">连接:</strong>显示连接的状态</li></ul><p id="7646" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">由于HTTP是一个无状态协议，连接将在响应后关闭。</p><p id="af8a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">无状态:</strong>请求/响应周期完全相互独立。每个周期与之前的请求/响应没有关联。</p><p id="5f28" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例如，当一个请求是针对一个网页时，响应通常会包含一个<em class="lo">正文</em> <strong class="ku ir">。</strong>正文包含浏览器可以用来显示网页的HTML代码。</p><p id="f2e3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">HTTP请求/响应中可以包含各种其他可选的头，但是我试图突出显示在处理HTTP请求/响应时最常见的头。</p></div></div>    
</body>
</html>