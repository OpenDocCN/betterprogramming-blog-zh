<html>
<head>
<title>Quitting WhatsApp? Build Your Own Messaging Android Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">退出WhatsApp？构建您自己的消息Android应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/quitting-whatsapp-build-your-own-messaging-android-application-d0b54483b9bd?source=collection_archive---------11-----------------------#2021-01-27">https://betterprogramming.pub/quitting-whatsapp-build-your-own-messaging-android-application-d0b54483b9bd?source=collection_archive---------11-----------------------#2021-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0b92" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用以隐私为中心的电报库来派生您自己的应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/451be471ce3847bf4e1c3f0e7130c6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5fQtKb4dEqvLxNwb"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯蒂安·威迪格在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8e3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着WhatsApp宣布其新的隐私政策，每个人都开始意识到自己的隐私。你可以切换到<a class="ae kv" href="https://telegram.org/" rel="noopener ugc nofollow" target="_blank">电报</a>或<a class="ae kv" href="https://signal.org/en/" rel="noopener ugc nofollow" target="_blank">信号</a>，但如果你执迷不悟，还有一个选择:创建自己的消息应用程序，并在朋友间使用。</p><p id="3f3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们不会从头开始编写任何东西，而是会派生出Telegram Android应用程序。[1]请记住，撰写本文是为了娱乐，而不是为了开发一个生产就绪的消息传递应用程序。让我们开始吧。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="ab05" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">分叉应用程序</h1><p id="4720" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Telegram是开源的，这意味着你可以在GitHub上找到它的源代码。我们将从Android 的分叉<a class="ae kv" href="https://github.com/DrKLO/Telegram" rel="noopener ugc nofollow" target="_blank">电报开始。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/b65c5c6cdcc819cb070af6088a0f530d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HqjrfDR3LqV5aHiB2mLlug.png"/></div></div></figure><p id="7b55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后克隆fork开始工作:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="2d28" class="nc ma iq my b gy nd ne l nf ng">git clone <a class="ae kv" href="https://github.com/DoguD/Telegram.git" rel="noopener ugc nofollow" target="_blank">https://github.com/YOUR_USERNAME/Telegram.git</a></span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="481d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">获取API ID和API哈希</h1><p id="aca7" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">下一步是获取<code class="fe nh ni nj my b">api_id</code>和<code class="fe nh ni nj my b">api_hash</code> <strong class="ky ir">、</strong>，我们只需要按照<a class="ae kv" href="https://core.telegram.org/api/obtaining_api_id" rel="noopener ugc nofollow" target="_blank">电报的指令</a>来获取它们:</p><ul class=""><li id="ac7e" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">使用任何应用程序注册电报。</li><li id="19df" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">登录你的电报核心:<a class="ae kv" href="https://my.telegram.org/" rel="noopener ugc nofollow" target="_blank">https://my.telegram.org</a>。</li><li id="be1c" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">进入<a class="ae kv" href="https://my.telegram.org/apps" rel="noopener ugc nofollow" target="_blank"> API开发工具</a>并填写表格。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/97b4f07800b2510a1fe9159c6801984d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-TEKBVCIfU2kn0_EnEXGQ.png"/></div></div></figure><p id="28f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您完成表单之后，Telegram会给您API密钥和必要的秘密。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/c5348f6e05f4ccedc1243b7d6c8864d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2P9hehcUBEhjZkexI-b8HA.png"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9528" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">密钥库文件</h1><p id="831d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">接下来我们需要将我们的<strong class="ky ir"> </strong> <code class="fe nh ni nj my b">.keystore</code>文件复制到<code class="fe nh ni nj my b">Telegram/TMessagesProj/config</code> <strong class="ky ir"> </strong>并填入WhatsApp中。(如果你没有<code class="fe nh ni nj my b">.keystore</code>文件，你可以按照<a class="ae kv" href="https://developer.android.com/studio/publish/app-signing#generate-key" rel="noopener ugc nofollow" target="_blank"> Android文档</a>创建一个。)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/686f77e767ed2f7cd20b6a3df547f279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZhMi3lO18RMunKZWr7g2w.png"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="bc27" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">重火力点</h1><p id="0c7c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在是时候转到我们的Firebase仪表板并创建一个新项目了。我将把它命名为超级秘密信息应用程序。初始化完成后，我们应该会看到下面的仪表板。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/41981cf5611a992bc13121b875987686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkoLxEnsIsTb5PMB1di95g.png"/></div></div></figure><p id="f22a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要创建一个Android应用程序。只需点击Android按钮，根据自己的需求填写表格即可。(如果不想重构源代码的包名，将包名设置为org.telegram.messenger很重要。)【2】<strong class="ky ir"/>我们还需要用包名org.telegram.messenger.beta重复这个过程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a02f8352a9d246ade1f6c49688d12023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvpighHzchpUkLXAnYbf6Q.png"/></div></div></figure><p id="f3d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，下载<code class="fe nh ni nj my b">google-services.json</code>并复制到<code class="fe nh ni nj my b">Telegram/TMessagesProj</code>下。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="de3c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">更改构建变量</strong></h1><p id="67b3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们需要打开<code class="fe nh ni nj my b">Telegram/TMessagesProj/src/main/java/org/telegram/messenger/BuildVars.java</code>，根据我们在<a class="ae kv" href="https://my.telegram.org/apps" rel="noopener ugc nofollow" target="_blank">电报App配置网站</a>上的信息(<code class="fe nh ni nj my b">app_id</code><strong class="ky ir"/><code class="fe nh ni nj my b">app_hash</code>)进行更改。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/572ad04c9269c48ee7552f1eacf23391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o8KfIDXYJZkOe_OEeV1dWQ.png"/></div></div></figure><p id="39da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可选地，我们可以将<code class="fe nh ni nj my b">BUILD_VERSION</code>恢复为1，将<code class="fe nh ni nj my b">BUILD_VERSION_STRING</code>恢复为1.0.0。这将是我们自己的消息应用程序，因此没有理由不这样做。</p><p id="db11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果一切正常，我们现在应该有一个可用的电报克隆。构建和测试的时间。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0d0e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">生成APK</h1><p id="8ab8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了测试应用程序，我们需要构建签名的APK，这可以在Build &gt; Generate Signed Bundle / APK中完成。由于我们不会将这个应用程序发布到Play Store，我们将选择APK选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/9313d6ec36907cde3ac4835f6d334a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vssNxIh_cPUvf9Y4WMVkVw.png"/></div></div></figure><p id="9062" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击“下一步”后，我们需要填写所需的信息(别名、密码等。)关于我们的<code class="fe nh ni nj my b">.keystore file</code>。</p><p id="0b4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">构建变体部分有点棘手(特定于手机)，但我为我的华为P30 Pro手机选择了armv7Release。让我们在手机上安装APK，测试一下是否一切正常。</p><p id="9b90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了测试，我把APK的文件发给了我的朋友<a class="ae kv" href="https://medium.com/@jonasrue" rel="noopener">乔纳斯·鲁</a>。在完成电话验证后，我们测试了与他的消息传递，一切都运行良好。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/328f9092e035e16c2ba495b705173300.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JqTHiZ2OJSsv9C52LhCHzg.jpeg"/></div></div></figure><p id="3a76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还测试了语音聊天，效果也很好。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/fdb17d8efc4a79f90343c17752fe3234.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgJ4XWkQwT5JTCUB8zafmQ.jpeg"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="cac5" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="0883" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在本教程中，我们编译了我们自己的Android Telegram克隆，它可以完美地工作。重要的是要记住，我们的应用程序仍然使用电报后端。我计划撰写本教程的第2部分，探索托管我们自己的电报消息服务器。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="9dd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非常感谢你一直读到最后。如果你面临任何问题，请随时写一封回信解释你的情况，我会尽我所能帮助你。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9a6d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">笔记</h1><p id="691e" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">[1]如果您计划发布您的应用程序，Telegram恳请您不要使用他们的名称和图标。为了遵守他们的许可，你还需要公开发布你的源代码。更多信息可以在他们的<a class="ae kv" href="https://github.com/DrKLO/Telegram" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。</p><p id="1811" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]如果你想更改应用程序的包名，可以关注StackOverflow 上的这个<a class="ae kv" href="https://stackoverflow.com/questions/16804093/rename-package-in-android-studio" rel="noopener ugc nofollow" target="_blank">牛逼的回答。</a></p></div></div>    
</body>
</html>