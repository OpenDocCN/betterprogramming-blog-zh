<html>
<head>
<title>Checking for Nulls in Java? Minimize Using “If Else”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Java中检查空值？尽量减少使用“如果，否则”</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/checking-for-nulls-in-java-minimize-using-if-else-edae27016474?source=collection_archive---------0-----------------------#2022-01-01">https://betterprogramming.pub/checking-for-nulls-in-java-minimize-using-if-else-edae27016474?source=collection_archive---------0-----------------------#2022-01-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0214" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">尝试6种替代方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/31e9620042a7401af4b9f6f7be6a510a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Rsm5RMRZjn5BgXkJ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@valentinlacoste?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Valentin Lacoste </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e134" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将尝试给出一些使用的不同类型的空检查或NPE (NullPointerException)避免技术的例子。</p><p id="5af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有许多关于这个主题的好文章，但我将试着把重点放在一些来自我自己经历的具体例子上。</p><p id="d480" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我仍在学习过程中—可能永无止境:)—因此，如果您看到任何错误，请随时告诉我。</p><h1 id="63e2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.java.util .可选</h1><blockquote class="mk ml mm"><p id="ce7a" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">一个容器对象，可能包含也可能不包含非空值。如果存在一个值，<code class="fe mr ms mt mu b">isPresent()</code>将返回<code class="fe mr ms mt mu b">true</code>，<code class="fe mr ms mt mu b">get()</code>将返回该值。</p></blockquote><p id="7b13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我目前从事的项目中，最常使用的一个地方是从数据库中检索数据。</p><p id="2e72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设你有三样东西:</p><ol class=""><li id="b61b" class="mv mw iq ky b kz la lc ld lf mx lj my ln mz lr na nb nc nd bi translated">一个叫做<code class="fe mr ms mt mu b">Student.java</code>的模型类</li><li id="b0ac" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated">一个服务接口及其实现:<code class="fe mr ms mt mu b">StudentService.java</code>和<code class="fe mr ms mt mu b">StudentServiceImpl.java</code></li><li id="f2bd" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated">一个DAO接口及其实现:<code class="fe mr ms mt mu b">StudentDao.java</code>和<code class="fe mr ms mt mu b">StudentDaoImpl.java</code></li></ol><p id="9750" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且您想要检索具有相关id的学生。</p><h2 id="235d" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">Optional.ofNullable()</h2><blockquote class="mk ml mm"><p id="8529" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果为非空，则返回描述给定值的可选值，否则返回空可选值。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="deeb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此方法的返回值永远不会为null。如果为空，返回值将为<code class="fe mr ms mt mu b">Optional.empty()</code>。这样，如果这个方法的结果被用在别的地方，就没有机会得到NPE。</p><h2 id="eaf9" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">Optional.orElseThrow()</h2><blockquote class="mk ml mm"><p id="8bb1" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果存在值，则返回该值，否则引发NoSuchElementException。</p></blockquote><p id="ee84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在null的情况下，如果你想抛出一个异常，你可以使用<code class="fe mr ms mt mu b">orElseThrow()</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="3c2e" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">Optional.orElse()</h2><blockquote class="mk ml mm"><p id="db3f" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果有值，则返回该值，否则返回其他。</p></blockquote><p id="be39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在null的情况下，如果你不想抛出一个异常，但是你想返回一个样本student实例，那么可以使用<code class="fe mr ms mt mu b">orElse()</code>。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="0eb3" class="nj lt iq mu b gy ob oc l od oe">@Override<br/>public Student getMockStudent(Long id) {<br/>    final var student = Student.<em class="mn">builder</em>()<br/>            .id(1L)<br/>            .name("ege")<br/>            .build();<br/><br/>    return studentDao.findStudentsById(id).orElse(student);<br/>}</span></pre><h2 id="b2c8" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">Optional.get()</h2><blockquote class="mk ml mm"><p id="4b90" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果存在值，则返回该值，否则引发NoSuchElementException。</p></blockquote><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="3ad5" class="nj lt iq mu b gy ob oc l od oe">@Override<br/>public Student getStudentDirectly(Long id) {<br/>    return studentDao.findStudentsById(id).get();<br/>}</span></pre><p id="4251" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，如果您使用IntelliJ，它会立即给出警告:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/1bdd0838a4ef8ce97239955e62397e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uqs6NoclkZtQ0Zr-J_tfQw.png"/></div></div></figure><p id="700b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上是说“首先检查你的学生是否为空，然后继续”。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="799c" class="nj lt iq mu b gy ob oc l od oe">// correct way to do it<br/>@Override<br/>public Student getStudentDirectly(Long id) {<br/>    final var studentOptional = studentDao.findStudentsById(id);<br/>    if(studentOptional.isPresent()){<br/>        // do your stuff here <br/>    }<br/>}</span></pre><p id="44dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我确信从我调用的方法中有数据返回时，我通常在单元测试中使用<code class="fe mr ms mt mu b">get()</code>。但是我不会在实际代码中没有<code class="fe mr ms mt mu b">isPresent()</code>的情况下使用它，即使我确信不会有null。</p><p id="a81c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再比如；下面的代码片段试图获取具有相关id的学生，如果没有这样的学生，则返回一个默认名称(“Hayley”)。当有学生但没有名字时，传递给<code class="fe mr ms mt mu b">rElse()</code>的值也会被返回。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="d948" class="nj lt iq mu b gy ob oc l od oe">@Override<br/>public String getStudentName(Long id) {<br/>    return studentDao.findStudentsById(id)<br/>            .map(Student::getName)<br/>            .orElse("Hayley");<br/>}</span></pre><h1 id="eac2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.apache.commons的实用程序类</h1><ul class=""><li id="896a" class="mv mw iq ky b kz og lc oh lf oi lj oj ln ok lr ol nb nc nd bi translated">对于收集实例:<code class="fe mr ms mt mu b">CollectionUtils.isEmpty()</code>或<code class="fe mr ms mt mu b">CollectionUtils.isEmpty()</code></li><li id="418a" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr ol nb nc nd bi translated">对于地图实例:<code class="fe mr ms mt mu b">MapUtils.isEmpty()</code>或<code class="fe mr ms mt mu b">MapUtils.isNotEmpty()</code></li><li id="2589" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr ol nb nc nd bi translated">对于字符串:<code class="fe mr ms mt mu b">StringUtils.isEmpty()</code>或<code class="fe mr ms mt mu b">StringUtils.isNotEmpty()</code></li></ul><p id="29c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于列表、映射等，<code class="fe mr ms mt mu b">isEmpty()</code> <em class="mn"> </em>检查集合/映射是否为空或大小为0。类似地，对于<code class="fe mr ms mt mu b">String</code>，它检查<code class="fe mr ms mt mu b">String</code>是否为空或长度为0。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="447d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使用<code class="fe mr ms mt mu b">CollectionUtils</code>和<code class="fe mr ms mt mu b">MapUtils</code>，需要在<code class="fe mr ms mt mu b">build.gradle</code>文件中添加以下依赖关系:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="ca62" class="nj lt iq mu b gy ob oc l od oe">implementation org.apache.commons:commons-collections4:4.4</span></pre><p id="629d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<code class="fe mr ms mt mu b">StringUtils</code>，您需要:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="50af" class="nj lt iq mu b gy ob oc l od oe">implementation org.apache.commons:commons-lang3:3.0</span></pre><h1 id="1470" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.Objects::流中非空</h1><blockquote class="mk ml mm"><p id="d070" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果提供的引用为非空，则返回<code class="fe mr ms mt mu b">true</code>，否则返回<code class="fe mr ms mt mu b">false</code>。</p></blockquote><p id="b08f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您有一个数据流，您将对该数据流执行一些链式操作，但在此之前，您希望过滤掉空值(如果有空值的话)。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="79dd" class="nj lt iq mu b gy ob oc l od oe">final var list = Arrays.<em class="mn">asList</em>(1, 2, null, 3, null, 4);<br/><br/>list.stream()<br/>        .filter(Objects::<em class="mn">nonNull</em>)<br/>        .forEach(System.<em class="mn">out</em>::print);</span></pre><p id="05cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果:<code class="fe mr ms mt mu b">1234</code></p><h1 id="2d33" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.要求java.util.Objects的非空方法</h1><h2 id="c478" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">requireNonNull()</h2><blockquote class="mk ml mm"><p id="e9d6" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">检查指定的对象引用是否不是<code class="fe mr ms mt mu b">null</code>，如果是，抛出一个定制的<code class="fe mr ms mt mu b"><em class="iq">NullPointerException</em></code>。此方法主要设计用于在具有多个参数的方法和构造函数中进行参数验证。</p></blockquote><h2 id="32a5" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">requireNonNullElse()</h2><blockquote class="mk ml mm"><p id="f119" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果第一个参数不是<code class="fe mr ms mt mu b">null</code>，则返回第一个参数，否则返回非<code class="fe mr ms mt mu b">null</code>的第二个参数。</p></blockquote><h2 id="1857" class="nj lt iq bd lu nk nl dn ly nm nn dp mc lf no np me lj nq nr mg ln ns nt mi nu bi translated">requireNonNullElseGet()</h2><blockquote class="mk ml mm"><p id="fc81" class="kw kx mn ky b kz la jr lb lc ld ju le mo lg lh li mp lk ll lm mq lo lp lq lr ij bi translated">如果是非<code class="fe mr ms mt mu b">null</code>则返回第一个参数，否则返回<code class="fe mr ms mt mu b">supplier.get()</code>的非<code class="fe mr ms mt mu b">null</code>值。</p></blockquote><p id="d035" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最常使用这三者的地方主要是构造函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7ffa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们用上面的例子来复习一下。</p><p id="5758" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt mu b">requireNonNull on id</code>:我们是说“这个字段是必填的，所以如果为空；抛出一条“需要身份证”的NPE信息。</p><p id="00b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt mu b">requireNonNullElse on name</code>:我们是说“这个字段是必填的，所以如果为空；不要抛出异常，而是为它设置一个默认值。在我们的例子中，默认值是“hayley”。</p><p id="290d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt mu b">requireNonNullElseGet on classes</code>:我们是说“这个字段是必填的，所以如果为空；不要抛出异常，而是为它设置一个默认值。。</p><p id="e741" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与<code class="fe mr ms mt mu b">requireNonNullElse</code>不同的是，这个方法期望<code class="fe mr ms mt mu b">Supplier</code>作为第二个参数。</p><p id="5612" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们可以使用带有<code class="fe mr ms mt mu b">requireNonNullElseGet.</code>的方法引用，这在处理列表、映射、集合时特别有用，如果你想将它们初始化为空列表、映射、集合等。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/c8f49c6adc971babbf5b9144ee70f946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LgIr4PR15g5SarDHFHG9A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">无供应商的requireNonNullElseGet</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/59f9102d5dd4eaa024105d9d60d62b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZfSjknryvlqFk_4sTpZFA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不含供应商的requireNonNullElseGet</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f584f541d65c1cff654d5dc0b081c2b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOFD_oL2YMu9Z2WSMeN2LQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">requireNonNullElseGet替换为requirenonnullesleeve</p></figure><p id="992b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看实际情况:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="28d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="2945" class="nj lt iq mu b gy ob oc l od oe">Student 1 name: hayley<br/>Student 2: Student(id=1, name=ege, classes=[], teacherMap={})<br/>Student 3: Student(id=null, name=null, classes=null, teacherMap=null)<br/>Student 4: Student(id=1, name=ege, classes=[], teacherMap={})<br/>Student 5: Student(id=1, name=ege, classes=[SchoolClass(id=null, name=null, type=null, teacher=null, students=null, extras=null, startDate=null)], teacherMap={})</span></pre><p id="cc4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，这些验证只有在调用相关的构造函数时才有效。</p><p id="e1db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再比如；假设你正在从你当前的方法(x)调用一个方法(y ),并且从(y)返回结果，你将在x中做其他操作，如果你不检查从y返回的结果是否为空，你有可能得到NPE。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="521c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="3772" class="nj lt iq mu b gy ob oc l od oe">Students 1: null<br/>Students 2: []<br/>Students 3: [Student(id=1, name=ege, classes=[], teacherMap={}), Student(id=2, name=itir, classes=[], teacherMap={})]<br/>Students 4: [Student(id=1, name=itir, classes=[], teacherMap={}), Student(id=2, name=ege, classes=[], teacherMap={})]<br/>Default student name: hayley<br/>All names:[itir, ege]</span></pre><h1 id="7711" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">5.龙目岛的建造者。默认</h1><p id="f6ee" class="pw-post-body-paragraph kw kx iq ky b kz og jr lb lc oh ju le lf op lh li lj oq ll lm ln or lp lq lr ij bi translated">如果你不熟悉龙目岛，我强烈建议你去看看。我个人非常喜欢Lombok，它让开发人员的生活变得更加轻松:)</p><p id="a388" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您有包含id、名称和类等字段的<code class="fe mr ms mt mu b">Student.java</code>。您可以在相关字段前使用put <code class="fe mr ms mt mu b">@Builder.Default</code>并给它一个默认值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="2a38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当这个<code class="fe mr ms mt mu b">Student</code>类的实例被创建时，它将“classes”作为一个空列表，而不是null。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="0a16" class="nj lt iq mu b gy ob oc l od oe">final var student1 = Student.<em class="mn">builder</em>().build();<br/>final var student2 = new Student();<br/>final var student3 = Student.<em class="mn">builder</em>().id(1L).name("ege").build();<br/><br/>System.<em class="mn">out</em>.println(student1.getClasses());<br/>System.<em class="mn">out</em>.println(student2.getClasses());<br/>System.<em class="mn">out</em>.println(student3.getClasses());<br/><br/>System.<em class="mn">out</em>.println(student1.getName());<br/>System.<em class="mn">out</em>.println(student2.getName());<br/>System.<em class="mn">out</em>.println(student3.getName());</span></pre><p id="808c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="0596" class="nj lt iq mu b gy ob oc l od oe">[]<br/>[]<br/>[]<br/>hayley<br/>hayley<br/>ege</span></pre><p id="6213" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您像这样简单地陈述<code class="fe mr ms mt mu b">Student.java</code>中的字段:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="c3cd" class="nj lt iq mu b gy ob oc l od oe">private Long id;<br/>private String name;<br/>private List&lt;SchoolClass&gt; classes;</span></pre><p id="3b11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="02d9" class="nj lt iq mu b gy ob oc l od oe">null<br/>null<br/>null<br/>null<br/>null<br/>ege</span></pre><p id="5dbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它对我处理列表、地图等特别有用。因为对于我正在从事的当前项目，列表或映射比其他字段更有可能为空。此外，如果在这些列表/映射上执行更多的操作，当它们为空时，很可能得到一个NPE。</p><p id="7077" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您想要获取学生注册的班级名称，并且您没有在“班级”列表中使用<code class="fe mr ms mt mu b">Builder.Default</code>。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="58a3" class="nj lt iq mu b gy ob oc l od oe">final var student1 = Student.<em class="mn">builder</em>().build();<br/>System.<em class="mn">out</em>.println(student1.getClasses().stream().map(SchoolClass::getName));</span></pre><p id="4fbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">抛出NPE。</p><h1 id="e84a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">6.NotNull、NotEmpty、NotBlank批注</h1><p id="4f94" class="pw-post-body-paragraph kw kx iq ky b kz og jr lb lc oh ju le lf op lh li lj oq ll lm ln or lp lq lr ij bi translated"><code class="fe mr ms mt mu b">@NotNull</code> : <em class="mn">“注释元素不能为空。接受任何类型。⁴ </em></p><p id="5360" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt mu b">@NotEmpty</code> : <em class="mn">"注释元素不能为null或空。支持的类型有CharSequence、Collection、Map、Array。⁵ </em></p><p id="34ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt mu b">@NotBlank</code> : <em class="mn">"带注释的元素不能为空，并且必须包含至少一个非空白字符。接受char sequence“⁶</em></p><p id="96a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设你有一个控制器和一个<code class="fe mr ms mt mu b">saveStudent()</code>方法。当您希望id、name和classes字段不为null或空时，您可以将这些注释放在Student class中，如下所示:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="7a35" class="nj lt iq mu b gy ob oc l od oe">@NotNull<br/>private Long id;<br/>@NotEmpty<br/>private String name;<br/>@NotEmpty<br/>private List&lt;SchoolClass&gt; classes;<br/>private Map&lt;Integer, Teacher&gt; teacherMap;</span></pre><p id="fcdc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您正在使用Spring Boot，您可以将这些注释与API请求体的<code class="fe mr ms mt mu b">@Validated</code>注释结合起来，如下所示。</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="9f69" class="nj lt iq mu b gy ob oc l od oe">@PostMapping()<br/>public void saveStudent(@Validated @RequestBody Student student){<br/>    studentService.saveStudent(student);<br/>}</span></pre><p id="ddd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您有这样的请求:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/d6ddd90b35b74194631f273c62d3c95d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YS59s--XkWttgfp2jKObiA.png"/></div></div></figure><p id="665a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，您将得到“400”错误，并且在您的应用程序的控制台中，您将看到:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="1477" class="nj lt iq mu b gy ob oc l od oe">DefaultHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public void com.example.demodemo.controller.StudentController.saveStudent(com.example.demodemo.model.Student) with 2 errors: [Field error in object 'student' on field 'classes': rejected value [null]; <br/>codes [NotEmpty.student.classes,NotEmpty.classes,NotEmpty.java.util.List,NotEmpty]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [student.classes,classes]; arguments []; default message [classes]]; default message [must not be empty]] [Field error in object 'student' on field 'id': rejected value [null]; <br/>codes [NotNull.student.id,NotNull.id,NotNull.java.lang.Long,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [student.id,id]; arguments []; default message [id]]; default message [must not be null]] ]</span></pre><p id="ff4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果愿意，您可以捕获这个<code class="fe mr ms mt mu b">MethodArgumentNotValidException</code>并返回一个自定义错误。</p><p id="08aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所需的依赖性:</p><pre class="kg kh ki kj gt nx mu ny nz aw oa bi"><span id="761c" class="nj lt iq mu b gy ob oc l od oe">implementation 'org.springframework.boot:spring-boot-starter-validation'</span></pre><p id="a8f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就我目前所知，就是这样。随着我学习更多的空检查方法，我会尝试更新这个列表。有时候，我仍然需要使用一个很好的旧的“if else”块来进行空值检查，但是我会尽可能地使用这些方法。</p><p id="c3a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你喜欢这篇文章。</p><p id="11f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献:</strong></p><ol class=""><li id="9ac7" class="mv mw iq ky b kz la lc ld lf mx lj my ln mz lr na nb nc nd bi translated"><a class="ae kv" href="https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/javase/8/docs/API/Java/util/optional . html</a></li><li id="9189" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://docs.oracle.com/javase/8/docs/api/java/util/Objects.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/javase/8/docs/API/Java/util/objects . html</a></li><li id="2cf0" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://docs.oracle.com/javase/9/docs/api/java/util/Objects.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/javase/9/docs/API/Java/util/objects . html</a></li><li id="71ac" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://docs.oracle.com/javaee/7/api/javax/validation/constraints/NotNull.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/javaee/7/API/javax/validation/constraints/not null . html</a></li><li id="3f2b" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/NotEmpty.html" rel="noopener ugc nofollow" target="_blank">https://javaee . github . io/javaee-spec/javadocs/javax/validation/constraints/notempty . html</a></li><li id="ba07" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/NotBlank.html" rel="noopener ugc nofollow" target="_blank">https://javaee . github . io/javaee-spec/javadocs/javax/validation/constraints/not blank . html</a></li><li id="c540" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://www.baeldung.com/java-avoid-null-check" rel="noopener ugc nofollow" target="_blank">https://www.baeldung.com/java-avoid-null-check</a></li><li id="9b78" class="mv mw iq ky b kz ne lc nf lf ng lj nh ln ni lr na nb nc nd bi translated"><a class="ae kv" href="https://projectlombok.org/" rel="noopener ugc nofollow" target="_blank">https://projectlombok.org/</a></li></ol></div></div>    
</body>
</html>