<html>
<head>
<title>Using CSS Modules With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将CSS模块与React一起使用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-css-modules-with-react-in-2020-73c2223f495c?source=collection_archive---------6-----------------------#2020-01-11">https://betterprogramming.pub/using-css-modules-with-react-in-2020-73c2223f495c?source=collection_archive---------6-----------------------#2020-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a8d9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有时候纯CSS是更好的选择</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab2efb3fc8cb191a00b2637358542176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*or2I2VUQArEH1W5n"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">妮可·沃尔夫在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我知道你在想什么。”<a class="ae ky" href="https://github.com/css-modules/css-modules" rel="noopener ugc nofollow" target="_blank"> CSS模块</a>？2020年？你住在山洞里吗？”好的。我明白了。有很多很酷的CSS-in-JS解决方案:<a class="ae ky" href="https://www.styled-components.com/" rel="noopener ugc nofollow" target="_blank"> styled-components、</a> <a class="ae ky" href="https://emotion.sh/" rel="noopener ugc nofollow" target="_blank"> emotion </a>、<a class="ae ky" href="https://linaria.now.sh/" rel="noopener ugc nofollow" target="_blank"> linaria </a>等等。他们都很棒，我爱他们。但是在有些情况下，使用老式的、近乎纯粹的CSS是更好的选择。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f047" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">故事</h1><p id="5c0e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我想使用React作为模板引擎，创建一个带有<a class="ae ky" href="https://amp.dev/" rel="noopener ugc nofollow" target="_blank"> AMP </a>(加速移动页面)的web项目。我的风格解决方案是情感和风格系统。对我来说这是一个很好的组合。基于主题的风格、风格道具、创造变化的能力等。布伦特·杰克逊为这个伟大的工具赢得了荣誉。我也是他的新工具<a class="ae ky" href="https://theme-ui.com/" rel="noopener ugc nofollow" target="_blank"> theme-ui </a>的忠实粉丝。</p><p id="0d5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之。您可能已经知道，AMP对CSS和HTML有严格的限制。其中一些是，例如，整个页面的CSS需要在一个样式标签中，HTML标签不能包含任何自定义属性。此外，您需要在服务器端渲染一切。一切都需要是静态的HTML和CSS。不允许自定义JS。在我开始使用CSS-in-JS解决方案后，我发现自己一次又一次地试图解决同样的问题。我意识到，即使这些CSS-in-JS解决方案总的来说很棒，但没有一个对我的工作效率有帮助。我花了那么多时间让事情运转起来。显然，我需要一个不同的解决方案。经过一番研究，我决定给一个老朋友一个机会，CSS模块。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b3bd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">履行</h1><p id="a785" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">由于CSS Modules只是带有一些构建时webpack魔法的CSS，所以将其用于AMP不会有任何问题。</p><p id="cb2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了今天使用未来的CSS，我使用了<a class="ae ky" href="https://preset-env.cssdb.org/" rel="noopener ugc nofollow" target="_blank"> postcss-preset-env </a>。此外，我想从CSS-in-JS堆栈中我最喜欢的特性中受益，比如基于主题的样式、样式道具等。</p><p id="01eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，主题化是一个大问题。CSS新特性的力量，比如CSS变量和自定义媒体查询，在这里很有帮助。有了postcss-preset-env，您也不需要担心浏览器支持。您需要做的就是用CSS变量创建一个<code class="fe nb nc nd ne b">theme.css</code>文件，并将这个文件提供给postcss-preset-env config。这是我的配置和一个示例主题文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="bd96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个设置，你可以为你的主题全局定义任何变量，并在你的样式中使用它。主题化问题解决了。下一个。</p><p id="aa9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我之前提到的，我是风格道具的忠实粉丝。有像<a class="ae ky" href="https://github.com/JedWatson/classnames" rel="noopener ugc nofollow" target="_blank"> classnames </a>和<a class="ae ky" href="https://github.com/lukeed/clsx" rel="noopener ugc nofollow" target="_blank"> clsx </a>这样的库来帮助你使用props创建动态类。让我们看一个例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="1e7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，即使是非常基本的组件，也有许多样板代码。但是等一下。你能看出模式吗？有风格道具，道具值，相对CSS类。似乎有了一些约定、助手函数和组件，我们可以为这个任务创建一个小型的通用库。</p><p id="aec0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要一些惯例。</p><ul class=""><li id="b45c" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">使用<code class="fe nb nc nd ne b">.root</code>级作为基础。</li><li id="7c20" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">使用<code class="fe nb nc nd ne b">.{prop}-{value}</code>约定俗成的风格道具。例如<code class="fe nb nc nd ne b">.color-primary</code></li><li id="2893" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">如果属性值是布尔值，使用<code class="fe nb nc nd ne b">.{prop}</code>约定</li></ul><p id="1a70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了从这些约定中获益，我们需要一个函数来获取一组属性和一个样式对象，然后使用clsx库将样式属性映射到样式对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="9867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个助手函数，我们不需要编写所有的样板代码。让我们使用<code class="fe nb nc nd ne b">mapPropsToStyles</code>函数重构按钮组件。</p><pre class="kj kk kl km gt nv ne nw nx aw ny bi"><span id="c872" class="nz md it ne b gy oa ob l oc od">// Button.css<br/>.root {<br/>  ...<br/>}</span><span id="39af" class="nz md it ne b gy oe ob l oc od">.color-primary {<br/>  background-color: var(--primary-color);<br/>}</span><span id="5fb5" class="nz md it ne b gy oe ob l oc od">.color-secondary {<br/>  background-color: var(--secondary-color);<br/>}</span><span id="9929" class="nz md it ne b gy oe ob l oc od">.size-small {<br/>  padding: var(--space-2);<br/>}</span><span id="96cc" class="nz md it ne b gy oe ob l oc od">.size-medium {<br/>  padding: var(--space-4);<br/>}</span><span id="d4fa" class="nz md it ne b gy oe ob l oc od">// Button.js<br/>import mapPropsToStyles from 'src/common/mapPropsToStyles';<br/>import styles from './Button.css';</span><span id="d881" class="nz md it ne b gy oe ob l oc od">export default function Button({ color, size, ...props }) {<br/>  const classes = mapPropsToStyles({ color, size }, styles);</span><span id="d7b0" class="nz md it ne b gy oe ob l oc od">  return &lt;button className={classes} {...props} /&gt;;<br/>}</span></pre><p id="ab39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好多了，对吧？是的，但是我们甚至可以更进一步，创建一个通用组件来为我们处理所有的样式工作。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk">.</p></figure><p id="183d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种方法，我们不需要为每个组件设计样板样式。我们可以用<code class="fe nb nc nd ne b">as</code> prop创建任何我们想要的元素，我们可以用<code class="fe nb nc nd ne b">className</code> prop传递额外的类来添加和覆盖样式。让我们最后一次重构我们的按钮组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="5014" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们的生活简单多了，我们的部件也很整洁。我们需要做的就是编写一个CSS文件，并将匹配的道具传递给我们的组件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9d2d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="df93" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当然，我们可以创建更多的例子，做更多的改进，比如使用数组的响应式道具支持。你可以从这里开始，根据你的需要进行定制。</p><p id="679f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相对于CSS-in-JS解决方案的一些优势:</p><ul class=""><li id="6896" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">只是CSS而已</li><li id="deb1" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">没有运行时间</li><li id="984d" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">轻松将样式导出到CSS文件</li><li id="faf5" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">SSR和CSR的设置相同</li></ul><p id="e30a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时候，坚持好的老解决方案，让事情变得简单，而不是追求炒作，会好得多。如果它符合你的需要，而且没有任何麻烦，其他的都不重要。</p><p id="9ea5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持冷静，继续编码！</p></div></div>    
</body>
</html>