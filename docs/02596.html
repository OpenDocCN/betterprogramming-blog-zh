<html>
<head>
<title>How to Extract Tables in PDFs to pandas DataFrames With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python将pdf中的表格提取为熊猫数据框</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/convert-tables-from-pdfs-to-pandas-with-python-d74f8ac31dc2?source=collection_archive---------0-----------------------#2019-12-11">https://betterprogramming.pub/convert-tables-from-pdfs-to-pandas-with-python-d74f8ac31dc2?source=collection_archive---------0-----------------------#2019-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="571b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数字化pdf中的数据集</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3942aa811604f436300ef1fe6c11048f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOoycGNG-hTSu3LA2nPAmg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jcoudriet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰森·库德里特</a>在<a class="ae ky" href="https://unsplash.com/s/photos/chart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5d61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://medium.com/@rqaiserr/how-to-convert-pdfs-into-searchable-key-words-with-python-85aab86c544f" rel="noopener">从PDF文件中提取关键词</a>之后，初露头角的数据科学家/工程师的下一步自然是弄清楚如何从那些讨厌的PDF文件中获取表格。</p><p id="5d22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">亲爱的读者，今天是你的幸运日。在我的一个项目中，我数字化了以PDF文件形式发布的政府数据集，我想分享一下我是如何做到的。我们将用我们最喜欢的语言:Python来做这件事。</p><p id="d746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面，您将找到设置环境的步骤和如何使用Python从PDF文件中提取表格的教程，另外！现实世界的例子。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="80d6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置</h1><p id="237f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于本教程，我将使用Python 3.7。你可以使用任何你喜欢的版本，但是，我不能保证如果你使用的是3.7以外的版本，任何东西都可以工作。</p><p id="973d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将需要以下Python库来遵循本教程:</p><ul class=""><li id="4c2a" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><a class="ae ky" href="http://tabula.technology/" rel="noopener ugc nofollow" target="_blank"> Tabula </a>(一个用Java编写的OCR库，用于PDF到DataFrame的转换)。</li><li id="221f" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">Pandas</a>(Python中的一个数据操作库)。</li><li id="9874" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">Java 8+(大多数操作系统默认应该有这个)。</li></ul><p id="ac0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述库可以按如下方式安装在您的终端中(在macOS上):</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c42d" class="ns md it no b gy nt nu l nv nw">pip install tabula-py</span><span id="95bd" class="ns md it no b gy nx nu l nv nw">pip install pandas</span></pre><p id="9d6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Java 8可以使用<a class="ae ky" href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" rel="noopener ugc nofollow" target="_blank">这个网站</a>下载安装。</p><p id="bdfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上内容应该足以让您从PDF文件中提取表格，并将其转换为pandas DataFrames以供进一步处理。</p><p id="0827" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">启动您最喜欢的编辑器并跟随！</p><p id="353d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:所有以<code class="fe ny nz oa no b">#</code>开头的行都是注释。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4d73" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤1:导入所有库</h1><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d10b" class="ns md it no b gy nt nu l nv nw">import tabula</span><span id="e88f" class="ns md it no b gy nx nu l nv nw">#the pd is the standard shorthand for pandas<br/>import pandas as pd</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="82ef" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤2:将PDF表格转换成数据框架</h1><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8b03" class="ns md it no b gy nt nu l nv nw">#declare the path of your file<br/>file_path = "/path/to/pdf_file/data.pdf"</span><span id="ce80" class="ns md it no b gy nx nu l nv nw">#Convert your file<br/>df = tabula.read_pdf(file_path)</span></pre><p id="db69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是<em class="ob">说</em>简单！至少理论上是这样。但是让我们试着用几个真实的例子来做上面的事情，这样你就可以看到Tabula在运行。</p><h2 id="8e26" class="ns md it bd me oc od dn mi oe of dp mm li og oh mo lm oi oj mq lq ok ol ms om bi translated">例如:巴基斯坦的电信</h2><p id="5088" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">因为我是巴基斯坦裔加拿大人，我喜欢看关于我的祖国的统计数据，所以让我们从那里开始吧。</p><p id="37e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用过去五年巴基斯坦电信用户的月度数据，你猜对了，是PDF格式的！你可以在这个网站上找到数据。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="7c93" class="ns md it no b gy nt nu l nv nw">#file is in the same folder as your program<br/>file_path = "./Telecommination_Sept_2019.pdf""</span><span id="268d" class="ns md it no b gy nx nu l nv nw">#Convert your file</span><span id="332f" class="ns md it no b gy nx nu l nv nw">df = tabula.read_pdf(file_path)</span></pre><p id="5aa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/5784041e95fb3f9ea58eba9640e499f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*Fa_HGUzADShmTpbVPalRlg.png"/></div></figure><p id="a963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管数据有点脏(在熊猫身上很容易清理——如果你对如何清理感到好奇，请留下评论), Tabula能够如此轻松地阅读它还是很酷的。</p><p id="c94a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是有一个问题。这个特殊的文件有六页不同的数据。如果我们想阅读所有的页面呢？好了，你需要做的就是将<code class="fe ny nz oa no b">pages=’all’</code> <strong class="lb iu"> </strong>旗帜传递给Tabula，如下:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="bdcc" class="ns md it no b gy nt nu l nv nw">#file is in the same folder as your program<br/>file_path = "./Telecommination_Sept_2019.pdf""</span><span id="3c62" class="ns md it no b gy nx nu l nv nw">#Convert your file</span><span id="803a" class="ns md it no b gy nx nu l nv nw">df = tabula.read_pdf(file_path, pages='all')</span></pre><p id="7772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ffb38d98eff44901d1cbb3fbecddbb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*H3xPiJVcVU_WxDNkRtSzRQ.png"/></div></figure><p id="7319" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很简单，对吧？实际上有很多不同的命令可以传递给Tabula来加速它，甚至提供特定的X-Y坐标来提取。</p><p id="a91b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常棒的图书馆！如果你对深入探索Tabula本身感兴趣，请联系我。</p><p id="61ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢我的作品吗？雇用我进行升级工作！</p></div></div>    
</body>
</html>