<html>
<head>
<title>How to Record Flutter Integration Tests With GitHub Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用GitHub动作记录颤振集成测试</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-record-flutter-integration-tests-with-github-actions-1ca670eff94a?source=collection_archive---------12-----------------------#2020-03-12">https://betterprogramming.pub/how-to-record-flutter-integration-tests-with-github-actions-1ca670eff94a?source=collection_archive---------12-----------------------#2020-03-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dc13" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">满怀信心地合并每个拉取请求</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/03608be2ad088a70f42562a4b70839eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNAJ8JqIJ6PDOaU1Tdgxvw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@srz?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">悉尼·瑞伊</a>在<a class="ae ky" href="https://unsplash.com/s/photos/confident?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="112b" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">当截图不够时，我们需要屏幕录像</h1><p id="fa16" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">如何有效保持UI的一致性一直是移动开发中的热门话题。</p><p id="2c87" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在我之前的一篇文章中，我讨论了如何用GitHub操作运行集成测试和上传截图:</p><div class="mz na gp gr nb nc"><a href="https://medium.com/better-programming/monitor-your-flutter-apps-health-end-to-end-with-github-actions-8a9fb1889c6a" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">使用GitHub操作端到端监控您的Flutter应用程序的健康状况</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">详细的指南</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><p id="c437" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">然而，随着应用程序越来越复杂，截图无法捕捉所有的回归。相反，屏幕录制更可取。</p><p id="2d6d" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">让我们在我之前的文章(Flutter integrations test+screens)的基础上，将屏幕录像添加到我们的军火库中。下面先睹为快(对于每个拉取请求，您将获得这样的屏幕记录):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="76ce" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如果你想直接跳到一个真实的Flutter项目中的完整实现，请查看<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener"> Mini Donkey </a>的知识库(本文中的所有代码都来自这里):</p><div class="mz na gp gr nb nc"><a href="https://github.com/tianhaoz95/photochat" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">天昊95/照片</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">迷你驴携带加密(AES)和隐写术(的技术)安全和秘密的私人信息</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nt l nn no np nl nq ks nc"/></div></div></a></div></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="ec26" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤1:启动屏幕记录器</h1><p id="bb89" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">要启动屏幕记录器，我们可以从Xcode使用CLI:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/5f68e1fdb125ea37a1913424b6534e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LqlS8KQ9IlSDKdb5ZkTxiw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/tianhaoz95/photochat/blob/master/.github/workflows/thor.yml#L86-L104" rel="noopener ugc nofollow" target="_blank">工作流程配置</a>来自<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>。</p></figure><p id="e279" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">由于Xcode中的一个“bug ”,在记录器之后立即开始测试会导致一个空的记录。我们需要添加一个<code class="fe nv nw nx ny b">sleep</code>来确保这种情况不会发生。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a824" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤2:检索屏幕记录器的PID</h1><p id="0b53" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">屏幕记录器启动并运行后，我们想要检索它的进程ID，以便我们可以在最后终止它。否则，我们的操作将永远运行，GitHub将在六个小时后终止它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/b6b0ae146f1b0a4d1ffbf44b3c3b84e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mee3E-Kfa31sLWA2TJ-H3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/tianhaoz95/photochat/blob/master/.github/workflows/thor.yml#L86-L104" rel="noopener ugc nofollow" target="_blank">工作流程配置</a>来自<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="d4c5" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤3:运行颤振综合测试</h1><p id="c8c7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在屏幕记录器完全准备好之后，我们可以开始颤振综合试验:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/607573c940d9b552c2fd6bdb7595be25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCDrup0iY9GpqgdZfH7uRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/tianhaoz95/photochat/blob/master/.github/workflows/thor.yml#L86-L104" rel="noopener ugc nofollow" target="_blank">工作流程配置</a>来自<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a910" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤4:终止屏幕记录器并收集记录</h1><p id="d425" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">颤振综合试验完成后，我们需要终止屏幕记录器，它在终止时自动保存屏幕记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/beb97b378d5c08b3d7d3fa65717b4d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pq5c04OL1EJVYWceFbf2ZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/tianhaoz95/photochat/blob/master/.github/workflows/thor.yml#L86-L104" rel="noopener ugc nofollow" target="_blank">工作流程配置</a>来自<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>。</p></figure><p id="8010" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">为了确保在容器销毁之前保存屏幕记录，我在<code class="fe nv nw nx ny b">kill</code>命令下添加了一个<code class="fe nv nw nx ny b">sleep</code>。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="a240" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">步骤5:将记录作为工件上传</h1><p id="5a88" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">生成屏幕记录后，我们现在可以将其作为构建工件上传，供其他开发人员查看:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/ebdf9bd2c0b4df8f08009f11fcddf076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Wo7MD65M2tepIdhqOuy4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/tianhaoz95/photochat/blob/master/.github/workflows/thor.yml#L86-L104" rel="noopener ugc nofollow" target="_blank">工作流程配置</a>来自<a class="ae ky" href="https://medium.com/minidonkey101" rel="noopener">迷你驴</a>。</p></figure><p id="9285" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">一旦GitHub Actions工作流配置签入，您将获得每个pull请求的一组工件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/b1a2d38218f4819e7d19da7b8ff0ca7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pr6ORcd3Z5YHDn5jSdBLHg.png"/></div></div></figure><p id="0670" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">屏幕录制位于每个设备的<code class="fe nv nw nx ny b">build artifact</code>包装内:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/dc260f8a2e77bdfc53286b6ff4303112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*B3HbGynlcn9YDHE6tPS6rw.png"/></div></figure><p id="f7d4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><code class="fe nv nw nx ny b">recording.mov</code>是你在这篇文章开头看到的屏幕记录。</p><p id="74d7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">每一次UI更改(即使是最细微的更改)都只需点击一下鼠标就能完成，因此我们现在可以真正放心地合并拉请求了。</p></div></div>    
</body>
</html>