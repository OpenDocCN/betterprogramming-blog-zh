<html>
<head>
<title>Build Animated Pie and Donut Charts in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中构建动画饼图和圆环图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-animated-pie-and-donut-charts-in-swiftui-9b74b95f8b39?source=collection_archive---------8-----------------------#2021-01-06">https://betterprogramming.pub/build-animated-pie-and-donut-charts-in-swiftui-9b74b95f8b39?source=collection_archive---------8-----------------------#2021-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0413" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建饼图和甜甜圈切片并制作动画</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c6aa314d6d4960e7039a21675ef32d84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBFL6fyYOSi8-79PV6M2_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">SwiftUI中的饼图和圆环图</p></figure><p id="98cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要开始创建形状并制作动画，我们首先需要从构建图表所需的数据开始。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="a082" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">图表数据</h1><p id="050c" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">为图表数据创建一个<code class="fe my mz na nb b">struct</code>。我们需要的数据是百分比、颜色和当前百分比之前的百分比总和。当我们使用修饰符<code class="fe my mz na nb b">.trim</code>从最后一个百分比值开始修剪时，我们将需要总和。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="73cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们需要创建一个可观察的对象。添加图表数据的已发布数组，并用数据填充它。测试时确保你的百分比加起来是100。将所有图表数据的值赋为0。我们希望当值从0变化到它将具有的任何值时，饼图切片能够显示动画。</p><p id="c11c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">示例:</p><pre class="kj kk kl km gt ne nb nf ng aw nh bi"><span id="7752" class="ni mc it nb b gy nj nk l nl nm">ChartData(color: Color.red, percent: 8, <strong class="nb iu">value: 0</strong>)</span></pre><p id="1816" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在该类中，创建一个函数，为我们计算数组中以前的百分比。如果您不希望图表是动画，创建一个运行我们的<code class="fe my mz na nb b">calc()</code>函数的<code class="fe my mz na nb b">init()</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ad56" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">圆形分格统计图表</h1><p id="2999" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">添加一个<code class="fe my mz na nb b">ChatDataContainer</code>类型的观察对象变量，然后遍历它的数组。对于饼图切片，我们将在一个<code class="fe my mz na nb b">ZStack</code>内堆叠圆圈。对图表数据值使用<code class="fe my mz na nb b">.trim()</code>修饰符。这些值将决定每次修剪的起点和终点。将聊天数据值除以100，因为<code class="fe my mz na nb b">trim()</code>修饰符只适用于0.0到1.0之间的值。</p><p id="5610" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让动画效果更好，我们需要一个<code class="fe my mz na nb b">stroke()</code>而不是一个<code class="fe my mz na nb b">fill()</code>修改器。您可以在两者之间切换，以查看不同之处。描边的线条宽度需要与饼图的宽度相匹配。下面，饼图宽度为100，线条宽度为100。</p><p id="fc0e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在视图出现在屏幕上时开始动画，我们可以使用<code class="fe my mz na nb b">.onAppear()</code>修改器并让<code class="fe my mz na nb b">calc()</code>函数在其中运行。您还可以给饼图扇区添加缩放效果。当我们的变量<code class="fe my mz na nb b">indexOfTappedSlice</code>改变时，比例效果将被激活。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="2423" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将在我们的<code class="fe my mz na nb b">VStack</code>中添加另一个<code class="fe my mz na nb b">ForEach</code>循环，以添加一个包含颜色和百分比的描述。您可以添加更多的文本元素来解释您的图表。在<code class="fe my mz na nb b">Text</code>视图中，添加<code class="fe my mz na nb b">onTapGesture()</code>修饰符，它将把我们的<code class="fe my mz na nb b">indexOfTappedSlice</code>值更改为点击文本的索引，或者当文本被点击两次时为-1。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="11cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，您可以将<code class="fe my mz na nb b">PieChart</code>添加到您的<code class="fe my mz na nb b">ContentView</code>中并运行应用程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/8e5c8de894b00c0b30453cde0e795920.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/1*p1ieYPCNGt5KF9oAtmrhqA.gif"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="68bd" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">圆环图</h1><p id="1fe2" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">圆环形状要求您更改以下内容:</p><ul class=""><li id="ed85" class="no np it la b lb lc le lf lh nq ll nr lp ns lt nt nu nv nw bi translated">框架宽度从100到200。</li><li id="984f" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated">框架高度从200到250。</li><li id="2b7c" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated">线宽从100到50。</li><li id="3c2f" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated">添加<code class="fe my mz na nb b">onTapGesture()</code>修改器。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="158c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">像我们对饼图所做的那样，在<code class="fe my mz na nb b">VStack</code>中添加描述循环。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cfc4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，在我们的<code class="fe my mz na nb b">ContentView</code>中添加<code class="fe my mz na nb b">DonutChart</code>视图并运行应用程序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/53c8814f3343b59aae8d79333366422a.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/1*YA8_q6oI6H8pBu7CN8alqw.gif"/></div></figure><p id="2567" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">全部完成！感谢阅读。</p></div></div>    
</body>
</html>