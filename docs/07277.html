<html>
<head>
<title>How to Self-Host WordPress</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何自托管WordPress</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-self-host-wordpress-f3b9d3f3d964?source=collection_archive---------10-----------------------#2020-12-28">https://betterprogramming.pub/how-to-self-host-wordpress-f3b9d3f3d964?source=collection_archive---------10-----------------------#2020-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab81" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在部署WordPress之前在本地设置它</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/04fb738e7050a0aed57dfc9ae51bc427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXKkakQBDgmBPHXa90Ue_w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=265132" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的图片由<a class="ae ky" href="https://pixabay.com/users/pixelcreatures-127599/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=265132" rel="noopener ugc nofollow" target="_blank">沃纳·莫泽</a>拍摄</p></figure><p id="4de6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">WordPress主机有很多选择。许多都是单击选项，你输入几个值，你的网站就开始运行了。但是你知道幕后是怎么回事吗？我从来不喜欢以简单的方式做事，我喜欢知道发生了什么，即使这意味着避免单击解决方案。</p><p id="ab4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还想在本地运行一个WordPress，这样我可以尝试不同的插件和主题，但仍然可以很快回到一些理智的起点。但是我不想开始在我的笔记本电脑上安装很多软件。对于那些熟悉我写作的人，我相信你能明白我的意思。我能从Docker上运行WordPress和伴随的进程吗？</p><p id="39af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我浏览了一下Docker Hub，我惊喜地发现这里有一张官方图片<a class="ae ky" href="https://hub.docker.com/_/wordpress" rel="noopener ugc nofollow" target="_blank"/>。它还有一个漂亮的<code class="fe lv lw lx ly b">docker-compose.yml</code>文件。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="7f7a" class="md me it ly b gy mf mg l mh mi">version: '3.1'</span><span id="e29a" class="md me it ly b gy mj mg l mh mi">services:</span><span id="fe40" class="md me it ly b gy mj mg l mh mi">wordpress:<br/>    image: wordpress<br/>    restart: always<br/>    ports:<br/>      - 8080:80<br/>    environment:<br/>      WORDPRESS_DB_HOST: db<br/>      WORDPRESS_DB_USER: exampleuser<br/>      WORDPRESS_DB_PASSWORD: examplepass<br/>      WORDPRESS_DB_NAME: exampledb<br/>    volumes:<br/>      - wordpress:/var/www/html</span><span id="b844" class="md me it ly b gy mj mg l mh mi">db:<br/>    image: mysql:5.7<br/>    restart: always<br/>    environment:<br/>      MYSQL_DATABASE: exampledb<br/>      MYSQL_USER: exampleuser<br/>      MYSQL_PASSWORD: examplepass<br/>      MYSQL_RANDOM_ROOT_PASSWORD: '1'<br/>    volumes:<br/>      - db:/var/lib/mysql</span><span id="0a8e" class="md me it ly b gy mj mg l mh mi">volumes:<br/>  wordpress:<br/>  db:</span></pre><p id="6009" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，这只适合在<code class="fe lv lw lx ly b">localhost</code>上运行，因为它没有强密码——我必须提供一个包含这些密码的环境文件。但是首先，我把它复制到一个本地目录并运行<code class="fe lv lw lx ly b">docker-compose up</code>，在几分钟内，我可以浏览到<code class="fe lv lw lx ly b"><a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/</a></code>并看到新的安装:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/933f7ed140ad3e33240881b189e0b52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MaR-qsj3Py5ncMND_fhAKg.png"/></div></div></figure><p id="6de9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，一切顺利！在你选择了一种语言后，另一个屏幕将会出现并询问一些问题。最重要的是登录时使用的用户名和密码。一定要记住那些！完成该屏幕后，您必须登录。然后，你会看到正常的WordPress管理界面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/eaa9265f161581c4914b3cabbb715bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uahRmJpWMuj43Rqbn69PsQ.png"/></div></div></figure><p id="a919" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你自己的个人WordPress沙盒！</p><p id="c7be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几件事我想立刻改变:MySQL数据库和WordPress使用Docker卷存储数据的方式。我想将它从卷中移出，并将它们映射到本地目录。这样，我可以看到其中发生了什么，我可以通过删除它们来清除它们，而不是记住Docker-volume delete命令。</p><p id="4011" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，我想从目录外的环境文件中读取数据，这样它就不会意外地提交给GitHub。使用<code class="fe lv lw lx ly b">Ctrl-C</code>停止服务器，使用<code class="fe lv lw lx ly b">docker-compose down</code>移除容器。</p><p id="7484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新的<code class="fe lv lw lx ly b">docker-compose.yml</code>文件将如下所示:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="f8d2" class="md me it ly b gy mf mg l mh mi">version: '3.1'<br/>services:<br/>  wordpress:<br/>    image: wordpress<br/>    restart: always<br/>    ports:<br/>      - 8080:80<br/>    env_file:<br/>      - ../config/wordpress.env<br/>    volumes:<br/>     - ./wordpress:/var/www/html<br/>  db:<br/>    image: mysql:5.7<br/>    restart: always<br/>    env_file:<br/>      - ../config/wordpress.env<br/>    volumes:<br/>      - ./data:/var/lib/mysql</span></pre><p id="a6f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">WordPress和MySql都会在../config/wordpress.env，应该是这样的:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="e25c" class="md me it ly b gy mf mg l mh mi">WORDPRESS_DB_HOST=db<br/>WORDPRESS_DB_USER=wpuser<br/>WORDPRESS_DB_PASSWORD=&lt;password&gt;<br/>WORDPRESS_DB_NAME=wpdb<br/>MYSQL_DATABASE=wpdb<br/>MYSQL_USER=wpuser<br/>MYSQL_PASSWORD=&lt;password&gt;<br/>MYSQL_RANDOM_ROOT_PASSWORD=1</span></pre><p id="d44a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用强密码替换<code class="fe lv lw lx ly b">&lt;password&gt;</code>，并且必须匹配。注意，<code class="fe lv lw lx ly b">WORDPRESS_DB_HOST</code>是<code class="fe lv lw lx ly b">db</code>。这是Docker Compose服务名称，它为其内部DNS名称。</p><p id="f5ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还创建了<code class="fe lv lw lx ly b">wordpress</code>和<code class="fe lv lw lx ly b">data</code>目录，并在其中放了一个<code class="fe lv lw lx ly b">.gitignore</code>文件，这样Git会将它们添加到我的存储库中，当我将它们移到云中时，我就不必创建它们了，稍后您会看到。我不希望将这些目录中的文件签入存储库，所以这些目录中的<code class="fe lv lw lx ly b">.gitignore</code>文件看起来像这样:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="cba8" class="md me it ly b gy mf mg l mh mi"># Ignore all files in this dir...<br/>*</span><span id="eae5" class="md me it ly b gy mj mg l mh mi"># ... except for this one.<br/>!.gitignore</span></pre><p id="adc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成所有这些后，你可以用<code class="fe lv lw lx ly b">docker-compose up</code>再次启动WordPress。浏览至<code class="fe lv lw lx ly b"><a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/</a></code>，浏览两个设置屏幕，再次进入主管理屏幕。打开一个新的终端模拟器窗口，您可以看到<code class="fe lv lw lx ly b">data</code>和<code class="fe lv lw lx ly b">wordpress</code>目录现在被文件填满了。</p><p id="6044" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我打算玩玩我的新沙盒，尝试一些插件和主题，用我可以不费吹灰之力从头开始的知识。我会把脚本放到GitHub中，这样你就可以访问它们了，尽管现在只有一个脚本。</p><p id="67d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的下一篇文章中，我将带着我所拥有的，向你展示如何把它托管在互联网上。</p><div class="mm mn gp gr mo mp"><a href="https://github.com/rkamradt/wordpress/tree/v0.1" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd iu gy z fp mu fr fs mv fu fw is bi translated">rkamradt/wordpress</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">这将为你启动一个WordPress实例。你需要一个..带有…的/config/wordpress.env文件</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd ks mp"/></div></div></a></div></div></div>    
</body>
</html>