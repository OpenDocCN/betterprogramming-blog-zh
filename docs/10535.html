<html>
<head>
<title>A Comprehensive Guide to MLOps Terraform: Infrastructure As Code(IaC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MLOps平台综合指南:基础设施代码(IaC)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-comprehensive-guide-to-mlops-infrastructure-as-code-iac-ef4c97742351?source=collection_archive---------7-----------------------#2022-01-13">https://betterprogramming.pub/a-comprehensive-guide-to-mlops-infrastructure-as-code-iac-ef4c97742351?source=collection_archive---------7-----------------------#2022-01-13</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="0690" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用Terraform的GCP供应</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/7876bcdb462a2e989645d0f5f1af79da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ViMZuWNC6dIl0ZUu"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">安德里亚·莱奥帕尔迪在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="614b" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="d231" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Terraform是许多科技公司用来管理基础设施的工具之一。它正在成为IaC中的一个流行工具。它也是云不可知的，可以与任何云提供商合作。所以你可以和AWS、GCP、Azure、OCI等合作。我开始学习在我的个人项目中使用terraform。非常简单易学。它消除了所有手动活动。即使是一个小项目，也会节省很多时间。作为一名MLOps人员，您真的需要了解IaC吗？我觉得还是学的好。我将介绍地形的基本知识，并提供一些我在项目中使用的GCP对象。</p><p id="cb58" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在本文中，让我们看看如何使用terraform在ML项目中构建GCP对象。</p><h2 id="f95c" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">内容:</h2><ul class=""><li id="38a0" class="mu mv iu ly b lz ma mc md lj mw ln mx lr my mo mz na nb nc bi translated">什么是基础设施即代码(IaC)</li><li id="1c99" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">IaC的优势。</li><li id="56b1" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">命令式与声明式方法。</li><li id="5838" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">IaC的主要参与者。</li><li id="8cc6" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">将（行星）地球化（以适合人类居住）</li><li id="12c9" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">使用Terraform供应GCP对象</li></ul><h1 id="b440" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">什么是基础设施即代码(IaC)</h1><p id="8123" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">显示微软<strong class="ly iv">的</strong>文档</p><blockquote class="nt nu nv"><p id="7d77" class="lw lx nw ly b lz mp jv mb mc mq jy me nx mr mg mh ny ms mj mk nz mt mm mn mo in bi translated">基础设施即代码(IaC)是描述性模型中基础设施(网络、虚拟机、负载平衡器和连接拓扑)的管理，使用与DevOps团队用于源代码的版本相同的版本。就像相同的源代码生成相同的二进制文件一样，IaC模型每次应用时都会生成相同的环境。IaC是DevOps的一项关键实践，与持续交付结合使用。</p></blockquote><p id="a912" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">简而言之，您通过编写代码来配置基础架构，而不是手动配置。</p><div class="oa ob gq gs oc od"><a href="https://devops.stackexchange.com/questions/550/what-is-infrastructure-as-code" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fp"><div class="of ab og cl cj oh"><h2 class="bd iv gz z fq oi fs ft oj fv fx it bi translated">什么是“基础设施即代码”？</h2><div class="ok l"><h3 class="bd b gz z fq oi fs ft oj fv fx dk translated">TL；DR:代码形式的基础架构是自动化和备份您的环境的一种方式。在理想情况下，灾难过后，你…</h3></div><div class="ol l"><p class="bd b dl z fq oi fs ft oj fv fx dk translated">devops.stackexchange.com</p></div></div><div class="om l"><div class="on l oo op oq om or kt od"/></div></div></a></div><h1 id="a183" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">使用IaC的优势</h1><ul class=""><li id="d185" class="mu mv iu ly b lz ma mc md lj mw ln mx lr my mo mz na nb nc bi translated">速度</li><li id="f3d8" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">成本降低</li><li id="31d9" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">可重复性</li><li id="cf33" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">标准化</li><li id="0b19" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">可量测性</li><li id="b72f" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">一致性</li><li id="6188" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">避免人工干预-自动化</li><li id="9f93" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">可靠性</li><li id="ef9e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">版本管理-Gitops</li><li id="9441" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">安全性</li><li id="95ab" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">证明文件</li><li id="598f" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">更快的灾难恢复</li><li id="a6bd" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">CICD一体化</li></ul><div class="oa ob gq gs oc od"><a href="https://stackoverflow.com/questions/1077412/what-is-an-idempotent-operation" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fp"><div class="of ab og cl cj oh"><h2 class="bd iv gz z fq oi fs ft oj fv fx it bi translated">什么是幂等运算？</h2><div class="ok l"><h3 class="bd b gz z fq oi fs ft oj fv fx dk translated">在计算中，一个幂等运算是一个没有额外效果的运算，如果用相同的…</h3></div><div class="ol l"><p class="bd b dl z fq oi fs ft oj fv fx dk translated">stackoverflow.com</p></div></div><div class="om l"><div class="os l oo op oq om or kt od"/></div></div></a></div><h1 id="8f87" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">命令式与陈述式</h1><p id="752a" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">有两种方法可以编写代码。</p><ul class=""><li id="382d" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">命令式方法</li><li id="3445" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">陈述方法</li></ul><h2 id="fbfc" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">命令式方法</h2><ul class=""><li id="e7c9" class="mu mv iu ly b lz ma mc md lj mw ln mx lr my mo mz na nb nc bi translated">开发人员定义要执行的确切步骤。</li><li id="7845" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">系统遵循代码中的指令。</li></ul><h2 id="0efa" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">声明式方法</strong></h2><ul class=""><li id="a8a8" class="mu mv iu ly b lz ma mc md lj mw ln mx lr my mo mz na nb nc bi translated">开发人员定义所需的最终状态。</li><li id="0552" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">平台或系统处理实现最终状态所需的步骤。</li></ul><p id="ed66" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">查看<a class="ae kz" href="https://stackoverflow.com/questions/1784664/what-is-the-difference-between-declarative-and-imperative-paradigm-in-programmin" rel="noopener ugc nofollow" target="_blank">这篇StackOverflow帖子</a>和<a class="ae kz" href="https://codeburst.io/declarative-vs-imperative-programming-a8a7c93d9ad2" rel="noopener" target="_blank">这篇文章</a>，了解命令式和声明式方法之间的差异。</p><p id="00f7" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">Terraform使用声明式方法。</p><p id="413d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">IaC的主要参与者有</p><ul class=""><li id="01d2" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">将（行星）地球化（以适合人类居住）</li><li id="a173" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Ansible</li><li id="5489" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">自动气象站云的形成</li><li id="330a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">谷歌云部署管理器</li><li id="3ddf" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Azure资源管理器</li><li id="f708" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">木偶</li><li id="e078" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">盐堆</li><li id="7b99" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">厨师</li></ul></div><div class="ab cl ow ox hy oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="in io ip iq ir"><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pd"><img src="../Images/bd23058a7f5acc5fd3273ff919e875ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xt1ispxUFnS8CZ1dw4rMKg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图像信用哈希公司文档</p></figure><h1 id="7fc1" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">将（行星）地球化（以适合人类居住）</h1><p id="f3f0" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">根据哈希公司的文件-</p><blockquote class="nt nu nv"><p id="3556" class="lw lx nw ly b lz mp jv mb mc mq jy me nx mr mg mh ny ms mj mk nz mt mm mn mo in bi translated">Terraform是一个基础设施代码(IaC)工具，允许您安全高效地构建、更改和版本化基础设施。这包括计算实例、存储和网络等低级组件，以及DNS条目、SaaS功能等高级组件。Terraform可以管理现有的服务提供商和定制的内部解决方案。</p></blockquote><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pe"><img src="../Images/c8f76559359c7101dbc1ee6dd9f75cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATNMu1nQTnIXauJYXlDDGw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图像信用哈希公司文档</p></figure><ul class=""><li id="d3be" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">Terraform是一个IaC工具。</li><li id="1eeb" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform最近很受欢迎，许多科技公司都在使用它。</li><li id="ba87" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform是用Golang写的。</li><li id="19b4" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform是开源的。</li><li id="6e97" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform是一个云无关的工具。</li><li id="02d3" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform与提供者的API一起工作。根据Terraform的文档，到目前为止，它可以与1700多家提供商合作。</li><li id="1a29" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform使用声明式方法。</li><li id="d252" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform使用一种叫做Hashicorp标记语言或HCL的语言。</li><li id="1a59" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">开发人员创建所需状态的配置文件。</li></ul><p id="1dfd" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">例如，您想要3 kubernetes集群并创建配置文件。</p><p id="37fa" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">然后，Terraform将创建3个kubernetes集群，并创建一个状态文件。</p><p id="6386" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在您只需要2个kubernetes集群。然后修改配置文件，说我只需要2个GKE集群。</p><p id="eacb" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">Terraform使用状态文件检查配置文件，并删除第三个kubernetes集群。</p><p id="d573" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在您需要4个kubernetes集群。再次对配置文件进行更改。Terraform使用配置文件检查状态文件，并创建另外两个kubernetes集群。</p><p id="94ba" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">因此，您只需通过配置文件提供最终状态，Terraform就会知道如何获得最终状态。这就是terraform的妙处。这和kubernetes差不多。您可以定义副本的数量，比如您想要运行多少个pods(应用程序的数量),然后kubernetes会自行处理。</p><p id="15e1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">Terraform的另一个重要部分叫做provider。Terraform是一个云无关的工具。您可以在任何云提供商中创建基础架构，如AWS、GCP、Azure或Oracle Cloud等。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pf"><img src="../Images/e65322762032ce52f9e65f26d21afddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhdyIRJ-r7UXldULQtfq1Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图像信用哈希公司-地形文件</p></figure><p id="57fb" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">截至目前terraform有<code class="fe pg ph pi pj b">1781 providers</code> <strong class="ly iv">。</strong></p><ul class=""><li id="4127" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">terraform的主要重要特性是，您可以使用一个配置文件在多个云提供商中创建基础架构。例如，使用云形成，你只能在AWS中创建，而使用terraform，你可以在AWS、GCP、Azure等单一配置文件中创建。</li></ul><div class="oa ob gq gs oc od"><a href="https://www.terraform.io/intro/vs" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fp"><div class="of ab og cl cj oh"><h2 class="bd iv gz z fq oi fs ft oj fv fx it bi translated">Terraform与其他软件| Terraform，HashiCorp</h2><div class="ok l"><h3 class="bd b gz z fq oi fs ft oj fv fx dk translated">搜索Terraform文档Terraform提供了资源和提供者的灵活抽象。这种模式允许…</h3></div><div class="ol l"><p class="bd b dl z fq oi fs ft oj fv fx dk translated">www.terraform.io</p></div></div><div class="om l"><div class="pk l oo op oq om or kt od"/></div></div></a></div><p id="785d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">要开始学习terraform，请参考这些文档和教程:</p><ul class=""><li id="ef3a" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><a class="ae kz" href="https://learn.hashicorp.com/terraform?utm_source=terraform_io" rel="noopener ugc nofollow" target="_blank">地形教程——哈希公司学习</a></li><li id="77f2" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://cloud.google.com/docs/terraform" rel="noopener ugc nofollow" target="_blank">通过谷歌云使用Terraform】</a></li><li id="01a8" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://docs.oracle.com/en-us/iaas/developer-tutorials/tutorials/tf-simple-infrastructure/01-summary.htm" rel="noopener ugc nofollow" target="_blank">使用OCI地形建立简单的基础设施</a></li><li id="dd20" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://docs.oracle.com/en-us/iaas/developer-tutorials/tutorials/tf-simple-infrastructure/01-summary.htm" rel="noopener ugc nofollow" target="_blank">使用OCI Terraform建立简单的基础设施</a></li><li id="3a8a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://docs.microsoft.com/en-us/azure/developer/terraform/" rel="noopener ugc nofollow" target="_blank">Azure文档上的terra form</a></li><li id="d3a5" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://aws.amazon.com/blogs/apn/using-terraform-to-manage-aws-programmable-infrastructures/" rel="noopener ugc nofollow" target="_blank">使用Terraform管理AWS可编程基础设施</a></li></ul></div><div class="ab cl ow ox hy oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="in io ip iq ir"><h1 id="ec0b" class="ni lb iu bd lc nj pl nl lf nm pm no li ka pn kb lm kd po ke lq kg pp kh lu ns bi translated">使用Terraform供应GCP</h1><p id="df02" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">让我们使用Terraform来提供以下内容</p><ul class=""><li id="5227" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">创建一个谷歌云存储桶。</li><li id="0fe1" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">为ML培训创建一个笔记本实例。</li><li id="3778" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">启用所需的API。</li><li id="ee4e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">为顶点训练和顶点管道创建服务帐户。</li><li id="a656" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">创建一个GKE集群来部署ML应用程序。</li></ul><p id="13a7" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">只需观看Hashicorp培训视频或youtube视频，然后开始做以下步骤。不然就有点难以理解了。同样，terraform是最容易学习和实现的工具之一。</p><ol class=""><li id="8017" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo pq na nb nc bi translated">登录到GCP控制台。</li><li id="4e30" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated">创建一个项目。最好创建一个新的项目ID。因为您可以创建项目中的所有资源，然后销毁这些资源。因此，您不会为您创建的任何资源付费。</li><li id="d3da" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated">打开云壳。</li></ol><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pr"><img src="../Images/5004d0848d6f94f542b67ff6f01c3b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBszhfYNC1aiSYF2dYyfog.png"/></div></div></figure><p id="cd77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">4.文件结构:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ps"><img src="../Images/d67a7fef20f031f319af4fbb2effa6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Df9kpSED1cc6rUMpUiYCLA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="dd75" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">我有以下文件:</p><ul class=""><li id="74dc" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/gcs-bucket.tf" rel="noopener ugc nofollow" target="_blank">gcs-bucket.tf</a></code></li><li id="cada" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/gke.tf" rel="noopener ugc nofollow" target="_blank">gke.tf</a></code></li><li id="b8e1" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/main.tf" rel="noopener ugc nofollow" target="_blank">main.tf</a></code></li><li id="448d" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/notebook-instance.tf" rel="noopener ugc nofollow" target="_blank">notebook-instance.tf</a></code></li><li id="685b" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/service-accounts.tf" rel="noopener ugc nofollow" target="_blank">service-accounts.tf</a></code></li><li id="634e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/services.tf" rel="noopener ugc nofollow" target="_blank">services.tf</a></code></li><li id="86ac" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/terraform.tfvars" rel="noopener ugc nofollow" target="_blank">terraform.tfvars</a></code></li><li id="bced" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><a class="ae kz" href="https://github.com/esenthil2018/Terraform-GCP/blob/main/provision/variables.tf" rel="noopener ugc nofollow" target="_blank">variables.tf</a></code></li></ul><p id="2c6c" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">terraform文件结构如上。</p><ul class=""><li id="2b1a" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">Terraform语言的代码存储在文件扩展名为<code class="fe pg ph pi pj b">.tf</code>的纯文本文件中。还有一种基于JSON的语言变体，以文件扩展名<code class="fe pg ph pi pj b">.tf.json</code>命名。</li><li id="9e85" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><em class="nw">模块</em>是保存在一个目录中的<code class="fe pg ph pi pj b">.tf</code>和/或<code class="fe pg ph pi pj b">.tf.json</code>文件的集合。Terraform模块仅由目录中的顶层配置文件组成；嵌套目录被视为完全独立的模块，不会自动包含在配置中。</li><li id="bf71" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">main.tf</code>:包含局部变量、模块和资源定义。</li><li id="0948" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">data.tf</code>:包含<code class="fe pg ph pi pj b">main.tf</code>中使用的输入数据的数据资源。</li><li id="ec2c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">outputs.tf</code>:包含来自<code class="fe pg ph pi pj b">main.tf</code>中创建的资源的输出。</li><li id="84b8" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">providers.tf</code>:包含提供商和提供商版本定义。这里我们使用<code class="fe pg ph pi pj b">main.tf file</code>中的提供商信息。</li><li id="38f4" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">variables.tf</code>:包含<code class="fe pg ph pi pj b">main.tf</code>中使用的变量(即输入或参数)的声明。</li><li id="4d67" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">terraform.tfvars</code>文件包含分配给变量的值。</li><li id="487e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">例如<code class="fe pg ph pi pj b">variables.tf</code>包含</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><p id="0088" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">tfvars</code>文件包含该值</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><p id="522f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">我们为存储桶、笔记本实例、GKE集群创建、服务帐户创建和启用API提供了单独的tf文件。Terraform在按字母顺序指定的目录中加载所有配置文件。</p><p id="a72d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://stackoverflow.com/questions/58001764/how-to-split-a-terraform-file-main-tf-in-several-files-no-modules" rel="noopener ugc nofollow" target="_blank">这个StackOverflow问题</a>讨论了为什么我们可以为每个配置使用不同的tf文件，而不是使用<code class="fe pg ph pi pj b">main.tf</code>文件中的所有配置。</p><p id="152b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">Terraform文档中的一些重要语法</p><ul class=""><li id="e829" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">行注释以<code class="fe pg ph pi pj b">#</code>开始</li><li id="80a1" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">多行评论用<code class="fe pg ph pi pj b">/*</code>和<code class="fe pg ph pi pj b">*/</code>包裹</li><li id="282b" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">用<code class="fe pg ph pi pj b">key = value</code>的语法赋值(空格无关紧要)。该值可以是任何原语(字符串、数字、布尔值)、列表或映射。</li><li id="f372" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">字符串用双引号括起来。</li><li id="8737" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">字符串可以使用封装在<code class="fe pg ph pi pj b">${}</code>中的语法插入其他值，比如<code class="fe pg ph pi pj b">${var.foo}</code>。</li><li id="37ce" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">多行字符串可以使用shell风格的“here doc”语法，字符串以类似标记的<code class="fe pg ph pi pj b">&lt;&lt;EOF</code>开始，然后在单独的一行上以<code class="fe pg ph pi pj b">EOF</code>结束。字符串和结束标记的行必须<em class="nw">而不是</em>缩进。</li><li id="023c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">数字被假定为基数为10。如果一个数字的前缀为，它将被视为十六进制数字。</li><li id="1c76" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">布尔值:<code class="fe pg ph pi pj b">true</code>，<code class="fe pg ph pi pj b">false</code>。</li><li id="dd07" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">可以用方括号(<code class="fe pg ph pi pj b">[]</code>)列出基本类型。例:<code class="fe pg ph pi pj b">["foo", "bar", "baz"]</code>。</li><li id="a819" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">地图可以用大括号(<code class="fe pg ph pi pj b">{}</code>)和冒号(<code class="fe pg ph pi pj b">:</code> ): <code class="fe pg ph pi pj b">{ "foo": "bar", "bar": "baz" }</code>。键上的引号可以省略，除非键以数字开头，在这种情况下需要引号。对于单线映射，键/值对之间需要逗号。在多行映射中，键/值对之间的新行就足够了。</li></ul><p id="fdfb" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">更多请参考<a class="ae kz" href="https://www.terraform.io/language/configuration-0-11/interpolation" rel="noopener ugc nofollow" target="_blank">插值语法</a>。</p><ul class=""><li id="f33d" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><code class="fe pg ph pi pj b"><strong class="ly iv">{ }</strong></code> <strong class="ly iv"> </strong>用于定义块。</li></ul><p id="c679" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">让我们深入研究一下文件。</p><ul class=""><li id="6523" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">您可以拥有一个<code class="fe pg ph pi pj b">.tf</code>文件或多个<code class="fe pg ph pi pj b">.tf</code>文件。我为GKE创建了一个<code class="fe pg ph pi pj b">tf</code>文件，为存储云桶创建了一个<code class="fe pg ph pi pj b">tf</code>文件，为服务帐户创建了一个<code class="fe pg ph pi pj b">tf</code>文件，为note实例创建了一个<code class="fe pg ph pi pj b">tf</code>文件。</li></ul><p id="4c3b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">Main.tf</code><strong class="ly iv">:T21</strong></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><p id="8e79" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">这主要包含提供商信息。</p><ul class=""><li id="6722" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">提供程序在提供程序块中定义。它以关键字“提供者”开始。这里我们的提供者是google-provider <code class="fe pg ph pi pj b">“google” { project = var.project_id }</code> <strong class="ly iv"> <em class="nw">。</em>T25】</strong></li><li id="85ed" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">当您执行terraform init时，它会自动下载google provider。</li><li id="d0d4" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以参考Hasicorp网站上提供者的完整列表。上面的链接我已经给了。</li><li id="ca47" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">terraform将提供程序存储在项目文件夹中。它会创建一个名为terraform的特殊文件夹。</li><li id="5ab2" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">格式是<code class="fe pg ph pi pj b">terraform-provider-&lt;NAME&gt;_vX.Y.Z</code>。</li><li id="bffe" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">当您运行terraform init时，terraform会检查文件夹中是否已有该版本。如果没有，它就下载它。</li><li id="1b95" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">我们还在terraform块中<code class="fe pg ph pi pj b">required_providers</code>块。在这个块中，我们可以限制哪个版本可以工作。</li></ul><p id="e86a" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">Variables.tf</code> <strong class="ly iv"> : </strong></p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><p id="3363" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">上面的<code class="fe pg ph pi pj b">variables.tf</code>只是包含了你在项目中使用的变量。</p><ul class=""><li id="7492" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">使用variable命令声明变量。</li><li id="8a77" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后用双引号指定变量的名称。</li><li id="8a06" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">描述是可选的。</li><li id="e59e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">不需要指定类型命令。但还是推荐。</li><li id="c88d" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">类型约束允许您指定变量的类型。有三种简单的类型:字符串、数字、布尔值。</li><li id="8af9" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">此外，还有其他类型约束，如list、set、tuple、map、object和any。</li><li id="7d72" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">字符串应该用引号声明。</li><li id="6913" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">该数字可以用引号或不带引号来声明。</li><li id="d41c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">为了在代码中使用一个<code class="fe pg ph pi pj b">variable</code>的值，我们使用语法<code class="fe pg ph pi pj b">var.&lt;variable_identifier&gt;</code>。比如我们这里应该是<code class="fe pg ph pi pj b">var.project_id</code>、<code class="fe pg ph pi pj b">var.region</code>等。</li><li id="f472" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">变量可以在不同的地方设置</li></ul><ol class=""><li id="b65b" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo pq na nb nc bi translated">作为环境变量—使用导出语句</li><li id="7cc2" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated">作为命令行标志— <code class="fe pg ph pi pj b">var</code></li><li id="bf13" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated">在文件中— <code class="fe pg ph pi pj b">tfvars</code>文件</li><li id="2237" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated">变量默认值—在<code class="fe pg ph pi pj b">variable.tf</code>文件中</li></ol><p id="f85b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">terraform.tvars</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><ul class=""><li id="c88e" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">terraform.tvars</code>是terraform使用的特殊文件名，用于标识在<code class="fe pg ph pi pj b">variables.tf</code>文件中创建的变量值。</li><li id="198e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">project_id = “mlops2022”</code>。你可以使用变量标识符然后等号(=)和变量的值。在这种情况下，<code class="fe pg ph pi pj b">project_id</code>是<code class="fe pg ph pi pj b">variable</code>，而<code class="fe pg ph pi pj b">mlops2022</code>是变量值。</li><li id="b777" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您也可以使用以<code class="fe pg ph pi pj b">.auto.tfvars</code>结尾的文件名。在这种情况下，如果你想为变量值赋值创建多个文件，那么你可以这样做。</li></ul><p id="dc0e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，您还需要了解一些其他概念。</p><p id="9552" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">数据来源:</strong></p><ul class=""><li id="56a4" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">数据源允许terraform使用当前项目之外的可用信息。</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><ul class=""><li id="e37a" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">数据源由<em class="nw">数据块</em>定义。</li><li id="6a16" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后指定对象的类型。在这种情况下，谷歌存储桶。</li><li id="c087" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后是数据源的名称。</li><li id="64ee" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后是已经存在的桶名-图像-存储</li><li id="bd94" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后是物体的名字——<code class="fe pg ph pi pj b">folder/butterfly01.jpg</code>。</li><li id="668a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">用<code class="fe pg ph pi pj b"><strong class="ly iv">{</strong></code>打开数据源块</li><li id="9e36" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">数据源块用<code class="fe pg ph pi pj b"><strong class="ly iv">}</strong></code>关闭。</li><li id="fd3f" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以在括号中指定对象的属性。有关每种对象类型的可用属性，请参考文档。</li></ul><p id="d800" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">产出:</strong></p><ul class=""><li id="d5cb" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">输出是在Terraform活动完成后显示terraform状态文件中的数据。</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><ul class=""><li id="4e2a" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">输出块以关键字output开始。那么输出的名称在这种情况下是“ip”。</li><li id="7a1a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后用<code class="fe pg ph pi pj b"><strong class="ly iv">{</strong></code> <strong class="ly iv">启动<code class="fe pg ph pi pj b">output</code> <strong class="ly iv"> </strong>挡。</strong>程序块以<code class="fe pg ph pi pj b"><strong class="ly iv">}</strong></code>结束。</li><li id="cabd" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后就可以使用value属性了。只有一个属性叫做<code class="fe pg ph pi pj b">value</code>。成功完成地形应用后，将显示值<code class="fe pg ph pi pj b">google_compute_instance.vm_instance.network_interface.0.network_ip</code>。</li></ul><p id="2c40" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">有关输出的更多信息，请参考文档。</p><p id="fa58" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">本地人:</strong></p><ul class=""><li id="229d" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">局部变量定义一次，可以多次使用。一个局部变量可以是一个固定的字符串，或者一个局部变量可以引用另一个表达式，就像另外两个局部变量一样。</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div></figure><ul class=""><li id="eebb" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">一个局部块应该以一个<code class="fe pg ph pi pj b">locals</code> <strong class="ly iv"> <em class="nw"> </em> </strong>关键字开始。</li><li id="02d8" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">然后用<code class="fe pg ph pi pj b"><strong class="ly iv">{</strong></code>启动<code class="fe pg ph pi pj b">output</code>块。街区以<code class="fe pg ph pi pj b"><strong class="ly iv">}</strong></code>结束。</li><li id="aa71" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">第一个local是服务名，用' = '加上引号" forum "指定一个字符串。</li><li id="359a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">第二个local是所有者，用' = '分配一个带引号的字符串“Community Team”。</li><li id="169a" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">可以使用<code class="fe pg ph pi pj b">local.local_identifier</code>在代码中引用局部变量。</li><li id="62f9" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">本地值是由<code class="fe pg ph pi pj b">locals</code>块【复数】创建的<em class="nw">，但是你<em class="nw">将它们作为名为<code class="fe pg ph pi pj b">local</code>(单数)的对象的属性引用</em>。在引用本地值时，一定要去掉“s ”!</em></li><li id="0cd3" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">在这种情况下<code class="fe pg ph pi pj b">tags = local.common_tags</code>(应该是本地的而不是本地的)</li></ul><p id="c867" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">模块:</strong></p><ul class=""><li id="1aaa" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">模块更像是组织代码。</li><li id="a78c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以使用外部供应商提供的模块。可以使用AWS或Github等的模块。</li></ul><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><ul class=""><li id="8acf" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">您可以将代码作为一个模块再次重用。</li><li id="2bb7" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以从外部资源(如GitHub)或本地文件夹中使用该模块。</li><li id="1ac6" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以将参数传递给模块。</li><li id="5b49" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">您可以使用输出将值传递给调用模块。</li></ul><p id="7ae0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">还有一些其他的概念，比如<em class="nw">工作区和置备者</em>，我在这里没有涉及到。有关更多信息，请参考文档。</p><p id="4bdc" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">5.<strong class="ly iv">源库</strong>如下所示:</p><div class="oa ob gq gs oc od"><a href="https://github.com/esenthil2018/Terraform-GCP.git" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fp"><div class="of ab og cl cj oh"><h2 class="bd iv gz z fq oi fs ft oj fv fx it bi translated">GitHub-esenthil 2018/Terraform-GCP:使用terra form-GCP进行供应</h2><div class="ok l"><h3 class="bd b gz z fq oi fs ft oj fv fx dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ol l"><p class="bd b dl z fq oi fs ft oj fv fx dk translated">github.com</p></div></div><div class="om l"><div class="pv l oo op oq om or kt od"/></div></div></a></div><p id="283d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在把文件复制到GCP:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><ul class=""><li id="27ad" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">将变量设置为GitHub存储库。</li><li id="b616" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">设置本地目录变量。</li><li id="077c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">get</code>从git子目录中获取远程包，并将其写入新的本地目录。</li><li id="feb3" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">kpt pkg get REPO_URI[.git]/PKG_PATH[@VERSION] [LOCAL_DEST_DIRECTORY] [flags]</code></li></ul><p id="f140" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在文件被复制到GCP:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pw"><img src="../Images/2d3739c11c910afff65381541dae409b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sOmt57h9sBuDaCS3PqU0Yg.png"/></div></div></figure><p id="53f0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">6.现在我们需要开始创建基础设施。在此之前，让我们看看terraform的工作流程。</p><p id="f9da" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">请观看YouTube视频，然后查看。tf文件。然后你就会了解提供者、资源、输出、变量、数据源等。</p><p id="bc82" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">主要的标准工作流程是:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj px"><img src="../Images/d9d7bbad786ddeb7285383dad24289f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*vdE5kEqK2Lg7ArkqJ05Aag.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="b8b7" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">这是我的工作流程。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj py"><img src="../Images/f02f146195a7a135ec3717a6fd5f222b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*E-6uwKxZe5J32UV8hWwDPg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><h2 id="bbb0" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">地形初始化:</h2><p id="766d" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Terraform init是您需要执行的第一个命令。这是强制性的。Terraform init将下载与提供者相关的所有插件。在我们的情况下，它是GCP。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pz"><img src="../Images/fb7087ffacbdb513ed5271a481c52ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhyGM67u26LUNKKL7Opn2w.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="4c58" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">查看terra form<code class="fe pg ph pi pj b"><a class="ae kz" href="https://www.terraform.io/cli/commands/init" rel="noopener ugc nofollow" target="_blank">init</a></code><a class="ae kz" href="https://www.terraform.io/cli/commands/init" rel="noopener ugc nofollow" target="_blank">docs</a><strong class="ly iv"/>以了解关于该命令的更多信息。</p><h2 id="98fd" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Terraform验证:</h2><p id="d795" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated"><code class="fe pg ph pi pj b">terraform validate</code>命令验证目录中的配置文件，只引用配置，不访问任何远程服务，比如远程状态、提供者API等。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qa"><img src="../Images/99dc597f236ddb25fb6bdcede6a876db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYkSbcprgC5UTuJTf2K4QQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="4d6f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">检查像</p><ul class=""><li id="d338" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">未声明的变量</li><li id="131e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">多次声明的提供程序</li><li id="db50" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">无效的模块名称</li><li id="fa6f" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">多次声明的资源</li></ul><h2 id="aa31" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">地形图</h2><p id="a3a4" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">根据hashicorp文档,<code class="fe pg ph pi pj b">terraform plan</code>命令创建一个执行计划，让您预览Terraform计划对您的基础架构进行的更改。默认情况下，当Terraform创建平面图时，它:</p><ul class=""><li id="a0f6" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">读取任何已存在的远程对象的当前状态，以确保Terraform状态是最新的。</li><li id="be3f" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">将当前配置与先前状态进行比较，并记录任何差异。</li><li id="ee33" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">建议一组更改操作，如果应用这些操作，将使远程对象与配置相匹配。</li></ul><p id="bdec" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">您可以使用<code class="fe pg ph pi pj b">-out</code>参数将该计划保存到文件中。你可以使用<code class="fe pg ph pi pj b">terraform plan -out mlops</code>命令将其保存到一个名为mlops的文件中。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qb"><img src="../Images/8c635cd71ab0232d670c3f07653956de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n26tg_7KMXLcRJr82tBzRA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="95b0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">对于地形图，申请和销毁将要求确认。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qc"><img src="../Images/62be16c4de50b55a8e54a9b9b0420a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZHIgjAdRu4GdkXLb6coMzg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="044d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">它说计划:将添加39个对象。</p><h2 id="ce63" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">地形应用:</h2><p id="5cd1" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">该命令执行地形图中提出的动作。</p><p id="a70e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">有两种方法可以执行terraform应用</p><ul class=""><li id="0c8c" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">不带任何参数执行terraform apply。在这种情况下，它将首先创建terraform计划，然后要求确认。如果你说是，那么执行计划。</li><li id="7258" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">使用<code class="fe pg ph pi pj b">terraform apply</code>的另一种方法是将您之前创建的已保存计划文件的文件名传递给它，在这种情况下，Terraform将在没有任何确认提示的情况下应用计划中的更改。</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qd"><img src="../Images/5cd721266e938ca98ea874b4b9f12ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z9eOdikJtMVFG2n3nRKT8Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="8eb6" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在它说terraform apply说增加了39个。所以在计划中，它说将增加39个。</p><p id="ccaa" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">terraform应用完成后，检查目录</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qe"><img src="../Images/14b4a012e60dda52db9bf9bbf6851f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*550GQl68jH1u5zNiMymahw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="2663" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在您会看到创建了两个新文件</p><ul class=""><li id="0826" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">terraform.tfstate file</code></li><li id="989e" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><code class="fe pg ph pi pj b">kubeconfig-production</code></li></ul><p id="b213" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv"> Terraform.tfstate文件<br/></strong>Terraform状态文件是terra form创建的文件。它存储了terraform从您提供的配置文件(如tf文件)中创建的所有资源。</p><p id="58b0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">每当删除一个资源时，它在状态文件下的相应条目也会被删除。Terraform还存储它创建的对象的依赖关系，并在状态文件中维护依赖关系。</p><p id="d53f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">terraform.tfstate.backup</code> <strong class="ly iv"> <em class="nw">中还有前一状态版本的备份文件。</em> </strong></p><p id="d733" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">Terraform状态文件在</p><ul class=""><li id="516d" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">地形图</li><li id="c274" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">地形应用</li><li id="7f7d" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">地形破坏</li></ul><p id="eb69" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">当您应用terraform apply时，会创建新的状态文件，然后旧的状态文件会作为备份写入。你可以像GitHub一样在你的版本控制系统中维护terraform状态文件。</p><p id="ee93" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">检查状态命令和下面备忘单中的所有命令:</p><ul class=""><li id="6087" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated"><a class="ae kz" href="https://acloudguru.com/blog/engineering/the-ultimate-terraform-cheatsheet" rel="noopener ugc nofollow" target="_blank">终极地形命令备忘单</a></li><li id="2c98" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><a class="ae kz" href="https://justinoconnor.codes/2021/09/06/the-essential-terraform-cheat-sheet/" rel="noopener ugc nofollow" target="_blank">基本地形说明书</a></li></ul><p id="782b" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">Kubeconfig-production</code> <strong class="ly iv"> : </strong></p><p id="d235" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><code class="fe pg ph pi pj b">kubeconfig-production</code> <strong class="ly iv"> </strong>是新创建的集群的kubeconfig。</p><p id="a7a8" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">使用以下命令检查GKE集群:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="pt pu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qf"><img src="../Images/b13c31dfcbe2ef49bd78a89e3d59bf80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBMUpvdc8L6PeX1hWPZizQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="fc3e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在，您可以看到GKE已经启动并运行了所有的running pods。</p><p id="65e2" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">所以检查你创建的所有对象</p><p id="f0d4" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">GCP储物桶:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ps"><img src="../Images/2e5670f527f2908e8815c0dd86e68eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b36Lg2zUFz4P2xU9J--dtg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="1792" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">GCP服务帐户:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qg"><img src="../Images/0978eac8ab3725c8f1dd9f81a71aa593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gS0f2gF0XwCRfGrGOtc_2Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="7a18" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">GCP启用的API:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qh"><img src="../Images/f5505e45c0b1de8ef5fa8d4434a93fcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFzQ-H18wfjVwQPutKsmJg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="f3f5" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">GCP GKE集群:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qi"><img src="../Images/0984a34f8791ace6401ddc022e9fc7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0tejCnL1GvUtC2dqyp_XA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="a9fc" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">关于Terraform <code class="fe pg ph pi pj b">apply</code>的更多信息可在文档中获得<a class="ae kz" href="https://www.terraform.io/cli/commands/apply" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="0ef6" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">地形破坏:</h2><p id="dd10" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Terraform destroy允许破坏创造的资源。</p><ul class=""><li id="ab66" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">没有任何参数的Terraform destroy销毁所有创建的资源。</li><li id="3682" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">带有<code class="fe pg ph pi pj b">-target</code>旗帜的地形摧毁允许我们摧毁特定的资源。</li><li id="3a06" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">在我们的例子中，<em class="nw">创建了39个资源</em>，我想删除所有的39个资源。因此，我使用terraform销毁。</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj qj"><img src="../Images/5cdeef26888a38edc48b3d5b2343963c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kakg5wGjvXWA-MP7N7MtJQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="cf34" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">所以所有创造出来的<em class="nw"> 39资源</em>都被销毁了。</p><p id="5223" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">所以重要的步骤是</p><ul class=""><li id="1dde" class="mu mv iu ly b lz mp mc mq lj ot ln ou lr ov mo mz na nb nc bi translated">地形初始化</li><li id="ec66" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform应用(运行计划并要求确认)</li><li id="3615" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">Terraform Destroy(如果你想摧毁所有创建的资源)。</li></ul><p id="9378" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">安装平台请参考<a class="ae kz" href="https://learn.hashicorp.com/tutorials/terraform/install-cli" rel="noopener ugc nofollow" target="_blank">此链接</a>。</p><h1 id="ba41" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">额外资源</h1><p id="01a6" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">1.如果你打算准备Terraform助理证书，这个YouTube视频是一个很好的开始:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="qk pu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">freecodecamp.org视频信贷</p></figure><p id="952d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">2.关于<a class="ae kz" href="https://brendanthompson.com/posts/2021/11/my-terraform-standards" rel="noopener ugc nofollow" target="_blank">地形标准</a>的不错的博客</p><p id="90af" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">3.从现有的<em class="nw">基础设施</em>生成地形文件的CLI工具(反向地形)</p><p id="8d35" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">4.<a class="ae kz" href="https://lachlanwhite.com/posts/terraform/10-11-2021-terraform-variables-a-standard/" rel="noopener ugc nofollow" target="_blank">地形变量标准</a></p><p id="3492" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">5.<a class="ae kz" href="https://github.com/easyawslearn/Terraform-Tutorial" rel="noopener ugc nofollow" target="_blank">地形实例</a></p><p id="1ce1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">6.<a class="ae kz" href="https://www.zero2devops.com/blog/ultimate-guide-to-terraform" rel="noopener ugc nofollow" target="_blank">地形零到英雄</a></p><h1 id="d84d" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">结论</h1><p id="49c4" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">同样，terraform是一个非常有用的学习和使用工具。terraform文档本身是一个很好的起点。另外，看看我上面提到的YouTube视频。Pluralsight、Udemy和Coursera都有不错的课程。去看看吧。</p><p id="26e6" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">尝试在你工作的云提供商如AWS或GCP或Azure中自动创建资源。这将是一个有趣的项目。祝你好运！</p><h1 id="5385" class="ni lb iu bd lc nj nk nl lf nm nn no li ka np kb lm kd nq ke lq kg nr kh lu ns bi translated">参考</h1><ol class=""><li id="0fb5" class="mu mv iu ly b lz ma mc md lj mw ln mx lr my mo pq na nb nc bi translated"><a class="ae kz" href="https://github.com/GoogleCloudPlatform/mlops-with-vertex-ai" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/mlops-with-vertex-ai</a></li><li id="e6ba" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://github.com/hashicorp/terraform-provider-google" rel="noopener ugc nofollow" target="_blank">https://github.com/hashicorp/terraform-provider-google</a></li><li id="1e5c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://github.com/terraform-google-modules" rel="noopener ugc nofollow" target="_blank">https://github.com/terraform-google-modules</a></li><li id="4826" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://learnk8s.io/terraform-gke" rel="noopener ugc nofollow" target="_blank">https://learnk8s.io/terraform-gke</a></li><li id="5497" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://www.terraform.io/docs" rel="noopener ugc nofollow" target="_blank">https://www.terraform.io/docs</a></li><li id="4bc6" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://learn.hashicorp.com/terraform" rel="noopener ugc nofollow" target="_blank">https://learn.hashicorp.com/terraform</a></li><li id="c741" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://docs.microsoft.com/en-us/azure/developer/terraform/" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-us/azure/developer/terraform/</a></li><li id="13d1" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://cloud.google.com/docs/terraform" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/docs/terraform</a></li><li id="4d7b" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://github.com/upgundecha/howtheysre" rel="noopener ugc nofollow" target="_blank">https://github.com/upgundecha/howtheysre</a></li><li id="000c" class="mu mv iu ly b lz nd mc ne lj nf ln ng lr nh mo pq na nb nc bi translated"><a class="ae kz" href="https://github.com/bridgecrewio/checkov" rel="noopener ugc nofollow" target="_blank">https://github.com/bridgecrewio/checkov</a></li></ol><pre class="kk kl km kn gu ql pj qm qn aw qo bi"><span id="eb48" class="la lb iu pj b gz qp qq l qr qs"><strong class="pj iv">Want to Connect?</strong></span><span id="1e2d" class="la lb iu pj b gz qt qq l qr qs">Please feel free to connect with me on <a class="ae kz" href="http://linkedin.com/in/esenthil" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></span></pre></div></div>    
</body>
</html>