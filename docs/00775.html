<html>
<head>
<title>Angular: Simple Ionic Tabs App with Child Routes &amp; Protected Routes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:带有子路线和受保护路线的简单离子标签应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/simple-ionic-tabs-app-with-child-routes-protected-routes-2a8c05e57c4b?source=collection_archive---------9-----------------------#2019-07-11">https://betterprogramming.pub/simple-ionic-tabs-app-with-child-routes-protected-routes-2a8c05e57c4b?source=collection_archive---------9-----------------------#2019-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c0a5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Ionic Framework版本4在基于选项卡的应用程序中保护路由和处理子路由</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/69c3321fe55638211a2ebdeb2da97ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTbwQjdOkgJ-4KpyyPGCkA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@parktroopers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">公园巡警</a>在<a class="ae ky" href="https://unsplash.com/search/photos/kids?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="ba9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常看到发布的关于Ionic应用的两个问题是:</p><ol class=""><li id="7616" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我如何处理认证(受保护的路由)和</li><li id="c5d7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在Ionic中使用选项卡时，如何处理子路线？</li></ol><p id="e957" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我将尝试提出一个简单的基本解决方案，用下面的代码解决这两个问题。我只包含了解决上面列出的问题所必需的代码片段，但是完整的源代码可以在<a class="ae ky" href="https://github.com/aaronksaunders/ionicv4-tabs-with-detail" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="313a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mj">此示例代码基于Ionic Framework的v4。</em></p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/b8b02c1765f57a3cb74c650989fdff08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVUvv7TTwA8XjPiLPzcfpA.png"/></div></div></figure><h1 id="426e" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">受保护的路线</h1><p id="6d27" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">要获得受保护的路由，您需要能够确定用户的登录状态。为了使事情尽可能简单，我们创建了一个<code class="fe np nq nr ns b">AuthenticationService</code>，它有一个将状态设置为真或假的方法，以及一个获取当前登录状态的方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="dc02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来我们创建一个新的类，<code class="fe np nq nr ns b">AuthGuardService</code>，它实现了<code class="fe np nq nr ns b"><a class="ae ky" href="https://angular.io/api/router/CanActivate" rel="noopener ugc nofollow" target="_blank">CanActivate</a></code>接口。</p><p id="e248" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们所做的就是调用<code class="fe np nq nr ns b">AuthenticationService</code>来查看用户是否通过了身份验证。如果用户没有通过认证，那么我们将用户重定向到由路径<code class="fe np nq nr ns b">/login</code>定义的路由。我们通过构造一个<code class="fe np nq nr ns b">UrlTree</code>对象并返回它来实现，因为根据<code class="fe np nq nr ns b"><a class="ae ky" href="https://angular.io/api/router/CanActivate" rel="noopener ugc nofollow" target="_blank">CanActivate</a></code> <a class="ae ky" href="https://angular.io/api/router/CanActivate" rel="noopener ugc nofollow" target="_blank">文档</a>，我们可以从函数中返回一个<code class="fe np nq nr ns b">boolean</code>、<code class="fe np nq nr ns b">Promise</code>或<code class="fe np nq nr ns b">UrlTree</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="bf88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了告诉我们用户状态的<code class="fe np nq nr ns b">AuthenticationService</code>和在呈现路线之前用于检查的<code class="fe np nq nr ns b">AuthGuardService</code>，我们准备好更新<code class="fe np nq nr ns b">app-routing.module</code>。</p><p id="a692" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">见下文，我们将<code class="fe np nq nr ns b">AuthGuardService</code>添加到默认路线，这样当应用程序首次启动时，用户的身份验证状态将被验证。否则会重定向到<code class="fe np nq nr ns b">LoginPageModule</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="c31d" class="ms mt it bd mu mv nv mx my mz nw nb nc jz nx ka ne kc ny kd ng kf nz kg ni nj bi translated">选项卡中的子路线</h1><p id="798d" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">选项卡路由器模块在这里有一些魔力，可以处理默认路由，还可以正确处理子路由，以管理每个选项卡的导航堆栈。</p><p id="94b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">呈现的第一个组件是<code class="fe np nq nr ns b">TabsPage</code>，但是如您所见，该页面有子模块。第一个是<code class="fe np nq nr ns b">HomePageModule</code>，会渲染<code class="fe np nq nr ns b">HomePage</code>。</p><p id="dcf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.在下面代码段的底部，我们展示了如何处理选项卡模块的默认路由，将它重定向到home选项卡。</p><p id="2ef1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe np nq nr ns b">home</code>路径下的第二个路由定义演示了如何处理选项卡的子路由，或者呈现一个细节页面。我们已经定义了路径<code class="fe np nq nr ns b">detail</code>，我们使用完整路径<code class="fe np nq nr ns b">/tabs/home/detail</code>来访问它。</p><p id="2c44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.这将加载<code class="fe np nq nr ns b">DetailPageModule</code>，它将依次加载<code class="fe np nq nr ns b">DetailPage</code>，因为它是<code class="fe np nq nr ns b">DetailPageModule</code>中的默认路线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/c6426058288e7eb11062b7e6c2f26556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUBPhBdNS_kXZsi1jhDjAw.png"/></div></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="c533" class="ms mt it bd mu mv nv mx my mz nw nb nc jz nx ka ne kc ny kd ng kf nz kg ni nj bi translated">处理应用程序中的路线</h1><h2 id="4314" class="ob mt it bd mu oc od dn my oe of dp nc li og oh ne lm oi oj ng lq ok ol ni om bi translated"><strong class="ak">登录</strong></h2><p id="aa10" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">为了登录到应用程序，我们在<code class="fe np nq nr ns b">login.page.ts</code>文件中包含了以下代码。应用程序将首先调用注入的<code class="fe np nq nr ns b">AuthenticationService</code>来设置登录状态，然后导航到应用程序的默认路径。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="9cbe" class="ob mt it bd mu oc od dn my oe of dp nc li og oh ne lm oi oj ng lq ok ol ni om bi translated"><strong class="ak">注销</strong></h2><p id="0d51" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">为了注销应用程序，我们在<code class="fe np nq nr ns b">home.page.ts</code>文件中包含了以下代码。应用首先调用注入的<code class="fe np nq nr ns b">AuthenticationService</code>来设置登录状态，然后导航到应用的登录路径。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="a26d" class="ob mt it bd mu oc od dn my oe of dp nc li og oh ne lm oi oj ng lq ok ol ni om bi translated"><strong class="ak">详细页面</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d8059bf93c2815d23341bccbcc39e374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74lSl-VGFnXuoH5wp9qFAg.png"/></div></div></figure><p id="2c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了从<code class="fe np nq nr ns b">HomePage</code>选项卡导航子根，我们在页面中包含了以下代码；使用<code class="fe np nq nr ns b">ion-button</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="9fff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简洁起见，我没有在这篇文章中包括所有的源代码，但是GitHub repo在这里是<a class="ae ky" href="https://github.com/aaronksaunders/ionicv4-tabs-with-detail" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>