<html>
<head>
<title>3 Huge Mistakes Django Developers Make</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django开发人员犯的3个大错误</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-huge-mistakes-django-developers-make-9fe588540088?source=collection_archive---------1-----------------------#2021-08-01">https://betterprogramming.pub/3-huge-mistakes-django-developers-make-9fe588540088?source=collection_archive---------1-----------------------#2021-08-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b186" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以下是如何更好地优化Django代码的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/15bc53bd5b192324f1a7381dce5ba81d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39KV706btHXSLGOk0u-n-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">鸣谢:作者</p></figure><p id="46e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Django是一个非常有趣的框架，因为它允许你用python作为后端来创建web应用程序。不仅如此，它还可以处理大部分数据库的东西，这样我们就不用担心表了，至少对小应用程序来说是这样，我们可以专注于晚餐。</p><p id="83d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管Django是一个非常有用的框架，但它有一个陡峭的学习曲线，可能会吓到初学者，让他们无法自拔——我希望你能理解我的笑话。</p><p id="f46b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将向您介绍一些最好的Django特性和实践，让您的生活变得更加轻松。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="0791" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">1.重复模板代码</h1><p id="5d87" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">Django为您提供了许多不同的方法来重用您的代码，并使您的代码更加高效和可读。其中一个特性是Django的<strong class="la iu">模板标签和过滤器。</strong></p><p id="18d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它允许你在HTML文件中编写逻辑并显示相关数据。有许多<a class="ae my" href="https://docs.djangoproject.com/en/3.2/ref/templates/builtins/" rel="noopener ugc nofollow" target="_blank">内置的标签和过滤器</a>但是你也可以创建你自己的。</p><p id="8004" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个这样的标签是<code class="fe mz na nb nc b">include</code>，它允许我们重用我们的HTML。以下是我如何在我的网站上使用它:</p><div class="kj kk kl km gt ab cb"><figure class="nd kn ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ba3944d3ae5ea227ad414439b12f308c.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*23AchCr6G6PQbSJTW61hgw.png"/></div></figure><figure class="nd kn nj nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ba5d12efba1a51f4c028d9bd3b21ead7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*r2wd_Ylt_IawzDAlma1PZQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk nk di nl nm translated">左:我主页上的最新文章。右:我的文章页面上的所有文章</p></figure></div><p id="00f4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想在“主页”和“文章”页面上展示我的最新文章。</p><p id="9da5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于文章卡片的设计保持不变，解决这个问题的最好方法是创建一个通用的HTML，并使用include在两个页面上重用它。下面是它在代码中的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">index.html—显示文章的代码片段。我从views.py文件中获取文章数据</p></figure><p id="7110" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你在上面的代码中看到的，我正在遍历由<code class="fe mz na nb nc b">views.py</code>文件传递的所有文章，对于每一篇文章，它都在创建<code class="fe mz na nb nc b">{% include %}</code>来添加想要的HTML。(在下一个示例中，我们将看到views.py文件如何传递这些数据)使用include的语法如下所示:</p><pre class="kj kk kl km gt np nc nq nr aw ns bi"><span id="4d52" class="nt mc it nc b gy nu nv l nw nx">{% include “file_name” with argument_name=”some_argument” second_argument_name=”another_argument” %} </span></pre><p id="0949" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mz na nb nc b">with</code>关键字是可选的，当你需要向你的HTML传递参数时使用它。要传递字符串参数，把它放在<code class="fe mz na nb nc b">“”</code>里面，或者你也可以传递变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">article.html—所有文章卡片的通用HTML文件</p></figure><p id="8029" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以上代码是我的文章卡。在第一行，我使用<code class="fe mz na nb nc b">{% load static %}</code>来访问静态文件，即任何CSS、JS或图像文件。要使用从<code class="fe mz na nb nc b">include</code>标签传递的参数，您必须将参数名放在<code class="fe mz na nb nc b">{{}}</code>中，比如— <code class="fe mz na nb nc b">{{ argument_name }}</code></p><p id="71b9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是如何重用你的HTML。现在让我们看看基于类的视图，这些视图经常被忽略或者不为新的Django开发者所知。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="b5d5" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">2.使用基于功能的视图</h1><p id="1b49" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">首先，我想澄清一个误解，即基于类的观点(CBV)比基于功能的观点(FBV)更好:它们不是。</p><p id="cfe7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这取决于用例，两者各有优势。我在本文中添加了CBV，因为它们允许您删除代码中的冗余，而FBV经常会出现这种情况。所以，了解CBVs是有好处的。</p><p id="29ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你曾经创建过任何Django项目，你一定知道FBV。它们易于创建和阅读，但在可重用性方面就不那么好了。</p><p id="fb6e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Django为您提供了通用视图，您可以将其继承到自己的视图类中，并覆盖其内容。所以大部分东西都已经为你创建好了，你只需要定制它们来满足你的需求。以下是我在博客中使用它的方式。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">views.py文件的片段</p></figure><p id="ddda" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mz na nb nc b">ListView</code>是最常见的泛型类之一，用于列出数据库中的所有项目。要使用它，只需在您的<code class="fe mz na nb nc b">views.py</code>文件中创建一个类，并从<code class="fe mz na nb nc b"> django.views.generic import ListView</code>继承该类。</p><p id="ec59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在最简单的情况下，您只需要创建一个<code class="fe mz na nb nc b">model</code>变量，其他的事情都会处理好。默认的模板名称是<code class="fe mz na nb nc b">“model_name”_list.html</code>，但是当然你可以像我上面做的那样改变它。</p><p id="c4bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要进一步定制它，您可以覆盖这些函数。在我的例子中，我想按日期或标签对文章进行排序，然后将它们分成三个块，用于模板文件中的三个列。下面是如何在你的模板文件中使用<code class="fe mz na nb nc b">article_data</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">articles.html片段</p></figure><p id="a11a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在前面的例子中，我们看到了如何使用include重用模板。该模板从out <code class="fe mz na nb nc b">article_data</code>变量的<code class="fe mz na nb nc b">left</code> <code class="fe mz na nb nc b">right</code>和<code class="fe mz na nb nc b">middle</code>中获取数据。但是，不是这样。为了使用CBV，我们需要在我们的<code class="fe mz na nb nc b">urls.py</code>文件中做一件事。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为了简化这个例子，我编辑了我的urls.py文件</p></figure><p id="6c7b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先需要导入我们的类，然后用<code class="fe mz na nb nc b">.as_view()</code>函数在<code class="fe mz na nb nc b">urlpatterns</code>中使用它。这是因为Django的URL解析器希望将请求和参数发送给函数，而不是类。你只需要使用<code class="fe mz na nb nc b">.as_view()</code>函数，Django会处理剩下的事情。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="dd64" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">3.大型views.py文件</h1><p id="b5a1" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><code class="fe mz na nb nc b">views.py</code>文件包含了我们的大部分逻辑，因此它可以增长到数百行代码。这使得调试更加困难，代码更难阅读。以下是如何在不破坏代码的情况下破坏文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/6e7df281135d13e861702f637c386110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*hYUvSkyyobhbgjemBtuCfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">视图文件夹的屏幕截图</p></figure><p id="9051" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建一个名为views的文件夹，并在其中创建一个名为<code class="fe mz na nb nc b">__init__.py</code>的文件。现在，您可以分解views.py文件，并将它的每个类或函数放入不同的文件中。</p><p id="f781" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我的例子中，我为所有的cbv使用了<code class="fe mz na nb nc b">views_a.py</code>文件，并且为每个操作创建了更多的文件。</p><p id="40e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您已经将原始views.py文件中的函数和类拆分成多个文件，那么将这些文件中的所有内容导入到您的<code class="fe mz na nb nc b">__init__.py</code>文件中，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">__init__。巴拉圭</p></figure><p id="a051" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的例子中，我实际上不需要导入除了<code class="fe mz na nb nc b">views_a</code>以外的任何东西。这是因为我将在<code class="fe mz na nb nc b">urls.py</code>文件中使用的所有视图对象都在<code class="fe mz na nb nc b">views_a</code>中。</p><p id="8641" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，如果您将它们分成多个文件，您需要像上面显示的那样导入每个文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">urls.py</p></figure><p id="3525" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，输入<code class="fe mz na nb nc b">from .views import *</code>来导入所有的视图对象。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="d84f" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论</h1><p id="5e20" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">这一次到此为止！我希望它能让你的Django代码至少提高2倍。</p><p id="17ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nz">如有疑问或建议，可通过我的</em> <a class="ae my" href="https://y.at/%F0%9F%92%BB%F0%9F%8E%A5%E2%9C%8D%E2%98%95" rel="noopener ugc nofollow" target="_blank"> <em class="nz">社交</em> </a> <em class="nz">联系我。</em></p></div></div>    
</body>
</html>