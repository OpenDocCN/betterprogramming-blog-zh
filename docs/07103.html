<html>
<head>
<title>Building a Design System Package With Storybook, TypeScript, and React in 15 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在15分钟内用故事书、打字稿和反馈建立一个设计系统包</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-design-system-package-with-storybook-typescript-and-react-in-15-minutes-b5fd5711339e?source=collection_archive---------11-----------------------#2020-12-07">https://betterprogramming.pub/building-a-design-system-package-with-storybook-typescript-and-react-in-15-minutes-b5fd5711339e?source=collection_archive---------11-----------------------#2020-12-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8116" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">设计系统会让你更有效率，并帮助你更快地构建新的特性和组件</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/b2b432edae48aa7461e9648acdc5692c.png" data-original-src="https://miro.medium.com/v2/0*BuHz-C6Y61mnLOx5"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">尼尔斯·约翰·加布里埃尔森在<a class="ae ku" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的背景照片。</p></figure><p id="7ba6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当我为自己的工作构建一个UI组件库时，我在搜索如何创建一个简单的“正常工作”的工作流时遇到了一些棘手的问题。</p><p id="1980" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我看到的大多数关于TypeScript组件库的教程都使用了构建工具(这有时会引起麻烦)，而我目前的工作采取了相反的极端做法，将UI组件库发布为TypeScript，并依靠单个项目直接从库本身将其转换为JavaScript(如果你来自我的公司……你什么都没读过)。</p><p id="c52c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">本教程将向您展示如何设置一个<code class="fe lr ls lt lu b">create-react-app</code>项目来用TypeScript + Storybook创建组件，然后演示在另一个React项目中作为一个包使用的同一个设计系统。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3c21" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">UI组件库与设计系统</h1><p id="77aa" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">虽然这些对我来说可能是次要的语义，但是在组件库和设计系统的构成上有一些重要的区别，你可能想要深入研究和理解(除非你像我一样乐于一直被纠正)。</p><p id="d1bc" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">本质上，我们将创建一个简单的单组件UI组件库作为主要演示，但Storybook的安装将使我们能够标记编写原则、模式、语气等的指南。</p><p id="b748" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你更新这些指南的意愿(对于所有意图和目的来说)将把这个项目从一个简单的组件库带到能够交流构成“设计系统”定义的其他方面，如上所列。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f21a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="456e" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">我们将首先使用<code class="fe lr ls lt lu b">create-react-app</code>建立一个React项目，然后添加Storybook来帮助组件开发:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="dfa7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">因为我们将使用TypeScript进行构建，所以我使用<code class="fe lr ls lt lu b">copyfiles</code>来帮助我们复制TypeScript编译器不处理的文件类型(比如CSS文件、图像资源等等)。).这有助于我们保持构建工具尽可能简单。</p><p id="effe" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们将使用<code class="fe lr ls lt lu b">rimraf</code>作为一个简单的预构建清理来删除我们的输出文件夹(将是<code class="fe lr ls lt lu b">./lib</code>)。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="54ac" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">更新我们的Package.json配置</h1><p id="71e4" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">我们将向我们的<code class="fe lr ls lt lu b">package.json</code>文件添加一些元信息。在我的例子中，我将创建一个托管在GitHub上的私有npm包。</p><p id="8b6f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你可以看到一篇关于创建GitHub包的旧文章。否则，你想怎么发表就怎么发表！</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0140" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我还更新了构建脚本，以构建来自<code class="fe lr ls lt lu b">tsconfig.json</code>的配置。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="43cc" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">更新tsconfig.json</h1><p id="c75b" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">我们希望更新配置以发出文件和发出声明文件:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="45ba" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这里，我们已经更新了文件，删除了<code class="fe lr ls lt lu b">noEmit</code>，然后使用<code class="fe lr ls lt lu b">declaration</code>来发出声明文件。</p><p id="269d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这将确保我们创建的任何自定义类型都将在构建期间发出，以供其他支持TypeScript的库使用。</p><p id="96b5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="nb">注意:我们更新的</em> <code class="fe lr ls lt lu b"><em class="nb">package.json file</em></code> <em class="nb">包含对“构建”脚本的更改，该脚本使用TypeScript编译器而不是</em> <code class="fe lr ls lt lu b"><em class="nb">react-scripts</em></code> <em class="nb">。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9f44" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们通过故事书的第一个组成部分</h1><p id="a33c" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">运行<code class="fe lr ls lt lu b">npx sb init</code>将会为我们创建一个<code class="fe lr ls lt lu b">src/stories</code>文件夹来存放一些文件。</p><p id="9fee" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们将<code class="fe lr ls lt lu b">src/stories/Button.*.*</code>文件移动到<code class="fe lr ls lt lu b">src/components/Button</code>。</p><p id="f0b9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一旦完成，我们将把组件装桶出来。我们通过创建<code class="fe lr ls lt lu b">src/components/index.ts</code>来做到这一点。</p><p id="3579" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在<code class="fe lr ls lt lu b">src/components/index.ts</code>内，添加以下内容:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8a67" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">然后从我们的库中导出它，我们将创建一个文件<code class="fe lr ls lt lu b">src/main.ts</code>并添加以下内容:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="a029" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们在<code class="fe lr ls lt lu b">package.json</code>文件中的类型、主关键字和模块关键字行将指向创建的文件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="902d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">故事书的工作流程</h1><p id="6628" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">让我们添加<code class="fe lr ls lt lu b">src/components/Button/Button.stories.mdx</code>并添加一些基本的降价:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">把这个看作是原始的，以获得更好的想法。感谢gists将代码转换为markdown…</p></figure><p id="2801" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">虽然这是一个超级基本的例子，但它将创建一些交互式的降价，我们可以用它来记录用法，并添加到我们的“设计系统”指南和原则中。</p><p id="d5d3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在让我们运行<code class="fe lr ls lt lu b">yarn storybook</code>来启动故事书环境。</p><p id="6ba3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="nb">注意:你还需要调整</em> <code class="fe lr ls lt lu b"><em class="nb">src/stories/Header.tsx</em></code> <em class="nb">来确定</em> <code class="fe lr ls lt lu b"><em class="nb">Button</em></code> <em class="nb">从哪里导入。</em></p><p id="8412" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一旦Storybook启动并运行，您可以前往localhost端口查看一个<code class="fe lr ls lt lu b">Usage</code>部分，其中有我们关于使用按钮的注释(尽管样式糟糕且乏味),并且您可以在<code class="fe lr ls lt lu b">Examples/Button</code>下看到一些示例和使用组件本身的交互方式。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/87fa00fd0ed215a2dfbf7088bd24e75d.png" data-original-src="https://miro.medium.com/v2/0*hqyTd07MiRQp2-Ue"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/049785c5840ef1304f0e3e12535498e4.png" data-original-src="https://miro.medium.com/v2/0*P1Mf7u9j7b5NlPE0"/></div></figure><p id="75a4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">太神奇了！我们有一个开发组件的工作环境。</p><p id="fcab" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">此时，我将把故事书部分留在那里(这更像是概念性的证明)，然后继续发布库。Storybook有很多内容，但是从现在开始检查文档，以构建比我们上面所做的简单设置更进一步的内容。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8935" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">发布图书馆</h1><p id="8345" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">假设我们对我们的<code class="fe lr ls lt lu b">Button</code>很满意，并且它将构成我们难以置信的多功能组件库的唯一组件，那么让我们继续发布这个包吧！</p><p id="b926" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于我自己，我将运行以下内容:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="5d3a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这将把包构建到<code class="fe lr ls lt lu b">lib</code>文件夹中，然后为我发布到GitHub。这种配置和“为什么”的大部分来自我们之前在<code class="fe lr ls lt lu b">package.json</code>和<code class="fe lr ls lt lu b">tsconfig.json</code>做的设置。</p><p id="26e6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="nb">注意:如果您也发布到GitHub，请确保您在remote上创建了repo。对我来说，我通过运行</em> <code class="fe lr ls lt lu b"><em class="nb">gh repo create okeeffed/ds-pkg-blog-post --public -y</em></code> <em class="nb">使用GitHub CLI，然后推送到remote。您还需要确保您已经正确设置了</em> <code class="fe lr ls lt lu b"><em class="nb">.npmrc</em></code> <em class="nb">(无论是在本地项目中还是在全局范围内)。如果你不熟悉发布包，请查看我上面关于创建GitHub包的链接。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f394" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">试用新图书馆</h1><p id="e555" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">现在我们的包已经发布了，让我们开始另一个<code class="fe lr ls lt lu b">create-react-app</code>项目并安装我们的包:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0c67" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们更新<code class="fe lr ls lt lu b">src/App.tsx</code>以使用我们的新<code class="fe lr ls lt lu b">Button</code>:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="7259" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在这个项目中使用<code class="fe lr ls lt lu b">yarn start</code>运行我们的应用程序，并前往localhost将向我们展示我们正在使用的组件！单击该按钮也将注销我们的“单击”以查看所有操作。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/779158fe6730792d886e2e054fec7a1e.png" data-original-src="https://miro.medium.com/v2/0*-djTeiBCGMh2AoCd"/></div></figure><p id="85b3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">令人惊奇的是，我们仍然显示我们的类型安全，正如我们不提供标签时所证明的那样:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/f03b0d7a8b976069ff6d2671afd5c227.png" data-original-src="https://miro.medium.com/v2/0*6vfGAXRVGN3SOvef"/></div></figure><p id="6a17" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们也得到我们的类型建议，比如我们的道具(如VS代码所示):</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/7566308356af36f309b2644808a90022.png" data-original-src="https://miro.medium.com/v2/0*5aUZG9qFaaU1T8f0"/></div></figure><p id="0699" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">成功！我们已经从头到尾完成了我们的设计系统设置，并让它在另一个项目中作为类型安全包工作。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="35d2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="8e96" class="pw-post-body-paragraph kv kw it kx b ky mu ju la lb mv jx ld le mw lg lh li mx lk ll lm my lo lp lq im bi translated">今天的文章无论如何都不是完美的或包罗万象的，但是我很惊讶关于在没有遇到问题的情况下完成这一切的内容是如此之少。</p><p id="4488" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">拥有一个基本的TypeScript编译的解决方案对我来说非常有用，它是一个快速的开始，可以让事情一起工作，而不会有太多的差异或问题。</p><p id="4a2f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们已经从一个简单的<code class="fe lr ls lt lu b">create-react-app</code>命令发展到拥有一个支持开发和文档故事书的类型脚本设计系统。然后我们将它作为一个npm包发布在GitHub上，并最终在另一个项目中看到了它的运行——所有这些都在几分钟内完成。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cb8f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源和进一步阅读</h1><ol class=""><li id="5d22" class="nc nd it kx b ky mu lb mv le ne li nf lm ng lq nh ni nj nk bi translated"><a class="ae ku" href="https://uxdesign.cc/do-you-think-your-component-library-is-your-design-system-think-again-7e2c902b5275" rel="noopener" target="_blank">你以为你的元件库就是你的设计系统？再想想。</a></li><li id="15e0" class="nc nd it kx b ky nl lb nm le nn li no lm np lq nh ni nj nk bi translated"><a class="ae ku" href="https://blog.dennisokeeffe.com/blog/2020-07-05-your-first-github-npm-package-in-five-minutes/" rel="noopener ugc nofollow" target="_blank">5分钟后你的第一个GitHub npm包</a></li><li id="8795" class="nc nd it kx b ky nl lb nm le nn li no lm np lq nh ni nj nk bi translated"><a class="ae ku" href="https://github.com/okeeffed/ds-pkg-blog-post" rel="noopener ugc nofollow" target="_blank">在GitHub上完成打包</a></li><li id="22b3" class="nc nd it kx b ky nl lb nm le nn li no lm np lq nh ni nj nk bi translated"><a class="ae ku" href="https://github.com/okeeffed/ds-pkg-in-use" rel="noopener ugc nofollow" target="_blank">使用中的包的示例报告</a></li></ol></div></div>    
</body>
</html>