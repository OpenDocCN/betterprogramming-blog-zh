<html>
<head>
<title>Animating Shapes Using AnimatablePair in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中使用AnimatablePair制作形状动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/animating-shapes-using-animationpair-in-swiftui-cedbb227e4c6?source=collection_archive---------14-----------------------#2020-07-15">https://betterprogramming.pub/animating-shapes-using-animationpair-in-swiftui-cedbb227e4c6?source=collection_archive---------14-----------------------#2020-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bdf1" class="pw-subtitle-paragraph ju is it bd b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dk translated">将形状从正方形转换为三角形，然后再转换回来</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/9294dcd58bea0ad38ce85978d9bb493f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iPK4peYsPjOSxOtR"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">由<a class="ae lc" href="https://unsplash.com/@delilaziebart?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Delila Ziebart </a>在<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="a1f7" class="lk ll it bd lm ln lo lp lq lr ls lt lu kd lv ke lw kg lx kh ly kj lz kk ma mb bi translated">形状</h1><p id="51b9" class="pw-post-body-paragraph mc md it me b mf mg jy mh mi mj kb mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">我们可以从使用类型为<code class="fe jq jr js jt b">Shape</code>的结构和绘制并返回正方形的路径函数来制作正方形开始:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/6074f5963c038886b6ceb82c6f9a810e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*2ZTNCFtgoenofZapvDgpMA.png"/></div></figure><p id="b2d9" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">在我们的<code class="fe jq jr js jt b">ContentView</code>中，我们可以在一个<code class="fe jq jr js jt b">GeometryReader</code>中添加我们的形状。这将允许我们给我们的形状一个框架，这取决于我们的屏幕宽度。这将使我们的形状在肖像模式下的所有设备上看起来都一样。为了让我们的形状在风景模式下看起来更好，你可以使用<code class="fe jq jr js jt b">min</code>功能来查看宽度和高度哪个更小，然后使用最低值来调整框架。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/8325c9605aa5e6747da8dabbcc1e33d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*GRCrNB8QKIfXwiovRb7jlg.png"/></div></figure><p id="a600" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">当你运行代码时，你会发现我们的正方形。如果你想给正方形添加一个笔画，你可能会得到一个编译器错误(<code class="fe jq jr js jt b">“Value of type ‘some View’ has no member ‘stroke.’”</code>)为了避免这个错误，我们可以用一个笔画覆盖一个相同的形状:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/67d6c63c98c27391a5dda0b6eab44dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*mlpEP2NaA9q944ERYg-2hA.png"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="c858" class="lk ll it bd lm ln lo lp lq lr ls lt lu kd lv ke lw kg lx kh ly kj lz kk ma mb bi translated"><code class="fe jq jr js jt b">AnimatablePair</code></h1><p id="0661" class="pw-post-body-paragraph mc md it me b mf mg jy mh mi mj kb mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">现在我们可以将下面的代码片段添加到我们的形状中。这段代码将允许我们的形状通过逐渐改变<code class="fe jq jr js jt b">divideByValue</code>和<code class="fe jq jr js jt b">multiplyByValue</code>的值来制作动画。</p><p id="5962" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">例如，如果<em class="ne"> x </em> =1，那么当我们将它的值改为<em class="ne"> x </em> = 0时，该值将逐渐变化为0.9→0.8→0.7→0.6……→0.0。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/ce11020a827b1f49a8a9a249469beb27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*DG421H85JJ9nlSVZaBPK1w.png"/></div></figure><p id="8706" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">在我们的<code class="fe jq jr js jt b">ContentView</code>中声明两个状态变量，将它们传递给我们的形状。使<code class="fe jq jr js jt b">divideByValue</code> = 1，使<code class="fe jq jr js jt b">multiplyByValue</code> = 0。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/3b3f5405ba2f02928ad0e29bd8496ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*M16gDnNx2ah0qi2o6kd3XQ.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/79a77115dafd287ed46a3e1e2646b192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*xh2UBdKL5Qt7ju4urjuueg.png"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="0e74" class="lk ll it bd lm ln lo lp lq lr ls lt lu kd lv ke lw kg lx kh ly kj lz kk ma mb bi translated">动画</h1><p id="787d" class="pw-post-body-paragraph mc md it me b mf mg jy mh mi mj kb mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">我们为正方形添加的前两条路径线中的<em class="ne"> x </em>值如下:</p><pre class="kn ko kp kq gt nf jt ng nh aw ni bi"><span id="90c2" class="nj ll it jt b gy nk nl l nm nn">path.addLine(to: CGPoint(<strong class="jt iu">x: 0</strong>, y: rect.minY))<br/>path.addLine(to: CGPoint(<strong class="jt iu">x: rect.maxX</strong>, y: rect.minY))</span></pre><p id="14eb" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">要将我们的正方形形状改为三角形，我们需要将<em class="ne"> x </em>值改为<code class="fe jq jr js jt b">rect.maxX/2</code>:</p><pre class="kn ko kp kq gt nf jt ng nh aw ni bi"><span id="bc98" class="nj ll it jt b gy nk nl l nm nn">path.addLine(to: CGPoint(x: (rect.maxX / 2), y: rect.minY))<br/>path.addLine(to: CGPoint(x: (rect.maxX / 2), y: rect.minY))</span></pre><p id="9c7c" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">我们第一行的<em class="ne"> x </em>需要在<em class="ne"> x </em> = 0和<em class="ne"> x </em> = <code class="fe jq jr js jt b">rect.maxX /2</code> <strong class="me iu"> </strong>之间切换才能做出两种形状，我们第二行的<em class="ne"> x </em>值需要从<em class="ne"> x </em> = <code class="fe jq jr js jt b">rect.maxX</code>变为<strong class="me iu"> </strong> <code class="fe jq jr js jt b">rect.maxX /2</code>。</p><p id="c33f" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">用下面的代码替换我们的路径函数。我们将让<code class="fe jq jr js jt b">divideByValue</code>在1和2之间切换，让<code class="fe jq jr js jt b">multiplyByValue</code>在0和1之间切换:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/beef5f7a27b4629f90e3b441e44f2e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*fgwepa_Yvj_GhyRH5GLxgw.png"/></div></figure><p id="45fb" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">现在，我们添加一个按钮，它将改变我们在<code class="fe jq jr js jt b">ContentView</code>中声明的状态变量的值。按钮使用我们的<code class="fe jq jr js jt b">multiplyByValue</code>状态值在<code class="fe jq jr js jt b">Square</code>和<code class="fe jq jr js jt b">Triangle</code>之间切换文本:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/51b00ed8cc44813601731336b0021700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*o1wILZw84WyECW1DyyNvug.png"/></div></figure><p id="3afd" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">由于<code class="fe jq jr js jt b">multiplyByValue</code>在<code class="fe jq jr js jt b">withAnimation</code>里面，这将使我们的文本动画。我们不希望这种情况发生，因为它会在切换到单词<code class="fe jq jr js jt b">Triangle</code>之前显示<code class="fe jq jr js jt b">Tria…</code>。为了避免这种情况，我们可以声明一个布尔变量，并让它在按钮内的<code class="fe jq jr js jt b">withAnimation</code>之前改变它的值:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/60a9d76e99f5353ae2203ec6e1b70bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*ukB1WK678tdSaJ6ffbv-1A.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/573dded51080b6dd83326475fafbbb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*gTr9RHRRkqfx-xjC9GfbIw.png"/></div></figure><p id="aa4b" class="pw-post-body-paragraph mc md it me b mf mz jy mh mi na kb mk ml nb mn mo mp nc mr ms mt nd mv mw mx im bi translated">全部完成！您可以运行代码并查看形状动画:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/f7e24da3e952e9b671f9587b931ae75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/1*OMiGXogqhxko9IwpOTVIiQ.gif"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">使用<code class="fe jq jr js jt b">AnimatablePair</code>的形状动画示例</p></figure></div></div>    
</body>
</html>