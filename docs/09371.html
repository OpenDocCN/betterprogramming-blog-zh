<html>
<head>
<title>Build a Python Flask App To See the Places You’ve Travelled</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个Python Flask应用程序来查看您去过的地方</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-python-flask-app-to-see-the-places-youve-travelled-fee71e54ec0c?source=collection_archive---------7-----------------------#2021-08-16">https://betterprogramming.pub/build-a-python-flask-app-to-see-the-places-youve-travelled-fee71e54ec0c?source=collection_archive---------7-----------------------#2021-08-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="52cb" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用Python将您的旅行记忆钉在“这里”地图上</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/8f1efec506bd0f12053aaebaf1841477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vSDylmba8M91NrZ4"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@element5digital?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">元素5数码</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b66b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望你有一个愉快的暑假。难道你和你的朋友不会很高兴回忆起你们一起去过的地方吗？</p><p id="ddc6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这篇文章中，我将向您展示如何创建一个自定义地图，您可以在其中钉上您去过的所有地方的度假照片。您可以选择添加文字来更好地描述您的旅行记忆。</p><p id="1319" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我已经写了一篇<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/plan-your-holiday-with-python-and-here-maps-aaeeaf9580c3">教程</a>关于如何用<a class="ae kz" href="https://developer.here.com/" rel="noopener ugc nofollow" target="_blank">这里</a>的地图来计划你的假期。这个教程是独立的，所以你可以从这里开始，如果你感兴趣的话，可以稍后查看另一个。我们将重用一些技术，并应用更多的增强功能。最后，您将学习如何将您的应用程序部署到<a class="ae kz" href="https://heroku.com" rel="noopener ugc nofollow" target="_blank"> Heroku </a>，这样您的朋友也可以看到它。</p><p id="d1b0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p><h1 id="e839" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">创建项目</h1><h2 id="ed8c" class="mo lx iu bd ly mp mq dn mc mr ms dp mg lj mt mu mi ln mv mw mk lr mx my mm mz bi translated">要求</h2><p id="4d8c" class="pw-post-body-paragraph la lb iu lc b ld na jv lf lg nb jy li lj nc ll lm ln nd lp lq lr ne lt lu lv in bi translated">你需要什么:</p><ul class=""><li id="b9d4" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv nk nl nm nn bi translated">一些你假期拍的很棒的照片。</li><li id="51b9" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">你去过的地方的坐标。我们将使用<a class="ae kz" href="https://pypi.org/project/geopy/" rel="noopener ugc nofollow" target="_blank"> geopy </a> Python库来完成这项任务:</li></ul><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="9c09" class="mo lx iu nu b gz ny nz l oa ob">pip install geopy</span></pre><ul class=""><li id="34fc" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv nk nl nm nn bi translated"><a class="ae kz" href="https://pypi.org/project/Flask/" rel="noopener ugc nofollow" target="_blank"> Flask </a> —轻量级web应用框架:</li></ul><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="4d68" class="mo lx iu nu b gz ny nz l oa ob">pip install Flask</span></pre><ul class=""><li id="09f1" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv nk nl nm nn bi translated">这里是开发者账户。点击<a class="ae kz" href="https://developer.here.com/tutorials/getting-here-credentials/" rel="noopener ugc nofollow" target="_blank">此处</a>获取如何创建API密钥的说明。我们将需要这个来从我们的应用程序调用HERE地图。</li><li id="997f" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">Heroku account —该工具用于在云上构建和运行应用程序。目前，如果你不想要付费账户，你可以免费托管一个应用。</li></ul><h2 id="f5b9" class="mo lx iu bd ly mp mq dn mc mr ms dp mg lj mt mu mi ln mv mw mk lr mx my mm mz bi translated">编码部分</h2><ol class=""><li id="3c4b" class="nf ng iu lc b ld na lg nb lj oc ln od lr oe lv of nl nm nn bi translated">创建一个新的Python文件，例如<code class="fe og oh oi nu b">app_runner.py</code>，并粘贴以下代码:</li></ol><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oj ok l"/></div></figure><p id="b8b8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.在项目的文件夹中创建一个名为<code class="fe og oh oi nu b">templates</code>的新目录。在那个文件夹中创建<code class="fe og oh oi nu b">map.html</code>文件。</p><p id="2c71" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.粘贴以下内容:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oj ok l"/></div></figure><p id="f4ad" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这段代码最重要的部分是:</p><ul class=""><li id="b02a" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv nk nl nm nn bi translated">我们已经导入了渲染地图所需的脚本。</li><li id="d2f3" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">确保用你的替换这里的<code class="fe og oh oi nu b">apikey</code>。</li><li id="de43" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">我为这个项目选择了巴塞罗那市。这是地图上的默认位置。</li><li id="b9a4" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated"><code class="fe og oh oi nu b">addMarkerToGroup()</code>功能向地图添加位置。在本例中，我创建了一个标记— Barceloneta Beach。我们将很快看到如何从一个位置获得坐标。使用此功能添加任意数量的位置。</li><li id="86d1" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">点击该位置时会调用<code class="fe og oh oi nu b">addEventListener('tap')</code>功能。</li><li id="e1b7" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated"><code class="fe og oh oi nu b">addInfoBubble()</code>功能在用户点击标记时显示我们的自定义文本和照片。</li></ul><p id="5f5a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">4.要提取位置的纬度和经度，请使用以下代码创建一个单独的Python文件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oj ok l"/></div></figure><p id="8892" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们刚刚使用了<code class="fe og oh oi nu b">geopy</code>库来获取坐标:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="ac6f" class="mo lx iu nu b gz ny nz l oa ob">la Barceloneta, Ciutat Vella, Barcelona, Barcelonès, Barcelona, Catalunya, 08001, España<br/>(<strong class="nu iv">41.3806533, 2.1899274</strong>)</span></pre><p id="8158" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，您也可以传递位置的地址，而不是名称。</p><p id="d24b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">5.对你去过的所有地方重复这一步。</p><p id="1961" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">6.将标记添加到自定义地图。基本上，你需要做的就是使用<code class="fe og oh oi nu b">addMarkerToGroup</code>方法在地图上添加更多的地方。</p><ul class=""><li id="eb2f" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv nk nl nm nn bi translated">添加纬度和经度。</li><li id="83c2" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">根据需要调整图像的宽度和高度。</li><li id="eea3" class="nf ng iu lc b ld no lg np lj nq ln nr lr ns lv nk nl nm nn bi translated">将照片网址替换为您的网址。</li></ul><p id="7d7d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了简洁起见，我不打算在这里粘贴我的整个代码，因为我添加了很多地方。</p><h1 id="4cee" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">测试项目</h1><p id="a4a5" class="pw-post-body-paragraph la lb iu lc b ld na jv lf lg nb jy li lj nc ll lm ln nd lp lq lr ne lt lu lv in bi translated">现在让我们在本地运行Flask应用程序:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="59cb" class="mo lx iu nu b gz ny nz l oa ob">python3 app_runner.py</span></pre><p id="bc83" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在<a class="ae kz" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">打开浏览器http://127 . 0 . 0 . 1:5000/</strong></a>并点击标记:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/486e25b886fb9526c43aac64a97692ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqJfVn7f31uiRbQZyvQ3zw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">自定义地图上带有照片的信息气泡。照片来自Unsplash。</p></figure><p id="afd1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">厉害！图片如预期所示。</p><p id="3436" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请随意试验标记的HTML代码，使信息气泡更令人兴奋。</p><p id="bffa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="om">声明:为了这个教程，我从</em><a class="ae kz" href="https://unsplash.com/collections/74V2qxuNhzE/community-by-priscila-du-preez" rel="noopener ugc nofollow" target="_blank"><em class="om">Unsplash</em></a><em class="om">收集了一些好看的图片。如果你想知道——这些地方不是来自巴塞罗那。</em></p><h1 id="090e" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">将应用程序部署到Heroku</h1><p id="ff09" class="pw-post-body-paragraph la lb iu lc b ld na jv lf lg nb jy li lj nc ll lm ln nd lp lq lr ne lt lu lv in bi translated">现在让我们将应用程序公开。我们将把它部署到Heroku并与其他人共享链接。</p><ol class=""><li id="55f5" class="nf ng iu lc b ld le lg lh lj nh ln ni lr nj lv of nl nm nn bi translated">在您的项目目录中创建一个<code class="fe og oh oi nu b">requirements.txt</code>文件:</li></ol><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="3be8" class="mo lx iu nu b gz ny nz l oa ob">Flask==1.1.1<br/>gunicorn==19.9.0<br/>Jinja2==2.10.1</span></pre><p id="4270" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个文件让Heroku知道要安装哪些库。请随意更改版本。</p><p id="6e02" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.在项目的文件夹中创建一个<code class="fe og oh oi nu b">Procfile</code>:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="35b2" class="mo lx iu nu b gz ny nz l oa ob">web: gunicorn app_runner:app</span></pre><p id="3c08" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个文件定义了Heroku应该运行哪些命令来启动我们的应用程序。<code class="fe og oh oi nu b">web</code>命令启动一个web服务器，使用<code class="fe og oh oi nu b">gunicorn </code>作为我们的Python WSGI HTTP服务器。基于<code class="fe og oh oi nu b">app_runner.py</code>文件，应用程序名称被称为<code class="fe og oh oi nu b">app_runner</code>。</p><p id="7b88" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.登录Heroku并创建一个新应用程序:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj on"><img src="../Images/8d19afb9af996e7111af81f1eeb4be1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*imp7yYZQCpSUYcluxReQVA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在Heroku创建新应用程序</p></figure><p id="66dc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">4.将应用程序部署到Heroku有多种策略。在本例中，我们将使用<a class="ae kz" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank"> Heroku CLI </a>。你需要下载它。</p><p id="26a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">5.在项目文件夹中初始化一个新的Git存储库:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="76d9" class="mo lx iu nu b gz ny nz l oa ob">git init</span></pre><p id="0353" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">6.将应用程序添加到远程:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="c113" class="mo lx iu nu b gz ny nz l oa ob">heroku git:remote -a here-maps-demo</span></pre><p id="0dfa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">7.推动变革:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="fb70" class="mo lx iu nu b gz ny nz l oa ob">git add .<br/>git commit -m "added app files"<br/>git push heroku master</span></pre><p id="6e1b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">就是这样！</p><p id="c4f7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您应该看到Heroku正在部署您的应用程序。如果一切正常，您应该会在命令输出的末尾看到应用程序的URL:</p><pre class="kk kl km kn gu nt nu nv nw aw nx bi"><span id="1e54" class="mo lx iu nu b gz ny nz l oa ob">remote: <a class="ae kz" href="https://here-maps-demo.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://here-maps-demo.herokuapp.com/</a> deployed to Heroku</span></pre><p id="4255" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，打开应用的网址。最终结果将如下所示:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oo"><img src="../Images/e6c92213b96bbe29a95bdfae7b7d5743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*nrgX-gaK7c5hDHTGbfAb9Q.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在这里地图与信息泡沫演示</p></figure><p id="edde" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">太好了！现在，您的朋友可以回放美好的回忆，甚至从您的应用程序下载图片。</p><h1 id="563c" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结论</h1><p id="1b37" class="pw-post-body-paragraph la lb iu lc b ld na jv lf lg nb jy li lj nc ll lm ln nd lp lq lr ne lt lu lv in bi translated">在本教程中，您学习了如何使用HERE maps API创建自定义地图。我们使用Flask创建了一个简单的web应用程序，并将其部署在Heroku上，以便其他人可以访问它。</p><p id="0343" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意，在Git存储库中公开API键不是一个好的做法。我在本文中没有涉及这个主题。但是如果你想完善这个应用，可以考虑使用Heroku中的<a class="ae kz" href="https://devcenter.heroku.com/articles/config-vars" rel="noopener ugc nofollow" target="_blank">配置变量</a>。</p><p id="47cd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望你喜欢这篇文章，它给了你创造自己美好回忆地图的灵感。</p><p id="4147" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可能也会喜欢我的其他HERE地图相关教程:</p><div class="op oq gq gs or os"><a rel="noopener  ugc nofollow" target="_blank" href="/plan-your-holiday-with-python-and-here-maps-aaeeaf9580c3"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd iv gz z fq ox fs ft oy fv fx it bi translated">使用Python和此处的地图规划您的假期</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">如何创建自己的地图来可视化您想去的地方</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">better编程. pub</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg kt os"/></div></div></a></div><p id="b552" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，祝您编码愉快！</p></div></div>    
</body>
</html>