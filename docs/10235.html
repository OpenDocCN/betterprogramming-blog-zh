<html>
<head>
<title>3 Different Ways to Use Function as Values in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Go中使用函数作为值的3种不同方式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-different-ways-to-use-function-as-values-in-go-6e4bbcdba4c3?source=collection_archive---------8-----------------------#2021-12-15">https://betterprogramming.pub/3-different-ways-to-use-function-as-values-in-go-6e4bbcdba4c3?source=collection_archive---------8-----------------------#2021-12-15</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="cabb" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">Go开发模式</h2><div class=""/><div class=""><h2 id="96a1" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">在我们的Go项目中加入一些功能技巧</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/40f315050c8aa4f92a56e3b581c03ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUIKx_qd5CKi1WTyQsY8aQ.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">Jud Mackrill 在<a class="ae li" href="https://unsplash.com/s/photos/programming-coffee-people?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="107f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Go是一种静态类型的编译语言。它就像任何其他静态类型语言一样，但是没有那么麻烦，而且非常简单。当谈到函数式编程风格时，它不像Java那样冗长。</p><p id="c1b5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">借助于函数像任何其他值一样是一等公民的事实，以及Go支持鸭子类型的事实，我们可以很容易地在其中编写函数风格的代码。</p><p id="be65" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在这篇文章中，我将讨论3种在Go中编码的方法。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><h1 id="12b7" class="mm mn iu bd mo mp mq mr ms mt mu mv mw kj mx kk my km mz kn na kp nb kq nc nd bi translated">中间件</h1><p id="38c6" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">在不同的方式中，我最喜欢这一种——最流行的处理程序模式。让我们看看它的实际效果。</p><p id="5d6a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下面，我们正在创建处理程序来处理应用程序中的事情。该功能符合<code class="fe nj nk nl nm b"> http.Handler</code>接口:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="ccea" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们还创建了一些中间处理程序/中间件来处理交叉问题，如身份验证和记录其他工作:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="8b53" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">最后，在main函数中，我们创建了<code class="fe nj nk nl nm b">ultimateHandler</code>,它将在每个请求的日志记录和认证等所有相关工作完成后执行。为此，我们在第5行中链接了多个处理程序:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="06b6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">基本上，当我们用<code class="fe nj nk nl nm b">http.HandlerFunc</code>创建一个变量时，我们在创建一个包装器。当一个函数被发送给它时，它会自己调用。</p><h1 id="761e" class="mm mn iu bd mo mp np mr ms mt nq mv mw kj nr kk my km ns kn na kp nt kq nc nd bi translated">动态功能</h1><p id="d5ca" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">这是我喜欢尽可能在代码中使用的另一种模式。它可能看起来像创建函数类或流API的Java模式。但是我们也可以用最少的代码和更低的复杂度来使用这种编码方式:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nn no l"/></div></figure><h2 id="3b8c" class="nu mn iu bd mo nv nw dn ms nx ny dp mw ls nz oa my lw ob oc na ma od oe nc ja bi translated"><strong class="ak">分析</strong></h2><ul class=""><li id="7a1a" class="of og iu ll b lm ne lp nf ls oh lw oi ma oj me ok ol om on bi translated">在第8行，我们定义了一个函数的类型(<code class="fe nj nk nl nm b">UnaryFunction</code>，一个带1个参数的函数)，这个函数将带一个<code class="fe nj nk nl nm b">int</code>，并返回另一个int。通过定义这一点，我们可以创建任何符合其结构的其他类型，凭借duck typing，我们可以在Golang中实现动态功能。</li><li id="9341" class="of og iu ll b lm oo lp op ls oq lw or ma os me ok ol om on bi translated">第18行和第19行定义了两个函数，这两个函数与第8行定义的函数一致，但实现方式不同。第18行实现了<code class="fe nj nk nl nm b">square</code>方法，第19行实现了<code class="fe nj nk nl nm b">cubing</code>。</li></ul><h1 id="faf1" class="mm mn iu bd mo mp np mr ms mt nq mv mw kj nr kk my km ns kn na kp nt kq nc nd bi translated">通用代码</h1><p id="49be" class="pw-post-body-paragraph lj lk iu ll b lm ne ke lo lp nf kh lr ls ng lu lv lw nh ly lz ma ni mc md me in bi translated">我们可以用闭包来实现用Golang写一些通用代码。考虑以下代码:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nn no l"/></div></figure><p id="645e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们来分析一下:</p><ul class=""><li id="1f85" class="of og iu ll b lm ln lp lq ls ot lw ou ma ov me ok ol om on bi translated">我们有两个服务:<code class="fe nj nk nl nm b">SubscriberDetailsService</code>和<code class="fe nj nk nl nm b">SubscribeEntitlementService</code>，它们返回一种类型的<code class="fe nj nk nl nm b">ServiceCallback</code>。</li><li id="83a3" class="of og iu ll b lm oo lp op ls oq lw or ma os me ok ol om on bi translated">这些<code class="fe nj nk nl nm b">ServiceCallbacks</code>可以单独处理，也可以使用负载均衡器和作业调度器，比如<a class="ae li" href="https://github.com/susamn/rio" rel="noopener ugc nofollow" target="_blank"> rio </a>。</li></ul><p id="4b5f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在我们的例子中，服务回调可以在任何地方被调用，但是当它被调用时，它给父对象控制调用机制，并且由于它们是相同的类型(<code class="fe nj nk nl nm b">ServiceCallback</code>)，它们可以按照开发人员的意愿被收集、区分优先级或序列化。</p></div><div class="ab cl mf mg hy mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="in io ip iq ir"><p id="6e22" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">仅此而已。感谢阅读。</p><p id="f635" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我在Golang上的另一个帖子</p><div class="ow ox gq gs oy oz"><a href="https://medium.com/geekculture/be-in-the-flow-with-idiomatic-go-development-58058326bffe" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd je gz z fq pe fs ft pf fv fx jd bi translated">在发展惯用的流程中去</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">开发类似Go的代码，记住一些简单的规则</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn lc oz"/></div></div></a></div></div></div>    
</body>
</html>