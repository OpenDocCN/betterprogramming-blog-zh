<html>
<head>
<title>How Honeycomb Cut AWS Costs 50% by Power Tuning Lambdas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">蜂巢切割AWS如何通过功率调谐降低50%的成本</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-honeycomb-cut-aws-costs-50-by-power-tuning-lambdas-c6c9ced1b0d4?source=collection_archive---------9-----------------------#2022-07-12">https://betterprogramming.pub/how-honeycomb-cut-aws-costs-50-by-power-tuning-lambdas-c6c9ced1b0d4?source=collection_archive---------9-----------------------#2022-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="36bb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提升了他们的公司文化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6e00ed35520c1f2fe52dd6ec322093d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E-EU59NmzU8BG2wm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@junoe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ezequiel Junoe </a>拍摄</p></figure><p id="d282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“对我们(蜂巢)来说，[AWS Lambda]的成本是三件事的函数，”工程经理本·哈特向<a class="ae ky" href="https://www.honeycomb.io/blog/aws-costs-service-level/" rel="noopener ugc nofollow" target="_blank">在蜂巢博客</a>上写道，描述了他的团队最近的成本削减努力。根据本的说法:</p><ol class=""><li id="e68d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">Lambda的ARM架构比x86便宜</li><li id="fadf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">内存较少的小兰博达比大兰博达便宜</li><li id="f026" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">完成得快的兰姆达斯比完成得慢的兰姆达斯便宜</li></ol><p id="47ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在确定了架构、RAM大小和持续时间这三个节省成本的变量之后，蜂巢团队需要获取这些数据。他们的目标是识别和划分每个客户和每个查询的AWS成本。</p><p id="eaba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该团队装备了Honeycomb的查询引擎，将客户特定标识符的遥测数据以及查询源直接发送到Honeycomb应用程序，根据用户操作隔离查询。</p><p id="56c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是，Honeycomb的每个Lambdas都记录了它的客户id、用户操作(例如，手动运行查询或加载仪表板)、配置的内存和关于查询的其他信息。</p><h1 id="f182" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">监控大客户和AWS异常情况</h1><p id="9126" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">使用这个相当于黑匣子的飞行记录器，他们计算的成本是持续时间(以毫秒计)乘以每个架构的价格乘以内存大小除以Lambda的最大大小(10240GB)。</p><p id="6e29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据他们的初始数据集，他们确定arm64体系结构的每GB成本为1.33e-7美元，而x86体系结构的每GB成本为1.67e-7美元。将这些数字乘以RAM和持续时间等于成本。</p><p id="507d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们的计算(使用Honeycomb中的“派生列”来自动化事情)不仅有助于跟踪成本，而且他们还确定了发生Lambda账单明显高于和低于平均水平的客户。</p><p id="7155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在实际削减成本之前，该团队做的最后一件事是设置一个Slack触发器，每当任何一个“挥金如土”的客户在一天内在AWS Lambda上花费超过100美元时，该触发器就会自动发出通知。</p><h1 id="9333" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">通过功率调谐降低AWS Lambda成本</h1><p id="1bd1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">该团队最大的问题是“我们选择的λ大小是否正确，”本写道。为了找到答案，他们使用<a class="ae ky" href="https://docs.aws.amazon.com/lambda/latest/operatorguide/profile-functions.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda功率调谐</a>对大量不同的配置进行实验，然后比较成本。</p><p id="59c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Ben文章中的一张图片显示，据我推测，Honeycomb的Lambda成本每月从10，272.67美元下降到5，200.15美元，这意味着他们的AWS Lambda支出下降了近50%。</p><blockquote class="ng"><p id="d895" class="nh ni it bd nj nk nl nm nn no np lu dk translated">“呜！Lambda成本降低50%，同时提供一致的客户体验，这是一大胜利。”</p><p id="5868" class="nh ni it bd nj nk nl nm nn no np lu dk translated">本·哈特向</p></blockquote><p id="2ff5" class="pw-post-body-paragraph kz la it lb b lc ns ju le lf nt jx lh li nu lk ll lm nv lo lp lq nw ls lt lu im bi translated">这是一笔可观的节省，全部来自看起来简单的可监控性项目。当他们设置空闲通知时(非常酷！)对于超支，真正的胜利来自跟踪和实验。</p><h1 id="e06f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">成本节约对公司文化的影响</h1><p id="f660" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">除了我确信他们每年为公司节省60，000美元(据我估计)后对团队士气的鼓舞之外，这个项目还对Honeycomb的公司文化产生了持久的影响。</p><p id="45ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“让(对AWS支出的)影响反映在实际的美元上，”本写道，“更容易(知道)何时[…]优化工作[对我们的开发人员来说]真正值得付出努力。”这就是我所说的管理！</p><p id="d445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过严格测量和跟踪他们的AWS成本数据，然后系统地调整他们的Lambda策略，Honeycomb不仅节省了成本，还确定了如何最好地利用开发人员时间的客观措施，他们计划继续这样做。</p><p id="3658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">蜂巢团队的每个人都做得很好，我很赞赏他们将成本节约融入他们的文化。我希望这篇文章能激励你削减(或至少跟踪)自己在AWS Lambdas上的支出。</p><p id="3370" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="d466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.linkedin.com/in/derek-austin/" rel="noopener ugc nofollow" target="_blank">德里克·奥斯丁</a>博士是《职业规划<a class="ae ky" href="https://www.amazon.com/dp/B0BRJDLJ43" rel="noopener ugc nofollow" target="_blank"> <em class="oe">:如何在6个月内成为一名成功的6位数程序员</em> </a>的作者，现在亚马逊上有售。</p></div></div>    
</body>
</html>