<html>
<head>
<title>Namespacing in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的命名空间</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/namespacing-with-python-79574d125564?source=collection_archive---------4-----------------------#2020-01-03">https://betterprogramming.pub/namespacing-with-python-79574d125564?source=collection_archive---------4-----------------------#2020-01-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="49f5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索名称空间以及Python如何使用它们来帮助改进代码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/29be17c4c78b230b339435c128979644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YK97ewWmTioxoCwZ-Xv2fQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kv" href="https://unsplash.com/s/photos/name?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="2f68" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated"><strong class="ak">命名空间</strong></h1><p id="44f2" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">与许多编程语言一样，Python通过<em class="mr">名称空间</em>的概念隔离代码。当程序运行时，它跟踪所有已知的名称空间以及这些名称空间中可用的信息。</p><p id="cb42" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">名称空间在几个方面很有帮助:</p><ul class=""><li id="008c" class="mx my iq lx b ly ms mb mt me mz mi na mm nb mq nc nd ne nf bi translated">随着软件的增长，多个概念需要相似或相同的名称。</li><li id="3760" class="mx my iq lx b ly ng mb nh me ni mi nj mm nk mq nc nd ne nf bi translated">名称空间有助于最小化冲突，使每个名称所指的概念变得清晰。</li><li id="c57a" class="mx my iq lx b ly ng mb nh me ni mi nj mm nk mq nc nd ne nf bi translated">随着软件的增长，知道哪个代码已经在代码库中变得更加困难。名称空间帮助您对代码可能存在的位置做出有根据的猜测。</li><li id="1219" class="mx my iq lx b ly ng mb nh me ni mi nj mm nk mq nc nd ne nf bi translated">当向大型代码库添加新代码时，现有的名称空间可以指导新代码应该位于何处。如果没有明显的选择，一个新的名称空间可能是合适的。</li></ul><p id="75e6" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">名称空间非常重要，以至于它们被包含在Python的禅宗中(如果您不熟悉Python的禅宗，请尝试启动Python解释器并键入<code class="fe nl nm nn no b">import this</code>)。</p><blockquote class="np"><p id="e534" class="nq nr iq bd ns nt nu nv nw nx ny mq dk translated"><em class="nz">“名称空间是一个非常棒的想法——让我们做更多这样的事情吧！”—</em>Python的禅</p></blockquote><p id="c2d9" class="pw-post-body-paragraph lv lw iq lx b ly oa jr ma mb ob ju md me oc mg mh mi od mk ml mm oe mo mp mq ij bi translated">你在Python中使用过的所有变量、函数和类都是这个或那个名称空间中的<em class="mr">名</em>。名字是类似于<code class="fe nl nm nn no b">x</code>或<code class="fe nl nm nn no b">total</code>或<code class="fe nl nm nn no b">EssentialBusinessDomainObject</code>的东西，它们是对某事物的引用。</p><p id="946c" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">当你的Python代码说<code class="fe nl nm nn no b">x = 3</code>时，它的意思是，“将值3赋给名字<code class="fe nl nm nn no b">x</code>，然后你可以在你的代码中引用<code class="fe nl nm nn no b">x</code>。</p><p id="a94f" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">“变量”一词可以与表示值的名称互换使用，尽管在Python中名称可以表示函数、类等等。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c7d5" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated"><strong class="ak">命名空间和I </strong> <code class="fe nl nm nn no b">mport</code> <strong class="ak">语句</strong></h1><p id="bc98" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">当您第一次打开Python解释器时，内置名称空间中会填充Python内置的所有内容。Python内置名称空间包含内置函数，如<code class="fe nl nm nn no b">print()</code>和<code class="fe nl nm nn no b">open()</code>。</p><p id="7c6b" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这些内置的没有前缀，你不需要做任何特殊的事情来使用它们。Python让您可以在代码中的任何地方使用它们。这就是为什么Python中著名的简单<code class="fe nl nm nn no b">print('Hello world!')</code> Just Works。</p><p id="47c7" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">与某些语言不同，您不会在Python代码中显式地创建名称空间，但是您的代码结构会影响创建什么名称空间以及它们如何交互。</p><p id="252d" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">例如，创建一个Python <em class="mr">模块</em>会自动为该模块创建一个额外的名称空间。最简单地说，Python模块是一个包含一些代码的<code class="fe nl nm nn no b">.py</code>文件。</p><p id="acb5" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">例如，一个名为<code class="fe nl nm nn no b">sales_tax.py</code>的文件就是“这个<code class="fe nl nm nn no b">sales_tax</code>模块”:</p><pre class="kg kh ki kj gt of no og oh aw oi bi"><span id="2d2b" class="oj le iq no b gy ok ol l om on"># sales_tax.py<br/>  <br/> <strong class="no ir">def add_sales_tax</strong>(total, tax_rate):<br/>     <strong class="no ir">return </strong>total * tax_rate</span></pre><p id="f12b" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">每个模块都有一个全局名称空间，模块中的代码可以自由访问。没有嵌套的函数、类和变量位于模块的全局名称空间中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="6db9" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">❶ <code class="fe nl nm nn no b">TAX_RATES_BY_STATE</code>在模块的全局名称空间中。</p><p id="60aa" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">模块中的❷代码可以毫不费力地使用<code class="fe nl nm nn no b">TAX_RATES_BY_STATE</code>。</p><p id="6f2a" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">模块中的函数和类也有一个只有它们可以访问的<em class="mr">本地</em>名称空间:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="1d03" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">❶ <code class="fe nl nm nn no b">tax_rate</code>只在<code class="fe nl nm nn no b">add_sales_tax()</code>的局部范围内。</p><p id="d4af" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated"><code class="fe nl nm nn no b">add_sales_tax()</code>中的❷代码可以毫不费力地使用<code class="fe nl nm nn no b">tax_rate</code>。</p><p id="994d" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">想要使用另一个模块的变量、函数或类的模块必须<em class="mr">将它导入</em>到它的全局名称空间中。导入是一种将名称从其他地方拉入所需名称空间的方式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="bf03" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">❶<code class="fe nl nm nn no b">add_sales_tax</code>函数被添加到<code class="fe nl nm nn no b">receipt</code>全局名称空间中。</p><p id="6904" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">❷ <code class="fe nl nm nn no b">add_sales_tax</code>仍然从它自己的名称空间知道<code class="fe nl nm nn no b">TAX_RATES_BY_STATE</code>和<code class="fe nl nm nn no b">tax_rate</code>。</p><p id="711f" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">要引用Python中的变量、函数或类，必须满足以下条件之一:</p><ol class=""><li id="60c2" class="mx my iq lx b ly ms mb mt me mz mi na mm nb mq oq nd ne nf bi translated">该名称位于Python内置名称空间中。</li><li id="b631" class="mx my iq lx b ly ng mb nh me ni mi nj mm nk mq oq nd ne nf bi translated">该名称是当前模块的全局名称空间。</li><li id="e3df" class="mx my iq lx b ly ng mb nh me ni mi nj mm nk mq oq nd ne nf bi translated">该名称位于代码的本地命名空间的当前行中。</li></ol><p id="6276" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">冲突名称的优先级以相反的顺序工作；本地名称覆盖全局名称，全局名称覆盖内置名称。</p><p id="f96a" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">您可以记住这一点，因为一般来说，最特定于当前代码的定义是被使用的定义。这如图1所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/51e41840423f3026dfe480c0128e1346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OLdn0XMKllDn5qDB.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd os">图一。</strong>名称空间的特异性</p></figure><p id="8cfd" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">在您使用Python的冒险经历中，您可能曾经见过一个<code class="fe nl nm nn no b">NameError: name 'my_var' is not defined</code>。这意味着在该代码已知的任何名称空间中都找不到名称<code class="fe nl nm nn no b">my_var</code>。</p><p id="8d13" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这通常意味着你从未给<code class="fe nl nm nn no b">my_var</code>赋值，或者你在别的地方赋值了，需要导入它。</p><p id="f45f" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">模块是开始分解代码的好方法；如果你有一个长的<code class="fe nl nm nn no b">script.py</code>包含一堆不相关的函数，考虑将这些函数分解成模块。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4c9b" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">进口的许多面具</h1><p id="2783" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">Python中的导入语法初看起来很简单，但是有几种方法可以实现，每种方法都会导致引入名称空间的信息有细微的差别。</p><p id="68b9" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">之前，您将<code class="fe nl nm nn no b">add_sales_tax()</code>功能从<code class="fe nl nm nn no b">sales_tax</code>模块导入到<code class="fe nl nm nn no b">receipt</code>模块:</p><pre class="kg kh ki kj gt of no og oh aw oi bi"><span id="1fad" class="oj le iq no b gy ok ol l om on"># receipt.py<br/>  <br/> from sales_tax import add_sales_tax</span></pre><p id="7bfc" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这将把<code class="fe nl nm nn no b">add_sales_tax()</code>函数添加到<code class="fe nl nm nn no b">receipt</code>模块的全局名称空间中。</p><p id="e5c9" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这一切都很好，但是假设您给<code class="fe nl nm nn no b">sales_tax</code>增加了十个函数，并且想在<code class="fe nl nm nn no b">receipt</code>中使用它们。如果你继续沿着同一条路走下去，你会得到这样的结果:</p><pre class="kg kh ki kj gt of no og oh aw oi bi"><span id="d25d" class="oj le iq no b gy ok ol l om on"># receipt.py<br/>  <br/> <strong class="no ir">from </strong>sales_tax <strong class="no ir">import </strong>add_sales_tax, add_state_tax, add_city_tax, add_local_millage_tax, ...</span></pre><p id="659f" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这是一个替代语法，对其进行了一点改进:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="a922" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">还是不太好。当您需要另一个模块的大量功能时，您可以完全导入该模块:</p><pre class="kg kh ki kj gt of no og oh aw oi bi"><span id="b276" class="oj le iq no b gy ok ol l om on"># receipt.py<br/>  <br/> <strong class="no ir">import </strong>sales_tax</span></pre><p id="61dd" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这将整个<code class="fe nl nm nn no b">sales_tax</code>模块添加到当前名称空间，并且可以用前缀<code class="fe nl nm nn no b">sales_tax.</code>引用它的函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="84e3" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">这有利于避免长的<code class="fe nl nm nn no b">import</code>语句，前缀有助于避免名称空间冲突。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="d464" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated"><strong class="ak">通配符导入</strong></h1><p id="fdd2" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">Python允许您使用<code class="fe nl nm nn no b">from themodule import *</code>以速记方式从模块中导入所有名称。在你的代码中用这个代替前缀<code class="fe nl nm nn no b">themodule.</code>很诱人，但是<em class="mr">请不要</em>！</p><p id="e5de" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">通配符导入会导致更多的名称冲突，因为您看不到被导入的显式名称，这使得问题难以调试。坚持显式导入！</p><p id="a661" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated">本文到此为止。如果你想了解更多关于这本书的内容，可以在<a class="ae kv" href="https://livebook.manning.com/book/practices-of-the-python-pro/?utm_source=freecontentcenter&amp;utm_medium=website&amp;utm_campaign=book_practicesofthepythonpro&amp;utm_content=article_01" rel="noopener ugc nofollow" target="_blank"> liveBook </a>上查看，还可以看看这个<a class="ae kv" href="https://www.slideshare.net/ManningBooks/practices-of-the-python-pro-coding-best-practices?utm_source=freecontentcenter&amp;utm_medium=website&amp;utm_campaign=book_practicesofthepythonpro&amp;utm_content=article_01" rel="noopener ugc nofollow" target="_blank">幻灯片</a>。</p><p id="d0cf" class="pw-post-body-paragraph lv lw iq lx b ly ms jr ma mb mt ju md me mu mg mh mi mv mk ml mm mw mo mp mq ij bi translated"><em class="mr">摘自戴恩·希拉德的《Python Pro </em>  <em class="mr">的做法》。</em></p></div></div>    
</body>
</html>