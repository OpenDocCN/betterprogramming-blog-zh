# Python 中处理数字的 5 种高级操作

> 原文：<https://betterprogramming.pub/5-advanced-operations-to-handle-numbers-in-python-e7ff921da475>

## 你都认识吗？

![](img/ce5e3af8964d1eede89868ff310ccc1b.png)

乔恩·泰森在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

数字在我们的日常生活中无处不在——有电话号码、出生日期、年龄和其他各种标识符(例如，驾照和社会保险号)。

自然，所有的编程语言都有广泛的处理数字的功能。这些运算大多基于常见的算术运算符——加、减、乘、除——大家应该都非常熟悉。然而，各种编程语言都有独特的操作，新手往往觉得不太直观。

在本文中，我想回顾一下 Python 中处理数字的五种高级操作。

# 1.较少使用的运算符

众所周知，加减乘除是最基本的数学运算符。然而，还有另外三个我们使用较少但非常方便的操作符。

*   模数运算符`%`返回一个数除以另一个数后的余数。
*   取幂运算符`**`返回一个数的另一个数的幂后的结果。
*   取整运算符`//`返回一个数除以另一个数后的最大可能结果(例如，将 2.x 向下舍入为 2)。

请参见下面代码片段中的一些例子。值得注意的是，您不必对这些操作使用整数，因为它们也可以在浮点上工作。

运算符:%、**和//

在这些操作符中，这里有两个具体的用例，您可能会觉得很方便。

*   要找出一个整数是偶数还是奇数，你可以简单地通过将它除以 2 并与 0 或 1 进行比较来检查它的模(例如，`x % 2 == 1`将评估它是否是奇数)。
*   对于 floor division 操作，数据处理中的一个用途是从时间序列数据中找出下采样的数据点数，如`x // 4`，将数据下采样到季度。

# 2.赋值运算符

我们都知道，我们使用等式运算符`=`给变量赋值，因此它也被称为赋值运算符。与许多其他编程语言一样，算术运算符可以与赋值运算符一起使用，以创建操作现有变量的值的快捷方式。例如，`x += 5`相当于`x = x+5`，`x *= 3`相当于`x = x*3`。这些操作应该很简单。以下代码片段向您展示了一些简单的示例:

赋值运算符

上面的例子展示了一些使用一些很少使用的操作符的赋值操作的例子，正如上一节所讨论的。顺便提一下，一些赋值操作符可以处理序列数据，这有时会对您有所帮助。

列表赋值运算符

# 3.小数精度

假设我们正在解决一个非常简单的加法问题。我们定义两个变量，一个是 2.2，另一个是 1.1。这两个数的和是多少？相关的，总和等于 3.3 吗？我相信你对自己的答案很有信心，但是让我们用 Python 来帮助我们解决这个问题:

精度问题

你能相信你刚刚看到的吗？别开玩笑了——这不是我编的。你也可以在你的机器上试试。

实际上，如果你明白这些浮点数并不是精确地存储在内存中，你就不应该对这些结果感到惊讶。对这些底层机制的完整讨论超出了本文的范围，但是如果您感兴趣，可以参考关于 [StackOverflow](https://stackoverflow.com/questions/7644699/how-are-floating-point-numbers-stored-in-memory) 的相关讨论。

幸运的是，Python 有一个特殊的模块— `decimal` —来支持这些具有期望精度的操作。这些精确的操作在精确至关重要的领域尤其重要，例如物理和金融行业。让我们通过一些简单的例子来看看它是如何工作的:

十进制的使用

如上所示，我们使用`Decimal`类创建了浮点数。重要的是，我们使用字符串来实例化`Decimal`对象。如果我们检查`c_Decimal`的值，你会发现它是正确的数量(即 3.3)。但是，如果你直接和 3.3 比较，你会发现它们并不一样。

这种不平等是意料之中的，因为常规浮点的真实值并不完全与它看起来的一样。另外，常规浮点数属于`float`类，而`c_Decimal`属于`Decimal`类。值得注意的是，我们可以将它与使用相同浮点数创建的另一个`Decimal`实例进行比较。

与此相关，上面的代码向您展示了我们可以对两个`Decimal`实例使用加法运算。实际上，其他常见操作(如减法和除法)也适用于他们。

# 4.分数

在大多数情况下，我们使用浮点数来表示足够精确的数量。例如，如果用 1 除以 9，得到 0.111111111111111，这就是 16 位精度。虽然在`Decimal`类的帮助下，这种精度水平在各种情况下都符合我们的目的，但从数学的角度来看，这并不完全正确。

幸运的是，Python 有一个特殊的包`Fraction`，用来处理这些与分数相关的算术运算。总的来说，用法类似于`Decimal`类。让我们看看他们的行动:

分数

如上所示，要创建一个分数，需要实例化一个`Fraction`对象，指定分子和分母。它们支持我们之前讨论过的算术运算，比如加法和乘法。除了这些基本用法之外，下面的代码片段向您展示了额外的常用操作:

分数的附加运算

在上面的代码中有几件事情需要强调。

*   通过在实例化期间设置`_normalize`参数来控制规范化。默认情况下，分数将被规范化为最小的分母。
*   要将浮点数转换成分数，在浮点数上使用`as_integer_ratio()`函数将返回一个元组。我们使用星号来解包元组，元组的元素(在我们的例子中就是`(1, 2)`)用于创建新的分数。

# 5.设置字符串的数字格式

需要将数字显示为字符串是很常见的。在许多情况下，我们需要格式化，以便数字对于手边的任务更容易阅读。

例如，如果我们显示一个包含多个数字的非常大的数字，您可能希望分隔符更好地理解该数字，如下所示:

大量的数字

假设我们想要显示两位数精度的浮点数，比如某个学生的分数列表中的平均分数。考虑下面这个简单的例子。

这里需要注意一些事情:

1.  上一个例子使用了`format()`方法，而下面的例子使用了 [f-strings](https://medium.com/swlh/string-formatting-in-python-6-things-to-know-about-f-strings-72fd38d96172) ，这只是向您展示了有多种方法来格式化字符串。
2.  格式化浮点数的另一种方法是使用`round()`方法，该方法创建一个具有所需精度的新浮点数。请注意，使用`round()`不同于字符串格式化，它不会创建一个新的浮点数。

浮点精度

在科学计算项目中，数字可以变得很大或很小，在这种情况下，科学符号是相关的技术，如下所示:

科学符号

以百分比显示数字也很常见，例如利率和其他小额金额，如促销活动的折扣率。展示了一些琐碎的例子。值得注意的是，我们可以通过在百分号前指定值来控制精度。

百分率

# 结论

在本文中，我们回顾了在 Python 中处理数字的五种高级技术。这里有一个快速回顾。

*   除了基本运算符(+、-、*、/)之外，我们还可以使用%来计算模，**来计算取幂运算，而//则用来计算除法运算。
*   这些算术运算符可以与赋值运算符一起使用，后者在执行适当的运算后对值进行赋值。
*   如果我们需要精确的计算，我们需要使用标准库中的*十进制*模块中的`Decimal`类。
*   *分数*模块中的`Fraction`类是专门为处理分数而设计的。
*   strings 的`format()`方法和 f-strings 是以期望的方式格式化数字的便利工具，例如百分比和科学记数法。