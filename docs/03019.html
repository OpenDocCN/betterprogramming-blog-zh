<html>
<head>
<title>Check if a Swift Array Is Empty: Best Practice Revisited</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检查Swift数组是否为空:最佳实践回顾</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/check-swift-array-is-empty-f15e63bf1026?source=collection_archive---------9-----------------------#2020-01-15">https://betterprogramming.pub/check-swift-array-is-empty-f15e63bf1026?source=collection_archive---------9-----------------------#2020-01-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1c5a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看哪个更快，是空的还是？计数== 0</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/83ea599b4245db335655393636a1ecc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqZ92eCnTTZmHMY9dDfiCA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">奥利弗·科尔在<a class="ae ky" href="https://unsplash.com/s/photos/empty?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="acb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你是一家软件开发公司的本科生暑期实习生，你刚刚开始学习Swift编程，你写了一些如下这样的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="e0cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是(或者不幸的是)，你的代码被你的团队领导，一位资深的iOS开发者，在你每周与他一对一的会议中审查了。</p><p id="ae30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当他看到这几行代码时，他开始微笑，并说:“从技术上讲，你的代码是正确的，这是毫无疑问的。然而，这不是最佳做法，”低声说道。</p><p id="893c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他立刻停止了说话，转向你，等着轮到你问为什么。虽然他迫不及待地分享了一些见解(也就是某种定义上的炫耀)，但他不得不假装平静，毕竟他是一名高级开发人员。</p><p id="1bc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你开始有点皱眉，让自己看起来很困惑(你最好这样做，因为这可能是你的主管所期待的)，然后你问:“你能澄清一下你所说的最佳实践是什么意思吗？”</p><p id="0e05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他对这个问题非常满意，通过你的眼镜，他看到了一双渴望知识、洞察力和专业技能的眼睛。</p><p id="cfe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“嗯，要检查一个数组是否为空，应该直接访问<code class="fe lx ly lz ma b">isEmpty</code>属性，复杂度为O(1)。但是，如果您访问<code class="fe lx ly lz ma b">count</code>属性，它将导致整个数组的迭代，以找出数组的元素数，这是O(n)复杂度。”</p><p id="c409" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他说话时一直在点头。“也就是说，对您的问题的简短回答是，最佳实践是使用<code class="fe lx ly lz ma b">isEmpty</code>，而不是将<code class="fe lx ly lz ma b">count</code>属性与0进行比较。”</p><p id="3c1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他说话的时候，你跟他一样的步调不停的点头(这么多行为技巧要学……)。当他讲完后，你问:“为什么访问<code class="fe lx ly lz ma b">isEmpty</code>是O(1)运算？”</p><p id="9df6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他给你解释了，虽然你其实不是很懂。您的对话继续进行，并就此话题提出了更多的后续问题。你整整一个小时的会议就是用来讨论这个的。</p><p id="16d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你离开他的办公室时，你看起来仍然很困惑，因为有太多的新信息涌入。尽管如此，您学到了一些重要的东西:使用<code class="fe lx ly lz ma b">isEmpty</code>而不是<code class="fe lx ly lz ma b">count == 0</code>来检查数组是否为空— <em class="mb">最佳实践</em>！</p><p id="9508" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当你回到办公室坐下时，你开始怀疑<code class="fe lx ly lz ma b">isEmpty</code>是否总是胜过<code class="fe lx ly lz ma b">count == 0</code>。</p><p id="fbe6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于Xcode就在您面前，您决定运行一些简单的实验来比较这两种方法的性能。毕竟数据不会骗你！</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="50e5" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">模拟结果</h1><p id="a456" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">下表显示了模拟结果。用于产生结果的代码可以在GitHub 上找到<a class="ae ky" href="https://gist.github.com/ycui1/0cdd666d11556530c238ee2176ffe604" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="4a81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发生的事情是，创建了一系列整数数组，元素的数量从0、1、10一直到10，000，000。</p><p id="cdd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于每个操作，<code class="fe lx ly lz ma b">count == 0</code>和<code class="fe lx ly lz ma b">isEmpty</code>，它运行10，000次以生成可靠的性能时间。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对于各种阵列类型，两种方法的性能相似</p></figure><p id="d663" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令人惊讶的是，您发现即使数组中有1000万个整数,<code class="fe lx ly lz ma b">isEmpty</code>也没有胜过<code class="fe lx ly lz ma b">count == 0</code>。</p><p id="582b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，这些结果不支持您的主管告诉您的关于访问<code class="fe lx ly lz ma b">count</code>属性的O(n)复杂度与访问<code class="fe lx ly lz ma b">isEmpty</code>属性的O(1)复杂度的对比。</p><p id="c7c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你对结果不太确定，又做了一次实验。尽管如此，还是获得了类似的结果。</p><p id="70fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，您进一步对数组<code class="fe lx ly lz ma b">String</code>和<code class="fe lx ly lz ma b">Dictionary</code>进行了比较。同样，两种方法的性能相当。</p><p id="d095" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些结果似乎支持了是否使用<code class="fe lx ly lz ma b">isEmpty</code>或<code class="fe lx ly lz ma b">count == 0</code>来检查数组是否为空并不重要，因为两者速度一样快。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="3cde" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">说明</h1><p id="8b26" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">虽然你的上司的辩解听起来是对的，但当你看到这些结果时，你不得不怀疑为什么会发生这种事。</p><p id="00ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我试着给出我的解释，可能不全面。因此，如果你有什么想说的，请随时留下你的评论。</p><p id="391b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从<a class="ae ky" href="https://developer.apple.com/documentation/swift/array/1688398-isempty" rel="noopener ugc nofollow" target="_blank">官方文档</a>中可以很清楚地看出，访问<code class="fe lx ly lz ma b">isEmpty</code>属性是一个O(1)操作，这一点我们毫无疑问。</p><p id="ee5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，模拟结果支持这样的观点，即<code class="fe lx ly lz ma b">count == 0</code>的性能与<code class="fe lx ly lz ma b">isEmpty</code>相当，这表明访问count属性也是一个O(1)操作。可能吗？</p><p id="10a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案是肯定的。但是为什么呢？这仅仅是因为<code class="fe lx ly lz ma b">Array</code>符合<a class="ae ky" href="https://developer.apple.com/documentation/swift/randomaccesscollection" rel="noopener ugc nofollow" target="_blank"> RandomAccessCollection </a>协议。下面是来自官方文档的该协议的概述。</p><blockquote class="ng nh ni"><p id="7567" class="kz la mb lb b lc ld ju le lf lg jx lh nj lj lk ll nk ln lo lp nl lr ls lt lu im bi translated">随机访问集合可以将索引移动任意距离，并在O(1)时间内测量索引之间的距离。</p><p id="7549" class="kz la mb lb b lc ld ju le lf lg jx lh nj lj lk ll nk ln lo lp nl lr ls lt lu im bi translated">因此，随机访问和双向收集之间的根本区别在于，依赖于索引移动或距离测量的操作可以显著提高效率。</p><p id="5509" class="kz la mb lb b lc ld ju le lf lg jx lh nj lj lk ll nk ln lo lp nl lr ls lt lu im bi translated">例如，随机访问集合的count属性在O(1)中计算，而不需要迭代整个集合。</p></blockquote><p id="c361" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从最后一句可以看出，它清楚地说明了随机访问集合的<code class="fe lx ly lz ma b">count</code>属性是O(1)运算。</p><p id="7b64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为对于作为随机访问集合的<code class="fe lx ly lz ma b">Array</code>来说，<code class="fe lx ly lz ma b">count</code>和<code class="fe lx ly lz ma b">isEmpty</code>属性都是O(1)操作，所以我们应该期望，为了检查数组是否为空，<code class="fe lx ly lz ma b">count == 0</code>和<code class="fe lx ly lz ma b">isEmpty</code>方法具有相似的性能。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="b1f8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">快速旁注</h1><p id="99ce" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">与当前讨论相关的是检查<code class="fe lx ly lz ma b">Set</code>和<code class="fe lx ly lz ma b">String</code>是否为空的正确方法。</p><p id="44b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以告诉你<code class="fe lx ly lz ma b">Set</code>的<code class="fe lx ly lz ma b">count</code>属性是<a class="ae ky" href="https://developer.apple.com/documentation/swift/set/3018378-count" rel="noopener ugc nofollow" target="_blank">官方文档</a>中所说的O(1)运算。因此，使用<code class="fe lx ly lz ma b">count == 0</code>和<code class="fe lx ly lz ma b">isEmpty</code>检查<code class="fe lx ly lz ma b">Set</code>是否为空没有明显的区别。</p><p id="bbde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，<code class="fe lx ly lz ma b">String</code>作为一个字符集合不符合上述RandomAccessCollection协议，使其<code class="fe lx ly lz ma b">count</code>属性成为O(n)运算。</p><p id="87dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，使用<code class="fe lx ly lz ma b">isEmpty</code>来检查<code class="fe lx ly lz ma b">String</code>是否为空，而不是使用<code class="fe lx ly lz ma b">count == 0</code>，这确实是最佳实践。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="78da" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="0287" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">许多Swift程序员，尤其是资深程序员，可能会有这样的印象:使用<code class="fe lx ly lz ma b">isEmpty</code>是确定数组是否为空的最佳实践。</p><p id="3eb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这里提供的数据支持<code class="fe lx ly lz ma b">count == 0</code>有可比的性能。因此，当快速数组被检查为空时，没有坚实的理由反对使用<code class="fe lx ly lz ma b">count == 0</code>。</p></div></div>    
</body>
</html>