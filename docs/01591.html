<html>
<head>
<title>An Intro to Python Assert Statements</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python断言语句简介</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/an-intro-to-python-assert-statements-bdd45834d303?source=collection_archive---------10-----------------------#2019-09-26">https://betterprogramming.pub/an-intro-to-python-assert-statements-bdd45834d303?source=collection_archive---------10-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4383" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么断言？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f679ff3af52f74360f28912bbdf50d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwpVeV618VXn8feTOS2E7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://twitter.com/ninalimpi" rel="noopener ugc nofollow" target="_blank"> Katerina Limpitsouni </a>创作</p></figure><p id="9023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果Python是一个故事，断言就是无名英雄之一。你可能没有听说过它们，也不知道它们能做什么。所以，让我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="339a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">什么是断言？</strong></h1><p id="f99a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><em class="mz">断言</em>或<em class="mz">断言语句</em>内置于Python中，是调试的工具。顾名思义，assert语句在检查程序员指定的条件时，试图断言它对其余代码的权限。</p><p id="0b79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以告诉assert语句检查变量<code class="fe na nb nc nd b">speed</code>的值是否大于或等于<code class="fe na nb nc nd b">0</code>(因为velocity可以是负的，而speed不是)。如果条件为真，assert不做任何事情，程序正常运行。但是，如果条件失败，assert语句断言它的权限并引发一个<code class="fe na nb nc nd b">AssertionError</code>，这将停止程序的执行。Python中的代码大概是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Python断言的示例</p></figure><p id="90a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果引发了一个<code class="fe na nb nc nd b">AssertionError</code>(如第7行的<code class="fe na nb nc nd b">get_speed</code>函数的第二次调用)，很容易发现，这使得在大型代码库中进行调试很容易。错误消息可能是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/9947bd1d8058f000b2c73777fc963a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovqNTdrE8c8JO7s8U0SgDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="nh">断言错误</em></p></figure><p id="a60f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该错误消息的好处是，作为开发人员，您可以找到确切的行号，在本例中是在第3行，也就是编写assert语句的地方。因此，通过断言其权威性，assert语句使开发人员的工作变得更加轻松。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="60d1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">为什么断言？</strong></h1><p id="98d6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为什么不用别的东西来代替，比如一个<code class="fe na nb nc nd b">if</code> … <code class="fe na nb nc nd b">else</code>语句，如下所示？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不使用断言的相同代码</p></figure><p id="b1d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，这段代码会占用更多的空间，不仅因为它将在一个<code class="fe na nb nc nd b">if</code>语句内分支，还因为它还必须在单独的一行上有一个<code class="fe na nb nc nd b">raise</code>异常。其次，作为一名程序员，它分散了你的注意力，使你无法完成主要的<em class="mz"> </em>工作，也就是说，不是通过一种强力方法来防御所有可能的错误，而是专注于主要代码。引发异常允许更好的错误处理和更干净的代码。作为程序员，您有很多选择来处理引发的异常，使用<code class="fe na nb nc nd b">try</code>和<code class="fe na nb nc nd b">except</code>。更多关于他们的<a class="ae ky" href="https://www.w3schools.com/python/python_try_except.asp" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="0896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，断言被设计成程序的迷你自检，它们可以很好地集成，而不必跨越我们的多个<code class="fe na nb nc nd b">if</code> … <code class="fe na nb nc nd b">else</code>语句。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2e8a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">如何断言？</strong></h1><p id="ccef" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在你已经知道了断言以及为什么我们应该使用它们，我们可以看看如何使用它们以及应该在哪里使用它们。根据<a class="ae ky" href="https://docs.python.org/3/reference/simple_stmts.html#grammar-token-assert-stmt" rel="noopener ugc nofollow" target="_blank"> Python文档</a>，assert语句具有以下语法，这只是创建assert语句的模板:</p><p id="2c54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe na nb nc nd b">assert_smt ::= "assert" expression1 ["," expression2]</code></p><p id="2838" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一开始可能看起来很复杂，但是使用起来非常简单。<code class="fe na nb nc nd b">expression1</code>是你要测试的条件。你希望你的程序正常运行。在我们的速度例子中，它是<code class="fe na nb nc nd b">speed &gt;=0</code>。<code class="fe na nb nc nd b">[]</code>括号表示<code class="fe na nb nc nd b">expression2</code>是可选的。然而，我们可以用它来提供特定的错误消息。例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有特定消息的断言</p></figure><p id="9a9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，如果出现断言错误，将向程序员显示<code class="fe na nb nc nd b">expression2 </code>中的特定消息。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="eae2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">哪里没有断言？</strong></h1><p id="b812" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">断言看起来很酷，那么它们应该无处不在来检查错误吗？简单的回答是<em class="mz">没有</em>。</p><p id="36a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很容易陷入<em class="mz">真断言</em>的陷阱:其条件永远不会评估为<code class="fe na nb nc nd b">False</code>的断言。例如，当非空时，<code class="fe na nb nc nd b">tuple</code>语句将始终计算为<code class="fe na nb nc nd b">True</code>。即使您不打算提供一个<code class="fe na nb nc nd b">tuple</code>作为条件，它也可能会意外发生:</p><pre class="kj kk kl km gt ni nd nj nk aw nl bi"><span id="8819" class="nm md it nd b gy nn no l np nq">assert (    <br/>       speed &gt;= 0,    <br/>       "Speed should be non-negative!"<br/>)</span></pre><p id="7d45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，这个assert语句看起来完全没问题。然而，<code class="fe na nb nc nd b">()</code>使它成为一个tuple对象，如果它不为空，它将总是计算为<code class="fe na nb nc nd b">True</code>。</p><p id="13cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用断言时也需要小心。可以通过尝试优化执行来禁用断言，在命令行中使用诸如<code class="fe na nb nc nd b">-O</code>和<code class="fe na nb nc nd b">-OO</code>这样的标志。这意味着即使条件为假，它们也不会起作用，也不会引发错误。</p><p id="e08f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是对assert语句的介绍，我希望这篇文章能帮助你开始。如果您想深入了解assert语句，请查阅以下资源:</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4308" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><p id="d5ce" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">以下是一些可供进一步阅读的资源:</p><p id="5e48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.python.org/3/reference/simple_stmts.html#grammar-token-assert-stmt" rel="noopener ugc nofollow" target="_blank">简单语句—Python 3.7.4文档</a></p><p id="6ad7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.tutorialspoint.com/python/assertions_in_python.htm" rel="noopener ugc nofollow" target="_blank">Python中的断言</a></p><p id="9fcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/emre/notes/blob/master/python/when-to-use-assert.md" rel="noopener ugc nofollow" target="_blank"> emre/notes </a></p></div></div>    
</body>
</html>