<html>
<head>
<title>Character Encodings — The Pain That Won’t Go Away, Part 2/3: Unicode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">字符编码——挥之不去的痛，第2/3部分:Unicode</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/character-encodings-the-pain-that-wont-go-away-part-2-2-unicode-4f13a0d2d42d?source=collection_archive---------13-----------------------#2019-10-28">https://betterprogramming.pub/character-encodings-the-pain-that-wont-go-away-part-2-2-unicode-4f13a0d2d42d?source=collection_archive---------13-----------------------#2019-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1ce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这应该能拯救我们所有人，但这仅仅是我们目前最好的办法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/4edb78e1c4a6e4b1b218a64b8ddafe7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*zRU57NY61K6oH87CpstCMw.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">黑暗中有一道光…对吗？(摄影:兰迪·欧)</p></figure><p id="9ec0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://medium.com/better-programming/character-encodings-the-pain-that-wont-go-away-part-1-2-non-unicode-dee7650fb6bf" rel="noopener"> <em class="lr">字符编码系列的第1部分在这里有。</em>T3】</a></p><p id="0d5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我开始撰写本文之前，我并不知道Unicode的起源始于20世纪80年代，Unicode Consortium于1991年1月正式合并，<a class="ae lq" href="https://unicode.org/history/publicationdates.html" rel="noopener ugc nofollow" target="_blank">于当年晚些时候发布了第一个标准</a>。就像字符编码的历史问题有几十年的历史一样，当前的解决方案也有几十年的工作。意思是，很复杂。</p><p id="973f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在写这篇文章的时候，我很难确定一个数据科学家需要了解Unicode的哪些知识才能有效地工作。虽然该标准非常技术性、深奥和复杂，但它在过去几十年中已经被业界如此完善和广泛采用，以至于大多数硬东西对用户来说都是透明的。令人惊讶的是，我们被允许如此理所当然。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="d389" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">作为一名数据科学家，您需要了解Unicode的哪些知识</h1><ol class=""><li id="42cb" class="mr ms it kw b kx mt la mu ld mv lh mw ll mx lp my mz na nb bi translated">Unicode通常能够毫无问题地存储您可能遇到的任何字符。</li><li id="c73c" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">截至Unicode 13.0(草稿，截至本文撰写时)，<a class="ae lq" href="https://www.unicode.org/versions/Unicode13.0.0/" rel="noopener ugc nofollow" target="_blank">标准中有143，859个字符</a>。</li><li id="9992" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">Unicode定义了一组1，114，112个码位，从0x0到0x10FFFF，可以映射到字符。其中绝大部分当前未被使用，并被保留以供将来使用。</li><li id="7a9c" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">排序、正则表达式等操作。也是在Unicode标准中定义的，所以一切通常都是行为良好的，即使是像从右到左的语言等。我们不需要担心它！</li><li id="d476" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">最佳实践是获取任何传入的文本，将其转换为UTF格式(通常是UTF-8或UTF-16)，并以该格式执行所有常规操作。</li><li id="bda4" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">当将传入文本转换为Unicode时，请尝试确定它的编码。字符集检测器本质上不可能是完美的。(<a class="ae lq" href="https://medium.com/better-programming/character-encodings-the-pain-that-wont-go-away-part-1-2-non-unicode-dee7650fb6bf" rel="noopener">参见第1部分</a>)</li><li id="9107" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp my mz na nb bi translated">只有在输出用于系统的数据时，才应该考虑转换为非Unicode编码。即便如此，99%的情况下还是输出到UTF-8比较好。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/4a296cec527c52f39b729cf0a5271d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dyOzDevH8w4Nk7xHUwzpQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">通常，如果你想处理文本输入，你应该做一些这样的事情</p></figure><p id="6c52" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于任何只需要“处理”Unicode数据的人来说，这已经足够了。对于一个如此复杂的标准来说，它少得惊人。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="18e7" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">但是如果我们真的想更好地理解Unicode，有什么好理解的呢？</h1><p id="9bd7" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">很多！虽然我们可能都知道Unicode是“适用于我们应该使用的所有语言的标准”，但它是一个庞大的标准，包含许多非常有趣的部分和有用的概念。大致了解它的工作原理将使您更好地理解如何处理文本数据。</p><p id="5059" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">先来偷看一下高层结构和争议点！</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="ef58" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">Unicode通过增加抽象层解决了字符编码冲突的问题</h1><p id="8c9d" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">像许多工程问题一样，增加一个抽象层可以使困难的问题更容易解决。这就是Unicode的实际作用。</p><p id="f77e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回想一下，像ASCII这样的传统字符编码是特定字母的二进制序列的严格定义。在ASCII中，0x41是大写的“a”。对于8位，只有256个潜在的数字来分配字符，并且前128个已经由ASCII定义。所以每个代码页对不同的字符重复使用相同的数字。</p><p id="d0cc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Unicode在一个字符的二进制表示和人类想要显示给其他人的实际字符之间放置了多个抽象层。</p><h2 id="0c5f" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">第1层和第2层:存在独立于编码的抽象字符，我们对进入标准的字符进行编码</h2><p id="1bf5" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode试图定义具有语义值的最小书写单位的编码。在欧洲语言中，这通常意味着字母和标点符号。对于东亚语言，这可能包括数千个标识字符。其他语言，如阿拉伯语，可能有更复杂的书写规则，如省略某些元音或组合字符。</p><p id="9fa9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些角色是抽象的，就像柏拉图式的理想。我们需要把它们变成现实。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi ob"><img src="../Images/4ea538093e9d6a9341c42ec10f17b99a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5sXMHdYCX6pzK-tKuV33hA.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">Unicode字符可能具有的(部分)潜在属性表</p></figure><p id="fca7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个抽象层之所以存在，是因为需要有“什么是应该用Unicode编码的字符？”当一个书写单位被纳入标准时，该抽象字符被编码，并被赋予一个名称和<a class="ae lq" href="http://www.unicode.org/glossary/#code_point" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">码点</strong> </a> <strong class="kw iu">。</strong>编码点以十六进制编码的U+####格式表示。U+0041被分配给“拉丁大写字母A”，这是“A”的抽象概念，而不是你在屏幕上看到的字体。</p><p id="04f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该字符也被输入到UCD、<a class="ae lq" href="https://unicode.org/ucd/" rel="noopener ugc nofollow" target="_blank"> Unicode字符数据库</a>，并被赋予各种<a class="ae lq" href="http://unicode.org/reports/tr44/#Property_Index" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">属性</strong> </a>。属性是Unicode工作如此顺畅的一个重要原因——它们表示诸如“小写”、“数值”等属性，表示字符是否应该排序，甚至表示双向算法应该如何处理字符的信息(L-to-R或R-to-L文本显示)。</p><h2 id="25d9" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">编码字符被分成17个平面</h2><p id="25a9" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode被组织成17个“<a class="ae lq" href="https://en.wikipedia.org/wiki/Plane_(Unicode)#Overview" rel="noopener ugc nofollow" target="_blank">平面</a>，每个平面有64k个代码点。绝大多数目前未被使用。</p><ul class=""><li id="a52d" class="mr ms it kw b kx ky la lb ld oc lh od ll oe lp of mz na nb bi translated">平面0:基本多语言计划，BMP —常用字符。</li><li id="295a" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">平面1:补充多语言平面，SMP——不常见的非表意字符。历史或不常见的文字、符号等。表情符号和表情符号生活在这里！</li><li id="dea2" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">平面2:补充表意平面，SIP——不常用表意字符。</li><li id="1681" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">平面3:第三代表意文字计划，TIP — <a class="ae lq" href="https://unicode.org/roadmaps/tip/" rel="noopener ugc nofollow" target="_blank">提议</a>用于Unicode 13.0(仍未发布)。将涵盖BMP或SIP中未涵盖的CJK表意文字，包括许多历史字符。</li><li id="2299" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">平面4–13:目前未分配，保留供将来使用。</li><li id="3a1e" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">飞机14:辅助专用飞机(SSP)。</li><li id="2a89" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">15，16号飞机:私人使用。</li></ul><p id="f940" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">平面上的64k代码点恰好使用代码点的最后四个十六进制数字进行编码，因此平面实际上是前面的一个额外数字，从0到f。这就是为什么BMP通常只显示为U+####，前面省略了0，而SMP将是U+1####，依此类推。</p><p id="445d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在每个平面内，数字块被分配给不同的语言或分组，以便共享相似主题的事物；例如“希腊语”或“表情符号”被分组在一起。</p><h2 id="6c24" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">第3层和第4层:字符在计算机中表示，并转换成比特</h2><p id="d234" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode定义了<a class="ae lq" href="http://www.unicode.org/glossary/#character_encoding_scheme." rel="noopener ugc nofollow" target="_blank">字符编码方案</a>，如UTF-8、UTF-16和UTF-32。这些规则定义了计算机如何使用特定的位序列(也称为代码单元)来指示所使用的Unicode字符。</p><p id="5e44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有多种方式对相同的码点进行编码；例如UTF-16、UTF-32、GB 18030等。有些是由统一码联盟(UTF-8，16，32)定义的，有些是由其他标准团体定义的。所有这些方案都编码相同的Unicode码位，因此(通常)可以在彼此之间自由转换。</p><p id="6e7e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这一部分被分成两层的原因是因为在UTF层之下，有另一个抽象层将编码字符转换成实际的位和字节。这是因为<a class="ae lq" href="https://en.wikipedia.org/wiki/Endianness" rel="noopener ugc nofollow" target="_blank">字节序</a>还是一个东西，不同的计算机架构会以不同的顺序写相同的位序列。当你交流数据时，需要考虑到这一点。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="b42a" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">UTF 8岁、16岁和32岁是怎么回事？</h1><p id="bed5" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">UTF名字后面的数字代表该格式工作的<em class="lr">代码单元</em>的大小。代码单元是单个字符可以使用的最小大小(以位为单位)。</p><p id="6992" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">UTF-8使用8位块来表示Unicode。显然，八位中只有256个值，所以它有办法扩展到使用两个、三个甚至四个字节来表示它需要的任何字符。它还具有非常独特的向后兼容ASCII的特性(因为UTF-8阅读器将读取ASCII，反之则不行)，因为用于编码切换到多字节的字节被分配给ASCII标准之外的字节。</p><p id="2fa6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">类似地，UTF-16用两个字节的块来表示事物。因此，如果它需要进入Unicode的一部分，而仅用两个字节是无法访问的，它将使用第二个块，总共四个字节来访问它。由于历史原因，许多操作系统在内部的不同地方使用UTF-16，因为Unicode最初是一种16位编码格式(后来他们意识到他们需要更多的空间来覆盖CJK字符，不得不扩展)。</p><p id="713f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另外，UTF-16有字节序。所以你可以有UTF-16LE(小端序)和UTF-16BE(大端序)。如果名称中没有指定字节顺序，字符串可以用<a class="ae lq" href="https://en.wikipedia.org/wiki/Byte_order_mark" rel="noopener ugc nofollow" target="_blank"> BOM(字节顺序标记)</a>来指定。字符串开头的0xFE 0xFF表示小端，0xFF 0xFE表示大端。</p><p id="bfdd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">UTF-32用四个字节来表示事物。但是它可以覆盖整个Unicode标准，而不需要UTF 8和16使用的任何可变宽度方案。对于许多用例来说，这是非常浪费的(大部分32位空间都是0，因为大多数平面都没有使用)，所以它几乎没有用处。但它仍然可用。</p><h2 id="d97b" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">UTF表单是自动同步的</h2><p id="3a12" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">UTF编码形式很有趣，因为它们不使用转义序列来表示切换到编码方案的不同区域，并且很容易识别字符边界。这是对由<a class="ae lq" href="https://en.wikipedia.org/wiki/ISO/IEC_2022" rel="noopener ugc nofollow" target="_blank"> ISO/IEC 2022 </a>引起的问题的直接反应，ISO/定义了转义序列来表示代码页内的切换字符集，并且通常用于CJK语言。</p><p id="2636" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们不想要转义序列，因为它会使字符串有状态。你需要阅读所有的东西，以确保你能抓住转义字符，理解每个后续字符是什么。这给搜索、连接文本等带来了巨大的问题。因为您必须扫描整个字符串才能找到所有的转义字符。</p><h2 id="a2e7" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">无论你在做什么，只要使用UTF格式</h2><p id="e8bb" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">总的来说，大多数在互联网上交流的东西都使用UTF-8。如果你处理的是ASCII文本，它就很简洁，互联网上的很多文本都是这样。如果您碰巧使用的是CJK语言，那么使用UTF-16可能会获得更好的文件大小。几乎没有理由使用UTF-32。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="8948" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">ISO/IEC 10646，另一个“Unicode”标准</h1><p id="c9dd" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">令人困惑的是，Unicode Consortium与ISO标准机构相协调，所以有相应的ISO标准。由ISO/IEC 10646定义的通用编码字符集与Unicode保持同步。人们经常交替使用这两个术语。但是，虽然这两者共享相同的字符映射，但它们之间存在巨大的差异。</p><p id="0633" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ISO/IEC 10646定义了通用字符集。它是独立于Unicode开始的，但是两者已经成为协调的同一件事。您有时会看到对较老的UCS-2(两个代表两个字节)的引用，对于plane 0 BMP，它的行为本质上类似于UTF-16。然而，UCS-2不能访问BMP之外的内容。现在已经过时了。</p><p id="7498" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">相反，当前的标准是UCS-4(四字节),本质上相当于UTF-32，但没有额外的Unicode语义，这使Unicode变得很棒。像泥浆一样清澈，对吗？</p><p id="4928" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终，两者之间的区别是:Unicode标准是<em class="lr">而不是</em>只是字符到数字的巨大映射。它还包括与排序(排序)和正则表达式相关的算法，以及编码(UTF-8等。)、安全(欺骗等。)，还有很多其他的东西。</p><p id="cfef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同时，ISO标准<em class="lr">是</em>主要只是一个巨大的字符到数字的映射。ISO/IEC 10646不包括Unicode的各种属性和算法来处理编码和排序顺序之类的事情。因此，理论上，有些东西可以兼容ISO/IEC 10646，但不能兼容Unicode，因为它没有实现所有额外的东西。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="a435" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">表情符号</h1><p id="814c" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">表情符号最近在互联网上风靡一时。不过，我仍然对老式表情符号情有独钟。</p><blockquote class="og"><p id="704a" class="oh oi it bd oj ok ol om on oo op lp dk">(ノ｀Д´)ノ彡┻━┻</p></blockquote><p id="191e" class="pw-post-body-paragraph ku kv it kw b kx oq ju kz la or jx lc ld os lf lg lh ot lj lk ll ou ln lo lp im bi translated">如你所知，<a class="ae lq" href="https://en.wikipedia.org/wiki/Emoji#History" rel="noopener ugc nofollow" target="_blank">表情符号最初是日本手机使用的专有文本扩展</a>。然后它们被采用到Unicode中(从Unicode 1.0中的79开始)，因为Unicode努力包含人们广泛使用的文本，这为日本手机之外的系统能够使用它们打开了大门(假设字体支持字符)。</p><p id="450d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">随着时间的推移，新的表情符号被添加到Unicode标准中。你(对，就是你！)可以尝试<a class="ae lq" href="http://unicode.org/emoji/proposals.html" rel="noopener ugc nofollow" target="_blank">提交一个新表情符号的提案</a>，如果你很有动力的话。提出并证明一个角色值得被纳入标准需要<em class="lr">大量的工作，但也许有人已经足够专注于此。</em></p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="a981" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">Unicode并不完美的地方</h1><p id="3db6" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode在绝大多数情况下都能正常工作，以至于您很少需要过多考虑它。但是如果你足够多的使用跨语言的文本，你会发现有些地方并不完美。</p><h2 id="5109" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">稳定政策是一把双刃剑</h2><p id="c6f9" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode在不断发展。为了防止局势完全混乱，他们有一套<a class="ae lq" href="https://unicode.org/policies/stability_policy.html" rel="noopener ugc nofollow" target="_blank">稳定政策</a>。比如:被编码的字符永远不会被移动，名字永远不会被改变，组合/分解的规范化等等。</p><p id="89c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然这样做是为了让Unicode保持向后兼容，但这也意味着某些种类的错误或失误，即使事后来看，也永远无法修复。你可以在<a class="ae lq" href="https://unicode.org/faq/normalization.html" rel="noopener ugc nofollow" target="_blank">规范化常见问题解答</a>中找到例子；例如“<em class="lr">阿拉伯字符的规范排序不是错误的吗？”一个更好的标准化方法可能是可行的，但是由于稳定性政策，现在不能改变。</em></p><h2 id="bf8c" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">存在旧字符和预先组合的字符</h2><p id="8766" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">Unicode有一种组合字符的方法。可以拿<em class="lr"> e </em> (U+0065)加一个“组合锐音”(U+0301)来造<em class="lr"> é。</em>也可以用<em class="lr"> é </em> (U+00E9)，称为“预组合字符”。预先组合的字符被放入Unicode标准中，以便与不完全兼容Unicode的系统(和字体)一起工作。如果软件不能由碎片组成字符，它可能能够使用预先组成的一个来代替。</p><p id="6910" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关于预组合字符的一件很酷的事情是，它们被认为等同于组合字符。U+0065 U+0301等于U+00E9。它们应该呈现相同的内容，各种排序/搜索算法应该对它们一视同仁。这是通过Unicode中指定的规范化算法来完成的。</p><p id="ec70" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">构图也是允许我们拥有<a class="ae lq" href="https://en.wikipedia.org/wiki/Combining_character#Zalgo_text" rel="noopener ugc nofollow" target="_blank"> Zalgo文本</a>的特性。t͉̥̯͙͒̆ͣ̍̑e̜̭͚͎̱̐͊̃ͥͪ͜ẋ̯̬͍̠̱́̊̔͡t̛̲͇͍͇̖͓̙̱̝̮ͦ̈́ͨͭt̢̟͙̫̱͉̙̻̔̉̈́̓͂ỏ̡̖̺̳̘̮̪̱͉̄̆ͥ̒̐̌̑ͅm̶̽ͭ̓a̛͍͈ͣ͗k̨̟̺̥̝͇̣ͫ̌e̜̳̣̟̫͖͊̈́ͣ̓͒͌ͭy̵o̬̰͚͍͘u͍͍̲̮ṛ̫͔̆͌̈ͥ̃̓ͬ͊́̽ͤ҉ë̴͓̠̎ͥͮyͤ̌̃̀ẻ͇̬̰͗͑ͭ͠s̠̗̼͈͎͉̉̓͌̌̅̚͟b̟̼̞̦̣̜̾ͅl̤̲̖̫̭̈́̒̂̅́e̱͍e͍̟̹͉ͦ̒͂̊̿͘ͅd͋͛͌͗͢.͇̆̔͐去咨询一个Zalgo文本生成器，如果你想惹恼你的朋友，结交新的敌人。</p><p id="a516" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Unicode还包括一些传统字符，如U+FB00、ﬀ、两个连在一起的f字符。在某些语言中，这被视为单个字符，但Unicode通常会将其视为两个字符，因为连字是一个字体/表示问题。但是它包含了这个字符，这样遗留代码页可以顺利地在Unicode之间来回转换。</p><h2 id="85bc" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">私人使用区(PUA)</h2><p id="0b0a" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">有两个完整的平面(15和16)，所以128k字符，加上平面0 BMP (U+E000-U+F8FF)中的6400区域，被指定为“私人使用区域”这些字符是Unicode consortium声明永远不会分配给这些范围的字符。相反，它是让用户来定义角色，并且完全由用户之间的协议来定义<a class="ae lq" href="http://www.unicode.org/faq/private_use.html" rel="noopener ugc nofollow" target="_blank">。事实上，如果你要创造你自己的角色，任意选择一个PUA代码点，并说服很多人使用那个字符作为代码点，你可以！</a></p><p id="171b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">PUA最常见的用途是在CJK语言中定义Unicode标准之外的额外字符。第二类人通常是学者，他们需要不受支持的语言的特殊字符。这些可能是遗产或历史人物，或特定的变体。有时，这样的字符最终会进入Unicode标准。在此之前，它们由标准机构、组织和字体制造商之间的协议编码。其他可能永远无法转换成Unicode的文字和特殊字符也可以使用PUA。</p><p id="56a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是因为所有的事情都是通过用户之间的协议来完成的，而且Unicode协会明确表示他们不提供任何机制让用户在标准内达成一致，<strong class="kw iu">冲突可能会出现</strong>。两个不同的系统可以对不同的字符使用相同的PUA码。</p><p id="75a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">令人欣慰的是，因为有一个代码点并没有太大的作用，除非你有一个字体，也有你想要显示的字符，这意味着没有太多的团体在广泛使用PUA。一些组织已经发布了各种标准和字体。公司也使用各种PUA点，比如在他们的软件或操作系统中包含独特的标志和符号。Linux吉祥物Tux以放荡不羁的字体生活在U+E000上。</p><p id="a0eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">PUA角色没有任何关联的属性，因此它会影响角色与显示/搜索/排序等内容的交互方式。</p><p id="4ddc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">无论如何，虽然很少遇到这些角色，但偶尔你会碰到他们。现在你知道为什么你有奇怪的字符，如果没有安装特定的字体就不能正确显示。</p><h2 id="e9f2" class="np ma it bd mb nq nr dn mf ns nt dp mj ld nu nv ml lh nw nx mn ll ny nz mp oa bi translated">汉统一</h2><p id="150c" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi">This is perhaps the messiest and most confusing part of Unicode. Languages like Chinese, Japanese, Korean, and Vietnamese use Han ideographs in their writing systems due to the influence China has had on the region historically. For example, the character 人 is used in all three languages and generally carries the same meaning.</p><p id="38c7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">多年来，通过各种语言改革和自然的语言变化，汉字获得了多种形式或不同的含义。在汉语中，mainland China使用的是<a class="ae lq" href="https://en.wikipedia.org/wiki/Simplified_Chinese_characters" rel="noopener ugc nofollow" target="_blank">简体字</a>，而台湾和其他一些地方继续使用<a class="ae lq" href="https://en.wikipedia.org/wiki/Traditional_Chinese_characters" rel="noopener ugc nofollow" target="_blank">繁体字</a>。日语有旧的和新的形式，它们共享一些简化，但不是全部。朝鲜文汉字在很大程度上类似于繁体字，但它们可以有自己的细微差别。一种语言创造了新的汉字，而另一种语言却没有使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/e32b6ecb78b3318e8293e390f3ba22ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*JA6JSlRjuKs1ERsNrYDPWQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">有些差异就像一个“发现差异”的游戏来源:<a class="ae lq" href="https://blogs.adobe.com/CCJKType/2012/01/genuine-han-unification.html" rel="noopener ugc nofollow" target="_blank"> Adobe </a></p></figure><p id="e6c4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，我们有许多语言(甚至方言)在概念上共享一组表意字符，但在一些字符的具体细节上可能有重大分歧。一种语言的旧形式可能在另一种语言中使用，或者一个字符在不同的媒体或历史时期可能有略微不同的表达，但保留相同的含义。对于一种语言来说，排版上的微小差异在另一种语言中可能是更有意义的差异。由于该地区悠久的地缘政治历史，它可能变得相当政治化。</p><p id="0d78" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与此同时，汉字已经占用了Unicode中大量的空间，因此不希望将每一个微小的差异都作为一个单独的代码点。所以Unicode坚持对“抽象”字符进行编码的原则，将小的字体差异视为表示上的怪癖，将字符合并到它们认为合适的一个代码点中，并将其他字符分开。</p><p id="c414" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Unicode对这个复杂的“<a class="ae lq" href="https://en.wikipedia.org/wiki/Han_unification" rel="noopener ugc nofollow" target="_blank">汉统一</a>”的处理一直存在争议。它必须区分某些字符在某种程度上是否“足够不同”,以作为一个单独的代码点。该标准在三维模型下工作，其中他们试图包括语义不同的事物(x轴)，或者具有不同抽象形状的事物(y轴)，但是最小化仅仅字体不同的事物(z轴)。y和z的区别是棘手的。你可以查看Unicode标准的<a class="ae lq" href="http://www.unicode.org/versions/Unicode12.1.0/ch18.pdf" rel="noopener ugc nofollow" target="_blank">第18章，了解更多相关信息。</a></p><p id="5dec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终结果是，Unicode将一个给定字符书写方式的许多细微差别视为字体问题，而不是语义问题。对于简体-繁体对，它们具有在语义上将它们链接在一起的属性。这样做的好处是，它将汉字概念化为跨所有语言共享，因此，如果您在一种语言中查找一个字符，它将允许您指示一个代码点来标识多种语言中的一个字符。</p><p id="6a38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但它也将区域差异视为字体问题，这意味着如果您在同一个文档中混合了中文、日文、韩文甚至越南语，您将无法显示正确的字形，除非您专门切换到该语言的正确区域字体——这一事实与Unicode允许每种语言在单个文档中使用(可能使用单一字体)的目标背道而驰。</p><p id="54d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让事情变得更加复杂的是，究竟哪些字符被认为是足够不同的，值得纳入该标准，这有点不一致。关于主题的<a class="ae lq" href="https://en.wikipedia.org/wiki/Han_unification#Rationale_and_controversy" rel="noopener ugc nofollow" target="_blank">维基百科页面已经足够令人费解了。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/2f75e8f3aec9252675397d1fcc1caf0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*TTl1LjCTkt9AiAQSD6e7Vw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">IVD的一部分显示了一些变化</p></figure><p id="6c7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">目前，<a class="ae lq" href="https://www.unicode.org/reports/tr37/" rel="noopener ugc nofollow" target="_blank"> Unicode技术标准#35 </a>已经创建了一种用表意文字变体数据库(IVD)指定特定变体字形的方法。IVD是一个表意变体序列(IVS，一个字符后跟一个范围为U+E0100到U+E01EF的变体选择器)的注册表，它选择一个不同于正常的字形。</p><p id="5954" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里还有一个比我更了解汉族统一的人的帖子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ox oy l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="1c74" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">幸运的是，我们很少需要考虑这些事情</h1><p id="f91b" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">作为主要处理数据的人，我们通常不需要处理那么多文本(除非你对自然语言处理、光学字符识别或类似领域感兴趣)。所以我们经常可以依靠我们的库来处理这个问题，天真地使用我们的字符串，继续前进。直到我们不得不直接分析文本…</p><p id="59fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以，现在，当你开始在舒适的“纯文本”网络上工作，并开始处理来自全球各地的文本时，对等待你的复杂性有一个概述是很好的。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="d857" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">感兴趣的读者可以进一步阅读</h1><p id="7387" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">虽然我已经在正文中放了大量的链接，但这里还有更多东西要戳。</p><ul class=""><li id="cb02" class="mr ms it kw b kx ky la lb ld oc lh od ll oe lp of mz na nb bi translated"><a class="ae lq" href="https://www.unicode.org/versions/Unicode12.0.0/UnicodeStandard-12.0.pdf" rel="noopener ugc nofollow" target="_blank">完整的Unicode 12.0标准</a> —警告，已经超过1000页了。</li><li id="0b5b" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated"><a class="ae lq" href="https://www.unicode.org/notes/tn23/" rel="noopener ugc nofollow" target="_blank">到BMP以及更远的地方</a> —这个演示始于2005年，解释了Unicode的许多基础知识。多(全？)由于Unicode的稳定性保证，它仍然是相关的。</li><li id="6570" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">https://www.unicode.org/standard/tutorial-info.html<a class="ae lq" href="https://www.unicode.org/standard/tutorial-info.html" rel="noopener ugc nofollow" target="_blank">—Unicode标准的教程/指南/演示。有些真的很深入。</a></li><li id="bae6" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi"><a class="ae lq" href="http://www.unicode.org/reports/tr15/" rel="noopener ugc nofollow" target="_blank">Normalization forms </a>— How Unicode will decompose/recompose text to determine the equivalence of characters. For example, here’s <a class="ae lq" href="https://www.unicode.org/cgi-bin/GetUnihanData.pl?codepoint=%E4%BA%BA" rel="noopener ugc nofollow" target="_blank">人</a>.</li><li id="1efd" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated"><a class="ae lq" href="https://www.unicode.org/charts/unihan.html" rel="noopener ugc nofollow" target="_blank"> Unihan数据库查找工具</a> —您可以在其中搜索han字符以查找详细信息。</li><li id="ccf1" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated"><a class="ae lq" href="https://en.wikipedia.org/wiki/Plane_(Unicode)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Plane _(Unicode)</a></li><li id="05e9" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated"><a class="ae lq" href="https://en.wikipedia.org/wiki/Comparison_of_Unicode_encodings" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Comparison _ of _ Unicode _ encodings</a></li><li id="36ba" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated"><a class="ae lq" href="https://www.quora.com/Is-Han-Unification-considered-a-failure-Why-is-it-so-difficult-to-unify-Han-characters" rel="noopener ugc nofollow" target="_blank">https://www . quora . com/Is-Han-Unification-consided-a-failure-Why-Is-it-so-difficult-Han-characters</a></li><li id="57a6" class="mr ms it kw b kx nc la nd ld ne lh nf ll ng lp of mz na nb bi translated">https://en.wikipedia.org/wiki/UTF-EBCDIC——一个对EBCDIC友好的UTF！满足您的大型机需求。</li></ul></div></div>    
</body>
</html>