# 如何避免安卓设备上的 WiFi 节流

> 原文：<https://betterprogramming.pub/how-to-avoid-wifi-throttling-on-android-devices-494a0cc29dd8>

## 继续讨论谷歌的局限性以及如何绕过它们

![](img/de1926ea03d86b721d0d9d3c6804ce4f.png)

[气体部分](https://dribbble.com/Gaspart)在[滴溜溜](https://dribbble.com/)上拍照。

今天我想讨论一下安卓新版本中的 WiFi 扫描节流以及如何避免。[之前我写过一篇文章](https://proandroiddev.com/android-wifi-scanning-frustrations-799d1d942aea)关于最近发布的 Android R 上的一个新的扫描机制，如果你看了那篇文章，你就知道谷歌像以前的 Android 版本一样限制开发者扫描 WiFi 的机会。

因此，让我们从回顾它以前是如何工作的，以及现在如何使用新的 Android R 获得类似的结果开始我们的文章。

# 之前是如何运作的

文章的这一部分会很简单，没有任何限制。没有任何限制，包括安卓奥利奥，你可以没有任何限制地每秒扫描一次。下面是一个简单的代码片段，解释了它之前是如何工作的:

您只需在您的上下文中注册广播接收器，以获取扫描结果并解析它们。然后你在你的 WiFi 管理器上调用`start scan`方法，它非常有效。曾经有一段时间，Android 允许每秒扫描 WiFi 高达十次。想象一下为[高质量导航](https://navigine.com/)打开的潜力。

但后来一切都出了问题，谷歌引入了 WiFi 扫描限制。

# 安卓 9 和 10

Android 9 一发布，谷歌就给所有开发者呈现了一个惊喜。WiFi 扫描被尽可能地裁剪。现在，您可以每 120 秒启动四次扫描。如果您尝试启动扫描更多次，那么您的所有尝试都将被阻止。

在我的上一篇文章中，我描述了一个以相等的时间间隔扫描和使用 WiFi RTT 的解决方案，但是值得注意的是，你不能完全避免节流。

顺便说一下，谷歌随着 Android 10 的发布推出了一个解决方案。他们在开发者设置中增加了一个可以关闭 WiFi 扫描节流的按钮，所以现在你可以关闭它，不受限制地扫描。但是，如果您为所有设备编写通用解决方案，那么您将不知道该选项是否关闭。主要问题是采用定制操作系统的设备(如华为、小米等。)因为他们没有关闭节流的选项。

# Android R 及其解决方案

Android R 在几周前发布，谷歌推出了新的扫描，因为旧的扫描随着 Android 9 的发布而被淘汰。所以现在他们增加了一个功能来检查节流是否关闭:

你只需要检查节流被禁用，你可以扫描没有任何限制。顺便说一下，这个解决方案只有在您测试本地应用程序时才是好的。对于通过 Play Market 和其他平台分发它，这个解决方案可能非常糟糕，因为用户需要打开开发者模式并在那里找到这个选项。

# 结论

谷歌限制了频繁的 WiFi 扫描，但增加了关闭节流的选项。看起来他们明白自己糟糕的决策，并试图以某种方式修复它。然而，这仍然给开发者和用户都带来了困难。

另一方面，iOS 上根本没有办法扫描 WiFi，所以我们应该感激我们所拥有的。