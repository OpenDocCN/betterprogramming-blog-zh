<html>
<head>
<title>Create a Typing Game With React Hooks, UseKeyPress, and Faker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React Hooks、UseKeyPress和Faker创建一个打字游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-typing-game-with-react-hooks-usekeypress-and-faker-28bbc7919820?source=collection_archive---------9-----------------------#2019-12-09">https://betterprogramming.pub/create-a-typing-game-with-react-hooks-usekeypress-and-faker-28bbc7919820?source=collection_archive---------9-----------------------#2019-12-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="847c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有趣的JavaScript教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/63807eb1b38683362f18fb54f1a4c146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PM-P9cMZDl1yLUR3iW2Jpg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://archive.org/details/msdos_Mario_Teaches_Typing_1992" rel="noopener ugc nofollow" target="_blank">https://archive.org/details/msdos_Mario_Teaches_Typing_1992</a></p></figure><p id="1ef4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">啊，那些美好的旧时光！打字游戏勾起回忆，回忆勾起回忆。如果你是像我一样在90年代开始使用电脑的90后之一，你可能玩过《马里奥教打字》。</p><p id="8461" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们所有使用电脑的人一定都玩过至少一个打字游戏。你想过自己造一个吗？</p><p id="9cb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章将教你如何在不到10分钟的时间内使用<a class="ae ky" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"> React Hooks </a>和<a class="ae ky" href="https://faker.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Faker </a>创建一个简单的打字游戏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/43634a1fc31491612dd463b2288d19d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bzVt_IMdXUVxpUfVrD0v6Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这将是你的应用程序的最终外观。激动吗？</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="cd2d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">什么是React钩子？</h1><p id="a9fc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">React钩子是在React 16.8.0中引入的。钩子为你的无状态组件(也称为功能组件)提供状态。</p><p id="7fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本钩有<code class="fe na nb nc nd b">useState</code>、<code class="fe na nb nc nd b">useEffect</code>、<code class="fe na nb nc nd b">useContext</code>。您可以根据不同的目的创建不同的挂钩。只有你的想象力是极限。</p><p id="4186" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是<a class="ae ky" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank"> React Hooks API参考</a>。为了避免讲述React和React钩子如何工作的冗长细节，我假设您已经对React和React钩子有了基本的了解。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="49bb" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">Faker是什么？</h1><p id="94cb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://www.npmjs.com/package/faker" rel="noopener ugc nofollow" target="_blank"> Faker </a>是一个npm包，它生成随机的、真实的、虚假的输入。它通常用在单元测试中，每次用不同的输入运行测试。您的测试可能会通过<code class="fe na nb nc nd b">foo bar baz</code>，但是在其他情况下可能会失败。</p><p id="fcd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果你的被测函数需要名字参数，你可以使用<code class="fe na nb nc nd b">faker.name.findName()</code>，它会给你<code class="fe na nb nc nd b">Myra Mills</code>、<code class="fe na nb nc nd b">Alexandrea Steuber</code>、<code class="fe na nb nc nd b">Magdalena Braun</code>等等。可以在<a class="ae ky" href="https://cdn.rawgit.com/Marak/faker.js/master/examples/browser/index.html#name" rel="noopener ugc nofollow" target="_blank"> Faker演示页面</a>上玩。</p><p id="82e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你的打字游戏中，你可以把它作为一个word数据源。稍后，您将构建一个不断发出单词供用户键入的单词生成器。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7428" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">创建打字狂潮反应应用程序</h1><p id="d255" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">既然您已经理解了依赖关系，那么是时候动手编写代码了。事不宜迟，在终端中创建您的项目:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="7050" class="ni me it nd b gy nj nk l nl nm">create-react-app <strong class="nd iu">typing-frenzy</strong></span></pre><p id="893c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们称你的应用程序为<em class="nn">打字狂潮</em>。等待所有软件包安装完毕，运行以下命令:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="4eed" class="ni me it nd b gy nj nk l nl nm">cd typing-frenzy<br/>npm start</span></pre><p id="a3fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的浏览器应该会弹出一个新的标签并加载<code class="fe na nb nc nd b">http://localhost:3000</code>。如果你看到这个屏幕，你就完成了20%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e7c2e45fa754f9327b37b4abe9990b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLmLS2XAhOE0nPuO5vGwlQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">紧接在create-react-app之后的默认UI</p></figure><p id="4026" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您安装的<code class="fe na nb nc nd b"><a class="ae ky" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank">create-react-app</a></code>版本，您可能会看到不同的屏幕截图。<code class="fe na nb nc nd b">create-react-app</code>的版本是3.1.1。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="fc6e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">构建单词生成器</h1><p id="0878" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在<a class="ae ky" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS Code </a>或任何你喜欢的IDE中打开项目。您的项目结构应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/c8adb42d6bbff1606059f68f0cba1adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KalpuA5pus_wppKoUyIddg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目结构</p></figure><p id="204f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里保留默认代码。稍后您将充分利用这个默认代码。</p><p id="30e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行以下命令安装Faker:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="93f2" class="ni me it nd b gy nj nk l nl nm">npm i faker</span></pre><p id="c1b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个位置创建一个新文件夹和一个新文件:<code class="fe na nb nc nd b">/src/utils/words.js</code>。打开文件并粘贴以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="9f73" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">将默认字数设置为10。</li><li id="4cc0" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">创建一个新的10的空数组并填充<code class="fe na nb nc nd b">undefined</code>。这是创建具有定义大小的数组的快速方法。</li><li id="fd1e" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">调用<code class="fe na nb nc nd b">faker.random.word()</code>发出单字或复合词。</li><li id="eaf4" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">用空格连接所有单词。</li></ul><p id="6b96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查看输出，请转到<code class="fe na nb nc nd b">App.js</code>，导入新出炉的<code class="fe na nb nc nd b">generate</code>函数，并记录输出:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="aac1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存文件并等待热重装。切换到浏览器，打开Chrome检查器(F12)，点击<em class="nn">控制台</em>标签。如果看不到任何输出，请刷新页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/c64f51cffa5ab7bf2b44eb49d5a31871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DpgNn83_-V-fV5blqhlzow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">控制台日志显示了单词生成器的输出</p></figure><p id="0fc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你看到像这样的随机单词，这意味着你的Faker和word generator工作正常。</p><p id="c9d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以多刷新几次页面来查看不同的一批单词。您应该注意到您的单词生成器具有以下特征:</p><ul class=""><li id="1dbc" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">没有复杂的符号。(可能有破折号、撇号、圆括号。)</li><li id="69bb" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">有些单词的首字母是大写的。</li><li id="58ed" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">超过10个字是因为<code class="fe na nb nc nd b">faker.random.word()</code>每次会发出一个字或者复合词。</li></ul><p id="e269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您完成测试后，删除<code class="fe na nb nc nd b">console.log</code>语句。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="aa58" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">建立按键挂钩</h1><p id="f255" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在<code class="fe na nb nc nd b">/src/hooks/useKeyPress.js</code>创建一个新文件夹和一个新文件。</p><p id="1722" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制粘贴以下要点，是<a class="ae ky" href="https://usehooks.com/useKeyPress/" rel="noopener ugc nofollow" target="_blank">https://usehooks.com/useKeyPress/</a>的修改版:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ol class=""><li id="43a9" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu oh ny nz oa bi translated">传入一个<code class="fe na nb nc nd b">callback</code>作为参数。您将在这个回调中完成大部分逻辑。</li><li id="a905" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">调用<code class="fe na nb nc nd b">useState</code>钩子为被按下的键创建一个状态。每次按下一个键，你将调用<code class="fe na nb nc nd b">setKeyPressed</code>来更新当前的键。</li><li id="dafb" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">在<code class="fe na nb nc nd b">useEffect</code>里面做你的关键更新操作。可以考虑类似于<code class="fe na nb nc nd b">componentDidMount</code>或者<code class="fe na nb nc nd b">componentDidUpdate</code>的<code class="fe na nb nc nd b">useEffect</code>。<a class="ae ky" href="https://reactjs.org/docs/hooks-reference.html#useeffect" rel="noopener ugc nofollow" target="_blank">更多详情在此</a>。</li><li id="ca9c" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">在<code class="fe na nb nc nd b">downHandler</code>中，当一个键被按下时，它是处理程序，您只根据两个条件更新被按下的键。首先，检查它是否是不同的键，以防止当用户长时间按住该键时注册相同的键击。第二，检查是否是单字符键，即不是CTRL、Shift、Esc、Delete、Return、Arrow等。</li><li id="b62d" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">在<code class="fe na nb nc nd b">upHandler</code>内部，当一个键被按下(释放)时，将当前键状态设置为<code class="fe na nb nc nd b">null</code>。这是为了让它很好地与步骤4一起工作。</li><li id="b967" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">向浏览器窗口注册处理程序。</li><li id="83b5" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">在<code class="fe na nb nc nd b">useEffect</code>的结尾，返回一个进行清理的函数。在这种情况下，用浏览器窗口注销处理程序。</li><li id="7c18" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">将<code class="fe na nb nc nd b">keyPressed</code>状态返回给调用者。在本教程中，您不必使用这个返回值。</li></ol><p id="c0fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看它是如何工作的。切换到<code class="fe na nb nc nd b">App.js</code>，导入<code class="fe na nb nc nd b">useKeyPress</code>，这样使用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="fd75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存并等待热重装。按下键盘上的任意键，查看您的应用程序收到哪个键。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/9def935c67e6f01644858dfaf9126695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*S2iQfGdbv3vLOGVjJMy_Dw.gif"/></div></div></figure><p id="db26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe na nb nc nd b">useKeyPress</code>挂钩非常好用。以后可以在其他项目中使用。再次删除<code class="fe na nb nc nd b">console.log</code>语句。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="77bd" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设计打字行的状态</h1><p id="182f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">状态取决于你希望你的打字游戏是什么样子的。您希望用户看到一些输入字符(用户必须键入的内容)和一些输出字符(用户已经键入的内容)。</p><p id="4f4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当前字符应该高亮显示，并始终保持在屏幕中央。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/438d746bffe6804c7039d24aef27e318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-CPbAHhGOC6tthVps3UgcA.jpeg"/></div></div></figure><p id="5608" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到您的<code class="fe na nb nc nd b">App.js</code>并添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="1c70" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">确保从<code class="fe na nb nc nd b">react</code>导入<code class="fe na nb nc nd b">{ useState }</code>。使用<code class="fe na nb nc nd b">useState</code>创建状态时，可以设置其初始值。</li><li id="f43f" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">leftPadding</code>:最初额外的20个空格，使<code class="fe na nb nc nd b">currentChar</code>保持在打字行的中间。</li><li id="1d39" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">outgoingChars</code>:空无一物。</li><li id="a156" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">currentChar</code>:从您的单词生成函数中排除的字符串的第一个字符。</li><li id="8d9a" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">incomingChars</code>:除第一个字符之外的单词生成器中的单词串。</li></ul><p id="75eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将存储<code class="fe na nb nc nd b">outgoingChars</code>和<code class="fe na nb nc nd b">incomingChars</code>中的所有字符，但是您将在UI中仅显示<code class="fe na nb nc nd b">outgoingChars</code>的最后 20个字符<em class="nn">和<code class="fe na nb nc nd b">incomingChars</code>的第<em class="nn">20个字符</em>。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4ebe" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">更新打字行的状态</h1><p id="fb9a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在<code class="fe na nb nc nd b">useKeyPress</code>的回调里面更新上面的四个状态。当您仍在<code class="fe na nb nc nd b">App.js</code>中时，更新<code class="fe na nb nc nd b">useKeyPress</code>的回调，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ol class=""><li id="7427" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu oh ny nz oa bi translated">将<code class="fe na nb nc nd b">outgoingChars</code>和<code class="fe na nb nc nd b">incomingChars</code>状态分配给临时变量，因为您需要多次使用它们。</li><li id="20c2" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">检查用户是否点击了正确的按键。否则，打字行的状态不会改变。</li><li id="4317" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">将<code class="fe na nb nc nd b">leftPadding</code>减少一个字符。对于前20次正确的击键，此条件将为真。</li><li id="1937" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">将<code class="fe na nb nc nd b">currentChar</code>附加到<code class="fe na nb nc nd b">outgoingChars</code>上。</li><li id="4a6a" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">用<code class="fe na nb nc nd b">incomingChars</code>的第一个字符更新<code class="fe na nb nc nd b">currentChar</code>。</li><li id="5e16" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">删除<code class="fe na nb nc nd b">incomingChars</code>的第一个字符。检查<code class="fe na nb nc nd b">incomingChars</code>是否还有足够的字数。如果没有，用<code class="fe na nb nc nd b">generate</code>功能补充10个以上生词。</li></ol></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="cce6" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">为输入行构建UI</h1><p id="3280" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">您将使用您的输入行替换<code class="fe na nb nc nd b">Edit src/App.js and save to reload.</code>。将你的注意力转移到你的<code class="fe na nb nc nd b">App</code>职能的<code class="fe na nb nc nd b">return</code>陈述上。用以下代码替换<code class="fe na nb nc nd b">&lt;p&gt;&lt;/p&gt;</code>标签:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7e89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码基本上是不言自明的。您为打字行的三个部分创建了三个<code class="fe na nb nc nd b">span</code>:</p><ul class=""><li id="c5d1" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">左图:<code class="fe na nb nc nd b">leftPadding</code>和<code class="fe na nb nc nd b">outgoingChars</code>的后20个字符。</li><li id="114f" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">中心:<code class="fe na nb nc nd b">currentChar</code>。</li><li id="986e" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">右图:<code class="fe na nb nc nd b">incomingChars</code>的前20个字。</li></ul><p id="b7c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">缺少样式。确保字体系列是等宽的很重要，这样每个字符都有相同的宽度，这保证了<code class="fe na nb nc nd b">currentChar</code>的位置总是保持在中心。</p><p id="8c60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将以下样式添加到<code class="fe na nb nc nd b">App.css</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ul class=""><li id="3dbb" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">font-family: monospace;</code>:将应用程序中的每个文本设置为等宽。</li><li id="3ca2" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe na nb nc nd b">white-space: pre;</code>:使尾随空格占据与其他可见字符相同的字符宽度。如果不设置此样式，尾随空格将被视为空白。</li></ul><p id="e11f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是相当多的编码。让我们测试你的应用程序并开始输入！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/201a61312e17bd2ac12396ba8f0e86f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/1*p15D34oZosRC4HyFAi2sug.gif"/></div></figure><p id="6eb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它看起来令人满意，但缺乏刺激，这是每分钟字数(WPM)和准确性。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4c2b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">构建WPM</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/88552ec18856f7dedc36eb98da52714f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ui9R0s9-TrP-GhnI9Y4yTA.png"/></div></div></figure><p id="e20c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">WPM的计算方法是将<em class="nn">字数</em>除以<em class="nn">分钟数</em>。也就是说，你还需要三个新的州:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="1ff5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得以毫秒为单位的当前时间，您需要一个简单的util函数。使用以下代码创建<code class="fe na nb nc nd b">/src/utils/time.js</code> <strong class="lb iu"> </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="de04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<code class="fe na nb nc nd b">{ currentTime }</code>导入<code class="fe na nb nc nd b">App.js</code>。用以下代码更新<code class="fe na nb nc nd b">App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ol class=""><li id="46da" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu oh ny nz oa bi translated">当用户开始输入第一个字符时，设置<code class="fe na nb nc nd b">startTime</code>。在应用程序完全安装之前不要设置它。用户不会高兴的。</li><li id="0083" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">当用户将要完成单词时，重新计算WPM。在这种情况下，您需要检查下一个要键入的字符是否是空格。</li><li id="a9d3" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">增加字数。</li><li id="0edd" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">以分钟为单位计算运行时间。虽然你会在一分钟之前得到<code class="fe na nb nc nd b">0.**</code>分钟，但是WPM仍然有效。</li><li id="48f8" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">设置WPM。将小数位数限制为两位。</li></ol><p id="ace3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经有了WPM状态，通过添加下面的代码来更新您的UI，就在<code class="fe na nb nc nd b">&lt;p&gt;&lt;/p&gt;</code>标签的下面:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="f57e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存并热重装您的应用程序。当你输入完第一个单词后，你会看到WPM更新。每打完一个字都会有波动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/93b6505cb763dafae3104af700cc3899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/1*i5kiMaEETuVjwxP1G_bK8Q.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你的WPM是多少？</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2490" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">构建准确性</h1><p id="81be" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">准确度是所有击键中正确击键的百分比。您已经有了正确的按键，即<code class="fe na nb nc nd b">outgoingChars</code>。用以下代码更新<code class="fe na nb nc nd b">App.js</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><ol class=""><li id="ce1e" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu oh ny nz oa bi translated">再宣布两个州。<code class="fe na nb nc nd b">accuracy</code>用于显示精度。<code class="fe na nb nc nd b">typedChars</code>用于存储所有按下的键。</li><li id="4b4b" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">通过追加所有已按下的键来更新<code class="fe na nb nc nd b">typedChars</code>。</li><li id="fe8e" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu oh ny nz oa bi translated">用<code class="fe na nb nc nd b">outgoingChars</code>的长度除以<code class="fe na nb nc nd b">typedChars</code>的长度来设定<code class="fe na nb nc nd b">accuracy</code>。将小数位数限制在两位。</li></ol><p id="17a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">WPM旁边显示精度(ACC ):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="9e8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存并重新加载。下面是《打字狂潮》的最终版本:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/43634a1fc31491612dd463b2288d19d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bzVt_IMdXUVxpUfVrD0v6Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">WPM vs准确率，你更在乎哪个？</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b8c6" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">还有什么可以补充的？</h1><p id="0706" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">还有几十个东西要补充。你可以显示一个计时器，将每次打字时间限制在一分钟，增加单词生成器的复杂性，显示前10个最常见的错误键，将你的React应用上传到GitHub页面，等等。</p><p id="6e74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打字狂潮在手机上不起作用，因为没有输入栏你无法调出软键盘。但是，应该有一个解决方法。如果对本教程的反应良好，可能会有第2部分。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b684" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">离别赠言</h1><p id="f653" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">React钩子改变了你定义和更新状态的方式。所有的操作都可以在不同的钩子中完成，这不需要您将功能组件更改为有状态组件。让你自己上钩吧！</p><p id="4b85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到<a class="ae ky" href="https://github.com/taingmeng/typing-frenzy" rel="noopener ugc nofollow" target="_blank">源代码</a>和<a class="ae ky" href="https://taingmeng.github.io/typing-frenzy/" rel="noopener ugc nofollow" target="_blank">现场演示</a>。我希望你喜欢这个教程！</p></div></div>    
</body>
</html>