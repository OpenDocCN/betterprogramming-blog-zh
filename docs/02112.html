<html>
<head>
<title>How To Draw Beautifully Animated Graphs in SwiftUI — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中绘制漂亮的动画图形—第2部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-draw-beautifully-animated-graphs-in-swiftui-part-2-597d7e1ef79e?source=collection_archive---------18-----------------------#2019-11-06">https://betterprogramming.pub/how-to-draw-beautifully-animated-graphs-in-swiftui-part-2-597d7e1ef79e?source=collection_archive---------18-----------------------#2019-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="25f0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过重用我们在上一篇文章中创建的<strong class="ak">胶囊栏</strong>来组合<strong class="ak">胶囊图视图</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ca56290da0dcd68fba62878b36c34929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e3RGAJmUIINNHCzkmg2Qow.png"/></div></div></figure><p id="e379" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们继续第1部分的条形图项目。</p><p id="3bfa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，创建一个新的结构，并将其命名为<code class="fe lq lr ls lt b">CapsuleGraphView</code>:</p><pre class="kj kk kl km gt lu lt lv lw aw lx bi"><span id="8b91" class="ly lz it lt b gy ma mb l mc md">struct CapsuleGraphView: View {</span><span id="b341" class="ly lz it lt b gy me mb l mc md">    var data: [Int]<br/>    var maxValueInData: Int<br/>    var spacing: CGFloat<br/>    var capsuleColor: ColorRGB</span><span id="e2aa" class="ly lz it lt b gy me mb l mc md">    var body: some View {</span><span id="e156" class="ly lz it lt b gy me mb l mc md">        Text("Hello")</span><span id="87c4" class="ly lz it lt b gy me mb l mc md">    }</span><span id="f842" class="ly lz it lt b gy me mb l mc md">}</span></pre><p id="077e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在初始设置中，我们创建了:</p><ul class=""><li id="3304" class="mf mg it kw b kx ky la lb ld mh lh mi ll mj lp mk ml mm mn bi translated">一个<code class="fe lq lr ls lt b">data</code> <strong class="kw iu"> </strong>变量，它将是我们要显示的值的数组；</li><li id="8cfe" class="mf mg it kw b kx mo la mp ld mq lh mr ll ms lp mk ml mm mn bi translated"><code class="fe lq lr ls lt b">maxValueInData</code>，用数组中的max值来设置填充的最大高度值；</li><li id="0b74" class="mf mg it kw b kx mo la mp ld mq lh mr ll ms lp mk ml mm mn bi translated"><code class="fe lq lr ls lt b">spacing</code>、<strong class="kw iu">、</strong>用于间隔图形；</li><li id="69c1" class="mf mg it kw b kx mo la mp ld mq lh mr ll ms lp mk ml mm mn bi translated">和<code class="fe lq lr ls lt b">capsuleColor</code>，用于为每个胶囊分配一种颜色。</li></ul><p id="f7a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们将实现图形本身。为此，我们需要一个<code class="fe lq lr ls lt b">GeometryReader</code>来正确检索显示尺寸，一个<code class="fe lq lr ls lt b">HStack</code>来水平对齐胶囊:</p><pre class="kj kk kl km gt lu lt lv lw aw lx bi"><span id="2051" class="ly lz it lt b gy ma mb l mc md">struct CapsuleGraphView: View {</span><span id="80f7" class="ly lz it lt b gy me mb l mc md">    var data: [Int]<br/>    var maxValueInData: Int<br/>    var spacing: CGFloat<br/>    var capsuleColor: ColorRGB<br/>    <br/>    var body: some View {</span><span id="432e" class="ly lz it lt b gy me mb l mc md">        GeometryReader { geometry in</span><span id="d44e" class="ly lz it lt b gy me mb l mc md">            HStack {</span><span id="22f2" class="ly lz it lt b gy me mb l mc md">                CapsuleBar(value: self.data[0], <br/>                           maxValue: self.maxValueInData, <br/>                           width: (CGFloat(geometry.size.width) - 8          * self.spacing) / CGFloat(self.data.count), <br/>                           valueName: "val1", <br/>                           capsuleColor: self.capsuleColor<br/>                 )</span><span id="2d53" class="ly lz it lt b gy me mb l mc md">                CapsuleBar(value: self.data[1], <br/>                           maxValue: self.maxValueInData, <br/>                           width: (CGFloat(geometry.size.width) - 8 * self.spacing) / CGFloat(self.data.count), <br/>                           valueName: "val2", <br/>                           capsuleColor: self.capsuleColor<br/>                 )</span><span id="c07a" class="ly lz it lt b gy me mb l mc md">                 CapsuleBar(value: self.data[2], <br/>                           maxValue: self.maxValueInData, <br/>                           width: (CGFloat(geometry.size.width) - 8 * self.spacing) / CGFloat(self.data.count), <br/>                           valueName: "val3", <br/>                           capsuleColor: self.capsuleColor<br/>                 )</span><span id="73c0" class="ly lz it lt b gy me mb l mc md">                 CapsuleBar(value: self.data[3], <br/>                           maxValue: self.maxValueInData, <br/>                           width: (CGFloat(geometry.size.width) - 8 * self.spacing) / CGFloat(self.data.count), <br/>                           valueName: "val4", <br/>                           capsuleColor: self.capsuleColor<br/>                 )</span><span id="6c20" class="ly lz it lt b gy me mb l mc md">                 CapsuleBar(value: self.data[4], <br/>                           maxValue: self.maxValueInData, <br/>                           width: (CGFloat(geometry.size.width) - 8 * self.spacing) / CGFloat(self.data.count), <br/>                           valueName: "val5", <br/>                           capsuleColor: self.capsuleColor<br/>                 )</span><span id="1056" class="ly lz it lt b gy me mb l mc md">            }</span><span id="25da" class="ly lz it lt b gy me mb l mc md">        }.frame(height: 500)<br/>}</span></pre><p id="f7aa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不幸的是，我们不能在这里使用<code class="fe lq lr ls lt b">ForEach</code>来按照我们想要的方式制作胶囊动画(希望这只是一个bug)，所以我们必须在<code class="fe lq lr ls lt b">HStack</code>中硬编码<code class="fe lq lr ls lt b">CapsuleBar</code> <strong class="kw iu"> </strong>组件五次。</p><p id="e91d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我已经设置了框架，这样图表就不会一直垂直延伸，但是如果你想让它更高，你可以取消这个限制。</p><p id="47dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">仅此而已！现在，当我们预览代码时，应该会看到类似这样的内容:</p><pre class="kj kk kl km gt lu lt lv lw aw lx bi"><span id="fb5d" class="ly lz it lt b gy ma mb l mc md"><strong class="lt iu">struct</strong> ContentView_Previews: PreviewProvider {<br/>    <strong class="lt iu">static</strong> <strong class="lt iu">var</strong> previews: <strong class="lt iu">some</strong> View {<br/>    CapsuleGraphView(data: [1, 2, 3, 4, 5],<br/>                     maxValueInData: 5,<br/>                     spacing: 24,<br/>                     capsuleColor: ColorRGB(red: 44 / 255, green: 54 / 255, blue: 79 / 255))</span><span id="08e1" class="ly lz it lt b gy me mb l mc md">    }</span><span id="ff29" class="ly lz it lt b gy me mb l mc md">}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/41a67b6bca2c69011f11ab37f0c047de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y8wLFmvj2pjMo8KuDrli5w.png"/></div></div></figure><p id="2237" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第3部分中，我们将在选择一个分段的选取器项目时，组合我们的视图并动画显示背景和图形。那里见！</p></div></div>    
</body>
</html>