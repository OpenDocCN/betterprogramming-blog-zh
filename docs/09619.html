<html>
<head>
<title>How To Design Relationships Between Your Django Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何设计Django模型之间的关系</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-design-relationships-between-your-django-models-caa01bc17a5c?source=collection_archive---------1-----------------------#2021-09-17">https://betterprogramming.pub/how-to-design-relationships-between-your-django-models-caa01bc17a5c?source=collection_archive---------1-----------------------#2021-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ccb9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Django中的一对一、一对多和多对多关系</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/37e63d7a0e0e0415f517f03c897d0b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CN051zrJsXvWP6KwZfVfow.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.pexels.com/photo/man-standing-while-holding-red-marker-pen-facing-marker-board-7369/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae ky" href="https://www.pexels.com/@startup-stock-photos?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">创业股票照片</a></p></figure><p id="579f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设计数据库是构建web应用程序最重要的部分之一。如果您使用关系数据库，维护表之间的正确关系是必须的。</p><p id="79cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<a class="ae ky" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>应用程序中的每个<a class="ae ky" href="https://docs.djangoproject.com/en/3.2/topics/db/models/" rel="noopener ugc nofollow" target="_blank">模型</a>代表一个数据库表。默认情况下，Django模型在关系数据库管理系统(RDBMS)上运行。因此，您需要设计Django模型，维护它们之间的适当关系。</p><p id="013b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将大致了解如何创建数据库表之间的关系。然后我们将看到如何在Django模型中实现这些关系。我们开始吧！</p><p id="86f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在关系数据库系统中，有三种类型的关系:</p><ul class=""><li id="4c63" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">一对一的关系</li><li id="be72" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">一对多关系(或多对一)</li><li id="559f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">多对多关系</li></ul><p id="5590" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Django模型支持这三种类型的关系。我们先用例子来了解一下每一种关系。然后我们将看到如何在Django模型中应用它们。</p><h1 id="d735" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">一对一的关系</h1><blockquote class="nb nc nd"><p id="b129" class="kz la ne lb b lc ld ju le lf lg jx lh nf lj lk ll ng ln lo lp nh lr ls lt lu im bi translated">“一对一关系意味着一个表中的一条记录恰好与另一个表中的一条记录相关联。”<em class="it"> — fmhelp </em></p></blockquote><p id="4d1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一对一关系的真实例子可以是一个国家及其首都。每个国家只有一个首都。而且每个首都都是唯一一个国家的首都。这种关系可以用下图表示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/d6db3287435a5c3b895e1d87118bb88d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*4cmBcTWG_qJ8nDEsubkj7g.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一对一关系|作者图片</p></figure><p id="d7c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看如何将它转换成Django模型。为了在Django中建立一对一的关系，使用了关键字<code class="fe nj nk nl nm b">OneToOneField</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="c2f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是如何在两个模型<code class="fe nj nk nl nm b">Country</code>和<code class="fe nj nk nl nm b">Capital</code>之间建立一对一的关系。</p><p id="e68e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看另一个例子:</p><p id="d2b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.djangoproject.com/en/3.2/topics/auth/" rel="noopener ugc nofollow" target="_blank"> Django认证</a>有一个默认模型<code class="fe nj nk nl nm b">User</code>。假设你正在建立一个电子商务平台，并想从<code class="fe nj nk nl nm b">User</code>扩展你的<code class="fe nj nk nl nm b">Customer</code>模型。您将执行如下操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5ce2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，也可以将一个用户添加为客户。一个用户不能是多个客户。</p><h1 id="12e8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">一对多关系</h1><blockquote class="nb nc nd"><p id="0370" class="kz la ne lb b lc ld ju le lf lg jx lh nf lj lk ll ng ln lo lp nh lr ls lt lu im bi translated">在一对多关系中，一个表中的一条记录可以与另一个表中的一条或多条记录关联<em class="it"> — fmhelp </em></p></blockquote><p id="e563" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以再次回到一个国家的例子。考虑一个国家和它的城市之间的关系。一个国家有多个城市。另一方面，每个城市只在一个国家。所以一个国家和它的城市是一对多的关系。我们可以用下图来表示这种关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/c2768501eed5f4f51c5408aefc0e2d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*086YfxmhLwapk90hFd6few.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一对多关系|作者图片</p></figure><p id="dac2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以这样翻译图表:一个国家可以有很多城市，每个城市只属于一个国家。</p><p id="76f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在Django模型中定义一对多的关系，我们需要使用关键字<code class="fe nj nk nl nm b">ForeignKey</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="abdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个一对多的关系中，<code class="fe nj nk nl nm b">Country</code>是父节点，<code class="fe nj nk nl nm b">City</code>是子节点。</p><p id="3e1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们回到电子商务的例子。我们在<code class="fe nj nk nl nm b">User</code>模型和<code class="fe nj nk nl nm b">Customer</code>模型之间建立了一对一的关系。客户将在电子商务平台上下单。<code class="fe nj nk nl nm b">Order</code>车型和<code class="fe nj nk nl nm b">Customer</code>车型会是什么关系？一个客户可以下很多订单，但是一个订单只能与一个客户关联。这在<code class="fe nj nk nl nm b">Customer</code>和<code class="fe nj nk nl nm b">Order</code>之间创建了一个一对多的关系。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><h1 id="388b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">多对多关系</h1><blockquote class="nb nc nd"><p id="47fb" class="kz la ne lb b lc ld ju le lf lg jx lh nf lj lk ll ng ln lo lp nh lr ls lt lu im bi translated">在多对多关系中，一个表中的多条记录可以与另一个表中的多条记录相关联<em class="it"> — fmhelp </em></p></blockquote><p id="385b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们考虑一个学校数据库中教师和科目之间的关系。一个老师可以教一门或多门课程。一个科目也可以由一个或多个老师来教。这就在教师和学科之间形成了多对多的关系。我们可以使用下图来表示这种关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/66ad537d86dc3e5e5d61d25fed5d6fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xJ7hfIfm71nmGUh8QDWrA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多对多关系|作者图片</p></figure><p id="9f62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在Django模型中定义多对多关系，我们需要使用关键字<code class="fe nj nk nl nm b">ManyToManyField</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="cddf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要注意的一点是，我们也可以在<code class="fe nj nk nl nm b">Teacher</code>模型中使用<code class="fe nj nk nl nm b">ManyToManyField</code>。这样的话，我们需要把<code class="fe nj nk nl nm b">Subject</code>类放在第一位。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="7127" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为这是一个多对多的关系，所以无论哪种方式都适用。</p><p id="8ec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">多对多关系的另一个例子是博客网站中的博客帖子和标签之间的关系。一篇博客文章可以共享许多标签，一个标签可以在许多博客文章之间共享。</p><p id="ab0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑这篇关于姜戈的文章。它可能有多个标签:编程、web开发、Django、Python等。另一篇与Python和Django相关的不同文章可能有类似的标签。所以这是一个多对多的关系。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="b731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设计数据库是web应用程序构建过程的一个重要部分。无论您使用什么堆栈，这都是您在计划构建web应用程序时应该做的第一件事。</p><p id="7a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我描述了如何在Django应用程序中创建模型之间的关系。如果您在Django应用程序中使用关系数据库设计，您必须维护模型之间的正确关系。</p><p id="9dd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望通过这篇文章，您能够清楚地了解数据库关系是如何工作的。以及如何在Django模型中应用它们。感谢阅读。</p><h1 id="d3aa" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">参考</h1><ul class=""><li id="620c" class="lv lw it lb b lc nr lf ns li nt lm nu lq nv lu ma mb mc md bi translated"><a class="ae ky" href="https://docs.djangoproject.com/en/3.2/topics/db/examples/one_to_one/" rel="noopener ugc nofollow" target="_blank">https://docs . django project . com/en/3.2/topics/db/examples/one _ to _ one/</a></li><li id="7708" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://docs.djangoproject.com/en/3.2/topics/db/examples/many_to_one/" rel="noopener ugc nofollow" target="_blank">https://docs . django project . com/en/3.2/topics/db/examples/many _ to _ one/</a></li><li id="7c05" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://docs.djangoproject.com/en/3.2/topics/db/examples/many_to_many/" rel="noopener ugc nofollow" target="_blank">https://docs . django project . com/en/3.2/topics/db/examples/many _ to _ many/</a></li></ul></div></div>    
</body>
</html>