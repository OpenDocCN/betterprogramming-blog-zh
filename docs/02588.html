<html>
<head>
<title>Best Practices for Generating Secure Passwords and Tokens in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python生成安全密码和令牌的最佳实践</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/best-practices-for-generating-secure-passwords-and-tokens-in-python-ebb91d459267?source=collection_archive---------6-----------------------#2019-12-10">https://betterprogramming.pub/best-practices-for-generating-secure-passwords-and-tokens-in-python-ebb91d459267?source=collection_archive---------6-----------------------#2019-12-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="935b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用内置模块生成加密保护的密码和令牌</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7fb4017e30dcd5d1a775048aa3ef5b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQXhz1tR6FwsXk0VOJJgIw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">詹姆斯·萨顿的照片</p></figure><p id="08c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将学习生成强随机密码和加密保护令牌的正确方法。拥有安全随机数使我们能够管理敏感信息，如密码和安全令牌。我们将使用从Python 3.6开始可用的secrets模块。<a class="ae ky" href="https://docs.python.org/3/library/secrets.html" rel="noopener ugc nofollow" target="_blank">官方文件</a>声明:</p><blockquote class="lv lw lx"><p id="d6d8" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">“…应优先使用机密，而不是随机模块中的默认伪随机数生成器，随机模块是为建模和模拟而设计的，而不是为安全或加密而设计的。”</p></blockquote><p id="ea5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文分为三个部分:</p><ol class=""><li id="0854" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">基本用法</li><li id="0d0a" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">例子</li><li id="5d9b" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">结论</li></ol><p id="ea38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="ef51" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">1.基本用法</h1><p id="00fc" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">secrets模块提供了一些内置函数，我们可以用它们来生成数字和令牌。不需要设置，但我们需要在使用之前导入模块。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="0940" class="nz my it nv b gy oa ob l oc od">import secrets</span></pre><h2 id="afc7" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成一个随机数</h2><p id="5935" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">使用<code class="fe op oq or nv b">randbelow</code>功能生成一个数字。它接受一个整数，生成的数字介于0和输入整数减1之间。输入的整数必须大于0</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="eca6" class="nz my it nv b gy oa ob l oc od">secrets.randbelow(2) # generate either 0 or 1<br/>secrets.randbelow(10) # generate a number from 0 to 9<br/>secrets.randbelow(0) # error<br/>secrets.randbelow(-10) # error</span></pre><p id="96d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以使用<code class="fe op oq or nv b">randbits</code>函数来生成一个随机数。它接受一个表示位数的整数。输入的整数必须大于0。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="80c2" class="nz my it nv b gy oa ob l oc od">secrets.randbits(1) # generate either 0 or 1<br/>secrets.randbits(2) # generate a number from 0 to 3<br/>secrets.randbits(4) # generate a number from 0 to 15<br/>secrets.randbits(8) # generate a number from 0 to 255</span></pre><h2 id="6c71" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">从列表中生成随机元素</h2><p id="2499" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">该模块还为我们提供了从非空序列中选择随机元素的方法。让我们使用<code class="fe op oq or nv b">choice</code>功能来试试吧</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="1a68" class="nz my it nv b gy oa ob l oc od">colour = ['red', 'blue', 'green', 'purple', 'yellow']<br/>secrets.choice(colour)</span></pre><h2 id="a92f" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成随机字节串</h2><p id="404d" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated"><code class="fe op oq or nv b">token_bytes</code>函数是生成字节的完美选择。您可以指定一个整数作为参数。如果你不指定任何东西，它将确定一个随机整数。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="adde" class="nz my it nv b gy oa ob l oc od">secrets.token_bytes(8) # generate 8 random bytes string</span></pre><p id="5b8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该会看到类似这样的随机字节字符串:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="baf1" class="nz my it nv b gy oa ob l oc od">b'\x1bq\x8e\x83\x08\xb2g\x17'</span></pre><h2 id="166b" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成一个十六进制的随机字符串</h2><p id="0d5e" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">如果你想要一个十六进制的字符串，你可以使用<code class="fe op oq or nv b">token_hex</code>函数。就像<code class="fe op oq or nv b">token_bytes</code>函数一样，它接受一个整数，这个整数用来产生n个字节，每个字节稍后将被转换成两个十六进制数字。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="9d07" class="nz my it nv b gy oa ob l oc od">secrets.token_hex(16) # generate 16 random hexadecimal string</span></pre><p id="4e41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个输出示例:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="7ac6" class="nz my it nv b gy oa ob l oc od">cd7b7fb7e0c5c1fa17389050f884526e</span></pre><h2 id="e3f5" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成URL安全的字符串</h2><p id="02fd" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">有时，您可能希望为您的web应用程序使用Base64编码的字符串。对于这种用例来说,<code class="fe op oq or nv b">token_urlsafe</code>函数非常方便。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="8108" class="nz my it nv b gy oa ob l oc od">secrets.token_urlsafe(16)</span></pre><p id="fc14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我得到了以下结果:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="8ce1" class="nz my it nv b gy oa ob l oc od">S357dE8QSuE</span></pre></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="7f72" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">2.例子</h1><p id="7c74" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">在这一节中，我将概述一些生成安全密码和令牌的最佳实践。请自行测试它们。</p><h2 id="3fdb" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成10个字符的字母数字密码</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="f178" class="nz my it nv b gy oa ob l oc od">import string<br/>import secrets</span><span id="ee33" class="nz my it nv b gy os ob l oc od">alphabet = string.ascii_letters + string.digits<br/>password = ''.join(secrets.choice(alphabet) for i in range(10))<br/>print(password)</span></pre><ul class=""><li id="2984" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu ot mi mj mk bi translated"><code class="fe op oq or nv b">ascii_letters</code> —包含从A到Z的小写和大写</li></ul><h2 id="0ccd" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成一个包含标点符号的10个字符的十六进制密码</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="5f42" class="nz my it nv b gy oa ob l oc od">import string<br/>import secrets</span><span id="abf3" class="nz my it nv b gy os ob l oc od">alphabet = string.hexdigits + string.punctuation<br/>password = ''.join(secrets.choice(alphabet) for i in range(10))<br/>print(password)</span></pre><h2 id="a54c" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成10个字符的密码，至少包含一个小写字母、一个大写字母和一个数字</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="4fc3" class="nz my it nv b gy oa ob l oc od">import string<br/>import secrets</span><span id="21ec" class="nz my it nv b gy os ob l oc od">alphabet = string.ascii_letters + string.digits<br/>while True:<br/>    password = ''.join(secrets.choice(alphabet) for i in range(10))<br/>    if (any(c.islower() for c in password) and any(c.isupper() for c in password) and any(c.isdigit() for c in password)):<br/>        break</span><span id="a337" class="nz my it nv b gy os ob l oc od">print(password)</span></pre><ul class=""><li id="6ab2" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu ot mi mj mk bi translated"><code class="fe op oq or nv b">islower </code> —确定字符是否为小写</li><li id="be08" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu ot mi mj mk bi translated"><code class="fe op oq or nv b">isupper</code> —确定字符是否大写</li><li id="e9d8" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu ot mi mj mk bi translated"><code class="fe op oq or nv b">isdigit</code> —确定字符是否为数字</li></ul><h2 id="8d5d" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成一个10个字符的密码，至少包含两个大写字母和两个数字</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="01ba" class="nz my it nv b gy oa ob l oc od">import string<br/>import secrets</span><span id="d0df" class="nz my it nv b gy os ob l oc od">alphabet = string.ascii_letters + string.digits<br/>while True:<br/>    password = ''.join(secrets.choice(alphabet) for i in range(10))<br/>    if (sum(c.isupper() for c in password) &gt;= 2 and sum(c.isdigit() for c in password) &gt;= 2):<br/>        break</span><span id="6597" class="nz my it nv b gy os ob l oc od">print(password)</span></pre><h2 id="15e9" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">生成唯一的四字密码</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="2e73" class="nz my it nv b gy oa ob l oc od">import secrets</span><span id="0f35" class="nz my it nv b gy os ob l oc od">animal = ['horse', 'elephant', 'monkey', 'donkey', 'goat', 'chicken', 'duck', 'mouse']<br/>fruit = ['apple', 'banana', 'peach', 'orange', 'papaya', 'watermelon', 'durian']<br/>electronic = ['computer', 'laptop', 'smartphone', 'battery', 'charger', 'cable']<br/>vegetable = ['lettuce', 'spinach', 'celery', 'cabbage', 'turnip', 'cucumber', 'eggplant']<br/>word_list = animal + fruit + electronic + vegetable</span><span id="cc9f" class="nz my it nv b gy os ob l oc od">password = set()<br/>while True:<br/>    password.add(secrets.choice(word_list))<br/>    if(len(password) &gt;= 4):<br/>        break</span><span id="4a98" class="nz my it nv b gy os ob l oc od">print(' '.join(password))</span></pre><h2 id="f701" class="nz my it bd mz oe of dn nd og oh dp nh li oi oj nj lm ok ol nl lq om on nn oo bi translated">为密码重置生成一个带有安全令牌的临时URL</h2><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="58b3" class="nz my it nv b gy oa ob l oc od">import secrets</span><span id="25c9" class="nz my it nv b gy os ob l oc od">url = 'https://mywebsite/reset?key=' + secrets.token_urlsafe()<br/>print(url)</span></pre></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="5911" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">3.结论</h1><p id="dd7b" class="pw-post-body-paragraph kz la it lb b lc np ju le lf nq jx lh li nr lk ll lm ns lo lp lq nt ls lt lu im bi translated">让我们回顾一下今天所学的内容。我们开始探索由<code class="fe op oq or nv b">secrets</code>模块提供的基本功能。</p><p id="8043" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们测试生成一些随机密码和字符串令牌或字节令牌的函数。</p><p id="7ba6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们尝试使用该模块，生成了几种不同类型的安全可靠的密码。</p><p id="3c3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，您不应该将您的密码存储在任何容易恢复的纯文本或加密文件中。应该使用不可逆的单向哈希函数对它们进行加盐和哈希处理。</p><p id="aa92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，希望你喜欢这篇教程。下一篇文章再见。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="7223" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">参考</h1><ol class=""><li id="0a20" class="mc md it lb b lc np lf nq li ou lm ov lq ow lu mh mi mj mk bi translated"><a class="ae ky" href="https://docs.python.org/3.6/library/secrets.html#module-secrets" rel="noopener ugc nofollow" target="_blank">https://docs . python . org/3.6/library/secrets . html # module-secrets</a></li></ol></div></div>    
</body>
</html>