<html>
<head>
<title>Easy Sorting, Searching, Tagging Elements in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中轻松排序、搜索和标记元素</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swiftui-sorting-searching-tagging-elements-like-a-delivery-app-b607fba5ba70?source=collection_archive---------1-----------------------#2021-12-15">https://betterprogramming.pub/swiftui-sorting-searching-tagging-elements-like-a-delivery-app-b607fba5ba70?source=collection_archive---------1-----------------------#2021-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6cdc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在SwiftUI中构建类似交付的应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/00d5cffcb4c9f6612e6264afc905d030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1nqdQoU1tn168Uw2"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">布雷特·乔丹在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我这次尝试的是开发一些有趣的方法来从数据库中搜索、排序和标记元素。为此，我制作了一个交付应用程序的例子。</p><p id="c4c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">让我们来看一看最终的视图。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/0c885e489199623d9ac5d3f60672ed49.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*bj2umBZhqo-qNsxKeztapw.gif"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/aba787ffe1ecb8633048c247e72d77d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*JqFvp8IU9G1M9vwf59mayA.gif"/></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="0723" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">关键功能</h1><p id="4f47" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">让我们来看看我们将要使用的一些函数。</p><ol class=""><li id="17ac" class="my mz iq ky b kz la lc ld lf na lj nb ln nc lr nd ne nf ng bi translated"><code class="fe nh ni nj nk b">JSONDecoder()</code>:解码JSON数据库时使用</li><li id="b3af" class="my mz iq ky b kz nl lc nm lf nn lj no ln np lr nd ne nf ng bi translated"><code class="fe nh ni nj nk b">sort(), filter()</code>:在处理我们使用的型号列表时使用。</li></ol><p id="c101" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，一点也不难。那我们开始吧。</p><h1 id="2e9b" class="mb mc iq bd md me nq mg mh mi nr mk ml jw ns jx mn jz nt ka mp kc nu kd mr ms bi translated">设置模型</h1><p id="b4e6" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">让我们先建立我们的模型，使数据处理简单一点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="ef0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了方便起见，我创建了一些名为<code class="fe nh ni nj nk b">Food</code>的新数据类型，其中包含了各种美食。最初自定义的数据类型不是<code class="fe nh ni nj nk b">Codable</code>，而是通过制作<code class="fe nh ni nj nk b">enum</code>本身<code class="fe nh ni nj nk b">Codable</code>，我们可以顺利处理这个问题。想了解<code class="fe nh ni nj nk b">Codable</code>，看<a class="ae kv" href="https://developer.apple.com/documentation/swift/codable" rel="noopener ugc nofollow" target="_blank">这里</a>。简单地说，它使JSON编码/解码变得容易。</p><p id="7ae8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想构建一个更复杂的，你可以像我在这篇文章底部附加的原始代码中所做的那样，编写自定义的编码规则。然而，在这种情况下，如果没有编码、解码规则，似乎不会发生任何错误。</p><h1 id="c725" class="mb mc iq bd md me nq mg mh mi nr mk ml jw ns jx mn jz nt ka mp kc nu kd mr ms bi translated">从数据库加载数据(JSON)</h1><p id="e6e6" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">为了方便起见，我们将使用本地文件存储数据。让我们编写一个<code class="fe nh ni nj nk b">ListViewModel</code>来从文件中加载数据。JSON文件如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5444" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多亏了<code class="fe nh ni nj nk b">codable</code>，我们可以非常轻松地解码JSON。</p><p id="1de9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们所要做的就是简单地导入<code class="fe nh ni nj nk b">.json</code>文件(<em class="ls">请注意，您应该在执行此</em>之前添加目标)，方法是获取文件<code class="fe nh ni nj nk b">Bundle.main.url</code>的本地URL路径，并将其传递给<code class="fe nh ni nj nk b">Data(contentOf: )</code>以获取数据。到时候剩下的辛苦工作就交给你了。之后，我们最终可以得到从<code class="fe nh ni nj nk b">DBdata.json</code>解码的<code class="fe nh ni nj nk b">Store</code>信息列表。</p><h1 id="2988" class="mb mc iq bd md me nq mg mh mi nr mk ml jw ns jx mn jz nt ka mp kc nu kd mr ms bi translated">连接到视图</h1><p id="e9dc" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">正如您在结果预览中看到的，我们将添加一个包含搜索栏和排序选项的应用程序栏。</p><p id="3bdc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">先说根视图，<code class="fe nh ni nj nk b">ListView</code>。</p><blockquote class="nx ny nz"><p id="f05a" class="kw kx ls ky b kz la jr lb lc ld ju le oa lg lh li ob lk ll lm oc lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq"> ListView </em> </strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d671fdaa8305d07ec1db508f95a191f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/1*U4FAU9YaHx36WSxeyjdrIw.gif"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="d876" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最引人注目的部分大概就是<code class="fe nh ni nj nk b">filter</code>部分了。我们可以通过使用<code class="fe nh ni nj nk b">ForEach</code>中的<code class="fe nh ni nj nk b">.filter()</code>来获取过滤后的<code class="fe nh ni nj nk b">Store</code>信息。过滤关键字<code class="fe nh ni nj nk b">inputText</code>和<code class="fe nh ni nj nk b">isOnSale</code>将在<code class="fe nh ni nj nk b">AppBarView</code>中处理。请原谅我的懒惰，我只实现了搜索“出售”标签。如果你想添加更多的标签，使用标签关键词列表是避免硬编码的好方法。</p><p id="8a10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除此之外，我还使用了<code class="fe nh ni nj nk b">LazyVstack</code>来防止页面波动。而且，这是它的这个观点。现在让我们继续讨论<code class="fe nh ni nj nk b">AppBarView</code>。</p><blockquote class="nx ny nz"><p id="9be3" class="kw kx ls ky b kz la jr lb lc ld ju le oa lg lh li ob lk ll lm oc lo lp lq lr ij bi translated"><strong class="ky ir">T22】AppBarViewT24】</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/e3de65f32ffe3175e820887bff2f1f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ZVC8Y2nWejBQJsmCkWjGmA.png"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="8fc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它看起来很长，但是实际上并没有什么困难。我在这里只做了几件事，添加排序函数、选择器和按钮来改变绑定值。</p><p id="ef92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了方便起见，我写了<code class="fe nh ni nj nk b">SortBy</code>枚举，你可以在第二段代码中看到(更新<code class="fe nh ni nj nk b">ListViewModel.swift</code>)。这种方法特别有利于简化复杂条件的处理和提高可读性。我在第一个代码(<code class="fe nh ni nj nk b">AppBarView.swift</code>)中使用的<code class="fe nh ni nj nk b">picker</code>类也是制作选择选项视图的更好的建议，该视图从iOS 14开始可用。</p><p id="2cae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看看最后一个视图，它包含了实际的形状，<code class="fe nh ni nj nk b">StoreView</code>。</p><blockquote class="nx ny nz"><p id="f8e2" class="kw kx ls ky b kz la jr lb lc ld ju le oa lg lh li ob lk ll lm oc lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq"> StoreView </em> </strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f0763c856b7044bd4ee55f975014c41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*gxPH48oaJ7q-KpIJ7GVKsw.png"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7962" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个简单的布局，所以你可能没有什么不能理解的。但是，正如你可能注意到的，在<code class="fe nh ni nj nk b">DBdata.json</code>中，<code class="fe nh ni nj nk b">imageURL</code>的形式有点奇怪。为此，我做了一个扩展，从那个奇怪的路径中提取图像。</p><p id="949b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结束了。你现在可以得到和我开始展示的一样的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/0c885e489199623d9ac5d3f60672ed49.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*bj2umBZhqo-qNsxKeztapw.gif"/></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="e820" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">完整源代码</h1><div class="og oh gp gr oi oj"><a href="https://github.com/enebin/MyDelivery" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">GitHub - enebin/MyDelivery</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">github.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kp oj"/></div></div></a></div></div></div>    
</body>
</html>