<html>
<head>
<title>It’s Time To Kill Visual Basic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">是时候干掉Visual Basic了</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/its-time-to-kill-visual-basic-ed6bab4f437a?source=collection_archive---------5-----------------------#2021-07-15">https://betterprogramming.pub/its-time-to-kill-visual-basic-ed6bab4f437a?source=collection_archive---------5-----------------------#2021-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e00f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这对每个人都不好，包括你</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/209b3e34523ea5c4cec7399eebffb33d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b2YALg9Feryv1xU9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机器人神童在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="4262" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Visual Basic (VB)在许多开发人员心中占有特殊的地位。对于很多人来说，他们写的第一个代码是用VB写的。如果你懂VB，你可以创建桌面和网络应用程序，甚至可以在Excel或Word等应用程序中自动完成任务。在PowerShell出现之前，我们可以使用VBScript直接与Windows交互，自动执行任务，甚至处理更复杂的事情。</p><p id="8a27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我们真的需要停止使用它。这对我不好，对你不好，对所有人都不好。如今的Visual Basic与大约30年前开始时完全不同。这个区别很大程度上可以归结为说，在1991年，它是有前途的。今天，它没有。</p><p id="245e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">30年前的那一年，全世界都接触到了Visual Basic。大约在这个时候，RAD(快速应用开发)开始流行。开发人员可以将控件拖放到表单上，然后轻松地连接一些功能，这一想法立即吸引了任何对创建应用程序感兴趣的人，而VB使这一点变得更加容易实现。为了补充这一点，Visual Basic被证明是易于学习和理解的，这在当时被证明对初露头角的开发人员是有用的。</p><p id="8e0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，现在我们是在2021年，在Visual Basic最初发布的三十年后。这是一次伟大的奔跑，但是是时候离开了。为什么呢？嗯，VB有三种主要形式，让我们来看看每一种。这些是。NET (VB。NET)、Visual Basic for Applications(用于在Word或Excel中创建宏)和VBScript。让我们想想为什么是时候继续前进了。</p><h1 id="3e13" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Visual Basic。网</h1><p id="f5b0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">VB。NET和C#几乎同时出现。然而，Visual Basic的概念已经存在于VBScript和Visual Basic for Applications中。这意味着人们开始使用VB.NET比学习一门全新的语言如C#更容易。当时，它比使用Visual Basic 6要好，但现在，使用它来启动新项目是一个坏主意，任何现有的项目都开始积累越来越多的技术债务。为什么？</p><h2 id="9973" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">缺乏简洁性</h2><p id="7a30" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">几乎每种语言都有lambdas。Lambdas是将参数从一个函数传递到另一个函数的简单表达方式。当我们想要将一个条目列表从一种类型映射到另一种类型时，我们通常会使用lambdas。</p><p id="fa80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种更合理的语言通常通过以下方式实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="2609" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不确定有多少种语言以这种方式实现了lambdas，但据我所知，C#、Dart、TypeScript和最近的JavaScript版本(ES6)都支持使用arrow函数。如果您将这些代码展示给任何使用这些语言的开发人员，他们可能会明白发生了什么。</p><p id="2242" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Visual Basic非常冗长，没有任何原因。也许人们认为更多的单词意味着对于刚起步的开发人员来说更容易理解，但是我认为更多的单词意味着更容易误解正在发生的事情。Visual Basic不支持箭头函数。相反，你得到了这个。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="0181" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Visual Basic抛出了一个毫无意义的关键字<code class="fe ng nh ni nj b">Function</code>,并让我们将操作符放在括号中。而且记住，微软还做了C#和TypeScript，它们都有箭头函数支持。这里到底发生了什么？添加箭头功能是否违背某种语言指南？如果是这样，我们应该感到担忧。</p><p id="294d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许最奇怪的是，这正是在ES6之前JavaScript处理lambda的方式。感谢那些制作Babel transpiler的好人，JavaScript开发人员可以随心所欲地编写箭头函数，Babel transpiler会用旧的<code class="fe ng nh ni nj b">function</code> lambda操作符替换它们。但是对于VB.NET来说，没有这样的平移解决方案，所以你在使用VB.NET的时候，总是被这些奇怪的lambda算子所困扰。</p><p id="a0f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为没有其他语言(至少据我所知)像lambdas这样，并且因为作为一个全栈开发人员，你可以在一天之内编写一些VB.NET、Javascript、C#和Dart，你偶尔会记错，并在你拍脑袋记住你当时没有使用VB.NET之前在编辑器中编写错误的语法。</p><p id="59d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的头脑中有两套规则，一套针对人们实际使用的最新语言(如C#、JavaScript、Dart等)。)和另一套只能应用于Visual Basic的VB.NET规则。你的大脑只能容纳这么多东西，你真的想用只适用于一种语言的语法规则来提升它吗？</p><h2 id="00d9" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">缺乏互操作性</h2><p id="8b05" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果有人说他们是Python开发者，你知道他们是什么意思。如果他们说自己是Java开发人员，你还是知道他们的意思的。如果有人说他们是Visual Basic开发人员…他们是什么意思？他们是否已经完成了一个快速的Visual Basic脚本(VBS)来自动化一些任务？还是用Visual Basic for Applications (VBA)为Word或Excel编写宏？还是他们用的是Visual Basic。NET (VB。网)？</p><p id="92ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这三者中没有一个是相互兼容的。是的，它们的相似之处多于不同之处，但是你不能仅仅从编写VBScript到编写VB.NET应用程序。这可能有一个很好的理由，但在我看来，没有什么理由可以解释为什么这些语言会发展到如此地步。为什么VB.NET、VBA和VBS之间的语法不能更相似，如果不是相同的话？</p><h2 id="00f2" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">糟糕的编辑选择</h2><p id="1c39" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果您使用C#、Java或几乎任何其他语言(除了，我不知道，COBOL)进行开发，您可以很好地选择使用什么IDE来编写代码。事实上，COBOL <a class="ae ky" href="https://github.com/OpenCobolIDE/OpenCobolIDE" rel="noopener ugc nofollow" target="_blank">也有一个非常好的编辑器</a>。尴尬。</p><p id="4d3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想用VB.NET或者VBScript，你可以用Visual Studio或者VS代码加上必要的插件，就可以了。但是，如果你想尝试使用VBA来创建一个Excel插件，你是在为这个可憎的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/b1b98e18ad8ba36744b0fb562dcbb772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kk3cgK5oLqWeb4yuo4JeVw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">看看那些线条。直接退出Windows 2000。</p></figure><p id="4d8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到Excel 2019实际上看起来相当不错，事实上，你从这种外观和感觉中被抛到看起来像是从90年代末开始的东西，这无异于不和谐。哦，等等，这东西是哪年的？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b375829f594cd4953e0e91af541636ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*0XJv-PTE4PV2RXUltzI8Yg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数字</p></figure><p id="aa23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">版权声明中的年份可能不是软件最后一次被修改或构建的最可靠指标，但它确实让人感觉VBA编辑器已经有近十年没有被修改过了。</p><p id="98e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更糟糕的是，在我不得不使用这个东西的几次中，我花了大约一半的时间与编辑器本身斗争。现代编辑器用曲线突出显示您的代码，或者在您键入代码建议和编译时错误时为您提供一些视觉指示。另一方面，VBA编辑器更像一个竞赛裁判，隐藏分数直到你写完一行并按下回车键，这时它要么通过语法检查，要么用一个神秘的错误扇你一巴掌。我这么说是什么意思？让我们来看看这个可怕的、无用的、永远无法编译的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/d8790bf9df4a9f21f7dfa6f12963f982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*BiLwtmlSvSxkHFlsDCngug.png"/></div></figure><p id="0231" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个函数，我没有声明任何变量名。我刚刚在编辑器里写了垃圾。在这种情况下，因为我每行写了两个单词，所以编辑器很乐意让我每行都按return键，而不会抛出错误。你希望你的代码错误下面有弯弯曲曲的线条吗？你怎么敢。你说VBA不会直接编译进你的大脑是什么意思？</p><p id="0420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是当我在这条线上添加更多的单词时，它就爆炸了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/7604b0fef9d1aaa23ff11c500baf0c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*JRI9XG0Ye1Zpkqh-9zRKBA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">悲伤的长号噪音。</p></figure><p id="1101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">短语“编译错误”似乎暗示VBA的编辑试着编译了我之前的代码，完全没问题。这根本不可能是真的；它不能编译那些垃圾。在VBA编辑器中，当你在一行的末尾按回车键时，会发生一些事情，这是某种程度的验证，它会被严重命中和错过。</p><h2 id="eb08" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">鼓励坏习惯</h2><p id="42fa" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我的职业生涯中，我花了令人失望的时间来清理和解决一个相当大的Visual Basic项目的问题，这个项目从关闭<code class="fe ng nh ni nj b">Option Strict</code>开始。这基本上意味着隐式转换可以在类型之间发生，并且不会引发编辑时警告。例如，如果您的函数返回一个<code class="fe ng nh ni nj b">Object</code>，并且您试图将它赋给类型为<code class="fe ng nh ni nj b">String</code>的东西，那么编辑器将会认为运行时转换是正确的，不会将其标记为编译时错误。</p><p id="1f1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这句话真的很可怕，它是对单词<em class="no">运行时</em>的重复使用。也就是说，如果你要有一个问题，那么它将发生在运行时，而不是编译时，这不是你想要的。如果你像我一样，继承了一个VB。NET项目中有数千行代码，而您启用了<code class="fe ng nh ni nj b">Option Strict</code>，那么您将面临数千个与类型相关的错误。在代码编译之前，您必须手动修复每一个错误。当然，这样做，你提高了代码的质量，减少了代码的味道，但是这是一个愚蠢的问题。为什么这甚至是一个选项，哪个疯子宁愿关掉它，放弃一些那种类型的安全？令人难以置信。</p><h2 id="3081" class="ms lw it bd lx mt mu dn mb mv mw dp mf li mx my mh lm mz na mj lq nb nc ml nd bi translated">语言不再有改进</h2><p id="5f66" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">微软宣布他们将把Visual Basic发展成一门语言。NET Core ，然后，四个月后，把那个思想改成“<a class="ae ky" href="https://devblogs.microsoft.com/vbteam/visual-basic-support-planned-for-net-5-0/" rel="noopener ugc nofollow" target="_blank">其实，还是不要</a>了。”在我看来，将整个语言移植到。NET Framework 5.0，但却立即放弃了它，这让我有些吃惊。</p><p id="21c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许你对今天的VB.NET语感到满意，如果你满意，那也没关系。但是时代在变，在像C#甚至Dart这样的语言中，我们在处理<code class="fe ng nh ni nj b">null</code>的方式上得到了改进，在Dart和Flutter的最新版本中，我们甚至获得了像默认不可空(NNBD)这样的特性。这些并不是你制作应用程序所需要的东西，但是随着时间的推移，一些小的改进会让开发者的生活变得稍微轻松一些。因此，除非微软开源Visual Basic，否则随着时间的推移，这些进化式的改进不会应用于Visual Basic。最终，它会变得过时，甚至比今天更加过时。如果这对你来说还不够，在Stack Overflow的2020年开发者调查中，<a class="ae ky" href="https://insights.stackoverflow.com/survey/2020#technology-most-loved-dreaded-and-wanted-languages-dreaded" rel="noopener ugc nofollow" target="_blank"> VBA是最讨厌的语言</a>。如果人们讨厌使用它，那么按理说可供选择的开发者会越来越少，对吗？</p><h1 id="f5d6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">我该怎么办？</h1><p id="f8f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你专门为Excel或Word创建VBA解决方案，你很可能会被现有的东西困住。似乎确实有一些工具可以帮助，而且看起来相当不错(但是我还没有试过)。到目前为止，最糟糕的事情是，如果你的思维固定在VBA的做事方式上，试图学习任何其他语言都会有巨大的困难。</p><p id="d52f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还在用VBScript，嗯，很难。脚本语言对于自动化来说是很棒的，所以改变成其他语言的提议可能没有那么吸引人。但是有没有想过学习<a class="ae ky" href="https://docs.microsoft.com/en-us/powershell/" rel="noopener ugc nofollow" target="_blank"> PowerShell </a>？如果您进行了这种转换，您也可以使用Powershell Core，这样您创建的东西就有可能在Linux或macOS上运行，这可能是一个很大的动力。</p><p id="e8d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还在使用VB.NET，如果你把它和web forms这样过时的编程模式结合使用，那就更是如此了，我认为你写的每一行新代码都在增加你的技术债务。在不久的将来，招募和维持擅长VB.NET的开发人员将变得困难。因为你的。NET项目编译成解释语言(IL)，你可以同时运行一个<a class="ae ky" href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/" rel="noopener ugc nofollow" target="_blank"> C# </a>项目和你的VB.NET项目，并且彼此依赖。这是开始用C#编写新的应用程序或者用C#重写部分应用程序的好方法。同样，如果你使用的是web表单之类的东西，那么理想情况下，你用C#编写的代码应该是API控制器，你应该选择一个前端JavaScript框架来与它们交互。这就是我正在用我的传统VB.NET网络应用程序做的事情，它让世界变得不同。</p><p id="fe53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">过去有一段时间，我不得不从VB.NET转到C#，是的，我花了几个月的时间才完全转换过来。但我很高兴我做到了。如果没有VBA在微软办公套件中的紧密结合，我不确定它是否需要存在。当然，值得注意的是，这些年来很多人都在使用Visual Basic，有些人可能是通过使用VB开始软件开发的。我并不是专门针对这些人——创造一种语言将是一项巨大的事业，最终，世界上更多的软件开发者可能是一件好事。但是作为一门语言，现在我们当然有更好的选择。</p><p id="a416" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样值得注意的是，这个世界将永远需要一些Excel和Word宏的VBA开发者，因为在这个产品中没有其他选择来编写东西。但是我们更需要谁呢:VBA专家还是亚马逊网络服务(AWS)专家？肯定是后者。如果你有1000个知道AWS的人和1000个知道VBA的人，更多的AWS人最终会被雇用，因为有更大的需求。</p><p id="2bcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当Visual Basic第一次出现时，它使软件开发变得容易，但是当它开始实现与此直接相反的目标时，现在是它离开的好时机。再见，Visual Basic，感谢所有的类型错误。</p></div></div>    
</body>
</html>