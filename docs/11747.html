<html>
<head>
<title>How To Build an Online Searchable Dropdown Flutter Widget</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立一个在线可搜索的下拉式窗口小部件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-an-online-searchable-dropdown-flutter-widget-3ede426f4d17?source=collection_archive---------1-----------------------#2022-04-13">https://betterprogramming.pub/how-to-build-an-online-searchable-dropdown-flutter-widget-3ede426f4d17?source=collection_archive---------1-----------------------#2022-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ca39" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Flutter中的在线-离线数据实现可定制的下拉菜单</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/032dd0b372562d1bd443efa49c320bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NmzjahgT_IoQHb15"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@vmxhu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Szabo Viktor </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7fe0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Flutter中有几个小部件提供下拉搜索功能，但我发现真正令人惊叹的是:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="e69e" class="lx ly iq lt b gy lz ma l mb mc">DropdownSearch&lt;&gt;</span></pre><p id="f133" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此小部件允许您执行以下操作:</p><ol class=""><li id="ae42" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated">创建项目的下拉列表。</li><li id="3c04" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">搜索提供的数据(完整和不完整的搜索功能)。</li><li id="ba7b" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">设置数据，使其成为您构建的离线列表，或者可以是可以通过API请求获取的在线数据。</li><li id="fa4a" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">可定制的弹出窗口构建器。弹出数据列表的文本、样式和装饰。</li><li id="a498" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">可定制的下拉项目生成器。弹出式下拉列表的文本、样式和装饰。</li></ol><p id="9427" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为第一步，在Flutter项目的<code class="fe mr ms mt lt b">pubspec.yml</code>文件的依赖列表中包含widget类。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="c427" class="lx ly iq lt b gy lz ma l mb mc">pubspec.yaml</span><span id="e5d2" class="lx ly iq lt b gy mu ma l mb mc">dependencies:<br/>   dropdown_search:</span></pre><h1 id="ff16" class="mv ly iq bd mw mx my mz na nb nc nd ne jw nf jx ng jz nh ka ni kc nj kd nk nl bi translated"><strong class="ak">用例</strong></h1><p id="c1d1" class="pw-post-body-paragraph kw kx iq ky b kz nm jr lb lc nn ju le lf no lh li lj np ll lm ln nq lp lq lr ij bi translated">这个小部件就像一个工具，像一个锤子，所以你需要知道在什么情况下应该使用这个工具:</p><h2 id="60d6" class="lx ly iq bd mw nr ns dn na nt nu dp ne lf nv nw ng lj nx ny ni ln nz oa nk ob bi translated"><strong class="ak">案例1 </strong></h2><ol class=""><li id="504d" class="md me iq ky b kz nm lc nn lf oc lj od ln oe lr mi mj mk ml bi translated">您希望实现一个可搜索的下拉列表，并且正在离线创建数据。</li><li id="e851" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">离线意味着数据是在代码内部创建的，不需要调用任何API。</li></ol><h2 id="e503" class="lx ly iq bd mw nr ns dn na nt nu dp ne lf nv nw ng lj nx ny ni ln nz oa nk ob bi translated"><strong class="ak">案例二</strong></h2><ol class=""><li id="7ee6" class="md me iq ky b kz nm lc nn lf oc lj od ln oe lr mi mj mk ml bi translated">您希望实现一个可搜索的下拉菜单，并且正在在线获取数据。</li><li id="6a64" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">在线意味着通过HTTP请求从API获取数据。</li><li id="42f3" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">你不想在线过滤。</li><li id="149a" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">您正在使用一个<code class="fe mr ms mt lt b">FutureBuilder </code>并希望将未来变量传递给下拉搜索小部件。</li></ol><h2 id="b518" class="lx ly iq bd mw nr ns dn na nt nu dp ne lf nv nw ng lj nx ny ni ln nz oa nk ob bi translated"><strong class="ak">案例三</strong></h2><ol class=""><li id="00e2" class="md me iq ky b kz nm lc nn lf oc lj od ln oe lr mi mj mk ml bi translated">您希望实现一个可搜索的下拉菜单，并且正在在线获取数据。</li><li id="3bca" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">你需要支持关键词搜索的在线过滤。</li><li id="3cb7" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">现在，随着在线过滤的启用，您有了一个希望与这个小部件连接的API请求。</li></ol><p id="3968" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我将解释案例3。这是最复杂的情况。在我接下来的教程中，我还将解释案例1和案例2。</p><h1 id="4958" class="mv ly iq bd mw mx my mz na nb nc nd ne jw nf jx ng jz nh ka ni kc nj kd nk nl bi translated">在案例3中实现下拉搜索后，用户界面将会是什么样子</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/d9376ffb24274d16279e0f7a0ba64bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*uh0akjmL6VssyrJMi4PYTw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将创建的用户界面</p></figure><p id="5a42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这张快照来自我的个人项目。您可以看到搜索栏如何出现在列表上，以及如何设计整个小部件的样式。这是我们使用这个小部件的动机。</p><h1 id="f1c0" class="mv ly iq bd mw mx my mz na nb nc nd ne jw nf jx ng jz nh ka ni kc nj kd nk nl bi translated">Widget类中每个参数的含义。</h1><p id="dd94" class="pw-post-body-paragraph kw kx iq ky b kz nm jr lb lc nn ju le lf no lh li lj np ll lm ln nq lp lq lr ij bi translated">小部件代码——允许您使用过滤器创建在线搜索——如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><ol class=""><li id="cdf5" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">DropdownSearch&lt;Class&gt;</code>:<code class="fe mr ms mt lt b">Class </code>是您希望在下拉列表中包含的列表项的<code class="fe mr ms mt lt b">Class</code>类型。您可以在您的代码中创建一个自定义的<code class="fe mr ms mt lt b">Class</code>，或者如果列表中有一个已经在Dart中可用的类类型，例如String、int或bool，您可以编写它们来代替<code class="fe mr ms mt lt b">Class</code>。这是非常重要的，因为你必须事先决定哪种类型的项目，你想包括在内。在<code class="fe mr ms mt lt b">onFind</code>参数中的<code class="fe mr ms mt lt b">getData()</code>方法将返回相同类型的项目。同一个类的对象会用<code class="fe mr ms mt lt b">onChanged()</code>的方法给出。</li><li id="ba53" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">mode </code>:指的是您想要在按下小工具时创建的弹出窗口的类型。您可以从<code class="fe mr ms mt lt b">MENU</code>、<code class="fe mr ms mt lt b">DIALOG </code>或<code class="fe mr ms mt lt b">BOTTOMSHEET</code>三个选项中进行选择。</li><li id="a039" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">showSearchBox </code>:如果需要搜索功能，应该为真。</li><li id="dbb5" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">isFilteredOnline</code>:如果要对在线数据应用过滤器，则应为true。这意味着无论你在搜索框中写什么，都会被发送到一个API在线获取相应的数据。该字段链接到<code class="fe mr ms mt lt b">onFind </code>，这将在本教程稍后讨论。</li><li id="cc2e" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">dropDownButton</code>:如果你看到UI快照，你会看到一个小箭头在右边朝下。这表明您可以扩展列表。该字段提供了图标小部件。您可以在此放置任何图标，但它必须是一个图标。</li><li id="2a6c" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">dropdownSearchDecoration</code>:该字段用于下拉小工具的样式。水平矩形框，其中有一个建筑图标和搜索/大学商店写，由于这个领域。该字段接受一个<code class="fe mr ms mt lt b">InputDecoration </code>类。什么是输入装饰类，它的属性是什么，可以在Flutter关于<a class="ae kv" href="https://api.flutter.dev/flutter/material/InputDecoration-class.html" rel="noopener ugc nofollow" target="_blank">输入装饰</a>的文档中研究。</li><li id="0b0e" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe mr ms mt lt b">dropdownBuilder</code>:控制从下拉列表中选择的项目显示后下拉列表的外观。我使用了<code class="fe mr ms mt lt b">ListTile </code>来显示文本。<code class="fe mr ms mt lt b">_customDropDownPrograms </code>的实现如下:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="321e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，<code class="fe mr ms mt lt b">item </code>是从列表中选择的对象，该字段知道您选择了哪个对象，因此它采用一个返回<code class="fe mr ms mt lt b">ListTile</code>的方法。如果<code class="fe mr ms mt lt b">item </code>不为空(对象被选中)，它使用被选中的<code class="fe mr ms mt lt b">item </code>，并从中获取<code class="fe mr ms mt lt b">title </code>属性。这里的<code class="fe mr ms mt lt b">item </code>是类<code class="fe mr ms mt lt b">BootCampDetails</code>的自定义实现类对象。您可以创建您的类和属性放在这里。如果<code class="fe mr ms mt lt b">item </code>为空(无选择)，则显示“搜索程序”。</p><p id="b171" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">8.<code class="fe mr ms mt lt b">popupItemBuilder</code>:该字段控制弹出下拉菜单中显示的项目的样式。您可以更改文本、颜色长度和大小，甚至添加前导图标。所有这些属性都由<code class="fe mr ms mt lt b">ListTile </code>小部件提供。你也可以在每一个项目标题上添加说明性的小标题等等。在关于<a class="ae kv" href="https://api.flutter.dev/flutter/material/ListTile-class.html" rel="noopener ugc nofollow" target="_blank"> ListTitle </a>的Flutter文档中了解更多关于这个小部件的信息。<code class="fe mr ms mt lt b">_customPopupItemBuilder</code>的实现如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="da75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt lt b">isSelected </code>在这里是没用的。它是用来预选的，大多数情况下不用，但是你得把它放在函数参数里。</p><p id="10a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">9.这是最重要的方法，因为数据在这里给出。<code class="fe mr ms mt lt b">onFindg</code>给了我们一个可以使用的字符串类型过滤器。Filter会存储我们在搜索框中输入的任何内容，即使只输入了一个字母并触发了<code class="fe mr ms mt lt b">onFind</code>。然后，过滤器变得可用。我已经将filter作为参数传递给了<code class="fe mr ms mt lt b">getData()</code>,它使用过滤器字符串向API发出在线请求。您需要实现一个类似的方法，返回一个<code class="fe mr ms mt lt b">Future List</code> <strong class="ky ir">。这非常重要，因为<code class="fe mr ms mt lt b">onFind </code>只需要一个未来列表类型的对象。<code class="fe mr ms mt lt b">getData()</code>实现如下:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="5d62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第10行是我们将过滤器设置为键<code class="fe mr ms mt lt b">searchText</code>的值的地方。这是在请求正文中发送的。这取决于我用来获取数据的特定API。之后，<code class="fe mr ms mt lt b">detailList </code>转换为<code class="fe mr ms mt lt b">List</code>并返回。每当您在搜索框中输入内容时，此方法都会获取数据；因此，它提供实时数据提取。</p><p id="c1fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">10 <strong class="ky ir">。</strong> <code class="fe mr ms mt lt b">onChanged</code>:第二重要的参数就是这个。在您从下拉列表中选择一些内容之后，用这个参数编写的代码将被执行。<code class="fe mr ms mt lt b">onChanged </code>字段为我们提供了选中的<code class="fe mr ms mt lt b">Object</code>。你可以对这个物体做任何你想做的事情。也许把它储存起来，用在别的地方。<code class="fe mr ms mt lt b">setState()</code>可以从代码内部的任何地方调用。我在这里调用它是为了满足我的特定需求。此外，调用<code class="fe mr ms mt lt b">setState </code>是一种常见的做法，因为你可以保存选中的对象，并可能在用户界面的某个地方显示它。</p><p id="09f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mr ms mt lt b">showClearButton </code>:如果为真，在所选对象的右边会显示一个小的清除按钮。它用于清除小部件并重新选择某些东西。</p><p id="b63e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户界面快照:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6ce4b625e4da31c7a19387138b0bc0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*-J8_ynb6YU2XUHagdbIENw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用动态数据提取进行搜索</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/880aea7994f3fd5386951cf816fe38a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*Z8VtqzEvB3I9hJD-xhKyPQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">customdropdownbuilder设置选定数据对象的样式</p></figure><p id="b53f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将会写另一个关于Flutter中使用的小部件的详细教程。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="e276" class="lx ly iq lt b gy lz ma l mb mc"><strong class="lt ir">Want to Connect?</strong></span><span id="44fb" class="lx ly iq lt b gy mu ma l mb mc">Hit me up on <a class="ae kv" href="https://www.linkedin.com/in/hatim-zahid/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>. </span></pre><h1 id="8aa8" class="mv ly iq bd mw mx my mz na nb nc nd ne jw nf jx ng jz nh ka ni kc nj kd nk nl bi translated">参考</h1><div class="ok ol gp gr om on"><a href="https://api.flutter.dev/flutter/material/InputDecoration-class.html" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd ir gy z fp os fr fs ot fu fw ip bi translated">输入说明类-素材库- Dart API</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">此示例显示如何使用InputDecorator设置TextField的样式。文本字段显示一个“发送消息”图标到…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">api.flutter.dev</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb kp on"/></div></div></a></div><div class="ok ol gp gr om on"><a href="https://api.flutter.dev/flutter/material/ListTile-class.html" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd ir gy z fp os fr fs ot fu fw ip bi translated">ListTile类-素材库- Dart API</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">单个固定高度的行，通常包含一些文本以及前导或尾随图标。列表框包含…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">api.flutter.dev</p></div></div><div class="ow l"><div class="pc l oy oz pa ow pb kp on"/></div></div></a></div></div></div>    
</body>
</html>