<html>
<head>
<title>Exploring the UIColor and Color APIs in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索iOS中的UIColor和Color APIs</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-the-uicolor-and-color-apis-in-ios-68c9ea7a2162?source=collection_archive---------10-----------------------#2022-08-16">https://betterprogramming.pub/exploring-the-uicolor-and-color-apis-in-ios-68c9ea7a2162?source=collection_archive---------10-----------------------#2022-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1aad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何充分利用色彩</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/45547675a7054f32c18182a688ae7b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6gGUnNRlp-DsCTqA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">罗伯特·卡茨基在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都想运送高质量的产品，我们想尽可能快地运送它们。我们喜欢关注复杂的问题，快速处理我们重复编写的代码。</p><p id="52ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，俗话说，魔鬼在细节中。产品的质量恰恰在于这些细节:例如，精心设计的动画，或者正确按钮的正确颜色。</p><p id="1b0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，我想深入探讨一下苹果提供的<code class="fe lv lw lx ly b">UIColor</code>和<code class="fe lv lw lx ly b">Color</code>API，并分享一些有用的技巧来增强你的应用。</p><h1 id="3e4b" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">显示P3支持</h1><p id="6e70" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">苹果在iPhone 7上发布了首款支持P3显示屏的设备。P3显示器比标准显示器支持更广泛的颜色:宽25%。最终结果是，你可以用更明亮的颜色编写更具表现力的应用程序。</p><p id="1541" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图显示了一组标准RGB颜色(左栏)和使用P3显示API的相同颜色(右栏)之间的差异。左边的模拟器设置的是浅色主题，右边的模拟器使用的是深色主题。</p><div class="kj kk kl km gt ab cb"><figure class="mw kn mx my mz na nb paragraph-image"><img src="../Images/a479712c27f20e5f44ae0f2ee16115f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*o-bQJCJbq2KVW4gdzY8brw.png"/></figure><figure class="mw kn nc my mz na nb paragraph-image"><img src="../Images/d53209aec6961299accdd4269aaba98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*QmhtVv8mw8H9_6tDPrqarQ.png"/></figure></div><blockquote class="nd ne nf"><p id="12c6" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">你必须有一个支持P3显示的显示器才能看出区别！</p></blockquote><p id="3cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到左栏的颜色看起来比右栏暗。这两者之间的区别或多或少是显而易见的，取决于主题。</p><h1 id="bee0" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">创建显示P3颜色</h1><p id="2210" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">创建显示P3的API在iOS 10中就已经存在，所以您的项目可能支持它。</p><p id="cba8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在扩展色彩空间(有时也称为广色域)中创建UIKit颜色，您可以使用此<code class="fe lv lw lx ly b">UIColor</code> init:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="3644" class="no ma it ly b gy np nq l nr ns"><a class="ae ky" href="https://developer.apple.com/documentation/uikit/uicolor/1648568-init" rel="noopener ugc nofollow" target="_blank">UIColor.init(displayP3Red:green:blue:alpha:)</a></span></pre><p id="86d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这四个值必须从0到1，就像标准的<code class="fe lv lw lx ly b">UIColor.init(red:green:blue:alpha:)</code>初始化器一样。</p><p id="5795" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI的<code class="fe lv lw lx ly b">Color</code>使用显示P3颜色空间创建它的初始化器:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="5f10" class="no ma it ly b gy np nq l nr ns"><a class="ae ky" href="https://developer.apple.com/documentation/swiftui/color/init(_:red:green:blue:opacity:)" rel="noopener ugc nofollow" target="_blank">init(_:red:green:blue:opacity:)</a></span></pre><p id="79cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">色彩空间由第一个匿名参数标识。其默认值为<code class="fe lv lw lx ly b">sRGB</code>，代表标准RGB色彩空间。然而，<code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.apple.com/documentation/swiftui/color/rgbcolorspace" rel="noopener ugc nofollow" target="_blank">Color.RGBColorSpace</a></code>枚举也包含了<code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.apple.com/documentation/swiftui/color/rgbcolorspace/displayp3" rel="noopener ugc nofollow" target="_blank">displayP3</a></code>值，这正是您所需要的。</p><h1 id="f752" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">从一个表象到另一个表象</h1><p id="8509" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">RGB并不是描述颜色的唯一可用的表示法。颜色也可以用使用色调、饱和度和亮度(HSB)的模型来描述。Apple也为这种表示提供了一个init:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="1ad0" class="no ma it ly b gy np nq l nr ns">// UIKit<br/><a class="ae ky" href="https://developer.apple.com/documentation/uikit/uicolor/1621931-init" rel="noopener ugc nofollow" target="_blank">init(hue:saturation:brightness:alpha:)</a></span><span id="741f" class="no ma it ly b gy nt nq l nr ns">// SwiftUI<br/><a class="ae ky" href="https://developer.apple.com/documentation/swiftui/color/init(hue:saturation:brightness:opacity:)" rel="noopener ugc nofollow" target="_blank">init(hue:saturation:brightness:opacity:)</a></span></pre><p id="0896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些初始化器不太强调颜色的色调，但是让你可以更容易地使用它的饱和度和亮度。HSB模型由以下圆柱体表示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/70d9b2d2a0c3330370302ad9d9fc0585.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*LUE6eE9o771jailh9Uwr6w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">HSB气缸。</p></figure><ul class=""><li id="b44d" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">色调参数从0到1，代表色调。这些值映射到圆柱体从0到360度的角度。</li><li id="c349" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">饱和度参数从0到1，代表您想要的颜色色调。值0表示灰色。</li><li id="f855" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">亮度参数代表颜色的亮度。值0以黑色结束。</li></ul><p id="ffdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">针对iOS 10或更新版本链接的应用程序，HSB表示会使用P3显示器的扩展颜色范围自动渲染，因此您可以免费获得更亮的颜色。</p><h1 id="e928" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">我们如何使用HSB模型？</h1><p id="23ea" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">通过观察一些适应当前主题的默认颜色，您可能会发现颜色的色调保持不变，而当从亮主题转到暗主题时，颜色的饱和度和亮度会发生变化。</p><p id="bea0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以利用HSB模型为浅色和深色主题自动创建良好的颜色，而无需手动指定两种不同的颜色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/b8b9151a962e169f4b1f0d9cc6c2ccf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*JQHvmjnxXsVAK7oH6M2BXQ.png"/></div></figure><h1 id="645e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">自动化浅色/深色</h1><p id="8414" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">作为一个实验，你可以写一个小脚本来检查苹果是如何改变这些值的。脚本可能是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="c56f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在注释中看到各种操作:</p><ol class=""><li id="0ab0" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu om ob oc od bi translated">该脚本为明暗主题定义了一个<code class="fe lv lw lx ly b">UITraitCollection</code>。</li><li id="6568" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu om ob oc od bi translated">它定义了一组可以探索的颜色。</li><li id="ab95" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu om ob oc od bi translated">对于每种颜色，它获得亮值和暗值。</li><li id="bb96" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu om ob oc od bi translated">它获取HSB值。</li><li id="6354" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu om ob oc od bi translated">它打印这些值。</li></ol><p id="3b3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第17行和第18行的<code class="fe lv lw lx ly b">hsba</code>属性是我准备的自定义属性，它返回颜色的<code class="fe lv lw lx ly b">HSBA</code>表示。该属性的代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="09c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注释中解释了代码，但简而言之，它定义了一个帮助器<code class="fe lv lw lx ly b">HSBAColor</code>结构来收集值并在控制台中轻松地打印它们。</p><p id="8901" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">hsba</code>属性只是使用<code class="fe lv lw lx ly b">UIColor</code>提供的实用工具<code class="fe lv lw lx ly b"><a class="ae ky" href="https://developer.apple.com/documentation/uikit/uicolor/1621949-gethue" rel="noopener ugc nofollow" target="_blank">getHue(_:saturation:brightness:alpha:)</a></code>函数来提取我们需要的值。</p><p id="f0db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行的结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/3addcd8769ac4acd03c837236256034d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aji4ZEy9YWiWeRWe5UtMnA.png"/></div></div></figure><p id="983b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以观察到:</p><ul class=""><li id="733d" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">系统颜色的色调几乎保持不变。</li><li id="337b" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">大多数情况下，饱和度会降低约5–10%。</li><li id="7059" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">在大多数情况下，亮度增加约5-10%。</li></ul><p id="95c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，你可以推断深色可以描述为:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="9fb0" class="no ma it ly b gy np nq l nr ns">hue(dark) = hue(light)<br/>saturation(dark) = saturation(light)-0.07<br/>brightness(dark) = brightness(light)+0.07</span></pre><blockquote class="nd ne nf"><p id="58a7" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">警告<strong class="lb iu"><br/></strong>如果你和一个为明暗主题都提供值的设计师一起工作，使用它们，不要使用这种启发式。</p><p id="2ce2" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">这有利于开发一个支持两种主题的应用程序或原型，而无需投入大量时间来设计完美的调色板。</p><p id="0131" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">UI设计师有挑选合适颜色的经验，结果会比你自动生成的任何组合好得多。</p></blockquote><h1 id="02b1" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">自动创建动态颜色</h1><p id="eb91" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">现在，你必须创造你的动态颜色。苹果颜色是一种特殊的<code class="fe lv lw lx ly b">DynamicSystemColor</code>类型，不能在客户端代码中实例化。网上有很多描述如何创建动态颜色的文章，它们都决心使用这个构造函数:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="102f" class="no ma it ly b gy np nq l nr ns"><a class="ae ky" href="https://developer.apple.com/documentation/uikit/uicolor/3238041-init" rel="noopener ugc nofollow" target="_blank">init(dynamicProvider:)</a></span></pre><p id="fa69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个初始化器采用了<code class="fe lv lw lx ly b">(<a class="ae ky" href="https://developer.apple.com/documentation/uikit/uitraitcollection" rel="noopener ugc nofollow" target="_blank">UITraitCollection</a>) -&gt; <a class="ae ky" href="https://developer.apple.com/documentation/uikit/uicolor" rel="noopener ugc nofollow" target="_blank">UIColor</a></code>形式的闭包:你可以返回一个基于<code class="fe lv lw lx ly b">UITraitCollection.userInterfaceStyle</code>属性的颜色，它告诉你当前的应用程序主题。</p><p id="2c20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以在这个初始化式中应用上一节中的启发法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="94eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个代码片段声明了一个静态函数来创建一个动态颜色，从一个<code class="fe lv lw lx ly b">UIColor</code>开始。首先，它提取了<code class="fe lv lw lx ly b">hsba</code>结构。然后，它使用这个结构来创建初始颜色的深色表示。最后，它用<code class="fe lv lw lx ly b">dynamicProvider</code>初始化器返回颜色。</p><p id="6e7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以这样使用它:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="c448" class="no ma it ly b gy np nq l nr ns">UIColor.dynamicColor(UIColor(displayP3Red: 0.75, green:0.25, blue: 0.33, alpha: 1)</span></pre><p id="ad3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想要一个更好的API，类似于苹果的方法，你可以创建一个静态属性作为返回<code class="fe lv lw lx ly b">dynamicColor</code>的<code class="fe lv lw lx ly b">UIColor</code>的扩展。如果需要，您也可以将其与另一个属性一起引入SwiftUI:</p><pre class="kj kk kl km gt nk ly nl nm aw nn bi"><span id="a429" class="no ma it ly b gy np nq l nr ns">// Extending UIColor with dynamic properties...<br/>extension UIColor {<br/>  static var myColor = UIColor.dynamicColor(UIColor(displayP3Red: 0.75, green:0.25, blue: 0.33, alpha: 1)</span><span id="c78a" class="no ma it ly b gy nt nq l nr ns">}</span><span id="bb19" class="no ma it ly b gy nt nq l nr ns">// ...and porting them to SwiftUI<br/>extension Color {<br/>  static var myColor = Color(uiColor: .myColor)<br/>}</span></pre><h1 id="5851" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">结论</h1><p id="bb65" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">今天我们探讨了iOS颜色的几个方面:</p><ul class=""><li id="5401" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">标准RGB和显示P3色彩空间之间的差异。</li><li id="da4b" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">RGB与色调、饱和度和亮度(HSB)表示之间的差异。</li><li id="8000" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">如何从浅色自动生成深色？</li><li id="d216" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">如何创造动态色彩来回应明暗主题？</li></ul><p id="9acf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章能激励你花些时间去探索苹果的API，甚至是基本的API:有时，我们可以通过使用合适的API获得巨大的成功，并做出更好的产品。</p><p id="ae24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住，使用你的颜色的DisplayP3版本，而不是普通的RGB版本！</p></div></div>    
</body>
</html>