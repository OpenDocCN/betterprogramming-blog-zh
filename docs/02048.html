<html>
<head>
<title>How To Highlight Markdown Code With Remarkable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用卓越来突出Markdown代码</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/highlight-markdown-code-with-remarkable-and-a-web-component-eaf4d69e19b6?source=collection_archive---------4-----------------------#2019-11-02">https://betterprogramming.pub/highlight-markdown-code-with-remarkable-and-a-web-component-eaf4d69e19b6?source=collection_archive---------4-----------------------#2019-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be85" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Web组件漂亮地显示代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e0d39d25e3c01184a096137f864269e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfrSMW1qpZb_6x0opEVNwQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@tdpatch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">蒂姆·帕奇</a>在<a class="ae ky" href="https://unsplash.com/s/photos/highlight?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="05ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们目前正在为即将发布的新版本的遥控器<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>开发许多改进，这是我们用于演示的开源web编辑器。</p><p id="719d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中一项改进将使我们的用户能够在我们的编辑器中写笔记，并更方便地在控制器中显示它们。但不仅如此，还可以使用Markdown来编写这些内容。</p><p id="9aa5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天早些时候，<a class="ae ky" href="https://twitter.com/fsfarimani" rel="noopener ugc nofollow" target="_blank"> Foad Sojoodi Farimani </a>与我们分享了一个很好的想法，即更进一步，突出显示作为降价注释提供的代码块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="7522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我发现这个主意棒极了，我几乎直接开始实施它(<em class="lx">几乎</em>因为我必须先打扫我的公寓，周末的工作是最好的……)。</p><p id="62dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然通常情况下，您会为您正在使用的Markdown解析器提供一个库，在我们的例子中，Jon Schlinkert的<a class="ae ky" href="https://github.com/jonschlinkert/remarkable" rel="noopener ugc nofollow" target="_blank">显著的</a>，为了突出显示代码，我通过在我们的web组件<code class="fe ly lz ma mb b">&lt;deckgo-highlight-code/&gt;</code>的帮助下实际解析它来解决它。</p><p id="f228" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个<a class="ae ky" href="https://docs.deckdeckgo.com/components/code" rel="noopener ugc nofollow" target="_blank">组件</a>是一个包装器，它使用Lea Verou和James DiGioia的<a class="ae ky" href="https://prismjs.com" rel="noopener ugc nofollow" target="_blank"> Prism.js </a>。它的优势是在运行时获取它必须解释的语言的定义，如果提供的代码可以是任何类型的，这就有点方便了。</p><p id="6339" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我花了一点时间来弄清楚如何将所有的东西整合在一起，所以我想通过这篇新的博客帖子向你展示一下它的踪迹。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="12c0" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">装置</h1><p id="6589" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在您的项目中，安装markdown解析器和web组件:</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="c151" class="nk mk it mb b gy nl nm l nn no">npm install remarkable @deckdeckgo/highlight-code --save</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="08ec" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">进口</h1><p id="bfac" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">安装后，将库和组件导入到您的应用程序中:</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="e12d" class="nk mk it mb b gy nl nm l nn no">import {Remarkable} from 'remarkable';</span><span id="6410" class="nk mk it mb b gy np nm l nn no">import '@deckdeckgo/highlight-code';</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="0638" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">解决办法</h1><p id="28d1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在实例化一个新的<code class="fe ly lz ma mb b">Remarkable</code>对象时，我们将定义自己的自定义规则来解析代码，而不是像文档中显示的那样提供一个荧光笔函数，并且我们不提供任何荧光笔。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="ce3f" class="nk mk it mb b gy nl nm l nn no">const md: Remarkable = new Remarkable({<br/>    html: true,<br/>    xhtmlOut: true,<br/>    breaks: true<br/>});</span></pre><p id="7a91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的目标是用我们的定制web组件<code class="fe ly lz ma mb b">&lt;deckgo-highlight-code/&gt;</code>替换自动生成的HTML代码<code class="fe ly lz ma mb b">&lt;pre&gt;&lt;code/&gt;&lt;pre&gt;</code>。因此，我们在自定义函数中创建自己的规则。</p><p id="3dc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，由于代码可以是内联的，也可以是以块的形式提供的，所以我们在函数中添加了一个变量来处理两种情况和各自的风格。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="d572" class="nk mk it mb b gy nl nm l nn no">const codeRule = (inline: boolean) =&gt; <br/>  (tokens, idx, _options, _env) =&gt; {<br/>    return `&lt;deckgo-highlight-code <br/>            ${inline ? 'class="inline"' : ''}<br/>            language="${tokens[idx].params ?<br/>                tokens[idx].params : 'javascript'}"&gt;<br/>                    &lt;code slot="code"&gt;${tokens[idx].content}&lt;/code&gt;<br/>        &lt;/deckgo-highlight-code&gt;`;<br/>};</span></pre><p id="e64b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的自定义规则被定义，我们将它设置为<code class="fe ly lz ma mb b">Remarkable</code>来转换代码(“内联代码”)和栅栏(“代码块”)。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="0f4b" class="nk mk it mb b gy nl nm l nn no">md.renderer.rules.code = codeRule(true);<br/>md.renderer.rules.fence = codeRule(false);</span></pre><p id="22e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将Markdown内容解析成HTML，我们最后像往常一样，使用<code class="fe ly lz ma mb b">render</code>方法。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="26d7" class="nk mk it mb b gy nl nm l nn no">md.render(content);</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="d984" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">风格</h1><p id="c92c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了处理内联和块两种样式，我们为内联样式提供了特定的显示。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="1c33" class="nk mk it mb b gy nl nm l nn no">deckgo-highlight-code {<br/>  &amp;.inline {<br/>    --deckgo-highlight-code-container-display: inline-flex;<br/>  }<br/>}</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="744f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">试验</h1><p id="8390" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们终于可以尝试我们的解决方案了。为此，我们尝试向控制台呈现一段简单的代码。</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="9306" class="nk mk it mb b gy nl nm l nn no">const content: string = `# Title<br/><br/>A line \`console.log('Inline code');\`<br/>    <br/>\`\`\`<br/>console.log('Block code');<br/>\`\`\`<br/><br/>                `;</span><span id="c2ba" class="nk mk it mb b gy np nm l nn no">console.log(md.render(content));</span></pre><p id="bcaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切按计划进行，输出应该如下所示:</p><pre class="kj kk kl km gt ng mb nh ni aw nj bi"><span id="618a" class="nk mk it mb b gy nl nm l nn no">&lt;h1&gt;Title&lt;/h1&gt;</span><span id="cc31" class="nk mk it mb b gy np nm l nn no">&lt;p&gt;A line &lt;deckgo-highlight-code<br/>              class="inline" language="javascript"&gt;<br/>                  &lt;code slot="code"&gt;console.log('Inline code');<br/>                  &lt;/code&gt;<br/>          &lt;/deckgo-highlight-code&gt;<br/>&lt;/p&gt;</span><span id="c58f" class="nk mk it mb b gy np nm l nn no">&lt;deckgo-highlight-code <br/>        language="javascript"&gt;<br/>              &lt;code slot="code"&gt;console.log('Block code');<br/>              &lt;/code&gt;<br/>&lt;/deckgo-highlight-code&gt;</span></pre><p id="9d0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧，就是这样，我们做到了。</p><p id="2a98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们用<code class="fe ly lz ma mb b">Remarkable</code>和一个web组件动态突出显示Markdown代码。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="3d6b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="d259" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">DeckDeckGo是开源的，因此，你可以看看我们在<a class="ae ky" href="https://github.com/deckgo/deckdeckgo/blob/63a76e3a4d7b40ef0cb70dc30cae818da02d4d94/remote/src/app/components/app-notes/app-notes.tsx#L31" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上实现的源代码。</p><p id="c4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到无限和更远的地方。</p><p id="221c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大卫</p></div></div>    
</body>
</html>