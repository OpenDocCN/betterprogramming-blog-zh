<html>
<head>
<title>How To Build an OpenVPN Client on iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在iOS上构建OpenVPN客户端</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-an-openvpn-client-on-ios-c8f927c11e80?source=collection_archive---------2-----------------------#2019-11-18">https://betterprogramming.pub/how-to-build-an-openvpn-client-on-ios-c8f927c11e80?source=collection_archive---------2-----------------------#2019-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3ef4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">搭建VPN app？从这里开始。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/612e942a46a7a7e541693e032f4b1428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Cnn6fwW1IKqekwRP_nGIg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.google.com/url?sa=i&amp;rct=j&amp;q=&amp;esrc=s&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiVpLiIvvTlAhUGsp4KHf6qANEQjhx6BAgBEAI&amp;url=https%3A%2F%2Fopenvpn.net%2F&amp;psig=AOvVaw0wUIoY4LnZo4qqCZea5_sG&amp;ust=1574191386775516" rel="noopener ugc nofollow" target="_blank"> VPN软件解决方案&amp;商业服务| OpenVPN </a></p></figure><p id="5608" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在大部分VPN apps都支持OpenVPN协议。然而，当涉及到iOS时，并没有太多的东西可以帮助iOS开发者轻松进入其中。</p><p id="2cc6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">苹果意识到移动端对VPN的需求越来越大；它们为开发者提供了内置于iOS中的强大支持。</p><p id="0b08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">苹果创建了<a class="ae kv" href="https://developer.apple.com/documentation/networkextension" rel="noopener ugc nofollow" target="_blank">网络扩展</a>框架，让开发者可以轻松创建VPN应用。在本文中，我将只向您展示如何使用OpenVPN协议建立VPN连接。IKEv2将在另一篇文章中介绍。</p><p id="ad83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始…</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="7109" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">1.导入OpenVPNAdapter—OpenVPN库的Objective-C包装器</h1><p id="61cf" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://github.com/ss-abramchuk/OpenVPNAdapter" rel="noopener ugc nofollow" target="_blank"> OpenVPNAdapter </a>，它是OpenVPN库的包装器。</p><p id="6e5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用CocoaPods安装它:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="82ee" class="nb ma iq mx b gy nc nd l ne nf">pod 'OpenVPNAdapter', :git =&gt; 'https://github.com/ss-abramchuk/OpenVPNAdapter.git', :tag =&gt; '0.4.0'</span></pre><p id="7717" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别感谢<a class="ae kv" href="https://github.com/ss-abramchuk/OpenVPNAdapter/commits?author=ss-abramchuk" rel="noopener ugc nofollow" target="_blank"> Sergey Abramchuk </a>他是<a class="ae kv" href="https://github.com/ss-abramchuk/OpenVPNAdapter" rel="noopener ugc nofollow" target="_blank"> OpenVPNAdapter </a>的创造者。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="696b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak"> 2。添加所需功能</strong></h1><p id="35f4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">如果应用程序提供VPN服务，苹果要求它们添加个人VPN和网络扩展功能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/ebe73a1366f576883dabb115762108e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFM0A1Oidu85RazuMG5V-g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">单击“签名和功能”上的“+功能”按钮添加新功能</p></figure><p id="5697" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果Xcode上没有显示这些功能，请访问<a class="ae kv" href="https://developer.apple.com" rel="noopener ugc nofollow" target="_blank">developer.apple.com</a>并为您的捆绑包ID启用它们。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="436d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">3.添加网络扩展目标</h1><p id="9365" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">您将需要添加一个网络扩展，您可以将它视为一个独立的应用程序，它将在后台处理VPN操作。</p><p id="aa59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">苹果是这样定义扩展的:“应用程序扩展让你可以扩展应用程序之外的自定义功能和内容，让用户在与其他应用程序或系统交互时可以使用。”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/0eec19b76973823b54ab9afe128061d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xNP3v1XJzRzr1PGZSDZVjg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文件&gt;新建&gt;目标</p></figure><p id="6d7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将自动创建一个新文件夹，其中包含您的目标名称和一系列文件。我们将在步骤5中使用这些。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e45c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">4.配置VPN配置文件</h1><p id="581b" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">首先导入<code class="fe nh ni nj mx b">NetworkExtension</code>并开始使用<code class="fe nh ni nj mx b">NETunnelProviderManager</code>配置您的VPN配置文件</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="3546" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在这里提供了一个非常简单的配置<code class="fe nh ni nj mx b"><a class="ae kv" href="https://developer.apple.com/documentation/networkextension/netunnelproviderprotocol" rel="noopener ugc nofollow" target="_blank">NETunnelProviderProtocol</a></code>(VPN隧道的配置参数)的方法。<em class="nm"> ) </em></p><p id="edae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些参数可能会根据服务器的要求而变化。</p><p id="3210" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要将<code class="fe nh ni nj mx b">.ovpn</code>文件导入到项目中。这个文件应该包含OpenVPN指令、证书和密钥。基本上，这个文件包含了建立VPN连接所需的所有信息。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="90a2" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">5.建立联系</h1><p id="a35b" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">创建网络扩展目标后，Xcode会自动生成一个<code class="fe nh ni nj mx b">PacketTunnelProvider</code>类，它是<code class="fe nh ni nj mx b">NEPacketTunnelProvider</code>(数据包隧道提供商应用扩展的主要类)的子类。)</p><p id="30bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，您可以使用<a class="ae kv" href="https://github.com/ss-abramchuk/OpenVPNAdapter" rel="noopener ugc nofollow" target="_blank"> OpenVPNAdapter </a>配置和建立VPN连接。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="68ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已！现在运行你的应用程序，它应该建立一个VPN连接。</p><p id="fb28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你打算在你的应用程序上显示Wi-Fi SSID，你可以阅读我的文章<a class="ae kv" href="https://medium.com/better-programming/how-to-access-wifi-ssid-on-ios-13-using-swift-40c4bba3c81d" rel="noopener">如何在iOS 13上访问Wi-Fi SSID</a>。</p></div></div>    
</body>
</html>