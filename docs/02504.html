<html>
<head>
<title>Understanding The forEach Method for Arrays in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解JavaScript中数组的forEach方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/understanding-the-foreach-method-for-arrays-in-javascript-48810fccf257?source=collection_archive---------12-----------------------#2019-12-04">https://betterprogramming.pub/understanding-the-foreach-method-for-arrays-in-javascript-48810fccf257?source=collection_archive---------12-----------------------#2019-12-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9739" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">改进您的迭代</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/898c5755d5c0cc4e4db976c3775096b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmHXnBMPW8RRW3ACqI4RqQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@mbaumi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">米卡·鲍梅斯特</a>在<a class="ae kv" href="https://unsplash.com/s/photos/syntax?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="5fca" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是forEach？</h1><p id="89c7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">方法对数组的所有元素执行回调函数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/9647f3454dab3bdc349a888f6c84fc5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGqOnNBQy7J7Cnmwf_ZlWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">JavaScript中的forEach方法</p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="87c3" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">句法</h1><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="9014" class="nf kx iq mn b gy ng nh l ni nj">array.forEach(callbackFunction, <strong class="mn ir">[, thisArg]</strong>);</span><span id="6f60" class="nf kx iq mn b gy nk nh l ni nj">// thisArg is optional</span><span id="8c93" class="nf kx iq mn b gy nk nh l ni nj">arguments for callbackFunction</span><span id="0b38" class="nf kx iq mn b gy nk nh l ni nj">callbackFunction(currentValue, index ,array) {</span><span id="499b" class="nf kx iq mn b gy nk nh l ni nj">   //index, array is optional</span><span id="538e" class="nf kx iq mn b gy nk nh l ni nj">}</span></pre><p id="432f" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated"><code class="fe mk ml mm mn b">forEach</code>方法不返回任何东西。</p><p id="6f69" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">让我们从一个循环开始，然后把它转换成一个<code class="fe mk ml mm mn b">forEach</code>循环</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="252e" class="nf kx iq mn b gy ng nh l ni nj">var array = [1,2,3,4,5];</span><span id="8887" class="nf kx iq mn b gy nk nh l ni nj">function print(val, index) {</span><span id="683e" class="nf kx iq mn b gy nk nh l ni nj">    console.log(`array[${index}\] = ${val}`);</span><span id="8788" class="nf kx iq mn b gy nk nh l ni nj">}</span><span id="4996" class="nf kx iq mn b gy nk nh l ni nj">for(let index =0, len = array.length; index &lt; len; index++ ) {</span><span id="c278" class="nf kx iq mn b gy nk nh l ni nj">       let val = array[index];<br/>       print(index, val);</span><span id="3d02" class="nf kx iq mn b gy nk nh l ni nj">}</span></pre><p id="d351" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">现在，让我们使用一个<code class="fe mk ml mm mn b">forEach</code>循环来做同样的操作。</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="81bf" class="nf kx iq mn b gy ng nh l ni nj">var array = [1,2,3,4,5];</span><span id="bbc3" class="nf kx iq mn b gy nk nh l ni nj">function print(val, index) {</span><span id="9d86" class="nf kx iq mn b gy nk nh l ni nj">   console.log(`array[${index}] = ${val}`);</span><span id="5f08" class="nf kx iq mn b gy nk nh l ni nj">}</span><span id="e6b0" class="nf kx iq mn b gy nk nh l ni nj">array.forEach(print);</span><span id="fb9c" class="nf kx iq mn b gy nk nh l ni nj"><strong class="mn ir">// output</strong><br/>array[0] = 1<br/>array[1] = 2<br/>array[2] = 3<br/>array[3] = 4<br/>array[4] = 5</span></pre><p id="a320" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">我们不能在<code class="fe mk ml mm mn b">forEach</code>里面使用<code class="fe mk ml mm mn b">break</code>或者<code class="fe mk ml mm mn b">continue</code>。如果你想在中间<code class="fe mk ml mm mn b">break</code>或<code class="fe mk ml mm mn b">continue</code>循环，你可以使用:</p><ul class=""><li id="9c82" class="nq nr iq lq b lr nl lu nm lx ns mb nt mf nu mj nv nw nx ny bi translated">for循环</li><li id="60b5" class="nq nr iq lq b lr nz lu oa lx ob mb oc mf od mj nv nw nx ny bi translated"><code class="fe mk ml mm mn b">every</code></li><li id="11df" class="nq nr iq lq b lr nz lu oa lx ob mb oc mf od mj nv nw nx ny bi translated"><code class="fe mk ml mm mn b">some</code></li></ul><h2 id="ac48" class="nf kx iq bd ky oe of dn lc og oh dp lg lx oi oj li mb ok ol lk mf om on lm oo bi translated">forEach循环不会对空值执行</h2><p id="c9dd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">示例1:</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="c7f4" class="nf kx iq mn b gy ng nh l ni nj">var arr = new Array(3);</span><span id="0f46" class="nf kx iq mn b gy nk nh l ni nj">arr; // [empty × 3]</span><span id="9bd1" class="nf kx iq mn b gy nk nh l ni nj">arr.forEach( val  =&gt; console.log(val) ); // it prints nothing</span></pre><p id="c587" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">示例2:</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="2cb4" class="nf kx iq mn b gy ng nh l ni nj">var arr = [1,,,,];</span><span id="bdd2" class="nf kx iq mn b gy nk nh l ni nj">arr.forEach( val  =&gt; console.log(val) ); </span><span id="dff3" class="nf kx iq mn b gy nk nh l ni nj">//output : 1<br/>// it prints 1 then forEach loop will be terminated</span></pre><p id="c1ff" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">示例3:</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="b18d" class="nf kx iq mn b gy ng nh l ni nj">var arr = [1<strong class="mn ir">,,</strong>null, undefined, NaN]</span><span id="8427" class="nf kx iq mn b gy nk nh l ni nj">arr.forEach( val  =&gt; console.log(val) );</span><span id="c714" class="nf kx iq mn b gy nk nh l ni nj">output:<br/><strong class="mn ir">1<br/>null<br/>undefined<br/>NaN</strong></span></pre><h2 id="9c3e" class="nf kx iq bd ky oe of dn lc og oh dp lg lx oi oj li mb ok ol lk mf om on lm oo bi translated">如果数组在迭代过程中被修改，其他元素可能会被跳过</h2><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="3c18" class="nf kx iq mn b gy ng nh l ni nj">var array = [1,2,3,4,5];</span><span id="b176" class="nf kx iq mn b gy nk nh l ni nj">array.forEach((value, index, sourceArray) =&gt; {<br/>    <br/>    sourceArray.push(10);<br/>    console.log(value);</span><span id="94be" class="nf kx iq mn b gy nk nh l ni nj">})</span><span id="a15d" class="nf kx iq mn b gy nk nh l ni nj"><strong class="mn ir">output : <br/>1,2,3,4,5</strong></span><span id="660f" class="nf kx iq mn b gy nk nh l ni nj"><strong class="mn ir">array : [1,2,3,4,5,10,10,10,10,10]</strong></span></pre><p id="fdb1" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">在上面的例子中，我们在每次迭代中添加了一个元素。但是for-each循环将只对元素执行，并且在<code class="fe mk ml mm mn b">forEach</code>操作开始时在数组中可用。</p><h2 id="5365" class="nf kx iq bd ky oe of dn lc og oh dp lg lx oi oj li mb ok ol lk mf om on lm oo bi translated">在forEach期间删除数组元素</h2><p id="4387" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果在<code class="fe mk ml mm mn b">forEach</code>循环中删除了数组中未被访问的元素，那么这些元素将被跳过。</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="bdfb" class="nf kx iq mn b gy ng nh l ni nj">var array = [1,2,3,4,5];</span><span id="71c6" class="nf kx iq mn b gy nk nh l ni nj">array.forEach((value, index, sourceArray) =&gt; {<br/>    <br/>    sourceArray.pop();<br/>    console.log(value);</span><span id="16f9" class="nf kx iq mn b gy nk nh l ni nj">});</span><span id="7bdb" class="nf kx iq mn b gy nk nh l ni nj"><strong class="mn ir">output:<br/></strong>1, 2, 3</span><span id="5c2b" class="nf kx iq mn b gy nk nh l ni nj">array:[1,2]</span></pre><p id="dad3" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">在上面的例子中，我们删除了每次迭代的最后一个元素。被删除的元素不会被打印。只跳过未访问的元素。这就是为什么<code class="fe mk ml mm mn b">3</code>在输出中被打印，但在源数组中被删除。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="312d" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">不要删除或添加元素</h1><p id="7dfe" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们不应该使用<code class="fe mk ml mm mn b">forEach</code>来修改<code class="fe mk ml mm mn b">forEach</code>回调函数中的元素。它违反了<code class="fe mk ml mm mn b">forEach</code>模式。</p><p id="bb17" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">记住<code class="fe mk ml mm mn b">forEach</code>用于对数组的所有元素执行<code class="fe mk ml mm mn b">function</code>。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="45e9" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">使用“this”参数</h1><p id="6d41" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们还可以在执行<code class="fe mk ml mm mn b">forEach</code>循环时指定自定义的<code class="fe mk ml mm mn b">this</code>值。</p><p id="a17f" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">例1(没有通过<code class="fe mk ml mm mn b">this)</code>:</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="416d" class="nf kx iq mn b gy ng nh l ni nj">var array = [1];</span><span id="5357" class="nf kx iq mn b gy nk nh l ni nj">function log(val, index) {<br/>    console.log(this); // window object<br/>}</span><span id="a3ac" class="nf kx iq mn b gy nk nh l ni nj">array.forEach(log);</span><span id="d9c8" class="nf kx iq mn b gy nk nh l ni nj">In the above code this --&gt; window</span></pre><p id="8d5b" class="pw-post-body-paragraph lo lp iq lq b lr nl jr lt lu nm ju lw lx nn lz ma mb no md me mf np mh mi mj ij bi translated">示例2:</p><pre class="kg kh ki kj gt nb mn nc nd aw ne bi"><span id="91ad" class="nf kx iq mn b gy ng nh l ni nj">var customThis = {val : 10};</span><span id="2c8c" class="nf kx iq mn b gy nk nh l ni nj">var array = [1];</span><span id="dbae" class="nf kx iq mn b gy nk nh l ni nj">function log(val, index) {<br/>    console.log(this.val); // 10 <br/>}</span><span id="4621" class="nf kx iq mn b gy nk nh l ni nj">array.forEach(log, customThis);</span></pre></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="0448" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">参考</h1><ul class=""><li id="823f" class="nq nr iq lq b lr ls lu lv lx op mb oq mf or mj nv nw nx ny bi translated"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach" rel="noopener ugc nofollow" target="_blank"> Mozilla开发者网络</a></li></ul></div></div>    
</body>
</html>