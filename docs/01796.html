<html>
<head>
<title>Create Your First React Desktop Application in Electron With Hot-Reload</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建您的第一个带有热重装功能的React桌面应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-your-first-react-desktop-application-in-electron-with-hot-reload-be96bb455890?source=collection_archive---------14-----------------------#2019-10-14">https://betterprogramming.pub/create-your-first-react-desktop-application-in-electron-with-hot-reload-be96bb455890?source=collection_archive---------14-----------------------#2019-10-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="37f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基础变得简单，这样你就可以打造下一件大事</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb520fe57069cd2fa1946d421716c745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKnuhwB_Nbf1P9W5Sw2P0Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="ky">照片由</em><a class="ae kz" href="https://unsplash.com/@rgrzybowski" rel="noopener ugc nofollow" target="_blank"><em class="ky">Radek Grzybowski</em></a><em class="ky"/><a class="ae kz" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"><em class="ky">Unsplash</em></a></p></figure><p id="8fea" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你是一名JavaScript开发人员，你构建web应用程序的大部分(或全部)经验可能都来自JavaScript社区——尤其是在过去几年中发布的这些热门的新技术。这可能会对你多年来决定开发的东西产生影响。</p><p id="2d0e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当我们被JavaScript生态系统中不断变化的环境所包围时，这些环境主要涉及web应用程序，我们甚至可能会质疑桌面应用程序是否值得进入。2019年的一项<a class="ae kz" href="https://insights.stackoverflow.com/survey/2019#developer-roles" rel="noopener ugc nofollow" target="_blank">堆栈溢出调查</a>显示，仍然有很高比例的桌面开发者，在全球9万名调查参与者中，约有21%是开发者。</p><p id="6442" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">换句话说，在桌面开发应用仍然是一个受欢迎的选择。因此，如果你想知道如何开始使用JavaScript创建你的第一个现代桌面应用程序，那么我希望这篇文章能帮助你！</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="1a5d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">构建我们的应用</h1><p id="5cd1" class="pw-post-body-paragraph la lb it lc b ld mw ju lf lg mx jx li lj my ll lm ln mz lp lq lr na lt lu lv im bi translated">我们将使用电子作为我们的主要工具。我们还将安装<a class="ae kz" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>，因为我们将用它来开始构建我们的用户界面。</p><p id="8019" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们要做的第一件事是使用<a class="ae kz" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>创建我们的项目，这将用于提供react和其他一些有用的工具，如<a class="ae kz" href="https://jestjs.io/docs/en/getting-started" rel="noopener ugc nofollow" target="_blank"> Jest </a>来运行测试。对于本教程，我将我们的项目称为<code class="fe nb nc nd ne b">electron-react-typescript-app</code>:</p><p id="2ee2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你想拿到你的回购协议，请访问<a class="ae kz" href="https://github.com/jsmanifest/electron-react-typescript-app.git" rel="noopener ugc nofollow" target="_blank">此链接</a>。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="8e0c" class="nj mf it ne b gy nk nl l nm nn">npx create-react-app electron-react-typescript-app`</span></pre><p id="8630" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">运行它将创建<strong class="lc iu">电子反应类型脚本应用</strong>文件夹，并安装<code class="fe nb nc nd ne b">package.json</code>中列出的必要依赖项。</p><p id="442f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，让我们继续清理我们不需要的文件。这是我的目录最终的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/59057f2024831a254ab7a25fb1c76433.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/0*hQPoBViWvnmUeEXk.jpg"/></div></figure><p id="bf2d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是我们的<code class="fe nb nc nd ne b">App.js</code>组件:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="9460" class="nj mf it ne b gy nk nl l nm nn">import React from 'react'</span><span id="4132" class="nj mf it ne b gy np nl l nm nn">function App() {<br/>  return &lt;h1&gt;Our Electron App&lt;/h1&gt;<br/>}</span><span id="093b" class="nj mf it ne b gy np nl l nm nn">export default App</span></pre><p id="297d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，我们将继续安装<code class="fe nb nc nd ne b">electron</code>作为依赖项:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="c912" class="nj mf it ne b gy nk nl l nm nn">npm i electron</span></pre><p id="0994" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">然后，我们将安装<a class="ae kz" href="https://github.com/electron-userland/electron-builder" rel="noopener ugc nofollow" target="_blank">电子生成器</a>。这是一个完整的解决方案，可以打包并构建一个现成的电子应用程序，支持自动更新。</p><p id="0161" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">将其作为<em class="lw">开发依赖项</em>安装:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="f8a6" class="nj mf it ne b gy nk nl l nm nn">npm i -D electron-builder</span></pre><p id="5161" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">注:</strong> <code class="fe nb nc nd ne b">-D</code>只是<code class="fe nb nc nd ne b">--save-dev</code>的别名。</p><p id="2e74" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">继续在<em class="lw"> package.json </em>中创建一个<code class="fe nb nc nd ne b">"build"</code>属性，因为<code class="fe nb nc nd ne b">electron-builder</code>将会使用它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="708a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您可以在此阅读所有可用选项<a class="ae kz" href="https://www.electron.build/configuration/configuration" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f7e2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">注意:</strong>对于使用<em class="lw"> create-react-app </em>创建的项目，您<em class="lw">必须</em>将<code class="fe nb nc nd ne b">"homepage"</code>属性的值放到<code class="fe nb nc nd ne b">"./"</code>中，以便路径在整个应用程序中正确解析，因为CRA <a class="ae kz" href="https://create-react-app.dev/docs/deployment#step-1-add-homepage-to-packagejson" rel="noopener ugc nofollow" target="_blank">会自动生成我们的文件，假设我们的应用程序托管在服务器根</a>中。这是为了确保生成的<code class="fe nb nc nd ne b">index.html</code>文件在构建后正确地加载资产。如果你不确定这是什么意思，请相信我，试试看！</p><p id="e393" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当你运行<code class="fe nb nc nd ne b">npm run electron</code>时，它会给出这样一个错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/e5461a204ac144489139321ed4c96350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/0*qEWhFqhqIwntEYBA.jpg"/></div></figure><p id="bb06" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">那是因为电子找不到可以读取的文件。我们可以在根目录下创建一个<code class="fe nb nc nd ne b">electron.js</code>文件，也可以在<code class="fe nb nc nd ne b">src</code>目录下创建一个启动脚本，这样更直观。让我们在<em class="lw"> src </em>目录下创建一个<code class="fe nb nc nd ne b">start.js</code>文件，并编写一些代码来初始化一个具有固定维度的浏览器窗口:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="195a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">完成这些后，我们必须向<code class="fe nb nc nd ne b">package.json</code>添加一个指向该文件的新属性，这样运行<code class="fe nb nc nd ne b">npm run electron</code>将引导程序加载<code class="fe nb nc nd ne b">start.js</code>:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="421e" class="nj mf it ne b gy nk nl l nm nn">{<br/>  "name": "electron-react-typescript-app",<br/>  "version": "0.1.0",<br/>  "private": true,<br/>  "main": "src/start.js",<br/>  "build": {<br/>    "appId": "some.id.ofyours",<br/>    "directories": {<br/>      "buildResources": "assets"<br/>    },</span></pre><p id="2af2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">运行<code class="fe nb nc nd ne b">npm run electron</code>将会打开一个加载<code class="fe nb nc nd ne b">loading.html</code>文件的窗口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/d0c6eb56221227f630f986550a18e58f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fbXy7hOGZmAZzcXR.jpg"/></div></div></figure><p id="6f8f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">太好了，现在情况开始好转了！</p><p id="9a0c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在让我们继续运行<code class="fe nb nc nd ne b">npm start</code>。该脚本现在将成功加载React代码的网页！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/3a8cd97e8bfe6016143cbde9851d41b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cmmfsX3kkzFLrgKS.jpg"/></div></div></figure><p id="7dbf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">但是等一下…这是<em class="lw">而不是</em>我们要找的。我们应该在电子窗口中看到我们的React代码<em class="lw">，那么为什么我们却在浏览器中看到它呢？</em></p><p id="ec5f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是因为我们本质上有两个不同的过程在做不同的事情。他们不知道另一个进程的存在！</p><p id="43af" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">所以我们要做的是让电子指向网络服务器，因为它有一个可以通过URL加载网页的API。这意味着我们将不再使用浏览器，因为我们正在构建一个桌面应用程序，并且Electron可以通过给每个窗口提供URL来加载内容。所以我们可以使用电子窗口(可以访问node.js模块和本地文件系统)。</p><p id="c949" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了能够做到这一点，我们将安装一个有用的包来检测应用程序是在<em class="lw">开发</em>还是<em class="lw">生产</em>模式下运行。如果应用程序在开发模式下运行，那么我们将使用web服务器。如果应用程序不是，那么这意味着我们已经使用<code class="fe nb nc nd ne b">electron-builder</code>构建了文件，我们通过一些可执行文件加载应用程序内容。这就是电子生成器的用途。</p><p id="76f2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">继续安装<code class="fe nb nc nd ne b">electron-is-dev</code>:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="ad61" class="nj mf it ne b gy nk nl l nm nn">npm i electron-is-dev</span></pre><p id="1964" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，我们将继续在我们的电子脚本中要求这样做，并像这样使用它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="f01b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">需要注意的重要行是:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="d494" class="nj mf it ne b gy nk nl l nm nn">mainWindow.loadURL(<br/>  isDev<br/>    ? 'http://localhost:3000'<br/>    : `file://${path.join(__dirname, '../build/index.html')}`,<br/>)</span></pre><p id="9aca" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，我们没有直接加载<code class="fe nb nc nd ne b">index.html</code>文件，而是应用了一个条件，在开发模式下使用CRA的web服务器，或者继续加载<code class="fe nb nc nd ne b">index.html</code>文件(当环境是<em class="lw">而不是</em>开发时)。</p><p id="12f8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您可能还注意到，我们不再使用路径<code class="fe nb nc nd ne b">../public/indx.html</code>，而是将其改为<code class="fe nb nc nd ne b">../build/index.html</code>。这是因为CRA内部不<em class="lw">而</em>处理<code class="fe nb nc nd ne b">public</code>文件夹内的文件。相反，它<a class="ae kz" href="https://create-react-app.dev/docs/using-the-public-folder#adding-assets-outside-of-the-module-system" rel="noopener ugc nofollow" target="_blank">将它们移动到<em class="lw">未接触过的</em>到</a> <code class="fe nb nc nd ne b"><a class="ae kz" href="https://create-react-app.dev/docs/using-the-public-folder#adding-assets-outside-of-the-module-system" rel="noopener ugc nofollow" target="_blank">build</a></code> <a class="ae kz" href="https://create-react-app.dev/docs/using-the-public-folder#adding-assets-outside-of-the-module-system" rel="noopener ugc nofollow" target="_blank">文件夹</a>。由于<code class="fe nb nc nd ne b">build</code>文件夹最终会包含所有生成的文件，我们不得不指向它。</p><p id="d44a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在继续运行<code class="fe nb nc nd ne b">npm start</code>，然后运行<code class="fe nb nc nd ne b">npm run electron</code>。您现在应该会看到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/2824a023378c6fd2cd84bc98c21f3ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JHyKnebJY7Abxa6D.jpg"/></div></div></figure><p id="2edf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">万岁！</p><p id="a4b3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们从CRA获得热重新加载到电子窗口的好处，以及node.js模块和本地文件系统环境进入“<em class="lw"> web </em>”页面的好处。这有多棒？</p><p id="80a8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">哦，是的，如果你看到一个浏览器标签被打开，试着像这样设置<code class="fe nb nc nd ne b">BROWSER=none</code>到你的<code class="fe nb nc nd ne b">package.json</code>脚本:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="34f7" class="nj mf it ne b gy nk nl l nm nn">"start": "cross-env BROWSER=none npm run react-start",</span></pre><p id="d963" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在让我们在对<code class="fe nb nc nd ne b">start.js</code>进行更改时重启主要的电子流程，因为目前我们只为网页UI启用了热重装。</p><p id="6024" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为此，安装<code class="fe nb nc nd ne b">electron-reload</code>和<code class="fe nb nc nd ne b">nodemon</code>:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="0cec" class="nj mf it ne b gy nk nl l nm nn">npm i -D electron-reload nodemon</span></pre><p id="b414" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">将您的<code class="fe nb nc nd ne b">npm run electron</code>脚本更改为:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="af60" class="nj mf it ne b gy nk nl l nm nn">"electron": "cross-env NODE_ENV=dev nodemon --exec \"\"electron .\"\"",</span></pre><p id="36a6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">并且只需要<code class="fe nb nc nd ne b">start.js</code>中的<code class="fe nb nc nd ne b">electron-reload</code>包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="94d3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，当您对<code class="fe nb nc nd ne b">start.js</code>进行更改时，电子窗口应该会自动重启。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="c6f9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="f06e" class="pw-post-body-paragraph la lb it lc b ld mw ju lf lg mx jx li lj my ll lm ln mz lp lq lr na lt lu lv im bi translated">恭喜您，您现在知道如何使用Electron用JavaScript创建一个react桌面应用程序了！我希望你发现这是有价值的，并期待在未来更多！</p></div></div>    
</body>
</html>