<html>
<head>
<title>Convert Static Websites to REST APIs With a Cloud Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将静态网站转换为具有云功能的REST APIs</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/convert-static-websites-to-rest-apis-with-cloud-functions-82f4dfd54b38?source=collection_archive---------10-----------------------#2019-08-20">https://betterprogramming.pub/convert-static-websites-to-rest-apis-with-cloud-functions-82f4dfd54b38?source=collection_archive---------10-----------------------#2019-08-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a3fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">按需以低成本执行复杂的转换</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1723b3ec019f508bd928db3399e86654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySUS6PGMRaEkcQcU4jZd0w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托拜厄斯·菲舍尔在<a class="ae ky" href="https://unsplash.com/search/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常遇到这样的情况，我的应用程序需要的数据是可用的，但不是以它可以随时使用的格式。</p><p id="b989" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">云功能等微服务在这里真的大放异彩。它们可以根据需要将数据从一种形式转换成另一种形式，而且通常非常便宜。因为它们是不同的执行上下文，所以它们不必与消费应用程序的技术栈相匹配。这使得他们可以使用最适合转换工作的语言和库。</p><p id="3f22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们还完全封装(隐藏)了通常不优雅的转换代码，使消费应用程序的逻辑简单而集中。</p><p id="0d27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常需要的一个转换是从静态网站到RESTful APIs。让我举几个例子来说明。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1224" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">示例1:库目录结果</h1><p id="f3d3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">以我当地的图书馆网站为例。我想创建一个浏览器插件，当在线购物者在图书馆找到他们要找的书时通知他们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/730abfef26362198237450d60283a11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8qvbkEPsF6sa-YeO59BeA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.nicepik.com/selective-focus-photography-of-pile-of-hardbound-books-old-vintage-chipped-table-wood-free-photo-30373" rel="noopener ugc nofollow" target="_blank"> Nicepik </a>供图</p></figure><p id="6246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图书馆网站提供了一个可搜索的在线目录。然而，网站上的所有页面都是在服务器端呈现的。该库也没有公开公共的web API。</p><p id="aa89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，我唯一的选择是将我的搜索查询发送到库的服务器，并向我的扩展添加逻辑来解析返回的搜索结果HTML。</p><p id="54c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们创建一个云函数，接受来自我的浏览器扩展的请求，对库的服务器进行网络调用，解析返回的HTML，并发回一个格式良好的JSON响应，会怎么样呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e0acd0357499292f7dfe9d31f2b2adda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylcN2g-shvkVGiVdCW0mXA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">转换API架构</p></figure><p id="0385" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将有效地将本地库的静态呈现网站转换成RESTful JSON API。</p><p id="5ada" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很酷。</p><p id="d258" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的云函数代码。(我使用带有AWS Lambda的<a class="ae ky" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器</a>框架进行开发和部署)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c8d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的应用从新的API获得的JSON的图像。这列出了图书馆目录中单词<em class="nc"> computer </em>的第一个条目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/f31d9b276b7e2bf6c38d0179156f7369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i7FWepkJImX-rGXYxJ40Ig.png"/></div></div></figure><p id="52de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望您已经看到了这种微服务数据转换架构的强大之处。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2744" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">示例2:计算机科学系</h1><p id="5cca" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">比方说，我们正在开发一个应用程序，根据犹他大学潜在的研究生的研究兴趣，向他们推荐教师导师。</p><p id="0b5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，在学校的网站上可以找到一份教师名单，包括研究简介甚至联系方式。</p><p id="4c98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们遵循相同的模式来创建一个web API。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">犹他大学教师API函数代码</p></figure><p id="2292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是来自新教员API的回应:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/63378a9fb68d763e3ea6907f5d917fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YT4Ge8xgJpzhPfj2rFu3Qw.png"/></div></div></figure><p id="3ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击这里查看API工作直播<a class="ae ky" href="https://91iqp08xwg.execute-api.us-east-1.amazonaws.com/dev/faculty" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c6fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与图书馆的例子有许多相似之处。但是你注意到不同了吗？</p><p id="56ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个重要的问题:教员很少变动<em class="nc">。</em></p><p id="6714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最后一个示例中，每次云功能收到消费者的搜索请求时，都需要轮询图书馆网站。然而，事实往往并非如此。</p><p id="812e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个教员的例子中，实际上很少需要检查静态网站的更新。这让我们可以缓存教师数据，并简单地偶尔在网站上查询更新。进行这种更改可以将数据源从消费应用程序中分离出来。我们已经从一个云功能转移到两个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/2c8de52f08a4f26a95689eac6738462d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AVaeZOQPTxYFMvwwBraRw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">缓存转换架构</p></figure><p id="b4db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一方面，我喜欢这种分离，因为如果您不控制数据源(静态网站或其他)，未经宣布的更改可能需要更新转换代码。</p><p id="d789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有这种分离，最终用户很可能会立即发现转换失败。</p><p id="af6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了它，消费应用程序可能会继续正常运行一段时间。这给了你时间来更新转换代码。</p><p id="2bb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，唯一的缺点是额外的复杂性，即确保缓存总是足够新，以适合您的消费应用程序。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b93b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="8b3d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">虽然这篇文章特别适合于从静态网站转换到RESTful APIs，但是让我重申一下这种云函数转换模式的普遍适用性。</p><p id="03d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它提供了一个模块化、有针对性的独立环境，可以在其中执行现代应用经常需要的复杂转换操作。</p></div></div>    
</body>
</html>