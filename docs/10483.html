<html>
<head>
<title>SwiftUI: How to Programmatically Scroll to a Row</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI:如何以编程方式滚动到一行</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swiftui-scroll-to-row-in-scrollview-29d2eb5deba5?source=collection_archive---------12-----------------------#2022-01-10">https://betterprogramming.pub/swiftui-scroll-to-row-in-scrollview-29d2eb5deba5?source=collection_archive---------12-----------------------#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aec7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何以编程方式轻松滚动到ScrollView的某一行</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/769c0cb2a02eaed0ddad78606085491b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pC-w8_TX2JG0HUDuIHjkcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"> Undraw </a></p></figure><p id="382c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当执行简单的任务时，SwiftUI ScrollView会变得非常乏味，而使用旧的亲爱的UIKit会非常非常令人沮丧。</p><p id="1293" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很遗憾，滚动到想要的行是其中之一。</p><p id="c267" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在UIKit中，每个<code class="fe lv lw lx ly b">UIScrollView</code>都有一个非常方便的方法来以编程方式滚动视图本身:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="b093" class="md me it ly b gy mf mg l mh mi">func setContentOffset(CGPoint, animated: Bool)</span></pre><p id="f4eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以同样的方式，每一种子类都有类似的方法；例如，在<code class="fe lv lw lx ly b">UITableView</code>中，您可以使用:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="d9e0" class="md me it ly b gy mf mg l mh mi">func scrollToRow(at: IndexPath, at: UITableView.ScrollPosition, animated: Bool)</span></pre><p id="1da3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令人惊讶的是，目前SwiftUI中缺少这些简单的功能，因此我们必须编写稍微复杂一点的代码来执行相同的任务。</p><p id="85fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建一个演示应用程序，能够重现以下行为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/e94eee451b3981610dc2b16bdc3f6b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/1*qACj1d2IcNuvqeHg2fbDsQ.gif"/></div></figure><p id="1948" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像上一篇文章一样，是时候编写上面显示的非常简单的UI了。我们将只使用一个<code class="fe lv lw lx ly b">List</code>和一个<code class="fe lv lw lx ly b">Picker</code>视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="1a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这种朴素的UI是不行的。当我们使用滚轮选择器选择一个项目时，没有任何反应。</p><p id="4070" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望有某种能够观察和读取<code class="fe lv lw lx ly b">ScrollView</code>内部发生的事情的组件</p><p id="9bb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着iOS 14的发布，苹果推出了一款名为<code class="fe lv lw lx ly b">ScrollViewProxy</code>的新<code class="fe lv lw lx ly b">struct</code>，定义如下:</p><blockquote class="mm mn mo"><p id="4612" class="kz la mp lb b lc ld ju le lf lg jx lh mq lj lk ll mr ln lo lp ms lr ls lt lu im bi translated">扫描代理包含的所有滚动视图，查找带有标识符为“id”的子视图的第一个视图，然后滚动到该视图。</p></blockquote><p id="0f5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在SwiftUI官方文档的同一部分，我们还可以看到:</p><blockquote class="mm mn mo"><p id="a542" class="kz la mp lb b lc ld ju le lf lg jx lh mq lj lk ll mr ln lo lp ms lr ls lt lu im bi translated">你不需要直接创建<code class="fe lv lw lx ly b">ScrollViewProxy</code>的实例。相反，您的<code class="fe lv lw lx ly b">ScrollViewReader</code>在其<code class="fe lv lw lx ly b">content</code>视图构建器中接收到一个<code class="fe lv lw lx ly b">ScrollViewProxy</code>的实例。</p></blockquote><p id="3339" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，正如苹果自己建议的，我们将使用<code class="fe lv lw lx ly b">ScrollViewReader</code>视图！</p><p id="684d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个新组件是一个内部带有代理scrollView的<code class="fe lv lw lx ly b">View</code>。所以我们可以开始用下面的方式修改我们的UI:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="8f22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的代码中可以得出一些推论:</p><ul class=""><li id="1091" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">在第8行中使用了<code class="fe lv lw lx ly b">ScrollViewReader</code>视图。</li><li id="ba56" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">在第11行，我们将修饰符<code class="fe lv lw lx ly b">.id(index)</code>添加到了<code class="fe lv lw lx ly b">Text</code>视图中。正如SwiftUI中经常发生的那样，我们可以用一个id唯一地标识一个元素。这正是我们在这里所做的。</li></ul><p id="c909" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候创建能够以编程方式滚动列表的真正代码了。<br/>在第22行，我添加了注释<code class="fe lv lw lx ly b">// More to come...</code>,我们将把选取器的选择绑定到一个动作。</p><p id="b800" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们写几行代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="1931" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Just</code>操作符来自Combine框架，所以我们需要在文件顶部添加一个导入:<code class="fe lv lw lx ly b">#import Combine</code>。</p><p id="351d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，搞定了！</p><p id="9b7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当我们选择一个提货行时，上方的<code class="fe lv lw lx ly b">List</code>会滚动到某一行。</p><p id="de63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的。您可能已经注意到，这段代码工作正常，但并不美观。UX对那种“跳跃”一点也不友好。</p><p id="9595" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们给卷轴添加一个简单而愉快的动画:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="1626" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">示例已经完成，是时候在一个地方展示完整的代码了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="a893" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在不到40行的时间里，我们得到了我们所需要的。</p><p id="2321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，一旦你理解了基本的机制，整个过程是非常简单的，你只需要记住添加一个id到你想要滚动到的项目。</p><p id="aedc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。同样的指南在我的YouTube频道上也有视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no ml l"/></div></figure></div></div>    
</body>
</html>