<html>
<head>
<title>How To Create a Discord Bot With 10 Lines of JavaScript Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用10行JavaScript代码创建一个不和谐机器人</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-a-discord-bot-with-10-lines-of-code-6ad05e28e5f3?source=collection_archive---------12-----------------------#2021-06-15">https://betterprogramming.pub/how-to-create-a-discord-bot-with-10-lines-of-code-6ad05e28e5f3?source=collection_archive---------12-----------------------#2021-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a730" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">释放Node.js和Discord.js的力量</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/1be18be80dea2f7c36c0653dbb5efb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSbm5so0zwaSZFwh0BlXfg.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">奥斯卡·伊尔迪兹在<a class="ae kw" href="https://unsplash.com/s/photos/javascript?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="c8b3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><a class="ae kw" href="https://discord.com/" rel="noopener ugc nofollow" target="_blank"> Discord </a>是一款非常流行的消息和VOIP应用。主要由游戏玩家使用，它现在非常普遍，并且与游戏、启动器有很大的集成，它甚至有一个移动应用程序。</p><p id="38ca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">像<a class="ae kw" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-a-telegram-bot-with-10-lines-of-code-4b38bc3a101a"> Telegram </a>一样，它提供了创建群组的可能性，在群组中你可以拥有自动执行某些任务的机器人。对我们来说幸运的是，通过使用<a class="ae kw" href="https://discord.js.org/#/" rel="noopener ugc nofollow" target="_blank"> Discord.js </a>，我们可以使用Node.js创建这些。所以让我们看看如何创建非常基本的机器人供我们使用。</p><p id="0f47" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">注意:本文假设您对Node.js和npm有基本的了解。</em></p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="71d9" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">注册我们的机器人</h1><p id="239e" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">像Telegram一样，我们需要注册我们的机器人。我们需要在<a class="ae kw" href="https://discord.com/developers/applications" rel="noopener ugc nofollow" target="_blank"> Discord开发者门户</a>注册。</p><p id="66c7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">单击“新建应用程序”并输入应用程序的名称。我用过“测试机器人”当您创建bot时，您将被重定向到一个包含您的项目的各种信息的页面(比如API密钥)。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi my"><img src="../Images/2d1a5c5ac02e7c5c9ab54ae9499dc76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*RtKRGfDL9f0tPq_9q5Z2-g.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">DD门户的侧菜单</p></figure><p id="deef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在屏幕左侧，选择“机器人”选项卡。在这里，您可以单击“添加机器人”按钮来创建您的第一个机器人。单击“接受”,您将被重定向到一个页面，在该页面上您可以更改您的机器人的数据。我们现在已经成功注册了它，可以继续在IDE中进行安装了。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="6cd9" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">装置</h1><p id="9d3c" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">在保存bot代码项目的地方创建一个新文件夹。在您选择的IDE中打开新文件夹。我将使用Visual Studio代码，因为它非常漂亮和简约。</p><p id="ca07" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">打开终端并初始化NPM:</p><pre class="kh ki kj kk gt mz na nb nc aw nd bi"><span id="421b" class="ne mc iq na b gy nf ng l nh ni">npm init -y</span></pre><p id="1606" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们现在有了我们的<code class="fe nj nk nl na b">package.json</code>文件，我们可以继续安装Discord.js。我还将安装<a class="ae kw" href="https://medium.com/quick-programming/why-you-almost-always-want-to-use-nodemon-b446286eabdf" rel="noopener"> Nodemon </a>以便于重新启动:</p><pre class="kh ki kj kk gt mz na nb nc aw nd bi"><span id="8f05" class="ne mc iq na b gy nf ng l nh ni">npm i discord.js<br/>npm i nodemon</span></pre><p id="70d0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">运行这两个命令，我们现在就有了创建一个Discord bot所必需的依赖项。如果你想隐藏你的API密匙，你也可以安装Dotenv。我写了<a class="ae kw" href="https://javascript.plainenglish.io/introduction-to-dotenv-f2bdf93e4a1" rel="noopener ugc nofollow" target="_blank">一个关于这个话题的教程</a>。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="98ed" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">创建机器人的启动命令</h1><p id="2336" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">在我们的文件夹中，创建一个<code class="fe nj nk nl na b">index.js</code>文件。这个文件将是我们的应用程序的入口点。我们还需要更改我们的<code class="fe nj nk nl na b">package.json</code>,这样我们就可以实际运行文件了。打开您的<code class="fe nj nk nl na b">package.json</code>文件并添加以下脚本:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1388" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用<code class="fe nj nk nl na b">npm run start</code>，我们可以在最终可能部署应用程序时启动它。通过<code class="fe nj nk nl na b">npm run dev</code>，我们将使用Nodemon启动开发服务器。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="f503" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">进入我们不和谐服务器的机器人</h1><p id="8a3d" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">在我们继续之前，我们需要将bot添加到Discord服务器。我在我的Discord上创建了一个空的测试服务器，这样我就不会打扰我的任何朋友。</p><p id="ca2c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">返回开发者门户，点击“OAuth2”选项卡。这里，我们需要选择bot的范围。在这种情况下，它只是“机器人”勾号。您还可以在下面的权限块中添加“管理角色”和“发送消息”复选标记。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi no"><img src="../Images/c4eb1dead548c54e3b9987c69f4d1845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNbizapEJ7hHvOHubXaB7Q.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">开发人员门户中的权限</p></figure><p id="393e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要将bot输入服务器，请从作用域内复制链接。出于显而易见的原因，我已经模糊了我的。</p><p id="9882" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">复制链接并在浏览器中转到该地址。您将收到一条标准的授权信息。将机器人添加到适当的服务器(我们的测试服务器)<strong class="kz ir"> </strong>这样你就不会打扰你的朋友了。</p><p id="693c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">完成后，您应该会看到机器人已经通过Discord服务器中的消息以及网页上的确认屏幕加入了您的服务器。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi np"><img src="../Images/c56bc3e64f138ec4f87e4f6eddefda5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*FrCUL9-3urjTO8p15E-jAw.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">欢迎我们的机器人加入服务器。</p></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="eb1a" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">编写我们的机器人</h1><p id="bbe1" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">我们终于可以开始编码了。从开发人员门户的“bot”选项卡中复制Bot的令牌，并将其添加到您的代码中(如果您选择这样做，最好是在Dotenv文件中)。这对开发来说不是必需的，但是这样做更安全。</p><p id="a76a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">注意:我将混淆我的gists，其中我用全大写字母显示了带有虚构常数的代码。</em></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/46f1ee7c96af44687bed187812174de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*hiAvL6wT6EQe5CDSYXCE0Q.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">获取令牌</p></figure><p id="ff1b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第一个任务是登录机器人。它在我们的服务器里，但是我们的甜蜜机器人仍然离线。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3e36" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当您通过运行<code class="fe nj nk nl na b">npm run dev</code>以适当的<code class="fe nj nk nl na b">BOT_KEY</code>运行这段代码时，您会注意到机器人现在在我们的服务器上是在线的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/dedf450cfd9854c0c5ab0c3d550c8534.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*iqQqpQ7vfl4Y0Z2iSVYoSg.png"/></div></figure><p id="c688" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是现在它没有做任何事情。当它准备做其他事情时，我们应该首先让它在终端中发送一个消息。我们使用<code class="fe nj nk nl na b">client.on()</code>函数来完成这项工作。这个函数需要一个事件名和一个到达该事件时要执行的函数。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a263" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，当您保存文件时(如果您不使用Nodemon，可以选择重启服务器)，您会在我们的终端中注意到一条消息。</p><p id="3a9b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让它回复一条“你好”的消息吧。我们为此使用了<code class="fe nj nk nl na b">client.on("message", ...)</code>函数。在我们作为参数传递的函数中，我们可以检查消息是否说了“Hello ”,并用一个问候来回复它。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="7ac8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当我们再次重启服务器时，我们可以说“你好”并得到回复。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d6fb9ad363dc3a0d8c845ac00c5838ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*XZLnxG_k54CaX3Jjl48Sag.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">友好的机器人</p></figure><p id="a3f6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果我们不想回复一条消息，而只是简单地发送一条新消息，我们可以用<code class="fe nj nk nl na b">msg.channel.send(STRING)</code>代替<code class="fe nj nk nl na b">msg.reply(STRING)</code>。试试看。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="80f1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">要警惕的是，如果它寻找的消息(“Hi”)与它发送的消息(“Hello”)相同，如果你不检查它是否发送，它就会向你的服务器发送垃圾邮件。</em></p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="2cfe" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">结论</h1><p id="ffad" class="pw-post-body-paragraph kx ky iq kz b la mt jr lc ld mu ju lf lg mv li lj lk mw lm ln lo mx lq lr ls ij bi translated">当然，这个最小的十行代码是针对一个基本的机器人的。我甚至可以试着用五行代码得到一个更小的机器人，但那将是非常愚蠢的。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="ca60" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通过这段简单的代码和开发人员门户上的少量工作，您已经可以创建赌博机器人或在遇到问题时提供信息的机器人——至少如果您有适当的JavaScript技能。</p><p id="f459" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对我来说，搞清楚这一点很有趣。关于机器人，我还有很多东西要学，我已经迫不及待了。</p><p id="5eff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">非常感谢您的阅读，祝您度过美好的一天。</p></div></div>    
</body>
</html>