<html>
<head>
<title>Will Tauri Be an Electron Killer?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tauri会成为电子黑仔吗？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/will-tauri-be-an-electron-killer-38fd6478004?source=collection_archive---------0-----------------------#2022-04-18">https://betterprogramming.pub/will-tauri-be-an-electron-killer-38fd6478004?source=collection_archive---------0-----------------------#2022-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c607" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你知道Tauri吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b592572fd11c9cb6ef28401efc093d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nInc4e-hr6bvrSnrfGmzA.png"/></div></div></figure><p id="0fe4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">作为一个前端开发人员，我相信你应该了解电子。它使用JavaScript开发跨平台的桌面应用，但是你听说过Tauri吗？</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="e11c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">Tauri是什么？</h1><blockquote class="mp mq mr"><p id="125d" class="ku kv ms kw b kx ky ju kz la lb jx lc mt le lf lg mu li lj lk mv lm ln lo lp im bi translated">Tauri是一个为所有主流桌面平台构建微小、速度惊人的二进制文件的框架。开发人员可以集成任何编译成HTML、JS和CSS的前端框架来构建他们的用户界面。应用程序的后端是一个来源于rust的二进制文件，带有一个前端可以与之交互的API。</p></blockquote><p id="7f92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以上介绍来自官方<a class="ae mw" href="https://github.com/tauri-apps/tauri#introduction" rel="noopener ugc nofollow" target="_blank"> Github库</a>。简短的几句话概括了Tauri的特点:</p><ul class=""><li id="5f61" class="mx my it kw b kx ky la lb ld mz lh na ll nb lp nc nd ne nf bi translated">小型建筑</li><li id="919e" class="mx my it kw b kx ng la nh ld ni lh nj ll nk lp nc nd ne nf bi translated">良好的性能</li><li id="3430" class="mx my it kw b kx ng la nh ld ni lh nj ll nk lp nc nd ne nf bi translated">二进制文件</li><li id="b55c" class="mx my it kw b kx ng la nh ld ni lh nj ll nk lp nc nd ne nf bi translated">跨平台</li><li id="b688" class="mx my it kw b kx ng la nh ld ni lh nj ll nk lp nc nd ne nf bi translated">用户界面可以使用web前端技术堆栈</li><li id="24a8" class="mx my it kw b kx ng la nh ld ni lh nj ll nk lp nc nd ne nf bi translated">程序后端使用Rust</li></ul><p id="4898" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">看起来太好了！那么它会是电子杀手吗？</p><h1 id="64b5" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">Tauri对电子</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/36e3e98b959cb6ae041d304becd1fb9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*w2oNdWMobAYA2i4bheThAQ.png"/></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">图片来自<a class="ae mw" href="https://github.com/tauri-apps/tauri#comparison-between-tauri-and-electron" rel="noopener ugc nofollow" target="_blank"> Github </a></p></figure><p id="7c95" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上图是现在Tauri和Electron的对比。</p><p id="e5f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以看到它比电子有一些优势，比如包装尺寸和发射时间。它还有一些电子不支持的特性。</p><p id="f769" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是<strong class="kw iu">锈</strong>最吸引我的注意。近几年频频出现在前端圈，还有SWC，德诺等。都在用。它是一种静态类型安全的语言，没有运行时和垃圾收集机制。它特别擅长于高性能、可靠性和高生产率。编译器足够严格以保证内存安全和线程安全。</p><p id="0972" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里，它被用作后端绑定和底层引擎。我将在下面与电子的比较中描述它是如何工作的。</p><p id="b48a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我将从几个角度比较这两者:开发、构建、自动更新和架构。</p><h1 id="e276" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">发展</h1><p id="c086" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">要创建Tauri应用程序，您必须首先在本地计算机上准备好<a class="ae mw" href="https://www.rust-lang.org/tools/install" rel="noopener ugc nofollow" target="_blank"> Rust环境</a>和<a class="ae mw" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js环境</a>。你可以去他们官网按照步骤安装。让我们关注如何创建一个Tauri项目。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="f845" class="of ly it ob b gy og oh l oi oj">yarn create tauri-app<br/>#OR<br/>npx create-tauri-app</span></pre><p id="352b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Tauri内置了很多模板，所以我们可以自由选择:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/e7e7228163c2d594abb6d1dcc37dd808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kd1btk6Yvv5L887Cn_g6LQ.png"/></div></div></figure><p id="446b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我在这里选择了Vite + react-ts，下面是生成的目录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/c9bd0d1cb7d479b8dd4c94f338ddd064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*dm78mu-CbadkvlLEdJ2A8w.png"/></div></figure><p id="3a23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可以看到项目结构非常清晰。如果选择另一个模板，整个项目结构大致相同。主要变化是前端项目结构。</p><p id="d285" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们来看看默认生成的<code class="fe om on oo ob b">package.json</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8dd80814874be757815969a436d59101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*YqJqUXRSF9jHrRP7chzZVg.png"/></div></figure><p id="d8f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">太棒了。Tauri已经为我们做了一切。我们可以用<code class="fe om on oo ob b">yarn tauri dev</code>开始开发，用<code class="fe om on oo ob b">yarn tauri build</code>包装最终产品。</p><p id="a11e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">web前端命令可以在<code class="fe om on oo ob b">src-tauri/tauri.conf.json</code>中定制:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/5ff42cb3e92883b06ef69d2d91595411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*7z397zStY5YnIbtbWqO26w.png"/></div></figure><p id="a2f2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Tauri也可以有选择地集成到现有的前端项目中。相比之下，电子官方不提供模板创建功能。只能根据文档逐步配置。</p><p id="e33b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以在开发体验方面，<strong class="kw iu"> Tauri开箱即用，给我们一个清晰的项目配置，绝对节省了我们很多时间。</strong></p><h1 id="5bfe" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">建筑物</h1><p id="2303" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">Rust现阶段的编译时间饱受诟病，这是Tauri打包时间过长的直接结果。但是好消息是下一次编译将使用缓存来减少时间。此外，最终产品将以二进制形式存在，为破解增加了一层安全保障。</p><p id="6283" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">默认情况下，Electron不会打包主程序代码，它甚至会将巨大的<code class="fe om on oo ob b">node_modules</code>打包到最终程序中。这进一步增加了制造产品的尺寸。这也导致源代码没有加密机制。即使它把源代码包装在asar里，也很容易被破解。</p><p id="9ae7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当然，我们可以使用构建工具对源代码进行打包和模糊处理，这显然是费时费力的。</p><p id="0a44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样值得注意的是，电子可以跨平台构建。例如，它可以在Mac平台上为Windows平台构建软件包。而Tauri目前只能搭建在相应的平台上。这对于自动打包和分发的系统来说是一个麻烦。</p><h1 id="c4bb" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">自动更新</h1><p id="aaea" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">为了在三大桌面平台上支持自动更新，Electron需要第三方库，如<code class="fe om on oo ob b">electron-builder</code>或<code class="fe om on oo ob b">electron-packager</code>。Tauri可以原生支持它。</p><h1 id="42ef" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">体系结构</h1><p id="01b6" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">在架构上，Tauri没有包装铬。<strong class="kw iu">它使用自主开发的</strong> <a class="ae mw" href="https://github.com/tauri-apps/wry" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> WRY </strong> </a> <strong class="kw iu">连接各种平台的Web引擎，提供统一的界面来呈现WebView。</strong>它所使用的每个平台的底层Web引擎:</p><p id="2095" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="ms">在Windows平台上使用微软Edge Chromium的WebView2Mac上的WebKit在Linux平台上使用WebKitGTK。</em></p><p id="1e71" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这意味着<strong class="kw iu">它与铬</strong>无关。如果在Mac平台上打开DevTools，可以看到其内部UI与Safari一致。如果你在Windows平台上打开DevTools，你会发现它的内部UI和微软Edge是一致的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/492628e0f6e6cf9698a1b4859c364a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMDrSgz3WxDnZDDcMlvDGg.png"/></div></div></figure><p id="17e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">也就是说，它只做<strong class="kw iu">粘合层</strong>，所以它的体积很小。</p><p id="1aa2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除此之外，他们还开发了<a class="ae mw" href="https://github.com/tauri-apps/tao" rel="noopener ugc nofollow" target="_blank"> TAO </a>，一个用于跨平台应用窗口创建的库，并在WRY中重新导出，用于事件循环和窗口创建。</p><p id="d7fe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">电子包裹整个铬进行前端渲染。在事件循环中，它启动了一个单独的线程，该线程持续轮询Node.js中的<code class="fe om on oo ob b">backend_fd</code>以获取来自<a class="ae mw" href="https://github.com/libuv/libuv" rel="noopener ugc nofollow" target="_blank"> libuv </a>的新事件。当发现新事件时，它们被转发到Chromium的事件循环(MessageLoop)。详见下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/17eb085c72cba6fce87afc99b73ad5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTXmrQqhst2P5JWWpMz7Ng.png"/></div></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">图片来自<a class="ae mw" href="https://www.youtube.com/watch?v=OPhb5GoV8Xk" rel="noopener ugc nofollow" target="_blank"> Shelley Vohr | JSHeroes 2019 </a></p></figure><p id="7066" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过以上方式，Electron将Node.js的事件循环整合到Chromium的事件循环中，保证了应用的性能。</p><p id="f886" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">两相比较，我的感性认识是:</p><p id="bbb9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">电子更像是一种融合技术，将Node.js集成到Chromium中。</p><p id="c291" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Tauri更像是胶水，把WebView的渲染交给各个平台的内置Web引擎。Tauri是可以通过WRY和TAO控制GUI的顶层。</p><h1 id="44dc" class="lx ly it bd lz ma nl mc md me nm mg mh jz nn ka mj kc no kd ml kf np kg mn mo bi translated">结论</h1><p id="24f5" class="pw-post-body-paragraph ku kv it kw b kx nv ju kz la nw jx lc ld nx lf lg lh ny lj lk ll nz ln lo lp im bi translated">Tauri性能好，前景好。它解决了电子存在的许多问题，带来了简单方便的开发体验。但仍有一些问题需要改进，Rust的学习曲线是曲折的，有一定的学习成本。</p><p id="7107" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">今天电子发展得很好。而且它依托的是欣欣向荣的Node.js社区，周边生态非常好。它前后端都用JavaScript，所以学习成本更小。</p><p id="ace8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你觉得Tauri怎么样？</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="cc87" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="ms">感谢阅读。如果你喜欢这样的故事，想支持我，请考虑成为</em> <a class="ae mw" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="ms">中会员</em> </a> <em class="ms">。每月5美元，你可以无限制地访问媒体内容。如果你通过</em> <a class="ae mw" href="https://medium.com/@islizeqiang/membership" rel="noopener"> <em class="ms">我的链接</em> </a> <em class="ms">报名，我会得到一点佣金。</em></p><p id="1cac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你的支持对我很重要——谢谢。</p></div></div>    
</body>
</html>