# 微服务不是银弹。了解原因。

> 原文：<https://betterprogramming.pub/microservice-pros-cons-69ffe8c39faf>

## 要微服务还是不要微服务？

![](img/5cb93406a70d6e58d24ca9e33bf3343c.png)

由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的 [Shubham Dhage](https://unsplash.com/@theshubhamdhage?utm_source=medium&utm_medium=referral) 拍摄的照片

在过去的几年里，我们被一句口头禅轰炸:使用微服务，整体就是邪恶。从那时起，那些维护旧代码库的人，或者正在实现简单 MVC 网站的人，不得不为没有遵循微服务模式而感到力不从心。你有过这种感觉吗？嗯，我想我们大多数人都知道。

微服务是一种提高可维护性和加速开发的架构原则。也许，这是交付复杂项目而不陷入架构问题的唯一方法。但是如果你做的方法不对呢？微服务是一种不允许妥协的模式:要么你做得对，要么最好别做。这是另一个我们听了很多遍的咒语，我们认为它是真的。

在本文中，我将解释什么是微服务，以及它们如何有助于保持一个干净的架构，并从您的软件中获得最佳效果。然后，我将探索你在这条道路上能找到的所有批判性，这样你就能有意识地采纳它。

# 我们为什么需要微服务？

微服务是交付软件解决方案的最佳实践架构原则的发展。

所有的行业，不管 IT 是否是他们的核心业务，都必须努力交付能够给总是要求更高的目标用户提供最佳体验的软件。

这意味着更多的变化和更大的复杂性。通常，这些硬性要求转化为涉及多个团队，并且在很短的时间内工作。在这种情况下，高效是必须的。一个简单快捷的方法是将软件架构与业务能力结合起来。

> 微服务允许将问题分解成独立的子问题，这些子问题可以由不同的自治团队并行管理。

单个项目的上下文是由业务流程和事务构成的，在这个有限的范围内很容易确定要做什么。结果是一个 web 服务网络，它处理单个问题(微服务),并被编排为交互和实现整个用户体验。

# 微服务多少微

接下来的一点就是微服务必须有多小。在这个问题上，大多数采用微服务的项目都失败了。

问题是，并不是所有的应用程序范围都是以一种可以将它们划分成原子小部分的方式定义的。那么，这些零件必须小到什么程度才能产生效益呢？也许没有任何书面规定。

想象一个微服务，就像一个具有领域模型的应用程序。如果这个域太小，您将需要通过添加更多的应用程序来完善功能。

从更高的角度来看，您将有多个应用程序在做同样的事情，因此存在能力重叠和重复的风险。另一方面，如果域模型更大，您就有包含多个域的风险，失去拥有尽可能小的单元的好处。

当您设计微服务架构时，使用域驱动的方法非常有帮助，但是当您的模型由于依赖性、遗留应用程序部分或其他现实世界中的问题而不允许被分解为原子部分时，这是没有任何解决方法的，除非您在纸上工作。

> 正是因为这些不可预测的问题，大多数微服务架构在一个好的设计之后，会转向一些不同的东西。

最常见的不可预测的行为是程序员在他们的工作中添加特性的习惯。我们说用户要求很高，我们不得不应对大量的变更请求。

接受任务的开发人员是否能够理解这不仅仅需要一个新的端点，而是需要一个全新的微服务？如果某些微服务领域被违反，他有权力停止计划并重构吗？这只是打开“微服务”应用程序时，你会发现一些微服务看起来像一块小石头的部分原因。

# 避免分布式整体块的错误

我们常常被解决问题弄得不知所措、疲惫不堪，以至于我们相信谁在为某些事情推销银弹。巧合的是，解决方案总是最新的技术。

在不知道自己在做什么的情况下使用微服务架构可能比管理我们良好的旧整体架构更糟糕。

事实上，没有策略地拆分 monolith 不会导致微服务架构，而是导致 monolith 分布到许多小应用程序中。这产生了通信问题、延迟和依赖性，不允许在应用程序的不同部分上并行开发过程。

因此，要做的第一件事是采用一种能从架构中获得最大利益的方法。

> 否则，风险在于随着分布式体系结构的复杂性增加而陷入整体。

微服务的真正问题是没有任何书面规则可以保证结果。唯一的解决方案是采用回顾性的方法，每天都保持一个完美的架构，并创建正确的文化，让每一个资源从架构的角度意识到他们的选择的含义。

此外，增加要部署的应用程序的数量，在没有合适的基础架构的情况下做微服务是不可行的。您需要良好的 DevOps 自动化，并且希望有一个可以轻松扩展的基础架构。要了解更多关于现代 DevOps 原则的信息，请阅读我的关于 NoOps 的文章。

# 带什么回家

微服务往往被当做万能的灵丹妙药来卖，但闪光的不一定都是金子。微服务是一种有用的模式，它可以产生干净的架构，加速实现新事物，以及可维护的系统。

> 无论如何，一个设计糟糕的微服务会扼杀我们的梦想，并产生与 Monolith 和微服务架构的复杂性相同的问题的软件。

为了避免这种情况，第一个要求是从良好的业务分析开始，但最重要的是，要考虑经常对偏离理想行为的微服务进行重构。

此外，如果您的业务模型与大量的领域模型不兼容，您可以接受单个应用程序的大小不是微型而是迷你，并将相同的原则应用于更大的应用程序领域。这将使我们的微服务架构不是乌托邦式的，并将为我们的项目带来(大部分)微服务的好处。