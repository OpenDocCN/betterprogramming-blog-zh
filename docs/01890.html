<html>
<head>
<title>Creating a Tutorial for a SpriteKit Game</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为精灵游戏创建教程</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-tutorial-for-a-spritekit-game-f10f2228e414?source=collection_archive---------12-----------------------#2019-10-20">https://betterprogramming.pub/creating-a-tutorial-for-a-spritekit-game-f10f2228e414?source=collection_archive---------12-----------------------#2019-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d99" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">循序渐进的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9ae72c53e710b444595ee2c29af10488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLp_6dTE6WPpStiH48yfcA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1820039" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/Wokandapix-614097/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1820039" rel="noopener ugc nofollow" target="_blank"> Wokandapix </a></p></figure><p id="2885" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，我和妻子正在开发一个小游戏。玩家控制一条鱼，这条鱼需要在从深海游上来的途中躲避障碍物。这条鱼只能在四个泳道内游泳，正如你在这张图片中看到的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/a29344f23fb5bf426ee305287faf68e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*34cTXqRoEVQsDHH_LhEi1w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">鱼弗雷迪可以在这四条泳道中游泳，需要躲避障碍物。</p></figure><p id="dd29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">玩家可以通过向左或向右滑动来切换车道。你会猜测这个概念并不难理解，我们也是如此。但是当测试用户玩的时候，他们中的一些人不明白他们需要做什么。因此，我们决定将第一级转化为教程。由于我找不到如何添加教程的教程，我将描述我们采取的方法。</p><p id="fea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">教程级别的每个步骤都由两部分组成。首先，鱼需要停在一个特定的点上，同时用户得到他们必须做什么的提示。第二，用户完成滑动手势后，鱼需要进行所需的动作。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6bb6" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">1.教程节点的设置</h1><p id="0112" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们通过在场景中添加节点来标记鱼应该停留的点。每个节点的名称都以<code class="fe na nb nc nd b">tutorial_node_</code>开头，后面是教程中步骤的编号。这些节点是在方法<code class="fe na nb nc nd b">setupNodes</code>中准备的，当场景被移动到一个视图时会调用这个方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置教程节点</p></figure><ol class=""><li id="7025" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">将节点添加到场景编辑器后，我们需要在代码中访问它们。我们可以通过从场景中获取周围的<code class="fe na nb nc nd b">world</code>节点并遍历其子节点来做到这一点。</li><li id="3f5e" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">现在我们可以访问节点，我们需要准备它们。我们把他们弄清楚，这样他们就不会在游戏中被看到，我们为他们每个人都创建了一个<code class="fe na nb nc nd b">SKPhysicsBody</code>，这样他们就可以被鱼击中。每个物体的大小和位置都与节点本身相同，并获得一个<code class="fe na nb nc nd b">categoryBitMask</code>值，以将它们标记为教程中涉及的节点。最后，通过将<code class="fe na nb nc nd b">isDynamic</code>属性设置为<code class="fe na nb nc nd b">false</code>，节点不会受到重力的影响，将会停留在原来的位置。</li></ol></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="df6f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">2.处理与教程节点的联系</h1><p id="fed8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">为了检测播放器和教程节点之间的接触，我们需要实现<code class="fe na nb nc nd b">didBegin</code>方法，这是<code class="fe na nb nc nd b">SKPhysicsContactDelegate</code>协议所要求的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">处理玩家与教程节点的联系。</p></figure><ol class=""><li id="5d7a" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">作为参数传递的contact对象包含contact中涉及的两个元素<code class="fe na nb nc nd b">bodyA </code>和<code class="fe na nb nc nd b">bodyB</code>。通过在<code class="fe na nb nc nd b">categoryBitMask</code>中将两者结合起来，我们可以检查哪些节点发生了冲突。</li><li id="a811" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">在鱼和教程块的例子中，我们需要展示教程的下一部分。</li><li id="6ecf" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">首先我们让鱼停下来。它只会在用户完成教程的这一部分后继续游动。</li><li id="48e3" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">我们通过使用一个叫做node <code class="fe na nb nc nd b">(withCategory:)</code>的小助手函数从contact中提取tutorial块。它是<code class="fe na nb nc nd b">SKPhysicsContact</code>的扩展，检查bodyA或bodyB是否有教程<code class="fe na nb nc nd b">categoryBitMask</code>并返回正确的body。现在我们可以检查教程块的名称。因为我们在场景编辑器中列举了它们，所以我们知道玩家当前处于教程的哪一步。在本例中，我们将只探索第一步。</li><li id="d3ef" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">每当鱼开始接触一个教程节点，我们就决定鱼要执行的下一个动作。第一步，鱼需要游到最左边的泳道。我们还展示了一个动画来形象化用户必须做的动作。</li></ol><p id="be0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以看到，我们通过使用两个函数<code class="fe na nb nc nd b">calculateNeededMovement(current:destination:)</code>和<code class="fe na nb nc nd b">showSwipeNeededAnimation(for:)</code>来实现这一点。让我们看看它们是如何工作的。</p><p id="baf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些通道由以下枚举表示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您在第一幅图像中看到的四条泳道由这些值表示。</p></figure><p id="4713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个动作包括鱼应该移动的方向和鱼在给定方向上必须做的许多鱼线转换。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">struct Movement封装了一个方向和朝该方向前进的多个步骤。</p></figure><p id="2968" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了构造一个移动实例，我们将鱼的当前位置<code class="fe na nb nc nd b">SwimmingColumn</code>和鱼应该移动到的目的地传递给方法<code class="fe na nb nc nd b">calculateNeededMovement(current:destination:)</code>。它切换两者并返回相应的移动对象，例如，如果鱼当前在最左侧的泳道中，需要移动到中间左侧的泳道，它需要向右移动一步。这个移动被存储在变量<code class="fe na nb nc nd b">calculatedMovement</code>中，一旦用户滑动就被执行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在这个例子中，获得下一个动作就像切换所有可能的组合一样简单。</p></figure><p id="1c65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:另一种方法是推迟计算玩家的下一步行动，直到用户已经触发了恢复。这将消除将计算和执行下一个动作分开的需要，这似乎是一个更好的方法。但是，仍然有状态需要存储，主要是教程的哪个点被触发了。此外，将这些步骤分开也有一些好处。当到达教程点时，SpriteKit除了显示动画之外没有其他事情要做，因此有足够的资源来计算下一步。在这样一个小游戏中，这似乎无关紧要，但是想象一下，你有多个敌人，玩家需要以最好的方式绕过他们。甚至可能会有一个人工智能来寻找到达下一个地点的最短路径。这可以在游戏等待玩家下一步行动时完美完成。如果这种计算发生在用户执行恢复游戏所需的操作之后，可能会有性能问题。</p><p id="433a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe na nb nc nd b">didBegin(contact:)</code>方法中可以看到，在下一个动作确定后，我们想给用户展示一个动画，说明他们需要做什么。在其他情况下，您可能还想显示提供更多信息的文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向用户展示如何处理这个动画。</p></figure><p id="f5df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们如何一步一步添加动画:</p><ol class=""><li id="a6d8" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">因为我们希望在用户滑动时移除动画节点，所以我们将它存储在一个变量中。</li><li id="e6d8" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">当设置动画时，我们首先确保我们接收到了一个有效的运动。否则，我们将不显示任何动画。当用户需要向左滑动时，我们希望指示器从显示屏的右侧开始。否则，应该从左侧开始。因此，我们根据方向，用-100或100的x偏移创建它的位置。该位置存储在一个变量中，以将动画中的节点重置为其起始点。</li><li id="3848" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">现在我们创建一个填充的白色圆圈，它将是动画节点，指示用户需要在特定方向上滑动。</li><li id="56e6" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">最后，我们可以设置动画。该动画由四个不同的动画组成，按顺序执行，并将永远重复。首先，我们向用户需要滑动的方向移动指示器。一旦完成，节点将淡出，移回其原始位置，并淡入。</li></ol></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="c1c6" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">3.处理用户的滑动</h1><p id="930d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们可以通过使用一个<code class="fe na nb nc nd b">UIGestureRecognizer</code>来检测滑动。我们首先移除先前创建和存储的指示器节点来停止动画。接下来，它使用一种叫做<code class="fe na nb nc nd b">executeMovement</code>的方法，实际执行我们之前确定的运动。最后一步是重启鱼。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在教程节点被鱼击中后处理用户的滑动。</p></figure><p id="370f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">方法<code class="fe na nb nc nd b">executeMovement</code>仅在给定方向移动鱼。这样重复<code class="fe na nb nc nd b">numberOfSteps</code>次。在我们的游戏中，左右移动包括一个动画来切换线条，改变鱼的精灵和其他被忽略的东西。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">执行先前确定的运动。</p></figure><p id="0e9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们如何构建我们的教程水平。在这张图片中，您可以看到我们为向用户展示他必须做的事情而经历的所有步骤的摘要:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/e0add51404c481ce4a8e03113d5c81e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GDVJrKtpgo9tLgbtWu3PNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加教程步骤的操作。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="e442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想给你的游戏增加一个教程等级，我希望你可以用这个例子！如果您有问题或想建议更好的方法，请留下评论。</p></div></div>    
</body>
</html>