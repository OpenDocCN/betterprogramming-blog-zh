<html>
<head>
<title>Build a Simple Web Server With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建一个简单的Web服务器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/web-server-with-python-cde3a9911a0f?source=collection_archive---------2-----------------------#2020-09-04">https://betterprogramming.pub/web-server-with-python-cde3a9911a0f?source=collection_archive---------2-----------------------#2020-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e354" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建并运行一个简单的服务器，您可以根据自己的需要进行定制</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3985846428efb2e5720529a8eb55611b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*39_ac9bRfeYa4DaC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰尼斯·格罗尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="a483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网络服务器就在我们周围。每个应用程序、每个框架都使用web服务器。这听起来可能很奇怪，但是每个web服务器都做三件事:监听HTTP请求，处理这些请求，并向用户发回响应。让我们试着用Python构建自己的服务器。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9f0f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">HTTP服务器的性质</strong></h1><p id="56df" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当您尝试打开<a class="ae ky" href="http://medium.com" rel="noopener"> Medium，</a>您的浏览器会以HTTP请求的形式创建一条网络消息。请求将通过互联网一路传送到一台计算机，在那里Medium有一个正在运行的服务器，该服务器将通过使用Medium主页的HTML进行响应来处理该请求。当您的浏览器收到响应时，它将呈现HTML，这样我们就可以在出错时看到呈现的错误消息的网页。</p><p id="3016" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每次与网页的交互都会发送一个新的请求，服务器会用新的HTML来响应。</p><p id="3eee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看请求是如何到达服务器的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="60da" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">倾听的重要性</strong></h1><p id="e88d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了获得目的地，每个HTTP消息都包含目的地TCP地址。TCP地址是IP地址和端口号。</p><p id="9d71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看Medium在哪里托管他们的网站:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/d58dda2426b7592e3f0bae386e2d7777.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*kZ8_JZowl3NQs5gfZTwqTg.png"/></div></div></figure><p id="8d11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道了IP地址，让我们来看看端口。默认情况下，HTTP的端口号为80，HTTPS的端口号为443。如果web服务器监听非常规端口，您必须指定HTTP消息应该去往何处。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="133b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">网络服务器</strong></h1><p id="cf96" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们或多或少地了解了请求是如何在互联网上传播并找到它们的目的地的，让我们用Python构建一个简单的web服务器。</p><p id="0ee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要导入两个库来帮助我们运行服务器和处理请求:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/584cda25283b5533388d0147bf7c7bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*T3e0BLREL1_DiPfA_9p1eg.png"/></div></figure><p id="0541" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将声明服务器监听请求的端口，并创建HTTP请求的处理程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/12e654b46a587db2fbe723073490fe0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*_NrnOfw93HLiVwxj8r3z2w.png"/></div></figure><p id="e82b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们在我们声明的端口上运行服务器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/504ce8b9110eacb903f56c7e26bb58d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0XctUmRbwLudq_2NqI5dw.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="55c5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">服务器HTML </strong></h1><p id="7792" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们的服务器已经准备好了，但是我们没有任何东西可以回馈给用户。让我们创建一个简单的HTML文档来在浏览器中呈现一些内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/b54f1bdd1099a94543959fb582582382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zz0-gi7BmLKZSvq53Nhq1Q.png"/></div></div></figure><p id="f3c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忘记将HTML文档和Python文件放在同一个目录下，并将HTML文件命名为<code class="fe ne nf ng nh b">index.html</code>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cd83" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">运行服务器</strong></h1><p id="877e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在是时候启动引擎并运行我们的服务器了。让我们转到Python文件和HTML文档所在的目录。运行以下命令:</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="fd77" class="nm md it nh b gy nn no l np nq">python server.py</span></pre><p id="1d50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者这个(取决于你用哪个版本的Python):</p><pre class="kj kk kl km gt ni nh nj nk aw nl bi"><span id="2143" class="nm md it nh b gy nn no l np nq">python3 server.py</span></pre><p id="3427" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在控制台上看到什么？该服务器的端口为8000:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/43b7f7f2e28fae21d5632e2c8ee616df.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*0oJvrhj2tzyxWvHqn5TEvA.png"/></div></figure><p id="27b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们打开浏览器，导航到<a class="ae ky" href="http://localhost:8000" rel="noopener ugc nofollow" target="_blank"> http://localhost:8000 </a>。我们的HTML文档已经送达:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a3d833e010b7c806ac9d83eda9024659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/1*nHrwR7uz6brhUx2fOjSXmw.gif"/></div></figure><h2 id="a96c" class="nm md it bd me nt nu dn mi nv nw dp mm li nx ny mo lm nz oa mq lq ob oc ms od bi translated"><strong class="ak">服务器片段</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1d6d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">结论</strong></h1><p id="fcc3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">虽然我们的服务器很简单，但它能够提供HTML文档。当然，处理Medium请求的服务器要复杂得多，但原理是一样的。它监听请求并做出相应的响应。</p><p id="3fb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不断学习，不断成长！</p></div></div>    
</body>
</html>