<html>
<head>
<title>Build an Uber-Like Payment Service Using Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spring Boot建立一个类似优步的支付服务</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-an-uber-like-payment-service-using-spring-boot-f6cfb45f67d8?source=collection_archive---------1-----------------------#2021-09-09">https://betterprogramming.pub/build-an-uber-like-payment-service-using-spring-boot-f6cfb45f67d8?source=collection_archive---------1-----------------------#2021-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f251" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在支付了一个优步之后，我决定深入研究用于支付处理的Marqeta API。看看几个小时后我去了哪里</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/df308e3aa61a4653f30e6bda9713ebf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qOWG1vyDolMjZhP5x1uigg.jpeg"/></div></div></figure><p id="2ae4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在过去的两年里，当我从拉斯韦加斯机场前往我嫂子在偏远郊区的美丽庄园时，我体验了优步的服务。每次，优步游乐设施都是为我买的——这是我妹夫的一个友好姿态。因此，当我们穿过多岩石和干旱的内华达植被沙漠时，我能够专注于结识新朋友的机会，那里有相当多的豪华酒店和赌场。</p><p id="064e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">7月，我返回中西部的航班遇到了一些延误。这架西南航空公司的飞机没有在午夜后不久到家，而是在当地时间凌晨4点着陆。我不打算让我的妻子(和蹒跚学步的儿子)开30分钟的单程车来接我。相反，我决定第一次使用优步，安排我自己的旅程。</p><p id="81d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我印象深刻。我不仅遇到了另一个美好的灵魂，还体验了一个只用手机支付交通费用的惊人用例。事实上，我在出发前就设置了我的账户，因为我知道当这个城市的大部分人都熟睡时我需要交通工具。</p><p id="d65f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在休息了几个小时并回到我的家庭办公室后，我决定了解更多关于优步背后的支付处理服务。这让我找到了<a class="ae lq" href="https://www.marqeta.com/?utm_source=medium&amp;utm_medium=blog&amp;utm_campaign=devspotlight_september&amp;utm_id=article1" rel="noopener ugc nofollow" target="_blank"> Marqeta </a>，一家我以前从未听说过的公司。查看他们的支付平台和API，我想知道在利用Marqeta平台的同时，如何轻松地在Spring Boot创建支付服务。</p><p id="aa34" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为我热爱写作，所以我想我应该记录下我探索的结果。</p><h1 id="8ec1" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">关于玛克塔</h1><p id="75c1" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">首席执行官<a class="ae lq" href="https://twitter.com/jmgards" rel="noopener ugc nofollow" target="_blank">杰森·加德纳</a>创立了Marqeta，“通过让任何公司——无论是全新的创业公司还是最老牌的企业——都能够建立在我们现代发卡平台的基础上，而不必担心支付基础设施的复杂性，从而实现创新的民主化。”</p><p id="6da7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种方法立即引起了我的注意，因为我一直非常专注于利用框架、产品和服务，以便继续专注于提供扩展我的客户(或雇主)知识产权价值的解决方案。</p><p id="4fb3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Marqeta的成功很容易通过关注技术的客户的“名人录”来衡量，这些客户全天候依赖Marqeta。如前所述，优步品牌利用了Marqeta。其他客户包括<a class="ae lq" href="https://www.doordash.com/" rel="noopener ugc nofollow" target="_blank"> DoorDash </a>、<a class="ae lq" href="https://squareup.com/us/en" rel="noopener ugc nofollow" target="_blank"> Square </a>、<a class="ae lq" href="https://www.instacart.com/" rel="noopener ugc nofollow" target="_blank"> Instacart </a>、<a class="ae lq" href="https://www.affirm.com/" rel="noopener ugc nofollow" target="_blank"> Affirm </a>和<a class="ae lq" href="https://www.brex.com/" rel="noopener ugc nofollow" target="_blank"> Brex </a>(旗下有Airbnb、Classpass和Flexport)，这些公司在过去五年里都已家喻户晓。</p><p id="9d3c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">截至2021年3月31日，Marqeta已处理超过3.2亿张卡(支付来源)和16亿笔交易。Marqeta的成功得到了福布斯(金融科技50强奖)、《快速公司》(50大最具创新奖)和美国消费者新闻与商业频道(颠覆者50强奖)的认可。</p><p id="d099" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对我来说，Marqeta似乎是“真正的交易”。</p><h1 id="e8ca" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">没有Java SDK，没问题</h1><p id="1dfa" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">Marqeta提供了一个非常令人印象深刻的<a class="ae lq" href="https://www.marqeta.com/docs/core-api-explorer?utm_source=dzone&amp;utm_medium=blog&amp;utm_campaign=devspotlight_september&amp;utm_id=article1" rel="noopener ugc nofollow" target="_blank">核心API Explorer </a>，允许开发者了解支付平台。事实上，我以前的经验告诉我，当我开始看到可能性，并因简单地浏览API而兴奋时，那么我就处于优质产品的接收端。</p><p id="d6e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然目前有针对Python和Ruby的软件开发工具包(SDK ),但没有针对Java的SDK。然而，在审查了核心API之后，我觉得在Spring Boot构建一个支付服务，作为一个中间件产品，并对Marqeta平台进行RESTful调用，将是一个有趣的探索。</p><p id="f013" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦完成，这个基于Java的中间件支付服务可以被在我的域中运行的定制应用程序利用，这些应用程序需要执行金融交易的能力。</p><p id="37c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在走这条路之前，也许我应该提供一些关于Marqeta平台的高级细节。</p><h1 id="7a71" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Marqeta入门</h1><p id="b889" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">简单来说，Marqeta设计的核心有四个主要概念:</p><ul class=""><li id="8e9b" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">用户—计划执行交易的客户(您)</li><li id="840c" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">资金来源—资金所在的金融机构(您的银行)</li><li id="7632" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">卡产品—由您的资金来源(如Visa、Mastercard、Discover等)提供的卡服务</li><li id="71a8" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">卡—与您的资金来源(您的信用卡)相关的卡产品实例</li></ul><p id="00ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我创建了下图来演示这些关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/dc06703deb09457a8425515fea6d9930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dymt4F7Vn0B0D76vuRsE3A.png"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">作者图片</p></figure><p id="23f2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出于本文的目的，我决定通过基本的cURL命令直接调用Marqeta核心API来设置用户、资金来源、卡产品和卡。</p><p id="ad9f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，在我开始之前，我需要用Marqeta创建一个新帐户，它将授予访问Marqeta沙箱的权限。</p><h2 id="235d" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">建立对Marqeta沙盒的访问</h2><p id="02fe" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">零成本开始使用Marqeta就像使用下面的链接创建一个帐户一样简单:</p><p id="ea1d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="http://app.marqeta.com/" rel="noopener ugc nofollow" target="_blank">http://app.marqeta.com/</a></p><p id="b5a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建您的帐户后，导航至<a class="ae lq" href="https://app.marqeta.com/development#!" rel="noopener ugc nofollow" target="_blank">发展仪表板</a>将提供类似于下图的详细信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/2380af443ab86a7ce6c5d84ec039068f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D4D88SHQiI9DzQ4nUYWog.png"/></div></div></figure><p id="4c6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文的剩余部分，将引用上图中的以下项目:</p><ul class=""><li id="1aa4" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">应用令牌= <code class="fe nu nv nw nx b">${APPLICATION_TOKEN}</code>和<code class="fe nu nv nw nx b">APPLICATION_TOKEN_GOES_HERE</code></li><li id="b6a4" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">管理员访问令牌= <code class="fe nu nv nw nx b">${ADMIN_ACCESS_TOKEN}</code>和<code class="fe nu nv nw nx b">ADMIN_ACCESS_TOKEN_GOES_HERE</code></li></ul><h2 id="1f15" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">创建新用户</h2><p id="7309" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">下面的cURL命令可以用来创建一个名为<a class="ae lq" href="https://twitter.com/randykern" rel="noopener ugc nofollow" target="_blank"> Randy Kern </a>的新用户:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="82ae" class="nh ls it nx b gy oc od l oe of">curl -i \<br/>  -X POST \<br/>  -H 'Content-Type: application/json' \<br/>  --user APPLICATION_TOKEN_GOES_HERE:ADMIN_ACCESS_TOKEN_GOES_HERE \<br/>  -d '{<br/>    "first_name": "Randy",<br/>    "last_name": "Kern",<br/>    "active": true<br/>  }' \<br/>  <a class="ae lq" href="https://sandbox-api.marqeta.com/v3/users" rel="noopener ugc nofollow" target="_blank">https://sandbox-api.marqeta.com/v3/users</a></span></pre><p id="9656" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">成功的POST会产生2xx HTTP响应和Randy Kern用户的唯一令牌:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="b9c0" class="nh ls it nx b gy oc od l oe of">{<br/>"token" : "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>"active" : true,<br/>"first_name" : "Randy",<br/>"last_name" : "Kern",<br/>"uses_parent_account" : false,<br/>"corporate_card_holder" : false,<br/>"created_time" : "2021-08-14T13:01:13Z",<br/>"last_modified_time" : "2021-08-14T13:01:14Z",<br/>"metadata" : { },<br/>"account_holder_group_token" : "DEFAULT_AHG",<br/>"status" : "ACTIVE",<br/>"deposit_account" : {<br/>  "token" : "6716c09f-c0dd-430f-ada5-d39f6c5059bb",<br/>  "account_number" : "40018215000000810",<br/>  "routing_number" : "293748000",<br/>  "allow_immediate_credit" : false<br/>  }<br/>}</span></pre><p id="8a6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">记下令牌值，因为稍后将需要使用它。</p><h2 id="64e8" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">创造一个及时的资金来源</h2><p id="91a2" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">接下来，需要一个资金来源。对于这个例子，我们将使用一个即时(JIT)资金来源。把JIT模型想象成当你使用借记卡而不是预装一定金额的礼品卡时会发生什么。</p><p id="793b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面的cURL命令在我的Marqeta沙箱中建立了一个名为“funding_source_bank”的JIT资金来源:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="2990" class="nh ls it nx b gy oc od l oe of">curl -X POST "<a class="ae lq" href="https://sandbox-api.marqeta.com/v3/fundingsources/program" rel="noopener ugc nofollow" target="_blank">https://sandbox-api.marqeta.com/v3/fundingsources/program</a>" \<br/>  --user APPLICATION_TOKEN_GOES_HERE:ADMIN_ACCESS_TOKEN_GOES_HERE \<br/>  -H "accept: application/json"  \<br/>  -H "Content-Type: application/json"  \</span><span id="9d5f" class="nh ls it nx b gy og od l oe of">-d ‘{"name":"funding_source_bank","active":true}’</span></pre><p id="0923" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">产生的有效负载应该类似于下面的注释:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="99dd" class="nh ls it nx b gy oc od l oe of">{<br/>  "name": "funding_source_bank",<br/>  "active": true,<br/>  "token": "069e4f6c-a731-48e2-82b7-0df9f44dea62",<br/>  "created_time": "2021-08-15T02:42:06Z",<br/>  "last_modified_time": "2021-08-15T02:42:06Z",<br/>  "account": "12.003.001.000000"<br/>}</span></pre><p id="ac7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意来自这个新创建的资金来源的令牌值，因为这将是我们在下一个cURL命令中的<code class="fe nu nv nw nx b">funding_source_token</code>。</p><h1 id="270c" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">创建卡产品</h1><p id="6988" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">卡产品链接到JIT资金来源和属于给定用户的卡。下面的cURL命令创建一个新的卡产品，它使用上面创建的“funding_source_bank ”:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="af58" class="nh ls it nx b gy oc od l oe of">curl -X POST "<a class="ae lq" href="https://sandbox-api.marqeta.com/v3/cardproducts" rel="noopener ugc nofollow" target="_blank">https://sandbox-api.marqeta.com/v3/cardproducts</a>"  \<br/>  --user APPLICATION_TOKEN_GOES_HERE:ADMIN_ACCESS_TOKEN_GOES_HERE \<br/>  -H "accept: application/json"  \<br/>  -H "Content-Type: application/json"  \<br/>  -d '{<br/>       "start_date":"2020-05-01",<br/>       "name":"Funding Source Bank Card",<br/>       "config":{<br/>          "fulfillment":{<br/>             "payment_instrument":"VIRTUAL_PAN"<br/>          },<br/>          "poi":{<br/>             "ecommerce":true,<br/>             "atm":true<br/>          },<br/>          "card_life_cycle":{<br/>             "activate_upon_issue":true<br/>          },<br/>          "jit_funding":{<br/>             "program_funding_source":{<br/>                "funding_source_token":"JIT_TOKEN_GOES_HERE",<br/>                "refunds_destination":"PROGRAM_FUNDING_SOURCE",<br/>                "enabled":true<br/>             }<br/>          }<br/>       }<br/>    }'</span></pre><p id="7573" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个请求产生一个卡产品令牌，它将用于为Randy Kern创建一张卡。产生的有效负载的一部分显示如下:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="2129" class="nh ls it nx b gy oc od l oe of">{<br/>  "token": "99db1d05-9199-446c-9ff1-047df5ccf154",<br/>  "name": "Funding Source Bank Card",<br/>  "active": true,<br/>  ...</span></pre><h2 id="6330" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">创建新卡片</h2><p id="9f6d" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">Marqeta中的卡是一种支付设备，使用户能够在商家进行交易。简单来说，就把卡想象成借记卡或信用卡。对于我们的例子，我们将从上面建立的“资金来源银行卡”卡产品中创建一张卡。</p><p id="a2e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要为Randy Kern创建卡片，请执行以下cURL命令:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="d407" class="nh ls it nx b gy oc od l oe of">curl -X POST "<a class="ae lq" href="https://sandbox-api.marqeta.com/v3/cards" rel="noopener ugc nofollow" target="_blank">https://sandbox-api.marqeta.com/v3/cards</a>"  \<br/>  --user APPLICATION_TOKEN_GOES_HERE:ADMIN_ACCESS_TOKEN_GOES_HERE \<br/>  -H "accept: application/json"  \<br/>  -H "Content-Type: application/json"  \<br/>  -d '{<br/>       "user_token":"RANDY_KERN_USER_TOKEN_GOES_HERE",<br/>       "card_product_token":"FUNDING_SOURCE_BANK_CARD_PRODUCT_TOKEN_GOES_HERE<br/>   }'</span></pre><p id="7bf6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">应该会出现如下所示的有效负载:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="7e04" class="nh ls it nx b gy oc od l oe of">{<br/>  "created_time": "2021-08-15T02:47:52Z",<br/>  "last_modified_time": "2021-08-15T02:47:52Z",<br/>  "token": "9d32f3b7-2fb6-43ec-b4a8-99fc81312301",<br/>  "user_token": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>  "card_product_token": "99db1d05-9199-446c-9ff1-047df5ccf154",<br/>  "last_four": "4445",<br/>  "pan": "111111______4445",<br/>  "expiration": "0825",<br/>  "expiration_time": "2025-08-31T23:59:59Z",<br/>  "barcode": "11195778081390829687",<br/>  "pin_is_set": false,<br/>  "state": "ACTIVE",<br/>  "state_reason": "New card activated",<br/>  "fulfillment_status": "ISSUED",<br/>  "instrument_type": "VIRTUAL_PAN",<br/>  "expedite": false,<br/>  "metadata": {}<br/>}</span></pre><p id="de9d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">至此，我们已经准备好配置Spring Boot服务了。</p><h1 id="2c16" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Spring Boot入门</h1><p id="b814" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在我的Marqeta沙箱中创建了一组基本数据后，下一步是使用Spring Boot创建一个简单的支付服务。Spring Boot服务使用以下URIs:</p><ul class=""><li id="21f9" class="mo mp it kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">在Marqeta平台中配置用户</li><li id="bc07" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">获取与给定用户令牌相关联的卡</li><li id="714a" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">获取与给定用户令牌相关联的事务</li><li id="4502" class="mo mp it kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">使用资金来源过账与用户相关联的卡的新交易</li></ul><p id="1e5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我将以下依赖项添加到我在IntelliJ IDEA开发环境中创建的Spring Boot项目中:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="09b8" class="nh ls it nx b gy oc od l oe of">&lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>        &lt;artifactId&gt;spring-boot-starter-jersey&lt;/artifactId&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;<br/>        &lt;artifactId&gt;commons-collections4&lt;/artifactId&gt;<br/>        &lt;version&gt;4.1&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;<br/>        &lt;artifactId&gt;httpclient&lt;/artifactId&gt;<br/>        &lt;version&gt;4.5.13&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>        &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;<br/>        &lt;optional&gt;true&lt;/optional&gt;<br/>    &lt;/dependency&gt;<br/>    &lt;dependency&gt;<br/>        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;<br/>        &lt;artifactId&gt;lombok&lt;/artifactId&gt;<br/>        &lt;optional&gt;true&lt;/optional&gt;<br/>    &lt;/dependency&gt;<br/>&lt;/dependencies&gt;</span></pre><p id="86b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我创建了一系列数据转换对象(dto ),以遵守Marqeta平台所使用和期望的数据契约。下面是我介绍的DTO课程的截图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/c286673d858bed0cac3fb0375f6b190d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*j3FEW8iYUxRodOjD0CDf5w.png"/></div></figure><p id="5935" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以在这里查看Spring Boot项目的更详细的源代码，而不是在这里涵盖所有这些项目:</p><p id="ea5b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://bit.ly/mq-models" rel="noopener ugc nofollow" target="_blank">https://bit.ly/mq-models</a></p><h2 id="6640" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">马尔凯塔构型</h2><p id="7edd" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">以下属性被外化到Spring Boot的`<a class="ae lq" href="https://gitlab.com/johnjvester/marqeta-example/-/blob/master/src/main/resources/application.yml" rel="noopener ugc nofollow" target="_blank"> application.yml </a>`配置文件中:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="2427" class="nh ls it nx b gy oc od l oe of">marqeta:<br/>  application-token: ${APPLICATION_TOKEN}<br/>  admin-access-token: ${ADMIN_ACCESS_TOKEN}<br/>  hostname: sandbox-api.marqeta.com<br/>  secure: true<br/>  base-uri: /v3</span></pre><p id="5f19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">application-token和admin-access-token的值将在程序之外设置(比如一个环境变量),以避免将机密信息签入存储库。</p><p id="300e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在一个实际的例子中，hostname属性也会被具体化，但是我决定让这个例子尽可能简单。</p><p id="b321" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Marqeta配置属性在Spring Boot可用，因为有了<a class="ae lq" href="https://gitlab.com/johnjvester/marqeta-example/-/blob/master/src/main/java/com/gitlab/johnjvester/marqeta/configs/MarqetaConfigurationProperties.java" rel="noopener ugc nofollow" target="_blank">MarqetaConfigurationProperties</a>类:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="44f7" class="nh ls it nx b gy oc od l oe of">@Data<br/>@Configuration("marqetaConfigurationProperties")<br/>@ConfigurationProperties("marqeta")<br/>public class MarqetaConfigurationProperties {<br/>    private String applicationToken;<br/>    private String adminAccessToken;<br/>    private String hostname;<br/>    private boolean secure;<br/>    private String baseUri;<br/>}</span></pre><p id="0d30" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于这种变化，通过依赖注入，配置值可用于任何组件或服务。下面是用户服务的一个示例:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="c7dc" class="nh ls it nx b gy oc od l oe of">@RequiredArgsConstructor<br/>@Service<br/>public class UserService {<br/>    private final MarqetaConfigurationProperties marqetaConfigurationProperties;<br/>    ...<br/>}</span></pre><h2 id="7af7" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">与Marqeta核心API通信</h2><p id="43d6" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">为了保持事物“干燥”(不要重复自己)，我创建了一个<a class="ae lq" href="https://gitlab.com/johnjvester/marqeta-example/-/blob/master/src/main/java/com/gitlab/johnjvester/marqeta/utils/MarqetaUtils.java" rel="noopener ugc nofollow" target="_blank"> MarqetaUtils </a>实用程序类来存放与Marqeta核心API进行GET和POST通信的帮助器方法。为了简单起见，我在下面列出了<code class="fe nu nv nw nx b">marqetaGet()</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="a014" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，Spring Boot的用户API只需提供以下信息就可以向Marqeta核心API发出GET请求:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="c00d" class="nh ls it nx b gy oc od l oe of">CloseableHttpResponse closeableHttpResponse = MarqetaUtils.marqetaGet(marqetaConfigurationProperties, "/users", null)</span></pre><h2 id="b148" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">在Spring Boot创建一个GET URI</h2><p id="aa39" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">如上所述，基于GET的URIs将为用户、卡和交易而存在。下图说明了使用用户API的流程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/06e6cdbc168fd49bff7c417f92ecb014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kal2nrtA_--UnrUUp4CSQw.png"/></div></div></figure><p id="5fd2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了从Spring Boot服务中检索用户列表，我们将使用以下cURL:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="e7e7" class="nh ls it nx b gy oc od l oe of">curl --location -X GET 'localhost:9999/users'</span></pre><p id="3d83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个请求导致调用<code class="fe nu nv nw nx b">UserController</code>类中的<code class="fe nu nv nw nx b">getUsers()</code>方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="4c26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nu nv nw nx b">userService.getAllUsers() </code>方法与<code class="fe nu nv nw nx b">UserService</code>类交互，返回一个<code class="fe nu nv nw nx b">User</code>对象列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="94bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用上面提供的信息，下面的JSON响应负载被返回给发出请求的客户机:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="a4d9" class="nh ls it nx b gy oc od l oe of">[<br/>    {<br/>        "token": string,<br/>        "createdTime": number,<br/>        "lastModifiedTime": number,<br/>        "metadata": {},<br/>        "active": boolean,<br/>        "firstName": string,<br/>        "lastName": string,<br/>        "usersParentAccount": boolean,<br/>        "corporateCardHolder": boolean,<br/>        "accountHolderGroupToken": string,<br/>        "status": string<br/>    }<br/>]</span></pre><p id="9405" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按照同样的方法，我创建了剩余的GET URIs，以及一个POST请求。对Marqeta核心API的每个请求都使用静态MarqetaUtils类，以减少Spring Boot服务中重复代码的数量。</p><p id="571f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要查看为本文创建的所有服务，只需打开以下URL:</p><p id="ce9c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://bit.ly/mq-services" rel="noopener ugc nofollow" target="_blank">https://bit.ly/mq-services</a></p><h1 id="9d44" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">把所有的放在一起</h1><p id="5218" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">随着Marqeta沙盒的创建和Spring Boot服务的准备就绪，我启动了Spring Boot服务:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/e34baf425f207defa9a644838c65840a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHLptJXKD6Pam8Ep93nqlA.png"/></div></div></figure><p id="e11d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了验证配置设置是否正确，我还在Spring Boot创建了一个/ping URI来与Marqeta核心API进行交互，而不需要请求任何数据。我对Spring Boot服务执行了以下cURL:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="7aee" class="nh ls it nx b gy oc od l oe of">curl --location -X GET 'localhost:9999/ping'</span></pre><p id="8f60" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">/ping URI使用以下有效负载和200 HTTP响应进行响应:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="b54c" class="nh ls it nx b gy oc od l oe of">{<br/>    "success": true,<br/>    "version": "rel-21.7.1",<br/>    "revision": "7b6bf2842d024b0d26f5e29f5cc50617b0d49872",<br/>    "timestamp": "Fri Jul 16 22:37:50 UTC 2021",<br/>    "env": "sandbox",<br/>    "id": "i-0e0a4a9bc40f8d05d:us-east-1a:10.128.19.176"<br/>}</span></pre><p id="e30f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">200 HTTP响应和“success”属性的true值表示请求成功。</p><h2 id="dc6a" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">获取Marqeta中的用户列表</h2><p id="91d8" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">如前所述，以下cURL命令将返回用户列表:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="46f5" class="nh ls it nx b gy oc od l oe of">curl --location -X GET 'localhost:9999/users'</span></pre><p id="e7b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我收到了来自Spring Boot服务的以下响应有效负载:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="9ee0" class="nh ls it nx b gy oc od l oe of">[<br/>    {<br/>        "token": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>        "createdTime": 1628946073000,<br/>        "lastModifiedTime": 1628946074000,<br/>        "metadata": {},<br/>        "active": true,<br/>        "firstName": "Randy",<br/>        "lastName": "Kern",<br/>        "usersParentAccount": false,<br/>        "corporateCardHolder": false,<br/>        "accountHolderGroupToken": "DEFAULT_AHG",<br/>        "status": "ACTIVE"<br/>    }<br/>]</span></pre><h2 id="36db" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">在Marqeta中获取给定用户的卡片列表</h2><p id="072d" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">以下cURL命令将提供与Randy Kern用户令牌相关联的卡片列表:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="d5d1" class="nh ls it nx b gy oc od l oe of">curl --location --request GET 'localhost:9999/cards/user/1017b62c-6b61-4fcd-b663-5c81feab6524'</span></pre><p id="33c2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">响应有效负载为Randy Kern用户提供了卡片摘要:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="ecae" class="nh ls it nx b gy oc od l oe of">[<br/>    {<br/>        "token": "9d32f3b7-2fb6-43ec-b4a8-99fc81312301",<br/>        "createdTime": 1628995672000,<br/>        "lastModifiedTime": 1628995672000,<br/>        "metadata": {},<br/>        "userToken": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>        "cardProductToken": "99db1d05-9199-446c-9ff1-047df5ccf154",<br/>        "lastFour": "4445",<br/>        "pan": "111111______4445",<br/>        "expiration": "0825",<br/>        "expirationTime": 1756684799000,<br/>        "barcode": "11195778081390829687",<br/>        "pinSet": false,<br/>        "state": "ACTIVE",<br/>        "stateReason": "New card activated",<br/>        "fulfillmentStatus": "ISSUED",<br/>        "instrumentType": "VIRTUAL_PAN",<br/>        "expedite": false<br/>    }<br/>]</span></pre><h2 id="597b" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">将交易过帐到Marqeta</h2><p id="c1d5" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">Spring Boot服务接受一个简单的POST请求，使用MarqetaTransactionRequestt主体负载在Marqeta平台上创建一个新的事务。</p><p id="a904" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面的示例是一个MarqetaTransactionRequest有效负载，用于Friendly Tavern的7.50美元交易:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="e2d2" class="nh ls it nx b gy oc od l oe of">{<br/>    "amount": "7.50",<br/>    "mid": "11111",<br/>    "card_token": "9d32f3b7-2fb6-43ec-b4a8-99fc81312301",<br/>    "card_acceptor": {<br/>        "name": "The Friendly Tavern",<br/>        "address": "290 S. Main St",<br/>        "city": "Zionsville",<br/>        "state": "IN",<br/>        "zip": "46077",<br/>        "country": "USA"<br/>    },<br/>    "webhook": {<br/>        "endpoint": "<a class="ae lq" href="https://mywebook.url.goes.here.com" rel="noopener ugc nofollow" target="_blank">https://mywebook.url.goes.here.com</a>",<br/>        "username": "some_username",<br/>        "password": "some_password"<br/>    }<br/>}</span></pre><p id="2ccf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面的有效负载可以包含在下面的cURL语句中，以利用Spring Boot服务中的授权API:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="55dd" class="nh ls it nx b gy oc od l oe of">curl --location --request POST 'localhost:9999/authorization' \<br/>  --user APPLICATION_TOKEN_GOES_HERE:ADMIN_ACCESS_TOKEN_GOES_HERE \<br/>  --H 'accept: application/json' \<br/>  --H 'Content-Type: application/json' \<br/>  --d '{<br/>        "amount": "7.50",<br/>        "mid": "11111",<br/>        "card_token": "CARD_TOKEN_GOES_HERE",<br/>        "card_acceptor": {<br/>            "name": "The Friendly Tavern",<br/>            "address": "290 S. Main St",<br/>            "city": "Zionsville",<br/>            "state": "IN",<br/>            "zip": "46077",<br/>            "country": "USA"<br/>        },<br/>        "webhook": {<br/>            "endpoint": "SOME_WEBHOOK_URL_GOES_HERE",<br/>            "username": "USERNAME_GOES_HERE",<br/>            "password": "PASSWORD_GOES_HERE"<br/>        }<br/>    }'</span></pre><p id="d9af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">提交成功后，将显示该交易的全部详细信息。此外，一旦请求得到处理，webhook对象就提供了调用指定端点的机会。更多关于使用Marqeta webhooks的信息可以在<a class="ae lq" href="https://www.marqeta.com/docs/developer-guides/webhooks-overview?utm_source=medium&amp;utm_medium=blog&amp;utm_campaign=devspotlight_september&amp;utm_id=article1" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="067e" class="nh ls it bd lt ni nj dn lx nk nl dp mb ld nm nn md lh no np mf ll nq nr mh ns bi translated">获取Marqeta中的交易列表</h2><p id="d549" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">Randy Kern用户已经创建了一个事务，我们可以通过下面的cURL命令访问“用户事务”URI:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="6a2b" class="nh ls it nx b gy oc od l oe of">curl --location --request GET 'localhost:9999/transactions/user/1017b62c-6b61-4fcd-b663-5c81feab6524'</span></pre><p id="ffca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果是单个事务的以下数据:</p><pre class="kj kk kl km gt ny nx nz oa aw ob bi"><span id="3e55" class="nh ls it nx b gy oc od l oe of">[<br/>    {<br/>        "token": "ca66618d-43c7-4c74-aa30-5b2fedfc676f",<br/>        "createdTime": 1629083511000,<br/>        "type": "authorization",<br/>        "state": "PENDING",<br/>        "identifier": "19",<br/>        "userToken": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>        "actingUserToken": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>        "cardToken": "9d32f3b7-2fb6-43ec-b4a8-99fc81312301",<br/>        "gpa": {<br/>            "ledgerBalance": 7.50,<br/>            "availableBalance": 0.00,<br/>            "creditBalance": 0.00,<br/>            "pendingCredits": 0.00,<br/>            "impactedAmount": -7.50,<br/>            "currencyCode": "USD",<br/>            "balances": {<br/>                "USD": {<br/>                    "ledgerBalance": 7.50,<br/>                    "availableBalance": 0.00,<br/>                    "creditBalance": 0.00,<br/>                    "pendingCredits": 0.00,<br/>                    "impactedAmount": -7.50,<br/>                    "currencyCode": "USD"<br/>                }<br/>            }<br/>        },<br/>        "gpaOrder": {<br/>            "token": "be3dc1b6-fa22-4ef9-8157-8fc10c86d632",<br/>            "createdTime": 1629083511000,<br/>            "lastModifiedTime": 1629083511000,<br/>            "amount": 7.50,<br/>            "transactionToken": "23976c31-efc2-4a44-8834-b5390ab131ab",<br/>            "state": "PENDING",<br/>            "response": {<br/>                "code": "0000",<br/>                "memo": "Approved or completed successfully"<br/>            },<br/>            "funding": {<br/>                "amount": 7.50,<br/>                "source": {<br/>                    "token": "**********ea62",<br/>                    "createdTime": 1628995326000,<br/>                    "lastModifiedTime": 1628995326000,<br/>                    "type": "program",<br/>                    "active": true,<br/>                    "name": "funding_source_bank",<br/>                    "defaultAccount": false<br/>                }<br/>            },<br/>            "fundingSourceToken": "**********ea62",<br/>            "userToken": "1017b62c-6b61-4fcd-b663-5c81feab6524",<br/>            "currencyCode": "USD"<br/>        },<br/>        "duration": 127,<br/>        "userTransactionTime": 1629083511000,<br/>        "settlementDate": 1629072000000,<br/>        "requestAmount": 5.00,<br/>        "amount": 5.00,<br/>        "issuerReceivedTime": 1629083511084,<br/>        "issuerPaymentNode": "00b8d031e0a4759766b5b5266f5229d8",<br/>        "networkReferenceId": "765766405219",<br/>        "currencyCode": "USD",<br/>        "approvalCode": "223355",<br/>        "response": {<br/>            "code": "0000",<br/>            "memo": "Approved or completed successfully"<br/>        },<br/>        "network": "DISCOVER",<br/>        "acquirer": {<br/>            "systemTraceAuditNumber": "940779"<br/>        },<br/>        "acquirerFeeAmount": 0,<br/>        "user": {<br/>            "metadata": {}<br/>        },<br/>        "card": {<br/>            "lastFour": "4445",<br/>            "metadata": {}<br/>        },<br/>        "cardAcceptor": {<br/>            "mid": "11111",<br/>            "mcc": "6411",<br/>            "name": "The Friendly Tavern",<br/>            "streetAddress": "290 S. Main St",<br/>            "city": "Zionsville",<br/>            "state": "IN",<br/>            "zip": "46077",<br/>            "countryCode": "USA"<br/>        },<br/>        "pos": {<br/>            "pinPresent": false,<br/>            "partialApprovalCapable": true,<br/>            "purchaseAmountOnly": false,<br/>            "recurring": false,<br/>            "installment": false<br/>        }<br/>    }<br/>]</span></pre><p id="e2b6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然最终的有效载荷肯定不是精益的，但这是一项金融交易——具有预期的保障措施和制衡机制。</p><h1 id="08e2" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">结论</h1><p id="b70f" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">从2021年开始，我一直努力实践以下使命宣言，我觉得这适用于任何IT专业人士:</p><blockquote class="om on oo"><p id="0be7" class="ku kv op kw b kx ky ju kz la lb jx lc oq le lf lg or li lj lk os lm ln lo lp im bi translated">将您的时间集中在提供扩展您知识产权价值的特性/功能上。将框架、产品和服务用于其他一切。<em class="it">—j·维斯特</em></p></blockquote><p id="b79d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Marqeta当然符合我的使命宣言，消除了使用Java和Spring Boot实现支付平台的困惑和挑战。</p><p id="a297" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2020年，DZone让我用Java写一个专注于支付处理的RefCard。我拒绝了这个提议，因为我觉得利用支付处理服务要容易得多。如果我当时知道Marqeta，我肯定会在我的答复中提到Marqeta。</p><p id="4f59" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您的项目目标可以受益于优步、DoorDash、Square、Instacart、Affirm和Brex信任的全功能支付处理平台，那么我强烈建议将Marqeta添加到您的供应商候选名单中进行评估。</p><p id="c0be" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望能更深入地了解Marqeta所能提供的更多方面，继续在我已经创建的Spring Boot服务的基础上更进一步。我的目标是在此过程中发表未来的文章。</p><p id="2eab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您对本文中使用的全部源代码感兴趣，只需打开GitLab上的以下资源库:</p><p id="8c91" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">【https://gitlab.com/johnjvester/marqeta-example T4】</p><p id="0cd8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">祝你今天过得愉快！</p></div></div>    
</body>
</html>