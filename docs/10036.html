<html>
<head>
<title>How to Document Svelte Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何记录纤细的组件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-document-svelte-components-ab504661a6fc?source=collection_archive---------11-----------------------#2021-11-16">https://betterprogramming.pub/how-to-document-svelte-components-ab504661a6fc?source=collection_archive---------11-----------------------#2021-11-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="db3f" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">创建编写自己的文档的组件</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/2231e98f8f25128903daae042c1a8e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWDhLFXuSdJ64nZl8BlfzQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae kz" href="https://unsplash.com/@sigmund?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="23f3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在过去的两周里，我一直专注于如何快速为我的<a class="ae kz" href="https://svelte.dev/" rel="noopener ugc nofollow" target="_blank">苗条</a>组件创建文档。我不想重复我的经典错误:创建一些有趣的小东西，但却不能保持文档更新。我需要一种方法来编写并保持文档与代码同步。我试图找出如何让斯维特自己照顾它。我还没有完全成功，但我想我已经设定了大致的程序。</p><h1 id="b147" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">台阶</h1><p id="85ec" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我调查了几条街，大部分都是死胡同。第一次尝试是使用<a class="ae kz" href="https://svelte.dev/docs#svelte_parse" rel="noopener ugc nofollow" target="_blank">svelte . parse</a>——这不符合我的目的。第二次尝试是尝试一些JavaScript解析器，从<a class="ae kz" href="https://github.com/acornjs/acorn" rel="noopener ugc nofollow" target="_blank"> acorn </a>开始。水中的另一个洞:这些工具对我的目标来说太大了。因此，我必须集中精力从较低的水平开始。为了拥有苗条的自我记录，我必须:</p><p id="42ab" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">读取尚未编译的细长组件，即原始的<code class="fe mt mu mv mw b">.svelte</code>文件，并提取我需要的信息:</p><ol class=""><li id="9625" class="mx my iu lc b ld le lg lh lj mz ln na lr nb lv nc nd ne nf bi translated"><code class="fe mt mu mv mw b">props</code>，以及它们的名称、类型和默认值</li><li id="f790" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">可以执行的<code class="fe mt mu mv mw b">actions</code><strong class="lc iv"/>；在这种情况下，如果名称不言自明，就足够了</li><li id="2984" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">可以使用的插槽<strong class="lc iv">和</strong>名称</li><li id="6013" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">还有，但我不完全确定，组件使用的CSS变量</li><li id="7283" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">将这些信息保存在JSON文件中</li><li id="adfa" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">自动去做，这样你就不用去记了</li><li id="e8a1" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">将此信息导入Svelte</li><li id="ec7b" class="mx my iu lc b ld ng lg nh lj ni ln nj lr nk lv nc nd ne nf bi translated">使用特定组件读取信息并自动显示</li></ol><p id="7057" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为关于组件的信息只在开发过程中改变，所以如果设置采取几个步骤就不成问题。如果一切都是自动化的，我可以专注于开发本身，而不用担心细节。</p><h1 id="a20b" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">总体结构</h1><p id="1bd6" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我决定将项目分成两个不同的存储库:</p><div class="nl nm gq gs nn no"><a href="https://github.com/el3um4s/svelte-get-component-info" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd iv gz z fq nt fs ft nu fv fx it bi translated">GitHub—El 3um 4s/svelte-get-component-info:一个提取道具信息的函数</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">一个函数，用于提取一个苗条文件的属性信息。旨在简化文档的创建…</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kt no"/></div></div></a></div><p id="abf6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">管理与数据提取相关的部分</p><div class="nl nm gq gs nn no"><a href="https://github.com/el3um4s/svelte-component-info" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd iv gz z fq nt fs ft nu fv fx it bi translated">GitHub-El 3um 4s/svelte-component-info:显示有关Svelte属性的信息…</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">显示苗条组件的属性信息。旨在简化文档的创建— WIP…</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">github.com</p></div></div><div class="nx l"><div class="od l nz oa ob nx oc kt no"/></div></div></a></div><p id="5129" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了简化各种属性的显示</p><p id="d7f4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这两个库还没有完成。我感兴趣的是记录我已经采取的步骤和将要采取的步骤。一旦项目足够成熟，我将把它集成到我的<a class="ae kz" href="https://github.com/el3um4s/svelte-component-package-starter" rel="noopener ugc nofollow" target="_blank">苗条组件包启动</a>模板中。</p><h1 id="e038" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何获得一个苗条组件的道具列表</h1><p id="335a" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">获取一个瘦组件的属性列表的问题大致类似于在文本文件中查找一个单词的问题。它包括读取一个文件，提取其内容，然后通过提取我需要的片段来滚动浏览。</p><p id="f012" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我首先创建一个函数来读取一个文件，并将其内容作为文本字符串返回:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="6643" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我使用NodeJS <a class="ae kz" href="https://nodejs.org/api/fs.html#fsreadfilesyncpath-options" rel="noopener ugc nofollow" target="_blank"> readFileSync </a> API。获得文件内容后，我开始寻找我感兴趣的内容。为了提取组件的属性，我可以将搜索限制在<a class="ae kz" href="https://svelte.dev/docs#script" rel="noopener ugc nofollow" target="_blank">脚本块</a>中:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="9a4b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我使用regex <code class="fe mt mu mv mw b">/&lt;script[\s\S]*?&gt;[\s\S]*?&lt;\/script&gt;/gi</code>表达式和<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match" rel="noopener ugc nofollow" target="_blank"> string.match(regex) </a>来获得一个字符串。我使用这个结果来查找组件导出的所有<code class="fe mt mu mv mw b">let</code>变量，并将它们保存在一个数组中。我使用的正则表达式是<code class="fe mt mu mv mw b">/export let [\s\S]*?;/gi</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><h1 id="d492" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">获取道具的属性</h1><p id="17ee" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">现在我可以开始查找道具的名称，再次使用正则表达式(<code class="fe mt mu mv mw b">/(?&lt;=let )(.*?)(?=\s|;|=|:)/</code>):</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="05ef" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下一步是提取变量的类型。在本例中，我使用的正则表达式是<code class="fe mt mu mv mw b">/(?&lt;=let [:]|[:])(.*?)(?=;|=)/</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="9899" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">获取变量的默认值更加复杂。我不能使用正则表达式，有太多可能的歧义情况。我可以使用一个技巧，这要感谢我在开始时做的一个选择，当时我把每个let变量保存为一个数组的元素。</p><p id="d1e9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这样，我可以将等号(<code class="fe mt mu mv mw b">=</code>)和字符串的最后一个字符(应该是分号<code class="fe mt mu mv mw b">;</code>)之间出现的所有内容视为默认值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="4d82" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当默认值是字符串时，必须删除引号。为此，我使用了<code class="fe mt mu mv mw b">isStringType</code>和<code class="fe mt mu mv mw b">getStringWithoutQuote</code>函数:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><h1 id="b36d" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">用信息创建对象</h1><p id="8404" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">现在我有了所有的碎片，我可以开始把它们组合在一起了。我写一个函数，得到<code class="fe mt mu mv mw b">name</code>、<code class="fe mt mu mv mw b">type</code>和<code class="fe mt mu mv mw b">defaultValue</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="f278" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，我创建一个函数来读取文件，提取值，并将其作为对象返回:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure></div><div class="ab cl og oh hy oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="in io ip iq ir"><h1 id="a91c" class="lw lx iu bd ly lz on mb mc md oo mf mg ka op kb mi kd oq ke mk kg or kh mm mn bi translated">苗条的部分</h1><p id="f1dd" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在提取了所有的值之后，我必须弄清楚如何显示它们。为了使事情更容易，我正在创建一个苗条的组件(<a class="ae kz" href="https://github.com/el3um4s/svelte-component-info" rel="noopener ugc nofollow" target="_blank">El 3um 4s/Svelte-component-info</a>)。我想要这样的东西:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj os"><img src="../Images/6297a9be48e77831ba8469e237f6a787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tTeDz8tNb-rycwI0.jpg"/></div></div></figure><p id="d989" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一件事是创建一个<code class="fe mt mu mv mw b">SvelteInfo.svelte</code>组件，并决定我需要哪些道具:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="364c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我需要组件名、包名(自动插入代码以便从npm下载)，当然还有我使用前面创建的代码可以获得的所有信息。</p><p id="d31e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用这些信息，我可以自动创建一个解释如何将组件导入到项目中的部分:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="9bd3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以及如何使用该组件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="3ea7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我还可以自动创建一个表格，其中包含关于道具的所有必要信息:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><h1 id="ff68" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">全部使用</h1><p id="211e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">现在我有了所有不同的部分，我可以把它们放在一起，使创建组件的文档更容易。我从已经创建的组件开始，并开始安装我需要的组件:</p><pre class="kk kl km kn gu ot mw ou ov aw ow bi"><span id="c06f" class="ox lx iu mw b gz oy oz l pa pb">npm i @el3um4s/svelte-get-component-info @el3um4s/svelte-component-info</span></pre><p id="26f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我创建了一个文件来管理<code class="fe mt mu mv mw b">infoSvelteComponents.json</code>文件的创建，其中包含以下信息:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="a5c7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我通过添加几个脚本来更新<code class="fe mt mu mv mw b">package.json</code>文件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="f0a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我通过导入<code class="fe mt mu mv mw b">InfoSvelte.svelte</code>和json文件来编辑组件文档页面。然后我添加组件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oe of l"/></div></figure><p id="59ad" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后……没什么，就这样。只需导入组件和JSON文件，其他什么都不要做。从现在开始，每当我使用<code class="fe mt mu mv mw b">npm run build</code>创建组件文档时，我将自动导入所有更新的信息。</p><p id="47ed" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">正如我所说的，这两个库仍在开发中。我计划在接下来的几天里更新它们，但是现在我想把之前的各个步骤整理一下。</p><p id="45b0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢阅读！敬请关注更多内容。</p></div><div class="ab cl og oh hy oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="in io ip iq ir"><p id="9ef0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv"> <em class="pc">不要错过我的下一篇文章—报名参加我的</em> </strong> <a class="ae kz" href="https://medium.com/subscribe/@el3um4s" rel="noopener"> <strong class="lc iv"> <em class="pc">中邮箱列表</em> </strong> </a></p><div class="nl nm gq gs nn no"><a href="https://el3um4s.medium.com/membership" rel="noopener follow" target="_blank"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd iv gz z fq nt fs ft nu fv fx it bi translated">通过我的推荐链接加入Medium—Samuele</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">阅读萨缪尔的每一个故事(以及媒体上成千上万的其他作家)。不是中等会员？在这里加入一块…</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">el3um4s.medium.com</p></div></div><div class="nx l"><div class="pd l nz oa ob nx oc kt no"/></div></div></a></div></div></div>    
</body>
</html>