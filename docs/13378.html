<html>
<head>
<title>Production-Ready React App Setup With Next.js and Dokku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Next.js和Dokku进行生产就绪型React应用设置</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/production-ready-react-app-setup-with-next-js-and-dokku-555fb08cb188?source=collection_archive---------10-----------------------#2022-08-22">https://betterprogramming.pub/production-ready-react-app-setup-with-next-js-and-dokku-555fb08cb188?source=collection_archive---------10-----------------------#2022-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d9c1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这就是我如何用口袋里最少的预算创建并推出一个实时的React应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5674901a37fd09ffb0323e9620bf4c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K_jlrtzG7zpBfJkPyvrlRQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创造的形象</p></figure><p id="fa3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将谈论我的网站。到写这个故事的时候，在功能性方面几乎什么都没有。在这之前，我更专注于一个稳定的应用程序框架，但我计划对它进行改进，并在未来的帖子中分享我的经验。</p><p id="6bd1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我今天的目标是以最低预算为起点，并选择在未来扩展。此外，我愿意完全控制基础设施，并有权在未来将其用作商业项目，所以我选择了自我托管的解决方案，而不是SaaS服务或网站建设者。</p><h1 id="87cc" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">先决条件</h1><ul class=""><li id="af52" class="mm mn it la b lb mo le mp lh mq ll mr lp ms lt mt mu mv mw bi translated">基础编程知识</li><li id="3d54" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">至少34美元在你的口袋里买一个域名，并激活一个主机</li><li id="798a" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">Node.js 12.22.0或更高版本</li></ul><h1 id="d21c" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">应用程序框架</h1><p id="5bb6" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">你可以跳过这一章，克隆我的准系统<a class="ae nf" href="https://github.com/vladmykol/biolink-clone" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>，用你的细节修改它，或者继续阅读，看看我是怎么做的。</p><p id="f2e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时很难开始一个新项目，因为需要大量的初始设置才能让所有的东西都很好地协同工作。为了克服这一点，我决定使用<a class="ae nf" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>，它将为我的应用程序提供最新的webpack、Babel、ESLint和其他惊人的功能。</p><p id="ae66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一天后，当我到达部署部分时，我意识到有一种更现代的方式来引导新的React应用程序，而Create React App中使用的一些方法已经被否决了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/13ab1c3f11ba2d24a1ac4192e90229fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5ybk3LJQUp-tWG2FgOs6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GitHub的随机评论</p></figure><p id="f0b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很可能，你可以为你的下一个React应用程序使用<a class="ae nf" href="https://nextjs.org/docs#setup" rel="noopener ugc nofollow" target="_blank"> Next JS </a>来节省一些时间和跳过那个错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/8997d2547f44263184c2b20b7306f126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lCEejrFcgjuYG5Eh4ZQeeg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用终端新建下一个JS应用程序</p></figure><h1 id="44d3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">准备遥控器</h1><p id="1a55" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在部署我们的应用程序之前，我们需要创建一些帐户，并进行必要的服务器设置。</p><h2 id="349f" class="ni lv it bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">GitHub回购</h2><p id="3fd9" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">私有和公共存储库都是支持和免费的，所以把你的代码推送到<a class="ae nf" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>并创建你的个人<a class="ae nf" href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token#creating-a-token" rel="noopener ugc nofollow" target="_blank">访问令牌</a>。这将允许我们稍后建立一个自动构建&amp;部署工作流。</p><h2 id="2a6f" class="ni lv it bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">云服务器</h2><p id="f59d" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我正在使用Hetzner ，但是你可以使用任何其他的云提供商，直到他们有远程SSH的服务器。现在最便宜的Hetzner服务器花费€4.15英镑/月，我相信一旦你的流量增加，它将足够启动并快速扩展。</p><p id="4fa3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让它更便宜，你可以使用我的<a class="ae nf" href="https://hetzner.cloud/?ref=Pte4144d9gtB" rel="noopener ugc nofollow" target="_blank">推荐链接</a>，只需支付第一年剩余的€30英镑，而不是€50英镑。</p><p id="b8f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用Dokku来管理我们的服务器。这里需要一点设置，但它将允许我们在同一台服务器上托管多个React应用程序，并且不需要额外的费用，所以值得一试。</p><div class="nu nv gp gr nw nx"><a rel="noopener  ugc nofollow" target="_blank" href="/host-your-app-in-the-cloud-for-less-than-5-a-month-cba15cdb6cd8"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">以每月不到5美元的价格在云中托管您的应用程序</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">这是一种在云中部署和托管NodeJs、Python、Java或Ruby应用程序的简单而廉价的方式，几乎不需要任何成本…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">better编程. pub</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><p id="8678" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要完成Hetzner/Dokky的设置，你可以按照我上一篇文章中的步骤找到<your_cloud_server_ip>。</your_cloud_server_ip></p><h2 id="85e6" class="ni lv it bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">新的Dokku应用程序</h2><p id="47ee" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在我们需要用SSH连接到我们的服务器，并创建一个Dokku应用程序。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="9641" class="ni lv it on b gy or os l ot ou">ssh root@&lt;your_cloud_server_IP&gt;</span><span id="ca85" class="ni lv it on b gy ov os l ot ou">dokku apps:create &lt;app_name&gt;<br/>dokku proxy:ports-set &lt;app_name&gt; http:80:5000</span></pre><p id="72c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于Dokku会自动识别、安装所有依赖项，并在<a class="ae nf" href="https://github.com/heroku/heroku-buildpack-nodejs" rel="noopener ugc nofollow" target="_blank"> heroku-buildpack </a>的帮助下构建我们的应用程序，因此无需更多。</p><h1 id="6bad" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">域名</h1><p id="eee7" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我用的是Namecheap，但是你可以选择任何其他支持自定义DNS记录的域名提供商。</p><blockquote class="ow ox oy"><p id="a11e" class="ky kz oz la b lb lc ju ld le lf jx lg pa li lj lk pb lm ln lo pc lq lr ls lt im bi translated">在您的域名DNS记录中，您需要添加<a class="ae nf" href="https://www.cloudflare.com/learning/dns/dns-records/dns-a-record/#:~:text=What%20is%20a%20DNS%20A,210.9." rel="noopener ugc nofollow" target="_blank">一条记录</a>指向&lt; your_cloud_server_IP &gt;</p></blockquote><p id="37a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">找到一个好的域名可能需要几天或几周的时间，但不要在这上面花太多时间或金钱，尤其是如果这是你的试点项目。将来总是有可能改变的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/917fe47e36c7327889f33f3c08878725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrKFkMuKEfVNJijunuHmEQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae nf" href="https://www.namecheap.com/domains/registration/results/?domain=codonator" rel="noopener ugc nofollow" target="_blank"> Namecheap </a>的近似域名价格</p></figure><p id="2167" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">截止到写这篇文章的时候，我最喜欢的“<a class="ae nf" href="https://www.namecheap.com/domains/registration/results/?domain=codonator" rel="noopener ugc nofollow" target="_blank">codonator</a>”<strong class="la iu"/>域名<strong class="la iu"> </strong>一年1.79美元起。</p><h1 id="18f3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">释放它</h1><p id="fd20" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我们终于可以发布我们的应用程序，看着Dokku施展它的魔法了。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="3d3f" class="ni lv it on b gy or os l ot ou">ssh root@&lt;your_cloud_server_IP&gt;</span><span id="31aa" class="ni lv it on b gy ov os l ot ou">dokku git:allow-host github.com<br/>dokku git:auth github.com &lt;username&gt; &lt;github_access_token&gt;<br/>dokku git:sync --build &lt;app_name&gt; &lt;github_repo_link&gt;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/02ddb0984c66b4c917e8627f1ce124cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*15ZyO7qiEcHjV0DkPYGL4Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Dokku应用程序构建</p></figure><p id="6381" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦我们的应用程序被部署，我们可以分配一个域名，并通过生成一个免费的Letsencrypt SSL证书来启用HTTPS。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="40de" class="ni lv it on b gy or os l ot ou">dokku domains:add &lt;app_name&gt; &lt;domain_name&gt;<br/>dokku config:set &lt;app_name&gt; DOKKU_LETSENCRYPT_EMAIL=&lt;your_email&gt;<br/>dokku letsencrypt:enable vladmykol-app<br/>dokku letsencrypt:cron-job --add</span></pre><h1 id="00bb" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">接下来呢？</h1><p id="665d" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">下次我想在我的React应用程序中添加一些新功能时，我会将它推送到GitHub，并运行以下命令来发布它:</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="9d54" class="ni lv it on b gy or os l ot ou">ssh root@&lt;your_cloud_server_IP&gt;<br/>dokku git:sync --build &lt;app_name&gt; &lt;github_repo_link&gt;</span></pre><p id="3b1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不再有本地版本和到服务器的FTP连接。这是一个漂亮而稳定的类似prod的设置。</p><p id="8e4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">仍然有一些安全特性需要配置。不建议使用root帐户。然而，为了简单起见，在我的例子中仍然是这种情况，而不是房间ssh和服务器防火墙设置。</p><h1 id="98f9" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">最后的想法</h1><p id="6b52" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">我使用上述方法来托管五个不同的应用程序，但只支付一个域名和一个远程服务器。这就是Dokku(码头集装箱化)的魅力所在。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/7d6f632696e477aa8615973867657143.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*C2dlLFQdDCYlFRQQnif46g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第一年的估计价格</p></figure><p id="3f7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一次安装需要34美元，但是在服务器有足够的容量之前，下一次安装都是零价格。我估计下一个非促销年度的成本在63美元左右，这仍然是其他SaaS解决方案中最好的价格，我将在<a class="ae nf" href="https://hetzner.cloud/?ref=Pte4144d9gtB" rel="noopener ugc nofollow" target="_blank"> Hetzner </a>上推荐这种与Next.js和Dokku一起托管React App的方式。</p><p id="6d61" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">布里尔。如果你读到这里，你确实是一个好奇的读者。现在，拍拍自己的背，下一轮见。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="ff8a" class="ni lv it on b gy or os l ot ou"><strong class="on iu">Want to see a full source code?</strong></span><span id="0dee" class="ni lv it on b gy ov os l ot ou">Here's my GitHub repo: <a class="ae nf" href="https://github.com/vladmykol/biolink-clone" rel="noopener ugc nofollow" target="_blank">https://github.com/vladmykol/biolink-clone</a></span></pre></div></div>    
</body>
</html>