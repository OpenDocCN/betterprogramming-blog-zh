<html>
<head>
<title>Reading Local JSON Present in an Angular 4/5 or Ionic 2/3 Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">阅读Angular 4/5或Ionic 2/3项目中的本地JSON</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/reading-local-json-present-in-an-angular-2-project-733bc3dda18e?source=collection_archive---------2-----------------------#2017-04-14">https://betterprogramming.pub/reading-local-json-present-in-an-angular-2-project-733bc3dda18e?source=collection_archive---------2-----------------------#2017-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/75e27e0013dc8853cb8cb35009ea8bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4WqthpfMdI7d3i8tcVMWw.png"/></div></div></figure><p id="d475" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">更新:如果您使用的是TypeScript 2.9及以上版本，您可以使用tsconfig.json中的</strong> <code class="fe kz la lb lc b">resolveJsonModule</code> <strong class="kd iu">来访问TS文件中的json文件，如下所示:</strong></p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="8849" class="ll lm it lc b gy ln lo l lp lq">// In tsconfig.json:</span><span id="5b1e" class="ll lm it lc b gy lr lo l lp lq">{</span><span id="015d" class="ll lm it lc b gy lr lo l lp lq">    "compilerOptions": {<br/>        ...</span><span id="c2d4" class="ll lm it lc b gy lr lo l lp lq">        "resolveJsonModule": true,<br/>        ...</span><span id="044d" class="ll lm it lc b gy lr lo l lp lq">    },</span><span id="743b" class="ll lm it lc b gy lr lo l lp lq">}</span><span id="c784" class="ll lm it lc b gy lr lo l lp lq">// In your TS files:</span><span id="f16b" class="ll lm it lc b gy lr lo l lp lq">import * as products from "./products.json";</span><span id="5674" class="ll lm it lc b gy lr lo l lp lq">//and then using them as:</span><span id="f208" class="ll lm it lc b gy lr lo l lp lq">console.log(products.property)</span></pre><p id="0bdc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">了解更多</strong> <a class="ae ls" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-9.html#new---resolvejsonmodule" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">这里</strong> </a> <strong class="kd iu">。</strong></p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="a052" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我最近在做一个Angular 2项目，该项目需要读取项目文件夹中的一个本地静态JSON文件。我在网上搜索JSON的阅读方式，发现:</p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="b5eb" class="ll lm it lc b gy ln lo l lp lq">private _productURL = 'api/products/products.json';    <br/>getProducts(): Observable&lt;any&gt; {<br/>        return this._http.get(this._productURL).map((response : Response) =&gt; &lt;any&gt; response.json())<br/>        .do(data =&gt;console.log(JSON.stringify(data))).catch(this.handleError);<br/>}</span></pre><p id="916d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一种流行的读取本地JSONs的方式。这里，我使用的是存在于<em class="ma"> @angular/http </em>中的Angular 2 HTTP类。你会在很多网站上找到类似上面的代码。</p><p id="8f94" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我在浏览器的开发者窗口中启用了<a class="ae ls" href="https://developers.google.com/web/tools/chrome-devtools/network-performance/reference#offline" rel="noopener ugc nofollow" target="_blank">离线</a>复选框。</p><p id="97d8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">结果？JSON没有加载。当应用程序离线时，Angular 2 HTTP不工作。我甚至尝试为应用程序配置服务人员，但这是一个非常复杂的方法。</p><p id="a619" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在网上搜了一天，挠头了一天之后，我尝试了一个解决方案。它实际上是有效的，但效率不是很高。我将完整的JSON转换为typescript文件中的变量，并导出它们，在需要的地方，导入它们并像这样使用:</p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="b6a9" class="ll lm it lc b gy ln lo l lp lq">//Creating a new typescript file and adding code like below:<br/>export const varName = [{},{},..];</span><span id="3f79" class="ll lm it lc b gy lr lo l lp lq">//And then importing them in other files:<br/>import { varName } from 'path';<br/>console.log(varName.property);</span></pre><p id="6e73" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用这种方法有效，但也有一些缺点。它增加了应用程序的大小，并需要更多的内存来在运行时存储如此大的变量。</p><p id="cefc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">后来又搜索了几个站点，尝试使用Node.js require方法。</p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="e7f7" class="ll lm it lc b gy ln lo l lp lq">//Add this before class declaration:</span><span id="8ac2" class="ll lm it lc b gy lr lo l lp lq">declare function require(url: string);</span><span id="6f55" class="ll lm it lc b gy lr lo l lp lq">//and later:</span><span id="0821" class="ll lm it lc b gy lr lo l lp lq">let variable = require('path/to/your/JSON.json');</span><span id="169a" class="ll lm it lc b gy lr lo l lp lq">//And using it as:</span><span id="ff7e" class="ll lm it lc b gy lr lo l lp lq">console.log(variable.property);</span></pre><p id="ae60" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">再次，另一种方法，效果很好，但我在寻找一个更清晰的解决方案。所以，我在stack overflow<a class="ae ls" href="http://stackoverflow.com/questions/43345347/using-angular-2-http-offline-when-loading-json-in-local-project-folder/43365447#43365447" rel="noopener ugc nofollow" target="_blank">上发了一个问题，并收到了Ofer Herman </a>的回答。他建议道:</p><p id="0844" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，添加一个新文件<code class="fe kz la lb lc b">json-typings.d.ts</code>。</p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="272d" class="ll lm it lc b gy ln lo l lp lq">declare module "*.json" {</span><span id="9dcc" class="ll lm it lc b gy lr lo l lp lq">   const value: any;</span><span id="66cf" class="ll lm it lc b gy lr lo l lp lq">   export default value;</span><span id="3a3d" class="ll lm it lc b gy lr lo l lp lq">}</span></pre><p id="c8b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我把这个文件和index.html文件一起放在了app文件夹里。</p><p id="4f0d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其次，在所需的文件中导入所需的JSON，如下所示:</p><pre class="ld le lf lg gt lh lc li lj aw lk bi"><span id="d8a5" class="ll lm it lc b gy ln lo l lp lq">import * as products from "./products.json";</span><span id="585a" class="ll lm it lc b gy lr lo l lp lq">//and then using them as:</span><span id="6d1e" class="ll lm it lc b gy lr lo l lp lq">console.log(products.property)</span></pre><p id="ac20" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">后来，我选择了最后一个，因为它似乎能更清楚地解决我的问题。</p></div></div>    
</body>
</html>