<html>
<head>
<title>Creating a Zoomable Image View in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中创建可缩放图像视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-zoomable-image-view-in-swift-c5ce67f17b2e?source=collection_archive---------3-----------------------#2021-10-29">https://betterprogramming.pub/creating-a-zoomable-image-view-in-swift-c5ce67f17b2e?source=collection_archive---------3-----------------------#2021-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f6da" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将缩放功能添加到iOS应用程序的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c1095779eba2fec3a54a1b1008060b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0fySSSjoDNx_42Ly"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马库斯·温克勒在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="709c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有什么比完美的图像更能让你的应用大放异彩了。但是，如果你想让你的应用程序用户真正参与到图片中并与之互动呢？也许他们想放大，平移，真正掌握像素？</p><p id="e95e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将构建一个可缩放、可平移的图像视图来实现这一点。</p><h1 id="6cc2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">这个计划</h1><p id="2505" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">他们说一张图片胜过千言万语——但这并不需要一千行代码！对于我们的可缩放图像视图，我们将利用<code class="fe mp mq mr ms b">UIScrollView</code>的缩放和平移功能。本质上，我们将在一个<code class="fe mp mq mr ms b">UIScrollView</code>中嵌套一个包含我们图像的<code class="fe mp mq mr ms b">UIImageView</code>，它将处理所有的缩放、平移(和点击！)我们扔向它的手势。</p><h1 id="43ca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建一个<code class="fe mp mq mr ms b">PanZoomImageView</code></h1><p id="6c01" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们首先创建一个继承了<code class="fe mp mq mr ms b">UIScrollView</code>的<code class="fe mp mq mr ms b">PanZoomImageView</code>类。我们将用一个作为子视图添加的<code class="fe mp mq mr ms b">UIImageView</code>来初始化这个类。我们希望能够通过编程和接口构建器来使用<code class="fe mp mq mr ms b">PanZoomImageView</code>，所以让我们处理不同的初始化器并创建一个公共的init:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="904d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mp mq mr ms b">commonInit()</code>中，我们将图像视图居中并设置其高度和宽度，而不是将其固定在父视图上。这样，滚动视图将从图像视图中获取其内容大小。</p><h1 id="97a5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">设置滚动视图</h1><p id="b052" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们需要实际设置我们的滚动视图，使其可缩放和可平移。这包括设置最小和最大缩放级别，并指定当用户放大时使用的<code class="fe mp mq mr ms b">UIView</code>(在我们的例子中，它将是图像视图)。让我们设置滚动视图(为清晰起见，添加一些注释):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c72e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们设置最小和最大缩放级别，确保滚动指示器是隐藏的(我们不想让它们破坏我们美丽的图像！)，然后我们将<code class="fe mp mq mr ms b">PanZoomImageView</code>类设置为滚动视图委托。Xcode可能会开始抱怨，因为<code class="fe mp mq mr ms b">PanZoomImageView</code>还不符合<code class="fe mp mq mr ms b">UIScrollViewDelegate</code>——让我们接下来这么做:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f5a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这非常简单——我们希望我们的图像是缩放和平移时显示的视图，所以我们只需返回我们的<code class="fe mp mq mr ms b">imageView</code>。</p><h1 id="ba7a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">树立我们的形象</h1><p id="0137" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">太好了！我们在一个<code class="fe mp mq mr ms b">UIScrollView</code>中嵌套了一个<code class="fe mp mq mr ms b">UIImageView</code>，一切都应该是可滚动和可平移的。然而，我们实际上如何树立我们的形象呢？我们将通过向我们的类中添加一个<code class="fe mp mq mr ms b">imageName</code>字符串，并在字符串改变时更新<code class="fe mp mq mr ms b">UIImageView</code>来实现这一点。我们还将把<code class="fe mp mq mr ms b">imageName</code>标记为<code class="fe mp mq mr ms b">@IBInspectable</code>，这样就可以通过界面构建器对其进行设置:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9e6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，我想我们已经准备好使用我们的新类了！打开Main.storyboard并添加一个视图，按照您喜欢的方式将其固定到父视图。接下来，选择视图，导航到Identity Inspector，并将类设置为<code class="fe mp mq mr ms b">PanZoomImageView</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/42e2931fb1102c73de88e653080257bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/0*sS6OJ1ezGrRp4cRg.png"/></div></figure><p id="f344" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导航到属性检查器，您应该看到“图像名称”属性(这代表我们设置为<code class="fe mp mq mr ms b">@IBInspectable</code>的<code class="fe mp mq mr ms b">imageName</code>字符串！).在此处键入您要在视图中嵌套的图像的名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/4bd0adedb21fb6f8cc29b44770f043ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/0*XQGn8FJSQYlJuXU1.png"/></div></figure><p id="4a50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是时候建造和运行了！一切正常，您应该会看到如下内容。尝试平移和缩放(如果您正在使用模拟器，请按住“option”键)——您将获得一个全新的图像视角！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/5205044467b184e8d06a5255004f2733.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/0*DHUZNzHuFLMLA8au.gif"/></div></figure><h1 id="e3b4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">以编程方式初始化视图</h1><p id="c81f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这在使用界面构建器时非常有用——但是如果您想以编程方式初始化视图呢？让我们向类中添加另一个初始化器，这样我们就可以用代码设置图像名称:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">注意，我们在这里不需要调用common init<code class="fe mp mq mr ms b">()</code>——当我们调用<code class="fe mp mq mr ms b">init(frame: .zero)</code>时，它会在不同的初始化器中被调用</p></figure><p id="8a0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！我们现在可以通过传递一个图像名以编程方式初始化我们的视图，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="9c16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从整体上看一下我们的类:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="3609" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">双击手势(可选)</h1><p id="c1a7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">可缩放视图的一个常见功能是双击以放大和缩小。这是对我们类的一个相对简单的添加，所以接下来让我们添加它。我们将创建一个<code class="fe mp mq mr ms b">UITapGestureRecognizer</code>并在用户双击时使用它来改变滚动视图的缩放比例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="994e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！我们现在可以双击来放大/缩小我们的图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/80d263354142afca1114a93c0144fa55.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/0*J4ep8W6esuKB6hB1.gif"/></div></figure></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><h1 id="26aa" class="ls lt iq bd lu lv nf lx ly lz ng mb mc jw nh jx me jz ni ka mg kc nj kd mi mj bi translated">最后的想法</h1><p id="5732" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这是一个很棒的可重用类，只要你想让一个图像可缩放，你就可以把它取出来。添加这种额外的功能可以真正帮助人们关注你在应用程序中显示的图像，这通常是用户期望和需要的功能。</p><p id="c007" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也不仅仅适用于图像视图——如果你想使<code class="fe mp mq mr ms b">UIView</code>可缩放，你可以采用同样的方法，用<code class="fe mp mq mr ms b">UIView</code>代替图像名初始化你的类。要尝试的东西！</p></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><p id="6182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nk">最初发表于</em><a class="ae kv" href="https://www.brightec.co.uk/blog/creating-a-zoomable-image-view-in-swift" rel="noopener ugc nofollow" target="_blank"><em class="nk">【https://www.brightec.co.uk】</em></a><em class="nk">。</em></p></div></div>    
</body>
</html>