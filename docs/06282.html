<html>
<head>
<title>Dockerize Your Development Environment in VS Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用VS代码将你的开发环境文档化</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/dockerize-your-development-environment-in-vs-code-d55ba8d705a9?source=collection_archive---------0-----------------------#2020-09-17">https://betterprogramming.pub/dockerize-your-development-environment-in-vs-code-d55ba8d705a9?source=collection_archive---------0-----------------------#2020-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fa98" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将Node.js环境容器化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd860c3afbdc27ae203fb20221fb0d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-KDHl3vw6lRRcAf99WNyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="e095" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我上一份工作中，我在团队中遇到的一个问题是跨多个操作系统一致地运行项目。我花了几周时间尝试破解Docker文件，这将为团队提供本地一致的工作流，但后来我发现Visual Studio代码只需一个插件就可以轻松完成。</p><p id="f8fc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本指南结合了<a class="ae lu" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>和<a class="ae lu" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>来模拟您的生产设置，并创建跨开发环境的一致性。要使用本指南，需要安装Docker和Visual Studio代码。</p><p id="22a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本指南是为使用Create React App的节点环境编写的，但是无论所选环境需要什么，步骤都可以更改。</p><p id="0dff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你甚至可以在你的开发容器中进行热重装。</p><p id="122d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Visual Studio代码中，安装以下插件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/843dc8b9f9366de34585aa3ea764c597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7MKlB9DgsIzjpA1V.png"/></div></div></figure><p id="9d65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里可以找到:<a class="ae lu" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers" rel="noopener ugc nofollow" target="_blank">https://marketplace.visualstudio.com/items?itemName = ms-vs code-remote . remote-containers</a></p><p id="a2db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这允许我们在容器中运行Visual Studio代码。</p><p id="0426" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在项目的根目录下，需要创建一个名为<code class="fe lw lx ly lz b">.devcontainer</code>的文件夹。这是我们将存储环境设置的地方。</p><p id="db70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后在这个文件夹中创建两个文件，<code class="fe lw lx ly lz b">devcontainer.json</code>和一个<code class="fe lw lx ly lz b">Dockerfile</code>。</p><p id="d579" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">命名很重要，因为Visual Studio代码希望我们使用文件夹和文件名来成功运行容器。</p><p id="79c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您的文件夹结构应该与此匹配:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ebd2d91c544fe8771b8b16e00731ec53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UoqrBgQGZpeWAcYd.png"/></div></div></figure><p id="6a77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe lw lx ly lz b">Dockerfile</code>中，我们选择镜像，并在安装镜像后选择<code class="fe lw lx ly lz b">RUN</code>任何需要的命令(比如全局安装)。</p><p id="6ea6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">Dockerfile</code></p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="fcfc" class="me mf it lz b gy mg mh l mi mj">FROM node:12.14.1-stretch<br/>RUN npm install -g eslint prettier</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0850f08a6849c9ffb19bb2545cb637a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KlPsIyfMKVDO76qg.png"/></div></div></figure><p id="f14c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后在<code class="fe lw lx ly lz b">devcontainer.json</code>中，我们可以配置所有的设置。</p><p id="9a7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">devcontainer.json</code>基本上是一个配置文件，它决定了你的开发容器如何构建和启动。</p><p id="b083" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lw lx ly lz b">devcontainer.json</code></p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="878c" class="me mf it lz b gy mg mh l mi mj">{<br/>  "name": "Node.js Sample",<br/>  "dockerFile": "Dockerfile",<br/>  "appPort": 3000,<br/>  "extensions": ["dbaeumer.vscode-eslint"],<br/>  "settings": {<br/>    "terminal.integrated.shell.linux": "/bin/bash"<br/>  },<br/>  "postCreateCommand": "yarn install",<br/>  // Comment out the next line to run as root instead. Linux users, update<br/>  // Dockerfile with your user's UID/GID if not 1000.<br/>  "runArgs": ["-u", "node"]<br/>}</span></pre><ul class=""><li id="ab08" class="mk ml it la b lb lc le lf lh mm ll mn lp mo lt mp mq mr ms bi translated">Option Description <code class="fe lw lx ly lz b">dockerfile</code> Relative —指向您希望用作图像的docker文件的路径。</li><li id="2c6f" class="mk ml it la b lb mt le mu lh mv ll mw lp mx lt mp mq mr ms bi translated"><code class="fe lw lx ly lz b">appPort</code> —容器运行时应在本地可用的端口或端口阵列</li><li id="4cc6" class="mk ml it la b lb mt le mu lh mv ll mw lp mx lt mp mq mr ms bi translated"><code class="fe lw lx ly lz b">extensions</code> —扩展id数组，指定创建容器时应该安装在容器内的扩展</li><li id="56cd" class="mk ml it la b lb mt le mu lh mv ll mw lp mx lt mp mq mr ms bi translated"><code class="fe lw lx ly lz b">settings</code> —将默认的<code class="fe lw lx ly lz b">settings.json</code>值添加到容器/机器特定的设置文件中</li><li id="2df0" class="mk ml it la b lb mt le mu lh mv ll mw lp mx lt mp mq mr ms bi translated"><code class="fe lw lx ly lz b">postCreateCommand</code> —创建容器后运行的命令字符串或命令参数列表</li><li id="afe5" class="mk ml it la b lb mt le mu lh mv ll mw lp mx lt mp mq mr ms bi translated"><code class="fe lw lx ly lz b">runArgs </code> —运行容器时应使用的Docker CLI参数数组</li></ul><p id="a5ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里是<code class="fe lw lx ly lz b"><a class="ae lu" href="https://code.visualstudio.com/docs/remote/containers#_devcontainerjson-reference" rel="noopener ugc nofollow" target="_blank">devcontainer.json</a></code> <a class="ae lu" href="https://code.visualstudio.com/docs/remote/containers#_devcontainerjson-reference" rel="noopener ugc nofollow" target="_blank">选项</a>的完整列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/d57376a06d51082512f9671fd5a2424b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZxE3y27-sPzb6pdl.png"/></div></div></figure><h2 id="7c13" class="me mf it bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">支票</h2><p id="5566" class="pw-post-body-paragraph ky kz it la b lb np ju ld le nq jx lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">一旦容器运行并且您连接上了，您应该在状态栏的左下方看到您的远程上下文的变化:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/c6e50ea66be576d39da55fa437b6ae7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s2vz-zXJnvCGCigy.png"/></div></div></figure><p id="27c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">安装了Remote-Containers扩展后，您将在最左侧看到一个新的状态栏项目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/7f4c4ca0d48606f1bc7b3e20029744db.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/0*uQYtMIqa-kaw0-Z9.png"/></div></figure><p id="9591" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">远程状态栏项目可以快速显示代码在哪个上下文中运行(本地或远程),单击该项将显示远程容器命令。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/1d164ff60f364e1a523e0b1100c9cb63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gsJpNqNVnikfYFSF.png"/></div></div></figure><p id="cd90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择在容器中重新打开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/1c2fc3a4ea480b50b386582c1dc770c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KU1YGvL13tbclopp.png"/></div></div></figure><h2 id="26f3" class="me mf it bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">等待容器构建完成</h2><p id="f5ef" class="pw-post-body-paragraph ky kz it la b lb np ju ld le nq jx lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">如果这是您第一次连接，将会下载并构建一个Docker映像，并启动一个运行VS代码服务器副本的容器。第一次连接可能需要几分钟，但是以后的连接只需要几秒钟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/29f32419c38d52a89c800dbd0dd5bdbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gym9YCEIDRjkDctn.png"/></div></div></figure><h2 id="acce" class="me mf it bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">检查您的环境</h2><p id="d544" class="pw-post-body-paragraph ky kz it la b lb np ju ld le nq jx lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">在容器中开发的一个好处是，您可以使用应用程序需要的特定版本的依赖项，而不会影响您的本地开发环境。</p><pre class="kj kk kl km gt ma lz mb mc aw md bi"><span id="4547" class="me mf it lz b gy mg mh l mi mj">node --version; <br/>npm --version</span></pre></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="316d" class="od mf it bd my oe of og nb oh oi oj ne jz ok ka nh kc ol kd nk kf om kg nn on bi translated">如果您想要本指南的视频版本:</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure></div></div>    
</body>
</html>