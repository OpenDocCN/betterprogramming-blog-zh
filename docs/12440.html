<html>
<head>
<title>Implement Strategy Pattern in a Purchase Process E-commerce System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在采购流程电子商务系统中实现策略模式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-the-strategy-pattern-works-ce3700100679?source=collection_archive---------12-----------------------#2022-06-06">https://betterprogramming.pub/how-the-strategy-pattern-works-ce3700100679?source=collection_archive---------12-----------------------#2022-06-06</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="8f8d" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">理解策略模式如何工作</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/580f6831e5bf9005387e77f38648893f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b06Z9eZgJAI-SneP6rFltQ.png"/></div></div></figure><h1 id="3bb1" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">概观</h1><p id="1276" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">你有没有进过电商网站购买过一个产品？如果你有，那么你可能见过不同的支付方式(贝宝，信用卡等。)</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mg"><img src="../Images/038ed0226396c0ecf86566a637f5be48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ofK-KItF7mD2aiml"/></div></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">购买流程</p></figure><p id="b866" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">这个购买过程是一种观察战略模式的方式。</p><p id="612a" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">策略是一种行为设计模式，允许您定义不同的策略并在它们之间切换以达到目标。在上图中，你有一个目标(购买产品)和不同的策略来完成它(用PayPal、信用卡等支付)。).</p><p id="823d" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">让我们看看我们将如何实现这个购买过程。</p><h1 id="6a5c" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">战略模式的结构</h1><p id="101c" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">首先，让我们了解一下模式的结构。它由3部分定义:</p><ol class=""><li id="cbb6" class="mq mr ir lm b ln ml lq mm lt ms lx mt mb mu mf mv mw mx my bi translated">情境类:这是我们的目标</li><li id="c663" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">契约接口:这些是策略要遵循的规则</li><li id="461a" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">策略类:指达到目标的不同策略，都是<code class="fe ne nf ng nh b">Contract Interface</code>的实施</li></ol><p id="1a5e" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">下面是策略结构的类图:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mg"><img src="../Images/1b01f0822b317bb5480c44d774e20803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RjXtK5GmMHXVqyuU"/></div></div></figure><p id="2d18" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">也需要一个触发购买过程的客户端。将在代码示例中看到这一点。</p><h1 id="b235" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">代码时间，耶！</h1><p id="7201" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">现在，让我们将类图转化为代码，看看它是如何实现的。我将使用<a class="ae ni" href="https://go.dev/" rel="noopener ugc nofollow" target="_blank"> Golang </a>，因为这是我熟悉的语言:</p><p id="6443" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated"><strong class="lm is">定义合同界面</strong></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">PaymentMethodStrategy接口</p></figure><p id="da61" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated"><strong class="lm is">定义上下文</strong></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">购买用例</p></figure><p id="0c12" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated"><strong class="lm is">实施战略</strong></p><p id="23fd" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">为此，将有3个不同的类(贝宝，信用卡和银行)</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">PayPal策略</p></figure><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">信用卡策略</p></figure><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">银行战略</p></figure><p id="b0d8" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated"><strong class="lm is">客户端</strong></p><p id="546d" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">在这个例子中，我将使用控制台来执行购买过程。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">客户端使用</p></figure><p id="109d" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">当我们运行程序时，情况是这样:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nl"><img src="../Images/2f8de7275c8aafc40eb8cf49c0cc90ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1eVWdlL-HwohOCfA"/></div></div></figure><blockquote class="nm nn no"><p id="eb1a" class="lk ll np lm b ln ml js lp lq mm jv ls nq mn lv lw nr mo lz ma ns mp md me mf ik bi translated">注意:这个模式是实现SOLID的开/闭原理的一种方式。</p></blockquote><h2 id="c93e" class="nt kt ir bd ku nu nv dn ky nw nx dp lc lt ny nz le lx oa ob lg mb oc od li oe bi translated">如果我们想增加另一种支付方式呢？</h2><p id="e30e" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">这很容易，您只需创建另一个实现“PaymentMethodStrategy”接口的类:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">比特币策略</p></figure><p id="420b" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">之后，你只需要在你的上下文类中注册它:</p><pre class="kh ki kj kk gu of nh og oh aw oi bi"><span id="2177" class="nt kt ir nh b gz oj ok l ol om">purchase.RegisterStrategy("Bitcoin", NewBitcoin())</span></pre><h1 id="d4e3" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">传统的方式</h1><p id="f137" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated"><em class="np">如果没有战略模式，实施这个流程会怎么样？</em></p><p id="4b2b" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">我们没有3个类(上下文、契约和策略)，而是只有一个类来实现用PayPal、信用卡、银行等支付的所有逻辑。</p><p id="adbb" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">这将是我们实现所有逻辑的<code class="fe ne nf ng nh b">Purchase</code>类:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">经典实现</p></figure><p id="1136" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated"><strong class="lm is">我们的客户</strong></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nj nk l"/></div><p class="mh mi gk gi gj mj mk bd b be z dk translated">使用经典实现的客户端</p></figure><p id="fdff" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">当我们运行程序时，情况是这样:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nl"><img src="../Images/432719f1f0704a235c023d9128c200c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6vHHr7QxL4600DUT"/></div></div></figure><p id="45e3" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">当您第一次构建我们的应用程序时，或者当您知道您很少添加或修改现有逻辑时，这可能是好的。但是如果你知道商业逻辑将会增长，这样的事情将来可能会发生:</p><ol class=""><li id="bd40" class="mq mr ir lm b ln ml lq mm lt ms lx mt mb mu mf mv mw mx my bi translated">浏览代码将会很困难</li><li id="9f13" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">很有可能你修改了不该修改的东西</li><li id="aba0" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">当不同的人处理同一个类时，Git会发生冲突</li><li id="dcf0" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">许多条件之间切换不同的支付方式</li></ol><p id="ddec" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">从业务的角度来看，它可以工作，但是从技术的角度来看，它不可维护。</p><blockquote class="nm nn no"><p id="53b2" class="lk ll np lm b ln ml js lp lq mm jv ls nq mn lv lw nr mo lz ma ns mp md me mf ik bi translated">注意:在这个例子中，将所有的逻辑放在一个类中，将违背SOLID的单一责任原则。</p></blockquote><h1 id="4bc6" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">实践</h1><p id="d8c2" class="pw-post-body-paragraph lk ll ir lm b ln lo js lp lq lr jv ls lt lu lv lw lx ly lz ma mb mc md me mf ik bi translated">在这里，我展示了什么是策略模式，它是如何构造的，以及何时应该使用这种模式，而不是将所有的逻辑放在一个类中。</p><p id="46b2" class="pw-post-body-paragraph lk ll ir lm b ln ml js lp lq mm jv ls lt mn lv lw lx mo lz ma mb mp md me mf ik bi translated">我邀请你实现这种模式来应用订单折扣，并在评论中分享代码。希望这篇博客能帮助你理解战略模式。在本系列的下一篇设计模式文章中再见。</p><h1 id="57f3" class="ks kt ir bd ku kv kw kx ky kz la lb lc jx ld jy le ka lf kb lg kd lh ke li lj bi translated">参考</h1><ol class=""><li id="2ceb" class="mq mr ir lm b ln lo lq lr lt on lx oo mb op mf mv mw mx my bi translated"><a class="ae ni" href="https://refactoring.guru/design-patterns/book" rel="noopener ugc nofollow" target="_blank">深入研究设计模式</a>:这篇文章是我从这本书上记下来的</li><li id="432a" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated"><a class="ae ni" href="https://github.com/phw/peek" rel="noopener ugc nofollow" target="_blank"> Peek </a>:记录我终端的工具</li><li id="dedc" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated"><a class="ae ni" href="https://www.figma.com/figjam/" rel="noopener ugc nofollow" target="_blank"> Figma Jam </a>:制作插画</li><li id="cb44" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated">文章库:你可以在我的GitHub中找到例子</li><li id="9596" class="mq mr ir lm b ln mz lq na lt nb lx nc mb nd mf mv mw mx my bi translated"><a class="ae ni" href="https://ray.so/" rel="noopener ugc nofollow" target="_blank"> Ray.so </a>:截图</li></ol></div></div>    
</body>
</html>