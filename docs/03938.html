<html>
<head>
<title>5 Property Wrappers to Declutter Your iOS Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个属性包装器来整理你的iOS代码</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/five-property-wrappers-to-de-clutter-your-ios-code-f5ee6fa4e52e?source=collection_archive---------1-----------------------#2020-03-14">https://betterprogramming.pub/five-property-wrappers-to-de-clutter-your-ios-code-f5ee6fa4e52e?source=collection_archive---------1-----------------------#2020-03-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="41b5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你可能熟悉@State和@EnvironmentObject，这里还有5个</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/10565aaeb6a53c473aaf076fb1f5c316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DUXPYr8i_kQFITAnHlnJIA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@plushdesignstudio?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">毛绒设计工作室</a>在<a class="ae ky" href="https://unsplash.com/s/photos/organising?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="202f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Swift 5.1给了我们属性包装器，允许我们复制我们自己从关键字中获得的功能。如果你用过SwiftUI，你会发现它们无处不在，其中<code class="fe lv lw lx ly b">@State</code>和<code class="fe lv lw lx ly b">@EnvironmentObject</code>是开发的关键。</p><p id="01d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了帮助您开始在应用程序中使用属性包装器，我收集了一些非SwiftUI的示例，它们改进了我的工作流程。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="abcb" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak"> 1。已获取</strong></h1><p id="b253" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">Fetched消除了设置获取请求和<code class="fe lv lw lx ly b">NSFetchedResultsControllers</code>的痛苦，并用一个简单的变量声明来代替它。</p><p id="4465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不用编写服务或者用核心数据逻辑来混淆视图模型，您只需将<code class="fe lv lw lx ly b">@Fetched</code>添加到一个变量中，并让它自动排序。</p><p id="0d2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个包装器，你可以完全免费地获得实时更新数据，你所要做的就是获得<code class="fe lv lw lx ly b">wrappedValue</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="ef48" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">2.普遍存在的</h1><p id="5890" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在编写现代iOS应用程序时，您可能需要保存一些关于用户的信息。</p><p id="d571" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我见过的最好的方法是创建管理器类，它为您照看单个属性，并在需要时获取它们。我见过的最简单的方法就是在声明变量时获取它。</p><p id="a20e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们可以拥有一行程序的简单性，拥有一个manager类的干净底层代码，并将这些值存储在iCloud中，会怎么样？</p><p id="2ec9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入<code class="fe lv lw lx ly b">Ubiquitous</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="87ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢<a class="nf ng ep" href="https://medium.com/u/7946a85da51b?source=post_page-----f5ee6fa4e52e--------------------------------" rel="noopener" target="_blank">安托万·范德·李·🇳🇱</a>的灵感，我所做的只是将用户默认设置替换为<code class="fe lv lw lx ly b">NSUbiquitousKeyValueStore</code>以获得iCloud支持，并注入可测试性。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="7ec7" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">3.文本</h1><p id="0438" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">或者，在这种情况下，<code class="fe lv lw lx ly b">Title</code>。</p><p id="2425" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用编程布局时，您会发现自己在重复设置<code class="fe lv lw lx ly b">UILabel</code>的属性。</p><p id="81e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然代码不多，但你可以重用其中的很多，你会发现复杂的视图变得非常大，非常快。如果您正在附近进行约束逻辑，这一点尤其正确。</p><p id="d05b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数设计良好的应用程序都有一些严格遵循的文本样式，你不希望重复制作标签并用这些值来设置它们。</p><p id="f4eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，您有一个想要显示的字符串，并且知道如何显示它。为什么不让包装器为您处理所有这些呢？</p><p id="52c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我将标题标签的代码包装到了<code class="fe lv lw lx ly b">Title</code>属性包装器中，这意味着每个带有标题的屏幕都简单地使用了<code class="fe lv lw lx ly b">@Title</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="83b6" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">4.卡片</h1><p id="5db4" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">遵循与<code class="fe lv lw lx ly b">Text</code>相同的模式，您可以使用属性包装器来设置<code class="fe lv lw lx ly b">UIView</code>的公共属性</p><p id="3ccc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以一张基础卡为例，你有一个特定的阴影和圆角半径来应用。您可以很容易地创建一个<code class="fe lv lw lx ly b">UIView</code>子类来为您设置所有这些属性——但是如果您所做的只是使用现有的属性，为什么要走那么远呢？</p><p id="5841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Card</code>可应用于任何<code class="fe lv lw lx ly b">UIView</code>并设置整个视图，包括拐角曲线和阴影不透明度等内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1019" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的——属性包装器和<code class="fe lv lw lx ly b">UIView</code>的这种模式确实有助于减少编程布局代码的大小。</p><p id="8f9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这甚至可以更多地用于向视图添加约束，其中<code class="fe lv lw lx ly b">@Pinned</code>是一个可能的解决方案，将一个视图固定到它的superview。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="f8b1" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">5.图像下载</h1><p id="1fe4" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我保证这不仅仅是设置UIKit属性。</p><p id="1664" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像下载是一个非常琐碎的任务，但是它最终会涉及到大量的代码。您有从数据创建<code class="fe lv lw lx ly b">UIImage</code>的<code class="fe lv lw lx ly b">URLSession</code>代码，甚至可能有一个缓存。</p><p id="9429" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，<code class="fe lv lw lx ly b">ImageDownloading</code>包装器将为您设置一个占位符图像(如果它存在的话)，然后继续从web下载图像并将其设置在<code class="fe lv lw lx ly b">UIImageView</code>上。</p><p id="6e4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它甚至处理线程，以帮助保持主线程漂亮和自由地呈现您的用户界面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b8f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">ImageDownloading</code>可以很容易地被扩展以包含对共享缓存的引用，或者适合与可重用的视图一起工作。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="5133" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="4b42" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我希望这些属性包装器对您有所帮助，并启发您自己添加一些——它们是避免重复代码的一种强大的新方法，并且它们帮助我弥合了SwiftUI和声明性UIKit之间的差距。</p><p id="55cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>