<html>
<head>
<title>How to Pass Pointers As Arguments in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Go中将指针作为参数传递</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/passing-pointers-as-arguments-in-go-a77a7d1f8493?source=collection_archive---------16-----------------------#2020-03-16">https://betterprogramming.pub/passing-pointers-as-arguments-in-go-a77a7d1f8493?source=collection_archive---------16-----------------------#2020-03-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a54b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">需要修改值时如何处理指针</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c27733c79b96b96b3451979aaccf9629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5hCyh9kXfFAQ6T2B"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯莉·西克玛在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片。</p></figure><p id="a38e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是围棋中一个简单而基本的概念，但作为一个新手，我很难理解到底发生了什么。所以这可能会为另一个困惑的初学者节省一点时间。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8bbd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">问题是</h1><p id="dab8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有时，当将一个变量作为参数传递给一个函数，目的是以某种方式改变该变量时，该变量在调用该函数后根本不会改变。如果我在函数范围内改变值，那怎么可能呢？</p><p id="5798" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Go中的变量总是通过值来传递，也就是说每次你把一个变量传递给一个函数，这个函数都会复制这个变量，而不会接触到原来的变量。</p><p id="4594" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们举个简单的例子。我们想向购物列表添加一些项目(字符串片段中的字符串)，所以我们只需声明并初始化我们的项目，然后将它们追加到购物列表中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="7b88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是当我们打印出购物清单时，我们得到:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="eb7f" class="ng md it nc b gy nh ni l nj nk">//Output<br/>Shopping list contains: []</span></pre><p id="08ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可不好。我们在购物清单上加了三样东西，但它看起来完全是空的。当我们在函数中明确地将这些项添加到列表中时，这怎么可能呢？</p><p id="e32d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关键事实是:变量(我们的购物清单)确实在变化，但这只发生在被调用的函数范围内。如果我们对函数中的购物清单进行快照，我们会看到发生了什么。让我们添加一行来查看函数范围内的列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="07f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到了:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5536" class="ng md it nc b gy nh ni l nj nk">//Output<br/>[oreos]                               //appending cookies<br/>[toilet paper]                        //appending vaccine<br/>[Animal Crossing: New Horizons]        //appending lifePurpose<br/>Shopping list contains: []            //Actual list still empty</span></pre><p id="2ecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们确认了购物清单只在函数内部发生变化，因为当切片作为参数传递时，函数会复制一个只存在于函数范围内的副本。这是因为，Go中的变量总是通过值传递的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0cd7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">解决方案</h1><p id="9e65" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了使函数能够更改并实际向切片添加项目，它需要始终指向同一个<code class="fe nl nm nn nc b">shoppingList</code>变量。因此，我们可以通过简单地传递一个指向<code class="fe nl nm nn nc b">shoppingList</code>变量而不是变量的指针来解决这个基本但令人讨厌的问题。</p><p id="abb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，函数将总是引用同一个变量，而不仅仅是复制它。</p><p id="eb7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:从技术上讲，即使当通过指针传递变量时，指针仍然是通过值传递的。该变量从不通过引用传递。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="ad03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，我们改变了函数调用，给它变量的地址:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="07b7" class="ng md it nc b gy nh ni l nj nk">addToShoppingList(cookies, &amp;shoppingList)<br/>addToShoppingList(vaccine, &amp;shoppingList)<br/>addToShoppingList(life, &amp;shoppingList)</span></pre><p id="6678" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们在第3行直接修改了指向变量<code class="fe nl nm nn nc b">shoppingList</code>的指针，我们可以简化函数:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="865d" class="ng md it nc b gy nh ni l nj nk">func addToShoppingList(item string, shoppingList *[]string) {</span><span id="e24e" class="ng md it nc b gy no ni l nj nk">*shoppingList = append(*shoppingList, item)  //line 3</span><span id="2152" class="ng md it nc b gy no ni l nj nk">}</span></pre><p id="c025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但不管怎样，我们都会得到:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="2935" class="ng md it nc b gy nh ni l nj nk">//Output<br/>Shopping list contains: [oreos toilet paper Animal Crossing: New Horizons]</span></pre><p id="2aeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们设法修改了我们的购物清单！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6187" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结束了</h1><p id="c46d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">因此，虽然这显然是一个过于简化的案例，但如果您对这个琐碎但有用的概念有任何疑问，我希望这有助于消除您的疑虑。如果你想补充一些东西或者告诉我我可能犯的任何错误，就在下面写下你的回答。</p><p id="d2a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">干杯！</p></div></div>    
</body>
</html>