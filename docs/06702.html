<html>
<head>
<title>Learn Solidity: Variables (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习可靠性:变量(第1部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/learn-solidity-variables-part-1-657fc27c2cc1?source=collection_archive---------5-----------------------#2020-10-27">https://betterprogramming.pub/learn-solidity-variables-part-1-657fc27c2cc1?source=collection_archive---------5-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f1e7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">开始在以太坊上写智能合同</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/24b6da962e961481a7f1e255b07b49d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kOOnvxJ3Pb_EPd7jdFJBTg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@photoshobby?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">照片爱好</a>在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="e23a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎阅读学习可靠性系列的第二篇文章。如果您还没有阅读第一篇<a class="ae kv" href="https://wissal-haji.medium.com/learn-solidity-introduction-327b1f9eb30e" rel="noopener"/>，我强烈建议您阅读，以便设置您的开发环境，并编写和部署您的第一份合同。在这篇文章中，我们将看看Solidity中的变量，它们的类型，它们是如何存储的，以及如何使用它们。</p><p id="4a66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/" rel="noopener ugc nofollow" target="_blank">实度</a>中，我们有两种类型的变量:</p><h2 id="e636" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">状态变量</h2><p id="5752" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这些变量是在函数之外声明的(就像类的属性一样)，并永久存储在以太坊区块链中，更具体地说是存储在Merkle Patricia树中，这是形成帐户状态的信息的一部分(这就是为什么我们称之为状态变量)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/45e4030be61f83296f8c0c1dc231e098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*8TjnzNi_9JZG7UmlqDId7g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">以太坊Merkle帕特里夏树:<a class="ae kv" href="https://medium.com/cybermiles/diving-into-ethereums-world-state-c893102030ed" rel="noopener">来源</a></p></figure><p id="8f41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在本文中找到更多关于以太坊区块链<a class="ae kv" href="https://medium.com/cybermiles/diving-into-ethereums-world-state-c893102030ed" rel="noopener">中数据存储方式的信息。</a></p><p id="71d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">状态变量可以在声明时进行初始化，并具有以下可见性:</p><ul class=""><li id="77ab" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><code class="fe na nb nc nd b">private</code>:状态变量只对定义它的契约可见。</li><li id="3916" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated"><code class="fe na nb nc nd b">public</code>:状态变量也可以从定义它的契约外部访问，因为编译器会自动创建一个与变量同名的getter函数。</li><li id="fd40" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated"><code class="fe na nb nc nd b">internal</code>:state变量对于定义它的契约以及继承它的所有其他契约都是可见的。</li></ul><p id="50c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可见性说明符在状态变量的类型之后给出，如果没有指定，状态变量将被认为是内部变量。</p><h2 id="0f9d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">局部变量</h2><p id="dfdb" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这些是在函数内部声明的变量，它们的生存期仅限于在。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="6e97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和其他语言一样，我们有基本类型和复杂类型。当用作函数参数或在赋值中使用时，基元类型总是通过值传递，而复杂类型(如数组和结构)则通过引用传递。</p><h2 id="f712" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">原始数据类型</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/c5667d8d73b7f9e456121d0b0af4bf83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*iv1eWdxTcvDkWeV5fu4Stw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">坚固性基本类型</p></figure><p id="c9f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/types.html#address" rel="noopener ugc nofollow" target="_blank">关于地址类型的更多信息:</a></p><ul class=""><li id="d4dc" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">地址文字:通过地址校验和测试的十六进制文字，例如<code class="fe na nb nc nd b">0xdCad3a6d3569DF655070DEd06cb7A1b2Ccd1D3AF</code>属于<code class="fe na nb nc nd b">address payable</code>类型。</li><li id="bd36" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">类型转换:<code class="fe na nb nc nd b">address payable</code>可以隐式地转换成一个简单的<code class="fe na nb nc nd b">address</code>，这意味着您可以将一个可支付的地址分配给一个地址，而无需显式地转换它。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="81b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">整数、<a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/types.html#rational-and-integer-literals" rel="noopener ugc nofollow" target="_blank">整数文字、</a>和<code class="fe na nb nc nd b">bytes20</code>允许使用以下语法显式转换为地址:<code class="fe na nb nc nd b">address(x)</code>。这种转换将产生一个<code class="fe na nb nc nd b">address payable</code>类型。</p><ul class=""><li id="92fe" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/units-and-global-variables.html#address-related" rel="noopener ugc nofollow" target="_blank">地址成员:</a>地址类型的两个重要成员是<code class="fe na nb nc nd b">balance</code>和<code class="fe na nb nc nd b">transfer</code>，前者允许查询一个地址的余额，后者允许发送以太(以卫为单位)到一个可支付的地址。</li><li id="c0bb" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated"><a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/types.html#contract-types" rel="noopener ugc nofollow" target="_blank">契约和地址类型:</a> <br/>您可以使用我们之前看到的语法:<code class="fe na nb nc nd b">address(x)</code>显式地将契约转换为地址类型，这里的x是契约的一个实例。如果契约定义了一个<a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/contracts.html#receive-ether-function" rel="noopener ugc nofollow" target="_blank">接收</a>或一个<a class="ae kv" href="https://solidity.readthedocs.io/en/v0.7.4/contracts.html#fallback-function" rel="noopener ugc nofollow" target="_blank">应付回退函数</a>(我们将在后面更详细地讨论函数)，这将导致一个<code class="fe na nb nc nd b">address payable</code>，如果没有定义，则导致一个<code class="fe na nb nc nd b">address</code>，在这种情况下，如果您希望它是应付的，您将必须使用<code class="fe na nb nc nd b">payable(address(x))</code>。</li></ul></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="fe17" class="nt lt iq bd lu nu nv nw lx nx ny nz ma jw oa jx md jz ob ka mg kc oc kd mj od bi translated">全局可用变量</h1><p id="6317" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">有一些特殊变量总是存在于全局名称空间中，主要用于提供有关区块链的信息。</p><p id="3a39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以将这些变量分为三类:</p><ol class=""><li id="18fd" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr oe mx my mz bi translated">块属性</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/8496d7375c3da1f800f0a90a06c52f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sk6q45yy_GtJr_LuhTRS7Q.png"/></div></div></figure><p id="ca19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.邮件属性</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/6be1bdd3aa2814af9bc4161e1c27a40b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*5Tk08OB8RJmQh2eYTQwKiw.png"/></div></figure><p id="ae0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.交易属性</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/0f13b3bbfcb43351cf801ec926705829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*XwBuaf5FhjIEWTCZE545Cw.png"/></div></div></figure><p id="6e15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将大量使用的两个属性是<code class="fe na nb nc nd b">msg.sender</code>，它可以为我们提供发送者的地址，从而可以存储合同所有者的地址，以及<code class="fe na nb nc nd b">msg.value</code>来获取随消息发送的金额。</p><p id="ae3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们举一个例子，我们存储合同创建者的地址并修改<code class="fe na nb nc nd b">HelloWorldContract</code>，这样如果消息是由创建者发送的，我们就用“你好，爸爸否则，我们用“你好，世界”来问候发送者</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="929e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您像我们在上一篇文章中看到的那样部署契约，然后单击<code class="fe na nb nc nd b">sayHell</code>，您将得到“hello Daddy ”,因为您用于部署契约的地址与您用于调用该函数的地址相同。</p><p id="827c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们换个账号再调用函数吧。要更改您的帐户，您需要点击帐户部分的下拉列表，并选择不同的地址。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/add32e55d97190eccff79aeec2f845b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*KsJn25sZnE0JScIJL55PIA.png"/></div></figure><p id="4615" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你这次打电话给<code class="fe na nb nc nd b">sayHello</code>，你应该会得到“你好世界”太好了，我们学到了一些东西。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="c03e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在给你留下一个应用你所学知识的练习之前，我想提一下，Solidity中的<code class="fe na nb nc nd b"><a class="ae kv" href="https://solidity.readthedocs.io/en/latest/units-and-global-variables.html#contract-related" rel="noopener ugc nofollow" target="_blank">this</a></code>关键字引用了当前契约的类型，并且可以显式地转换为地址，就像我们在契约实例中看到的那样。</p><p id="b154" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我将留给您以下任务作为练习:</p><ul class=""><li id="ecaa" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">合同的寄信人地址。</li><li id="f304" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">合同所有者的寄信人地址。</li><li id="3db2" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">寄件人的回邮地址。</li><li id="f7d4" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">返回合同的余额。</li><li id="7473" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">返回合同所有者的余额(仅当发送方是所有者时)。</li><li id="94a8" class="mr ms iq ky b kz ne lc nf lf ng lj nh ln ni lr mw mx my mz bi translated">返回发送方的余额。</li></ul><p id="5057" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在GitHub 上找到解决方案<a class="ae kv" href="https://gist.github.com/wissalHaji/43ba02467834e5d07e42fa3a1978d15c" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a852" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这篇文章。下一次我们将讨论复杂类型，并揭示我在前面的代码中在<code class="fe na nb nc nd b">string</code>旁边使用的<code class="fe na nb nc nd b">memory</code>关键字背后的秘密。所以，如果你想了解更多，请留下来，下一篇文章再见。</p></div></div>    
</body>
</html>