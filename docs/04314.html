<html>
<head>
<title>Warhol: Face Detection Made Easy on iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">沃霍尔:iOS上的人脸检测变得简单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/warhol-face-detection-made-easy-on-ios-4b146b87b7d0?source=collection_archive---------8-----------------------#2020-04-05">https://betterprogramming.pub/warhol-face-detection-made-easy-on-ios-4b146b87b7d0?source=collection_archive---------8-----------------------#2020-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0286" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">只需一步，即可检测人脸并在上面绘画</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/07e0b919fed7feca93f369b619dde38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Td7AXP1Y2T_KV_-g8qXJnA.png"/></div></div></figure><h1 id="79b9" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">创世纪</h1><p id="1d64" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我喜欢画画。具体来说，我喜欢画肖像。我发现我们面部的独特性很迷人，我们每个人都有如此少的参数(眼睛、鼻子、嘴巴、耳朵和一个形状)却有不同的面貌。</p><p id="a382" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">一旦你开始画肖像，理论上说放置细节和找到合适的比例是最重要的。当然，你需要表现出每个特征的细节，但是给你一种与原作相似的感觉的是那些特征。如果有个app帮我做到这一切岂不是很好？我在app store里查了一下，惊讶的是，什么都没有！因为我喜欢吃我自己的狗粮，所以是时候开发一个应用程序了，给定一张肖像，提供脸部的坐标和比例，这样当我把它投影到纸和铅笔上时，我就有了一个想法。</p><p id="a346" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">自然，第一个任务是刷新我在iOS上关于人脸检测的生锈知识，并深入了解<a class="ae mk" href="https://developer.apple.com/documentation/vision" rel="noopener ugc nofollow" target="_blank">视觉</a>。</p><blockquote class="ml mm mn"><p id="8d1a" class="lj lk mo ll b lm mf jr lo lp mg ju lr mp mh lu lv mq mi ly lz mr mj mc md me ij bi translated">该框架执行面部和面部标志检测、文本检测、条形码识别、图像配准和一般特征跟踪。Vision还允许使用定制的核心ML模型来完成分类或对象检测等任务。</p></blockquote><p id="97d6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">哇，这是一大块的功能！我只需要面部和面部标志检测。地标是视觉语言中的一个特征，比如左眼、右眼……除此之外，如果我想从设备摄像头中检索人脸图像，我必须使用AVFoundation。</p><p id="7e87" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在我开始深入研究之后，我的“潜在第三方库帮助开源社区警报”开始响了。令我感到惊讶的是，尽管关于它的教程很少，但没有一个库一步封装了人脸检测功能，避免了处理低级的苹果框架，并使移动应用程序上人脸检测的主要目的变得容易——在上面画一些愚蠢的东西😝</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/752bf8c3304f1058a469cf27c7522923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYPrS3aJZmCwnQVLpaWsDw.jpeg"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">画肖像:比例，比例，比例。</p></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="dba9" class="kr ks iq bd kt ku ne kw kx ky nf la lb jw ng jx ld jz nh ka lf kc ni kd lh li bi translated">沃霍尔</h1><p id="1176" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mk" href="https://github.com/toupper/Warhol" rel="noopener ugc nofollow" target="_blank">沃霍尔</a>取自安迪·沃霍尔的名字，他是美国艺术家、电影导演和制片人，是被称为<a class="ae mk" href="https://en.wikipedia.org/wiki/Pop_art" rel="noopener ugc nofollow" target="_blank">波普艺术</a>的<a class="ae mk" href="https://en.wikipedia.org/wiki/Art_movement" rel="noopener ugc nofollow" target="_blank">视觉艺术运动</a>的领军人物。这是因为当我想到肖像画时，我会想到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/c899010f8dae4dd3a2d0214ee95989a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1S1kJybsuRReSEbU4e0_w.jpeg"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">沃霍尔，多酷的名字啊！</p></figure><p id="b3c0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为什么要用？如前所述，你可以忘记相当繁琐的Vision和AVFoundation Apple框架，专注于你真正的创造性任务。这是一个工具，将帮助你实现你的独特功能。</p><h2 id="f70c" class="nk ks iq bd kt nl nm dn kx nn no dp lb ls np nq ld lw nr ns lf ma nt nu lh nv bi translated">特点:</h2><p id="3390" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mk" href="https://github.com/toupper/Warhol" rel="noopener ugc nofollow" target="_blank">沃霍尔</a>有什么特点？</p><ul class=""><li id="05ae" class="nw nx iq ll b lm mf lp mg ls ny lw nz ma oa me ob oc od oe bi translated">摄像机中的人脸检测</li><li id="7adf" class="nw nx iq ll b lm of lp og ls oh lw oi ma oj me ob oc od oe bi translated">UIImageView中的人脸检测</li><li id="dc52" class="nw nx iq ll b lm of lp og ls oh lw oi ma oj me ob oc od oe bi translated">将面部特征转换到客户坐标</li><li id="c637" class="nw nx iq ll b lm of lp og ls oh lw oi ma oj me ob oc od oe bi translated">在脸部上方绘制</li></ul></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="1824" class="kr ks iq bd kt ku ne kw kx ky nf la lb jw ng jx ld jz nh ka lf kc ni kd lh li bi translated">用法示例</h1><p id="9551" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我不会用沃霍尔的核心iOS SDK来完成人脸检测的过程，因为互联网上已经有一些很好的教程——例如<a class="ae mk" href="https://www.raywenderlich.com/1163620-face-detection-tutorial-using-the-vision-framework-for-ios" rel="noopener ugc nofollow" target="_blank">，这个</a>。然而，我将详细说明我们如何从相机和图像实例中用沃霍尔接口做同样的事情。正如您将看到的，我们可以用其中的几行代码替换几百行代码和类。</p><h2 id="6c18" class="nk ks iq bd kt nl nm dn kx nn no dp lb ls np nq ld lw nr ns lf ma nt nu lh nv bi translated">带摄像头</h2><p id="3f37" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在你要使用的文件中导入沃霍尔。创建一个<code class="fe ok ol om on b">CameraFaceDetectionViewController</code>的实例，并将将要绘制的视图分配给前者的<code class="fe ok ol om on b">cameraFrontView</code>属性。(我们马上就会看到如何绘制)。然后，您可以呈现视图控制器:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="f69e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为了绘图，我们应该创建一个符合沃霍尔协议FaceView的UIView的子类。给定更新后的视图模型属性，我们可以绘制他们的<code class="fe ok ol om on b">func draw(_ rect: CGRect)</code>函数。每当沃霍尔检测到人脸变化时，它就更新视图模型并在视图上调用<code class="fe ok ol om on b">setNeedsDisplay()</code>,这样它就可以触发绘制过程:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/10115c20c4116b42a0e679d3467b749e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*uU4omx2QQZKSxD4VxT_YtA.jpeg"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">一个被隔离的被沃霍尔提炼的我。绘图由客户端应用程序完成，在本例中是项目示例应用程序。</p></figure><p id="f5d9" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">您可以实施<code class="fe ok ol om on b">CameraFaceDetectionDelegate</code>协议来对人脸检测中的任何变化做出反应。当您不想在顶部绘制，而只想获得面部特征(界标)坐标时，这可能很方便。这些封装在给定参数<code class="fe ok ol om on b">FaceViewModel</code>中。</p><h2 id="2d0c" class="nk ks iq bd kt nl nm dn kx nn no dp lb ls np nq ld lw nr ns lf ma nt nu lh nv bi translated">带图像</h2><p id="556c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为了检测面部特征并在上面绘制，我们应该将描述面部的UIImageView传递给SDK，并在图像的上面绘制一个闭包:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="23a1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果不是修改过去的图像，而是希望生成一个新的UIImageView实例并保留原来的实例，请使用<code class="fe ok ol om on b">drawLandmarksInNewImage</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo op l"/></div></figure></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="6767" class="kr ks iq bd kt ku ne kw kx ky nf la lb jw ng jx ld jz nh ka lf kc ni kd lh li bi translated">源头</h1><p id="a08d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">要了解更多关于沃霍尔的信息并使用它，请访问<a class="ae mk" href="https://github.com/toupper/Warhol" rel="noopener ugc nofollow" target="_blank"> GitHub回购页面</a>。您可以通过CocoaPods、Carthage和Swift Package Manager将框架作为子报告添加到您的项目中。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h1 id="5513" class="kr ks iq bd kt ku ne kw kx ky nf la lb jw ng jx ld jz nh ka lf kc ni kd lh li bi translated">未来</h1><p id="8248" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这只是一个开始——在检测人脸时，有很多很酷的事情要做。下一个版本将会看到更多出色的特性，例如:</p><ul class=""><li id="881f" class="nw nx iq ll b lm mf lp mg ls ny lw nz ma oa me ob oc od oe bi translated">更多的面部标志被转换。</li><li id="cd12" class="nw nx iq ll b lm of lp og ls oh lw oi ma oj me ob oc od oe bi translated">像在Instagram或Snapchat Stories上一样，在顶部提供录制的视频和绘图。</li><li id="00f7" class="nw nx iq ll b lm of lp og ls oh lw oi ma oj me ob oc od oe bi translated">免费的过滤器，因此客户只需在一些有助于定制用户体验的图形中进行选择。</li></ul><p id="1b48" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">当然，我会感谢你对沃霍尔的贡献。PRs非常欢迎新的想法、改进、修正和建议。该项目受麻省理工学院许可，如有问题，请使用GitHub中的专用部分。在这个故事的第二部分中，你可以学习如何在检测到的人脸上简单地叠加。</p><p id="795e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">快乐的战争！😜</p></div></div>    
</body>
</html>