# Scala 几乎成功了

> 原文：<https://betterprogramming.pub/scala-almost-succeeded-c3b1028b02c5>

## 而且仍然有可能

![](img/951cd84a541a66596ee0a91632662adb.png)

Sherise 拍摄的照片。开[退溅](https://unsplash.com?utm_source=medium&utm_medium=referral)。

[Scala](https://www.scala-lang.org/) 是一种学术语言。它引起了业界的关注，因为它承诺在 Java 停滞不前的时候为多核计算机提供更好的可扩展性。

然后，在 2015 年左右，Scala 因为通用集群计算框架 Spark 而经历了高速增长。

所谓“成功”，我们指的是行业中使用 Scala 的开发人员的数量。如果 Redmonk 的评级和招聘广告的频率可以作为参考，Scala 已经进入了稳定期。也就是说，Scala 已经设法进入了几乎所有的 JVM 系统——即使系统中只有一部分是用 Scala 编写的库或框架。

这篇文章提供了一个观点，关于为什么 Scala 早期的成功可能会走到尽头，以及我认为 Scala 社区需要做些什么来回到成长阶段。

*免责声明:这不是对任何个人的攻击。如果你觉得我对你这个人有负面评价，请联系我，我会尽力让你放心。*

# 棘手问题

Scala 开发人员总是抱怨编译时间、工具质量，以及哪些语言特性太复杂而不能包含在他们的代码库中。

准确地说，开发人员抱怨缓慢的*构建*时间，这是从冷构建一个项目所需的时间。这还包括启动时间和解析/下载依赖关系。

对工具的抱怨可以是任何事情，从构建工具的复杂性到 IDE 中缺乏对高级语言特性的支持，再到发布项目的困难。

让大多数 Scala 开发人员害怕的事情——也是引起最激烈争论的事情——是不成形的泛型编程库的使用。我对此负有部分责任，因为我曾经举办过一场 Scala 交换研讨会来支持它的使用。我后悔了。请原谅我！

# 编译时间

2019 年，我们看到了 Lightbend 在编译性能上的良好进步:Scala 2.13 编译器是迄今为止最快的 Scala 编译器，专有的 GraalVM 技术可以让它更快。

值得称赞的是，在商业客户的帮助下，Lightbend 在微观优化上加倍努力。这是一个值得称赞的成就，因为 Lightbend 主要关心他们自己的产品，Scala 团队非常小(只有四个全职开发人员)，他们还负责 sbt 的维护。

对于任何需要更快编译的人来说，triplequote 的 Hydra 已经满足了你的需求。

Twitter 正在用 RSC(合理的 Scala 编译器)重写编译器，而 Kentucky Mule 是由一名前 Scala 编译器团队成员提出的，所以还有更多选择可以采用。

# 工具作业

EPFL 的学者们花了很长时间才承认编译时间和工具是个问题。 [Scala 中心](https://scala.epfl.ch/)成立于 2016 年，旨在“协调和开发开源库和工具，造福所有 Scala 用户。”

我是早期的支持者，但当他们花了前三年的时间在宠物项目和 vapourware 上，如 Scaladex、孢子、Scastie、Scala Native 和 Dotty，而不是解决迫在眉睫的问题时，我失去了信心。

2019 年，我们看到 Scala Center 交付了更多相关的项目:他们正在编写更快的构建工具、重构工具和 IntelliJ 的替代品。

不幸的是，他们缺乏工业工程经验，这表现在他们决定发明新的解决方案，而不是对生产中使用的现有工具做出贡献。例如，我们可以批评 bloop，指出除非在 sbt 中看到好处，否则没有人会受益。我们可以通过注意到 10%的 Scala 用户(大约 2018 年)正在使用 ENSIME 来批评 Metals 的创造，他们拒绝了数百名志愿者的贡献。

这遵循了重新发明的传统，可以追溯到 Scastie(重新发明 Scalafiddle)和 Scala Native(与 Graal 竞争)。如果 Scala 社区想要更好的工具，那么他们必须让 Scala 中心负起责任:他们的建立是为了“协调和开发”——而不是忽略现有的东西和开发新的东西。

我也可以说，如果社区想要更好的工具，那么他们就必须建造它，但是我不认为这对贡献他们时间的志愿者是公平的。这是一份全职工作，任何人都不应该为此牺牲家庭时间。

# 复杂性

2018 年，Jon Pretty 发布了白玉兰宏库。团队正在用简单的 Magnolia 替代程序替换他们最复杂的不成形的“类型类派生”代码，这可以快 100 倍地编译。

# 好看吗？

看看每个人对主要问题的反应，Scala 的情况很好！

Scala Center 和 Lightbend 正在交付价值，社区正在加紧弥补生态系统中的差距。那么为什么 Scala 会陷入停滞状态呢？这一切是不是太少了，太晚了？

我认为问题是多方面的:

1.  T4 很难雇佣到有经验的 Scala 开发者。
2.  Scala 在浪费时间，而 Java 已经赶上来了。
3.  Scala 3 和奥斯本效应。

# 很难雇佣 Scala 开发人员

高速增长阶段的一个后果是，绝大多数 Scala 开发人员都是相对初学者。这本身可以通过良好的培训来解决。但是 Scala 固有的复杂性意味着一个培训课程通常不足以让开发人员掌握所有的语言特性、运行时环境和支离破碎的生态系统。

Scala 的卖点之一是它与 Java 库兼容。这是一把双刃剑，因为虽然它有助于 Java 开发人员过渡到 Scala，但它让不懂 Java 的人更难学习 Scala。人们必须了解 JVM 才能使用大部分运行时工具(分析器、调试器、优化等)。).

Scala 的许多不同风格意味着雇佣或培训“Scala”人员是不够的。Play、Typelevel、Scalaz 都是非常不同的技术栈，在利基中创造利基。根深蒂固的政治已经导致这两大阵营渐行渐远。他们必须团结起来，而不是争斗。不幸的是，2019 年我们看到了相反的情况:Lightbend 和 Scala Center 主动将项目和个人排除在社区之外，因为他们贡献了“错误”的堆栈。

政治是如此肮脏，以至于 Scala 编译器团队的几个成员最近参与了一个著名贡献者的“无平台化”,他的主题演讲被从 Scala Days(更新:和 Scala eXchange)中删除，所有会议组织者都受到了压力。更新:一名前 Lightbend 高管呼吁抵制与该贡献者合作的招聘人员。

然后是 Typelevel。在我看来，它们是 Scala 社区发生的最糟糕的事情。他们是一个人数不多但很有发言权的少数群体，他们认为自己在道德上是优越的，代表着函数式编程社区。但是没有人选他们，很多人对此很不高兴。

这出戏本身就让人们远离了 Scala。对于贡献者来说，这也是一个巨大的阻碍，以免他们被视为选择了一方，或者更糟糕的是，发现自己无法就业。

# Java 已经赶上来了

Java 现在对并发和函数式编程有了更好的支持。有人提议在语言中加入模式匹配。

占全球智能手机 80%的安卓运行的是精简版的 Java。Scala 有意放弃对 Android 的支持，这意味着任何以世界上最大的应用商店为目标的开发者都必须寻找替代语言。许多人回到了 Java，而其他人则作为“更好的 Java”迁移到了 Kotlin。

我不知道 Scala 是否有计划再次支持 Android，但排除世界上最大的市场似乎是一个错误。

# 奥斯本效应

奥斯本效应是一个神话，奥斯本计算机公司在 20 世纪 80 年代倒闭了，因为他们发布了个人电脑的第三版，而第二版还在商店里。虽然是个神话，但效果非常真实。Scala 3 作为一个学术研究项目已经有近五年的时间了，代号为“Dotty ”,预计将在未来几年内推出。到那时，你所知道的 Scala 将会退役。那么，既然可以等到 Scala 3，并且在那之前用 Python 凑合，为什么还要投资 Scala 2 呢？

Scala 3 的变化如此巨大，以至于所有 Scala 开发人员都需要重新培训，所有代码库都需要进行迁移。个人联系人告诉我，他们的迁移评估范围从小型项目的“一个周末”到中型项目的一个月(10 万行代码)到大型项目的数年努力(数百万行代码)。这是假设自由软件生态系统已经被移植，这依赖于许多志愿者为共同的事业动员起来。

过去几年中所有的编译器和工具改进都将被抛弃。他们针对的是 Scala 2 编译器。甚至不清楚 ide 和文本编辑器是否准备好了(支持*重要空格*和新语法结构的努力不能被夸大，而且太低级了，LSP 无法解决)。

Scala 3 编译器比 Scala 2 编译器慢，并且不能构建核心生态系统库。作为一名社区志愿者贡献者，你需要重写你所有的项目，有些项目可能无法重写。空闲时间的缺乏会在生态系统中留下缺口。

对于维护遗留代码库的人来说，Scala 3 是一场噩梦。如果您无法承担将代码库重写到 Scala 3 的风险，该怎么办？很抱歉，但你将不得不继续使用 Scala 2，并支付额外费用来自己维护编译器和生态系统，你进入招聘池的机会将显著减少，因此你需要支付另一笔额外费用来吸引和留住人才。

我知道很多 Scala 开发人员和项目经理非常关心 Scala 3 的发展方向。不幸的是，官方的回应是加倍温和:负面谈论 Scala 是违反行为准则的(行为准则最初是为了抑制性别歧视的社区语气，但后来被用作政治武器)。因此，任何关于 Scala 3 的担忧都会遭到强烈反对，你将面临禁止在公共场合提出担忧的威胁。

Scala 社区中最热情的支持者试图羞辱和驳斥任何对 Scala 3 表示担忧的人，称他们为“有毒的巨魔”或“FUD”但这是真正的担忧，不应被忽视。辩论不应该被压制，个人不应该因为质疑估计数而被解雇或禁止。

能做些什么？我相信 Scala 社区需要大声地说出来，告诉 Scala 的学者和管理者改变 Scala 3 的名字。将其命名为“Dotty”，这是一种有自己改进过程的新语言。把 Scala 改进过程(SIP)的控制权交给业界，让我们通过共识来做事。

最初支持 Scala 3 的顶级生态系统贡献者已经恳求缩小范围，因为他们担心 Python 3 或 Perl 6 的重复。跟随他们的领导。

> “我看到一些激进的、大规模突破性的变革正在被提出，并在反对负面共识的情况下被推进。”—《快速解析》和《菊石》的作者