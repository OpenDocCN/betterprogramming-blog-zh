<html>
<head>
<title>A Simple Redux Guide for React Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React开发人员的简单Redux指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-simple-redux-guide-i-needed-1306d43b8783?source=collection_archive---------17-----------------------#2022-01-10">https://betterprogramming.pub/the-simple-redux-guide-i-needed-1306d43b8783?source=collection_archive---------17-----------------------#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7d7f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解Redux的构建模块</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b5b0e30ed69c722551b878e30941c756.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ctdNBgtD1jtbyiPX"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@lastnameeaster?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> La-Rel Easter </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="96ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Redux是一个状态管理工具，最常用于React或React Native。</p><p id="905c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我一年前第一次开始使用它时，它看起来有点复杂，但是只需要理解几件事情就可以打开所有的东西:存储、动作、Reducers以及挂钩<code class="fe ls lt lu lv b">useSelector</code>和<code class="fe ls lt lu lv b">useDispatch</code>。</p><p id="5bb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您正在使用<code class="fe ls lt lu lv b"><a class="ae kv" href="https://redux-toolkit.js.org/" rel="noopener ugc nofollow" target="_blank">@reduxjs/toolkit</a></code>库来减少样板文件(我强烈推荐)，那么就会为您生成与您的减少器名称相匹配的动作。</p><p id="940c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">困难在于Redux的数据是循环流动的，所以知道从哪里开始理解会很困难。我将讨论构建模块，然后通过一个简单的例子来说明如何使用它们。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="1d2c" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">积木</h1><h2 id="2180" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">商店</h2><p id="ad9f" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">先说最简单的概念:商店。Store保存一个状态，基本上就是一个大的JavaScript对象。</p><p id="87ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它是您的真实来源，包含您放入的任何内容(通常是您的应用程序状态)。</p><p id="fea1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只要你在通常放在层次结构顶端的<code class="fe ls lt lu lv b">Provider</code>组件中，就可以使用<code class="fe ls lt lu lv b">useSelector</code>钩子从任何地方读取它。</p><p id="4c15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，它不能被直接修改。要修改它，你需要一个减速器。</p><h2 id="ed2d" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">还原剂</h2><p id="1a94" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">减速器是来自<a class="ae kv" href="https://en.wikipedia.org/wiki/Fold_(higher-order_function)" rel="noopener ugc nofollow" target="_blank">功能编程</a>的概念，它执行以下简单工作:<code class="fe ls lt lu lv b">Current State + New Information =&gt; New State</code>。</p><p id="4c4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Redux中，reducers正是这样做的。它们可以被定义为一个带有两个参数的函数:存储的当前状态和一个动作(通常包含一个有效负载)。</p><p id="8557" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后它们输出一个新的状态，要么在使用vanilla redux时返回它，要么修改由<code class="fe ls lt lu lv b">@reduxjs/toolkit</code>提供的状态的一个特定的可变副本。输出的新状态由redux库本身而不是您的代码放入存储。</p><h2 id="8980" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">行动</h2><p id="ceca" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">动作是Reducers中的“新信息”。它们为Reducers提供了正确修改存储状态所需的信息(如果合适，也可以不修改)。</p><p id="6d3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果需要的话，动作可以有一个有效载荷来传递新的信息。</p><p id="30a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">行动需要被“分派”到商店，以便它们得到正确处理，这就是挂钩的作用所在。</p><p id="98bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当使用<code class="fe ls lt lu lv b">@reduxjs/toolkit</code>时，你将有函数来创建为你生成的动作，其方式与你的Reducers相匹配。</p><h2 id="6b3d" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">钩子:使用Dispatch和使用Selector</h2><p id="117c" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">钩子可以在组件或其他钩子上使用，但是网上有很多解释钩子的资源，所以我将把重点放在与Redux相关的资源上。</p><p id="9b5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了分派一个动作，你需要调用由<code class="fe ls lt lu lv b">useDispatch</code>钩子提供的<code class="fe ls lt lu lv b">dispatch</code>函数。这通常是通过您的UI组件来完成的。</p><p id="1fb3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">UI组件也可以使用<code class="fe ls lt lu lv b">useSelector</code>钩子从存储中读取状态。这允许组件监听存储状态的特定区域中的任何变化，并在发生变化时重新呈现。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="a536" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">示例流程</h1><p id="6255" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">现在我们知道了构造块，让我们看一个简单的例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/59b453f817e68ee83501cdf29f1be907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*QYo9XJxvO_bvudb1XHGAKQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Redux的简单银行web应用示例。由作者创作。</p></figure><h2 id="06a9" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">密码</h2><p id="f4cc" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">在这个例子中，我们有一个简单的银行web应用程序，您可以在其中向银行账户存钱和取钱。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f4ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下面的<code class="fe ls lt lu lv b">BankAccountRedux.tsx</code>第7行，你可以看到我们商店的初始状态是余额15。</p><p id="88d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还有2个Reducers，允许在第9-16行存款和取款。触发这些减速器的动作由<code class="fe ls lt lu lv b">@reduxjs/toolkit</code>(使用减速器的名称)为我们生成，并在第22行导出。</p><p id="8308" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ls lt lu lv b">Store.tsx</code>中，我们配置商店，然后在<code class="fe ls lt lu lv b">ReduxEnabledApp.tsx</code>的第7行，我们使用该商店。</p><p id="5b2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，在UI组件中，我们利用第14行上的<code class="fe ls lt lu lv b">useSelector</code>钩子来监听存储中的<code class="fe ls lt lu lv b">balance</code>变量的值，这样如果它改变了，我们就可以重新呈现<code class="fe ls lt lu lv b">App</code>组件。</p><p id="1623" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还在第15行使用了<code class="fe ls lt lu lv b">useDispatch</code>钩子，使UI组件能够向Reducers发送动作。我们在第22行和第26行上为动作提供了正确的有效负载，以存放10和提取4，它们被传递给适当的Reducers。</p><h2 id="6026" class="mv me iq bd mf mw mx dn mj my mz dp mn lf na nb mp lj nc nd mr ln ne nf mt ng bi translated">事件顺序示例</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/333299c37881d3f70d612415bc7815a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*shFCbLbQaFdPTmfrjf1wFg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用事件顺序示例的Redux数据流图。由作者在draw.io上创建。</p></figure><ol class=""><li id="4fff" class="nq nr iq ky b kz la lc ld lf ns lj nt ln nu lr nv nw nx ny bi translated">点击了“存款10”按钮</li><li id="6b90" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><code class="fe ls lt lu lv b">deposit</code>动作被<code class="fe ls lt lu lv b">dispatch</code>执行，有效载荷为10</li><li id="9bfd" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><code class="fe ls lt lu lv b">deposit</code>当前状态为<code class="fe ls lt lu lv b">{ balance: 15 }</code>且第2步动作时调用的减速器</li><li id="7aa4" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated">减速器更新状态为<code class="fe ls lt lu lv b">{ balance: 25 }</code>状态</li><li id="36ce" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><code class="fe ls lt lu lv b">useSelector</code>被通知存储状态中的<code class="fe ls lt lu lv b">balance</code>的改变</li><li id="0a26" class="nq nr iq ky b kz nz lc oa lf ob lj oc ln od lr nv nw nx ny bi translated"><code class="fe ls lt lu lv b">App</code>组件以25的平衡重新渲染</li></ol></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="04ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，这只是一个介绍，Redux领域还有很多东西需要了解，比如中间件、异步操作、副作用等等。但是他们都需要理解本文中的核心概念。有了这些工具，我希望您能立即更有效地管理您的应用程序状态。</p></div></div>    
</body>
</html>