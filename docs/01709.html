<html>
<head>
<title>Using a Picker in a SwiftUI List</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI列表中使用选择器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-a-picker-in-a-swiftui-list-ff33b2ce979a?source=collection_archive---------8-----------------------#2019-10-07">https://betterprogramming.pub/using-a-picker-in-a-swiftui-list-ff33b2ce979a?source=collection_archive---------8-----------------------#2019-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="104b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个能节省你时间的例子</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a6e1bada94371974e79a8dab3c67c96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTsFrFNywgcUqto8qpyKTQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae kv" href="https://unsplash.com/s/photos/to-do?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7ad4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我成为苹果注册开发者已经有十年了，在这段时间里我使用了几个版本的<a class="ae kv" href="https://developer.apple.com/xcode/interface-builder/" rel="noopener ugc nofollow" target="_blank">界面生成器</a> (IB)。当唯一的设备是iPhone时，这曾经是非常简单的。在其他设备开始出现的那一刻，生活开始变得艰难，限制开始积累。视图控制器成了编码和测试的噩梦。大约一年前，我发现了用更好的东西取代MVC架构的Clean Swift T7，并开始用它开发新的应用。起初，这是一个很大的进步，但后来…</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="4ff2" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">背景</h1><p id="ae54" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我看了一些WWDC19 <a class="ae kv" href="https://developer.apple.com/xcode/swiftui/" rel="noopener ugc nofollow" target="_blank"> SwiftUI </a>视频，心想:终于不再有庞大的视图控制器了。我被迷住了，所以我下载了最新的XCode测试版，并开始尝试学习SwiftUI。目前，我使用的是<a class="ae kv" href="https://developer.apple.com/news/releases/?id=10022019e" rel="noopener ugc nofollow" target="_blank"> Xcode版本11.2 beta </a>。不用说，它包含bug，文档仍然严重不足，视图编译需要一些时间来适应，尤其是有这么多通用代码的时候。WWDC的视频和样本代码是一个很好的资源，大量的教程已经开始出现在网上。SwiftUI实验室<a class="ae kv" href="https://swiftui-lab.com/welcome/" rel="noopener ugc nofollow" target="_blank">和SwiftUI的udemy.com课程</a><a class="ae kv" href="https://www.udemy.com/course/swiftui-declarative-interfaces-for-any-apple-device/" rel="noopener ugc nofollow" target="_blank">是一些很好的资源。</a></p><p id="175f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在开头提到，我开始使用Clean Swift构建一个新的应用程序。我现在正在将我到目前为止所做的工作转换到SwiftUI，这将我带到本教程的目的。我在Clean Swift版本中构建的一个对话使用了一个<em class="mw">选择器</em>作为表格的一部分，其方式与iCal中的事件对话完全相同。我喜欢日期选择器直到需要时才占用屏幕空间，尤其是在iPhone上。使用IB和控制器复制这一点并不容易。在SwiftUI中简单了很多，但仍然不简单。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="ee75" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">例子</h1><p id="dbb4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我写了一些示例代码来演示我使用的技术。它使用一个选择器从可见光谱中选择一种颜色。当前选择的颜色显示在两行列表中。在屏幕截图中，颜色“绿色”当前被选中，其名称显示为蓝色。下面是颜色被选择的次数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9a61a62172f83af1ec32b5f566fc1705.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*9f9DO4Q7Jpb2ndG53xBxQw.png"/></div></figure><p id="c352" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击颜色名称(上面显示为“绿色”),提货人会出现在它下面的行中，按下显示计数的行。颜色名称现在显示为红色。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/167d07f8f3880565c1cb7fb207f13d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*LqBzUJNkOt3jGUx7CsdhvA.png"/></div></figure><p id="e374" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选一种颜色，比如说，“靛蓝。”点击拾色器或红色显示的颜色名称会导致拾色器消失，显示新的颜色，并且计数增加1。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c0f945b6e9ee04cbe46887c0280edf72.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*b8ID3R06ab_x_uMn19mFyA.png"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3355" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">代码</h1><p id="6a21" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">那么这一切是怎么做到的呢？首先是变量:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/37831e62f1a7349d26251256053b23d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6PJVYuEIRERo6vAD_mxoA.png"/></div></div></figure><p id="5baa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有四个状态变量:</p><ul class=""><li id="da7d" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated"><code class="fe ni nj nk nl b">colours</code>:用于填充选取器的字符串数组</li><li id="53de" class="mz na iq ky b kz nm lc nn lf no lj np ln nq lr ne nf ng nh bi translated"><code class="fe ni nj nk nl b">selection</code>:用作选取器选择的整数</li><li id="1e2e" class="mz na iq ky b kz nm lc nn lf no lj np ln nq lr ne nf ng nh bi translated"><code class="fe ni nj nk nl b">pickerVisible</code>:当选取器可见时，布尔值设置为“真”</li><li id="3de4" class="mz na iq ky b kz nm lc nn lf no lj np ln nq lr ne nf ng nh bi translated"><code class="fe ni nj nk nl b">count</code>:拾取器选择次数的计数。</li></ul><p id="cbca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是<code class="fe ni nj nk nl b">ContentView</code>主体的代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/fdca9953c7edc35b64125de489e41bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnqTOG-DAWej6d1usNkCrA.png"/></div></div></figure><p id="4a6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这由两个元素的VStack组成:显示标题的文本视图和包含颜色、Picker和计数行的列表视图。</p><p id="6ff5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">列表的第一行是一个<code class="fe ni nj nk nl b">HStack</code>，由行描述和按钮视图组成。按钮的闭合有两个作用:</p><ol class=""><li id="c7cd" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nr nf ng nh bi translated">测试机械臂是否可见，如果可见，则增加<code class="fe ni nj nk nl b">count</code>。</li><li id="3f17" class="mz na iq ky b kz nm lc nn lf no lj np ln nq lr nr nf ng nh bi translated">切换<code class="fe ni nj nk nl b">pickerVisible</code>布尔值。</li></ol><p id="6d04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击按钮，执行关闭并重建<code class="fe ni nj nk nl b">ContentView</code>。</p><p id="2830" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe ni nj nk nl b">HStack</code>之后，有一个条件语句测试<code class="fe ni nj nk nl b">pickerVisible</code>的值。如果它的值为<code class="fe ni nj nk nl b">true</code>，<em class="mw">，</em>，则包含一个<code class="fe ni nj nk nl b">HStack</code>，它包含了提货人。选取器的第一个参数是绑定变量<code class="fe ni nj nk nl b">selection</code>，第二个是标签(此处为空)，第三个是遍历<code class="fe ni nj nk nl b">colours</code>数组的闭包，为每个元素创建文本视图。值得指出的是，很容易将<code class="fe ni nj nk nl b">ForEach</code>与数组方法<code class="fe ni nj nk nl b">forEach</code>混淆。这里<code class="fe ni nj nk nl b">ForEach</code>生成视图；事实上，在SwiftUI中，视图无处不在。</p><p id="bf2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Picker视图附加了修饰符<code class="fe ni nj nk nl b">onTapGesture</code> <em class="mw"> </em>(修饰符实际上是属于视图的函数)。这有一个增加<code class="fe ni nj nk nl b">count</code>和切换<code class="fe ni nj nk nl b">pickerVisible</code>的闭包。当视图再次重建时，选取器消失。</p><p id="8f67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，还有另一个包含显示<code class="fe ni nj nk nl b">count</code>的行的<code class="fe ni nj nk nl b">HStack</code>。</p><p id="9042" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。我希望这个小例子可以节省一些人的时间。</p></div></div>    
</body>
</html>