<html>
<head>
<title>Does Variable Name Length Affect JavaScript Code Speed?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">变量名长度影响JavaScript代码速度吗？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/does-variable-name-length-affect-javascript-code-speed-bedc3cf592a8?source=collection_archive---------12-----------------------#2022-09-05">https://betterprogramming.pub/does-variable-name-length-affect-javascript-code-speed-bedc3cf592a8?source=collection_archive---------12-----------------------#2022-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="69f0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">程序大小很重要。有点儿</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14a8553e3f087f24c2af0f5507f89278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CPaozt2920JyCOvr"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@deonblack?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迪昂布莱克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您已经编程一段时间了，那么您可能会遇到以下问题:变量名的长度是否会以任何方式影响代码的运行时性能？</p><p id="bce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">起初，这似乎是一个愚蠢的问题。毕竟，除了老派的C开发人员，世界上有谁会选择模糊的三个字母的变量名而不是更具描述性和可读性的标识符呢？然而，这是一个合理的问题，它开启了学习一些有趣概念的可能性，您可能会发现这些概念在您的软件开发之旅中很有用。</p><p id="4df4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当编程语言源代码被编译成机器代码时，变量的概念就失去了意义。剩下的所有对象、类、函数和所有这些高级概念只是内存地址、跳转指令和简单的操作。特别是，变量被转换成内存地址和偏移量。</p><p id="7b29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，JavaScript通常不直接编译成机器代码，而是由一个JavaScript引擎解释，比如谷歌的<a class="ae ky" href="https://v8.dev/" rel="noopener ugc nofollow" target="_blank"> V8 </a>。JavaScript代码的执行管道相当复杂:引擎必须创建适当的执行上下文和范围链，解析源代码并将其编译成可执行的字节码，以便虚拟机运行。freeCodeCamp在他们的文章“<a class="ae ky" href="https://www.freecodecamp.org/news/execution-context-how-javascript-works-behind-the-scenes" rel="noopener ugc nofollow" target="_blank"> JavaScript执行上下文——JS如何在幕后工作</a>”中很好地解释了这个过程，作者是<a class="ae ky" href="https://www.freecodecamp.org/news/author/victor-ikechukwu/" rel="noopener ugc nofollow" target="_blank"> Victor Ikechukwu </a>。</p><p id="e011" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将探讨变量名的长度如何影响程序的性能。</p><h1 id="81a6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">速度基准</h1><p id="eaf9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，让我们做一个性能基准测试，看看是否有任何明显的差异。对于这个测试，我编写了一个简单的JavaScript脚本，比较两个函数的执行速度:<code class="fe ms mt mu mv b">short_name</code>和<code class="fe ms mt mu mv b">long_name</code>。前者使用简短的单字母变量名，而后者使用16k字节长的名称。如果有任何速度差异，这个大差距应该会很明显。</p><p id="9934" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于基准测试，我使用了<code class="fe ms mt mu mv b">benchmark</code>库的高分辨率计时器和具有统计意义的结果。请注意，这里我用较短的名称替换了16kb的名称，这样您就不必下载无用的大文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d2d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是基准测试结果:</p><pre class="kj kk kl km gt my mv mz na aw nb bi"><span id="9e18" class="nc lw it mv b gy nd ne l nf ng">Short name x 523 ops/sec ±0.95% (89 runs sampled)<br/>Long name x 521 ops/sec ±1.00% (88 runs sampled)<br/>The fastest option is Short name,Long name</span></pre><p id="db45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，这两个函数在速度上似乎没有什么区别。然而，还不要停止阅读:有趣的部分现在就来了。让我们更深入地研究JavaScript如何处理变量。</p><h1 id="ae13" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">分析字节码</h1><p id="6571" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">正如我之前提到的，JavaScript在执行之前被编译成字节码。为了比较这两个函数的字节码，我将它们分成两个独立的文件。此外，长变量名每个都是一兆字节，以进一步强调任何差异。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="8aee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了生成V8字节码，我使用了<code class="fe ms mt mu mv b"><a class="ae ky" href="https://github.com/bytenode/bytenode" rel="noopener ugc nofollow" target="_blank">bytenode</a></code>，这是一个用JavaScript编写的Node.js的极简字节码编译器。要编译JavaScript源代码，请键入以下命令:</p><pre class="kj kk kl km gt my mv mz na aw nb bi"><span id="c68d" class="nc lw it mv b gy nd ne l nf ng">npx bytenode -c short_name.js<br/>npx bytenode -c long_name.js</span></pre><p id="784b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会生成两个字节码文件:<code class="fe ms mt mu mv b">long_name.jsc</code>和<code class="fe ms mt mu mv b">short_name.jsc</code>。现在，让我们用<code class="fe ms mt mu mv b">du</code>打印文件大小，看看是否有什么不同。毕竟，变量名应该还在。</p><pre class="kj kk kl km gt my mv mz na aw nb bi"><span id="3b3a" class="nc lw it mv b gy nd ne l nf ng">du short_name.jsc long_name.jsc -h --apparent-size</span><span id="e8a8" class="nc lw it mv b gy nh ne l nf ng">840 short_name.jsc<br/>978K long_name.jsc</span></pre><p id="7936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，大小有很大的差异:后者大约大1000倍。如果我们用十六进制编辑器(我用的是VSCode内置编辑器)检查字节码，我们应该可以找到变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/8f2b683c43364467c54e87a63969d03b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s7SEqvkjaDtI5QI9ad_y2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简称. jsc</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/9677a3d665bad99812cb7d3eaf8b8eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mURjRi9YCxIU6-ujKL0ZgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">long_name.jsc</p></figure><p id="cfba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，变量名仍然存在。然而，符号名(变量、函数……)在字节码中只存储一次，然后使用偏移量和地址而不是它们的ASCII名来引用。因此，<code class="fe ms mt mu mv b">long_name.jsc</code>大约有一兆字节大:long <code class="fe ms mt mu mv b">l</code>变量的长度。同样，for循环中使用的<code class="fe ms mt mu mv b">i</code>也消失了。老实说，我对JavaScript了解不多，无法解释为什么字节码中没有<code class="fe ms mt mu mv b">i</code>。我想这是一种优化。</p><h1 id="68a8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">运行时基准测试</h1><p id="9404" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在您知道了两个生成的字节码文件之间有很大的差异，您可能想知道它们的运行时性能是如何相同的。在之前的基准测试中，只有在整个程序被加载到内存中并被JavaScript引擎读取后，计时器才会启动。</p><p id="46c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们调用<code class="fe ms mt mu mv b">short_name.js</code>和<code class="fe ms mt mu mv b">long_name.js</code>末尾的函数，并使用<code class="fe ms mt mu mv b">time</code>实用程序执行速度测试，我们应该会看到不同之处:</p><pre class="kj kk kl km gt my mv mz na aw nb bi"><span id="bf84" class="nc lw it mv b gy nd ne l nf ng">time node long_name.js</span><span id="f6f0" class="nc lw it mv b gy nh ne l nf ng">real 0m0,132s<br/>user 0m0,111s<br/>sys 0m0,021s</span><span id="0f3b" class="nc lw it mv b gy nh ne l nf ng">time node short_name.js</span><span id="c8e8" class="nc lw it mv b gy nh ne l nf ng">real 0m0,058s<br/>user 0m0,048s<br/>sys 0m0,011s</span></pre><p id="c490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，这是有区别的。测量程序从启动到退出需要多长时间。这还包括从磁盘读取文件以及JavaScript引擎通过每个字节执行代码所花费的时间。当然，字节越多，处理它们的时间就越长。</p><p id="0da6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至于之前的基准测试，正如我提到的，没有性能差异，因为一旦加载，这些符号就像数组元素一样通过偏移量和地址来访问，所以没有对它们名称的引用。</p><h1 id="cd28" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="78a2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后，我们已经看到了程序大小如何影响代码的运行时性能。然而，本文中的例子是你在职业生涯中可能不会遇到的极端情况。此外，一旦程序被加载，由于字节码中处理符号的方式，不会有任何性能差异。</p><p id="94e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，你不应该为了更小的文件而牺牲源代码的可读性。一个恰当的描述性变量名总是比一个三个辅音的单词好，就像老派的C开发人员在使用电传打字机和纸张时所做的那样(现在仍有一些人这样做)。</p><p id="da3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你特别热衷于保持文件尽可能小，例如，为了在互联网上更快地传输，你总是可以利用<a class="ae ky" href="https://en.wikipedia.org/wiki/Minification_(programming)" rel="noopener ugc nofollow" target="_blank">缩小</a>，这是在不改变其功能的情况下从源代码中删除所有不必要的字符的过程，从而降低带宽使用率并减少网站的加载时间。</p><p id="36b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，变量名长度影响JavaScript执行速度吗？是的，至少理论上是这样。实际上，这并没有什么明显的区别。</p><p id="16e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。如果你有什么要补充的，请在评论中分享你的想法。感谢阅读！</p><p id="d156" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您对增强您的JavaScript代码库感兴趣，请看看下面这个故事:</p><div class="nk nl gp gr nm nn"><a rel="noopener  ugc nofollow" target="_blank" href="/why-i-migrated-from-javascript-to-typescript-again-69819a55daab"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">为什么我再次从JavaScript迁移到TypeScript</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">TypeScript的好处以及何时应该迁移到它</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">better编程. pub</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ks nn"/></div></div></a></div></div></div>    
</body>
</html>