<html>
<head>
<title>How to Do Sentiment Analysis in a Python App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python应用程序中进行情感分析</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-do-sentiment-analysis-in-a-python-app-bde0470bb466?source=collection_archive---------14-----------------------#2020-03-17">https://betterprogramming.pub/how-to-do-sentiment-analysis-in-a-python-app-bde0470bb466?source=collection_archive---------14-----------------------#2020-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4295" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建嵌入在GUI中的意见挖掘模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/55c29c0397ce7a11f9d2f6722ae7bb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wb2AFmYit23DCOoRqAOpdQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯尔·格伦在<a class="ae ky" href="https://unsplash.com/s/photos/feelings?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d64d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在互联网和社交媒体时代，人们的真实意见正在成为营销和政治的基本资源。</p><p id="4ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">反馈有助于公司改善服务，但是，对于一个人来说，手动分析数以百万计的反馈是不可能的。此外，一个人会犯很多错误。</p><p id="6442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了避免这种风险并节省金钱和时间，公司开发了<em class="lv">情绪分析AI </em>，也称为<em class="lv">意见挖掘</em>。</p><p id="1f2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">观点挖掘是自然语言处理的一个热门分支，其目的是分析文档的极性。情感分析最常见的任务之一是基于作者表达的观点和情感的文档分类。</p><p id="96e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果一位政治家想知道他们在人们中的受欢迎程度，开始调查以查看结果，并将意见分为积极或消极，他们将使用意见挖掘模型。</p><p id="fb3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个简短的介绍给我们一个主题的概述之后，让我们看看我们在这个教程中要做什么:</p><ul class=""><li id="c7bc" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">首先，我们将创建一个简单的情感分析模型，对电影评论进行分类(正面或负面)。</li><li id="ffbe" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">然后，我们将把模型嵌入到图形应用程序中。</li><li id="7436" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">作为本教程的总结，我将提出一些想法来使分类器适应其他用途。</li></ul><p id="a7a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们开始之前，我建议您注意代码上的注释。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="24c1" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">下载数据集</h1><p id="2851" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在本教程中，我们将使用IMDB的电影评论数据集。</p><p id="1683" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以从<a class="ae ky" href="https://www.dropbox.com/s/sxdfxweepcfu1jz/movie_s_a_dataset.csv.gz?dl=0" rel="noopener ugc nofollow" target="_blank"> Dropbox </a>下载。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ca7f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">创建模型</h1><p id="a2d8" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">这些是您需要的Python包:</p><ul class=""><li id="75f8" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><a class="ae ky" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank">泡菜</a></li><li id="95d6" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://docs.python.org/3/library/re.html" rel="noopener ugc nofollow" target="_blank">回复</a></li><li id="4aae" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">熊猫</li><li id="07de" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://pypi.org/project/nltk/" rel="noopener ugc nofollow" target="_blank"> NLTK </a></li><li id="64b4" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://pypi.org/project/sklearn/" rel="noopener ugc nofollow" target="_blank"> sklearn </a></li><li id="921d" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank"> os </a></li></ul><p id="0ca5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了构建我们的模型，我们将使用核外学习技术，这有助于我们处理大型数据集，避免高计算成本。</p><p id="05fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为分类器，我们会使用<a class="ae ky" href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn的SGDClassifier </a> <em class="lv"> </em>(随机梯度下降分类器)，我们会将其序列化(保存)在一个. pkl文件中。</p><p id="67e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们编码吧！</p><h2 id="2166" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">Pkl_builder.py</h2><p id="5f1b" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">该文件创建并序列化SGDClassifier。</p><p id="ff22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们导入所需的模块并下载<code class="fe oa ob oc od b">stopwords</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="9904" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是什么是停用词呢？</p><p id="0c4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">停用词是那些在英语中非常常见的词，并且不包含关于文本的重要信息，所以最好识别并删除它们。</p><p id="6d36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们分析文档之前，我们需要清理它们:我们删除所有不想要的字符，并通过regex(正则表达式)库识别表情符号:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="c5d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们创建矢量器，它将文本转换成可分析的数据，以及分类器<strong class="lb iu"> <em class="lv"> </em> </strong>(我之前说过的随机梯度下降分类器):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="6415" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，我们即将完成情感分析模型的创建，但在此之前，我们必须训练它并将其保存在一个<code class="fe oa ob oc od b">.pkl</code>文件中。请注意，我们还将对之前下载的停用词进行序列化:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="d45e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码将创建<code class="fe oa ob oc od b">classifier.pkl</code>和<code class="fe oa ob oc od b">stopwords.pkl</code>文件。</p><p id="d4b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的目录应该是这样的:</p><h2 id="def6" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">目录树</h2><pre class="kj kk kl km gt og od oh oi aw oj bi"><span id="9271" class="no ms it od b gy ok ol l om on">/movieclassifier    <br/>    /pkl_objects        <br/>        classifier.pkl        <br/>        stopwords.pkl    <br/>    pkl_builder.py</span></pre><p id="6687" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经创建了我们的模型。来测试一下吧！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="1d63" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">测试我们的模型</h1><p id="a30c" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在上一步中，我们构建并序列化了分类器；现在我们要测试它。但在此之前，我们必须创建矢量器。等等，我们不是已经创造出来了吗？</p><p id="ebeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我们做了，但是我们创建了矢量器来训练模型，而不是测试它。幸运的是，代码相当相似，我们唯一要做的就是用下面的代码创建一个<strong class="lb iu"> </strong> <code class="fe oa ob oc od b">vectorizer.py</code> <em class="lv"> </em>文件。</p><h2 id="4cb8" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">矢量器. py</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="c445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，这段代码与我们之前开发的代码相同，只是它使用了我们之前创建的停用词文件。</p><p id="b6b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了测试代码，您需要创建另一个名为<code class="fe oa ob oc od b">model_test.py</code> <em class="lv"> </em>的Python文件，并键入以下代码。</p><h2 id="979d" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">模型_测试. py</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="abfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们加载了分类器文件并定义了我们的分类函数，其中X变量是矢量化的文档(转换成可分析数据的文档)。<strong class="lb iu"> <em class="lv"> </em> </strong> <em class="lv"> y变量</em>是我们的模型对收到的评论做的预测。</p><p id="1e21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后它将短语“我喜欢这部电影。完美。”并打印我们模型的预测和预测正确的概率。</p><p id="b1fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你的目录现在应该的样子。</p><h2 id="b43f" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">目录树</h2><pre class="kj kk kl km gt og od oh oi aw oj bi"><span id="17c7" class="no ms it od b gy ok ol l om on">/movieclassifier    <br/>    /pkl_objects       <br/>        classifier.pkl       <br/>        stopwords.pkl    <br/>    pkl_builder.py<br/>    model_test.py    <br/>    vectorizer.py</span></pre><p id="3f52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试一下！</p><p id="aa65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开您的终端(UNIX用户)或命令提示符(Windows用户),然后:</p><ol class=""><li id="e3fd" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu oo mc md me bi translated">进入<code class="fe oa ob oc od b">/movieclassifier</code>目录。</li><li id="d1a7" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu oo mc md me bi translated">通过键入:<code class="fe oa ob oc od b">python model_test.py</code>执行我们之前创建的脚本。</li></ol><p id="1f1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有用！厉害！</p><p id="034d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们准备将模型嵌入到图形应用程序中。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="37ce" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">将模型嵌入图形应用程序</h1><p id="fd4d" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">为了将模型嵌入到应用程序中，我们将使用<a class="ae ky" href="https://kivy.org/" rel="noopener ugc nofollow" target="_blank"> Kivy </a> Python包，所以我们需要先安装它:<code class="fe oa ob oc od b">pip install kivy</code>。</p><p id="2b6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，我们可以开始编码了！</p><h2 id="e4be" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated"><strong class="ak"> App.py(位于/movieclassifier目录中)</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="868b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们导入所需的模块。之后，我们加载我们的分类器并粘贴我们在<code class="fe oa ob oc od b">model_test.py</code>中定义的分类函数。</p><p id="95ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将创建Kivy应用程序。请记住，要彻底理解代码，还得看注释。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="7fd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们刚刚将模型嵌入到kivy应用程序中。</p><p id="22de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在执行<code class="fe oa ob oc od b">app.py</code>，你将看到魔法！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="0b8c" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="7625" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">你做到了，你创建了自己的观点挖掘模型，你可能想知道之后该做什么。我可能有一些建议给你。</p><ul class=""><li id="ed40" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">增强应用程序的图形，还有很多需要改进的地方。</li><li id="1fb8" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">将模型应用于其他目的。为此，您必须使用不同的数据集执行<code class="fe oa ob oc od b">pkl_builder.py</code>文件。您可以使用<code class="fe oa ob oc od b">dataset.csv</code>来代替<code class="fe oa ob oc od b">movie_s_a_dataset.csv</code>，这将使用另一个数据集来训练模型。例如，新款<code class="fe oa ob oc od b">dataset.csv</code>可能是这样的:</li></ul><pre class="kj kk kl km gt og od oh oi aw oj bi"><span id="999c" class="no ms it od b gy ok ol l om on">review,sentiment<br/>"I really liked this amazon product, the quality is good and the delivery was ok.", 1<br/>"Bad, really bad, when I got the product it was broken.", 0</span></pre><p id="3a4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，要创建一个像样的工作模型，数据集必须有至少2000个或更多的评论。事实上，我们之前使用的数据集大约有25，000条评论。</p></div></div>    
</body>
</html>