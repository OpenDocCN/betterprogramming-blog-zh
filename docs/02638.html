<html>
<head>
<title>Create a Custom Input for Ion-Select</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为离子选择创建自定义输入</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/custom-input-in-ion-select-with-ionic-4-angular-8-daafe44c0f55?source=collection_archive---------4-----------------------#2019-12-14">https://betterprogramming.pub/custom-input-in-ion-select-with-ionic-4-angular-8-daafe44c0f55?source=collection_archive---------4-----------------------#2019-12-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc92" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建适合您应用的独特产品</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f4a50aa17c9b72b493670e2fc25d1227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRxjvDlL52z1gXhZm2mm-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义离子选择输入</p></figure><p id="13ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文介绍了在Ionic 4/Angular 8应用程序中为'<a class="ae lu" href="https://ionicframework.com/docs/api/select" rel="noopener ugc nofollow" target="_blank"> ion-select </a>'组件实现自定义输入字段的方法，默认情况下，该组件不允许编辑其中的选项。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6d3c" class="ma mb it lw b gy mc md l me mf">&lt;ion-item&gt;<br/>  &lt;ion-label&gt;Hair Color&lt;/ion-label&gt;<br/>  &lt;ion-select&gt;<br/>    &lt;ion-select-option selected&gt;Custom&lt;/ion-select-option&gt;<br/>    &lt;ion-select-option&gt;Brown&lt;/ion-select-option&gt;<br/>    &lt;ion-select-option&gt;Dark&lt;/ion-select-option&gt;<br/>  &lt;/ion-select&gt;<br/>&lt;/ion-item&gt;</span></pre><p id="27a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的离子选择组件允许从Ionic 4应用程序的三个可用选项中选择一个。有一个用例，我们希望用户能够真正输入他们想要的选项。我们将通过为离子选择流添加<a class="ae lu" href="https://ionicframework.com/docs/api/alert" rel="noopener ugc nofollow" target="_blank">警报控制器</a>来实现平稳的UX之旅。</p><p id="79d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先介绍一些有助于我们构建方法和定义范围的内容:</p><ol class=""><li id="b801" class="mg mh it la b lb lc le lf lh mi ll mj lp mk lt ml mm mn mo bi translated">首先，允许用户添加他们的自定义值意味着我们的<strong class="la iu"> </strong>应该在我们的模板中支持n个<strong class="la iu"> </strong> <code class="fe mp mq mr lw b">&lt;ion-select-options&gt;</code>，所以我们必须使用<code class="fe mp mq mr lw b">*ngFor</code>指令并将当前的一组值存储在我们的类(ts文件)中。</li><li id="9298" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt ml mm mn mo bi translated">我们应该确保用户所做的所有更改都被Angular拾取，并适时地呈现在模板中(我们将在警报控制器模式处理中看到这意味着什么)。</li><li id="5596" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt ml mm mn mo bi translated">如果用户选择了“自定义”选项，但随后取消了新选项的创建，我们应该考虑回退方案。</li><li id="5623" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt ml mm mn mo bi translated">最后，我们应该理解在这个范围内我们不能提供“删除”自定义选项功能的限制。如果我们需要允许它，我们可能需要另一个UI小部件来处理这样的场景，所以这超出了本文的范围。</li></ol></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="c92c" class="ma mb it bd ne nf ng dn nh ni nj dp nk lh nl nm nn ll no np nq lp nr ns nt nu bi translated">步骤1: <a class="ae lu" href="https://stackblitz.com/edit/ionic-4-template" rel="noopener ugc nofollow" target="_blank">启动一个新的Ionic 4模板</a>并修改你的<code class="fe mp mq mr lw b">home.page.ts</code>:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dfbf" class="ma mb it lw b gy mc md l me mf">import { Component } from '@angular/core'; <br/>import { AlertController } from '@ionic/angular';</span><span id="4ee1" class="ma mb it lw b gy nv md l me mf"><a class="ae lu" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-home',<br/>  templateUrl: 'home.page.html'<br/>})</span><span id="0a32" class="ma mb it lw b gy nv md l me mf">export class HomePage {</span><span id="020c" class="ma mb it lw b gy nv md l me mf">  public colors: Array&lt;string&gt;;</span><span id="53f2" class="ma mb it lw b gy nv md l me mf">  public currentColor: string;</span><span id="b761" class="ma mb it lw b gy nv md l me mf">  constructor(public alertController: AlertController) {}</span><span id="ebd5" class="ma mb it lw b gy nv md l me mf">  ngOnInit() {<br/>    this.colors = ["Custom", "Brown", "Dark"];<br/>    this.currentColor = "Brown";<br/>  };</span><span id="a87d" class="ma mb it lw b gy nv md l me mf">}</span></pre><p id="ec10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们导入AlertController并通过构造函数注入它，然后声明两个属性及其类型:<strong class="la iu"> colors </strong>和<strong class="la iu"> currentColor </strong>。</p><p id="f86c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，在onInit hook中，我们为这些属性赋予初始值。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="98b6" class="ma mb it bd ne nf ng dn nh ni nj dp nk lh nl nm nn ll no np nq lp nr ns nt nu bi translated">步骤2:我们添加ion-select，通过*ngFor添加复制，并在home.page.html中添加所有必要的绑定:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2559" class="ma mb it lw b gy mc md l me mf">&lt;ion-header&gt;<br/> &lt;ion-toolbar color="primary"&gt;<br/>  &lt;ion-title&gt;<br/>   Ion-select with custom input<br/>  &lt;/ion-title&gt;<br/> &lt;/ion-toolbar&gt;<br/>&lt;/ion-header&gt;</span><span id="250a" class="ma mb it lw b gy nv md l me mf">&lt;ion-content padding&gt;</span><span id="cab0" class="ma mb it lw b gy nv md l me mf">&lt;ion-item&gt;<br/>    &lt;ion-label&gt;Hair Color&lt;/ion-label&gt;<br/>    &lt;ion-select #mySelect [value]="currentColor" [selectedText]="currentColor" (ionChange)="selectChanged(mySelect.value)"&gt;<br/>      &lt;ion-select-option *ngFor="let color of colors" [selected]="color === currentColor"&gt;{{ color }}&lt;/ion-select-option&gt;<br/>    &lt;/ion-select&gt;<br/>  &lt;/ion-item&gt;</span><span id="9358" class="ma mb it lw b gy nv md l me mf">&lt;/ion-content&gt;</span></pre><p id="7974" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一些亮点:</p><ul class=""><li id="4c6b" class="mg mh it la b lb lc le lf lh mi ll mj lp mk lt nw mm mn mo bi translated">我们将“value”和“selectedText”属性绑定到同一个currentColor属性，以确保呈现的内容和选择的内容一致。</li><li id="dcd7" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt nw mm mn mo bi translated">我们添加了(ionChange)事件绑定，这样我们就可以处理home.page.ts中的所有选项更改。</li><li id="cfce" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt nw mm mn mo bi translated">最后，我们利用*ngFor指令，使用我们拥有的“colors”数组复制颜色选项，并绑定“selected”属性，以确保用户可以看到哪个选项已经被选中。</li></ul></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="0e48" class="ma mb it bd ne nf ng dn nh ni nj dp nk lh nl nm nn ll no np nq lp nr ns nt nu bi translated">步骤3:我们在home.page.ts中实现方法来支持我们利用AlertController的用例:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a732" class="ma mb it lw b gy mc md l me mf">  selectChanged(selectedColor) {<br/>    if (selectedColor === 'Custom') {<br/>      this.inputCustomColorValue()<br/>    } else {<br/>      this.currentColor = selectedColor;<br/>    };<br/>  };</span></pre><p id="6a8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们添加了“selectChanged”方法，它运行在非常简单的逻辑上:</p><ul class=""><li id="94cd" class="mg mh it la b lb lc le lf lh mi ll mj lp mk lt nw mm mn mo bi translated">从我们的模板代码中接收“selectedColor”。</li><li id="5aec" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt nw mm mn mo bi translated">如果我们的用户选择“自定义”颜色，我们希望在另一个方法inputCustomColorValue()中处理进一步的交互。</li><li id="a5c8" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt nw mm mn mo bi translated">“else”意味着我们只需更新currentColor值，模板中的属性绑定将处理其余部分，向用户显示正确的新值。</li></ul><p id="fa30" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们实现我们的自定义输入法:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f4e5" class="ma mb it lw b gy mc md l me mf">async inputCustomColorValue() {</span><span id="1bab" class="ma mb it lw b gy nv md l me mf">  const inputAlert = await this.alertController.create({<br/>    header: 'Enter your custom color:',<br/>    inputs: [ { type: 'text', placeholder: 'type in' } ],<br/>    buttons: [ { text: 'Cancel' }, { text: 'Ok' } ]<br/>  });</span><span id="c2e3" class="ma mb it lw b gy nv md l me mf">inputAlert.onDidDismiss((data) =&gt; {<br/>    let customColorName: string = data.data.values[0];<br/>    if (customColorName) {<br/>      let indexFound = this.colors.findIndex(color =&gt; color === customColorName)<br/>      if (indexFound === -1) {<br/>        this.colors.push(customColorName);<br/>        this.currentColor = customColorName;<br/>      } else {<br/>        this.currentColor = this.colors[indexFound];<br/>      };<br/>    };      <br/>  })</span><span id="f0bc" class="ma mb it lw b gy nv md l me mf">  await inputAlert.present();<br/>    <br/>};</span></pre><p id="7acf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们使用AlertController创建一个简单的文本输入警报，然后在onDidDismiss方法中处理用户交互的结果。一些注意事项:</p><ul class=""><li id="aa03" class="mg mh it la b lb lc le lf lh mi ll mj lp mk lt nw mm mn mo bi translated">我们使用onDidDismiss vs. button handler，因为我们希望Angular拾取数据中的变化。如果这些变化发生在警报控制器组件内部——我们将不得不付出额外的努力来更新我们的组件绑定(触发变化检测，或者在角度区域内显式运行处理程序，等等)。</li><li id="4622" class="mg mh it la b lb ms le mt lh mu ll mv lp mw lt nw mm mn mo bi translated">我们利用“indexFound”来检查这样的“颜色”是否已经存在，我们没有将这样的颜色添加到我们的“颜色”数组中，但仍然允许用户选择它。</li></ul></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="5cce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样。我们已经完全实现了我们想要实现的功能。在这里:<a class="ae lu" href="https://ionic-4-template-cb2wbk.stackblitz.io" rel="noopener ugc nofollow" target="_blank">https://ionic-4-template-CB 2 wbk . stack blitz . io</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a3fc3c7502c250aa97f5ef69c86c6e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/1*V_l6Oc8qGs7w4S_fikaKgg.gif"/></div></figure></div></div>    
</body>
</html>