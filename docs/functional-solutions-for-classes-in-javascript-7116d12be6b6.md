# JavaScript 中类的函数式解决方案

> 原文：<https://betterprogramming.pub/functional-solutions-for-classes-in-javascript-7116d12be6b6>

## 在 JavaScript 中处理对象的更好方法

![](img/f53dd8d312f1917fe53edecc9addd04c.png)

照片由[海梅·斯巴尼奥](https://unsplash.com/@jaimespaniol?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

JavaScript 不是经典的面向对象语言。它是面向原型的。他们都旨在用不同的方式解决同样的问题。两者各有利弊。

但是由于历史原因，JavaScript 需要看起来和感觉上像 Java，正如你从名字中看到的那样。出于各种原因，主要是市场营销，即使没有类，它也需要具有与 Java 相似的面向对象的特性。

在 ES2015 中，JavaScript 中终于引入了类语法。一场大狂欢！但是这种快乐并没有持续多久，因为它只是对原型遗传的一种掩饰。

同样的怪癖仍然存在，尽管用 JavaScript 的类来编写和阅读 OOP 要容易得多。

有很多关于在 JavaScript 中使用类的讨论。很多人建议避免使用它们，因为它们有很多奇怪的地方，很难理解、调试和维护。

围绕这场争论，你已经可以找到很多文章了。我想写这篇文章来提供一个针对 JavaScript 中的类的函数式解决方案的快速指南。

在下面的例子中，我将展示在 JavaScript 中使用类的两种方式。历史函数类语法和 ES2015 类语法。

为了简单起见，我将把它们都称为类，除非我明确地提到其中的一个。

# 创建对象

在 JavaScript 中，可以使用对象字面语法直接创建对象。

多亏了这种语法，根本不需要类语法。了解一些模式有助于我们远离那些怪癖，写出更好的代码。首先，让我们看看如何使用类语法创建对象。

即使 ES2015 类语法更好，但它只是原型之上的语法糖。使用对象工厂模式可以获得相同的结果。

工厂模式只是一个使用对象字面语法返回对象的纯函数。

如果您有一些经验，您应该已经意识到这种方法的一个问题。每次创建一个新对象时，`createHuman`工厂都会创建一个新的`getFullname`方法。

如果创建了数千或数百万个对象，这会增加内存消耗并产生一些性能开销。

但是不用担心。这很容易解决。把`getFullname`方法搬到工厂外面，在工厂里面引用就行了。

# 继承之上的组合

类最大的特点之一就是继承。你可以把重复的定义分成小块，然后继承它们。

尽管继承作为 OOP 的一个特性很棒，但在 JavaScript 中却是个问题。这是反对在 JavaScript 中使用类的主要理由。

使用原型继承，对象直接从其他对象继承，如果有很多嵌套的原型，就会变得混乱。追踪 bug 会变得非常困难。

幸运的是，我们有另一种模式来复制同样的效果。作文。您可以组合它们，而不是从其他对象继承对象。

# 私有字段、设置器和获取器

JavaScript 类还没有私有字段的概念。幸运的是，在漫长的等待之后，[私有字段](https://github.com/tc39/proposal-class-fields)很快就会出现在 JavaScript 中。

但在此之前，有一些变通办法，如以下划线开始字段名以将其标记为私有或使用符号。即使 JavaScript 中还没有私有字段，setters 和 getters 也已经存在很久了。

如果考虑函数式方法，私有字段只是变量和函数，不通过对象工厂公开。

# 静态字段

静态字段不能访问对象上下文。一些用例是存储与类相关的常量、一些助手函数或工厂函数。

因为静态字段不能访问对象上下文，所以把它们放在哪里并不重要。你可以把它们作为变量，一个模块中的纯函数，如果需要它们是公共的或者你可以把它们赋给工厂函数，就把它们导出来。

# 结论

每年我们都会看到各种 JavaScript 主题的大量改进，包括类。甚至类语法也比函数类有了巨大的改进，但它仍然有着与原型继承相同的怪癖。

在有意义的时候，在 JavaScript 中使用类并没有错。但是强烈建议远离它们，以防止不必要的错误和行为。

此外，JavaScript 的设计允许我们以更简单的方式使用类的相同特性，使用函数和一些模式。

感谢阅读！