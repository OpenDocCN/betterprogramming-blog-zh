<html>
<head>
<title>How To Get an FCM Device Token in Android (Updated for 2021)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中获得FCM设备令牌(2021年更新)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-get-an-fcm-device-token-in-android-updated-for-2021-54fcf81746f1?source=collection_archive---------4-----------------------#2021-03-31">https://betterprogramming.pub/how-to-get-an-fcm-device-token-in-android-updated-for-2021-54fcf81746f1?source=collection_archive---------4-----------------------#2021-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="18ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">不推荐使用用于检索令牌的旧类。让我们看看更新的那个</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/58456d0f43e776dfed685a63686452a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ahlv2aFjA1yRd4GW"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">乔纳森·肯珀在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="93af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我真的不太喜欢有截止日期的任务，到处都是旧代码，所有代码都被弃用，导致网上没有具体的答案。</p><p id="7622" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那是你为社区工作，而不是为任何工作。</p><p id="d8b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开门见山:谷歌弃用了<a class="ae kv" href="https://firebase.google.com/docs" rel="noopener ugc nofollow" target="_blank"> Firebase </a>的<code class="fe ls lt lu lv b">FirebaseInstanceIdService</code>类，我直到昨晚才知道，因为我上一次写FCM服务是在一年半以前。为了获取FCM设备令牌，我必须修改应用程序代码库，该应用程序代码库包含不推荐使用的类，我认为它是正确的。实际上，我得到了两个代码库，它们都有相同的非工作服务类。</p><p id="ff30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在网上寻找答案，但没有运气。然后我在Stack Overflow上看到一个关于<code class="fe ls lt lu lv b">FirebaseInstallations</code>的问题的评论，这才好玩的开始。</p><p id="882a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道它的功能，但不知道如何到达那里:<code class="fe ls lt lu lv b">FirebaseInstallations</code>是一条路。我尝试了不同的方法，并得到了整个工作。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="96fc" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">Java代码片段</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="40b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不是在这里填鸭式地喂你。我假设你知道如何在Firebase中创建一个项目，如何同步SDK，包括哪些依赖项，关于<code class="fe ls lt lu lv b">google-services.json</code>文件，以及这个主类工作之前需要的所有东西。</p><p id="7541" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有，别忘了把<code class="fe ls lt lu lv b">FirebaseApp.initializeApp(this)</code>包括在<code class="fe ls lt lu lv b">BaseActivity</code>类的<code class="fe ls lt lu lv b">onCreate()</code>里。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="d591" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">科特林(带匕首)代码片段</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="fb88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，创建扩展<code class="fe ls lt lu lv b">FirebaseMessagingService</code>的<code class="fe ls lt lu lv b">DaggerFirebaseService</code>。然后用<code class="fe ls lt lu lv b">MessagingServices</code>延长<code class="fe ls lt lu lv b">DaggerFirebaseService</code>。<em class="mx"> </em>或者你可以简单的移除<a class="ae kv" href="https://dagger.dev/" rel="noopener ugc nofollow" target="_blank">匕首</a> <code class="fe ls lt lu lv b">Firebase</code>类如果你不使用匕首的话。</p><p id="293c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以看到我是如何在<code class="fe ls lt lu lv b">BaseApplication</code>类的<code class="fe ls lt lu lv b">onCreate()</code>中初始化<code class="fe ls lt lu lv b">FirebaseApp</code>的。</p><p id="9b5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我会让你完全理解它，因为正如我之前所说的，如果你之前有过这方面的挣扎，你知道你在看什么。</p><p id="e006" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:不要只是复制粘贴上面的代码，而是要理解它。</p><p id="2590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>