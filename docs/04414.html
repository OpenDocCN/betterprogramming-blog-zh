<html>
<head>
<title>API Development With Flask for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的Flask API开发</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/api-development-with-flask-for-the-absolute-beginner-a2163b2bd8ca?source=collection_archive---------4-----------------------#2020-04-12">https://betterprogramming.pub/api-development-with-flask-for-the-absolute-beginner-a2163b2bd8ca?source=collection_archive---------4-----------------------#2020-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9153" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开始使用Python构建后端服务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b76d8b2de3531fa263ef3afb1b727213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0KhqiMHe-7Oz8WJgR634CQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.endivesoftware.com" rel="noopener ugc nofollow" target="_blank">https://www.endivesoftware.com</a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="622d" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">背景</h1><p id="55fb" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我这篇文章的目标是帮助刚开始编程的人用他们新发现的技能快速变得高效。</p><p id="3f27" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">当你开始学习编程时，最困难的障碍之一是你如何开始应用你新发现的知识来解决一个实际问题。用Python构建一个API是开始看到你努力工作的结果的一个很好的地方。</p><p id="2d75" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这篇文章是为那些一直在学习用Python编程，并且对命令行和web如何工作有基本了解的人准备的。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="bf5e" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">技术</h1><p id="bbf9" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在本文中，我们将使用<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>:“Web开发一次一滴”。Flask是一个基于Python构建的web开发库。</p><p id="0a62" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Flask利用Python的简单性作为初学者的一种方法，这使得为复杂的后端API和服务于数百万用户的微服务构建基本应用程序变得容易。Flask被网飞、Reddit、Lyft等科技巨头使用。</p><p id="d9ba" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">对于IDE，我将使用<a class="ae ky" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>。我强烈推荐你使用它，它是免费的，有一个惊人的插件生态系统，会让你的Python开发充满乐趣。为了测试我们的API端点，我们将使用<a class="ae ky" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>，你可以免费下载。</p><h2 id="4c58" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">边注</h2><p id="7907" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在本教程中，我将假设您已经知道基本的Python语法，您已经在开发机器上安装了Python，您知道如何使用命令行，以及互联网如何工作的基础知识。</p><p id="3175" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如果你还没有这些知识，我会在下面提供免费资源链接，你可以在那里学习这些基础知识，然后你可以回到这个教程。</p><ul class=""><li id="cdf4" class="nl nm it ma b mb mu me mv mh nn ml no mp np mt nq nr ns nt bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=rfscVS0vtbw" rel="noopener ugc nofollow" target="_blank">学习Python —初学者全教程(教程</a>)</li><li id="52ab" class="nl nm it ma b mb nu me nv mh nw ml nx mp ny mt nq nr ns nt bi translated"><a class="ae ky" href="https://www.codecademy.com/articles/install-python" rel="noopener ugc nofollow" target="_blank">安装Python </a></li><li id="a412" class="nl nm it ma b mb nu me nv mh nw ml nx mp ny mt nq nr ns nt bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=x3c1ih2NJEg" rel="noopener ugc nofollow" target="_blank">互联网如何工作</a></li><li id="2631" class="nl nm it ma b mb nu me nv mh nw ml nx mp ny mt nq nr ns nt bi translated"><a class="ae ky" href="https://www.theodinproject.com/courses/web-development-101/lessons/command-line-basics-web-development-101" rel="noopener ugc nofollow" target="_blank">命令行基础知识</a></li></ul></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="b34f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">定义</h1><h2 id="8911" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">API定义</h2><blockquote class="nz oa ob"><p id="a487" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">“应用程序编程接口是软件组件或系统的计算接口，它定义了其他组件或系统如何使用它。它定义了可以进行的调用或请求的种类、如何进行、应该使用的数据格式、应该遵循的约定等。”— <a class="ae ky" href="https://en.wikipedia.org/wiki/Application_programming_interface" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><h2 id="0b43" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">JSON定义</h2><blockquote class="nz oa ob"><p id="fb20" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">JavaScript对象表示法是一种开放的标准文件格式和数据交换格式，它使用人类可读的文本来存储和传输由属性值对和数组数据类型组成的数据对象— <a class="ae ky" href="https://en.wikipedia.org/wiki/JSON" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><h2 id="406c" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">HTTP定义</h2><blockquote class="nz oa ob"><p id="4117" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">HTTP定义了一组请求方法来指示对给定资源要执行的期望动作。虽然它们也可以是名词，但是这些请求方法有时被称为<em class="it"> HTTP动词</em>。</p><p id="f512" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">它们中的每一个都实现了不同的语义，但是它们之间有一些共同的特性:例如，请求方法可以是安全的、幂等的或者可缓存的。”— <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" rel="noopener ugc nofollow" target="_blank"> MDN </a></p></blockquote><h2 id="fe31" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated"><code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET" rel="noopener ugc nofollow" target="_blank">GET</a></code></h2><p id="bff9" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">方法请求指定资源的表示。使用<code class="fe og oh oi oj b">GET</code>的请求应该只检索数据。</p><h2 id="c4c0" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated"><code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST" rel="noopener ugc nofollow" target="_blank">POST</a></code></h2><p id="4eb4" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated"><code class="fe og oh oi oj b">POST</code>方法用于将一个实体提交给指定的资源，这通常会导致状态的改变或者对服务器产生副作用。</p><h2 id="5dd0" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated"><code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT" rel="noopener ugc nofollow" target="_blank">PUT</a></code></h2><p id="74e2" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated"><code class="fe og oh oi oj b">PUT</code>方法用请求负载替换目标资源的所有当前表示。</p><h2 id="27ec" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated"><code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/DELETE" rel="noopener ugc nofollow" target="_blank">DELETE</a></code></h2><p id="a1eb" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">方法删除指定的资源。<code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/CONNECT" rel="noopener ugc nofollow" target="_blank">CONNECT</a></code>。</p><h2 id="7145" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated"><code class="fe og oh oi oj b"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PATCH" rel="noopener ugc nofollow" target="_blank">PATCH</a></code></h2><p id="9e69" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated"><code class="fe og oh oi oj b">PATCH</code>方法用于对资源进行部分修改。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="0750" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">我们要建造什么</h1><p id="cf78" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在本教程中，我们将为AA汽车公司构建一个后端服务来跟踪他们的车队。在本教程中，为了简单起见，我们将使用一个基本的Python数据结构来存储我们的数据，我们可以在以后的教程中添加一个数据库。</p><p id="ccb8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们还不需要担心数据库的复杂性，但是已经了解了构建API的基本概念以及它们是如何工作的。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="929f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">入门指南</h1><p id="9ee4" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">上面，我已经为我们提供了API世界中的通用定义，随着您继续学习和构建API，所有这些将变得更加清晰。</p><p id="4ebd" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">创建一个新目录，并导航到新创建的目录。我把我的名字叫做<code class="fe og oh oi oj b">aa-api</code>，“你可以随便叫你的名字。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="e222" class="mz lh it oj b gy oo op l oq or">mkdir aa-api<br/>cd aa-api</span></pre><h2 id="4f0f" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">安装<a class="ae ky" href="https://github.com/pypa/pipenv" rel="noopener ugc nofollow" target="_blank">管道</a></h2><blockquote class="nz oa ob"><p id="288f" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">“Pipenv是一种工具，旨在将所有包装领域(捆扎机、作曲家、npm、货物、纱线等)的精华带给客户。)到Python世界。在我们的世界里，Windows是一等公民。</p><p id="b014" class="ly lz oc ma b mb mu ju md me mv jx mg od mw mj mk oe mx mn mo of my mr ms mt im bi translated">它会自动为您的项目创建和管理一个virtualenv，并在您安装/卸载软件包时从您的<code class="fe og oh oi oj b">Pipfile</code>中添加/删除软件包。它还生成了非常重要的<code class="fe og oh oi oj b">Pipfile.lock</code>，用于产生确定性的构建。"</p></blockquote><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="00b8" class="mz lh it oj b gy oo op l oq or">pip install --user pipenv</span></pre><h2 id="13d2" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">安装烧瓶</h2><p id="c0d3" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">正如我在上面的技术部分提到的，我们将使用<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>，一个用于构建web应用程序的极简Python库。我们将使用Pipenv来安装Flask。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="8607" class="mz lh it oj b gy oo op l oq or">pipenv install flask</span></pre><p id="7020" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这将创建一个虚拟环境并安装Flask。它将为我们生成两个文件，<code class="fe og oh oi oj b">Pipfile</code>和<code class="fe og oh oi oj b">Pipfile.lock</code>。如果你有一些Node.js的经验，这类似于一个<code class="fe og oh oi oj b">Package.json</code>文件或Ruby Gemfile。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="7814" class="mz lh it oj b gy oo op l oq or">[[source]]<br/>name = "pypi"<br/>url = "https://pypi.org/simple"<br/>verify_ssl = true<br/>[dev-packages]<br/>[packages]<br/>flask = "*"<br/>[requires]<br/>python_version = "3.8"</span></pre><p id="63e4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">六行代码中的flask“Hello Universe”API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/19d862f586f2c6578891a4604e0739c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VcW6Y77Sp2el44kXAaryLQ.png"/></div></div></figure><p id="c9a6" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这就是我们的第一个API，只有6行代码，这就是Flask的厉害之处。如果您熟悉Python，那么这些代码的大部分对您来说会很熟悉。</p><p id="9f08" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">也许<code class="fe og oh oi oj b">@app.route('/)</code>可以看起来有点关。这在Python中叫做<em class="oc"> decorators </em>，这个概念在其他编程语言中也有，所以并不是Python特有的。</p><p id="cb90" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">装饰者接受一个函数并为我们的<code class="fe og oh oi oj b">hello</code>函数扩展它的功能，当<code class="fe og oh oi oj b">/</code>路由被请求时，它将被调用并返回一个JSON <code class="fe og oh oi oj b">{"hello": "Universe"}</code>。</p><p id="e169" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我将在本文后面放一个链接，以学习更多关于Python中的decorators的知识，尽管这不是本文的要求。弗拉斯克已经帮我们做了繁重的工作。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="2d92" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">运行我们的应用</h1><p id="54de" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">要运行我们的应用程序，我们首先需要通过运行<code class="fe og oh oi oj b">pipenv shell</code>来激活Pipenv为我们创建的虚拟环境。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="a16f" class="mz lh it oj b gy oo op l oq or">➜  aa-api pipenv shell <br/>Launching subshell in virtual environment…<br/> . /Users/peterayeni/.local/share/virtualenvs/aa-api-9L89IsJh/bin/activate<br/>➜  aa-api  . /Users/peterayeni/.local/share/virtualenvs/aa-api-9L89IsJh/bin/activate<br/>(aa-api) ➜  aa-api</span></pre><p id="d8bd" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">然后我们跑<code class="fe og oh oi oj b">python app.py</code>。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="970a" class="mz lh it oj b gy oo op l oq or">(aa-api) ➜  aa-api python app.py<br/> * Serving Flask app "app" (lazy loading)<br/> * Environment: production<br/>   WARNING: This is a development server. Do not use it in a production deployment.<br/>   Use a production WSGI server instead.<br/> * Debug mode: off<br/> * Running on <a class="ae ky" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/</a> (Press CTRL+C to quit)</span></pre><p id="0fc0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您将看到一个开发服务器正在本地主机的端口5000上运行。启动Postman并创建一个GET请求。</p><p id="2151" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如果您以前没有使用过Postman，为了帮助您理解它，请查看这个快速教程:<a class="ae ky" href="https://www.youtube.com/watch?v=jBjXVrS8nXs" rel="noopener ugc nofollow" target="_blank">如何使用Postman </a>发送和捕获API请求。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/f27ef89010decb305fb07e58fcf6f8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6q7KYUgyUGU9TRk1LePh-Q.png"/></div></div></figure><p id="c0d2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这就是上面的HTTP动词的定义开始有意义的地方。默认情况下，我们的<code class="fe og oh oi oj b">hello</code>函数向根路由<code class="fe og oh oi oj b">"/"</code>发出GET请求，您可以在上面的Postman中看到返回的JSON。</p><p id="f155" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">干得好，现在让我们扩展我们的应用程序，以便能够做更多的事情。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="fccc" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">总线数据</h1><p id="6d55" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在本教程的剩余部分，我们将构建一个CRUD API来管理AA汽车的总线。让我们定义我们需要收集的关于每辆公交车的信息。</p><pre class="kj kk kl km gt ok oj ol om aw on bi"><span id="69af" class="mz lh it oj b gy oo op l oq or">Number Plate<br/>Manufacturer<br/>Model<br/>Year<br/>Capacity</span></pre><p id="aaf8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">以上是定义每条总线的数据。我们可以创建一个Python列表来帮助我们存储每辆公交车的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/ffd38b3912316dedb63a699352f93879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6LRMlic8TA9Bzidd3G2g-Q.png"/></div></div></figure><p id="04f4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">以上是一个字典列表，通过这种方式，你会看到大多数语言都在创建数据集合，以便在内存中存储复杂的数据。从现在开始，我们将在应用程序中使用上面的列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/6121f1acd41e1e00ce9889bbb9f52cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DE16HDRcDWDxqex56MkJQw.png"/></div></div></figure><p id="5435" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">上面，我对我们的代码做了一些修改，添加了一个<em class="oc">总线</em>集合，并对函数做了一些修改。</p><p id="7783" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们的<code class="fe og oh oi oj b">hello</code>函数现在改名为<code class="fe og oh oi oj b">get_buses</code>。这个名字让我们知道这个函数的功能是什么，它将得到我们集合中的所有总线。</p><p id="7f51" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">为了看到我们工作的结果，我们需要使用<code class="fe og oh oi oj b">ctr+ c</code>和<code class="fe og oh oi oj b">python app.py</code>重启服务器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/dedef4262bf4f25584b4c9cb3599d455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KYEUm6emCk-xmLRhGVCgiw.png"/></div></div></figure><h2 id="3783" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">坐一辆公共汽车</h2><p id="63a9" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">现在，让我们创建另一个仅检索一条总线的端点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/b107db32cd13f0a7a42063f1d5b8be64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1IZJz6rMRHFQZWwqmiRBg.png"/></div></div></figure><p id="e9ea" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">上面，我们添加了一个新的端点来获得单条总线。</p><p id="ab3a" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们通过URL <code class="fe og oh oi oj b">'/buses/&lt;int:index&gt;'</code>捕获了我们想要检索的总线的索引，因此，在我们的URL中，我们可以有<code class="fe og oh oi oj b"><a class="ae ky" href="http://127.0.0.1:5000/buses/1" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:5000/buses/1</a></code>,并且“1”将被传递给<code class="fe og oh oi oj b">get_bus</code>函数，该函数将用于在我们的<code class="fe og oh oi oj b">buses</code>数组的那个位置获取总线并将其返回给我们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/f14c9bf493974c10ca126992c1bdee80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJtvVG2CKkzDtqZKYDmqUg.png"/></div></div></figure><h2 id="77cf" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">添加新总线</h2><p id="5fe0" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">太棒了，我们只有一辆巴士。现在，我们将创建一个端点，允许用户使用我们的API添加新的总线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/9d79a7cb622b348f8f72ffc57f535f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKK297kBhM_IGuzRf4tOOA.png"/></div></div></figure><p id="a59f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">上面是我们添加了新总线的端点的代码实现，您会注意到这里有一些简单的区别。</p><p id="2efe" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">首先映入您眼帘的是我们的<code class="fe og oh oi oj b">@app.route</code>接受了第二个参数<em class="oc"> methods </em>，它指定了我们期望的HTTP方法的类型。</p><p id="5cd8" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">根据上面对POST的定义，您将会记得，每当我们需要创建一个新资源时，我们都需要使用HTTP方法。此外，我们从Flask导入请求方法，这允许我们捕获通过请求体发送的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/d1e25f2236856453bba117a7018c168a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ec3QFDo3CxOz5TdJGuKf1Q.png"/></div></div></figure><p id="0852" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您还会注意到，这一次，我们返回了新添加的总线的ID，该ID只是列表的大小和一个状态代码200，表示资源创建成功。</p><p id="daa7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">让我们更新代码，只返回我们添加的总线，这对于良好的用户体验更好，并将使我们的前端开发人员的生活更好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/c6fdfa0622699110eb70df5f711f645b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRNKVpwOQdJb52E0jQ1Nsw.png"/></div></div></figure><h2 id="5433" class="mz lh it bd li na nb dn lm nc nd dp lq mh ne nf ls ml ng nh lu mp ni nj lw nk bi translated">更新和删除</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/71fc365e7b8561d589fec6a3189ea68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NIUKywKgwX5ChM3mnhdpTw.png"/></div></div></figure><p id="3d89" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">如您所见，更新和删除遵循相似的模式。对于更新，我们使用PUT HTTP方法，通过request方法获取更新的内容。我们通过URL传递数据来了解要更新的数据，就像获取单条总线一样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/f55b0eb44b562429ab528aa172bbdef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29YU1UypOh3B6HBgehwn6g.png"/></div></div></figure><p id="bd94" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">删除是最简单的部分。我们从URL中取出要删除的总线，并使用pop数组方法将其从列表中取出，然后将删除的总线返回给用户。</p><p id="d487" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您会注意到我们使用了<code class="fe og oh oi oj b">jsonify()</code>，一个来自Flask的方法，将Python字典转换成JSON，然后发送给用户。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="f446" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">完整代码</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/813d25c073ae36047d3c03f8473aa4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MGpEb-eqM3FZwAI09_nK2w.png"/></div></div></figure><p id="74cd" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">这就是使用Flask在Python中构建完整CRUD API所需的所有代码。</p><p id="8c39" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我希望这能在您需要开始用Python构建后端服务时给你一些提示。这段代码中有很多我们可以改进的地方，比如错误检查、验证、添加数据库来保存数据、认证、测试和文档。</p><p id="8e0b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Flask提供了很棒的文档，可以用来改进这个API，还有许多其他资源，只需一个Google away就可以让你继续学习。我将继续在本教程的基础上增加其他层次的改进。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="83a4" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">资源</h1><ul class=""><li id="f456" class="nl nm it ma b mb mc me mf mh oy ml oz mp pa mt nq nr ns nt bi translated"><a class="ae ky" href="https://www.endivesoftware.com/blog/api-definition-types-specifications-documentation/" rel="noopener ugc nofollow" target="_blank">什么是API？定义、类型、规格和文件</a></li><li id="ec92" class="nl nm it ma b mb nu me nv mh nw ml nx mp ny mt nq nr ns nt bi translated"><a class="ae ky" href="https://dev.to/sonnk/python-decorator-and-flask-4c16" rel="noopener ugc nofollow" target="_blank"> Python装饰器和烧瓶</a></li><li id="555e" class="nl nm it ma b mb nu me nv mh nw ml nx mp ny mt nq nr ns nt bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="noopener ugc nofollow" target="_blank"> HTTP响应状态码</a></li></ul><p id="ac89" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">编码快乐！</p></div></div>    
</body>
</html>