# 使用一个简短的 Python 脚本隐藏你的秘密信息

> 原文：<https://betterprogramming.pub/hide-your-secret-message-in-plain-site-using-a-short-python-script-1439bd0fcf6d>

## 眼不见为净——他们永远也不会知道！

![](img/8b5ca9e45cc8ad5503c5144414fa83da.png)

由 [Kristina Flour](https://unsplash.com/@tinaflour?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片。

隐写术是将消息或信息隐藏在其他非机密文本或数据中的做法。使用以下 Python 代码，您可以在图像文件中隐藏文本消息，人眼将看不到文件图像的任何变化。他们不会知道他们不知道的事。

# 只是一点小小的改变

那么，怎么可能在一张图片中隐藏数百行文本而没有人发现这种变化呢？如果您检查图像文件的属性，您会发现它的宽度和高度是用像素来表示的，像素是视觉信息的最小点。当使用 [NumPy](https://numpy.org/) 加载到内存中时，每个像素有三个字节的信息:红色、绿色和蓝色各一个。我们可以将我们的秘密文本分割成微小的比特，或者 1 和 0，并将这些比特存储在每个颜色字节的最低位。

![](img/a933d3573099fa5a81c1433ef88885a3.png)

没有秘密信息的原始照片(作者)。

# 为什么看不出图像有什么变化？

当秘密消息被嵌入到图像中时，修改后的图像文件中的每个像素的颜色被改变(平均大约一半时间)256 个可能的强度等级中的一个。专家表示，这几乎是正常人类颜色感知极限的两倍。简而言之，没有人会注意到这个变化。

![](img/efdf32eeca3a25b224af51f83f002473.png)

这张图片中嵌入了几行秘密文本。

*注意:Medium 在发布过程中会对图像进行一些额外的处理，因此您必须使用自己的图像文件，而不是下载上面显示的内容。*

# 守则的基本内容

第一个程序嵌入你的秘密文本在一个 PNG 图像文件，第二个程序提取它。图像文件不能是有损类型，这意味着组成图像的所有字节都必须没有任何改变。这排除了使用 JPG 文件的可能性，因为图像数据在压缩过程中会有一些损失。另一方面，PNG 文件保留了所有的信息，没有丢失。始终使用 PNG 图像文件。

这是第一个名为`txt_hide.py`的程序。下面的代码清单解释了它的工作原理:

这个程序中导入了三个库。tkinter 是标准 Python 安装的一部分，但是另外两个( [PIL](https://pillow.readthedocs.io/en/stable/) 和 NumPy)需要安装，如果你还没有安装的话。安装它们最简单的方法是在命令提示符或终端窗口中使用`pip install Pillow`和`pip install numpy`。为了便于参考，我在清单顶部的注释中添加了这两个命令。

程序运行时会弹出两个对话框，这两个对话框都是由 tkinter 库提供的。第一个提示输入嵌入秘密消息的 PNG 图像文件，另一个提示输入秘密消息的文本。我选择了`askstring()`对话框，而不是 Python 的`input()`语句，因为它允许你粘贴剪贴板中的多行文本，并在每行末尾添加新行。

# NumPy 来救援了

加载和处理图像文件有几种可能的方法，但是 NumPy 库是这个程序的理想选择，原因有几个。图像被加载到一个三维数组中——二维表示行和列的位置，一维表示颜色的字节。NumPy 允许您有效地将该数组重新整形为一个 8 位字节的一维数组，并在以后将其重新整形为原始形状，以便写回文件。作为一个简单的字节线性数组，处理每个字节中的所有低位要容易得多。

秘密消息的每个字节被分解成单独的比特，并且这些比特中的每个比特替换图像字节中的低阶比特。最后，图像字节被重新整形为它们的原始形式，并且结果被写入以替换原始的 PNG 文件。

*注意:我建议在试验这段代码的同时复制一个 PNG 图像文件。任何打字错误都可能破坏你的图像文件。*

# 提取秘密信息

第二个程序名为`txt_show.py`，从 PNG 图像文件中提取秘密信息的过程与此相反。下面是源代码:

这个程序的几个部分与第一个清单中的非常相似。导入相同的库，并使用相同的 tkinter 对话框提示输入 PNG 文件。这个程序核心的比特旋转代码从图像字节数组中提取低位比特，并重建秘密文本消息。

# 这结束了我们的传输

如果您非常仔细地查看源代码，您可能会注意到一个附加在秘密消息末尾的特殊字符，并在提取过程中注意它。`End of xmit`在标准 ASCII 码中由数值为`4`的字符表示。我选择这个作为一个特殊的标记来表示秘密文本的结束。在正常情况下，该字符不应出现在您作为输入内容键入或复制粘贴的任何普通文本中。

# 可回收图像

提取过程不会改变图像文件，因此您可以根据需要多次提取秘密邮件。类似地，您可以重复使用相同的图像文件来嵌入不同的秘密消息，因为每次只改变相同的低阶位。

感谢阅读！