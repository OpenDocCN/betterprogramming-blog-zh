<html>
<head>
<title>Build Layout Animations Using React Native Reanimated</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native Reanimated构建布局动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/layout-animations-with-react-native-reanimated-2-3-0-52da4bdc347e?source=collection_archive---------4-----------------------#2022-01-22">https://betterprogramming.pub/layout-animations-with-react-native-reanimated-2-3-0-52da4bdc347e?source=collection_archive---------4-----------------------#2022-01-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e26e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用react-native-reactive 2 . 3 . 0库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9bd3e6cca44c16b7aca314370f414002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cf-SKznUipa5Wx6G"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@lautaroandreani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">劳塔罗·安德烈亚尼</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="03f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将看到如何使用<a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/" rel="noopener ugc nofollow" target="_blank">React-Native-reanimated</a>库在React Native中实现布局动画。</p><p id="6f54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React Native Reanimated是一个动画库，它将我们在Javascript线程上声明的动画直接运行到Native / UI线程上。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="a3a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在React Native中，组件立即呈现或出现在UI上，这与缓慢淡入或带有其他动画的内容相比，并不令用户满意。现在，由于新版<a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/docs/" rel="noopener ugc nofollow" target="_blank"> 2.3.0 </a>的reanimated，当组件进入或退出用户界面时，制作组件动画变得非常容易。他们引入了一种叫做<a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/layout_animations" rel="noopener ugc nofollow" target="_blank">布局动画</a>的东西，它做的和听起来一模一样。使用这个我们现在可以指定当一个组件<code class="fe lz ma mb mc b">Mounts</code> / <code class="fe lz ma mb mc b">Enters</code>或者<code class="fe lz ma mb mc b">Demounts</code> / <code class="fe lz ma mb mc b">Exits</code>出现在屏幕上时应该出现哪种类型的动画。有很多预定义的动画可以用于<code class="fe lz ma mb mc b"><a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/docs/api/LayoutAnimations/entryAnimations#predefined-animations" rel="noopener ugc nofollow" target="_blank">Entering</a></code>和<code class="fe lz ma mb mc b"><a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/docs/api/LayoutAnimations/exitAnimations#predefined-animations" rel="noopener ugc nofollow" target="_blank">Exiting</a></code>动画。</p><p id="b3b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将看到如何通过创建两个动画在React本地应用程序中实现布局动画:</p><ul class=""><li id="fa6c" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated">动画翻转计数器</li><li id="a3c0" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">动画待办事项列表</li></ul><p id="14da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是开始编码前您需要的先决条件:</p><ul class=""><li id="3d99" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated">react-原生版本=&gt; 0.62+</li><li id="2890" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">React-Native-Reanimated =&gt; 2.3.0或更高版本(因为布局动画是最近在2.3.0中引入的)</li></ul><p id="d700" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将从创建一个新的react-native项目开始，要创建一个新的react-native项目，请在您的终端中键入以下命令。</p><p id="d910" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">你可以在这个</strong> <a class="ae kv" href="https://github.com/hrupesh/LayoutAnimationsDemo" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">仓库</strong> </a>中检查代码</p><blockquote class="mr ms mt"><p id="867a" class="kw kx mu ky b kz la jr lb lc ld ju le mv lg lh li mw lk ll lm mx lo lp lq lr ij bi translated">在我写这篇文章的时候，最新的react-native版本是0.67</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e99f03a62881aa6d5337040b9fb5e13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*uH1dkq0yBZdq9_9gm0MDLg.png"/></div></figure><p id="28b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后将您当前的工作目录更改为我们刚刚创建的应用程序</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="1782" class="nd ne iq mc b gy nf ng l nh ni">cd &lt;App-Name&gt;</span></pre><p id="0aac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在终端中键入以下内容以安装pods并运行iOS项目:</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="51ff" class="nd ne iq mc b gy nf ng l nh ni">cd ios<br/>pod install<br/>cd ..<br/>yarn ios </span><span id="bd73" class="nd ne iq mc b gy nj ng l nh ni">``` <br/>Use Yarn if you have it installed and if <br/>not run [ npm run ios ]</span><span id="17b5" class="nd ne iq mc b gy nj ng l nh ni">```</span></pre><p id="7358" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用以下命令运行android项目:</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="20ef" class="nd ne iq mc b gy nf ng l nh ni">yarn android</span></pre><p id="1942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们的iOS和Android应用程序已经启动并运行，我们将安装react-native-reanimated。由于这个库使用了<a class="ae kv" href="https://github.com/react-native-community/discussions-and-proposals/issues/40" rel="noopener ugc nofollow" target="_blank"> TurboModules </a>，我们需要做一些额外的步骤来使它工作。</p><blockquote class="mr ms mt"><p id="d888" class="kw kx mu ky b kz la jr lb lc ld ju le mv lg lh li mw lk ll lm mx lo lp lq lr ij bi translated">Turbo模块为初始化本机模块提供了一种新的架构。在应用程序运行时，TurboModules会打开一个桥，以后允许js代码在第一次使用时初始化任何模块。</p></blockquote><p id="fb4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">iOS中的设置非常简单，因为他们不再使用Turbomodules来注册他们的模块。</p><p id="7bdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在你的终端窗口中运行下面的命令来安装重新激活的软件包。</p><blockquote class="mr ms mt"><p id="d507" class="kw kx mu ky b kz la jr lb lc ld ju le mv lg lh li mw lk ll lm mx lo lp lq lr ij bi translated">在我写这篇文章的时候，最新的版本是2.3.1</p></blockquote><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="2692" class="nd ne iq mc b gy nf ng l nh ni">yarn add react-native-reanimated</span><span id="2114" class="nd ne iq mc b gy nj ng l nh ni">```<br/>Once installed cd into ios folder and install pods for RNReanimated<br/>```<br/>cd ios<br/>pod install</span><span id="45b0" class="nd ne iq mc b gy nj ng l nh ni">```<br/>Now we just need to build the iOS app again<br/>To do that either build from XCode or using below command<br/>```<br/>yarn ios</span></pre><p id="b39c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是我们在iOS项目中安装的reanimated。</p><p id="3f37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于android，我们需要采取一些额外的步骤:</p><p id="cb7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要启用爱马仕；为此，转到应用程序级的<code class="fe lz ma mb mc b">build.gradle</code>文件，并将<code class="fe lz ma mb mc b">enableHermes</code>标志切换为真。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/b4aa57c719c0d2c4c2acb415bd8eaddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_1klMUGa3SbM851ljTZ_g.png"/></div></div></figure><p id="02dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们需要在<code class="fe lz ma mb mc b">getJSIModulePackage</code>方法中返回复活的JSI模块，为此，将下面的代码添加到您的<code class="fe lz ma mb mc b">MainApplication.java</code></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/1bb449c64c62acb4cb5132793d1665ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIf8XscEG_zXBIK6MSoZBw.png"/></div></div></figure><p id="b8c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要重新构建我们的Android应用程序，以反映原生变化</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="9e88" class="nd ne iq mc b gy nf ng l nh ni">```<br/>Either run the android app from android studio or type the command below </span><span id="0823" class="nd ne iq mc b gy nj ng l nh ni">```<br/>yarn android</span></pre><p id="f692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然reanimated已经正确地安装到我们的项目中，我们可以利用它来创建令人惊叹的动画。</p><p id="c874" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将从创建一个简单的计数器开始，每当它的值改变时，它就翻转。</p><p id="3c59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了利用布局动画，我们有两个道具，它们将预定义的或<a class="ae kv" href="https://docs.swmansion.com/react-native-reanimated/docs/api/LayoutAnimations/customAnimations" rel="noopener ugc nofollow" target="_blank"> <em class="mu">自定义创建的</em> </a>动画作为输入:</p><ul class=""><li id="0fa8" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated"><code class="fe lz ma mb mc b">entering</code>:组件安装到屏幕上时应该出现的动画。</li><li id="c6ea" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe lz ma mb mc b">exiting</code>:组件从屏幕上卸下时应该出现的动画。</li></ul><p id="eed2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，我们将创建一个带有两个按钮[add和subtract]的计数器，它们的功能与听起来完全相同，并且<code class="fe lz ma mb mc b">count</code>被包裹在一个<code class="fe lz ma mb mc b">Animated</code>视图中，该视图会随着值的变化而翻转。</p><p id="c860" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是可能的，因为<code class="fe lz ma mb mc b">React</code>中的<code class="fe lz ma mb mc b">key</code>属性，所以我们只需要将计数值(它是对<code class="fe lz ma mb mc b">key</code>属性的一个反应<code class="fe lz ma mb mc b">state</code>)赋值，其余的将由<code class="fe lz ma mb mc b">React</code>和<code class="fe lz ma mb mc b">Reanimated</code>处理。当我们为它编写代码时，我们将看看它实际上是如何工作的。</p><p id="45c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将下面的代码粘贴到您的<code class="fe lz ma mb mc b">App.js</code>文件中</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="304c" class="nd ne iq mc b gy nf ng l nh ni">import {<br/>  Text,<br/>  SafeAreaView,<br/>  Button,<br/>  View,<br/>  StyleSheet,<br/>  TouchableOpacity,<br/>} from "react-native";<br/>import React, { useState } from "react";<br/>import Animated, {<br/>  FlipInXUp,<br/>  FlipOutXDown,<br/>  SlideInDown,<br/>  SlideOutUp,<br/>} from "react-native-reanimated";</span><span id="f603" class="nd ne iq mc b gy nj ng l nh ni">const App = () =&gt; {<br/>  const [count, setCount] = useState(0);<br/>  return (<br/>    &lt;SafeAreaView style={styles.container}&gt;<br/>      &lt;View style={styles.counterContainer}&gt;<br/>        &lt;Animated.View<br/>          key={count}<br/>          style={styles.counterFlip}<br/>          entering={FlipInXUp.springify()}<br/>          exiting={FlipOutXDown.springify()}<br/>        &gt;<br/>          &lt;Text style={styles.counterText}&gt;{count}&lt;/Text&gt;<br/>        &lt;/Animated.View&gt;<br/>        &lt;TouchableOpacity<br/>          style={[styles.button, styles.subBtn]}<br/>          onPress={() =&gt; setCount(count - 1)}<br/>        &gt;<br/>          &lt;Text style={styles.btnText}&gt;{"-"}&lt;/Text&gt;<br/>        &lt;/TouchableOpacity&gt;<br/>        &lt;TouchableOpacity<br/>          style={[styles.button, styles.addBtn]}<br/>          onPress={() =&gt; setCount(count + 1)}<br/>        &gt;<br/>          &lt;Text style={styles.btnText}&gt;{"+"}&lt;/Text&gt;<br/>        &lt;/TouchableOpacity&gt;<br/>      &lt;/View&gt;<br/>    &lt;/SafeAreaView&gt;<br/>  );<br/>};</span><span id="35ea" class="nd ne iq mc b gy nj ng l nh ni">export default App;</span><span id="c6b4" class="nd ne iq mc b gy nj ng l nh ni">const styles = StyleSheet.create({<br/>  container: {<br/>    flex: 1,<br/>    justifyContent: "center",<br/>    alignItems: "center",<br/>    backgroundColor: "#000",<br/>  },<br/>  counterContainer: {<br/>    height: 100,<br/>    backgroundColor: "#EEE",<br/>    width: "90%",<br/>    justifyContent: "center",<br/>    alignItems: "center",<br/>    borderRadius: 100,<br/>    marginBottom: 8,<br/>    overflow: "hidden",<br/>    paddingVertical: 8,<br/>  },<br/>  counterText: {<br/>    color: "#FFF",<br/>    fontWeight: "bold",<br/>    fontSize: 54,<br/>    letterSpacing: 2,<br/>    lineHeight: 64,<br/>  },<br/>  button: {<br/>    position: "absolute",<br/>    backgroundColor: "#111",<br/>    borderRadius: 40,<br/>    height: 80,<br/>    width: 80,<br/>    justifyContent: "center",<br/>    alignItems: "center",<br/>  },<br/>  subBtn: { left: 6 },<br/>  addBtn: { right: 6 },<br/>  btnText: {<br/>    color: "#FFF",<br/>    fontWeight: "400",<br/>    fontSize: 54,<br/>    lineHeight: 56,<br/>  },<br/>  counterFlip: {<br/>    backgroundColor: "#000",<br/>    paddingHorizontal: 24,<br/>    justifyContent: "center",<br/>    alignItems: "center",<br/>    height: 90,<br/>    borderRadius: 6,<br/>  },<br/>});</span></pre><p id="413e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你粘贴了代码，你会看到我们有<code class="fe lz ma mb mc b">Animated.View</code>一个组件，它有<code class="fe lz ma mb mc b">Text</code>一个显示<code class="fe lz ma mb mc b">count</code>值的组件。主要代码在这里:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/4869147ccb31ffb5521b2bf0e07ecdca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqcGledN8urXx8MLZomW4A.png"/></div></div></figure><p id="a9d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经使用<code class="fe lz ma mb mc b">count</code>作为<code class="fe lz ma mb mc b">View</code>的<code class="fe lz ma mb mc b">key</code>，所以当我们增加或减少<code class="fe lz ma mb mc b">count</code>值时，组件的<code class="fe lz ma mb mc b">key</code>也会改变，这导致组件的拆卸，并使用新的<code class="fe lz ma mb mc b">key</code>值安装另一个组件。</p><p id="c289" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将<code class="fe lz ma mb mc b">FlipInXUp</code>用作<code class="fe lz ma mb mc b">entering</code>动画，将<code class="fe lz ma mb mc b">FlipOutXDown</code>用作<code class="fe lz ma mb mc b">exiting</code>动画，并且我们还对它们使用了<code class="fe lz ma mb mc b">springify</code>方法，这样我们就为我们的反视图获得了一个有弹性的动画。</p><p id="ae9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的最终输出将是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ba6bfe4906898ae0644ebe7beed97901.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/1*531pWbMqlUqmxVCqI1heTg.gif"/></div></figure><p id="d06f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在计数器已经完成，我们可以进入<code class="fe lz ma mb mc b">Animated</code>待办事项列表组件。</p><p id="aa13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将是一个非常简单的待办事项列表，只有删除和添加待办事项功能。如果你愿意，你可以添加更多的功能。</p><p id="e211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将设计的用户界面如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0694d35e73ae1b52dfca2f0d03db8fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*6GOV1mOzO9AIuHJXj0mqNQ.png"/></div></figure><p id="5976" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们首先为Todo创建一个组件，根据您的可访问性创建一个<code class="fe lz ma mb mc b">Todos.tsx</code>或<code class="fe lz ma mb mc b">Todos.js</code>文件。此外，删除我们在<code class="fe lz ma mb mc b">App.js</code>中为<code class="fe lz ma mb mc b">Counter</code>编写的所有代码(将<code class="fe lz ma mb mc b">counter</code>组件移动到单独的文件),并将以下代码粘贴到其中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/b503f079687d140a3b64da3eda436d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0MVW7ImAi-1MmfqgcOsGw.png"/></div></div></figure><blockquote class="mr ms mt"><p id="0830" class="kw kx mu ky b kz la jr lb lc ld ju le mv lg lh li mw lk ll lm mx lo lp lq lr ij bi translated">我们还没有创建<code class="fe lz ma mb mc b">Todos</code>组件</p></blockquote><p id="8ba8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将以下代码粘贴到您的<code class="fe lz ma mb mc b">Todos.tsx</code>文件中</p><pre class="kg kh ki kj gt mz mc na nb aw nc bi"><span id="0554" class="nd ne iq mc b gy nf ng l nh ni">import React, { useState } from "react";<br/>import { ScrollView, StyleSheet, Text, TextInput, View } from "react-native";<br/>import Animated, {<br/>  Easing,<br/>  FadeInDown,<br/>  Layout,<br/>  SlideOutLeft,<br/>} from "react-native-reanimated";</span><span id="5934" class="nd ne iq mc b gy nj ng l nh ni">type Todo = {<br/>  id: number,<br/>  text: string,<br/>};</span><span id="4789" class="nd ne iq mc b gy nj ng l nh ni">export const Todos: React.FC = () =&gt; {<br/>  const [todos, setTodos] = useState&lt;Todo[]&gt;([<br/>    { id: 1, text: "Initial Todo 1" },<br/>    { id: 2, text: "Initial Todo 2" },<br/>  ]);<br/>  const [text, setText] = useState &lt; string &gt; "";</span><span id="f100" class="nd ne iq mc b gy nj ng l nh ni">  const removeTodo = (id: number) =&gt; {<br/>    setTodos(todos.filter((todo) =&gt; todo.id !== id));<br/>  };</span><span id="1e9e" class="nd ne iq mc b gy nj ng l nh ni">  const addTodo = () =&gt; {<br/>    if (text?.trim()) {<br/>      setTodos([...todos, { id: todos?.length + 1, text }]);<br/>      setText("");<br/>    }<br/>  };</span><span id="7035" class="nd ne iq mc b gy nj ng l nh ni">  return (<br/>    &lt;ScrollView<br/>      contentContainerStyle={styles.container}<br/>      keyboardDismissMode="on-drag"<br/>      keyboardShouldPersistTaps={"always"}<br/>    &gt;<br/>      &lt;Text style={styles.header}&gt;Your To Do's&lt;/Text&gt;<br/>      &lt;View style={styles.separator} /&gt;<br/>      &lt;TextInput<br/>        style={styles.todoInput}<br/>        blurOnSubmit={false}<br/>        placeholder={"Add ToDo"}<br/>        placeholderTextColor={"#444"}<br/>        value={text}<br/>        onChangeText={setText}<br/>        onSubmitEditing={addTodo}<br/>      /&gt;<br/>      &lt;View style={styles.separator} /&gt;<br/>      {todos.map((todo, index) =&gt; (<br/>        &lt;Animated.View<br/>          key={todo.id}<br/>          style={styles.todo}<br/>          entering={FadeInDown}<br/>          layout={Layout.easing(Easing.bounce).delay(index * 100)}<br/>          exiting={SlideOutLeft}<br/>        &gt;<br/>          &lt;Text style={styles.todoText}&gt;{todo.text}&lt;/Text&gt;<br/>          &lt;Text onPress={() =&gt; removeTodo(todo?.id)}&gt;{"✅"}&lt;/Text&gt;<br/>        &lt;/Animated.View&gt;<br/>      ))}<br/>    &lt;/ScrollView&gt;<br/>  );<br/>};</span><span id="0d13" class="nd ne iq mc b gy nj ng l nh ni">const styles = StyleSheet.create({<br/>  container: {<br/>    paddingVertical: 14,<br/>    paddingHorizontal: 18,<br/>  },<br/>  header: {<br/>    fontSize: 32,<br/>    fontWeight: "800",<br/>    color: "#fff",<br/>    letterSpacing: 1.2,<br/>  },<br/>  separator: {<br/>    height: StyleSheet.hairlineWidth,<br/>    backgroundColor: "#444",<br/>    marginTop: 10,<br/>  },<br/>  todo: {<br/>    paddingVertical: 10,<br/>    paddingHorizontal: 18,<br/>    borderWidth: StyleSheet.hairlineWidth,<br/>    borderColor: "#444",<br/>    borderRadius: 4,<br/>    marginTop: 12,<br/>    flexDirection: "row",<br/>    justifyContent: "space-between",<br/>    alignItems: "center",<br/>  },<br/>  todoText: {<br/>    fontSize: 18,<br/>    fontWeight: "400",<br/>    color: "#ccc",<br/>  },<br/>  todoInput: {<br/>    paddingVertical: 10,<br/>    paddingHorizontal: 18,<br/>    borderWidth: StyleSheet.hairlineWidth,<br/>    borderColor: "#bbb",<br/>    backgroundColor: "#111b",<br/>    borderRadius: 4,<br/>    marginTop: 10,<br/>    color: "#fff",<br/>    fontSize: 20,<br/>    fontWeight: "600",<br/>    letterSpacing: 1.4,<br/>  },<br/>});</span></pre><p id="552c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看看我们在这里实际做了什么:</p><ul class=""><li id="538a" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated">我们已经用一个<code class="fe lz ma mb mc b">ScrollView</code>包装了组件，在这里列出了所有的待办事项</li><li id="6518" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">然后我们有<code class="fe lz ma mb mc b">TextInput</code>来修改我们的<code class="fe lz ma mb mc b">state</code>值<code class="fe lz ma mb mc b">text</code>，它被用来添加一个新的Todo，当一个用户从那个输入提交时，我们就把那个<code class="fe lz ma mb mc b">Todo</code>对象添加到我们的<code class="fe lz ma mb mc b">todos</code>数组中。</li><li id="b0ba" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated">我们已经映射了<code class="fe lz ma mb mc b">todos</code>数组，在<code class="fe lz ma mb mc b">ScrollView</code>中列出了<code class="fe lz ma mb mc b">todos</code>，然后我们在<code class="fe lz ma mb mc b">Animated.View</code>组件中呈现了<code class="fe lz ma mb mc b">Todo</code>。</li><li id="9e15" class="md me iq ky b kz mm lc mn lf mo lj mp ln mq lr mi mj mk ml bi translated"><code class="fe lz ma mb mc b">Animated.View</code>组件是所有魔法发生的地方，你一定已经注意到我们已经引入了一个名为<code class="fe lz ma mb mc b">layout</code>的新道具，这个道具负责在布局有任何变化时触发任何动画，就像在我们的情况下，如果任何<code class="fe lz ma mb mc b">Todo</code>被删除，那么所有剩余的待办事项，特别是它下面的那些将改变它们的布局，然后我们用<code class="fe lz ma mb mc b">Easing</code>反弹功能来制作它的动画，并且我们对<code class="fe lz ma mb mc b">index * 100</code>的每个项目都有延迟，这是为了实现涟漪效应，以便每个组件在另一个之后被制作成动画<code class="fe lz ma mb mc b">100ms </code>。</li></ul><blockquote class="mr ms mt"><p id="3015" class="kw kx mu ky b kz la jr lb lc ld ju le mv lg lh li mw lk ll lm mx lo lp lq lr ij bi translated">注意:不要在大列表中使用<code class="fe lz ma mb mc b">index * 100</code>中的<code class="fe lz ma mb mc b">delay</code>,因为这可能会导致许多秒的延迟</p></blockquote><ul class=""><li id="3b40" class="md me iq ky b kz la lc ld lf mf lj mg ln mh lr mi mj mk ml bi translated">此外，我们还有“✅”文本，按下它会删除指定的<code class="fe lz ma mb mc b">Todo</code>对象</li></ul><p id="8b84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就这样，我们创建了一个动画待办事项列表，没有任何其他特定于动画的代码。</p><p id="ab68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出将是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e16939f0472f718e0b49392a1f74e03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/1*-DiwUQvqOv9fFwjt36MwZA.gif"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="a97d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，现在我们对布局动画如何反应原生动画有了一个工作理解，以及我们如何在不编写太多代码的情况下轻松实现它们。这是一个强大的功能，将改变我们在React Native中的动画方式。</p></div></div>    
</body>
</html>