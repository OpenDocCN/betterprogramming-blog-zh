<html>
<head>
<title>Modern Way to Host a Site on IPFS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IPFS网站的现代托管方式</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/modern-way-to-host-a-site-on-ipfs-7941b65d27c3?source=collection_archive---------2-----------------------#2022-06-24">https://betterprogramming.pub/modern-way-to-host-a-site-on-ipfs-7941b65d27c3?source=collection_archive---------2-----------------------#2022-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bd6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用web3.storage、GitHub Actions和IPNS</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c692061b12eb5b1e164b2a94f5b8de55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gvSowVP7_JbYo5BM3FFCdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡特琳娜·林皮索妮的“简介”(来源<a class="ae ky" href="https://undraw.co/illustrations" rel="noopener ugc nofollow" target="_blank">https://undraw.co/illustrations</a>)</p></figure><p id="93ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章是我的“IPFS网站托管指南”的更新版本</p><div class="lv lw gp gr lx ly"><a rel="noopener  ugc nofollow" target="_blank" href="/a-guide-to-hosting-websites-on-ipfs-d2efad40ed3"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">IPFS网站托管指南</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">如何在行星间文件系统上托管站点</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">better编程. pub</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="19a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自从那篇文章发表以来，我已经简化了我的方法，将更新我的网站的过程浓缩为三个命令:</p><ol class=""><li id="0f6f" class="mn mo it lb b lc ld lf lg li mp lm mq lq mr lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">git push</code></li><li id="b25d" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">gh run view -v</code></li><li id="b43e" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">w3 name publish &lt;KEY_ID&gt; &lt;CID&gt;</code></li></ol><p id="1382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种设置的神奇之处在于:</p><ol class=""><li id="821d" class="mn mo it lb b lc ld lf lg li mp lm mq lq mr lu ms mt mu mv bi translated">使用GitHub动作通过<a class="ae ky" href="https://web3.storage/" rel="noopener ugc nofollow" target="_blank"> web3.storage </a>将站点推送到<a class="ae ky" href="https://ipfs.io" rel="noopener ugc nofollow" target="_blank"> IPFS </a></li><li id="6046" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">使用<a class="ae ky" href="https://docs.ipfs.io/concepts/ipns/" rel="noopener ugc nofollow" target="_blank"> IPNS </a>避免手动更改<a class="ae ky" href="https://docs.ipfs.io/concepts/dnslink/#publish-content-path" rel="noopener ugc nofollow" target="_blank"> DNS链接</a>。</li></ol><p id="2117" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">建立这个工作流有很多步骤，但是能够只用几个终端命令来更新您的分散站点是值得的。</p><h1 id="36d0" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">设置web3.storage</h1><p id="0246" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">为了使向IPFS推送内容更容易，我们将使用<a class="ae ky" href="https://web3.storage/" rel="noopener ugc nofollow" target="_blank"> web3.storage </a>，它是由IPFS和<a class="ae ky" href="https://filecoin.io" rel="noopener ugc nofollow" target="_blank"> Filecoin </a>背后的同一个团队创建的。</p><p id="6d03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Web3.storage允许你上传无限量的数据到IPFS，它会帮你把数据固定到多台服务器上，这太棒了！</p><p id="63c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到<a class="ae ky" href="https://web3.storage/" rel="noopener ugc nofollow" target="_blank"> https://web3.storage </a>创建一个帐户:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/06e723b3e21dc61b891a364a16567050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLfBUsMwbVYMp4gXwH_KUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图(来源:【https://web3.storage/pricing/】T21)</p></figure><h1 id="9bdb" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">创建web3.storage API令牌</h1><p id="6145" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">为了从命令行和GitHub动作将内容推送到web3.storage，我们需要一个<a class="ae ky" href="https://web3.storage/docs/#get-an-api-token" rel="noopener ugc nofollow" target="_blank"> API令牌</a>。</p><ol class=""><li id="e91e" class="mn mo it lb b lc ld lf lg li mp lm mq lq mr lu ms mt mu mv bi translated">登录您的<a class="ae ky" href="https://web3.storage/account/" rel="noopener ugc nofollow" target="_blank"> web3.storage帐户</a></li><li id="fc27" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">点击顶部的帐户，然后创建API令牌</li><li id="ec17" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">输入令牌的描述性名称，然后单击创建</li><li id="9c8b" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">您可以单击复制将新的API令牌复制到剪贴板。</li></ol><p id="be16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="od">不要与任何人共享您的API密钥，它是您的帐户专用的。您还应该在某个地方记下令牌字段，并安全地存储它。</em></p><h1 id="47a8" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">安装w3命令行界面</h1><p id="3d6e" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated"><code class="fe mw mx my mz b"><a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">w3</a></code> <a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">命令行界面</a> (CLI)允许我们从终端与web3.storage交互。这是一个基于节点的CLI，所以您首先必须在您的机器上安装<code class="fe mw mx my mz b">node</code></p><p id="36c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你使用的是Mac，你可以通过<a class="ae ky" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制软件</a>轻松安装<code class="fe mw mx my mz b">node</code></p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="a406" class="oi ng it mz b gy oj ok l ol om">brew install node</span></pre><p id="0f4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将包括节点包管理器(npm)，我们将使用它来安装<code class="fe mw mx my mz b"><a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">w3</a></code> CLI。</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="8175" class="oi ng it mz b gy oj ok l ol om">npm install -g @web3-storage/w3</span></pre><p id="6ed3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们使用以下命令进行测试，以确保w3已安装:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="b134" class="oi ng it mz b gy oj ok l ol om">w3 --help</span></pre><p id="51e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将显示所有可用的命令。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/865d5ce70a9975a62ca70daaea6c942f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlfdWb_zuC_p2--xEbzO_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a>创建)</p></figure><p id="826f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道CLI已经安装，运行<code class="fe mw mx my mz b">token</code>命令将CLI连接到web3.storage</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="056d" class="oi ng it mz b gy oj ok l ol om">w3 token</span></pre><p id="323b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后会提示您粘贴API令牌。</p><p id="9ee5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是在上一节中创建的web3.storage API令牌。</p><p id="d041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mw mx my mz b">⁂ API token saved</code>表示CLI已成功链接</p><h1 id="6af7" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">将文件放在web3.storage上</h1><p id="b226" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">如果你回头看看<code class="fe mw mx my mz b">w3</code>中可用的命令，你会看到一个叫做<code class="fe mw mx my mz b">put</code>的命令。</p><p id="8ef8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能已经猜到了，这就是我们在IPFS上“放置”内容的方式。</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="cbde" class="oi ng it mz b gy oj ok l ol om">w3 put &lt;path&gt;</span></pre><p id="ee12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举个简单的例子，创建一个包含如下消息的文本文件:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="8cf0" class="oi ng it mz b gy oj ok l ol om">echo "Hello web3.storage" &gt; hello.txt</span></pre><p id="b5c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们使用<code class="fe mw mx my mz b">put</code>命令将文件推送到IPFS:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="7780" class="oi ng it mz b gy oj ok l ol om">w3 put hello.txt --name hello</span></pre><blockquote class="oo op oq"><p id="6964" class="kz la od lb b lc ld ju le lf lg jx lh or lj lk ll os ln lo lp ot lr ls lt lu im bi translated"><code class="fe mw mx my mz b">--name hello</code>告诉命令在web3.storage中命名文件<code class="fe mw mx my mz b">hello</code>。</p></blockquote><p id="acd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出<a class="ae ky" href="https://web3.storage/docs/concepts/content-addressing/" rel="noopener ugc nofollow" target="_blank">内容标识符</a> (CID)以及公共网关链接。</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="66c7" class="oi ng it mz b gy oj ok l ol om"><a class="ae ky" href="https://dweb.link/ipfs/bafybeifzoby6p5khannw2wmdn3sbi3626zxatkzjhvqvp26bg7uo6gxxc4" rel="noopener ugc nofollow" target="_blank">https://dweb.link/ipfs/bafybeifzoby6p5khannw2wmdn3sbi3626zxatkzjhvqvp26bg7uo6gxxc4</a></span></pre><p id="b4e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您完全按照上述步骤操作，那么您的CID应该与我的一致。请记住，CID是唯一标识内容的散列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/17b9f7e0151949de960190bd49211846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEzeozShLVxBJEMC9JiI1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用https://carbon.now.sh/的<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">创建)</a></p></figure><p id="67dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用完全相同的方式上传文件夹。只需向<code class="fe mw mx my mz b">put</code>命令提供您想要上传的目录的路径。</p><p id="2f29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章的后面，我们将使用一个GitHub动作来自动化这个put步骤。</p><h1 id="146b" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">创建IPNS地址</h1><p id="523f" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">cid是不可变的，不能更改。星际名称系统(IPNS)用可变名称解决了这个问题，可变名称是一个公钥的<a class="ae ky" href="http://docs.ipfs.io.ipns.localhost:48084/concepts/hashing/" rel="noopener ugc nofollow" target="_blank">散列</a>。您可以将IPNS地址视为指向CID的指针。</p><p id="80ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用以下命令使用<code class="fe mw mx my mz b">w3</code>创建一个IPNS地址:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="7651" class="oi ng it mz b gy oj ok l ol om">w3 name create</span></pre><p id="5e9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你的地址会显示出来，但是你可以用<code class="fe mw mx my mz b">w3 name list</code>来显示名字。然而，我还是会把地址写下来，存放在某个地方。</p><p id="333e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要将CID链接到IPNS地址，我们使用<code class="fe mw mx my mz b">publish</code>命令，如下所示:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="94e7" class="oi ng it mz b gy oj ok l ol om">w3 name publish <!-- -->&lt;key_id&gt; &lt;cid&gt;</span></pre><blockquote class="oo op oq"><p id="a1bd" class="kz la od lb b lc ld ju le lf lg jx lh or lj lk ll os ln lo lp ot lr ls lt lu im bi translated"><code class="fe mw mx my mz b">&lt;key_id&gt;</code>是你的IPNS地址(T5显示的内容)，而<code class="fe mw mx my mz b">&lt;cid&gt;</code>是我们链接到的地址</p></blockquote><p id="dce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，不要担心将任何CID链接到您的IPNS地址。我们以后再做。</p><h1 id="0d13" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">设置GitHub Repo / GitHub操作</h1><p id="0cbc" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">创建一个GitHub repo来存储您的网站代码。如果这是一个人的网页，我建议命名为repo <code class="fe mw mx my mz b">&lt;account_name&gt;.github.io</code>，这样你也可以使用<a class="ae ky" href="https://pages.github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub Pages </a>。</p><p id="7f34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您的回购设置，让我们添加一个<a class="ae ky" href="https://github.com/web3-storage/add-to-web3" rel="noopener ugc nofollow" target="_blank">操作</a>，每次我们使用<code class="fe mw mx my mz b">git push</code>时，它都会将回购推送到web3.storage</p><p id="3feb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将下面的代码片段放在repo的<code class="fe mw mx my mz b">.github/workflows/web3_storage.yaml</code>中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/68f2c89339ca4cbb4a9457b2d5f3d61f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuIngTMzhJ8N4dRVPMDgkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由“git push”触发的GitHub动作将整个库发送到IPFS，代码在这里可用<a class="ae ky" href="https://github.com/lgloege/lgloege.github.io/blob/master/.github/workflows/web3_storage.yaml" rel="noopener ugc nofollow" target="_blank"><strong class="bd ow"/></a>(使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a>创建)</p></figure><p id="ed83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">行<code class="fe mw mx my mz b">${{ secrets.WEB3_STORAGE_TOKEN }}</code>读取您的API令牌，这就是动作如何知道推送到您的帐户。</p><p id="5ce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过以下步骤将API令牌存储在GitHub中:</p><ol class=""><li id="ddde" class="mn mo it lb b lc ld lf lg li mp lm mq lq mr lu ms mt mu mv bi translated">登录您的<a class="ae ky" href="https://github.com/login" rel="noopener ugc nofollow" target="_blank"> GitHub账户</a></li><li id="d580" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">转到设置</li><li id="c681" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">然后是秘密</li><li id="afe9" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">单击操作，然后单击新建存储库密码</li><li id="2d99" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">您的令牌必须命名为<code class="fe mw mx my mz b">WEB3_STORAGE_TOKEN</code></li><li id="365c" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">将我们之前创建的web3.storage API令牌复制到该字段中</li></ol><p id="0dc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，每次你运行<code class="fe mw mx my mz b">git push</code>操作都会被触发，你的回购将被上传到IPFS。如果你尝试这样做，你应该有一个绿色的✅，表示没有错误。</p><p id="1bfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单击复选标记查看操作的详细信息。这将显示CID和网关URL(这就是操作中最后两行所做的)。</p><h1 id="13b8" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">使用GitHub CLI</h1><p id="2097" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">您可以使用GitHub CLI在终端中查看CID。这需要安装另一个命令行工具，并将其链接到您的GitHub帐户。</p><p id="4da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GitHub CLI不是设置的一部分，但它可以让您在终端中查看操作的输出。</p><p id="10d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Mac上，我们可以用homebrew安装<code class="fe mw mx my mz b">gh</code> CLI，如下所示:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="c705" class="oi ng it mz b gy oj ok l ol om">brew install gh</span></pre><p id="f4e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="od">参见</em> <a class="ae ky" href="https://cli.github.com/manual/installation" rel="noopener ugc nofollow" target="_blank"> <em class="od">文档</em> </a> <em class="od">了解如何在不同的操作系统上安装。</em></p><p id="bb84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到<a class="ae ky" href="https://github.com/settings/tokens" rel="noopener ugc nofollow" target="_blank">https://github.com/settings/tokens</a>创建访问令牌。您可以在<a class="ae ky" href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token" rel="noopener ugc nofollow" target="_blank">文档</a>中找到详细步骤。注意，这个令牌不同于我们之前创建的web3.storage令牌。这是为了让GitHub CLI可以与您的GitHub帐户通信。</p><p id="538f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拥有访问令牌后，运行以下命令:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="30a7" class="oi ng it mz b gy oj ok l ol om">gh auth login</span></pre><p id="69ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将被提示输入您的GitHub认证令牌</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/173c0817aec65b8ab5427ff3e53f005d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JEx5__BJ7ko6qzfum7RNCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a>创建)</p></figure><p id="6622" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe mw mx my mz b">gh</code>命令来查看关于我们运行的操作的信息:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="3fe0" class="oi ng it mz b gy oj ok l ol om">gh run view -v</span></pre><p id="ab93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="od">您必须从具有git远程设置的目录中运行该命令，否则您将收到错误:“无法确定基本存储库:未找到git远程”</em></p><p id="a9f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的<code class="fe mw mx my mz b">-v</code>标志启用详细输出。否则，你会看到一条信息，说“要了解更多关于工作的信息，请尝试:gh run view …”</p><p id="c97d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择您想要查看的工作流，输出将在分页工具中打开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/f907606e48092ebd9f6479c117db99cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kj2wkt-R9uGRsf6yYlicbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用https://carbon.now.sh/的<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">创建)</a></p></figure><p id="b542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这显示了GitHub操作的输出，特别是CID。</p><p id="877d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="od">如果您喜欢从网页上复制CID，您可以使用</em> <code class="fe mw mx my mz b"><em class="od">gh repo view username/repo --web</em></code> <em class="od">打开回购。</em></p><p id="e532" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道了我们的CID，让我们链接到我们之前创建的IPNS地址。</p><h1 id="009b" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">把刑事调查局和IPNS联系起来</h1><p id="b44a" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">要将CID链接到IPNS地址，请使用以下命令:</p><pre class="kj kk kl km gt oe mz of og aw oh bi"><span id="ee53" class="oi ng it mz b gy oj ok l ol om">w3 name publish <!-- -->&lt;key_id&gt; &lt;cid&gt;</span></pre><blockquote class="oo op oq"><p id="4847" class="kz la od lb b lc ld ju le lf lg jx lh or lj lk ll os ln lo lp ot lr ls lt lu im bi translated">注意，<code class="fe mw mx my mz b">&lt;key_id&gt;</code>是IPNS地址，<code class="fe mw mx my mz b">&lt;cid&gt;</code>是最后一段的CID</p></blockquote><p id="2be8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样做的好处是IPNS地址是可变的。这意味着在我们更新网站后，我们可以让地址指向更新后的CID。</p><p id="aeb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们用我们的IPNS地址建立一个DNSLink。</p><h1 id="8471" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">设置DNS链接</h1><p id="6752" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">您必须通过DNS提供商购买一个自定义域。我使用了<a class="ae ky" href="https://www.cloudflare.com/" rel="noopener ugc nofollow" target="_blank"> Cloudflare </a>，但是任何提供者都应该工作。</p><p id="551c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的想法是让我们的自定义域从网关URL检索内容，但我们必须告诉它要检索的IPNS地址。</p><h2 id="08ee" class="oi ng it bd nh oz pa dn nl pb pc dp np li pd pe nr lm pf pg nt lq ph pi nv pj bi translated"><strong class="ak">使用Cloudflare的DNS链接指令</strong></h2><ol class=""><li id="4103" class="mn mo it lb b lc nx lf ny li pk lm pl lq pm lu ms mt mu mv bi translated">登录Cloudflare</li><li id="3635" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">单击您的活动网站，然后单击左侧栏中的DNS。</li><li id="e9bc" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">在DNS管理部分，增加一条<code class="fe mw mx my mz b">TXT</code>和<code class="fe mw mx my mz b">CNAME</code>记录。</li><li id="3717" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">将<code class="fe mw mx my mz b">TXT</code>记录名称设置为<code class="fe mw mx my mz b">_dnslink.yourwebsite.com</code>(注意:确保用您自己的域名替换yourwebsite.com)</li><li id="b1fa" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">将<code class="fe mw mx my mz b">TXT</code>记录内容设置为<code class="fe mw mx my mz b">dnslink=/ipns/&lt;key_id&gt;</code>(注意:<code class="fe mw mx my mz b">&lt;key_id&gt;</code>是您的IPNS地址</li><li id="5bca" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated">将<code class="fe mw mx my mz b">CNAME</code>记录设置到任何IPFS网关(例如<code class="fe mw mx my mz b">gateway.ipfs.io</code>)</li></ol><p id="2f03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，下面是我的<code class="fe mw mx my mz b">TXT</code>和<code class="fe mw mx my mz b">CNAME</code>记录的截图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/34b9709b33dc5fd9a57cc044fe6f473d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-551YjdDDeBMd6ykQShSJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bab5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="od">使用可变IPNS地址，DNS链接只需完成一次。</em></p><h1 id="5ac2" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">这里发生了什么</h1><p id="1e83" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">我们刚刚做的是将我们的域名(托管在一个中央服务器上)链接到一个网关服务器。该网关服务器(也是集中式服务器)从IPFS网络(是分散式的)获取我们所请求的内容。</p><p id="9c57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，你的网站就伪托管在IPFS上了。网关服务器是集中式的，如果该服务器关闭，您的网站将处于非活动状态。</p><p id="3d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，您网站的内容仍然在IPFS网络上。这种网关服务器方法是我们可以让我们的分散式网站与不了解IPFS的浏览器通信的方法之一。网关是解决这个问题的权宜之计。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/7bffaa7cd6178b7be041a408c77baf9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/0*bVxU36V5ohgUf224.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">IPFS网关工作原理示意图。请求通过中央网关服务器路由，然后IPFS上的内容被检索并发送给用户。(图片来源:作者修改过的<a class="ae ky" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank"> UnDraw </a>图片)</p></figure><h1 id="0b00" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">最后的想法</h1><p id="ffb9" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">我想我已经尽可能地提炼出了这个过程。这种方法消除了在DNS链路中更新cid的需要，并且只需三个命令就可以从命令行完成所有工作</p><h2 id="149c" class="oi ng it bd nh oz pa dn nl pb pc dp np li pd pe nr lm pf pg nt lq ph pi nv pj bi translated"><strong class="ak">更新网站的三个命令</strong></h2><ol class=""><li id="461d" class="mn mo it lb b lc nx lf ny li pk lm pl lq pm lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">git push</code>:更新回购，将网站推送到IPFS</li><li id="d2c0" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">gh run view -h</code>:这是查看我们的CID</li><li id="cf79" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu ms mt mu mv bi translated"><code class="fe mw mx my mz b">w3 name publish &lt;key_id&gt; &lt;cid&gt;</code>:这更新了IPNS链接</li></ol><p id="ff8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法需要一些时间来建立，但我认为这是值得的努力。</p><p id="b0ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有人有办法改善这个工作流程，我愿意接受建议。</p><h1 id="c739" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">首字母缩略词</h1><ul class=""><li id="2716" class="mn mo it lb b lc nx lf ny li pk lm pl lq pm lu pp mt mu mv bi translated">星际文件系统(IPFS)</li><li id="d443" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu pp mt mu mv bi translated">星际命名系统(IPNS)</li><li id="ceab" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu pp mt mu mv bi translated">内容标识符(CID)</li><li id="d420" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu pp mt mu mv bi translated">域名系统(DNS)</li><li id="5bbd" class="mn mo it lb b lc na lf nb li nc lm nd lq ne lu pp mt mu mv bi translated">命令行界面(CLI)</li></ul></div></div>    
</body>
</html>