<html>
<head>
<title>Domains and Redirects: How Does DNS Work?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">域名和重定向:域名系统是如何工作的？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/debunking-the-complexities-in-understanding-dns-b4374e6ca7e5?source=collection_archive---------7-----------------------#2020-06-25">https://betterprogramming.pub/debunking-the-complexities-in-understanding-dns-b4374e6ca7e5?source=collection_archive---------7-----------------------#2020-06-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f856" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解DNS是非常简单的，希望这篇文章将有助于揭穿一些复杂性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/82151c12d0d8d06b53f1579228e56600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-6IllQ5kqR5SY82otGCZQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Andrew Stutesman 在<a class="ae ky" href="https://unsplash.com/s/photos/map-of-the-world?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="4228" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">域名系统</h1><p id="c595" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在最基本的层面上，域名系统(DNS)是人类可读域名(如<code class="fe mn mo mp mq b">google.com</code>或<code class="fe mn mo mp mq b">amazon.com</code>)和IP地址之间的翻译目录。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="ac4d" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">什么是IP地址？</h1><p id="9c52" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">互联网协议地址(IP地址)是分配给连接到使用IP进行通信的计算机网络的每台设备的数字标签。</p><p id="8eaf" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">IP地址有两个主要功能:网络接口识别和位置寻址。</p><p id="10ea" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">日常使用的IP地址有两种版本:IPv4和IPv6。</p><p id="1229" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">由于可用的IPv4地址迅速耗尽，IPv6在2000年代中期后变得更加普及。您可以通过地址的长度快速区分IPv4 ( <code class="fe mn mo mp mq b">8.8.8.8</code>)和IPv6地址(<code class="fe mn mo mp mq b">0:0:0:0:0:ffff:808:808</code>)。</p><p id="f23a" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">网络上的每台设备都需要有一个IP地址。IP地址可以是公有的，也可以是私有的，保留的IP地址用于私有IP地址。</p><p id="68c4" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><code class="fe mn mo mp mq b">Class A — 10.0.0.0/8</code><br/>T5】</p><p id="797c" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><code class="fe mn mo mp mq b">Class B — 172.16.0.0/12</code> <br/> <code class="fe mn mo mp mq b">172.16.0.0–172.31.255.255</code></p><p id="05dd" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><code class="fe mn mo mp mq b">Class C — 192.168.0.0/16</code> <br/> <code class="fe mn mo mp mq b">192.168.0.0–192.168.255.255</code></p><p id="d428" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">IP地址是一个庞大的主题，关于IP的更多信息超出了本文的范围。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="f0c5" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">DNS解析</h1><p id="e988" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">DNS解析是将主机名转换为IP地址的过程。<br/>加载一个网页需要四个操作。</p><h2 id="c5e9" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">递归程序</h2><p id="5efd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">递归器是一种服务器，用于接收来自客户端的查询。它将充当客户端和DNS名称服务器之间的中间人。如果数据存在，它将从缓存中返回数据，或者直接查找根名称服务器。</p><h2 id="9156" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">根名称服务器</h2><p id="9997" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">根名称服务器包含构成根区域的信息，根区域是顶级域的全球列表。根区域包含:</p><ul class=""><li id="91eb" class="nu nv it lt b lu nd lx ne ma nw me nx mi ny mm nz oa ob oc bi translated">通用顶级域名，如<code class="fe mn mo mp mq b">.com</code>、<code class="fe mn mo mp mq b">.net</code>和<code class="fe mn mo mp mq b">.org</code></li><li id="94f3" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">国家代码顶级域名，如英国的<code class="fe mn mo mp mq b">.uk</code>。</li><li id="e49e" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">国际化顶级域名，本质上是用每个国家的本地字符集书写的顶级域名</li></ul><h2 id="9ac4" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">顶级域名服务器</h2><p id="fe71" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">顶级域名(TLD)是互联网域名系统根区域中最高级别的域名。互联网名称与数字地址分配机构(ICANN)负责大多数顶级域名。</p><h2 id="6fcd" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">权威名称服务器</h2><p id="018d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">权威名称服务器是名称服务器查询中的最后一个操作。如果权威名称服务器可以访问所请求的记录，它会将所请求主机名的IP地址返回给DNS recursor。该服务器保存实际的DNS记录(A、CNAME等。)对于特定的域</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="636b" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">权威DNS服务器vs递归DNS解析器？</h1><p id="493f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">主要区别是递归解析器在DNS查询的开始，而权威名称服务器在查询的结尾。</p><p id="6449" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">假设您的操作系统和web浏览器还没有缓存，客户端将请求递归DNS服务器找到与该网站相关联的IP地址。</p><p id="385e" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">递归服务器将检查自己是否缓存了该IP，以及它是否在有效的生存时间(TTL)内。如果没有，它将启动一个递归(重复一个过程并引用自身)过程，遍历权威DNS服务器层次结构。</p><p id="c824" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">权威DNS服务器负责目标网站的IP映射。权威服务器将响应递归服务器。</p><p id="b36c" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">Web托管公司通常管理权威服务器，递归服务器用于减轻权威服务器的负载并提供一定程度的缓存。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="b2e3" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">DNS查找(无缓存时的指南)</h1><p id="a54c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">用户在浏览器中键入网站，如<code class="fe mn mo mp mq b">medium.com</code>。该请求最初由DNS递归解析器拾取。</p><ol class=""><li id="aff0" class="nu nv it lt b lu nd lx ne ma nw me nx mi ny mm oi oa ob oc bi translated">DNS递归解析器查询DNS根目录<code class="fe mn mo mp mq b">nameserver (.)</code>。</li><li id="242b" class="nu nv it lt b lu od lx oe ma of me og mi oh mm oi oa ob oc bi translated">根服务器然后用一个TLD的地址响应，并被指向<code class="fe mn mo mp mq b">.com</code> TLD。向它发出请求。</li><li id="0ac4" class="nu nv it lt b lu od lx oe ma of me og mi oh mm oi oa ob oc bi translated">TLD域名服务器响应域名服务器的IP地址<code class="fe mn mo mp mq b">medium.com</code>。</li><li id="37fd" class="nu nv it lt b lu od lx oe ma of me og mi oh mm oi oa ob oc bi translated">递归解析器然后向域名服务器发送一个查询，然后<code class="fe mn mo mp mq b">medium.com</code>的IP地址从域名服务器返回给解析器。</li><li id="407c" class="nu nv it lt b lu od lx oe ma of me og mi oh mm oi oa ob oc bi translated">然后，该IP被发送回web浏览器，然后浏览器向该IP地址发出HTTP请求。呈现从服务器返回的内容。</li></ol></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="e1d8" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">DNS查询类型</h1><p id="038f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在典型的DNS查找中，使用三种类型的查询。</p><p id="8fb9" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">在理想情况下，缓存的记录数据将是可用的，允许DNS名称服务器返回非递归查询。</p><h2 id="70a1" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">递归DNS查询</h2><p id="c862" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于递归查询，如果解析器找不到记录，DNS客户端要求DNS服务器用资源记录或错误消息来响应客户端。</p><h2 id="2832" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">迭代DNS查询</h2><p id="4f48" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于重复的DNS查询，DNS客户端将允许DNS服务器返回它能返回的最佳答案。</p><p id="ad86" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">如果被查询的DNS服务器没有与查询名称匹配的域名，它将返回一个到权威DNS服务器的引用。然后，DNS客户端对引用地址进行查询。这一过程随着查询链中的其他DNS服务器而继续，直到出现错误或超时。</p><h2 id="b921" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">非递归DNS查询</h2><p id="7d04" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于非递归查询，DNS解析器已经知道答案。</p><p id="2464" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">它要么立即返回一个DNS记录，因为它已经将该记录存储在本地缓存中，要么查询该记录的权威DNS名称服务器。在这两种情况下，都不需要额外的查询，所以响应会立即返回给客户端。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="541d" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">DNS缓存，DNS缓存发生在哪里？</h1><p id="389b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">缓存将数据临时存储在一个位置，从而提高数据请求的性能和可靠性。</p><p id="fd97" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">DNS缓存将数据存储在离请求客户端更近的地方，以便可以更早地解析DNS查询，并避免其他查询。缓存缩短了加载时间。</p><p id="de81" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">DNS数据缓存在多个位置，每个位置将在由生存时间(TTL)确定的一段时间内存储DNS记录。</p><h2 id="1761" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">浏览器DNS缓存</h2><p id="5751" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Web浏览器被设计为在设定的时间内缓存DNS记录。</p><p id="25ab" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">DNS缓存离web浏览器越近，检查缓存并向IP地址发出正确请求所需的处理步骤就越少。</p><p id="15ae" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">浏览器缓存是检查所请求记录的第一个位置。</p><h2 id="8ff0" class="ni la it bd lb nj nk dn lf nl nm dp lj ma nn no ll me np nq ln mi nr ns lp nt bi translated">操作系统DNS缓存</h2><p id="5c26" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在DNS查询离开您的机器之前，您的操作系统是最后一个可以使用缓存的地方。</p><p id="2bc5" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">当浏览器中没有缓存记录时，操作系统解析器会检查其缓存以查看是否有该记录。</p><p id="4ff4" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">如果不匹配，它会在本地网络外部向互联网服务提供商(ISP)内部的DNS递归解析器发送DNS查询，这通常是默认设置或路由器内部设置的解析器。</p><p id="5f88" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">当递归解析器接收到DNS查询时，它还会检查所请求的主机转换是否已经存储在其缓存中。</p><p id="791d" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">递归解析器还具有附加功能，具体取决于其缓存中的记录类型。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="4566" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">递归解析器如何高效地解析</h1><ul class=""><li id="ffea" class="nu nv it lt b lu lv lx ly ma oj me ok mi ol mm nz oa ob oc bi translated">如果解析器没有A记录，但有权威名称服务器的NS记录，它将绕过DNS查询中的几个步骤，直接查询这些名称服务器。这种快捷方式可以防止从根和<code class="fe mn mo mp mq b">.com</code>名称服务器查找(在我们搜索<code class="fe mn mo mp mq b">example.com</code>时)，并有助于更快地解析DNS查询。</li><li id="7637" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">如果解析器没有NS记录，它将向TLD服务器发送一个查询(在我们的例子中是T2)，跳过根服务器。</li><li id="aa7f" class="nu nv it lt b lu od lx oe ma of me og mi oh mm nz oa ob oc bi translated">万一解析器没有指向TLD服务器的记录，它将查询根服务器。此事件通常在DNS缓存被清除后发生。</li></ul></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="4371" class="kz la it bd lb lc my le lf lg mz li lj jz na ka ll kc nb kd ln kf nc kg lp lq bi translated">结论</h1><p id="c0c1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">感谢阅读！</p></div></div>    
</body>
</html>