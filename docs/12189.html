<html>
<head>
<title>Write Quick Clean Swift By Learning Clean Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过学习干净的架构来编写快速干净的Swift</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/quick-clean-swift-4955d8ac6788?source=collection_archive---------4-----------------------#2022-05-18">https://betterprogramming.pub/quick-clean-swift-4955d8ac6788?source=collection_archive---------4-----------------------#2022-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f03e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在短时间内学习清晰的Swift架构基础知识。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2fcd1c8c5f42499e80886403aefb33f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtROa4YrWheqHdTMV7ZK0w.jpeg"/></div></div></figure><p id="cab2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">还记得我们这些iOS开发人员花费大量时间学习MVVM的那些日子吗？现在我相信迟早有一天，我们会到处去学习和掌握清洁建筑。那么我们为什么不从今天开始呢？</p><p id="f992" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，我将告诉你什么是干净的架构，这样你可以很快地学习到很多东西。</p><p id="7bf1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/96c7d93e773b3115e41cbb340205e8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/1*03L3z3U9h1gpHa2wt8ci2w.gif"/></div></figure><h1 id="e66c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">关于干净的Swift架构</h1><p id="3f34" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">Clean Swift(简称VIP)是Bob大叔适配iOS和macOS项目的Clean架构。用于编写干净Swift代码的VIP架构是由Raymond Law引入的。<br/>你可能知道，VIP代表视图—交互者—演示者。</p><p id="2e44" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种架构中的项目结构是围绕场景构建的。场景应该包含以下组件:</p><ul class=""><li id="5b0a" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">视图控制器</li><li id="3ef2" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">互动者</li><li id="5b74" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">提出者</li><li id="ce03" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">工人</li><li id="e829" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">模型</li><li id="246c" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">路由器</li><li id="d41d" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">配置器(可选)</li></ul><p id="867b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">换句话说，我们将为每个场景准备一套组件，用于我们的控制器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/0782559f5284a1675f0cf3d1993c7e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*T5Upq7ZSr-Z_8wWXG0wtyA.jpeg"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">干净的Swift架构周期</p></figure><h1 id="b99a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">VIP周期</h1><ol class=""><li id="b603" class="ml mm iq kt b ku mg kx mh la ne le nf li ng lm nh mr ms mt bi translated">视图控制器接受一个用户事件，构造一个请求对象，并将其发送给交互器。</li><li id="d758" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nh mr ms mt bi translated">交互器使用workers对请求进行一些处理，构造一个响应对象，并将其发送给表示器。</li><li id="d8ca" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nh mr ms mt bi translated">演示者格式化响应中的数据，构造视图模型对象，并将其发送给视图控制器。</li><li id="e5ff" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nh mr ms mt bi translated">视图控制器向用户显示视图模型中包含的结果。</li></ol><p id="e2c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在让我们更深入地看看每个组件:</p><h1 id="bd60" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">视图控制器</h1><p id="9b2e" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">与互动者交流，并从演示者那里获得反馈。</p><ul class=""><li id="d31b" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">包含视图。</li><li id="45ff" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">保存交互器和路由器的实例。</li><li id="4364" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">将动作从视图传递给交互器(业务逻辑),并将演示者的动作作为输入。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">清洁Swift ViewController</p></figure><h1 id="0728" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">互动者</h1><p id="a073" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">工人和主持人之间的调解人。</p><ul class=""><li id="5a92" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">包含场景的业务逻辑。</li><li id="03f8" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">保留对演示者的引用。</li><li id="bf2b" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">基于输入(来自视图控制器)对工人运行操作，触发并将结果传递给演示者。</li><li id="caf4" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">交互器不应该导入UIKit。</li><li id="f433" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">交互器也包含两种类型的协议，就像路由器一样:<br/> 1。业务逻辑协议<em class="nk"> — </em>在这个协议中声明所有的Interactor方法，因此它们可以在ViewController中使用。<br/> 2。数据存储协议—应该保持其当前状态的所有属性都在此处声明。该协议主要用于路由器的控制器之间传递数据。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">清洁Swift互动器</p></figure><h1 id="6501" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">提出者</h1><p id="c5e6" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">将交互器的结果格式化为视图模型，并将结果传递回视图控制器。</p><ul class=""><li id="5b57" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">保留对视图控制器的弱引用，该视图控制器是演示者的输出。</li><li id="839f" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">在交互器产生一些结果后，它将响应传递给表示器。接下来，展示者将响应整理成适合于显示的视图模型，然后将视图模型传递回视图控制器以显示给用户。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">清洁Swift演示者</p></figure><h1 id="ce58" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">工人</h1><p id="fac2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">处理所有API/数据库请求和响应。</p><ul class=""><li id="b95b" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">一个处理不同底层操作的抽象，比如从核心数据中提取用户，下载个人资料照片，允许用户喜欢和关注，等等。</li><li id="680d" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">应遵循单一责任原则(一个交互者可能包含许多具有不同责任的工作者)。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">干净利落的工人</p></figure><h1 id="85a6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">模型</h1><p id="e59c" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">存储所有数据模型。</p><ul class=""><li id="1100" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">解耦的数据抽象。</li><li id="badb" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">包含<code class="fe nl nm nn no b">Request</code>、<code class="fe nl nm nn no b">Response</code>和<code class="fe nl nm nn no b">ViewModel</code>数据模型。</li><li id="f584" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">请求有时可以是一个空结构(比如当我们没有任何post参数或DB查询时)。</li><li id="fabe" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">每个数据模型都要在特定的组件中创建和使用:<br/> <code class="fe nl nm nn no b">Request</code>:在视图控制器中创建，在交互器中使用。<br/> <code class="fe nl nm nn no b">Response</code>:在交互器中创建，在演示器中使用。<br/> <code class="fe nl nm nn no b">ViewModel</code>:在presenter中创建，在view controller中使用。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">干净的Swift模型</p></figure><h1 id="3a97" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">路由器</h1><p id="f4e3" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">负责视图控制器之间的转换和传递数据。</p><ul class=""><li id="dffe" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">从视图控制器中提取导航逻辑。</li><li id="1404" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">保持对视图控制器的弱引用。</li><li id="3243" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">声明了两个协议:<br/> 1。路由逻辑协议<em class="nk"> — </em>所有用于路由的方法都遵循该协议。<br/> 2。<em class="nk"> </em>数据传递协议<em class="nk"> </em> —包含需要传递到目的控制器的数据的协议。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">清洁Swift路由器</p></figure><h1 id="4195" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">配置程序</h1><p id="bad0" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">获取原始视图控制器并返回已配置的视图控制器。</p><ul class=""><li id="278b" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">一个可选组件，负责通过封装所有实例的创建并在需要的地方分配它们来配置VIP周期。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">干净的Swift配置器</p></figure><p id="b65c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您阅读了本文中的示例代码，您可能已经注意到我们有另一个名为<code class="fe nl nm nn no b">SceneFactory</code>的对象。<br/> <code class="fe nl nm nn no b">SceneFactory</code>不过是一个保存场景配置器实例并使用它们制作场景的类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div><p class="na nb gj gh gi nc nd bd b be z dk translated">清洁快速场景工厂</p></figure><p id="9907" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，对于您项目的文件结构，您可以遵循以下方案:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/0c66bc584620a4631b3c3e611c5ac482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*70C_Gwwc8S3qxq-P33uiNQ.png"/></div></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="e4bd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些是干净的Swift架构的基础。目前，我正在做一个有3个视图的示例clean项目，它几乎涵盖了所有的架构挑战，比如clean+coordinator和delegates。<br/>如果你想获得关于clean architecture的未来帖子的通知，包括提到的示例项目和高级Xcode clean architecture模板，可以关注我。</p><p id="8717" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读。我希望你喜欢！</p></div></div>    
</body>
</html>