<html>
<head>
<title>Demeter’s Law: Don’t talk to strangers!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">德米特里定律:不要和陌生人说话！</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/demeters-law-don-t-talk-to-strangers-87bb4af11694?source=collection_archive---------2-----------------------#2019-09-26">https://betterprogramming.pub/demeters-law-don-t-talk-to-strangers-87bb4af11694?source=collection_archive---------2-----------------------#2019-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a8a3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">软件工程原理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0c674604aa82783b86732a9af6d8c44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zz682r8f1fW0odg0bSLYKA.jpeg"/></div></div></figure><blockquote class="ku"><p id="85a1" class="kv kw it bd kx ky kz la lb lc ld le dk translated">德米特定律(LoD)或最少知识原则(T10)是开发软件，尤其是面向对象程序的设计指南。</p></blockquote><p id="3cd5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma le im bi translated">— <em class="mb">维基百科</em></p><p id="79fd" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">这个定律是伊恩·霍兰德在1987年提出的。Holland和他的同事正在使用面向对象编程来设计一个叫做<em class="mb"> Demeter </em>的系统。在系统开发过程中，他们意识到满足一系列规则的代码耦合度较低。</p><p id="6ae3" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">德米特里定律被称为“不要和陌生人说话”，因为:</p><ol class=""><li id="a0bb" class="mh mi it li b lj mc lm md lp mj lt mk lx ml le mm mn mo mp bi translated">每个单元应该只对其他单元有有限的了解——只有与当前单元“密切”相关的单元。</li><li id="deb4" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mm mn mo mp bi translated">各单位只和自己的朋友说话— <em class="mb">不要和陌生人说话</em>。</li><li id="af0f" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mm mn mo mp bi translated">只和你最亲近的朋友说话。</li></ol><p id="2385" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">更正式地说，Demeter法则要求对象<em class="mb">或</em>的方法<em class="mb"> m </em>只能调用以下类型对象的方法:</p><ul class=""><li id="222b" class="mh mi it li b lj mc lm md lp mj lt mk lx ml le mv mn mo mp bi translated"><em class="mb"> O </em>本身。</li><li id="6bd1" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mv mn mo mp bi translated"><em class="mb"> m的</em>参数。</li><li id="f09b" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mv mn mo mp bi translated">在m 内创建/实例化的任何对象<em class="mb">。</em></li><li id="545f" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mv mn mo mp bi translated">o的直接组件对象。</li><li id="bc9c" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mv mn mo mp bi translated">一个全局变量，<em class="mb">可由O访问，在m </em>的范围内。</li></ul><p id="5576" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">总之，上面所有的规则都可以总结为:应该避免调用由另一个方法返回的成员对象的方法。在现代面向对象语言中，使用的标识符是<code class="fe mw mx my mz b">dot</code>或<code class="fe mw mx my mz b">-&gt;</code>。因此，当代码在类之间有多个步骤时，就违反了德米特定律。例如，以下代码显示了违反德米特里定律的示例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/9ad61918175824eed8e4c54ff1b85a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*INzo8h9xDf-l6h1HdVMTuA.png"/></div></div></figure><p id="8940" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">在这种情况下，来自A类的对象<code class="fe mw mx my mz b">a</code>可以请求B类的对象实例的方法，但是对象A <em class="mb">不应该直接到达</em>对象B，因为这意味着对象A对对象B的内部结构有更多的了解(紧耦合)。</p><p id="c8dd" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">下图说明了阶级之间谁是朋友的关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b6cf5c4b282af6a5d4cb32720632e874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/0*SQJijRVd2Xeom69p.png"/></div></figure><h1 id="1803" class="nc nd it bd ne nf ng nh ni nj nk nl nm jz nn ka no kc np kd nq kf nr kg ns nt bi translated">真实例子—人→房子→地址</h1><p id="be9b" class="pw-post-body-paragraph lg lh it li b lj nu ju ll lm nv jx lo lp nw lr ls lt nx lv lw lx ny lz ma le im bi translated">现在，我将展示一个用TypeScript实现的真实例子。在下面的UML图中，您可以看到,<code class="fe mw mx my mz b">Person</code>与<code class="fe mw mx my mz b">House</code>相关，而<code class="fe mw mx my mz b">House</code>与<code class="fe mw mx my mz b">Address</code>相关。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/8318c2ae1b6bd1f2025f84efa5efe96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hV9tWEUwQulX2eyH.jpg"/></div></div></figure><p id="58e1" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">原代码来自<a class="ae oa" href="https://github.com/tavaresasilva/LoDRaV" rel="noopener ugc nofollow" target="_blank">https://github.com/tavaresasilva/LoDRaV</a>，用JAVA编码。</p><p id="14bd" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">下面的代码可以在客户端/上下文中运行，而第一个代码违反了德米特定律，因为<code class="fe mw mx my mz b">Person</code>需要了解类<code class="fe mw mx my mz b">House</code>的内部实现。另一方面，第二种实现遵循Demeter定律，代码耦合度较低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/dfd256b6eb9b16561f8ceb1cf809a432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iBw_gPCWpsZl9Q0O-aoSw.png"/></div></div></figure><p id="8bfe" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">下面的步骤表明，您必须实现代码以遵守Demeter定律，并获得耦合度较低的代码。因此，第一步是创建将在我们的具体类中实现的接口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/2a229d4e381af033b8692eac7101400b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFUBDkjzfC7pF_EYoYtrXg.png"/></div></div></figure><p id="241e" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">下一步将是具体类的实现，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/09e8a8824581716a18197ae1aaa44597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-gCvOlI_z51vV9-QIMleg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/cea99525b11286fe1be32bc49121fee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PoY1fyqgeCibRbZwCG3Q1w.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/8fad78458e37c1464472e81ade41208a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DAu5brBVNYzsSK0eTKwCKA.png"/></div></div></figure><p id="596f" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">代码中最重要的一点是，没有任何方法违反了德米特里定律(被包含对象的连续调用不超过两次)。</p><p id="7ecc" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">这是另一个违反德米特里定律的例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/48279aba218a542cb9213dcb27bf30cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhr6ncJTK1vuiSyouWg8nQ.png"/></div></div></figure><p id="b407" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">在这种情况下，解决方案是在类<code class="fe mw mx my mz b">person</code>中实现<code class="fe mw mx my mz b">isZipCode</code>方法，如下面的代码所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/13cb5493137c82460ed30714b265496f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNQRAcDWinypyzoCtz5FuQ.png"/></div></div></figure></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><h1 id="eb0c" class="nc nd it bd ne nf om nh ni nj on nl nm jz oo ka no kc op kd nq kf oq kg ns nt bi translated">优势</h1><p id="4bdc" class="pw-post-body-paragraph lg lh it li b lj nu ju ll lm nv jx lo lp nw lr ls lt nx lv lw lx ny lz ma le im bi translated">满足德米特里定律的主要优点是:</p><ol class=""><li id="88cd" class="mh mi it li b lj mc lm md lp mj lt mk lx ml le mm mn mo mp bi translated">减少了类之间的依赖性和耦合。</li><li id="2cbc" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mm mn mo mp bi translated">可以轻松地重用类。</li><li id="bfaa" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mm mn mo mp bi translated">代码更容易测试。</li><li id="e0bb" class="mh mi it li b lj mq lm mr lp ms lt mt lx mu le mm mn mo mp bi translated">代码更易维护，对变化更灵活。</li></ol></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><h1 id="71da" class="nc nd it bd ne nf om nh ni nj on nl nm jz oo ka no kc op kd nq kf oq kg ns nt bi translated">越来越多</h1><p id="1528" class="pw-post-body-paragraph lg lh it li b lj nu ju ll lm nv jx lo lp nw lr ls lt nx lv lw lx ny lz ma le im bi translated">【http://www.ccs.neu.edu/home/lieber/LoD.html<br/><a class="ae oa" href="https://en.wikipedia.org/wiki/Law_of_Demeter" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Law_of_Demeter</a><br/><a class="ae oa" href="https://hackernoon.com/the-law-of-demeter-in-the-era-of-microservices-3186f4c399a1" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/the-law-of-Demeter-in-the-era-of-micro-services-3186 f4c 399 a1</a><br/><a class="ae oa" href="https://testing.googleblog.com/2008/07/breaking-law-of-demeter-is-like-looking.html" rel="noopener ugc nofollow" target="_blank">https://testing . Google blog . com/2008/07/breaking-law-of-of-Demeter-is-like-looking . html</a><br/><a class="ae oa" href="http://www.virtuouscode.com/2011/07/05/demeter-its-not-just-a-good-idea-its-the-law/" rel="noopener ugc nofollow" target="_blank">http://www</a></p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="0593" class="pw-post-body-paragraph lg lh it li b lj mc ju ll lm md jx lo lp me lr ls lt mf lv lw lx mg lz ma le im bi translated">这个岗位的GitHub分支是<a class="ae oa" href="https://github.com/Caballerog/blog/tree/master/demeter-law" rel="noopener ugc nofollow" target="_blank">https://github.com/Caballerog/blog/tree/master/demeter</a></p></div></div>    
</body>
</html>