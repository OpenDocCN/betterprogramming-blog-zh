<html>
<head>
<title>What Is JSON Web-Token Authentication?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是JSON Web令牌认证？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-json-web-token-authentication-a2962f8c5267?source=collection_archive---------9-----------------------#2020-01-27">https://betterprogramming.pub/what-is-json-web-token-authentication-a2962f8c5267?source=collection_archive---------9-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="19ea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对JSON Web令牌(JWT)和会话id的高级理解</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3ca232d7b7c223473acba159a1c12cc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7xOInCP8r7RsAPb_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@zisun_word?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">孙富</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7ac9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我在工作中的代码库中遇到了JWT认证的用法。我很想弄清楚JWT和标准会话令牌/IDs之间的机制差异，尤其是因为JWT最近越来越受欢迎。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c941" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为什么我们需要认证？</h1><p id="91ff" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">HTTP是一种无状态协议，这意味着当前的客户端请求独立于任何以前的请求，服务器不知道任何以前的请求。</p><p id="9cae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果您只是简单地获取静态数据，<strong class="lb iu"> </strong>比如访问<code class="fe mz na nb nc b">www.facebook.com</code>，服务器并不需要知道客户端是谁，因为它们返回的是登录页面，而不是任何形式的敏感信息。另一方面，如果你想更改你在脸书的个人资料，你必须在脸书的服务器将信息返回给你之前证明你拥有这个账户。</p><p id="4acb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，在服务器允许您访问敏感信息之前，您需要验证自己的身份。为了理解对JWTs的需求，让我们后退一步来理解当前仍然广泛使用的会话令牌模型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8764" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用会话令牌进行认证</h1><p id="990f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在会话令牌模型中，用户登录并授权后，服务器会创建一个客户端独有的会话。服务器将会话ID返回给客户机，然后客户机将它存储在浏览器的cookie中。</p><p id="d38b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在随后的HTTP调用中，cookie将自动包含在HTTP请求的头部，服务器将能够知道客户机的身份。尽管cookie存储在客户端，但由于验证是在服务器上完成的，因此该模型仍然构成服务器端会话。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/b5464ea226f3e23323bc8a863612c019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhK7q8YeV-PW2I6z6KXRsQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用会话id的整体架构</p></figure><p id="c387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能会想——如果HTTP协议是无状态的，服务器如何记住客户机的身份？</p><h2 id="ff81" class="ne md it bd me nf ng dn mi nh ni dp mm li nj nk mo lm nl nm mq lq nn no ms np bi translated">服务器端会话:实际上不是无状态的</h2><p id="94f6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">从技术上讲，HTTP无状态协议并不禁止服务器存储信息。大多数web应用程序需要存储某种形式状态，以便知道客户端的会话ID是否有效。</p><p id="1942" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，服务器可能有一个存储会话ID的会话日志(可能是一个哈希表或数据库),因此每当以前通过身份验证的客户端发出请求时，服务器只需查找会话ID并验证客户端是否通过身份验证。</p><h2 id="45e3" class="ne md it bd me nf ng dn mi nh ni dp mm li nj nk mo lm nl nm mq lq nn no ms np bi translated">会话令牌的优点</h2><ul class=""><li id="eaa5" class="nq nr it lb b lc mu lf mv li ns lm nt lq nu lu nv nw nx ny bi translated">会话id有过期时间</li><li id="eb7b" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">可以撤销会话id</li><li id="1ad6" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">较小的cookie大小(本质上是一个加密的会话ID)</li></ul><h2 id="5354" class="ne md it bd me nf ng dn mi nh ni dp mm li nj nk mo lm nl nm mq lq nn no ms np bi translated">会话令牌的缺点</h2><ul class=""><li id="63c2" class="nq nr it lb b lc mu lf mv li ns lm nt lq nu lu nv nw nx ny bi translated">可伸缩性是确保跨所有服务器的会话日志的一个挑战</li></ul><p id="3b55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上图中，我们假设了一个简化的整体架构，其中一个客户端与一个服务器通信。然而，在现实中，我们可能会期望一个类似如下的多石架构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/fc21d3c165f180984002df64c12f0073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*plIDu2m0NJP9Gocwq1bCJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有会话id的多石架构</p></figure><p id="7edc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在某种程度上，这种多石架构有助于在一定程度上抵消可伸缩性的挑战。确保所有服务器拥有相同会话日志的一种方法是用负载平衡器分发请求，并使用所有服务器共享的Redis缓存。虽然这是确保会话日志同步的一个可行的解决方法，但是现在有一个单点故障(Redis缓存)。</p><p id="bf75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我只讨论了一些我愿意谈论的优点和缺点，但是如果你有兴趣了解更多，你可以阅读这篇讨论<a class="ae ky" href="http://www.rodsonluo.com/client-session-vs-server-session" rel="noopener ugc nofollow" target="_blank">服务器与客户端</a>会话的文章。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="660b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">JSON Web-Token (JWT)认证</h1><p id="512a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在JWT模型中，用户登录后，服务器不会返回会话ID，而是向客户端返回一个签名的令牌<strong class="lb iu"> </strong>。这个已签名的令牌本质上是一个JSON对象，包含服务器使用秘密或公钥/私钥签名的认证信息。</p><p id="e3d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在后续的HTTP请求中，客户端只需在请求中传递JWT，每个服务器实例都有能力解密令牌并对用户进行身份验证。</p><h2 id="c776" class="ne md it bd me nf ng dn mi nh ni dp mm li nj nk mo lm nl nm mq lq nn no ms np bi translated">JWT的优点</h2><ul class=""><li id="52a2" class="nq nr it lb b lc mu lf mv li ns lm nt lq nu lu nv nw nx ny bi translated">消除了存储会话id的缓存/数据库需求</li></ul><h2 id="a873" class="ne md it bd me nf ng dn mi nh ni dp mm li nj nk mo lm nl nm mq lq nn no ms np bi translated">JWT的缺点</h2><ul class=""><li id="9086" class="nq nr it lb b lc mu lf mv li ns lm nt lq nu lu nv nw nx ny bi translated">无法从服务器撤销令牌，因为它们只能确定令牌是否有效</li></ul><p id="2926" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再说一次，我只是略述了JWT的利与弊，但是你可以查看这篇关于JWT利与弊的深入文章。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="41ec" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">最终注释</h1><p id="1f3e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这篇文章旨在简化我自己对jwt的理解，我希望它能帮助你理解一些概念。</p><p id="8676" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想看一些视觉效果，我强烈推荐这个<a class="ae ky" href="https://www.youtube.com/watch?v=soGRyl9ztjI" rel="noopener ugc nofollow" target="_blank"> YouTube视频</a>，它帮助我快速掌握了概念。</p></div></div>    
</body>
</html>