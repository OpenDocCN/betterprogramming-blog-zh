# 如何编写安全的 JavaScript 并避免函数中途返回

> 原文：<https://betterprogramming.pub/how-to-check-for-javascript-properties-without-mid-function-returns-46f39d09975b>

## 假设积极的一面，同时抓住灾难

![](img/650a4755a98b6073bec998191de9c36e.png)

Joan Gamell 在 [Unsplash](https://unsplash.com/s/photos/javascript?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

假设您正在编写一个接受来自其他地方的数据的 JavaScript 程序——并且您想让它防弹。要让这个程序工作，你必须写一个特殊的函数，它接受一个对象作为参数。它接受的对象类型具有深度嵌套的属性，如下所示。

您的函数将不得不钻取这个教师对象，以获得它需要的值。

为了防止由于遇到`undefined`值而导致的错误，您需要检查这些属性是否存在。

# 使用中间函数返回向下钻取

假设您想编写一个函数，返回教师班级列表中的第一个班级。要实现这一点，您需要深入几个层次。处理这种情况的一种方法是使用中间函数返回，它让你在第一次出现问题时就退出程序。也就是说，使用它们是有代价的。考虑这个返回教师第一堂课的示例函数:

这些中间函数返回埋没了函数的用途。

这个函数把 mid-function returns 发挥到极致，结果很可笑。大部分功能是检查每一个可能的问题。我从这个函数中得到的总体感觉是，一场大灾难在意料之中。

# 紧急呼叫接线员进行救援

幸运的是，我们可以通过 AND ( `&&`)操作符避免灾难优先的思维模式。这个操作符的好处是它让我们的程序从左到右检查条件——例如，我们可以在检查`teacher.data`之前检查`teacher`。请看下面:

AND 运算符让我们可以安全地查找嵌套值。

在这里，我们首先处理正面案例*并仍然返回底部的`null`，但前提是先前的努力失败。让我们来看看会发生什么:*

*   *如果没有`teacher`对象，程序马上脱离`if`状态，返回`null`。*
*   *如果有一个`teacher`没有`data`属性，程序在第二次检查后中断并再次返回`null`。*
*   *如果老师有一个`classes`属性，我们检查`length`。*
*   *如果`classes`阵的`length`在`0`之上，那么我们就可以取回第一级！*
*   *同样，只有当所有这些检查都失败时，我们才返回`null`。*

# *优雅地检查*

*使用 OR ( `||`)操作符还有一种更优雅的方式。考虑下面修改后的函数:*

*更紧凑的 getFirstClass 函数。*

*这里，我们使用了`||`操作符，这样我们只返回第一个类，如果它被定义的话。如果没有定义，我们可以返回`null`。*

*你可以在下面的代码笔中看到所有这些功能。随意叉和实验。*

*检索嵌套值的三种方法。*

# *检查第一个学生*

*下面是一个更深入的函数，检查第一个班级中的第一个学生，而不使用中间函数返回。注意我们结合了前面例子中的方法，检查类对象的`length`，然后对`pupils`数组使用`||`操作符。*

*带有 AND 和 OR 运算符的 getFirstPupil 函数。*

*您可以在下面的操作中看到这一点。*

*使用 AND 和 or 运算符检查第一个瞳孔。*

# *最后的想法*

*对我来说，`&&`操作符帮助我在编写函数时保持乐观。通过允许我渐进地深入一个对象，它让我在检查以确保必要的属性存在的同时假定最佳的结果——并在它们不存在时处理这种情况。*

*[](/7-approaches-to-rewriting-javascript-from-my-early-days-c6ada526d55f) [## 我早期用来重写 JavaScript 代码的 7 个技巧

### 3.移除过多的中间函数返回

betterprogramming.pu](/7-approaches-to-rewriting-javascript-from-my-early-days-c6ada526d55f)*