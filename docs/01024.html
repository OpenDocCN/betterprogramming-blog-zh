<html>
<head>
<title>4 Basic Python Tips to Automate Your Workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化工作流程的4个基本Python技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-basic-python-tips-to-automate-your-workflow-befabe140b83?source=collection_archive---------1-----------------------#2019-08-08">https://betterprogramming.pub/4-basic-python-tips-to-automate-your-workflow-befabe140b83?source=collection_archive---------1-----------------------#2019-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7469" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让它看起来像你在工作，当你不在的时候</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f09d8b84514f6832e9195081dd4488b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_1gSFV4F53-X2bA1ie18Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@davidleveque?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> DXL </a>在<a class="ae ky" href="https://unsplash.com/search/photos/robots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="44ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动化。它应该可以消除工作。那么，为什么不帮助它呢？</p><p id="6fb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说实话，即使是简单任务的自动化也需要时间和大量的依赖管理，这会变得非常复杂。</p><p id="0949" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，将一些简单的任务自动化是非常有益的。即使更多的是为了好玩。</p><p id="a943" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于那些已经是<a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>粉丝的人来说，你知道Python对于与任何东西交互是多么友好。从发送HTTP请求，与<a class="ae ky" href="https://medium.com/better-programming/using-python-to-scrape-meet-up-api-38e15f1354f" rel="noopener">API</a>交互，到<a class="ae ky" href="http://www.acheronanalytics.com/acheron-blog/how-to-load-multiple-files-into-your-database-with-python-and-sql" rel="noopener ugc nofollow" target="_blank">加载和管理数据库</a>。</p><p id="b122" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python是自动化的绝佳选择。</p><p id="aab7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有五个简单的事情，你可以自动化，可以帮助你的各种工作流程和项目。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="52d0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.自动移动鼠标，让您的Skype/Lynk显示您在工作中的活跃状态</h1><p id="aa9f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">想象一下，在过去的十分钟里，你一直在浏览你最喜欢的社交媒体应用的新闻提要。突然，您的<a class="ae ky" href="https://lynk.global/" rel="noopener ugc nofollow" target="_blank"> Lynk </a>活动符号变成黄色。您不活跃，不在会议中。</p><p id="2ca2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你爱管闲事的老板走过来拍了拍你的肩膀。</p><p id="691d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">惊讶之余，你抬头看到他正怒视着你。他有一个坏习惯，就是对你的每一秒钟都进行微观管理。</p><p id="431f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“嘿，呃，我想让你放松，除了那个模块进展如何，”他问道。你咬紧牙关，礼貌地回答。</p><p id="7cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“酷，好吧，我只是想确定你正在集中注意力。我们的副总裁贾尼斯非常希望我们能在最后期限前完成任务。”</p><p id="b045" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">互动结束。</p><p id="9a00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要是林克没那样叫你就好了。</p><p id="c563" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等等，你可以绕过这个。在谷歌搜索了一会儿之后，你找到了一个移动鼠标的脚本，并开始编写一个每隔几分钟运行一次的任务，以确保你的鼠标在移动。</p><p id="5ff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就Skype或Lynk而言，鼠标和键盘的这些移动有助于让你看起来像是在积极工作。</p><p id="4652" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动化运动使用Python的<a class="ae ky" href="https://pyautogui.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> PyAutoGUI模块</a>。要安装PyAutoGUI模块，请运行以下命令:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b7c4" class="ne md it na b gy nf ng l nh ni">pip install pyautogui</span></pre><p id="08ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python使用屏幕的坐标系来控制和跟踪鼠标。例如，如果您使用1920x1080的屏幕分辨率，屏幕的坐标系将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/036f7e94d5fbf191834fd418b2a16fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*iVh--r5b0PPF9xZTjb4-5w.png"/></div></figure><p id="a528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PyAutoGUI模块下提供了以下函数:</p><ul class=""><li id="3357" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><code class="fe nt nu nv na b">size()</code>:<code class="fe nt nu nv na b">size()</code>功能让你知道你的屏幕分辨率。</li></ul><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b0f5" class="ne md it na b gy nf ng l nh ni">import pyautogui<em class="nw"><br/></em>print(pyautogui<em class="nw">.size())</em></span></pre><p id="7970" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个文件(保存为<code class="fe nt nu nv na b">.py</code>扩展名)，Python代码使用<code class="fe nt nu nv na b">size()</code>函数给出屏幕分辨率的x，y格式作为输出:</p><ul class=""><li id="75e5" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><code class="fe nt nu nv na b">moveTo()</code>:PyAutoGUI模块中的<code class="fe nt nu nv na b">moveTo()</code>功能移动鼠标。下面的代码使用函数，该函数接受x和y的坐标，以及一个可选的持续时间参数。该函数使用指定的持续时间参数将鼠标指针从当前位置移动到x和y坐标。</li></ul><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1afe" class="ne md it na b gy nf ng l nh ni">import pyautogui<em class="nw"><br/></em>print(pyautogui.size())</span><span id="6271" class="ne md it na b gy nx ng l nh ni">pyautogui.moveTo(150,100, duration = 2)</span></pre><p id="e5ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个Python脚本神奇地将鼠标指针从当前位置移动到坐标(<code class="fe nt nu nv na b">150, 100</code>)，用了<code class="fe nt nu nv na b">2</code>秒来完成这个过程。</p><p id="05d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了这些基本功能之外，您还可以对单击和键入字符串使用函数，如click和type。</p><p id="ae3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些都有助于确保你的老板不会很快发现你偷懒。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="651b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.使用Selenium自动化网站登录过程</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/572432deba4925d472b6facb25312cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZP7ABksYfiMkCG9bh3qzQ.png"/></div></div></figure><p id="f852" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">许多网站不赞成使用自动爬虫和程序登录他们的网站。但是，这仍然是一项很好的技能。</p><p id="9c1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Selenium 是一个有用的库，可以被多种语言使用，可以帮助自动化UI QA，甚至可以通过登录来抓取网站。</p><p id="15e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然学习硒需要一些时间，但是要从小处着手。搭建一个可以登录自己喜欢的网站的工具就可以了。</p><p id="5dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，你必须安装Chrome驱动程序和Python的Selenium库。使用下面的命令添加Selenium库。：</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7478" class="ne md it na b gy nf ng l nh ni">pip install Selenium</span></pre><p id="7333" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要从Python的Selenium库中导入一些选定的模块。添加下面的命令:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="fa6c" class="ne md it na b gy nf ng l nh ni">From selenium import webdriver</span><span id="e27b" class="ne md it na b gy nx ng l nh ni">driver = webdriver.Chrome()</span></pre><p id="6161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了自动化登录过程，我们从一个简单的任务开始，比如网站的登录表单。</p><p id="4a44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这项任务需要:</p><ul class=""><li id="b360" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated">导航到网站。</li><li id="3a50" class="nk nl it lb b lc nz lf oa li ob lm oc lq od lu np nq nr ns bi translated">查找登录字段(通常是用户名和密码)。</li><li id="0a7a" class="nk nl it lb b lc nz lf oa li ob lm oc lq od lu np nq nr ns bi translated">填写您的登录信息。</li><li id="f063" class="nk nl it lb b lc nz lf oa li ob lm oc lq od lu np nq nr ns bi translated">提交登录详细信息，让您自动通过登录屏幕。</li></ul><p id="3906" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">提示:</strong>您可能决定定义一个“方法”(用于频繁登录)来支持在其他测试中的重用。</p><p id="a7bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码行将类似于:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="1803" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您会注意到，您需要获得想要与之交互的元素。这可以说是创建web抓取器或登录网站的自动化脚本最困难的部分之一。</p><p id="50b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几种方法可以检测web应用程序的元素以找到登录字段。</p><p id="e431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查找元素的常见方法包括ID(如上例)、CSS选择器、名称和XPaths。</p><p id="706a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Selenium 的官方文档<a class="ae ky" href="http://selenium-python.readthedocs.io/locating-elements.html" rel="noopener ugc nofollow" target="_blank">中可以找到定位登录流程元素的不同方法。一些网站包含更多动态内容(比如几个JavaScript！).</a></p><p id="1673" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，看着Selenium自动点击按钮并登录你最喜欢的网站是令人着迷的。没有你的参与，事情就开始运转。</p><p id="adb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几乎像魔术一样！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="552e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.自动文件备份</h1><p id="c73f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您执行定期备份，创建自动备份文件会非常有用。</p><p id="e7c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能熟悉ZIP文件(带有。zip扩展名)。ZIP文件可以包含几个带有压缩内容的文件。此外，由于ZIP文件还可以包含许多文件夹和子文件夹，因此通过将它们打包成一个文件来备份文件是一种便捷的方式。</p><p id="7d7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以使用<a class="ae ky" href="https://docs.python.org/3/library/zipfile.html" rel="noopener ugc nofollow" target="_blank"> zipfile模块</a>中的Python函数自动创建一个单独的ZIP文件，称为归档文件。</p><p id="97ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以使用Python打开(或提取)ZIP文件。脚本分享如下。</p><p id="8fd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个脚本摘自《T4》一书《用Python自动化枯燥的东西》(如果你想要更多的想法)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dd52" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">4.自动将YouTube视频发布到Reddit线程</h1><p id="72b4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们最近看到并想到的另一个一次性想法是<a class="ae ky" href="https://jimblackler.net/blog/?p=402" rel="noopener ugc nofollow" target="_blank">一种有趣的</a>自动化您可能经常做的任务的方式，即使用一个脚本将多个视频发布到Reddit。</p><p id="471e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Reddit线程中发布YouTube视频也可以实现自动化。使用<a class="ae ky" href="https://praw.readthedocs.io/en/latest/getting_started/installation.html" rel="noopener ugc nofollow" target="_blank"> PRAW </a>，一个让你抓取数据的Python包装器，可以为你的Reddit体验提供更多。</p><p id="4268" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，<a class="ae ky" href="https://praw.readthedocs.io/en/latest/getting_started/installation.html" rel="noopener ugc nofollow" target="_blank">使用<a class="ae ky" href="https://pypi.org/project/pip/" rel="noopener ugc nofollow" target="_blank"> pip </a>安装PRAW </a>。</p><p id="bcd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的脚本自动将YouTube视频发布到Reddit线程。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9915" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="88f0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">自动化任务会很有趣。看着你的程序自动登录到你最喜欢的网站，或者<a class="ae ky" href="https://www.theseattledataguy.com/automating-file-loading-into-sql-server-with-python-and-sql/" rel="noopener ugc nofollow" target="_blank">把几百个文件加载到一个数据库</a>，会让你觉得好像重新设计了轮子。</p><p id="8d4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而且，有很多很棒的库可以帮助您轻松地自动化任务。<a class="ae ky" href="https://office.live.com/start/Excel.aspx" rel="noopener ugc nofollow" target="_blank"> Excel </a>报告、电子邮件和其他任务可以简化为几行代码。</p><p id="9a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只要是可维护的！</p></div></div>    
</body>
</html>