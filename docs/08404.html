<html>
<head>
<title>How To Plot Your Data on Maps Using Python and Folium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python和Folium在地图上绘制数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-plot-your-data-on-maps-using-python-and-folium-20c8bb39a7e2?source=collection_archive---------3-----------------------#2021-04-27">https://betterprogramming.pub/how-to-plot-your-data-on-maps-using-python-and-folium-20c8bb39a7e2?source=collection_archive---------3-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="07ef" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用Python与data和Leaflet.js在制图方面的强大功能来创建丰富的地图可视化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/08b0119169185351518d47e2458a5fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAxkrEl4G9_E_PdhI94lfQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左拉周在<a class="ae ky" href="https://unsplash.com/s/photos/maps?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="032b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/python-visualization/folium" rel="noopener ugc nofollow" target="_blank">yellow</a>是一个Python包，它将Python提供的用于操作数据的所有工具与<a class="ae ky" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank"> Leaflet </a> JavaScript库结合起来，以创建丰富的交互式地图。</p><p id="907a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和我的文章一样，我提供了一个Google <a class="ae ky" href="https://colab.research.google.com/drive/1MnZepW9RLJjXKnbgxtIl0zcGAmwO4R9J?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab Jupyter笔记本</a>，上面有所有的代码和结果。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fbcd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建基本地图</h1><p id="8994" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们开始构建任何东西之前，让我们安装一些我们将在整个教程中使用的库。你可以使用任何打包工具。我将提供Pipenv和pip prepending <code class="fe mz na nb nc b">!</code>的例子，这样它就可以在Jupyter笔记本上工作，比如Google Colab。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="04ee" class="nh md it nc b gy ni nj l nk nl">pipenv install folium pandas</span><span id="8901" class="nh md it nc b gy nm nj l nk nl">Or</span><span id="aee7" class="nh md it nc b gy nm nj l nk nl">!pip install folium pandas</span></pre><p id="2721" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装完库后，创建地图就像一行代码一样简单:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="21dc" class="nh md it nc b gy ni nj l nk nl">import folium<br/>folium.Map(location=[48.130518, 11.5364172], zoom_start=12)</span></pre><p id="f733" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将自动生成一个交互式<a class="ae ky" href="https://python-visualization.github.io/folium/quickstart.html#Getting-Started" rel="noopener ugc nofollow" target="_blank">地图</a>并将其输出到Jupyter笔记本，在那里您将能够与它进行交互。函数<code class="fe mz na nb nc b">Map</code>接受一些可选参数。在我们的例子中，我们发送的是位置(坐标)和默认的缩放级别。</p><p id="9867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切顺利，您应该会看到这样的地图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b57f67d1b8d2775e20c285d0ace2e963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iBCrg61gEB6alvlw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基本地图</p></figure><p id="4787" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使这已经很令人兴奋了，我们也没有做什么特别的事情。Folium的真正力量来自于将库的映射功能与Python的数据操作能力相结合，所以让我们开始做一些工作吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3552" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">添加标记</h1><p id="7b49" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以添加到地图中的一个基本功能是标记地点的能力，这样就可以很容易地找到它们或者突出显示重要信息。</p><p id="2c6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可以很容易地用来自叶子的<code class="fe mz na nb nc b">Marker</code>函数来完成，正如我们接下来演示的:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="e610" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[48.218871184761596, 11.624819877497147], zoom_start=15)</span><span id="bede" class="nh md it nc b gy nm nj l nk nl">tooltip = "Click Here For More Info"</span><span id="2d33" class="nh md it nc b gy nm nj l nk nl">marker = folium.Marker(<br/>    location=[48.218871184761596, 11.624819877497147],<br/>    popup="&lt;stong&gt;Allianz Arena&lt;/stong&gt;",<br/>    tooltip=tooltip)<br/>marker.add_to(m)</span><span id="57d9" class="nh md it nc b gy nm nj l nk nl">m</span></pre><p id="3e3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与第一个例子类似，首先我们创建一个地图对象，然后我们也创建一个标记对象。<a class="ae ky" href="https://python-visualization.github.io/folium/quickstart.html#Markers" rel="noopener ugc nofollow" target="_blank">标记</a>对象是通过向点传递坐标、当有人点击标记时我们希望在弹出窗口上显示的内容、标记的工具提示以及其他选项创建的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/60a1127ae17d566c38c6bba2666214d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gpNlxw50gsoT1_sO.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带标记的地图</p></figure><p id="569b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标记有大量的配置选项，因为标记弹出窗口需要一个HTML，所以有很多可能性。但是如果我们想在弹出窗口中显示图表呢？有没有简单的方法？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="abe6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">标记的图表弹出窗口</h1><p id="7ce6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Folium为任何标记类型的可视化提供了内置支持。可视化是由库<a class="ae ky" href="https://github.com/wrobstory/vincent" rel="noopener ugc nofollow" target="_blank">文森特</a>和<a class="ae ky" href="https://altair-viz.github.io/" rel="noopener ugc nofollow" target="_blank">牵牛星</a>实现的。</p><p id="4713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了呈现一些可视化效果，我们将需要一些数据，所以让我们先获取这些数据:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2e96" class="nh md it nc b gy ni nj l nk nl">import json</span><span id="4d35" class="nh md it nc b gy nm nj l nk nl">import requests</span><span id="7aa3" class="nh md it nc b gy nm nj l nk nl">url = (<br/>    "https://raw.githubusercontent.com/python-visualization/folium/master/examples/data"<br/>)<br/>data = json.loads(requests.get(f"{url}/vis1.json").text)</span></pre><p id="90b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们在标记中绘制数据:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="bffe" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[48.218871184761596, 11.624819877497147], zoom_start=15, tiles="Stamen Terrain")</span><span id="1e95" class="nh md it nc b gy nm nj l nk nl">marker = folium.Marker(<br/>    location=[48.218871184761596, 11.624819877497147],<br/>    popup=folium.Popup(max_width=450).add_child(<br/>        folium.Vega(data, width=450, height=250)<br/>    ),<br/>)</span><span id="6043" class="nh md it nc b gy nm nj l nk nl">marker.add_to(m)</span><span id="a18a" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/000ab37fcfd1de330964b7465ab3d078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KcmdWMxfxWxFQQdh.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有标记和地块的地图</p></figure><p id="0b8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太棒了，但是我们真的能改变标记本身而不仅仅是弹出窗口吗？简而言之，答案是肯定的，而且几乎可以用任何东西。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="06f2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">自定义标记</h1><p id="db26" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe mz na nb nc b">Marker</code>函数允许许多参数化，从将标记图标从预定义图标库更改为形状到使用HTML构建您自己的标记，在本文中，我们将看到三个示例，从使用预定义图标开始:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="ad4e" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[48.218871184761596, 11.624819877497147], zoom_start=15)</span><span id="5c64" class="nh md it nc b gy nm nj l nk nl">tooltip = "Click Here For More Info"</span><span id="87ce" class="nh md it nc b gy nm nj l nk nl">marker = folium.Marker(<br/>    location=[48.218871184761596, 11.624819877497147],<br/>    icon=folium.Icon(icon="cloud"),<br/>    popup="&lt;stong&gt;Allianz Arena&lt;/stong&gt;",<br/>    tooltip=tooltip)<br/>marker.add_to(m)</span><span id="b657" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b0b81a934789128c35a7e210752fcb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lcaBNBm3QDU2JF9Z.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有图标标记的地图</p></figure><p id="80c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到我们简单的Allianz Arena示例，我们现在已经用云改变了标记的图标，但是这些图标是从哪里来的呢？有哪些选择？</p><p id="8aca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图标来自于<a class="ae ky" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank"> Bootstra </a> p库，但是你也可以使用<a class="ae ky" href="https://fontawesome.com/" rel="noopener ugc nofollow" target="_blank">字体Awesome </a>。</p><p id="6b9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们使用形状(例如，圆)来构建我们的标记:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="979b" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[48.218871184761596, 11.624819877497147], zoom_start=15)</span><span id="407e" class="nh md it nc b gy nm nj l nk nl">tooltip = "Click Here For More Info"</span><span id="abde" class="nh md it nc b gy nm nj l nk nl">marker = folium.CircleMarker(<br/>    location=[48.218871184761596, 11.624819877497147],<br/>    radius=50,<br/>    popup="&lt;stong&gt;Allianz Arena&lt;/stong&gt;",<br/>    tooltip=tooltip)<br/>marker.add_to(m)</span><span id="0bf3" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/2df2fd56c7fa78703a9be3589e5869de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DoCU2gs2BFqvRn0e.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有圆形标记的地图</p></figure><p id="75de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以使用HTML来构建任何类型的标记。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ced6f64819c7335fcf1b360af2797846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IdvOCvYYpN1Ycykv.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有HTML标记的地图</p></figure><p id="c818" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最后一个例子中，我们使用HTML创建一个DIV元素并放置一些文本作为标记，但是我们也可以使用SVG并呈现您想要的任何内容。只要记住把你的HTML居中，这样标记就在正确的位置，在我的例子中我没有这样做。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e695" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Choropleth地图</h1><p id="a736" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Choropleth地图是流行的专题地图，用于通过预定地理区域(例如，国家或州)上的各种阴影图案或符号来表示统计数据。他们善于利用数据来简单地表示一个地区的期望测量的可变性。</p><p id="2e4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建choropleth地图，我们需要处理两种类型的数据:我们想要表示的阴影或颜色的统计数据和地理空间数据。</p><p id="f373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的示例中，我们将使用美国各州来定义地区，以及美国失业统计数据(不是真实数据)。</p><p id="4525" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从绘制地理区域开始，也就是美国各州:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="d835" class="nh md it nc b gy ni nj l nk nl">data_url = (<br/>    "https://raw.githubusercontent.com/python-visualization/folium/master/examples/data"<br/>)<br/>us_states_url = f"{data_url}/us-states.json"</span><span id="cece" class="nh md it nc b gy nm nj l nk nl">m = folium.Map([43, -100], zoom_start=4)</span><span id="0586" class="nh md it nc b gy nm nj l nk nl">folium.GeoJson(us_states_url).add_to(m)</span><span id="811b" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a6060a84d455ec20ce9f3ae7718be743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7VUGRkDp2-imvbzk.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国各州</p></figure><p id="de50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的新地图现在包含了一个突出显示美国各州的覆盖图，但我们还可以做得更多。我们现在可以使用我们拥有的关于美国失业率的统计信息，并突出显示失业率高低的州。</p><p id="f2a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们看看数据是什么样的:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="911e" class="nh md it nc b gy ni nj l nk nl">import pandas as pd</span><span id="43d3" class="nh md it nc b gy nm nj l nk nl">us_unemployment_url = f"{data_url}/US_Unemployment_Oct2012.csv"<br/>unemployment = pd.read_csv(us_unemployment_url)</span><span id="79e0" class="nh md it nc b gy nm nj l nk nl">unemployment.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/8ce0cb55141b28b5c49f2cd7095f9d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gmU_laBE13Obi-KqchxkQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国各州失业率的样本数据</p></figure><p id="a8fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据非常简单:一列包含州，下一列包含失业率。</p><p id="de29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这些，我们就可以开始给地图上色了:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="2bc3" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[48, -102], zoom_start=3)</span><span id="9436" class="nh md it nc b gy nm nj l nk nl">folium.Choropleth(<br/>    geo_data=us_states,<br/>    name='choropleth',<br/>    data=unemployment,<br/>    columns=['State', 'Unemployment'],<br/>    key_on='feature.id',<br/>    fill_color='YlGn',<br/>    fill_opacity=0.7,<br/>    line_opacity=0.2,<br/>    legend_name='Unemployment Rate %'<br/>).add_to(m)</span><span id="5905" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b18e1153100583b87ee0f41493db5a11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tENKVIT4fKrHJq3P.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国各州的失业率(虚假数据)</p></figure><p id="561f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">做得好！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="52d6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">热图</h1><p id="eff1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">热图是地图的另一个流行选择。它们可以用于多种目的，包括天气状况、污染、人口密度等。</p><p id="fbcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们是非常强大的工具，在熊猫T2和叶子的帮助下，非常容易建造。让我们以芝加哥市的自行车站为例。我在网上发现了一个有趣的数据集，其中包含自行车站点的坐标，我们将使用这些坐标来构建我们的热图。</p><p id="f31c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们加载数据:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="eb0d" class="nh md it nc b gy ni nj l nk nl">stations_url = 'https://gbfs.divvybikes.com/gbfs/en/station_information.json'</span><span id="abab" class="nh md it nc b gy nm nj l nk nl">stations = json.loads(requests.get(stations_url).text)['data']['stations']<br/>stations = pd.json_normalize(stations)<br/>stations = stations[['lat', 'lon']]<br/></span><span id="4a34" class="nh md it nc b gy nm nj l nk nl">stations.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/76fcc985879e326a079d1dc5b00a0875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvOhgF5oTR1LIk_8w-40Hg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含每个自行车站点的纬度和经度的站点数据集的样本数据。</p></figure><p id="1d80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">87–87。58687 . 68888886861</p><p id="e66a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自行车站数据有多列，包含大量数据。然而，对于我们的目的，我们只需要坐标，所以我们删除其余的。现在每一行代表一组自行车站所在的坐标(纬度和经度)。</p><p id="ef51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将构建一个热点图来突出显示城市中自行车站点较为集中的区域。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="30da" class="nh md it nc b gy ni nj l nk nl">from folium import plugins</span><span id="6613" class="nh md it nc b gy nm nj l nk nl">m = folium.Map([41.8781, -87.6298], zoom_start=11)</span><span id="5508" class="nh md it nc b gy nm nj l nk nl"># convert to (n, 2) nd-array format for heatmap<br/>stationArr = stations.values</span><span id="c3a5" class="nh md it nc b gy nm nj l nk nl"># plot heatmap<br/>m.add_child(plugins.HeatMap(stationArr, radius=15))<br/>m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/048c59b1f19e31b563102e114b2bfa5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QH_YdmZBPVTsxKbL.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带热图的地图</p></figure><p id="fa38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">干得好！热图的秘密是简单地使用一个来自follow的插件，传递一个带有每个站点的纬度和经度以及半径的矩阵。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fe06" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">地图切片</h1><p id="52b4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，在结束之前，我想强调一下leav的另一个特性，地图切片。到目前为止，我们使用了一种类型的地图渲染，但是我们可以使用许多选项，每个选项都会使地图看起来不同。</p><p id="041a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一些例子:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="7702" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[30.4407159,-66.6017203], zoom_start=3)<br/>folium.TileLayer('stamenterrain').add_to(m)<br/>m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/57842e2ff0a7388cc1d1a549744d1dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZpKRopVHw5qbXG8t.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有雄蕊地形层的地图</p></figure><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="0f49" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[30.4407159,-66.6017203], zoom_start=3)<br/>folium.TileLayer('stamentoner').add_to(m)<br/>m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/686815696ff5756385428698bb5db449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TM85m0LAGdmRNDye.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有雄蕊调色剂层的地图</p></figure><p id="0393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者更好的是，您可以通过使用另一个名为<code class="fe mz na nb nc b">layerControl</code>的特性给用户提供选项。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="ec93" class="nh md it nc b gy ni nj l nk nl">m = folium.Map(location=[30.4407159,-66.6017203], zoom_start=4)</span><span id="9c96" class="nh md it nc b gy nm nj l nk nl"># Add tiles<br/>folium.TileLayer('stamentoner').add_to(m)<br/>folium.TileLayer('stamenwatercolor').add_to(m)<br/>folium.TileLayer('cartodbpositron').add_to(m)<br/>folium.TileLayer('openstreetmap').add_to(m)</span><span id="e561" class="nh md it nc b gy nm nj l nk nl"># Add the option to switch tiles<br/>folium.LayerControl().add_to(m)</span><span id="d4ab" class="nh md it nc b gy nm nj l nk nl">m</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/bbe3224be5cb8a5c9b9323d8c3673640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TZI982Qy0_iVkPX4.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有多个图层的地图</p></figure><p id="fe28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你现在可以在这张地图的右上角看到一个图层选择，用户可以使用它在图块之间切换。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c017" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="a534" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">写这篇文章非常有趣！Folium提供了许多配置选项和大量构建优秀地图的机会，我肯定会继续使用它来创造一些乐趣。</p><p id="94e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在研究这个主题的时候，我遇到了一些问题，因为文档不是很好；然而，在他们的<a class="ae ky" href="https://github.com/python-visualization/folium/" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>上，他们提供了很好的例子，你可以运行来看看如何实现我们今天学到的一些东西。我强烈建议浏览一下。</p><p id="ce7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>