<html>
<head>
<title>Establish a Classic 3-Tier Architecture in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS中建立经典的3层架构</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lets-create-classic-3-tier-architecture-in-aws-cf187664a83c?source=collection_archive---------12-----------------------#2022-05-09">https://betterprogramming.pub/lets-create-classic-3-tier-architecture-in-aws-cf187664a83c?source=collection_archive---------12-----------------------#2022-05-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="b5c2" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让我们创造吧！</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/906cf8c1867646918edb40fabba4d6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvvM5Qf2LsdcM35JFgJSag.png"/></div></div></figure><p id="a537" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">本周的项目要求我们在Amazon Web Services中建立一个传统的三层架构。这三层通常被称为Web或表示层、应用层和数据库(或简单数据)层。让我们快速浏览一下每个组件:</p><h1 id="3970" class="lr ls iu bd lt lu lv lw lx ly lz ma mb ka mc kb md kd me ke mf kg mg kh mh mi bi translated">介绍</h1><ul class=""><li id="3097" class="mj mk iu kx b ky ml lb mm le mn li mo lm mp lq mq mr ms mt bi translated"><strong class="kx iv"> Web层— </strong>这通常是项目面向公众的一面。无论是网站还是GUI，这都是用户看到的和与之交互的东西。对于我们的项目，我们将有一个运行Apache的EC2实例自动扩展组来托管一个简单的HTML站点，该站点包含在通过网关连接到互联网的VPC的几个子网中。安全组会将这些实例的流量仅限于HTTP。</li><li id="5ad2" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated"><strong class="kx iv">应用层— </strong>这一层，听起来像是实际的逻辑，或者代码，或者项目的“大脑”所在的地方。流量将从Web层传递到这一层进行处理。在我们的示例中，我们将在私有子网内拥有一组自动扩展的EC2实例。安全组将确保只有直接来自Web层的流量才能通过。对于这个项目，我们实际上不会有任何运行代码。</li><li id="a0aa" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated"><strong class="kx iv">数据库层— </strong>最后一层基本上是存储。它将包含您的解决方案所需的任何数据库或存储设备，如S3存储桶。在我们的项目中，这将是一个MySQL RDS数据库，位于几个私有子网中。和以前一样，安全组将流量限制为仅来自应用层的入站流量。</li></ul><p id="a7bf" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我试图把它画出来，所以逻辑上看起来可能是这样的:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mz"><img src="../Images/795fec725b1221cbece7f71ba6035bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muxT3DG0EIgR2_d9caGe3Q.png"/></div></div></figure><h1 id="8384" class="lr ls iu bd lt lu lv lw lx ly lz ma mb ka mc kb md kd me ke mf kg mg kh mh mi bi translated">先决条件</h1><p id="e0b9" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated">对于这个项目，我们需要的是一个具有管理员权限的AWS帐户。(一如既往，不要使用您的root帐户)</p><p id="915c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们开始吧！</p></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><h1 id="af09" class="lr ls iu bd lt lu nk lw lx ly nl ma mb ka nm kb md kd nn ke mf kg no kh mh mi bi translated">Web层</h1><p id="c540" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated"><strong class="kx iv">创建一个VPC </strong> <br/>首先，我们将在AWS控制台中导航至VPC仪表盘。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj np"><img src="../Images/45c71290aa78e8f3d2278752f64c585f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lmDKvm0RQ7ow4bS_FsZw5g.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">我们是书呆子。我们喜欢巫师。</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nu"><img src="../Images/84ff6c21dc5508af666c0e4cf3f273c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-eue2dTyQnPH7EZm_FUGQ.png"/></div></div></figure><p id="d959" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">和控制台中的其他东西一样，让我们看看右上角的“创建VPC”按钮。</p><p id="61b6" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">下一个屏幕截图展示了一个漂亮的特性，它允许您一次性为这个项目创建大部分资产。然而，我似乎是一个惩罚的饕餮者，我会将事情分解一点，以保持我的“三个不同层次”的方法。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nv"><img src="../Images/21909d8ace7a0754be565bfe44c7f8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYEZ3sSb_AxupyDNdgZGnA.png"/></div></div></figure><p id="bcb8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">因此，我们选择“仅VPC”，给它命名，给它一个CIDR区块，然后嘣。第一步完成了。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nw"><img src="../Images/8d18e6646cdf433c8ddbd5721afe1455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*MTLPMjclGMv_PiBcEFsMcw.png"/></div></figure><p id="0006" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建一些子网</strong> <br/>接下来，我们将沿着左侧的菜单向下，选择“子网”。寻找“创建子网”按钮，并按下它。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nx"><img src="../Images/7cccff3626f1b55b70412b98d38cedd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*aIb7K3tAwaAKaODemupNtg.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">单击“添加新子网”一次创建多个子网，完成后单击“创建子网”。</p></figure><p id="94f5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">哇哦。成功。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/d36fdc6d10741ba1c6f2648bbf44c170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqgJ1u8X_aIaZlW705Jeiw.png"/></div></div></figure><p id="2a9d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">路由表</strong> <br/>这是一页，我们会多次回到这一页，但现在我们要为刚刚建立的两个子网创建一个路由表。这将允许实例相互通信，并在以后与Internet网关通信。与子网一样，它是控制台左侧的下一个选项，zwoop！右上角为“创建路由表”</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nz"><img src="../Images/ee1daa28c292953f0213aadb7098f964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*IdZ_axG3a6AuGWGejLOUcA.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">请务必手动选择正确的VPC，因为我们没有使用默认设置。</p></figure><p id="c616" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">有了表之后，我们需要将子网与表相关联:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/dbd56a05d31a3314aefadbce45658540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KjIA-kd99YccP_-UBvZp1w.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">选择“关联”选项卡，然后选择“编辑子网关联”</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/c74f73f29ddabdbdf5bf49d5d0ffcd0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7r7iEUYwelX3uIBnXH0Iqw.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">选择两个子网并“保存”</p></figure><p id="ea44" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这创建了一个“显式”关联。我只想说，这可能是隐含的，但我们今天不会讨论这些。这里我还应该指出，默认情况下，任何创建的路由表都有一个名为“本地”的默认路由条目。此路由允许任何实例与子网内使用此表的任何其他实例进行通信。</p><p id="8435" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">另一个需要完成的步骤是将这个表作为VPC的“主”表。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/6ca7e778463c9f4e8f21211c97329045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miTGoPuIC0j1rydUu4o7qg.png"/></div></div></figure><p id="63be" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">互联网网关</strong> <br/>简称互联网网关，下一项资产允许我们之前创建的子网自由访问互联网，从而成为“公共子网”</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj od"><img src="../Images/7b4ddce8e7cb3c662513a1edc00aee2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*BiIhb4G4dRwiFOz-r87_yw.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">让我们再一次进入下一个选项！</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nz"><img src="../Images/c4b4aba703f215fb05a2ae3ae7975e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*Vs5YvHeqmJVt6E4RwrOPDw.png"/></div></figure><p id="58a7" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">下一步是将网关“连接”到我们在开始时创建的VPC。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oe"><img src="../Images/d4418c85fd51f2a7b09e3dd81e5c98d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4IICVlvRRuDYIxBg9mrwA.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">创建后，通知标题会直接提供一个到下一步的简单链接，但是“Actions”&gt;“Attach to ”(操作)“VPC”选项会一直为我们提供。</p></figure><p id="fca8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">按照提示，选择正确的VPC，我们就进入下一个环节！<br/>此时，我们还可以将网关添加到路由表中:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj of"><img src="../Images/b0d8e22ea2b9fec8bddd8e80401100ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoVPvideBBWoJwAze-n8WA.png"/></div></div></figure><p id="efc1" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建安全组</strong> <br/>安全组作为某种“实例级”防火墙至关重要。这里，我们将创建一个仅允许HTTP流量进入的网络。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj og"><img src="../Images/b4a589ef30b24ed39a882de9dd849b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hk8H0ILBGO2WpaUpiNfzqg.png"/></div></div></figure><p id="3086" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建自动缩放组<br/> </strong>通过导航到EC2 &gt;自动缩放组，我们可以找到典型的“创建XYZ”向导，但是在启动该向导时，我意识到我确实需要首先创建一个启动模板。我已经在前面的中介绍了创建和使用一个启动模板<a class="ae oh" href="https://awstip.com/creating-an-aws-launch-template-with-aaa-reliability-70347e6d8b38" rel="noopener ugc nofollow" target="_blank">，但是这个项目有足够多的独特之处，我将在这里再次向大家展示。</a></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/76002145bce83e09312822b836088356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*wmyLuEko1W1-OD2oVfKcCg.png"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/56a4b68a2820475356bb1bbef18a418c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*Vk_Gwir25KSmng1DQ8YI7Q.png"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/fd851f91782ec73476fdc4ba3c10b112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*Z5XWXLWTx6v4PlQtq3q7PQ.png"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ol"><img src="../Images/de4bd342a36b794f1f3dfe161932903d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*2EPXdqMXhVKYJmisCfrkGA.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">没有显示的是我在以前的项目中使用的引导脚本，它被放置在向导页面最底部的用户数据字段中。</p></figure><p id="fdb1" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在我们已经创建了启动模板，我们可以返回到自动缩放组(ASG)向导，并继续:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj om"><img src="../Images/8fcaef2dc36bb9f86d4ad03edf8f0fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*BgRWEVHLtqDCfspePeWetA.png"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj on"><img src="../Images/6b0e8acb985ecb85e45973cf1d48fdf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*dt-tKvFfW6YkQdf6dJ5diQ.png"/></div></figure><p id="d8fb" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">其他一切都是默认的，我们实际上可以利用上面页面上的“跳到评论”按钮，但不管怎样..完成向导，一旦我们的实例完成初始化，我们就可以获取它们的一个公共IP并查看我们最喜欢的小html页面:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oo"><img src="../Images/26953c714ae35d4bce2e1ac0f57f04a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaNY0QbBIKAG52MdgTqGYA.png"/></div></div></figure><p id="7c68" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><em class="op">注意:由于一些奇怪的原因，我的正常引导脚本失败了，所以我必须添加一个</em> <code class="fe oq or os ot b">install php</code> <em class="op">命令来启动Apache服务器。</em></p><p id="dbe7" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">从而结束我们的第一层。*扔纸屑*拿一些液体能量，你的帽子，可能还有猫，让我们继续前进！</p></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><h1 id="eed5" class="lr ls iu bd lt lu nk lw lx ly nl ma mb ka nm kb md kd nn ke mf kg no kh mh mi bi translated">应用层</h1><p id="2851" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated"><strong class="kx iv">创建更多子网</strong> <br/>导航回我们的VPC &gt;子网页面，我们将再创建两个子网:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ou"><img src="../Images/0423a9380918a5388ba89c655668ff54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1yTUwFQ9uOFaNyI1_WhHCA.png"/></div></div></figure><p id="9175" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这一次，我们不打算将它们连接到internet网关，从而使它们成为“私有”子网。但是，我们需要将它们与路由表相关联。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/510a3c27435259d1fa62b1e329ab6c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjJ4UTQfaVq2MFVyQjKs9w.png"/></div></div></figure><p id="189f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建我们的应用安全组</strong> <br/>有趣的是，它只允许来自我们的网络安全组的流量！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ov"><img src="../Images/194c812b436d78c28ffa5dea8766f2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e34eLSA2XIwmRq-C6Hw7lw.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">VPC下拉列表有点棘手…使用Web安全组的ID来创建入站规则。</p></figure><p id="bf86" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">汽车衡再次来袭！<br/> </strong>我们将创建另一个启动模板/自动缩放组组合，但这个组合将只启动EC2实例，并且只有一个操作系统。你之前已经看到了这些选项，所以我把我的启动模板命名为<strong class="kx iv"> USAFBlueprint </strong>，我的ASG <strong class="kx iv"> BaseDorms </strong>。完成向导，这些将开始旋转！</p><p id="0c21" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建NAT网关</strong>重要的一点是选择正确的子网，确保它是公共类型，并分配一个弹性IP。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ow"><img src="../Images/0a30947a4939bc260a34ead13ded7308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*reqGkJztBBJySl4OiJ4QcQ.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">这将允许我们的私有子网与房子的公共端通话。</p></figure><p id="31ad" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在，我们可以导航回路由表，并将NAT网关ID作为路由条目添加到应用程序层私有路由表中(<strong class="kx iv">底图</strong>)，或者我们可以等到以后，将其添加到两个私有路由表中(<strong class="kx iv">底图/FortMap </strong>)。无论哪种方式，它看起来都会像这样:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ox"><img src="../Images/f770d8d432cf0f808590e8619ba5f3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJ4grZGMLCeiXxc5TGqdJg.png"/></div></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oy"><img src="../Images/6207136419fc4acc655433154c99742b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQug-cxzALE96Rl9F7WjmQ.png"/></div></div></figure><p id="56ef" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这就是我们的应用层！在我们的最后一站…</p></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><h1 id="b590" class="lr ls iu bd lt lu nk lw lx ly nl ma mb ka nm kb md kd nn ke mf kg no kh mh mi bi translated">数据库层</h1><p id="bd3e" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated"><strong class="kx iv">另一个安全组… </strong> <br/>这个安全组只允许来自我的应用层安全组的MySQL流量:<strong class="kx iv"> SecurityForces </strong>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oz"><img src="../Images/c9234d12527213425429812680fdd683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*enZ6Cb7vJUlu3zqVm2WayA.png"/></div></div></figure><p id="10ea" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><strong class="kx iv">创建数据库</strong> <br/>接下来，我们要创建一个MySQL RDS数据库。现在，这些屏幕截图可能会让我看起来能够顺利完成，但实际上我不得不后退几步来准备这个阶段..</p><ul class=""><li id="298b" class="mj mk iu kx b ky kz lb lc le pa li pb lm pc lq mq mr ms mt bi translated">数据库不会创建，因为它需要分布在至少两个可用性区域的子网</li><li id="994e" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">因为我已经用“让Amazon选择AZ”创建了我的所有子网，所以它们都在同一个AZ中。</li><li id="acef" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">最后，我不得不删除/重新创建我的最后一个子网，并手动将其放在不同的AZ中。</li><li id="2c32" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq mq mr ms mt bi translated">然后，我创建了DB子网组，并能够完成数据库创建。</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pd"><img src="../Images/b8848ae142d4abd6606d8407c3655982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*vYXdmtPAmCVLryWt1t-alQ.png"/></div></figure><p id="5f84" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在我们又回到正轨了！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pe"><img src="../Images/62bcd4be56406b5aa7670d999253cbd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*-MC8pTUTyKHmHvQPFJgOUw.png"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pe"><img src="../Images/388fa5d95d353445915c1f1754a91417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FqU7BmZpzjNe1YQIuxY7LA.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">对于这个项目，我们没有使用多AZ数据库选项，但除了严格的“自由层”以外的任何选项都将解锁中心框中的选项，从而启用多AZ。</p></figure><p id="503b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><em class="op">在这两张截图之间有很大一部分选项，但这是唯一相关的选项。</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pf"><img src="../Images/0a15ae79f98fdc70929b92f217d68ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*DzAuyxKBxIXsctzfInGlog.png"/></div></figure><p id="2992" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在你知道了！数据库层！</p><p id="6b14" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这里需要注意的是这个项目:</p><ol class=""><li id="efa1" class="mj mk iu kx b ky kz lb lc le pa li pb lm pc lq pg mr ms mt bi translated">没有任何应用层的功能</li><li id="314a" class="mj mk iu kx b ky mu lb mv le mw li mx lm my lq pg mr ms mt bi translated">实际上并不与数据库层有任何联系，但更多的是为了展示创建类似内容的过程。</li></ol><p id="161a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">不过，在我们结束之前。</p></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><h1 id="5ccb" class="lr ls iu bd lt lu nk lw lx ly nl ma mb ka nm kb md kd nn ke mf kg no kh mh mi bi translated">堡垒</h1><h2 id="a047" class="ph ls iu bd lt pi pj dn lx pk pl dp mb le pm pn md li po pp mf lm pq pr mh ps bi translated"><strong class="ak">测试Web to App </strong></h2><p id="d8f5" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated">简单地说，一个堡垒主机(或者用旧的说法，一个跳转服务器)是锁定你的架构的一个额外的方法，但是仍然允许一个访问点用于某些动作。在这种情况下，我们将创建一个堡垒主机来测试并查看我们的web层可以与我们的应用程序层对话！</p><p id="1045" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们的Bastion主机(又名<code class="fe oq or os ot b">SpaceWarningSqdn</code>)将被放置在我们的公共子网内，并被授予(再次通过我们的安全组)ping我们的一个应用层实例的私有IP的权利。</p><p id="75aa" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">不幸的是，经过凌晨4点的混乱，以及一长串测试不同规则配置以使其实际工作的过程，我丢失了大部分截图。但是这里有一个ping实际上在工作！</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pt"><img src="../Images/005abbd9f0c69c34e179dddc76935343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*nB98Wr2_cgzG3lrw8skZsg.png"/></div></figure></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><h1 id="3eb9" class="lr ls iu bd lt lu nk lw lx ly nl ma mb ka nm kb md kd nn ke mf kg no kh mh mi bi translated">结论</h1><p id="8b51" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le na lg lh li nb lk ll lm nc lo lp lq in bi translated">三层架构是构建整个服务堆栈的好方法，因为它允许您在逻辑上将其分解，让每个部分单独工作，然后将各个点连接起来，形成一个功能完整的大型项目。</p><p id="3d00" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">谢谢你和我在一起，下次再见！</p></div><div class="ab cl nd ne hy nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="in io ip iq ir"><p id="a423" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">腹心蛙！</p></div></div>    
</body>
</html>