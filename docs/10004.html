<html>
<head>
<title>How to Use tmuxp to Manage Your tmux Session</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用tmuxp管理您的tmux会话</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-tmuxp-to-manage-your-tmux-session-614b6d42d6b6?source=collection_archive---------1-----------------------#2021-11-12">https://betterprogramming.pub/how-to-use-tmuxp-to-manage-your-tmux-session-614b6d42d6b6?source=collection_archive---------1-----------------------#2021-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="07f6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">控制您的tmux会话</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/270caac4395ff544d0210724484fea17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yeDDSISYm3QPAq90"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Jorge Ramirez 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名程序员，几乎每个工作日都是从为我正在处理的特定任务设置开发环境开始的。</p><p id="60de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此期间，我会花几分钟来设置我的<a class="ae ky" href="https://github.com/tmux/tmux" rel="noopener ugc nofollow" target="_blank"> tmux </a>窗口和窗格，每次，我都会对自己说，没有必要进行自动化，因为这不会花费太多时间。然而，当我在需要不同布局的任务之间来回切换时，这变得令人疲惫不堪。</p><p id="e4f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">起初，我试着使用一些基本的脚本，但很快就无法维护它们，因为需要花费相当大的精力来更新。然后，我找到了<a class="ae ky" href="https://github.com/tmux-python/tmuxp" rel="noopener ugc nofollow" target="_blank"> tmuxp </a>。现在已经用了一段时间了，准备分享一下经验。</p><p id="a0ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，如果你像我一样，喜欢为每个任务设计一个特定的布局，并且希望花最少的时间来管理配置，那么这篇文章绝对适合你。</p><h1 id="8b18" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置</h1><p id="5c56" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，确保你安装了tmux 1.8以上和python 2.6以上。然后，使用以下命令安装tmuxp:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="0658" class="mx lw it mt b gy my mz l na nb"># For macOs<br/>$ brew install tmuxp</span><span id="9abb" class="mx lw it mt b gy nc mz l na nb"># Using pip (python package manager)<br/>$ pip install --user tmuxp</span></pre><p id="bd67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装后，您需要在rc文件中设置以下环境变量(即<code class="fe nd ne nf mt b">.zshrc</code>)。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="0403" class="mx lw it mt b gy my mz l na nb">export DISABLE_AUTO_TITLE='true'</span></pre><h1 id="af8d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基础知识</h1><h2 id="a2dc" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">存储配置</h2><p id="2f92" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Tmuxp配置要么是YAML文件，要么是JSON文件，您需要决定将它们存储在哪里。您可以保留配置文件:</p><ul class=""><li id="03ba" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">在你文件系统的某个地方。</li><li id="4553" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">在你的项目目录中作为<code class="fe nd ne nf mt b">.tmuxp.yaml</code>或者<code class="fe nd ne nf mt b">.tmuxp.json</code>。</li><li id="85b9" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">在你的<code class="fe nd ne nf mt b">XDG_CONFIG_HOME</code> ( <code class="fe nd ne nf mt b">$HOME/.config/tmuxp</code>)。</li><li id="3cbf" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">在<code class="fe nd ne nf mt b">$HOME/.tmuxp</code>中。</li><li id="7ebd" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">在由<code class="fe nd ne nf mt b">TMUXP_CONFIGDIR</code>环境变量引用的自定义路径中。</li></ul><p id="5ee8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些方法都会有相同的结果(用期望的配置启动tmux)。但是，使用最后三个选项之一，您可以从文件系统中的任何位置启动tmux会话，而无需键入配置文件的路径。在我这边，我更喜欢使用<code class="fe nd ne nf mt b">XDG_CONFIG_HOME</code>，因为我已经在其他工具上使用它了。</p><h2 id="5047" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">创建配置</h2><p id="ed81" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">从较高层次来看，创建配置文件包括两个主要步骤。首先是定义布局。第二步是选择您想要在每个面板中运行的应用程序或命令。</p><p id="09b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">创建布局:</strong>创建布局有两个选项。你要么使用一个预定义的tmux布局(<code class="fe nd ne nf mt b">even-horizontal</code>、<code class="fe nd ne nf mt b">even-vertical</code>、<code class="fe nd ne nf mt b">main-horizontal</code>、<code class="fe nd ne nf mt b">main-vertical</code>、<code class="fe nd ne nf mt b">tiled</code>)，要么创建一个自定义的，这是我通常做的。从技术上讲，您可以直接在配置文件中创建一个自定义布局，但是您已经得到了类似如下的结果:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6c2b" class="mx lw it mt b gy my mz l na nb">layout: b8f1,104x67,0,0{52x67,0,0[52x45,0,0,1,52x21,0,46,3],51x67,53,0,2}. </span></pre><p id="3384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，您可以遵循以下步骤:</p><ul class=""><li id="be56" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">在您的配置目录中，创建包含以下内容的配置文件。就我而言，我将其命名为<code class="fe nd ne nf mt b">starter.yaml</code>。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><ul class=""><li id="c0fb" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">使用上面创建的文件启动tmux会话。</li></ul><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6f80" class="mx lw it mt b gy my mz l na nb">$ tmuxp load <!-- -->starter</span></pre><ul class=""><li id="e275" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">使用tmux快捷方式，创建所需的布局。请注意，您还不需要启动应用程序或命令。完成后，使用交互式<code class="fe nd ne nf mt b">freeze</code>命令保存当前会话。在下面的例子中，我将新配置命名为<code class="fe nd ne nf mt b">demo.yaml</code>。</li></ul><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="adee" class="mx lw it mt b gy my mz l na nb">$ tmuxp freeze <!-- -->starter<br/>Convert to [yaml]: &lt;hit enter&gt;  <br/>---------------------------------------------------------------<br/>Freeze does its best to snapshot live tmux sessions.</span><span id="65c4" class="mx lw it mt b gy nc mz l na nb">The new config *WILL* require adjusting afterwards. Save config? [y/N]: y<br/>Save to: .../.config/tmuxp/starter.yaml [.../.config/tmuxp/starter.yaml]: demo.yaml<br/>Save to .../.config/tmuxp/demo.yaml? [y/N]: y<br/>Saved to .../.config/tmuxp/demo.yaml.</span></pre><ul class=""><li id="0fa3" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">最后，退出tmux ( <code class="fe nd ne nf mt b">:kill-session</code>)并加载您的新配置以查看保存的布局。</li></ul><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c18d" class="mx lw it mt b gy my mz l na nb">$ tmuxp load demo</span></pre><p id="2662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们跳到下一步之前，我想指出，如果您喜欢JSON格式，您可以查看<a class="ae ky" href="https://tmuxp.git-pull.com/examples.html#short-hand-inline" rel="noopener ugc nofollow" target="_blank">文档</a>或者使用<code class="fe nd ne nf mt b">tmuxp convert</code>命令进行从YAML到JSON的转换(<code class="fe nd ne nf mt b">tmux convert config.yaml</code>)。</p><p id="6f5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">选择要运行的命令:</strong>现在您已经创建了布局，您可以在每个窗口和窗格中添加想要运行的命令。此外，您可以设置其他配置，如当前工作目录、窗口名称等。(查看<a class="ae ky" href="https://tmuxp.git-pull.com/examples.html" rel="noopener ugc nofollow" target="_blank">文件</a>了解更多详情)。在下面的例子中，我将第一个窗格设置为启动Neovim ( <code class="fe nd ne nf mt b">nvim</code>)，将第二个窗格设置为创建一个空终端(<code class="fe nd ne nf mt b">blank</code>)。此外，我将窗口重命名为<code class="fe nd ne nf mt b">main_window</code>，并将当前目录设置为<code class="fe nd ne nf mt b">~/work/demo</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><h1 id="3499" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">现实世界的例子</h1><p id="8a51" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">像你们中的许多人一样，作为一名程序员，我对每项任务都有不同的布局。我有一个用来写代码，另一个用来调试或尝试一些新功能。我甚至在处理特定的特性或错误时会有不同的布局，这取决于它们触及的代码部分。因此，让我们尝试使用tmuxp来复制其中两种布局。</p><h2 id="a7d3" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">编写代码</h2><p id="834b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我的代码编写配置中，我通常有一个包含文本编辑器、终端和文件管理器的窗口，比如<a class="ae ky" href="https://vifm.info/" rel="noopener ugc nofollow" target="_blank"> vifm </a>。此外，我激活正确的虚拟环境，并在所有窗格中设置当前工作目录。此外，我打开我的编辑器到最后编辑的文件，并在终端窗格中显示当前的git状态(在一个周末之后，这对于避免混合更改非常有用)。配置如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/3befa8dfdeb15eb0587073d4f9bec198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ZsMBJ_xy0DYBjhLvSld6Zg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用tmuxp的开发配置</p></figure><h2 id="82d3" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">测试</h2><p id="c736" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当尝试新功能时，我使用包含两个窗口的更复杂的布局。第一个有一个文本编辑器，一个发布命令的终端(<code class="fe nd ne nf mt b">kubectl</code>、<code class="fe nd ne nf mt b">curl</code>等)。)，以及一个查看主日志的终端。第二个窗口包含每个容器日志的窗格。此外，我配置<code class="fe nd ne nf mt b">kubeclt</code>来使用正确的配置和上下文。配置如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/634846b3566ad424e2d87c40d637b3e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hCBdG5k3xQrj1R6uu_B9lA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用tmuxp测试配置</p></figure><h2 id="0995" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">临时演员</h2><p id="065a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我的配置之上，我使用以下助手来简化tmuxp的使用:</p><ul class=""><li id="705c" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated">在我的rc文件中设置别名:<code class="fe nd ne nf mt b">alias mux=’tmuxp’</code>。</li><li id="6b3b" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">使用<a class="ae ky" href="https://www.gnu.org/software/stow/" rel="noopener ugc nofollow" target="_blank"> GNU Stow </a>来管理我的配置。</li><li id="5c4e" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated">当我有太多配置时，使用<a class="ae ky" href="https://towardsdatascience.com/turbocharge-your-command-line-game-3344b16bfeec" rel="noopener" target="_blank"> fzf </a>帮助选择合适的配置:</li></ul><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="e7c4" class="mx lw it mt b gy my mz l na nb">alias fux='tmuxp load $(tmuxp ls | fzf --layout=reverse --info=inline --height=40%)'</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/49c5d7a5db230dde1ee0acf85dcad08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1Itx99GdAI2w79YcQByytA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用fzf加载tmuxp配置</p></figure><h1 id="1d27" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="96ef" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这篇文章概述了一些基本的<code class="fe nd ne nf mt b">tmuxp</code>特性，并向你展示了我如何构建我的一些配置。</p><p id="e6a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我觉得这个工具(或者类似的)值得一试。是的，您可以使用普通的tmux和一些shell脚本来完成我展示的所有内容。然而，管理器消除了处理和管理脚本的额外工作。此外，您总是可以从使用相同工具的其他用户那里获得一些灵感。</p><h1 id="e196" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><ul class=""><li id="3c5d" class="nr ns it lb b lc mn lf mo li oj lm ok lq ol lu nw nx ny nz bi translated"><a class="ae ky" href="https://towardsdatascience.com/turbocharge-your-command-line-game-3344b16bfeec" rel="noopener" target="_blank">增强你的命令行游戏</a></li><li id="d870" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><a class="ae ky" href="https://github.com/tmux/tmux" rel="noopener ugc nofollow" target="_blank"> GitHub — tmux/tmux: tmux源代码</a></li><li id="0081" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><a class="ae ky" href="https://github.com/tmux-python/tmuxp" rel="noopener ugc nofollow" target="_blank">GitHub—tmux-python/tmuxp:tmux会话管理器。基于libtmux构建</a></li><li id="78a1" class="nr ns it lb b lc oa lf ob li oc lm od lq oe lu nw nx ny nz bi translated"><a class="ae ky" href="https://www.gnu.org/software/stow/" rel="noopener ugc nofollow" target="_blank"> Stow — GNU项目—自由软件基金会</a></li></ul><h2 id="2140" class="mx lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">想联系作者？</h2><p id="0c5f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在Twitter上关注我，我经常在那里发关于软件开发和机器学习的微博。</p></div></div>    
</body>
</html>