<html>
<head>
<title>Identify Music With Your AI-Powered Assistant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用你的人工智能助手识别音乐</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/identify-music-with-your-ai-powered-assistant-4202763ca553?source=collection_archive---------24-----------------------#2022-09-12">https://betterprogramming.pub/identify-music-with-your-ai-powered-assistant-4202763ca553?source=collection_archive---------24-----------------------#2022-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b4d0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当你问“那首歌是什么？”时，得到一个答案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/da4a8119500a106049b8f7540a79980e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlIfKd24L4FLFAH2u514eg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="65bf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你好，欢迎光临！</p><p id="bbfa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上一篇文章中，我们使用Howler.js来控制音频播放。今天，我们将使用ACRCloud API像SoundHound一样识别音乐。</p><p id="807f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我们将能够发出诸如“这是什么歌？”这样的命令并得到回复。</p><p id="8805" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面的视频展示了这一点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">演示视频</p></figure><h1 id="bab6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">安装</h1><p id="edb5" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">如果您错过了上一篇文章，请阅读它以了解我们如何添加新的命令处理程序。</p><p id="1d06" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mq" rel="noopener ugc nofollow" target="_blank" href="/control-audio-playback-with-your-ai-powered-assistant-967dce72a582">用人工智能助手控制音频播放|作者:Joseph Nma | 2022年9月|更好的编程</a></p><p id="c644" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是如果你想向前看，我建议至少读一下这个系列的第一部分。</p><p id="a63d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mq" rel="noopener ugc nofollow" target="_blank" href="/build-your-own-ai-powered-virtual-assistant-on-the-web-175fc9e61973">在网络上构建你自己的人工智能虚拟助手|作者Joseph Nma | 2022年8月|更好的编程</a></p><p id="2c72" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以在这里找到本文<a class="ae mq" href="https://github.com/WoolDoughnut310/houndify-voice-assistant/tree/part3" rel="noopener ugc nofollow" target="_blank">的起始代码。</a></p><p id="78aa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，启用<code class="fe mr ms mt mu b">SoundHoundNow</code>域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/98d1ed5239a766f007a36db941e6243d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QccBBzkMsl8iflmMu-ivtQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Houndify.com上启用新域</p></figure><p id="d2b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">启用并单击右上角的保存更改。该域将启用音乐识别命令。</p><h1 id="f5d9" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">处理音乐识别命令</h1><p id="1b44" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">创建一个新的处理程序文件，见上一篇文章。命名为<code class="fe mr ms mt mu b">SoundHoundNowCommand.ts</code>。</p><p id="83a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将以下代码添加到文件的顶部:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="7923" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mr ms mt mu b">STARTING_RESULT</code>定义了一个包含“正在听……”的结果作为回应。一旦我们录制了音频，我们就输出对文本到语音转换响应。</p><p id="d5d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将定义一个名为<code class="fe mr ms mt mu b">handleACRCommand</code>的函数。我们称之为开始监听并返回一个结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="c2b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们来分析一下。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="833c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们“说出”结果，等待演讲结束。注意，我们首先必须将<code class="fe mr ms mt mu b">App.tsx</code>中的<code class="fe mr ms mt mu b">say</code>函数提取到一个新文件中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="8dd0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们在录制音频时显示一段祝酒词来提醒用户。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="0cc7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们将音频数据以“文件”的名称发送到服务器</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="841e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">服务器识别音频并返回数据。然后，我们使用这些数据来格式化响应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><p id="b905" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们用新的口头回答返回结果。</p><p id="a824" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不要忘记将我们的新文件添加到<code class="fe mr ms mt mu b">index.ts</code>中的handlers数组中。</p><pre class="kg kh ki kj gt mx mu my mz aw na bi"><span id="63c7" class="nb lu iq mu b gy nc nd l ne nf">const COMMANDS = ["MusicCommand", "MusicPlayerCommand", "SoundHoundNowCommand"];</span></pre><h1 id="9849" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">使用ACRCloud API</h1><p id="e0dc" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">首先，我们需要获得我们的API证书。在<a class="ae mq" href="https://www.acrcloud.com/" rel="noopener ugc nofollow" target="_blank">acrcloud.com</a>报名并创建一个音频和视频识别项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/6fded53968ca4fd41a0dc9ea80169d2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmgUJ1Xs-O6V8JSKZIdgSQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在ACRCloud创建项目</p></figure><p id="7c0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在从NPM安装<code class="fe mr ms mt mu b">arcloud</code>来访问API。我们还需要<code class="fe mr ms mt mu b">formidable</code>来解析上传的音频文件。</p><pre class="kg kh ki kj gt mx mu my mz aw na bi"><span id="eaea" class="nb lu iq mu b gy nc nd l ne nf">npm i acrcloud formidable @types/formidable</span></pre><p id="dbac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在将您的凭证添加到<code class="fe mr ms mt mu b">.env</code>文件的末尾，如下所示:</p><pre class="kg kh ki kj gt mx mu my mz aw na bi"><span id="cfc2" class="nb lu iq mu b gy nc nd l ne nf">...<br/>ACRCLOUD_HOST=identify-eu-west-1.acrcloud.com<br/>ACRCLOUD_ACCESS_KEY=*****<br/>ACRCLOUD_SECRET=*****</span></pre><h1 id="7b60" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">初始化ACRCloud实例</h1><p id="f503" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">打开<code class="fe mr ms mt mu b">server.js</code>，导入必要的包。</p><pre class="kg kh ki kj gt mx mu my mz aw na bi"><span id="ed48" class="nb lu iq mu b gy nc nd l ne nf">const acrcloud = require("acrcloud");<br/>const formidable = require("formidable");</span></pre><p id="749f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">用你的凭证初始化一个<code class="fe mr ms mt mu b">ACRCloud</code>实例。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><h1 id="571c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">添加音乐识别API路由</h1><p id="1c87" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">定义一个API路由来识别音频文件。首先，解析上传的文件并读取上传文件的路径。然后，将文件发送到ACRCloud并返回曲目的标题和艺术家。</p><p id="ea24" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是路线的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><h1 id="a2f0" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">识别音频文件</h1><p id="1713" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">定义一个函数从路径中读取文件并返回歌曲的元数据。如果ACRCloud返回一个错误，我们抛出一个错误。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw ls l"/></div></figure><h1 id="fe6d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="33a1" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">目前就这些。你可以在这里找到这篇文章的所有代码。</p><p id="4e5e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下次我们将使用Houndify API来创建定制命令。这样，我们可以使用Pokémon API实现我们自己的Pokedex。敬请期待！</p><h1 id="c2c2" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">资源</h1><p id="2111" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated"><a class="ae mq" href="https://github.com/node-formidable/formidable#with-expressjs" rel="noopener ugc nofollow" target="_blank">https://github.com/node-formidable/formidable</a></p><p id="4771" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mq" href="https://medium.com/@bryanjenningz/how-to-record-and-play-audio-in-javascript-faa1b2b3e49b" rel="noopener">https://medium . com/@ bryanjenningz/how-to-record-and-play-audio-in-JavaScript-FAA 1 b 2 b 3 e 49 b</a></p><p id="fa4a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mq" href="https://fkhadra.github.io/react-toastify/introduction" rel="noopener ugc nofollow" target="_blank">https://fkhadra.github.io/react-toastify/introduction</a></p><p id="7e3c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mq" href="https://www.npmjs.com/package/acrcloud" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/acrcloud</a></p></div></div>    
</body>
</html>