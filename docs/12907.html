<html>
<head>
<title>Create a Fancy Toast Component Using SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SwiftUI创建花式吐司组件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swiftui-create-a-fancy-toast-component-in-10-minutes-e6bae6021984?source=collection_archive---------4-----------------------#2022-07-11">https://betterprogramming.pub/swiftui-create-a-fancy-toast-component-in-10-minutes-e6bae6021984?source=collection_archive---------4-----------------------#2022-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9123" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建令人惊叹的用户界面</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/49bfa0dc308dcb9eefdbf1a76bed8abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGRdgMGXzsVqZhUBFBrU9g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对，我们要做这个组件！🎉</p></figure><p id="8e86" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">嗨，伙计们，欢迎来到另一篇SwiftUI文章！在本文中，我们将在SwiftUI中快速轻松地制作一个别致的toast组件。谁兴奋了？</p><h2 id="e077" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">什么是吐司？</h2><blockquote class="mk ml mm"><p id="ebc8" class="kv kw mn kx b ky kz jr la lb lc ju ld mo lf lg lh mp lj lk ll mq ln lo lp lq ij bi translated">toast组件是一个非破坏性消息，显示在界面底部，提供关于操作结果的快速、一目了然的反馈。<a class="ae mr" href="https://polaris.shopify.com/components/toast" rel="noopener ugc nofollow" target="_blank">来源</a></p></blockquote><p id="ca71" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基于UX的观点:</p><p id="0c30" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Toast应该只用于不需要完全中断用户体验的确认、简单通知和低优先级警报。</p><p id="eb8d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">事不宜迟，我们开始吧！</p><h1 id="324b" class="ms ls iq bd lt mt mu mv lw mw mx my lz jw mz jx mc jz na ka mf kc nb kd mi nc bi translated">1.创建toast视图</h1><p id="5eeb" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">首先，创建一个SwiftUI视图文件，并将其命名为<code class="fe ni nj nk nl b">FancyToastView</code>或其他名称。这是我们将向用户显示的toast的主视图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1d46" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基于上面的代码，toast由水平排列的图标、标题、消息和关闭按钮组成。对于图标，我们将使用<code class="fe ni nj nk nl b">SFSymbol</code>,这样您就不需要导入资产来运行上面的代码。</p><p id="946b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们用一张覆盖图来制作边单。当运行上面的代码时，视图应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/abf767d679aa67ecfc626aee2797eb89.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*RXpVBEoaCDJAvTg8xp4eng.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">如此奇特又如此简单，对吧？😁</p></figure><p id="84ed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是…我们希望祝酒词的内容是动态的。行..下一个。</p><h1 id="db63" class="ms ls iq bd lt mt mu mv lw mw mx my lz jw mz jx mc jz na ka mf kc nb kd mi nc bi translated">2.创建toast枚举样式和toast模型</h1><p id="2719" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">我们将制作4种最常见的祝酒方式。样式包括信息、错误、警告和成功。不同之处通常在于主题颜色和图标。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a419" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我认为上面的代码非常简单。我们有4种类型，我们使用computed属性来获取每种类型的主题颜色和图标文件名。如此简单！</p><p id="37f6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将制作一个模型来配置我们的toast内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0dc4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的模型包含type，其中type是我们之前创建的enum，title和message是将在烤面包机上显示的消息内容，duration是决定烤面包机将显示多长时间的值，然后自动关闭它。此外，我们在模型中使用了Equatable，因为我们希望区分不同的吐司。</p><h1 id="4833" class="ms ls iq bd lt mt mu mv lw mw mx my lz jw mz jx mc jz na ka mf kc nb kd mi nc bi translated">3.将视图与模型集成</h1><p id="47cd" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">下一步是将我们的主视图与模型集成，这样我们的烤面包机内容就是动态的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b065" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">和上一个没多大区别吧？我们只是用模型中的值替换硬编码的值。如果你注意到了，就会发现有些不同。是的，我们对cancel按钮操作使用回调函数，所以我们希望父视图执行关闭toast的逻辑。</p><p id="b115" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后尝试通过调用视图来运行它，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="6fbc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">视图应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/8d136a17f22506838847c3d20b2a5379.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*t_bH3T7VvEU_LeeT7N7fqg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">耶！</p></figure><p id="d0e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更近一步…</p><h1 id="08c2" class="ms ls iq bd lt mt mu mv lw mw mx my lz jw mz jx mc jz na ka mf kc nb kd mi nc bi translated">4.创建一个ViewModifier来显示toast</h1><p id="3ec3" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">我们希望能够轻松、无缝地展示我们的祝酒词，当然还可以重复使用。因为我们将在应用程序的许多视图中使用这个toast。如果我们创建一个ZStack，然后手动将toast放在每个视图的tp视图中，这将是非常复杂和累人的。<code class="fe ni nj nk nl b">ViewModifier</code>是一把钥匙！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">赞成..我希望这不会让:D感到困惑</p></figure><p id="5a5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可能这是之前上面众多代码中最复杂，也有点混乱的一个。但是请冷静…我会试着用简单的方式解释。</p><p id="cd9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个视图修改器中，有两个具有不同属性包装的变量。</p><p id="f19c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一个是toast，这是一个toast模型，我们使用<code class="fe ni nj nk nl b">@Binding</code>属性包装器将它绑定到toast视图，这样我们可以从内部改变值，并且如果外部的值发生变化，我们也可以直接反映出来。</p><p id="6931" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第二个是<code class="fe ni nj nk nl b">workItem</code>，它是一个<code class="fe ni nj nk nl b">DispatchWorkItem</code>，当烤面包时间达到指定的持续时间时，它将帮助我们关闭烤面包。明白了吗？</p><p id="cd48" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还有2个视图函数和2个逻辑函数。我不会详细讨论UI代码，因为我相信你们所有人都已经理解了SwiftUI的基础，从上面的代码来看没有什么是困难的。一切都很基本。</p><p id="055b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们只是将框架内容的大小设置为无穷大，这意味着它适合设备屏幕，因此我们的toast组件将按照我们的预期出现在屏幕的底部。然后我们使用overlays和ZStack将我们的toast组件放在内容之上。我们还使用<code class="fe ni nj nk nl b">onChange</code>修饰符来执行负责显示toast的函数。</p><p id="33a3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来是<code class="fe ni nj nk nl b">showToast</code>函数，我认为它也很简单。因为我们只是调用了<code class="fe ni nj nk nl b">UIImpactFeedbackGenerator</code>函数来让我们的toast变得引人注目和花哨，然后设置<code class="fe ni nj nk nl b">workItem</code>任务并在指定的持续时间后执行它。</p><p id="50e6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后一个是<code class="fe ni nj nk nl b">dismissToast</code>，也是直白吧？我们只是将nil设置为绑定toast，然后取消并将nil设置为我们的工作项，以防止内存泄漏。</p><h2 id="be09" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">完成了吗？嗯差不多。</h2><p id="5216" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">使它变得更容易和更有趣的最后一步是在视图扩展中创建一个函数，这样我们就可以使用我们的组件变得更加“SwiftUI”。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="bf63" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们完成了组件的创建，现在可以使用了！</p><p id="99f9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用组件的示例如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="2247" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尝试运行它，它应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/eaabfe99007bcb0e14f7f71afcb26620.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/1*4TRtJHjw4eG1xHXVxmJHuQ.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">太棒了！！</p></figure><h2 id="0a12" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">结论</h2><p id="062a" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">Toast在应用程序中是一个非常常见的东西，我想为那些可能不知道如何在SwiftUI中制作这个组件的人分享如何轻松制作toast组件。或者对于那些已经有制作这个吐司组件的经验的人，或者有更好的东西，请在下面的评论中自由讨论。</p><p id="4ed8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，您可以自己探索如何创建一个队列系统，如果您想要显示多个祝酒词和其他内容的话。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt ny nl nz oa aw ob bi"><span id="5c18" class="lr ls iq nl b gy oc od l oe of"><strong class="nl ir">Want to Connect?</strong></span><span id="7f32" class="lr ls iq nl b gy og od l oe of">If you’re an Indonesian, <a class="ae mr" href="https://careers.blibli.com/" rel="noopener ugc nofollow" target="_blank">Blibli.com is Hiring</a>! Pssst we are using SwiftUI in one of our projects</span></pre></div></div>    
</body>
</html>