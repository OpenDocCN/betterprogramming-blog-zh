<html>
<head>
<title>Email Syntax Validation and Existence Verification in PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PHP中的电子邮件语法验证和存在性验证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/email-syntax-validation-and-existence-verification-in-php-5f7fdad768dd?source=collection_archive---------7-----------------------#2022-04-12">https://betterprogramming.pub/email-syntax-validation-and-existence-verification-in-php-5f7fdad768dd?source=collection_archive---------7-----------------------#2022-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ecf1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何构建一个PHP脚本来验证电子邮件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/42352dde48a5cc10c1336d8c20d295f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uwJ8NvKVW6ibb9ND"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">本·格里菲斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="4b57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设您在一段时间内从用户那里收集了几封电子邮件，但没有向他们发送验证电子邮件。现在，您希望使用这些电子邮件来联系您的用户，发送简讯，或者只是确保您收集的电子邮件有效并且存在。在这种情况下，你应该找到一种方法来检测无效和虚假的电子邮件，并要求这些用户向你提供一个有效的电子邮件。最简单的方法是向每个用户发送一封验证电子邮件。</p><p id="fc48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种后验方法的问题是，你要求你的用户主动执行一个动作，如果你在他们注册后发送了一封验证邮件，这个动作就没有必要了。此外，许多用户可能不活跃，懒惰，或怀疑他们收到的验证链接。换句话说，给所有人发一封验证邮件可能不是最好的方法。</p><p id="c757" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，您应该考虑运行一个脚本来验证您的电子邮件，然后只联系电子邮件未通过测试的用户。因此，让我们看看如何构建一个脚本来验证电子邮件是否有效以及是否存在于PHP中。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7605" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何在PHP中验证电子邮件</h1><p id="78ef" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有几种在线服务可以让你验证一封电子邮件在语法上是否有效以及是否存在。在这里，您将学习如何用两种方法来验证和确认电子邮件。第一个不涉及<a class="ae ky" href="https://getcomposer.org/" rel="noopener ugc nofollow" target="_blank"> Composer </a>，而第二个使用了Composer依赖。</p><p id="5e52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，这些方法都不是完美的。尽管它们很少失败，但它们仍然是验证你的大部分邮件的有效方法。</p><p id="2754" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h2 id="1e83" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">1.不使用编写器验证电子邮件</h2><p id="d0da" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">第一种方法不需要Composer，并且基于SMTP验证。点击了解更多关于这种电子邮件存在验证方法的工作原理<a class="ae ky" href="https://mailtrap.io/blog/verify-email-address-without-sending/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="f4fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体来说，您可以使用下面GitHub repo中的<code class="fe nl nm nn no b">SMTP_validateEmail</code>类，根据SMTP方法验证电子邮件是否存在:</p><pre class="kj kk kl km gt np no nq nr aw ns bi"><span id="01c0" class="mz md it no b gy nt nu l nv nw"><a class="ae ky" href="https://github.com/semplon/php-smtp-email-validation" rel="noopener ugc nofollow" target="_blank">https://github.com/semplon/php-smtp-email-validation</a></span></pre><p id="b2f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管这是一个老项目，但它仍然非常有效。因为这个类不区分语法失败和存在失败，所以您需要定义一个函数来验证电子邮件在PHP中的语法是否正确。您可以通过以下方式实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="952a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的<code class="fe nl nm nn no b">validateEmail()</code>函数使用<code class="fe nl nm nn no b"><a class="ae ky" href="https://www.php.net/manual/en/function.filter-var.php" rel="noopener ugc nofollow" target="_blank">filter_var()</a></code> PHP函数来验证电子邮件地址。如果您将<code class="fe nl nm nn no b">FILTER_VALIDATE_EMAIL</code>选项过滤器传递给它，<code class="fe nl nm nn no b">filter_var()</code>将从语法角度验证存储在<code class="fe nl nm nn no b">$email</code>中的电子邮件地址，如果成功则返回过滤后的数据，如果失败则返回<code class="fe nl nm nn no b">false</code>。然后<code class="fe nl nm nn no b">filter_var()</code>返回的值被转换成<a class="ae ky" href="https://www.php.net/manual/en/language.types.boolean.php" rel="noopener ugc nofollow" target="_blank">布尔</a>，最后由<code class="fe nl nm nn no b">validateEmail()</code>函数返回。</p><p id="3cb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您已经拥有了在PHP中不使用Composer来验证和发送电子邮件所需的一切。您可以实现这一点，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="3b37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，在上面的例子中，<code class="fe nl nm nn no b">SMTP_validateEmail</code>类及其子文件夹和文件被放置在<code class="fe nl nm nn no b">vendor</code>文件夹中。</p><h2 id="54f7" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">2.使用Composer验证电子邮件</h2><p id="2f16" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这里，你将学习如何使用<a class="ae ky" href="https://github.com/masroore/verifyemail" rel="noopener ugc nofollow" target="_blank"> VerifyEmail </a> PHP库。如官方GitHub页面所述，VerifyEmail允许您验证电子邮件地址的语法是否正确以及是否存在。</p><p id="34b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用以下Composer命令安装它:</p><pre class="kj kk kl km gt np no nq nr aw ns bi"><span id="5745" class="mz md it no b gy nt nu l nv nw">composer require "masroore/verifyemail"</span></pre><p id="959a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该库支持4种不同级别的验证:</p><ul class=""><li id="ab82" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated"><code class="fe nl nm nn no b">SyntaxCheck</code>:通过执行语法检查来验证电子邮件地址。</li><li id="3daf" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe nl nm nn no b">DnsQuery</code>:通过使用电子邮件地址字符串的域部分检查负责电子邮件传送的SMTP MX主机是否存在来验证电子邮件地址。</li><li id="893b" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe nl nm nn no b">SmtpConnection</code>:通过测试与SMTP MX主机的连接来验证电子邮件地址。</li><li id="2982" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><code class="fe nl nm nn no b">SendAttempt</code>:通过测试SMTP连接，发送<code class="fe nl nm nn no b">EHLO/HELO</code>和<code class="fe nl nm nn no b">MAIL FROM</code>命令，并在<code class="fe nl nm nn no b">RCPT TO</code>命令中提交给定的电子邮件地址字符串来验证电子邮件地址。这是最完整的方法，也是默认使用的方法。</li></ul><p id="9939" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们中的每一个都可以用在<code class="fe nl nm nn no b">AddressValidationLevel</code>类中定义的<code class="fe nl nm nn no b">EmailAddressVerifier::validationLevel</code>属性来设置。</p><p id="3ff7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe nl nm nn no b">EmailAddressVerifier</code>验证电子邮件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="41a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，几行代码足以验证你的邮件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a52c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="ed4d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这里，我们看了如何实现一个PHP脚本来验证电子邮件列表，并验证它们是否存在。这可以通过多种方式实现。在本文中，我们学习了如何使用外部库和Composer库来实现。在这两种情况下，几行代码就足够了。</p><p id="58b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！我希望这篇文章对你有所帮助。</p></div></div>    
</body>
</html>