<html>
<head>
<title>Creating a Multi-Filter Function to Filter Out Multiple Attributes Using Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Javascript创建多重过滤函数来过滤多个属性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-multi-filter-function-to-filter-out-multiple-attributes-javascript-react-rails-5aad8e272142?source=collection_archive---------0-----------------------#2019-05-12">https://betterprogramming.pub/creating-a-multi-filter-function-to-filter-out-multiple-attributes-javascript-react-rails-5aad8e272142?source=collection_archive---------0-----------------------#2019-05-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9375" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当一个过滤器不够用时</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/9b030ee2c3e0be3c69dac07ab1e0ee37.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*e5GJWv9b_7M8-H08kEBXSQ.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="http://www.techtalk.gfi.com/wp-content/uploads/2011/07/web-content-filtering-200x300.jpg" rel="noopener ugc nofollow" target="_blank">http://www . tech talk . gfi . com/WP-content/uploads/2011/07/we B- content-filtering-200 x300 . jpg</a></p></figure><p id="ec83" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在最近一次训练营的最后一个项目中，我的任务是创建一个电子商务网站，顾客可以在这里购买童装。在建立网站的时候，我最大的挑战是编写一个<code class="fe lo lp lq lr b">.filter</code>功能，客户可以点击标签来缩小他们的产品列表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ls"><img src="../Images/e6d1291ef1d7f35f1ba6794d481656ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSswj4N0Nd-090eAFx4HHA.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">客户可以点击任何标签，我的过滤功能将只呈现满足客户选择的产品。</p></figure><p id="5b42" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这篇文章中，我将介绍我的过程和代码以及最终结果，同时详细说明<strong class="ku ir">如何创建一个多重过滤函数</strong>，该函数比较产品的所有属性和客户选择的标签，以输出一个经过过滤的产品列表。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="9795" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">什么是。Javascript中的filter()？</h1><blockquote class="mw"><p id="c206" class="mx my iq bd mz na nb nc nd ne nf ln dk translated"><code class="fe lo lp lq lr b"><strong class="ak">filter()</strong></code>方法创建一个新的数组，其中所有元素都通过了由提供的函数实现的测试。— <a class="ae kr" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter" rel="noopener ugc nofollow" target="_blank"> MDN文档</a></p></blockquote><figure class="ng nh ni nj nk kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="35e0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">接受一个函数作为参数，使用<code class="fe lo lp lq lr b">.filter()</code>将返回一个新数组，其中包含所有返回<code class="fe lo lp lq lr b">true</code>的元素。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="207f" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">产品表设计</h1><p id="1d54" class="pw-post-body-paragraph ks kt iq ku b kv nn jr kx ky no ju la lb np ld le lf nq lh li lj nr ll lm ln ij bi translated">在开始解释之前，让我们回顾一下将要过滤的产品的属性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ls"><img src="../Images/67b488fd5df4bc150ac37357e74dee37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZOAJEyFBXl5-lgP0z3-R4w.png"/></div></div></figure><p id="c7ed" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">以下是每个键的值:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="b5b5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这很有挑战性，不仅因为我想创建一个动态过滤函数，还因为<code class="fe lo lp lq lr b">material</code>是一个包含多个元素的数组。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="8aad" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">我的完整代码</h1><p id="b490" class="pw-post-body-paragraph ks kt iq ku b kv nn jr kx ky no ju la lb np ld le lf nq lh li lj nr ll lm ln ij bi translated">该网站的一个特点是，客户可以看到他们在搜索输入上面选择了什么标签。要取消标签，只需点击选择的标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ls"><img src="../Images/3ecaf235265178aa5df54c03e989d0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NiPVmvlWek6cy4O49lG5Q.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ns"><img src="../Images/fa7fe36b5d6b1c54ffbbf572291e8dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/1*3OqZMJyR8Q1IG8CKNB8NOA.gif"/></div></div></figure><p id="246c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了在放大镜图标和搜索部分之间呈现选择的标签，我必须以特定的方式设计我的react的<code class="fe lo lp lq lr b">state</code>。“标签收集”部分(红色小矩形)将收集客户点击的任何标签，这意味着当其中一个标签被点击时，它将触发一个回调，<code class="fe lo lp lq lr b">callFilterClickListener()</code>，将布尔状态设置为true。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">出现在标签收集部分的所有标签都在“传递标签”中</p></figure><p id="5138" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因为每个键中的每个元素都有不同的职责，并且因为我要求它们都是客户可以点击的标签，所以我不得不写了一个很长的脚本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nt"><img src="../Images/c398f88964138cd5f84c3db8f17e1976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2QpbhASevfrabDRb4cCCRQ.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">每个键都有自己的“div”标签，但调用相同的函数时使用不同的参数。</p></figure><p id="56d1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因为客户可以点击任何标签来取消它们，包括已经选择的标签，所以我包含了另一个看起来与上面的组件非常相似的组件。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="ffb1" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">。allFilterClickListener()</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="a237" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">函数<code class="fe lo lp lq lr b">allFilterClickListener()</code>动态地将事件和属性名称作为参数(参见我的完整代码下的<em class="nu"> </em>第一张图片<em class="nu"> </em>)。</p><p id="0c58" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><em class="nu">侧注:React Doc建议使用</em> <code class="fe lo lp lq lr b"><em class="nu">.setState()</em></code> <em class="nu">时使用</em> <code class="fe lo lp lq lr b"><em class="nu">prevState</em></code> <em class="nu">。更多信息可以在</em> <a class="ae kr" href="https://teamtreehouse.com/community/react-docs-now-recommends-using-function-with-prevstate-inside-of-setstate" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir"> <em class="nu">这个链接</em> </strong> </a> <em class="nu">中找到。</em></p><p id="25f0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">假设客户点击了<code class="fe lo lp lq lr b">white</code>、<code class="fe lo lp lq lr b">pink</code>、<code class="fe lo lp lq lr b">cotton</code>和<code class="fe lo lp lq lr b">girl</code>。该函数将搜索<code class="fe lo lp lq lr b">state,</code>找到名为<code class="fe lo lp lq lr b">color</code>的键，并根据<code class="fe lo lp lq lr b">state</code>的状态将布尔值更改为真或假。然后重复该过程，用<code class="fe lo lp lq lr b">girl</code>过滤<code class="fe lo lp lq lr b">material</code>至<code class="fe lo lp lq lr b">cotton</code>和<code class="fe lo lp lq lr b">gender</code>。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="c86b" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated"><code class="fe lo lp lq lr b">.filteredCollected()</code></h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="708e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">该函数通过单独遍历<code class="fe lo lp lq lr b">color, gender, material, and category</code>并按下值为真的键返回<code class="fe lo lp lq lr b">collectedTrueKeys</code>。既然我选了<code class="fe lo lp lq lr b">white, pink, cotton, and girl</code>，<code class="fe lo lp lq lr b">collectedTrueKeys</code>，就会是这个样子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="987c" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">。multiPropsFilter()</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="4489" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是我在<a class="ae kr" href="https://gist.github.com/jherax/f11d669ba286f21b7a2dcff69621eb72" rel="noopener ugc nofollow" target="_blank"><strong class="ku ir"><em class="nu">GitHub</em></strong></a>上找到的一个功能。该函数比较两个参数products和filters，并返回通过给定筛选器的唯一产品。</p><p id="3993" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，仅仅从资源中复制粘贴代码是不够的，因为<code class="fe lo lp lq lr b">material</code>是一个包含多种材料的数组。因此，除了代码之外，我还在第182行到第186行添加了代码。如果<code class="fe lo lp lq lr b">product</code>中的一个键是一个数组，它将再次遍历该数组并返回任何为真的值。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="6818" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">。搜索产品()</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="b04c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因为顾客可以通过输入来搜索产品，<code class="fe lo lp lq lr b">.searchProducts()</code>同时处理过滤和搜索。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="19da" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然后，子组件<code class="fe lo lp lq lr b">ProductContainer</code>将接收已经过滤的产品列表。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="b174" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">摘要</h1><ol class=""><li id="3fec" class="nv nw iq ku b kv nn ky no lb nx lf ny lj nz ln oa ob oc od bi translated">客户将触发<code class="fe lo lp lq lr b">.allFilterClickListener(event, &lt;key name&gt;)</code>当点击任何过滤标签。</li><li id="27a5" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><code class="fe lo lp lq lr b">.allFilterClickListener()</code>接收被点击的标签并改变右边的<code class="fe lo lp lq lr b">state</code>。</li><li id="8d69" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><code class="fe lo lp lq lr b">.filteredCollected()</code>循环遍历状态并收集任何值为真的键。</li><li id="30d3" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><code class="fe lo lp lq lr b">.multiPropsFilter()</code>取所有产品列表，过滤返回过滤后的产品列表。</li><li id="31a1" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated">因为子组件<code class="fe lo lp lq lr b">ProductContainer</code>总是调用<code class="fe lo lp lq lr b">.searchProducts()</code>，所以数字3和4都将对变化做出响应。</li></ol></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h1 id="b9c7" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">结论</h1><p id="8783" class="pw-post-body-paragraph ks kt iq ku b kv nn jr kx ky no ju la lb np ld le lf nq lh li lj nr ll lm ln ij bi translated">使用Javascript时，我可以做任何我想做的事情，这真是太神奇了。即使我的<code class="fe lo lp lq lr b">material</code>嵌套了更多的数组，我仍然能够得到想要的结果。作为一名训练营学生，我上一个项目的挑战帮助了我的思考过程，这是一次伟大而愉快的经历，在我前进的过程中，我将永远记住它。</p></div></div>    
</body>
</html>