<html>
<head>
<title>Boost Your Productivity With Apollo Hooks and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apollo Hooks和TypeScript提高您的生产力</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/boost-your-productivity-with-apollo-hooks-and-typescript-91f246fdef95?source=collection_archive---------12-----------------------#2020-06-30">https://betterprogramming.pub/boost-your-productivity-with-apollo-hooks-and-typescript-91f246fdef95?source=collection_archive---------12-----------------------#2020-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1a4d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Apollo代码生成生成类型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ea8750a6144136a5878aeb387f7d91a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOu36IkK1m8kz1x7G3aM8Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@spacex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> SpaceX </a>在<a class="ae ky" href="/s/photos/rocket?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="efaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个世界上，TypeScript正成为许多web应用程序必不可少(几乎是必需的)的一部分，了解如何在我们当前堆栈中的许多库上使用它是非常有用的。</p><p id="7d13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在使用一个已经使用了TypeScript的React应用程序，并且你也使用了<a class="ae ky" href="https://www.apollographql.com/" rel="noopener ugc nofollow" target="_blank"> Apollo </a>，这个指南将帮助你开始一起使用它们来利用静态类型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="91e6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">开始我们的项目</h1><p id="d18a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们在新应用中配置Apollo:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2d3c" class="ne md it na b gy nf ng l nh ni">yarn add apollo-boost @apollo/react-hooks apollo</span></pre><p id="9c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们创建Apollo客户机，并将其用于React应用程序。</p><p id="a279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nj nk nl na b">App.tsx</code>上，添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="41a2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">编写一些查询</h1><p id="845c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们已经在应用程序中配置了Apollo，让我们编写一些查询来从API中获取数据。</p><p id="0095" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在<code class="fe nj nk nl na b">src</code>文件夹中创建一个名为<code class="fe nj nk nl na b">queries.ts</code>的新文件，并添加我们的第一个查询来获取字符:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="75de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的查询使用了一些变量来过滤字符并对列表进行分页。看<code class="fe nj nk nl na b">results</code>里面的字段。那些是属于角色的。还有一些，但这些是目前最相关的。</p><p id="7476" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，创建一个名为<code class="fe nj nk nl na b">Characters.tsx</code>的新字段。这是我们将使用查询并发出请求的地方:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b8e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地理解这一点，我们来分解一下:</p><ul class=""><li id="760c" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated"><code class="fe nj nk nl na b">useQuery</code> —根据<a class="ae ky" href="https://www.apollographql.com/docs/react/data/queries/" rel="noopener ugc nofollow" target="_blank"> Apollo的文档</a>，这是在Apollo应用程序中执行查询的主要API。不再需要高阶元件。只需使用<code class="fe nj nk nl na b">useQuery</code>，它将返回一个包含<code class="fe nj nk nl na b">loading</code>、<code class="fe nj nk nl na b">error</code>和<code class="fe nj nk nl na b">data</code>属性的对象。</li><li id="485f" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated"><code class="fe nj nk nl na b">charactersQuery</code> —这是我们之前写的查询。将它传递给<code class="fe nj nk nl na b">useQuery</code>钩子，它将返回数据。</li></ul><p id="acb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将这个新的<code class="fe nj nk nl na b">Characters</code>组件导入到app中，你会看到所有角色的数据。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="465b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">生成类型</h1><p id="550c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这是我最喜欢的部分:您可以为查询生成类型。使用Apollo Codegen将使我们在编写代码时大大提高生产率。</p><p id="9a5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之前，我们安装了<code class="fe nj nk nl na b">apollo</code>库，所以现在我们将在项目的根目录下创建一个配置文件(<code class="fe nj nk nl na b">apollo.config.js</code>):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="79c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在<code class="fe nj nk nl na b">package.json</code>上包含一个新的脚本来运行它并生成类型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="f46b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nj nk nl na b">tagName</code>标志是使用的模板文字标签的名称(在本例中是<code class="fe nj nk nl na b">gql</code>),<code class="fe nj nk nl na b">target</code>是要使用的代码生成器的类型，最后的<code class="fe nj nk nl na b">types</code>是输出和所有类型将要存放的新文件夹。</p><p id="4c91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://github.com/apollographql/apollo-tooling#apollo-clientcodegen-output" rel="noopener ugc nofollow" target="_blank">文档</a>以了解您可以设置的其他选项。</p><p id="a382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以现在你已经准备好在控制台上运行<code class="fe nj nk nl na b">yarn run apollo:codegen</code>，看看会发生什么:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/41bd985a4aacd79c880d158e8be1409f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dil7yHzSgQ3FuGgj.png"/></div></div></figure><p id="3f1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查您的项目，您应该会看到两个新文件夹。我们只需要里面有<code class="fe nj nk nl na b">charactersQuery.ts</code>文件的那个。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5b05" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用带挂钩的类型</h1><p id="e2b2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们回到<code class="fe nj nk nl na b">Characters</code>组件。现在我们已经生成了类型，下一部分很简单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9476" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入这些类型，将它们包含在<code class="fe nj nk nl na b">useQuery</code>钩子上，现在就可以开始了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/0d6edbd8b78a6f553d8fbd74ce948cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8e7YvNRxzxVgXDiO.png"/></div></div></figure><p id="b5eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们已经包含了变量的类型，如果您尝试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b017" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将抛出一个错误:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="105f" class="ne md it na b gy nf ng l nh ni">Type 'string' is not assignable to type 'number | null | undefined'.ts(2322)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6ca8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="5279" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一般来说，我尝试在我所有的项目中使用TypeScript。拥有查询和变异的类型节省了我很多时间。我希望你觉得这是有用的。</p></div></div>    
</body>
</html>