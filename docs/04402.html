<html>
<head>
<title>How to Implement Sign-In With SwiftUI and AWS Amplify (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用SwiftUI和AWS Amplify实现登录(第2部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-implement-sign-in-with-swiftui-and-aws-amplify-part-2-4a7b20bfe8cc?source=collection_archive---------7-----------------------#2020-04-10">https://betterprogramming.pub/how-to-implement-sign-in-with-swiftui-and-aws-amplify-part-2-4a7b20bfe8cc?source=collection_archive---------7-----------------------#2020-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f5b2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">与脸书一起登录</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8138154afc9a045cc5a675c601585f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*07Kkqv0_eeE-_8fq"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@tma?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">天一马</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="d611" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">检查您的用户</h1><p id="3b72" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">在开始准备我们的脸书登录之前，我希望你按照本教程第一部分的<a class="ae kv" href="https://medium.com/better-programming/sign-in-with-aws-amplify-and-swiftui-978b01a5cf10" rel="noopener">来设置你的AWS Amplify项目。设置是最难的(也是最长的)部分。相比之下，使用脸书添加登录将非常简单。</a></p><p id="d064" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果到目前为止您已经完成了所有工作，并且成功地测试了与Google的登录，那么您应该能够在AWS控制台上查看用户的详细信息。</p><p id="ab9a" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">首先，进入<a class="ae kv" href="https://console.aws.amazon.com/amplify" rel="noopener ugc nofollow" target="_blank"> AWS放大控制台</a>。单击您的项目，并转到“后端环境”选项卡。您应该看到身份验证类别:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/85c2feb976eaa774d8aed4b416eed978.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*vhQBfXeTtLkty5ndxbcI6g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于您项目的AWS放大器控制台</p></figure><p id="8794" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果您单击身份验证链接，您应该会看到以下选项卡:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/6c1d8ce863c987f97cf6ce9bec2d8a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*leRhVlU7Nno0AX3BoSTPkQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AWS Amplify控制台中的“身份验证”选项卡</p></figure><p id="a1d9" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">现在您已经知道如何检查身份验证是否配置正确，您可以转到<a class="ae kv" href="https://console.aws.amazon.com/cognito" rel="noopener ugc nofollow" target="_blank"> AWS Cognito控制台</a>。直接访问或点击用户旁边的“在Cognito中查看”按钮。您将被要求选择您的项目。接下来，单击常规设置下的“用户和组”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/69bf64d1abea862d4661b7dce8aa6466.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*ydiJhCaEQ6S-Zpf_m1f02w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AWS认知设置</p></figure><p id="a577" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果您在第1部分中测试了使用Google登录，您应该在列表中看到您的Google用户:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/2e68ff5b11fd2940f4310b712e1f13d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*_EkSlK-hRdfQCq0JQWHwjg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AWS Cognito中的用户列表</p></figure><p id="a585" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果你点击用户，你应该会看到你要求他们提供的详细信息:姓名、电子邮件和图片URL。</p><p id="861d" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">现在，您已经知道在哪里检查您的用户信息，让我们进入下一部分，实现与脸书登录。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="509c" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">将脸书登录添加到您的项目中</h1><p id="091b" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">如果你已经在你的项目上实现了使用谷歌登录，那么添加使用脸书登录只是将<code class="fe mz na nb nc b">identityProvider </code>的字符串从<code class="fe mz na nb nc b">“Google”</code>改为<code class="fe mz na nb nc b">“Facebook”</code>的问题。由于大部分代码都是相同的，我们可以重构初始方法<code class="fe mz na nb nc b">signInWithGoogle</code>，用适当的<code class="fe mz na nb nc b">String</code> <code class="fe mz na nb nc b">“Google”</code>调用方法<code class="fe mz na nb nc b">signInWithIdentityProvider</code>。对于方法<code class="fe mz na nb nc b">signInWithFacebook</code>，我们将做同样的事情，传递<code class="fe mz na nb nc b">String</code> <code class="fe mz na nb nc b">“Facebook”</code>。您可以检查以下方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用多个身份提供商登录</p></figure><p id="0e02" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">或者，在<code class="fe mz na nb nc b">ContentView.swift</code>中，您可以在点击按钮时调用<code class="fe mz na nb nc b">signInVC.signInWithIdentityProvider(with: "Google")</code>，这是您喜欢的。</p><p id="27cb" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">你可能已经注意到了第<code class="fe mz na nb nc b">if provider == "Facebook"…</code>行。这是因为脸书的图片URL嵌入在我们需要解码的对象中，所以我们添加了这个小验证。要解码图片网址，可以查看下面的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">解析脸书图片URL的方法</p></figure><p id="dbac" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">当然，不要忘记添加一个按钮，用脸书登录并调用你的新方法。检查下面更新的<code class="fe mz na nb nc b">ContentView.swift</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有新的“用脸书按钮登录”的内容视图</p></figure><p id="6464" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">现在，你可以再次运行你的应用程序，并按下新的<code class="fe mz na nb nc b">Button</code>以登录脸书。您应该会在屏幕上看到更改，还会在Xcode控制台上看到用户信息。</p><p id="d117" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果我们返回到<a class="ae kv" href="https://console.aws.amazon.com/cognito" rel="noopener ugc nofollow" target="_blank"> AWS Cognito控制台</a>并查看用户列表，您可以看到您的新脸书用户:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/0b6267dd420b0d340c3b4659268bbe11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LvHfHY0uiVMJt21aPGWAg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">脸书用户新登录的用户列表</p></figure><p id="6d10" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">就是这样。现在您的项目中有两个身份提供者了！</p><p id="e5f6" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">如果你想看看整个项目，请查看<a class="ae kv" href="https://github.com/rolisanchez/swiftui-amplify-demo" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>。</p></div></div>    
</body>
</html>