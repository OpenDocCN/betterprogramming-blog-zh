<html>
<head>
<title>Is It Possible to Use SwiftUI Preview on UIViewController?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可以在UIViewController上使用SwiftUI预览吗？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/is-it-possible-to-use-swiftui-preview-on-uiviewcontroller-b86425167765?source=collection_archive---------9-----------------------#2022-03-25">https://betterprogramming.pub/is-it-possible-to-use-swiftui-preview-on-uiviewcontroller-b86425167765?source=collection_archive---------9-----------------------#2022-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6f27" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们来了解一下！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c72db03a67cdb9b145b0d87da9125c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVFzAEb3rBhgMadg_okLkg@2x.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:苹果</p></figure><p id="6f9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在2019年WWDC大会上，苹果宣布了一个名为SwiftUI的全新框架，让每个开发者都感到惊讶。它不仅仅改变了你开发iOS应用的方式。这是自Swift首次亮相以来，苹果开发者生态系统(包括iPadOS、macOS、tvOS和watchOS)的最大转变。</p><p id="b079" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">除了以声明的方式创建视图之外，您现在还可以预览屏幕，更新视图中包含的每个图形修改。这提高了您的工作效率，因为您不再需要每次更改都运行您的应用程序来查看是否一切都按预期运行。</p><p id="d635" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你仍然在使用UIKit框架，但是你想使用SwiftUI的<code class="fe lr ls lt lu b">PreviewProvider</code>来提高你的工作效率，我会给你一些提示，告诉你如何做到这一点。</p><p id="76c6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们创建一个<code class="fe lr ls lt lu b">UIViewController</code>的扩展:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lv lw l"/></div></figure><ol class=""><li id="a64a" class="lx ly iq kx b ky kz lb lc le lz li ma lm mb lq mc md me mf bi translated">只有在可以导入SwiftUI并且处于调试模式时，Xcode才会构建这段代码。(可选)</li><li id="50c5" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated">向iOS 13及更高版本的消费者提供该扩展。</li><li id="2fd7" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated">私有的<code class="fe lr ls lt lu b">Preview</code>结构符合<code class="fe lr ls lt lu b">UIViewControllerRepresentable</code>协议。我们将使用它为我们的视图控制器创建一个预览。</li><li id="9f91" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated">结构依赖于<code class="fe lr ls lt lu b">UIViewController</code>。例如，如果我们想要一个<code class="fe lr ls lt lu b">SettingsViewController</code>的预览，我们将把它提供给<code class="fe lr ls lt lu b">Preview</code>结构。</li><li id="a746" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated"><code class="fe lr ls lt lu b">makeUIViewController(context:)</code>和<code class="fe lr ls lt lu b">updateUIViewController(_ uiviewController:context:)</code>方法是<code class="fe lr ls lt lu b">UIViewControllerRepresentable</code>协议所要求的。在<code class="fe lr ls lt lu b">makeUIViewController</code>方法中，我们返回想要获得预览的视图控制器。后一种方法保持为空。</li><li id="3695" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated">创建一个方便的<code class="fe lr ls lt lu b">preview</code>属性，为视图控制器返回一个<code class="fe lr ls lt lu b">Preview</code>。</li></ol><p id="c605" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是我们需要添加的所有内容，以便在我们的应用中支持任何<code class="fe lr ls lt lu b">UIViewController</code>的预览。让我们测试一下我们创造了什么。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h2 id="a9d0" class="ms mt iq bd mu mv mw dn mx my mz dp na le nb nc nd li ne nf ng lm nh ni nj nk bi translated"><strong class="ak">用法举例</strong></h2><p id="3ffd" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">让我们创建一个简单的ViewController <code class="fe lr ls lt lu b">HomeViewController.swift</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="fc08" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个<code class="fe lr ls lt lu b">HomeViewController.swift</code>上，我们有一个可选的<code class="fe lr ls lt lu b">HomeView</code>，让我们使用视图代码创建一个简单的<code class="fe lr ls lt lu b">UIView</code>，它有3个标签和1个按钮，例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="eca0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的例子中，我们在文件<code class="fe lr ls lt lu b">HomeView.swift</code>中隔离了与屏幕视图相关的内容。</p><p id="bb51" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好吧，但是我们的<code class="fe lr ls lt lu b">PreviewProvider</code>呢？</p><p id="f22f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为SwiftUI的默认设置，我们可以将其添加到视图文件的末尾。让我们在<code class="fe lr ls lt lu b">HomeView.swift</code>的末尾加上:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lv lw l"/></div></figure><ol class=""><li id="6d49" class="lx ly iq kx b ky kz lb lc le lz li ma lm mb lq mc md me mf bi translated">只有当可以导入SwiftUI并且处于调试模式时，Xcode才会构建这个代码块，这与我们在<code class="fe lr ls lt lu b">UIViewController</code>扩展中包含的原因相同。(可选)</li><li id="4ef4" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq mc md me mf bi translated">我们提供了从一个<code class="fe lr ls lt lu b">UINavigationController</code>经过我们的<code class="fe lr ls lt lu b">ViewController</code>成为一个<code class="fe lr ls lt lu b">rootViewController</code>的扩展的预览。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/2e773dc9d2ca8f819ff88972bf980362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0YmongoYAKBUTmcbRm_Iw.png"/></div></div></figure><p id="a26e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后<em class="nr">瞧！</em></p><h2 id="cd7e" class="ms mt iq bd mu mv mw dn mx my mz dp na le nb nc nd li ne nf ng lm nh ni nj nk bi translated">一些重要的事情/提示…</h2><ul class=""><li id="5658" class="lx ly iq kx b ky nl lb nm le ns li nt lm nu lq nv md me mf bi translated">结构预览的名称应该有一个“Preview”后缀，例如:<code class="fe lr ls lt lu b">ViewControllerPreview</code>、<code class="fe lr ls lt lu b">HomeViewControllerPreview</code>、<code class="fe lr ls lt lu b">SomeViewPreview</code>。否则，您将会遇到一个构建错误=/。</li><li id="2b52" class="lx ly iq kx b ky mg lb mh le mi li mj lm mk lq nv md me mf bi translated">如果预览画布不存在，您可以使用快捷键<code class="fe lr ls lt lu b">⌘+Option + Return</code>或手动操作。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/8d1c36d8f1bb8160727acd30e5e305a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DijtTjNRaUcaloXp7Jt13g.gif"/></div></div></figure><ul class=""><li id="5038" class="lx ly iq kx b ky kz lb lc le lz li ma lm mb lq nv md me mf bi translated">要继续预览，您也可以使用快捷键<code class="fe lr ls lt lu b">⌘+Option+P</code>。</li></ul><p id="376f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好了，我们学习了如何为我们的<code class="fe lr ls lt lu b">ViewControllers</code>实现预览，但是我超级懒，我不想在我将要创建的每一个<code class="fe lr ls lt lu b">ViewController</code>上手工添加所有的代码，所以让我们创建一个<em class="nr">代码片段</em>！</p><p id="c020" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要创建一个新的代码片段，您可以在文件内的任何地方右击，然后点击“创建代码片段”<em class="nr">。</em>然后你要给你的代码片段起一个名字，添加将在自动完成时填充的代码块，然后添加这个代码块，并添加你的标记用于自动完成，我在这个例子中使用了<code class="fe lr ls lt lu b">SwiftUIPreview</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="574e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它是这样工作的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/0aa811ab519e902066c5416c0c398f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PyUxbFQ34o_9Z3MA5CWy6g.gif"/></div></div></figure><p id="60ac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要了解更多关于代码片段以及如何实现它们，你可以阅读这篇文章。</p><h1 id="406e" class="nz mt iq bd mu oa ob oc mx od oe of na jw og jx nd jz oh ka ng kc oi kd nj oj bi translated">资源</h1><p id="e2de" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">示例项目的源代码可以在<a class="ae ny" href="https://github.com/kleytonandroid/SwiftUIPreviewOnUiKit" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p></div></div>    
</body>
</html>