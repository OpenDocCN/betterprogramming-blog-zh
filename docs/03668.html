<html>
<head>
<title>What is OptionSet in Swift and When You Should Use It?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的OptionSet是什么，您应该何时使用它？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-optionset-in-swift-and-when-you-should-use-it-419777f3c39?source=collection_archive---------12-----------------------#2020-02-25">https://betterprogramming.pub/what-is-optionset-in-swift-and-when-you-should-use-it-419777f3c39?source=collection_archive---------12-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1ea7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过实际的列举比较</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f999fe086a9ca197d049585ad426fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aShMt3xCFNOCKXCX"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丘特尔斯纳普</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="2432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个简短的教程中，我们将了解Swift中的<code class="fe lv lw lx ly b">OptionSet</code>是什么，以及何时我们可能希望在我们的iOS应用中使用它。</p><p id="20d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe lv lw lx ly b">OptionSet</code>来表示一组相关成员(或选项)，并以类型安全的方式工作。它的概念类似于<code class="fe lv lw lx ly b">enum</code>，但是它有一些非常有用的特性，这些特性在简单的枚举中是不可用的。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="197e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">我们开始吧</h1><p id="5264" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">假设我们正在开发一个项目管理工具，并且希望有不同重要性和难度的任务。做到这一点的标准方法是使用枚举:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d8e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了实例化一个<code class="fe lv lw lx ly b">TaskType</code>，我们编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a114" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果我们想让我们的<code class="fe lv lw lx ly b">Item</code>既<em class="nf">不急</em>又<em class="nf">轻松</em>呢？我们必须使<code class="fe lv lw lx ly b">taskType</code>属性成为一个数组，并将其签名改为<code class="fe lv lw lx ly b">taskTypes</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b07b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了检查该项目是否既不紧急又简单，我们编写了这个相对较长的<code class="fe lv lw lx ly b">if</code>语句:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d4b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还希望<code class="fe lv lw lx ly b">taskTypes</code>数组只包含唯一的成员(不允许有两个<code class="fe lv lw lx ly b">.notUrgent</code>)。所以我们把这个数组转换成一个<code class="fe lv lw lx ly b">Set</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c5a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这么简单的事情，步骤太多了？所以我们有了更好的选择— <code class="fe lv lw lx ly b">OptionSet</code>。</p><h1 id="ab60" class="mg mh it bd mi mj ng ml mm mn nh mp mq jz ni ka ms kc nj kd mu kf nk kg mw mx bi translated">选项集实现</h1><p id="43ca" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们执行上面的任务，但是用<code class="fe lv lw lx ly b">OptionSet</code>代替<code class="fe lv lw lx ly b">enum</code>。首先，我们应该创建<code class="fe lv lw lx ly b">TaskTypes</code>结构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="442c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们符合<code class="fe lv lw lx ly b">OptionSet</code>协议时，要求我们为该结构提供一个<code class="fe lv lw lx ly b">rawValue</code>。根据<a class="ae ky" href="https://developer.apple.com/documentation/swift/optionset" rel="noopener ugc nofollow" target="_blank">苹果的文档</a>，我们可以使用符合<code class="fe lv lw lx ly b">FixedWidthInteger</code>的类型，比如<code class="fe lv lw lx ly b">Int</code>，或者<code class="fe lv lw lx ly b">UInt8</code>。</p><p id="ec17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们查看<code class="fe lv lw lx ly b">urgent</code>属性，我们会看到下面的模式:<code class="fe lv lw lx ly b">1 &lt;&lt; 0</code>。左边的值表示一个整数乘以右边值的2的幂。为了澄清，1应该以零的幂乘以2:1 *2⁰= 1。</p><p id="2d34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相应地，<code class="fe lv lw lx ly b">notUrgent</code>的<code class="fe lv lw lx ly b">rawValue</code>就是<code class="fe lv lw lx ly b">1 &lt;&lt; 1</code>。所以1乘以2的1次方:1 * 2 = 2。由于这种位运算，集合中的每个成员都有一个唯一的值。</p><p id="6b7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">清楚了这一点，让我们进入下一部分——实例化和使用创建的<code class="fe lv lw lx ly b">OptionSet</code>。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4e2b" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">使用选项集</h1><p id="56ca" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们定义一个<code class="fe lv lw lx ly b">Item</code>并实例化它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7428" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码现在更简洁了，但是通过<code class="fe lv lw lx ly b">OptionSet</code>我们获得了一些其他的好处:</p><ul class=""><li id="848e" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">我们现在可以执行与集合相关的操作，如<code class="fe lv lw lx ly b">intersection</code>:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><ul class=""><li id="bcfc" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">或者<code class="fe lv lw lx ly b">union</code>:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1da3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码打印9的值，因为<code class="fe lv lw lx ly b">.urgent</code>对应于1，而<code class="fe lv lw lx ly b">.hard</code>对应于8。它们的和是9，这是唯一的，只有在与<code class="fe lv lw lx ly b">.urgent</code>和<code class="fe lv lw lx ly b">.hard</code>进行union时<em class="nf">才能得到。</em></p><ul class=""><li id="43cc" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">和许多其他方便的操作:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/54b1e17872ad8559429d6e6172c1c1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8b2UpSDE5pwJlR_uNx38w.png"/></div></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="2967" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">包扎</h1><p id="6461" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">要了解关于<code class="fe lv lw lx ly b">OptionSet</code>的更多信息，请参考Apple官方文档:</p><div class="nv nw gp gr nx ny"><a href="https://developer.apple.com/documentation/swift/optionset" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">选项集</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">声明使用协议来表示位集类型，其中各个位表示一个集合的成员。采用…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">developer.apple.com</p></div></div></div></a></div><p id="8880" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读！</p></div></div>    
</body>
</html>