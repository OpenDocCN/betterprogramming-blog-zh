<html>
<head>
<title>The Smaller, the Better: Reducing Android App Size</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">越小越好:减少Android应用程序的大小</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-smaller-the-better-reducing-android-app-size-3b063a40ded7?source=collection_archive---------4-----------------------#2020-09-27">https://betterprogramming.pub/the-smaller-the-better-reducing-android-app-size-3b063a40ded7?source=collection_archive---------4-----------------------#2020-09-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="09e9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">较小的APK大小可以带来更多的用户和更好的首次用户体验</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f6879f3e8a0ac9f27b00143c73fbf9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83_mVFj6zTYq6oN9BkSv8Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/photos/small-size?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@amir_v_ali?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> amirali mirhashemian </a>拍摄的照片</p></figure><p id="cb7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你下载过多少次大型应用程序？很少，对吧？那么，如果你的应用耗费了用户这么多的数据、时间、电池和空间，你怎么能指望他们下载你的应用呢？</p><p id="ad08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当人们去Play Store下载应用程序时，应用程序的大小是他们考虑的一个重要因素。应用程序越小越好。</p><p id="132d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">繁重的应用程序在下载时会占用大量的数据、更多的下载时间和大量的设备空间。它减少了你的应用程序达到更合理大小的机会。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/19d86528430fdf359358ca3a8d378f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*EvLch6aKfo3C9cP4dT7RJA.jpeg"/></div></figure><p id="5ea6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种景象并不好看，如果你的应用程序需要额外的空间，那么很少有用户会去设置和删除媒体文件来下载你的应用程序。在另一种情况下，如果他们想下载其他应用程序并看到这个，他们可能会删除占用大量空间的应用程序，即您的大尺寸应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/7fb332ebd2e8c13d4857790e29d7d575.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*xUzRV7uKtbo2e0oZjRwK8A.png"/></div></figure><p id="52bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你认为人们在看到这个之后会继续前进吗？我不这么认为。不管你的应用程序有多神奇，除非人们下载并使用它，否则它没有多大作用。看到带有大文件警告的弹出窗口会降低应用程序被下载的几率。</p><p id="73e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Android设备的存储、电池和互联网都受到限制。人们不希望在一个应用程序上花费太多。如果你想为<a class="ae kv" href="https://developer.android.com/distribute/best-practices/develop/build-for-the-next-billion" rel="noopener ugc nofollow" target="_blank">下一个十亿用户</a>开发应用，这是第一个最佳实践:为入门级设备优化应用。</p><p id="e7a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还不信服？阅读文章"<a class="ae kv" href="https://medium.com/googleplaydev/shrinking-apks-growing-installs-5d3fcba23ce2" rel="noopener">缩减apk，增加安装量</a>"对于100MB以下的应用，APK大小与安装转化率之间存在负相关关系。</p><p id="1831" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们总能找到一些方法来减小应用程序的大小。一个应用程序包含的东西比它实际需要或做的要多。作为开发人员，我们肯定可以实现一些步骤，向用户交付一个小型的应用程序，其中只包含所需的资源和文件。</p><p id="c6cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将分享我减小应用程序大小的经验，以及帮助我实现这一目标的资源和工具。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="1673" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">应用捆绑包</h1><p id="95cf" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">如果你还没有探索过Android应用捆绑包，那么现在就去探索吧。应用捆绑是在Play Store上发布应用的另一种格式。</p><p id="f883" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们分析一下是什么增加了应用程序的规模:</p><ul class=""><li id="ada6" class="my mz iq ky b kz la lc ld lf na lj nb ln nc lr nd ne nf ng bi translated">它包含所有语言的资源，甚至当用户只想使用Odia中的应用程序时也是如此。为其他语言添加的字符串对用户来说是无用的，并且是对他们设备上的应用程序的不必要的添加。</li><li id="befb" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">它包含每种屏幕密度的资源，即使用户的设备不需要它们。</li><li id="c078" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">应用程序中有一些功能不是每个人都要使用的，它们有时会增加很多大小。</li></ul><p id="84f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用应用捆绑包，我们可以拥有按需功能。这意味着，如果有一些重负载特性，而它对一些用户没有用，它不会被添加到他们的应用程序下载中。如果有人需要，可以选择按需下载。例如，不会将所有屏幕密度资源下载到设备上，只会下载用户需要的资源。语言也是如此。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="8dc6" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">安卓尺寸分析仪</h1><p id="5678" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我们可以使用一个插件来分析这个应用程序:Android Size Analyzer。这可以帮助我们找到减小应用程序大小的方法。</p><p id="7114" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有安装，可以在Android Studio本身找到。遵循以下步骤-</p><ol class=""><li id="6f1b" class="my mz iq ky b kz la lc ld lf na lj nb ln nc lr nm ne nf ng bi translated">Android Studio -&gt;首选项</li><li id="5bf5" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nm ne nf ng bi translated">转到插件，然后转到市场。</li><li id="158a" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nm ne nf ng bi translated">搜索“安卓尺寸分析仪”安装它。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/f638e5483fb38840fdc7bbe87e180910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSET1LD-IXoYYSwoN8cfUA.png"/></div></div></figure><p id="642c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要运行analyzer，请转到分析-&gt;分析应用程序大小。它会打开一个窗口，提供减小应用程序大小的建议。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/828f484b283aa78f8a147aadf88afb68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVi9Cy3HHIJubm7AWWBDFg.png"/></div></div></figure><h2 id="6e36" class="np mc iq bd md nq nr dn mh ns nt dp ml lf nu nv mn lj nw nx mp ln ny nz mr oa bi translated">对图像使用WebP文件格式</h2><p id="e464" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">正如我们看到的，第一个建议是关于图像的。这个项目中使用了一些PNG或JPEG文件格式的图像。使用WebP格式，我们可以进行有损压缩以及透明压缩，压缩效果比JPEG和PNG更好。转换到WebP是一个简单的步骤。分析者指出问题并提出解决方案。单击分析器中的图像，您可以看到将图像转换为WebP文件格式的选项。</p><h2 id="abcb" class="np mc iq bd md nq nr dn mh ns nt dp ml lf nu nv mn lj nw nx mp ln ny nz mr oa bi translated">删除未使用的资源</h2><p id="12f5" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">我们添加到项目中的每一个资源都会增加应用程序的大小，不管项目是否使用它。要识别和移除资源，Android Studio中有一个选项。</p><p id="bd0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到折射-&gt;删除未使用的资源。这将检查应用程序中没有使用的资源并删除它们。</p><p id="50a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我发现还有一个工具对代码检查非常有帮助。它在应用程序基本代码lint中查找错误和警告。</p><h2 id="1b95" class="np mc iq bd md nq nr dn mh ns nt dp ml lf nu nv mn lj nw nx mp ln ny nz mr oa bi translated">线头</h2><p id="3a98" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">要使用此功能，请进入<strong class="ky ir"> <em class="ob"> </em> </strong>分析- &gt;检查代码。这指向项目中没有使用的代码。<a class="ae kv" href="https://developer.android.com/studio/write/lint" rel="noopener ugc nofollow" target="_blank"> Lint </a>帮助我们识别代码的结构质量，而无需执行代码或编写测试用例。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="5133" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">R8收缩</h1><p id="8d6c" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">通过使用lint并移除未使用的资源，您可以移除已经添加的资源并减小大小。您添加的库附带的文件和资源呢？您总是需要库附带的所有代码吗？不完全是。我们在Gradle中添加的库提供了很多功能。有时，我们的应用程序只需要库的一小部分。我们可以通过启用<code class="fe oc od oe of b">minifyEnabled</code>和<code class="fe oc od oe of b">shrinkResources</code>来移除未使用的代码和资源。在运行时，这可以检查对你的应用程序有用的部分，只保留它们并删除其他部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="b5b2" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">resConfigs</h1><p id="c717" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated"><code class="fe oc od oe of b">shrinkResources</code>只会缩减应用程序不需要的资源。它不会删除本地化中使用的资源。例如，您的应用程序目前支持三种语言。但是我们在项目中添加的库可能支持很多语言。在app级别的<code class="fe oc od oe of b">build.gradle</code>中添加以下内容，可以移除其他语言的资源。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="5e67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除此之外，尽可能重用代码和资源。不要重复编写同一段代码。它有助于更快地进行更改，并有助于减少应用程序的大小。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="f3fc" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">摘要</h1><ul class=""><li id="1e98" class="my mz iq ky b kz mt lc mu lf oi lj oj ln ok lr nd ne nf ng bi translated">如果您还没有开始使用App Bundle发布应用程序，那么现在就开始吧。</li><li id="a203" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">使用Android Size Analyzer获得减少应用程序大小的建议，并使用lint进行代码检查。</li><li id="1348" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">对图像使用WebP文件格式，而不是PNG或JPEG。</li><li id="5511" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">如果某些代码或资源是不需要的，就将其删除。</li><li id="d07f" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">使用R8收缩。</li><li id="a970" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">尽可能重用代码和资源。</li></ul><p id="71d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有其他一些很好的资源解释了减少应用程序大小的方法。请查阅参考资料。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="8988" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">参考</h1><ul class=""><li id="eea6" class="my mz iq ky b kz mt lc mu lf oi lj oj ln ok lr nd ne nf ng bi translated"><a class="ae kv" href="https://medium.com/pixplicity/size-matters-how-your-app-size-is-costing-you-customers-6121d6db74e" rel="noopener">大小很重要:你的应用大小如何影响你的客户</a></li><li id="0573" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://developer.android.com/topic/performance/reduce-apk-size" rel="noopener ugc nofollow" target="_blank">缩小你的应用尺寸</a></li><li id="9329" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://dev.to/amitspaceo/how-to-reduce-android-app-size-android-tutorial-578i" rel="noopener ugc nofollow" target="_blank">如何缩小你的app尺寸？</a></li><li id="415b" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://blog.mindorks.com/how-to-reduce-apk-size-in-android-2f3713d2d662" rel="noopener ugc nofollow" target="_blank">缩小APK尺寸</a></li><li id="4225" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://developer.android.com/guide/app-bundle" rel="noopener ugc nofollow" target="_blank">阅读更多关于应用捆绑包的信息</a></li><li id="cde9" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://developer.android.com/studio/write/lint" rel="noopener ugc nofollow" target="_blank">阅读更多关于lint的信息</a></li><li id="2c91" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated"><a class="ae kv" href="https://developer.android.com/studio/build/shrink-code" rel="noopener ugc nofollow" target="_blank">阅读更多关于R8萎缩的信息</a></li></ul><p id="479f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>