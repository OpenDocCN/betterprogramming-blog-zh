<html>
<head>
<title>The Path of Getting Comfortable in Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在生产中获得舒适的途径</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-path-of-getting-comfortable-in-production-c88456146f00?source=collection_archive---------12-----------------------#2022-01-24">https://betterprogramming.pub/the-path-of-getting-comfortable-in-production-c88456146f00?source=collection_archive---------12-----------------------#2022-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5712" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我的舒适生产之路</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c97d83be0f7bd05d452c4c93cf8b587b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zwaUbXPiZ_hy1Pg1"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源<a class="ae kv" href="https://unsplash.com/photos/feXpdV001o4" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/feXpdV001o4</a>阿纳斯·阿尔尚提</p></figure><p id="e6b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4年前，我是一个相当不错的程序员，我已经做了6年的桌面开发，我甚至管理过一个小团队，但是我从来没有机会使用具有短交付周期的高可用性分布式系统。</p><p id="4b6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4年前，我做出了转变，全力以赴为一家SAAS公司工作，从我的舒适区转向新技术。就在那时，我知道了所谓的“生产”这个东西，即在IDE中最后一次击键后会发生什么，以及在我的代码被运送到“云”后会发生什么，这在当时对我来说是未知的。</p><p id="3778" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回顾过去，我可以自信地说，在生产中变得舒适是一个需要时间的旅程，需要与编码完全不同的技能，以及大量的协作工作。</p><p id="628f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，如果您是一名从未收到过产品警告的开发人员，或者不完全理解CI完成其部分后会发生什么——这篇文章正是为您准备的！我不会详细解释所有这些，但是，我会描述我走过的路，并希望在这个旅程中激励和使它更容易。</p><h1 id="8917" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤1 —在你的运营/SRE团队中结交一些朋友</h1><p id="da13" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你将会不明白很多事情，你有时会迷失方向！你需要“内部人员”来交谈。</p><p id="0c5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于许多过程、工具和实践将是公司内部的和特定的——谷歌搜索只能让你走到这一步——你需要一个导师。</p><h1 id="a3c0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第二步——重新审视你对完成(DOD)的定义</h1><p id="b060" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一个可工作的特性是好的，一个经过测试的特性更好，一个自动测试的特性是惊人的。但是，您还没有完成——但是，随着时间的推移，您如何断言您的特性在生产中起作用呢？从现在起6个月内，您如何调查该功能的故障？你如何断言总体生产稳定性保持不变？</p><p id="b69f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要改变您的思维状态——软件稳定性随着时间的推移而发展和变化，因此您的工作只有在涵盖了以上所有内容的情况下才算完成。这包括:</p><ol class=""><li id="6540" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">监控——您的特性的行为受到监控，并且不会影响系统的整体行为(T2 4黄金指标是一个很好的起点)。</li><li id="9ee9" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">日志——确保您有相关的日志来追溯系统中发生的事情，尤其是当出现问题时。确保在某个系统中有可用的异常和堆栈跟踪。<br/>您可以从详细记录功能启动开始，并随着时间的推移减少和完善它们。</li><li id="fd69" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">你的<a class="ae kv" href="https://opentelemetry.io/docs/reference/specification/trace/api/#span" rel="noopener ugc nofollow" target="_blank">跨度</a>和<a class="ae kv" href="https://opentelemetry.io/docs/reference/specification/trace/api/#tracer" rel="noopener ugc nofollow" target="_blank">轨迹</a>是否被正确标记和标注以覆盖所有感兴趣的流？</li></ol><p id="ddb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后——理解积极监控和消极监控的区别，确保你积极监控你的特性变化。</p><ul class=""><li id="ce77" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr nd mv mw mx bi translated">积极的监控意味着你积极地断言你的特性工作正常。</li><li id="44ad" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr nd mv mw mx bi translated">消极监控(通常)意味着你被动地监控没有任何事情被破坏。</li></ul><h1 id="7204" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第3步——了解你的基础设施</h1><p id="efd5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你必须理解什么将代码投入生产，它是如何被构建的，以及它是如何被部署的——这些和理解你的代码一样重要，因为它们会引起问题，或者解决问题，一样容易。</p><p id="a807" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">能够理解和控制这一过程可以赋予超能力——你可以创建自定义图像——与环境互动，甚至创建自己的图像！</p><p id="2243" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">了解您的构建和CI流程——理想情况下——为其添加一些功能，确保您可以在机会出现时对其进行更改。学习并熟悉展示和恢复流程。</p><p id="6d5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">了解您的生产布局——您的实例在哪里，它们的运行时间是什么，它们是如何配置和连接到世界的，新软件是如何交付给它们的，您如何从/向它们获取或转移流量。</p><h1 id="f255" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第4步—监控，监控，监控</h1><p id="fb5a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我过去常常在每个工作日开始时检查我领域内系统的3到4个主控制面板。我开始了解交通模式——了解“正常”是什么样子(请看<a class="ae kv" href="https://youtu.be/Q4nniyAarbs?t=1775" rel="noopener ugc nofollow" target="_blank">这篇演讲</a>，它创造了术语<em class="ne">“直觉工程”</em>)。</p><p id="1692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，什么是“正常”呢？我在看什么？</p><p id="38b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">显而易见的指标是延迟、吞吐量、错误率(是的，一些系统将错误视为“正常状态”)，但我更深入地分析了常见的CPU利用率模式、网络、内存、延迟分布、客户流量分布。您可以在一天中的任何时间向我发送ping命令，我会非常有把握地告诉您我们系统的吞吐量是多少，谁是产生大部分数据量的客户，以及设备群中的副本数量。知道了“正常”——我就能发现“异常”。</p><p id="4974" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在某种程度上，这种不断的监控和对度量、日志和可观察性工具的实验将使您能够使用不同的工具和角度监控任何东西，使您变得独立——我已经艰难地认识到，可观察性工具也可能在停机期间失败，能够监控具有一定冗余水平的系统是一种天赋。</p><p id="1e42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，调查异常情况，即使没有引起任何警报或明显的影响。你会从他们身上学到很多东西！您可能会了解到您的一些客户遇到了流量高峰，或者您的系统在一天中的某些时候会经历清理周期(例如<a class="ae kv" href="https://www.postgresql.org/docs/9.1/sql-vacuum.html" rel="noopener ugc nofollow" target="_blank">postgres vacuum</a>或GCs)。</p><p id="c267" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一个有趣的案例中，我通过调查一个异常的流量模式，了解到我们有一个与客户不良集成的案例。系统变得更好。</p><h1 id="a936" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第五步——从你的词汇中删除“不是我的责任”</h1><p id="4841" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要真正了解和感受这个系统，你不能只局限于你的领域下的4-5个服务或组件。你也需要了解其他系统是如何工作的，是什么让它们运转。</p><p id="502e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不一定要对每一个比特和字节都有360度的深刻理解，但对事物的大致规划可以非常有见地。</p><p id="207a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在你已经对生产进行了足够的监控(第4步)之后——“深入”其他系统，此外——理解其他系统的问题就容易多了。即使您不熟悉数据库或服务，也可以通过查看日志来理解数据库何时返回错误，并且您已经是如何挖掘这些错误日志的专家了。</p><p id="b1e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不管什么服务，HTTP错误代码都是一样的。也许你不会完全理解根本原因或影响——但是你完全有能力理解发生了什么，什么失败了。</p><p id="f0ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望大多数系统足够稳定，所以其他服务只是另一个学习机会，此外，了解更多的系统会让您更有信心和能力评估业务影响(等待第7步)。</p><h1 id="3c05" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">步骤6 —收集事件—调查每一个事件</h1><p id="e6a0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">跳上作战室，坐在后面。只是看和听。学习，感受刺激(或恐怖)。</p><p id="3203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经历或参加验尸。了解发生了什么——了解什么是受影响的sli，以及如何监控它们。这些sli后来转化为业务影响！</p><p id="e636" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你会从那里学到很多东西，看到工程师是如何工作的。每一个这样的事件都会嵌入到你的职业自我中，下一次它(或类似的事情)发生时(它会发生)，你会从所有其他事件中获得更多的背景信息，并有所领先。</p><p id="d438" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将理解影响(对业务的影响)、症状(对系统的影响)和根本原因(导致崩溃的原因)之间的区别。</p><p id="93f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终，你会对生产事件感到舒适——这是工作的一部分，就像进行代码评审或谈论你的设计一样。</p><h1 id="36e4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第七步——了解业务</h1><p id="e48f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你的普通销售工程师不明白“我们在ElasticSearch上有延迟问题”对他们的客户意味着什么！在系统的技术实现和它为最终消费者产生的价值之间有一个领域障碍。</p><p id="c9f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一名工程师，你必须了解你的组件的底线价值，并能够从最终用户的角度解释系统中任何问题的影响。</p><p id="cfb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几年前，当我们还是一家小型创业公司时，在一次著名的事件中，一名随叫随到的工程师向公司报告说“有积压的工作”——他显然不知道这些工作是什么。这引发了太多的问题，也造成了太多不必要的恐慌。</p><h1 id="d87b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第八步——你一次寻求指导，下一次自己去做</h1><p id="b716" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">尽可能独立，学会在你的权限和角色范围内做任何事情:</p><ul class=""><li id="8c25" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr nd mv mw mx bi translated">需要改变你的形象吗？太神奇了！寻求指导，然后确保你能独立重做。</li><li id="bc0b" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr nd mv mw mx bi translated">需要对某个实例使用ssh / kubectl来检查一些东西吗？太神奇了！坐在你最喜欢的同事旁边，写下他们在做什么，然后确保你可以独立地重做。</li><li id="d297" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr nd mv mw mx bi translated">需要在普罗米修斯中创建一些复杂的度量标准或在基巴纳创建一个仪表板吗？太神奇了！牵着你的一个观察专家的手，学习他们是如何做的，他们关注的是什么，然后确保你可以独立地重复这些。</li><li id="dbc3" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr nd mv mw mx bi translated">需要在生产中调试复杂的东西吗？太神奇了！和你的团队领导坐下来，记下应该如何实现这个目标，然后独立完成。</li></ul><p id="72de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你能够自己做所有这些事情后，你可以开始在团队中承担更多的责任，并更快地交付价值。此外，您将开始理解DevOps领域和术语，并且能够更好地与运营团队沟通。</p><h1 id="133c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">回顾的</h1><p id="d744" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你看，这是我走过的路。这是一个密集的旅程，涉及几十个服务、许多同事、几个导师和偶尔的中断。聚集的技能是无价的，可能性是无穷的。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="bb59" class="nk lt iq ng b gy nl nm l nn no"><strong class="ng ir">Want to Connect?</strong></span><span id="ff56" class="nk lt iq ng b gy np nm l nn no">Hope you enjoyed this, and feel free to reach out with anything on Twitter <a class="ae kv" href="https://twitter.com/cherkaskyb" rel="noopener ugc nofollow" target="_blank">@cherkaskyb</a></span></pre></div></div>    
</body>
</html>