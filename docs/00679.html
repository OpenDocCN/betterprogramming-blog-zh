<html>
<head>
<title>Let’s Learn React Hooks and Context API by Building a Recipe Search App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们通过构建一个食谱搜索应用程序来学习React钩子和上下文API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lets-learn-react-hooks-and-context-api-by-building-a-recipe-search-app-63be9d9e1801?source=collection_archive---------3-----------------------#2019-06-29">https://betterprogramming.pub/lets-learn-react-hooks-and-context-api-by-building-a-recipe-search-app-63be9d9e1801?source=collection_archive---------3-----------------------#2019-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7cfc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">制作一个美味的食谱搜索应用程序所需的一切</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/66ea292bf6e84040ff0c25e8fd49ff40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*bCr9TeAoPaIT5L5VheAvGQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><a class="ae ku" href="https://www.freecodecamp.org/news/an-introduction-to-react-hooks-12843fcd2fd9/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><blockquote class="kv kw kx"><p id="72e7" class="ky kz la lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二部分是直播</strong> <a class="ae ku" href="https://medium.com/better-programming/lets-learn-react-hooks-and-context-api-by-building-a-recipe-search-app-2eb0b2d2cb85" rel="noopener"> <strong class="lb iu">这里是</strong> </a></p></blockquote><h1 id="5521" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">概观</h1><p id="0545" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">这是一个理解<a class="ae ku" href="https://reactjs.org/docs/hooks-overview.html#state-hook" rel="noopener ugc nofollow" target="_blank"> React钩子</a> <strong class="lb iu"> </strong>和上下文API的初学者教程。实际上，这更多的是试图向我自己和感兴趣的读者解释这些概念。</p><p id="dd1d" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">这将分为两部分，第一部分集中在钩子的基础上。另一部分将关注更高级的用例以及上下文API。我们将实现搜索功能，并转换为使用上下文API来管理状态和避免道具钻取。</p><h2 id="8de6" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated">我们将如何学习？</h2><p id="9ef0" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">我们将看看用类组件和用React钩子处理相同状态逻辑的区别。我们将构建一个食谱搜索应用程序来巩固这些概念——然后我们将有一瓶红酒来庆祝！我相信弄乱代码是最好的学习方式。</p><h2 id="88ff" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated"><strong class="ak">我们将构建的最终版本</strong></h2><p id="c7c8" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">我们将构建一个简单的<a class="ae ku" href="https://www.food2fork.com/" rel="noopener ugc nofollow" target="_blank"> Food2Fork网站</a>的克隆。这不会是一个完全成熟的版本，但我们将使用他们的API和前30名食谱。我们将添加一些我们自己的UI逻辑来扰乱状态，看看我们如何用钩子处理它们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/1504130b9a204b71cbd64780698f3974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*HkHkDUKYzu4QN-meFsJHOQ.gif"/></div></figure><h2 id="d5ca" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated"><strong class="ak">先决条件</strong></h2><ul class=""><li id="7b2a" class="ni nj it lb b lc mn lf mo mp nk mr nl mt nm lu nn no np nq bi translated">React的基础知识</li><li id="e19f" class="ni nj it lb b lc nr lf ns mp nt mr nu mt nv lu nn no np nq bi translated">JavaScript ES6基础知识(数组方法、析构等)。)</li></ul></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="0878" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated"><strong class="ak">什么是React Hook？</strong></h1><p id="a484" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">首先:什么是React Hook？来自<a class="ae ku" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank">文档</a>:</p><blockquote class="oi"><p id="b272" class="oj ok it bd ol om on oo op oq or lu dk translated"><strong class="ak">什么是挂钩？</strong>挂钩是一个特殊的功能，可以让你“挂钩”到React特性中。例如，useState是一个钩子，它允许您向函数组件添加React状态。</p></blockquote><p id="d2c2" class="pw-post-body-paragraph ky kz it lb b lc os ju le lf ot jx lh mp ou lk ll mr ov lo lp mt ow ls lt lu im bi translated">简单地说，钩子允许我们“挂钩”到特定的React特性。例如<code class="fe ox oy oz pa b">useState</code>，顾名思义，帮助我们在React中使用状态特性，否则我们将无法使用它，例如在函数组件内部。我们会详细解释一下语法用法等。，通过构建食谱搜索应用程序。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="f8a3" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated"><strong class="ak">设置</strong></h1><p id="06a6" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">我们将使用<code class="fe ox oy oz pa b">create-react-app</code>来引导应用程序。我已经创建了一个基本的回购协议，我们可以很快开始。简单地克隆跟随。运行下面的命令:</p><p id="161b" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">git clone<a class="ae ku" href="https://github.com/olajohn-ajiboye/Blog-React-Hook-Tutorial.git" rel="noopener ugc nofollow" target="_blank">https://github . com/OLA John-aji boye/Blog-React-Hook-Tutorial . git</a><br/>CD Blog-React-Hook-Tutorial</p><p id="f817" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">让我们回到我们将要构建的应用程序。我们将使用<a class="ae ku" href="https://www.food2fork.com/about/api" rel="noopener ugc nofollow" target="_blank"> Food2Fork API </a>来获取和搜索30个顶级食谱的列表。然而，API对我们每天可以进行的查询有一个限制。在本教程中，我已经根据它们创建了确切的JSON响应。这将从<a class="ae ku" href="https://api.myjson.com/bins/t7szj" rel="noopener ugc nofollow" target="_blank">这里</a>提供，这样我们就不会太频繁地访问他们的服务器。</p><p id="a4e6" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">让我们在<code class="fe ox oy oz pa b">src</code>文件夹中创建一个组件文件夹来存放我们的应用程序可能会有的不同组件。花点时间想一想。将会有一个显示每个<code class="fe ox oy oz pa b">Recipe</code>的组件，一个呈现食谱列表的<code class="fe ox oy oz pa b">RecipeList</code>组件，<code class="fe ox oy oz pa b">RecipeSearch</code>组件，以及一个显示每个食谱附加细节的<code class="fe ox oy oz pa b">RecipeDetails</code> <strong class="lb iu"> <em class="la"> </em> </strong>组件。所有的组件都是功能组件，因为使用钩子是本教程的重点。</p><p id="3816" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">如果你做的一切都是正确的，你应该有一个像下面这样的文件夹结构。您还可以克隆repo中的第二个分支，以跳转到教程中的这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/1ef8bb272d44cc13041e705d44db7447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*O8ENqBnyY6jahz2GrTZ1qw.png"/></div></figure><p id="1ccd" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">如果你还没有，我推荐安装的一个扩展是ES7 <code class="fe ox oy oz pa b">React/Redux/GraphQL/React-Native</code> snippets。它通过允许您键入缩写来获得一些React片段，从而加快了React的开发。你可以在这里找到更多的。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="4573" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated"><strong class="ak">让我们上钩吧</strong></h1><p id="e563" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">为什么还要钩子？</p><p id="7afd" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">在任何前端应用程序中，您最常做的事情之一就是获取和显示数据，并基于UI操纵应用程序的状态以获得更好的UX。React也没什么不同。state <strong class="lb iu"> </strong>的一个常见用例是存储来自API调用的数据。在Hooks之前，如果你需要在你的应用程序中有一个任何类型的状态，你绝对必须使用一个类组件。您还需要在componentDidMount生命周期内异步获取数据。对于许多人来说，这不是一个很大的问题，但是React团队认为它引起了组件逻辑的紧密耦合。此外，在更复杂的应用程序中，很难重用有状态逻辑。</p><p id="a23c" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">不要相信我的话，只需在这里阅读钩子的动机<a class="ae ku" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="d213" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated">类别与挂钩</h1><p id="1998" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">让我们先看看如何从我在一个经典组件中创建的REST API中获取数据，然后再讨论如何用钩子处理它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="892d" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">让我们看一下带有钩子和效果的相同代码，后面是解释。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="a615" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">有几件事是显而易见的。我们已经从React导入了<code class="fe ox oy oz pa b">useState</code>和<code class="fe ox oy oz pa b">useEffect</code>。这些是暴露给我们的API，使我们能够使用React Hook。<code class="fe ox oy oz pa b">useState</code>钩子接受初始状态。在上面的例子中，我们已经将它初始化为一个空数组。我们希望用来自API调用的数据填充数组。这相当于我们的类组件中的below。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/8a69fb81bb979b72c1e8855e9c5c5ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*j-HUqNKl8whK9igMJWv12g.png"/></div></figure><p id="8924" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">此外，<code class="fe ox oy oz pa b">useState</code>向我们返回一对值。它们是当前状态和更新它的函数。所以我们从使用状态中取回<em class="la"> </em> <code class="fe ox oy oz pa b">[currentState, setStateFunction]</code>。这就是为什么我们在应用程序中写了<code class="fe ox oy oz pa b">const [recipes, setRecipes] = useState([])</code> <em class="la"> </em>。其中,<code class="fe ox oy oz pa b">Recipes</code>是保存我们的配方数据的数组,<code class="fe ox oy oz pa b">setRecipe</code>是使我们能够更新状态的函数，这相当于类组件中的<code class="fe ox oy oz pa b">this.setState</code>。</p><p id="efb3" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">以防语法看起来混乱，这不是特定于React的语法，而是普通的ES6 JavaScript。这就是所谓的解构。因为<code class="fe ox oy oz pa b">useState</code>返回一对值，所以我们将它析构为一个数组。我们为它们选择的名字并不影响它们的行为。将它们命名为[您所在州的名称，集合+州的名称]是一个简单的好习惯，因此我们有:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/e5b91da98a3e7ad2e7f12741c286a6ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*-tptYToNM5JTm2UN9qbaKQ.png"/></div></figure><p id="587d" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">如果你需要一些关于析构的复习或入门，我已经在这里写了一点。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="0b44" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated">关闭</h1><p id="77c1" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">为了充分理解这里发生的事情，我们需要注意的另一个JavaScript特性是<em class="la">闭包</em>。由于JavaScript闭包，我们可以在函数中的任何地方从<code class="fe ox oy oz pa b">useState</code>访问被析构的变量。因此，在<code class="fe ox oy oz pa b">fecthRecipe </code>函数内和组件内的任何地方，我们可以使用<code class="fe ox oy oz pa b">setRecipe</code>或任何其他变量，而不必调用它<code class="fe ox oy oz pa b">this.setRecipe</code>、<strong class="lb iu">、<em class="la">、</em>、</strong>等。</p><p id="1599" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">出于本教程的目的，<em class="la">闭包</em>的一个简化定义是，它让我们可以访问外部(封闭)函数的变量——作用域链，以及它们的返回值。</p><p id="22fd" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">这里可以看更多<a class="ae ku" href="https://javascript.info/closure" rel="noopener ugc nofollow" target="_blank">，这里</a>可以看<a class="ae ku" href="https://www.youtube.com/watch?v=71AtaJpJHw0" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="4052" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">让我们快速地将道具传递给我们的组件，并设置它们来显示<code class="fe ox oy oz pa b">Recipe</code>的列表。因为这不是一个特定于钩子的特性，所以我将跳过它。你可以在这里找到最新的回购协议。我还增加了样式来加快速度。更新后的回购在【回购】<a class="ae ku" href="https://github.com/olajohn-ajiboye/Blog-React-Hook-Tutorial" rel="noopener ugc nofollow" target="_blank">https://github.com/olajohn-ajiboye/Blog-React-Hook-Tutorial</a>的第三个<code class="fe ox oy oz pa b">/hook-in-app.js</code>分支。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="d14f" class="lv lw it bd lx ly od ma mb mc oe me mf jz of ka mh kc og kd mj kf oh kg ml mm bi translated"><strong class="ak">使用</strong> <code class="fe ox oy oz pa b"><strong class="ak">useState</strong></code></h1><p id="2857" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">此时，你的<code class="fe ox oy oz pa b">App.js</code>应该如下图所示。我们只是将状态中的recipes数组作为<code class="fe ox oy oz pa b">recipes props</code>传递给了<code class="fe ox oy oz pa b"><strong class="lb iu"><em class="la">RecipeList</em></strong> </code>组件。注意，我还用<code class="fe ox oy oz pa b">useState</code>添加了一个加载状态，并在数据完全取出后将其设置回<em class="la">假</em>。这是使用多态的第一个例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><h2 id="21aa" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated"><code class="fe ox oy oz pa b">RecipeList</code>组件</h2><p id="ffb1" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">这里，我们简单地接收了从父组件<code class="fe ox oy oz pa b">App</code>作为道具传递的<code class="fe ox oy oz pa b">recipes</code>,并立即对其进行了析构——见第5行。然后我们对它进行映射，将每个食谱作为道具传递给<code class="fe ox oy oz pa b">Recipe</code>组件。这里没什么特别有趣的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="aeda" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">现在到了有趣的部分…</p><p id="4caa" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">在<code class="fe ox oy oz pa b">Recipe</code> <strong class="lb iu"> </strong>组件内部，我添加了一些做作的状态<em class="la"> </em>，简单到可以完全理解。我们将尝试一行一行地进行，试图理解我们在做什么，以及我们如何用<code class="fe ox oy oz pa b">useState</code> <strong class="lb iu"> <em class="la"> </em> </strong>钩子处理有状态逻辑。你的<code class="fe ox oy oz pa b">Recipe</code> <strong class="lb iu"> <em class="la"> </em> </strong>中应该有以下成分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="16e1" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">我们来理解一下上面的代码。如前所述，我们已经从其父组件<code class="fe ox oy oz pa b">RecipeList</code>接收了<code class="fe ox oy oz pa b">recipe</code> <strong class="lb iu"> <em class="la"> </em> </strong>作为道具。然后，我们立即在函数参数中对它进行了析构。然后我们继续进一步从<code class="fe ox oy oz pa b">recipe</code> <strong class="lb iu"> <em class="la"> </em> </strong>对象中析构我们打算使用的部分。我知道<code class="fe ox oy oz pa b">recipe</code>对象包含什么，因为我测试过API，所以这不是什么魔术。这相当于下图</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/37f6071e4ef03278e264492597a471c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*0WCkhlVlB3AKLEc5o-qIow.png"/></div></figure><h2 id="1673" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated">在更多和更少之间切换</h2><p id="de58" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">如果你检查应用程序，你会意识到，当我们点击“更多细节”按钮时，我们会获得与该食谱相关的额外信息，特别是成分列表和社会评价。看一眼顶部的gif图，复习一下。所以我们需要某种状态来处理期望的用户交互。</p><p id="447b" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">想一想。我们需要一种方法来切换显示更多或更少的信息。我们还需要一种方法来获取特定配方的信息。期望的结果将被存储在某种状态中。因此，我们至少确定了两种状态。因此，在我们的应用程序中，我们有一个<code class="fe ox oy oz pa b">showInfo</code> <strong class="lb iu"> </strong>和一个<code class="fe ox oy oz pa b"><strong class="lb iu">recipeDetail</strong>s</code>状态。</p><p id="4fef" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">有了这些信息，让我们使用<code class="fe ox oy oz pa b">useState</code>钩子。</p><ul class=""><li id="e2de" class="ni nj it lb b lc ld lf lg mp ph mr pi mt pj lu nn no np nq bi translated">首先，我们声明<code class="fe ox oy oz pa b">showInfo</code>状态和<code class="fe ox oy oz pa b">setShowInfo</code>函数(相当于<code class="fe ox oy oz pa b">this.SetState</code>)。我们将值设置为<em class="la">假。</em></li><li id="8144" class="ni nj it lb b lc nr lf ns mp nt mr nu mt nv lu nn no np nq bi translated">其次，我们声明了<code class="fe ox oy oz pa b">recipeDetails</code>和<code class="fe ox oy oz pa b">setRecipeDetails</code>。我们将值设置为空数组[]。</li></ul><p id="7ebb" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">希望这足够简单。我们已经设置了初始状态，并准备用<code class="fe ox oy oz pa b">setShowInfo</code> <strong class="lb iu"> <em class="la"> </em> </strong>和<code class="fe ox oy oz pa b">setRecipeDetails</code>处理状态变化。</p><h2 id="da8a" class="mv lw it bd lx mw mx dn mb my mz dp mf mp na nb mh mr nc nd mj mt ne nf ml ng bi translated">handleShowInfo <strong class="ak">功能</strong>功能</h2><p id="6e7e" class="pw-post-body-paragraph ky kz it lb b lc mn ju le lf mo jx lh mp mq lk ll mr ms lo lp mt mu ls lt lu im bi translated">这是一个异步函数，帮助获取数据，并处理状态变化以显示或不显示信息。</p><p id="d0c4" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">让我们一行一行地把它拆开。</p><p id="f57b" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">因为我们打算在点击按钮时调用<code class="fe ox oy oz pa b">handleShowInfo</code>，所以我们必须访问事件对象。在按钮内部，我们将<code class="fe ox oy oz pa b">recipe_id</code>设置为数据属性。这使我们能够抓住特定配方的<code class="fe ox oy oz pa b">id</code>。在<code class="fe ox oy oz pa b">handleShowInfo</code>中，我们通过将<code class="fe ox oy oz pa b">id</code>从<code class="fe ox oy oz pa b">event.target</code>属性中提取出来来获得它。因为我们需要获得额外的信息，所以需要用<code class="fe ox oy oz pa b">id</code>发出一个HTTP <strong class="lb iu"> </strong>请求。这就是我们下一步要做的，等待回应。然后，我们将该值转换为一个<code class="fe ox oy oz pa b">json</code>，并将该值存储在<code class="fe ox oy oz pa b">const recipe</code>中。</p><p id="5e20" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">注意:您可能需要从<a class="ae ku" href="https://www.food2fork.com/" rel="noopener ugc nofollow" target="_blank"> Food2Fork </a>获取一个API密钥。当前键可能会超出限制。</p><p id="238a" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">我们作为响应得到的<code class="fe ox oy oz pa b">recipe</code> <strong class="lb iu"> <em class="la"> </em> </strong>然后被放入setRecipeDetails中作为<code class="fe ox oy oz pa b">recipeDetails</code>的更新程序。至此，我们已经简单地将<code class="fe ox oy oz pa b">recipeDetails</code> <strong class="lb iu"> <em class="la"> </em> </strong>的状态设置为数组响应变量<code class="fe ox oy oz pa b"> <strong class="lb iu"><em class="la">recipe</em></strong></code>。这相当于</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/c34da55fd1a7728c4e503d5cdbe9b6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*wB4YKN0kdQ2HDiEVipLmjw.png"/></div></figure><p id="e6c8" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">我们还将<code class="fe ox oy oz pa b">showInfo</code>的值设置为它原来的相反值。这就是每当点击按钮时产生切换效果的原因。这相当于:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/960e64bc57c06019530cb538cef5c2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*7NUOPaJIlcQARA2SAX0JKQ.png"/></div></figure><p id="3cbf" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">仅此而已。在返回的jsx中，我们根据点击按钮时<code class="fe ox oy oz pa b">showInfo</code>的状态有条件地呈现信息。此外，我们还映射了一系列配料，将它们显示为附加信息。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="e732" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">这是钩子最基本的介绍的结尾，也许是一种过于简化的介绍。在本系列的下一次迭代中，我们将更详细地研究钩子，然后学习上下文API。</p><p id="0228" class="pw-post-body-paragraph ky kz it lb b lc ld ju le lf lg jx lh mp lj lk ll mr ln lo lp mt lr ls lt lu im bi translated">希望你喜欢这个介绍。敬请关注下一次更新，很快再见。谢谢大家！</p></div></div>    
</body>
</html>