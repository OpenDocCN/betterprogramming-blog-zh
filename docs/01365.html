<html>
<head>
<title>Building Cross-Platform Voice Apps With VOXA — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用VOXA构建跨平台的语音应用——第3部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-cross-platform-voice-apps-with-voxa-part-3-e738cd991fde?source=collection_archive---------16-----------------------#2019-09-03">https://betterprogramming.pub/building-cross-platform-voice-apps-with-voxa-part-3-e738cd991fde?source=collection_archive---------16-----------------------#2019-09-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5607" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在VOXA中创建跨平台语音应用系列的第三部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/42c6d6f6b63541f21e8c619a588765ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGXw35E9epOBdlbpOaqfog.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@frostroomhead?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">罗迪翁·库察耶夫</a>在<a class="ae kv" href="https://unsplash.com/search/photos/voice-cellphone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f021" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" href="https://medium.com/better-programming/building-cross-platform-voice-apps-with-voxa-part-2-feb440ec5da0" rel="noopener">之前的文章</a>中，我们创建了Alexa skill和Google Assistant应用。我们还创建了VUI电子表格，您团队中的任何人都可以通过为您的语音应用程序添加意图、话语和响应来进行协作。此外，我们了解到，我们可以使用VOXA-CLI将所有这些信息下载到我们的VOXA项目中，并从头开始创建项目。最后，我们添加了链接到Alexa skill的帐户和Google action的Google Sign-In。在本文中，我们将创建游戏的基本逻辑，获取用户信息，并在AWS DynamoDB中保持进度。</p><p id="cca1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，让我们开始吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/0b398ca9437ca9218be8c9539daca616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciG2XSBC2cchcAqkHxQyzw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://pixabay.com/images/search/equation/" rel="noopener ugc nofollow" target="_blank">www.pixabay.com</a></p></figure><p id="cce4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们在本系列的第一部分中了解到的，VOXA利用MVC原则来分离三个不同的层:模型、视图和控制器。我们将尝试在我们的应用程序中遵循这一模式:</p><ul class=""><li id="e31d" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated"><strong class="ky ir"> /src/app/model.js </strong>文件中的模型</li><li id="59fd" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> /src/languageResources </strong>文件夹中的所有视图。</li><li id="7dbb" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> /src/app/states </strong>文件夹中的所有控制器。</li></ul><p id="afee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以从快速数学模板下载代码，我已经把它推送到我的GitHub库的分支<a class="ae kv" href="https://github.com/omenocal/quick-maths-voice-app/tree/part3" rel="noopener ugc nofollow" target="_blank"> part3 </a>中。</p><p id="99d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们检查一下model.js文件。该文件太大，无法在此显示，因此请通过<a class="ae kv" href="https://github.com/omenocal/quick-maths-voice-app/blob/part3/src/app/model.js" rel="noopener ugc nofollow" target="_blank">该链接</a>将其签出到存储库中。</p><p id="b2db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有两种重要的方法来生成游戏的主要逻辑:</p><p id="8d8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">selectOperation(voxaEvent)</code></p><p id="3210" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和</p><p id="8c29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">isAnswerRight(result)</code></p><p id="5916" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mh mi mj mk b">selectOperation</code>中，我们随机选择数字和运算符，让用户计算结果。我们暂时简化一下，一次只有两个数字和一个操作符。我们还确保结果永远不会是负面的。我们不希望用户在尝试计算51–78时失去理智，例如，这仍然是一个简单的操作，但我们希望用户参与我们的应用程序。如果他们在开始使用应用程序时得到这种操作，他们可能会停止使用它！</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="7155" class="mp mq iq mk b gy mr ms l mt mu">if (this.user.isFirstTime) {<br/>  this.level = _.head(levels);<br/>} else if (this.user.sessionCount &lt;= 3) {<br/>  this.level = _.nth(levels, this.user.sessionCount);<br/>} else {<br/>  this.level = _.sample(levels);<br/>}</span></pre><p id="46f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这段代码，我们就可以确保难度是根据用户开启技能的次数来决定的。</p><p id="01c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，您可能会发现这段代码很有趣:</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="edb6" class="mp mq iq mk b gy mr ms l mt mu">const wordsNumber1 = ntw.toWords(this.number1);<br/>const wordsNumber2 = ntw.toWords(this.number2);<br/>const params = {<br/>  operatorName: this.operatorName,<br/>  wordsNumber1,<br/>  wordsNumber2,<br/>};<br/><br/>const speech = voxaEvent.t('Operation.Expression.calculation', params);<br/>const durationTime = readingTime(speech);<br/><br/>console.log('speech', speech);<br/>console.log('durationTime', durationTime);<br/><br/>this.speechTimeDiff += durationTime.time;</span></pre><p id="781d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住，我们根据用户计算结果所用的时间给他们打分，但我们必须考虑Alexa持续的时间:</p><ul class=""><li id="57ed" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">55 * 2是多少？</li><li id="3a4b" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">105 + 203是多少？</li><li id="d99c" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">3512–512是多少？</li></ul><p id="6e80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">时间不能固定为一个单一的数字，所以我们使用<a class="ae kv" href="https://www.npmjs.com/package/number-to-words" rel="noopener ugc nofollow" target="_blank">数字转文字</a>和<a class="ae kv" href="https://www.npmjs.com/package/reading-time" rel="noopener ugc nofollow" target="_blank">阅读时间</a> NPM包来计算它。这个时间不是100%准确——它会根据Alexa和托管技能的服务器之间的互联网连接而变化。使用当前值，您会发现在本地测试您的技能时，它不是100%准确，但是我发现在将代码部署到AWS Lambda函数时，它是相当准确的。</p><p id="6df7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mh mi mj mk b">isAnswerRight</code>方法中，我们获取用户计算操作所用的秒数，并相应地给他们打分:</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="ddb7" class="mp mq iq mk b gy mr ms l mt mu">if (timeDiff &lt;= 3000) {<br/>  pointsEarned += 10;<br/>} else if (timeDiff &lt;= 6000) {<br/>  pointsEarned += 8;<br/>} else if (timeDiff &lt;= 9000) {<br/>  pointsEarned += 4;<br/>} else {<br/>  pointsEarned += 2;<br/>}</span></pre><p id="ac4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<strong class="ky ir">/src/app/States/main . States . js</strong>文件中，您可以看到我们用来控制这个流的主要状态:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/4d18932061a4c48ffcaa822cb317897a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*hBv7fLNYjRmdsLNN0jRMmA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">VOXA状态处理程序</p></figure><p id="fb89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对话是这样的:</p><p id="6b23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:Alexa，打开快速数学</p><p id="9815" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Alexa:欢迎回到快速数学！要不要从游戏开始？</p><p id="4ce9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:是的</p><p id="819d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Alexa:995-213是多少？</p><p id="cd9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:782</p><p id="f1bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Alexa:太棒了！你得到2分。我们应该再试一次吗？</p><p id="5e7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:是的</p><p id="9495" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亚历山大:7 * 9是多少？</p><p id="3523" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:73</p><p id="6951" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亚历克莎:不！是63。我们应该再试一次吗？</p><p id="d139" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户:没有</p><p id="912b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亚历山大:好的。再见。</p><p id="863c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在VOXA中，我们控制我们想要返回的视图和我们期望下一次交互的状态。例如:</p><pre class="kg kh ki kj gt ml mk mm mn aw mo bi"><span id="bc0f" class="mp mq iq mk b gy mr ms l mt mu">return {<br/>    reply: [‘RightAnswerExpression’, ‘RightAnswer’],<br/>    to: ‘begin’,<br/> };</span></pre><p id="2064" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">RightAnswerExpression</code>是一个具有独特指令的视图:<code class="fe mh mi mj mk b"><strong class="ky ir">say</strong></code>。在VOXA中，这意味着视图的内容将被附加到我们在相同状态或下一个状态中使用的下一个视图，直到我们设置了将响应返回给Alexa或Google的点。</p><p id="f27d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">RightAnswer</code>是一个带有三个指令的视图:</p><ul class=""><li id="0fee" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated"><strong class="ky ir">问</strong>:Alexa或者Google会给出的主要回应。这表示响应应该返回到语音平台，而不是另一个VOXA状态。</li><li id="a5c3" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">如果用户在主要发言后保持沉默，Alexa或谷歌将给出重新提示。</li><li id="e027" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> dialogflowSuggestions </strong>:谷歌助手屏幕下方显示的建议。</li></ul><p id="46ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">VOXA有几个指令，可用于渲染特定于平台的功能。例如:</p><ul class=""><li id="7232" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated"><strong class="ky ir"> alexaCard </strong>:为Alexa渲染一个链接卡、简单卡或基本卡</li><li id="06fd" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">alexaAPLTemplate :呈现一个APL模板指令</li><li id="1033" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> alexaRenderTemplate </strong>:呈现DisplayTemplate指令</li><li id="6a10" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> dialogflowSuggestions </strong>:为谷歌助手渲染建议芯片</li><li id="b6d6" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> dialogflowTable </strong>:为谷歌助手渲染一个表格</li><li id="23e1" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated"><strong class="ky ir"> googleCompletePurchase </strong>:呈现Google的DigitalGoods指令</li></ul><p id="006d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击以下链接查看其他Alexa和谷歌助理指令:</p><p id="eaee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://voxa.readthedocs.io/en/latest/alexa-directives.html" rel="noopener ugc nofollow" target="_blank"> Alexa指令</a></p><p id="f574" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://voxa.readthedocs.io/en/latest/google-assistant-directives.html" rel="noopener ugc nofollow" target="_blank">谷歌助手指令</a></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="ee67" class="nd mq iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">AWS DynamoDB集成</h1><p id="e527" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">我们将使用DynamoDB表来存储用户的信息——他们的进度、记录的创建日期、他们开启技能的次数，以及您想要存储的任何其他数据。</p><p id="5a55" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到您的AWS帐户并创建一个DynamoDB表。我创建了两个表:<strong class="ky ir"> QuickMathsUsersStaging </strong>和<strong class="ky ir">QuickMathsUsersProduction</strong>，因为我想拥有两种不同的技能，一种用于测试，另一种用于认证。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/09fb8cb2bd9ba06ac6a1e4146b0c052b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_bUse2DJbZQ5I2D0w85ug.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd oa">QuickMathsUsersProduction</strong>DynamoDB表格视图</p></figure><p id="827a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住将这类信息添加到项目的配置值中，这样您就不必在代码的几个部分中像这样定义重要的值。因为我们在不同的环境中使用不同名称的表，所以有必要将表的名称放在您的配置文件中的<strong class="ky ir"> /src/config/ </strong>文件夹中。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="9cb0" class="nd mq iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">在本地测试技能</h1><p id="c8d9" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">首先，确保您的项目中有本地文件。如果没有，可以简单的复制<strong class="ky ir">/src/config/local . example . JSON</strong>文件，创建<strong class="ky ir"> /src/config/local.json </strong>文件。如果您使用staging中的相同配置，您可以选择<strong class="ky ir"> staging.json </strong>文件来复制内容。</p><p id="c998" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用一个优秀的工具进行本地调试:<a class="ae kv" href="https://www.npmjs.com/package/bespoken-tools" rel="noopener ugc nofollow" target="_blank"> Bespoken tools </a>。如果您的计算机中没有安装它，请下载并全局安装该软件包。</p><p id="cd88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Bespoken提供了一个代理命令，将来自Alexa或Google Assistant应用程序的请求重定向到您的本地机器，您只需在您的终端上运行:</p><p id="b96b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ob"> bst代理http &lt;端口&gt;T1】</em></p><p id="9f10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行这个程序，您将有一个代理在您喜欢的端口上运行。我总是用3000，那是我最喜欢的一个！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/73e633f8c4b7eae1ce54f868640bc799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQvPeDhJBFP8TC0cWrj1hA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在您计算机的端口3000本地运行的预定服务器</p></figure><p id="2e6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于预订的URL，您需要根据您想要运行的平台添加一个路径:</p><p id="d485" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Alexa:<a class="ae kv" href="https://dreamy-bradbury.bespoken.link" rel="noopener ugc nofollow" target="_blank">https://&lt;YOUR-BESPOKEN-ID&gt;. BESPOKEN . link/Alexa</a></p><p id="8761" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谷歌:<a class="ae kv" href="https://dreamy-bradbury.bespoken.link" rel="noopener ugc nofollow" target="_blank">https://&lt;YOUR-BESPOKEN-ID&gt;. BESPOKEN . link/Google action</a></p><p id="8538" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，打开一个新的终端窗口，转到项目的根路径并运行:</p><p id="095e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ob">纱线手表</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/37c19afc67336f449ddba6381ec0913f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_uzzpmTtD-5MFNKD6Zdzow.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用<strong class="bd oa">纱线观察</strong>命令为语音应用启动VOXA服务器</p></figure><p id="ffd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将启动项目的一个服务器，运行在端口3000，等待来自Alexa或Google的请求。</p><p id="5a0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我更喜欢用纱线工作，但你也可以运行<strong class="ky ir"> npm run watch。</strong></p><p id="1781" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到Dialogflow，确保你更新了所有的意图和话语。你可以通过压缩dialogflow文件夹中的所有内容来做到这一点:<strong class="ky ir">/speech-assets/dialog flow/&lt;environment&gt;</strong>，可以是staging也可以是production。在您的代理中，转到设置按钮⚙，然后转到<strong class="ky ir">导出和导入</strong>选项卡。点击<strong class="ky ir">恢复</strong>按钮，拖放zip文件。然后进入左侧的履行菜单，粘贴你预约的网址:<a class="ae kv" href="https://dreamy-bradbury.bespoken.link" rel="noopener ugc nofollow" target="_blank">https://&lt;YOUR-BESPOKEN-ID&gt;. BESPOKEN . link/Google action</a>。</p><p id="d733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在integrations选项卡中，单击Google Assistant集成，并单击TEST按钮。这将把你带到谷歌行动的模拟器页面，我们可以在那里开始测试！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/edd23301ddc448b5c1a8129ce11b9f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l0npMLrbFvZXS9b1YSRQGQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的快速数学谷歌行动的主视图</p></figure><p id="6c57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果一切正常，你将有谷歌行动发送请求回你的电脑。同时，VOXA将把结果保存在DynamoDB中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/cb261f4ab12c728e3361e1db5872ddce.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*xfQ9AUzdYIsfA0K4AHPr_Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">快速数学谷歌行动对话示例</p></figure><p id="61a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的终端窗口中，您将看到bespoken如何记录请求和响应，以及VOXA服务器如何记录我们正在记录的一些重要数据。你也可以打印任何你想检查的数据。</p><p id="79a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一点上，我们已经有一个Alexa技能和谷歌行动准备发送认证。我们只需要创建一个lambda函数来上传我们的代码。本指南不包括代码的部署，但我建议你上传你的代码到两个不同的Lambda函数——一个用于Alexa技能，另一个用于Google动作。</p><p id="492d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于Google Action，您还需要创建一个API网关，通过Dialogflow可以访问的https端点来公开您的Lambda函数。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="e615" class="nd mq iq bd ne nf ng nh ni nj nk nl nm jw nn jx no jz np ka nq kc nr kd ns nt bi translated">最后的</h1><p id="39d1" class="pw-post-body-paragraph kw kx iq ky b kz nu jr lb lc nv ju le lf nw lh li lj nx ll lm ln ny lp lq lr ij bi translated">我们将进一步发展。在下一篇文章中，我们将创建竞争流。这场比赛将显示前10名的球员与更多的分数在一个排行榜，使它更有趣。我们将为我们的应用程序添加订阅，每月仅需0.99美元！这将是一个学习如何将我们的语音应用货币化的好机会。我们将利用Alexa的技能内购买和谷歌的数字商品API。</p><p id="0896" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！请务必查看下一篇文章。</p><p id="a1c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">记住:不要把垃圾扔到海里！</p></div></div>    
</body>
</html>