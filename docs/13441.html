<html>
<head>
<title>Detect User Inactivity in Flutter Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检测颤振应用中的用户不活动</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/detect-user-inactivity-in-flutter-applications-af42b08101c?source=collection_archive---------0-----------------------#2022-08-27">https://betterprogramming.pub/detect-user-inactivity-in-flutter-applications-af42b08101c?source=collection_archive---------0-----------------------#2022-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d510" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">防止数据泄露</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ae09031c81f05333af0cbc15d5b060de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jAz1Z2SKl8h0OEEI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@proxyclick?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">procyclick访客管理系统</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5abb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最常见的功能之一是检测用户的非活动状态，以避免数据泄漏。这些可以是你智能手机上的私人应用程序，比如你的银行账户，或者是在实体店的信息亭设备上运行的应用程序，你可能需要在这些设备上输入一些个人信息，比如你的电子邮件地址。</p><blockquote class="ls lt lu"><p id="ac73" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">我假设您对依赖注入和阻塞模式有所了解，但是请记住，这些都不是实现您自己解决方案所必需的。反正我会提供一个替代方案。说够了，让我们开始研究吧！</p></blockquote><h1 id="0bd9" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用依赖和阻塞模式</h1><p id="6ff1" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">先加上<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/injectable" rel="noopener ugc nofollow" target="_blank">injectable</a></code>、<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/async" rel="noopener ugc nofollow" target="_blank">async</a></code>、<code class="fe mw mx my mz b"><a class="ae kv" href="https://pub.dev/packages/flutter_bloc" rel="noopener ugc nofollow" target="_blank">flutter_bloc</a></code>和<code class="fe mw mx my mz b">build_runner</code>。那些是一些众所周知的软件包，经常被使用。</p><p id="a43e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们需要一个对象来记录时间，这是主要的特征。为此，让我们创建一个简单的<code class="fe mw mx my mz b">cubit</code>并使用<code class="fe mw mx my mz b">RestartableTimer</code>。它做它所说的，并由<code class="fe mw mx my mz b">async</code>包提供。正是我们需要的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="76ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以想象，这个想法是在<code class="fe mw mx my mz b">60 secondes</code>期间运行某种倒计时，一旦时间过去，它发出一个<code class="fe mw mx my mz b">TimeoutExpired</code>状态，以便我们的表示层中的<code class="fe mw mx my mz b">BlocListener</code>可以捕捉到它并相应地采取行动。例如，您可能想要显示一个<code class="fe mw mx my mz b">AlertDialog</code>来确保用户已经离开或者立即清除任何个人信息。</p><p id="81ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一方面，每次与屏幕发生交互时，倒计时将<code class="fe mw mx my mz b">reseted</code>到其原始值。这就是下面代码的目的，也是为什么<code class="fe mw mx my mz b">RestartableTimer</code>比常规的<code class="fe mw mx my mz b">Timer</code>更好。</p><p id="0178" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后把你的<code class="fe mw mx my mz b">MaterialApp</code>包在一个简单的<code class="fe mw mx my mz b">Listener</code>里面！<code class="fe mw mx my mz b">onPointerDown</code>回调是我们实现的关键。每次你和屏幕互动的时候都会触发。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><blockquote class="ls lt lu"><p id="294c" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">别忘了调用<code class="fe mw mx my mz b">runner</code>来生成你需要的一切。</p></blockquote><h1 id="8873" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">没有阻塞或依赖注入替代方案</strong></h1><p id="026c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">用同样的方法创建一个简单的类。唯一的区别是回调函数。每当超时触发时，它将为我们提供处理预期行为的机会。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="b708" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了防止任何多次超时运行(如果您需要访问您的实例进行一些扩展使用)，我使用了<code class="fe mw mx my mz b">factory</code>构造函数来创建一个<code class="fe mw mx my mz b">singleton</code>，就像我使用<code class="fe mw mx my mz b">@lazySingleton</code>注释一样。显然<code class="fe mw mx my mz b">callback</code>会像<code class="fe mw mx my mz b">state</code>一样被触发。</p><p id="7b74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您需要创建它的一个实例，这样就万事俱备了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1205" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要忘记在<code class="fe mw mx my mz b">onPointerDown</code>回调中调用<code class="fe mw mx my mz b">reset</code>。</p><h1 id="8d38" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">处理背景和前景状态</h1><p id="454a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">添加<code class="fe mw mx my mz b">WidgetsBindingObserver</code> mixin并覆盖<code class="fe mw mx my mz b">initState</code>、<code class="fe mw mx my mz b">dispose</code>和<code class="fe mw mx my mz b">didChangeAppLifecycleState</code>方法。请确保您的应用程序扩展了<code class="fe mw mx my mz b">StatefulWidget</code>来这样做！如果没有，<code class="fe mw mx my mz b">didChangeAppLifecycleState</code>就不会被调用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="5fd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。有了这些，您应该能够在应用程序中的任何地方处理用户的不活动。</p><p id="972a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像往常一样，这是一个提议，如果你知道实现这种特性的更好的方法，请随意分享！</p><h1 id="2748" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">了解更多信息…</h1><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/build-a-collaborative-pixel-art-app-with-flutter-and-firebase-d4a027b4534b"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">用Flutter和Firebase构建一个协作像素艺术应用程序</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">创建您自己的休息/场所</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">better编程. pub</p></div></div><div class="no l"><div class="np l nq nr ns no nt kp nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a rel="noopener  ugc nofollow" target="_blank" href="/a-guide-to-handling-user-privacy-to-comply-with-gdpr-in-flutter-applications-9914ab479240"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">颤振应用中符合GDPR的用户隐私处理指南</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">通过在收集数据前询问来保持合规性</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">better编程. pub</p></div></div><div class="no l"><div class="nu l nq nr ns no nt kp nf"/></div></div></a></div><div class="nc nd gp gr ne nf"><a href="https://medium.com/@julien.duribreux_43255/flutter-dependency-injection-flavors-and-secrets-management-75181705045d" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">依赖注入和风味的颤振秘密管理</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">软件开发中的一个常见用例是需要处理多种环境和相关的…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="nv l nq nr ns no nt kp nf"/></div></div></a></div></div></div>    
</body>
</html>