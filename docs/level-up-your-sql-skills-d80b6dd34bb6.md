# 提升您的 SQL 技能

> 原文：<https://betterprogramming.pub/level-up-your-sql-skills-d80b6dd34bb6>

## 帮助您提高 SQL 水平的技巧

![](img/1e633551f96d5f3b097a4c5ced6b57f3.png)

图片来自 [Unsplash](https://unsplash.com/photos/fPkvU7RDmCo) 上的 [Caspar Camille Rubin](https://unsplash.com/@casparrubin) 。

根据 [JetBrains 的 2020 年开发者生态系统调查](https://www.jetbrains.com/lp/devecosystem-2020/)，56%的开发者在他们的开发环境中使用 SQL 数据库或与之交互。尽管如此，大多数开发人员将 SQL 概念视为次要问题，因为他们经常通过自己选择的语言进行交互，在设计中并没有起到太大的作用。一般来说，能够连接和运行基本的查询会让你度过一天。

在许多公司，甚至有一个单独的数据库团队来处理数据库设计和优化，所以你永远不会得到第一手的资料。我认为这通常是学习更多 SQL 知识的障碍。它被认为是一个经常被其他人使用的工具。软件开发人员已经够忙的了，对吧？很公平。

然而，在我们的行业中，拥有全栈技能总是一个好主意。你永远不知道会有什么东西扔向你。我们每天都与 SQL 进行交互，因此更多的知识总会派上用场。此外，如果您最终在一家规模较小的公司工作，没有足够的资源来组建完整的数据库团队，那么更多的责任将落在您的身上。能够在面试中表明你对自己的数据库技能有信心，将会开启许多有趣的职业道路。

我个人比大多数人更喜欢 SQL 开发。在我职业生涯的早期，我在一个优秀的数据库管理员团队实习，并很快坠入爱河。我在学校里学过数据库课程，所以我有一些基础知识，但是我在那次实习中学到的东西对我来说是无价的。它不仅教会我对数据有一种秘密的热情，而且我获得的技术理解对我未来的每份工作都有好处。

数据库开发和管理有很多工作要做——有些专家可以施展魔法。然而，作为一名开发人员而不是 SQL 向导，这些主题将使您在 SQL 知识方面脱颖而出。

*注意:我有使用微软 SQL Server 的经验，所以这是我将贯穿始终的参考。然而，这些概念绝对适用于其他 SQL DBMS 选项。*

# 正常化

如果你在学校上过关系数据库的课程，你肯定会遇到术语*规范化*。这是数据库设计的核心概念。然而，作为一名开发人员，以下是您应该关心的原因:这将使您的生活更加轻松。

数据库规范化背后的主要思想是减少数据冗余，并确保数据以一种干净、逻辑的方式存储。数据库的规范化级别取决于它所达到的“范式”。迄今为止，有争议的范式多达六种，但实际上，你需要理解的只是前三种。

以下是简单明了的重要规则:

*   第一范式(1NF)规定单个字段应该存储单个数据点，并且所有行都应该是唯一的。不要在一个字段中存储一个列表。那些应该是个人记录。
*   第二范式(2NF)规定每个表应该有一个主键列。创建唯一的 id。不要使用名称和地址作为复合键，只需给用户一个唯一的 ID 号或 GUID。
*   第三范式(3NF)声明不允许函数传递依赖。这可能是最复杂的，但本质上它意味着如果你有一个依赖于另一个字段的字段，它应该被分解到另一个表中。这允许外键改变，而不是实际值。

这里重要的一点是，你的数据应该是*原子的*，所以有重复数据的大表应该分解成有容易搜索的关键字的小表。这使得过滤更有效，查询更简单。它让你的工作变得更加轻松！

# 数据库对象

如果你在一个更全栈的角色，或者在一个没有数据库团队的公司，你可能会负责数据库开发。在这种情况下，您应该很清楚在不同的场景中使用哪种数据库对象。

简而言之，数据库对象是可以用存储或访问数据的创建脚本生成的任何东西。最明显的例子是表，它是数据库的构造块。这些显然将成为数据存储的首选。

但是，还有其他类型的对象以不同的方式访问和转换这些数据。使用最合适的物品非常重要。以下是我在决定使用哪个用例时使用的基本规则:

*注意:索引在技术上是数据库对象，因为它们影响数据的存储和访问。*

*   存储过程:这是处理或转换数据的常用方法。如果您需要在一天中的特定时间或特定频率进行更新，可以创建存储过程，然后按计划运行。
*   视图:视图本质上是一个存储查询，它允许您从一组动态数据中进行选择。如果数据需要更新并且可能以某种方式转换，我经常用视图替换缓存的表。实际上没有存储任何更改，但是您可以包含计算字段，当您需要动态的最新数据时，这使视图成为一个很好的选择。

了解了表、视图和存储过程之后，您将有可能处理大多数数据库开发任务。

![](img/d7e9bca88ce5ce5166a877faf40da223.png)

图片来自[本杰明·雷曼](https://unsplash.com/@benjaminlehman)在 [Unsplash](https://unsplash.com/photos/GNyjCePVRs8)

# 索引

您需要理解的第一个主要索引概念是聚集索引和非聚集索引之间的区别。

*   聚集索引:根据索引存储表中的所有数据。只能有一个聚集索引，默认情况下，主键是聚集的。
*   非聚集索引:将索引字段与表分开存储。这个索引字段指向存储在表中的数据，就像一本书的索引一样。您可以拥有任意数量的非聚集索引！

*注意:更高效查询的代价是增加存储。非聚集索引需要自己的存储，因为它们与表数据分开保存。仅索引您需要筛选或连接的字段，以便在存储和性能之间找到最佳平衡。*

索引是优化数据库性能的首选方式。索引影响数据在页面中的存储方式。默认情况下，记录不会以任何有保证的顺序存储，因此对字段进行索引会导致数据以可预测的方式存储。因此，当您筛选该字段时，查询会运行得更快，因为 SQL Server 确切地知道从哪里开始查找。

出于特定目的，可以对字段设置许多索引，但是如果试图提高性能，通常会创建一般的非聚集索引。

*亲提示:* *如果是创建索引，就要维护索引。插入、更新和删除会导致索引碎片化。因此，除非您的数据完全停滞，否则您将需要根据数据变化的频率来重建索引。理想情况下，您应该使用预定的存储过程来实现这一点，以便始终保持性能。*

创建索引的 SQL 语句非常简单。以下语句将在 Orders 表的给定字段上创建一个名为`idx_orderdate`的非聚集索引:

```
CREATE INDEX idx_orderdate ON Orders (OrderDate);
```

# 读取查询计划

如果您有兴趣更深入地了解数据库性能，能够阅读查询执行计划是一项有用的技能。当您运行查询时，SQL Server 会根据执行计划对其进行处理。您可以在运行查询时生成计划，或者如果查询一直在运行，则查看缓存的计划。这允许您查看查询中的每个步骤花费了多少时间。

有经验的 SQL 向导可以从查询计划中发现许多细微差别。然而，对于标准开发人员来说，您需要知道的是寻道和扫描之间的区别。

*   扫描:这可以是索引扫描或表扫描，但无论哪种方式，SQL Server 都必须扫描整个表或索引中的数据。
*   Seek:在索引搜索的情况下，SQL Server 能够根据给定的索引识别您正在查询的数据。

一般来说，寻道效率更高。通常，如果您希望优化查询，您应该确定查询中扫描发生的位置并修复它们。修复它们最简单的方法是确保您连接的是索引字段。

专业提示:SQL Server 会让你知道你是否遗漏了一个可能在你的查询中使用的索引。建议将出现在查询计划的顶部。如果您右键单击建议索引的查询计划并选择“缺少索引细节”，它甚至会为您生成索引创建脚本！

# 恭喜你！

您现在已经提高了您的 SQL 技能！使用这些概念，您现在可以更有效地优化数据库和查询。无论您是从应用程序进行查询，还是构建自己的存储过程和视图，这些技巧都将使您的工作变得更加轻松！

祝你好运！