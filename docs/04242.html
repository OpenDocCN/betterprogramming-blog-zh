<html>
<head>
<title>How to Parameterize Your Tests in a Declarative Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何以声明的方式参数化您的测试</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-parameterize-your-tests-in-a-declarative-way-64618bf7fbd9?source=collection_archive---------17-----------------------#2020-03-31">https://betterprogramming.pub/how-to-parameterize-your-tests-in-a-declarative-way-64618bf7fbd9?source=collection_archive---------17-----------------------#2020-03-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5c52" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">TDD和声明式编程是如何结合在一起的？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bf6b034d77e2f75f3a89e9ed51207728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwgXxsfRxRWBRjPe63t2zg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Jaz King 在<a class="ae ky" href="https://unsplash.com/s/photos/books?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="7770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为软件工程师，我们都同意测试是我们创建的每一个软件的一个非常重要的部分。我们编写测试的方法是一个完全不同的话题。我们中的一些人喜欢TDD，而另一些人通常在一个特性实现后编写测试。</p><p id="e162" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将只关注参数化测试，因为我相信这种编写测试的方式有时会更简单，可读性更好。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1c77" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">你将从这篇文章中得到什么？</h1><ul class=""><li id="1f80" class="mu mv it lb b lc mw lf mx li my lm mz lq na lu nb nc nd ne bi translated">简单看一下什么是声明式编程，什么不是。</li><li id="1aa1" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">如何用JavaScript编写参数化测试？</li><li id="c06d" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">确定使用这些测试的正确时间。</li><li id="6bff" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">编写参数化测试的利弊。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1cee" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">声明性—有什么大不了的？</h1><p id="47cb" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">当我开始在React中写作时，我说服自己使用声明性范式，但这有什么大不了的呢？</p><p id="38ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">声明性范式通常被比作命令性范式。在命令式编程中，我们关注的是如何实现我们的目标。另一方面，声明式编程更多的是关于我们想要达到的目标。泰勒·麦金尼斯在<a class="ae ky" href="https://tylermcginnis.com/imperative-vs-declarative-programming/" rel="noopener ugc nofollow" target="_blank">关于这个话题的文章</a>中提供了一个很好的例子:</p><blockquote class="nn no np"><p id="f1d1" class="kz la nq lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">“我就在沃尔玛旁边。从这里怎么去你家？”</p><p id="9480" class="kz la nq lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated"><strong class="lb iu">命令式响应</strong>:出停车场北口左转。沿15号州际公路向北行驶，直到您到达第12街出口。在出口处右转，就像去宜家一样。直走，在第一个红绿灯右转。继续穿过下一个红绿灯，然后在下一个路口左转。我的房子是298号。</p><p id="45db" class="kz la nq lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">陈述性回答:我的地址是犹他州艾登市西不变巷298号，邮编84310</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6ac2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何编写参数化测试</h1><p id="bf4d" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我已经用一些用JavaScript编写的样板代码准备好了<a class="ae ky" href="https://github.com/kwdowik/declarative-tests" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。首先，让我们看看当所有参数都在测试中指定时，测试将会是什么样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="1706" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些测试是以命令的方式编写的。在每次测试中，我都遵循相同的步骤:</p><ul class=""><li id="7cbb" class="mu mv it lb b lc ld lf lg li nw lm nx lq ny lu nb nc nd ne bi translated">创作一本书。</li><li id="bddf" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">检查这本书是否有效。</li><li id="b40b" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">将结果赋给一个变量。</li><li id="4200" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">检查结果是否和我们预期的一样。</li></ul><p id="f23f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看如何将每个测试中的参数从测试逻辑中分离出来:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="75b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，我们只留下了检查创建的图书是否有效的测试逻辑，但是所有参数都在不同的JSON文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们将参数移动到了不同的文件中，所以我们可以很容易地添加新的测试用例。</p><p id="1087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有很多允许我们编写参数化测试的库(例如<a class="ae ky" href="https://www.npmjs.com/package/jest-each" rel="noopener ugc nofollow" target="_blank"> jest-each </a> ) <em class="nq">。使用这个特殊的库非常容易。您可以通过数组的数组来指定测试用例，其中每个数组都是一个新的测试用例，数组中的每个元素都是测试函数的另一个参数:</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者使用模板字符串代替数组的数组:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="2ef2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种解决方案对于简单的情况似乎是完美的，但是对于更复杂的测试，我们需要注入一些服务或者存储库，最好使用一个JSON文件，在那里指定测试用例，因为分离和增加可读性。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5739" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">何时使用参数化测试</h1><h2 id="1f0c" class="nz md it bd me oa ob dn mi oc od dp mm li oe of mo lm og oh mq lq oi oj ms ok bi translated"><strong class="ak">使用</strong></h2><p id="1419" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">当然，要看情况。你没想到会有不同的答案，是吗？这类测试的最佳场景是一个测试有很多测试用例的情况——就像上面的例子，我们测试了某本书对不同数据的验证。另一个例子可以是一个存储库，在这里我们想要检查不同数据集的每个CRUD方法，以确保我们接触到每个案例。</p><h2 id="ff4e" class="nz md it bd me oa ob dn mi oc od dp mm li oe of mo lm og oh mq lq oi oj ms ok bi translated"><strong class="ak">不要使用</strong></h2><p id="cf05" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">另一方面，您不应该在测试一组数据的情况下使用参数化测试。将数据从测试中分离出来会有些矫枉过正。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4e6e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参数化测试的利与弊</h1><h2 id="9782" class="nz md it bd me oa ob dn mi oc od dp mm li oe of mo lm og oh mq lq oi oj ms ok bi translated"><strong class="ak">优点</strong></h2><ul class=""><li id="14ac" class="mu mv it lb b lc mw lf mx li my lm mz lq na lu nb nc nd ne bi translated">创建一次测试，然后只添加新的测试用例。</li><li id="a0c7" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">测试逻辑从测试用例中分离出来。</li><li id="6be6" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">包含测试用例的JSON文件可以很容易地与其他团队成员共享，而不用担心任何人会破坏您的测试。</li><li id="1043" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">使用JSON模式验证，测试可以与技术不太熟练的团队成员共享(例如，手工测试人员)。</li><li id="1f1a" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">他们遵循干燥原则。</li></ul><h2 id="8efd" class="nz md it bd me oa ob dn mi oc od dp mm li oe of mo lm og oh mq lq oi oj ms ok bi translated">骗局</h2><ul class=""><li id="da95" class="mu mv it lb b lc mw lf mx li my lm mz lq na lu nb nc nd ne bi translated">将测试逻辑从测试参数中分离出来需要额外的工作。</li><li id="3595" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">对只有几个病例要检查的测试来说是过度的。</li><li id="c7d2" class="mu mv it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">带有测试用例的附加文件(不需要)。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6b5f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="f267" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">本文的目的是说明在某些情况下，编写这些类型的测试可能是一种简单而干净的替代方法。这只是参数化测试和我的方法的一个简单例子。如果你想了解更多，我推荐<a class="ae ky" href="https://github.com/kwdowik/declarative-tests" rel="noopener ugc nofollow" target="_blank">查看我的库</a>以获得完整的应用程序。</p><p id="9533" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇短文实现了我在开始时的承诺。</p><p id="532f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="e969" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">推特:<a class="ae ky" href="https://twitter.com/k_wdowik" rel="noopener ugc nofollow" target="_blank"> <em class="nq"> k_wdowik </em> </a></p></div></div>    
</body>
</html>