<html>
<head>
<title>Why You Should Prefer Declarative API Designs Over Imperative?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么你更喜欢声明式API设计而不是命令式？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/why-you-should-prefer-declarative-api-designs-over-imperative-ddbc1192f9f6?source=collection_archive---------8-----------------------#2021-03-02">https://betterprogramming.pub/why-you-should-prefer-declarative-api-designs-over-imperative-ddbc1192f9f6?source=collection_archive---------8-----------------------#2021-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="115c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">React是声明性的。SQL也是声明性的。有共性吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/08aa5a36292da095bcc420704d1c1339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mOy3Q-Ts12CPCcF9.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者提供</p></figure><p id="66cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如今，我们的许多应用程序都围绕着API。例如，我们应用程序代码的许多核心都是通过API进行通信的。我们通过用可理解的抽象将应用分层来构建应用。这个抽象层是必不可少的，因为它帮助我们解决我们的软件是如何编写的及其问题。</p><p id="563f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">定义API有两种流行的方式——命令式和声明式。SQL是一种声明式查询语言，而IMS和CODASYL使用命令式代码查询数据库。最常用的编程语言是命令式。</p><p id="3520" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，在本文中，更广泛使用声明式API的一个重要原因是，与命令式API相比，它使用起来更简洁，并且提供了更好的抽象。</p><h1 id="55d3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">数据模型中的命令式声明</h1><p id="bbe2" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在有SQL之前，1960年，IBM设计了信息管理系统(IMS ),它有一个分层模型，叫做CODASYL，类似于文档数据库中使用的JSON模型。</p><p id="4f3d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个模型称为网络模型，它有助于为多对多关系创建一个数据模型。每个记录都有多个父记录，我们标记一个记录与另一个记录的关系的方法是在编程语言中使用指针而不是外键。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/349793b86857fc3d5640843b4687500c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gjeqtNtSnk8wGMJh.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:天然la的Codasyl型Schela通用医学记录</p></figure><p id="a4a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想得到一个特定链接的值，你必须从列表的头部开始遍历，一次查看一条记录，直到找到你想要的那条。</p><p id="3b13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种检索数据的方式使得开发人员很难进行任何更新或更改，因为他们必须跟踪所有的关系和链接的父链接，否则他们就无法找到他们想要的数据。</p><h1 id="11e1" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">关系模型数据查询有何不同</h1><p id="f575" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">关系模型使用不同的方式查询数据。我们，作为开发者，会告诉程序“<em class="ms">”做什么“</em>”，而不是“<em class="ms">如何</em>”去做。因此，查询优化器将自动决定以何种顺序执行查询的哪一部分以及使用哪些索引。</p><p id="82be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">告诉程序“做”什么，而不是“如何”做。</p><p id="8262" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">声明式方法的一个好处是，查询语言使用API抽象了客户机的实现细节。这可以为优化查询优化器留下空间，以产生更好的性能并引入更新的功能，而无需任何查询更改。</p><p id="6c7d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着越来越多的计算逻辑转向软件而不是硬件，SQL因其灵活性而变得更加流行和广泛使用。</p><p id="65db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看一下web浏览器中声明性API和命令性API的另一个类比和说明。</p><h1 id="cced" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">以Web服务为例</h1><p id="723a" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们举一个在web浏览器中使用声明式和命令式方法操作DOM元素的例子。</p><p id="2a7a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一般来说，使用CSS是声明性的，用JavaScript操作DOM元素是必须的。在下面的例子中，你可以看到为什么CSS比JavaScript更擅长在网上查询数据。</p><p id="45cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">更改HTML标签上的段落“逃脱的那个人”中文本的颜色，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7300" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用CSS，您的代码将如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="7ca9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相对简单，因为它声明了我们想要将文本的蓝色应用到的元素的模式。不在<code class="fe mv mw mx my b">class</code>名称<code class="fe mv mw mx my b">topClass</code>下的段落、<code class="fe mv mw mx my b">&lt;p&gt;</code>标签不会改变颜色，因为它与声明不匹配。</p><p id="1c30" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，使用JavaScript操作DOM元素将如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f372" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用JavaScript来操作DOM元素，我们必须告诉程序如何去做。它没有抽象地告诉程序我们想要的结果是什么。这段代码并不比CSS长多少，但也更难理解。新开发人员需要完全按照HTML页面的指示来理解该功能的意图。</p><p id="0b6c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我们必须跟踪我们在DOM节点上设置了什么，以及我们没有在DOM节点上放置什么。例如，如果用户转到下一页，我们需要手动知道如何将<code class="fe mv mw mx my b">color:blue</code>设置回黑色。而且，如果API发生了变化，比如新的函数，<code class="fe mv mw mx my b">getElementByTagNameV2</code>(我只是瞎编的)，客户端将需要重写函数，因为API与客户端的实现是紧密耦合的。</p><p id="ade0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，在定义API的声明方式中——我们可以优化浏览器性能，而无需客户更改他们编写的任何CSS标签。</p><p id="ad6a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们知道，在web浏览器中查询数据时，CSS比JavaScript更灵活，也更容易向后兼容。</p><h1 id="e81d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">在实践中</h1><p id="479f" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">最终，API的抽象程度越高，API的声明性就越强。所有的低级API都公开了你想要调用的动词，如果没有命令式API，我们就无法封装更高级别的抽象API。换句话说，需要存在一个命令式API来将API封装成声明式API。</p><p id="8217" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想让您的API更具声明性，请在API上放置config以进行进一步的抽象。通常，声明式API会通过在底层提供一些容错功能来抽象某些方面，因此您不必考虑这些。</p><p id="139e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设您想从队列中创建一个轮询值的抽象。你可以通过给一个函数<code class="fe mv mw mx my b">poll()</code>来提到轮询的机制。</p><p id="fb09" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在声明<code class="fe mv mw mx my b">poll()</code>的强制方式中，它只会做一件事——轮询。如果在这个过程中有一些网络问题或故障，它将抛出一个异常。</p><p id="9796" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">编写API的一种声明性方式是提及函数意图的配置。例如，如果您希望重试次数为2，并在失败时采取特定的操作。客户端需要考虑的任何特定的错误处理或功能都可以封装在一个配置值中，让API为您完成所有困难的工作。</p><h1 id="e4da" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">关闭</h1><p id="02aa" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们开始明白为什么声明式API比命令式API更容易理解和使用。首先，我们知道目前广泛使用的查询语言——SQL，以及它与前身CODASYL的比较。然后，我们看到查询web浏览器的声明性方式比命令性形式更容易。最后，理解用户的意图，并使用配置来抽象他们需要实现的所有逻辑，这是过渡到声明式API的一个很好的方法。</p></div></div>    
</body>
</html>