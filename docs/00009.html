<html>
<head>
<title>Running Python Script From C# and Working With the Results</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从C#运行Python脚本并处理结果</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/running-python-script-from-c-and-working-with-the-results-843e68d230e5?source=collection_archive---------1-----------------------#2016-11-24">https://betterprogramming.pub/running-python-script-from-c-and-working-with-the-results-843e68d230e5?source=collection_archive---------1-----------------------#2016-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d1a8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何根据动态条件修补参数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/4836d87a73a1ce8258b14ff64fbf2fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*FDMlDJyVv5A49EgAvYiukg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">Python的禅</p></figure><p id="97ec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在最近的一个项目中，我需要根据动态条件修补一些参数。我们有几个外部服务要调用，基于一些标识符，对于标识符#1012，我们需要从参数中删除每个“-”实例，然后用修补的参数调用外部服务；对于标识符#1013，我们需要在没有定义前缀的任何输入参数前添加“995”。</p><p id="65b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">项目写在。NET (C#)和修补部分是作为一些实用程序静态类方法完成的，它随着时间的推移而增长…主要问题是，对于任何附加条件，我必须添加实际的补丁，并将服务重新部署到活动服务器。我需要能够使用某种动态解释语言来编写补丁，这种语言可以更改/添加/删除补丁，而无需重新编译。净部分。我必须决定是使用PHP还是Python。</p><p id="a0ab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然我有一些编写PHP脚本的经验，但这对我来说并不舒服。Python的哲学/意识形态(见标题图片)如此契合，以至于Python被选中来完成这项任务。</p><p id="510a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于编程来说，至少有两种方法可以解决我们的问题。让我们通过一些示例实现细节来讨论几个解决方案:</p><ol class=""><li id="752b" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">使用安装了Python解释器的新进程调用Python脚本。</li><li id="ea7a" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">使用<a class="ae me" href="http://ironpython.net/" rel="noopener ugc nofollow" target="_blank"> IronPython </a>解释器调用Python脚本。NET应用程序。</li></ol><p id="93a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面的例子包含了更多的解释。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="fbb9" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">使用新流程初始化调用Python脚本。</h1><p id="125a" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">这里的主要思想是使用一个新初始化的进程调用脚本，并获得它的标准输出。这个方法需要一个外部Python解释器来实际执行脚本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用新流程初始化执行脚本的示例实现</p></figure><p id="d761" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请记住，当您运行这样的代码时，您需要考虑运行您的主应用程序的帐户的权限。例如，如果您想从托管在IIS上的web服务运行一个脚本——确保所有需要执行的脚本文件对运行web服务的<code class="fe nl nm nn no b">ApplicationPool</code>的用户具有正确的权限。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="03db" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">使用IronPython解释器调用Python脚本。NET应用程序。</h1><p id="3965" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">您可以将IronPython解释器放在您的。NET应用程序。例如，使用NuGet，您可以下载<a class="ae me" href="https://www.nuget.org/packages/IronPython" rel="noopener ugc nofollow" target="_blank">右包</a>，然后将脚本执行(实际上是IronPython引擎)嵌入到您的应用程序中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="3bca" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated"><strong class="ak">结论</strong></h1><p id="ac34" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">这里的主要区别是，第二种方法是完全托管的代码，因此您可以在应用程序中获得所有异常和对脚本执行的控制。对于第一种方法，您失去了对已启动流程内部的控制。当然，您可以使用标准输出和控制流程等待超时来查看异常，但是所有这些都是需要支持的额外代码。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="3180" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">资源</h1><div class="np nq gp gr nr ns"><a href="https://www.amazon.com/IronPython-Action-Michael-J-Foord/dp/1933988339/ref=sr_1_1?ie=UTF8&amp;qid=1480012639&amp;sr=8-1&amp;keywords=IronPython+in+Action" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">IronPython正在运行</h2><div class="nz l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.amazon.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ko ns"/></div></div></a></div><p id="7e9a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">特别感谢Giorgi Kardava关于IronPython的讨论和材料，以及一些例子和测试。</p><div class="np nq gp gr nr ns"><a href="https://github.com/gkardava" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">格卡尔达瓦(乔治卡尔达瓦)</h2><div class="og l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">gkardava有5个存储库可用。在GitHub上关注他们的代码。</h3></div><div class="nz l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="oh l oc od oe oa of ko ns"/></div></div></a></div></div></div>    
</body>
</html>