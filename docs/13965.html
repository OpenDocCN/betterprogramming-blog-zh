<html>
<head>
<title>Fast and Flexible CSV Parsing Using the Univocity Parsers Java Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Univocity解析器Java库快速灵活地解析CSV</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/fast-and-flexible-csv-parsing-using-univocity-parsers-java-library-94f765ac8e20?source=collection_archive---------5-----------------------#2022-10-20">https://betterprogramming.pub/fast-and-flexible-csv-parsing-using-univocity-parsers-java-library-94f765ac8e20?source=collection_archive---------5-----------------------#2022-10-20</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="951d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">Spring Boot演示项目中的大学解析器介绍</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/bfa1da429df3a9682e17bc819bb8ead2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J08BqVv-34yFoxQv"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@i_am_g?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Guillaume Jaillet </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1e5e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://github.com/uniVocity/univocity-parsers" rel="noopener ugc nofollow" target="_blank"> Univocity Parsers </a>是一个用Java编写的文件解析器库。它的性能令人难以置信，并为数据处理提供了一个方便的接口。据统计，它是最快的CSV解析器:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lw"><img src="../Images/4e7e3ab055178df81b7f22541ec51beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzqqwDcn5EX3GXjNUm_doA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来源于<a class="ae kz" href="https://github.com/uniVocity/csv-parsers-comparison" rel="noopener ugc nofollow" target="_blank">https://github.com/uniVocity/csv-parsers-comparison</a></p></figure><p id="b9c0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用一个库来代替构建自定义的解析器是很方便的。但是这个库也为开发新的解析器提供了一个坚实的框架。</p><p id="3add" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本教程中，我将向您展示如何使用Univocity解析器库从CSV文件中检索信息。我将用一个简单但实用的用例在Spring Boot项目中演示它的用法。</p><p id="6c4e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p><h1 id="68f5" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">演示项目</h1><p id="8d7a" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">作为开发人员，解析CSV文件并基于数据输出执行各种操作是一项常见的任务。让我们假设您在一个CSV文件中存储了几个服务配置属性。作为管理员用户，您希望通过REST端点检索服务数据。</p><p id="2f53" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下是流程概述:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mu"><img src="../Images/6bf66c716874f5dfb98f2af080d547d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*JmYXHq8gHYQ6-OCJx-fGEw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">演示应用流程概述</p></figure><h2 id="8214" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">添加依赖项</h2><p id="0d28" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">我通过<a class="ae kz" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank">https://start.spring.io/</a>创建了一个简单的Sprint Boot项目。让我们添加本演示的依赖项:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><h2 id="a71f" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">创建数据</h2><p id="0130" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">让我们用以下逗号分隔的记录创建一个名为<code class="fe nj nk nl nm b">data.csv</code>的文件:</p><pre class="kk kl km kn gu nn nm no np aw nq bi"><span id="3e42" class="mv ly iu nm b gz nr ns l nt nu">SERVICE_ID,SERVICE_NAME,SERVICE_CASE,SERVICE_CLIENT<br/>1,SERVICE1,TEST1,CLIENT1<br/>2,SERVICE2,TEST2,CLIENT2<br/>12,SERVICE12,TEST12,CLIENT21</span></pre><p id="1df1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个文件就像一个数据库，我们将查询它的信息。</p><p id="af6d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="nv">注意该库还可以解析不同格式的文件，例如TSV。</em></p><h2 id="dfe9" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">创建DTO类</h2><p id="8853" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">让我们创建一个保存数据的Java类。它看起来是这样的:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><ul class=""><li id="93a3" class="nw nx iu lc b ld le lg lh lj ny ln nz lr oa lv ob oc od oe bi translated"><code class="fe nj nk nl nm b">@Data</code> Lombok注释消除了样板代码(Getters、Setters等。).</li><li id="0d3c" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated">来自大学的<code class="fe nj nk nl nm b">@Parsed</code>注释类似于来自Java Persistence的<code class="fe nj nk nl nm b">@Column</code>注释。它对应于我们的CSV文件中的列名。</li></ul><h2 id="bda2" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">添加服务</h2><p id="8350" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">让我们添加一个服务来处理记录:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="60ba" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这类似于使用Spring JPA从数据库中查询数据。但是我们不想在每次收到请求时都读取CSV文件。该服务将充当缓存。</p><ul class=""><li id="7aa7" class="nw nx iu lc b ld le lg lh lj ny ln nz lr oa lv ob oc od oe bi translated">我们用CSV文件中的数据填充<code class="fe nj nk nl nm b">dataMap</code>。这是我们的储藏室。</li><li id="b94b" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated"><code class="fe nj nk nl nm b">@PostConstruct</code>注释保证bean将被完全初始化，我们可以使用必要的依赖项。</li><li id="6698" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated">方法从<code class="fe nj nk nl nm b">resources</code>文件夹中读取文件。</li><li id="4717" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated">我们为<code class="fe nj nk nl nm b"><a class="ae kz" href="http://docs.univocity.com/parser/html/2.1.0/com/univocity/parsers/csv/CsvParser.html" rel="noopener ugc nofollow" target="_blank">CsvParser</a></code>定义了一个<code class="fe nj nk nl nm b"><a class="ae kz" href="http://docs.univocity.com/parser/html/2.1.0/com/univocity/parsers/csv/CsvParserSettings.html" rel="noopener ugc nofollow" target="_blank">CsvParserSettings</a></code>配置类。</li><li id="c20b" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated">我们添加了一个<code class="fe nj nk nl nm b"><a class="ae kz" href="http://docs.univocity.com/parsers/2.7.2/index.html?com/univocity/parsers/common/processor/BeanProcessor.html" rel="noopener ugc nofollow" target="_blank">BeanListProcessor</a></code>,将解析后的输入生成的所有Java对象存储到一个列表中。这样，我们将使用<code class="fe nj nk nl nm b">Getters</code>轻松访问数据。</li><li id="6cc4" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated">注意，我们还指示<code class="fe nj nk nl nm b">CsvParserSettings</code>使用<code class="fe nj nk nl nm b">selectFields</code>方法选择特定字段。这意味着我们不会加载我们不需要的字段。这也加快了进程。</li><li id="fcc6" class="nw nx iu lc b ld of lg og lj oh ln oi lr oj lv ob oc od oe bi translated"><code class="fe nj nk nl nm b">getDataById</code>和<code class="fe nj nk nl nm b">getAllData</code>方法类似于JPA存储库方法。</li></ul><h2 id="2061" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">添加休息控制器</h2><p id="19f0" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">现在，让我们添加一个Rest控制器来检索数据:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="5c66" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将使用GET请求来相应地检索数据。</p><h2 id="ef93" class="mv ly iu bd lz mw mx dn md my mz dp mh lj na nb mj ln nc nd ml lr ne nf mn ng bi translated">测试应用程序</h2><p id="5f7f" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">考验的时候到了！</p><p id="d06b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在终端或浏览器中，执行以下GET请求:</p><pre class="kk kl km kn gu nn nm no np aw nq bi"><span id="4b4a" class="mv ly iu nm b gz nr ns l nt nu"><a class="ae kz" href="http://localhost:8080/getAll" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/getAll</a></span></pre><p id="9515" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您应该会看到这样的响应:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nh ni l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">服务响应</p></figure><p id="86a7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注意<code class="fe nj nk nl nm b">serviceClient</code>已经被忽略。</p><p id="7f34" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们尝试通过id来检索服务名:</p><pre class="kk kl km kn gu nn nm no np aw nq bi"><span id="3a06" class="mv ly iu nm b gz nr ns l nt nu">GET <a class="ae kz" href="http://localhost:8080/getServiceCaseById?id=2" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/getServiceCaseById?id=2</a></span></pre><p id="ad9b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">回应:</p><pre class="kk kl km kn gu nn nm no np aw nq bi"><span id="3ef9" class="mv ly iu nm b gz nr ns l nt nu">TEST2</span></pre><p id="83c4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">太好了！它像预期的那样工作。</p><h1 id="2e90" class="lx ly iu bd lz ma mb mc md me mf mg mh ka mi kb mj kd mk ke ml kg mm kh mn mo bi translated">结论</h1><p id="13bd" class="pw-post-body-paragraph la lb iu lc b ld mp jv lf lg mq jy li lj mr ll lm ln ms lp lq lr mt lt lu lv in bi translated">在本教程中，您学习了如何使用Univocity Parsers Java库读取CSV文件并轻松操作数据。</p><p id="4e8a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个库很健壮，提供了更多的选项，比如CSV编写、自定义解析器设置等。要了解所有支持功能的更多信息，请访问<a class="ae kz" href="https://github.com/uniVocity/univocity-parsers" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="8e2c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个演示的源代码可以在我的<a class="ae kz" href="https://github.com/kirshiyin89/univocity-parsers-spring-boot-demo" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。</p><p id="d8c6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你喜欢这篇文章，你可能也会喜欢我的另一篇Spring Boot/CSV相关的文章:</p><div class="ok ol gq gs om on"><a rel="noopener  ugc nofollow" target="_blank" href="/kafka-streams-how-to-process-a-csv-file-to-perform-calculations-173758da117d"><div class="oo ab fp"><div class="op ab oq cl cj or"><h2 class="bd iv gz z fq os fs ft ot fv fx it bi translated">Kafka Streams:如何处理CSV文件以执行计算</h2><div class="ou l"><h3 class="bd b gz z fq os fs ft ot fv fx dk translated">处理一个大的CSV文件，并根据历史天气记录计算日平均温度</h3></div><div class="ov l"><p class="bd b dl z fq os fs ft ot fv fx dk translated">better编程. pub</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb kt on"/></div></div></a></div><p id="6029" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，祝您编码愉快！</p></div></div>    
</body>
</html>