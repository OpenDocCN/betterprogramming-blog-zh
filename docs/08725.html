<html>
<head>
<title>Boolean Operators in Python Aren’t What You Think</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的布尔运算符不是你所想的那样</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/boolean-operators-in-python-arent-what-you-think-df45a2be71f1?source=collection_archive---------6-----------------------#2021-06-04">https://betterprogramming.pub/boolean-operators-in-python-arent-what-you-think-df45a2be71f1?source=collection_archive---------6-----------------------#2021-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a645" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这些小家伙并不像看上去那么简单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/87450c78d27b90a859d663935b989c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OY-s5AAw94_ouJ5j"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米切尔罗</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="9677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我认为自己是一个不错的Python程序员。我过去曾广泛使用过这种语言，它是我使用起来最舒服的一种语言。</p><p id="9ffd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，即使在我们舒适区的舒适范围内，时不时地，我们都会遇到令人兴奋的不熟悉的“哼”的时刻。最近，我有一个这样的时刻，它来自一个你可能最意想不到的地方:古老的布尔运算符。</p><p id="a262" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你看，在那之前，我一直认为表达式<code class="fe lv lw lx ly b">True and False</code>、<code class="fe lv lw lx ly b">"abc" and ""</code>和<code class="fe lv lw lx ly b">None or 0</code>的值都是<code class="fe lv lw lx ly b">False</code>，因为Python将<code class="fe lv lw lx ly b">False</code>、<code class="fe lv lw lx ly b">None</code>、空字符串、所有类型的数字0以及<a class="ae ky" href="https://docs.python.org/3/reference/expressions.html#boolean-operations" rel="noopener ugc nofollow" target="_blank">其他值</a>解释为false。</p><p id="2727" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么我不会这么想呢？毕竟，我们一直在使用<code class="fe lv lw lx ly b">if</code>语句，他们从未失望过。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="16d2" class="md me it ly b gy mf mg l mh mi">if 1 and 0:<br/>    print("You will never see this...")<br/>if 1 or 0:<br/>    print("But this you will see!")</span></pre><p id="9c57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很明显，<code class="fe lv lw lx ly b">1 and 0</code>相当于<code class="fe lv lw lx ly b">False</code>，<code class="fe lv lw lx ly b">1 or 0</code>相当于<code class="fe lv lw lx ly b">True</code>，对吧？</p><p id="da2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这里有一个问题:Python将某些非布尔值(如<code class="fe lv lw lx ly b">1</code>或<code class="fe lv lw lx ly b">""</code>)解释为<code class="fe lv lw lx ly b">True</code>或<code class="fe lv lw lx ly b">False</code>，当它们出现在布尔上下文中时(例如，当与布尔操作符结合使用时),这一事实与所述上下文的返回值无关。换句话说，<code class="fe lv lw lx ly b">val = True and 1</code>评估的是什么？</p><p id="e0bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是布尔运算返回最后一个求值的参数的值。在<code class="fe lv lw lx ly b">and</code>的情况下，一旦遇到非真值(在<code class="fe lv lw lx ly b">or</code>的情况下为真),表达式<a class="ae ky" href="https://en.m.wikipedia.org/wiki/Short-circuit_evaluation" rel="noopener ugc nofollow" target="_blank">就会短路</a>。否则，需要检查所有参数的真值。</p><p id="2393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以在上面的表达式中，<code class="fe lv lw lx ly b">1</code>将是最后一个被求值的参数，因此<code class="fe lv lw lx ly b">val</code>将得到值<code class="fe lv lw lx ly b">1</code>。</p><p id="e56e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里还有一些例子:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="0c76" class="md me it ly b gy mf mg l mh mi">val = False and True # val = False<br/>val = "abc" and "" # val = ""<br/>val = "" or "abc" # val = "abc"<br/>val = None or 0 # val = 0</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9f5e" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">这为什么有用？</h1><p id="a69f" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">知道了这一点，例如，可以利用这一行为在赋值期间执行简洁的空值检查:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="d118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种方法是明确检查<code class="fe lv lw lx ly b">person</code>是否是<code class="fe lv lw lx ly b">None</code>:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="266e" class="md me it ly b gy mf mg l mh mi">age = person.age if person else None</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0721" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">不是Python独有的</h1><p id="0730" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">事实上，Python并不是唯一有这种行为的编程语言，一些Redditors很快指出了这一点。特别是JavaScript，行为类似，甚至更进一步，提供了一个<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining" rel="noopener ugc nofollow" target="_blank">可选链接</a>操作符(<code class="fe lv lw lx ly b">?.</code>)。</p><p id="b564" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们已经将<code class="fe lv lw lx ly b">Person</code>类移植到JavaScript，这个操作符将允许我们执行:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="b48c" class="md me it ly b gy mf mg l mh mi">person = new Person(18)<br/>age = person?.age // age = 18</span><span id="a87a" class="md me it ly b gy no mg l mh mi">person = undefined<br/>age = person?.age // age = undefined</span><span id="5b20" class="md me it ly b gy no mg l mh mi">name = person?.name ?? "John Doe" // name = "John Doe" </span></pre><p id="7317" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，可以使用<code class="fe lv lw lx ly b">??</code>指定回退值。</p><p id="cd25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="np">注意:虽然根对象(在我们的例子中</em>、<em class="np"> </em> <code class="fe lv lw lx ly b"><em class="np">person</em></code> <em class="np">)可以是</em> <code class="fe lv lw lx ly b"><em class="np">None</em></code> <em class="np"> (Python)或者</em><code class="fe lv lw lx ly b"><em class="np">undefined</em></code><em class="np">/</em><code class="fe lv lw lx ly b"><em class="np">null</em></code><em class="np">(JavaScript)，但是必须声明。</em></p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="acd5" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">结论</h1><p id="6a11" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">我希望这个小花絮有用。分享你的想法，如果有任何问题，一定要让我知道。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d50a" class="mq me it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">资源</h1><ul class=""><li id="0e17" class="nq nr it lb b lc nh lf ni li ns lm nt lq nu lu nv nw nx ny bi translated"><a class="ae ky" href="https://docs.python.org/3/reference/expressions.html#boolean-operations" rel="noopener ugc nofollow" target="_blank">布尔运算| Python文档</a></li><li id="b349" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://en.m.wikipedia.org/wiki/Short-circuit_evaluation" rel="noopener ugc nofollow" target="_blank">短路评估|维基百科</a></li><li id="4a4c" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://www.reddit.com/r/ProgrammerTIL/comments/n6y76l/pythons_boolean_operators_do_not_return_boolean/" rel="noopener ugc nofollow" target="_blank"> Python的布尔运算符不返回布尔| Reddit </a></li><li id="c117" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining" rel="noopener ugc nofollow" target="_blank">可选链接(？。)| MDN网络文档</a></li></ul></div></div>    
</body>
</html>