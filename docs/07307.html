<html>
<head>
<title>How To Add Authentication to a Vue.js App Using Auth0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Auth0向Vue.js应用程序添加认证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-add-authentication-to-a-vue-app-using-auth0-4a2fa32df05c?source=collection_archive---------0-----------------------#2020-12-31">https://betterprogramming.pub/how-to-add-authentication-to-a-vue-app-using-auth0-4a2fa32df05c?source=collection_archive---------0-----------------------#2020-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cbdc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Auth0向您的Vue应用程序添加身份验证</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a57915e50323a4946f0b2c83f21e073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vbGOfM9OZMb3__Py"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@blankest?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">千斤顶T </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="330c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://auth0.com/" rel="noopener ugc nofollow" target="_blank"> Auth0 </a>是一个灵活的嵌入式解决方案，为您的应用程序添加认证和授权服务。了解添加到您的Vue应用程序有多简单，这样您就可以使用用户的电子邮件地址和密码来注册和登录用户。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f268" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们将创造什么</h1><p id="22d2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将使用Vue CLI创建一个非常简单的Vue应用程序。我们将修改默认的scaffolded应用程序，以便我们可以使用Auth0来注册新用户或登录现有用户。一旦用户登录，他们将有权查看“关于”页面。</p><p id="15e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户将能够使用Auth0中的电子邮件和密码认证系统向应用程序注册。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="273b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建我们的项目</h1><p id="1333" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我将使用Vue CLI为我们搭建一个项目。为此，您需要在系统上安装Vue CLI。如果没有安装，可以使用以下命令进行全局安装:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="17ba" class="ne md it na b gy nf ng l nh ni">npm install -g @vue/cli</span></pre><p id="603e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以使用Vue CLI来创建我们的项目。使用以下命令创建一个新项目:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="522f" class="ne md it na b gy nf ng l nh ni">vue create vue-authentication-auth0</span></pre><p id="1e6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将被要求选择一个预设。选取“手动选择功能”，然后选择“babel”、“Router”和“Linter / Formatter”</p><p id="915e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统会询问您是否要对路由器使用历史模式。选择“是”(应该是默认值)。</p><p id="7750" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以选择任何你想要的棉绒，但是对于本教程，我将选择“Eslint +更漂亮。”</p><p id="501a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Vue CLI完成后，它将为您提供一些命令，以切换到刚刚创建的新目录并启动服务器。遵循这些指示。一旦服务器启动，您就可以打开浏览器到localhost:8080。您应该看到这个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/d0a1eb5122966e17e23f7000e9b9b77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aULwhJQrKCD0RZ8t"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5be8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建Auth0帐户</h1><p id="21e2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你需要做的第一件事是<a class="ae ky" href="https://auth0.com/signup" rel="noopener ugc nofollow" target="_blank">用Auth0创建一个账户</a>，如果你还没有的话。创建帐户是免费的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="987d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建Auth0应用程序</h1><p id="358c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">创建免费的Auth0帐户后，请登录您的帐户。在左侧导航栏中，单击应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/d750ae17cad42f77852aed86634b7517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/0*dx-jheyJRHChE5ET"/></div></figure><p id="5154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，单击“创建应用程序”按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/d2533583c39075625af28e1ccbebc843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zXLpqqkLENVyAASt"/></div></div></figure><p id="3ee7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到一个对话框，让您为应用程序提供一个名称，并指定要创建的应用程序的类型。</p><p id="39d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的应用程序的名称是Vue身份验证Auth0。您可以为您的应用程序取任何您想要的名称。</p><p id="a471" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于应用程序类型，选择单页Web应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/37c3d8fe09337fd87c6e885891c0dd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*44vQOJ9golspep06"/></div></div></figure><p id="aae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建应用程序后，Quick Start选项卡将提供如何使用最流行的JavaScript框架在web应用程序中实现Auth0的说明。</p><p id="7741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们的应用程序使用Vue，所以单击Vue图标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/5e7b9ad3421b21a6a75cfb645a0f98f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jGC1dkmWfYbUhXQL"/></div></div></figure><p id="f640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Auth0就如何实现他们的身份验证即服务产品提供了非常详细的说明。对于本教程，我们将在我们已经创建的Vue应用程序中实现他们的指令。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4c44" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">配置应用程序设置</h1><p id="7b4a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您可以通过点击页面顶部的设置选项卡来访问您的设置。</p><p id="be06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将在基本信息下看到您的域名和客户端ID。我们稍后将回到这一点，因为我们将需要存储这些值以使我们的应用程序工作。</p><p id="0337" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在“应用程序URIs”部分，我们需要定义允许的回调URL、允许的注销URL和允许的web源。</p><p id="8eea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了本地测试我们的应用程序，我们将使用URL http://localhost:8080。</p><p id="85d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>如果您决定在某个地方托管您的应用程序，比如在<a class="ae ky" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>或<a class="ae ky" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>上，那么您将需要使用您托管的应用程序的URL来更新所有这些设置。</p><p id="421d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将strong &gt;允许的回拨URL、允许的注销URL和允许的Web源设置为http://localhost:8080。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/85a5edf5ac6cbc82f5ffb5df61b5915b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nX1DoL-RXVC1x4oD"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8db5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安装Auth0 SDK</h1><p id="e3ea" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">返回到您的Vue应用程序，使用以下命令添加Auth0 Client SDK:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="305b" class="ne md it na b gy nf ng l nh ni">npm install @auth0/auth0-spa-js</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c3a2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建身份验证包装</h1><p id="7221" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Auth0 SDK要求在Vue应用程序启动之前对其进行初始化。Vue有生命周期挂钩，我们可以用它来初始化SDK。你可能认为我们可以在<code class="fe np nq nr na b">App.vue</code>文件中使用一个<code class="fe np nq nr na b">beforeCreate</code>钩子，但是你错了。让我告诉你为什么。</p><p id="9849" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是Vue生命周期挂钩的图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/4b3e806a674d316266d7e38a3952a3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NuSvkkm1kohKVJbt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://vuejs.org/v2/guide/instance.html" rel="noopener ugc nofollow" target="_blank">https://vuejs.org/v2/guide/instance.html</a>提供</p></figure><p id="faff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr na b">beforeCreate</code>是第一个Vue生命周期挂钩。但是请注意，在该图像中，它是在使用<code class="fe np nq nr na b">new Vue()</code>创建Vue应用程序之后触发的。</p><p id="3e92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要能够在创建Vue应用程序的<code class="fe np nq nr na b">new Vue()</code>之前初始化Auth0 SDK。Vue提供了一种机制来用Vue插件做到这一点。</p><p id="c5d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用一个插件，你必须用<code class="fe np nq nr na b">Vue.use()</code>命令调用它。此命令必须在您通过调用<code class="fe np nq nr na b">new Vue()</code>启动应用程序之前完成。</p><p id="b472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建的认证包装器实际上将是一个Vue插件。</p><p id="4530" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe np nq nr na b">src</code>目录中，创建一个名为<code class="fe np nq nr na b">auth</code>的新目录。在auth目录中，创建一个名为<code class="fe np nq nr na b">index.js</code>文件。</p><p id="7f58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将复制快速启动选项卡中提供的代码，并将其粘贴到此文件中。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="987e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建配置文件</h1><p id="cce4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">传递给插件的options对象用于提供<code class="fe np nq nr na b">clientId</code>和<code class="fe np nq nr na b">domain</code>的值，我在前面提到过，并说我们稍后会用到。</p><p id="c805" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在应用程序的根目录下，创建一个名为<code class="fe np nq nr na b">auth_config.json</code>的新文件。我们将从您的应用程序中为<code class="fe np nq nr na b">domain</code>和<code class="fe np nq nr na b">clientId</code>填充值。将这段代码放入<code class="fe np nq nr na b">auth_config.json</code>文件，并确保用您的应用程序的值更新它。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a4e0" class="ne md it na b gy nf ng l nh ni">{ <br/>  "domain": "yourAppValuesHere", <br/>  "clientId": "yourAppValuesHere" <br/>}</span></pre><p id="bc0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此配置文件包含与您的Auth0应用程序相关的非敏感值。该文件不应提交给源代码管理。我们可以通过将文件名添加到<code class="fe np nq nr na b">.gitignore</code>文件中来实现。</p><p id="fffb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe np nq nr na b">.gitignore</code>文件，在文件中添加<code class="fe np nq nr na b">auth_config.json</code>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4640" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">向我们的Vue应用程序添加插件</h1><p id="bb85" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们已经创建了插件，我们需要告诉Vue使用它。打开<code class="fe np nq nr na b">main.js</code>文件。添加这两个导入语句，它们从<code class="fe np nq nr na b">auth_config.json</code>文件中导入我们的插件以及我们的<code class="fe np nq nr na b">domain</code>和<code class="fe np nq nr na b">clientId</code>。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="61d5" class="ne md it na b gy nf ng l nh ni">// Import the Auth0 configuration<br/>import { domain, clientId } from "../auth_config.json";</span><span id="4622" class="ne md it na b gy nv ng l nh ni">// Import the plugin here<br/>import { Auth0Plugin } from "./auth";</span></pre><p id="7854" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来我们需要告诉Vue使用我们的插件。在导入语句后，添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a01b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">登录应用程序</h1><p id="c161" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果你查看<code class="fe np nq nr na b">auth/index.js</code>文件中的插件代码，你会注意到提供了两种不同的登录方式:<code class="fe np nq nr na b">loginWithPopup</code>和<code class="fe np nq nr na b">loginWithRedirect</code>。</p><p id="5935" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Auth0提供了一个托管登录页面，任何应用程序都可以使用它来登录或注册用户。<code class="fe np nq nr na b">loginWithRedirect</code>方法将访问托管登录页面。这意味着，当用户单击登录按钮时，URL将变为指向Auth0网站，用户将在那里输入他们的登录详细信息。成功通过身份验证后，它们将被重定向回我们的应用程序。</p><p id="0667" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们不想做这个重定向，Auth0提供了通过弹出窗口登录或注册用户的选项，该弹出窗口显示在我们的网站上。</p><p id="5c5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将向您展示如何使用这两种登录方法。</p><p id="b805" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe np nq nr na b">App.vue</code> <strong class="lb iu"> </strong>文件。导航目前有两个条目，主页和关于页面。我们需要添加两个按钮来登录。将此代码添加到导航中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="11c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，按钮被包装在一个指令中，该指令确保<code class="fe np nq nr na b">$auth.loading</code>为假。如果你查看我们插件的代码，你会看到有一个数据段的值是<code class="fe np nq nr na b">isAuthenticated</code>。如果用户成功通过Auth0验证，则设置该值。如果用户已经过身份验证，那么我们不希望显示两个登录按钮。</p><p id="cc57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们添加div时，按钮出现在Home和About按钮链接下面的行中。我希望它们都在同一行上，所以将CSS样式更新为:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="59f9" class="ne md it na b gy nf ng l nh ni">#nav { <br/>  display: flex; <br/>  justify-content: center; <br/>  padding: 30px; <br/>} </span><span id="e311" class="ne md it na b gy nv ng l nh ni">#nav a { <br/>  font-weight: bold; <br/>  color: #2c3e50; <br/>  padding: 0 5px; <br/>}</span></pre><p id="d41a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当您查看应用程序时，您将看到两个按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/3f829f7d22178d9e31b050e131b2d244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LyHE1bybFhyso-Db"/></div></div></figure><p id="3d94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个按钮是调用方法<code class="fe np nq nr na b">login</code>和<code class="fe np nq nr na b">loginPopup</code>。让我们现在就实施它们。</p><p id="f9ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用两种方法添加一个<code class="fe np nq nr na b">methods</code>对象。代码如下:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="3ee5" class="ne md it na b gy nf ng l nh ni">methods: { <br/>  login() { <br/>    this.$auth.loginWithRedirect(); <br/>  }, <br/>  loginPopup() { <br/>    this.$auth.loginWithPopup(); <br/>  }, <br/>}</span></pre><p id="50c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr na b">this.$auth</code>是我们插件的一个句柄。然后我们调用插件中可用的方法。</p><p id="01b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在回到您的应用程序。如果您单击登录按钮，应该会转到Auth0的托管登录页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/48ba524b6515a51fc1ff4fb305ce8692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BopphiRqeQ3ReXlI"/></div></div></figure><p id="4afe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您单击登录弹出按钮，您将在您的应用程序中看到一个登录模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/404b49a1aee8b1ad90d212d7d09ffd3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e40CPdd19xjobDw-"/></div></div></figure><p id="9194" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论您选择哪一个，您都会看到您可以选择登录或注册。继续创建一个帐户。当您返回应用程序时，您会看到两个登录按钮都被隐藏了。它们是隐藏的，因为插件中的<code class="fe np nq nr na b">isAuthenticated</code>值现在是<code class="fe np nq nr na b">true</code>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="276c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">实施注销</h1><p id="5df2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">下一步是实现注销。打开<code class="fe np nq nr na b">App.vue</code>文件。像这样添加一个注销按钮:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c6c7" class="ne md it na b gy nf ng l nh ni">&lt;button @click="logout" v-if="$auth.isAuthenticated"&gt;<br/>  Logout<br/>&lt;/button&gt;</span></pre><p id="2b80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们有一个指令，只在用户当前通过身份验证时显示这个按钮。回到您的应用程序，您现在应该会看到Logout按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/6c9625adcca950acf3fdbe4ab91c5b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qp0QOUNUP-wz3iUn"/></div></div></figure><p id="a0d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加此方法以实现注销功能:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f5e9" class="ne md it na b gy nf ng l nh ni">logout() { <br/>  this.$auth.logout(); <br/>  this.$router.push({ path: '/' }); <br/>}</span></pre><p id="7e67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个方法中，我们调用插件中的注销函数。如果用户在一个只有经过身份验证的用户才能看到的页面上，我们会将用户重定向到主页。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e42c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">仅向经过身份验证的用户显示页面</h1><p id="90a1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">目前，我们的应用程序有一个主页和一个关于页面。我们不创建新页面，而是将About页面设置为只有用户登录时才可见。</p><p id="eae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果用户已经登录，我们只想在导航中显示“关于”页面。我们将使用与显示注销按钮相同的指令，并将它放在导航中的About页面上。将导航更新为:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b0a1" class="ne md it na b gy nf ng l nh ni">&lt;router-link v-if="$auth.isAuthenticated" to="/about"&gt;About&lt;/router-link&gt;</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e5de" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">添加路线守卫</h1><p id="945c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果用户当前没有被认证，我们已经隐藏了导航中的关于页面的链接。但是用户可以输入网址“/about”直接进入页面。这表明未经验证的用户可以访问该页面。避免这种情况的方法是使用路由保护。</p><p id="2470" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe np nq nr na b">auth</code>目录中，创建一个名为<code class="fe np nq nr na b">authGuard.js</code>的新文件。</p><p id="ff91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将以下代码添加到文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="91a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码检查用户当前是否已经过身份验证。如果不是，它将弹出Auth0托管的登录页面供用户登录。如果用户未能登录或无法成功登录，它会将用户从他们试图访问的具有路由保护的页面重定向出去。</p><p id="e46c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们在Vue路由器中实现这个路由保护。打开路由器目录中的<code class="fe np nq nr na b">index.js</code>文件。</p><p id="b405" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在文件的顶部，为我们刚刚创建的<code class="fe np nq nr na b">authGuard</code>文件添加一个导入:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="71a5" class="ne md it na b gy nf ng l nh ni">import { authGuard } from "../auth/authGuard";</span></pre><p id="bd4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要在/about路由中添加路由保护。将/about路由更新为:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f1ad" class="ne md it na b gy nf ng l nh ni">{ <br/>  path: '/about', <br/>  name: 'About', <br/>  component: () =&gt; import(/* webpackChunkName: "about" */ '../views/About.vue'), <br/>  beforeEnter: authGuard <br/>}</span></pre><p id="4f79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到您的应用程序。如果您当前没有通过身份验证，请登录到您的应用程序。您应该会在导航中看到About条目。现在从应用程序中注销。手动尝试去网址“<strong class="lb iu"> / </strong>了解一下。”您应该被重定向到Auth0托管的登录页面。</p><p id="5f2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！您已成功将Auth0身份验证添加到您的Vue应用程序中。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="af6c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">获取代码</h1><p id="d768" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我的GitHub账户里有完整的代码。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="889d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="5bc7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Auth0是一个身份验证即服务产品，您可以将其添加到您的应用程序中。它使得使用认证变得非常容易。</p><p id="49ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。感谢阅读。</p></div></div>    
</body>
</html>