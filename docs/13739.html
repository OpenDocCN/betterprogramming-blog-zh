<html>
<head>
<title>Create an Emoji Ball-drop Game With Matter.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Matter.js创建一个表情符号投球游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-an-emoji-ball-drop-game-with-matter-js-9ffb6b873f26?source=collection_archive---------10-----------------------#2022-09-21">https://betterprogramming.pub/create-an-emoji-ball-drop-game-with-matter-js-9ffb6b873f26?source=collection_archive---------10-----------------------#2022-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="637e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">把这些点连接起来</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e8d6c1844348bc9d91b01839578210a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29AEDG3TdJpPWeis7AMMwg.png"/></div></div></figure><p id="e271" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有时候，走出自己的舒适区，接手一些兼职项目是提高开发人员素质的好方法。你获得的技能越多，你能做的就越多。将来的某一天你可能会需要它们。</p><p id="1dc5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，我将向你展示如何用2D的网络物理引擎<a class="ae ln" href="https://brm.io/matter-js/" rel="noopener ugc nofollow" target="_blank"> Matter.js </a>创建一个简单的游戏。叫做<a class="ae ln" href="https://olivernguyen.io/w/emoji.drop/play.html" rel="noopener ugc nofollow" target="_blank">表情符号滴</a>。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="b523" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">用Vite启动一个新的TypeScript项目</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/0da6dcf3fc72ba272878a2dc12a13ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s42vMaFoPBF4jEmh.png"/></div></div></figure><p id="8428" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了快速进入项目，让我们使用<a class="ae ln" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> Vite </a>。它是现代web开发的工具，对TypeScript有很好的支持。</p><p id="c0d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它非常容易设置和使用。让我们用<code class="fe mo mp mq mr b">index.html</code>创建您的项目:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="7243" class="mw lw iq mr b gy mx my l mz na">&lt;!doctype html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;title&gt;Emoji Drop&lt;/title&gt;<br/>  &lt;script type="module" src="index.mts"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;canvas id="canvas"&gt;&lt;/canvas&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="356d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">和<code class="fe mo mp mq mr b">index.mts</code>:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="8414" class="mw lw iq mr b gy mx my l mz na">import Matter from 'matter-js'</span><span id="4f4b" class="mw lw iq mr b gy nb my l mz na">const {Bodies, Composite, Engine, Render, Runner, Svg} = Matter;</span><span id="7de7" class="mw lw iq mr b gy nb my l mz na">console.log('Hello, Matter.js!');</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/72359958315487f366e3ae6abfaddf35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcHzFN8jL7vvQA_8W3RoNw.png"/></div></div></figure><p id="76da" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后运行这些命令:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="2b87" class="mw lw iq mr b gy mx my l mz na">yarn init<br/>yarn add vite matter-js<br/>yarn vite</span></pre><p id="bdb0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">转到<code class="fe mo mp mq mr b">localhost:5137</code>，你应该会在控制台中看到这条消息。就是这样！现在您已经有了一个项目，它可以实时重载、npm包支持、TypeScript类型检查等等。(<a class="ae ln" href="https://github.com/iOliverN/emoji.drop/commit/6b58ebf5c6309a76ff28f9cfb6a811981f42bd64" rel="noopener ugc nofollow" target="_blank">代码</a>)</p><p id="da0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于生产构建，运行<code class="fe mo mp mq mr b">yarn vite build</code>。</p><h1 id="2806" class="lv lw iq bd lx ly nc ma mb mc nd me mf jw ne jx mh jz nf ka mj kc ng kd ml mm bi translated">Matter.js入门</h1><p id="9e97" class="pw-post-body-paragraph kr ks iq kt b ku nh jr kw kx ni ju kz la nj lc ld le nk lg lh li nl lk ll lm ij bi translated"><code class="fe mo mp mq mr b"><a class="ae ln" href="https://brm.io/matter-js/" rel="noopener ugc nofollow" target="_blank">Matter.js</a></code>是一个为网络创建2D物理引擎的伟大的库。它很容易使用，而且有很多功能。你可以用它在几分钟内创建一个简单的游戏。</p><p id="1dff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在让我们用一些身体创建一个<code class="fe mo mp mq mr b">Matter.js</code>世界:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="0c10" class="mw lw iq mr b gy mx my l mz na">import Matter from 'matter-js'</span><span id="7127" class="mw lw iq mr b gy nb my l mz na">const {Bodies, Composite, Engine, Render, Runner, Svg} = Matter;</span><span id="946a" class="mw lw iq mr b gy nb my l mz na">const canvas = document.getElementById('canvas') as HTMLCanvasElement<br/>canvas.width = 791;<br/>canvas.height = 500;</span><span id="1c6c" class="mw lw iq mr b gy nb my l mz na">const engine = Engine.create();</span><span id="7f22" class="mw lw iq mr b gy nb my l mz na">const render = Render.create({<br/>  engine: engine,<br/>  canvas: canvas,<br/>  options: {<br/>    width: 791,<br/>    height: 500,<br/>    wireframes: false<br/>  }<br/>});</span><span id="eac0" class="mw lw iq mr b gy nb my l mz na">const ground = Bodies.rectangle(395, 505, 791, 10, {isStatic: true});<br/>const leftWall = Bodies.rectangle(-11, 0, 10, 1000, {isStatic: true});<br/>const rightWall = Bodies.rectangle(792, 0, 10, 1000, {isStatic: true});</span><span id="2027" class="mw lw iq mr b gy nb my l mz na">Composite.add(engine.world, [ground, leftWall, rightWall]);</span><span id="d27e" class="mw lw iq mr b gy nb my l mz na">Render.run(render);<br/>const runner = Runner.create();<br/>Runner.run(runner, engine);</span><span id="bb76" class="mw lw iq mr b gy nb my l mz na">for (let i = 0; i &lt; 10; i++) {<br/>  setTimeout(() =&gt; {<br/>    const body = Bodies.rectangle(350 + i, 0, 40, 40);<br/>    Composite.add(engine.world, [body]);<br/>  }, i * 500)<br/>}</span></pre><p id="1174" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">只需几行代码，您就可以准备好一个Matter.js项目:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/67f170661bcd554ef07c09bda1c1ed4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aKnK-vIruxiJniF-IMZFaw.gif"/></div></div></figure><p id="b90a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在是时候给这个世界增加一些球和障碍了。我将此作为读者的一个练习。你可以用<code class="fe mo mp mq mr b"><a class="ae ln" href="https://brm.io/matter-js/docs/classes/Bodies.html#method_circle" rel="noopener ugc nofollow" target="_blank">Bodies.cirle()</a></code>把它们放到世界里。(<a class="ae ln" href="https://github.com/iOliverN/emoji.drop/commit/7875f1b8d5f481108968c3b3f6781141f29eff36" rel="noopener ugc nofollow" target="_blank">代码</a>)</p><h1 id="1b72" class="lv lw iq bd lx ly nc ma mb mc nd me mf jw ne jx mh jz nf ka mj kc ng kd ml mm bi translated">加载SVG图像</h1><p id="111c" class="pw-post-body-paragraph kr ks iq kt b ku nh jr kw kx ni ju kz la nj lc ld le nk lg lh li nl lk ll lm ij bi translated">让我们用心形图标作为我们的球。</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="80ea" class="mw lw iq mr b gy mx my l mz na">const heartPath = document.getElementById('path-heart');<br/>const heartVertices = Svg.pathToVertices(heartPath, 1)</span><span id="2a51" class="mw lw iq mr b gy nb my l mz na">const heartBall = Bodies.fromVertices(<br/>  random(300, 491), 0,<br/>  [heartVertices],<br/>  {<br/>    restitution: random(0.5, 0.9),<br/>    render: {<br/>      sprite: {<br/>        texture: "heart.png",<br/>        xScale: 1,<br/>        yScale: 1<br/>      }<br/>    }<br/>  }<br/>);</span><span id="0cbd" class="mw lw iq mr b gy nb my l mz na">function random(a: number, b: number) {<br/>  return Math.random() * (b - a) + a;<br/>}</span></pre><p id="e7b4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这有两个部分:心形和心形纹理。</p><ol class=""><li id="4ed1" class="nn no iq kt b ku kv kx ky la np le nq li nr lm ns nt nu nv bi translated">心形是一个SVG路径。要将其添加到世界中，我们需要将其转换为顶点。</li></ol><ul class=""><li id="dc4a" class="nn no iq kt b ku kv kx ky la np le nq li nr lm nw nt nu nv bi translated">将svg路径放在HTML中。用<code class="fe mo mp mq mr b">document.getElementById()</code>取回。</li><li id="f66d" class="nn no iq kt b ku nx kx ny la nz le oa li ob lm nw nt nu nv bi translated">使用<code class="fe mo mp mq mr b">Svg.pathToVertices()</code>将其转换为顶点。</li><li id="198f" class="nn no iq kt b ku nx kx ny la nz le oa li ob lm nw nt nu nv bi translated">并使用<code class="fe mo mp mq mr b">Bodies.fromVertices()</code>创建一个Matter.js体。</li><li id="40f3" class="nn no iq kt b ku nx kx ny la nz le oa li ob lm nw nt nu nv bi translated">您需要在项目中包含<a class="ae ln" href="https://www.npmjs.com/package/pathseg" rel="noopener ugc nofollow" target="_blank"> pathseg.js </a>来使<code class="fe mo mp mq mr b">Svg.pathToVertices()</code>工作。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/72cc18ecafc56aa65c1e9223d1d2f0da.png" data-original-src="https://miro.medium.com/v2/resize:fit:180/format:webp/0*j0IrerN20smVjDaM.png"/></div></figure><p id="d06f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.心脏纹理是png图像。我们可以用它作为<code class="fe mo mp mq mr b">render.sprite.texture</code>身体的精灵。</p><p id="48f7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这一步，游戏应该看起来如下:(<a class="ae ln" href="https://github.com/iOliverN/emoji.drop/commit/792228815bca48c5cb934f8e4cfc81f17b3e6c8b" rel="noopener ugc nofollow" target="_blank">代码</a>)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/64db1a44187d773ffe8062f0f014f624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Af8dBJPU_cGXKEWCVfWdnw.gif"/></div></div></figure><h1 id="b981" class="lv lw iq bd lx ly nc ma mb mc nd me mf jw ne jx mh jz nf ka mj kc ng kd ml mm bi translated">得分</h1><p id="d0eb" class="pw-post-body-paragraph kr ks iq kt b ku nh jr kw kx ni ju kz la nj lc ld le nk lg lh li nl lk ll lm ij bi translated">为了得到一个球的分数，让我们等待球停下来，然后从x位置计算分数。</p><p id="3280" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="od">我们怎么知道球什么时候停？</em></p><p id="addb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有<code class="fe mo mp mq mr b">Body.velocity</code>、<code class="fe mo mp mq mr b">Body.speed</code>、<code class="fe mo mp mq mr b">Body.angularSpeed</code>。等他们足够小了再算分数。</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="fc99" class="mw lw iq mr b gy mx my l mz na">const didBallStop = (body: Matter.Body) =&gt; {<br/>  const {speed, angularSpeed} = body;<br/>  return speed &lt; 0.1 &amp;&amp; angularSpeed &lt; 0.1;<br/>}</span></pre></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="5923" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">恭喜你！你已经用<a class="ae ln" href="https://brm.io/matter-js" rel="noopener ugc nofollow" target="_blank"> Matter.js </a>创建了一个简单的游戏。享受你的工作！参见示例<a class="ae ln" href="https://olivernguyen.io/w/emoji.drop/sample.html" rel="noopener ugc nofollow" target="_blank">此处</a>与<a class="ae ln" href="https://github.com/iOliverN/emoji.drop" rel="noopener ugc nofollow" target="_blank">源代码</a> <em class="od">。</em></p><p id="0103" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我还创建了一个Twitter版本。在此尝试:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="2306" class="mw lw iq mr b gy mx my l mz na"><strong class="mr ir">Want to Connect?</strong></span><span id="37a2" class="mw lw iq mr b gy nb my l mz na">I’m <a class="ae ln" href="https://olivernguyen.io/" rel="noopener ugc nofollow" target="_blank">Oliver Nguyen</a>. I share about programming, JavaScript, and Go. I created <a class="ae ln" href="https://onesidebar.com/" rel="noopener ugc nofollow" target="_blank">OneSidebar</a> — a browser extension for navigating GitHub. Follow me for more content.</span></pre></div></div>    
</body>
</html>