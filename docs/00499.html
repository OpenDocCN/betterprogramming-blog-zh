<html>
<head>
<title>Incorporating Apple Maps with Autocomplete in a React Native Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React原生应用程序中整合苹果地图和自动完成功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/incorporating-apple-maps-with-autocomplete-in-a-react-native-application-31b56befef3?source=collection_archive---------3-----------------------#2019-06-01">https://betterprogramming.pub/incorporating-apple-maps-with-autocomplete-in-a-react-native-application-31b56befef3?source=collection_archive---------3-----------------------#2019-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="431b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何找到你在哪里，你要去哪里</h2></div><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gh gi gj"><img src="../Images/aa780ceb488237951a3fd0c8b17e1f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NUFmYFAPYYxIAcnDvb_VA.png"/></div></div></figure><p id="5415" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">地图做了一件很棒的工作，以可视化的方式给用户一种感觉，让他们知道自己在哪里，下一步想去哪里。通常情况下，提供定位服务的应用程序会在屏幕上显示地图，让用户获得更具互动性的体验。要在React Native开发的iOS应用程序中为您自己的用户提供相同的体验，请遵循以下步骤！</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="229a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">步骤1:安装工具</h1><p id="801c" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">本教程将使用Xcode项目的CocoaPods包管理器。要安装CocoaPods，请运行:</p><p id="f297" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><code class="fe mq mr ms mt b">sudo gem install cocoapods</code></p><h1 id="1608" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">步骤2:安装地图库</h1><p id="6fd8" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">在您的终端中，导航到您的项目目录并运行以下命令:</p><p id="cff0" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><code class="fe mq mr ms mt b">npm install react-native-maps --save</code></p><p id="f1c4" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这将允许您在应用程序中使用React原生地图，如果需要的话，还支持Google Maps。</p><h1 id="72bd" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">步骤3:创建pod文件并安装pod</h1><p id="21f3" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">Podfile允许您轻松地列出并安装您希望在项目中使用的不同依赖项，类似于Ruby中的Gemfile。在React本地项目的<code class="fe mq mr ms mt b">ios/</code>文件夹中创建一个Podfile，并使用下面的示例开始:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="91f8" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">一旦用正确的依赖项创建了Podfile，用您的项目名替换<code class="fe mq mr ms mt b">_YOUR_PROJECT_TARGET_</code>,回到您的终端，导航到您的项目的iOS目录(您创建Podfile的地方),运行命令<code class="fe mq mr ms mt b">pod install</code>。</p><p id="84a4" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这个命令将安装所有的pods并创建一个新的<code class="fe mq mr ms mt b">.xcworkspace</code>文件，您可以使用它在Xcode中构建您的项目。或者，通过移回根目录并运行<code class="fe mq mr ms mt b">cd ..</code>导航回根目录并运行<code class="fe mq mr ms mt b">react-native run-ios</code>运行应用程序来开始构建。</p><h1 id="867d" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">步骤4:添加地图</h1><p id="b302" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">添加完所有依赖项后，我们就可以为您的应用程序添加地图了！将以下导入语句添加到地图组件的顶部:</p><pre class="kf kg kh ki gt nb mt nc nd aw ne bi"><span id="6b7b" class="nf lu iq mt b gy ng nh l ni nj">import MapView from 'react-native-maps';</span></pre><p id="7efe" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">将以下代码片段添加到渲染方法中，以显示具有固定初始位置的地图:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c7f8" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">你可能会注意到你的地图不见了。这与样式有关，所以继续添加这些静态样式，以便在包装容器的视图中使用:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="031a" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这些样式将使您在屏幕顶部加入自动完成组件。如果在您的用例中不需要它，您可以在这里停下来，将您的样式组件简化为:</p><pre class="kf kg kh ki gt nb mt nc nd aw ne bi"><span id="bd8d" class="nf lu iq mt b gy ng nh l ni nj">const styles = StyleSheet.create({<br/>  map: {<br/>    ...StyleSheet.absoluteFillObject,<br/>  },<br/>});</span></pre><p id="64fb" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">您可能希望允许显示的位置发生变化。在状态中维护地图坐标将允许您灵活地执行以下操作:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0c32" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在整合了这些零碎的东西之后，您的组件看起来将非常像这样:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="18c7" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">希望您的地图加载成功并导航到旧金山的一个区域！</p><h1 id="3ca0" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">第五步:添加标记</h1><p id="c641" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">标记使用户可以直观地精确定位他们在地图上的位置。您可能已经注意到，我们当前的地图不包括这样的功能，所以让我们继续添加一个。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="cfef" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">步骤6:安装地点自动完成</h1><p id="e0b1" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">为了让用户与地图更紧密地交互，我们希望使用一个自动完成功能，该功能获取一个地址，并将其转换为在地图上呈现该地址所需的坐标。安装<code class="fe mq mr ms mt b">react-native-google-places-autocomplete</code>将使这种集成更加容易。</p><p id="9990" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">要安装，导航回您的终端并在您的项目的根目录下运行:<code class="fe mq mr ms mt b">npm install react-native-google-places-autocomplete --save</code>。</p><h1 id="f88c" class="lt lu iq bd lv lw mu ly lz ma mv mc md jw mw jx mf jz mx ka mh kc my kd mj mk bi translated">步骤7:添加自动完成组件</h1><p id="8e97" class="pw-post-body-paragraph kq kr iq ks b kt ml jr kv kw mm ju ky kz mn lb lc ld mo lf lg lh mp lj lk ll ij bi translated">现在我们已经安装了React Native Places Autocomplete，让我们将它添加到地图中。</p><p id="02ec" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">将以下内容添加到组件中:</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="ed7a" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">确保获取您的<a class="ae nk" href="https://developers.google.com/places/web-service/get-api-key" rel="noopener ugc nofollow" target="_blank"> Google Places API键</a>，并将其添加到组件的<code class="fe mq mr ms mt b">query</code>参数中。</p><p id="5f38" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">您将会注意到模拟器屏幕顶部有一个输入框——继续并开始键入地址，然后观察将会根据您的输入生成的建议！上面的实现不处理地址选择，但是添加onPress方法将允许您获取所选的地址，并将其作为参数传递给呈现地图的MapView。这一调整将允许您看到地图上呈现的所选地址。</p><p id="40e9" class="pw-post-body-paragraph kq kr iq ks b kt ku jr kv kw kx ju ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这就是将苹果地图整合到您的应用程序中所需要的一切！</p></div></div>    
</body>
</html>