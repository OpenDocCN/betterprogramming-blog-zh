<html>
<head>
<title>How to Fix Greyed Icons on iOS Document Browser and Picker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何修复iOS文档浏览器和选择器上的灰色图标</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-fix-greyed-icons-on-ios-document-browser-and-picker-8dea8a76d6e7?source=collection_archive---------5-----------------------#2020-10-06">https://betterprogramming.pub/how-to-fix-greyed-icons-on-ios-document-browser-and-picker-8dea8a76d6e7?source=collection_archive---------5-----------------------#2020-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="de27" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">UIDocumentBrowserViewController支持的统一类型标识符的正确配置</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/15cfad6ea05c64c3208dd6384fbf8340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0atJRZt46DshAKAN_SaNxw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="1263" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可能知道，安装在iOS上的应用程序，出于安全原因，被限制在应用程序沙箱中。这意味着从iOS应用程序中，您只能访问应用程序本身生成的文件或包含在应用程序文件夹中的文件。</p><p id="9ecf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了帮助开发人员，UIKit在iOS上提供了两个标准的UI解决方案，以访问来自app文件夹和云提供商的文件:</p><ul class=""><li id="ae70" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/uidocumentbrowserviewcontroller" rel="noopener ugc nofollow" target="_blank">UIDocumentBrowserViewController</a>是苹果标准视图控制器，用于管理iOS上的文档，浏览云资源并对其执行操作。</li><li id="ced5" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/uidocumentpickerviewcontroller" rel="noopener ugc nofollow" target="_blank">UIDocumentPickerViewController</a>是标准视图，设计用于导入、导出、打开或移动文件。</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="fd82" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">文档和教程</h1><p id="fe32" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">Apple已经提供了很好的使用示例，我建议您阅读官方文档来了解如何使用它们:</p><p id="380d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">UIDocumentBrowserViewController</strong></p><ul class=""><li id="5368" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/adding_a_document_browser_to_your_app" rel="noopener ugc nofollow" target="_blank">向您的应用添加文档浏览器</a></li><li id="eba8" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/adding_a_document_browser_to_your_app/setting_up_a_document_browser_app" rel="noopener ugc nofollow" target="_blank">设置文档浏览器应用</a></li><li id="a9ce" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/adding_a_document_browser_to_your_app/presenting_selected_documents" rel="noopener ugc nofollow" target="_blank">展示所选文件</a></li><li id="6417" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/adding_a_document_browser_to_your_app/enabling_document_sharing" rel="noopener ugc nofollow" target="_blank">启用文档共享</a></li><li id="7f55" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/building_a_document_browser_app_for_custom_file_formats" rel="noopener ugc nofollow" target="_blank">为自定义文件格式构建文档浏览器应用</a></li></ul><p id="5603" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">UIDocumentPickerViewController</strong></p><ul class=""><li id="e4dd" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><a class="ae ma" href="https://developer.apple.com/documentation/uikit/view_controllers/providing_access_to_directories" rel="noopener ugc nofollow" target="_blank">提供对目录的访问</a></li></ul><p id="f208" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> WWDC </strong></p><p id="1411" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ma" href="https://developer.apple.com/videos/play/wwdc2018/216/" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/videos/play/wwdc2018/216/</a></p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="7fd5" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">我的用例:GPX轨迹浏览器</h1><p id="373f" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">UIDocumentBrowserViewController的经典用例是作为特定文件类型的查看器。</p><p id="0ccf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，我用它构建了一个名为<a class="ae ma" href="https://apps.apple.com/us/app/id1465569363" rel="noopener ugc nofollow" target="_blank"> Trackyzer Pro </a>的应用程序，这是一个GPX浏览器，为骑自行车的人提供丰富的坡度、速度和海拔数据图形。该应用程序可以将训练另存为GPX，或者使用文档浏览器打开任何带有曲目的GPX文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/53f2e7e73c059d1c8a3781e12dc84177.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8uWKBaMT0gCLWbp3UOWRGA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">track yzer Pro-GPX可视化工具</p></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="bb18" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">灰色图标</h1><p id="c55c" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">我按照苹果公司提供的最佳实践和教程开发了我的应用程序，一切似乎都是正确的，直到我把我的应用程序安装在一个真实的设备上。</p><p id="b68f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，大多数骑自行车的人有不止一个应用程序来导入GPX文件，结果是在某些情况下，应用程序内的文件浏览器显示灰色图标。</p><p id="7ccd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦图标在文档浏览器中变灰，用户就无法从应用程序中打开任何文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ac15c5a3b175ede37f047bd9195599af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWMZarQ-Rtivb8kPIISIDw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="a88d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">深入探讨一下我在支持博客上看到的<a class="ae ma" href="https://developer.apple.com/forums/thread/118932" rel="noopener ugc nofollow" target="_blank">这篇文章</a>:</p><blockquote class="nl nm nn"><p id="bc94" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">我们知道您在类型定义方面存在问题。gpx文件。目前，还没有公认的统一类型标识符。gpx文件和不同的开发者已经定义了他们的。gpx声明不同。这意味着，如果两个应用程序安装在同一台设备上，声称可以打开不同定义的文件，它们将无法正确交互:从用户的角度来看，这些应用程序中只有一个看似随机选择的应用程序能够打开这些文件。”</p></blockquote><p id="9e99" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GPX格式在这里被定义为<a class="ae ma" href="https://www.topografix.com/gpx_manual.asp" rel="noopener ugc nofollow" target="_blank"/>，它是一个XML文本文件。所以在不同的条件下，根据用户安装的应用程序，iOS可能会将其显示为文本图标、XML图标或自定义图标。</p><p id="3815" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个问题似乎没有解决办法，但我找到了一个。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="33ec" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">什么是统一类型标识符？</h1><p id="205f" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">根据苹果<a class="ae ma" href="https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_conc/understand_utis_conc.html#//apple_ref/doc/uid/TP40001319-CH202-SW1" rel="noopener ugc nofollow" target="_blank">官方文档</a>，一个统一的类型标识符:</p><blockquote class="nl nm nn"><p id="25a7" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">是唯一标识被认为具有“类型”的一类实体的字符串。例如，对于文件或其他字节流，“类型”是指数据的格式。对于包和包之类的实体，“类型”是指目录层次结构的内部结构。</p><p id="0f21" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">最常见的情况是，UTI为所有应用程序和服务都可以识别和依赖的数据提供一致的标识符，从而无需跟踪所有现有的数据标记方法。"</p></blockquote><p id="3598" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<code class="fe ns nt nu nv b">Info.plist</code>中声明的GPX UTI的例子:</p><pre class="kg kh ki kj gt nw nv nx ny aw nz bi"><span id="23c6" class="oa mo iq nv b gy ob oc l od oe"><strong class="nv ir">&lt;dict&gt;<br/> &lt;key&gt;</strong>UTTypeConformsTo<strong class="nv ir">&lt;/key&gt;<br/> &lt;array&gt;<br/>  &lt;string&gt;</strong>public.content<strong class="nv ir">&lt;/string&gt;<br/>  &lt;string&gt;</strong>public.data<strong class="nv ir">&lt;/string&gt;<br/>  &lt;string&gt;</strong>public.xml<strong class="nv ir">&lt;/string&gt;<br/> &lt;/array&gt;<br/> &lt;key&gt;</strong>UTTypeDescription<strong class="nv ir">&lt;/key&gt;<br/> &lt;string&gt;</strong>GPS Exchange Format (GPX)<strong class="nv ir">&lt;/string<br/> &lt;key&gt;</strong>UTTypeIconFiles<strong class="nv ir">&lt;/key&gt;<br/> &lt;array&gt;<br/> &lt;string&gt;</strong>GPX.icns<strong class="nv ir">&lt;/string&gt;<br/> &lt;/array&gt;<br/> &lt;key&gt;</strong>UTTypeIdentifier<strong class="nv ir">&lt;/key&gt;<br/> &lt;string&gt;</strong>com.topografix.gpx<strong class="nv ir">&lt;/string&gt;<br/> &lt;key&gt;</strong>UTTypeReferenceURL<strong class="nv ir">&lt;/key<br/> &lt;string&gt;</strong>http://www.topografix.com/GPX/1/1<strong class="nv ir">&lt;/string&gt;<br/> &lt;key&gt;</strong>UTTypeTagSpecification<strong class="nv ir">&lt;/key&gt;<br/> &lt;dict&gt;<br/> &lt;key&gt;</strong>public.filename-extension<strong class="nv ir">&lt;/key&gt;<br/> &lt;array&gt;<br/> &lt;string&gt;</strong>gpx<strong class="nv ir">&lt;/string&gt;<br/> &lt;/array&gt;<br/> &lt;key&gt;</strong>public.mime-type<strong class="nv ir">&lt;/key&gt;<br/> &lt;array&gt;<br/> &lt;string&gt;</strong>application/gpx+xml<strong class="nv ir">&lt;/string&gt;<br/> &lt;/array&gt;<br/> &lt;/dict&gt;<br/>&lt;/dict&gt;</strong></span></pre><p id="195d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这基本上说明了GPX文件可以是:</p><ul class=""><li id="08b1" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">扩展名为<code class="fe ns nt nu nv b">.gpx</code>的文件</li><li id="a59c" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated">一个哑剧类型<code class="fe ns nt nu nv b">application/gpx+xml</code></li><li id="4127" class="lr ls iq kx b ky mb lb mc le md li me lm mf lq lw lx ly lz bi translated">符合<code class="fe ns nt nu nv b">public.xml, public.text, public.data</code>的文件，引用url如下:<code class="fe ns nt nu nv b"><a class="ae ma" href="http://www.topografix.com/GPX/1/1" rel="noopener ugc nofollow" target="_blank">http://www.topografix.com/GPX/1/1</a></code></li></ul><p id="7edc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是任何人都可以定义自己的UTI。通过这种方式，没有简单的方法来获取应用程序的类型所有者。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="3aaa" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">我如何知道另一个应用程序是否正在使用我的UTI？</h1><p id="48b2" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">Apple提供了一个函数来获取类型<a class="ae ma" href="https://developer.apple.com/documentation/coreservices/1448939-uttypecreatepreferredidentifierf" rel="noopener ugc nofollow" target="_blank">UTTypeCreatePreferredIdentifierForTag</a>的首选UTI:</p><pre class="kg kh ki kj gt nw nv nx ny aw nz bi"><span id="c956" class="oa mo iq nv b gy ob oc l od oe"><strong class="nv ir">func</strong> preferredUTI(ext: String) -&gt; String? {</span><span id="fa37" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">let</strong> theUTI = UTTypeCreatePreferredIdentifierForTag(</span><span id="2015" class="oa mo iq nv b gy of oc l od oe">kUTTagClassFilenameExtension,</span><span id="fbb9" class="oa mo iq nv b gy of oc l od oe">ext <strong class="nv ir">as</strong> CFString,</span><span id="a329" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">nil</strong>)?.takeRetainedValue()</span><span id="4092" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">return</strong> theUTI <strong class="nv ir">as</strong> String?</span><span id="7ac0" class="oa mo iq nv b gy of oc l od oe">}</span></pre><p id="a834" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你使用它，你会发现当有另一个应用程序声明的首选UTI时，图标是灰色的。</p><p id="cb46" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过使用函数<a class="ae ma" href="https://developer.apple.com/documentation/coreservices/1447261-uttypecreateallidentifiersfortag" rel="noopener ugc nofollow" target="_blank">uttypecreatelidentifiersfortag</a>，可以知道系统中声明的所有uti。</p><p id="5dea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下示例实现了一种获取特定文件扩展名的所有UTI标识符的方法:</p><pre class="kg kh ki kj gt nw nv nx ny aw nz bi"><span id="b412" class="oa mo iq nv b gy ob oc l od oe"><strong class="nv ir">func</strong> getUTTypeCreateAllIdentifiers(for tag: String) -&gt; [String] {</span><span id="fd43" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">let</strong> cfArray = UTTypeCreateAllIdentifiersForTag(<br/>                 kUTTagClassFilenameExtension,<br/>                 tag <strong class="nv ir">as</strong> CFString,<br/>                 <strong class="nv ir">nil<br/>              </strong>)?.takeRetainedValue()</span><span id="5a3b" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">let</strong> utis:[String] = cfArray <strong class="nv ir">as</strong>? [String] ?? []</span><span id="01e4" class="oa mo iq nv b gy of oc l od oe"><strong class="nv ir">return</strong> utis;</span><span id="314b" class="oa mo iq nv b gy of oc l od oe">}</span></pre><p id="decf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意:这些函数在iOS14中被弃用，但是有一个新的类型叫做<a class="ae ma" href="https://developer.apple.com/documentation/uniformtypeidentifiers/uttypereference" rel="noopener ugc nofollow" target="_blank"> UTTypeReference </a>，在其中你会找到等价的方法。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="680b" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">灰色图标:解决方案</h1><p id="9fea" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">现在我们明白了发生了什么，让我们找到一个解决办法。</p><p id="333d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">阅读这些类的文档，您会在UIDocumentBrowserViewController上发现这一点:</p><blockquote class="nl nm nn"><p id="6388" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><code class="fe ns nt nu nv b">init(forOpeningFilesWithContentTypes allowedContentTypes: [<a class="ae ma" href="https://developer.apple.com/documentation/swift/string" rel="noopener ugc nofollow" target="_blank">String</a>]?)</code></p><p id="d403" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><code class="fe ns nt nu nv b">allowedContentTypes</code></p><p id="e997" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">统一类型标识符(UTIs)的数组。文档浏览器只能打开这些uti指定的文档类型。如果您通过了<code class="fe ns nt nu nv b">nil</code>，浏览器将使用应用程序的<code class="fe ns nt nu nv b">Info.plist</code>文件中的<code class="fe ns nt nu nv b">CFBundleDocumentTypes</code>键指定的文档类型</p></blockquote><p id="2dad" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于UIDocumentPickerViewController:</p><blockquote class="nl nm nn"><p id="ea54" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><code class="fe ns nt nu nv b">init(documentTypes allowedUTIs: [<a class="ae ma" href="https://developer.apple.com/documentation/swift/string" rel="noopener ugc nofollow" target="_blank">String</a>], in mode: <a class="ae ma" href="https://developer.apple.com/documentation/uikit/uidocumentpickermode" rel="noopener ugc nofollow" target="_blank">UIDocumentPickerMode</a>)</code></p><p id="4622" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated"><code class="fe ns nt nu nv b">allowedUTIs</code></p><p id="fb7e" class="kv kw no kx b ky kz jr la lb lc ju ld np lf lg lh nq lj lk ll nr ln lo lp lq ij bi translated">统一类型标识符(UTIs)的数组。uti是唯一标识文件类型的字符串。</p></blockquote><p id="1deb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Apple示例是用故事板准备的，这意味着UIDocumentBrowserViewController是用默认实现实例化的，这意味着<code class="fe ns nt nu nv b">nil</code>被作为<code class="fe ns nt nu nv b">allowedContentTypes</code>传递，这将只使用您声明的UTI过滤文件，而不使用另一个应用程序声明的首选UTI。</p><p id="6d71" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您在init方法中传递所有的uti，问题就解决了，因为应用的过滤器不仅仅是您在<code class="fe ns nt nu nv b">CFBundleDocumentType</code>中定义的，还包括所有注册的uti。</p><pre class="kg kh ki kj gt nw nv nx ny aw nz bi"><span id="59a6" class="oa mo iq nv b gy ob oc l od oe">//UIDocumentViewController</span><span id="724e" class="oa mo iq nv b gy of oc l od oe">let utis = <strong class="nv ir">func</strong> getUTTypeCreateAllIdentifiers(for: "gpx")<br/>let viewController = UIDocumentViewController(<em class="no">forOpeningFilesWithContentTypes</em>: utis)</span><span id="abb9" class="oa mo iq nv b gy of oc l od oe">//UIDocumentPickerViewController</span><span id="85b3" class="oa mo iq nv b gy of oc l od oe">let viewController = UIDocumentPickerViewController(<!-- -->documentTypes: utis, in: .open)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/66a211d7c582562f14aeae15a4992900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xlyjw7UTNoSUbbvp_JkEPA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">UIDocumentBrowserViewController—灰色图标已修复</p></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="8c13" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">结论</h1><p id="81de" class="pw-post-body-paragraph kv kw iq kx b ky nf jr la lb ng ju ld le nh lg lh li ni lk ll lm nj lo lp lq ij bi translated">本文讨论了一个具体的问题，但通过阅读官方文档，这个问题并不明显。</p><p id="bb07" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这两个组件的潜在用途非常惊人，但挑战在于如何以正确的方式配置它们。</p><p id="431b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">可以添加特定的动作和不同的风格，可以预览文档并共享它们。我把探索更多选择的冒险留给你。</p><p id="d133" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/21108a24eeab377de4c1236b991ad634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2X5VXpAKKy7vemx0cdseDw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Trackyzer Pro —具有文档预览功能的UIDocumentBrowserViewController</p></figure></div></div>    
</body>
</html>