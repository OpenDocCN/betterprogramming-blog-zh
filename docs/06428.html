<html>
<head>
<title>How to Implement In-App Purchases in Your Android App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在你的Android应用中实现应用内购买</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-implement-in-app-purchases-in-your-android-app-7cc1f80148a4?source=collection_archive---------1-----------------------#2020-10-01">https://betterprogramming.pub/how-to-implement-in-app-purchases-in-your-android-app-7cc1f80148a4?source=collection_archive---------1-----------------------#2020-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="80cc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">应用内购买整合完整指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/115039e59bdbb2bb9b4aef8c87da526e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZuGWdsKrQ7gf4w9kVeWSLg.png"/></div></div></figure><h1 id="1853" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="aa87" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">Google Play应用内购买是在Android应用上销售数字产品或内容的最简单的解决方案。因此，许多想要销售数字商品或向用户提供高级会员资格的应用程序开发人员可以简单地使用Google Play应用程序内的计费流程来顺利轻松地结账。</p><p id="0f24" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在本文中，我们将检查在Android应用上实现应用内购买以及在Google Play控制台上创建应用内付费产品的端到端流程。</p><p id="0b4f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果你想直接进入代码，这里是回购:</p><div class="mn mo gp gr mp mq"><a href="https://github.com/pavan5208/android_in_app_purchase_sample" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">pavan 5208/Android _ in _ app _ purchase _ sample</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">github.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne ks mq"/></div></div></a></div><p id="b33b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们开始吧！</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="8f72" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">Google Play计费系统概述</h1><p id="15b5" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在直接进入代码之前，我们先了解一下计费系统的基本概念。要知道的一个重要的事情就是我们能卖给用户什么样的产品。Google Play的计费系统帮助我们销售以下类型的数字内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/542c3ac135aefcc1319c99caaef03bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v77D4oN5lQOsspF8OUaASA.png"/></div></div></figure><p id="8aa6" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">那么现在让我们来了解一下其中的每一个。应用内购买主要包括两类项目:一次性产品和订阅。</p><h2 id="d993" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated"><strong class="ak">一次性产品</strong></h2><p id="8b32" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">从名称本身来看，我们知道这是一次性购买，没有重复费用。一次性产品是指用户可以一次性购买的产品。同样，这个一次性产品有两个不同的类别，如上所示:</p><ul class=""><li id="3994" class="oe of it lo b lp mi ls mj lv og lz oh md oi mh oj ok ol om bi translated"><em class="on">可消费产品</em> <strong class="lo iu"> </strong>是用户可以重复购买以访问应用内内容的产品。例如，这可能是购买游戏中的货币，该货币将在适当的时候用完，用户可以再次购买可消耗的<strong class="lo iu"> </strong>产品来获得货币、食物等。</li><li id="f264" class="oe of it lo b lp oo ls op lv oq lz or md os mh oj ok ol om bi translated"><em class="on">非消耗性产品</em> <strong class="lo iu"> </strong>是一种用户可以购买永久利益而无需反复购买的产品。主要是，我们使用这种产品为用户提供高级会员资格，用于移除广告、进入游戏中的特定级别等。</li></ul><h2 id="7fe2" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated"><em class="ot">订阅</em></h2><p id="83fa" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">从名称本身来看，我们可以理解我们正在谈论的是一次重复购买，以获得对应用程序内容的访问权限。</p><p id="973a" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在用户取消订阅之前，订阅会自动续订，这意味着在用户取消订阅之前，会定期向用户收取费用，例如一个月、六个月、一年等。例如，这些订阅主要用于音乐流服务、在线杂志等情况。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="98c2" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">Google Play向开发者收取的交易费用</h1><p id="3371" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们需要向谷歌支付使用应用内购买的交易费。Google Play中所有购买的交易费是用户每次交易支付价格的30%。这意味着开发者获得70% <strong class="lo iu"> </strong>的报酬，剩下的30%归发行伙伴和运营费。</p><p id="e43a" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">例如，如果支付100美元作为购买，那么开发者将获得70美元，而谷歌交易费将是30美元。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c3bce9f633f62016de3585cc517f9ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*ndtCr3Nkfdse7YQ2ZdbxSg.png"/></div></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="b70c" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">应用内购买的Android实现</h1><p id="1d84" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">让我们采取循序渐进的方法来更好地理解这一点。如果你不想经历这些步骤，而是想直接跳到代码中，这里有<a class="ae ov" href="https://github.com/pavan5208/android_in_app_purchase_sample" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>。</p><p id="c30a" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们从编码开始！</p><h2 id="c51b" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">1.让我们首先创建一个示例应用程序</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9842018f0eec27110060edd55c0240f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V5gv2nZBnOV12LmTKlTYAA.png"/></div></div></figure><h2 id="8d39" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">2.创建项目后，让我们在应用程序级别或模块级别将计费客户端依赖项添加到build.gradle文件中——无论您想添加到哪里</h2><pre class="kj kk kl km gt ox oy oz pa aw pb bi"><span id="0975" class="ns kv it oy b gy pc pd l pe pf">dependencies {<br/>    def billing_version = "3.0.0"</span><span id="624b" class="ns kv it oy b gy pg pd l pe pf">//Kotlin<br/>   implementation "com.android.billingclient:billing-ktx:$billing_version"<br/>}</span></pre><p id="2875" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果你正在使用Kotlinm，使用上面的依赖关系，因为KTX模块包含Kotlin扩展和协程支持，这将为我们提供方便。否则，您可以添加以下内容并同步Gradle文件以下载您需要的依赖项</p><pre class="kj kk kl km gt ox oy oz pa aw pb bi"><span id="e831" class="ns kv it oy b gy pc pd l pe pf">implementation 'com.android.billingclient:billing:$billing_version'</span></pre><h2 id="cece" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">3.在继续下一步之前，我们需要将一款应用上传到Play Store</h2><p id="bc4e" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">添加完库后，我们需要生成一个构建并发布应用程序。它可以发布到内部测试跟踪，这限制了出于测试目的的访问。</p><p id="795b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">注意:</strong>记住我们上传到Play Store的应用版本。测试的版本应该是相同的——否则，我们会遇到不相关的问题。</p><h2 id="ec51" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">4.发布应用程序后，我们需要创建我们想要销售的产品</h2><p id="69ee" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">要创建应用内产品，请导航至:</p><p id="f71b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><em class="on">商店存在→应用内产品→被管理产品</em></p><p id="ecf4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">然后，我们将看到下面的页面，在这里我们可以创建我们的产品。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/78ef5bd020f1b22bd1ab6d79878fd933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZFGhVZ1HlufcAz4lzLtTg.png"/></div></div></figure><p id="abb6" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">首先，点击“建立一个商家账户”，并填写要求基本信息的表格，如姓名、地址、电子邮件等。之后，单击“创建被管理产品”选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/a0ced1ecfb6ec0422ea6d72acf7ae9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KRrLPMYMee8aZcg9E7NuKA.png"/></div></div></figure><p id="243d" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">然后，它导航到产品创建页面，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/db7e677a32ca24be7b101a3013a780a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5gakMHVvSR4nUn034JOTLw.png"/></div></div></figure><p id="0908" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们在创建产品ID时需要小心一点，因为它不能在以后被修改，并且记住它应该是唯一的ID。填写完之后，在标题和描述中填入适当的信息。当我们启动购买流程时，这将对用户可见。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/774e0bcd2168d71dadce34cbd7c11d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*Ck2c5YGdqtFGR0HAgjgO1g.jpeg"/></div></figure><p id="ea68" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">注意:</strong>完成产品的创建后。复制所有产品id，并将它们保存在您的服务器上。我们需要这些产品id，因为这些是需要提供给计费客户端以获取信息、发起购买等的产品id。否则，如果你是无服务器的，把它们保存在一个常量文件中。</p><h2 id="123e" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">5.初始化计费客户端</h2><p id="ca46" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">现在一切都已经在Google Play上完成了，让我们回到代码库，开始处理应用内购买流程。在我们的活动中，首先让我们创建一个方法<code class="fe pj pk pl oy b">setUpBillingClient</code>，我们可以在其中初始化计费客户端，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="2086" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们使用提供的构建器模式来创建计费客户端实例。为此，我们需要提供一个<code class="fe pj pk pl oy b">PurchasesUpdatedListener</code>，<strong class="lo iu"> </strong>，在这里我们可以得到与任何购买相关的回调。基本设置完成后，我们将在后面讨论这一部分。</p><blockquote class="po pp pq"><p id="4eaa" class="lm ln on lo b lp mi ju lr ls mj jx lu pr mk lx ly ps ml mb mc pt mm mf mg mh im bi translated"><strong class="lo iu"> "BillingClient </strong>是库和应用程序代码之间通信的主要接口。它为应用内计费提供了便利的方法。我们可以为您的应用程序创建该类的一个实例，并使用它来处理应用程序内的计费操作。它为许多常见的应用内计费操作提供了同步(阻塞)和异步(非阻塞)方法。所有方法都应该从Ui线程调用，所有异步回调也将在Ui线程上返回”“<a class="ae ov" href="https://developer.android.com/reference/com/android/billingclient/api/BillingClient" rel="noopener ugc nofollow" target="_blank"> Android开发者文档</a></p></blockquote><h2 id="08d6" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">6.在计费客户端实例上启动连接</h2><p id="7d04" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">一旦创建了客户端实例，我们需要在创建的实例上启动一个连接:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="a049" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一旦我们在<code class="fe pj pk pl oy b">onBillingSetupFinished</code>中收到回调，我们可以使用<code class="fe pj pk pl oy b">billingResult.responseCode</code>来检查连接是否建立成功。然后，我们可以继续启动购买流程或查询我们的产品等。</p><h2 id="963d" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">7.让我们查询一下现有的产品</h2><p id="0b9a" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们需要创建一个<code class="fe pj pk pl oy b">SkuDetailsParams</code> <strong class="lo iu"> </strong>实例来启动对SKU详细信息的查询。我们需要将SKU列表及其类型设置为<code class="fe pj pk pl oy b">SkuDetailsParams</code>。</p><p id="bbed" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">可能的SKU类型是应用内产品和订阅，如上所述。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="a247" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一旦<code class="fe pj pk pl oy b">SkuDetailsParams</code>准备就绪，我们需要在创建的计费客户端实例上调用<code class="fe pj pk pl oy b">querySkuDetailsAsync</code>方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="f8bc" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一旦获取了项目，我们就可以更新并在屏幕上显示它们。因为我们只有一个单元，所以让我们创建一个简单的XML文件来显示细节。</p><h2 id="fa63" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">8.创建用户界面以显示SKU的详细信息</h2><p id="f9a8" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">让我们创建XML文件，用标题和描述字段向用户显示信息。添加一个按钮，这样当用户点击时，我们可以开始购买流程。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><h2 id="49ea" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">9.根据“QueryPurchases”的结果更新UI</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="59d2" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">通过使用扩展，尝试自己编写更好的代码。</p><h2 id="92b2" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">10.点击购买按钮，启动购买流程</h2><p id="fea5" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">因为我们已经获取了SKU的详细信息，所以我们可以启动计费流程。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><h2 id="6be4" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">11.让我们在' purchaseUpdateListener '中处理购买结果</h2><p id="7f92" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">如果<code class="fe pj pk pl oy b">billingResult</code>的响应代码是OK，例如<code class="fe pj pk pl oy b">0 </code>，那么购买就成功了，我们需要处理消耗品和非消耗品购买的流程(这在上面的被管理产品一节中讨论过)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><h2 id="b182" class="ns kv it bd kw nt nu dn la nv nw dp le lv nx ny lg lz nz oa li md ob oc lk od bi translated">12.处理消耗品和非消耗品的购买—然后授予用户使用特定功能的权限</h2><p id="347e" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">对于非消耗品购买，我们需要通过计费客户端确认购买。然而，对于消耗品的购买，我们需要通过调用计费客户端上的<code class="fe pj pk pl oy b">consumeAsync</code>来消费它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div></figure><p id="6555" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">以下是输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/2f5e57c6c59c288aa4d31905080f1933.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*5BjCSker63rIL7e327cAvQ.gif"/></div></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="1b3c" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">应用内购买的安全问题</h1><p id="151d" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">应用内购买会有很多安全问题。常见的问题是中间人攻击。所以我们需要采取一些小的安全措施。</p><p id="6e0e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果您有一个服务器，将purchase实例中可用的购买令牌发送到服务器，在服务器端，使用Google Developers提供的API来验证该令牌，验证购买，然后授予用户访问权限。</p><p id="d3b8" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们在我即将发表的关于应用内购买的高级处理的文章中讨论更多的安全漏洞和算法。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="3c17" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">摘要</h1><p id="07e0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">以上就是全部内容，希望你已经了解了一些关于应用内产品的知识。使用您帐户中简单的应用程序内集成，从世界各地将金额存入您的帐户，而无需支付网关带来的麻烦。通过添加电子邮件注册为授权测试员，这样您就可以免费测试应用程序。</p><p id="8e12" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">所有这些建议都不能放在一篇文章中，所以让我们看看如何处理基本错误代码，如何详细测试应用内购买，更好的模块管理，重试策略等。在我即将发表的文章中。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="0c37" class="ku kv it bd kw kx nm kz la lb nn ld le jz no ka lg kc np kd li kf nq kg lk ll bi translated">参考</h1><ul class=""><li id="e2e1" class="oe of it lo b lp lq ls lt lv pv lz pw md px mh oj ok ol om bi translated"><a class="ae ov" href="https://developer.android.com/google/play/billing/getting-ready" rel="noopener ugc nofollow" target="_blank">安卓开发者:应用内购买设置</a></li><li id="4115" class="oe of it lo b lp oo ls op lv oq lz or md os mh oj ok ol om bi translated"><a class="ae ov" href="https://codelabs.developers.google.com/codelabs/play-billing-scalable-kotlin/index.html?index=..%2F..index#0" rel="noopener ugc nofollow" target="_blank"> CodeLabs:应用内购买</a></li></ul></div></div>    
</body>
</html>