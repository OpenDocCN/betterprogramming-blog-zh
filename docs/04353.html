<html>
<head>
<title>The Basics of React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React挂钩的基础</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-basics-of-react-hooks-f270428f1b92?source=collection_archive---------13-----------------------#2020-04-07">https://betterprogramming.pub/the-basics-of-react-hooks-f270428f1b92?source=collection_archive---------13-----------------------#2020-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="901f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">现在造你的第一个钩子还不晚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/21749f04906fb43e5bdb90c6ebff0569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*niqzkr1IOzfegXdB5FV1BQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@sortino?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Joshua Sortino </a>在<a class="ae kv" href="https://unsplash.com/s/photos/future?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="79f4" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是钩子？</h1><p id="cb60" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">钩子是JavaScript函数，允许您向功能组件添加状态。它们是在React v16.8中添加的。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="6269" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">为什么要用钩子？</h1><p id="ee8f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在React的早期版本中，状态和功能组件是互斥的特性。要么有状态，要么有功能组件。Hooks解决了这个问题。钩子允许我们给一个功能组件添加状态。</p><p id="2968" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">现在我们已经了解了钩子的用途，让我们看看我们实际上是如何使用它们的。</p><p id="d972" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">下面是一个函数的例子，它使用钩子来呈现一段文本，告诉用户灯的状态，以及一个按钮，允许用户打开和关闭灯。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="06bf" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">您可能会注意到，我们从React导入了名为<code class="fe nd ne nf ng b">useState</code>的东西。这是一个钩子，我们在函数内部调用它来给组件添加一些状态。它返回我们的当前状态— <code class="fe nd ne nf ng b">value(false)</code> —以及一个允许我们更新状态的函数— <code class="fe nd ne nf ng b">setLightStatus</code>。例如，这个返回的函数可以在事件处理程序中调用，类似于来自类组件的<code class="fe nd ne nf ng b">this.setState</code>。</p><p id="1f16" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><code class="fe nd ne nf ng b">useState</code>钩子只接受一个初始化的状态参数，在我们的例子中是<code class="fe nd ne nf ng b">false</code>。注意，我们的初始化状态不像使用<code class="fe nd ne nf ng b">this.state</code>时那样是一个对象——但是如果你需要，它可以是一个对象。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="85f9" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">挂钩指南</h1><p id="5587" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">尽管钩子只是一个JavaScript函数，但它有两个简单的规则:</p><ul class=""><li id="3106" class="nh ni iq lq b lr mw lu mx lx nj mb nk mf nl mj nm nn no np bi translated">钩子应该只在顶层被调用，并且它们应该<em class="nq">而不是</em>在循环、条件或嵌套函数中被调用。</li><li id="7ae9" class="nh ni iq lq b lr nr lu ns lx nt mb nu mf nv mj nm nn no np bi translated">React挂钩应该只用于功能性React组件内部或自定义挂钩内部。(稍后将详细介绍定制挂钩)</li></ul></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="5663" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">多状态变量呢？</h1><p id="f05b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">你可以像这样多次调用<code class="fe nd ne nf ng b">useState</code>:</p><pre class="kg kh ki kj gt nw ng nx ny aw nz bi"><span id="7f84" class="oa kx iq ng b gy ob oc l od oe">function ExampleWithManyStates() {<br/>// Declare multiple state variables!<br/>const [miles, setMiles] = useState(42);<br/>const [food, setFood] = useState(‘banana’);<br/>const [ideas, setIdeas] = useState([{ ideaOne: ‘Learn Hooks’ }]);<br/>// …<br/>}</span></pre></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="46ad" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">钩子的另一个作用</h1><p id="3cbc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">另一个增加的挂钩是<code class="fe nd ne nf ng b">useEffect</code>挂钩。当<code class="fe nd ne nf ng b">componentDidMount</code>、<code class="fe nd ne nf ng b">componentDidUpdate</code>和<code class="fe nd ne nf ng b">componentWillUnmount</code>被一个类组件使用时，一个功能组件将使用<code class="fe nd ne nf ng b">useEffect</code>钩子。<code class="fe nd ne nf ng b">useEffect</code>挂钩可代替以下部件:</p><pre class="kg kh ki kj gt nw ng nx ny aw nz bi"><span id="e8f7" class="oa kx iq ng b gy ob oc l od oe">componentDidMount() <br/>{<br/> document.title = `You clicked ${this.state.count} times`; <br/>}<br/>componentDidUpdate() { <br/>document.title = `You clicked ${this.state.count} times`; <br/>}</span></pre><p id="9d25" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">有了这个:</p><pre class="kg kh ki kj gt nw ng nx ny aw nz bi"><span id="26d5" class="oa kx iq ng b gy ob oc l od oe">useEffect(() =&gt; { <br/>// Update the document title using the browser API <br/>document.title = `You clicked ${count} times`; <br/>});</span></pre><p id="dcfb" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">通过调用<code class="fe nd ne nf ng b">useEffect</code>钩子，React将在刷新DOM更改后运行钩子内部定义的内容。另一个好处是，因为钩子是在组件内部定义的，所以钩子可以访问组件的属性和状态。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="adb7" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">定义多个useEffect挂钩</h1><p id="b309" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><code class="fe nd ne nf ng b">useEffect</code>的另一个很好的特性是我们可以用它们各自的状态钩子而不是生命周期名称来分离动作，这个特性大大提高了代码的可读性，正如你可能猜到的那样。与其这样:</p><pre class="kg kh ki kj gt nw ng nx ny aw nz bi"><span id="7b6a" class="oa kx iq ng b gy ob oc l od oe">componentDidMount() {<br/>console.log(“Do Something”)<br/>console.log(“Something Else”)<br/>}</span></pre><p id="a45f" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">我们可以像这样定义多个<code class="fe nd ne nf ng b">useEffect</code>钩子:</p><pre class="kg kh ki kj gt nw ng nx ny aw nz bi"><span id="81c4" class="oa kx iq ng b gy ob oc l od oe">const [food, setFood] = useState(‘banana’);<br/>useEffect(() =&gt; {<br/> document.title = “You’re Favorite Food is ${food}“;<br/>});</span><span id="f21a" class="oa kx iq ng b gy of oc l od oe">const [isOnline, setIsOnline] = useState(null);<br/>useEffect(() =&gt; {<br/> console.log(Do Something’)<br/>  return () =&gt; {<br/>    console.log(“Clean Up”)<br/>  };<br/>});</span></pre><p id="7724" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">需要注意的是，多个<code class="fe nd ne nf ng b">useEffect</code>钩子是按照它们被定义的顺序被调用的。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="e78c" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">构建自定义挂钩</h1><p id="05b6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">通常，在构建React应用程序时，您希望在多个组件中重用一个状态逻辑。以前，有两种方法可以实现这一点——创建高阶组件或使用渲染道具。定制钩子允许我们以更简洁的方式实现同样的功能。首先，我们定义名为<code class="fe nd ne nf ng b">useOnlineStatus</code>的定制钩子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="46de" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">然后，我们可以在其他组件中使用这个自定义挂钩:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="9bbf" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">这些组件的状态相互独立。自定义钩子只允许我们重用状态逻辑。此外，习惯上用<code class="fe nd ne nf ng b">use</code>作为函数来命名一个定制钩子。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="da23" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">结论</h1><p id="07bb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><code class="fe nd ne nf ng b">useState</code>和<code class="fe nd ne nf ng b">useEffect</code>钩子只是在抓React钩子的表面。在<a class="ae kv" href="https://reactjs.org/docs/hooks-reference.html" rel="noopener ugc nofollow" target="_blank">文档</a>中定义了许多更有用的钩子。</p><p id="ba14" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">如果您有任何问题、建议或其他任何事情，请随时发表评论！</p></div></div>    
</body>
</html>