<html>
<head>
<title>Getting Started With Pyvcloud — A Python Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pyvcloud入门Python库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/getting-started-with-pyvcloud-a-python-library-2e77092ed3ea?source=collection_archive---------10-----------------------#2022-04-06">https://betterprogramming.pub/getting-started-with-pyvcloud-a-python-library-2e77092ed3ea?source=collection_archive---------10-----------------------#2022-04-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d9af" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建第一台虚拟机的快速设置</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9a7f98503b8e2ed0b67a7447dbda78b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7s2Wo3VgQBNPKl_bKhzbA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@divinetechygirl?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">克里斯蒂娜·莫里路</a>从<a class="ae kv" href="https://www.pexels.com/photo/woman-programming-on-a-notebook-1181359/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><h1 id="e70b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> <em class="lo">什么是Pyvcloud？</em>T9】</strong></h1><p id="664b" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">您是否使用VMWare的vCloud Director？您是否厌倦了重复创建虚拟应用程序、虚拟机等平凡步骤？你在寻找</p><blockquote class="ml mm mn"><p id="c86e" class="lp lq mo lr b ls mp jr lu lv mq ju lx mr ms ma mb mt mu me mf mv mw mi mj mk ij bi translated">《如何使用pyv cloud》《v cloud Director的Python包》</p></blockquote><p id="63ee" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">如果您的答案是肯定的，那么来看看VMWare自己的Pyvcloud吧。</p><blockquote class="ml mm mn"><p id="ccd4" class="lp lq mo lr b ls mp jr lu lv mq ju lx mr ms ma mb mt mu me mf mv mw mi mj mk ij bi translated">用VMWare自己的话说，“Pyvcloud就是VMWare vCloud Director的Python SDK”。</p></blockquote><p id="2c30" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">简单来说，Pyvcloud是一个用于VCloud Director管理的Python库，您可以在vCloud Director上执行的所有任务都可以通过这个易于使用的Pyvcloud来完成！对于一些目前不可用的任务有一些例外，我们将在接下来的讨论中涉及它们。</p><p id="36de" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><strong class="lr ir"> <em class="mo">开始之前:</em> </strong></p><ol class=""><li id="9cb6" class="mx my iq lr b ls mp lv mq ly mz mc na mg nb mk nc nd ne nf bi translated">使用<a class="ae kv" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">下载python </a>在您的机器上下载并安装Python</li><li id="9431" class="mx my iq lr b ls ng lv nh ly ni mc nj mg nk mk nc nd ne nf bi translated">设置一个IDE，有很多IDE可供选择，但是我建议在本教程中坚持使用<a class="ae kv" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank">而不是代码</a>。</li><li id="7b0f" class="mx my iq lr b ls ng lv nh ly ni mc nj mg nk mk nc nd ne nf bi translated">智能感知拯救:将微软的Python 扩展添加到VS代码中</li></ol><h2 id="fc82" class="nl kx iq bd ky nm nn dn lc no np dp lg ly nq nr li mc ns nt lk mg nu nv lm nw bi translated"><strong class="ak"> <em class="lo">安装pyvcloud </em> </strong></h2><p id="6121" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">在Python程序中使用之前，您必须在系统上安装<code class="fe nx ny nz oa b">pyvcloud</code>。运行下面给出的命令</p><pre class="kg kh ki kj gt ob oa oc od aw oe bi"><span id="5354" class="nl kx iq oa b gy of og l oh oi">pip install pyvcloud</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/b7c96977326a2f67bbecbe9ae3d4939e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbBwJc0j4kTo2fImaT1zSg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@cbpsc1" rel="noopener ugc nofollow" target="_blank">客户帕特森</a>在<a class="ae kv" href="https://unsplash.com/photos/dYEuFB8KQJk" rel="noopener ugc nofollow" target="_blank"> unsplash </a>上拍摄的照片</p></figure><h1 id="11bf" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> <em class="lo">将Python连接到VCD </em> </strong></h1><p id="531c" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">对于本教程，我们将创建一个名为<code class="fe nx ny nz oa b">VCD_Utils</code>的类，在其中我们将定义所有的方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="260a" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">构造函数建立python与VCD的连接。在此代码片段<em class="mo">、</em>中，<em class="mo"> </em>客户端是v cloud Director REST API的底层接口。它需要你的VCD的主机名和其他参数是可选的；我们可以根据您的日志要求将它们设置为True或False。BasicLoginCredentials完成主要的连接工作，并为您设置连接。</p><p id="979b" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">Org和VDC是构造函数，在Pyvcloud中，记住在使用构造函数时，你只需要两个东西:客户端对象和各自的资源。例如，为了构造一个VDC对象，我们提供了客户端和VDC的资源。我们将把org和VDC对象存储为实例变量，因为它们需要用于进一步的操作<em class="mo">。</em></p><p id="7514" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><em class="mo">注意:对于我们的教程，我们有一对一的映射，即单个vApp仅包含一个虚拟机。</em></p><p id="e686" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">助手方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="2c2d" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">这些是帮助者的方法，它们会让我们的生活变得更容易。</p><p id="1414" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><code class="fe nx ny nz oa b">get_vapp()</code>接收<code class="fe nx ny nz oa b">vapp_name</code>，从我们的数据中心获取它的资源，然后我们使用构造函数创建vAPP的XML对象。同样的情况也出现在创建一个VM对象并返回它的<code class="fe nx ny nz oa b">get_vm()</code>方法上！最后一个方法<code class="fe nx ny nz oa b">does_vapp_exist()</code>只是检查给定的<code class="fe nx ny nz oa b">vApp</code>是否存在于我们的VCD中，如果是- &gt;返回真，否则返回假<em class="mo">。</em></p><p id="4905" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><em class="mo">在VCD上执行CRUD操作:</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/e18ef5a9543c2ace535e7a6e733f925b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2T-hxjyvJWrAivg_Y5zNw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由亚什·萨尔维提供</p></figure><p id="bf73" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><em class="mo">创建vApp: </em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="09af" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">此方法需要新vApp的名称、制作vApp的模板以及其他可选参数，如网络、存储策略等。实际上，我们使用VCD的<code class="fe nx ny nz oa b">instantiate_vapp()</code>方法创建<code class="fe nx ny nz oa b">vApp</code>并返回<code class="fe nx ny nz oa b">vApp</code> XML对象。现在，创建后我们可以检查<code class="fe nx ny nz oa b">vApp</code>是否是由我们的助手<code class="fe nx ny nz oa b">does_vapp_exist()</code>方法创建的。</p><p id="2ad9" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated"><em class="mo">注意:创建vApp时，其状态为未解析，即电源状态= 0，直到应用的状态从未解析变为断电(电源状态= 8)，我们无法在vApp上执行任何操作。</em></p><h1 id="b5b1" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> <em class="lo">读取vApp的数据</em> </strong></h1><p id="4ecc" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">现在，我们可以玩我们的VApp了，我们需要由pyvcloud的vApp类构造的vApp对象。<code class="fe nx ny nz oa b">vApp</code>对象包含了大量的方法，多亏了我们的智能感知，通过在它后面加一个点就可以很容易地看到这些方法。为了读取vApp的数据，让我们获取虚拟机的IP地址。</p><p id="fc70" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">注意:在大多数情况下，Pyvcloud返回需要转换成字典的XML数据。Pyvcloud有一个内置的<code class="fe nx ny nz oa b">to_dict()</code>方法可以帮助我们进行这种转换，我们可以在控制台上看到字典内容！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="de05" class="nl kx iq bd ky nm nn dn lc no np dp lg ly nq nr li mc ns nt lk mg nu nv lm nw bi translated"><strong class="ak"> <em class="lo">更新vApp </em> </strong></h2><p id="26d0" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">现在，我们将更新虚拟机的CPU。为此，我们需要虚拟机对象驻留在我们的vApp中。我们将使用我们的助手方法get_vm()来获取vm对象。然后，可以使用VM对象来更新CPU。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h2 id="147e" class="nl kx iq bd ky nm nn dn lc no np dp lg ly nq nr li mc ns nt lk mg nu nv lm nw bi translated"><strong class="ak"> <em class="lo">删除vApp </em> </strong></h2><p id="4298" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">现在，我们将删除vApp。删除也很简单。我们只需要<code class="fe nx ny nz oa b">vapp_name</code>，把它提供给Pyvcloud，然后boom就把它从VCD上删除了。这里的force true仅仅意味着如果它在<em class="mo">上，就关闭其中的虚拟机。</em>如果虚拟机已启动，而force true没有通过，那么我们将会得到一个错误！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="923a" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">唉！我们已经写了我们的类。</p><p id="ba81" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">让我们通过为我们的类创建一个对象来收获果实并让我们的工作得到回报。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="9bf3" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">最后但同样重要的是，让我们注销我们的VCD。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="c60d" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">到目前为止，您应该已经成功地在VCD上执行了CRUD操作。要深入了解<code class="fe nx ny nz oa b">pyvcloud</code>，你可以浏览他们的<a class="ae kv" href="https://vmware.github.io/pyvcloud/" rel="noopener ugc nofollow" target="_blank">文档。</a></p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><p id="f03a" class="pw-post-body-paragraph lp lq iq lr b ls mp jr lu lv mq ju lx ly ms ma mb mc mu me mf mg mw mi mj mk ij bi translated">暂时就这样吧！你可以在我的<a class="ae kv" href="https://github.com/Raxy45/getting_started_with_pyvcloud" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>上找到完整的代码。</p></div></div>    
</body>
</html>