<html>
<head>
<title>A Simple Note-Taking App With Flutter — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个简单的带Flutter的笔记应用程序—第1部分</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/simple-notes-app-with-flutter-part-1-ab66e15c8635?source=collection_archive---------0-----------------------#2019-05-19">https://betterprogramming.pub/simple-notes-app-with-flutter-part-1-ab66e15c8635?source=collection_archive---------0-----------------------#2019-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5bde" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">是时候用sqflite数据库创建一个Flutter应用程序了</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/66639c74dc8600c893555c78876218da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQrftlQirpRHnb1ESc9EvQ.png"/></div></div></figure><p id="2670" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">T2是一个流行的创建应用程序的框架。我每天都在探索Flutter，因为它有很多小部件和很多东西需要学习。</p><p id="511f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，当我们谈论生产性应用时，我们总是在其中有一些本地存储。</p><p id="63f8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在Flutter中，我们有三种类型的本地存储:</p><ol class=""><li id="a486" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">读取/写入文本文件。</li><li id="a09e" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">SharedPreferences。</li><li id="a25d" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><a class="ae ln" href="https://pub.dev/packages/sqflite" rel="noopener ugc nofollow" target="_blank"> sqflite </a>。</li></ol><p id="b297" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">与1 . 0相比，Sqflite稍微复杂一点。第二。，所以我们要把重点放在sqflite的实现上。</p><p id="c3b9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在此的帮助下，我们将创建一个简单的笔记应用程序，当然，在我们学习的过程中，你会学到很多不同的东西。</p><p id="fe8b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们直接进入它。</p><p id="fd7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你是Flutter新手，建议你去<a class="ae ln" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">这个</a>链接，按照说明操作。一旦你完成了，你就可以设置环境和开发SDK，然后你就可以加入我了。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="f7c1" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">入门指南</h1><p id="787d" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">我在Android Studio中开发这个应用程序，因为它很容易，它可以帮助我根据Flutter的需求设置一切。我对此很满意，但是如果你对Android Studio不满意，你可以使用你选择的编辑器。</p><p id="776a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是目前支持Flutter的编辑器:</p><ul class=""><li id="4062" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm ng lu lv lw bi translated"><a class="ae ln" href="https://developer.android.com/studio" rel="noopener ugc nofollow" target="_blank">安卓工作室</a>，3.0版本或更高版本。</li><li id="8fde" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><a class="ae ln" href="https://www.jetbrains.com/idea/download/" rel="noopener ugc nofollow" target="_blank"> IntelliJ IDEA社区</a>，2017.1或更高版本。</li><li id="3e48" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><a class="ae ln" href="https://www.jetbrains.com/idea/download/" rel="noopener ugc nofollow" target="_blank"> IntelliJ IDEA Ultimate </a>，2017.1或更高版本。</li><li id="0d81" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><a class="ae ln" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS代码</a>，最新稳定版本。</li></ul><p id="84ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，您的项目在创建后会是这样的。运行您的项目以确保一切都完美运行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/c2b9fbd6ae8623ce5e73d1fdd1a9be19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yn-5HJcJr64p0nNlYHLcFw.png"/></div></div></figure><p id="318b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">删除一切，我们从零开始。</p><p id="46dc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你的代码应该和我的一样:</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="3e05" class="nn mk iq nj b gy no np l nq nr"><strong class="nj ir">import </strong>'package:flutter/material.dart';<br/><br/><strong class="nj ir">void </strong>main() {<br/>  runApp(MaterialApp(<br/>    title: "Notes App",<br/>    home: NotesList(),<br/>  ));<br/>}<br/><br/><strong class="nj ir">class </strong>NotesList <strong class="nj ir">extends </strong>StatefulWidget {<br/>  @override<br/>  _NotesListState createState() =&gt; _NotesListState();<br/>}<br/><br/><strong class="nj ir">class </strong>_NotesListState <strong class="nj ir">extends </strong>State&lt;NotesList&gt; {<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    <strong class="nj ir">return </strong>Container();<br/>  }<br/>}</span></pre><p id="3c91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，是时候添加一些插件了。</p><p id="e391" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这个应用程序中，我们将有以下插件:</p><ol class=""><li id="a38f" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated"><a class="ae ln" href="https://pub.dev/packages/sqflite#-installing-tab-" rel="noopener ugc nofollow" target="_blank"> Sqflite插件</a></li><li id="5fa9" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><a class="ae ln" href="https://pub.dev/packages/path_provider#-installing-tab-" rel="noopener ugc nofollow" target="_blank">路径提供者</a></li><li id="df89" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated"><a class="ae ln" href="https://pub.dev/packages/intl#-installing-tab-" rel="noopener ugc nofollow" target="_blank">国际</a></li></ol><p id="906c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将这些插件添加到项目文件夹下的<code class="fe ns nt nu nj b">pubspec.yaml</code>文件中，然后点击<em class="nv">获得</em>包。</p><p id="0acb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能在完成所有包后收到此消息(忽略时间，它将根据您的互联网连接获得这些包):</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="6bf2" class="nn mk iq nj b gy no np l nq nr">Running “flutter packages get” in notes_app… 4.7s<br/>Process finished with exit code 0</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/381580daf5539f42bc36e6fc7bd92b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NkhFOxNzn_22Ot7v97xTDQ.png"/></div></div></figure><p id="f918" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，您已经具备了制作一个成熟的笔记应用程序的所有条件。</p><p id="0e69" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe ns nt nu nj b">lib</code>文件夹下创建一些包，这对于专业开发人员来说是一个好习惯。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1744bbbd33b7551f346cd05b03d7ae60.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*atMn3DYJK4fGGR0-YB329A.png"/></div></figure><p id="1005" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">难怪，我刚把我的<code class="fe ns nt nu nj b">main.dart</code>搬进UI包。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="dd68" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated"><strong class="ak">模型类</strong></h1><p id="0190" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">让我们创建一个模型来帮助我们做笔记。</p><p id="7a35" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在你的模型包中，右键点击<em class="nv">模型包</em> &gt; <em class="nv">新建</em> &gt; <em class="nv">镖文件</em>并将其命名为<em class="nv">注意。</em></p><p id="a83a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你的<code class="fe ns nt nu nj b">Class</code>应该是这样的:</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="5ba7" class="nn mk iq nj b gy no np l nq nr"><strong class="nj ir">class </strong>Note {<br/>  String _text, _date; //our note contain text,create date and an Id<br/>  int _id;<br/><br/>  Note.update(<strong class="nj ir">this</strong>._text, <strong class="nj ir">this</strong>._date, <strong class="nj ir">this</strong>._id);<br/><br/>  Note(<strong class="nj ir">this</strong>._text, <strong class="nj ir">this</strong>._date);<br/><br/>  Note.map(<strong class="nj ir">dynamic </strong>obj) {<br/>    <strong class="nj ir">this</strong>._text = obj['name'];<br/>    <strong class="nj ir">this</strong>._date = obj['date'];<br/>    <strong class="nj ir">this</strong>._id = obj['id'];<br/>  } <br/><br/>  Note.fromMap(Map&lt;String, <strong class="nj ir">dynamic</strong>&gt; map) {<br/>    <strong class="nj ir">this</strong>._text = map['name'];<br/>    <strong class="nj ir">this</strong>._id = map['id'];<br/>    <strong class="nj ir">this</strong>._date = map['date'];<br/>  }<br/><br/>  Map&lt;String, <strong class="nj ir">dynamic</strong>&gt; toMap() {<br/>    Map&lt;String, <strong class="nj ir">dynamic</strong>&gt; map = <strong class="nj ir">new </strong>Map&lt;String, <strong class="nj ir">dynamic</strong>&gt;();<br/><br/>    map['name'] = <strong class="nj ir">this</strong>._text;<br/>    map['date'] = <strong class="nj ir">this</strong>._date;<br/><br/>    <strong class="nj ir">if </strong>(id != <strong class="nj ir">null</strong>) map['id'] = <strong class="nj ir">this</strong>._id;<br/><br/>    <strong class="nj ir">return </strong>map;<br/>  }<br/><br/>  <strong class="nj ir">get </strong>name =&gt; _text;<br/><br/>  <strong class="nj ir">set </strong>name(value) {<br/>    _text = value;<br/>  }<br/><br/>  <strong class="nj ir">get </strong>date =&gt; _date;<br/><br/>  <strong class="nj ir">set </strong>date(value) {<br/>    _date = value;<br/>  }<br/><br/>  int <strong class="nj ir">get </strong>id =&gt; _id;<br/><br/>  <strong class="nj ir">set </strong>id(int value) {<br/>    _id = value;<br/>  }<br/>}</span></pre><p id="77d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不要担心所有的方法，随着我们的深入，我会定义所有的方法。因为，实施之后，你会对我们这里做了什么有一个清晰的概念。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="0101" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated"><strong class="ak">实用程序类</strong></h1><p id="ce2e" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">按照上面讨论的相同步骤，在util包中制作一个<code class="fe ns nt nu nj b">class</code>，命名为<code class="fe ns nt nu nj b">Constants</code>。</p><p id="ca7d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将有助于我们不要反复编写相同的变量。因此，在您的项目中添加这些类型的类是一个很好的实践。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="0858" class="nn mk iq nj b gy no np l nq nr"><strong class="nj ir">class </strong>Constants {<br/>  <strong class="nj ir">static final </strong>String <em class="nv">TABLE_NAME </em>= "noteTable";<br/>  <strong class="nj ir">static final </strong>String <em class="nv">COLUM_TEXT </em>= "text";<br/>  <strong class="nj ir">static final </strong>String <em class="nv">COLUM_DATE </em>= "date";<br/>  <strong class="nj ir">static final </strong>String <em class="nv">COLUM_ID </em>= "id";<br/>  <strong class="nj ir">static final </strong>int <em class="nv">DB_VERSION </em>= 1;<br/>  <strong class="nj ir">static final </strong>String <em class="nv">DBNAME </em>= "notes.db";<br/>}</span></pre><ul class=""><li id="e19f" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">TABLE_NAME</code>:我们数据库的名称。</li><li id="0eee" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">COLUMN_TEXT</code>:注释文本栏。</li><li id="5fe3" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">COLUMN_DATE</code>:票据创建日期。</li><li id="5d7f" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">COLUMN_ID</code>:数据库中特定行的ID。</li><li id="6cf3" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">DB_VERSION</code>:数据库版本。</li><li id="93fd" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">BDNAME</code>:我们数据库的名称。</li></ul></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="fd0e" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated"><strong class="ak">数据库助手实现</strong></h1><p id="06a8" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">现在，让我告诉你一些关于sqflite的事情。</p><p id="0194" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Sqflite使用单例模式。如果我们用一种简单的方式定义什么是单例，记住单例类可能不需要一次又一次地实例化。</p><p id="2439" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你只有一个实例，你是好的。</p><p id="b1b9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">导航到你的项目面板，右键点击<em class="nv">数据库包</em> &gt; <em class="nv">新建</em> &gt; <em class="nv"> Dart文件</em>，命名为<code class="fe ns nt nu nj b">database_helper</code>，点击回车。</p><p id="4403" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建一个名为<code class="fe ns nt nu nj b">DatabaseHelper</code>的类，并导入一些库和变量。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="de74" class="nn mk iq nj b gy no np l nq nr"><strong class="nj ir">import </strong>'dart:async';<br/><strong class="nj ir">import </strong>'dart:io';<br/><strong class="nj ir">import </strong>'package:sqflite/sqflite.dart';<br/><strong class="nj ir">import </strong>'package:path_provider/path_provider.dart';<br/><strong class="nj ir">import </strong>'package:path/path.dart';<br/><strong class="nj ir">import </strong>'package:todo_app/utils/constants.dart';<br/><strong class="nj ir">import </strong>'package:todo_app/models/note.dart';</span><span id="5da4" class="nn mk iq nj b gy ny np l nq nr">class DatabaseHelper{</span><span id="29da" class="nn mk iq nj b gy ny np l nq nr"><strong class="nj ir">static final </strong>DatabaseHelper <em class="nv">_INSTANCE </em>= <strong class="nj ir">new </strong>DatabaseHelper.make();<br/><br/><strong class="nj ir">factory </strong>DatabaseHelper() =&gt; <em class="nv">_INSTANCE</em>;<br/><br/><strong class="nj ir">static </strong>Database <em class="nv">_db</em>;<br/><br/>DatabaseHelper.make();</span><span id="9ea6" class="nn mk iq nj b gy ny np l nq nr">}</span></pre><ul class=""><li id="4542" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">_INSTANCE</code>:将用于实例化我们的数据库助手一次。</li><li id="5833" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">factory</code>:构造函数用于返回<code class="fe ns nt nu nj b">databasehelper</code>的实例。</li><li id="748c" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">DatabaseHelper.make()</code>:是一个命名的构造函数，用来制作我们的类对象。</li><li id="2b70" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated">是我们实际的数据库，我们将一直与它进行交互。</li></ul><p id="0bfe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">重要事项:</p><p id="2c87" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Flutter中的数据库执行发生在后台线程中，因为Flutter是一个单线程的UI框架，所以它有<code class="fe ns nt nu nj b">async</code>、<code class="fe ns nt nu nj b">await</code>和<code class="fe ns nt nu nj b">Future</code>关键字来使事情在后台工作。</p><p id="5afc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们初始化我们的数据库。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="e5cd" class="nn mk iq nj b gy no np l nq nr">Future&lt;Database&gt; <strong class="nj ir">get </strong>db <strong class="nj ir">async </strong>{<br/>  <strong class="nj ir">if </strong>(<em class="nv">_db </em>!= <strong class="nj ir">null</strong>) <strong class="nj ir">return </strong><em class="nv">_db</em>; <br/>  <em class="nv">_db </em>= <strong class="nj ir">await </strong>initDB();<br/>  <strong class="nj ir">return </strong><em class="nv">_db</em>;<br/>}<br/>------------------------------------------------------------------<br/>initDB() <strong class="nj ir">async </strong>{<br/>  Directory directory = <strong class="nj ir">await </strong>getApplicationDocumentsDirectory();<br/>  String path = join(directory.path, Constants.<em class="nv">DBNAME</em>);<br/>  <strong class="nj ir">var </strong>myDb =<br/>      openDatabase(path, version: Constants.<em class="nv">DB_VERSION</em>, onCreate: _onCreate);<br/><br/>  <strong class="nj ir">return </strong>myDb;<br/>}</span></pre><p id="4ce1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一个方法是get方法，它将返回我们实际的数据库。</p><p id="e5e3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我知道你想知道<code class="fe ns nt nu nj b">initDB()</code>是什么，它是一个帮助返回我们创建的数据库的方法。</p><p id="abe6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">看，每个方法都有<code class="fe ns nt nu nj b">async</code>和<code class="fe ns nt nu nj b">await</code>关键字，因为sqflite中的每个操作都是由flutter在后台执行的...那确实是一个美人！</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="07ee" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated"><strong class="ak"> _onCreate方法</strong></h1><p id="6e19" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">这个方法有一些SQL的东西，比如<code class="fe ns nt nu nj b">CREATE TABLE</code>，用它可以创建一个表来存储我们的笔记。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="a5b8" class="nn mk iq nj b gy no np l nq nr"><strong class="nj ir">void </strong>_onCreate(Database db, int version) <strong class="nj ir">async </strong>{<br/>  <strong class="nj ir">await </strong>db.execute(<br/>      "CREATE TABLE ${Constants.<em class="nv">TABLE_NAME</em>} (${Constants.<em class="nv">COLUM_ID</em>} INTEGER PRIMARY KEY, "<br/>      "${Constants.<em class="nv">COLUM_TEXT</em>} TEXT, ${Constants.<em class="nv">COLUM_DATE</em>} TEXT );");<br/>}</span></pre><p id="59f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">插入注释的方法:</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="1919" class="nn mk iq nj b gy no np l nq nr">Future&lt;int&gt; insertNote(Note note) <strong class="nj ir">async </strong>{<br/>  <strong class="nj ir">var </strong>dbClient = <strong class="nj ir">await </strong>db;<br/>  int count = <strong class="nj ir">await </strong>dbClient.insert(Constants.<em class="nv">TABLE_NAME</em>, note.toMap());<br/><br/>  <strong class="nj ir">return </strong>count;<br/>}</span></pre><ul class=""><li id="9c62" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">insertNote</code> <strong class="kt ir"> </strong>方法将一个注释对象作为参数，并将其插入数据库。它将在后台发生，现在你意识到了这一点。</li><li id="2a35" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">dbClient</code>:是我们的数据库变量。</li><li id="8cde" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><code class="fe ns nt nu nj b">count</code>:在数据库中插入值后，它将返回一个整数，该整数实际上是存储数据的特定行的ID。我们稍后将使用它从数据库中获取单个注释。</li></ul><p id="61dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在是时候定义我们之前在<code class="fe ns nt nu nj b">note.dart</code>中创建的<code class="fe ns nt nu nj b">toMap()</code>了，还记得吗？</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="89ce" class="nn mk iq nj b gy no np l nq nr">Map&lt;String, <strong class="nj ir">dynamic</strong>&gt; toMap() {<br/>  Map&lt;String, <strong class="nj ir">dynamic</strong>&gt; map = <strong class="nj ir">new </strong>Map&lt;String, <strong class="nj ir">dynamic</strong>&gt;();<br/><br/>  map['name'] = <strong class="nj ir">this</strong>._text;<br/>  map['date'] = <strong class="nj ir">this</strong>._date;<br/><br/>  <strong class="nj ir">if </strong>(id != <strong class="nj ir">null</strong>) map['id'] = <strong class="nj ir">this</strong>._id;<br/><br/>  <strong class="nj ir">return </strong>map;<br/>}</span></pre><p id="30fe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Sqflite以键值对格式保存所有内容。因此，默认情况下，它将<code class="fe ns nt nu nj b">Map&lt;String,dynamic&gt;</code>对象作为参数在数据库中插入值，因此<code class="fe ns nt nu nj b">toMap()</code>将为您完成这项工作。它会把你的对象转换成<code class="fe ns nt nu nj b">Map</code>。</p><p id="3ab9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ns nt nu nj b">Map&lt;String,dynamic&gt;</code>字符串是一个键，它将帮助Flutter理解哪个值对应于哪个键。</p><p id="8870" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Dynamic是一个非常强大和有利的关键字，您可以在<code class="fe ns nt nu nj b">Map</code>中传递任何值，因为它可以是整数、字符串、布尔、双精度等。这就是颤动的美妙之处。</p><p id="3c7c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在是从数据库中获取所有注释的时候了。</p><p id="a929" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对此我们有办法。</p><pre class="kg kh ki kj gt ni nj nk nl aw nm bi"><span id="79a9" class="nn mk iq nj b gy no np l nq nr">Future&lt;List&gt; getAllNotes() <strong class="nj ir">async </strong>{<br/>  <strong class="nj ir">var </strong>dbClient = <strong class="nj ir">await </strong>db;<br/>  <strong class="nj ir">var </strong>result = <strong class="nj ir">await </strong>dbClient.rawQuery(<br/>      "SELECT * FROM ${Constants.<em class="nv">TABLE_NAME</em>} ORDER BY ${Constants.<em class="nv">COLUM_TEXT</em>} ASC");<br/><br/>  <strong class="nj ir">return </strong>result.toList();<br/>}</span></pre><p id="1840" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将从数据库中获取所有数据，放在一个列表<code class="fe ns nt nu nj b">Maps</code>中。</p><p id="dfa2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">记住数据库中的所有东西都存储为一个<code class="fe ns nt nu nj b">Map</code>？因此，它将返回一个地图列表。稍后我们将从中提取数据。现在，就加上这个。</p><p id="fcf1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一部分到此为止，下一部分再见。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="eeab" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">觉得这篇文章有用？跟着我<a class="nz oa ep" href="https://medium.com/u/8ee4abb8abb8?source=post_page-----ab66e15c8635--------------------------------" rel="noopener" target="_blank"> Mustufa Ansari </a>上媒。看看下面我读得最多的文章。</p><ul class=""><li id="5848" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm ng lu lv lw bi translated"><a class="ae ln" href="https://medium.com/better-programming/animated-fab-button-with-more-options-2dcf7118fff6" rel="noopener">Android recycler用漂亮的动画观看</a></li><li id="239b" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><a class="ae ln" href="https://medium.com/better-programming/animated-fab-button-with-more-options-2dcf7118fff6" rel="noopener">有更多选项的动画浮动动作按钮！</a></li><li id="8700" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm ng lu lv lw bi translated"><a class="ae ln" href="https://medium.com/better-programming/what-is-androidx-1b8c9832af43" rel="noopener">AndroidX是什么？</a></li></ul></div></div>    
</body>
</html>