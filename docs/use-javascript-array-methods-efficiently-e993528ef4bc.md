# 无指针 JavaScript

> 原文：<https://betterprogramming.pub/use-javascript-array-methods-efficiently-e993528ef4bc>

## 函数式编程中可组合数组方法的使用

![](img/71e7476b0762d680574bbe5e73c68ded.png)

照片由[班农·莫里西](https://unsplash.com/@bannon15?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/functional?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄

JavaScript 在 2009 年左右开始获得主流吸引力。大约在那个时候，我们得到了高性能的 v8 发动机。几个月后，Node.js 说服我们认真对待 JavaScript，然后 [AngularJS](https://angularjs.org/) 将前端开发提升到另一个水平。

但是我们在这个故事中感兴趣的是 ES5 中引入的函数数组方法。

2009 年，JavaScript 有了一些改进，比如严格模式、JSON 支持和 ES5 的函数数组方法。几年后，React 开始向 JavaScript 开发人员介绍函数式编程范式。

越来越多的人开始使用`map`、`filter`、`reduce`、`every`、`some`等数组方法。

使用这些方法的优点是不变性，并使编码人员能够编写声明性代码。所有这些都很棒，但问题是:“我们有效地使用这些方法了吗？”

我将向您展示如何使用函数式编程技术来充分利用这些方法。此外，我将使用接近真实世界的例子。我不相信柜台或 foo-bar 的例子。

为了简单起见，我不打算涵盖每个细节或边缘情况。我要硬编码一些部分比如参数。

# 经典的方法

首先，让我们创建一个场景和一些假数据用于我们的例子。

想象一下，我们有一个智能手机商店，并希望创建有史以来最好的电子商务商店。我们创建一个数据库和一个简单的 API 来返回我们的数据。

其次，我们希望创建一个页面，列出库存中的苹果智能手机。还有，今天是黑色星期五，我们要给顾客打八折。

哇哦。我们使用了一些函数式编程、不变性、声明式编程，实现了我们想要的。这应该很棒，但是这段代码会给我们带来很多痛苦。那么，这些痛点是什么呢？

*   可读性一塌糊涂。变量名很清楚，但是我们如何实现这个结果却一点也不清楚。
*   完全不能重复使用。我们可以将它包装成一个函数，并在谷歌智能手机上重复使用，但如果我们只需要应用其中的一部分，那该怎么办呢？
*   可测试性不是最好的。我们不能在这里测试单独的部分，最有可能的是，我们需要在应用程序的其他地方一次又一次地测试相同的部分。

函数式编程来拯救我们了。是时候升级游戏了。

# 无点编程

我总是发现无点编程很难用语言来解释。如果我试着解释一下，我会说你在编码的时候没有提到函数参数。相反，您将函数作为参数传递。

在前面的代码中，我们内联编写了所有必要的函数。相反，我们可以创建可重用的小函数，并通过数组方法以无指针的方式使用它们，以提高可读性、可重用性和可测试性。

看看我们是如何用无指针风格提高代码的可读性的。现在，我们可以一步步清楚地看到我们的产品列表发生了什么变化。

还有，仔细看看非无点和无点风格的对比。在后者中，我们只是将我们的小函数传递给数组方法，而根本没有提到参数。它使阅读更加自然流畅。

# Currying

我可以解释 currying，因为它是一种允许你用固定参数创建新函数的技术。

您不是创建一个同时期望所有参数并返回一个值的函数，而是创建一个期望固定数量的参数并返回使用这些参数的新函数。

让我们写一些例子，让它更容易理解。

好处是巨大的。现在我们有了高度可重用和专门化的超小功能，一次只能做一件事。

此外，由于我们新的`map`和`filter`函数，我们可以根据需要创建任意多的变体。还是那句话，可读性是王道。我们有负责特定任务的功能，它们带有明确的名称。

# 隐性编程

我们的例子越来越好，但我们已经开始写了很多。这不一定是件坏事，但感觉还是缺少了什么。缺少的东西就是构图。

在隐性编程中，您可以借助于无点风格来创建更具体的函数。在我们的 curry 示例中，我们创建了专门的`filter`和`map`方法，然后分别使用它们来获得我们的结果。

使用心照不宣的编程原则，我们可以组合所有这些函数来创建一个超级专门化的函数来加速游戏。

现在我们的代码被提升到了天堂。我们有高度可重用、可组合、可读和可测试的代码。我们可以将任何功能组合在一起，创建许多不同的功能。

# 结论

了解好处和利弊的最佳方式是比较这两种解决方案。

现在你可以争辩说经典方法更好，因为它超级短。在一个超级小的代码库中，也许这是真的。

但是，如果你考虑一个巨大的代码库，当涉及到代码评审、创建类似的功能、需求变更、代码重构和测试时，你用后一种方法花费的额外时间将会得到回报。

有更多的原则和模式(比如部分应用)可以帮助你写出更有弹性的代码。我强烈建议你看看它们。

但是最重要的一点是在有意义的时候使用这些原则和模式。当一项技术给你带来一些好处时，它就是有价值的。JavaScript 是一种非常灵活的语言。避免利用任何原则和模式。聪明点，有道理的时候作弊。

# 助手库

在没有助手库的情况下用 JavaScript 编写函数代码会让你发疯。你会需要很多像`compose`、`curry`等功能。

幸运的是，确实有很棒的图书馆可以帮助你。这里有一些基本的，你可以作为一个初学者开始使用。

*   [拉姆达](https://github.com/ramda/ramda)
*   [lodash/fp](https://github.com/lodash/lodash/wiki/FP-Guide)

# 推荐资源

以下是一些书籍推荐，可以帮助你走得更远更深。

*   [功能编程的基本指南](https://mostly-adequate.gitbooks.io/mostly-adequate-guide/)
*   [组合软件:JavaScript 中函数式编程和对象组合的探索](https://www.amazon.com/Composing-Software-Exploration-Programming-Composition/dp/1661212565)
*   [YDKJS:范围&闭包](https://www.amazon.com/You-Dont-Know-JS-Closures/dp/1449335586)
*   [YDKJS: ES6 &超出](https://www.amazon.com/You-Dont-Know-JS-Beyond/dp/1491904240)