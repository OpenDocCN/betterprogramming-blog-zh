<html>
<head>
<title>Say Goodbye to For Loops and Start Using the Powerful JavaScript Array Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">告别For循环，开始使用强大的JavaScript数组方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/say-goodbye-to-for-loops-and-start-using-the-powerful-javascript-array-methods-4c5faf583b5b?source=collection_archive---------10-----------------------#2021-04-27">https://betterprogramming.pub/say-goodbye-to-for-loops-and-start-using-the-powerful-javascript-array-methods-4c5faf583b5b?source=collection_archive---------10-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9d43" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用过滤、映射、简化和其他数组方法快速操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/53f73fa52f46235b08a10a911f29b30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJ1wquz-LBugZoWKed5f7w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="3712" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">for</code>循环为我们提供了很好的服务，但是现在是时候为了数组方法而抛弃它了。让我们来看看一些例子，看看你的想法。</p><p id="bfe1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在所有的例子中，我们将处理相同的电视节目列表。这是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="f9ca" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">过滤器</h1><p id="d2d2" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">考虑下面的例子，它只从电视节目列表中选择情景喜剧。它仍然在使用一个<code class="fe lu lv lw lx b">for</code>循环:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="540c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从一个空的情景喜剧数组开始，遍历节目列表，只将情景喜剧放入其中。</p><p id="fb67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们能做得比这更好吗？</p><p id="0ec7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">filter</code>数组方法使用谓词函数从列表中选择元素。<code class="fe lu lv lw lx b">filter</code>不改变输入数组。它创造了一个新的。</p><p id="d042" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谓词是一个<a class="ae ne" rel="noopener ugc nofollow" target="_blank" href="/10-fundamentals-you-need-to-know-about-functions-in-javascript-8e74579b7a9a">函数</a>，它检查条件是否满足，并返回一个布尔值(<code class="fe lu lv lw lx b">true</code>或<code class="fe lu lv lw lx b">false</code>)。</p><p id="8828" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们检查电视节目是否是情景喜剧的谓词函数:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="a251" class="nj mi it lx b gy nk nl l nm nn">function isSitcom(show){<br/>  return show.type === 'sitcom';<br/>}</span></pre><p id="e9f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以将谓词函数传递给<code class="fe lu lv lw lx b">filter</code>数组方法，只从列表中选择情景喜剧:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="ace5" class="nj mi it lx b gy nk nl l nm nn">const sitcoms = shows.filter(isSitcom);</span></pre><p id="06a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样。你怎么想呢?</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="66a4" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">地图</h1><p id="c524" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">现在我们想把电视节目对象列表转换成字符串列表。对于每个对象，我们想要创建一个新的字符串，如下所示:<code class="fe lu lv lw lx b">`${show.name} is a ${show.type}`</code>。</p><p id="045d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是如何用一个<code class="fe lu lv lw lx b">for</code>循环完成转换的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="1c67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从一个空的字符串数组开始，遍历电视节目列表，并向其中添加计算出的字符串文本。</p><p id="e0c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我认为我们可以做得更好。</p><p id="c8bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe lu lv lw lx b">map</code>可以正确地将数组转换成具有相同数量元素的新数组。</p><p id="fe27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数组方法将一个值列表转换成一个新的值列表。新值可以是从原语到对象的任何值。<code class="fe lu lv lw lx b">map</code>不改变输入数组。它创造了一个新的。</p><p id="a0ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们将对象转换成字符串的映射函数:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="6613" class="nj mi it lx b gy nk nl l nm nn">function toShowText(show){<br/>  return `${show.name} is a ${show.type}`;<br/>}</span></pre><p id="403f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以将映射函数传递给<code class="fe lu lv lw lx b">map</code>数组方法，并进行与之前相同的转换:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="984e" class="nj mi it lx b gy nk nl l nm nn">const showsTexts = shows.map(toShowText);</span></pre><p id="621d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你认为它看起来更好吗？</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="cd15" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">减少</h1><p id="8ebd" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">考虑下面的代码，它使用一个<code class="fe lu lv lw lx b">for</code>循环来检测每种类型有多少个节目:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="9aec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从一个空的<a class="ae ne" href="https://medium.com/dailyjs/7-differences-between-objects-and-maps-in-javascript-bc901dfa9350" rel="noopener">对象</a> ( <code class="fe lu lv lw lx b">{}</code>)开始，遍历节目列表，在每一步，我们增加当前电视节目类型的计数。</p><p id="c1f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面，您可以检查每一步的计数是如何增加的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="0bb8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个节目是一个情景喜剧，所以它的计数被设置为<code class="fe lu lv lw lx b">1</code>。第二个节目仍然是情景喜剧，因此情景喜剧的计数增加到<code class="fe lu lv lw lx b">2</code>。第三个节目是一个情景喜剧，所以计数成为<code class="fe lu lv lw lx b">3</code>。第四个节目是冒险，所以情景喜剧的计数仍然是<code class="fe lu lv lw lx b">3</code>，冒险的计数被设置为<code class="fe lu lv lw lx b">1</code>。</p><p id="1315" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用数组方法重构代码。</p><p id="0635" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">reduce</code>数组方法使用reducer函数将一列值转换成一个新的聚合值。</p><p id="81b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在每一步，reducer函数获取聚合值和当前元素，并返回新计算的聚合值。</p><p id="3f99" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们的reducer函数，它获取带有每种类型和当前节目计数的聚合<a class="ae ne" href="https://medium.com/dailyjs/15-fundamentals-you-should-know-on-javascript-objects-90f57cc9d78d" rel="noopener">对象</a>，并返回一个当前节目类型计数增加的聚合对象:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="1aa9" class="nj mi it lx b gy nk nl l nm nn">function countByType(counts, show){<br/>  counts[show.type] = (counts[show.type] || 0 ) + 1;<br/>  return counts;<br/>}</span></pre><p id="98c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">(counts[show.type] || 0 )</code>表达式返回特定演出类型的计数(如果该类型存在)。否则，计算结果为<code class="fe lu lv lw lx b">0</code>。</p><p id="e4b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们可以将reducer函数传递给<code class="fe lu lv lw lx b">reduce</code>方法，并计算与前面的循环逻辑相同的结果:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="5a2c" class="nj mi it lx b gy nk nl l nm nn">const counts = shows.reduce(countByType, {})</span></pre><p id="6186" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">reduce</code>方法的第二个参数是计算出的聚合值的初始值。在我们的例子中，这是一个空的<a class="ae ne" href="https://medium.com/dailyjs/15-fundamentals-you-should-know-on-javascript-objects-90f57cc9d78d" rel="noopener">对象</a> ( <code class="fe lu lv lw lx b">{}</code>)。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="b0b2" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">每一/一些</h1><p id="80b9" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">在接下来的例子中，使用一个<code class="fe lu lv lw lx b">for</code>循环来检测是否所有的节目都是情景喜剧，以及列表中是否至少有一个情景喜剧。</p><p id="f52c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从设置为<code class="fe lu lv lw lx b">true</code>的<code class="fe lu lv lw lx b">areAllSicoms</code>变量开始，遍历列表。当我们发现一个不是情景喜剧的节目时，我们将其设置为<code class="fe lu lv lw lx b">false</code>并停止循环:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="8d9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以类似的方式，我们从设置为<code class="fe lu lv lw lx b">false</code>的<code class="fe lu lv lw lx b">hasSitcoms</code>变量开始，遍历列表。当我们找到一个情景喜剧时，我们将它设置为<code class="fe lu lv lw lx b">true</code>，并停止循环:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="a4b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我认为我们可以改进这段代码。</p><p id="dcd6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">every</code>方法检查<a class="ae ne" href="https://medium.com/programming-essentials/how-to-remove-duplicates-from-arrays-61050fc7b62" rel="noopener">数组</a>中的所有元素是否都通过了谓词函数的测试，并返回一个布尔值。如果谓词函数返回一个falsy值，它将停止并返回<code class="fe lu lv lw lx b">false</code>。否则，处理完所有元素后返回<code class="fe lu lv lw lx b">true</code>。</p><p id="7aab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">方法检查数组中是否至少有一个元素通过了谓词函数的测试，并返回一个布尔值。如果谓词函数返回真值，它将停止并返回<code class="fe lu lv lw lx b">true</code>。否则，在处理完所有元素后返回<code class="fe lu lv lw lx b">false</code>。</p><p id="32d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们可以用来检查一个节目是否是情景喜剧的谓词函数:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="992f" class="nj mi it lx b gy nk nl l nm nn">function isSitcom(show){<br/>  return show.type === 'sitcom';<br/>}</span></pre><p id="ad94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在可以将谓词函数传递给<code class="fe lu lv lw lx b">every</code>和<code class="fe lu lv lw lx b">some</code>数组方法，以检测是否所有的节目都是情景喜剧，以及列表中是否至少有一个情景喜剧:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="d9c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你觉得现在好看了吗？</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="d7c5" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">发现</h1><p id="63f2" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">以下是搜索列表中特定电视节目的循环示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="0745" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从一个设置为<code class="fe lu lv lw lx b">null</code>的<code class="fe lu lv lw lx b">sitcom</code>变量开始，遍历列表。当我们找到具有特定名称的节目时，我们设置变量来引用那个<a class="ae ne" href="https://medium.com/dailyjs/15-fundamentals-you-should-know-on-javascript-objects-90f57cc9d78d" rel="noopener">对象</a>并停止循环。</p><p id="dbb1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们能简化这段代码吗？</p><p id="bfc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">find</code>方法从<a class="ae ne" href="https://medium.com/programming-essentials/how-to-add-conditional-elements-to-array-and-object-literals-d708124b4c6b" rel="noopener">数组</a>中返回满足谓词函数的第一个元素。如果没有找到元素，则返回<code class="fe lu lv lw lx b"><a class="ae ne" href="https://medium.com/programming-essentials/essential-things-on-undefined-and-null-178e2baa21b8" rel="noopener">undefined</a></code>。</p><p id="a2db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们的谓词函数，它检查我们要查找的节目的名称:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="ce80" class="nj mi it lx b gy nk nl l nm nn">function isFriendsSitcom(show){<br/>  return show.name === 'Friends';<br/>}</span></pre><p id="463d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以将谓词函数传递给<code class="fe lu lv lw lx b">find</code>数组方法:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="e14f" class="nj mi it lx b gy nk nl l nm nn">let sitcom = shows.find(isFriendsSitcom);</span></pre><p id="b195" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用arrow函数可以实现类似的谓词函数。这是它的样子:</p><pre class="kj kk kl km gt nf lx ng nh aw ni bi"><span id="b492" class="nj mi it lx b gy nk nl l nm nn">const sitcom = shows.find(show =&gt; show.name === 'Friends');</span></pre><p id="264e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你觉得现在好看了吗？</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="ade5" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="6588" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">这些是你可以用来重构<code class="fe lu lv lw lx b">for</code>循环的一些最有用的数组方法。在我的上一篇文章中，你可以找到更多关于如何将你的代码重构为函数式风格的想法。</p><p id="9006" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。</p></div></div>    
</body>
</html>