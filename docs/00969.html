<html>
<head>
<title>How to Create an HTTP Endpoint on AWS With Serverless Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用无服务器框架在AWS上创建HTTP端点</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-an-http-endpoint-on-aws-with-serverless-framework-9e5fd8eee2cb?source=collection_archive---------6-----------------------#2019-08-01">https://betterprogramming.pub/how-to-create-an-http-endpoint-on-aws-with-serverless-framework-9e5fd8eee2cb?source=collection_archive---------6-----------------------#2019-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="66cd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用无服务器在AWS上托管Python函数并通过HTTP端点调用它的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8ce9e98a89a0248d108720a3643d7abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CqGkmz7t4h0vFh5v"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://github.com/serverless/serverless" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="0d81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于各种原因，你可能希望使用云提供商，如<a class="ae kv" href="https://aws.amazon.com" rel="noopener ugc nofollow" target="_blank">亚马逊网络服务</a> (AWS)、<a class="ae kv" href="https://cloud.google.com" rel="noopener ugc nofollow" target="_blank">谷歌云</a>或<a class="ae kv" href="https://azure.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank">微软Azure </a>来托管你的代码。这篇文章将带您一步一步地了解使用<a class="ae kv" href="https://serverless.com" rel="noopener ugc nofollow" target="_blank">无服务器</a>在AWS上托管Python函数并使用HTTP端点调用它的过程。</p><p id="453e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果这不完全符合你所寻找的不要担心！如果你想要不同的云提供商，无服务器支持许多不同的提供商。除了HTTP请求之外，还支持其他语言和触发器，这些语言和触发器的可用选项取决于您的特定提供程序。完成本教程后，您应该可以轻松地修改这些步骤来支持这些附加选项。</p><p id="88d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的一些先决条件:</p><ul class=""><li id="263b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">确保安装了Node.js和npm。如果没有，根据这些说明安装它们。</li><li id="5b2f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">必须安装Python 3</li><li id="69ce" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">基本熟悉<a class="ae kv" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank">虚拟环境</a></li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="cf33" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤1:设置无服务器</h1><p id="d4b0" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">如果您不熟悉无服务器，这是一个帮助您轻松开发、部署和测试无服务器应用程序的框架。我一直认为AWS是一项复杂(但强大)的服务，而无服务器通过抽象掉一些复杂性，使得使用AWS变得更加容易。</p><p id="149c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，用<code class="fe nk nl nm nn b">npm install -g serverless</code>在你的机器上安装Serverless。</p><p id="1198" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以使用命令<code class="fe nk nl nm nn b">serverless create --template aws-python3 --path aws-serverless-test</code>创建我们的无服务器项目。这里我们使用了<code class="fe nk nl nm nn b"><a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/cli-reference/create/" rel="noopener ugc nofollow" target="_blank">create</a></code>命令在当前工作目录中创建新服务。注意，使用<code class="fe nk nl nm nn b">--template</code>标志，我们指定AWS作为提供者，Python 3作为运行时，使用<code class="fe nk nl nm nn b">--path</code>标志，我们将项目命名为<code class="fe nk nl nm nn b">aws-serverless-test</code>。</p><p id="1538" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想使用不同的提供商或不同的语言，请确保使用不同的模板。你可以在这里找到流行模板的列表<a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/cli-reference/create/" rel="noopener ugc nofollow" target="_blank">，或者运行<code class="fe nk nl nm nn b">serverless create --help</code>查看所有模板的列表。(注意，每当我们调用<code class="fe nk nl nm nn b">serverless</code>命令时，为了简洁起见，您可以使用<code class="fe nk nl nm nn b">sls</code>。)</a></p><p id="5a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的新项目将有三个文件(如果使用不同的提供者或语言，这些文件可能会稍有不同):</p><ul class=""><li id="6da2" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><code class="fe nk nl nm nn b">.gitignore</code> —这是根据我们选择的模板生成的，我们可以根据需要进行更新</li><li id="ce2e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe nk nl nm nn b">handler.py</code> —这个文件是我们指定应该为每个端点运行的函数的地方</li><li id="7236" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe nk nl nm nn b">serverless.yml</code> —在这里，我们可以为AWS的无服务器部署配置设置</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="9ba5" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤2:创建我们的函数</h1><p id="bc66" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">设置好模板后，让我们创建函数并为部署做准备。</p><p id="31c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们将创建一个虚拟环境。确保将您的终端切换到项目的文件夹，然后运行<code class="fe nk nl nm nn b">python3 -m venv venv</code>创建一个虚拟环境，并使用源<code class="fe nk nl nm nn b">./venv/bin/activate</code>激活它。确保将<code class="fe nk nl nm nn b">venv</code>添加到您的<code class="fe nk nl nm nn b">.gitignore</code>中，这样您就不会不小心提交了。此时，您可以随意使用<code class="fe nk nl nm nn b">pip</code>来安装您喜欢的任何linters或formatters。</p><p id="d550" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本教程，我们现在将在根目录中创建一个名为<code class="fe nk nl nm nn b">functions.py</code>的文件，它将包含我们要部署的函数。如果您没有自己的函数来测试这一点，这里有一个简单的Python函数可以使用:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="8f58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的函数完成后，让我们配置API来返回这个消息。在<code class="fe nk nl nm nn b">handler.py</code>中，您将看到一个名为<code class="fe nk nl nm nn b">hello</code>的函数，它接受<a class="ae kv" href="https://docs.aws.amazon.com/lambda/latest/dg/python-programming-model-handler-types.html" rel="noopener ugc nofollow" target="_blank">的两个输入</a> — <code class="fe nk nl nm nn b">event</code>是一个包含所有传入请求数据的<code class="fe nk nl nm nn b">dict</code>，比如头和查询字符串参数，<code class="fe nk nl nm nn b"><a class="ae kv" href="https://docs.aws.amazon.com/lambda/latest/dg/python-context-object.html" rel="noopener ugc nofollow" target="_blank">context</a></code>提供方法和属性，这些方法和属性提供关于调用、函数和执行环境的信息</p><p id="5393" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不需要return语句下面的所有内容，所以让我们删除这一部分。更新主体中的消息，以返回上面定义的自定义消息(或者您想要返回的任何内容)。我们的<code class="fe nk nl nm nn b">handler.py</code>函数现在应该是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="e438" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我们还添加了对URL查询字符串参数的支持，因此当我们发出GET请求时，我们可以通过将<code class="fe nk nl nm nn b">?first_name=Matt</code>追加到我们的查询中来为此函数提供一个名称。下面的示例代码更详细地介绍了如何解析POST和GET参数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="7d6c" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤3:更新无服务器设置</h1><p id="2eba" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在让我们准备部署。打开<code class="fe nk nl nm nn b">serverless.yml</code>并更新它，使它看起来像下面的代码片段。请随意留下所有默认评论，以供将来参考。在这段代码中，我删除了那些注释，并替换成其他注释，以便清楚地说明您在更改什么以及为什么更改。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6219" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个文件的最后两行谈到跨来源的资源共享(<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" rel="noopener ugc nofollow" target="_blank"> CORS </a>)。如果你不熟悉CORS，只需知道“当一个web应用程序请求一个不同来源(域、协议或端口)的资源时，它会执行一个跨来源的HTTP请求。”因为我们不会将我们的函数托管在与我们的web应用程序相同的域中，也不会托管在调用该函数的任何地方，所以我们需要启用CORS。</p><p id="45f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无服务器团队有一篇关于处理CORS的很棒的博客文章，他们推荐JavaScript函数使用middy，Python函数使用lambda-decorator。所以我们现在也要遵循<code class="fe nk nl nm nn b">lambda-decorators</code>指令来确保我们的函数提供CORS支持。</p><p id="03a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们安装<a class="ae kv" href="https://github.com/UnitedIncome/serverless-python-requirements" rel="noopener ugc nofollow" target="_blank">无服务器python需求</a>。这个插件扩展了Serverless的功能，使得在部署时包含我们的<code class="fe nk nl nm nn b">requirements.txt</code>文件的依赖项变得容易。这是通过运行<code class="fe nk nl nm nn b">sls plugin install -n serverless-python-requirements</code>安装的。您会注意到这会创建一个<code class="fe nk nl nm nn b">package.json</code>文件，并为您更新您的<code class="fe nk nl nm nn b">serverless.yml</code>文件。如果你有兴趣了解更多关于无服务器插件的知识，请看这里。</p><p id="2ac3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我们可以用<code class="fe nk nl nm nn b">pip install lambda_decorators</code>安装<code class="fe nk nl nm nn b">lambda-decorators</code>包。为了使用它，我们将更新我们的<code class="fe nk nl nm nn b">handler.py</code>文件以包含<code class="fe nk nl nm nn b">from lambda_decorators import cors_headers</code>，并更新我们的函数以使用我们刚刚导入的装饰器。更新后的文件如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="ce1e" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤4:打包更新</h1><p id="d01f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">因为您可能没有使用与AWS相同的操作系统，所以您安装的依赖项不会在它们的服务器上运行。为了解决这个问题，我们使用<a class="ae kv" href="https://www.docker.com" rel="noopener ugc nofollow" target="_blank"> Docker </a>。如果你不熟悉Docker，没关系，只要按照这些安装说明并确保Docker在你的电脑上运行。</p><p id="dbd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经安装了<code class="fe nk nl nm nn b">serverless-python-requirements</code>包，其中包括一个<code class="fe nk nl nm nn b">dockerizePip</code>选项来促进这一点。要使用它，只需将以下内容添加到<code class="fe nk nl nm nn b">serverless.yml</code>的底部</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="9fca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于这个命令的更多细节，你可以在这里看到<a class="ae kv" href="https://serverless.com/blog/serverless-python-packaging/" rel="noopener ugc nofollow" target="_blank">这里看到</a>和<a class="ae kv" href="https://github.com/UnitedIncome/serverless-python-requirements" rel="noopener ugc nofollow" target="_blank">这里看到</a>。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="59c7" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤5:部署我们的功能</h1><p id="0442" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我们现在准备好部署我们的功能了！首先，我们需要通过运行<code class="fe nk nl nm nn b">pip freeze &gt; requirements.txt</code>来创建我们的<code class="fe nk nl nm nn b">requirements.txt</code>文件。</p><p id="2edf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，让我们配置我们的AWS凭证。您可以按照此处的步骤<a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/guide/credentials/" rel="noopener ugc nofollow" target="_blank">进行操作。当您到达</a><a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/guide/credentials#using-aws-access-keys" rel="noopener ugc nofollow" target="_blank"> <em class="nq">使用AWS访问键</em> </a> <em class="nq"> </em>部分时，遵循名为<a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/guide/credentials#using-aws-profiles" rel="noopener ugc nofollow" target="_blank"> <em class="nq">使用AWS概要文件</em></a><em class="nq"/>的小节，并创建一个名为<code class="fe nk nl nm nn b">aws-serverless-tutorial</code>的概要文件。如果需要，您可以直接编辑机器上的<code class="fe nk nl nm nn b">~/.aws/credentials</code>文件来配置您的配置文件。样本配置文件可能如下所示:</p><pre class="kg kh ki kj gt nr nn ns nt aw nu bi"><span id="32b0" class="nv mo iq nn b gy nw nx l ny nz">[default]<br/>aws_access_key_id = YOUR_ACCESS_KEY_ID<br/>aws_secret_access_key = YOUR_SECRET_ACCESS_KEY<br/>region=us-east-1</span><span id="bb5d" class="nv mo iq nn b gy oa nx l ny nz">[aws-serverless-tutorial]<br/>aws_access_key_id=YOUR_ACCESS_KEY_ID<br/>aws_secret_access_key=YOUR_SECRET_ACCESS_KEY<br/>region=us-east-1</span></pre><p id="4735" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在可以使用<code class="fe nk nl nm nn b">sls deploy -v --aws-profile aws-serverless-tutorial</code>来部署我们的功能。在该命令中，<code class="fe nk nl nm nn b">-v</code>标志是可选的，用于指定<em class="nq">详细</em>模式，即终端的额外记录。注意，我们还指定了我们想要部署的AWS概要文件。为不同的项目创建不同的概要文件是一个很好的实践。</p><p id="325d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请耐心等待，因为这需要几分钟时间。每次更改<code class="fe nk nl nm nn b">serverless.yml</code>文件时，必须运行该命令。如果您只编辑了正在部署的函数，那么您可以通过运行<code class="fe nk nl nm nn b">sls deploy -v --aws-profile aws-serverless-tutorial --function get-custom-greeting</code>来加速部署。(当然，一定要把<code class="fe nk nl nm nn b">get-custom-greeting</code>换成你的函数名。)</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="43f6" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤6:测试我们的功能</h1><p id="2e9f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">一旦部署完成，查找控制台的<em class="nq">堆栈输出</em>部分，并注意<em class="nq">服务端点</em>的值。这应该是类似<code class="fe nk nl nm nn b">https://kr3c39wj4o.execute-api.us-east-1.amazonaws.com/dev</code>的东西。这是我们函数的根URL。您的确切网址会有所不同。</p><p id="595d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果再往上看一点，在<em class="nq">服务信息</em>部分，您会看到我们刚刚创建的特定端点，类似于下面的代码片段:</p><pre class="kg kh ki kj gt nr nn ns nt aw nu bi"><span id="bbef" class="nv mo iq nn b gy nw nx l ny nz">endpoints:<br/>  GET - https://<!-- -->kr3c39wj4o<!-- -->.execute-api.us-east-1.amazonaws.com/dev/get-custom-greeting</span></pre><p id="296d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住，这个函数需要一个name参数，所以要看到它在实践中的工作，请将<code class="fe nk nl nm nn b">?first_name=yourName</code>附加到上面的URL——例如<code class="fe nk nl nm nn b">https://kr3c39wj4o.execute-api.us-east-1.amazonaws.com/dev/get-custom-greeting?first_name=Matt</code>——并在您的浏览器中打开该URL。您的函数响应现在应该显示出来了！</p><p id="8692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，它可能不会…</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="ed99" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">步骤7:故障排除</h1><p id="8b4a" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">如果令您失望的是，您没有看到您的结果，而是看到了<code class="fe nk nl nm nn b">{“message”: “Internal server error”}</code>，不要担心——我们只需要快速排除故障。</p><p id="c733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个错误消息是非常无用的。要获得更有用的版本，请按照以下步骤操作:</p><ol class=""><li id="a872" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ob ly lz ma bi translated">登录您的AWS帐户</li><li id="59fb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">导航至<em class="nq">服务</em> &gt; <em class="nq">云观察</em></li><li id="42c3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">在左侧的导航工具条中，点击<em class="nq">日志</em></li><li id="54dd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">选择适当的日志组，例如<code class="fe nk nl nm nn b"><a class="ae kv" href="https://kr3c39wj4o.execute-api.us-east-1.amazonaws.com/dev/get-custom-greeting" rel="noopener ugc nofollow" target="_blank">https://kr3c39wj4o.execute-api.us-east-1.amazonaws.com/dev/get-custom-greeting</a></code></li><li id="732b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">从该组中选择特定日志流以查看错误消息</li></ol><p id="31c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者，您可以使用无服务器直接查看日志，如这里的<a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/guide/workflow/" rel="noopener ugc nofollow" target="_blank">和这里的</a>和<a class="ae kv" href="https://serverless.com/framework/docs/providers/aws/cli-reference/logs/" rel="noopener ugc nofollow" target="_blank">所述。</a></p><p id="2102" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您很可能会看到以下错误:</p><pre class="kg kh ki kj gt nr nn ns nt aw nu bi"><span id="9258" class="nv mo iq nn b gy nw nx l ny nz">DistributionNotFound: The 'jsonschema' distribution was not found and is required by the application</span></pre><p id="d211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是<a class="ae kv" href="https://stackoverflow.com/a/54900374/10152004" rel="noopener ugc nofollow" target="_blank">由于</a>与AWS和<code class="fe nk nl nm nn b">requirements.txt</code>中列出的<code class="fe nk nl nm nn b">jsonschema</code>包不兼容。为了解决这个问题，我们将使用以下步骤强制将<code class="fe nk nl nm nn b">jsonschema</code>包升级到2.6.0:</p><ol class=""><li id="eb2f" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ob ly lz ma bi translated">打开<code class="fe nk nl nm nn b">requirements.txt</code>并将相应的行更新为<code class="fe nk nl nm nn b">jsonschema==2.6.0</code></li><li id="fb00" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">使用<code class="fe nk nl nm nn b">pip install -r requirements.txt</code>基于这个文件重新安装我们的依赖项</li><li id="01c2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">通过运行<code class="fe nk nl nm nn b">pip freeze &gt; requirements.txt</code>确保没有其他变化。在每次部署之前运行这个是一个很好的实践。</li><li id="8946" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ob ly lz ma bi translated">使用上面的命令重新部署我们的服务。由于我们在这个项目中可能有多个功能，为了简单起见，我们将部署完整的服务。但是，请注意，当您重新部署一个功能时，依赖关系会更新。</li></ol><p id="8788" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">刷新浏览器页面，这次您应该会看到您的消息！</p><p id="1ab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nk nl nm nn b">handler.py</code>中，我们将输入——我们的<code class="fe nk nl nm nn b">event</code>参数——作为响应的输出。因此，您看到的响应可能看起来有点混乱。如果您不需要这个输出，请随意删除它，然后重新部署您的功能。</p><p id="8cdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至此，您已经完成了，如果您准备深入研究，您可以查看<a class="ae kv" href="https://serverless.com/framework/docs/" rel="noopener ugc nofollow" target="_blank">的无服务器文档</a>！</p></div></div>    
</body>
</html>