<html>
<head>
<title>Introduction to Client Side and Server Side Pagination in TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript中客户端和服务器端分页介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/introduction-to-client-side-and-server-side-pagination-in-typescript-9edae72f94a0?source=collection_archive---------2-----------------------#2021-10-18">https://betterprogramming.pub/introduction-to-client-side-and-server-side-pagination-in-typescript-9edae72f94a0?source=collection_archive---------2-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7abc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在您的web应用程序界面中轻松管理大型数据集</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8762ce61923cad43f5decb4362ad37c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AxW0_UAxokmNfWRP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@disguise_truth?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安娜斯塔西娅·杰尼娜</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="aae6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分页是一种常见的Web UI技术，它将大型数据集分成多个页面，一次显示一个页面。通常情况下，分页发生在<a class="ae ky" href="https://en.wikipedia.org/wiki/Table_(information)" rel="noopener ugc nofollow" target="_blank">表</a>中，它是数据在行和列中的一种排列。然而，分页不限于表；其他组件也可能发生这种情况。</p><p id="bb7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分页可以在客户端或服务器端处理。在本文中，我们将介绍分页服务，并提供客户端分页和服务器端分页的示例。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7edd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">页码</h1><p id="cd2a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">分页是用有限的屏幕空间显示更多数据的UI表示。下面是由<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-introduction-to-ant-tables-for-javascript-developers-c420754c9fe7"> Ant表</a>显示的分页表。该表有两页，示例显示了第一页。在内部，它使用HTML <code class="fe mz na nb nc b">table</code>组件，用分页页脚显示页面信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/ce5aefb61a1b15f623c2b01d53eb07ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PTzhyWivnQyqL_sJg3Catg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0d75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个表格可以被设计成看起来不像表格，或者它可以被构造成没有<code class="fe mz na nb nc b">table</code>组件。以下UI来自亚马逊搜索结果，由<code class="fe mz na nb nc b">div</code>组件组成。它显示了共13页的第一页。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/e71d58e0d22bdbaba324c3179a27c3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMcrmjPSX2LCsBm93jD-0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图来自亚马逊</p></figure><p id="72c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于分页的表/组件，它需要以下信息:</p><ul class=""><li id="c91a" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">页面大小</li><li id="0703" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">页面索引</li><li id="389e" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">总菌数</li></ul><p id="3840" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个显示分页信息的UI。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b12a801d932b334d75ac89cd7c749c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*5Golzy3KLJY94Lo8-qwu6Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0a50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设有1885行，页面大小为20。<code class="fe mz na nb nc b">1885 / 20</code>的上限是95。因此，它以95页结束，其中每页有20行，除了最后一页有5行。当前页码是3，它显示了第41–60行，总共有<code class="fe mz na nb nc b">1885</code>行。</p><p id="f06a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，总计数是不可用的，但是您仍然可以进行上一页、下一页或任何特定页面的操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/799258611d5386bca2748391f48cde50.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*DIe7hpFjh2G4WBgxHRB0ng.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6d91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分页是一种显示多页中的一页的服务。分页表通常需要以下操作:</p><ul class=""><li id="50b9" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">获取数据:获取全部或部分数据集进行显示。</li><li id="1f01" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">设置页面数据:将提取的数据加载到表中。</li><li id="9b84" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">设置加载指示:显示加载指示，如旋转图标，在数据可用之前填充空白。</li><li id="ba1e" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">转到下一页:响应用户操作转到下一页，除非它是最后一页。</li><li id="51bc" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">转到上一页:响应用户操作转到上一页，除非它是第一页。</li><li id="0c80" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">转到特定页面:响应用户操作转到特定页面。</li><li id="1d91" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">集合排序:为表定义排序的列名和顺序(升序、降序或无顺序)。排序可以是单列排序，也可以是多列排序。</li><li id="9f0b" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">设置过滤器:定义表格的过滤标准。筛选可以应用于特定列，也可以应用于所有列(全局筛选)。对每次击键进行过滤的成本可能很高。<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/lodash-create-react-apps-built-in-library-for-debounce-and-throttle-with-hooks-3418087f44d8">去抖和节流</a>通常用于控制过滤功能被调用的速率。这样就避免了一些不必要的调用，提高了性能。</li><li id="1c22" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">页面自动刷新:显示表格后，数据可能会变得陈旧。自动刷新基于服务器推送或客户端轮询。更新的数据可以直接上传到表格，或者表格显示陈旧数据指示。</li></ul><p id="d3c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/understanding-the-ant-design-system-a-ui-design-for-enterprises-39afdb188b06"> Ant设计系统</a>是企业级UI设计语言和React UI库的开源代码，其中Ant table为我们实现了分页服务。我们可以简单地调用服务来完成客户端分页或服务器端分页。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="713c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">建立工作环境</h1><p id="a6e3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们使用<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/10-fun-facts-about-create-react-app-eb7124aa3785"> Create React App </a>来探索分页。</p><pre class="kj kk kl km gt nv nc nw nx aw ny bi"><span id="8616" class="nz md it nc b gy oa ob l oc od">npx create-react-app react-ant-table --template typescript<br/>cd react-ant-table</span></pre><p id="08e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="0560" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第1行安装Ant设计系统。</p><p id="f1e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第2行安装了React的类型定义。</p><p id="fdf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第3行安装了<code class="fe mz na nb nc b"><a class="ae ky" href="https://github.com/Marak/faker.js" rel="noopener ugc nofollow" target="_blank">faker</a></code>，这个库为我们的例子生成人名和城市名。</p><p id="7db2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第4行安装了<code class="fe mz na nb nc b">faker</code>的类型定义。</p><p id="103d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第5行安装了<code class="fe mz na nb nc b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/setting-up-mocks-for-react-development-storybook-and-testing-8f5cedb66257">fetch-mock</a></code>，一个模拟后端调用的库。</p><p id="6c8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是<code class="fe mz na nb nc b">package.json</code>中附加的<code class="fe mz na nb nc b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/package-jsons-dependencies-in-depth-a1f0637a3129">dependencies/devDependencies</a></code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="86c2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">客户端分页</h1><p id="3f9c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">客户端分页向服务器发出一个查询来获取所有数据。客户端将所有数据保存在内存中，并通过页面索引显示其中的一部分。客户端分页总是有总数据计数。</p><h2 id="c1eb" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">数据源</h2><p id="b30a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们为一个表构建一个数据源，这个表由1000条孩子信息记录组成。每份记录都有孩子的名字、年龄和居住的城市。下面是在Create React应用程序环境中创建的<code class="fe mz na nb nc b">src/dataSource.tsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="dfde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第4–9行为每条记录定义了<code class="fe mz na nb nc b">DataType</code>。<code class="fe mz na nb nc b">key</code>是蚂蚁表的推荐属性。</p><p id="f998" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第11–30行定义了3列，包括排序器UI(上下箭头)和排序算法(第15、21和27行)。</p><p id="1c7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第32–43行定义了一个创建1000个孩子记录的服务。它使用<code class="fe mz na nb nc b">faker</code>生成随机的孩子名字(第37行)和城市名字(第39行)。年龄是为5到9之间的数字随机生成的(第38行)。</p><p id="8fc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第46行调用<code class="fe mz na nb nc b">getData()</code>将<code class="fe mz na nb nc b">allData</code>中的记录存储在服务器上。</p><p id="207d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第48行模拟一个HTTP <code class="fe mz na nb nc b">GET</code>方法，在一次调用中返回<code class="fe mz na nb nc b">allData</code>。</p><h2 id="78bd" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">分页代码</h2><p id="fa42" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们调用数据源来获取客户端分页的所有数据。该表使用Ant table的排序UI和功能，但是过滤UI和功能是专有实现的。下面是修改后的<code class="fe mz na nb nc b">src/App.tsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="c9a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第11–13行调用模拟服务。</p><p id="34d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第15–20行调用端点<code class="fe mz na nb nc b">'/v2/kids'</code>，以获取所有的孩子记录，并将它们保存在<code class="fe mz na nb nc b">kidList</code>(第18行)。</p><p id="cb1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第22–30行通过<code class="fe mz na nb nc b">filterString</code>(第23行)过滤表格的所有列(第27行)，忽略字母大小写。结果保存到<code class="fe mz na nb nc b">displayList</code>。</p><p id="ee73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第34–47行构建了一个用于过滤的输入字段(第44行)。</p><p id="1891" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第48行用<code class="fe mz na nb nc b">displayList</code>和<code class="fe mz na nb nc b">columns</code>定义构建客户端分页表。默认页面大小为10。</p><p id="24b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分页就像一行代码(第48行)一样简单，我们有分页表。它显示了100页，每页有10条记录。如果适用，我们可以转到上一页或下一页，或者选择特定的页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/cad6d9efca295832c85d26cac2f9eef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThnaTsDgXsdunxcv7qc9XA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a8b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分页表可以排序。以下是将<code class="fe mz na nb nc b">name</code>按升序排序后的第一页。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/72f6c9adb0dbd697fe9dba95cd19690a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RwfiDLSChhY0AR5yxWiQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="da37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe mz na nb nc b">'smith'</code>上过滤后，还剩7条记录(1页)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/6e93756fd265b6ebcadd7a6f7859a9a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BcTBeMx_vhngYLgx7iLggQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="9bfb" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">用例</h2><p id="2f8a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">客户端分页适合少量数据。由于所有内容都已经预加载，所以后续的页面加载很快。当所有数据都可用时，可以在客户端执行排序和过滤。</p><p id="07fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">客户端分页要求浏览器支持并启用Javascript，但对于大多数情况来说，这应该不是什么大事。但是，当数据量很大时，提取所有数据会导致很大的页面负载。加载一大块数据需要更长时间，更糟糕的是，它可能会使后端服务崩溃或导致浏览器崩溃。</p><p id="90ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于以下用例，应该考虑客户端分页:</p><ul class=""><li id="c7f1" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">数据量相对较小。</li><li id="1f8a" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">所有数据的初始页面加载相当快。</li><li id="c049" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">客户端的排序和过滤相当快。</li><li id="881b" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">用户可能会查看所有页面。</li><li id="2d61" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">分页主要是为了表示的目的。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3cf2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">服务器端分页</h1><p id="9b02" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">服务器端分页请求在导航时单独加载每个页面。服务器需要支持分页，然后客户端能够请求具有指定页面大小、页面索引以及可能的排序顺序和过滤标准的数据集。服务器用适当的子集数据和总计数进行响应。</p><h2 id="34fd" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">数据源</h2><p id="a1d9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们为一个表构建一个数据源，这个表有1000条相同的kid信息记录，尽管每次运行随机生成的数据可能不同。下面是在Create React应用程序环境中创建的<code class="fe mz na nb nc b">src/dataSource.tsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="b6e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第4–9行为每条记录定义了<code class="fe mz na nb nc b">DataType</code>。</p><p id="e1d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第11–14行定义了服务器响应的<code class="fe mz na nb nc b">ResponseType</code>，包括<code class="fe mz na nb nc b">total</code>数据计数，以及部分数据<code class="fe mz na nb nc b">list</code>。</p><p id="a9f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第16–18行定义了<code class="fe mz na nb nc b">DataTypeIndex</code>来启用带有属性值的数组索引。</p><p id="49e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第20–39行定义了3列，包括排序器UI(上下箭头)(第15、21和27行)，没有排序算法。</p><p id="682f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第41–52行定义了一个创建1000个孩子记录的服务。</p><p id="d09a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第54行调用<code class="fe mz na nb nc b">getData()</code>将记录存储在服务器的<code class="fe mz na nb nc b">allData</code>中。</p><p id="10c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第57–101行模拟了一个HTTP <code class="fe mz na nb nc b">POST</code>方法，根据客户端提供的<code class="fe mz na nb nc b">pageIndex</code>(第62行)、<code class="fe mz na nb nc b">pageSize</code>(第63行)、过滤字符串(第67行的<code class="fe mz na nb nc b">query</code>)和排序定义(第76–87行的<code class="fe mz na nb nc b">sortBy</code>和<code class="fe mz na nb nc b">sortOrder</code>)，检索服务器过滤(第66–72行)、排序(第75–88行)的当前页面(第92行的数据子集)。</p><p id="8b87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，服务器数据源承担了过滤、排序和分页的重任。</p><h2 id="de8a" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">显示分页数据</h2><p id="e2ea" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于服务器端分页，客户端代码负责提供<code class="fe mz na nb nc b">pageSize</code>、<code class="fe mz na nb nc b">pageIndex</code>、<code class="fe mz na nb nc b">sortBy</code>、<code class="fe mz na nb nc b">sortOrder</code>、<code class="fe mz na nb nc b">query</code>等选项。当服务器数据源用当前页面响应时，客户端UI需要正确地解释它。下面的代码使用Ant table的排序和过滤UI，没有实现排序算法。下面是修改后的<code class="fe mz na nb nc b">src/App.tsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="d9b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第14–16行调用模拟服务。</p><p id="4c4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第18–32行调用端点<code class="fe mz na nb nc b">'/v2/kids'</code>，以检索当前页面的kid记录，并将它们保存在<code class="fe mz na nb nc b">kidList</code>(第30行)。<code class="fe mz na nb nc b">pageSize</code>、<code class="fe mz na nb nc b">pageIndex</code>、<code class="fe mz na nb nc b">sortBy</code>、<code class="fe mz na nb nc b">sortOrder</code>和<code class="fe mz na nb nc b">query</code>作为<code class="fe mz na nb nc b">POST</code>方法的体选项发送。</p><p id="cbff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第36–49行构建了一个用于过滤的输入字段(第46行)。</p><p id="8d93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第50–59行显示带有<code class="fe mz na nb nc b">kidList.list</code>(第51行)和<code class="fe mz na nb nc b">columns</code>定义(第52行)以及分页设置(第53行)的当前页面。第54–58行设置分页选项。</p><p id="0868" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从用户的角度来看，服务器端分页UI看起来与客户端分页相同。它显示了100页，每页有10条记录。如果适用，我们可以转到上一页或下一页，或者选择特定的页面。排序和过滤也以同样的方式工作。</p><p id="6352" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，有一个微妙的区别。初始页面加载速度更快，数据块更小，而后续页面加载需要新的读取。</p><h2 id="542b" class="nz md it bd me og oh dn mi oi oj dp mm li ok ol mo lm om on mq lq oo op ms oq bi translated">用例</h2><p id="4497" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">服务器端分页适合大型数据集。每页较少的负载提供了稳定性和可伸缩性。后续页面的额外加载时间可以通过预取接下来的几个页面来抵消，这也称为混合服务器和客户端分页。由于获取数据的频率更高，服务器端分页对并发更改的适应能力更强。一如既往，服务器的计算能力比浏览器更强。它们以更有效的方式处理排序和过滤。</p><p id="79d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果服务器端分页处理巨大的数据集，总的数据计数可能不可用。正如我们所见，谷歌搜索结果没有一个固定的总数。用户必须继续前进，直到到达终点。</p><p id="7717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于以下用例，应该考虑服务器端分页:</p><ul class=""><li id="d1f9" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">数据量大。</li><li id="97fe" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">排序和过滤操作非常耗时。</li><li id="9a7f" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">用户可能只会查看初始页面。</li><li id="9551" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">后端支持服务器端分页。</li><li id="15d1" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">需要更强的适应并发变化的能力。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="675d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="873d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们已经浏览了分页服务，并演示了客户端分页和服务器端分页的例子。选择主要取决于数据大小。</p><p id="7195" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">客户端分页适用于少量数据，主要用于表示目的。服务器端分页处理大量数据，并提供稳定性和可伸缩性。</p><p id="5ec2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。我希望这有所帮助。如果你有兴趣，可以看看<a class="ae ky" href="https://jenniferfubook.medium.com/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">我的其他媒体文章</a>。</p></div></div>    
</body>
</html>