<html>
<head>
<title>How To Use Firebase in SwiftUI’s New Application Lifecycle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI的新应用生命周期中使用Firebase</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-firebase-in-swiftuis-new-application-lifecycle-c77a8a306d63?source=collection_archive---------8-----------------------#2021-02-16">https://betterprogramming.pub/how-to-use-firebase-in-swiftuis-new-application-lifecycle-c77a8a306d63?source=collection_archive---------8-----------------------#2021-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8fc9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用SwiftUI 2.0探索Firebase</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ec42fbdd785360f531ac644a677daec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ocl9CUu4BgGHxd0ht8oUzA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="650e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SwiftUI 2.0给我们带来了很多新功能。我最喜欢的是新的应用程序生命周期，因为它比旧的更简单，但用Firebase配置它可能会很棘手。</p><p id="d65a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将学习如何用SwiftUI的新生命周期配置Firebase。</p><p id="4d90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们来看看新旧app生命周期的区别！</p><p id="8d06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">注:您可以在GitHub上</em> <a class="ae lv" href="https://github.com/Unobliging/How-to-Use-Firebase-in-SwiftUI-s-New-Application-Lifecycle" rel="noopener ugc nofollow" target="_blank"> <em class="lu">下载本文的示例项目和源代码</em> </a> <em class="lu">。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d5aa" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">UIKit应用委托生命周期与SwiftUI生命周期</h1><p id="f2dc" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">有了UIKit的生命周期，你需要在<code class="fe na nb nc nd b">didFinishLaunchingWithOptions</code>方法中编写Firebase的<code class="fe na nb nc nd b">configure()</code>函数。此方法用于首次打开应用程序时应该完成的操作。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="7e73" class="ni me it nd b gy nj nk l nl nm"><strong class="nd iu">import</strong> UIKit<br/><strong class="nd iu">import</strong> Firebase</span><span id="fffb" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">@UIApplicationMain</strong><br/><strong class="nd iu">class</strong> AppDelegate: UIResponder, UIApplicationDelegate {<br/>    <strong class="nd iu">var</strong> window: UIWindow?</span><span id="d03d" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">    func</strong> application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; <strong class="nd iu">Bool</strong> {<br/>    FirebaseApp.configure()<br/><strong class="nd iu">       return true</strong><br/>    }<br/>}</span></pre><p id="be0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SwiftUI的生命周期与UIKit不同，因为SwiftUI是一个声明性框架。这就是为什么有不同的方法和类。显然，我们将在SwiftUI生命周期中使用的方法会略有不同。</p><p id="4db0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你以前一起使用过SwiftUI和UIKit，你知道我们想在SwiftUI中使用的一些类或方法来自UIKit，因为SwiftUI中仍然不支持很多东西。我们将从UIKit获得帮助，同时使SwiftUI应用生命周期适应Firebase。</p><p id="f15c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">目前，我不能说它们之间有显著的区别。也许SwiftUI 3.0会改变这一切。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="c808" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">开始使用SwiftUI的新生命周期</h1><p id="8553" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">首先，我们需要创建一个新的Xcode项目(要使用SwiftUI的新生命周期，需要<a class="ae lv" href="https://apps.apple.com/tr/app/xcode/id497799835?mt=12" rel="noopener ugc nofollow" target="_blank"> Xcode 12 </a>)。)创建新项目时，确保“界面”是“SwiftUI”，“生命周期”是“SwiftUI App”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/eeb354eadd92a9b1b9f3504e5325dd5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMqlUNTZcckTObAymJokkQ.png"/></div></div></figure><p id="ec31" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建一个项目后，进入<code class="fe na nb nc nd b">ExampleProjectApp.swift</code>文件(你的项目名称可以和我的不同)。当使用新的应用程序生命周期时，参与生命周期的最早可能点是通过向应用程序的主入口点添加初始化器。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="5bac" class="ni me it nd b gy nj nk l nl nm"><strong class="nd iu">import</strong> SwiftUI</span><span id="2d48" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">@main</strong><br/><strong class="nd iu">struct</strong> Example_ProjectApp: App {<br/>    <strong class="nd iu">var </strong>body: some Scene {<br/>         WindowGroup {<br/>            ContentView()<br/>         }<br/>    }<br/>}</span></pre><p id="858f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设您正在这个项目上配置Firebase。我们需要在这个文件上导入Firebase。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="9779" class="ni me it nd b gy nj nk l nl nm"><strong class="nd iu">import</strong> SwiftUI<br/><strong class="nd iu">import</strong> Firebase</span></pre><p id="b6e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">嗯，我们如何初始化Firebase？答案很简单:<code class="fe na nb nc nd b">init</code>方法。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="cca5" class="ni me it nd b gy nj nk l nl nm">import SwiftUI<br/>import Firebase</span><span id="c1e8" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">@main</strong><br/><strong class="nd iu">struct</strong> Example_ProjectApp: App {</span><span id="f216" class="ni me it nd b gy nn nk l nl nm">    // MARK: - Life Cycle<br/>    <strong class="nd iu">init</strong>() {<br/>        FirebaseApp.configure()<br/>    }<br/>  <br/>    // MARK: - UI Elements<br/>    <strong class="nd iu">var</strong> body: <strong class="nd iu">some</strong> Scene {<br/>        WindowGroup {<br/>            MainScreen()<br/>        }<br/>    }<br/>}</span></pre><p id="96ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这适用于Firebase SDKs，如Cloud Firestore，但对于Firebase Cloud Messaging来说还不够，因为它使用方法swizzling来挂钩应用程序生命周期。这种机制允许框架拦截对特定方法的调用，并在将调用传递给应用程序之前处理它们。</p><p id="3572" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，您需要使用<code class="fe na nb nc nd b">@UIApplicationDelegateAdaptor</code>属性包装器将您的应用程序连接到<code class="fe na nb nc nd b">AppDelegate</code>的实例。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="42b8" class="ni me it nd b gy nj nk l nl nm"><strong class="nd iu">import</strong> SwiftUI<br/><strong class="nd iu">import</strong> Firebase</span><span id="bdc1" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">class</strong> AppDelegate: NSObject, UIApplicationDelegate {<br/>    <br/>    // MARK: - Methods<br/>    <strong class="nd iu">func</strong> application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : <strong class="nd iu">Any</strong>]? = <strong class="nd iu">nil</strong>) -&gt; <strong class="nd iu">Bool</strong> {<br/>        <strong class="nd iu">return</strong> <strong class="nd iu">true</strong><br/>    }<br/>}</span><span id="d037" class="ni me it nd b gy nn nk l nl nm"><strong class="nd iu">@main</strong><br/><strong class="nd iu">struct</strong> Example_ProjectApp: App {<br/>    <br/>    // MARK: - Properties<br/>    <strong class="nd iu">@UIApplicationDelegateAdaptor</strong>(AppDelegate.<strong class="nd iu">self</strong>) <strong class="nd iu">var</strong> delegate<br/>  <br/>    // MARK: - Life Cycle<br/>    <strong class="nd iu">init</strong>() {<br/>        FirebaseApp.configure()<br/>    }<br/>  <br/>    // MARK: - UI Elements<br/>    <strong class="nd iu">var</strong> body: <strong class="nd iu">some</strong> Scene {<br/>        WindowGroup {<br/>            ContentView()<br/>        }<br/>    }<br/>}</span></pre><p id="2b58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同时，您将能够逐步迁移到新的应用程序生命周期模型。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="a73a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="3012" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">我希望这篇文章对你有所帮助。我会继续写Firebase，敬请期待！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2eca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想见我或有关于iOS开发等问题。你可以在这里和我<a class="ae lv" href="https://superpeer.com/canbalkya" rel="noopener ugc nofollow" target="_blank">进行一对一的会谈。</a></p></div></div>    
</body>
</html>