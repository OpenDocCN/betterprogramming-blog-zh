<html>
<head>
<title>Web Scraping With Google Sheets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google Sheets进行网页抓取</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/web-scraping-with-google-sheets-20d0dce323cc?source=collection_archive---------1-----------------------#2018-05-16">https://betterprogramming.pub/web-scraping-with-google-sheets-20d0dce323cc?source=collection_archive---------1-----------------------#2018-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="436b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">四个不同的功能，你可以用谷歌工作表来抓取网页</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/92970e53f81d1194389fdba39a8b510e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAXfLsOCXh8zr6KU3vIJmA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/man-using-ballpoint-pen-374820/" rel="noopener ugc nofollow" target="_blank">爆发</a>在<a class="ae ky" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="99e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网络抓取和利用各种API是从网站和应用程序收集数据的好方法，这些数据随后可以用于<a class="ae ky" href="http://www.acheronanalytics.com/acheron-blog/a-guide-to-data-wrangling-for-data-science-projects" rel="noopener ugc nofollow" target="_blank">数据分析</a>。一些公司的整个商业模式都集中在网络抓取上。HiQ抓取各种“公共”网站来收集数据，并为公司提供关于其员工的分析。他们帮助公司利用不同网站的数据，如LinkedIn和其他公共资源，找到顶尖人才，以获得他们算法所需的信息。</p><p id="09db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当LinkedIn要求他们停止使用某些技术方法来减缓HiQ的网络爬虫时，他们遇到了法律问题。<a class="ae ky" href="https://www.theregister.co.uk/2017/08/14/hiq_linkedin_bots_scraping/" rel="noopener ugc nofollow" target="_blank"> HiQ随后起诉Linkedin并胜诉！</a>法官说只要数据公开，刮就OK！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/f6acc8f88ba760d5996ff2b78801d236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MPt2rectMhwklT63.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="http://www.commitstrip.com/en/2015/05/19/data-wars/" rel="noopener ugc nofollow" target="_blank"> CommitStrip </a></p></figure><p id="cde6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Web抓取通常需要对HTTP请求、伪造标题、复杂的Regex语句、HTML解析器和数据库管理技能有复杂的理解。</p><p id="09fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一些编程语言可以让这变得容易得多，比如Python。Python提供了像Scrapy和BeautifulSoup这样的库，使得抓取和解析HTML更加容易。</p><p id="f216" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，它仍然需要适当的设计和对编程和网站架构的理解。</p><p id="36c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Sheets提供了几个有用的功能，可以帮助那些没有时间学习编程的人搜集web数据。如果你想看我们网上研讨会的视频，请在下面查看。如果没有，你可以继续阅读并弄清楚如何使用Google Sheets来抓取网站。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lw lx l"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="a96a" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">用于网页抓取的Google Sheet函数</h1><p id="56d4" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated"><strong class="lb iu">您可以使用Google Sheets进行网页抓取的功能有:</strong></p><ul class=""><li id="8fa9" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">导入XML</li><li id="1167" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">进口</li><li id="0081" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">进口饲料</li><li id="ce21" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">导入数据</li></ul><p id="4f5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些功能将根据提供给该功能的不同参数来抓取网站。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="8235" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">使用ImportFeed的网页抓取</h1><p id="a3ce" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">ImportFeed Google Sheets功能是比较容易使用的功能之一。它只需要访问Google Sheets和一个RSS提要的URL。这是一个通常与博客相关联的提要。</p><p id="6c85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，你可以使用这个RSS源:"http://www.acheronanalytics.com/2/feed"。</p><p id="75b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你如何使用这个功能？下面给出一个例子:</p><p id="9b71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nq">" = import feed(" http://www . acheronalanalytics . com/2/feed ")</em></p><p id="c57b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们所需要的！还有一些其他提示和技巧可以帮助清理数据馈送，因为您将获得不止一列信息。目前，这是网络抓取的一个良好开端。</p><h2 id="a69b" class="nr mg it bd mh ns nt dn ml nu nv dp mp li nw nx mr lm ny nz mt lq oa ob mv oc bi translated">Google工作表导入功能更新了吗？</h2><p id="ed33" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">所有这些导入功能每两个小时自动更新一次数据。可以设置触发功能来增加更新的频率。然而，这需要更多的编程。</p><p id="ab9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下就是这样！从这里开始，一切都取决于您的团队如何使用它！确保你设计了一个可靠的数据收集系统。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/cb89081877ce47ef8bac25e6eb61e154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yjcGSCF4FFQ-eAvb.png"/></div></div></figure><p id="7a89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图是使用ImportFeed函数的一个例子。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="56f3" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">使用ImportXML进行网页抓取</h1><p id="7e66" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Google Sheets中的ImportXML函数用于提取使用HTML ids和类的特定数据点。这需要对HTML和解析XML有所了解。这可能有点令人沮丧。所以我们创建了一个HTML网页抓取的分步指南。</p><p id="2a1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是来自Eventbrite页面的一些示例:</p><ol class=""><li id="6278" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu oe ni nj nk bi translated">前往https://www.eventbrite.com/d/wa-埃弗雷特的<a class="ae ky" href="https://www.eventbrite.com/d/wa--everett/events/" rel="noopener ugc nofollow" target="_blank">/events/</a>。</li><li id="bf0e" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">右键单击“检查元素”</li><li id="233c" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">找到您感兴趣的HTML标签</li><li id="8d6d" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">我们在这里寻找<div class="list-card__body">的一些文字</div>。</li><li id="b1b5" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">所以这是棘手的部分。您需要从这个HTML标记中提取的第一部分是类型。这就像<div>、<a>、<img/>、<span>等等。可以使用“//”调用第一个标签，然后调用标签名。比如“//div”，“//a”或者“//span。”</span></a></div></li><li id="67f8" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">现在，如果你真的想得到“这里的一些文本”，你需要调用这个类。</li><li id="635e" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">这是在步骤5所示的方法中完成的。您会注意到它将“//div”与“[@class="class name here"]结合使用。</li><li id="249b" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">xml字符串是"<strong class="lb iu">//div[@ class = ' list-card _ _ body ']</strong>"</li><li id="4f42" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">还有一个数据值您可能想得到。</li><li id="bd5a" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">我们想得到所有的网址。</li><li id="02c6" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">在这种情况下，需要提取第一个HTML标记本身的特定值。例如，<a href="”https//www.google.com&quot;">点击这里</a>。</li><li id="5bde" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">那就像第七步。</li><li id="a2fb" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">xml字符串是"<strong class="lb iu"> //a/@href </strong>"</li><li id="3a63" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">ImportXML(URL，XML字符串)。</li><li id="06f0" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oe ni nj nk bi translated">import XML("<a class="ae ky" href="https://www.eventbrite.com/d/wa--everett/events/" rel="noopener ugc nofollow" target="_blank">https://www.eventbrite.com/d/wa-埃弗雷特/事件/ </a>"，"<strong class="lb iu">//div[@ class = ' list-card _ _ body ']</strong>")。</li></ol><p id="c84a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这个函数的真相是它需要很多时间。因此，它需要规划和设计一个好的谷歌表单，以确保你从使用它中获得最大的利益。否则，你的团队将会花费时间维护它，而不是开发新的东西。如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3e368f3903e27bc0a8675a49a7984eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/0*6KbqUGaQfvfHRA3w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://xkcd.com/" rel="noopener ugc nofollow" target="_blank"> Xkcd </a></p></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="1cff" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">使用ImportHTML进行网页抓取</h1><p id="1508" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">最后，我们将讨论ImportHTML。这将从网页导入表格或列表。例如，如果您想从一个包含<a class="ae ky" href="http://www.nasdaq.com/symbol/snap/real-time" rel="noopener ugc nofollow" target="_blank">股票价格</a>的网站中抓取数据，该怎么办？这一页有一个表格，上面有过去几天的股票价格。</p><p id="f8a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于过去的函数，需要使用URL。在URL的顶部，你必须提到你想要抓取网页上的哪个表格。你可以通过利用可能的数字来做到这一点。</p><p id="1d25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:importtml("【http://www.nasdaq.com/symbol/snap/real-time】"，6)。这将从上面的链接中抓取股票价格。</p><p id="3ec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的视频中，他们还展示了如何收集上面的股票数据，并将其与当天的股票行情融合在一起。一个团队可以创建一个算法，利用过去的股票价格、新文章和Twitter信息来选择是购买还是出售股票。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="4e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有什么好主意可以用网络抓取来做什么吗？你的网页抓取项目需要帮助吗？让我们知道！</p></div></div>    
</body>
</html>