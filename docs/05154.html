<html>
<head>
<title>Resampling Imbalanced Data and Applying Machine Learning Techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对不平衡数据进行重采样并应用机器学习技术</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/resampling-imbalanced-data-and-applying-ml-techniques-91ebce40ff4d?source=collection_archive---------12-----------------------#2020-06-15">https://betterprogramming.pub/resampling-imbalanced-data-and-applying-ml-techniques-91ebce40ff4d?source=collection_archive---------12-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="47b6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当您的数据不平衡时该怎么办</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e2679699020de39f0954d543e9510271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iP4Vf0LKZDKDAPjq.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不平衡数据集图解来源:-<a class="ae ky" href="https://us.123rf.com/450wm/boykung/boykung1211/boykung121100073/16393037-disbalance-high-resolution-3d-image-.jpg?ver=6" rel="noopener ugc nofollow" target="_blank">https://us . 123 RF . com/450 WM/boy kung/boy kung 1211/boy kung 121100073/16393037-不平衡-高分辨率-3d-图像-。jpg？ver=6 </a></p></figure><h1 id="bbda" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lr"><img src="../Images/e3ee3ac790fc3166745c9513b54f7fdb.png" data-original-src="https://miro.medium.com/v2/format:webp/0*xuBzVyb7340Gx7x9.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:-<a class="ae ky" href="https://miro.medium.com/max/1396/1*cd6AorHoJYMFyj7IZd2nOg.png" rel="noopener">https://miro . medium . com/max/1396/1 * CD 6 aorhojymfyj 7 izd 2 nog . png</a></p></figure><p id="e366" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果你处理机器学习问题，最终你会遇到不平衡的数据。那是什么呢？</p><p id="da5b" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu"> <em class="mo">当数据集中某一类的观测值明显低于其他类的观测值时，就会出现不平衡数据。</em> </strong></p><p id="5377" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">不平衡数据集的示例:</p><ul class=""><li id="0f28" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn mu mv mw mx bi translated">用于在医学诊断等中识别罕见疾病的数据集。</li><li id="3e55" class="mp mq it lu b lv my ly mz mb na mf nb mj nc mn mu mv mw mx bi translated">与信用卡欺诈或信用卡风险相关的数据集。</li><li id="d887" class="mp mq it lu b lv my ly mz mb na mf nb mj nc mn mu mv mw mx bi translated">与评估计算机网络攻击风险相关的数据集。</li></ul></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="9be8" class="kz la it bd lb lc nk le lf lg nl li lj jz nm ka ll kc nn kd ln kf no kg lp lq bi translated">当数据集不平衡时会发生什么？</h1><p id="be3f" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">当您应用带有不平衡数据的机器学习算法时，您获得的模型将更偏向于多数类，即您的模型将预测多数类而不是少数类。大多数机器学习模型都假设数据是均匀分布的。这导致不准确的预测。传统的机器学习算法旨在通过提高精度来减少误差，但它们没有考虑不平衡。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="5500" class="kz la it bd lb lc nk le lf lg nl li lj jz nm ka ll kc nn kd ln kf no kg lp lq bi translated">公制傻瓜</h1><p id="f742" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">通常，我们使用准确性作为模型的度量标准。这让我们觉得我们的模型是准确的，但它并没有让我们对模型有太多的了解。</p><p id="a572" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">例如，一个数据集有90%的总观测值属于A类，10%的总观测值属于b类。TK现在，如果您拆分您的模型并训练您的模型，那么大部分训练数据集包含A类观测值，并且预测您遇到的测试数据集标签您的预测观测值属于A类并提供更高的准确性，但实际上，您需要了解您的模型更偏向于A类，甚至不预测b类的一个标签。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/781ca5fd27d40beb36729591d8c54f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/0*xrAvNzlRpQs1CV1C.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><h1 id="b1c8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何识别模型中的偏差</h1><p id="f2bd" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">我们需要使用混淆矩阵作为模型的度量标准。例如，我们上面讨论的模型的混淆矩阵如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/166cfd2199631a78a3963b06575be74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/0*I7LeVAgasZ_LfCYj.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混淆矩阵-图片来源:作者</p></figure><p id="9b06" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果您看到类0有更多的观察值，而类1没有被预测，这意味着模型偏向于类0，这决定了我们的模型是不合适的。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="ec21" class="kz la it bd lb lc nk le lf lg nl li lj jz nm ka ll kc nn kd ln kf no kg lp lq bi translated">如何处理数据集中的不平衡</h1><p id="ae21" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">让我们考虑一个来自Kaggle 的<a class="ae ky" href="https://www.kaggle.com/praveengovi/credit-risk-classification-dataset" rel="noopener ugc nofollow" target="_blank">信用风险分类数据集。探索下面的数据集见解。</a></p><ol class=""><li id="7de7" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn nw mv mw mx bi translated">标注分类上的箱线图:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3f58416feae16a07efcb83f063b59073.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*CoGevlFDR44lMGAeRb0rJA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签类上的箱线图-图像来源:作者</p></figure><p id="cb89" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">2.标注分类上的计数器图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8b5cee028c10e34e012da4455535362f.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*Sp6kUGxIx-kdTswNc_Sm_g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签类上的对策</p></figure><p id="39b3" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">当我们在一些预处理技术后分割数据集，如将空值分为20%作为测试集，80%作为训练集，并执行随机森林分类时，我们得到<strong class="lu iu"> </strong>以下结果:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><ol class=""><li id="f3d8" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn nw mv mw mx bi translated">模型的准确率为80.88%</li><li id="2eff" class="mp mq it lu b lv my ly mz mb na mf nb mj nc mn nw mv mw mx bi translated">分类报告:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/dad6cbbb121e618fc8e7ceaa8a4452ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*xNVQTv9yvPaPSNfahazPig.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分类报告-图片来源:作者</p></figure><p id="f5ad" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">3.混淆矩阵:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/343f1cf33c6e76b5fb6d622203cb3ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*K345FJ1Cp0c7F3z2pvv37Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混淆矩阵-图片来源:作者</p></figure><p id="9b0d" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">通过这些评估指标，我们可以清楚地看到，该模型更偏向于0类，而不是1类的现实模型。我们需要应用一种策略来减少模型的偏差，以便它能够执行正确的分类。这个问题的解决方案是对数据进行重新采样。</p><h2 id="e0d4" class="od la it bd lb oe of dn lf og oh dp lj mb oi oj ll mf ok ol ln mj om on lp oo bi translated">重采样</h2><p id="b34d" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated"><strong class="lu iu">重采样</strong>是一种从原始数据样本中抽取重复<a class="ae ky" href="http://www.statisticssolutions.com/sample-size-calculation-and-sample-size-justification/sampling/" rel="noopener ugc nofollow" target="_blank">样本</a>的方法。这是一种统计推断的非参数方法-换句话说，重采样方法不涉及使用一般分布表(例如，正态分布表)来计算近似p概率值。尽管有平衡类的优势，这些技术也有它们的弱点。</p><p id="918c" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">有两种广泛使用的重采样类型:</p><ul class=""><li id="323f" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn mu mv mw mx bi translated">欠采样</li><li id="ae5f" class="mp mq it lu b lv my ly mz mb na mf nb mj nc mn mu mv mw mx bi translated">过采样</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl lr"><img src="../Images/76cb75e83850b578830f7af5b1f0f4ac.png" data-original-src="https://miro.medium.com/v2/format:webp/0*49LgGsY4l09sNwcR.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">编辑图片来源:-<a class="ae ky" href="https://pbs.twimg.com/media/EA8WwfaUYAgaPDY.jpg" rel="noopener ugc nofollow" target="_blank">https://pbs.twimg.com/media/EA8WwfaUYAgaPDY.jpg</a></p></figure><p id="3a49" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">欠采样</strong>包括从多数类中随机选择样本，并将其从训练数据集中删除。在随机欠采样中，大多数类实例被随机丢弃，直到达到更平衡的分布。</p><p id="d289" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">过采样</strong>包括从少数类中随机复制样本，并将它们添加到训练数据集中。</p><h2 id="90a2" class="od la it bd lb oe of dn lf og oh dp lj mb oi oj ll mf ok ol ln mj om on lp oo bi translated">在上述数据集中实现重采样</h2><p id="3434" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">在上面的例子中，很明显少数类是1，risk，所以我通过增加risk类的观测值对数据集进行过采样。实现如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0cce" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们从生成的数据中收集见解。</p><ol class=""><li id="2a68" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn nw mv mw mx bi translated">箱线图:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/39c1371eb22f39bcb40e5875d25fb420.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*gmvmd_embxItPO9eOABQ7Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标签类的箱线图-图像来源:作者</p></figure><p id="7428" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">2.计数器图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/7f180b762475ae01076d2e2678791bc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*3UNIfZWSaOx3Duxpnw_3qg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个标签类的对策-图像信用:作者</p></figure><p id="74df" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">现在我们需要将数据分成训练集和测试集。为此，我们将测试规模设为20%，并将随机森林分类<strong class="lu iu"> </strong>应用于该数据。然后，我们评估指标以获得洞察力。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="e816" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">以下是通过评估指标获得的结果:</p><ol class=""><li id="ed7a" class="mp mq it lu b lv lw ly lz mb mr mf ms mj mt mn nw mv mw mx bi translated">精度:模型的精度为92.22%</li><li id="7076" class="mp mq it lu b lv my ly mz mb na mf nb mj nc mn nw mv mw mx bi translated">分类报告:</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/d7e72105072d7c727a8b367f275eef7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*Zgja-SCVNoM7OYGOtG5Pkg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重采样数据后的分类报告-图像来源:作者</p></figure><p id="5f64" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">3.混淆矩阵:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/220256b237781c50318a2edbfb492325.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*4L3YajTjhkMP8JHIKO8ElA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据重采样后的混淆矩阵-图片来源:作者</p></figure><p id="58bb" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">观察上述结果后，我们可以说该模型在预测结果方面工作良好。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="e4ad" class="kz la it bd lb lc nk le lf lg nl li lj jz nm ka ll kc nn kd ln kf no kg lp lq bi translated">结论</h1><p id="4441" class="pw-post-body-paragraph ls lt it lu b lv np ju lx ly nq jx ma mb nr md me mf ns mh mi mj nt ml mm mn im bi translated">这就是当我们在机器学习中遇到不平衡数据问题时，我们如何使我们的模型无偏。</p><p id="b20d" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">感谢阅读！</p></div></div>    
</body>
</html>