<html>
<head>
<title>Everything You Need to Know About PWAs — Push Notifications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您需要了解的关于PWAs的一切—推送通知</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/everything-you-need-to-know-about-pwas-push-notifications-e870bb54e14f?source=collection_archive---------1-----------------------#2019-06-28">https://betterprogramming.pub/everything-you-need-to-know-about-pwas-push-notifications-e870bb54e14f?source=collection_archive---------1-----------------------#2019-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c043" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向您的应用添加推送通知，以提高用户参与度</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/30df8f94922f0d77f837e654adf2ebf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El1EL7puIfOtxCNYlzmzAQ.png"/></div></div></figure><p id="6f4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个关于<a class="ae lq" href="https://en.wikipedia.org/wiki/Progressive_web_applications" rel="noopener ugc nofollow" target="_blank">渐进式网络应用</a>的系列。如果你还不知道，请在阅读前先看看第一部分。</p><div class="lr ls gp gr lt lu"><a href="https://medium.com/@indreklasn/everything-you-need-to-know-about-pwas-8e41a7e745aa" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">你需要知道的关于PWAs的一切</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">移动开发环境很难上手。移动开发人员之前有很多决策…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">medium.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi ks lu"/></div></div></a></div></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3214" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">什么是推送通知？</h1><p id="05e2" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">通知是在用户设备上弹出的消息。通知可以由打开的应用程序在本地触发，也可以实时从服务器“推”给用户，即使应用程序没有运行。</p><p id="0e42" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">推送通知背后的主要思想是吸引用户，让每个人都了解最新的内容或功能。例如，您可能会从中型移动应用程序获得每日通知，这些是推送通知！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/cf094dcfb650fb942216e9cb91f9a096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvuy1MOVvKvPahzQMBsrQQ.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated"><a class="ae lq" href="https://developers.google.com/web/ilt/pwa/introduction-to-push-notifications" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/web/ILT/pwa/简介-推送通知</a></p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a688" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">了解Web上的推送通知</h1><p id="ba62" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">大多数现代浏览器允许我们向用户推送实时通知。我们通过<a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API" rel="noopener ugc nofollow" target="_blank">通知API </a>来实现这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/ff6cf24dc1f0b56f43a2030743a1b477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TwPfYzOCU0Dq18GQws2ZqQ.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">通知API—<a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/Notifications _ API</a></p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="01d4" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">检查许可</h1><p id="3030" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">一旦您注册了服务人员，您将可以全局访问通知API。首先，我们需要请求用户允许显示通知:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4cfd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nv nw nx ny b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Notification/requestPermission" rel="noopener ugc nofollow" target="_blank">requestPermission</a></code>承诺返回三个值之一:<code class="fe nv nw nx ny b">granted</code>、<code class="fe nv nw nx ny b">denied</code>或<code class="fe nv nw nx ny b">default</code>。</p><p id="eb1c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注:<code class="fe nv nw nx ny b">Safari Version 12.0.3 still uses callback to get the permission.</code></p><p id="42e8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注销，然后注册新的服务人员。将弹出通知提示。授予服务人员所需的访问权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/72f0192c8d61cebb330e6f3bc7ac7791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SY-yM54Xo7_vSjpMdMHhYA.gif"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">处理通知权限</p></figure><p id="cb29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按下“允许”后，浏览器将在您的设置下保存选择。在任何给定的时间，我们可以通过设置撤销通知。请确保不要滥用通知，否则，用户将撤销权限，并且永远不会再授予它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/7846efd18bd0f0cddb0b8a6658866a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P24i-n1L-lXzGbCka0BRug.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">勇敢://设置/内容/通知？搜索=网站+设置</p></figure><p id="b296" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想知道，我用的是<a class="ae lq" href="https://brave.com/" rel="noopener ugc nofollow" target="_blank">勇敢浏览器。</a>它和Chrome差不多，但默认情况下会屏蔽广告，而且没有追踪器。如果你没有使用基于Chromium的浏览器，快速搜索会告诉你如何访问通知设置。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5e19" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">我们可以如何处理通知？</h1><p id="70ae" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">我们想要的任何东西…嗯，差不多。我们发送推送通知的频率没有限制。我们试试看，发一个:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8cdf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nv nw nx ny b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer" rel="noopener ugc nofollow" target="_blank">ServiceWorkerContainer</a></code>接口的<code class="fe nv nw nx ny b">.ready</code>只读属性提供了一种延迟代码执行的方法，直到服务工作器处于活动状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/1e4c3e66ea0168a3a11fbb879e55ae9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MUhCrJnu8ow3aW44-d1jsA.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer#Properties" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/service worker container # Properties</a></p></figure><p id="20a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们注册新的服务人员时，我们应该会在屏幕上看到一个推送通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/9d1ba2f1169d3a38ebf5b6482a968646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPGGTUNL0R-NXQpANNYbqA.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">巴斯。巴斯。</p></figure><p id="dd3a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里要把用户体验放在心上。一定不要滥用这个新的超级大国！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3809" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">检查浏览器支持</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">检查通知API支持</p></figure><p id="9166" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并非所有的浏览器都支持新的通知API，因此我们必须确保浏览器中存在通知API。</p><p id="ce4e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们希望推送通知可重用并且具有更高的代码质量，只需将其提取出来即可:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e437" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，如果我们重新加载服务人员:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/27d7c8b76278600c008928e9d806c133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cgLLTwXIJGqCE3ZVxwWM0w.png"/></div></div></figure><p id="4acb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">瞧啊。可重复使用的推送通知。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8464edd5139c6e4fd65066b951101f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DkCx-Yh3aupxCBaG4gJ1QA.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">推送的工作原理—<a class="ae lq" href="https://web-push-book.gauntface.com/chapter-01/02-how-push-works/" rel="noopener ugc nofollow" target="_blank">https://we b-Push-book . gaunt face . com/chapter-01/02-how-Push-Works/</a></p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3fb0" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">浏览器支持</h1><p id="9e95" class="pw-post-body-paragraph ku kv it kw b kx ni ju kz la nj jx lc ld nk lf lg lh nl lj lk ll nm ln lo lp im bi translated">Web通知API是一项高度实验性的技术，将来很可能会改变。尽管API很脆弱，但在实时交易、在线约会(新的匹配)或突发新闻等应用程序中，让用户保持最新状态是非常有用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/a7b74a10f20c3a5e8eb7dfdc8937343e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7AnF6sbww1vZPbYPyszPw.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated"><a class="ae lq" href="https://caniuse.com/#search=notifications" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/#search=notifications</a></p></figure><p id="218d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">浏览器支持大部分都有，但可能会更好<em class="og">(看看你的iOS Safari、三星浏览器和Opera Mini)。</em>这个时候(2019)应该没人关心IE。</p><p id="9c39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想更深入地学习推送通知，我发现Web Push Book是一个非常有用的地方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/a22761ee368ab13a7df7c46daaac8a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NuvI-ktX02FAx6vIbMoV6w.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated"><a class="ae lq" href="https://web-push-book.gauntface.com/" rel="noopener ugc nofollow" target="_blank">https://web-push-book.gauntface.com/</a></p></figure><p id="6f83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">查看关于workbox的<a class="ae lq" href="https://medium.com/@indreklasn/everything-you-need-to-know-about-pwas-workbox-de5755672fb3" rel="noopener">下一章</a>以及它如何简化您的生活。</p><div class="lr ls gp gr lt lu"><a href="https://medium.com/@indreklasn/everything-you-need-to-know-about-pwas-workbox-de5755672fb3" rel="noopener follow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">关于PWAs，您需要了解的一切—工具箱</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">为你的渐进式网络应用添加预缓存、缓存策略、路由、后台同步将变得非常复杂…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">medium.com</p></div></div><div class="md l"><div class="oi l mf mg mh md mi ks lu"/></div></div></a></div><h2 id="af8d" class="oj mr it bd ms ok ol dn mw om on dp na ld oo op nc lh oq or ne ll os ot ng ou bi translated"><a class="ae lq" href="https://github.com/indreklasn/pwa-example/tree/part-2" rel="noopener ugc nofollow" target="_blank">在这里玩代码。</a></h2><div class="lr ls gp gr lt lu"><a href="https://github.com/indreklasn/pwa-example/tree/part-2" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">indreklasn/pwa-示例</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">通过在GitHub上创建帐户，为indreklasn/pwa-example开发做出贡献。</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">github.com</p></div></div></div></a></div><p id="9afd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！❤</p></div></div>    
</body>
</html>