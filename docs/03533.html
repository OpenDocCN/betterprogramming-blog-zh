<html>
<head>
<title>How to Convert a Traditional GraphQL Query to React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将传统的GraphQL查询转换成React钩子</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/convert-traditional-graphql-query-to-hooks-9fc50969914?source=collection_archive---------7-----------------------#2020-02-16">https://betterprogramming.pub/convert-traditional-graphql-query-to-hooks-9fc50969914?source=collection_archive---------7-----------------------#2020-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be2e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松转换</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b3478f91518db011b8ee8d964dd4d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCrlGOSW6rIOuQ_zuXmNqw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Justin Luebke 在<a class="ae ky" href="https://unsplash.com/s/photos/change?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9d8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不知道React钩子或者如何在GraphQL API中使用它们，先看看这篇文章。</p><p id="ce88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将告诉您如何轻松地将GraphQL查询转换为React Hooks。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="13b5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">GraphQL查询</h1><p id="5596" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最简单地说，GraphQL就是询问对象上的特定字段。让我们从一个非常简单的查询开始。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="6b5f" class="ne md it na b gy nf ng l nh ni">{ <br/> hero {<br/>   name<br/> }<br/>}</span></pre><p id="4a8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们运行时得到的结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="3ee7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以看到该查询与结果具有完全相同的形状。这对GraphQL来说是必不可少的，因为您总能得到您所期望的，并且服务器确切地知道客户端需要哪些字段。</p><p id="4099" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个在React类组件中进行GraphQL查询的实时示例。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="bca5" class="ne md it na b gy nf ng l nh ni">npm install react-apollo</span></pre><p id="0d14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个包为我们导出了<code class="fe nl nm nn na b">Query</code>。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4014" class="ne md it na b gy nf ng l nh ni">npm install graphql-tag</span></pre><p id="6d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将GraphQL查询字符串解析成标准GraphQL AST的JavaScript模板文字标签。</p><p id="50e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，从已安装的包中导入<code class="fe nl nm nn na b">Query</code>并使用它，如下例所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="9333" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你注意到，除了实际数据之外，我们还有两个状态，<code class="fe nl nm nn na b">error</code>和<code class="fe nl nm nn na b">loading</code>。</p><h2 id="9bf0" class="ne md it bd me no np dn mi nq nr dp mm li ns nt mo lm nu nv mq lq nw nx ms ny bi translated">装载状态</h2><p id="2aec" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当这个组件挂载时，在后台发送的GraphQL查询可能还没有完成。但是我们需要处理没有数据的临时状态，因此，我们在<code class="fe nl nm nn na b">loading</code>状态期间返回一些有用的文本。</p><p id="3ee5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种加载状态下，通常可以做一些有趣的事情，比如显示加载微调器。</p><h2 id="e5bf" class="ne md it bd me no np dn mi nq nr dp mm li ns nt mo lm nu nv mq lq nw nx ms ny bi translated">错误状态</h2><p id="e6cd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在，由于各种原因，查询也可能以<code class="fe nl nm nn na b">error</code>状态结束。有时GraphQL查询可能是错误的，或者服务器没有响应。</p><p id="dd42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管是什么原因，面向用户的UI应该显示一些信息来传达发生了错误。在这种错误状态下，通常您可以将这些错误消息发送给第三方服务，以跟踪哪里出错了。</p><p id="9fde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果您要将传统查询更改为Hooks，您必须执行以下操作:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c8fc" class="ne md it na b gy nf ng l nh ni">npm install @apollo/react-hooks</span></pre><p id="6ea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它将为您提供一个<code class="fe nl nm nn na b">useQuery</code>钩子，导入这个钩子，并如下例所示为您的函数式React组件使用它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="a098" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在我们将ID作为变量传递之后，上面的两个例子都对<code class="fe nl nm nn na b">Project</code>模型进行GraphQL查询，以获取特定项目的<code class="fe nl nm nn na b">name</code>。</p><p id="7772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个示例演示了React类组件的传统查询，而第二个示例演示了使用钩子的React功能组件。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7946" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="324e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">钩子是反应的一个强大的附加物。此外，React Hooks是一个强大的库，可以在React应用程序中使用带有GraphQL的钩子。我建议现在就使用钩子来接触GraphQL查询，因为您已经有了基础。</p><p id="21f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你今天学到新东西了吗？评论和反馈总能让作者开心。</p></div></div>    
</body>
</html>