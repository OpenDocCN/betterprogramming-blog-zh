<html>
<head>
<title>Build Rust Apps With Dev Containers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用开发容器构建Rust应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-rust-apps-with-dev-containers-3799b20ca683?source=collection_archive---------3-----------------------#2022-02-14">https://betterprogramming.pub/build-rust-apps-with-dev-containers-3799b20ca683?source=collection_archive---------3-----------------------#2022-02-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fe48" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你有没有想过试试Rust？立即开始使用VSCode和Devcontainers！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/23d497d166438e2eec139f771187a0d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WCxZXVqkRujGgZgl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ed6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Rust是这个领域的新生事物，它目前正在——也很有道理——引发大量炒作。喜欢Rust的原因有很多，但我认为它们在许多其他文章中都有涉及。我将使用Rust来进一步展示包含VS代码的开发容器是非常强大的工具，我认为所有开发人员都应该在他们的工具箱中拥有这些工具，而不是对Rust本身大肆渲染。</p><p id="a448" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我猜想，虽然许多技术博客的读者可能听说过Rust。但是我也猜想，没有多少人在您的机器上安装了工具，并开始使用Rust？</p><p id="5155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这不会是一个Rust语言教程——外面有很多这样的教程！本文将展示如何使用Visual Studio代码和Docker为Rust建立一个开发环境。我将演示如何在Docker容器<em class="lv"> </em>中构建一个全功能的Rust开发环境，这样你就可以不用在你的机器上安装任何特定于Rust的东西就可以开始了。</p><p id="869a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了说明这一点，我将使用<a class="ae ky" href="https://actix.rs/" rel="noopener ugc nofollow" target="_blank"> Acitx </a>构建一个简单的API示例。当然，如果我不加入一些测试，那就没什么意思了，所以我也要说了！</p><p id="443b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我以前的教程，您的机器的先决条件如下:</p><ul class=""><li id="b5cc" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><a class="ae ky" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="731b" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a></li><li id="5280" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">VSCode的'<a class="ae ky" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers" rel="noopener ugc nofollow" target="_blank">远程容器</a>'扩展</li><li id="3f6d" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">运行bash shell的终端</li><li id="1229" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">如果你用的是Windows，<a class="ae ky" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener ugc nofollow" target="_blank">我推荐WSL </a>，尽管这不是必须的。</li></ul><p id="acf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的代码可以在找到<a class="ae ky" href="https://github.com/AndyWatt83/rust-docker-dev-env" rel="noopener ugc nofollow" target="_blank">。想跳到最后就克隆回购！</a></p><h1 id="a81a" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">我们走吧！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/25a31106c7c0412b64c8ddafdede2ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J3JASi3diUYNA8-p"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@marie_enk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">玛丽·P</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="387d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先创建一个空文件夹，放入cd，然后打开VSCode。将它复制并粘贴到您的终端中，或者用传统的方式通过explorer来完成。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="a636" class="ni ml it ne b gy nj nk l nl nm">mkdir rust-devcontainer; \<br/>cd rust-devcontainer; \<br/>code .;</span></pre><p id="ef0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当VSCode打开时，按F1，并搜索添加开发容器。<em class="lv">注意:你需要安装</em> <a class="ae ky" href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers" rel="noopener ugc nofollow" target="_blank"> <em class="lv">扩展</em> </a> <em class="lv">。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e3873ae56cbc610d18afcf4521381513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*bI4g7vki_REjNDsR2TTxqw.png"/></div></figure><p id="4c27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">搜索“Rust”并添加容器配置文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d9b88a3a45eff850aad05c65b5d51b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*GSn_PSvi-nXvEWy59PMFXQ.png"/></div></div></figure><p id="9dd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择默认版本(撰写时为buster)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/bc4efced0970e15ddfd25fbc2a2ac8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*O9uI-uhn4tIJBkcxjL_jXA.png"/></div></figure><p id="f984" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">跳过任何附加功能，点击“确定”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d4bac62e8381d755849abffa6e084d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*CvogsiKIp-50eq59wz0dtg.png"/></div></figure><p id="3806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当自动添加配置文件时，VSCode将显示一个弹出窗口，让您打开容器。点击“在容器中重新打开”,在Docker中打开环境。</p><p id="c482" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">注意:如果弹出窗口没有出现，点击F1并搜索“在容器中重新打开”</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/eb7923ba69870974d4c3d9d4c11118e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*lhLmCa1hsJl2hz8OXlsb0g.png"/></div></figure><p id="080b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过打开一个终端并检查Rust工具是否可用，向自己证明您现在是在一个安装了所有Rust工具的容器中运行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/093ab861a46baf6622abb795d2865b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*7_-pyxlkcDeLWCfavCGDVw.png"/></div></figure><p id="3dd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦进入Rust环境，建立一个简单的API就非常简单了。通过在VSCode中打开终端并键入以下命令来初始化一个新的Rust项目:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="525a" class="ni ml it ne b gy nj nk l nl nm">cargo init</span></pre><p id="3d5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了表明我们已经真正启动并运行了rust环境，请转到<code class="fe ns nt nu ne b">src\main.rs</code>文件，并添加以下内容:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="8903" class="ni ml it ne b gy nj nk l nl nm">fn main() {<br/>   println!("Hello World!");<br/>}</span></pre><p id="ab01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在VSCode终端中，键入以下内容:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="99a4" class="ni ml it ne b gy nj nk l nl nm">cargo run</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ad08a8209cb4f1c18533ca8189ffe2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*tHU3gCKxdrnxu8PcNL0QKw.png"/></div></figure><p id="d760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！我们有一个全功能的Rust开发环境正在运行，我们已经准备好构建任意数量的应用程序。</p><p id="9dba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们使用Actix构建一个演示API。</p><h1 id="e23c" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">简单API</h1><p id="4287" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">在<code class="fe ns nt nu ne b">cargo.toml</code>文件中为Actix添加一个依赖项。</p><p id="9201" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:我现在用的是测试版。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="5363" class="ni ml it ne b gy nj nk l nl nm">[dependencies]<br/>actix-web = "<!-- -->4.0.0-beta.21<!-- -->"</span></pre><p id="601b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，删除“hello world”示例，并将其添加到<code class="fe ns nt nu ne b">src\main.rs</code>文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="e466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要确保它正常工作，请打开终端，键入</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="07e9" class="ni ml it ne b gy nj nk l nl nm">cargo run</span></pre><p id="27ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将启动在<code class="fe ns nt nu ne b">http://127.0.0.1:8080</code>上运行的API</p><p id="db52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在浏览器中访问该URL，您会看到它的行为符合预期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/407ccc6c48b65343191a5561726bd9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*m2nlw_n0Chv6iLyz-N34qQ.png"/></div></figure><p id="44bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止一切都很好，我们可以到此为止了。但是，在至少有一个单元测试运行之前，我是不会满意的，所以让我们开始吧。</p><h1 id="0a9f" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">测试</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/a8afd6f6f8d0d9f2fd1e9ae6390a6295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vPyiVEXFG8C0Buis"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="18cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到<code class="fe ns nt nu ne b">src\main.rs</code>文件，在逻辑下添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="c457" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并通过在VSCode中进入终端并键入以下命令来运行测试:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="68dc" class="ni ml it ne b gy nj nk l nl nm">cargo test</span></pre><p id="b022" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该看到测试通过了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1b968104ad02d19474b9903bb21145bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*sR2aJ15z7dWFSHrAoTMLlw.png"/></div></figure><p id="5614" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个可用的测试设置，但我确实喜欢测试浏览器，这样VSCode感觉更像一个“真正的IDE”。一如既往，社区提供了一个。</p><p id="fc0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在文件<code class="fe ns nt nu ne b">.devcontainer\devcontainer.json</code>中，向extensions属性添加另外两行</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="0f37" class="ni ml it ne b gy nj nk l nl nm">"swellaby.vscode-rust-test-adapter",<br/>"ms-vscode.test-adapter-converter"</span></pre><p id="5ef6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要退出并重新进入远程容器才能看到更改(F1，回到WSL，然后回到devcontainer)。重新加载环境后，您将看到熟悉的VSCode测试资源管理器。您可以直接从explorer中运行测试！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2358268695f430a8ca5713283ada1109.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*zvmHBQD5vOe_UbvGADpv3A.png"/></div></figure><p id="4300" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设一切正常，您可以从VSCode测试资源管理器中导航并运行测试。</p><h1 id="820e" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">结论</h1><p id="16f8" class="pw-post-body-paragraph kz la it lb b lc nw ju le lf nx jx lh li ny lk ll lm nz lo lp lq oa ls lt lu im bi translated">我认为这是暂时停下来的好地方。我们已经建立了一个相当全面的Rust开发环境，其中安装了一个基本的API、一个单元测试示例和一些基本的Rust扩展。</p><p id="67bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为这些都是使用devcontainers配置的，所以这个设置可以非常容易地在团队中共享，让每个人在几秒钟内就可以启动并运行一个一致的Rust dev环境——就像克隆一个repo一样长！</p><p id="7f08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这是对那些坚持到最后的人有用的阅读！我希望我已经改变了至少几个新的“农村人”！</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="59d5" class="ni ml it ne b gy nj nk l nl nm"><strong class="ne iu">Want to Connect?</strong></span><span id="2794" class="ni ml it ne b gy oh nk l nl nm">You can get in touch on <a class="ae ky" href="https://www.linkedin.com/in/andywatt83/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>.</span></pre></div></div>    
</body>
</html>