<html>
<head>
<title>Peaks.js — Interact With Audio Waveforms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Peaks.js —与音频波形交互</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/peaks-js-interact-with-audio-waveforms-b7cb5bd3939a?source=collection_archive---------0-----------------------#2019-10-22">https://betterprogramming.pub/peaks-js-interact-with-audio-waveforms-b7cb5bd3939a?source=collection_archive---------0-----------------------#2019-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0535" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Peaks.js是一个客户端JavaScript组件，用于在浏览器中显示音频波形并与之交互</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/baaa84117a548e45071b9dba9b7b6dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWGJDryQeSTTuJK8A1yykQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Peak.js演示</p></figure><p id="119a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Peaks.js由<a class="ae lu" href="https://www.bbc.co.uk/rd" rel="noopener ugc nofollow" target="_blank"> BBC R &amp; D </a>开发，允许用户在浏览器中使用后端API提供波形数据，对音频内容进行精确剪辑。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/514ae5f63874a9b96eddbe2711d80efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CixGx8f1AL8DQARv8LTydQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Peak.js <a class="ae lu" href="https://github.com/bbc/peaks.js" rel="noopener ugc nofollow" target="_blank"> Github </a>页面</p></figure><p id="dff4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Peaks.js使用HTML canvas元素以不同的缩放级别显示波形，并且它具有允许您定制波形视图的配置选项。Peaks.js允许用户与波形视图进行交互，包括缩放和滚动。用户还可以创建一个点或段标记，表示要剪切或参考的内容；例如区分音乐和语音或者识别不同的音乐轨道。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/544571eccb8df24d0fa925aa29771511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOVdiCSqrynlwgXjSVYFCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Peaks.js工作流</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="6b16" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">Peak.js功能</h1><ul class=""><li id="1e50" class="mw mx it la b lb my le mz lh na ll nb lp nc lt nd ne nf ng bi translated">可缩放和滚动的波形视图</li><li id="80c2" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">固定宽度波形视图</li><li id="2a5c" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">鼠标、触摸、滚轮和键盘交互</li><li id="6dab" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">客户端波形计算，为方便起见，使用Web音频API</li><li id="a639" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">服务器端波形计算，提高效率</li><li id="d3c8" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">单声道、立体声或多声道波形视图</li><li id="cba9" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">创建点或线段标记注释</li><li id="b3e8" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">可定制的波形视图</li></ul><p id="73bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在BBC R &amp; D的网站上阅读更多关于这个项目的内容并观看演示。</p><div class="nm nn gp gr no np"><a href="https://waveform.prototyping.bbc.co.uk/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">英国广播公司的研究和发展:音频波形</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">Peaks.js是一个JavaScript组件，允许用户在浏览器中查看音频波形并与之交互。Peaks.js…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">waveform.prototyping.bbc.co.uk</p></div></div></div></a></div></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="c8c7" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">装置</h1><ul class=""><li id="7fe4" class="mw mx it la b lb my le mz lh na ll nb lp nc lt nd ne nf ng bi translated">npm: <code class="fe ny nz oa ob b">npm install --save peaks.js</code></li><li id="87da" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated">鲍尔:<code class="fe ny nz oa ob b">bower install --save peaks.js</code></li><li id="8e13" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated"><a class="ae lu" href="https://wzrd.in/" rel="noopener ugc nofollow" target="_blank">浏览CDN </a> : <code class="fe ny nz oa ob b"><a class="ae lu" href="http://wzrd.in/standalone/peaks.js" rel="noopener ugc nofollow" target="_blank">http://wzrd.in/standalone/peaks.js</a></code></li><li id="f828" class="mw mx it la b lb nh le ni lh nj ll nk lp nl lt nd ne nf ng bi translated"><a class="ae lu" href="https://cdnjs.com/" rel="noopener ugc nofollow" target="_blank"> cdnjs </a> : <code class="fe ny nz oa ob b"><a class="ae lu" href="https://cdnjs.com/libraries/peaks.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.com/libraries/peaks.js</a></code></li></ul></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="11ed" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">在自己的项目中使用Peaks.js</h1><p id="d16d" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh oc lj lk ll od ln lo lp oe lr ls lt im bi translated">按照以下步骤，Peaks.js可以包含在任何网页中:</p><h2 id="3489" class="of mf it bd mg og oh dn mk oi oj dp mo lh ok ol mq ll om on ms lp oo op mu oq bi translated">捆绑式(网袋、包裹、卷装)方法</h2><p id="68ef" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh oc lj lk ll od ln lo lp oe lr ls lt im bi translated">这与诸如<a class="ae lu" href="https://www.meteor.com/" rel="noopener ugc nofollow" target="_blank"> Meteor </a>、<a class="ae lu" href="https://webpack.github.io/" rel="noopener ugc nofollow" target="_blank"> webpack </a>和<a class="ae lu" href="http://browserify.org/" rel="noopener ugc nofollow" target="_blank"> browserify </a>(与<a class="ae lu" href="https://github.com/babel/babelify" rel="noopener ugc nofollow" target="_blank"> babelify transform </a>)的系统配合得很好。</p><pre class="kj kk kl km gt or ob os ot aw ou bi"><span id="01b3" class="of mf it ob b gy ov ow l ox oy">import Peaks from '<a class="ae lu" href="https://github.com/bbc/peaks.js" rel="noopener ugc nofollow" target="_blank">peaks.js</a>';</span><span id="d914" class="of mf it ob b gy oz ow l ox oy">const options = { ... };</span><span id="0352" class="of mf it ob b gy oz ow l ox oy">Peaks.init(options, function(err, peaks) {<br/>  // ...<br/>});</span></pre></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="cefd" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">普通JavaScript</h1><pre class="kj kk kl km gt or ob os ot aw ou bi"><span id="cf10" class="of mf it ob b gy ov ow l ox oy">&lt;script src="node_modules/peaks.js/peaks.js"&gt;&lt;/script&gt;<br/>&lt;script&gt;<br/>(function(Peaks) {<br/>  const options = { ... };</span><span id="4e2f" class="of mf it ob b gy oz ow l ox oy">  Peaks.init(options, function(err, peaks) {<br/>    // ...<br/>  });<br/>})(peaks);<br/>&lt;/script&gt;</span></pre></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="beef" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">生成波形数据</h1><p id="70a9" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh oc lj lk ll od ln lo lp oe lr ls lt im bi translated">Peaks.js使用由<a class="ae lu" href="https://github.com/bbc/audiowaveform" rel="noopener ugc nofollow" target="_blank">音频波形</a>产生的波形数据文件。这些可以用二进制(.dat)或JSON格式。二进制格式是首选的，因为它的文件更小，但是它只与支持类型化数组的浏览器兼容。</p><p id="397c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当生成波形数据文件时，您还应该使用<code class="fe ny nz oa ob b">-b 8</code>选项，因为Peaks.js目前不支持16位波形数据文件。这也有助于最小化文件大小。</p><p id="2cec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要生成二进制波形数据文件:</p><pre class="kj kk kl km gt or ob os ot aw ou bi"><span id="6017" class="of mf it ob b gy ov ow l ox oy">audiowaveform -i sample.mp3 -o sample.dat -b 8</span></pre><p id="b432" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要生成JSON格式的波形数据文件:</p><pre class="kj kk kl km gt or ob os ot aw ou bi"><span id="770a" class="of mf it ob b gy ov ow l ox oy">audiowaveform -i sample.mp3 -o sample.json -b 8</span></pre><p id="ad76" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请参考<a class="ae lu" href="https://github.com/bbc/audiowaveform" rel="noopener ugc nofollow" target="_blank"> audiowaveform的</a>主页，了解可用命令行选项的详细信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/c4aacd1c3c9db5452b41c372a289abe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPlYyGdPGKJDzG9sOl93fQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">音频波形<a class="ae lu" href="https://github.com/bbc/audiowaveform" rel="noopener ugc nofollow" target="_blank"> GitHub </a>页面</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="5bfa" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">网络音频波形</h1><p id="4c5e" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh oc lj lk ll od ln lo lp oe lr ls lt im bi translated">Peaks.js可以使用<a class="ae lu" href="https://www.w3.org/TR/webaudio/" rel="noopener ugc nofollow" target="_blank"> Web Audio API </a>来生成波形，这意味着你不必预先生成一个<code class="fe ny nz oa ob b">dat</code>或<code class="fe ny nz oa ob b">json</code>文件。但是，请注意，这需要浏览器在显示波形之前下载整个音频文件，并且此过程可能会占用大量CPU资源，因此不建议用于长音频文件。</p><div class="nm nn gp gr no np"><a href="https://medium.com/better-programming/all-you-need-to-know-about-the-web-audio-api-3df170559378" rel="noopener follow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">关于网络音频API你需要知道的</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">使用JavaScript的API来处理和合成音频</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ks np"/></div></div></a></div><p id="1f33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要使用网络音频，省略<code class="fe ny nz oa ob b">dataUri</code>选项，转而传递一个包含<code class="fe ny nz oa ob b">AudioContext</code>实例的<code class="fe ny nz oa ob b">webAudio</code>对象。你的浏览器必须支持网络音频API。</p><pre class="kj kk kl km gt or ob os ot aw ou bi"><span id="b41d" class="of mf it ob b gy ov ow l ox oy">const AudioContext = window.AudioContext || window.webkitAudioContext;<br/>const audioContext = new AudioContext();</span><span id="65a4" class="of mf it ob b gy oz ow l ox oy">const options = {<br/>  containers: {<br/>    overview: document.getElementById('overview-waveform'),<br/>    zoomview: document.getElementById('zoomview-waveform')<br/>  },<br/>  mediaElement: document.querySelector('audio'),<br/>  webAudio: {<br/>    audioContext: audioContext<br/>  }<br/>};</span><span id="bd0d" class="of mf it ob b gy oz ow l ox oy">Peaks.init(options, function(err, peaks) {<br/>  // Do something when the waveform is displayed and ready<br/>});</span></pre><p id="2d93" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在Peak.js的<a class="ae lu" href="https://github.com/bbc/peaks.js#api" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>上查看完整的API文档和所有可用选项。</p><div class="nm nn gp gr no np"><a href="https://github.com/bbc/peaks.js#api" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">bbc/peaks.js</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">用于与音频波形交互的JavaScript UI组件- bbc/peaks.js</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg ks np"/></div></div></a></div></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="6ba7" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">贡献的</h1><p id="c0b4" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh oc lj lk ll od ln lo lp oe lr ls lt im bi translated">如果你想给Peaks.js投稿，请看看<a class="ae lu" href="https://github.com/bbc/peaks.js/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank">投稿指南</a>。</p><div class="nm nn gp gr no np"><a href="https://github.com/bbc/peaks.js/blob/master/CONTRIBUTING.md" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">bbc/peaks.js</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">感谢您对Peaks.js的关注！我们喜欢听到使用我们软件的人的反馈，所以如果你建立…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg ks np"/></div></div></a></div><p id="5cec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">感谢阅读，编码快乐！</strong></p></div></div>    
</body>
</html>