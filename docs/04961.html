<html>
<head>
<title>Building a Custom Transitioning for ViewController in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS中为ViewController构建自定义过渡</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-custom-transitioning-for-viewcontroller-in-ios-13-cbf9b4de3d9b?source=collection_archive---------7-----------------------#2020-05-26">https://betterprogramming.pub/building-a-custom-transitioning-for-viewcontroller-in-ios-13-cbf9b4de3d9b?source=collection_archive---------7-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a9fc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们在appsybill bed中构建自定义过渡</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4e5187eb7ecca21d92892974ed0e96e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGWRGpqh6VoLcgGaqbEqKw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@wesson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">威森王</a>在<a class="ae kv" href="https://unsplash.com/s/photos/mac?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="11d7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">概述</strong></h1><p id="379c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">每一个新的iOS都有设计上的改变。这次我们看到了新的视图表示风格，<strong class="lq ir"> </strong>，它为视图控制器提供了3D外观。</p><p id="52f2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">尽管Swift是开源的，但苹果的框架不是。你可能想知道苹果是怎么做到的——我当然想知道。我发现它不是一个黑匣子。</p><p id="a1c6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本文中，我们将尝试重现苹果一直在做的事情——又名<em class="mp">破解iOS代码！</em></p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="bf55" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated"><strong class="ak">先决条件</strong></h1><p id="d9df" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">熟悉<code class="fe nc nd ne nf b">UIViewControllerTransitioningDelegate</code>和<code class="fe nc nd ne nf b">UIViewControllerAnimatedTransitioning</code>。如果你不是，你最好先看看这篇<a class="ae kv" href="https://www.raywenderlich.com/322-custom-uiviewcontroller-transitions-getting-started" rel="noopener ugc nofollow" target="_blank">雷·温德里奇</a>的文章。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="ae55" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated">入门指南</h1><p id="39aa" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/arjunbaru/customTransitioning" rel="noopener ugc nofollow" target="_blank">下载项目</a>。</p><p id="db5b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们来探索一下起始项目。构建并运行:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/fd425ca5e62a23d97674ef90af4eec63.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/1*6CAFvyS7hsRqkY_o1zNM-g.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">iOS 13演示</p></figure><p id="a321" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">浏览代码，我们有一个带有<code class="fe nc nd ne nf b">Show Cities</code>按钮的<code class="fe nc nd ne nf b">PresentingViewController</code>类和一个显示一些城市数据的<code class="fe nc nd ne nf b">PresentedViewController</code>类。</p><p id="3ec5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果你想知道如何制作导航条动画，请查看<a class="ae kv" href="https://medium.com/better-programming/building-an-animating-navigation-bar-in-ios-13-96355c6822ce?source=your_stories_page---------------------------" rel="noopener">在Swift </a>中构建一个动画UINavigationBar。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="f735" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated"><strong class="ak">让我们编码</strong></h1><p id="f457" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将从给项目添加<code class="fe nc nd ne nf b">CustomAnimatedController.swift</code>开始。</p><p id="6286" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">首先，在文件中添加这个助手<code class="fe nc nd ne nf b">enum</code>:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="35e4" class="nl kx iq nf b gy nm nn l no np">enum ViewControlerScale {<br/>case modelPresentationScale<br/>case reset</span><span id="aa0e" class="nl kx iq nf b gy nq nn l no np">var transform: CATransform3D {<br/>switch self {<br/>case .modelPresentationScale:<br/>return CATransform3DMakeScale(0.88, 0.88, 1)<br/>case .reset:<br/>return CATransform3DMakeScale(1, 1, 1) <br/>     }<br/>  }<br/>}</span></pre><p id="32b2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这将有助于我们在新的<code class="fe nc nd ne nf b">viewController</code>弹出时实现背景收缩，并在<code class="fe nc nd ne nf b">viewController</code>消失后重置它。一旦我们使用它，你会有一个更好的主意。</p><p id="0ec9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在，让我们添加下面的类:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="ff9d" class="nl kx iq nf b gy nm nn l no np">//1<br/>class CustomAnimatedController: NSObject, UIViewControllerAnimatedTransitioning {</span><span id="2987" class="nl kx iq nf b gy nq nn l no np">//2<br/>func transitionDuration(using transitionContext: UIViewControllerContextTransitioning?) -&gt; TimeInterval {}</span><span id="6f0a" class="nl kx iq nf b gy nq nn l no np">//3<br/>func animateTransition(using transitionContext: UIViewControllerContextTransitioning) {}<br/>}</span></pre><p id="0556" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们从创建一个符合<code class="fe nc nd ne nf b">UIViewControllerAnimatedTransitioning</code>的<code class="fe nc nd ne nf b">CustomAnimatedController</code>开始。这个委托有两个强制方法(<code class="fe nc nd ne nf b">2</code>和<code class="fe nc nd ne nf b">3</code>)。</p><p id="a7e7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>该功能询问动画的持续时间。</p><p id="8209" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这就是我们增加魔力的地方。该功能负责从当前<code class="fe nc nd ne nf b">ViewController</code>到未来<code class="fe nc nd ne nf b">ViewController</code>的转换。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="d95b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">根据上面的理解，这个班需要什么？持续时间(针对代表)、估计的最终高度，以及我们是展示还是解散<code class="fe nc nd ne nf b">viewController</code>(我们稍后将讨论这一部分)。</p><p id="49ef" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">将以下代码添加到该类中:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="9c73" class="nl kx iq nf b gy nm nn l no np">let estimatedFinalHeight: CGFloat<br/>let animationDuration: TimeInterval<br/>var isPresenting: Bool</span><span id="d8fa" class="nl kx iq nf b gy nq nn l no np">init(estimatedFinalHeight: CGFloat, animationDuration: TimeInterval, isPresenting: Bool) {</span><span id="bb5e" class="nl kx iq nf b gy nq nn l no np">self.estimatedFinalHeight = estimatedFinalHeight<br/>self.animationDuration = animationDuration<br/>self.isPresenting = isPresenting</span><span id="d7cd" class="nl kx iq nf b gy nq nn l no np">}</span></pre><p id="94c4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下面我们来探讨一下<code class="fe nc nd ne nf b">func animateTransition(using transitionContext: UIViewControllerContextTransitioning)</code> <em class="mp">。</em></p><p id="84b0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">添加以下代码:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="7c62" class="nl kx iq nf b gy nm nn l no np">// 1<br/>guard let fromVC = transitionContext.viewController(forKey: .from),<br/>let toVC = transitionContext.viewController(forKey: .to) else { return }</span><span id="81a2" class="nl kx iq nf b gy nq nn l no np">//2<br/>let containerView = transitionContext.containerView</span><span id="96e7" class="nl kx iq nf b gy nq nn l no np">//3<br/>fromVC.beginAppearanceTransition(false, animated: true)<br/>toVC.beginAppearanceTransition(true, animated: true)</span></pre><p id="adec" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//1</code>这条线将为我们提供两个视图控制器(to和from)。</p><p id="941a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>容器视图负责动画。我们添加将呈现和消除的视图，以相应地激活它。</p><p id="2e80" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//3</code>当我们进行自定义演示时，我们的<code class="fe nc nd ne nf b">viewController</code>的生命周期没有被调用，这将导致突然的行为。建议我们永远不要直接调用生命周期方法。这个函数负责处理这个问题。</p><p id="40fd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们添加代码，以便在另一个视图控制器之上呈现一个视图控制器:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="48a6" class="nl kx iq nf b gy nm nn l no np">if isPresenting {</span><span id="5fba" class="nl kx iq nf b gy nq nn l no np">// 1<br/>toVC.view.frame.origin.y = fromVC.view.frame.maxY<br/>containerView.addSubview(toVC.view)</span><span id="740f" class="nl kx iq nf b gy nq nn l no np">UIView.animate(withDuration: animationDuration, animations: {</span><span id="969a" class="nl kx iq nf b gy nq nn l no np">// 2<br/>toVC.view.frame.origin.y = self.estimatedFinalHeight<br/>fromVC.view.layer.transform = <br/>ViewControlerScale.modelPresentationScale.transform</span><span id="cc57" class="nl kx iq nf b gy nq nn l no np">}, completion: { _ in</span><span id="f0df" class="nl kx iq nf b gy nq nn l no np">//3<br/>fromVC.endAppearanceTransition()<br/>toVC.endAppearanceTransition()</span><span id="669a" class="nl kx iq nf b gy nq nn l no np">transitionContext.completeTransition(!transitionContext.transitionWasCancelled)<br/>  })<br/>}</span></pre><p id="6981" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//1</code>我们将在当前呈现的ViewController底部固定“待呈现”ViewController。将<code class="fe nc nd ne nf b">toVC</code>添加到容器视图中(因为它负责保存呈现的ViewController)。</p><p id="c1ce" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>在<code class="fe nc nd ne nf b">Animation</code>中，我们将<code class="fe nc nd ne nf b">toVC</code>的Y轴从最大值改变到所需的高度。同样，在上面声明的<code class="fe nc nd ne nf b">enum</code>的帮助下，我们将我们的背景<code class="fe nc nd ne nf b">ViewController</code>进行缩放以给出一个3D效果。</p><p id="87b8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一旦我们完成了动画，我们就通知<code class="fe nc nd ne nf b">system</code>以便生命周期方法可以被正确调用。</p><p id="9a2c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果不出席，那就应该解散。让我们在上面的代码中添加<code class="fe nc nd ne nf b">else</code>部分:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="0d11" class="nl kx iq nf b gy nm nn l no np">else {</span><span id="ff8c" class="nl kx iq nf b gy nq nn l no np">// 1<br/>containerView.addSubview(fromVC.view)</span><span id="669e" class="nl kx iq nf b gy nq nn l no np">UIView.animate(withDuration: animationDuration, animations: {</span><span id="f5e0" class="nl kx iq nf b gy nq nn l no np">// 2<br/>fromVC.view.frame.origin.y = UIScreen.main.bounds.maxY<br/>toVC.view.layer.transform = ViewControlerScale.reset.transform</span><span id="2d7f" class="nl kx iq nf b gy nq nn l no np">}, completion: { _ in</span><span id="0195" class="nl kx iq nf b gy nq nn l no np">// 3<br/>fromVC.endAppearanceTransition()<br/>toVC.endAppearanceTransition()</span><span id="1ebe" class="nl kx iq nf b gy nq nn l no np">transitionContext.completeTransition(!transitionContext.transitionWasCancelled)<br/>  })<br/>}</span></pre><p id="18d6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">问题是:我们也使用相同的函数来消除<code class="fe nc nd ne nf b">ViewController</code>。此时，我们将从<code class="fe nc nd ne nf b">PresentedViewController</code>(现在将是<code class="fe nc nd ne nf b">fromVC</code>)到<code class="fe nc nd ne nf b">presentingViewController</code>(将是<code class="fe nc nd ne nf b">toVC</code>)。形势逆转了！</p><p id="56fa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//1</code>我们正在将弹出窗口<code class="fe nc nd ne nf b">ViewController</code>转换到底部，以免它被关闭。这个视图被添加到<code class="fe nc nd ne nf b">containerView</code>。</p><p id="a349" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>将我们之前缩小的<code class="fe nc nd ne nf b">toVC</code> ( <code class="fe nc nd ne nf b">PresentingViewController</code>)重置为其原始比例。</p><p id="9e74" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//3</code>让系统知道我们已经完成了<code class="fe nc nd ne nf b">Animation</code>，以便调用适当的生命周期方法。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="d8c6" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated">设置转换委托类</h1><p id="32f0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们添加另一个文件<code class="fe nc nd ne nf b">CustomTransitioningController.swift</code>，并向其中添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="8004" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//1</code>这个类将获取初始高度和持续时间，然后传递给我们的<code class="fe nc nd ne nf b">CustomAnimatedController</code>类。此外，这也是我们的<code class="fe nc nd ne nf b">Viewcontroller</code> s将会使用的前置舱。</p><p id="f4da" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>我们将有一个私有变量<code class="fe nc nd ne nf b">animatorController</code>，它将指导视图控制器的呈现和删除。</p><p id="0ba7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们的<code class="fe nc nd ne nf b">CustomTransitioningController</code>类符合委托<code class="fe nc nd ne nf b">UIViewControllerTransitioningDelegate</code>，这个委托带有两个可选函数——让我们来看看它们。</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="fe6e" class="nl kx iq nf b gy nm nn l no np">// 1<br/>func animationController(forPresented presented: UIViewController,<br/>presenting: UIViewController,<br/>source: UIViewController)<br/>-&gt; UIViewControllerAnimatedTransitioning? {</span><span id="35ed" class="nl kx iq nf b gy nq nn l no np">animatorController.isPresenting = true<br/>return animatorController</span><span id="01ff" class="nl kx iq nf b gy nq nn l no np">}</span><span id="f574" class="nl kx iq nf b gy nq nn l no np">// 2<br/>func animationController(forDismissed dismissed: UIViewController)<br/>-&gt; UIViewControllerAnimatedTransitioning? {</span><span id="ef53" class="nl kx iq nf b gy nq nn l no np">animatorController.isPresenting = false<br/>return animatorController</span><span id="b02b" class="nl kx iq nf b gy nq nn l no np">}</span></pre><p id="ca31" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//1</code>第一个功能引导我们呈现流程。我们得到<code class="fe nc nd ne nf b">presented</code>(我们当前的VC)和<code class="fe nc nd ne nf b">presenting</code>(被呈现的VC)。在制作动画之前，对<code class="fe nc nd ne nf b">viewController</code>的任何其他更改都可以在这里完成。</p><p id="6898" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe nc nd ne nf b">//2</code>这个函数给出了将要解除的控制器。在此功能中，可以对视图进行任何最后调整。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="af1e" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated">是时候连接我们的定制演示了</h1><p id="a0f6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">向<code class="fe nc nd ne nf b">PresentingViewController</code>类添加一个属性:</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="daa2" class="nl kx iq nf b gy nm nn l no np">let customTransitioningDelegate = CustomTransitioningController()</span></pre><p id="41f4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">用下面的代码替换<code class="fe nc nd ne nf b">onTapOfShowCities</code>函数的主体。</p><pre class="kg kh ki kj gt nh nf ni nj aw nk bi"><span id="2516" class="nl kx iq nf b gy nm nn l no np">guard let vc = UIStoryboard(name: "Main", bundle: nil).instantiateViewController(identifier: "PresentedViewController") as? PresentedViewController else { return }</span><span id="5a00" class="nl kx iq nf b gy nq nn l no np">vc.modalPresentationStyle = .custom<br/>vc.transitioningDelegate = customTransitioningDelegate</span><span id="f6f1" class="nl kx iq nf b gy nq nn l no np">self.present(vc, animated: true, completion: nil)</span></pre><p id="74f7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们将演示风格设置为custom，并让系统知道我们新的转换委托。</p><p id="af43" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">建造并运行！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/59dd1e463dd13ab019b6baec4d79faa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oOb820u8UCvsahcO9NVfg.png"/></div></div></figure><p id="dc4e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">正如我们所料。但是等等，为什么角那么尖？让我们修理他们。</p><p id="bca6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">转到<code class="fe nc nd ne nf b">CustomAnimatedController</code>类并添加以下代码(在断点处提到，第63和77行)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/3483442cc59ed5fcf223729039afe38e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EneiYEWmq1jKFIDrpfvHVQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们在演讲时转弯，在解散时恢复。</p></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="83dd" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated">最后的结果</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/f4c615e63efcc3520ca3a183e2d7b76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/1*XloAQQlAKRkjx617yP2paA.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自定义演示文稿。</p></figure><p id="b2cd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">干得好！我们现在有一些类似于苹果的东西。如果你观察苹果的动画，我们会看到滑动消除和一个很好的背景渐变。我们能做到吗？当然，但这是本教程第2部分的主题！</p><p id="dd79" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>