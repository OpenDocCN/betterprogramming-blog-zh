<html>
<head>
<title>How To Make a Chrome Extension To Create GitHub Gists With Vite, React and TailwindCSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何做一个Chrome扩展用Vite，React和TailwindCSS创建GitHub Gists</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-make-a-chrome-extension-to-create-github-gists-with-vite-react-and-tailwindcss-86d962654777?source=collection_archive---------5-----------------------#2022-10-18">https://betterprogramming.pub/how-to-make-a-chrome-extension-to-create-github-gists-with-vite-react-and-tailwindcss-86d962654777?source=collection_archive---------5-----------------------#2022-10-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="22ad" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这一省时功能的深入指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/05dcf1fb7bfb46c25a2bcf8a208a3919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OoJLt5dYPp7QgCnttxuiQA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自作者</p></figure><p id="8f3d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">大家好。在本文中，我将改进我们以前的gist命令行脚本。</p><p id="7e40" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Auto Gistify chrome扩展向页面上的每个代码块添加一个按钮。单击该按钮将创建一个新的gist，其文件扩展名由HTML元素类名给出。</p><p id="6b2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">举例来说，假设我们有以下HTML:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="71dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的扩展将把按钮注入到文档中，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="7d2b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">创建Vite应用程序</h1><p id="fb14" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">运行以下命令在您的目录中生成一个Vite + React模板:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="bbb3" class="mv lu iq mr b gy mw mx l my mz">npm create <!-- -->vite@latest auto-gistify -- --template react</span></pre><h1 id="f4bc" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">安装尾翼CSS</h1><p id="785d" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">现在，我们将为我们的项目安装Tailwind CSS。这一步不是绝对必要的，但是使用TailwindCSS可以快速开发样式。</p><p id="2eae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以从他们的<a class="ae na" href="https://tailwindcss.com/docs/guides/vite" rel="noopener ugc nofollow" target="_blank">网站</a>上阅读指南来开始。</p><h1 id="7670" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">Manifest.json</h1><p id="79d7" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">清单文件定义了扩展运行所需的信息。在项目的顶层目录中创建它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="9012" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，可通过网络访问的资源包括我们可以参考的所有文件。</p><h1 id="ab28" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">了解我们的项目结构</h1><p id="9706" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们的Auto Gistify扩展由三部分组成:一个弹出窗口、一个内容脚本和一个服务人员。</p><ul class=""><li id="c7f7" class="nb nc iq kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated">弹出窗口是用户单击扩展时看到的显示</li><li id="8844" class="nb nc iq kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">内容脚本注入了“Gistify”按钮</li><li id="d480" class="nb nc iq kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">服务人员处理授权</li></ul><p id="829c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们构建项目时，只有弹出窗口的代码会出现在输出中。因此，为了允许bundler包含我们的其他文件，我们需要将它们放到public文件夹中。</p><h1 id="cf86" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">批准</h1><p id="e5ea" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">以前，我们使用NPM的<code class="fe np nq nr mr b">@octokit/auth-oauth-device</code>来处理授权。由于我们不能在内容脚本中使用NPM模块，我们必须自己添加授权。</p><p id="6002" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在顶层目录的public文件夹中，创建一个名为<code class="fe np nq nr mr b">oauth.js</code>的文件。下面是Javascript的实现，参考了GitHub API文档。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="ed5a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">服务行业人员</h1><p id="4a5e" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">当用户单击“Authorize”按钮时，弹出窗口会发出一个事件，服务人员会处理这个事件。首先，它生成一个验证码，并将其返回给弹出脚本。接下来，它等待，直到用户获得授权并保存访问令牌。在<code class="fe np nq nr mr b">scripts</code>文件夹中创建一个名为<code class="fe np nq nr mr b">background.js</code>的文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="68ea" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">内容脚本</h1><p id="596e" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们需要使用动态导入将代码导入到我们的内容脚本中。如清单所示，在<code class="fe np nq nr mr b">public</code>文件夹中创建一个<code class="fe np nq nr mr b">scripts</code>文件夹。然后创建一个名为<code class="fe np nq nr mr b">content_script.js</code>的文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="cf2f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们需要检索访问令牌。接下来，我们必须找到所有的代码块，并注入按钮。在同一文件夹中创建一个名为<code class="fe np nq nr mr b">content_main.js</code>的文件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="400f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要定义一个从代码块中获取编程语言的函数。我们将利用在<code class="fe np nq nr mr b">code</code>元素上设置的类名。或者，您可以提示用户输入文件名。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="5803" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我们需要一个函数来接受我们的<code class="fe np nq nr mr b">code</code>元素和目标语言。然后它会创建一个按钮并设置一个<code class="fe np nq nr mr b">onclick</code>处理程序。</p><p id="a089" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意我们给按钮一个类名，这样所有的按钮都可以被设计。我们还使用<code class="fe np nq nr mr b">object</code>元素来导入我们的SVG GitHub图标。你可以在这里从羽毛下载图标<a class="ae na" href="https://feathericons.com/?query=github" rel="noopener ugc nofollow" target="_blank">并添加到<code class="fe np nq nr mr b">public</code>文件夹。</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="b82e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要实现一个函数来使用我们的访问令牌创建一个gist。在<code class="fe np nq nr mr b">public</code>文件夹中创建一个名为<code class="fe np nq nr mr b">gists.js</code>的文件，并添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="9f58" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">风格</h1><p id="13e5" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">在与<code class="fe np nq nr mr b">content_script.js</code>相同的文件夹中创建一个名为<code class="fe np nq nr mr b">content_script.css</code>的文件。添加以下样式:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="d5f3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">扩展弹出窗口(反应)</h1><p id="885b" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我们创建一个React组件来显示我们的弹出窗口。它存储了<code class="fe np nq nr mr b">authData</code>，其中保存了要显示的验证码和URL。还有<code class="fe np nq nr mr b">authorized</code>处理授权状态。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="fdc7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在可以添加生命周期效果来从存储中检索访问令牌。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="aa99" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，我们可以为服务工作者发出的<code class="fe np nq nr mr b">AUTH_RESPONSE</code>事件设置一个监听器。然后我们将更新我们的状态变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="ad0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是我们组件的所有标记，使用了Tailwind类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="1662" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">的。环境文件</h1><p id="0aa5" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">在顶层目录中，将这一行添加到一个新的<code class="fe np nq nr mr b">.env</code>文件中，以避免Chrome出现问题:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="91b1" class="mv lu iq mr b gy mw mx l my mz">INLINE_RUNTIME_CHUNK=false</span></pre><p id="94ea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们可以扩展了。</p><h1 id="80ee" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">构建扩展</h1><p id="670c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">运行<code class="fe np nq nr mr b">npm run build</code>将构建输出放到<code class="fe np nq nr mr b">dist</code>文件夹中。</p><p id="a21b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在基于Chromium的浏览器的新标签中进入<code class="fe np nq nr mr b">chrome://extensions</code>。启用开发者模式，点击“加载解压”，然后选择<code class="fe np nq nr mr b">dist</code>文件夹。</p><h1 id="912d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">测试它</h1><p id="8434" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">打开任何带有代码块的页面；您应该会看到注入的按钮。点击一个，链接到一个新的要点应该被复制到剪贴板。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/8b3afc3bb23054d03221cf643e8d1dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*etE-frflN11iNw6G"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来自作者的图片展示了扩展的作用</p></figure><h1 id="b638" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="536c" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">仅此而已！你可以在GitHub的这里找到整个项目。感谢<a class="nt nu ep" href="https://medium.com/u/a2e6187cebee?source=post_page-----86d962654777--------------------------------" rel="noopener" target="_blank">弗拉基米尔·托波列夫</a>提出这个想法。</p><h1 id="164c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">参考</h1><p id="2aaf" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated"><a class="ae na" href="https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps#device-flow" rel="noopener ugc nofollow" target="_blank">https://docs . github . com/en/developers/apps/building-oauth-apps/authoring-oauth-apps # device-flow</a></p><p id="0d43" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae na" href="https://stackoverflow.com/questions/48104433/how-to-import-es6-modules-in-content-script-for-chrome-extension#answer-53033388" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/48104433/how-to-import-es6-modules-in-content-script-for-chrome-extension # answer-53033388</a></p><p id="d3c2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae na" href="https://www.geeksforgeeks.org/how-to-import-a-svg-file-in-javascript/" rel="noopener ugc nofollow" target="_blank">https://geeks forgeeks . org/how-to-import-a-SVG-file-in-JavaScript</a></p><p id="dc5a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae na" href="https://developer.chrome.com/docs/extensions/mv3/manifest/" rel="noopener ugc nofollow" target="_blank">https://developer.chrome.com/docs/extensions/mv3/manifest</a></p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="c758" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="oc">原发布于</em><a class="ae na" href="https://cs310.hashnode.dev/chrome-extension-to-create-gists-with-vite-react-and-tailwindcss" rel="noopener ugc nofollow" target="_blank"><em class="oc">https://cs 310 . hash node . dev</em></a><em class="oc">。</em></p></div></div>    
</body>
</html>