<html>
<head>
<title>Analyzing Pepsi NFT Smart Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">百事NFT智能合同分析</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/nft-beginner-tutorial-pepsi-nft-smart-contract-explained-962721b7361a?source=collection_archive---------8-----------------------#2022-01-27">https://betterprogramming.pub/nft-beginner-tutorial-pepsi-nft-smart-contract-explained-962721b7361a?source=collection_archive---------8-----------------------#2022-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b76e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">解码智能合同01</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8c73a7cf2d32f1d764f4cce903929be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2hqia1cjQiKbmWuBSN7lw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">百事可乐的NFT系列</p></figure><p id="1ae0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">百事可乐于2021年12月放弃了它的创世纪NFT系列(<a class="ae lr" href="https://micdrop.pepsi.com/" rel="noopener ugc nofollow" target="_blank">来源</a>)，直到今天这个项目的交易量为23000亿瑞士法郎(560万美元)。我仔细研究了百事NFT公司的合同，了解他们是如何实施这个项目的。在本教程中，我将逐行解释智能合约。</p><h1 id="6d69" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">目标受众是谁？</h1><p id="99fb" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如果你刚到NFT，想学习如何自己开发一个NFT智能合同，这篇文章很适合你。如果你对NFT背后的技术是如何工作的感到好奇，这篇文章也会有所帮助。</p><h1 id="ea6d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">先决条件</h1><p id="ceff" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如果你了解ERC-721并有编码经验，你可以跳过这一节。</p><ul class=""><li id="0d20" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><strong class="kx ir">稳健</strong>:到目前为止，大部分NFT合约都使用<a class="ae lr" href="https://docs.soliditylang.org/en/latest/" rel="noopener ugc nofollow" target="_blank">稳健</a>。你不需要知道固体来理解这个概念。但是，如果您想自己实现一个NFT契约，一些编码经验将会非常有帮助。要学习扎实，我强烈推荐阅读<a class="ae lr" href="https://docs.soliditylang.org/en/latest/" rel="noopener ugc nofollow" target="_blank">公文</a>。</li><li id="86a9" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir"> ERC-721 </strong>:百事NFT建立在由Open Zeppelin实施的ERC-721智能合同的基础上。简而言之，ERC-721标准提供了NFT的基本功能，包括转账、支票账户余额、造币等。这篇文章给出了一个很好的概述:<a class="ae lr" href="https://ethereum.org/en/developers/docs/standards/tokens/erc-721/" rel="noopener ugc nofollow" target="_blank"> ERC-721不可替代令牌标准</a>。</li></ul><h1 id="aa22" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">放弃</h1><p id="b6e1" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">和很多人一样，我也是这个行业的新手。我试图再次检查内容的正确性，但可能会出现错误。如果你发现了什么，请告诉我，我将非常感谢你的帮助和更新本教程。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="54cb" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">智能合约在哪里？</h1><p id="d338" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">许多项目会将他们的合同开源，人们可以在做出任何(投资)决定之前接受教育。透明也是我在区块链行业最喜欢的特性之一。</p><p id="a134" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">百事可乐在官方网站上公布了其NFT合同地址。你可以简单地复制那个地址，然后在<a class="ae lr" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank">以太扫描</a>中搜索，这是查看以太坊区块链信息的必去之地。然后，您将看到以下页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/1dc6c6b0a633ba7fe496cb33ffb79d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VU75g_kPiczKr_qBMX2Fg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1以太扫描合同页面截图</p></figure><p id="6ef9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击<code class="fe nq nr ns nt b">Contract</code>按钮，您将看到14个文件。但是，我们只需要第一个文件，<code class="fe nq nr ns nt b">PepsiMicDrop.sol</code>。这份文件包含百事NFT合同。其余的是ERC-721合同的开放齐柏林，我们不会涵盖。</p><p id="5772" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了方便你，我把代码放在GitHub上，你可以在这里找到<a class="ae lr" href="https://gist.github.com/sicongzhao/81886ca422e46bffe4e668100c42b945" rel="noopener ugc nofollow" target="_blank">。我推荐你和这篇文章并排开放代码。</a></p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="4e19" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">合同中的NFT</h1><p id="2bdf" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在深入研究代码之前，让我们首先了解智能契约是如何定义NFT的。在引擎盖下，一辆NFT有两条信息:<strong class="kx ir"> (1) Id (2) URI </strong>。</p><p id="1ceb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">根据ERC-721标准，每个NFT都是唯一的。怎么会？该契约为每个NFT分配一个唯一的Id，从而实现了唯一性。在基于ERC-721的合同中，你不会发现两个不同的具有相同Id的NFT。</p><p id="d2e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么，图像在哪里(也可以是视频、文档等)？这就是URI发挥作用的地方。URI代表统一资源标识符。可以把它想象成一个URL，通过它可以获得与NFT相关的所有元数据。元数据可以是图像URL、描述、属性等。当前最流行的NFT市场OpenSea有它的<a class="ae lr" href="https://docs.opensea.io/docs/metadata-standards" rel="noopener ugc nofollow" target="_blank">元数据标准</a>。您可以找到完整的元数据列表。</p><p id="38b8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，你可能会问:<strong class="kx ir">URI和Id能确保NFT的独特性吗？</strong></p><p id="3c35" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">理想情况下，基于ERC-721的NFT将有其独特的图像或元数据，这就是它们不可替代的原因。但是，您可以将同一个URI分配给不同的Id，从而创建两个表面上看起来相同的NFT。然而，这不是ERC-721的目的。还有另一个标准，ERC-1155，它支持半可替换的NFT。你可以在这里了解更多<a class="ae lr" href="https://eips.ethereum.org/EIPS/eip-1155" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="2274" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，您可能会想:<strong class="kx ir">为什么元数据不存储在契约中？</strong>因为在区块链上存储数据非常昂贵，尤其是图像或视频。但是，您仍然可以在链上存储元数据，并支付高昂的电费。一些项目使用SVG格式的图像，这大大减少了数据量，从而减少了燃气费。然而，这超出了本教程的范围。如果您想了解更多关于基于SVG的NFT，请告诉我。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="c884" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">合同结构</h1><p id="a4e3" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这份合同乍看起来可能很复杂，但它组织得很好。图2显示了这个契约的结构。让我们看一下每个组件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/c2e88e8b27d8f303bfb4231071630a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gjsQZu7j9FUN8QDB1Ui9Ig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图2百事NFT合同的结构</p></figure><ul class=""><li id="a966" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated"><strong class="kx ir"> SPDX许可证标识符</strong>是注释后的第一行。它指明了其他人如何使用此代码。(第48行)</li><li id="b25a" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir"> Solidity版本</strong>让编译器正确翻译代码，然后EVM可以理解。(第49行)</li><li id="99da" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">导入ERC-721合同</strong>然后百事NFT合同将使用ERC-721合同作为其蓝图。</li><li id="1e7a" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">PepsiMicDrop 是我们将在下一节进一步讨论的NFT合同。它有三个子部分:<strong class="kx ir"> (1)状态变量(2)构造器(3)函数</strong>。</li><li id="29f0" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">状态变量</strong>是其值永久存储在合同存储器中的变量。</li><li id="4f6b" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">构造函数</strong>是一个特殊函数，仅在创建合同时执行。您可以运行合同初始化代码。</li><li id="e374" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><strong class="kx ir">功能</strong>不言自明。大多数函数用于设置或获取状态值。</li></ul></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="538d" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">百事可乐滴合同</h1><p id="a60f" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们看看合同。我将通过它的功能来解释契约，每个功能都与一些函数和状态变量相关。</p><h2 id="6191" class="nv lt iq bd lu nw nx dn ly ny nz dp mc le oa ob me li oc od mg lm oe of mi og bi translated"><strong class="ak"> (1)施工员</strong></h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="ca52" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">构造函数接受两个输入:</p><ul class=""><li id="b4f5" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">“百事麦克风下降”是NFT的令牌名称</li><li id="df62" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">“百事可乐”是象征符号。</li></ul><p id="c4a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该赋值发生在ERC721契约代码中，契约在第51行导入该代码。这就是为什么你找不到任何与这个构造函数体相关的东西。这是继承的美妙之处，我们不需要重做。</p><p id="6baf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在构造函数内部，我们可以看到两个状态变量获得了新值，<code class="fe nq nr ns nt b">reserveMicDropsId</code>和<code class="fe nq nr ns nt b">micDropsId</code>。为什么需要它们？在这次NFT投放中，百事可乐保留了前50个NFT，所以公开的NFT从id 51开始。</p><p id="64d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">等等，NFT不是一个形象吗？为什么这里他们用数字来表示NFT？如果你有这些问题，我和你在一起。为了理解这一点，我们需要了解什么是NFT。</p><h2 id="496b" class="nv lt iq bd lu nw nx dn ly ny nz dp mc le oa ob me li oc od mg lm oe of mi og bi translated"><strong class="ak"> (2)薄荷</strong></h2><p id="6926" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">现在我们来谈谈薄荷。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="f43d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第1部分— Merkle校样</strong></p><p id="a067" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">mint函数有两个输入，proof和leaf。它们用于第3行到第7行的Merkle校样。本质上，它检查用户是否有资格铸造NFT。有一个概念叫做<strong class="kx ir">白名单。有时你必须进入这个白名单，以便以后能够创建非功能性过滤。这部分我就不解释了，因为有人做的很棒。请看<a class="ae lr" href="https://medium.com/@ItsCuzzo/using-merkle-trees-for-nft-whitelists-523b58ada3f9" rel="noopener">这篇文章</a>，对Merkle证明进行了全面的讲解。</strong></p><p id="8fa2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第2部分—先决条件</strong></p><p id="d93a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一部分，第8到11行，定义了mint的4个先决条件。让我们逐一查看。</p><p id="a19c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(1)在NFT开始出售之前，状态变量<code class="fe nq nr ns nt b">saleStarted</code>被设置为假。所以它不会通过8号检测线。当销售开始时，合同所有者可以调用函数<code class="fe nq nr ns nt b">startSale()</code>来更改<code class="fe nq nr ns nt b">saleStarted</code>的值。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="018b" class="nv lt iq nt b gy on oo l op oq">require(saleStarted == true, "The sale is paused");</span></pre><p id="e20f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(2)该检查确保用户地址不是0x0。0x0是以太坊起源地址，没有用户会用。我也不确定为什么这个检查是必要的。如果你明白了，请告诉我。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="8b03" class="nv lt iq nt b gy on oo l op oq">require(msg.sender != address(0x0), "Public address is not correct");</span></pre><p id="475a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(3)在百事顺风车上，每个地址只能铸造一个NFT。<code class="fe nq nr ns nt b">alreadyMinted</code> <strong class="kx ir"> </strong>是映射类型中的一个状态变量，就像一个字典，它跟踪所有生成NFT的地址。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="db1f" class="nv lt iq nt b gy on oo l op oq">require(alreadyMinted[msg.sender] == false, "Address already used");</span></pre><p id="c339" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(4)供应量有限，最多1983年。这将检查是否所有的NFT都已被声明。<code class="fe nq nr ns nt b">micDropsId</code>是我们上面讨论的唯一令牌id。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="3669" class="nv lt iq nt b gy on oo l op oq">require(micDropsId &lt;= maxMint, "Mint limit reached");</span></pre><p id="811c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很简单，对吧？我们差不多完成了，挂在那里。</p><p id="b371" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第3部分——实际造币厂。</strong></p><p id="7591" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是造币厂实际发生的地方。好消息是我们不需要实现它，因为ERC-721已经这样做了。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="225f" class="nv lt iq nt b gy on oo l op oq">_safeMint(msg.sender, micDropsId++);</span></pre><p id="c405" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于mint，我们用用户的钱包地址和唯一的令牌id调用函数<code class="fe nq nr ns nt b">_safemint()</code>，就这样。在底层，有一个状态变量(像字典一样)跟踪每个令牌的所有权。通过调用<code class="fe nq nr ns nt b">_safemint()</code> <strong class="kx ir"> </strong>函数，我们更新这个状态变量，分配或改变相应令牌的所有权。</p><p id="d4db" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里需要注意的是，状态变量<code class="fe nq nr ns nt b">micDropId</code>代表令牌id，它在每次造币后<strong class="kx ir"> </strong>递增1。</p><p id="7890" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第4部分—更新铸造地址</strong></p><p id="72b5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如第2部分所述，每个地址只能铸造一个NFT。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="3d39" class="nv lt iq nt b gy on oo l op oq">alreadyMinted[msg.sender] = true;</span></pre><p id="d490" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这条线确保任何成功铸造NFT的人都会被记录下来。</p><p id="6950" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第五部分——返回</strong></p><p id="bd66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在铸造之后，令牌id被返回到前端。</p><h2 id="81ed" class="nv lt iq bd lu nw nx dn ly ny nz dp mc le oa ob me li oc od mg lm oe of mi og bi translated">(3)更新URI</h2><p id="6df3" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们需要讨论的最后一部分是更新URI的函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="1ed3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">众所周知，每个NFT都有自己的URI。这是用来改变基础URI的函数。</p><p id="8e65" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">URI是NFT各URI之间的共同部分。默认情况下，URI为<code class="fe nq nr ns nt b">baseURI/tokenId</code>。我们之所以设置baseURI，是因为这样可以节省油费。想象一下，如果你为每个极其昂贵的NFT设置URI。</p><p id="bb65" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以通过覆盖ERC-721合同中定义的功能<code class="fe nq nr ns nt b"><strong class="kx ir">tokenURI</strong></code> <strong class="kx ir"> </strong>来更改如何组合<code class="fe nq nr ns nt b">baseURI</code>和<code class="fe nq nr ns nt b">tokenId</code>。例如，如果URI就是这样格式化的，你可以做类似<code class="fe nq nr ns nt b">baseURI/tokenId + ‘.json’</code> <strong class="kx ir"> </strong>的事情。</p><p id="474b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可能会好奇，什么是<code class="fe nq nr ns nt b"><strong class="kx ir">public</strong></code><strong class="kx ir"/><strong class="kx ir"/><code class="fe nq nr ns nt b"><strong class="kx ir">onlyOwner</strong></code>。这些是函数修饰符，它们定义了函数运行的条件。<code class="fe nq nr ns nt b">public</code> <strong class="kx ir"> </strong>意为‘契约内外’，通达一切。部署完成后，我们通过网站(更确切地说是JavaScript)与契约进行交互，这就是public的意思。<code class="fe nq nr ns nt b">onlyOwner</code> <strong class="kx ir"> </strong>表示只有合同业主可以调用该功能。当然，我们只希望合同所有者能够更改令牌URI。</p><h2 id="9ee2" class="nv lt iq bd lu nw nx dn ly ny nz dp mc le oa ob me li oc od mg lm oe of mi og bi translated">(4)其他部分</h2><p id="c644" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">未覆盖的部分只是获取或设置状态变量的函数，我相信你不需要我的帮助。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="6fcd" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">结束了</h1><p id="c6e4" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">原来如此。感谢阅读这篇文章。希望对你有帮助。</p><pre class="kg kh ki kj gt oj nt ok ol aw om bi"><span id="cc38" class="nv lt iq nt b gy on oo l op oq"><strong class="nt ir">Want to Connect?</strong></span><span id="0b57" class="nv lt iq nt b gy or oo l op oq">Please feel free to reach out (<a class="ae lr" href="https://www.linkedin.com/in/zhaosicong/" rel="noopener ugc nofollow" target="_blank">my LinkedIn</a>) if you have any questions, feedback, or even just a random chat.</span></pre><h2 id="a4bc" class="nv lt iq bd lu nw nx dn ly ny nz dp mc le oa ob me li oc od mg lm oe of mi og bi translated">其他教程:</h2><ul class=""><li id="2e4d" class="mp mq iq kx b ky mk lb ml le os li ot lm ou lq mu mv mw mx bi translated"><a class="ae lr" href="https://medium.com/@luo9137/analyzing-autonomous-art-nft-smart-contract-aa4547b31eb3" rel="noopener">分析自主艺术NFT智能合约</a></li><li id="5d0d" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://medium.com/@luo9137/analyzing-paks-merge-smart-contract-7e437b66077c" rel="noopener">分析巴基斯坦的“合并”智能合同</a></li></ul></div></div>    
</body>
</html>