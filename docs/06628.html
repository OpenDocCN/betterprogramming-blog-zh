<html>
<head>
<title>What Is React Teleportation?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是反应传送？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-react-teleportation-7d9c5f6eacee?source=collection_archive---------2-----------------------#2020-10-20">https://betterprogramming.pub/what-is-react-teleportation-7d9c5f6eacee?source=collection_archive---------2-----------------------#2020-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be5b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过门户将React组件传输到其他React组件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/927477efce8a9df44ff8e52e1311258f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3535ppVFZKAhCpUqu6tjQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">paweczerwiński</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b63a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有想过在应用程序的一个完全不同的部分呈现一个React组件？在本文中，我将向您展示如何在第一个组件中控制它的同时做到这一点。</p><p id="e716" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你看下面的例子，我们有一个<code class="fe lv lw lx ly b">PortalIn</code>组件，它将接受传入它的任何内容，并在<code class="fe lv lw lx ly b">PortalOut</code>组件所在的位置呈现出来。为了实现这一点，两个React组件需要有相同的<code class="fe lv lw lx ly b">portalType</code>(我使用<code class="fe lv lw lx ly b">headerPortal</code>作为标识符)<em class="lz">。他们还需要被包裹在<code class="fe lv lw lx ly b">PortalProvider</code>里。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="d2a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看下面的动画。标题中有一个门户，位于通知铃的左侧。有几件事要记住:</p><ul class=""><li id="4df8" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">欢迎页面不向标题门户发送任何内容。</li><li id="5108" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">仪表板页面向标题门户发送一个计数器按钮，更新页面上的计数。</li><li id="db13" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">“关于”页面将“呼叫我”按钮发送到标题门户中。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/f875919ae9acc4099747144672e598c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pWxAuSxVmLo2nF-hWva1rw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过内部门户对应用程序做出反应</p></figure><p id="76fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React上下文API </a>创建一个<code class="fe lv lw lx ly b">PortalProvider</code>和另外两个React组件<code class="fe lv lw lx ly b">PortalIn</code>和<code class="fe lv lw lx ly b">PortalOut</code>。</p><p id="849a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">先从<code class="fe lv lw lx ly b">PortalOut</code>组件说起吧。您会注意到我们可以访问一个<code class="fe lv lw lx ly b">PortalContext</code>，上面有一个<code class="fe lv lw lx ly b">portalMap</code>对象，这是一个JavaScript <a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" rel="noopener ugc nofollow" target="_blank"> Map </a>对象，用于跟踪门户组件，这允许我们在<code class="fe lv lw lx ly b">portalType</code>的帮助下重用<code class="fe lv lw lx ly b">PortalIn</code> / <code class="fe lv lw lx ly b">PortalOut</code>组件。当<code class="fe lv lw lx ly b">PortalOut</code>渲染时，它要么渲染来自<code class="fe lv lw lx ly b">portalMap</code>的React组件，要么什么都不渲染，因为没有与<code class="fe lv lw lx ly b">portalType</code>匹配的组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="fdc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<code class="fe lv lw lx ly b">PortalIn</code>组件，您可以看到我们从<code class="fe lv lw lx ly b">PortalContext</code>访问了<code class="fe lv lw lx ly b">addPortalItem</code>和<code class="fe lv lw lx ly b">removePortalItem</code>函数。</p><ul class=""><li id="5ee5" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">在<a class="ae ky" href="https://reactjs.org/docs/hooks-reference.html#useeffect" rel="noopener ugc nofollow" target="_blank"> React.useEffect </a>中，我们通过<code class="fe lv lw lx ly b">addPortalItem</code>函数将<code class="fe lv lw lx ly b">portalType</code>和<code class="fe lv lw lx ly b">children</code>发送给<code class="fe lv lw lx ly b">PortalProvider</code>，在那里它们被添加到<code class="fe lv lw lx ly b">PortalOut</code>中的<code class="fe lv lw lx ly b">portalMap</code>对象中。</li><li id="8f60" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">还要注意，在<code class="fe lv lw lx ly b">useEffect</code>中，当<code class="fe lv lw lx ly b">PortalIn</code>组件在React应用程序中被卸载时，我们调用<code class="fe lv lw lx ly b">removePortalItem</code>。这将从<code class="fe lv lw lx ly b">PortalOut</code>中移除组件。</li><li id="5da7" class="mc md it lb b lc ml lf mm li mn lm mo lq mp lu mh mi mj mk bi translated">最后，注意我们返回了<code class="fe lv lw lx ly b">null</code>,所以没有呈现任何东西，因为我们不想在这个组件中显示任何东西。这是<code class="fe lv lw lx ly b">PortalOut</code>组件的工作。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="033c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们看看如何使用<a class="ae ky" href="https://reactjs.org/docs/context.html#contextprovider" rel="noopener ugc nofollow" target="_blank"> React上下文提供者</a>来创建我们的<code class="fe lv lw lx ly b">PortalProvider</code>。我们使用<a class="ae ky" href="https://reactjs.org/docs/hooks-reference.html#usestate" rel="noopener ugc nofollow" target="_blank"> React.useState </a>和<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" rel="noopener ugc nofollow" target="_blank"> Map </a>来持有键值对，也就是我们通过<a class="ae ky" href="https://reactjs.org/docs/react-api.html#reactchildren" rel="noopener ugc nofollow" target="_blank"> React.children </a>和<code class="fe lv lw lx ly b">portalType</code>道具传入的<code class="fe lv lw lx ly b">portalType</code>和<code class="fe lv lw lx ly b">component</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="7c4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这是有意义的，但是如果你想知道为什么我们每次都需要创建一个<code class="fe lv lw lx ly b">new Map</code>，那是因为我们需要<code class="fe lv lw lx ly b">useState</code>在调用<code class="fe lv lw lx ly b">addPortalItem</code>或<code class="fe lv lw lx ly b">removePortalItem</code>函数时触发更新。</p><p id="ee05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://react-transporting-portals-dte90s2z5.vercel.app/" rel="noopener ugc nofollow" target="_blank"> Next.js示例</a>和/或<a class="ae ky" href="https://github.com/codeBelt/react-transporting-portals" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="e67a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，请分享它，关注我，阅读我的其他<a class="ae ky" href="https://medium.com/@robertsavian" rel="noopener">文章</a>和/或用我下面的推荐链接注册Medium。谢谢！</p><div class="my mz gp gr na nb"><a href="https://medium.com/@robertsavian/membership" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">通过我的推荐链接加入Medium—Robert S(代码带)</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">medium.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ks nb"/></div></div></a></div></div></div>    
</body>
</html>