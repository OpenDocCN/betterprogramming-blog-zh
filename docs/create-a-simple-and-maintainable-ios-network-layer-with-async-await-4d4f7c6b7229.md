# 用 Async/Await 创建一个简单且可维护的 iOS 网络层

> 原文：<https://betterprogramming.pub/create-a-simple-and-maintainable-ios-network-layer-with-async-await-4d4f7c6b7229>

## 使用 async/await 为低于 15 的 iOS 版本创建一个具有良好可扩展性的网络层

![](img/6b3e5a15e1c6dbd33207ec073c9ec596.png)

该材料将是有用的，无论是对初学者还是一个老练的游客，我想你可以找到一些有趣的东西

这一切都是从苹果宣布**异步** / **等待**开始的，我想在行动中尝试一下。由于当时对于这项技术的提议没有现成的解决方案，所以决定提出一些易于扩展、便于调试和任意更改的解决方案

让我们从`URLRequest`扩展开始，因为标准组件没有方便的工具来处理网络请求方法

以下是协议:

*   `NetConfigType` —配置网络层，
*   `NetRoutes` —用实现的方法服务请求工厂，组装请求

为了更加方便，我们添加了一个模型，它将允许我们方便地呈现网络请求的响应，以便进行后续处理:

让我们描述一下未来请求的入口点和未来网络层的核心:

我们通过用协议关闭实现来实现请求工厂:

万岁！我们的网络层准备好了

使用嵌套`enum`可以轻松扩展该工厂:

使用所描述的网络层非常简单，可以归结为调用一个方法。大概是这样的:

这种解决方案被证明是相当轻量级的，易于扩展，它足以取代网络请求的实现，您可以通过 Publisher 获得一种反应式方法，或者您可以通过闭包使用标准方法。