<html>
<head>
<title>Optimizing Your CLI Experience by Knowing How To Pipe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过了解如何使用管道来优化您的CLI体验</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/optimizing-your-cli-experience-by-knowing-how-to-pipe-13669023eb23?source=collection_archive---------14-----------------------#2020-01-16">https://betterprogramming.pub/optimizing-your-cli-experience-by-knowing-how-to-pipe-13669023eb23?source=collection_archive---------14-----------------------#2020-01-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6ae3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解这个强大而优雅的特性的基础知识</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/66f23551e3c1865f487fd8beaafc4a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1NcJdb1MGW5HpSVU0QACAA.jpeg"/></div></div></figure><p id="5175" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">知道如何使用管道可以真正改变您使用CLI的方式。它可以为您使用的一些命令的看似复杂的输出带来更多的结构。但前提是你知道如何正确地吹奏。</p><p id="674a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">管道，您可以通过使用<code class="fe lq lr ls lt b">|</code>符号来利用它，将一个命令的输出作为另一个命令的输入来发送。并且这个命令的输出可以作为下一个命令的输入，等等。</p><p id="38d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">管道有助于创建强大的命令，这些命令可以执行复杂的任务。</p><p id="32cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我们将通过几个例子来演示如何使用管道以及使用管道的可能性。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="e5b5" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">让我们从简单的开始</h1><p id="c9d9" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">让我们来看一个非常基本的例子，在这个例子中我们使用了管道。在本例中，我们将使用一个包含所有<a class="ae my" href="https://gist.githubusercontent.com/kalinchernev/486393efcca01623b18d/raw/daa24c9fea66afb7d68f8d69f0c4b8eeb9406e83/countries" rel="noopener ugc nofollow" target="_blank">国家</a>的文件。我们将使用<code class="fe lq lr ls lt b">cat</code>来显示这个文件的内容。</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="eefc" class="nd mc it lt b gy ne nf l ng nh">cat countries</span></pre><p id="fb0b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于这样一个相对较长的文件，您可以看到提示跳转到了文件的末尾。内容太长，不适合您的屏幕。这是因为<code class="fe lq lr ls lt b">cat</code>命令会显示整个文件的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6fac3843e8ee6637fc0c4c7dc8342b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVm4ZLN4EBHwjHYrA0mV7w.png"/></div></div></figure><p id="ae1c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是有更聪明的方法，使用管道来显示这个文件的内容。</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="796c" class="nd mc it lt b gy ne nf l ng nh">cat countries | less</span></pre><p id="5b82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这导致<code class="fe lq lr ls lt b">cat</code>命令的输出传递给第二个命令，即<code class="fe lq lr ls lt b">less</code>。</p><p id="5d96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">Less</code>是一个终端分页程序，它可以通过箭头键浏览结果。要退出，按下<code class="fe lq lr ls lt b">q</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/6a7a6b612187753461d35d5bacd29fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oONP9YGMyeaaXTVKV-2plA.png"/></div></div></figure><p id="6f24" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除了<code class="fe lq lr ls lt b">less</code>，你还可以使用<code class="fe lq lr ls lt b">more</code>。<code class="fe lq lr ls lt b">More</code> <em class="nk"> </em>可以一次一屏的查看文本文件的内容。</p><p id="230e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe lq lr ls lt b">more</code>时，按<code class="fe lq lr ls lt b">Enter</code> <em class="nk">可逐行浏览文件。T </em>要一次导航一页，按下<code class="fe lq lr ls lt b">Spacebar</code>，其中一页相当于您当前终端屏幕的大小。要退出命令，只需按下<code class="fe lq lr ls lt b">q</code>。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="2268" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">但是你还可以做更多</h1><p id="1d63" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">除了浏览文件内容，您还可以用管道做更多的事情。</p><p id="7b61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，如果您想知道文件中有多少个国家，您可以使用<code class="fe lq lr ls lt b">wc</code>命令，这是单词计数的缩写。<code class="fe lq lr ls lt b">-l</code>选项打印行数。</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="31f0" class="nd mc it lt b gy ne nf l ng nh">cat countries | wc -l</span></pre><p id="3c84" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该命令返回196，这意味着该文件中有196个国家。</p><p id="4af0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如前所述，可以组合两个以上的命令:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="5c06" class="nd mc it lt b gy ne nf l ng nh">cat countries | head -10 | tail -3</span></pre><p id="9238" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该命令将获取<code class="fe lq lr ls lt b">cat</code>的输出，并将其用作<code class="fe lq lr ls lt b">head</code>命令的输入。<code class="fe lq lr ls lt b">head</code>命令列出了前十个国家，因为这是我们告诉它要做的。</p><p id="e03d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这十个国家将被用作<code class="fe lq lr ls lt b">tail</code>命令的输入。因为<code class="fe lq lr ls lt b">head</code>的输出被用于下一个命令。<code class="fe lq lr ls lt b">tail</code> <em class="nk"> </em>命令将返回最后三个国家。</p><p id="5f20" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这意味着，从最初的国家列表中，只有国家8、9和10会显示在屏幕上。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="3ee0" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">搜索</h1><p id="dec9" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">假设您想要在我们之前使用的文件中搜索特定的国家。您可以自己一行一行地检查内容来跟踪信息。</p><p id="bf7a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个更好，也可能更快的选择是使用<code class="fe lq lr ls lt b">grep</code>命令。<code class="fe lq lr ls lt b">grep</code>命令用于搜索文本。</p><p id="b601" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">Grep</code>将扫描文件中您想要检索的信息，并以您喜欢的格式显示结果。</p><p id="8bd2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从一个非常基本的<code class="fe lq lr ls lt b">grep</code>命令开始，我们在国家列表中查找单词<code class="fe lq lr ls lt b">Netherlands</code>。注意，默认情况下，<code class="fe lq lr ls lt b">grep</code>是区分大小写的。如果您想要搜索不区分大小写，请添加<code class="fe lq lr ls lt b">-i</code>选项。</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="3ec4" class="nd mc it lt b gy ne nf l ng nh">grep "Netherlands" countries</span></pre><p id="f831" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该命令将返回<code class="fe lq lr ls lt b">Netherlands</code>，这意味着该字符串在国家列表中出现过一次。如果我们打错了，输入了<code class="fe lq lr ls lt b">Metherlands</code>，将不会返回任何内容。</p><p id="afa8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就其本身而言，这个命令是相当不言自明的。如果您想知道一个字符串在文件中出现了多少次，您也可以使用<code class="fe lq lr ls lt b">-c</code>选项。</p><p id="ca6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很多时候，你需要更多的上下文来了解你要搜索的字符串在文件中的位置。您可以使用<code class="fe lq lr ls lt b">-n</code>选项，它将返回行号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/4c7e62763497ac9c14a97075f3dc65d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tadfdvFuX44gJ2s0RFSv-w.png"/></div></div></figure><p id="c3e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">作为替代，您可以使用<code class="fe lq lr ls lt b">-C</code>选项，它提供了上下文行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/fab0bf3aec3d2e1d51824b9d423e397b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LbbBYs2YeNtIjjFX4e5LEw.png"/></div></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="3b98" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">这是如何与管道一起工作的？</h1><p id="919b" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">让我们来看一个更实际的例子，我们想检查某个IP地址在过去五分钟内是否访问过我们的网站。我们可以通过在网站的访问日志中使用<code class="fe lq lr ls lt b">grep</code>来高效地完成这项工作。</p><p id="9612" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这不是一个高流量的网站，所以100行日志应该足够覆盖过去5分钟。</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="6e25" class="nd mc it lt b gy ne nf l ng nh">cat /path/to/access/log | tail -100 | grep -ic "ip: 127.0.0.1"</span></pre><p id="9a38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将在该文件的最后一百行中搜索我们的目标IP地址<code class="fe lq lr ls lt b">127.0.0.1</code>，并区分大小写。因此，出现的次数将打印在屏幕上。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="f64a" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论</h1><p id="c2eb" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">我希望这篇文章让您对如何使用管道有了基本的了解，这样您就可以优化您的CLI体验。</p><p id="c377" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们用<code class="fe lq lr ls lt b">less</code>、<code class="fe lq lr ls lt b">more</code>、<code class="fe lq lr ls lt b">wc</code>和<code class="fe lq lr ls lt b">grep</code>讲解了配管的基本知识。其中一些命令可以帮助您更有效地提取您正在寻找的信息。</p><p id="d32c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你有任何问题，请在评论区告诉我。我很乐意回答你的问题。</p></div></div>    
</body>
</html>