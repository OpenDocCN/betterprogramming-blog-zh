<html>
<head>
<title>How To Write Clearer Python Code With Type Hints</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用类型提示编写更清晰的Python代码</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-write-clearer-python-code-with-type-hints-330216291b7c?source=collection_archive---------6-----------------------#2021-07-28">https://betterprogramming.pub/how-to-write-clearer-python-code-with-type-hints-330216291b7c?source=collection_archive---------6-----------------------#2021-07-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="227e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过使变量和函数更加自文档化来避免错误</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ea2350101b676817e4ef16858089dfd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2Hye8OPbQYosLkoP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@dtravisphd?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大卫·特拉维斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="daff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都经历过在一个项目中工作和对着屏幕咒骂的麻烦，因为变量和函数似乎毫无意义，到处都是<code class="fe lv lw lx ly b">TypeError</code> s。这些情况使得开发人员希望Python中有静态类型，就像其他语言一样。还好有！是否使用它们以及在哪里使用它们完全取决于你！</p><h1 id="9ebc" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">什么是类型提示</h1><p id="f9be" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">顾名思义，类型提示是一种内置的方式，可以给出关于变量和函数代表什么的提示。您可以指定变量的类型或函数的返回类型，而无需改变程序的逻辑或添加任何代码行。您也可以创建自己的类型。需要指出的是，与静态类型语言不同，Python解释器完全忽略了类型提示:事实上，它们只是提示，而不是规则。</p><h1 id="fd1d" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">类型提示的好处</h1><p id="3b07" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">与传统的动态Python风格相比，使用类型提示有很多好处:</p><ul class=""><li id="9e2a" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">清晰度提高</strong>:告别无意义的符号。能够容易地识别一个变量意味着什么将会加速开发时间。</li><li id="658a" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">更少的错误:去掉你程序中愚蠢的错误。</li><li id="c355" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">自文档化代码</strong>:懒得为你的代码写文档？写一些简单的函数来帮助那些可能会看你代码库的人。</li><li id="e3e1" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">更好的IDE集成</strong>:你的IDE将使用你给它的类型提示来更好地分析你的代码中的问题并帮助你编码。</li></ul><h1 id="f350" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">如何实现类型提示</h1><p id="3dca" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">我将从一个简单的类型提示的例子开始，帮助您发展直觉。然后我将深入讨论它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="46f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然很酷，但这似乎帮助不大。显而易见，变量代表什么，甚至需要更多的时间来注释类型。但是类型提示并不止于此。Python中有很多可用的类型，你可以从<code class="fe lv lw lx ly b">typing</code>模块中导入更多，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="80b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有很多类型我就不在这里讨论了。你可以在<a class="ae ky" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">文档</a>中找到它们。</p><h1 id="5819" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">更高级的类型提示</h1><p id="7a69" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">到目前为止，你只是看到了一些很酷但没用的变量赋值。现在是时候真正使用类型提示了。</p><h2 id="312d" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">变量声明</h2><p id="0072" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">您可以声明一个类型化变量，而不用给它赋值。这里有一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="a88b" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">多种类型(联合)</h2><p id="305e" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated"><code class="fe lv lw lx ly b">Union</code>表示类型可以是指定的类型之一:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="1628" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">类型化函数</h2><p id="ac8c" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">类型化函数是编写良好的模块的主要部分。您可以指定参数的类型以及返回类型。这里有一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="da59" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">可选类型</h2><p id="3482" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">请注意，可选类型不是可选参数。<code class="fe lv lw lx ly b">Optional[x]</code>表示参数可以是<code class="fe lv lw lx ly b">None</code>或<code class="fe lv lw lx ly b">x.</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="d60f" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">创建类型</h2><p id="2092" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">如果愿意，您也可以创建自己的类型。以下是文档中的一个示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="aa38" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">文字类型</h2><p id="9f63" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">一种类型，指示变量值必须是指定集合中的一个。看看这个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="05ea" class="nm ma it bd mb nn no dn mf np nq dp mj li nr ns ml lm nt nu mn lq nv nw mp nx bi translated">使用类键入</h2><p id="c611" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">同样，你可以用<code class="fe lv lw lx ly b">NewType</code>定义你自己的类型。也可以用类；一个如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="b549" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">结论</h1><p id="5799" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">类型提示是在程序中使用的一个很好的编码实践。它不仅使您的代码更容易理解，而且还有助于您的IDE的类型检查器识别并突出显示愚蠢的错误。除此之外，想象一下必须处理一个具有如下功能的模块:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="85fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为<code class="fe lv lw lx ly b">ip</code>应该传什么？对于<code class="fe lv lw lx ly b">port</code>？<code class="fe lv lw lx ly b">timeout</code>是<code class="fe lv lw lx ly b">datetime.timedelta</code>对象还是<code class="fe lv lw lx ly b">int</code>？<code class="fe lv lw lx ly b">on_connection</code>和<code class="fe lv lw lx ly b">on_error</code>带什么论点？<code class="fe lv lw lx ly b">make_connection</code>还要返回什么？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="ea7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建更长但更清晰的自文档化代码值得花时间来注释类型，尤其是当其他人可能会阅读您的代码时。无论是公共模块还是你的团队正在进行的项目，清晰都是很重要的。</p><p id="d0b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">静态类型是一种祝福，而不是诅咒。尽可能使用它们。</p><p id="f44f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有更多类型提示的用例，请在评论中分享。我总是乐于学习新技术；他们肯定会受到赞赏。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="0867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您希望您的代码不仅可读性更好，而且运行速度也快几个数量级，那么您应该看看我关于Python的C扩展的文章:</p><div class="of og gp gr oh oi"><a rel="noopener  ugc nofollow" target="_blank" href="/speed-up-your-python-codebases-with-c-extensions-94859875eb70"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">用C扩展加速你的Python代码库</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">给你的Python程序带来C语言的速度</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">better编程. pub</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div><p id="9097" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>