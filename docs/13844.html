<html>
<head>
<title>Integrate Google Maps Into the Jetpack Compose App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将谷歌地图集成到Jetpack Compose应用程序中</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/integrate-google-maps-into-the-jetpack-compose-app-c2710a226af2?source=collection_archive---------5-----------------------#2022-10-03">https://betterprogramming.pub/integrate-google-maps-into-the-jetpack-compose-app-c2710a226af2?source=collection_archive---------5-----------------------#2022-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="04cf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Jetpack合成+地图合成库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dc797d6cb4c323752f4e6cff5f06ec20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPEjMQ11jouUnuX-o4QYLA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">本图中使用的Jetpack Compose徽标是由Google | base image作者创建的<a class="ae kv" href="https://android-developers.googleblog.com/2020/08/announcing-jetpack-compose-alpha.html" rel="noopener ugc nofollow" target="_blank">官方徽标</a></p></figure><p id="6f49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天我们将讨论如何将地图集成到您的Jetpack Compose应用程序中。为此，我们将使用地图合成库。</p><blockquote class="ls lt lu"><p id="3987" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">"地图合成库包含可合成的函数和数据类型，让您执行许多常见的任务."根据<a class="ae kv" href="https://developers.google.com/maps/documentation/android-sdk/maps-compose" rel="noopener ugc nofollow" target="_blank">地图组成图书馆官方文件</a></p></blockquote><p id="cf77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，您需要按照本页上的说明获取API密钥:</p><div class="lz ma gp gr mb mc"><a href="https://developers.google.com/maps/documentation/android-sdk/get-api-key" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">使用API键Android地图| Google开发者</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">本主题介绍如何为Android版地图SDK创建API密钥，将其添加到您的应用程序，并通过以下方式保护应用程序</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">developers.google.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq kp mc"/></div></div></a></div><p id="6424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，让我们包括所需的依赖项:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d723" class="mw mx iq ms b gy my mz l na nb">implementation 'com.google.maps.android:maps-compose:2.7.2'<br/>implementation 'com.google.android.gms:play-services-maps:18.1.0'</span></pre><p id="5f74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>检查这些依赖项是否有更新的版本。</p><p id="333c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，在您的清单文件中，添加以下元数据:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="0fd0" class="mw mx iq ms b gy my mz l na nb">&lt;meta-data<br/>    android:name="com.google.android.geo.API_KEY"<br/>    android:value="${MAPS_API_KEY}" /&gt;</span></pre><p id="ec45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经准备好在代码中实现地图了！</p><h1 id="20b7" class="nc mx iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">将地图集成到应用程序中</h1><p id="345e" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">通过调用<code class="fe ny nz oa ms b">GoogleMap()</code>，我们将在应用程序中显示地图。就这么简单！<code class="fe ny nz oa ms b">GoogleMap</code>是<code class="fe ny nz oa ms b">MapView</code>的合成容器。它允许我们在应用程序中显示地图。我们可以向这个composable传递许多参数，但所有参数都是可选的。</p><p id="4c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些参数如下:</p><ul class=""><li id="adc9" class="ob oc iq ky b kz la lc ld lf od lj oe ln of lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">cameraPositionState: CameraPositionState</code> —用于控制或观察地图的摄像头状态。</li><li id="f88b" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">googleMapOptionsFactory: () -&gt; GoogleMapOptions</code> —创建地图时提供的用于创建<code class="fe ny nz oa ms b">GoogleMapOptions</code>的块。</li><li id="1a0c" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">properties: MapProperties</code> —地图的属性，如<code class="fe ny nz oa ms b">isBuildingEnabled</code>、<code class="fe ny nz oa ms b">isIndoorEnabled</code>、<code class="fe ny nz oa ms b">isMyLocationEnabled</code>等。如果<code class="fe ny nz oa ms b">isMyLocationEnabled</code>设置为真，那么我们需要请求精确和粗略位置的权限。要了解如何在Jetpack compose中请求位置权限，请查看我以前的文章之一。</li><li id="acec" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">uiSettings: MapUiSettings</code> —地图上特定于UI的设置，如<code class="fe ny nz oa ms b">compassEnabled</code>、<code class="fe ny nz oa ms b">scrollGesturesEnabled</code>、<code class="fe ny nz oa ms b">rotationGesturesEnabled</code>等。</li><li id="cbc9" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">各种兰姆达，像<code class="fe ny nz oa ms b">onMapClicked</code>、<code class="fe ny nz oa ms b">onMapLoaded</code>、<code class="fe ny nz oa ms b">onMyLocationButtonClick</code>。</li></ul><p id="1a65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们可以将相机状态设置为放大某个特定位置。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e74e" class="mw mx iq ms b gy my mz l na nb">val cameraPositionState = <em class="lv">rememberCameraPositionState </em><strong class="ms ir">{<br/>    </strong>position = CameraPosition.fromLatLngZoom(LatLng(44.810058, 20.4617586), 16f)<br/><strong class="ms ir">}</strong></span></pre><p id="76cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们也可以得到最后的位置或者当前的位置。有关该检查的更多信息，请查看本文档。</p><h2 id="6813" class="mw mx iq bd nd op oq dn nh or os dp nl lf ot ou nn lj ov ow np ln ox oy nr oz bi translated">标记</h2><p id="0c28" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">如果我们想标记地点，例如，最近的加油站、酒店或任何你需要的东西，该怎么办？图书馆帮我们找到了。为此我们可以使用<code class="fe ny nz oa ms b">Markers</code>。</p><p id="e5ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ny nz oa ms b">Marker</code> composable有几个参数。我们将讨论最常用的，但也可以随意检查它们。</p><ul class=""><li id="1e2c" class="ob oc iq ky b kz la lc ld lf od lj oe ln of lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">state: MarkerState</code> —用于控制或观察标记状态，如其位置和信息窗口。</li><li id="539f" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">draggable: Boolean</code> —设置标记的可拖动性。</li><li id="fd5c" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">flat: Boolean</code> —设置标记是否应平放在地图上。</li><li id="06eb" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">icon: BitmapDescriptor</code> —设置标记的图标。</li><li id="f1e6" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated">各种lambdas，如<code class="fe ny nz oa ms b">onClick</code>、<code class="fe ny nz oa ms b">onInfoWindowClick</code>、<code class="fe ny nz oa ms b">onInfoWindowClose</code>和<code class="fe ny nz oa ms b">onInfoWindowLongClick</code>。</li></ul><p id="76f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们添加一些不同颜色的标记。代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="98dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您还可以从资源、资源、位图、文件等中获取标记的图标。如果您单击任何标记，您将看到一个带有标记标题的信息窗口。</p><h2 id="d7b8" class="mw mx iq bd nd op oq dn nh or os dp nl lf ot ou nn lj ov ow np ln ox oy nr oz bi translated">多叉线</h2><p id="eb38" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">接下来我们要做的是在两点之间画一条线。为此我们可以使用<code class="fe ny nz oa ms b">Polyline</code>。</p><p id="9c64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它只有一个必需的参数，那就是纬度和经度列表。其他一些参数包括:</p><ul class=""><li id="6aeb" class="ob oc iq ky b kz la lc ld lf od lj oe ln of lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">clickable: Boolean</code> —布尔值，指示折线是否可点击</li><li id="697a" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">color: Color</code> —折线的颜色</li><li id="e63e" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">startCap: Cap</code>-多段线起始顶点处的帽</li><li id="9934" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">endCap: Cap</code>-多段线末端顶点处的帽子</li><li id="865b" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">width: Float</code> —以屏幕像素为单位的折线宽度</li><li id="7c73" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><code class="fe ny nz oa ms b">onClick: (Polyline) -&gt; Unit</code>-单击折线时调用的lambda</li></ul><p id="63f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将只添加一条连接标记的折线:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="e17e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="87b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在地图上使用许多选项和组件，但现在没有必要一一介绍。你可以在官方文件中查看它们。</p><p id="440b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的<code class="fe ny nz oa ms b">MapsApp</code>就到这里，我希望你从这篇文章中学到了一些新的东西，并喜欢它。</p><p id="8fa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在<a class="ae kv" href="https://github.com/Giga99/MediumRepos" rel="noopener ugc nofollow" target="_blank">我的GitHub repo </a>中找到所有的源代码。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="f67f" class="mw mx iq ms b gy my mz l na nb"><strong class="ms ir">Want to Connect?</strong></span><span id="5a1c" class="mw mx iq ms b gy pc mz l na nb"><a class="ae kv" href="https://github.com/Giga99" rel="noopener ugc nofollow" target="_blank">GitHub</a><br/><a class="ae kv" href="https://www.linkedin.com/in/igor-stevanovic/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><a class="ae kv" href="https://twitter.com/igor_s1999" rel="noopener ugc nofollow" target="_blank"><br/>Twitter</a><br/><a class="ae kv" href="https://giga99.github.io/portfolio-website/" rel="noopener ugc nofollow" target="_blank">Portfolio website</a></span></pre></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><p id="6fc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想了解更多关于Jetpack Compose的信息，请阅读以下文章:</p><ul class=""><li id="3477" class="ob oc iq ky b kz la lc ld lf od lj oe ln of lr og oh oi oj bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/implement-bottom-sheet-in-jetpack-compose-d6472e8eaf2e">在Jetpack排版中实现底部表单</a></li><li id="5842" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/implement-horizontal-and-vertical-viewpager-in-jetpack-compose-a7a91f2ac746">在Jetpack Compose中实现水平和垂直view pager</a></li><li id="f1f7" class="ob oc iq ky b kz ok lc ol lf om lj on ln oo lr og oh oi oj bi translated"><a class="ae kv" href="https://medium.com/better-programming/build-a-camera-android-app-in-jetpack-compose-using-camerax-4d5dfbfbe8ec" rel="noopener">使用CameraX在Jetpack Compose中构建相机Android应用</a></li></ul><p id="6805" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，通过阅读本文，您可以了解如何使用拦截器在请求中包含访问令牌:</p><div class="lz ma gp gr mb mc"><a rel="noopener  ugc nofollow" target="_blank" href="/android-access-token-logic-with-retrofit-okhttp-interceptors-740ea48547a0"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">Android访问令牌逻辑和改进的OkHttp拦截器</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">使用OkHttp拦截器的访问令牌头逻辑</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">better编程. pub</p></div></div><div class="ml l"><div class="pk l mn mo mp ml mq kp mc"/></div></div></a></div><h1 id="2185" class="nc mx iq bd nd ne nf ng nh ni nj nk nl jw nm jx nn jz no ka np kc nq kd nr ns bi translated">资源</h1><div class="lz ma gp gr mb mc"><a href="https://developers.google.com/maps/documentation/android-sdk/maps-compose" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">地图合成库Android地图SDK谷歌开发者</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">Jetpack Compose是一个声明性的本地UI工具包，它简化并加速了UI开发。使用Jetpack…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">developers.google.com</p></div></div><div class="ml l"><div class="pl l mn mo mp ml mq kp mc"/></div></div></a></div></div></div>    
</body>
</html>