<html>
<head>
<title>How to Create an Angular Pipeline With Jenkins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Jenkins创建一个有角度的管道</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-create-an-angular-pipeline-with-jenkins-8040f1a0c0ee?source=collection_archive---------1-----------------------#2020-06-10">https://betterprogramming.pub/how-to-create-an-angular-pipeline-with-jenkins-8040f1a0c0ee?source=collection_archive---------1-----------------------#2020-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3c54" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">改善CI的逐步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/52e808b4b492f50ebb8c2c5e5fdba7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_KphGScFGnJITMez"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JJ英</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure><p id="290b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将看到如何从头开始设置Jenkins，并创建和运行Angular pipeline——所有这一切只需大约五分钟。如果你不熟悉Angular也不用担心。同样的原则也适用于Vue、React、Python、Java和其他语言。所以放松点，因为我们就要开始了。</p><p id="d7eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文章的结构如下:</p><ul class=""><li id="4336" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">陷害詹金斯</li><li id="94d7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">创建Jenkinsfile</li><li id="e205" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">创建管道</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5bfb" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">陷害詹金斯</h1><p id="b825" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果您已经熟悉Jenkins，请随意跳过这一部分。</p><p id="4ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一节中，我们将按照<a class="ae ky" href="https://www.jenkins.io/doc/book/installing/" rel="noopener ugc nofollow" target="_blank">Jenkins网站</a>上显示的步骤来安装macOS和Linux。您还可以找到在Windows机器上开始使用的信息。</p><p id="58fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们为Jenkins创建一个网络:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="7039" class="ns mr it no b gy nt nu l nv nw">docker network create jenkins</span></pre><p id="d502" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加两个卷以共享Docker客户端TLS证书并保存Jenkins数据。这样，当你关闭电脑或服务器时，数据不会丢失。请记住，如果删除这些卷，数据将永久丢失。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1dcb" class="ns mr it no b gy nt nu l nv nw">docker volume create jenkins-docker-certs<br/>docker volume create jenkins-data</span></pre><p id="7546" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下四个命令启动Docker容器:</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c947" class="ns mr it no b gy nt nu l nv nw">docker image pull docker:dind<br/>docker container run --name jenkins-docker \<br/>  --restart unless-stopped \<br/>  --detach \<br/>  --privileged --network jenkins \<br/>  --network-alias docker \<br/>  --env DOCKER_TLS_CERTDIR=/certs \<br/>  --volume jenkins-docker-certs:/certs/client \<br/>  --volume jenkins-data:/var/jenkins_home \<br/>  --publish 2376:2376\<br/>  docker:dind</span><span id="08cc" class="ns mr it no b gy nx nu l nv nw">docker image pull jenkinsci/blueocean<br/>docker container run --name jenkins-blueocean \<br/>  --restart unless-stopped \<br/>  --detach \<br/>  --network jenkins \<br/>  --env DOCKER_HOST=tcp://docker:2376 \<br/>  --env DOCKER_CERT_PATH=/certs/client \<br/>  --env DOCKER_TLS_VERIFY=1 \<br/>  --volume jenkins-data:/var/jenkins_home \<br/>  --volume jenkins-docker-certs:/certs/client:ro \<br/>  --publish 8080:8080 \<br/>  --publish 50000:50000 \<br/>jenkinsci/blueocean</span></pre><p id="0613" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Jenkins现在运行在<a class="ae ky" href="http://HTTP://localhost:8080," rel="noopener ugc nofollow" target="_blank"> http://localhost:8080，</a>上，但是你必须做一个更棘手的步骤:你必须解锁Jenkins。初始密码可以在Jenkins CI blue ocean Docker容器的一个文件夹中找到。我会告诉你如何取回这个。当你自己尝试的时候，确保你指定了正确的docker <a class="ae ky" href="https://medium.com/better-programming/what-is-a-uuid-and-how-are-they-generated-17f0acbd7233" rel="noopener"> UUID </a>。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="eb84" class="ns mr it no b gy nt nu l nv nw"><strong class="no iu">docker container ps<br/></strong>4ec29afb280f        jenkinsci/blueocean<br/>1ce11b131265        docker:dind<br/><strong class="no iu">docker container exec 4ec29afb280f cat /var/jenkins_home/secrets/initialAdminPassword</strong></span><span id="2c43" class="ns mr it no b gy nx nu l nv nw"><strong class="no iu">bd95aa5131a142b690795fa9427287a8</strong></span></pre><p id="9dbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一步中，您可以配置想要安装的插件。我将把那件事留给你。我安装了Cobertura(用于Java)和Locale插件，并去掉了Subversion。安装后，您必须创建一个管理员用户。</p><p id="7c1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最后一步中，您必须设置一个Jenkins URL(例如<a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>)，但是我没有费心去更改它。最后，詹金斯重新启动，并完全安装。我们只花了几分钟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ce8b32b0f1c4e1212f6357721deb5265.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*46TyvpDdnZdxJs2TcMfz_w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">詹金斯用户界面</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d571" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建Jenkinsfile</h1><p id="a043" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们面对现实吧，定义一个好的管道有很多可能的方法。这只是一个简单的例子。如果您对改进渠道有任何建议，我们将非常乐意倾听。不要犹豫，在文末留下评论吧！</p><p id="ac37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，指定一个基本Docker映像来运行我们的命令是很重要的。在撰写本文时，使用最新的node Docker映像似乎是一个不错的选择。</p><p id="c68c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们指定要检查的阶段。在这种配置中，指定了最容易识别的开发阶段:</p><ul class=""><li id="0982" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">Install —确保我们正确无误地安装了每个依赖项。</li><li id="34e3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">测试—列表、单元测试。为此，我们定义了两个可以并行运行的阶段。如果您有需要，可以随意添加集成或端到端测试。</li><li id="3799" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">构建——最后，我们的构建仍然有失败的可能。这是部署应用程序之前的最后一步。</li></ul><p id="9d9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请随意添加其他步骤。在这一点上，你有这么多的自由。自动部署或发布Docker映像，该映像可向有限数量的用户推广。这是你的选择。在结束这一部分之前，让我与您分享一下管道。将它放入项目根文件夹中的Jenkinsfile(无扩展名)中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">詹金斯文件</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="b973" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创建管道</h1><p id="d892" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在<a class="ae ky" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>上打开Jenkins，创建一个新项目。实际上，这里不需要做太多。让我们创建一个“多分支管道”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/4ac026fe1f5c43682aff734ed6ab9f7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfzbEckjW2FYi8p6UnC1dQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建管道菜单</p></figure><p id="aef1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将打开一个新菜单。在这里，您可以在许多其他内容中添加描述，但我们将只涵盖本文中最重要的部分。您应该查找名为“分支源代码”的部分，并选择Git。接下来要做的事情是传递一个项目存储库(例如https://github.com/user/project-name.git的<a class="ae ky" href="https://github.com/djFooFoo/dj-website.git" rel="noopener ugc nofollow" target="_blank">)和你的凭证。这就足够了。</a></p><p id="4d6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们再加一个东西，让它成为自动流水线。让我们轮询一下GitHub存储库的变化。启用“扫描多分支管道触发器”并传递一个合理的时间间隔。这将仅在存在源代码变更时触发构建(例如，每分钟)。这样，构件会自动触发。如果一分钟的时间太长，您可以降低时间间隔，以便稍后检查更改。</p><p id="cb49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在转到<a class="ae ky" href="http://localhost:8080/blue/organizations/jenkins/pipelines" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/blue/organizations/Jenkins/pipelines</a>并运行您的第一个作业，如果它还没有运行的话。让我给你看看这个是什么样子的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/902cf842f1b24fa8d64d1a8047104616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*1sXRVnlZI5lwq01PXpZC1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">管道成功了！</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="31b5" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="f276" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在本文中，Jenkins管道在五分钟内创建完成，而且不费吹灰之力！为其他应用程序创建一个也不需要很多时间。请随意创建您自己的。我的结论是，对于很多开发者来说，Jenkins已经足够了，而且非常稳定。</p><p id="635e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在云中做同样的事情不需要付出很多。你所需要的只是一些硬件，比如一台有几GBs内存的旧电脑和一台显示器，来创建一堵墙。</p><p id="006a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看完这篇文章你有什么想法？你打算试试吗？</p></div></div>    
</body>
</html>