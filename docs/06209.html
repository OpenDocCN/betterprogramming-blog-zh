<html>
<head>
<title>Sending Transactional Emails With Sendinblue in Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Kotlin中的Sendinblue发送事务性电子邮件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/sending-transactional-emails-with-sendinblue-in-kotlin-6f6920f49733?source=collection_archive---------12-----------------------#2020-09-09">https://betterprogramming.pub/sending-transactional-emails-with-sendinblue-in-kotlin-6f6920f49733?source=collection_archive---------12-----------------------#2020-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6257" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">自动化您的Android电子邮件营销策略</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cd7634f1b9491b7fd200bd7158dd9db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7_MuCu8CSy80_4X5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="51ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将解释如何使用Sendinblue发送事务性电子邮件。</p><blockquote class="lv lw lx"><p id="00be" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">“Sendinblue是一套全面的SaaS通信工具，包括电子邮件营销、交易电子邮件、短信以及<a class="ae ky" href="https://www.sendinblue.com/features/" rel="noopener ugc nofollow" target="_blank">更多</a>。”— <a class="ae ky" href="https://developers.sendinblue.com/docs" rel="noopener ugc nofollow" target="_blank"> <em class="it"> Sendinblue官方文档</em> </a></p></blockquote><p id="293b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sendinblue的<a class="ae ky" href="https://developers.sendinblue.com/docs/send-a-transactional-email" rel="noopener ugc nofollow" target="_blank">事务性电子邮件文档</a>推荐使用他们的<a class="ae ky" href="https://developers.sendinblue.com/docs/api-clients" rel="noopener ugc nofollow" target="_blank"> API客户端</a>，这些客户端在:<a class="ae ky" href="https://github.com/sendinblue/APIv3-csharp-library" rel="noopener ugc nofollow" target="_blank"> C# </a>、<a class="ae ky" href="https://github.com/sendinblue/APIv3-go-library" rel="noopener ugc nofollow" target="_blank"> Go </a>、<a class="ae ky" href="https://github.com/sendinblue/APIv3-java-library" rel="noopener ugc nofollow" target="_blank"> Java </a>、<a class="ae ky" href="https://github.com/sendinblue/APIv3-nodejs-library" rel="noopener ugc nofollow" target="_blank"> Node JS </a>、<a class="ae ky" href="https://github.com/sendinblue/APIv3-php-library" rel="noopener ugc nofollow" target="_blank"> PHP </a>、<a class="ae ky" href="https://github.com/sendinblue/APIv3-python-library" rel="noopener ugc nofollow" target="_blank"> Python </a>和<a class="ae ky" href="https://github.com/sendinblue/APIv3-ruby-library" rel="noopener ugc nofollow" target="_blank"> Ruby </a>中可用并有文档记录。那么<a class="ae ky" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank">科特林</a>呢？</p><p id="9c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要了解什么是事务性邮件。</p><blockquote class="lv lw lx"><p id="dfcf" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu"> </strong>交易电子邮件<strong class="lb iu"> </strong>是由您的网站自动发送给某个收件人的电子邮件，该电子邮件是由该人执行的交易或特定事件(如电子商务购买或密码重置请求)引起的— <a class="ae ky" href="https://www.sendinblue.com/blog/transactional-emails-guide/" rel="noopener ugc nofollow" target="_blank">交易邮件营销人员完整指南</a></p></blockquote><p id="adf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们准备开始学习教程了。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="4216" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建新的Sendinblue帐户</h1><p id="3cb3" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">首先，我们需要一个Sendinblue帐户。有几个<a class="ae ky" href="https://www.sendinblue.com/pricing/" rel="noopener ugc nofollow" target="_blank">计划</a>可用，但我们将使用免费的，它带有一些限制，如<a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/208580669-Is-there-a-limit-to-the-free-plan-" rel="noopener ugc nofollow" target="_blank">中所述，免费计划有限制吗？</a></p><p id="9ff5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在此页面创建一个新账户:<a class="ae ky" href="https://app.sendinblue.com/account/register" rel="noopener ugc nofollow" target="_blank">https://app.sendinblue.com/account/register</a></p><p id="13ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成这些后，就该获取我们的Sendinblue <a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/209467485-What-s-an-API-key-and-how-can-I-get-mine-" rel="noopener ugc nofollow" target="_blank"> API键</a>，这是开始调用Sendinblue API所必需的。您可以按照文档中的描述在<a class="ae ky" href="https://developers.sendinblue.com/docs/getting-started#quick-start" rel="noopener ugc nofollow" target="_blank">获取您的API密钥</a>下检索您的API密钥。</p><p id="9a4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以开始写几行代码了。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="2fff" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装Sendinblue API客户端</h1><p id="cc69" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了在Kotlin中发送事务性电子邮件，我们需要安装<a class="ae ky" href="https://github.com/sendinblue/APIv3-java-library" rel="noopener ugc nofollow" target="_blank"> Sendinblue API客户端</a>。</p><p id="07f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您是Gradle用户，请将此依赖项添加到项目的构建文件中:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="483d" class="nl mk it nh b gy nm nn l no np">compile "com.sendinblue:sib-api-v3-sdk:4.1.1"</span></pre><p id="8353" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">否则，如果您是Maven用户，请将以下依赖项添加到项目的构建POM中:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="caaa" class="nl mk it nh b gy nm nn l no np">&lt;dependency&gt;<br/>    &lt;groupId&gt;com.sendinblue&lt;/groupId&gt;<br/>    &lt;artifactId&gt;sib-api-v3-sdk&lt;/artifactId&gt;<br/>    &lt;version&gt;4.1.1&lt;/version&gt;<br/>    &lt;scope&gt;compile&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="8052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sendinblue API客户端现在已经安装完毕，可以使用了。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="712b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">定义包含动态内容的新模板</h1><p id="00db" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Sendinblue允许用户定义自己的<a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/360000946299-Create-customize-transactional-email-templates" rel="noopener ugc nofollow" target="_blank">定制模板</a>来设计电子邮件。模板支持动态内容，可以填充<a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/360000268730#attributes" rel="noopener ugc nofollow" target="_blank">联系人属性</a>(默认情况下，一个联系人有以下属性:<code class="fe nq nr ns nh b">EMAIL</code>、<code class="fe nq nr ns nh b">FIRSTNAME</code>、<code class="fe nq nr ns nh b">LASTNAME</code>、<code class="fe nq nr ns nh b">SMS</code>、<a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/360000268730#predefined" rel="noopener ugc nofollow" target="_blank">预定义变量</a>，自定义<a class="ae ky" href="https://help.sendinblue.com/hc/en-us/articles/360000268730#transactional" rel="noopener ugc nofollow" target="_blank">交易参数</a>。</p><p id="0bf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程的目标不是展示如何在Sendinblue中定义模板。所以，要完成这一步，强烈建议遵循官方指南。</p><p id="ad2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意:不要忘记保存您刚刚创建的模板的ID，因为我们将在下一步中使用它。</p><p id="774d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经有了在Kotlin中发送第一封事务性电子邮件所需的所有构件。让我们看看下一步怎么做。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="2cf6" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">发送交易电子邮件</h1><p id="5d44" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">是时候看看我们如何用Kotlin发送事务性电子邮件了。这可以通过下面几行代码轻松实现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="9102" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事务参数必须在<code class="fe nq nr ns nh b"><a class="ae ky" href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/" rel="noopener ugc nofollow" target="_blank">Map</a>&lt;String,String&gt;</code>对象中定义。地图是包含成对的<code class="fe nq nr ns nh b">&lt;key,value&gt;</code>对象的集合。在每一对中，<code class="fe nq nr ns nh b">key</code>是模板中定义的参数名，<code class="fe nq nr ns nh b">value</code>是我们希望赋予所选参数的相应值。</p><p id="49ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sendinblue API客户端需要一个<code class="fe nq nr ns nh b">SendSmtpEmailTo</code>对象列表，每个对象代表一个接收者。</p><p id="3540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个收件人必须有一个电子邮件，而名称是可选的。前者应该是在Sendinblue中注册并分配到联系人列表的联系人，后者是将附加到电子邮件收件人的名称，它将出现在电子邮件标题中，但不会出现在电子邮件正文中。</p><p id="9401" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您按照上一步中的描述创建了一个模板，您应该会得到以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/1d74bbaed6d72a0652771be5ac7e90e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xj1oxPOUTlQhVYjyjjMUTg.png"/></div></div></figure><h2 id="ac12" class="nl mk it bd ml nw nx dn mp ny nz dp mt li oa ob mv lm oc od mx lq oe of mz og bi translated">额外的</h2><p id="c641" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们刚刚看到了如何使用官方的Sendinblue API客户端发送事务性电子邮件，但是使用<code class="fe nq nr ns nh b">POST <a class="ae ky" href="https://api.sendinblue.com/v3/smtp/email" rel="noopener ugc nofollow" target="_blank">https://api.sendinblue.com/v3/smtp/email</a></code> API也可以获得相同的结果。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="76eb" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="2176" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本教程中，我们展示了如何在Kotlin中发送事务性电子邮件。我们通过利用官方的Sendinblue Java API客户端和Kotlin特有的与Java互操作的特性，成功实现了我们的目标。</p><p id="2aa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有所帮助——感谢阅读！如果你有任何意见或建议，请告诉我。</p></div></div>    
</body>
</html>