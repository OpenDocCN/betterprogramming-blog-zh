<html>
<head>
<title>How To Use Null Safety in Dart 2.12</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Dart 2.12中使用空安全</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-use-null-safety-in-dart-e0eb6bc02734?source=collection_archive---------6-----------------------#2021-03-04">https://betterprogramming.pub/how-to-use-null-safety-in-dart-e0eb6bc02734?source=collection_archive---------6-----------------------#2021-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="85de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">开始使用最新的Dart功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0253dc45ea3f574f821e1f6c1fc60f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bz_wWjv8xHBzJYZO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">🇻🇪·何塞·g·奥尔特加·卡斯特罗·🇲🇽在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="c0a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将在<a class="ae kv" href="https://dart.dev/" rel="noopener ugc nofollow" target="_blank"> Dart </a>中尝试新的空安全特性，看看它如何帮助我们避免恼人的错误。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="c69f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">零安全性入门</h1><p id="8ff7" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">从Dart 2.12开始，空安全现在稳定了！如果您正在使用Flutter，可以通过执行以下命令升级到最新版本:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="16f4" class="nb ma iq mx b gy nc nd l ne nf">flutter upgrade</span></pre><p id="02e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了确保更新正确运行，您可以执行<code class="fe ng nh ni mx b">flutter --version</code>，它将给出以下输出:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="8808" class="nb ma iq mx b gy nc nd l ne nf">Flutter 2.0.0 • channel stable • https://github.com/flutter/flutter Framework • revision 60bd88df91 <strong class="mx ir">(</strong>14 hours ago<strong class="mx ir">)</strong> • 2021-03-03 09:13:17 -0800 Engine • revision 40441def69 Tools • Dart 2.12.0</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6d6b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">什么是零安全？</h1><p id="00d7" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">简单来说，当我们在Dart中编写任何代码并运行它时，代码都将通过Dart VM。如果我们不初始化这些变量，那么我们将得到一个错误。例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="58a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的Dart代码中，我们用一个实例变量创建了一个<code class="fe ng nh ni mx b">Students</code>类。然后在<code class="fe ng nh ni mx b">main()</code>函数中，我们创建一个<code class="fe ng nh ni mx b">Students</code>类型的变量，并对其调用<code class="fe ng nh ni mx b">name</code>。但这里的问题是，我们没有创造任何学生！因此，上面的代码将返回一个错误:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="c878" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，当我们得到这个错误时，我们会检查对象是否被初始化。在我们的例子中，它没有被初始化。要解决这个问题，我们可以做到:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="adbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的简单代码中，很容易确定哪个变量没有初始化。但是在大型代码库中，这变得困难且耗时——而这正是null safety要解决的问题。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5be2" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用零安全</h1><p id="7882" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">使用上一节中的代码，我们甚至在运行应用程序之前就会得到以下错误:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/cf20213615086a1311fb2fae506b9388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYnx9F5-2xsgzdyBfSE18Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="7343" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着<code class="fe ng nh ni mx b">students</code>变量不能是<code class="fe ng nh ni mx b">null</code>。在Flutter/Dart中启用空安全时，除非指定，否则不能有任何等于<code class="fe ng nh ni mx b">null</code>的变量。这非常有帮助，因为您甚至可以在运行代码之前就发现问题，现在您不必在对变量使用属性或方法之前一直检查变量是否是<code class="fe ng nh ni mx b">null</code>。为了解决这个错误，我们可以初始化<code class="fe ng nh ni mx b">student</code>变量，正如我在上一节中展示的那样。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e34a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">可空类型</h1><p id="5e32" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">要指定变量是否可以是<code class="fe ng nh ni mx b">null</code>，可以使用可空类型<code class="fe ng nh ni mx b">?</code>操作符。例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="93b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Dart中使用操作符<code class="fe ng nh ni mx b">?</code>基本上意味着<code class="fe ng nh ni mx b">student</code>变量可以等于<code class="fe ng nh ni mx b">null</code>。现在如果你想在<code class="fe ng nh ni mx b">student</code>上调用<code class="fe ng nh ni mx b">name</code>，你会得到如下错误:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/9a146551cc4bc0bc05629972174220ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ED5DBMrSF9l3HLcbjSyq0w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="96aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如错误所说，您需要使用<code class="fe ng nh ni mx b">?.</code>操作符，因为<code class="fe ng nh ni mx b">student</code>可以是<code class="fe ng nh ni mx b">null</code>，所以您必须执行以下操作:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="9e63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在控制台中打印<code class="fe ng nh ni mx b">null</code>。</p><p id="7d9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一种方法是使用后缀运算符<code class="fe ng nh ni mx b">!</code>。使用此运算符时，控制台中将会抛出一个错误。例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6785" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将在控制台中引发以下错误:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="8eae" class="nb ma iq mx b gy nc nd l ne nf">Uncaught TypeError: Cannot read property 'get$name' of nullError: TypeError: Cannot read property 'get$name' of null</span></pre><p id="bd8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，后缀运算符<code class="fe ng nh ni mx b">!</code>会将变量转换为其基础的不可空类型。例如:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="440a" class="nb ma iq mx b gy nc nd l ne nf"> class HomePage extends StatefulWidget {<br/>    final String? message;</span></pre><p id="2f91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果在<code class="fe ng nh ni mx b">HomePage</code>声明下有上述内容，那么您需要在文本小部件中使用那个<code class="fe ng nh ni mx b">message</code>:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="9c7f" class="nb ma iq mx b gy nc nd l ne nf">Text(widget.message!)</span></pre><p id="8ae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们必须使用后缀运算符，因为<code class="fe ng nh ni mx b">Text()</code>小部件将类型为<code class="fe ng nh ni mx b">String</code>的值作为参数，而变量<code class="fe ng nh ni mx b">message</code>是类型为<code class="fe ng nh ni mx b">String?</code>的，这意味着它可以是null。因此，通过使用后缀运算符，它会将变量<code class="fe ng nh ni mx b">message</code>转换为<code class="fe ng nh ni mx b">String</code>。这里可以查看更多<a class="ae kv" href="https://dart.dev/null-safety/understanding-null-safety#null-assertion-operator" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="7b20" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">必需的关键字</h1><p id="502c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Dart新增的另一个关键词是<code class="fe ng nh ni mx b">required</code>。<code class="fe ng nh ni mx b">required</code>关键字可以与可选的命名参数一起使用。这样，在调用函数时，任何属于<code class="fe ng nh ni mx b">required</code>的变量都必须作为参数传递。让我们看一下计数器应用示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5c0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，默认情况下，<code class="fe ng nh ni mx b">title</code>变量是非<code class="fe ng nh ni mx b">null</code>变量。因此，上面的代码将给出以下错误:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/2d70616a65c1b3ca03a51ad0a8dc226e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYAEP8ZEdFa2hj5eqPLO8g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片。</p></figure><p id="1fe8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要解决这个错误，您可以在变量前添加<code class="fe ng nh ni mx b">required</code>关键字:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="b411" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">晚期关键字</h1><p id="7007" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">Dart新增的另一个关键词是<code class="fe ng nh ni mx b">late</code>。由于默认情况下所有变量都是非<code class="fe ng nh ni mx b">null</code>的，我们可以使用<code class="fe ng nh ni mx b">?</code>操作符，也可以使用<code class="fe ng nh ni mx b">late</code>关键字。例如:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="664a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过使用不可空的类型操作符<code class="fe ng nh ni mx b">?</code>，这意味着<code class="fe ng nh ni mx b">name</code>可以是<code class="fe ng nh ni mx b">null</code>。为了解决这个问题，我们使用<code class="fe ng nh ni mx b">late</code>，这基本上意味着延迟初始化:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="0e8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这篇文章。更多详细信息，请查看<a class="ae kv" href="https://dart.dev/null-safety" rel="noopener ugc nofollow" target="_blank"> Dart的文档</a>。</p><p id="b728" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="no">原载于</em><a class="ae kv" href="https://petercoding.com/flutter/2021/03/04/using-null-safety-in-dart/" rel="noopener ugc nofollow" target="_blank"><em class="no">https://petercoding.com</em></a><em class="no">。</em></p></div></div>    
</body>
</html>