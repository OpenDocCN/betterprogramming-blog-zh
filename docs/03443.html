<html>
<head>
<title>How to Bind Data in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Android中绑定数据</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-bind-data-in-android-bbb1e180a928?source=collection_archive---------16-----------------------#2020-02-10">https://betterprogramming.pub/how-to-bind-data-in-android-bbb1e180a928?source=collection_archive---------16-----------------------#2020-02-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7196" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果做得好，让你的Android应用对数据绑定更加敏感</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/20389f12186a4e03501d2375b888e98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eNkasa_mfW18t7rU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@robertbye?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Robert Bye </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="aea8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据绑定是一种技术，当您想要将信息片段(您的数据)粘合到一些可视用户输入元素时使用。在这个过程中，每当输入更新时，其背后的数据也会更新。这远不是一个新概念，有太多的框架已经将这一点融入到它们的设计中(AngularJS/React/Vue)。在本文中，我们关注的不是前端框架，而是移动环境。谷歌在Android中引入了<a class="ae ky" href="https://developer.android.com/topic/libraries/data-binding" rel="noopener ugc nofollow" target="_blank">数据绑定库</a>，它是<a class="ae ky" href="https://developer.android.com/jetpack" rel="noopener ugc nofollow" target="_blank"> Android Jetpack </a>的一部分。</p><p id="8c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对Jetpack库套件不熟悉，可能是因为<a class="ae ky" href="https://developer.android.com/topic/libraries/support-library" rel="noopener ugc nofollow" target="_blank"> Google已经宣布</a>它将停止开发其支持库，转而支持AndroidX库(这是支持库的新版本)。</p><p id="36cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我知道有很多文章解释了如何使用适配器来使用数据绑定，但是这篇文章不会关注这个问题。相反，我将展示一种最基本、最简单的数据绑定方法，它可以通过减少您必须编写的代码量来节省您的时间。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4509" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为什么要使用数据绑定？</h1><p id="ef95" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您还没有被说服，让我们花几分钟时间通过展示一个例子来解释使用数据绑定的好处。假设您有一个带有三个自定义按钮的菜单，其中每个按钮都是一个布局。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/3433f4321a4d2218d1102c5322877b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*DSKPtz7x8bn2NUVPhdMU4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的布局</p></figure><p id="62cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生成所有这些内容的一种方法是使用四种不同的XML布局:一种用于主布局，一种用于三个按钮。</p><p id="756a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要这样做，因为每个按钮会将用户引导到应用程序的不同部分，因此需要不同的文本和不同的图像。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按钮的布局</p></figure><p id="41e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这并没有太多的代码重复，因为我们只处理三种布局。但是如果你仔细想想，处理这些代码是非常浪费时间的。如果您考虑一个具有更复杂布局的应用程序，一个可能展示产品及其图像的应用程序，这可能会导致大量乏味的代码复制。</p><p id="b3aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过数据绑定，我们将设法只创建一个供所有按钮使用的XML布局。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f997" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们从哪里开始？</h1><p id="1043" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们需要让我们的项目支持数据绑定，为此，我们需要在应用程序的<code class="fe nc nd ne nf b">build.gradle</code>文件中添加<code class="fe nc nd ne nf b">dataBinding</code>元素:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">build.gradle</p></figure><p id="1789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在同步我们的项目之后，我们将创建我们的数据类，我们将用它来绑定布局。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ButtonData.kt</p></figure><p id="ff24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在我们的<code class="fe nc nd ne nf b">ButtonData</code>类中有两个字段:</p><ul class=""><li id="1633" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><code class="fe nc nd ne nf b">buttonText</code> —这是将显示在我们图像下方的文本。</li><li id="07d0" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe nc nd ne nf b">buttonImageSrc</code> —这负责按钮的图像。</li></ul><p id="d7cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想要更多的数据，我们只需在数据类中添加更多的字段。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9d0e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">实际绑定</h1><p id="4b8d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">接下来，我们需要在布局中声明一个变量属性，以便可以使用它。这个变量将绑定到我们创建的数据类。为此，我们需要做两件事:</p><ul class=""><li id="b69b" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">将我们的根布局元素包装在布局标签中。</li><li id="ca1f" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">添加一个包含变量声明的数据标签(<code class="fe nc nd ne nf b">buttonData</code>)。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">activity_main.xml</p></figure><p id="2513" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们可以将模式从先前的主布局中移除，因为它被移动到了根布局标记中。此外，我们添加的变量直接绑定到我们的数据类。</p><p id="cb68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的<code class="fe nc nd ne nf b">MainActivity</code>文件中，我们需要添加代码来处理绑定:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">主活动. kt</p></figure><p id="df1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每次在布局内部创建变量时，都会自动为该布局生成一个绑定类。在我们的例子中，我们的布局被称为<code class="fe nc nd ne nf b">activity_main</code>，因此绑定类将被命名为<code class="fe nc nd ne nf b">ActivityMainBinding</code>。</p><p id="db66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">约定始终是布局的名称，并在末尾添加了绑定。</p><p id="ed56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们在布局中将<code class="fe nc nd ne nf b">buttonData</code>声明为我们的变量，所以它被附加到绑定对象上，我们可以为它分配一个<code class="fe nc nd ne nf b">ButtonData</code>类的新实例。</p><p id="3f77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成所有这些之后，我们终于可以在布局中使用刚刚绑定的数据了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用绑定变量buttonData</p></figure><p id="e521" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/3bc9027cc23921cab8b2e8a67d8b5e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*fpchbTcVUnKWKcQQTBvkmg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">很顺利，是吧？</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f4f7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">等一下…</h1><p id="b2e0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们有三个按钮，而我们的数据类只能用于一个按钮，那么我们如何解决这个问题呢？</p><p id="73f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要创建一个新的数据类<code class="fe nc nd ne nf b">ButtonData</code>，来保存一个<code class="fe nc nd ne nf b">ButtonData</code>对象的列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ButtonsData.kt</p></figure><p id="25cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须覆盖<code class="fe nc nd ne nf b">get</code>方法，因为当我们在布局中使用它时需要识别它。</p><p id="22fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们需要更改<code class="fe nc nd ne nf b">activity_main.xml</code>中的引用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们更改了变量名和类以匹配ButtonsData</p></figure><p id="fcf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须为新的数据类创建一个新的绑定:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">主活动. kt</p></figure><p id="4cc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建了三个<code class="fe nc nd ne nf b">ButtonData</code>类的实例。然后我们实例化一个<code class="fe nc nd ne nf b">ButtonsData</code>对象，并将其附加到我们的绑定对象。</p><p id="981f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们现在可以在布局中正确使用我们的数据类了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个元素的用法示例</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/49fcb1b948b2b9d8f9c557c9c50f61ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*IKBNh860MfZ4xj7Og6osKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">非常管用</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="7456" class="nv md it bd me nw nx dn mi ny nz dp mm li oa ob mo lm oc od mq lq oe of ms og bi translated">资源</h2><ul class=""><li id="b306" class="ng nh it lb b lc mu lf mv li oh lm oi lq oj lu nl nm nn no bi translated">https://github.com/TomerPacific/LaundrySymbols<a class="ae ky" href="https://github.com/TomerPacific/LaundrySymbols" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="6822" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>