<html>
<head>
<title>6 Lessons I Learned From Using Fastlane</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我从使用浪子中学到的6个教训</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/6-lessons-i-learned-from-using-fastlane-cb35f53021b3?source=collection_archive---------11-----------------------#2020-04-27">https://betterprogramming.pub/6-lessons-i-learned-from-using-fastlane-cb35f53021b3?source=collection_archive---------11-----------------------#2020-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a914" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是一个神奇的工具，但有些事情可以解释得更好一点</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d4e44d85eb03333111adf7e7d250a6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OlJQrSayvtM_bgycmJ5BvQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@zanilic?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Zan </a>在<a class="ae kv" href="https://unsplash.com/s/photos/xcode?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="0dcd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就个人而言，我会推荐任何参与iOS开发的人使用浪子。一旦你掌握了窍门，它可以节省你大量的时间。设置它并不难，但是获得一些正确设置的指导可能会有所帮助。以下是一些帮助您开始或改进设置的提示。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="2600" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">简单回顾一下</h1><p id="d1ee" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">如果你不熟悉浪子，这是一个使用<a class="ae kv" href="https://en.wikipedia.org/wiki/Xcode" rel="noopener ugc nofollow" target="_blank"> Xcode </a>命令行工具链来自动化大量任务的工具链。最重要的是，它允许你毫不费力地构建、测试、签署和上传你的应用程序版本。</p><p id="85b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些工具大部分是用Ruby编写的，可以通过几个配置文件来设置，其中最主要的是<code class="fe mw mx my mz b">Fastfile</code>。在此文件中，您可以指定车道。每个通道运行一个或多个您想要分组和自动化的命令。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="af56" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">正确管理您的Ruby环境</h1><p id="7d48" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对于大多数iOS开发者来说，Ruby不是你的朋友。但是既然我们被它困住了，我们最好充分利用它。一个常见的问题是使用Ruby系统安装来安装gems。这是一个坏主意，因为你不拥有Ruby环境，也不能保证操作系统不会在软件更新或重启时破坏你的东西。</p><p id="fc73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后是<code class="fe mw mx my mz b">sudo</code>的问题。</p><p id="02d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只有在你确定确实需要的情况下，才应该对任何命令使用<code class="fe mw mx my mz b">sudo</code>。使用<code class="fe mw mx my mz b">sudo </code>安装gems意味着文件和文件夹将作为根用户创建，这意味着访问它们也需要<code class="fe mw mx my mz b">sudo</code>等。等。你去兔子洞。</p><p id="5a54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几种方法可以设置自己的Ruby环境来防止这种情况。我强烈推荐使用<a class="ae kv" href="https://rvm.io" rel="noopener ugc nofollow" target="_blank"> RVM </a>或者<a class="ae kv" href="https://github.com/rbenv/rbenv" rel="noopener ugc nofollow" target="_blank"> rbenv </a>。我个人更喜欢RVM，但是使用这两个工具中的任何一个都可以帮助您保持环境的简单和易于维护。</p><blockquote class="na nb nc"><p id="dac2" class="kw kx nd ky b kz la jr lb lc ld ju le ne lg lh li nf lk ll lm ng lo lp lq lr ij bi translated">“RVM是一个命令行工具，它允许您轻松地安装、管理和使用多种ruby环境，从解释器到gem集。”— <a class="ae kv" href="https://rvm.io" rel="noopener ugc nofollow" target="_blank"> rvm.io </a></p></blockquote><p id="0385" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">真的就这么简单。遵循安装说明，确保避免使用<code class="fe mw mx my mz b">sudo</code>。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9c9f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用Bundler管理您的宝石</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/9421e4022c4b6771cf9df597a8043c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyN0LAk_dpAySzqMHJDaog.png"/></div></div></figure><p id="3e03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如RVM管理你的Ruby环境一样，<a class="ae kv" href="https://bundler.io" rel="noopener ugc nofollow" target="_blank"> Bundler </a>可以帮助你以一种更加本地化和可维护的方式管理你的宝石。可以把它想象成Ruby gems的CocoaPods:您可以精确地指定想要使用哪个版本的依赖项。事实上，由于CocoaPods也是一种Ruby宝石，所以可以用同样的方法来管理它。很像《盗梦空间》，对吧？老实说，我对更多的开发人员不使用Bundler开发Cocoapods感到有点惊讶。</p><p id="d79f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用Bundler可以做两件事:</p><ul class=""><li id="4536" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">为不同的项目使用不同版本的gems</li><li id="5a0c" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">确保开发人员(和构建服务器)使用相同版本的gems</li></ul><p id="b43b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然这种情况很少发生，但我遇到过关于运行时崩溃和代码设计问题的奇怪问题，因为使用了错误版本的gem。创建一个Gemfile需要几分钟，这与在repo中创建一个Podfile非常相似。然后，不用运行<code class="fe mw mx my mz b">pod install</code>，你只需使用Bundler通过调用<code class="fe mw mx my mz b">bundle exec pod install</code>或<code class="fe mw mx my mz b">bundle exec fastlane release</code>为你的浪子发布通道确认你使用的是本地版本。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="2b87" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">指定您想要使用的Xcode版本</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/33d382fa940ebcd79c917b21b7657e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J42YUDxg8RezWmiW2aAp7g.png"/></div></div></figure><p id="a06a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的团队还没准备好更新到最新的Xcode吗？您可以<a class="ae kv" href="https://developer.apple.com/download/more/" rel="noopener ugc nofollow" target="_blank">并行下载并安装</a>多个版本。只需重命名<code class="fe mw mx my mz b">.app</code>文件，并将它放在<code class="fe mw mx my mz b">Applications</code>文件夹中其他文件的旁边。这对应用程序来说很好，但是浪子使用的命令行工具需要知道使用哪个版本的Xcode。</p><p id="7731" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe mw mx my mz b"><a class="ae kv" href="https://developer.apple.com/library/archive/technotes/tn2339/_index.html#//apple_ref/doc/uid/DTS40014588-CH1-HOW_DO_I_SELECT_THE_DEFAULT_VERSION_OF_XCODE_TO_USE_FOR_MY_COMMAND_LINE_TOOLS_" rel="noopener ugc nofollow" target="_blank">xcode-select</a></code>命令，您可以指定您希望使用哪个版本的Xcode。浪子有一个内置的<a class="ae kv" href="https://docs.fastlane.tools/actions/xcode_select/" rel="noopener ugc nofollow" target="_blank">动作来利用这一点。这又一次防止了你遇到讨厌的问题，因为Xcode的版本是在你背后更新的。</a></p><p id="5578" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果版本安装在正确的位置，浪子将为您找到它。否则，它将失败，停止构建，并告诉您发生了什么。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5a8b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">别忘了去浪子看看。迅速发生的</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/bb087ed6d1b61cb4e2299a4fbd5af613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tW0bYMMmY6cOU_PSDWeDbQ.png"/></div></div></figure><p id="ff27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它不像普通的浪子那么远，但可能足够满足你的需要了。非常坦率地说，它还可以防止您陷入对一个<code class="fe mw mx my mz b">Fastfile</code>的Ruby语法的理解。相反，您可以从Xcode享受漂亮的Swift语法和代码完成。它仍处于测试阶段，但在我的努力中，我很少因为这个碰到问题。<a class="ae kv" href="https://docs.fastlane.tools/getting-started/ios/fastlane-swift/" rel="noopener ugc nofollow" target="_blank">这里有可用的文档</a>，而且足够广泛，可以开始使用。</p><p id="7b3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不过不要担心:如果你真的陷入了困境，恢复到Ruby版本并不是太多的工作。毕竟，Swift版本中所有可用的命令都在那里。可能还需要一段时间来适应Ruby的语法。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="614f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">慢慢来，正确设置钥匙串</h1><p id="8b10" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">每个iOS开发人员都记得他们刚开始开发iOS应用程序时的挣扎，他们必须签署他们的第一个应用程序。这些年来，这个过程已经变得简单多了，但是当在构建服务器上构建和签署一个应用程序时，它并不总是像你希望的那样简单。</p><h2 id="e89d" class="nx ma iq bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">使用匹配</h2><p id="7a8a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">浪子为我们提供了一个名为<a class="ae kv" href="https://docs.fastlane.tools/actions/match/" rel="noopener ugc nofollow" target="_blank"> Match </a>的工具，它将简化代码设计并与你的开发团队共享证书。基本上，Match会接管管理你的证书，把它们存储在一个集中的地方。使用该工具时，您和您的团队将共享一组凭据，从而使新用户的加入和证书的续订变得更加容易。</p><h2 id="d73e" class="nx ma iq bd mb ny nz dn mf oa ob dp mj lf oc od ml lj oe of mn ln og oh mp oi bi translated">从远程连接签名</h2><p id="d67c" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">可能有你不能或不想使用这个的原因。或者也许你只是还没有时间去改变你的过程。此外，代码签名错误是隐晦的，尤其是当它们使用命令行发生时。</p><p id="d7dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不止一次遇到的一个错误是:</p><pre class="kg kh ki kj gt oj mz ok ol aw om bi"><span id="4399" class="nx ma iq mz b gy on oo l op oq">security error -25308<br/>Error: 0xFFFF9D24 -25308 User interaction is not allowed.</span></pre><p id="5b90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是因为在常规会话中默认解锁的钥匙串(即照常登录到机器)在通过SSH远程登录时实际上是锁定的。</p><p id="60db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，浪子有一个<code class="fe mw mx my mz b"><a class="ae kv" href="https://docs.fastlane.tools/actions/unlock_keychain/" rel="noopener ugc nofollow" target="_blank">unlock_keychain</a></code>命令可以解决这个问题。在尝试构建/签署您的应用程序之前运行此程序，您应该可以开始了！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="c576" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用浪子尽快建造和交付每一架试飞飞机</h1><p id="4f66" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">这可能听起来微不足道，但是当你陷入其他需要你注意的任务时，很容易推迟这件事。一旦你有了这样的设置，它不仅会为你节省最多的时间，而且你还会注意到你交付中间测试版本的频率更高了，这意味着更快的反馈和更快乐的测试人员。</p><p id="435d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你启动并运行它的时候，也是你意识到你应该更快地自动化你的构建的时候。此外，现在自动化更多流程的下一步突然触手可及。</p><p id="080c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！有建议或者补充？一定要让我知道！</p></div></div>    
</body>
</html>