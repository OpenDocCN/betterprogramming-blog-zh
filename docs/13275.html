<html>
<head>
<title>How to Develop a Web Application With Ktor and Thymeleaf</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Ktor和百里香叶开发一个Web应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-develop-a-web-application-with-ktor-and-thymeleaf-ccbb23776252?source=collection_archive---------9-----------------------#2022-08-12">https://betterprogramming.pub/how-to-develop-a-web-application-with-ktor-and-thymeleaf-ccbb23776252?source=collection_archive---------9-----------------------#2022-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9605" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Ktor和百里香叶配合得很好</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b335e56674b3c561e14ddb8538faf56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dX5WByhliJbHx-hl9pgnHQ.png"/></div></div></figure><p id="7aeb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我的文章“<a class="ae ln" href="https://link.medium.com/ZGxGDMpfVrb" rel="noopener">从Spring Boot切换到Ktor </a>”中，我展示了使用Ktor框架(结合Koin和Exposed)开发API端点是多么容易。</p><p id="e2a0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">开发一个只被REST API客户端访问的应用程序是一个需求，但是如果我想为用户提供一个图形界面呢？Ktor如何帮助我解决这个问题？</p><p id="48da" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Ktor <a class="ae ln" href="https://ktor.io/docs/working-with-views.html" rel="noopener ugc nofollow" target="_blank">为JVM模板引擎提供支持</a>。所以对我来说，使用我在Java开发中了解的一个著名引擎是可能的。</p><p id="64e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，我将展示如何使用<strong class="kt ir"> Ktor </strong>和<strong class="kt ir"> Thymeleaf </strong>开发一个支持基本CRUD操作的简单用户界面。</p><p id="0c47" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">起点是Intellij的“新建项目”向导:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lo"><img src="../Images/93430174c8d716531573268049a9adcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LTgNKOcVBzC3YhpX9YwBQ.png"/></div></div></figure><p id="c390" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我将路由和百里香插件添加到项目中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lo"><img src="../Images/827b09bce34f169b0701b1c392337d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POakJ_9hsm0LG2It8PsFPw.png"/></div></div></figure><p id="2504" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">创建的项目包含以下代码部分，这些代码部分提供了示例页的功能:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="12e2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当服务器成功启动时，我可以浏览显示用户名的示例页面。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/798afdcf46b187c668d995b848394718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*wc63RuaM19j381Vus8q8fw.png"/></div></figure><p id="babf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">所以让我们开始添加功能。</strong></p><h1 id="f97e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">域:</h1><p id="3bb6" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">作为第一步，我创建了代表我的业务用例的域对象。我使用两个相互关联的类。有一个客户有地址。为简单起见，每个客户都有他/她自己的地址对象。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="9ca4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了能够在第一个可见页面上显示域对象，我创建了一个硬编码的域对象列表，它保存在内存中。并且可以显示在表格中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="e2c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我编辑示例<code class="fe mp mq mr ms b">index.html</code>以在html表格中显示示例数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="bde1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">启动服务器并浏览<code class="fe mp mq mr ms b">index.html</code>，结果看起来不太好，即使对于主要是后端开发者的我来说也是如此。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/84013f0006c616ca8cb78a0d00a28940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWuv2PY_LPQvsnUkRR5BQA.png"/></div></div></figure><p id="f2d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了不费吹灰之力改进设计，我在项目中添加了<strong class="kt ir">bootstrap</strong>(<a class="ae ln" href="https://getbootstrap.com/docs/5.2/getting-started/introduction/" rel="noopener ugc nofollow" target="_blank">https://get bootstrap . com/docs/5.2/getting-started/introduction/</a>)。有了这个，现在看起来好多了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/1f4177f24590b5ecff603690a5185648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5MsK2Ds3pL2XEpW_CN8Lg.png"/></div></div></figure><p id="4f62" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">到目前为止，我只有一个静态页面，显示我硬编码的静态内容。下一步是添加创建新客户的功能。</p><p id="4198" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了能够创造新客户，我必须做以下改变:</p><ul class=""><li id="f5ec" class="mv mw iq kt b ku kv kx ky la mx le my li mz lm na nb nc nd bi translated">将html页面的一般标题部分提取到一个片段中。</li><li id="05ad" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">添加导航到index.html页面，允许导航到newcustomer.html页面</li><li id="09b4" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">添加newcustomer.html页面</li><li id="cba8" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">添加一个按钮来保存新创建的客户并导航回<code class="fe mp mq mr ms b">index.html</code>页面。</li></ul><p id="2bf3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们走吧。</p><h1 id="30b5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建新客户:</h1><p id="5d68" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">我添加了<code class="fe mp mq mr ms b">newcustomer.html</code>页面，可以看到带有引导配置的标题是重复的。为了防止重复添加这个部分，我将这个部分提取到一个片段中。<a class="ae ln" href="https://www.thymeleaf.org/doc/articles/layouts.html" rel="noopener ugc nofollow" target="_blank">百里香允许将</a>通用功能提取到一个片段中，该片段可以跨不同页面使用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="4225" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了能够为新客户添加数据，我必须添加一个新页面和一个在<code class="fe mp mq mr ms b">index.html</code>页面上导航的按钮。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="e236" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于导航，我添加了一个链接，它有一个<code class="fe mp mq mr ms b">th:href</code>属性和一个相对于根目录的URL(默认为localhost:8080)。你可以在<a class="ae ln" href="https://www.thymeleaf.org/doc/articles/standardurlsyntax.html" rel="noopener ugc nofollow" target="_blank">文档</a>中寻找更多关于如何使用百里香中的链接的信息。</p><p id="00ac" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当点击链接时，会发送一个URL为<code class="fe mp mq mr ms b">http:localhost:8080/new</code>的请求。我的路由部分需要一个端点来处理这些请求。</p><p id="d165" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了将表单数据反序列化为对象，我需要在应用程序中添加内容协商。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="f31f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Ktor目前不支持将表单数据反序列化为现成的对象(就像使用Spring时可以做到的那样)。使用时</p><pre class="kg kh ki kj gt nj ms nk nl aw nm bi"><span id="9879" class="nn lt iq ms b gy no np l nq nr">call.receive&lt;CustomerData&gt;()</span></pre><p id="fe71" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我得到一个错误，通知我将请求内容转换为DTO对象是不可能的:</p><pre class="kg kh ki kj gt nj ms nk nl aw nm bi"><span id="8a06" class="nn lt iq ms b gy no np l nq nr">Cannot transform this request’s content to com.poisonedyouth.CustomerData</span></pre><p id="65c8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从HTTP post请求返回的数据具有以下形式:</p><pre class="kg kh ki kj gt nj ms nk nl aw nm bi"><span id="15a9" class="nn lt iq ms b gy no np l nq nr">firstName=John&amp;lastName=Doe&amp;birthdate=2000-08-06&amp;street=Main+Street&amp;streetNumber=1&amp;zipCode=90001&amp;city=Los+Angeles</span></pre><p id="ee83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以我有两个选择:</p><ol class=""><li id="c9e3" class="mv mw iq kt b ku kv kx ky la mx le my li mz lm ns nb nc nd bi translated">编写一个自定义的反序列化程序，将表单数据转换为对象。</li><li id="4eed" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm ns nb nc nd bi translated">以字符串形式检索表单数据，并使用<code class="fe mp mq mr ms b">ObjectMapper</code>手动转换为对象。</li></ol><p id="eb10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了简单起见，我使用第二个选项:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="7877" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我以字符串形式检索表单数据，并将内容拆分成键值对。生成的地图可以通过Jackson的<code class="fe mp mq mr ms b">ObjectMapper</code>转换成我的DTO对象。</p><p id="20e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过这些更改，可以创建新客户并返回到<code class="fe mp mq mr ms b">index.html</code>页面。</p><h1 id="66ee" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">编辑现有客户:</h1><p id="5e08" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">为了能够从index.html页面编辑现有的客户，我必须在客户表中添加一个按钮，该按钮导航到编辑客户页面，我可以在那里更新现有的数据。</p><p id="d137" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">必须进行以下更改:</p><ul class=""><li id="f61e" class="mv mw iq kt b ku kv kx ky la mx le my li mz lm na nb nc nd bi translated">添加editcustomer.html页面</li><li id="4b2a" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">提取一般客户输入表单进行分段</li><li id="fa7a" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">添加一个按钮，从index.html页面导航到editcustomer.html页面</li><li id="7e50" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">添加按钮以保存更新的客户并定位回index.html</li></ul><p id="bf9e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">作为第一步，我添加了新的editcustomer.html页面，它看起来几乎完全一样的newcustomer.html页面。只有<code class="fe mp mq mr ms b">th:action</code>属性有不同的URL目的地。</p><p id="32c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了不复制整个表单，我将代码提取到一个片段中，并为<code class="fe mp mq mr ms b">th:action</code>和<code class="fe mp mq mr ms b">th:object</code> <strong class="kt ir"> </strong>指定变量，这些变量可以通过实现页面来设置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="606b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了这个表单片段，两个页面看起来都很整洁。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="4c33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了完成编辑现有客户的任务，我需要添加一个到<code class="fe mp mq mr ms b">index.html</code>的链接，该链接导航到<code class="fe mp mq mr ms b">editcustomer.html</code>页面并在URL中传递所选客户的customerId。</p><p id="a124" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在<code class="fe mp mq mr ms b">Templating.kt</code>类中，我提取请求路径的<code class="fe mp mq mr ms b">customerId</code>，在列表中搜索相应的客户，并将数据放入<code class="fe mp mq mr ms b">editcustomer.html</code>页面的模型中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="0ac9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完成这些更改后，可以点击客户行中的编辑按钮，编辑输入表单中的数据。</p><h1 id="953b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">删除现有客户:</h1><p id="fcf5" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">从<code class="fe mp mq mr ms b">index.html</code>页面的表格中删除现有客户，需要在客户表格中有一个按钮，该按钮触发一个从现有客户列表中删除客户的请求。</p><p id="a634" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">必须进行以下更改:</p><ul class=""><li id="63c0" class="mv mw iq kt b ku kv kx ky la mx le my li mz lm na nb nc nd bi translated">添加按钮删除客户并重新加载页面</li></ul><p id="b587" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我需要添加一个链接到index.html，这是导航到一个包含所选客户的<code class="fe mp mq mr ms b">customerId</code>的URL。</p><p id="82e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">目前，只可能从HTML表单发送GET和POST请求。因此，我需要滥用GET请求来发送由路由端点处理的customerId。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="ec52" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">到现在为止<code class="fe mp mq mr ms b">index.html</code>看起来如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/d924d56b7c2bac54774b7180801ef496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gN7lXmmIoS_QC4o55Qk_gw.png"/></div></div></figure><p id="7656" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可以创建新客户、编辑客户和删除现有客户。此外，页面之间的导航是可行的。</p><p id="d03d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是每次应用程序启动时，我都从相同的初始静态数据开始。为了有一个持久的客户名单，我需要添加一个数据库。</p><p id="a1bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了保持简单，我使用暴露+ H2数据库。</p><p id="6248" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过下面的配置，可以在我的应用程序中使用这两者。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="35ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我用一个使用H2文件数据库的持久层代替了内存中的<code class="fe mp mq mr ms b">DataHolder</code>。我使用暴露的DAO的实体类实现了基本的CRUD功能。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="bee5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mp mq mr ms b">DataHolder</code>作为一个服务层，将持久层从应用程序的其余部分中分离出来(使得与其他持久性框架进行交换成为可能)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="4d19" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有了这些改变，我有了一个简单的CRUD应用程序，使用百里香的模板引擎提供了一个基本的用户界面。</p><p id="7cdf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">百里香提供了更多的功能。一个很好的概述可以在<a class="ae ln" href="https://www.thymeleaf.org/documentation.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>中找到。</p><h1 id="1edb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">附录</h1><p id="81a4" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">因为我对从<code class="fe mp mq mr ms b">Thymeleaf</code>发送的表单内容的反序列化的解决方案不太满意，所以我尝试用一个更通用的变体来替换当前的手动将表单内容映射到我的d to对象的解决方案。我可以为表单数据注册一个自定义的<code class="fe mp mq mr ms b">ContentConverter</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="5bb0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当提交表单时，我通过<code class="fe mp mq mr ms b">deserialize(…)</code>方法获得以下信息:</p><ul class=""><li id="87c9" class="mv mw iq kt b ku kv kx ky la mx le my li mz lm na nb nc nd bi translated">使用的字符集</li><li id="bae8" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated"><code class="fe mp mq mr ms b">typeInfo</code>包含关于所使用的模型类的信息</li><li id="02ad" class="mv mw iq kt b ku ne kx nf la ng le nh li ni lm na nb nc nd bi translated">内容为<code class="fe mp mq mr ms b">ByteReadChannel</code></li></ul><p id="23ff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">要有一个通用的解决方案，能够将表单数据反序列化为不同的模型类，就必须处理Kotlins的反射机制。这给我带来了很多额外的工作来解决这个问题。所以我决定把它放在一篇额外的文章里，我将在未来发表。</p><h1 id="2151" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="e605" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">Ktor和百里香叶配合得很好，但与Spring Boot和百里香叶相比，我可能错过了一些关键的功能，如反序列化机制或发送“删除”表单请求的功能。这里是官方文件参考<a class="ae ln" href="https://ktor.io/docs/thymeleaf.html#install_plugin" rel="noopener ugc nofollow" target="_blank"> Ktor和百里香叶</a>。</p><p id="eb8a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您对我的应用程序的代码感兴趣，您可以在GitHub上找到这个库:</p><div class="nu nv gp gr nw nx"><a href="https://github.com/PoisonedYouth/ktor-thymeleaf.git" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">GitHub-PoisonedYouth/ktor-百里香叶</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kp nx"/></div></div></a></div></div></div>    
</body>
</html>