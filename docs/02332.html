<html>
<head>
<title>Installing MongoDB on macOS Catalina</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在macOS Catalina上安装MongoDB</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/installing-mongodb-on-macos-catalina-aab1cbe0c836?source=collection_archive---------0-----------------------#2019-11-23">https://betterprogramming.pub/installing-mongodb-on-macos-catalina-aab1cbe0c836?source=collection_archive---------0-----------------------#2019-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c846" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个棘手的问题，由于卡特琳娜的只读根文件夹</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6928f25312b9e52f63e9a987695ff564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GoxQXaPPeFwSuryuWDgJBw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">paweczerwiński</a>在<a class="ae ky" href="https://unsplash.com/s/photos/leaf?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4aec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我开始了一份新的开发工作，从Windows转到了Mac。切换非常顺利，只有一个主要问题:设置MongoDB。这个问题与最新的主要macOS版本Catalina有关，在本文中，我将分享我的解决方案。</p><p id="2b0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置MongoDB在Catalina上运行比它应该的更费时间，但是希望这篇文章将把您从我经历的一些头痛中解救出来！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9ae9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">问题是</h1><p id="9ff4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">默认情况下，MongoDB将数据库信息存储在根文件夹中的<code class="fe mz na nb nc b">data/db</code>中。但是Catalina更新提供了对根目录的只读访问。基于多姆伯克的这个建议，我的解决方案是把T1搬到T2。</p><p id="0b69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理论上，你可以把<code class="fe mz na nb nc b">data/db</code>放在任何你喜欢的地方。但是<code class="fe mz na nb nc b">/System/Volumes/Data/</code>似乎比<code class="fe mz na nb nc b">Documents</code>更安全。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1ea8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.禁用SIP</h1><p id="1d75" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">然而，要访问<code class="fe mz na nb nc b">/System/</code>，需要禁用macOS的SIP(系统完整性保护),这可以防止对该目录进行修改。要禁用SIP，您需要:</p><ul class=""><li id="df87" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">在启动过程中，通过重启并按住<code class="fe mz na nb nc b">CMD + R</code>进入恢复模式。</li><li id="70cb" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">打开终端(可以在顶部菜单的“实用程序”下找到)。</li><li id="cba2" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">在终端内部，运行<code class="fe mz na nb nc b">csrutil disable</code>。您现在可以在正常模式下重新启动。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dc9a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.将/data/db文件夹移出根目录</h1><p id="5ac4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您在根目录的<code class="fe mz na nb nc b">/data/db</code>中有数据，您可以通过提供对根目录的临时写访问来移动它。</p><p id="0bbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦SIP被禁用，打开终端并键入<code class="fe mz na nb nc b">sudo mount -uw /</code>。</p><p id="7a70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您可以将您的文件夹从根目录移到<code class="fe mz na nb nc b">/System/Volumes/Data/</code>中。这种读写能力只在当前会话中有效。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3a66" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.(重新)安装MongoDB</h1><p id="7bfe" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">接下来，我想全新安装MongoDB。我尝试了几种不同的选择，但Brew是最方便的。对于那些试图跟随旧教程的人来说，<code class="fe mz na nb nc b">mongodb</code>已经从<code class="fe mz na nb nc b">homebrew-core</code>中移除。</p><p id="16c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您需要使用<code class="fe mz na nb nc b">mongo-community</code>，可以通过以下方式访问:</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="2d12" class="nv md it nc b gy nw nx l ny nz">brew tap mongodb/brew<br/>brew install mongodb-community<br/>brew services start mongodb-community<!-- --> </span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8f44" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">4.从终端运行MongoDB</h1><p id="089e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果一切正常，你现在应该能够运行<code class="fe mz na nb nc b">mongod</code>和<code class="fe mz na nb nc b">mongo</code>——并看到除了<code class="fe mz na nb nc b">command not found</code>错误之外的其他错误！</p><p id="0e14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们只是运行<code class="fe mz na nb nc b">mongod</code>，我们将得到错误，告诉我们数据库目录是只读的。这是因为，默认情况下，该命令假设我们的数据库文件夹在根目录中。</p><p id="a7c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，在运行<code class="fe mz na nb nc b">mongod</code>时，我们需要具体的<code class="fe mz na nb nc b">--dbpath /System/Volumes/Data/data/db</code>。因为我们正在使用<code class="fe mz na nb nc b">/System/</code>，所以我们也需要使用<code class="fe mz na nb nc b">sudo</code>。完整的命令是:</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="7a0f" class="nv md it nc b gy nw nx l ny nz">sudo mongod --dbpath /System/Volumes/Data/data/db</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0040" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">5.创建终端别名</h1><p id="ef77" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">每次打字都有点累。因此，如果您主要使用相同的数据库路径，我建议设置一个别名。</p><p id="b37e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您使用Zsh，您可以将以下内容添加到<code class="fe mz na nb nc b">~/.zshrc</code>:</p><pre class="kj kk kl km gt nr nc ns nt aw nu bi"><span id="7f0c" class="nv md it nc b gy nw nx l ny nz">alias mongod="sudo mongod --dbpath /System/Volumes/Data/data/db"</span></pre><p id="4d2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着<code class="fe mz na nb nc b">mongod</code>会像你预期的那样工作。请注意，如果您需要更改<code class="fe mz na nb nc b">--dbpath</code>，您需要禁用这个别名。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="4a6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这为你节省了一些时间和挫折！这要归功于Dom Berk，<a class="ae ky" href="https://superuser.com/questions/1458974/macos-switched-root-mongodb-data-folder-to-system-ownership-and-it-cannot-be-cha" rel="noopener ugc nofollow" target="_blank">我在本文中构建了他的解决方案。</a></p></div></div>    
</body>
</html>