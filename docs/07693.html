<html>
<head>
<title>5 Powerful Unix Commands for Easier Troubleshooting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5个强大的Unix命令，便于故障排除</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-powerful-unix-commands-for-easier-troubleshooting-dd619d5e173a?source=collection_archive---------2-----------------------#2021-02-10">https://betterprogramming.pub/5-powerful-unix-commands-for-easier-troubleshooting-dd619d5e173a?source=collection_archive---------2-----------------------#2021-02-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="271e" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">一组经过验证的Unix命令，帮助您识别应用程序问题</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/2a5511bc9e37a7122b762bf9fb1f6414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kaBuwL05OLM2Nmjy"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@mylifeasaryan_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aryan Dhiman </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5240" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">识别应用程序问题可能非常耗时。这就是为什么了解各种故障排除命令至关重要，这可以使我们更容易发现问题。</p><p id="749f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">类Unix系统带有许多强大的内置命令。在这篇文章中，我收集了我经常使用的几个最常用的。您可以使用这里的示例创建自己的备忘单来解决问题。</p><p id="6901" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们开始吧！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="a5e4" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">lsof命令</h1><p id="8024" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man8/lsof.8.html" rel="noopener ugc nofollow" target="_blank">lsof</a></code>代表“列出打开的文件”这无疑是最强大的故障排除命令之一，因为您可以从中获得大量信息。</p><h2 id="8d95" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">检索属于活动进程的打开文件</h2><p id="96ee" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">没有任何参数，<code class="fe na nb nc nd b">lsof</code>列出了属于所有活动进程的所有打开文件。当您想要确定哪个进程正在使用您试图删除的文件时，这将非常有用。</p><p id="5b5e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要进行试验，请在您的终端中键入以下命令:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="25cc" class="ne me iu nd b gz nu nv l nw nx">$ lsof</span></pre><p id="dae4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例输出:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">lsof输出摘录</p></figure><p id="588d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在另一个场景中，您可能想要检查一个可疑的流程。您可以检查该进程使用的文件以获得更多信息。</p><p id="13f7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，对于某些进程，您可能会得到“权限被拒绝”。这是因为您的用户不允许查看其他用户拥有的进程。在这种情况下，以<code class="fe na nb nc nd b">root</code>的身份运行命令，您将能够看到所有用户的所有进程。</p><h2 id="f6f7" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">按用户列出打开的文件</h2><p id="11c4" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">如果您想找出某个用户正在使用哪些文件，请键入以下命令:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="621a" class="ne me iu nd b gz nu nv l nw nx">$ lsof -u someuser</span></pre><p id="ea9e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你会惊讶有多少打开的文件。为了缩小结果范围，您可能希望包含<code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/grep.1p.html" rel="noopener ugc nofollow" target="_blank">grep</a></code>命令。</p><p id="da3e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了演示这个选项，我在后台启动了一个Java应用程序。</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="2f7b" class="ne me iu nd b gz nu nv l nw nx">$ lsof -u kirshi | grep java</span></pre><p id="9ab1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出摘录:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">带grep样本输出的lsof</p></figure><h2 id="e0f7" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">结束所有用户进程</h2><p id="e045" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">如果您想要结束某个用户的所有进程，您可以通过执行以下命令轻松完成:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="71cd" class="ne me iu nd b gz nu nv l nw nx">kill -9 `lsof -t -u someuser`</span></pre><h2 id="0b13" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">检索在特定端口上运行的进程</h2><p id="66d6" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">有时您想要列出特定端口上所有正在运行的进程。为此，请执行:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="1a53" class="ne me iu nd b gz nu nv l nw nx">lsof -i :8090</span></pre><p id="1100" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例输出:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">具有指定端口输出的lsof</p></figure><p id="b96f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，<code class="fe na nb nc nd b">-i</code>参数列出了所有监听和已建立的连接。</p><p id="2e8a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果不确定端口号，可以查询指定范围内的端口:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="2a8c" class="ne me iu nd b gz nu nv l nw nx">$ lsof -i :8090-9090</span></pre><p id="d765" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">查找进程的另一种方法是使用PID id:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="785b" class="ne me iu nd b gz nu nv l nw nx">lsof -p 23619</span></pre><p id="412a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">结果将包含属于<code class="fe na nb nc nd b">23619</code> PID id的所有进程。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="e59b" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">netstat命令</h1><p id="3116" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b"><a class="ae kz" href="https://linux.die.net/man/8/netstat" rel="noopener ugc nofollow" target="_blank">netstat</a></code>是监控网络连接的绝佳工具。</p><h2 id="10b6" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">查找正在使用的端口</h2><p id="dad5" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">通过键入以下命令，您可以看到所有正在使用的端口，包括一些其他有用的信息:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="28d7" class="ne me iu nd b gz nu nv l nw nx">netstat -tulpn</span></pre><ul class=""><li id="1fb5" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-t</code>选项检查TCP连接。</li><li id="4753" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-u</code>选项检查UDP连接。</li><li id="fccc" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-l </code>选项告诉<code class="fe na nb nc nd b">netstat</code>只列出监听连接。如果您想查看所有连接，请使用<code class="fe na nb nc nd b">-a</code>选项。</li><li id="7a7d" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-p</code>选项显示了进程的PID id。</li><li id="6975" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-n</code>选项显示数字地址，而不是试图解析主机、端口或用户名。</li></ul><p id="c000" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你想检查一个特定的端口，只需添加<code class="fe na nb nc nd b">grep</code>命令:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="3f24" class="ne me iu nd b gz nu nv l nw nx">netstat -tulpn | grep 8090</span></pre><p id="96e3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例输出:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">netstat输出</p></figure><h2 id="d072" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">查找流程背后的用户</h2><p id="56ca" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">在某些情况下，知道正在运行的进程背后的用户名会很有用。添加<code class="fe na nb nc nd b">-e</code>选项来检索用户名。不要忘记移除<code class="fe na nb nc nd b">-n</code>选项；否则，用户名不会被解析。</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="e521" class="ne me iu nd b gz nu nv l nw nx">$ sudo netstat -tulpe | grep 8090</span></pre><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用户的netstat输出</p></figure><p id="0004" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">同样，如果您作为<code class="fe na nb nc nd b">root</code>进行查询，您将有权限查看所有进程的详细信息。</p><h2 id="ab8b" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">检查服务器状态</h2><p id="41de" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">如果您想检查像<code class="fe na nb nc nd b">http</code>或<code class="fe na nb nc nd b">smtp</code>这样的服务器是否正在运行，您可以使用<code class="fe na nb nc nd b">grep</code>来过滤结果:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="4f8c" class="ne me iu nd b gz nu nv l nw nx">$ sudo netstat -tuple | grep smtp</span></pre><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">netstat检查smtp状态</p></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="d5fc" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">卷曲命令</h1><p id="2aeb" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/curl.1.html" rel="noopener ugc nofollow" target="_blank">curl</a></code>通常用于在没有用户交互的情况下从服务器传输数据或向服务器传输数据。它支持HTTP、FTP、SCP、SFTP、SMTP、LDAP和许多其他协议。</p><h2 id="431e" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">检查服务运行状况</h2><p id="6249" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">当您想要确定某个站点或服务是否正常运行时，它会派上用场。</p><p id="0ba4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要检查站点是否处于活动状态，请运行以下命令:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="b369" class="ne me iu nd b gz nu nv l nw nx">$ curl -Is <a class="ae kz" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank">http://www.google.com</a></span><span id="2cbc" class="ne me iu nd b gz oo nv l nw nx">HTTP/1.1 200 OK<br/>Content-Type: text/html; charset=ISO-8859-1<br/>P3P: CP="This is not a P3P policy! See g.co/p3phelp for more info."<br/>Date: Sun, 07 Feb 2021 22:22:10 GMT<br/>Server: gws<br/>X-XSS-Protection: 0<br/>X-Frame-Options: SAMEORIGIN<br/>Transfer-Encoding: chunked<br/>Expires: Sun, 07 Feb 2021 22:22:10 GMT<br/>Cache-Control: private<br/>Set-Cookie: NID=208=WV1ENCL_yTQadGsKWAuYHUyBL0Htelh0nkkSNjnFpX2XjHEBj58-ldS9vjAl6MXH0jFwQC0oabKtcmS6jia2Wn9V-1C0CckpYyW17i8l3VTsQkL2RDLS43OBKxuE5UXiSfm9iSLbIxVV94oNcjC2SPuUfUIzwCJqgxDGi7Q3qRM; expires=Mon, 09-Aug-2021 22:22:10 GMT; path=/; domain=.google.com; HttpOnly</span></pre><ul class=""><li id="20e1" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-s</code>选项用于静音模式，禁用进度条和错误信息。</li><li id="c4f4" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-I</code>选项发送一个<code class="fe na nb nc nd b">HEAD</code> HTTP请求，并且不返回请求体。</li></ul><h2 id="6472" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">测试telnet功能</h2><p id="e6ef" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b">curl</code>是一种快速测试telnet功能的方法。例如，您可能想要确认使用特定TCP端口从本地机器到远程主机的连接是否正常工作。</p><p id="4bc3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们测试一个运行在端口<code class="fe na nb nc nd b">8090</code>上的Tomcat服务器:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="5a4f" class="ne me iu nd b gz nu nv l nw nx">curl -v telnet://127.0.0.1:8090</span><span id="1513" class="ne me iu nd b gz oo nv l nw nx">* Trying 127.0.0.1:8090...<br/>* TCP_NODELAY set<br/>* Connected to 127.0.0.1 (127.0.0.1) port 8090 (#0)</span></pre><p id="61b1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果我停止服务器，我会得到以下错误消息:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="5a94" class="ne me iu nd b gz nu nv l nw nx">curl: (7) Failed to connect to 127.0.0.1 port 8090: Connection refused</span></pre><h2 id="8655" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">测试你的应用程序和另一个服务之间的连接</h2><p id="7551" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">您还可以验证您的应用程序和另一个服务(如数据库)之间是否存在连接。</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="053c" class="ne me iu nd b gz nu nv l nw nx">$ curl -I -s myapp:5000</span></pre><p id="1306" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe na nb nc nd b">myapp</code>是您的应用程序的名称，<code class="fe na nb nc nd b">5000</code>是您试图到达的数据库的端口号。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="af35" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">ps命令</h1><p id="a183" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/ps.1.html" rel="noopener ugc nofollow" target="_blank">ps</a></code>是另一个有用的命令，用于显示正在运行的进程的信息。</p><h2 id="b976" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">查找进程的PID</h2><p id="02b7" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated"><code class="fe na nb nc nd b">ps</code>命令通常与<code class="fe na nb nc nd b">-ef</code>选项结合使用:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="545a" class="ne me iu nd b gz nu nv l nw nx">$ ps -ef</span></pre><ul class=""><li id="7e22" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-e</code>选项显示所有进程。</li><li id="edfd" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-f</code>提供了进程的详细信息。</li></ul><p id="9fcf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">样本输出:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">ps输出</p></figure><p id="391e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用<code class="fe na nb nc nd b">grep</code>来缩小结果范围:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="edf2" class="ne me iu nd b gz nu nv l nw nx">$ ps -ef | grep tomcat</span></pre><p id="4da3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您也可以将它与<code class="fe na nb nc nd b">aux</code>选项一起使用，以获得更详细的信息。</p><ul class=""><li id="a018" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-a</code>选项显示所有用户的进程。</li><li id="68df" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-u</code>代表面向用户的格式。</li><li id="d0fa" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">-x</code>还显示后台运行的进程。</li></ul><h2 id="4360" class="ne me iu bd mf nf ng dn mj nh ni dp mn lj nj nk mp ln nl nm mr lr nn no mt np bi translated">按内存对进程排序</h2><p id="7338" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">按照内存使用情况对进程进行排序会很有用，这样可以找出是什么在消耗您的资源:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="ee60" class="ne me iu nd b gz nu nv l nw nx">$ ps aux --sort=-%mem</span></pre><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ny nz l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">ps按内存排序</p></figure></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="d0c5" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">额外提示:cat命令</h1><p id="d5a1" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">你肯定熟悉<code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/cat.1.html" rel="noopener ugc nofollow" target="_blank">cat</a></code>命令。虽然它通常不用于故障排除，但它仍然可以方便地识别问题。</p><p id="994e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，当您收到一个脚本失败的错误消息时，比如说在第21行，您希望看到那一行。您可以使用外部工具来可视化文件，以检查行号。但是您也可以使用<code class="fe na nb nc nd b">cat</code>来实现:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="7de7" class="ne me iu nd b gz nu nv l nw nx">$ cat -n show-time.sh </span><span id="e6b3" class="ne me iu nd b gz oo nv l nw nx">1  #!/bin/bash<br/>2  while true; do<br/>3      sleep 5 <br/>4      date +"Hi, the current time is %F %T"<br/>5  done</span></pre><ul class=""><li id="92b3" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-n</code>选项显示文件中的行号。</li></ul><p id="8ef4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您正在处理一个长文件，您可以使用<code class="fe na nb nc nd b"><a class="ae kz" href="https://man7.org/linux/man-pages/man1/less.1.html" rel="noopener ugc nofollow" target="_blank">less</a></code>命令直接从命令行跳到所需的行号:</p><pre class="kk kl km kn gu nq nd nr ns aw nt bi"><span id="a727" class="ne me iu nd b gz nu nv l nw nx">$ less +4 -N show-time.sh</span><span id="0453" class="ne me iu nd b gz oo nv l nw nx">4     date +"Hi, the current time is %F %T"<br/>5     done</span></pre><ul class=""><li id="e70d" class="oa ob iu lc b ld le lg lh lj oc ln od lr oe lv of og oh oi bi translated"><code class="fe na nb nc nd b">-N</code>选项显示行号。</li><li id="0625" class="oa ob iu lc b ld oj lg ok lj ol ln om lr on lv of og oh oi bi translated"><code class="fe na nb nc nd b">+</code>符号和数字跳转到文件中的那一行</li></ul></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="ce8d" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">结论</h1><p id="6ee8" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">我们已经看到了如何使用像<code class="fe na nb nc nd b">curl</code>、<code class="fe na nb nc nd b">netstat</code>、<code class="fe na nb nc nd b">ps</code>和<code class="fe na nb nc nd b">lsof</code>这样的命令。这些命令在许多其他情况下也很有用。我建议浏览手册页，以发现更多的用例。</p><p id="50b3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您喜欢本教程，您可能也会喜欢我关于其他Unix技巧和诀窍的文章:</p><div class="op oq gq gs or os"><a href="https://medium.com/better-programming/lesser-known-but-powerful-unix-commands-to-polish-your-tech-skills-b2ceec3e078a" rel="noopener follow" target="_blank"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd iv gz z fq ox fs ft oy fv fx it bi translated">鲜为人知但功能强大的Unix命令来提高您的技术技能</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">带有简单示例的简便bash命令</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg kt os"/></div></div></a></div><div class="op oq gq gs or os"><a href="https://medium.com/better-programming/write-more-efficient-unix-scripts-with-heredoc-639719d0e660" rel="noopener follow" target="_blank"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd iv gz z fq ox fs ft oy fv fx it bi translated">用Heredoc编写更高效的Unix脚本</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">heredoc简介，让脚本更简洁</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">medium.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg kt os"/></div></div></a></div><div class="op oq gq gs or os"><a href="https://medium.com/better-programming/automate-your-scripts-with-expect-9305faa6e2ff" rel="noopener follow" target="_blank"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd iv gz z fq ox fs ft oy fv fx it bi translated">使用Expect自动化您的脚本</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">使用Expect脚本语言的强大功能来自动化您的程序</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">medium.com</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg kt os"/></div></div></a></div><p id="c916" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读，下次再见！</p></div></div>    
</body>
</html>