# 书写清洁减少器

> 原文：<https://betterprogramming.pub/write-cleaner-reducers-1c433a94a166>

## 创建适用于任何 JavaScript 环境的更干净、更可读、无样板文件的 reducers

![](img/0fb386067be63b4df45eb70623c33c60.png)

照片由[阿里·叶海亚](https://unsplash.com/@ayahya09?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

# 介绍

那么，什么是减速器呢？

这是一个纯粹的函数，它接受当前状态和动作，并基于它们返回一个新状态。就是这样！

Redux 库在 React 生态系统中极大地推广了 reducers 的概念，现在它几乎是考虑应用程序状态的标准方式。

在这篇文章中，我们将检查著名的计数器应用程序的例子和它的 reducer，看看我们能做些什么来使它变得漂亮和整洁。最后，我们将看到在 React 应用程序中采用这些知识是多么容易。

这是我们的应用程序:

![](img/afbc4ad1b1f12fa1b1016b7ff3c608b8.png)

它包含一个状态，当前计数和两个动作，递增和递减。典型的减速器可能是这样的:

这种方法有什么问题，我们如何改进它？

# 良好做法

首先，我们的动作类型(递增/递减)是硬编码的字符串。拥有这些真的是一个坏主意，因为它很容易导致各种各样的错误和打字错误，使重构更加困难，等等。

第二，我们的默认情况返回相同的状态。为什么这样不好？如果我们的 reducer 被调用了一个未知的动作，这意味着有问题，我们应该得到通知。

这些问题的解决方案可能是这样的:

# 不带开关/外壳的减速器

我们的 reducer 的另一个非常有用的改进是去掉 switch/case 语句。这样我们就可以有更多可读的、可测试的、优雅的代码。

下面是一个例子:

现在，我们可以让`createReducer` 助手函数来为我们处理，而不是每次都手动创建我们的 reducers。它应该以`handlers` 对象和`initialState`作为参数，并产生 reducer 作为返回值。

幸运的是，在前一个例子中，我们已经完成了所有繁重的工作，所以我们的代码现在应该是这样的:

# 自动合并状态

所以`createReducer` 现在是负责我们的减速器创建，在这个过程中，我们可以做得更多。一个特别好的特性是当前状态和下一个状态的合并。这样，我们就不必在所有的处理函数中手动合并状态。相反，我们只能返回我们想要应用的状态更改。

合并状态对我们的计数器应用程序来说不是特别重要，因为它只有一个状态。但是在现实世界中，几乎总是需要将当前状态合并到下一个状态。如果我们不这样做，我们可能会丢失部分状态，从而改变状态的结构，这可能会导致意外的行为和错误。

我们可以将当前和下一个状态传播到`createReducer`函数中的一个新对象中，而不是在每个处理函数中手动合并。调整后，我们的代码应该是这样的:

# 如何在 React 应用程序中应用

这里有一个 React 应用程序的工作示例，它利用这些技术制作一个漂亮、干净的缩减器，并使用`useReducer`钩子应用它:

# 结论

有了像`createReducer` 函数这样的简单抽象，我们可以让我们的生活变得更容易，编写简单、可读、但功能强大的 reducers。

感谢您的阅读。如果你有任何问题或反馈，请在评论中告诉我。