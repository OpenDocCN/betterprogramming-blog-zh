<html>
<head>
<title>An Introduction to GraphQL With Apollo Client and React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍带有Apollo客户端和React钩子的GraphQL</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/an-introduction-to-graphql-with-apollo-client-and-react-hooks-fc87ab960e36?source=collection_archive---------26-----------------------#2020-03-10">https://betterprogramming.pub/an-introduction-to-graphql-with-apollo-client-and-react-hooks-fc87ab960e36?source=collection_archive---------26-----------------------#2020-03-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="c411" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">GraphQL是什么？我如何为我的项目设置它？更多</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/32ff94cc640f084b99839716ab639a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qg-wVeH2Nh8UGA9o8kURVg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">反应，阿波罗，GraphQL。图片由hackernoon.com提供</p></figure><h1 id="9d03" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">TL；博士:</h1><ul class=""><li id="b3ba" class="mc md it js b jt me jx mf kb mg kf mh kj mi kn mj mk ml mm bi translated">GraphQL不是一种数据库查询语言。它是一种API数据的查询语言，和REST一样。</li><li id="115d" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">与REST不同，只需进行一次查询，就能得到您想要的结果。</li><li id="3dc0" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">本文的GitHub repo可以在这里找到:<a class="ae ms" href="https://github.com/machariamuguku/react_apollo_graphql" rel="noopener ugc nofollow" target="_blank">https://github.com/machariamuguku/react_apollo_graphql</a></li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="c8bd" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated"><strong class="ak">graph QL是什么？</strong></h1><p id="9fa2" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated"><a class="ae ms" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>是由脸书开发的(API)数据查询语言。GraphQL给了客户端(前端和其他API)要求他们想要的东西的能力，不多也不少。它为数据提供了一个结构化的查询，并对所请求的数据进行了完整和可理解的描述。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="ed50" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated">揭穿常见的GraphQL神话(GraphQL不是什么？)</h1><h2 id="8ceb" class="ni lf it bd lg nj nk dn lk nl nm dp lo kb nn no ls kf np nq lw kj nr ns ma nt bi translated">误区一。GraphQL是一种类似SQL的数据库查询语言</h2><p id="70a7" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">GraphQL是<strong class="js iu">而不是</strong>一种数据库查询语言。GraphQL查询一个API(类似REST ),它进行验证和实际的获取。GraphQL是一个粘合层，一端是您的前端，另一端是API后端和数据库。</p><h2 id="0b45" class="ni lf it bd lg nj nk dn lk nl nm dp lo kb nn no ls kf np nq lw kj nr ns ma nt bi translated">误区二。<strong class="ak"> </strong> GraphQL是魔法</h2><p id="1d4b" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">GraphQL是<strong class="js iu">而不是</strong>魔法。您必须自己为每个可能的GraphQL查询、变异或订阅定义解析器。这包括验证和业务逻辑。</p><h2 id="1b77" class="ni lf it bd lg nj nk dn lk nl nm dp lo kb nn no ls kf np nq lw kj nr ns ma nt bi translated">误区三。<strong class="ak"> </strong> GraphQL跟图有关系</h2><p id="d425" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">GraphQL是API数据的查询语言。GraphQL中的<em class="nu">图</em>指的是，在GraphQL 中的<a class="ae ms" href="https://graphql.org/learn/thinking-in-graphs/" rel="noopener ugc nofollow" target="_blank">，你如何通过定义一个模式将你的业务领域建模为一个图，在这个模式中，你定义不同类型的节点以及它们如何相互连接/关联。</a></p><h2 id="6942" class="ni lf it bd lg nj nk dn lk nl nm dp lo kb nn no ls kf np nq lw kj nr ns ma nt bi translated">误区四。GraphQL暴露了我的整个数据库</h2><p id="d6e0" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">GraphQL <strong class="js iu">只公开您明确告诉它通过解析器公开</strong>的内容。GraphQL为您提供了对所公开内容的细粒度控制。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="a378" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated">为什么选择GraphQL？为什么不休息一下呢？</h1><ul class=""><li id="4edd" class="mc md it js b jt me jx mf kb mg kf mh kj mi kn mj mk ml mm bi translated">它可以让你查询你到底需要什么。不多也不少。这有助于解决剩余的过度提取和不足提取问题。</li><li id="d322" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">可预测的有效载荷结构。查询的结构与相应的有效负载相同。这使得有效负载高度可预测。</li><li id="4885" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">只有一个端点。与REST不同，GraphQL只有一个端点，这使得前端工作变得非常容易。</li><li id="b327" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">来自多个来源的数据聚合。有了像<a class="ae ms" href="https://www.apollographql.com/docs/apollo-server/federation/introduction/" rel="noopener ugc nofollow" target="_blank"> Apollo Federation </a>这样的工具，就有可能跨多个联邦服务发出一个请求。这意味着往返行程的大幅削减。</li><li id="16db" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">GraphQL是强类型的。在后端，GraphQL有一个成熟的语言(模式定义语言或SDL)，完整的基本类型(<code class="fe nv nw nx ny b">String</code>、<code class="fe nv nw nx ny b">Int</code>、<code class="fe nv nw nx ny b">Float</code>、<code class="fe nv nw nx ny b">Boolean</code>等)。).这使得它不容易出错。</li><li id="254e" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">即时测试GraphQL查询、变异和订阅。使用<a class="ae ms" href="https://github.com/graphql/graphiql" rel="noopener ugc nofollow" target="_blank">GraphQL</a>或<a class="ae ms" href="https://github.com/prisma-labs/graphql-playground" rel="noopener ugc nofollow" target="_blank"> GraphQL Playground </a>，您可以轻松测试graph QL查询、变异和订阅。这是通过传递变量和HTTP头的能力完成的。</li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="4e8b" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated">为什么是阿波罗客户端？</h1><ul class=""><li id="ae06" class="mc md it js b jt me jx mf kb mg kf mh kj mi kn mj mk ml mm bi translated"><strong class="js iu">阿波罗缓存</strong>。Apollo客户机附带了一个默认的、最小设置的、功能强大的缓存。这确保了先前获取的数据被缓存在用户的内存中。默认情况下，客户端首先检查所需的数据是否已经在缓存中，并返回该数据，而不是再次查询它。</li><li id="a0fa" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">易用性</strong>。Apollo client的设置非常简单，在Apollo client v3时代更是如此。</li><li id="5790" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">阿波罗反应钩</strong>。使用Apollo React钩子，您可以在功能组件内部进行查询和修改。这使得编写纯函数更加容易。</li><li id="1620" class="mc md it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated"><strong class="js iu">阿波罗工装</strong>。像阿波罗联邦、<code class="fe nv nw nx ny b">apollo-link-rest</code>和<code class="fe nv nw nx ny b">apollo-upload-client</code>这样的工具只有最低限度的配置支持。</li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="a6e0" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated">GraphQL变异和查询示例</h1><ol class=""><li id="89cb" class="mc md it js b jt me jx mf kb mg kf mh kj mi kn nz mk ml mm bi translated">注册用户突变。突变就像REST中的POST请求。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/acba602948b80dc963cadd3a5789549a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qzQ0oXu_hrWAT-x39QwNA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">GraphQL注册用户突变</p></figure><p id="671d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.GraphQL登录用户查询。查询就像REST中的GET请求。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/ff8f0c510bab81306b5079ab8ec53e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Alo9W40v17kKoptHv00nQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">GraphQL登录用户查询</p></figure><p id="e374" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如您所看到的，有效负载结构(在右边)反映了请求结构(在左边)。你得到的正是你所查询的。很整洁，是吧？</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="4156" class="le lf it bd lg lh na lj lk ll nb ln lo lp nc lr ls lt nd lv lw lx ne lz ma mb bi translated">Apollo客户端设置</h1><p id="ac6a" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">我们将使用<a class="ae ms" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank"> Yarn </a>、<a class="ae ms" href="https://create-react-app.dev/docs/getting-started/" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>、CLI、<a class="ae ms" href="https://www.apollographql.com/docs/react/v3.0-beta/get-started/" rel="noopener ugc nofollow" target="_blank"> Apollo Client 3 beta </a>、<a class="ae ms" href="https://ant.design/" rel="noopener ugc nofollow" target="_blank"> Ant Design </a>和<a class="ae ms" href="https://swapi.graph.cool/" rel="noopener ugc nofollow" target="_blank"> Star Wars GraphQL API </a>。另外，确保您已经安装了Node.js。</p><ol class=""><li id="869d" class="mc md it js b jt ju jx jy kb oc kf od kj oe kn nz mk ml mm bi translated">进入你的项目文件夹，创建一个新的React项目。</li></ol><pre class="kp kq kr ks gt of ny og oh aw oi bi"><span id="3bb4" class="ni lf it ny b gy oj ok l ol om"><em class="nu">npx create-react-app react_apollo_graphql</em></span></pre><p id="6571" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.<code class="fe nv nw nx ny b">cd</code>进入项目，在你最喜欢的编辑器/IDE中打开，启动它确保一切正常。</p><pre class="kp kq kr ks gt of ny og oh aw oi bi"><span id="32f2" class="ni lf it ny b gy oj ok l ol om">cd react_apollo_graphql &amp;&amp; code . &amp;&amp; yarn start <br/>#I use vscode. Replace code . with your fav text editor<br/>#e.g subl . for sublime text</span></pre><p id="0b21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.如果一切顺利，项目应该在您的代码编辑器和默认浏览器上启动。</p><p id="6388" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.添加Apollo客户机包和GraphQL作为开发依赖项。</p><pre class="kp kq kr ks gt of ny og oh aw oi bi"><span id="b1cf" class="ni lf it ny b gy oj ok l ol om">yarn add @apollo/client &amp;&amp; yarn add graphql --dev</span></pre><p id="9aa1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.编辑<code class="fe nv nw nx ny b">index.js</code>如下，添加Ant Design CSS，在你的app上全球提供Apollo客户端。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="daee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.在<code class="fe nv nw nx ny b">src/</code>中创建一个组件文件夹。在其中，创建两个名为<code class="fe nv nw nx ny b">People.js</code>和<code class="fe nv nw nx ny b">Person.js</code>的文件，如下所示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="7855" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">6.编辑<code class="fe nv nw nx ny b">App.js</code>如下。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="5fa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">7.保存、运行和享受。</p><p id="7eaa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意:只要把<code class="fe nv nw nx ny b">useLazyQuery</code>换成<code class="fe nv nw nx ny b">useQuery</code>、<code class="fe nv nw nx ny b">useMutation</code>或<code class="fe nv nw nx ny b">useSubscription</code>，就好GraphQL了。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="751e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！我希望这有所帮助。感谢阅读！</p></div></div>    
</body>
</html>