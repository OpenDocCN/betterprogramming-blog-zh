<html>
<head>
<title>RxSwift Unit Testing Explained in 2 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RxSwift单元测试2分钟讲解</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/rxswift-unit-testing-explained-in-3-minutes-c024b7a26d?source=collection_archive---------6-----------------------#2020-04-02">https://betterprogramming.pub/rxswift-unit-testing-explained-in-3-minutes-c024b7a26d?source=collection_archive---------6-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e589" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用RxTest和RxBlocking库</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3381407c455afcbf18b572836b1720a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rG00LZDJps1YYrKTz1X4aw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="baaf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天，我们将学习如何使用RxTest和RxBlocking库测试我们的RxSwift应用。我们的示例项目遵循反应式<a class="ae lu" href="https://medium.com/better-programming/reactive-mvvm-and-the-coordinator-pattern-done-right-88248baf8ca5" rel="noopener"> MVVM </a>架构。</p><p id="ee6d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该项目的源代码可以在文章的底部找到。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5c9d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们开始吧</h1><p id="c310" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们有以下屏幕:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/1d0de02e64326346965e12a52338bf56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/1*8svjeZp1N6xqiw85wlM41A.gif"/></div></figure><p id="8520" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">而<code class="fe na nb nc nd b">ViewController</code>里面的结构如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="db15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，我们有一个包含三个<code class="fe na nb nc nd b">UIButton</code>的<code class="fe na nb nc nd b">UIStackView</code>。<code class="fe na nb nc nd b">ViewModel</code>内部的逻辑只允许选择一个按钮:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="09f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们想测试这个逻辑，但是我们的输入和输出不仅仅是值，它们是数据流。因此，只使用<code class="fe na nb nc nd b">XCTest</code>并不是一个可行的选择。RxTest和RxBlocking提供了帮助，允许我们以非常简单的方式测试异步逻辑。</p><p id="544b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在<code class="fe na nb nc nd b">ViewModelTests.swift</code>文件中写下以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="dc3e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将在使用RxTest测试逻辑时使用<code class="fe na nb nc nd b">testScheduler</code>属性，在使用RxBlocking时使用<code class="fe na nb nc nd b">scheduler</code>属性。</p><p id="9a87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在<code class="fe na nb nc nd b">tearDown()</code>方法下创建我们的第一个测试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1ebc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，正如该方法的名称所暗示的，我们断言当<code class="fe na nb nc nd b">ViewModel</code>被实例化时，所有按钮都被禁用。我们不关心事件发生的时间，所以我们使用<code class="fe na nb nc nd b">XCTAssertRecordedElements</code>。</p><p id="268d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用RxBlocking创建另一个测试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="5458" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们模拟了<code class="fe na nb nc nd b">ViewController</code>中的行为:当用户点击<code class="fe na nb nc nd b">secondButton</code>时，在<code class="fe na nb nc nd b">bindButtonActions()</code>中，我们将<code class="fe na nb nc nd b">false</code>的值发送给<code class="fe na nb nc nd b">ViewModel</code>的<code class="fe na nb nc nd b">didSelectFirst</code>和<code class="fe na nb nc nd b">didSelectThird</code>属性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d9c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，我们可以测试选择<code class="fe na nb nc nd b">firstButton</code>和<code class="fe na nb nc nd b">thirdButton</code>时的行为:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="5922" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们对<code class="fe na nb nc nd b">ViewModel</code>进行了全面测试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/a267127a277af88e88ce50ff45eafc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AjnuSyY52S5ukfHfpzE5SQ.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d0dd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><p id="27aa" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">该项目的<a class="ae lu" href="https://github.com/zafarivaev/RxSwift-UnitTesting" rel="noopener ugc nofollow" target="_blank">源代码</a>可以在GitHub上获得。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7ea2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">包扎</h1><p id="4ac8" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">要了解更多关于RxTest和RxBlocking的信息，请访问GitHub中的官方文档。</p><p id="1a55" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想了解更多关于RxSwift的信息？请随意查看我的其他相关文章，这些文章可能对您有所帮助:</p><ul class=""><li id="b969" class="nh ni it la b lb lc le lf lh nj ll nk lp nl lt nm nn no np bi translated"><a class="ae lu" href="https://medium.com/better-programming/how-to-create-a-timer-in-rxswift-578bf8712678" rel="noopener">如何在RxSwift中创建定时器</a></li><li id="874b" class="nh ni it la b lb nq le nr lh ns ll nt lp nu lt nm nn no np bi translated"><a class="ae lu" href="https://medium.com/better-programming/replace-delegation-with-rxswift-32ad18d75140" rel="noopener">用RxSwift替换Delegation】</a></li><li id="e86c" class="nh ni it la b lb nq le nr lh ns ll nt lp nu lt nm nn no np bi translated"><a class="ae lu" href="https://medium.com/better-programming/create-and-chain-observable-sequences-in-rxswift-fae9c5bbbc49" rel="noopener">在RxSwift中创建并链接可观察序列</a></li></ul><p id="d38b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！</p></div></div>    
</body>
</html>