<html>
<head>
<title>Your Git Commit History Should Read Like a History Book. Here’s How.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您的Git提交历史应该读起来像一本历史书。以下是方法。</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/your-git-commit-history-should-read-like-a-history-book-heres-how-7f44d5df1801?source=collection_archive---------0-----------------------#2022-05-05">https://betterprogramming.pub/your-git-commit-history-should-read-like-a-history-book-heres-how-7f44d5df1801?source=collection_archive---------0-----------------------#2022-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="62d0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不要再浪费时间去解释提交做了什么。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f632b0331db0b24743af522447ce5644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jYhSDjGQ6XsRsSwXB4Rj1A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托马斯·凯利在Unsplash<a class="ae ky" href="https://unsplash.com/s/photos/history-book?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">拍摄的照片</a></p></figure><p id="22ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以从历史中吸取教训。历史告诉我们过去的哪些事件塑造了现在。波士顿倾茶事件导致了独立战争。滑铁卢战役导致了拿破仑的失败。你能说出哪个决定，哪个提交导致了你的软件的当前状态吗？也许不是。</p><p id="353d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为许多提交消息令人困惑、混乱且无用。</p><p id="da3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我敢打赌你见过(或写过)这样的提交消息:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c351" class="ma mb it lw b gy mc md l me mf">wip</span><span id="e45e" class="ma mb it lw b gy mg md l me mf">work on feature XYZ</span><span id="f56c" class="ma mb it lw b gy mg md l me mf">fixed typo</span><span id="181e" class="ma mb it lw b gy mg md l me mf">Fixed JIRA-123</span></pre><p id="a50e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要跟踪一个问题或发现为什么实现是这样，这些消息没有帮助。</p><p id="2df8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须回答两个问题来改进我们的提交历史:</p><ol class=""><li id="86cb" class="mh mi it lb b lc ld lf lg li mj lm mk lq ml lu mm mn mo mp bi translated">什么是好的提交消息？</li><li id="b46d" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu mm mn mo mp bi translated">我如何让我的同事(和我自己)遵循这种格式？</li></ol></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="6d4c" class="nc mb it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">什么是好的提交消息？</h1><p id="28b4" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">没有明确的答案。提交消息应该包含足够的信息，以便了解发生了什么变化及其原因。它应该是一个完整的句子还是要点就足够了？在每个提交消息中需要票号吗？</p><p id="28ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我能给出的最佳答案是:</p><p id="fad9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与您的同事讨论并就提交信息的范围达成一致。</p><p id="032d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你不必毫无准备地参加讨论。有一些关于提交消息结构的建议。我们来看看其中的一个:<a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交</a>。</p><p id="1e93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交</a>视为提交消息的框架。它给了你一个可以使用的结构。每个提交消息至少包含一个类型和消息本身。范围、正文和页脚是可选的。还有一种简单的方法来显示提交包含了一个突破性的变化。</p><p id="8aea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本结构是这样的:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2e4b" class="ma mb it lw b gy mc md l me mf">&lt;type&gt;[optional !][optional scope]: &lt;description&gt;<br/><br/>[optional body]<br/><br/>[optional footer(s)]</span></pre><p id="95fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些例子:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d293" class="ma mb it lw b gy mc md l me mf">feat: allow user to keep logged in</span><span id="9ccd" class="ma mb it lw b gy mg md l me mf">fix: messages are now serialized correctly</span><span id="989b" class="ma mb it lw b gy mg md l me mf">feat(api)!: removed the old way users are handled</span><span id="840f" class="ma mb it lw b gy mg md l me mf">ci(deployment): the application will now be deployed on nonlive as well</span></pre><p id="cb9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个改进是显而易见的。</p><p id="01b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以浏览提交，因为现在每个提交都有一个<em class="ny">类型</em>。如果您搜索一个bug修复，只需查看所有带有<code class="fe nz oa ob lw b">fix</code>的提交。可选范围帮助您缩小搜索范围。</p><p id="6e72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感叹号表示重大变化。这也可以在提交消息的页脚中更加明确，例如:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5567" class="ma mb it lw b gy mc md l me mf">chore: drop support for Node 6<br/><br/>BREAKING CHANGE: use JavaScript features not available in Node 6.</span></pre><p id="0918" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用类型自动生成<a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/#how-does-this-relate-to-semver" rel="noopener ugc nofollow" target="_blank">语义版本号</a>。A <code class="fe nz oa ob lw b">fix</code>增加补丁等级，而a <code class="fe nz oa ob lw b">feat</code>增加次要等级。每一个突破性的改变都会增加主要等级。</p><p id="553d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">常规提交将改进您的提交消息。</p><p id="b334" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，心有余而力不足。你的同事和你可能会用到它，但是你可能会很快忘记它。您仍然会得到混乱的提交消息。简单的解决方案是:让git强制您使用常规提交。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="29f7" class="nc mb it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">使用<a class="ae ky" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" rel="noopener ugc nofollow" target="_blank"> git钩子</a>来执行常规提交</h1><p id="df5a" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">你可以用git钩子改变git的行为。有服务器端和客户端挂钩。我们将专注于客户端钩子，因为我们大多数人都没有自己的git。git挂钩是一个shell脚本，它在git工作流中的一个事件上执行。</p><p id="656f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一个钩子特别有趣:T2钩子。Git在您输入提交消息后执行它。它获取一个临时文件的路径，并将提交消息作为参数。您可以检查提交消息是否符合您的规则。</p><p id="946e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，这个钩子检查提交消息是否至少有十个字符长:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个简单的提交消息挂钩。</p></figure><p id="562d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用这个钩子，在你的库的根目录下创建一个新目录，例如<code class="fe nz oa ob lw b">.githooks</code>，并在那里添加一个新文件<code class="fe nz oa ob lw b">commit-msg</code>。这个名字对于git理解它是哪个钩子至关重要。不要忘记使文件可执行！</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2492" class="ma mb it lw b gy mc md l me mf">chmod +x .githooks/commit-msg</span></pre><p id="6b7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在告诉git在创建的文件夹中寻找挂钩。你的每个同事都必须做一次。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="655f" class="ma mb it lw b gy mc md l me mf">git config core.hooksPath .githooks</span></pre><p id="9986" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Git将从现在开始拒绝短提交消息。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1a50" class="ma mb it lw b gy mc md l me mf">&gt; git commit -am "abc"<br/>[Commit message] abc<br/>The commit message is to short!</span></pre><p id="6e5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它也适用于IntelliJ:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/2c41b9b9152312afd7d36dfc77c74027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*wahqblUbFjHIlFdgri1Zng.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如果提交消息太短，IntelliJ中的错误消息。</p></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="98ab" class="nc mb it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">将这一切结合在一起</h1><p id="ff20" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">现在可以使用git挂钩来执行常规提交。我甚至扩展了它，使得在类型之后，每条消息都必须包括票号，或者如果没有票号，则不包括JIRA。这是我的钩子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">commit-msg钩子用于常规提交+票号。(整个剧本不是我自己写的；它是我在GitHub上找到的一个的扩展。遗憾的是，我再也找不到原件了。)</p></figure></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="0b94" class="nc mb it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">一锤定音</h1><p id="4db7" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">您的存储库的提交消息变得更加可读。相信我，这是速战速决。但最重要的是每个人都必须同意这个想法。人们总是会避开他们不喜欢的东西。所以先和你的同事谈谈。</p><p id="9288" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忠实地遵循这一点。选择对你有用的东西并付诸实施。试试看！</p><h1 id="0609" class="nc mb it bd nd ne of ng nh ni og nk nl jz oh ka nn kc oi kd np kf oj kg nr ns bi translated">来源</h1><ul class=""><li id="bd83" class="mh mi it lb b lc nt lf nu li ok lm ol lq om lu on mn mo mp bi translated"><a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交规范</a></li><li id="8a57" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu on mn mo mp bi translated"><a class="ae ky" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" rel="noopener ugc nofollow" target="_blank"> Git挂钩</a></li></ul></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4801" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Want to Connect?</strong></span><span id="a53a" class="ma mb it lw b gy mg md l me mf">Subscribe to my newsletter so you never miss a new post:</span><span id="7c81" class="ma mb it lw b gy mg md l me mf"><a class="ae ky" href="https://verbosemode.dev/subscribe" rel="noopener ugc nofollow" target="_blank">https://verbosemode.dev/subscribe</a></span></pre></div></div>    
</body>
</html>