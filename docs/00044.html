<html>
<head>
<title>Angular: Stop Manipulating DOM With ElementRef</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:停止用ElementRef操作DOM</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-manipulate-properly-the-dom-with-renderer-16a756508cba?source=collection_archive---------3-----------------------#2017-07-26">https://betterprogramming.pub/angular-manipulate-properly-the-dom-with-renderer-16a756508cba?source=collection_archive---------3-----------------------#2017-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/4737daa11ef3f272bd2e152f6b1387dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*3SYlii7aDbQi88DBRFkB_w.jpeg"/></div></figure><p id="2709" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我需要和你分享这个故事。最近在Angular里发现了<code class="fe kv kw kx ky b">Renderer</code>的威力。</p><p id="3613" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">(<code class="fe kv kw kx ky b">Renderer</code>已被弃用，所以使用<code class="fe kv kw kx ky b">Renderer2</code>；不过，在本文中我将只使用<code class="fe kv kw kx ky b">Renderer</code>。)</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="4030" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">用Angular操作DOM很容易。我们可以通过使用<code class="fe kv kw kx ky b">@angular/core</code>提供的<code class="fe kv kw kx ky b">ElementRef</code>直接访问该元素。</p><p id="97d6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您通过使用一个指令来操作它(常见用例)——大多数人很可能像这样直接使用<code class="fe kv kw kx ky b">nativeElement</code>:</p><figure class="lg lh li lj gt ju"><div class="bz fp l di"><div class="lk ll l"/></div></figure><p id="3816" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">它将正确地改变元素的颜色。很多教程演示了<code class="fe kv kw kx ky b">nativeElement</code>的用法，但是这样安全吗？不，不是真的。</p><h2 id="a648" class="lm ln it bd lo lp lq dn lr ls lt dp lu ki lv lw lx km ly lz ma kq mb mc md me bi translated">为什么这么重要？</h2><p id="9b6b" class="pw-post-body-paragraph jx jy it jz b ka mf kc kd ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku im bi translated">根据角度文件<code class="fe kv kw kx ky b">ElementRef</code> <em class="mk"> : </em></p><blockquote class="ml mm mn"><p id="77a7" class="jx jy mk jz b ka kb kc kd ke kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt ku im bi translated"><em class="it">当需要直接访问DOM时，使用这个API作为最后的手段。允许直接访问DOM会使您的应用程序更容易受到XSS攻击</em> <strong class="jz iu"> <em class="it">。</em> </strong> <em class="it">仔细检查你的代码中</em> <code class="fe kv kw kx ky b"><a class="ae mr" href="https://angular.io/api/core/ElementRef" rel="noopener ugc nofollow" target="_blank"><em class="it">ElementRef</em></a></code> <em class="it">的任何使用。请改用Angular提供的模板和数据绑定。或者，你可以看看</em> <code class="fe kv kw kx ky b"><a class="ae mr" href="https://angular.io/api/core/Renderer" rel="noopener ugc nofollow" target="_blank"><em class="it">Renderer</em></a></code> <em class="it">，它提供了即使不支持直接访问本地元素也可以安全使用的API。</em></p><p id="5d23" class="jx jy mk jz b ka kb kc kd ke kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt ku im bi translated"><em class="it">依赖直接DOM访问会在应用程序和渲染层之间产生紧密耦合，这使得将两者分开并将应用程序部署到web worker变得不可能。</em></p></blockquote><p id="2efc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">不太好。但是，有一种替代方法叫做<code class="fe kv kw kx ky b">Renderer</code>。</p><h2 id="eb10" class="lm ln it bd lo lp lq dn lr ls lt dp lu ki lv lw lx km ly lz ma kq mb mc md me bi translated">操纵DOM的渲染器</h2><p id="51df" class="pw-post-body-paragraph jx jy it jz b ka mf kc kd ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku im bi translated">看看这个:</p><div class="ms mt gp gr mu mv"><a href="https://angular.io/api/core/Renderer2" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">角度文档渲染器2</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">渲染器2 API</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">angular.io</p></div></div></div></a></div><p id="5ea6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">有很多方法可以操作DOM。在这个用例中，我们需要改变一个CSS属性，颜色。根据API，我们需要这样使用<code class="fe kv kw kx ky b">setStyle</code>:</p><figure class="lg lh li lj gt ju"><div class="bz fp l di"><div class="lk ll l"/></div></figure><p id="8f32" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">果然奏效！<code class="fe kv kw kx ky b">Renderer</code>对于常见用例非常有用，对于复杂的DOM操作也非常有用。</p><p id="671f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">要定位特定元素，您可能需要使用<code class="fe kv kw kx ky b">ViewChild</code>或<code class="fe kv kw kx ky b">ContentChild</code>。如果这样做，请参阅本文:</p><div class="ms mt gp gr mu mv"><a href="https://netbasal.com/understanding-viewchildren-contentchildren-and-querylist-in-angular-896b0c689f6e" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">了解Angular中的ViewChildren、ContentChildren和QueryList</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">有时父组件需要访问其子组件。让我们看看如何用Angular处理这个问题。</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">netbasal.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj jv mv"/></div></div></a></div><p id="b37e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">总之，停止使用<code class="fe kv kw kx ky b">ElementRef</code>，使用<code class="fe kv kw kx ky b">Renderer</code>！</p></div></div>    
</body>
</html>