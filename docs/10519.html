<html>
<head>
<title>Create Twitter Bots for Your Medium Articles With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python为你的中型文章创建Twitter机器人</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-twitter-bots-for-your-medium-articles-with-python-bf6fdd635e50?source=collection_archive---------6-----------------------#2022-01-12">https://betterprogramming.pub/create-twitter-bots-for-your-medium-articles-with-python-bf6fdd635e50?source=collection_archive---------6-----------------------#2022-01-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="678c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们通过创建Twitter机器人来探索Twitter丰富的Tweepy API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/16953181d87f9744d3cb95992e035f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oPqz5F0Ukt4lvGHv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@rswebsols?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Souvik Banerjee </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3d24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名应届毕业生和新员工，我一直在深入思考我的职业道路及其目前的轨迹。</p><p id="334f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在向我公司的许多上级寻求建议和指导之后——我一直得到一条建议——作为一名顾问来发展我的品牌！就在那时，我决定开设一个Twitter和Medium账户，开始制作内容。</p><p id="56ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建自动化系统来帮助在线开发我的品牌的想法非常有趣，促使我创建了一个Twitter机器人。</p><p id="968d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将一步一步地展示如何重新创建我用来自动分享我最近的媒体文章的Twitter bot。它还具有基于标签或用户名自动转发的能力。</p><h1 id="b065" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">先决条件</h1><p id="7017" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了跟进，有几件事是必要的:</p><ol class=""><li id="b31f" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">Python 3</li><li id="3acc" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">任何IDE</li><li id="1489" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">Twitter上的开发者账户</li><li id="f293" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">Linux操作系统(可选)</li><li id="67f8" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">对Bash的基本理解(可选)</li></ol><p id="c942" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注:点击<a class="ae ky" href="https://developer.twitter.com/en/support/twitter-api/developer-account#:~:text=Log%2Din%20to%20Twitter%20and,and%20Project%20with%20Essential%20access" rel="noopener ugc nofollow" target="_blank">此处</a>获取开发者账号的说明。确保保存您的API密钥。你以后会需要它们的。</p><h1 id="04d4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">项目结构</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/5dd66718468ccb1489aaaf199bc33b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*mD7QceSmpNzpuplGC_YhHA.png"/></div></figure><p id="a4b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将这个项目分成3个独立的python文件。</p><p id="6ef2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">获取最新的媒体文章并发布到Twitter。基于标签或用户名转发。</p><p id="7d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">Main</code>将两个脚本放在一起，并连接到一个特定的Twitter帐户。<code class="fe nh ni nj nk b">install.sh</code>文件会安装依赖项，但不是必需的。</p><p id="a426" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">Run.sh</code>将在CronTab部分解释。</p><p id="9e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你开始编码之前，确保安装两个依赖项<code class="fe nh ni nj nk b">tweepy</code>，请求如下:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="4929" class="np lw it nk b gy nq nr l ns nt">pip install tweepy</span><span id="8ae5" class="np lw it nk b gy nu nr l ns nt">pip install requests</span></pre><p id="f3af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保在您编码的目录中这样做。Tweepy是我们将使用的Twitter API，而requests用于构造HTTP请求。实际上，上面两行是install.sh文件的内容。</p><h1 id="31aa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取中等职位</h1><p id="f8af" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这里我们将处理<code class="fe nh ni nj nk b">mediumPosting.py</code>文件。</p><p id="9160" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它需要两个功能。一个获取最近的文章，另一个用相应的链接构建Twitter帖子。</p><p id="c260" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了开始，我们需要三个导入来解析一个URL并执行HTTP请求。它们如下:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="32e8" class="np lw it nk b gy nq nr l ns nt">from urllib.request import urlretrieve</span><span id="3ad4" class="np lw it nk b gy nu nr l ns nt">from urllib.parse import urlparse</span><span id="7beb" class="np lw it nk b gy nu nr l ns nt">import requests</span></pre><p id="644b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何获取最新的Medium文章并提取其内容的完整源代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="74a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中:</p><p id="2a47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">fetch_article</code>函数接受一个中等配置文件URL，并使用HTTP请求检索一个帖子列表(返回一堆HTTP文章)。</p><p id="f0bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过在中等RSS源的<code class="fe nh ni nj nk b">{@username}</code>字段中包含您的用户名来创建URL，如下所示:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="58a0" class="np lw it nk b gy nq nr l ns nt">"https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/{@username}"</span></pre><p id="4817" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">HTTP响应中的第一条记录是最新的文章。构造一个包含这篇文章的<code class="fe nh ni nj nk b">title</code>、<code class="fe nh ni nj nk b">link</code>和<code class="fe nh ni nj nk b">thumbnail</code>的字典并返回。</p><p id="03df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获取文章，在URL上做一个基本的get请求，并创建一个字典，如上所述。完成之后，我们创建了一个函数<code class="fe nh ni nj nk b">Title_Link_Post</code>，它使用基本的字符串格式来创建Twitter帖子的内容。</p><p id="30c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是<code class="fe nh ni nj nk b">mediumPosting.py</code>文件所需的全部内容。</p><h1 id="6d79" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基于Hashtag的转发</h1><p id="b91f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本节中，我们将完成文件retweet.py，以根据标签自动转发预设数量的帖子。</p><p id="acc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们使用一个函数，它接受用户通过OAuth验证的三个输入变量——名为Auth(我们将在main.py中创建)、字符串形式的hashtag和转发的tweet数量。</p><p id="022a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了做到这一点，我们将通过使用如下所示的<code class="fe nh ni nj nk b">Cursor</code>函数来充分利用<code class="fe nh ni nj nk b">tweepy</code> API:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="9ff0" class="np lw it nk b gy nq nr l ns nt">tweepy.Cursor(auth.search, hashtag).items(num)</span></pre><p id="00a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">Auth.search</code>指定正在搜索的认证帐户，hashtag只是一个要搜索的字符串。</p><p id="d792" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">扩展<code class="fe nh ni nj nk b">.items(num)</code>抓取，其中<code class="fe nh ni nj nk b">num</code>是代表第一个商品计数的<code class="fe nh ni nj nk b">int</code>。</p><p id="56d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">找到推文后，我们将使用<code class="fe nh ni nj nk b">.retweet</code>功能来分享它们。</p><p id="3faa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是转发用户最近几条推文的功能，其工作方式几乎相同。为了便于记录，已经包含了打印语句。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="642f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">连接到您的帐户</h1><p id="97e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">认证只是将正确的API密钥传递给<code class="fe nh ni nj nk b">tweepy</code>的<code class="fe nh ni nj nk b">OAuthHandler</code>函数。</p><p id="f7ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦完成，我们就可以从<code class="fe nh ni nj nk b">retweet.py</code>中获得<code class="fe nh ni nj nk b">auth</code>变量。它代表API和我们登录的相应帐户(下面称为<code class="fe nh ni nj nk b">auth_acc</code>)。这通过以下方式实现:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="72d5" class="np lw it nk b gy nq nr l ns nt">API_KEY = "API KEY"<br/>API_SECRET_KEY = "SECRET KEY"<br/>API_ACCESS_TOKEN = "ACCESS TOKEN"<br/>API_ACCESS_SECRET = "ACCESS SECRET"</span><span id="f76e" class="np lw it nk b gy nu nr l ns nt"># Authentication<br/>auth = tweepy.OAuthHandler(API_KEY,API_SECRET_KEY)<br/>auth.set_access_token(API_ACCESS_TOKEN, API_ACCESS_SECRET)<br/>auth_acc = tweepy.API(auth)</span></pre><p id="e925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单地说，用创建开发人员帐户时保存的API密钥替换引号中的值。</p><p id="30e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦完成，你可以简单地将<code class="fe nh ni nj nk b">mediumPosting</code>和<code class="fe nh ni nj nk b">retweet</code>文件导入到<code class="fe nh ni nj nk b">main</code>文件中，并在你的主方法中使用相应的函数调用。</p><p id="ebac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">见下文:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">auth_acc.update_status发布我们在mediumPosting.py中创建的Title_Link字符串</p></figure><h1 id="073b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">CronTab</h1><p id="baa1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><code class="fe nh ni nj nk b">run.sh</code>的内容相当简单。</p><p id="72d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该文件包含一行代码，它使用crontab(一个用于调度作业的Linux实用程序)在特定的时间间隔自动运行bot。毕竟，机器人应该是自动的(至少在原则上)。</p><p id="f4c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只需将条目添加到crontab，如下所示，让文件以特定的时间间隔运行:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="d24c" class="np lw it nk b gy nq nr l ns nt">MM HH DD MM YYY python3 PATH/TO/Main.py</span></pre><p id="c5af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我下面的条目设置为每10分钟运行一次。我知道这有点多，但这个例子是可行的:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="3339" class="np lw it nk b gy nq nr l ns nt">*/10 * * * * python3 ./main.py</span></pre></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="17c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你能在本教程中找到一些有用的东西。</p><p id="ff93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到完整的代码<a class="ae ky" href="https://github.com/AleksaZatezalo/TwitterBot" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>