<html>
<head>
<title>What Is Up With The Numbers In Python?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的数字是怎么回事？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-up-with-the-numbers-in-python-26d8d36e129b?source=collection_archive---------12-----------------------#2022-02-28">https://betterprogramming.pub/what-is-up-with-the-numbers-in-python-26d8d36e129b?source=collection_archive---------12-----------------------#2022-02-28</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5851" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让我们来揭开为什么Python中整数的大小至少是24字节</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fb577da101c916e6885add237662bf17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RAu7_gt3CdTcCH-r"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">简·kopřiva在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6a92" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你是一个经验丰富的程序员，那么可以直接跳到叫做<strong class="lc iv">“Python中的数字类型”</strong>的部分，因为第一部分可能不会教你很多新东西。不然就继续看下去。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="5f11" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">显式和隐式类型</h2><p id="9f3c" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">Python是一种超级流行的语言，其中一个原因是用Python编码时，你不必考虑不同的数据类型。在C、C#和Java等语言中，您必须指定变量的数据类型，而在Python中，您可以忽略这一点，只需键入变量的名称，就可以了。</p><p id="1d27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你认为这是好是坏当然是主观的。一些开发人员讨厌非严格类型化的编程语言，因为如果您不是非常小心和清楚自己在做什么，类型的缺乏会增加创建易受攻击和不可预测的代码的风险。</p><p id="1fcf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">另一方面，一些开发人员确实喜欢Python提供的可写性和可读性，因为语法不那么冗长。</p><p id="cf9c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这篇文章中，我想让你更深入地了解Python中的数字是如何工作的，以及Python内部发生了什么。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="19c6" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">Python中隐式类型的一个结果</h2><p id="4563" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">我认为Python没有显式类型的一个后果是，许多新用户(包括我自己，直到最近)，并没有真正意识到他们使用该语言创建的数字背后发生了什么。让我们看一个例子:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="e794" class="md me iu nc b gz ng nh l ni nj">#Python<br/>x = 42<br/>y = 1.5</span></pre><p id="5438" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在上面的代码块中，我们实例化了一个整数和一个浮点数(带小数点的数字)。</p><p id="3111" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在像C这样的语言中，相同的代码可能是这样的:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="40f8" class="md me iu nc b gz ng nh l ni nj">//C<br/>int x = 42;<br/>float y = 1.5;</span></pre><p id="1e27" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如你所见，在C语言中，这两个变量有明显的区别，我们必须指定浮点数是浮点数，整数是整数。</p><p id="0ef5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">关于C中的数字类型，还有很多要学习的，但我现在不会深入探讨。</p><p id="7959" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果Python是您唯一有经验的编程语言，那么您可能没有太多考虑整数和小数之间是否有很大的区别。然而，在大多数其他语言中，这实际上是一件大事！</p><blockquote class="nl nm nn"><p id="1064" class="la lb nk lc b ld le jv lf lg lh jy li no lk ll lm np lo lp lq nq ls lt lu lv in bi translated">那么，Python到底有没有int和floats呢？它们在Python中仅仅是相同的数据类型吗？幕后还有更多的事情吗？</p></blockquote><p id="d904" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你打赌有！</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="ceee" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">Python中的数字类型</h2><p id="8f8d" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">如果我们使用Python <code class="fe nr ns nt nc b">type()</code>函数，我们可以得到变量的实际类型，在下面的截图中，你可以看到左边的函数调用和右边的终端输出。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nu"><img src="../Images/85b0144e21255cf20e4f841e20b781a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*c3L91TyZJR-7lcegwmFt6g.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Python中的42和1.5类型</p></figure><p id="9328" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如你所见，x的类型是<code class="fe nr ns nt nc b">class 'int'</code>，y的类型是<code class="fe nr ns nt nc b">class 'float'</code>。所以Python实际上既有int也有floats，即使在简单地实例化变量中的数字时并不明显。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="9ab5" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated"><strong class="ak">整型和浮点型的大小</strong></h2><p id="d092" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">现在让我们看看C和Python中int和float类型的字节大小。</p><p id="590b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="nk">请注意，不同数据类型的确切大小因CPU架构和用于编译程序的编译器而异，但是为了使这篇文章简单易懂，我将坚持使用我的系统使用的大小。</em></p><p id="29bb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是一个小的C程序，打印出我们的int和float的大小。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nv"><img src="../Images/6a6f2bc8140dd19037a6a77983c16be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*ZvqGdAPI5AOr8nNNWAMb3w.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在C #中打印int和float的大小</p></figure><p id="b569" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当程序运行时，您可以在右边的终端中看到，两个大小都是4字节，这意味着我们使用32位(8 * 4)来表示数字。</p><p id="4de8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来在Python中做同样的事情，(记住x实际上是一个int，y是一个float，正如我们之前发现的)。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nw"><img src="../Images/c838e60d154e81b842e423c82e2f9dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*J5lMuWmV2BmYG4lJIeqCNw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在Python中打印int和float的大小</p></figure><p id="eee0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">28个字节用于int，24个字节用于float。这意味着数字42在Python中占用的内存是c语言的7倍。</p><p id="bb86" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这就是为什么Python代码通常比C代码慢，以及为什么它需要更多内存的原因之一。</p><blockquote class="nl nm nn"><p id="4098" class="la lb nk lc b ld le jv lf lg lh jy li no lk ll lm np lo lp lq nq ls lt lu lv in bi translated">这是否使Python成为一种糟糕的语言？</p></blockquote><p id="a369" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">不，不是的。这只是意味着Python可能不是适合所有情况的工具。例如，如果您的代码需要在低资源设备上运行，那么C可能更适合这个任务。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="f525" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">Python中int 42为什么需要28字节？</h2><p id="bf91" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">在本文的剩余部分，我将主要关注int，而把floats的讨论留到以后。</p><p id="1ebf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">int 42在Python中占这么大空间的原因，不仅仅是数字。正如我们前面看到的，变量x的类型实际上是<code class="fe nr ns nt nc b">class 'int'</code>。这意味着我们谈论的是一个整体，而不仅仅是一个数字。这个int对象有4个属性，正是这些属性占据了空间。</p><p id="fe88" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这四个属性是:</p><ul class=""><li id="ab24" class="nx ny iu lc b ld le lg lh lj nz ln oa lr ob lv oc od oe of bi translated">一个帮助Python寻找内存位置并为int进行内存分配和释放的引用。它的类型是<code class="fe nr ns nt nc b">long</code>。</li><li id="24fa" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">指向这个对象的对象类型的指针，它是一个int类型。数据类型是一个<code class="fe nr ns nt nc b">pointer</code>。</li><li id="48ef" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">以字节为单位的数据大小(该变量/对象需要多少空间)。数据类型为<code class="fe nr ns nt nc b">size_t</code>。</li><li id="3a65" class="nx ny iu lc b ld og lg oh lj oi ln oj lr ok lv oc od oe of bi translated">最后，我们还有整数本身的值，也就是你想要存储在变量中的实际数字。默认情况下，Python为此至少分配了4个字节。</li></ul><p id="08ed" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">总之，这意味着Python中int类的一个实例需要一个<code class="fe nr ns nt nc b">long</code>、一个<code class="fe nr ns nt nc b">pointer</code>、一个<code class="fe nr ns nt nc b">size_t</code>的空间，它们都是C类型，而数字本身至少需要4个字节。</p><p id="7091" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">也许你已经知道，对于我们的数字42，这是如何累积到28个字节的。然而，为了让它超级清楚，让我们跳回一些C代码，检查这些数据类型的大小。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/4416c46302fc5d2094eb43cdc11b2a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4G1H3JoQBq9M2lMD-r6Xyw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用C打印出附加数据类型的大小</p></figure><p id="f67c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将这4个大小相加，我们就得到神秘的28字节，这就是为什么我们的数字42在Python中占据了这么多空间。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="14d0" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">整数的范围限制</h2><p id="66fb" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">在C #中，数据类型只能包含一定范围的数字，因为它们在某个时候会用完所有的位数。我们可以通过以下方式在我的系统上检查4字节int的范围:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj om"><img src="../Images/4b00384ec25ef59e79b03d4b05e6e8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*Sq-iBaRjnoj_3o877uz0Kg.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">C语言中的INT_MIN和INT_MAX</p></figure><p id="fe33" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这意味着如果我们想存储一个大于2147483647或小于-2147483648的数，那么我们必须使用另一种数据类型。</p><p id="cd2d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这在Python中有所不同，因为对于可以存储多大的值没有限制。Python会继续为你的int分配更多的字节。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj on"><img src="../Images/011489af5bb612b27b2e260bb744249d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*0qLdGJqwGy7yTJmH0cRfiw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用Python打印超大数字的大小</p></figure><p id="7553" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">正如你在上面的截图中看到的，数字越大，占据的空间就越大。(<code class="fe nr ns nt nc b">**</code>运算符指的是的幂)。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="c300" class="md me iu bd mf mg mh dn mi mj mk dp ml lj mm mn mo ln mp mq mr lr ms mt mu mv bi translated">临终遗言</h2><p id="22c6" class="pw-post-body-paragraph la lb iu lc b ld mw jv lf lg mx jy li lj my ll lm ln mz lp lq lr na lt lu lv in bi translated">因为Python是如此高级的语言，它抽象出了不同数据类型的概念以及它们所具有的正常大小限制。这样做的好处是，您不必担心太多的技术细节，可读性和可写性可能会得到提高。这样做的缺点是你不能完全意识到实际发生了什么，并且你不能控制你程序的小细节，这使得优化变得更加困难。</p><p id="907a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在你知道为什么Python中的数字需要这么多内存了，希望你能利用这些知识。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="7504" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢阅读！</p></div></div>    
</body>
</html>