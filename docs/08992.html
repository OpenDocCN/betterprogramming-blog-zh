<html>
<head>
<title>Create a Machine Learning API With Django Rest Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Django Rest框架创建机器学习API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-machine-learning-api-with-django-rest-framework-967571640c46?source=collection_archive---------0-----------------------#2021-07-05">https://betterprogramming.pub/create-a-machine-learning-api-with-django-rest-framework-967571640c46?source=collection_archive---------0-----------------------#2021-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5ab4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何用Django创建机器学习API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3cb6a60abac6ee39bff188fd395d2b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bbdU18Ot-y2N1HsN"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">詹姆斯·哈里逊在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="1e38" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">本教程将分为两部分。</p><ul class=""><li id="213d" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated">在<strong class="li iu">第1部分</strong>中，我们将训练一个简单的机器学习模型，并用<a class="ae ky" href="https://www.django-rest-framework.org/" rel="noopener ugc nofollow" target="_blank"> Django Rest框架</a>创建一个API。</li><li id="9758" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">在第2部分<strong class="li iu">中，我们将使用一个流行的云服务来部署我们的项目。<br/>(我将向您展示如何通过AWS和GCP部署您的项目，您可以选择任何您想要的。)</strong></li></ul></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="c7b3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在你正在阅读第一部分，它由三个子部分组成:</p><ul class=""><li id="8a9c" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated">建立一个模型，在给定身高和性别的情况下预测一个人的体重。</li><li id="e3d8" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">用Django创建一个API来处理到来的请求。</li><li id="accc" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">用失眠测试API。</li></ul></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="65c3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在进入文章之前，我不得不说，这篇文章既不是Django教程，也不是展示如何解决机器学习问题。事实上，本文的目的是将机器学习模型与Django项目结合起来，并将您的模型产品化为机器学习API。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="7bc0" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">建立一个模型</h1><p id="567a" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">在本节中，我们将训练一个机器学习模型，该模型稍后将用于预测API。</p><h2 id="1e0c" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">资料组</h2><p id="7e8e" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">为了简单起见，我将使用在<a class="ae ky" href="https://www.kaggle.com/mustafaali96/weight-height" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>和我的<a class="ae ky" href="https://github.com/gorkemarslan/WeightPredictionAPI/tree/main/ml/data" rel="noopener ugc nofollow" target="_blank"> Git repo </a>上可用的一个小数据集。利用这个数据集，我们将建立一个模型，在给定身高和性别的情况下预测一个人的体重。该数据集包含10，000条记录，包括人类性别、身高和体重。</p><p id="8556" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们开始探索数据集。</p><p id="11b7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">应该做的第一件事是导入依赖项。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="d714" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们加载数据集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="2cdc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">不幸的是，身高数据以英寸为单位，体重数据以磅为单位。我希望它们的单位分别是厘米和千克。所以我将做一个单位转换和四舍五入的数据，因为身高和体重不能用这些精度来衡量。</p><p id="238a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">(如果这些单元对你来说没问题，那么你可以跳过这一部分。)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="50ef" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们看看我们得到了什么:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="2a5e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在看起来好多了。</p><p id="b056" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们检查数据集是否平衡。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="72d1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">输出:</strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="7d5e" class="nn mr it oc b gy og oh l oi oj">Female    5000<br/>Male      5000<br/>Name: Gender, dtype: int64</span></pre><p id="31f4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">数据集具有相同数量的女性和男性记录，因此数据集是平衡的。</p><p id="ffbb" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们来看看基于性别的分布。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/50087411d693853757f8ca260fa4fb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G_s2EZIH_m6BgzLiFyJ3Kg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">男女分布(图片由作者提供)</p></figure><p id="ee0e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">此外，很明显，男女的体重和身高之间存在正相关关系。</p><p id="5cd3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在训练模型之前，我们需要完成最后一步。数据集中的性别列由分类数据组成，即<code class="fe ol om on oc b">female</code>和<code class="fe ol om on oc b">male</code>。但是它们必须是数字，所以我们需要将它们转换成数字数据。为此，我们将用<code class="fe ol om on oc b">0</code>替换<code class="fe ol om on oc b">Male</code>，用<code class="fe ol om on oc b">1</code>替换<code class="fe ol om on oc b">Female</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="dbb7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们可以训练一个模型。</p><h2 id="db1e" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">训练模型</h2><p id="93b1" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">我们将数据集分成80%的训练数据和20%的测试数据进行训练。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="8d39" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了简单起见，我对训练集应用线性回归。你可以选择更好的方法。让我们训练模型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="e4d4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">并测量模型的准确性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="5af1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">输出:</strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="222a" class="nn mr it oc b gy og oh l oi oj">0.904889435019112</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="0d49" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们希望我们的模型预测一个180厘米的男性的体重。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="1d68" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">输出:</strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="deaa" class="nn mr it oc b gy og oh l oi oj">89.8</span></pre><p id="0243" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我对结果进行了四舍五入，以便我们的API用户能够读懂。</p><p id="b007" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">结果可以进一步改进，但这足以创建一个Django项目。在结束本节之前，我们将保存模型，以便稍后在API中使用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="2122" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们可以开始姜戈部分了。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="2b39" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">用Django创建API</h1><p id="b47b" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">在本节中，我们将从创建Django项目开始。然后我们将能够创建一个API。</p><h2 id="7ae3" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated"><strong class="ak">虚拟环境和安装依赖关系</strong></h2><p id="c606" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">让我们开始为Django项目创建一个新目录。我在桌面上有一个名为<code class="fe ol om on oc b">code</code>的目录来存储我的项目。我建议你也这样做。</p><p id="9654" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">打开命令提示符，写下以下几行:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="a6bd" class="nn mr it oc b gy og oh l oi oj">$ cd Desktop/code<br/>$ mkdir WeightPredictionAPI</span></pre><p id="eaab" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">然后导航到此目录:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="5260" class="nn mr it oc b gy og oh l oi oj">$ cd WeightPredictionAPI</span></pre><p id="a77f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最佳实践是将Python项目所需的包隔离到虚拟环境中。因此，我们将首先创建一个虚拟环境。接下来我们将激活它。在控制台上，编写这些shell命令来创建和激活虚拟环境。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="9ed8" class="nn mr it oc b gy og oh l oi oj">$ python -m venv venv<br/>$ source venv/bin/activate</span></pre><p id="bbba" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一旦虚拟环境被激活，我们就可以安装Django项目所需的所有依赖项了。为此，我们将创建<code class="fe ol om on oc b">requirements.txt</code>文件来添加将在我们的项目中使用的包。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="be85" class="nn mr it oc b gy og oh l oi oj">(venv)$ touch requirements.txt</span></pre><p id="e4f9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们打开<code class="fe ol om on oc b">requirements.txt</code>文件，指定运行项目所需的包及其版本。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="f232" class="nn mr it oc b gy og oh l oi oj">Django==3.1<br/>djangorestframework==3.11.1<br/>numpy==1.18.4<br/>scikit-learn==0.24.2<br/>joblib==0.16.0</span></pre><p id="0be7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面的命令可用于安装写在<code class="fe ol om on oc b">requirements.txt</code>文件中的包。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="aa2f" class="nn mr it oc b gy og oh l oi oj">(venv)$ pip install -r requirements.txt</span></pre><p id="87ba" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">安装好所有东西后，我们需要创建一个Django项目。</p><h2 id="854d" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">创建Django项目</h2><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="dae3" class="nn mr it oc b gy og oh l oi oj">(venv)$ django-admin startproject WeightPredictionAPI .</span></pre><p id="d056" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们将创建一个负责API管理的新应用程序。运行以下命令创建一个新的Django应用程序。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="795f" class="nn mr it oc b gy og oh l oi oj">(venv)$ python manage.py startapp api</span></pre><p id="a5df" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们创建另一个目录来存储我们的机器学习模型。我还会将数据集添加到项目中，以便那些想要实现整个数据集的人使用。(创建数据文件夹不是强制性的。)</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="64b7" class="nn mr it oc b gy og oh l oi oj">(venv)$ mkdir ml<br/>(venv)$ mkdir ml/models<br/>(venv)$ mkdir ml/data</span></pre><p id="b1a9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">并将文件移动到相关目录。</p><p id="367a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您的项目文件夹和文件最终应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/e254fadf4b36a98510570cf91c96a38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*uGTVNRFap2fAH-62FaLiuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目结构(图片由作者提供)</p></figure><h2 id="2b5e" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated"><strong class="ak">更新settings.py </strong></h2><p id="5295" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">首先，我们需要将创建的应用程序添加到<code class="fe ol om on oc b">INSTALLED_APPS</code>中。否则，Django无法运行不是用<code class="fe ol om on oc b">INSTALLED_APPS</code>编写的应用程序。暂时我们只使用<code class="fe ol om on oc b">rest_framework</code> (Django rest框架)和<code class="fe ol om on oc b">api</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="9509" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们还需要告诉Django我们的机器学习模型所在的位置。将这几行添加到<code class="fe ol om on oc b">settings.py</code>文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="756a" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">迁移</h2><p id="7764" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">现在，我们能够在运行项目之前迁移一切。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="31fe" class="nn mr it oc b gy og oh l oi oj">(venv)$ python manage.py makemigrations<br/>(venv)$ python manage.py migrate</span></pre><p id="9d23" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您可能会在终端上看到这些消息。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="98c8" class="nn mr it oc b gy og oh l oi oj">Operations to perform:<br/>  Apply all migrations: admin, auth, contenttypes, sessions<br/>Running migrations:<br/>  Applying contenttypes.0001_initial... OK<br/>  Applying auth.0001_initial... OK<br/>  Applying admin.0001_initial... OK<br/>  Applying admin.0002_logentry_remove_auto_add... OK<br/>  Applying admin.0003_logentry_add_action_flag_choices... OK<br/>  Applying contenttypes.0002_remove_content_type_name... OK<br/>  Applying auth.0002_alter_permission_name_max_length... OK<br/>  Applying auth.0003_alter_user_email_max_length... OK<br/>  Applying auth.0004_alter_user_username_opts... OK<br/>  Applying auth.0005_alter_user_last_login_null... OK<br/>  Applying auth.0006_require_contenttypes_0002... OK<br/>  Applying auth.0007_alter_validators_add_error_messages... OK<br/>  Applying auth.0008_alter_user_username_max_length... OK<br/>  Applying auth.0009_alter_user_last_name_max_length... OK<br/>  Applying auth.0010_alter_group_name_max_length... OK<br/>  Applying auth.0011_update_proxy_permissions... OK<br/>  Applying auth.0012_alter_user_first_name_max_length... OK<br/>  Applying sessions.0001_initial... OK</span></pre><p id="ce48" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们运行项目，看看是否一切顺利。如果是这样，这意味着我们的Django后端设置正确，运行没有问题。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="b26c" class="nn mr it oc b gy og oh l oi oj">(venv)$ python manage.py runserver</span></pre><p id="9848" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在打开你的浏览器，进入<a class="ae ky" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank"> https:127.0.0.1:8000 </a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/2454b6bc2caf9e317554017b61451c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cloJRlcY3m3YFygwZBwYTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Django欢迎页面(图片由作者提供)</p></figure><p id="b5b2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果你看到这个页面，那就意味着到目前为止你没有任何问题。恭喜你！</p><h2 id="b88a" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">应用程序接口</h2><p id="ccd6" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">让我们创建我们的API。</p><p id="ae79" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">第一步是将路线添加到<code class="fe ol om on oc b">urls.py</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="cbd1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们需要为API应用程序生成<code class="fe ol om on oc b">urls.py</code>文件。在控制台上写下这一行:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="5dc2" class="nn mr it oc b gy og oh l oi oj">(venv)$ touch api/urls.py</span></pre><p id="615a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">更新文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="640e" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated">更新apps.py</h2><p id="dbb2" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">我强烈建议你在<code class="fe ol om on oc b">apps.py</code>中加载你的机器学习模型。在这里，当应用程序启动时，训练好的模型只被加载一次。否则，每次调用端点时都会加载训练好的模型，这样响应时间会变慢。</p><p id="088d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们更新<code class="fe ol om on oc b">apps.py</code>，以便我们的应用程序更快地处理传入的请求。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="0676" class="nn mr it bd ms no np dn mw nq nr dp na lp ns nt nc lt nu nv ne lx nw nx ng ny bi translated"><strong class="ak">编辑views.py </strong></h2><p id="b29f" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">最后一步是更新<code class="fe ol om on oc b">views.py</code>。视图将主要负责两项任务:</p><ol class=""><li id="cc2e" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb oq mi mj mk bi translated">处理传入的<code class="fe ol om on oc b">POST</code>请求。</li><li id="fc22" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb oq mi mj mk bi translated">使用输入数据进行预测，并将结果作为<code class="fe ol om on oc b">Response</code>给出。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="b1d4" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">测试API</h1><p id="1b96" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">为了测试我们的API，我将使用一个名为<a class="ae ky" href="https://insomnia.rest/" rel="noopener ugc nofollow" target="_blank">失眠症</a>的应用程序。你也可以使用<a class="ae ky" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">邮递员</a>。我喜欢用失眠，因为它对于小任务来说很简单。</p><p id="66cc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因为我们有一个端点，即<code class="fe ol om on oc b">weight/</code>，我们将只测试这个端点。</p><p id="e1ee" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们发送一个<code class="fe ol om on oc b">POST</code>请求到<a class="ae ky" href="http://127.0.0.1:8000/v1/api/weight/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/v1/API/weight/</a>。</p><p id="2619" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请求的主体必须包含<code class="fe ol om on oc b">Gender</code>和<code class="fe ol om on oc b">Height</code>字段。</p><p id="7896" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们来预测一个身高165 cm的女性的体重:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="1be3" class="nn mr it oc b gy og oh l oi oj">{<br/> "Gender": "Female",<br/> "Height": 165<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/fc2c18012bb1fc28d0097515628f4872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGu9HJLnNsyPnILwIgcR1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用失眠测试API(图片由作者提供)</p></figure><p id="0bfe" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在试着预测一下:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="7afb" class="nn mr it oc b gy og oh l oi oj">{<br/> "Gender": "Male",<br/> "Height": 175<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/edd94fecd854afa4878cf821ac13d08d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ba0ayoTvO9I9V0VVv1jZyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用失眠测试API(图片由作者提供)</p></figure><p id="bcd3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们的应用程序有效！</p><p id="b993" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如你所见，用Django做一个机器学习API没什么大不了的。</p><p id="4a67" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">源代码可以在<a class="ae ky" href="https://github.com/gorkemarslan/WeightPredictionAPI" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="94db" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="a9b9" class="pw-post-body-paragraph lg lh it li b lj ni ju ll lm nj jx lo lp nk lr ls lt nl lv lw lx nm lz ma mb im bi translated">在本教程中，我们学习如何将我们的机器学习模型与Django rest框架相结合。在第2部分中，我们将学习如何用Google云平台和Amazon Web Services部署这个项目。</p><p id="46d7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">希望你喜欢这篇文章。</p><p id="defd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果您想提高Python技能，可以访问:</p><div class="os ot gp gr ou ov"><a href="https://python.plainenglish.io/11-python-tricks-to-boost-your-python-skills-significantly-1a5221dfa5c7" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">显著提升你的Python技能的11个Python技巧</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">你不会相信有了这些技巧，Python中的事情会变得多么简单！</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">python .平原英语. io</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div></div></div>    
</body>
</html>