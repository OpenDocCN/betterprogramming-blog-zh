<html>
<head>
<title>Don’t Just Lint Your Code, Fix It With Prettier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要只是丢弃你的代码，用更漂亮的代码来修复它</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/dont-just-lint-your-code-fix-it-with-prettier-a6fbd88e7ee0?source=collection_archive---------20-----------------------#2019-11-06">https://betterprogramming.pub/dont-just-lint-your-code-fix-it-with-prettier-a6fbd88e7ee0?source=collection_archive---------20-----------------------#2019-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a390" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">林挺告诉我们代码有什么问题，但是我们如何避免做实际的修复工作呢？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/db2fdd95eb815cce98b8924e7e0106d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D0FsUPlxVOxkjI_b5mMg6w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com/photos/Fa0pTKuoDVY" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">林挺告诉我们代码有什么问题，让每个人的生活变得更轻松。但是我们如何避免做实际的修复工作呢？</p><p id="1802" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-is-linting-66e7876708f3" rel="noopener">之前，我写过关于林挺</a>，它是什么，以及它如何让你的生活更轻松。最后，我实际上包括了一种可以自动修复代码的方法，那么我为什么要写这个呢？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f486" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">修好它是什么意思？</h1><p id="a7a4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们深入讨论之前，让我们快速讨论一下这个问题。</p><p id="7607" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Linters功能强大，提供了一种简单的方法来扫描代码中可能导致bug的语法错误，或者只是帮助保持代码库的干净、健康和一致。当运行时，它会显示所有的问题，并让您逐个解决它们。</p><p id="6164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更进一步，一些linter实际上允许你向运行linter的命令传递一个参数，并允许它自动修复它。</p><p id="8a34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着您不必手动浏览并创建所有这些小空格和分号(添加它们！)拧自己！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a851" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我还能做些什么来补救呢？</h1><p id="f375" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您已经使用了fix选项，这是一个好的开始，但是除了在您的命令中添加一个标志之外，还有专门开发的工具来解决这个问题。</p><p id="4314" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我要盖的是<a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mz">更漂亮的</em> </a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e840" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么更漂亮？</h1><p id="b619" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">更漂亮的将自己标榜为“一个固执己见的代码格式化者”它接受您的代码输入，并以一致的格式输出，去掉任何原始代码风格。</p><p id="8b8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它实际上将你的代码转换成一个<a class="ae ky" href="https://github.com/benjamn/recast" rel="noopener ugc nofollow" target="_blank">语法树</a>，然后使用你和prettle通过你的<a class="ae ky" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a>配置和prettle的默认规则一起提供的样式和规则重写它。</p><p id="da71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以很容易地单独使用Prettier来格式化你的代码，这很好，但是把它和一个底层的ESLint进程结合起来，你就可以得到一个强大的linter和一个强大的fixer。</p><p id="1ee6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将向您展示如何让它们协同工作。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f112" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">开始使用更漂亮的</h1><p id="c70b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">对于本演练，我将假设您已经在应用程序中设置和配置了ESLint。特别是，我将从我之前的演练中停止的地方开始，在那里<a class="ae ky" href="https://medium.com/better-programming/what-is-linting-66e7876708f3" rel="noopener">我们将ESLint安装到React应用</a>。</p><p id="f193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外值得注意的是，Prettier从一开始就告诉我们，它是一个固执己见的代码格式化程序。</p><p id="4f5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你应该预料到它会以一种一致的方式格式化你的代码，但是可能是一种不同于你当前配置的方式。但是不要烦恼！您可以调整这个配置。</p><p id="fe48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，我们从什么开始？我们已经:</p><ul class=""><li id="b670" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">已经安装了<a class="ae ky" href="https://github.com/eslint/eslint" rel="noopener ugc nofollow" target="_blank"> ESLint </a>。</li><li id="55a4" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">添加了<a class="ae ky" href="https://github.com/babel/babel-eslint" rel="noopener ugc nofollow" target="_blank"> Babel </a>作为我们的解析器。</li><li id="9d07" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">添加了一个包含React配置的<a class="ae ky" href="https://github.com/yannickcr/eslint-plugin-react" rel="noopener ugc nofollow" target="_blank">插件</a>。</li></ul><p id="4da6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们从安装几个包开始:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e36b" class="nt md it np b gy nu nv l nw nx">yarn add prettier prettier-eslint prettier-eslint-cli -D</span></pre><p id="3d7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:上面的命令类似于使用<code class="fe ny nz oa np b">npm</code>。如果你的项目不使用<code class="fe ny nz oa np b">yarn</code>，适当地换成<code class="fe ny nz oa np b">npm</code>。</p><p id="e995" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面，我们正在安装:</p><ul class=""><li id="ac26" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><a class="ae ky" href="https://github.com/prettier/prettier" rel="noopener ugc nofollow" target="_blank">更漂亮</a>:核心更漂亮的包和发动机。</li><li id="2e48" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://github.com/prettier/prettier-eslint" rel="noopener ugc nofollow" target="_blank">beautiful-lint</a>:将beautiful结果传递给ESLint，使用ESLint配置进行修复。</li><li id="7c8b" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">帮助beauty和eslint在你的项目中合作处理不同的文件。</li></ul><p id="95e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而且，我们将它们作为开发依赖项进行安装，因为我们在开发之外不需要它。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9df8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">配置新的格式化程序</h1><p id="fa72" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们的包已经安装好了，我们可以设置<code class="fe ny nz oa np b">yarn</code>来为我们运行这个命令。</p><p id="d202" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之前，我们在<code class="fe ny nz oa np b">package.json</code>中设置了一个<code class="fe ny nz oa np b">lint</code>脚本，如下所示:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="21e0" class="nt md it np b gy nu nv l nw nx">“scripts”: {<br/>  …<br/>  “lint”: “eslint . —ext .js”,<br/>  …<br/>}</span></pre><p id="4fcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将保持原样，但我们将做一些类似的事情，并在它旁边为我们的格式化程序创建一个名为<code class="fe ny nz oa np b">format</code>的新脚本:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="2e6d" class="nt md it np b gy nu nv l nw nx">“scripts”: {<br/>  …<br/>  “format”: “prettier-eslint —eslint-config-path ./.eslintrc.js --write '**/*.js’”,<br/>  “lint”: “eslint . —ext .js”,<br/>  …<br/>}</span></pre><p id="0ec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那里发生了什么事？我们是:</p><ul class=""><li id="f007" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">添加一个名为<code class="fe ny nz oa np b">format</code>的新脚本，我们可以将其作为<code class="fe ny nz oa np b">yarn format</code>运行。</li><li id="f1ab" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">我们利用我们的<code class="fe ny nz oa np b">prettier-eslint-cli</code>包为我们运行格式化。</li><li id="caf7" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">我们将传递位于项目根目录下<code class="fe ny nz oa np b">package.json</code>旁边的ESLint配置(如果它在不同的位置，请更改它)。</li><li id="2963" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">最后，我们告诉Prettier编写所有匹配<code class="fe ny nz oa np b">**/*.js</code>的文件，或者它在我们的项目中递归找到的任何JS文件。</li></ul><p id="a2d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的美妙之处在于，我们将ESLint配置传递给了更漂亮的。这意味着我们只需要为这两个工具维护一个配置，但是我们仍然利用了ESLint的林挺功能，以及Prettier的格式化功能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="683f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">运行格式化程序</h1><p id="a288" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们都设置好了，让我们运行它！运行以下命令:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="ad6c" class="nt md it np b gy nu nv l nw nx">yarn format</span></pre><p id="bde0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很快，我们看到它起作用了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d0060391d1a9beb0d290bf310c59c6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y0_VsPBSNdqCgM37.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成功运行更漂亮</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6cee" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">嘿，我的代码看起来不一样</h1><p id="bc6e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">正如我前面提到的，漂亮地告诉我们，这是一个固执己见的格式化程序。它有自己的规则，有点像它自己的ESLint配置，所以它也会经历这些变化。</p><p id="851a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要抛弃你的代码！相反，你可以回顾这些变化，看看保持这种方式是否有意义(它将非常一致)，或者你可以更新你的ESLint配置(<code class="fe ny nz oa np b">.eslintrc.js</code>)来覆盖你不喜欢的规则。</p><p id="8bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也是一个很好的方法，也许可以学到一些你以前没有预料到的新东西。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="46a4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">这给我们留下了什么？</h1><p id="7cdb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您已经了解了，我们现在有两个命令:</p><ul class=""><li id="9208" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><code class="fe ny nz oa np b">lint</code>:它会检查你的代码并告诉你哪里出了问题。</li><li id="fadf" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe ny nz oa np b">format</code>:会自动尝试为你修复问题。</li></ul><p id="3a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在实践中使用这些工具时，你最好总是先运行<code class="fe ny nz oa np b">format</code>，让它尝试自动修复任何它能修复的东西，然后立即运行<code class="fe ny nz oa np b">lint</code>，捕捉任何它不能自动修复的东西。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3859" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">下一步是什么？</h1><p id="cc06" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">既然我们可以自动格式化我们的代码，我们应该能够自动修复我们的代码！</p><p id="0fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一次，我们将更进一步，设置一个<code class="fe ny nz oa np b">git</code>钩子，允许它在你提交之前运行，让你不必担心忘记再次运行它！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="77fa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">资源</h1><ul class=""><li id="4a60" class="na nb it lb b lc mu lf mv li oc lm od lq oe lu nf ng nh ni bi translated"><a class="ae ky" href="https://medium.com/better-programming/what-is-linting-66e7876708f3" rel="noopener">https://medium . com/better-programming/what-is-林挺-66e7876708f3 </a></li><li id="459e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://prettier.io/" rel="noopener ugc nofollow" target="_blank">https://prettier.io/</a></li><li id="7d4e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://github.com/prettier/prettier-eslint" rel="noopener ugc nofollow" target="_blank">https://github.com/prettier/prettier-eslint</a></li><li id="b4d2" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://github.com/prettier/prettier-eslint-cli" rel="noopener ugc nofollow" target="_blank">https://github.com/prettier/prettier-eslint-cli</a></li></ul></div></div>    
</body>
</html>