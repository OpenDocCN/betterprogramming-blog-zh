<html>
<head>
<title>Containerizing a Node.js API &amp; Using Docker with Kubernetes and Minikube</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Node.js API容器化&amp;将Docker与Kubernetes和Minikube一起使用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/containerizing-a-node-js-api-using-docker-with-kubernetes-and-minikube-30255fd33ef9?source=collection_archive---------0-----------------------#2018-08-15">https://betterprogramming.pub/containerizing-a-node-js-api-using-docker-with-kubernetes-and-minikube-30255fd33ef9?source=collection_archive---------0-----------------------#2018-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="18c8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Docker封装应用程序，并使用Kubernetes和Minikube在本地提供服务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb7b69f73bb0937b544b6c142818fef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yqz0IMNGday3VfmZCKCEkA.jpeg"/></div></div></figure><p id="8cf6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">作为<a class="ae lq" href="https://getstream.io" rel="noopener ugc nofollow" target="_blank"> Stream </a>的开发者传道者，我有机会了解我们的工程团队和客户每天都在使用的大量令人敬畏的新技术。可以吸收的知识量绝对是惊人的，只要有机会，我就喜欢学习所有的新兴工具和玩具。</p><p id="990d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最近谈论最多的组合之一是<a class="ae lq" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank">码头工人</a>和<a class="ae lq" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank">库伯内特斯</a>。Docker和Kubernetes是一个发电站，它使得开发能够在多种操作系统上运行的快速、不可变的应用程序变得非常容易，而没有处理包管理的所有需求的所有麻烦。Docker将任何给定操作系统的所有需求打包到您的Docker容器中，只需几个Kubernetes命令，您的应用程序就可以提供给用户，并且包括不可变的pods，可以在任何时候用一个Kubernetes命令终止和启动这些pods。</p><p id="31b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我将带你了解我如何用Docker封装一个应用程序，并使用Kubernetes和<a class="ae lq" href="https://kubernetes.io/docs/setup/minikube/" rel="noopener ugc nofollow" target="_blank"> Minikube </a>在本地提供它。最终，你将获得足够的知识去做同样的事情，并有希望通过在Kubernetes的云中启动你自己的应用程序，将它带到一个新的高度。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="47b5" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">要求✔️</h1><p id="0852" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">和任何教程一样，有几个要求可以帮助你走向成功；我们想确保你，读者，能够跟上而不会迷路😉。</p><p id="ac06" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这篇文章最重要的一点是，它是面向macOS用户的。如果您使用的是Windows或Linux，您仍然可以跟着做，但是，我的命令将与您想要使用的命令略有不同。</p><h2 id="129b" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">自制</h2><p id="7ba9" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">如果你的电脑上没有安装家酿软件，你可以使用https://brew.sh/网站上的安装命令来安装。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/5759e58c0c3949df4a0170099726f433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBB3h5KGDRndTjWvds7DBQ.png"/></div></div></figure><h2 id="5340" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第二步:码头工人</h2><p id="f60b" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">要安装Docker，请前往<a class="ae lq" href="https://www.docker.com/get-started" rel="noopener ugc nofollow" target="_blank">入门</a>页面，点击“Mac下载”。您将被重定向到另一个页面，您可能需要先创建一个帐户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/b14b9761c777f28d4da28fff0fbedb62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ii2yCzXyrkgZ7XVz_XJ2w.png"/></div></div></figure><h2 id="bae6" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第三步:迷你库贝</h2><p id="fce0" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">本教程使用Minikube创建一个本地集群。也就是说，让我们安装Minikube:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="6ffb" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第四步:超级工具包</h2><p id="eb90" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">按照<a class="ae lq" href="https://github.com/kubernetes/minikube/blob/master/docs/drivers.md#hyperkit-driver" rel="noopener ugc nofollow" target="_blank"> Minikube驱动程序安装指南</a>所述安装HyperKit驱动程序。您也可以运行以下命令(如果您在macOS上)来安装Hyperkit驱动程序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="9edc" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第五步:Kubernetes CLI</h2><p id="611e" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">使用Homebrew下载kubectl命令行工具，您可以使用它与Kubernetes集群进行交互:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="5704" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">克隆样板Express API💾</h1><p id="72dd" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">现在您已经完成了启动和运行Docker和Kubernetes的步骤，让我们继续下载我整理的样板Express API。您可以使用自己的命令，但是，我建议您首先尝试一下，直到您掌握了我们将要使用的命令。</p><p id="23ac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">前往您想要存储代码的目录。然后继续运行以下命令，将存储库克隆到您的目录中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="b3d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注:如果你想先看看回购，</em> <a class="ae lq" href="https://github.com/nparsons08/boilerplate-express-api" rel="noopener ugc nofollow" target="_blank"> <em class="nk">点击这里</em> </a> <em class="nk">。</em></p><p id="5d8f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，进入目录，构建API并启动它进行测试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="727b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">API会自动打开一个窗口，您应该会看到与此类似的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/e5ea6b996b9a1431a8813394a677d3e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5EIIBHHILosC92qUEMc7A.png"/></div></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="ca04" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">用Docker容器化API📦</h1><p id="1caf" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">我承认，当我第一次看到Docker的时候，我有点害怕。这个概念对我来说没什么意义，命令看起来完全陌生。然而，在阅读和研究了一些文档之后，我开始理解使用Docker的基本原理——你也会理解的。现在，我们要保持事情简单；在以后的文章中，我们将继续前进，让事情更上一层楼😀。</p><p id="f998" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:所有命令都应该在终端中运行。</em></p><h2 id="23a7" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">步骤1:理解Dockerfile文件(目录中已经存在一个模板):</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="a335" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">步骤2:构建Docker映像:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="c0df" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第三步:列出所有Docker图片(验证你的图片是否存在):</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="ce2b" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">步骤4:运行Docker映像:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="6a63" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">步骤5:查看正在运行的API:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="7b74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">繁荣💥！您刚刚使用Docker启动了API！现在让我们把它拆了，因为几分钟后我们将使用Kubernetes和Minikube来启动Docker容器。</p><h2 id="a3c2" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">第六步:拆掉它:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="afaf" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">走进Minikube &amp; Kubernetes的土地👣</h1><p id="678c" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">Minikube是一个让本地运行Kubernetes变得容易的工具。Minikube在笔记本电脑上的虚拟机中运行单节点Kubernetes集群。</p><h2 id="5cc8" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">设置Minikube</h2><p id="f7db" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">通过打开一个新的终端并使用以下命令，确定您是否可以直接访问像<a class="ae lq" href="https://cloud.google.com/container-registry/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/container-registry/</a>这样的网站，而无需代理:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="efc4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:如果这个cURL命令不起作用，请停止并尝试修复问题。如果不能访问外部互联网，Minikube将无法正常启动(对于本教程)。</em></p><p id="b9e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">cURL命令应该会退回一堆HTML，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/1b52926d43ce4d2408239e242a3d9d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrLYxY8L2q8lCNdn_D9LRw.png"/></div></div></figure><p id="0984" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:如果你不能访问谷歌容器注册表，你的连接有问题。在继续下一步之前，您需要对此进行调试。</em></p><p id="ebbf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，确保Docker守护进程已经启动。您可以使用以下命令来确定docker是否正在运行:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:如果命令成功，您应该在终端中看到Docker图像列表。如果你没有，你需要调试为什么Docker没有在你的机器上运行。</em></p><p id="1b36" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在您已经验证了Docker正在运行，我们可以使用以下命令启动Minikube进程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="faba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:</em><strong class="kw iu"><em class="nk">—</em></strong><code class="fe nn no np nq b"><em class="nk"> vm-driver=hyperkit</em></code><em class="nk">标志指定您正在使用macOS的Docker。默认的VM驱动实际上是VirtualBox，但在macOS上首选HyperKit。</em></p><p id="031c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果成功，您的终端看起来将完全像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/873c561f82eb2a01330b4d75a0b69ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2R3vCOt7qaUgezw_aDJgw.png"/></div></div></figure><p id="71ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在设置Minikube上下文。上下文决定了与哪个集群<code class="fe nn no np nq b">kubectl</code>进行交互。我们将使用以下命令来实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="e809" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">验证<code class="fe nn no np nq b">kubectl</code>是否配置为与您的集群通信:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="80fe" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">启动Minikube仪表板</h2><p id="f97c" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated"><em class="nk">注意:Minikube附带了一个仪表盘，您可以直观地看到正在发生的一切！</em></p><p id="8456" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们开始启动仪表板吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/f13a029386bbb55ff9a65fd65e0d8331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WpNqYltxkurfj61ClfFYQ.png"/></div></div></figure><p id="3b28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好吧，你已经走到这一步了。我们继续吧！</p><h2 id="a0c3" class="mv lz it bd ma mw mx dn me my mz dp mi ld na nb mk lh nc nd mm ll ne nf mo ng bi translated">创建Docker图像</h2><p id="607f" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">为了简单起见，让我们继续使用我们在本文前面使用的样板API。</p><p id="6471" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为本教程使用Minikube，而不是将Docker映像推送到注册表，所以您可以使用与Minikube VM相同的Docker主机来构建映像，这样映像就会自动出现。为此，请确保您使用的是Minikube Docker守护程序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="5ac6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们的守护进程已经为Docker设置好了，我们可以继续创建Docker映像。转到我们之前创建的<code class="fe nn no np nq b">/api</code>目录，运行以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="648c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:Minikube虚拟机现在可以运行您构建的映像。</em></p><p id="07d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该命令的输出应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/ac0ec89608ceb7db7d32eb5fb77b9985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L1UM3eTo3pFE0XFUqrCT_w.png"/></div></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e069" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">创建Kubernetes部署💻</h1><p id="10f2" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">Minikube正在运行，我们的Docker映像已经创建，一切进展顺利。让我们快速讨论一下Kubernetes部署的结构。</p><p id="6990" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Kubernetes <a class="ae lq" href="https://kubernetes.io/docs/concepts/workloads/pods/pod/" rel="noopener ugc nofollow" target="_blank"> Pod </a>是一组一个或多个容器，为了管理和联网而连接在一起。本教程中的Pod只有一个容器。Kubernetes <a class="ae lq" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" rel="noopener ugc nofollow" target="_blank">部署</a>检查您的Pod的健康状况，并在它终止时重启Pod的容器。部署是管理pod的创建和扩展的推荐方式。</p><p id="dca5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe nn no np nq b">kubectl run</code>命令创建一个管理Pod的部署。Pod运行一个基于您的<code class="fe nn no np nq b">api:v1</code> Docker映像的容器。将<strong class="kw iu"> — </strong> <code class="fe nn no np nq b">image-pull-policy</code>标志设置为<code class="fe nn no np nq b">Never</code>以始终使用本地图像，而不是从Docker注册表中提取图像(因为您还没有将它推送到那里):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="77a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们可以使用以下命令查看部署:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="d86e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并且，如果您访问您的仪表板(在您的终端中运行命令<code class="fe nn no np nq b">minikube dashboard</code><strong class="kw iu"/>)<strong class="kw iu"/>，您会看到绿色！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/4eb6126190af26dbb44a77cad10f2152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ost7BIFSZHFbThR8no-G6w.png"/></div></div></figure><p id="ce2c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你甚至可以在<a class="ae lq" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>访问API！</p><p id="11fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:当您不想再使用Minikube主机时，您可以通过运行</em> <code class="fe nn no np nq b"><em class="nk">eval $(minikube docker-env -u)</em></code> <em class="nk">来撤销此更改。</em></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="49fb" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">恭喜你！🎉</h1><p id="edf7" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">恭喜你！您刚刚用Docker封装了一个API，启动了Minikube，并在本地机器上将Docker映像部署到Kubernetes。</p><p id="482b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">干得好！在以后的文章中，我们将详细介绍如何封装和运行一个无状态但需要访问外部服务的应用程序，如<a class="ae lq" href="https://getstream.io/try-the-api" rel="noopener ugc nofollow" target="_blank"> Stream </a>、<a class="ae lq" href="https://cloud.mongodb.com" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>、<a class="ae lq" href="https://redis.io" rel="noopener ugc nofollow" target="_blank"> Redis </a>等。</p><p id="32f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在此之前，我推荐以下文章来提高你的技能:</p><ul class=""><li id="0609" class="nr ns it kw b kx ky la lb ld nt lh nu ll nv lp nw nx ny nz bi translated"><a class="ae lq" href="https://docs.docker.com/get-started/" rel="noopener ugc nofollow" target="_blank">Docker入门</a></li><li id="25ef" class="nr ns it kw b kx oa la ob ld oc lh od ll oe lp nw nx ny nz bi translated"><a class="ae lq" href="https://kubernetes.io/docs/tutorials/kubernetes-basics/" rel="noopener ugc nofollow" target="_blank"> Kubernetes基础知识</a></li><li id="f831" class="nr ns it kw b kx oa la ob ld oc lh od ll oe lp nw nx ny nz bi translated"><a class="ae lq" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/" rel="noopener ugc nofollow" target="_blank"> Docker最佳实践</a></li><li id="245d" class="nr ns it kw b kx oa la ob ld oc lh od ll oe lp nw nx ny nz bi translated"><a class="ae lq" href="https://kubernetes.io/docs/concepts/configuration/overview/" rel="noopener ugc nofollow" target="_blank"> Kubernetes最佳实践</a></li></ul><p id="aeba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">编码快乐！</strong>👏</p></div></div>    
</body>
</html>