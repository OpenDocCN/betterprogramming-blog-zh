<html>
<head>
<title>Make Awesome Maps in Python and Geopandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和Geopandas制作出色的地图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/make-awesome-maps-in-python-and-geopandas-c8b3c887b284?source=collection_archive---------5-----------------------#2022-06-15">https://betterprogramming.pub/make-awesome-maps-in-python-and-geopandas-c8b3c887b284?source=collection_archive---------5-----------------------#2022-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0ba9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何用Python和Geopandas制作美丽的choropleth地图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/49c24cd5544edafd3dfd2daacf974409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-SOlvQM4MD2JK8lr"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安妮·斯普拉特在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ef3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，<strong class="lb iu">你将学习如何使用GeoPandas和Matplotlib </strong>用Python制作令人惊叹的地图。地图是一种非常容易理解的数据可视化形式。然而，制作地图的过程并不是最简单的任务。本教程旨在通过指导您使用GeoPandas和Matplotlib来解决这个问题。</p><p id="24d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程结束时，您将学会:</p><ol class=""><li id="cd1c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">如何在GeoPandas中加载和管理shapefiles</li><li id="a120" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何用Python创建漂亮的choropleth地图</li><li id="8e47" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用GeoPandas和Matplotlib自定义地图</li></ol><p id="2a20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><h1 id="d2b5" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">GeoPandas是如何工作的？</h1><p id="7d12" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">GeoPandas结合了Pandas使用数据框架的强大功能和Shapely处理几何数据的强大功能。这允许您使用Pandas熟悉的语法，同时扩展其功能来创建漂亮的地图。</p><p id="68f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将创建下面的地图。首先，你可以从美国人口普查网站下载体形文件。下载州形状(较低的分辨率，如20m就可以了)。解压缩文件，并将其放入脚本旁边的文件夹中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6df67ad2625b0b91a1049e56b423343d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HkdGG6SP-odfKyNl2evxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您将在本教程中创建的地图。资料来源:Nik Piepenbreier</p></figure><p id="fce9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始创建地图吧！</p><h1 id="8eb3" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">将ShapeFile加载到GeoPandas数据帧中</h1><p id="0146" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">您可以使用以下代码加载Geopandas数据帧:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj mk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正在加载我们的GeoPandas数据帧</p></figure><p id="5e0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，通过将数据加载到GeoPandas数据帧中，它非常类似于普通的Pandas数据帧。最棒的是，我们实际上可以使用熊猫的不同功能和方法。</p><p id="537f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们加载我们的人口数据，以便进行分析。我们将把它加载到一个熊猫数据框架中，并进行一些计算。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj mk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加载和清除群体数据</p></figure><p id="9bb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们加载了数据帧<code class="fe nk nl nm nn b">df</code>并对其进行了一些清理。因为数据是作为字符串加载的，所以我们首先删除所有逗号并转换值。然后，我们计算两年之间的百分比变化。</p><p id="bf9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们的数据集已经准备好了，让我们创建我们的最终数据集！</p><h1 id="f24a" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">创建我们的最终数据集</h1><p id="24ab" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">因为GeoPandas数据帧可以访问底层数据帧，所以我们现在可以合并两个数据集。我们要合并到我们的形状数据帧中，并做一些最后的清理:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj mk l"/></div></figure><p id="bb30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们合并了两个数据集。然后我们删除它们之间任何缺失的值。最后，我们过滤掉非美国大陆的州和地区，以放大我们的地图。</p><p id="84a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以使用以下代码绘制地图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj mk l"/></div></figure><p id="ab98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们创建了一个<code class="fe nk nl nm nn b">ax</code>对象，这是一个<code class="fe nk nl nm nn b">shape.boundary</code>样式的绘图。然后我们在坐标轴上绘制人口变化图。这将返回以下可视化结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/5b0156f0fb4c72b54b0eb24f33b5e103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dz235-4mAp0HudD_t_ZuRg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用GeoPandas加载我们的第一张地图！资料来源:Nik Piepenbreier</p></figure><p id="69e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经做了很多。让我们进一步定制我们的图像，使它看起来更好，信息更丰富！</p><h1 id="ce03" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">使用Python定制我们的地图</h1><p id="f2ec" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们可以通过更改配色方案、移除边框、添加标题等方式进一步定制地图。这将使可视化更加清晰，信息量也更大。</p><p id="b67a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何进行一些定制:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj mk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">进一步定制我们的地图</p></figure><p id="7d68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们进行了以下定制:</p><ul class=""><li id="de71" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu no mb mc md bi translated">我们将<code class="fe nk nl nm nn b">.plot()</code>函数调用改为使用线宽更小的黑线</li><li id="4a21" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">我们更改数据的颜色映射，并传入一些图例关键字</li><li id="6275" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">我们关掉了轴和脊椎</li><li id="893c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">我们设置了一个标题，使我们的情节更具描述性</li></ul><p id="79d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些更改会返回以下图像:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6df67ad2625b0b91a1049e56b423343d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HkdGG6SP-odfKyNl2evxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含所有自定义内容的最终地图。资料来源:Nik Piepenbreier</p></figure><h1 id="4be6" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">结论</h1><p id="a686" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在本教程中，您学习了如何使用GeoPandas在Python中创建漂亮的choropleth地图！因为GeoPandas使用Pandas数据框架，所以您可以使用熟悉的代码来分析和组合数据。</p><p id="5824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望本教程能让你对如何在Python中使用地图更感兴趣。地图是一种令人难以置信的数据可视化工具，容易被许多受众理解！</p></div></div>    
</body>
</html>