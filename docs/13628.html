<html>
<head>
<title>Exploring ERC20 Fungible Token Standard in Solidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索ERC20可替换令牌标准的可靠性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-erc20-fungible-token-standard-in-solidity-d3a9936a6a63?source=collection_archive---------23-----------------------#2022-09-12">https://betterprogramming.pub/exploring-erc20-fungible-token-standard-in-solidity-d3a9936a6a63?source=collection_archive---------23-----------------------#2022-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="619e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">满足EVM链代币的黄金标准</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7804674afebcb28d0089c81cf0b809c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f1eRnMjELSndh-nDIPGGdA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@moneyphotos" rel="noopener ugc nofollow" target="_blank"> regularguy.eth </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="8f3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这次让我们来谈谈可替换令牌，它是DeFi中的主要构件之一。这些代币可以代表硬币、黄金、谷物和其他可以兑换的资产。我们将研究第20号以太坊改进提案中的一个。这个令牌标准被广泛称为ERC20，它描述了智能合约中令牌的接口。该ERC20标准定义了令牌转移、批准支出、创建等功能。</p><p id="c99c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了用代码说明ERC20标准，我们将使用<a class="ae ky" href="https://docs.openzeppelin.com/contracts/4.x/erc20" rel="noopener ugc nofollow" target="_blank">openzeplin ERC 20</a>实现。</p><h1 id="1b8f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">铸造和燃烧</h1><p id="9448" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">total token供应有两个主要动作。我们可以用薄荷或者烧了它们。铸造意味着创造更多的供给，而燃烧意味着一旦我们需要就减少供给。</p><h1 id="2a73" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">铸造</h1><p id="7db8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了创造代币供应，我们需要铸造这个数量。当我们在后台铸造时，调用这个函数的后台调用者接收提供的令牌数量。</p><p id="0575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个充当ERC20令牌的智能合约。在构造函数中，我们需要提供总的令牌供应并调用OpenZepplin的<code class="fe ms mt mu mv b">ERC20</code>实现构造函数，提供令牌名称和符号。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="d38a" class="na lw it mv b gy nb nc l nd ne">contract FungibleToken is ERC20 {<br/>  constructor(uint256 totalSupply) ERC20("MyBestToken", "BTKN") {<br/>    _mint(msg.sender, totalSupply);<br/>  }</span></pre><p id="a53f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们想要部署这个契约时，我们应该提供<code class="fe ms mt mu mv b">totalSupply</code>。我想提一下，我们用的是<a class="ae ky" href="https://remix-project.org/" rel="noopener ugc nofollow" target="_blank"> Remix开发IDE </a>。要使用像<a class="ae ky" href="https://www.alchemy.com/" rel="noopener ugc nofollow" target="_blank"> Alchemy </a>或<a class="ae ky" href="https://www.quicknode.com/" rel="noopener ugc nofollow" target="_blank"> Quicknode </a>、<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-your-own-nft-smart-contract-tutorial-1b90978bd7a3">这样的RPC端点来部署这个契约，您可以阅读本文</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/f38ff46bcbede223aaf8801c74057261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QRLtU9k2yRpQSTLf.png"/></div></div></figure><p id="97f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要，我们可以通过铸造更多的代币来发行更多的代币。</p><h1 id="2434" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">燃烧的</h1><p id="8819" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当我们需要降低流通中可用代币的总价值时，我们可以烧掉它们。令牌燃烧意味着我们向零地址<code class="fe ms mt mu mv b">0x0000000000000000000000000000000000000000</code>发送特定数量的令牌，它将被永久锁定，因为没有人可以访问该地址。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="b1bf" class="na lw it mv b gy nb nc l nd ne">function burn(uint256 burnAmount) external {<br/>    _burn(msg.sender, burnAmount);<br/>  }</span></pre><p id="a80c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要烧掉代币，我们需要传递铸造代币的地址和我们想要烧掉的数量。</p><h1 id="7a56" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">效用函数</h1><p id="8d4d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">ERC20标准中的几个实用函数帮助我们找到令牌信息和余额。</p><h1 id="7a01" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">令牌信息</h1><p id="a3e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦智能合约部署到链上，任何人都可以看到名称、符号和小数。唯一需要的是令牌智能合约地址。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/a6140cb13f768ce3e2efda4554b16d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9jylU_L-0Ci7xDEe.png"/></div></div></figure><h1 id="ba5d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">平衡</h1><p id="e0b2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">本质上，ERC20标准保存了地址的映射和它所拥有的数量。这意味着在任何给定的时间，我们可以要求平衡的具体地址。它是公开可见和可访问的。当然我们不知道这个地址后面是谁，也不能改变金额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6917719913ced028fa4955f0c9eeaf84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fUKKM_wT8FZNbrfB.png"/></div></div></figure><p id="5a71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在幕后，ERC20 OpenZepplin标准在一个映射中保持平衡，其中键是一个地址，值是<code class="fe ms mt mu mv b">uint256</code>。一点魔法都没有。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="d952" class="na lw it mv b gy nb nc l nd ne">mapping(address =&gt; uint256) private _balances;</span></pre><h1 id="c107" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">转移</h1><p id="02fc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当我告诉你我们不能改变一个地址持有的令牌数量时，我撒了一点谎。我们可以将令牌转移到某个地址，或者授予某个地址的转移权限。转让权意味着我们给予另一个地址代表我们花费一定数量代币的权利。</p><h1 id="ad48" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">转移代币</h1><p id="2907" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦我们持有一定数量的ERC20代币，我们就可以将不超过总数的代币发送到任何地址。这也包括零地址<code class="fe ms mt mu mv b">0x0000000000000000000000000000000000000000</code>，从技术上来说，这意味着燃烧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6ff0d20bbcd4fee02074784695dbd17f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UdS2eiBtnzlA_GW5.png"/></div></div></figure><p id="7f21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在ERC20实现中，描述了一旦我们转移令牌，我们发送的金额将从我们的余额中扣除，并根据我们发送到的地址增加。它检查我们是否有足够的代币来转移，以及我们是否没有超出我们的余额。请记住，我们一直在处理象征性的资产负债表。</p><h1 id="06c1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">代表转让代币</h1><p id="42f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">将转让权交给其他人听起来可能很复杂，但它在DeFi中被广泛使用，我们提供以太坊智能合约权来操作我们的令牌。例如，智能合约掉期令牌将它们放入流动性池，或者我们希望获得一笔贷款，为我们的令牌提供抵押品。</p><p id="be82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要给一个地址的权利，并提供它可以操作的最大数量。ERC20实施还将检查我们是否没有超出可用令牌，并在内部映射中保留令牌允许量。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="d6d4" class="na lw it mv b gy nb nc l nd ne">mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span></pre><p id="9971" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个映射密钥是令牌持有者的地址。然后，值是另一个映射，其中关键是支出者地址和允许支出的金额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/abc246f4fe2c484ca070dca3c9c24db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9yNPAnbP6y7deMvT.png"/></div></div></figure><p id="ebca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给予消费权后，我们可以减少或增加给花钱者的津贴。</p><p id="b23d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，消费者可以将我们保留的代币金额发送到任何其他地址，只要提供代币持有者地址、发送地址和要转移的代币金额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/961966faeee89e3f0476f4b3e6a11db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KeBoeWUDkaPLR1SJ.png"/></div></div></figure><p id="ea88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在ERC20标准的实施中，津贴和余额也相应地发生了变化。所提供的代币金额将减少消费方津贴，并且接收方的余额将增加。</p><h1 id="6330" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="be77" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">ERC20是以太坊改进提案中的首批标准之一。它描述了一个智能契约，其中包含可替换的令牌余额和地址间的转移。它还谈到了额外的功能，如允许代表代币持有者消费。这是EVM链条上代币的黄金标准。</p><h1 id="1b13" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">链接</h1><ul class=""><li id="a12e" class="nl nm it lb b lc mn lf mo li nn lm no lq np lu nq nr ns nt bi translated"><a class="ae ky" href="https://gist.github.com/fassko/9a25b7249394cf20625d705364ff469b" rel="noopener ugc nofollow" target="_blank">样本代码</a></li><li id="a998" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://eips.ethereum.org/EIPS/eip-20" rel="noopener ugc nofollow" target="_blank"> EIP-20:令牌标准</a></li><li id="9f30" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://ethereum.org/en/developers/docs/standards/tokens/erc-20/" rel="noopener ugc nofollow" target="_blank"> ERC-20 —以太坊文档</a></li><li id="b5d5" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://www.investopedia.com/news/what-erc20-and-what-does-it-mean-ethereum/" rel="noopener ugc nofollow" target="_blank"> ERC-20由Investopedia </a></li><li id="f467" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://docs.openzeppelin.com/contracts/4.x/erc20" rel="noopener ugc nofollow" target="_blank">ERC 20—openzeplin文档</a></li><li id="2f98" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/ERC20.sol" rel="noopener ugc nofollow" target="_blank">ERC 20—openzeplin实现</a></li><li id="cb42" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://github.com/solidstate-network/solidstate-solidity/blob/master/contracts/token/ERC20/SolidStateERC20.sol" rel="noopener ugc nofollow" target="_blank"> SolidState ERC20实施</a></li></ul></div></div>    
</body>
</html>