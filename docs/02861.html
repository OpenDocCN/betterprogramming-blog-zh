<html>
<head>
<title>Configure and Run a Docker Container for Redis and Use it for Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Redis配置并运行Docker容器，并将其用于Python</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/dockerizing-and-pythonizing-redis-41b1340979de?source=collection_archive---------1-----------------------#2020-01-06">https://betterprogramming.pub/dockerizing-and-pythonizing-redis-41b1340979de?source=collection_archive---------1-----------------------#2020-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3358" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">容器化您的Python项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c3cf626bfd49c9af686cbce69df66591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*al_UA5P19_0aB_ogyeVVkg.jpeg"/></div></figure><p id="7e3f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你已经做了一段时间的程序员，你可能已经感觉到你的系统需要某种缓存机制。这就是Redis缓存发挥作用的地方。</p><p id="d578" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Redis是内存中的键值数据存储，是最流行的缓存工具之一。</p><p id="9b6d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在本文中，我们将从使用<a class="ae lm" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>进行设置，到使用<a class="ae lm" href="http://python.org" rel="noopener ugc nofollow" target="_blank"> Python </a>使用Redis。本文可分为以下三个部分:</p><ol class=""><li id="e61f" class="ln lo it ks b kt ku kw kx kz lp ld lq lh lr ll ls lt lu lv bi translated">为Redis设置Docker容器。</li><li id="46ae" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll ls lt lu lv bi translated">使用一些基本命令在Redis命令行上进行试验。</li><li id="e74a" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll ls lt lu lv bi translated">用Python代码集成Redis。</li></ol><p id="5c7f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们一个一个地检查一下。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="0bfd" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">1.为Redis设置Docker容器</h1><p id="64b9" class="pw-post-body-paragraph kq kr it ks b kt na ju kv kw nb jx ky kz nc lb lc ld nd lf lg lh ne lj lk ll im bi translated">首先，我们需要为此创建一个目录和<code class="fe nf ng nh ni b">docker-compose.yml</code>文件。</p><p id="48db" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们首先创建目录:</p><pre class="kj kk kl km gt nj ni nk nl aw nm bi"><span id="9c38" class="nn mj it ni b gy no np l nq nr">mkdir redis-docker<br/>cd redis-docker</span></pre><p id="8b87" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">此外，让我们添加一个自定义配置文件，我们将用于Redis容器。首先，在<code class="fe nf ng nh ni b">redis-docker</code>中创建一个名为<code class="fe nf ng nh ni b">config</code>的目录，然后添加一个名为<code class="fe nf ng nh ni b">redis.conf</code>的文件。这个文件的内容可以在GitHub 上找到<a class="ae lm" href="https://github.com/ashutoshkarna03/redis-docker-python/blob/master/config/redis.conf" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="24e2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">该文件中值得注意的一点是，我们需要将bind设为<code class="fe nf ng nh ni b">bind 0.0.0.0</code>，否则您将无法在本地使用Redis，只能在Docker环境中使用。</p><p id="61e3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，让我们再次回到<code class="fe nf ng nh ni b">redis-docker</code>目录，在这里创建包含以下内容的<code class="fe nf ng nh ni b">docker-compose.yml</code>文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4ab6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在上面的文件中，我们使用了最新的Redis映像，并在端口6379向外界公开了Redis容器的端口6379。卷指定将<code class="fe nf ng nh ni b">conf</code>目录的<code class="fe nf ng nh ni b">redis.conf</code>文件映射到容器的<code class="fe nf ng nh ni b">redis.conf</code>。</p><p id="b083" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这可以通过使用我们指定的命令来加载和使用。<br/>现在，我们已经做好了如下运行的准备:</p><p id="2ac7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe nf ng nh ni b">docker-compose up -d</code></p><p id="f6ab" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一旦Redis容器启动，我们可以用<code class="fe nf ng nh ni b">docker-compose ps</code>来验证这一点，它应该显示如下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gh gi nu"><img src="../Images/752f32374f3577964c973775be43cc3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z853ySKVceURlWRggoR1Fg.png"/></div></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="c073" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">2.使用一些基本命令在Redis命令行上进行试验</h1><p id="da6b" class="pw-post-body-paragraph kq kr it ks b kt na ju kv kw nb jx ky kz nc lb lc ld nd lf lg lh ne lj lk ll im bi translated">让我们连接到redis容器的redis-cli并使用它。要连接到redis-cli，我们必须使用以下命令:</p><pre class="kj kk kl km gt nj ni nk nl aw nm bi"><span id="c46a" class="nn mj it ni b gy no np l nq nr">docker exec -it redis-docker_redis_1 redis-cli</span></pre><p id="f3c5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">注意:<code class="fe nf ng nh ni b">redis-docker_redis_1</code>是这里的容器名，你也可以自己选择。默认情况下，redis-cli将主机作为本地主机，端口作为6379。</p><p id="cca1" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这将把我们连接到redis-cli，我们可以用返回<code class="fe nf ng nh ni b">PONG</code>的<code class="fe nf ng nh ni b">ping</code>命令测试连接。如果是，那么您的设置是成功的。现在，我们可以尝试更多的命令，如:</p><pre class="kj kk kl km gt nj ni nk nl aw nm bi"><span id="3153" class="nn mj it ni b gy no np l nq nr">127.0.0.1:6379&gt; SET hello world<br/>OK</span></pre><p id="ecab" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这将把值<code class="fe nf ng nh ni b">world</code>设置为键<code class="fe nf ng nh ni b">hello</code>。我们可以用下面的命令获得这个键的值:</p><pre class="kj kk kl km gt nj ni nk nl aw nm bi"><span id="44c3" class="nn mj it ni b gy no np l nq nr">127.0.0.1:6379&gt; GET hello <br/>"world"</span></pre><p id="ddc9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Redis最酷的GUI工具之一是redis-commander。您可以使用命令<code class="fe nf ng nh ni b">exit</code>从redis-cli注销。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="6f4f" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated"><strong class="ak"> 3。将Redis与Python代码集成</strong></h1><p id="5760" class="pw-post-body-paragraph kq kr it ks b kt na ju kv kw nb jx ky kz nc lb lc ld nd lf lg lh ne lj lk ll im bi translated">让我们快速浏览一下如何在Python代码中使用Redis。</p><p id="2c13" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们可以使用名为<code class="fe nf ng nh ni b">redis</code>的Python库，它充当Redis到Python的驱动程序。我们可以使用<code class="fe nf ng nh ni b">pip install redis</code>很容易地安装它。</p><p id="17be" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们创建一个名为<code class="fe nf ng nh ni b">py_redis.py</code>的文件，并将以下内容添加到其中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="024e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我将添加更多Redis库支持的命令示例。</p><ul class=""><li id="12a5" class="ln lo it ks b kt ku kw kx kz lp ld lq lh lr ll nz lt lu lv bi translated">GitHub 上有完整版本<a class="ae lm" href="https://github.com/ashutoshkarna03/redis-docker-python/blob/master/py_redis.py" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="d195" class="ln lo it ks b kt lw kw lx kz ly ld lz lh ma ll nz lt lu lv bi translated">本教程的全部代码可在GitHub 上<a class="ae lm" href="https://github.com/ashutoshkarna03/redis-docker-python" rel="noopener ugc nofollow" target="_blank">获得。</a></li></ul><p id="b6f1" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">感谢阅读。随时欢迎评论和建议。</p></div></div>    
</body>
</html>