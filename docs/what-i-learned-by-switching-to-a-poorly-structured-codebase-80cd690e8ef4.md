# 通过切换到一个结构不良的代码库，我学到了什么

> 原文：<https://betterprogramming.pub/what-i-learned-by-switching-to-a-poorly-structured-codebase-80cd690e8ef4>

## 以及我希望所有开发人员遵循的东西

![](img/86125f99ba0ea259b858efb1d69e361d.png)

图片来源: [Freepik](https://www.freepik.com/)

你也讨厌写得不好的代码吗？嗯，我真的想。我和许多初级和高级开发人员一起工作过，他们只是写代码来完成工作。他们对编写干净、可读、结构合理的代码没有任何热情。

当你为一个组织编写代码时，写得好的代码变得更加重要。如果你在一个项目中工作，后来因为某种原因离开了组织，那么你写的糟糕的代码对于后来加入这个项目的开发人员来说可能会成为一件痛苦的事情。

我目前也在经历类似的情况。该组织要求我接管一个正在进行的项目，这让我很难理解代码库，因为它的结构很差。该项目的业务逻辑对我来说显然是新的，需要一些时间来清理，但难以消化的代码使它成为一个艰巨的旅程。

以下是我从一个结构不良的项目中学到的一些东西，前一个团队可以遵循的东西，以及我真正希望开发人员在编写代码时遵循的东西。

# 文件命名约定

遵循命名文件的约定是正确设置项目的一个重要方面。开发人员应该使用单一的约定来命名代码库的所有文件。

对一些文件使用骆驼箱，对其他文件使用烤肉串箱并不是一个好主意。选择一个你想用的案例并坚持下去。

如果你正在构建一个 React 应用程序，那么你应该对你的组件使用 Pascal Case，对其他文件使用 Camel Case 或 Kebab case。如果你正在开发一个 NodeJS 应用程序，你可能应该使用 Kebab 案例。

```
Pascal Case: HiThere
Camel Case:  hiThere
Kebab Case:  hi-there
```

无论您选择什么，请确保在整个应用程序中使用相同的约定。遵循这种方法实际上会使代码库看起来更干净。

# 文件夹结构

您遵循了正确的文件命名约定，现在呢？将文件放在正确的位置也是必需的。

把太多的文件放在一个文件夹里是非常不好的，用两个文件夹来分开两个文件也不好。我刚刚接手的项目的一个子项目在一个文件夹中有 60 多个文件(React 组件)。项目所需的几乎 90%的组件都放在一个文件夹中。

它不是一个好方法的原因之一是它使得项目更难维护，并且对于项目新手来说很难理解正在发生什么。如果我想快速找到一个组件，我必须滚动浏览 60 个文件。我可以使用 IDE 的快捷方式，但还是不太容易。

不要把太多的文件放在一个文件夹里，试着把它们分成属于同一类别的子文件夹。例如，与客户相关的组件可以位于一个子文件夹中。

```
src
└── components
     └── customers
           ─ customer related components
     └── orders
           ─ order related components
     └── reports
           ─ reports related components
```

现在，当您需要更新代码库中与客户相关的内容时，您知道在哪里可以找到您的组件。

# 写评论

确保你创建的所有东西的功能都有很好的文档记录。注释是描述代码功能的最佳方式之一。如果我必须为项目更新/添加一个特性，我需要阅读编写的每一行代码来理解逻辑，因为没有编写注释。

> 代码被读的次数比它被写的次数多

因此，编写注释不仅会使代码维护更容易，而且还会帮助您更快地发现错误，并记住良好记录的代码与正确工作的代码同样重要。

# 换行符和缩进

没有人喜欢阅读或理解一些胡言乱语。格式化代码使它更容易被人类阅读。您必须使用适当的:

*   行距
*   缩排
*   运算符周围的间距

这些是编写可读的干净代码的关键原则。对应用程序中的所有文件使用固定的标签大小(通常是两个)。理解格式不良的代码比理解格式正确的代码要困难得多。

下面是一个格式不佳的代码示例；它可能不是很难阅读，因为它只包含了 5 行，但是如果它是一个包含大量函数的 2000 行文件，那就很难了。

```
// poorly formatted code, harder to read
function foo(){const a=1;
const b=1;
const c=a*b*100/2;
return c;}
foo(); // returns 50
```

由于糟糕的代码格式让我很难理解其中的逻辑，我使用了[更漂亮的 CLI](https://prettier.io/) 一次性格式化项目的所有文件，包括 JavaScript、SASS、JSON、Markdown、YAML 和 CSS 文件。

```
// well-formatted, easier to understand
function foo(){
  const a = 1;
  const b = 1;
  const c = (a * b * 100) / 2;

  return c;
}foo(); // returns 50
```

此外，如果一行中的内容占用了太多空间，可以考虑添加换行符以提高可读性。

```
foo(longOne, anotherLongOne, longer, longerAmongAllOfThem, oneMore);// add line breaks
foo(
  longOne,
  anotherLongOne,
  longer,
  longerAmongAllOfThem,
  oneMore
);
```

有时，手动进行这种格式化不是很有效。所以，你应该在你的 IDE 中使用像[这样的代码格式化程序。当开发人员不能使用更漂亮的代码时，如果他们自己不能编写干净和适当缩进的代码，这真的让我很生气。](https://prettier.io/)

# 冗长的组件

困扰我做这个项目的原因之一是冗长的代码文件(基本上是 React 组件)。有的是 2000+线。有这么多行的组件必须分成几个组件。

在单个文件中编写太多代码会导致以下问题:

*   使得逻辑更难理解
*   在不同的作用域中使用相同的变量名会产生歧义
*   增加了复杂性，使调试更加困难

一般来说，你写的每个单元(一个类，一个函数)应该只关注一件事。尽量保持你的单位小。

# 我们的动力

此外，每种编程语言都有风格指南。坚持一个方针，并保持一致。为变量命名时，避免歧义，使用能清楚表达变量或函数的名称。

这些都是小事情，在你写代码的时候不需要太多的努力，但是这些小事情显著地提高了理解代码库的能力，并且使代码库结构良好，更加整洁。

如果之前在这个项目中工作的团队遵循了这些指导方针，我会更容易顺利快速地接管这个项目。

我已经分享了我在一个结构不良的项目中工作的故事。我必须做大量的重构工作，以便在保持相同功能的同时，使项目保持良好的状态。说得轻松一点，当你只是重构东西而不是构建新东西时，客户通常会抓狂。他们会说，“我没看到什么新东西，你在做什么？”

在没有编写干净代码的开发人员的世界里，成为那些热情地编写干净代码的人之一。在评论中等待你的体验。