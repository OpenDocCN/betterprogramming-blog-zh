<html>
<head>
<title>Train a Core ML Dog Breed Classifier With Turi Create</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Turi Create训练核心ML犬种分类器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/train-a-core-ml-dog-breed-classifier-with-turi-create-2624f9272d22?source=collection_archive---------0-----------------------#2019-01-17">https://betterprogramming.pub/train-a-core-ml-dog-breed-classifier-with-turi-create-2624f9272d22?source=collection_archive---------0-----------------------#2019-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dfcf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Turi Create训练犬种分类模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c51de02cf7fe706bf6404b8d808116df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwijKPq06BeRriP7Xf1faA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/search/photos/dog?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@reskp?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Jametlene Reskp </a>拍摄的照片</p></figure><p id="f144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，您将学习如何训练一个定制的狗品种分类核心ML模型，以便在您的iOS和macOS应用程序中使用。本教程结束时，你的核心ML模型将能够区分五种不同的品种！</p><p id="d2bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能还记得，苹果几年前以超过2亿美元的价格收购了机器学习和人工智能初创公司<a class="ae ky" href="https://turi.com/products/application-lifecycle.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">【Turi】</em></a><em class="lv"/>。它提供了在短时间内创建高级机器学习模型的强大工具。</p><p id="f8cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，您将学习:</p><ul class=""><li id="2987" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">在Mac上安装Turi Create</li><li id="be2a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">创建一个<a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>脚本</li><li id="6357" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">使用该脚本来训练一个<a class="ae ky" href="https://developer.apple.com/documentation/coreml" rel="noopener ugc nofollow" target="_blank"> Core ML </a>模型，您可以将其直接拖到您的Xcode项目中，并在您的应用程序中快速实现它。</li></ul></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="14eb" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">入门指南</h1><p id="8a45" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在我们开始实际的机器学习部分之前，让我们先了解一下Turi和Python的安装。当然，首先你需要确保你的硬件和软件符合Turi的要求。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="81c3" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">要求</h1><p id="3dad" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">和你安装的任何软件一样，Turi Create有一些特定的要求，这些要求可以在他们的官方GitHub页面上找到。</p><h2 id="8cc2" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated"><strong class="ak"> Turi创建支持:</strong></h2><ul class=""><li id="595c" class="lw lx it lb b lc nj lf nk li oa lm ob lq oc lu mb mc md me bi translated">macOS 10.12以上</li><li id="acd0" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">Linux(使用glibc 2.12+)</li><li id="9b4a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">Windows 10(通过WSL)</li></ul><h2 id="24c0" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated"><strong class="ak"> Turi创建要求:</strong></h2><ul class=""><li id="08c6" class="lw lx it lb b lc nj lf nk li oa lm ob lq oc lu mb mc md me bi translated">Python 2.7、3.5、3.6</li><li id="99de" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">x86_64架构</li><li id="79c1" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">至少4 GB内存</li></ul><p id="f324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">底线是，只要你的Mac是相当新的T21，你应该可以运行Turi Create。如果你愿意，你可以使用另一个操作系统；但是，您可能需要修改一些步骤才能让它们工作。</p><h2 id="9dcc" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">装置</h2><p id="4f8a" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">安装Turi Create相当简单，尤其是如果你熟悉命令行的话。虽然您可以选择使用较新版本的Python，但在本教程中我将使用Python 2.7。</p><p id="88da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在macOS Mojave中，Python 2.7是默认安装的，所以你需要做的就是检查版本。在你的Mac上，打开<strong class="lb iu">应用&gt;实用程序&gt;终端</strong>，或者用键盘快捷键<strong class="lb iu">命令空间</strong>简单搜索。</p><p id="7c9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要检查Mac上的Python版本，请输入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="2ed7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将告诉您Python的版本，您的控制台应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/bfd2f1e41da78e7dd02a3211ebadeaf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNhBi4nKLlR1WYPxW-WfTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd og">图1: </strong>检查Python版本</p></figure><p id="23db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的版本不是Python 2.7，或者由于某种原因没有安装在你的电脑上，你应该在这个链接安装<a class="ae ky" href="https://www.python.org/downloads/release/python-2714/" rel="noopener ugc nofollow" target="_blank">。如果您的输出看起来与我的相似，您就可以继续了。</a></p><p id="7453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注:</strong>有些人更喜欢用虚拟机来安装Turi Create，因为这是苹果推荐的。但是为了简单起见，我们将直接安装它。</p><p id="c4ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装Turi Create，只需在您的终端窗口中输入以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="1b30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅此而已！Turi Create已成功安装在您的Mac上，可以使用了。现在，您可以构建分类、检测、回归和其他类型的模型。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="2c3b" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">资料组</h1><p id="6f8b" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">对于任何机器学习模型，你都需要一个数据集。在本教程中，你将学习如何训练一个简单的狗品种分类模型，这需要图像分类。我将使用的数据来自斯坦福大学的狗数据集。</p><p id="ac89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了让Turi能够识别预先分类的图像，你需要根据它们所代表的内容来组织它们。例如，所有金毛猎犬的图片都在一个文件夹中，而所有拉布拉多犬的图片都在另一个文件夹中。</p><p id="7902" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单起见，我们将只使用斯坦福大学数据集中数百个品种中的五个，但是你可以随意使用。我已经开始为您组织它，并为它创建了一个<a class="ae ky" href="https://github.com/vhanagwal/dog-breed-dataset" rel="noopener ugc nofollow" target="_blank">存储库</a>。如果您选择添加更多的狗品种，只需添加更多的文件夹，并根据您的意愿命名。</p><h2 id="cb33" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">文件夹结构</h2><p id="4cab" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">到目前为止，您可能已经明白了排列数据集的方式对于正确训练模型至关重要——除此之外，Turi Create没有其他方法可以知道什么东西去了哪里。现在花点时间整理一下自己。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/fc111872bc746376a2216610dae6e3bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yedgbM1uC63FcNijGNlemw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd og">图2: </strong>起始文件夹结构</p></figure><p id="f068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个层次图应该解释了所有的事情，在继续学习本教程之前，你需要按照这个顺序放置你的文件夹。如果你想改变名字或安排不同的事情，你需要确保你记下这一点。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ecb1" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">训练分类器</h1><p id="4d3a" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">完成设置后，您就可以开始学习本教程的内容了——实际上是训练您的分类器。我们将主要使用Python，但是如果你以前从未使用过Python，那也没关系。我会在我们进行的过程中解释每一步，如果您有任何问题，请不要犹豫，在下面留下您的评论。</p><h2 id="48af" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">Python文件</h2><p id="fb31" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">首先，我们需要一个地方来放下我们的想法(当然，是用Python)。如果您已经有了一个支持Python的编辑器，比如<a class="ae ky" href="https://atom.io" rel="noopener ugc nofollow" target="_blank"> Atom </a>，或者一个集成开发环境，比如<a class="ae ky" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> PyCharm </a>，那么您可以使用它们来创建一个名为<code class="fe oh oi oj ok b">dog_breeds.py</code>的空白文件。</p><p id="8d3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您像我一样喜欢开发人员路线，您可以使用终端来做同样的事情。你需要在你的<code class="fe oh oi oj ok b">ml_classifier</code>文件夹中创建这个文件，在<code class="fe oh oi oj ok b">images</code>文件夹旁边，这样你的层次结构看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/4bf50d8f38e9f921afb76aa4b2709b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7N39UZARPbF0Jedpm1k8Iw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd og">图3:</strong>Python文件的文件夹结构</p></figure><p id="5275" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建一个新文件，首先进入目标目录:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="412f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建一个名为<code class="fe oh oi oj ok b">dog_breeds.py</code>的新文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="e4c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。您的文件夹、文件和图像都在它们需要的地方，您已经准备好继续下一步。我们将使用<a class="ae ky" href="https://developer.apple.com/xcode/" rel="noopener ugc nofollow" target="_blank"> Xcode </a>来打开我们的文件，所以请确保您已经安装了Xcode并且是最新的。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="e615" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">加载数据集图像</h1><p id="6c66" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">最后，是时候开始通过我们刚刚创建的Python文件告诉Turi它需要做什么了。如果你双击这个文件，默认情况下它会在Xcode中打开，如果你安装了Xcode的话。如果没有，您也可以使用另一个编辑器或Python IDE。</p><h2 id="687e" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">1.导入框架</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="4cf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在文件的顶部，您需要导入Turi Create框架。如果你愿意，你可以通过添加<code class="fe oh oi oj ok b">as &lt;your name&gt;</code>来创建一个名字作为参考。例如，如果您想在代码中将其称为<code class="fe oh oi oj ok b">tc</code>，您可以这样写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="d30d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将允许你调用它<code class="fe oh oi oj ok b">tc</code>而不是写出<code class="fe oh oi oj ok b">turicreate</code>。在本教程中，我将使用完整版，称之为<code class="fe oh oi oj ok b">turicreate</code>以减少歧义。</p><p id="0b86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还需要处理文件夹名称和其他与操作系统相关的任务，以便对图像进行分类。这将需要另一个名为<code class="fe oh oi oj ok b">os</code>的Python库。要导入它，只需添加以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="16ae" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">2.加载图像</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="b27e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们将数据集中的所有图像存储到一个名为<code class="fe oh oi oj ok b">data</code>的变量中。由于我们的<code class="fe oh oi oj ok b">dog_breeds.py</code>文件与<code class="fe oh oi oj ok b">images</code>文件夹在同一个目录中，我们可以简单地将<code class="fe oh oi oj ok b">“images/”</code>作为路径。</p><h2 id="a4c0" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">3.定义标签</h2><p id="6675" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">现在Turi Create已经有了你所有的图片，你需要把文件夹名和标签名联系起来。当在iOS或macOS应用程序中使用时，这些标签名称将在您的核心ML模型中返回。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="b10d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这允许你将所有的文件夹名映射到一个“标签”名，这告诉Turi Create所有在“可卡犬”文件夹中的图片确实是可卡犬。</p><h2 id="5e35" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">4.另存为<code class="fe oh oi oj ok b">SFrame</code></h2><p id="2b9c" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">如果你不熟悉一个<code class="fe oh oi oj ok b">SFrame</code>，简单来说，它是你所有数据(在这种情况下，一个图像)和所有标签(在这种情况下，狗的品种)的字典。像这样保存您的<code class="fe oh oi oj ok b">SFrame</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="99a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它允许您存储已标记的图像，以供下一步使用。这是机器学习行业中相当标准的数据类型。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="073c" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">培训和测试</h1><p id="fad2" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在Turi Create将你所有的标签图像都准备好之后，是时候进入最后阶段，最后训练你的模型了。我们还需要分割数据，以便80%用于训练，20%在模型完成训练后用于测试——我们不必手动测试。</p><h2 id="b418" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">1.加载SFrame</h2><p id="3f83" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">现在，我们需要加载我们在上一步中刚刚创建的SFrame。这是我们稍后将用来划分测试和训练数据的内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="1245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把类型为<code class="fe oh oi oj ok b">SFrame</code>的<code class="fe oh oi oj ok b">data</code>变量分配给我们在上一步中保存的SFrame。现在，我们需要将数据分成测试和训练数据。如前所述，我们将对训练数据进行80:20的测试。</p><h2 id="71ff" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">2.拆分数据</h2><p id="b111" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">是时候拆分数据了。在SFrame代码后，添加以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="95ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码随机地将数据分成80-20份，并分别分配给两个变量<code class="fe oh oi oj ok b">testing</code>和<code class="fe oh oi oj ok b">training</code>。现在，Turi将自动测试你的模型，而不需要你手动提供测试图像和创建应用程序。如果您需要进行调整，您不需要首先完全实现它，相反，您可以在您的Python文件中进行调整。</p><h2 id="eead" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">3.培训、测试和导出</h2><p id="fb11" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">你的努力终于有了回报！在这一行Python代码中，您只需告诉Turi Create训练您的模型，同时指定您想要使用的架构。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="9796" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你只是告诉Turi使用你的<code class="fe oh oi oj ok b">testing</code>数据(之前指定的)，并使用它们来预测<code class="fe oh oi oj ok b">labels</code>(基于之前的文件夹结构)，同时使用<code class="fe oh oi oj ok b">resnet-50</code>，这是最准确的机器学习模型架构之一。</p><p id="29a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用您的测试数据并确保您的模型是准确的，请添加以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="d91b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它使用您指定的<code class="fe oh oi oj ok b">training</code>数据，并将测试后的结果存储在一个名为<code class="fe oh oi oj ok b">testing</code>的变量中。供您参考，它打印出了准确性，但如果有足够的时间使用Turi Create的API，您也可以打印其他内容。</p><p id="350e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，在给模型起一个有用的名字后，可以用这个一行程序将模型保存到文件系统中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="7832" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，您也可以将您的模型保存为其他格式，但是对于这个例子，我将它保存为一个核心ML模型。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="b243" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">运行和输出</h1><p id="662b" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">对于所有的iOS开发者来说——不，这不是一个不断自动编译并抱怨错误的Xcode项目。为了执行您刚刚编写的代码，我们需要通过终端来执行。</p><h2 id="f45f" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">运行Python文件</h2><p id="c2c5" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">运行Python文件很容易！确保您位于正确的目录中，您需要做的只是在终端窗口中输入以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="f0f1" class="no ms it bd mt np nq dn mx nr ns dp nb li nt nu nd lm nv nw nf lq nx ny nh nz bi translated">输出</h2><p id="4213" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">经过几分钟的训练后，您的<code class="fe oh oi oj ok b">images</code>文件夹和<code class="fe oh oi oj ok b">dog_breeds.py</code>文件将伴随着一个SFrame、一个model文件夹和一个<code class="fe oh oi oj ok b">.mlmodel</code>文件，这就是您的核心ML模型！</p><p id="d5a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还会在终端窗口中看到输出，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/43d59e9c739ad95c27f5b1fb1700828e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZv8FmWDzqxVOwvELXx5XQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd og">图4: </strong>运行Python后的输出</p></figure><p id="2d6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这为您提供了有关训练和训练准确性、处理的图像数量以及其他有用信息的信息，您甚至可以在不使用模型的情况下使用这些信息来分析模型。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="466b" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="d4c1" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我希望你喜欢阅读这篇教程，就像我喜欢制作它一样！以下是从这里开始的一些步骤。如果你想学习如何在iOS应用程序中使用你的核心ML模型，请查看我的另一个教程:</p><div class="om on gp gr oo op"><a href="https://code.tutsplus.com/tutorials/image-classification-through-machine-learning-using-coreml--cms-29819?_ga=2.101472841.993700883.1547096068-312075175.1521244044" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">Core ML中的图像识别入门</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">随着技术的进步，我们的设备可以使用内置摄像头来准确识别…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">code.tutsplus.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ks op"/></div></div></a></div><p id="23e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程将向你展示如何使用你的<code class="fe oh oi oj ok b">dog_classifier.mlmodel</code>模型，并在真实的iOS应用中实现它。它还将教你解析一个直播视频，并采取个别帧的图像分类。</p><p id="4031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对本教程有任何问题或意见，请不要犹豫，在下面的评论区提出来！我总是渴望听到反馈，问题，或者你如何使用本教程中的知识。</p></div></div>    
</body>
</html>