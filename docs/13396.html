<html>
<head>
<title>Adaptive LinearProgressIndicator Height in Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构图中自适应线性渐进指示器高度</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/adaptive-linearprogressindicator-height-in-compose-7943a956992?source=collection_archive---------9-----------------------#2022-08-23">https://betterprogramming.pub/adaptive-linearprogressindicator-height-in-compose-7943a956992?source=collection_archive---------9-----------------------#2022-08-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="295e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将您的可组合文件渲染为您想要的大小</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f26d40566a5eeccdc7302556afdf5bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bw9s4PT54XRf8N_H"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@itookthose?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sid Balachandran </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f4c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当使用Jetpack Compose构建组件时，您可以按照您想要的方式渲染它们，这要归功于无数的修改器属性。</p><p id="c8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数时候，您可以通过覆盖这个参数来定制任何组件——您也应该总是提供一个，尤其是在构建SDK的时候。不过，有争议的是，一些可组合组件带有一组更严格的规则。<code class="fe ls lt lu lv b">LinearProgressIndicator</code>就是这种情况。</p><h1 id="ae65" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated"><code class="fe ls lt lu lv b">LinearProgressIndicator</code>用例</h1><p id="59b0" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">原生SDK公开了一个名为<code class="fe ls lt lu lv b">LinearProgressIndicator</code>的可组合组件，它显示一个水平进度条。为了配合<a class="ae kv" href="https://material.io/develop/ios/components/progress-indicators/progress-views" rel="noopener ugc nofollow" target="_blank">材料导轨</a>，高度配合<code class="fe ls lt lu lv b">LinearIndicatorHeight</code>(相当于<code class="fe ls lt lu lv b">4.dp</code>)。</p><p id="2e72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是Composable的实现(在我写这篇文章的时候，使用Compose 1.2.1):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6db0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能会注意到，可组合组件在内部用固定值覆盖了它的大小。</p><p id="83eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，这并不妨碍你去改变它！因为Composable自然地公开了一个<code class="fe ls lt lu lv b">Modifier</code>参数，所以您可以提供自己的大小。但是，如果你的尺寸适合另一个组件的尺寸呢？</p><p id="d051" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是时候看看想要的输出了。我们想画一个进度条，覆盖一个按钮的全部内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7e4d731947a9bfff13d123db68e73aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*TAeyn68uwG38V_c1GhJZvQ.gif"/></div></figure><p id="6487" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们分解这个可组合的，我们有:</p><ul class=""><li id="f9a2" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated">答<code class="fe ls lt lu lv b">Button</code></li><li id="eeb2" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">答<code class="fe ls lt lu lv b">LinearProgressIndicator</code></li><li id="e291" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">一个封装了<code class="fe ls lt lu lv b">Button</code>和<code class="fe ls lt lu lv b">LinearProgressIndicator</code>的<code class="fe ls lt lu lv b">Box</code></li></ul><p id="2c96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不会覆盖<code class="fe ls lt lu lv b">Button</code>中的文本和图标，因为它们不相关。</p><p id="7a1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就引出了这段代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0bb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您试一试，您会注意到进度条:</p><ul class=""><li id="34ac" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated">仍然有一个<code class="fe ls lt lu lv b">4.dp</code>高度，因此没有填充按钮。</li><li id="135b" class="mw mx iq ky b kz nf lc ng lf nh lj ni ln nj lr nb nc nd ne bi translated">不会在圆角处被夹住。试试红色，你会马上看到它。</li></ul><p id="726a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以很容易地解决第二个问题。一种方法是将造型委托给<code class="fe ls lt lu lv b">Box</code>而不是<code class="fe ls lt lu lv b">Button</code>，然后裁剪其内容。</p><pre class="kg kh ki kj gt nk lv nl nm aw nn bi"><span id="c989" class="no lx iq lv b gy np nq l nr ns">val shape = <em class="nt">RoundedCornerShape</em>(8.<em class="nt">dp</em>)<br/><em class="nt">Box</em>(<br/>    modifier = modifier<br/>        .<em class="nt">background</em>(<br/>            color = MaterialTheme.colors.primary,<br/>            shape = shape,<br/>        )<br/>        .<em class="nt">clip</em>(shape),<br/>)</span></pre><p id="1635" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们进入最有趣的部分。我们可以传递一个硬编码的值来改变进度条的高度。但是我们希望它能动态匹配容器的高度，不管里面装的是什么。</p><h1 id="efa7" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">调整<code class="fe ls lt lu lv b">LinearProgressIndicator</code>的大小</h1><p id="956e" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">首先，有几种方法可以解决这个问题。您可以通过使用一个<code class="fe ls lt lu lv b">Layout</code>并按照您想要的方式调整大小来深入到定制组件的艺术中。在大多数情况下，这是更好的选择，因为它带来了最灵活的模式来绘制组件。</p><p id="cb9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，你可以决定把<code class="fe ls lt lu lv b">LinearProgressIndicator</code>丢在<code class="fe ls lt lu lv b">Canvas</code>上，自己画出来！因为这个进度条是为了匹配材质指南，所以最好不要进一步调整它。这将是在<code class="fe ls lt lu lv b">Canvas</code>中绘制的最简单的形状之一。你所需要做的就是自己处理动画部分。</p><p id="6016" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，为了这个例子，我们仍将使用我们的<code class="fe ls lt lu lv b">LinearProgressIndicator</code>并通过几行额外的代码获得想要的结果。我们需要检索<code class="fe ls lt lu lv b">Button</code>高度并将其传递给<code class="fe ls lt lu lv b">LinearProgressIndicator</code>。我们可以利用另一个有用的叫做<code class="fe ls lt lu lv b">onSizeChanged()</code>的<code class="fe ls lt lu lv b">Modifier</code>。这个lambda在被重绘为参数时会传递它的大小。收到后，在<code class="fe ls lt lu lv b">Dp</code>中转换它，然后记住它，以便我们的<code class="fe ls lt lu lv b">LinearProgressIndicator</code>用它的新高度重新组合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="71ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了完整起见，下面是可组合的最终代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2b21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已！这种简单的技术允许您根据其他组件大小来调整组件的大小。请注意，您可以对任何类型的组件重复使用这种模式，尽管大多数时候，系统应该根据您的需要使用<code class="fe ls lt lu lv b">Modifier</code>属性来推断它们的大小。</p></div></div>    
</body>
</html>