# 如何利用 Python 中的线性回归通过语音诊断帕金森病

> 原文：<https://betterprogramming.pub/diagnosing-parkinsons-disease-by-voice-using-linear-regression-in-python-73aad2712fba>

## 用 Python 创建一个简单的机器学习算法，通过病人的声音来诊断他们

![](img/ef9fa6c9d529551e4c90b6ed6d186a97.png)

Marcelo Leal 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片。

*编者按:这不是医学建议。本文仅用于教育和信息目的。*

今天，我们将看到如何创建一个简单的 Python 机器学习算法，以便能够通过病人的声音来诊断他们。

我们将使用健康人和帕金森患者的音频文件库，通过对音频进行一些测量来建立我们的数据集。一旦我们的数据集建立起来，我们将使用 [scikit-learn 库](https://scikit-learn.org/stable/)训练一个线性回归模型来进行预测。最后，我们将构建一个 Python 库，然后可以很容易地集成到程序中。

我们走吧！

# 数据集创建

首先，我们需要将音频文件转换成一个表格，其中包含音频测量值和患者是否健康的指示。

我们将使用[这些音频文件](https://zenodo.org/record/2867216#.XqMgg5NKjJy)。

让我们从导入必要的库开始:

接下来，我们将创建一个函数，允许您对输入音频文件进行各种复杂的测量。这些测量都要感谢 [Parselmouth 库](https://parselmouth.readthedocs.io/en/stable/)，它允许您在 Python 代码中使用 Praat。

然后，我们为每种类型的测量创建列表，并创建另一个列表来指示患者是否健康。一旦列表被填充，这将用于构建数据集。

现在，我们必须通过使用之前创建的函数从音频文件中进行测量来填充列表。我们保留了 audio 文件夹中提供的树结构，所以我们需要使用四个 for 循环来填充我们的列表。

最后，由于有了 [pandas](https://pandas.pydata.org/) 和 [NumPy](https://numpy.org/) 库，我们必须将这些列表组合成一个表，从而将它们转换成一个数据集。

我们的数据集现在可以使用了。

# 制作模型

现在我们必须创建一个代表项目核心的模型。由于我们将提供的测量，它将允许我们做出预测。

我们将使用 scikit-learn 的线性回归算法，如开头所述。该算法将允许我们根据几个参数(测量值)对(0 或 1)对象进行分类。

首先，我们将通过指定参数(测量值)以及标签(0 或 1)来训练我们的模型，以便执行监督训练。

我们获得了 0.63 的精度，即正确预测的三分之一，考虑到用于创建数据集的有限数据，这是相当令人满意的。

一旦我们获得了令人满意的精度，我们必须拟合模型并使其可导出，以便在我们的库中使用。

我们的模型被训练、导出，并准备好供我们的库使用。

# 图书馆创建

记住，我们的目标是得到一个可以被另一个程序使用的库。为此，我们将创建三个函数:

*   模型加载
*   测量音频(已经用于构建数据集)
*   预测

这是图书馆:

以及如何实现它的示例:

如果你有兴趣看数据集或者完整的代码，可以看看我的 GitHub 上的[库项目。](https://github.com/alan91620/ParkinsonRecoLib)

# 为了更进一步…

有可能通过拥有更大的数据集(即，通过拥有来自帕金森病患者的更多音频样本，公开发现这一点非常复杂)来改进模型，以便获得更好的精度。

或者您可以在应用程序中实现这个库，以便提供任何人都可以使用的应用程序。这是我和我的同事在追求这个项目中所做的，所以我邀请你观看我们完成的项目的视频演示。

在 GitHub 上看一下[整个项目。](https://github.com/Milkad0/ParkinsonIA)