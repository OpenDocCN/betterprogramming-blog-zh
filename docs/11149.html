<html>
<head>
<title>How to Show Snackbars Across Multiple Screens in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Jetpack Compose中跨多个屏幕显示Snackbars</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-show-snackbars-across-multiple-screen-in-jetpack-compose-dd4b40c6829a?source=collection_archive---------4-----------------------#2022-02-22">https://betterprogramming.pub/how-to-show-snackbars-across-multiple-screen-in-jetpack-compose-dd4b40c6829a?source=collection_archive---------4-----------------------#2022-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fd16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在你的Android应用中提供直观的反馈</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb7a6ea79962cf30eddc8cb51ef06011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*iZjXyfc5nKepc1DfdMOPKw.gif"/></div></div></figure><h1 id="caf9" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">目标</h1><p id="48de" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们希望即使在Jetpack Compose中导航到新屏幕时，我们的小吃店也是可见的。所以Snackbar应该跨多个屏幕显示。</p><h1 id="bf38" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">TL；博士:</h1><p id="36ed" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们应该在应用程序状态保持器中保存一个scaffoldState，并让屏幕触发一个<code class="fe mf mg mh mi b"><strong class="ll ir">showSnackbar</strong></code> <strong class="ll ir"> </strong>事件。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><p id="8388" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">在本文中，我将解释如何在Jetpack Compose应用程序中触发导航时显示Snackbars。这是一个小应用程序，但为了能够维护一个更大的项目，使用Android推荐的解决方案非常重要。</p><p id="8975" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">第一个关键点是应用状态作为真理的来源，这里解释:<a class="ae mv" href="https://developer.android.com/jetpack/compose/state#state-holder-source-of-truth" rel="noopener ugc nofollow" target="_blank">状态持有者作为真理的来源</a>。</p><p id="8aa8" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">第二个重点是状态提升，这里解释:<a class="ae mv" href="https://developer.android.com/jetpack/compose/state#state-hoisting" rel="noopener ugc nofollow" target="_blank">状态提升</a>。</p><p id="f454" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">解决方案依赖于这两点。我们将有一个应用程序状态保持器，我们的屏幕将触发一个事件，通知我们的单个<code class="fe mf mg mh mi b">scaffoldState</code>应该显示一个snackbar。由于我们在根可组合组件中只有一个脚手架(它的状态存储在app state中),所以它不仅处理snack bar的显示，还处理多个snack bar是否被调度，并且它将显示每个没有被取消的snack bar。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="206d" class="kr ks iq bd kt ku mw kw kx ky mx la lb jw my jx ld jz mz ka lf kc na kd lh li bi translated">让我们浏览一下代码:</h1><p id="c1dd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">首先，我们有<code class="fe mf mg mh mi b">MainActivity.kt </code>——没什么特别的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="48fc" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">根可组合组件如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3b2f" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">我们可以看到，我们将状态容器注入到我们的可组合对象中，并使用它的属性和函数。</p><p id="6d48" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">所以让我们看看<code class="fe mf mg mh mi b">SnackbarDemoAppState</code>是什么样子的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="0fbb" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">在这里，我们收集我们的应用程序应该记住的一切，然后创建我们自己的记忆。<code class="fe mf mg mh mi b">AppState()</code>可组合函数。因为它在我们的根composable中，所以当屏幕离开composite时，我们的Snackbar不会消失。</p><p id="af62" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">因为我们只有一个<code class="fe mf mg mh mi b">scaffoldState</code>，它将处理每个<code class="fe mf mg mh mi b">showSnackbar</code>请求，并安排应该显示的每个消息。</p><p id="a95f" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated"><code class="fe mf mg mh mi b">MyNavigation</code> composable做什么:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="ecc8" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">它只是将<code class="fe mf mg mh mi b">showSnackbar</code>传递到屏幕上，所以他们可以调用它。(并且明显处理导航。)</p><p id="f6d8" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">实际屏幕是什么样子的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="a317" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">你可以看到当导航被触发时，我们也可以调用<code class="fe mf mg mh mi b">showSnackbar</code>函数。我们必须提供我们的信息和持续时间。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="1162" class="kr ks iq bd kt ku mw kw kx ky mx la lb jw my jx ld jz mz ka lf kc na kd lh li bi translated">结果</h1><p id="ed69" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">无论导航是否被调用(甚至是点击了后退按钮)，我们的小吃店总是显示的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/f2e79a91c923c010359ccbe999395188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-_s_OSC4yr6BqAWmelTuRg.gif"/></div></div></figure><h1 id="7300" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">摘要</h1><p id="6060" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们遵循推荐的解决方案，在我们的应用程序中存储状态，并在我们的合成树中发送可调用事件，以便在Jetpack Compose中导航到新屏幕时显示小吃店。</p><p id="4149" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">完整代码:<a class="ae mv" href="https://github.com/Abokyy/snackbardemo-app" rel="noopener ugc nofollow" target="_blank">https://github.com/Abokyy/snackbardemo-app</a></p><div class="ne nf gp gr ng nh"><a href="https://github.com/Abokyy/snackbardemo-app" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">GitHub - Abokyy/snackbardemo-app</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv kp nh"/></div></div></a></div><p id="413b" class="pw-post-body-paragraph lj lk iq ll b lm mq jr lo lp mr ju lr ls ms lu lv lw mt ly lz ma mu mc md me ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>