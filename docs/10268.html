<html>
<head>
<title>Syncing Cryptocurrency Prices Into Google Sheets With 100 Lines of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用100行代码将加密货币价格同步到谷歌表单中</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/syncing-cryptocurrency-prices-into-google-sheets-with-100-lines-of-code-df18764a79b6?source=collection_archive---------2-----------------------#2021-12-20">https://betterprogramming.pub/syncing-cryptocurrency-prices-into-google-sheets-with-100-lines-of-code-df18764a79b6?source=collection_archive---------2-----------------------#2021-12-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="365c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这种自动化是无服务器的，并且使用CoinMarketCap自由层API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6c7b823b7d3be742574a0e6210cb6693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyh8iiuT1O1TXJ_FOvrq8A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="332b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">嘿，我写了这个指南，因为和许多加密持有者一样，我花了太多时间手动复制和粘贴加密价格数据到我的谷歌投资组合跟踪器中。我想现在一定有人已经自动完成了，对吧？</p><p id="3fda" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">起初，我试图在网上寻找，但我找不到任何容易设置的东西，我也不想为电子表格插件的高级功能付费。</p><p id="29fa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我做了任何一个电子表格呆子都会做的事情:我使用一些谷歌应用程序和CoinMarketCap的免费层API编写了一个解决方案…然后<em class="lu">瞧</em>，你可以在下面看到我的概念证明:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/85089ad0f433801fc84c246973b08097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABlim93hEPhoLJ0TEXmqGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个<a class="ae lw" href="https://docs.google.com/spreadsheets/d/1Osa81aLQGN-QlkydWMwTqnpnojbTNBSZv3cBYJ2gxV0/edit#gid=0" rel="noopener ugc nofollow" target="_blank">演示谷歌表单</a>的例子，它每天从<strong class="bd lx">CoinMarketCap.com</strong>获取一次实时价格数据</p></figure><p id="3935" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你只是想使用<code class="fe ly lz ma mb b">VLOOKUP</code>和<code class="fe ly lz ma mb b">IMPORTRANGE </code>将一些每日价格数据放入你的Google Sheets，这里是我为自己和他人构建的5个常见加密货币对:</p><ul class=""><li id="b356" class="mc md it la b lb lc le lf lh me ll mf lp mg lt mh mi mj mk bi translated"><a class="ae lw" href="https://docs.google.com/spreadsheets/d/1Osa81aLQGN-QlkydWMwTqnpnojbTNBSZv3cBYJ2gxV0/edit#gid=0" rel="noopener ugc nofollow" target="_blank">前5000种美元加密货币(USD </a>)</li><li id="3a91" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt mh mi mj mk bi translated"><a class="ae lw" href="https://docs.google.com/spreadsheets/d/1CGG1Be8Dyjr0yqql3epRRZm6CGcjdR8eVNPm6V8dKDI/edit#gid=0" rel="noopener ugc nofollow" target="_blank">瑞士法郎(CHF </a>)的5000种顶级加密货币</li><li id="ce3a" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt mh mi mj mk bi translated"><a class="ae lw" href="https://docs.google.com/spreadsheets/d/1rnO13faOwmLiiiFye19Fr41qZlMN2RWRUQgSKlhekWQ/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">以欧元计的5000种顶级加密货币(欧元</a></li><li id="9f0a" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt mh mi mj mk bi translated"><a class="ae lw" href="https://docs.google.com/spreadsheets/d/1qBvh-VnERib_31xF_W-EQDCA5ngyA2bWaVJLZ-krSZQ/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">前5000种加拿大元加密货币(CAD </a></li></ul><p id="cb42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上述工作表每天运行一次，太平洋标准时间为每天早上6点。</p><blockquote class="mq"><p id="4764" class="mr ms it bd mt mu mv mw mx my mz lt dk translated">“这固然很好，但如果我想让它一天运行一次以上，或者以不同的货币运行，该怎么办？”</p></blockquote><p id="39a3" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">好问题！为此，您需要对代码进行一些定制。请继续阅读…</p><h2 id="8703" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">1)首先，从CoinMarketCap为自己申请一个开发者账户</h2><p id="6a90" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">CoinMarketCap API与比特币基地用于他们不支持的硬币和代币价格的API相同(我认为)，所以如果它对他们来说足够好，对我来说也足够好:)</p><p id="5023" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里创建一个账户来获得你的API密匙:<a class="ae lw" href="https://coinmarketcap.com/api/" rel="noopener ugc nofollow" target="_blank">coinmarketcap.com/api/</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/410e28048859c302e85339f59ebb1074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ueiJIbz-So5T7q6yATLbTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">了解更多:【https://coinmarketcap.com/api/documentation/v1/ T4】</p></figure><h2 id="1893" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">2)接下来，从<a class="ae lw" href="http://sheets.google.com" rel="noopener ugc nofollow" target="_blank">sheets.google.com</a>创建一个新的谷歌表单</h2><p id="f977" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">给它起个好记的名字，比如<em class="lu">coin market cap+Google Sheets</em></p><h2 id="a9ca" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">3)从这里，从<strong class="ak">扩展&gt;应用程序脚本</strong>访问<a class="ae lw" href="https://developers.google.com/apps-script" rel="noopener ugc nofollow" target="_blank">谷歌应用程序脚本</a></h2><p id="94ac" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">也给你的脚本起个名字，比如<em class="lu">coin market cap+Google Sheets API</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/ad8f1274f0370832a7ac50b0a9dd09d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XmsoAgC2-zoQpRIpmaVOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第一次？了解更多关于Google Apps脚本的信息:<a class="ae lw" href="https://developers.google.com/apps-script" rel="noopener ugc nofollow" target="_blank"> Google Apps脚本</a></p></figure><h2 id="d403" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">4)我们将<a class="ae lw" href="https://developers.google.com/apps-script/guides/menus?hl=en" rel="noopener ugc nofollow" target="_blank">添加一个自定义菜单</a>到我们的表单<strong class="ak">和</strong>中，一种安全存储硬币市值API密钥的方法(例如，不是明文)</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><ul class=""><li id="5570" class="mc md it la b lb lc le lf lh me ll mf lp mg lt mh mi mj mk bi translated">这些工具使用getUI()库向Google工作表添加定制菜单</li><li id="e8f1" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt mh mi mj mk bi translated"><code class="fe ly lz ma mb b"><a class="ae lw" href="https://developers.google.com/apps-script/guides/services/authorization" rel="noopener ugc nofollow" target="_blank">@OnlyCurrentDoc</a></code> <strong class="la iu"> </strong>使脚本只能访问它所链接的工作表。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><ul class=""><li id="4867" class="mc md it la b lb lc le lf lh me ll mf lp mg lt mh mi mj mk bi translated">这些使用Apps脚本的内置<code class="fe ly lz ma mb b"><a class="ae lw" href="https://developers.google.com/apps-script/reference/properties/properties-service" rel="noopener ugc nofollow" target="_blank">PropertiesService</a></code>为脚本提供了某些助手功能。这将把API密匙保存到您的Google帐户中，作为一个用户属性<em class="lu">稍后将被菜单项<strong class="la iu"> Run Query调用。</strong></em></li></ul><p id="1a46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我决定使用用户属性的原因是因为它比仅仅将API密钥存储在代码中更安全。我还希望电子表格的每个“用户”使用他/她自己的API键，而不是共享。</p><h2 id="a59e" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">5)接下来，让我们编写查询CoinMarketCap API所需的代码</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><ul class=""><li id="2c20" class="mc md it la b lb lc le lf lh me ll mf lp mg lt mh mi mj mk bi translated"><code class="fe ly lz ma mb b">queryCoinMarketCapEndpoint</code> <strong class="la iu"> </strong>使用<a class="ae lw" href="https://developers.google.com/apps-script/reference/url-fetch" rel="noopener ugc nofollow" target="_blank"> Apps脚本的urlfettchapp</a>库通过HTTP请求查询API端点。你可以从Google Apps脚本中使用这个API。如果您的API需要OAuth，他们甚至有一个受支持的OAuth库！</li></ul><p id="2a68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">热点提示:</em></p><ol class=""><li id="150f" class="mc md it la b lb lc le lf lh me ll mf lp mg lt oh mi mj mk bi translated">如果你愿意，你可以定制<code class="fe ly lz ma mb b">PARAMETERS</code>，但我只是拿了前5000个硬币，只要求以美元报价。</li><li id="743f" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt oh mi mj mk bi translated">如果您需要不同种类的货币，请用您的货币替换美元。</li></ol><h2 id="5e4d" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">6)现在端点工作了，将返回的数据写入您的Google Sheet</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><ul class=""><li id="918a" class="mc md it la b lb lc le lf lh me ll mf lp mg lt mh mi mj mk bi translated">如果您需要不同货币的报价，请记住在此替换“<strong class="la iu">美元”</strong></li><li id="eb38" class="mc md it la b lb ml le mm lh mn ll mo lp mp lt mh mi mj mk bi translated">确保您的Google Sheet有一个名为<strong class="la iu"> "ImportedData" </strong>的工作表，并且从单元格A1开始的标题与代码中的标题匹配！</li></ul><pre class="kj kk kl km gt oi mb oj ok aw ol bi"><span id="57d5" class="nf ng it mb b gy om on l oo op">symbol,name,price,volume_24h,volume_change_24h,percent_change_1h,percent_change_24h,percent_change_7d, market_cap,market_cap_dominance,fully_diluted_market_cap,last_updated</span></pre><h2 id="b688" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">7)现在运行您的脚本</h2><p id="601f" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">谷歌会告诉你这个应用还没有被验证。您应该使用高级链接授权该应用程序。</p><p id="0a10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">既然你是开发者，你可以信任他/她/他们，但显然不要在不舒服的情况下盲目地在网上运行脚本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/95f264cabbbc1dbd876c314cee3f929a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsndcs1WiWyvc7I9CrIZZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">点击<strong class="bd lx">高级</strong>进入下一个提示！</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/ada9a79ee1bcf47d8b97108a413e0306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gewgdoLyrGDAi06h-SK_5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向下滚动并<strong class="bd lx">批准</strong>您的脚本</p></figure><h2 id="d3e7" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">8)刷新浏览器窗口后，或者如果您手动运行OnOpen()，一个新的自定义菜单将出现在您的Google表单中</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/99b54cdb4a5f25a4a51fe369ac0bcd11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwwOWGBUCnG1XG8kVMnZSg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">该菜单是您添加CoinMarketCap API密钥的地方</p></figure><h2 id="399e" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">9)添加您的CoinMarketCap API密钥</h2><p id="01d5" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">这可以通过<code class="fe ly lz ma mb b"><strong class="la iu">CMC API &gt; Set API Key</strong></code>从谷歌表单中完成</p><h2 id="43c9" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">10)一旦设置了API键，运行查询</h2><p id="8d7e" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">这可以通过<code class="fe ly lz ma mb b"><strong class="la iu">CMC API &gt; Run Query</strong></code> <strong class="la iu">完成。</strong>如果您已经正确设置了所有内容，数据应该会为您加载，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/85089ad0f433801fc84c246973b08097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABlim93hEPhoLJ0TEXmqGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">噪音🐥</p></figure><h2 id="4546" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated"><strong class="ak"> 11)使用Google Sheets公式合并数据源</strong></h2><p id="df0d" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">要将这些数据添加到您的个人电子表格中，请在现有电子表格的新标签中使用<code class="fe ly lz ma mb b"><a class="ae lw" href="https://support.google.com/docs/answer/3093340?hl=en" rel="noopener ugc nofollow" target="_blank">IMPORTRANGE()</a></code>。它看起来会像这样:</p><pre class="kj kk kl km gt oi mb oj ok aw ol bi"><span id="faa5" class="nf ng it mb b gy om on l oo op"><strong class="mb iu">=IMPORTRANGE({{SPREADSHEET_URL}},ImportedData!A:J)</strong><br/>//This ImportRange() brings data from one spreadsheet to another. Afterward, you can manipulate or query the data from your own portfolio tracker or move it where you want it the screenshot below:</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4b48cfe1c4dc8724ebb3ef5b482ec1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vzb0fhtqS9KQWdYr3buw3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">参见前5000枚硬币电子表格中的<strong class="bd lx">用法示例</strong>选项卡</p></figure><p id="2cbe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦来自CoinMarketCap的数据进入你的个人电子表格，你还没有完成。你需要找到一种方法将你的投资组合数据和价格数据“连接”起来。为此，在我的电子表格中创建一个新列，并使用如下所示的内容，根据您的需要使用<code class="fe ly lz ma mb b">VLOOKUP().</code>进行填充:</p><pre class="kj kk kl km gt oi mb oj ok aw ol bi"><span id="d106" class="nf ng it mb b gy om on l oo op"><strong class="mb iu">=VLOOKUP({{SYMBOL}},ImportedData!A:J,3,FALSE)</strong><br/>//This Vlookup searches the ImportedData range and returns the <strong class="mb iu">3rd</strong> <strong class="mb iu">column</strong> using {{SYMBOL}} as its search key.</span></pre><p id="f9de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用这个公式，你可以查询符号，<strong class="la iu">、</strong> BTC、ETH、SOL或任何你想要的硬币或代币<strong class="la iu">、</strong>将你的投资组合数据与价格数据“结合”在一起。或者，如果您熟悉Google Sheets参考语法，您可以匹配列值，而不是硬编码符号，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/dfc0d114f5e55d207e6c6cc4dad79064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJqW9SGH--pZDNCcF6ZhEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为了方便使用，我在Top 5000 Coins电子表格的<strong class="bd lx">示例用法</strong>选项卡中添加了示例公式</p></figure><p id="76fa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你的交易日志可能和我的不一样，所以我就写到这里，但希望你能明白。</p><h2 id="7d6f" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">12)安排你的代码自己运行</h2><p id="d3d6" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">你可以使用基于时间或动作的<a class="ae lw" href="https://developers.google.com/apps-script/guides/triggers" rel="noopener ugc nofollow" target="_blank"> Google Apps触发器</a>来用实时数据自动刷新你的工作表。只是确保不要超过每月333次调用的免费API限制。</p><h2 id="0de5" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">13)定制脚本以检索其他数据(可选)</h2><p id="e801" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">我将在这里结束，但我已经在github repo中包含了另一个地方，您可以在那里自定义API结果，名为<code class="fe ly lz ma mb b">parameters</code>。定制您的API结果记录在<a class="ae lw" href="https://coinmarketcap.com/api/documentation/v1/#section/Endpoint-Overview" rel="noopener ugc nofollow" target="_blank">https://coinmarketcap.com/api/documentation/v1/</a>中。</p><p id="0acc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也就是说，如果您对参数进行了更改，请准备好更改脚本的其余部分，特别是更改第<strong class="la iu">行第40 </strong>行返回的字段，以及它们如何映射回Google工作表:</p><h1 id="3db6" class="ov ng it bd nh ow ox oy nk oz pa pb nn jz pc ka nq kc pd kd nt kf pe kg nw pf bi translated">源代码</h1><div class="pg ph gp gr pi pj"><a href="https://github.com/danphamx/CoinMarketCap-to-Google-Sheets" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd iu gy z fp po fr fs pp fu fw is bi translated">GitHub-danphamx/CoinMarketCap-to-Google-Sheets:从CoinMarketCap查询数据的模板…</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px ks pj"/></div></div></a></div></div><div class="ab cl py pz hx qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="im in io ip iq"><h2 id="3e59" class="nf ng it bd nh ni nj dn nk nl nm dp nn lh no np nq ll nr ns nt lp nu nv nw nx bi translated">要阅读更多我的个人理财文章，请查看Dan Pham个人理财文章索引并关注我:)<a class="ae lw" href="https://danphamx.medium.com/index-of-dan-phams-personal-finance-articles-290f7a3fad98" rel="noopener">https://danphamx . medium . com/Index-of-Dan-phams-Personal-Finance-Articles-290 f 7a 3 fad 98</a></h2></div><div class="ab cl py pz hx qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="im in io ip iq"><p id="77a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文仅供参考。不应将其视为财务或法律建议。并非所有信息都是准确的。在做任何重大财务决定之前，先咨询财务专家。</p></div></div>    
</body>
</html>