<html>
<head>
<title>Lessons Learned Migrating a Production App to Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将生产应用迁移到Flutter的经验教训</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lessons-learned-migrating-a-production-app-to-flutter-78195067b2cb?source=collection_archive---------17-----------------------#2020-02-03">https://betterprogramming.pub/lessons-learned-migrating-a-production-app-to-flutter-78195067b2cb?source=collection_archive---------17-----------------------#2020-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8d2c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我从艰难的道路中学到的教训可以帮助你在下一个颤振项目中更加有效</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1bd6e9adf7833304bb84fec7bd5328e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Br-Iv3NnXfQ6sjXry-UinA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/dual?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@franckinjapan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Franck V. </a>拍摄的照片</p></figure><p id="9748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经开发原生Android应用程序两年多了。除了在Android中做简单事情的过于复杂的方式之外，我所面临的唯一缺点是，我只能接触Android用户。我不得不指望一个iOS开发人员为iOS用户发布相同的应用程序。这总感觉像是对我作为开发人员的能力的某种限制。</p><p id="7878" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进入<a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank">颤振</a>，看起来有希望提高我的权力，并保持简单的事情简单的建设。我仍然需要依赖iOS dev来完成一些配置工作，但是现在这种依赖已经小得多了。</p><p id="e331" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个运行在Android和iOS上的本地应用，内部并不复杂，但需要更多的开发人员来维护它。我们有了下一个特性需求。</p><p id="e08c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我和我的团队为接下来的需求选择了Flutter。这是有意义的，因为它的功能并不复杂，但UI却很复杂。如果成功，这可能是我们将现有应用迁移到Flutter的第一步。</p><p id="a76d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们成功地度过了这一关，但只是在艰难地学习了一些东西之后。这是一次很棒的学习经历，而且构建跨平台应用程序更有趣。</p><p id="88d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我分享我们的经验和教训。</p><p id="0597" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一句话:我仍然爱扑！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4fc9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">经验教训</h1><h2 id="c1ef" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">1.开始会很难</h2><p id="c84c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">当你从本地应用程序开发转移到Flutter时，写代码将是一件非常痛苦的事情。</p><p id="4b01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您会发现自己在挣扎，因为您会对将业务逻辑和UI逻辑放在哪里感到困惑，尤其是当您喜欢编写干净的代码时。</p><p id="4410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">UI和业务逻辑的单个文件听起来像是一种优势，因为您不必创建单独的布局和逻辑文件，但是我发现它更像是一种潜在的负债而不是资产。</p><h2 id="5765" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">2.编写更干净的代码是一个更大的挑战，比以往任何时候都更重要</h2><p id="7b40" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">权力越大，责任越大。</p><p id="13ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这不仅仅是必须干净地编写您的UI和业务逻辑。在Flutter中，不同部件之间的通信方式非常重要。</p><p id="ccee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flutter按照一个窗口小部件树来构建东西，如果你不够仔细地规划你的数据流，那么你将会遇到你的UI不能正确更新的问题。随着时间的推移，你会感到沮丧，下一件事你知道，你会写黑客只是为了让它工作。</p><p id="484b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那只是运行中的坏代码。</p><p id="d4a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看刚刚发生了什么。你先写坏代码，然后你写更多的坏代码试图修复这些坏代码。一旦成功了，你就会害怕做出任何改变。然后你会忙于下一个截止日期。那些糟糕的代码会一直留在那里，困扰着你。您将围绕这些糟糕的代码编写更多的代码，以使其他东西正常工作。</p><p id="df29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着时间的推移，你的Flutter应用程序将会变得不可维护，并且比原生应用程序快得多。</p><h2 id="df04" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">3.在实际编码之前，在纸上计划你的方法</h2><p id="4733" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">首先，规划您的小部件树结构。</p><p id="3eaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从您的<code class="fe nl nm nn no b">main.dart</code>文件开始，到您的第一个屏幕及其小部件，考虑:</p><ul class=""><li id="5ff2" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">这些小部件将如何存储状态</li><li id="2347" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">无论您将使用<code class="fe nl nm nn no b">StatefulWidget</code>还是提供商包</li><li id="4270" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">是否需要任何小部件来监听公共数据源，如果需要，您将如何实现这一点</li><li id="3936" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">如何移动到另一个屏幕，以及如何与该屏幕共享数据(如果需要)</li><li id="ffaa" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">如何从子部件更新父部件</li><li id="5d62" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">你将如何构建你的代码:仓库、网络、工具、模型、视图、视图模型等等。</li><li id="4965" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">如何保持代码的可测试性，例如，是否可以使用依赖注入</li></ul><p id="25d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在纸上规划出你的MVP的整个流程。如果你遇到了障碍，做你的研究，找到可以帮助你的包和设计模式。</p><p id="a65a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">寻找以最干净的方式实现需求的最佳方式。</p><p id="3240" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能需要一点额外的时间，但从长远来看，这是一项值得的投资。</p><h2 id="534b" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">4.不要多此一举</h2><p id="1bd2" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">你知道我们怎么说的吗，“有一个应用程序可以做到这一点”？在Flutter中，如果你说“有一个包可以解决这个问题”，这几乎是真的。</p><p id="9686" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于令人惊奇的Flutter社区，现在有很多软件包。但是在选择使用哪个Flutter包时，您应该做好研究。</p><p id="9eab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一些只适用于Android的Flutter包和一些目前正在开发中的Android包。</p><p id="63b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您希望在Android和iOS上实现某个特定的功能，并且您依赖于某个包，请确保您构建了一个小型POC来检查该包在这两个平台上的功能。</p><p id="b781" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你不会想在进入生产阶段时发现你所依赖的包在某个平台上不工作。</p><h2 id="ff49" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">5.不要过度设计你的解决方案</h2><p id="f723" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">是的，封锁很酷。但是你试过提供商套餐吗？</p><p id="f758" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于一些看起来复杂的情况，您可以很容易地使用一些基本的构建块(比如提供者包)来实现您的特性。</p><p id="96ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即便如此，有时当你试图修复复杂逻辑中的一个bug时，你可能最终会写出更复杂的代码，但仍然不能修复你的解决方案。</p><p id="8e8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只是退一步，回到纸笔，计划一下。我相信你总能找到更简单更有效的方法。</p><h2 id="3b46" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">6.热重装很酷，但是…</h2><p id="82d5" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">当我第一次听说颤振和尝试热重装，我只是太他妈的高兴和惊讶。当我开始构建更复杂的管理状态的应用程序时，我发现自己冷启动应用程序的次数比热重新加载更多。</p><p id="f4c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重启有时会花费意想不到的长时间，这有点令人失望，毕竟热重装设置了很高的期望。还是比原生app搭建快。只是某些期望没有实现。</p><h2 id="7756" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">7.必须知道的</h2><p id="e511" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">无论您是正在学习Flutter并打算立即投入到应用程序开发中，还是您仍在从多个来源学习并且对Flutter没有信心，这里有几个主题应该足以让您开始构建漂亮的、可伸缩的应用程序。</p><ul class=""><li id="f768" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated">建筑布局</li><li id="7441" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><code class="fe nl nm nn no b">StatelessWidget</code>与<code class="fe nl nm nn no b">StatefulWidget</code>——何时使用，何时可以避免使用<code class="fe nl nm nn no b">StatefulWidget</code></li><li id="ea6b" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><code class="fe nl nm nn no b">ChangeNotifier</code> /提供者包——如何为多个小部件提供一个公共的数据观察者</li><li id="3e45" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">依赖注入与<code class="fe nl nm nn no b">GetIt</code></li><li id="f7bf" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated">在Flutter中编写测试</li></ul><p id="cb18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你觉得我错过了任何重要的话题，请在评论中告诉我。</p><h2 id="fbd7" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">8.免费学习的绝佳资源</h2><p id="79a4" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">Flutter仍然在发展，所以你不能坚持用一年前的课程来让你了解最新的最佳实践。重要的是，你要密切关注以下资源，并不断学习，以便在游戏中保持领先。</p><ul class=""><li id="a818" class="np nq it lb b lc ld lf lg li nr lm ns lq nt lu nu nv nw nx bi translated"><a class="ae ky" href="https://medium.com/flutter-community" rel="noopener">颤振群落</a> —中</li><li id="fda7" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><a class="ae ky" href="https://www.youtube.com/channel/UCsBjURrPoezykLs9EqgamOA" rel="noopener ugc nofollow" target="_blank">火船</a>——YouTube</li><li id="cef3" class="np nq it lb b lc ny lf nz li oa lm ob lq oc lu nu nv nw nx bi translated"><a class="ae ky" href="https://www.youtube.com/channel/UCSIvrn68cUk8CS8MbtBmBkA" rel="noopener ugc nofollow" target="_blank"> ResoCoder </a> — YouTube</li></ul><p id="1a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我个人真的很感谢所有这些帮助我学习Flutter的资料，以及它们的作者。这些人一直在增加内容，敬请关注。</p><h2 id="ac7b" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">9.练习建筑布局</h2><p id="a08d" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">在推介Flutter解决方案时，您会想到的第一个品质是您可以自由地构建外观惊艳、流畅、响应迅速的UI。</p><p id="bd6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，确保这是你的强项。去网上找各种资源，比如运球，练习做这些布局。发挥Flutter的最大潜能。</p><p id="f106" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一定要在网上分享你的作品，帮助别人从你身上学到更多。知识只有在分享时才会增长。</p><h2 id="fc36" class="mu md it bd me mv mw dn mi mx my dp mm li mz na mo lm nb nc mq lq nd ne ms nf bi translated">10.互操作性在这里，但是…</h2><p id="90b8" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">如果你有旧的原生应用程序在Android和iOS上运行，你可以考虑在Flutter中构建你的下一个功能——但这是以臃肿的应用程序大小为代价的。</p><p id="37a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不过，如果这不是一个大问题，也许你可以考虑迁移你的原生应用程序，一次一个屏幕，然后最终完成迁移，回到一个小得多的应用程序大小。</p><p id="703e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在进入项目并实现它之前，一定要检查如何在两个平台上实现互操作性。也许还可以学习如何将数据从本地应用程序发送到Flutter屏幕。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="8b50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>