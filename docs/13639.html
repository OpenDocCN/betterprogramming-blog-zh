<html>
<head>
<title>Building a GraphQL Server Using the Schema-First Approach in Golang</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Golang中使用模式优先的方法构建GraphQL服务器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-a-graphql-server-using-the-schema-first-approach-in-golang-a8da71d7e5b7?source=collection_archive---------9-----------------------#2022-09-13">https://betterprogramming.pub/building-a-graphql-server-using-the-schema-first-approach-in-golang-a8da71d7e5b7?source=collection_archive---------9-----------------------#2022-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3a80" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用CRUD操作探索Golang GraphQL服务器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb42bcbc0b72324f40d898360300fe7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DXWIpwA2O4XVXqIh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@nasrphotos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">侯赛因·纳斯尔</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="de08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是这篇文章的Golang版本— <a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/building-graphql-server-using-schema-first-approach-in-python-68aeee38bcc3">在Python中使用模式优先的方法构建GraphQL服务器。</a></p><blockquote class="ls lt lu"><p id="24d8" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">它在Golang中使用完全相同的模式实现。</p></blockquote><p id="d896" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">模式优先的方法意味着我们将首先使用GraphQL模式定义语言编写我们的模式。在代码优先的方法中，我们将使用库API构建我们的模式。</p><p id="97d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用<code class="fe lz ma mb mc b"><a class="ae kv" href="https://gqlgen.com/getting-started/" rel="noopener ugc nofollow" target="_blank">gqlgen</a></code>作为Golang的模式优先GraphQL库。</p><h1 id="e584" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">项目概述</h1><p id="9c0b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我们将构建GraphQL服务器来处理<code class="fe lz ma mb mc b">Book Store</code>中<code class="fe lz ma mb mc b">Book</code>的CRUD操作。</p><p id="6fae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简单地说，我们将把这本书的信息存储在我们的数据库中。为了简化这个项目，我没有使用任何类型的数据库；我只是使用了一个内存存储，并且更加关注GraphQL部分。</p><h1 id="a9b0" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">服务器操作</h1><ul class=""><li id="b0b2" class="na nb iq ky b kz mv lc mw lf nc lj nd ln ne lr nf ng nh ni bi translated">添加书籍</li><li id="6be2" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">按ID获取图书</li><li id="dbaf" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">按流派列出书籍</li><li id="be1a" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">列出所有的书</li><li id="cd95" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">更新图书</li><li id="4b27" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">删除这本书</li></ul><h1 id="95d7" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">构建GraphQL服务器</h1><h2 id="2058" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">入门指南</h2><ul class=""><li id="cab4" class="na nb iq ky b kz mv lc mw lf nc lj nd ln ne lr nf ng nh ni bi translated">让我们创建我们的项目目录。</li><li id="a3d4" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">用<code class="fe lz ma mb mc b">go mod init &lt;dirname&gt;</code>初始化Go模块。</li></ul><h2 id="bff9" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated"><code class="fe lz ma mb mc b">gqlgen</code></h2><ul class=""><li id="a14f" class="na nb iq ky b kz mv lc mw lf nc lj nd ln ne lr nf ng nh ni bi translated">在<code class="fe lz ma mb mc b">go get github.com/99designs/gqlgen</code>前领取我们的套餐</li><li id="64f1" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">通过<code class="fe lz ma mb mc b">go run github.com/99designs/gqlgen init</code>初始化gqlgen</li><li id="365a" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">运行<code class="fe lz ma mb mc b">go mod tidy</code>来获得所需的包</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/a43a19e196f23a346b9e00f1e3667a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0xhU3PblEeMV8g8slaY8aw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Go模块</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/d260e1840b38a253f59153eedf56b02c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*COKFFtM-XkfS-kbW6SdAYQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">gqlgen初始化</p></figure><p id="e30c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此时，我们可以看到目录graphql下的各种文件和文件夹。在我们键入<code class="fe lz ma mb mc b">init</code>命令后，gqlgen生成了目录图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/8492c7903e38e3466cd3f57e187c6ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LjDkXhUsw0c5dy-L0raIVA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://gqlgen.com/getting-started/#create-the-project-skeleton" rel="noopener ugc nofollow" target="_blank">生成文件</a></p></figure><p id="9097" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">model/model_gen.go</code> —这是一个包含由gqlgen生成并由模式文件<code class="fe lz ma mb mc b">schema.graphqls</code>定义的结构的文件</p><p id="af97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">generated/generated.go</code> —这是一个带有生成代码的文件，为每个查询和变异注入上下文和中间件。</p><blockquote class="ls lt lu"><p id="7d77" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">您不应该修改这些文件中的任何一个，因为当我们更新我们的模式并生成。</p></blockquote><p id="76dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">graph/resolver.go </code> —是根图形解析器类型。该文件不会重新生成。这是我们声明应用程序依赖关系的文件，比如我们的数据库。</p><p id="321b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">schema.graphqls </code> —是一个定义类型、查询和变异的GraphQL模式文件。模式文件使用模式定义语言(SDL)以人类可读的方式描述数据类型和操作(查询/突变)。</p><p id="cbc6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">schema.resolvers.go</code> —是一个Go文件，带有在<code class="fe lz ma mb mc b">schema.graphqls</code>中定义的查询和突变的包装代码</p><h1 id="936e" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">定义我们的模式</h1><blockquote class="ls lt lu"><p id="5341" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">我邀请您按照自己的方式和要求定义模式并实现代码。</p></blockquote><ul class=""><li id="e8c4" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated">删除文件<code class="fe lz ma mb mc b">graph/schema.graphqls</code>(由gqlgen生成)的内容</li><li id="c662" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">删除<code class="fe lz ma mb mc b">schema.resolvers.go</code>中的示例代码</li><li id="beb7" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">继续在<code class="fe lz ma mb mc b">graph/schema.graphqls</code>中定义我们自己的模式</li></ul><p id="3786" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我计划用一些GraphQL对象类型来保存关于我们的<code class="fe lz ma mb mc b">Book Store</code>中的<code class="fe lz ma mb mc b">Books</code>的一些信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="0a54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我用两个对象类型和一个枚举类型来描述一个<code class="fe lz ma mb mc b">Book</code>。</p><p id="ec39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">Book</code>类型有以下字段:</p><ul class=""><li id="189e" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">title</code> —字符串类型，不可空</li><li id="0753" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">book_id</code> — ID类型</li><li id="8207" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">genre</code> —枚举类型</li><li id="6dc9" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">author</code>—<code class="fe lz ma mb mc b">Author</code>类型的数组，不可空</li></ul><p id="b580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">Author</code>类型:</p><ul class=""><li id="e3fc" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">name</code> —字符串类型，不可空</li><li id="c9fb" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">mail</code> —字符串类型</li></ul><p id="751c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">BookGenre</code>枚举类型:</p><ul class=""><li id="d950" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated">有两个值(<code class="fe lz ma mb mc b">FICTION</code>、<code class="fe lz ma mb mc b">NONFICTION</code>)</li></ul><p id="ff6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上类型是处理<code class="fe lz ma mb mc b">Books</code>信息的基本类型。</p><p id="f1a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们继续定义GraphQL服务的入口点。</p><h2 id="999e" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">查询类型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="7210" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我有上面的<code class="fe lz ma mb mc b">Query</code>类型，它有以下三个字段:</p><ul class=""><li id="09e0" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">book</code> —通过在参数中提供<code class="fe lz ma mb mc b">book_id</code>来获取图书详细信息</li><li id="aa4c" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">books</code> —获取可用书籍列表</li><li id="2765" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">getbooks</code> —获取所请求流派的书籍列表。<code class="fe lz ma mb mc b">getgenre</code>参数是可选的。它有默认值<code class="fe lz ma mb mc b">FICTION</code>。</li></ul><pre class="kg kh ki kj gt oi mc oj ok aw ol bi"><span id="ced3" class="no me iq mc b gy om on l oo op">type GetBookResult{<br/>    <em class="lv">isexists</em>: Boolean!<br/>    <em class="lv">book</em>: Book<br/>}</span></pre><p id="f7c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">GetBookResult</code>类型有两个字段:</p><ul class=""><li id="a3f0" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">isexists</code> —布尔类型，不可空。它们告诉给定的<code class="fe lz ma mb mc b">book_id</code>书籍信息是否存在</li><li id="bcae" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">book </code> —书籍类型</li></ul><h2 id="83d3" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">突变类型</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="94ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">突变类型有三个字段:</p><ul class=""><li id="d6ee" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">add_book</code> —通过提供输入在我们的书店中创建图书资源，响应是请求的状态。</li><li id="01af" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">update_book</code> —更新现有的图书信息，响应是请求的状态。</li><li id="efeb" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">delete_book</code> —删除具有给定图书id的图书，并返回操作状态。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="8ec2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上类型用于突变类型的<code class="fe lz ma mb mc b">add_book</code>字段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="05b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">UpdateInput</code>和<code class="fe lz ma mb mc b">PutStatus</code>类型用于<code class="fe lz ma mb mc b">Mutation</code>类型的<code class="fe lz ma mb mc b">update_book</code>字段。</p><pre class="kg kh ki kj gt oi mc oj ok aw ol bi"><span id="49d8" class="no me iq mc b gy om on l oo op">type DeleteStatus{<br/>    <em class="lv">iserror</em>: Boolean!<br/>    <em class="lv">description</em>: String<br/>}</span></pre><p id="8dce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe lz ma mb mc b">DeleteStatus</code>类型用于<code class="fe lz ma mb mc b">Mutation</code>类型的<code class="fe lz ma mb mc b">delete_book</code>字段。</p><p id="73a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们到达了模式定义的末尾。</p><h2 id="b8ef" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">产生</h2><p id="749d" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">一旦我们完成了我们的模式，我们需要使用<code class="fe lz ma mb mc b">go run github.com/99designs/gqlgen generate</code>生成gqlgen文件。以下是它创建的所有命令:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/1b1ad6aa41ae48f70044f4be3612a4a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdG2jgaBys4a1vv-7UQdXQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">缺少go.sum条目和解析</p></figure><blockquote class="ls lt lu"><p id="0a5e" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">在运行这个命令时，如果你遇到一些错误，比如缺少go.sum条目，那么就把这些包添加到go.sum中。大多数情况下<code class="fe lz ma mb mc b"><em class="iq">go get github.com/99designs/gqlgen</em></code>会解决这个错误。然后执行生成命令。</p></blockquote><p id="d683" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">至此，我们已经为我们的模式生成了Go文件。开始实施我们的解决方案。</p><h1 id="dc34" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">GraphQL服务器实现</h1><h1 id="1557" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">内存存储</h1><p id="2761" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">正如我提到的，我将使用内存中的数据存储(简单地说是一个变量)来存储书的信息。</p><p id="83ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">初始化<code class="fe lz ma mb mc b">resolver.go</code>中的<code class="fe lz ma mb mc b">BOOKSTORE</code>变量。</p><p id="00ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看<code class="fe lz ma mb mc b">resolver.go</code>文件的内容:</p><pre class="kg kh ki kj gt oi mc oj ok aw ol bi"><span id="12b2" class="no me iq mc b gy om on l oo op">package graph</span><span id="9914" class="no me iq mc b gy or on l oo op">// This file will not be regenerated automatically.<br/>//<br/>// It serves as dependency injection for your app, add any dependencies you require here.</span><span id="8317" class="no me iq mc b gy or on l oo op">type Resolver struct{}</span></pre><p id="0b4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们将我们的<code class="fe lz ma mb mc b">BOOKSTORE</code>(列表<code class="fe lz ma mb mc b">Books</code>)添加到<code class="fe lz ma mb mc b">Resolver</code>结构中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="1f2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有设置，除了解析器实现。</p><h1 id="243d" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">解析器实现</h1><p id="e551" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">当我们打开文件<code class="fe lz ma mb mc b">graph/schema.resolvers.go</code>时，我们可以看到gqlgen generate命令生成的初始样板代码<code class="fe lz ma mb mc b">generate</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="7550" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们必须修改我们的解析器方法来执行我们的需求。</p><p id="9e2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">修改的方法包括以下几种:</p><ul class=""><li id="e1e3" class="na nb iq ky b kz la lc ld lf od lj oe ln of lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">AddBook</code></li><li id="a29e" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">UpdateBook</code></li><li id="7f88" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">DeleteBook</code></li><li id="6da5" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">Book</code></li><li id="a9ee" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">Books</code></li><li id="fee9" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated"><code class="fe lz ma mb mc b">Getbooks</code></li></ul><p id="3b15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上什么都有！</p><h2 id="ec55" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated"><code class="fe lz ma mb mc b">AddBook</code></h2><p id="6e3b" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">在实现我们的<code class="fe lz ma mb mc b">AddBook</code>方法之前，我们需要一个逻辑来生成唯一的图书ID。</p><p id="1cf7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是我在添加新书时查找下一个图书id的实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="5859" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们的<code class="fe lz ma mb mc b">AddBook</code>的方法实现开始了:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">addbook方法实现</p></figure><h2 id="ceac" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">更新手册</h2><p id="d797" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要更新现有图书，请执行以下操作:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="bc83" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">删除书籍</h2><p id="c3ba" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要从<code class="fe lz ma mb mc b">BOOKSTORE</code>中删除一本书，下面是代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="6c40" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">书，书，拿书</h2><p id="b81f" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">要按ID获取图书，按流派获取图书列表，或获取所有图书，以下是操作方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h1 id="c676" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">完整的解析器代码</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="e2a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经很好地实现了，让我们继续为客户服务。</p><h1 id="7bf4" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">为客户服务</h1><p id="a96a" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">通过<code class="fe lz ma mb mc b">go run server.go</code>启动服务器。</p><blockquote class="ls lt lu"><p id="f865" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">server.go是在初始化gqlgen项目时生成的go文件。这个server.go将为查询和变异指出我们的解析器。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/eb21f41ac62a95d131b9dedaefd57386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYrzVHEclh1CFNSpzIZtlQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">去运行server.go</p></figure><h2 id="a62b" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">突变地址簿</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/78d3a138068190eee983ddd20c316abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9kywll2kIKOCUnJclk3mXg.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="af81" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">查询书</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/c872f1f15ce2b9747c275a2b9c0cd8ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7RNJGJmfwPZQYYi5e4GWnQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="c205" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">突变更新手册</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/5defc7e27127f86caa043d1df14c4d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0j85mmy0BQkcAXcZK6h6A.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="0bc4" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">查询书籍</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/84cdee12175f722150d9903f87231a2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHfdvLjK4i5S3Oli_IditQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="646e" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">查询GetBooks</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/c6d9a1b06cad3313dd7139f8f6f84187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_loeM1W8WGo6ZVrpX_MOg.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="c3d7" class="no me iq bd mf np nq dn mj nr ns dp mn lf nt nu mp lj nv nw mr ln nx ny mt nz bi translated">突变删除书</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/8d2f5b737e15ec1204bc993023086a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t97FKK0Cs91ZZeqxPPUCgg.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="efcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用任何GraphQL客户端来访问这个服务。</p><h1 id="f636" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">摘要</h1><p id="a5f6" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">在本文中，我们看到了如何使用gqlgen库(模式优先方法)在Golang中构建我们自己的GraphQL服务器。</p><p id="5b63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在我的<a class="ae kv" href="https://github.com/LogeshVel/graphql_server_gqlgen" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到这个项目。感谢阅读。</p></div></div>    
</body>
</html>