<html>
<head>
<title>What’s New in React 18?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React 18有什么新功能？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/whats-new-in-react-18-f69fb8b0619f?source=collection_archive---------7-----------------------#2022-03-01">https://betterprogramming.pub/whats-new-in-react-18-f69fb8b0619f?source=collection_archive---------7-----------------------#2022-03-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="efe2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这里有3个即将推出的React特性，你应该会感到兴奋</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5b429657902b2ba9db858ce1565771c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R90VS5b1yY3P2-0C"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@oulashin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">肖恩·奥拉欣</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b515" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React团队已经宣布了发布React 18新版本的计划。现在它处于测试阶段。作为一名React开发人员，我希望了解新的特性。</p><p id="7969" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我们来讨论React 18将如何更容易地改变我们的生活。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6bf0" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">新建根API</h1><p id="708b" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">根API是指向顶层数据结构的指针，React利用它来跟踪要呈现的树。现在React有两个根API:</p><ul class=""><li id="038d" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><strong class="ky ir">遗留旧根API </strong> —带有<code class="fe nf ng nh ni b">ReactDOM.render</code>的现有API。在新的React版本之后，此API将被弃用</li><li id="b500" class="mw mx iq ky b kz nj lc nk lf nl lj nm ln nn lr nb nc nd ne bi translated"><strong class="ky ir">新根API </strong> —带有<code class="fe nf ng nh ni b">ReactDOM.createRoot</code>的新根API。这个根在React 18中以全新的改进和特性工作</li></ul><p id="7851" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们检查并比较这两个根API。下面是传统根API的典型用法:</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="0ffb" class="ns ma iq ni b gy nt nu l nv nw">import ReactDOM from 'react-dom';<br/>import App from './App';<br/><br/>ReactDOM.render(&lt;App /&gt;, document.getElementById('app'));</span></pre><p id="c432" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们使用新的根API修改前面的代码:</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="4f79" class="ns ma iq ni b gy nt nu l nv nw">import ReactDOM from 'react-dom';<br/>import App from './App';<br/><br/>// create a root<br/>const root = ReactDOM.createRoot(document.getElementById('app'));<br/><br/>// render an element to the root<br/>root.render(&lt;App /&gt;);</span></pre><p id="5061" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有太大的区别，除了根是一个可以传递的对象。例如，如果您希望您编写的某个函数能够更新根，您不需要向它传递一个DOM，相反，您应该传递根对象。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a93e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">自动配料</h1><p id="fb94" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">批处理是一次重新渲染中的多次反应状态更新。</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="f96d" class="ns ma iq ni b gy nt nu l nv nw">function Counter() {<br/>  const [count, setCount] = useState(0);<br/>  const [disabled, setDisabled] = useState(false);<br/><br/>  function handleClick() {<br/>    setCount(c =&gt; c + 1); // does not re-render yet<br/>    setDisabled(f =&gt; !f); // does not re-render yet<br/>    // React will only re-render once (that's batching!)<br/>  }<br/><br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;{count}&lt;/h1&gt;<br/>      &lt;button disabled={disabled} onClick={handleClick}&gt;<br/>        Increment<br/>      &lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="ea85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上，我们有<code class="fe nf ng nh ni b">count</code>和<code class="fe nf ng nh ni b">disabled</code>两种反应状态。当我们点击一个按钮时，React总是批处理并在一次重新渲染中更新它们。</p><p id="30f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这避免了不必要的重新渲染，提高了我们的性能。异步请求呢？React 17不进行批处理，而是进行两次独立的更新。</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="ce28" class="ns ma iq ni b gy nt nu l nv nw">function Counter() {<br/>  const [count, setCount] = useState(0);<br/>  const [disabled, setDisabled] = useState(false);<br/><br/>  function handleClick() {<br/>    doPostRequest()<br/>      .then(() =&gt; {<br/>        setCount(c =&gt; c + 1); // does re-render<br/>        setDisabled(f =&gt; !f); // does re-render<br/>      })<br/>  }<br/><br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h1&gt;{count}&lt;/h1&gt;<br/>      &lt;button disabled={disabled} onClick={handleClick}&gt;<br/>        Increment<br/>      &lt;/button&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="f388" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在React 18中，我们可以在<code class="fe nf ng nh ni b">promises</code>、<code class="fe nf ng nh ni b">setTimeout</code>、<code class="fe nf ng nh ni b">native event handlers</code>或任何其他事件中批量更新状态。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="2a5d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">startTransition API</h1><p id="afe4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在我们进入<code class="fe nf ng nh ni b">startTransition</code>之前，让我们检查一下React中有什么样的状态更新:</p><ul class=""><li id="f355" class="mw mx iq ky b kz la lc ld lf my lj mz ln na lr nb nc nd ne bi translated"><strong class="ky ir">紧急更新</strong> —打字、点击、敲击等直接交互。当它发生时，我们期待立即的反应。否则，我们会认为我们的应用程序有问题</li><li id="4df9" class="mw mx iq ky b kz nj lc nk lf nl lj nm ln nn lr nb nc nd ne bi translated"><strong class="ky ir">过渡更新</strong> — UI从一个视图过渡到另一个视图。当我们不期望在UI上看到每个中间变化时，我们可以描述它们</li></ul><p id="44ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b">startTransition</code>解决什么问题？例如，您有一个包含列表和输入的页面。当您输入内容时，您的列表将根据输入值进行过滤。您可以存储和更新状态中的输入值，并使用该值来过滤列表:</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="770b" class="ns ma iq ni b gy nt nu l nv nw">setInputValue(inputValue); // Urgent: show what was typed</span><span id="ba6d" class="ns ma iq ni b gy nx nu l nv nw">setSearchQuery(inputValue); // // Not urgent: show filtered list</span></pre><p id="e70d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户在输入中输入任何值时，我们应该立即显示响应。但是当我们过滤时，就需要更多的时间。因为我们正在搜索和显示一个过滤列表。因此，开发人员经常为此使用<a class="ae kv" href="https://www.freecodecamp.org/news/javascript-debounce-example/" rel="noopener ugc nofollow" target="_blank">去抖</a>。</p><p id="7fcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在React 18中，由<code class="fe nf ng nh ni b">startTransition</code> API解决:</p><pre class="kg kh ki kj gt no ni np nq aw nr bi"><span id="37a1" class="ns ma iq ni b gy nt nu l nv nw">import { startTransition } from 'react';<br/><br/>setInputValue(input);<br/><br/>startTransition(() =&gt; {<br/>  // Transition: show filtered list<br/>  setSearchQuery(input);<br/>});</span></pre><p id="ffae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想了解更多关于这个<code class="fe nf ng nh ni b">startTransition</code>的信息，请看下面的讨论:</p><div class="ny nz gp gr oa ob"><a href="https://github.com/reactwg/react-18/discussions/41" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">新功能:开始过渡讨论#41 reactwg/react-18</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kp ob"/></div></div></a></div></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6e80" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="1821" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">感谢阅读，希望这篇文章对你有用。编码快乐！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="af92" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">资源</h1><div class="ny nz gp gr oa ob"><a href="https://github.com/reactwg/react-18/discussions?discussions_q=root&amp;page=1" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">reactwg/react-18</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op kp ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://ru.reactjs.org/blog/2021/06/08/the-plan-for-react-18.html" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">React 18 - React博客的计划</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">React团队很高兴分享一些更新:我们已经开始了React 18版本的工作，这将是我们的下一个…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">ru.reactjs.org</p></div></div><div class="ok l"><div class="or l om on oo ok op kp ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://dev.to/alexeagleson/learnings-from-react-conf-2021-17lg" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">从React Conf 2021学到的东西</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">我最近有机会参加了2021年数字反应会议，并听取了一些来自一个真正伟大的名单…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">开发到</p></div></div><div class="ok l"><div class="os l om on oo ok op kp ob"/></div></div></a></div></div></div>    
</body>
</html>