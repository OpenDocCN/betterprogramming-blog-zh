<html>
<head>
<title>A Flexible SwiftUI Navigation Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">灵活的SwiftUI导航库</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-flexible-swiftui-navigation-library-f3d28e75a506?source=collection_archive---------10-----------------------#2021-01-15">https://betterprogramming.pub/a-flexible-swiftui-navigation-library-f3d28e75a506?source=collection_archive---------10-----------------------#2021-01-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5148" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">SwiftUI的导航堆栈</h2><div class=""/><div class=""><h2 id="d12c" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">解决NavigationView和NavigationLink的一些缺点</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/a941662bb8348a2ea134db1518ccf43a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-a65mKD6sj1bWyEwjm6LQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@photoholgic?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">摄影</a>在<a class="ae lh" href="https://unsplash.com/s/photos/swallow-flight?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2570" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">任何与SwiftUI打过交道的人也都接触过它的新型导航:你将SwiftUI视图嵌入到一个<code class="fe me mf mg mh b">NavigationView</code>中，并通过一个<code class="fe me mf mg mh b">NavigationLink</code>进行转换。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">NavigationView/NavigationLink用法示例</p></figure><p id="216e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">SwiftUI还为模态导航提供了<code class="fe me mf mg mh b">.sheet(isPresented:)</code>修改器。</p><p id="ea00" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">和SwiftUI一样，这一切都很优雅。😎</p><p id="2257" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，一旦你真的想实现一个真正的应用程序，而不仅仅是“你好，世界！例如，您遇到了某些问题:</p><ul class=""><li id="c9b5" class="mk ml it lk b ll lm lo lp lr mm lv mn lz mo md mp mq mr ms bi translated"><code class="fe me mf mg mh b">NavigationView</code> / <code class="fe me mf mg mh b">NavigationLink</code>不支持自定义过渡动画。</li><li id="4993" class="mk ml it lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">没有根pop或多重pop；您必须在整个视图层次中手动传递目标视图的状态变量。</li><li id="2933" class="mk ml it lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">如果您显示几个模态视图，您不能一次关闭所有视图。而且模态全面屏只有iOS 14+支持。</li><li id="2e95" class="mk ml it lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">不提供没有过渡动画的导航。有变通办法，但它们不再优雅。</li><li id="2adf" class="mk ml it lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">如果您随后修补您自己的转换解决方案，您会意识到向后转换必须在向前转换期间定义，并且不能在以后替换。然后你会偶然发现其他各种各样的SwiftUI怪事。</li></ul><p id="c1c7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当然，新技术会遇到初期问题，但一年后，我们仍然可以在iOS 14中使用它们。😞</p><p id="4d36" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我编写了自己的SwiftUI导航库来解决上述所有问题。🤓</p><p id="586b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我把它叫做NavigationStack，你可以在GitHub上找到它:</p><div class="my mz gp gr na nb"><a href="https://github.com/indieSoftware/NavigationStack" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd jd gy z fp ng fr fs nh fu fw jc bi translated">独立软件/导航堆栈</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">GitHub Page NavigationStack是一个定制的SwiftUI解决方案，用于在视图之间导航。这是一个更灵活的选择…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np lb nb"/></div></div></a></div></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="7f1f" class="nx ny it bd nz oa ob oc od oe of og oh ki oi kj oj kl ok km ol ko om kp on oo bi translated">导航堆栈简介</h1><p id="9f46" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated">NavigationStack的工作方式与SwiftUI的<code class="fe me mf mg mh b">NavigationView</code>非常相似。您将自己的SwiftUI视图嵌入到一个<code class="fe me mf mg mh b">NavigationStackView</code>中，而不是一个<code class="fe me mf mg mh b">NavigationView</code>中。不使用<code class="fe me mf mg mh b">NavigationLink</code>，而是调用<code class="fe me mf mg mh b">NavigationModel</code>类型的<code class="fe me mf mg mh b">EnvironmentObject</code>上提供的方法，比如<code class="fe me mf mg mh b">pushContent()</code>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">如何使用NavigationStack库推送视图的示例</p></figure><p id="9f58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">后退导航也可以通过<code class="fe me mf mg mh b">NavigationModel</code>操作。以下是pop过渡的一个示例:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">如何使用NavigationStack库返回到上一个视图的示例</p></figure><p id="db1d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此<code class="fe me mf mg mh b">NavigationModel</code>在所有子视图中都可以作为<code class="fe me mf mg mh b">EnvironmentObject</code>使用，当然，它必须被注入到视图层次的根视图中:</p><pre class="ks kt ku kv gt ou mh ov ow aw ox bi"><span id="f2d9" class="oy ny it mh b gy oz pa l pb pc">let myRootView = MyRootView().environmentObject(NavigationModel())</span></pre><p id="bdeb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">实际上，差不多就是这样。简单，优雅，敏捷，嗯？😄</p><h2 id="d35e" class="oy ny it bd nz pd pe dn od pf pg dp oh lr ph pi oj lv pj pk ol lz pl pm on iz bi translated">过渡</h2><p id="7746" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated"><code class="fe me mf mg mh b">NavigationModel</code>不仅支持push和pop导航，还有<code class="fe me mf mg mh b">presentContent()</code>和<code class="fe me mf mg mh b">dismissContent()</code>的便捷方法来模拟模态转换。使用<code class="fe me mf mg mh b">fadeInContent()</code>和<code class="fe me mf mg mh b">fadeOutContent()</code>，您可以切换到另一个视图。</p><p id="004e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些方便的方法在内部使用来自<code class="fe me mf mg mh b">NavigationModel</code>的方法<code class="fe me mf mg mh b">showView()</code>和<code class="fe me mf mg mh b">hideView()</code>。如果提供的方法不够，您还可以直接使用<code class="fe me mf mg mh b">showView()</code>和<code class="fe me mf mg mh b">hideView()</code>并创建自己的过渡。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">如何使用自定义转场的示例</p></figure><p id="4cfb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里不仅使用了<code class="fe me mf mg mh b">.easeOut</code>动画类型，还使用了单独的过渡动画。定义了这个过渡动画，它结合了缩放动画和不透明度动画。</p><p id="874d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">原点视图——即您想要导航离开的视图——被称为<code class="fe me mf mg mh b">defaultView</code>。因此,<code class="fe me mf mg mh b">alternativeView</code>是目标视图，即您想要导航到的视图。两者都可以单独制作动画。例如，旧视图淡出，而新视图移入。</p><p id="c101" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">反向动画与过渡动画同时自动定义。如果您调用<code class="fe me mf mg mh b">NavigationModel</code>上的<code class="fe me mf mg mh b">hideTopViewWithReverseAnimation()</code>，您可以返回到前一视图并使用反向动画。但是，您也可以使用<code class="fe me mf mg mh b">hideTopView()</code>返回到之前的视图，并指定要使用的特定过渡动画。当它真的回去的时候就可以了。</p><p id="e2fa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以毫不费力地创建自己的过渡动画。在图书馆的资料中，如果你想更深入地研究这个问题，你可以找到这样的例子。😉</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/1926e8dae62648528a7e61b51266c2cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*BNQ2FV_WrwmLxwwzeAMgXA.gif"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">该库提供的一些自定义过渡动画</p></figure><h2 id="9768" class="oy ny it bd nz pd pe dn od pf pg dp oh lr ph pi oj lv pj pk ol lz pl pm on iz bi translated">视图标识符</h2><p id="f3c0" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated">作为一名理解干净代码的iOS开发人员，字符串<code class="fe me mf mg mh b">MyRootView</code>的代码味道肯定会让你震惊。🧐</p><p id="6a09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个标识符是必要的，这样可以处理一个特殊的视图。通过这种方式，您可以明确地说出想要交换哪个视图，或者想要导航回哪个视图。由于有了这个标识符，即使中间有另一个视图级别，也可以直接跳到根视图。</p><p id="e6da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是，建议将字符串标识符转换为常数，并使用常数来代替。这降低了打字错误的风险。如果常量直接从视图名称自动创建就更好了。😁</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="mi mj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">如何使用常量作为导航字符串标识符的示例</p></figure><p id="d0e9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有了静态常量<code class="fe me mf mg mh b">id</code>，子视图就可以指向<code class="fe me mf mg mh b">MyRootView</code>并导航到它。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="bb1c" class="nx ny it bd nz oa ob oc od oe of og oh ki oi kj oj kl ok km ol ko om kp on oo bi translated">结论</h1><p id="52f8" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated">NavigationStack库的工作方式与SwiftUI的单页导航方式类似，即视图层次结构中的一个子视图被另一个子视图替换。</p><p id="e0a3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通过我自己的实现，我能够解决SwiftUI标准导航的一些问题和缺点。当然还有一些改进的空间，但是我希望有人会觉得它有用。😊</p><p id="c7f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">更多信息，可以查看GitHub 上的<a class="ae lh" href="https://github.com/indieSoftware/NavigationStack" rel="noopener ugc nofollow" target="_blank"> NavigationStack。</a></p></div></div>    
</body>
</html>