<html>
<head>
<title>Build a Job Survey CLI Tool With Go Using the Strategy Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用策略模式构建一个带有Go的工作调查CLI工具</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/lets-build-a-basic-job-survey-cli-tool-with-go-using-the-strategy-pattern-17632ea52d2b?source=collection_archive---------1-----------------------#2022-10-22">https://betterprogramming.pub/lets-build-a-basic-job-survey-cli-tool-with-go-using-the-strategy-pattern-17632ea52d2b?source=collection_archive---------1-----------------------#2022-10-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c171" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">决定你下一份工作的门户</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c0e7fc38a53752373f186764b0588cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDBu5XfjqGiZMjfVoUYi-A.png"/></div></div></figure><p id="6f19" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我在高中的时候，我们的顾问老师让我们参加一项调查，根据我们的兴趣和成绩来决定哪个系最适合我们。放心吧！我不会讨论那种方法的愚蠢。</p><p id="6168" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，我必须说，你的个性、能力和心态会随着时间的推移而演变和改变。这种进化取决于你成长的意愿。别忘了！正如C.S .德韦克在《T4心态》中所说的那样:一次失败并不能定义你。这只是一个你需要面对、处理、借鉴的问题。</p><p id="8e15" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以这种调查并不能对你做出最终的决定，尤其是要看你的成绩。</p><p id="4327" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在怀疑了这种有缺陷的调查逻辑之后，说这篇文章是关于调查CLI工具是很奇怪的。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt lw lx ly lz aw ma bi"><span id="cbf4" class="mb mc iq lx b gy md me l mf mg"><a class="ae ln" href="https://asciinema.org/a/531177" rel="noopener ugc nofollow" target="_blank"><strong class="lx ir">Working demo</strong></a>: <a class="ae ln" href="https://asciinema.org/a/531177" rel="noopener ugc nofollow" target="_blank">https://asciinema.org/a/531177</a></span><span id="65b2" class="mb mc iq lx b gy mh me l mf mg"><a class="ae ln" href="https://github.com/dilaragorum/job-survey" rel="noopener ugc nofollow" target="_blank"><strong class="lx ir">Source Code</strong></a><strong class="lx ir">: </strong><a class="ae ln" href="https://github.com/dilaragorum/job-survey" rel="noopener ugc nofollow" target="_blank">https://github.com/dilaragorum/job-survey</a></span><span id="2af4" class="mb mc iq lx b gy mh me l mf mg"><a class="ae ln" href="https://github.com/spf13/cobra" rel="noopener ugc nofollow" target="_blank"><strong class="lx ir">Cobra</strong></a>: Help us to develop a very basic CLI tool.</span><span id="2ecb" class="mb mc iq lx b gy mh me l mf mg"><a class="ae ln" href="https://github.com/AlecAivazis/survey" rel="noopener ugc nofollow" target="_blank"><strong class="lx ir">Survey</strong></a>: Help us to ask questions and get answers from users.</span></pre><h1 id="aa00" class="mi mc iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">项目概述</h1><p id="e5ad" class="pw-post-body-paragraph kr ks iq kt b ku mz jr kw kx na ju kz la nb lc ld le nc lg lh li nd lk ll lm ij bi translated">在调查中，第一个问题是，“你想做哪份工作？”。目前，有三种工作选择(宇航员、植物学家和软件开发员)。</p><p id="c87b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">根据你的选择，你会遇到不同的关于你想要的工作的问题。比如你选了宇航员，你会看到下面这些问题。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/b16cc56bf5af0c7f6ae7793bfe82b2a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5VfRJmPI_ij4Ygrb-KqiJw.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">图1-宇航员示例</p></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="fdf4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个项目最大的挑战是什么？你怎么想呢?</p><p id="4122" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有各种各样的工作，不同的问题和评估技术。因此，我们需要能够支持添加新的工作选项、新的问题等。</p><p id="2e55" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果能把问题理解清楚，如何高效解决这个问题？给你…</p><p id="b34c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">认识我们的朋友<a class="ae ln" href="https://refactoring.guru/design-patterns/strategy" rel="noopener ugc nofollow" target="_blank">战略模式</a>。</p><p id="c2ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当这个模式在我们的项目中实现时，所有的作业都有自己的策略方法，我们的程序会根据你的选择决定哪个策略起作用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/75174b25073eefafafb785463e3956a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FeNTytkOmjJ6LngRO2oCvg.png"/></div></div><p class="nf ng gj gh gi nh ni bd b be z dk translated">图2:应用的策略模式</p></figure><h2 id="5c0b" class="mb mc iq bd mj nk nl dn mn nm nn dp mr la no np mt le nq nr mv li ns nt mx nu bi translated">作业检查器界面</h2><pre class="kg kh ki kj gt lw lx ly lz aw ma bi"><span id="da54" class="mb mc iq lx b gy md me l mf mg">type JobChecker interface {<br/>   Check(answersBytes []byte) (CheckResult, error)<br/>   GetQuestions() []*survey.Question<br/>}</span></pre><p id="7aa8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们用所有的作业结构实现这个接口，如下所示。</p><ol class=""><li id="304e" class="nv nw iq kt b ku kv kx ky la nx le ny li nz lm oa ob oc od bi translated"><code class="fe oe of og lx b">astronaut.go</code></li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="cf3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.<em class="lo"> </em> <code class="fe oe of og lx b">botanist.go</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="6ed9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3.<em class="lo"> </em> <code class="fe oe of og lx b">software_developer.go</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="5d4e" class="mi mc iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">把它们放在一起</h1><p id="2e0e" class="pw-post-body-paragraph kr ks iq kt b ku mz jr kw kx na ju kz la nb lc ld le nc lg lh li nd lk ll lm ij bi translated">我们使用<code class="fe oe of og lx b">map</code>将所有策略存储在一个地方。根据您的选择，我们将浏览这张地图，并找到合适的策略。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="7bb8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们使用映射的键作为作业的名称，使用值作为作业结构，如下所示。在初始化阶段，我们使用了<code class="fe oe of og lx b"><a class="ae ln" href="https://www.digitalocean.com/community/tutorials/understanding-init-in-goü" rel="noopener ugc nofollow" target="_blank">go init</a></code> <a class="ae ln" href="https://www.digitalocean.com/community/tutorials/understanding-init-in-goü" rel="noopener ugc nofollow" target="_blank"> </a>的方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="ad0e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们的程序使用这个映射找到正确的作业结构，并调用这个结构的<code class="fe oe of og lx b">Check</code>和<code class="fe oe of og lx b">GetQuestions</code>方法，并将结果返回给用户。</p><pre class="kg kh ki kj gt lw lx ly lz aw ma bi"><span id="ebe8" class="mb mc iq lx b gy md me l mf mg">questions := strategy.Job.GetQuestions(job)</span><span id="87f0" class="mb mc iq lx b gy mh me l mf mg">// ..</span><span id="4df5" class="mb mc iq lx b gy mh me l mf mg">message, err := strategy.Job.Check(desired.Job, answersBytes)<br/>if err != nil {<br/>   return err<br/>}</span></pre><p id="f8f7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这样，我们的程序不知道我们在作业结构中的具体策略。</p><p id="6ad0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，通过提供<a class="ae ln" href="https://en.wikipedia.org/wiki/Loose_coupling" rel="noopener ugc nofollow" target="_blank">松耦合</a>，我们的代码库仍然易于维护和扩展。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oi l"/></div></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="2c94" class="mi mc iq bd mj mk oj mm mn mo ok mq mr jw ol jx mt jz om ka mv kc on kd mx my bi translated">奖金</h1><p id="b44e" class="pw-post-body-paragraph kr ks iq kt b ku mz jr kw kx na ju kz la nb lc ld le nc lg lh li nd lk ll lm ij bi translated"><a class="ae ln" href="https://github.com/goreleaser/goreleaser" rel="noopener ugc nofollow" target="_blank"> goreleaser </a>:不同的用户有不同的操作系统和架构。我们需要基于这些系统编译和发布我们的应用程序，以使他们能够使用我们的应用程序。一种更简单的方法是使用<code class="fe oe of og lx b">goreleaser</code>工具。有了基本配置，我们就可以实现我们的目标。</p><p id="7f24" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>