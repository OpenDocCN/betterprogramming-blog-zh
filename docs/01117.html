<html>
<head>
<title>Using Python Pandas With Excel Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Python熊猫与Excel工作表结合使用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-python-pandas-with-excel-d5082102ca27?source=collection_archive---------0-----------------------#2019-08-16">https://betterprogramming.pub/using-python-pandas-with-excel-d5082102ca27?source=collection_archive---------0-----------------------#2019-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0f6c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python库执行基本的Excel操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/969c22d4d4d5fd2e5f8351047b9e8e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*Dxp_PN37viCezdWTEGMSQQ.jpeg"/></div></figure><p id="e17f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这篇文章中，我将演示如何在Excel中使用Pandas库。我们将使用基本的excel表格操作，如创建新表格、添加批量数据、追加数据、读取数据、格式化数据和添加图表。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="67db" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">装置</h1><p id="ebb7" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">执行以下命令来安装Pandas、xlsxwriter、xlrd和openpyxl库。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="5096" class="mv lu it mr b gy mw mx l my mz">pip install pandas</span><span id="45d7" class="mv lu it mr b gy na mx l my mz">pip install xlsxwriter</span><span id="0dd8" class="mv lu it mr b gy na mx l my mz">pip install xlrd</span><span id="cfeb" class="mv lu it mr b gy na mx l my mz">pip install openpyxl</span></pre></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="fd38" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">创建Excel表格</h1><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="f9ed" class="mv lu it mr b gy mw mx l my mz">import<strong class="mr iu"> </strong>pandas as<strong class="mr iu"> </strong>pd</span><span id="cc8f" class="mv lu it mr b gy na mx l my mz">writer = pd.ExcelWriter('demo.xlsx', engine='xlsxwriter')</span><span id="ceab" class="mv lu it mr b gy na mx l my mz">writer.close()</span></pre><p id="e9e2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这段代码将用名为<code class="fe nb nc nd mr b">Sheet1</code>的默认工作表创建一个新的<code class="fe nb nc nd mr b">demo.xlsx</code>文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/39e8b1b9e0aed593bdf6b09b3b2f4eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0bwFC6kUhDoAjh-5npTv9w.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">带有工作表Sheet1的空demo.xlsx</p></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="90b7" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">向Excel表中添加批量数据</h1><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="125b" class="mv lu it mr b gy mw mx l my mz">import pandas as pd<br/><br/># dataframe Name and Age columns<br/>df = pd.DataFrame({'Name': ['A', 'B', 'C', 'D'],<br/>                   'Age': [10, 0, 30, 50]})<br/><br/># Create a Pandas Excel writer using XlsxWriter as the engine.<br/>writer = pd.ExcelWriter('demo.xlsx', engine='xlsxwriter')<br/><br/># Convert the dataframe to an XlsxWriter Excel object.<br/>df.to_excel(writer, sheet_name='Sheet1', index=False)<br/><br/># Close the Pandas Excel writer and output the Excel file.<br/>writer.close()</span></pre><p id="f6a6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这段代码将添加两列，<code class="fe nb nc nd mr b">Name</code>和<code class="fe nb nc nd mr b">Age</code>，并向<code class="fe nb nc nd mr b">demo.xlsx</code>的<code class="fe nb nc nd mr b">Sheet1</code>发送数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nn"><img src="../Images/972448142e16b5ce190f636d7fde850d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wWsMy2tqpnx55EjJ8dc0qQ.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">向excel表中添加批量数据</p></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="4ac0" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">从Excel表中读取数据</h1><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="6415" class="mv lu it mr b gy mw mx l my mz"><strong class="mr iu">import </strong>pandas <strong class="mr iu">as </strong>pd</span><span id="dc13" class="mv lu it mr b gy na mx l my mz">reader = pd.read_excel(r'demo.xlsx')</span><span id="0eea" class="mv lu it mr b gy na mx l my mz">print(reader)</span></pre><p id="5b02" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这段代码将打印excel表格中的所有数据。读者变量是一种熊猫的数据框。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="1570" class="mv lu it mr b gy mw mx l my mz">Name  Age<br/>0    A   10<br/>1    B    0<br/>2    C   30<br/>3    D   50</span></pre></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="9cd6" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">在Excel表的末尾追加数据</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="bf28" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这段代码将在excel的末尾追加数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/515ff3e32c36d41357e1cf013b464c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-k3648XCS4VeNGDL5BpbQ.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">附加在excel末尾的数据</p></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="5300" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">向输出添加条件格式</h1><p id="1861" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">我们可以使用xlsxwriter库格式化单元格:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="1fc8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">上面的代码将为年龄列单元格添加不同的颜色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/16c809d5d4f4b899e3341d1c45f26ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5dt43PwyVj4e3_sKmEFGQ.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">条件格式化数据</p></figure></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="0e0c" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">向输出添加图表</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="43e4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">上面的代码将从Panda的数据框向Excel表添加图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/755bd081ca1e215f789666dd85b7715e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7no0Dv9aOkmkuji_ty-CKg.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">来自熊猫数据框架的图表</p></figure><p id="04ef" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">感谢您阅读这篇文章。如果你喜欢，点击👏给它打分，满分为50分 <strong class="ks iu">，并与您的朋友分享。这对我意义重大。</strong></p><p id="5c68" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">你想看看我的其他文章吗？T13】</p><div class="nr ns gp gr nt nu"><a href="https://medium.com/aubergine-solutions/working-with-excel-sheets-in-python-using-openpyxl-4f9fd32de87f" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">使用openpyxl在Python中处理Excel表格</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">在本教程中，我们将通过openpyxl演示如何在python中使用Excel表格。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">medium.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ko nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://medium.com/aubergine-solutions/partial-string-search-in-apache-solr-4b9200e8e6bb" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">Apache Solr中的部分字符串搜索</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">在本教程中，我们将看到如何为部分字符串搜索配置Apache Solr的演示。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">medium.com</p></div></div><div class="od l"><div class="oj l of og oh od oi ko nu"/></div></div></a></div><div class="nr ns gp gr nt nu"><a href="https://medium.com/aubergine-solutions/django-jenkins-integration-for-django-project-3fe3251cd6f4" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">django项目的django-jenkins一体化</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">在本教程中，我们将看到如何为django项目集成django-jenkins的演示。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">medium.com</p></div></div><div class="od l"><div class="ok l of og oh od oi ko nu"/></div></div></a></div></div></div>    
</body>
</html>