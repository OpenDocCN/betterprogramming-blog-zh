<html>
<head>
<title>How To Build a Chrome Extension With Sentiment Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用情感分析构建Chrome扩展</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-a-chrome-extension-with-sentiment-analysis-89b7e19560b1?source=collection_archive---------13-----------------------#2022-05-31">https://betterprogramming.pub/how-to-build-a-chrome-extension-with-sentiment-analysis-89b7e19560b1?source=collection_archive---------13-----------------------#2022-05-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e7f1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">伤心时送猫chrome分机</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1c66facf09645666f5f96f4a5b2216d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nb6OEPubLTF4MrUW"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@tengyart?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">腾雅特</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不久前，我看到有人做了一个项目，在你难过的时候给你发猫的照片。我想，哇，这正是我生活中需要的。</p><h1 id="7c10" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">灵感</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/91bbd4d641b899a88aad683c21b741fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/0*am2IyVxdo8qa1Fvh.png"/></div></figure><p id="5c07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最初的项目利用面部识别来确定你是悲伤还是快乐。如果你在使用笔记本电脑时感到悲伤，它会给你发送一个带有可爱猫咪图像的电话通知。</p><div class="ml mm gp gr mn mo"><a href="https://github.com/healeycodes/if-sad-send-cat" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">GitHub-Healey codes/if-sad-send-cat:🐱一个程序，发送猫到我的手机，当我在…</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">我的博客帖子:当我难过时，我的电脑会给我发送猫。如果你在电脑前难过，这个项目会发送一个…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">github.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc kp mo"/></div></div></a></div><p id="fa03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们使用一个名为<a class="ae kv" href="https://ml5js.org/" rel="noopener ugc nofollow" target="_blank"> ML5js </a>的库，我们可以很容易地将面部识别集成到chrome扩展应用程序中。</p><p id="552f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，从我构建带有面部识别的Chrome扩展的经验来看，该应用程序将耗尽您计算机上的大部分CPU。</p><p id="3256" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，用户将不得不保持他们的网络摄像头的所有时间，它的工作。没人希望如此。</p><h1 id="beca" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">这个计划</h1><p id="7d2e" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我们将对用户输入的文本进行情感分析，而不是使用面部识别。</p><p id="8c61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为你的心情想象语法。</p><h1 id="b6de" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第一步。找到一个基础开始</h1><p id="03b3" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">当然，你可以去Chrome扩展文档的“入门”部分。</p><p id="cf9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实上，如果这是你的第一个Chrome扩展，这里有另一篇文章详细解释了这个过程:<a class="ae kv" href="https://medium.com/better-programming/how-to-build-your-first-chrome-extension-8abdee9a4365" rel="noopener">https://medium . com/better-programming/how-to-build-your-first-Chrome-extension-8 abdee9a 4365</a></p><p id="32ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是如果你已经熟悉了Chrome扩展的组成部分，那么这个库是一个很好的样板文件:<a class="ae kv" href="https://github.com/chibat/chrome-extension-typescript-starter" rel="noopener ugc nofollow" target="_blank">https://github . com/chibat/Chrome-extension-typescript-starter</a></p><h1 id="7db2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第二步。倾听用户的输入</h1><p id="78a4" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我不是说要成为一个好的倾听者，倾听用户的意见。</p><p id="76c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是为了进行情感分析，我们需要捕捉Chrome扩展用户输入的文本。</p><p id="2b05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无论他们是在打电子邮件还是在谷歌上搜索，它都会给我们暗示他们的感受。</p><p id="ce37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在哪里写代码？</p><p id="a2c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在内容脚本中，我们希望捕获用户当前关注的元素。</p><p id="8d3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以你可能会问，其他像<code class="fe ni nj nk nl b">input</code>、<code class="fe ni nj nk nl b">textarea</code>等元素呢？？</p><p id="77d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设你的用户是人类，通常，一个用户一次只能在一个地方打字。在他们转到另一个输入之前，他们将点击下一个输入，这将改变页面上的焦点。</p><p id="38f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在浏览器的JavaScript中，<code class="fe ni nj nk nl b">document</code>对象已经有了一个名为<code class="fe ni nj nk nl b">activeElement</code>的属性，它就是做这个的。获取页面关注的元素。</p><p id="45e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当内容脚本初始化时，我们将触发一个获取活动元素的函数，并监听页面上的焦点变化。</p><p id="1fa9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回调函数将总是返回页面关注的最新元素。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="96d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能会注意到，我们有一个检查元素类型的函数。可以编辑的明显元素是<code class="fe ni nj nk nl b">&lt;textaread/&gt;</code>和<code class="fe ni nj nk nl b">&lt;input/&gt;</code>。</p><p id="e500" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不太明显的一个是具有<code class="fe ni nj nk nl b">contenteditable</code>属性的元素，它将一个常规的<code class="fe ni nj nk nl b">&lt;div/&gt;</code>变成一个编辑区域。当你在Gmail中输入电子邮件或在Medium上写文章时，就会发生这种情况。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="d48a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用活动元素，您将能够听到输入。代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0b36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能会注意到，我们用<code class="fe ni nj nk nl b">setTimeout</code>来决定是否要触发<code class="fe ni nj nk nl b">search</code>函数。这是因为我们不想太频繁地调用我们的API，而且也想得到更有意义的句子而不是单个的字母。</p><h1 id="75bd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第三步。向服务器发送数据</h1><p id="bf17" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">然后它把我们带到了搜索功能。这个函数应该将用户的文本发送到我们的API，以了解该文本是“正面的”、“中性的”还是“负面的”</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="f434" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一种选择:</p><p id="2c5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果不想构建自己的情感分析API，可以使用现有的服务。不利的一面是，你将不得不为服务付费，但肯定会节省你的时间。</p><div class="ml mm gp gr mn mo"><a href="https://deepai.org/machine-learning-model/sentiment-analysis" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">情感分析</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">这个情感分析API提取给定文本字符串中的情感。情感分析，也称为“观点…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">deepai.org</p></div></div><div class="mx l"><div class="no l mz na nb mx nc kp mo"/></div></div></a></div><h1 id="8054" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第四步。设置您的API</h1><p id="101d" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">您可以使用python来设置您的服务器，但是因为我更熟悉JavaScript。我们将使用Node.js。</p><p id="27be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的端点中，我们将解析请求体以获得以下内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="64c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于实际做情感分析的部分，我们将使用Tensorflow.js来预测结果。</p><p id="98a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的<code class="fe ni nj nk nl b">setupSentimentModel</code>函数中，我们将加载模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="83f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">加载模型和元数据。你可以训练自己的情感分析模型，但是你也可以在网上找到可用的模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9364" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦加载了模型和元数据，我们就可以使用<code class="fe ni nj nk nl b">getSentimentScore</code>函数来处理文本。</p><p id="a082" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将把文本转换成一个索引序列，因为tensor2d需要一个数字数组。方法如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="b6fd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第五步。显示猫的照片</h1><p id="2870" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">在最初的项目中，作者选择在手机上向用户发送通知。</p><p id="d33a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是由于我们已经在Chrome浏览器中，我们可以打开一个新的标签，显示猫的图片。</p><p id="6f23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于猫的图片，已经有一个API了。</p><div class="ml mm gp gr mn mo"><a href="https://thecatapi.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">猫API -猫即服务。</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">一个关于猫的公共服务API，在制作你的新应用、网站或服务时可以免费使用。</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">thecatapi.com</p></div></div><div class="mx l"><div class="np l mz na nb mx nc kp mo"/></div></div></a></div><p id="b725" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的搜索功能中，您可能已经注意到了<code class="fe ni nj nk nl b">notifyUser</code>功能。这就是我们将得到猫的照片并展示给用户的地方。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="c50b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅向thecatapi.com发出一个API请求，以获取一张随机的可爱猫咪图片。然后，我们将在后台脚本上触发一个事件，打开一个带有猫图像的选项卡。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="5847" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在后台，我们需要做的就是监听该事件并创建带有猫图像URL的选项卡。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="f0fa" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="5e06" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">Chrome扩展代码:【https://github.com/davidyu37/therapypet-chrome-extension T2】</p><p id="288c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">情感分析服务器代码:【https://github.com/davidyu37/sentimentserver T4】</p><p id="d390" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Chrome商店上的治疗宠物:</p><div class="ml mm gp gr mn mo"><a href="https://chrome.google.com/webstore/detail/therapy-pet/dppfkiegdpndagfcmhbpjfcnbodekgoa" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">治疗宠物</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">当你难过的时候给你可爱的图像</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">chrome.google.com</p></div></div><div class="mx l"><div class="nq l mz na nb mx nc kp mo"/></div></div></a></div><p id="8a56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！敬请关注更多内容。</p></div></div>    
</body>
</html>