<html>
<head>
<title>Build a Snake Game With P5.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用P5.js构建一个贪吃蛇游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-your-first-snake-game-with-p5-js-577a45909fd7?source=collection_archive---------12-----------------------#2022-07-18">https://betterprogramming.pub/how-to-build-your-first-snake-game-with-p5-js-577a45909fd7?source=collection_archive---------12-----------------------#2022-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bbd0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">借助P5.js框架和一些JavaScript的魔力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5ece08c2fa242cba0d7ac3c242b213d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpawVwBemMWiJm5LIlUkEQ.png"/></div></div></figure><p id="96ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回想我开始编码之旅的时候，我记得我相信一个新手不可能编写完整个游戏。光是“实时更新”、用户输入和游戏处理的想法就让我相信，要最终达到游戏开发的水平，我还需要几年时间。</p><p id="8e5a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">嗯，我想犯错是人之常情。在这篇文章中，我将向你展示如何编写你的第一个游戏，以及为什么没有理由害怕它。如果你对阅读整本书不感兴趣，可以看看完成的<a class="ae lq" href="http://github.com/burlienterprises/p5-snake" rel="noopener ugc nofollow" target="_blank">产品</a>。</p><p id="64cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">免责声明</strong>:如果你已经对HTML和CSS的工作原理有了一些基本的了解，那就更好了。如果不是这样，不要慌。查看<a class="ae lq" href="https://medium.com/@iampika/html-and-css-fundamentals-6b8f7d90911b" rel="noopener">摩哂陀·乔杜里的这篇伟大的文章</a>，之后别忘了回来看看:)。</p><h2 id="3773" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">TL；蛇博士，那是什么？</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/433c083fd17aa989281778d5fad0946f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*IiuUVLTZgNXzfDdm.png"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">来源:<a class="ae lq" href="https://www.rokuguide.com/sites/default/files/Snake-Screenshot1.png" rel="noopener ugc nofollow" target="_blank"> Roku指南</a></p></figure><p id="9df8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们先快速解释一下我们将要创建的游戏:Snake。这绝对是70年代的经典之作，但对所有没有听说过它的孩子来说，它是免费的，有趣的，而且会让你很紧张。</p><p id="2bd2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本上，堡垒之夜是给老人的。我第一次接触这个游戏是因为它曾经预装在我们的翻盖手机上。每当你不小心打开浏览器，在网上冲浪两秒钟(感觉更像是十年)后，你内心的恐慌就会沸腾，这个游戏是让你冷静下来的理想选择。你们中的一些人可能还记得那种感觉。</p><p id="2cd4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">无论如何，游戏的目的是让你用键盘上的箭头键控制的蛇成长。如果蛇撞到边缘或自己的身体，游戏就结束了。通过收集随机放在游戏板上的苹果，种植是可能的。</p><h1 id="95bd" class="mp ls it bd lt mq mr ms lw mt mu mv lz jz mw ka mc kc mx kd mf kf my kg mi mz bi translated">让编码开始吧</h1><h2 id="f37e" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">设置</h2><p id="6032" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">首先，我们将使用<a class="ae lq" href="https://github.com/bsplt/p5js-boilerplate" rel="noopener ugc nofollow" target="_blank">样板文件</a>来开始我们的项目。样板文件很大程度上是一个模板，负责我们需要的文件夹结构和文件引用。它还包括P5.js，这是一个易于使用的JavaScript库，有一个巨大的社区，非常适合用它来创建游戏和可视化。我也认为它非常适合开始编码。</p><h2 id="a56c" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">布局和设计</h2><p id="2bf3" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">在编写任何游戏逻辑之前，我总是建议你创建一个基本布局并添加一些风格。大多数人反对这种方法，会先写JavaScript代码，但是设计优先的方法有一个很大的优势:如果代码不工作(很可能一开始就不工作)，至少有一些好看的东西；).</p><p id="d4eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">布局在<code class="fe nf ng nh ni b">index.html</code>文件中创建。如果我们要为我们的元素编写任何自定义样式，我们会将它们放入<code class="fe nf ng nh ni b">css/style.css</code>。相反，我们将使用一个名为<a class="ae lq" href="https://picocss.com/docs/" rel="noopener ugc nofollow" target="_blank"> Pico.css </a> framework的CSS框架来处理所有元素的默认样式。我们可以简单地将预定义的样式作为类添加到元素中。</p><p id="d67f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是最终的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">最终设计和布局</p></figure><h2 id="40af" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">使用P5.js</h2><p id="500d" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">既然设计已经完成，开始变魔术的时候到了。如前所述，我们将使用P5.js框架实现游戏逻辑，并将代码放入<code class="fe nf ng nh ni b">main.js</code>文件中。</p><p id="00c2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">P5的主要原理很简单。用户应该能够用代码创建绘图，并将它们直接放入HTML的<code class="fe nf ng nh ni b">&lt;canvas&gt;</code>对象中。不像普通的JavaScript，你不需要自己调用<code class="fe nf ng nh ni b">onLoad()</code>函数；P5.js库通过提供两个函数来完成这一切:</p><ul class=""><li id="80af" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated"><code class="fe nf ng nh ni b">setup()</code> —这是游戏板设置和初始化的地方</li><li id="1fcb" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated"><code class="fe nf ng nh ni b">draw()</code> —这是游戏处理和逻辑实现的地方。基本上，游戏循环是在这里编码的。</li></ul><p id="35b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你有兴趣了解更多关于P5的知识，请查看Johannes Preis的这篇文章。</p><h2 id="3743" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">搭建画布</h2><p id="3826" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">在编码任何东西之前，我们必须告诉框架它应该在setup函数中把图形放在哪里。为此，必须创建一个画布对象，并在<code class="fe nf ng nh ni b">setup()</code>函数中将HTML容器的id指定为画布的父对象。</p><p id="1de2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">至于图画的颜色，这必须在<code class="fe nf ng nh ni b">draw()</code>函数中指定，因为在游戏的每次迭代中，每个字段都必须更新。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="299f" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">实现游戏循环</h2><p id="f544" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">现在，我们如何实现这个游戏呢？想法是这样的:游戏板被分割成块。块数和块大小在它们自己的变量中设置。</p><p id="8bab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在循环的每一次迭代中，蛇都向它当前移动的方向移动一个街区。方向也是在它自己的变量中设置的，只有当用户单击其中一个箭头键时才会改变。这条蛇只不过是一些颜色与其他颜色不同的积木。块的位置保存在一个数组中，对于蛇的每个块，绘制一个背景不同于画布的矩形。</p><p id="55ed" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本的游戏循环如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/1821b2de7cb84fb821d66533b6c625bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*BTR7sOzWihq5W_zqYuxf0A.png"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">游戏循环</p></figure><h2 id="6d82" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">碰撞检测</h2><p id="a893" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">每当蛇撞到棋盘的边缘或自己的身体时，游戏结束。对于这两种方法，只有头部需要考虑，因为身体的其他部分总是跟着头部走。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="9cf7" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">蛇的运动</h2><p id="b336" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">每当用户按下箭头键时，蛇就改变它的运动方向。使用框架提供的<code class="fe nf ng nh ni b">keyPressed()</code>方法可以很容易地拦截这个事件。</p><p id="8b44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">x方向的负值表示蛇向左移动，y方向的负值表示蛇向上移动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="5019" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">食品加工</h2><p id="c193" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">食品加工可能是整个事情中最棘手的部分。通过选择随机的x和y值，苹果被放置在棋盘上的一个位置。然而，只有当蛇的身体没有任何部分占据这个位置时，苹果才会被放在这个位置。如果蛇吃了它，苹果会被随机放在另一个地方。而且蛇成长一格，分数也增加。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="bab8" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">游戏分数和状态</h2><p id="63dd" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">最后但同样重要的是，必须建立开始-停止-暂停过程。为此，我们对之前放在HTML中的按钮使用一个普通的事件监听器。然后点击改变设置状态的变量。这是在游戏循环中查询的。如果设置为暂停，则跳过大多数处理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="5aa7" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">最后的想法</h2><p id="cb7f" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">恭喜你，你刚刚编写了你的第一个游戏！如果你想直接看到最终代码，那么你可以点击<a class="ae lq" href="https://github.com/burliEnterprises/p5-snake" rel="noopener ugc nofollow" target="_blank">这里的</a>。请随意使用它和/或在您的机器上试用它。</p><p id="b821" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望你喜欢这篇文章。欢迎给我写你开始编程时编写的第一个游戏，或者留下任何关于游戏的想法:)。</p></div></div>    
</body>
</html>