<html>
<head>
<title>How To Automate Bringing Google Play Store Reviews to Google Sheets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何自动将谷歌Play商店评论引入谷歌表单</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/play-store-review-to-google-sheets-automation-c372115ff661?source=collection_archive---------10-----------------------#2019-10-31">https://betterprogramming.pub/play-store-review-to-google-sheets-automation-c372115ff661?source=collection_archive---------10-----------------------#2019-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="60e7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">知识是让你的应用变得更好的力量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb6172dabf536b6791c3142f39ce7482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIBuQmhI8q_dIY9g_RhO2Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@rajeshwerbatchu7?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">拉杰什瓦尔·巴楚</a>在<a class="ae kv" href="https://unsplash.com/s/photos/google?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="cdd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">充分利用谷歌Play商店对应用程序的评论对它们的成功至关重要。以下是我们如何有力地分析Play Store评论的方法。</p><p id="e439" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在发布你的应用程序后，跟踪用户的情绪是你能做的最重要的任务，因为这可以让你计划未来的迭代，并看到你的用户群中任何潜在的差异。</p><p id="2ff9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每月一次，我们的设计师Jotham会在一个电子表格中整理我们每个客户应用的最新评论。他用这个来分析数据和分类评论，以了解用户对每个应用程序的最新体验和想法。</p><p id="4c0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可想而知，这个过程很耗时，但是超级有价值。因此，我们决定利用最近的一个R&amp;D日来自动化这个过程。</p><p id="ec4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇博客概述了自动化的第一步——在电子表格中自动收集评论。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="427a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">第一步</h1><p id="455d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为此，您需要一个服务帐户。您可以根据此<a class="ae kv" href="http://(https://developers.google.com/android-publisher/getting_started#setting_up_api_access_clients" rel="noopener ugc nofollow" target="_blank">指南</a>创建一个。创建服务帐户后，下载JSON文件并将其放在驱动器中。</p><p id="237a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要记下文件ID。一旦选择了<em class="mw">打开</em>选项，您就可以在URL中找到它。这个文件包含了访问<a class="ae kv" href="https://developers.google.com/android-publisher" rel="noopener ugc nofollow" target="_blank"> Google Play开发者API </a>所需的一切。</p><p id="4636" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，创建一个新的Google工作表，根据您想要从评论中提取的信息设置您的列名。</p><p id="f83a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">开始编写脚本；选择<em class="mw">工具、</em>，然后选择<em class="mw">脚本编辑器</em>。这将打开一个在线IDE，您可以在其中编写来自JavaScript的Apps脚本。</p><p id="d4f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，您需要生成一个令牌来访问Google Play开发者API。为此，我们将使用一个名为<em class="mw"> cGOA </em>的便利库。点击<em class="mw">资源</em>，然后点击<em class="mw">库</em>，添加库。</p><p id="27b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">搜索<code class="fe mx my mz na b">MZx5DzNPsYjVyZaR67xXJQai_d-phDA33</code>并添加。完成后，您应该添加以下代码并运行以生成令牌(这将只需要完成一次):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">generateGoogleToken</p></figure><p id="c8c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要检索令牌，请添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用cGoa检索令牌</p></figure><p id="0f4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，可以调用<code class="fe mx my mz na b">Goth.getToken(‘PlayConsole’)</code>来获取令牌。您现在可以访问Android Publisher范围，我们可以在其中检索评论。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="908a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使其可用</h1><p id="9047" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">您可以通过拨打以下电话来检索用户在过去一周留下的评论的分页列表:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">获取评论</p></figure><p id="dbd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您现在可以开始用这些数据填充电子表格了。首先，将结果转换成可用的对象并打开电子表格:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">打开电子表格</p></figure><p id="ce68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，检测电子表格的底部，并迭代填充相关列的数据。该函数如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">解析数据并填充电子表格</p></figure><p id="e4ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这使用了一个助手函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">getColByName</p></figure><p id="b58d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如您所看到的，我们对评论执行一些其他功能，比如颠倒顺序和计算累积平均值。</p><p id="d364" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还检查我们还没有添加评论。运行您的代码，您应该看到电子表格开始填充。</p><p id="5e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Apps脚本真正酷的地方在于你可以用多种方式运行它。或者像刚才一样在编辑器中，或者您可以向电子表格添加一个按钮，或者设置一个自定义触发器。</p><p id="b68d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要将按钮添加到电子表格中，请运行以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加按钮</p></figure><p id="0535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要添加触发器，前往https://script.google.com/home的<a class="ae kv" href="https://script.google.com/home" rel="noopener ugc nofollow" target="_blank">，从三点菜单中选择你的脚本和触发器。有几种类型的触发器可以在计划的时间运行或从电子表格事件运行。例如，我们运行自定义按钮菜单代码<code class="fe mx my mz na b">onOpen</code>。</a></p><p id="ce9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了电子表格中现成的评论，我们现在可以考虑自动对它们进行分类或进行情感分析。我们将在未来几个月对此进行调查。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d513" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">来源</h1><ul class=""><li id="4b92" class="nd ne iq ky b kz mr lc ms lf nf lj ng ln nh lr ni nj nk nl bi translated"><a class="ae kv" href="http://ramblings.mcpher.com/Home/excelquirks/goa/walkthroughs/serviceaccount" rel="noopener ugc nofollow" target="_blank">演练:服务账户</a></li><li id="5d2e" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><a class="ae kv" href="https://developers.google.com/android-publisher/api-ref/reviews" rel="noopener ugc nofollow" target="_blank">安卓发行商:评论</a></li></ul></div></div>    
</body>
</html>