<html>
<head>
<title>8 Things I’ve Learned Over the Last Six Years Working With React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在过去六年的React工作中，我学到了8件事</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/things-ive-learned-over-the-last-6-years-working-with-react-f01a8f02146b?source=collection_archive---------2-----------------------#2022-10-07">https://betterprogramming.pub/things-ive-learned-over-the-last-6-years-working-with-react-f01a8f02146b?source=collection_archive---------2-----------------------#2022-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c7a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">React是一个库，不是框架</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/984ef0e2fdfea2346d91b26a14addc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pp2OEho8alMj083e"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@lautaroandreani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">劳塔罗·安德烈亚尼</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7354" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">时光飞逝。五年前，我们在团队中评估了React、Angular和Vue，并决定使用React。</p><p id="6569" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，看起来我们做出了正确的选择。React仍然存在——与许多其他JavaScript库不同，Google Trends取得了成功。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/5207074768b8a44959cc59a6af68e69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpbgcocqbujbA8QH9dRhhA.png"/></div></div></figure><p id="86cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去的六年里，我学到了一些重要的东西:</p><h1 id="8e8c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">1.React是一个库，不是框架</h1><p id="71c2" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">例如，Angular是一个框架，而React“仅仅”是一个库。虽然Angular带来了实现和维护复杂业务应用程序所需的许多东西，但React侧重于GUI组件的实现。</p><p id="9ea0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用于表单、验证、国际化等。在React应用程序中，必须使用第三方库。这带来了大量的自由，但也可能导致依赖地狱和错误的选择。</p><p id="a1b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您不想构建自己的React堆栈，当然可以使用众多React框架中的一个:</p><p id="e3ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank">T5】next . jsT7】</a></p><p id="b579" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Vite </strong> </a></p><p id="02f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://remix.run/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">混音</strong> </a></p><h1 id="e519" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">2.不要使用另一个库来解决所有问题</h1><p id="ba6c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">向项目中添加新库时，请务必小心。相信我，如果你想保持你的依赖关系是最新的，并且在项目中使用许多库，这些库要么没有被维护，要么经常包含不兼容的变更，那么你最终会陷入混乱。</p><p id="6642" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您添加一个新的库时，您应该通过查看GitHub上的以下几点来检查它的质量:</p><ul class=""><li id="21fb" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">上一个版本是几岁？</li><li id="8b20" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">该库使用了多少依赖项，它们是最新的吗？</li><li id="d759" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">项目有多少星级、下载量、开放问题和开放拉动请求？</li></ul><p id="652a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别是如果涉及到样式，我建议创建一个定制的组件，而不是使用一个现有的复杂的可配置的组件，它的样式必须被覆盖，这很无趣！</p><h1 id="9234" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">3.如果您使用组件库，请使用无头组件</h1><p id="ed06" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如果您觉得工作量太大，或者可以理解您不想实现自己的日期选择器或下拉组件，那么您应该寻找“无头组件”这些组件涵盖了必要的功能和UX，但没有样式。开发人员可以根据自己的需要设计这些组件的样式。</p><p id="361a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有几个我可以推荐的无头组件库:</p><ul class=""><li id="3fdb" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated"><a class="ae kv" href="https://headlessui.com/" rel="noopener ugc nofollow" target="_blank">无头UI </a></li><li id="8228" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://www.radix-ui.com/" rel="noopener ugc nofollow" target="_blank">原语——基数UI </a></li><li id="009a" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://github.com/downshift-js/downshift" rel="noopener ugc nofollow" target="_blank"> GitHub —降档-js/降档</a></li></ul><h1 id="a28a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">4.不需要用Redux</h1><p id="fe1f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">React不是一个框架，所以你很快就会得出结论，你仍然需要一个数据管理或状态管理的主干。</p><p id="353c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道的有用户交互的应用程序的经典模式是MVC——模型视图控制模式。脸书给了我们一个选择:<a class="ae kv" href="https://facebook.github.io/flux/docs/in-depth-overview/" rel="noopener ugc nofollow" target="_blank">通量</a>。</p><p id="7a76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这种方法，现在有许多React、Angular和其他UI解决方案的采用和实现。</p><p id="de34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最流行的状态管理实现是redux，但是你不需要使用Redux。花些时间为您的应用找到合适的解决方案。除了Redux，还有一些替代品——我可以推荐<a class="ae kv" href="https://github.com/pmndrs/zustand" rel="noopener ugc nofollow" target="_blank"> Zustand </a>。</p><p id="b720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以保持简单，只使用组件的状态，并使用属性将其传递给子组件。这适用于很多情况。对于数据，您需要跨应用程序并希望在应用程序级别进行管理，如用户会话，您可以使用React Context API。</p><p id="c84b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我主要使用下面的模式来创建一个上下文，并在使用自定义钩子的组件中使用它。</p><p id="9630" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个包含用户上下文本身、提供者和访问上下文的快捷钩子函数的文件。方法如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="026e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将提供者放在组件树中尽可能高的位置。下面是实现这一点的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="069b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，使用以下代码访问任何组件中的用户上下文:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h1 id="7d4a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">5.正确使用PropTypes</h1><blockquote class="ng nh ni"><p id="c1ac" class="kw kx nj ky b kz la jr lb lc ld ju le nk lg lh li nl lk ll lm nm lo lp lq lr ij bi translated">随着应用程序的增长，你可以通过类型检查发现很多错误。对于某些应用程序，您可以使用JavaScript扩展，如<a class="ae kv" href="https://flow.org/" rel="noopener ugc nofollow" target="_blank"> Flow </a>或<a class="ae kv" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank"> TypeScript </a>来对整个应用程序进行类型检查。但是，即使您不使用这些，React也有一些内置的类型检查功能。</p><p id="b8ca" class="kw kx nj ky b kz la jr lb lc ld ju le nk lg lh li nl lk ll lm nm lo lp lq lr ij bi translated"><a class="ae kv" href="https://reactjs.org/docs/typechecking-with-proptypes.html" rel="noopener ugc nofollow" target="_blank">https://reactjs.org/docs/typechecking-with-proptypes.html</a></p></blockquote><p id="8863" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如React的文档所说，使用prop-types库可以防止类型错误，尤其是在不使用typescript或flow的情况下。</p><p id="1702" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这相对来说很容易也很好。只是我的一个小建议:</p><p id="2d03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要用合适类型来描述一般的数据结构，要用它们来定义你对组件的期望。否则，您将最终得到对多个组件有效的大形状，增加了耦合性并容易出错。</p><h1 id="1ccd" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">4.保持你的组件小</h1><p id="ffbd" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">为React组件找到合适的尺寸是最困难的事情之一。组件越大，维护和测试就越复杂。另一方面，太小的组件会使你的代码难以阅读——也难以维护。</p><p id="fddd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的建议是使用标准的软件开发模式来分离组件。与React相关的最重要的功能如下:</p><ul class=""><li id="e82d" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated"><a class="ae kv" href="https://reactjs.org/docs/composition-vs-inheritance.html" rel="noopener ugc nofollow" target="_blank">构成vs继承</a></li><li id="287b" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Separation_of_concerns" rel="noopener ugc nofollow" target="_blank">关注点分离</a></li><li id="2267" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="noopener ugc nofollow" target="_blank">不要重复自己</a></li></ul><p id="1cda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">永远记住，你不是在为自己或编译器/浏览器写代码。你是在为别人写代码，所以尽量坚持鲍勃大叔的<a class="ae kv" href="https://cleancoders.com/" rel="noopener ugc nofollow" target="_blank">干净代码</a>哲学。</p><h1 id="2676" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">7.将组件库分成至少两个模块</h1><p id="9083" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是一个真实的故事。在我的团队中，我们是公司中第一个使用React的人。因此，我们必须实现许多布局React组件，以遵循公司的风格指南。</p><p id="1e0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当第二个团队开始使用React时，该团队当然不想在React中再次实施公司风格指南，并要求我们提供React组件。</p><p id="ef08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，将它从我们的项目中分离出来几乎是不可能的，因为它非常强烈地依赖于我们的业务逻辑。</p><p id="8a09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的建议是从一开始就创建自己的UI组件库，不包含任何业务逻辑。这使得在团队或项目之间共享这些组件变得更加容易，使得测试和处理组件变得更加容易和有趣，当然，也使得以后的重新设计变得非常容易。</p><p id="8ab0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于UI组件的实现，像<a class="ae kv" href="https://storybook.js.org/" rel="noopener ugc nofollow" target="_blank"> Storybook </a>这样的解决方案是不错的选择。</p><p id="6614" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了不陷入内部依赖广告版本的地狱，请为您的应用程序和库使用monorepo。NX 可以帮你做到这一点。</p><h1 id="e6fc" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">8.编写测试</h1><p id="e06e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我也被称为100%先生，因为我认为你的单元测试报告应该有100%的覆盖率。在测试覆盖率中明确忽略部分代码比说80%的覆盖率就足够了要好。这样的话，你就冒了重要部分没有被测试的风险。</p><p id="0e2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我测试React应用程序的首选测试设置包括作为测试运行器的<a class="ae kv" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>、作为React组件单元和集成测试框架的<a class="ae kv" href="https://testing-library.com/docs/react-testing-library/intro/" rel="noopener ugc nofollow" target="_blank"> React测试库</a>以及用于完整端到端测试的<a class="ae kv" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> Cypress </a>或<a class="ae kv" href="https://playwright.dev/" rel="noopener ugc nofollow" target="_blank">剧作家</a>。</p></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="cfe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>