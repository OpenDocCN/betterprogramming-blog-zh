<html>
<head>
<title>Build a Tinder-Like Swipe UI for Angular/Ionic 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Angular/Ionic 4构建类似Tinder的滑动UI</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/tinder-like-swiper-ui-for-angular-ionic-4-50c401d6b9fb?source=collection_archive---------2-----------------------#2020-01-12">https://betterprogramming.pub/tinder-like-swiper-ui-for-angular-ionic-4-50c401d6b9fb?source=collection_archive---------2-----------------------#2020-01-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1768" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Tinder的swiper是一个有用的UI组件。为您的Angular/Ionic 4应用程序构建它</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a958200ba0c3ff85106308d9c560d6a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wSTjKi7a3CQFBTcA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Nicola Fioravanti 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="afff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在高层次上，我决定将工作分成四个部分:</p><ol class=""><li id="f731" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">为该组件起草初始(~placeholder)模板和TS代码，将其放入一个带有按钮的<a class="ae ky" href="https://ionicframework.com/" rel="noopener ugc nofollow" target="_blank"> Ionic </a>应用程序页面(home.page)中，该页面会将Tinder cards的数据“加载”到该组件中。</li><li id="a20e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">实现“堆叠”卡片的视图，以便它可以呈现由图像、标题和描述组成的卡片列表。</li><li id="b889" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后，执行是(心形)/否(十字)按钮，动画显示从牌堆中取出的牌。</li><li id="0d72" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最后，实现卡片拖动，以便用户可以左右拖动和滑动卡片，做出相应的是/否选择，然后为用户做出的选择配置一个简单的事件侦听器。</li></ol><p id="6f16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，最终结果应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/78df8fd46530588414c6412c01a076e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/1*LDmPuxsApHAqMlraTghPew.gif"/></div></figure><p id="4a12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧，有很多内容要讲！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ea32" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">第1部分:创建初始模板</h1><p id="2ca4" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">让我们从分叉<a class="ae ky" href="https://stackblitz.com/edit/ionic-4-template" rel="noopener ugc nofollow" target="_blank">这个StackBlitz的Ionic 4模板</a>开始。它有一个<code class="fe no np nq nr b">HomePage</code>开始，我们将添加一个新的角度组件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="796a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面可以看出，我们已经向模板添加了<code class="fe no np nq nr b">tinder-ui</code>组件，它将具有<code class="fe no np nq nr b">cards</code>属性(我们将使用<a class="ae ky" href="https://angular.io/api/core/Input" rel="noopener ugc nofollow" target="_blank"> Angular的输入</a>在我们的组件中实现它)，以及一个<code class="fe no np nq nr b">choiceMade</code>监听器。(将通过<a class="ae ky" href="https://angular.io/guide/template-syntax#input-and-output-properties" rel="noopener ugc nofollow" target="_blank"> Angular的输出</a>实现)。</p><p id="9c75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，我们添加了一个简单的按钮，我们将使用它来模拟将卡“加载”到我们的组件中</p><p id="9a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们刺一下我们的<code class="fe no np nq nr b">tinder-ui</code>组件。(我们将创建三个文件:tinder-ui-component的HTML、SCSS和TS)并将其添加到<code class="fe no np nq nr b">home.module.ts</code>:</p><h2 id="3417" class="nu ms it bd mt nv nw dn mx nx ny dp nb li nz oa nd lm ob oc nf lq od oe nh of bi translated"><strong class="ak">tinder-ui.component.html</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="5bdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，我们只是在这里添加了所有div和它们相应的类，并添加了对根div到<code class="fe no np nq nr b">cards.length</code> - &gt;的绑定，使得如果卡的长度为零，整个组件不可见。</p><h2 id="2a48" class="nu ms it bd mt nv nw dn mx nx ny dp nb li nz oa nd lm ob oc nf lq od oe nh of bi translated"><strong class="ak">tinder-ui . component . scss</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="851c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的CSS规则将有助于对齐所有的东西，并使其看起来适合swiper。</p><p id="97a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不太擅长样式，所以你可能有一个更好的方法，尤其是如果你打算使用一个响应式UI。但是对于我们这里的情况，这些应该足够了。</p><h2 id="9343" class="nu ms it bd mt nv nw dn mx nx ny dp nb li nz oa nd lm ob oc nf lq od oe nh of bi translated"><strong class="ak"> tinder-ui.component.ts </strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="0117" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，这里有几个注意事项:</p><ul class=""><li id="e07c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu og mb mc md bi translated">我们导入了<code class="fe no np nq nr b">Input</code>，并使用这个装饰器来引用这个组件将从其父组件(<code class="fe no np nq nr b">home.page</code>)获得的卡片数据。</li><li id="7300" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu og mb mc md bi translated">我们使用<code class="fe no np nq nr b">ViewChildren</code>来跟踪代表我们每张卡片的实际HTML元素。因为我们订阅了更改，所以可以动态跟踪卡。我们将需要访问的元素，因为我们将改变他们的风格(如操纵他们的“转换”等。).</li></ul><p id="990b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然组件的基础已经准备好了，我们需要将它添加到我们的<code class="fe no np nq nr b">home.module.ts</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="563a" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">第2部分:实现堆叠卡片的视图</h1><p id="b5ef" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">对于这个实现，我们将假设每张卡片只有一个图像、标题和描述，并且我们的<code class="fe no np nq nr b">cards</code>数组(数据源来自<code class="fe no np nq nr b">home.page.ts</code>)将有以下接口:</p><pre class="kj kk kl km gt oh nr oi oj aw ok bi"><span id="6c45" class="nu ms it nr b gy ol om l on oo">cards: Array&lt;{</span><span id="9598" class="nu ms it nr b gy op om l on oo">    img: string,</span><span id="0963" class="nu ms it nr b gy op om l on oo">    title: string,</span><span id="b938" class="nu ms it nr b gy op om l on oo">    description: string</span><span id="8f60" class="nu ms it nr b gy op om l on oo">}&gt;;</span></pre><p id="c3e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于此，我们现在将在<code class="fe no np nq nr b">tinder-ui.component.html</code>中实现堆叠卡片的视图。</p><p id="acac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将利用<code class="fe no np nq nr b">*ngFor</code>指令来复制卡片，并将使用<code class="fe no np nq nr b">[ngStyle]</code>绑定和每个卡片的<code class="fe no np nq nr b">index</code>来以堆栈的形式呈现它们:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="3525" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还将添加一个模板引用<code class="fe no np nq nr b">tinderCardImage</code>到我们的<code class="fe no np nq nr b">&lt;img&gt;</code>元素中，这样我们就可以在TS代码中用<code class="fe no np nq nr b">ViewChildren</code>来选择它。</p><p id="a032" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我添加了一个简单的(load)监听器，以确保图像只有在完全加载后才会显示(不透明度1)。这是一个更流畅的外观和感觉。</p><p id="0e3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们应该准备好测试这叠卡片的视图了。为此，我们将把<code class="fe no np nq nr b">home.page.html</code>中的按钮绑定到一个方法，该方法将加载一些占位符数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="038d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们应该能够点击<em class="oq">加载火绒卡</em>按钮，并看到以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/b3cc70caa6a38b1f4b0a736926ee89af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ve3dDZ14jDwHSSUUJX6Ng.png"/></div></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="e3f7" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">第3部分:用动画实现是/否按钮</h1><p id="1731" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我们将假设一个“心”的图像代表“是”,一个“叉”的图像代表用户的“否”回答。</p><p id="9832" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个实现，我决定只使用一个SVG图像，并将其内嵌到Tinder按钮(上面的白色圆圈)和Tinder-status中，Tinder-status是一个动态指示器，它将在拖动时向用户显示他们的答案。</p><p id="784e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，现在我们正在内联表示心和十字的SVG，并向每张卡片添加一个(<code class="fe no np nq nr b">transitionend</code>)事件监听器，因为我们只想在过渡动画完全结束的情况下对卡片进行操作(例如从堆栈中删除卡片)。</p><p id="28ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们将添加<code class="fe no np nq nr b">[style.opacity]</code>绑定，这将帮助我们在需要时显示选择指示器。</p><h2 id="2ba7" class="nu ms it bd mt nv nw dn mx nx ny dp nb li nz oa nd lm ob oc nf lq od oe nh of bi translated">更新的tinder-ui.component.html</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="b86e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们已经准备好用按钮逻辑修改我们的TS文件了，还有一些额外的好处:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d7a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们:</p><ul class=""><li id="1003" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu og mb mc md bi translated">增加了新的导入——<code class="fe no np nq nr b">Renderer2</code>——这是为了使卡片元素<a class="ae ky" href="https://alligator.io/angular/using-renderer2/" rel="noopener ugc nofollow" target="_blank">样式以一种有角度的方式</a>变化。</li><li id="74fb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu og mb mc md bi translated">我们添加了新的var——<code class="fe no np nq nr b">moveOutWidth</code>——我们现在在<code class="fe no np nq nr b">ngAfterViewInit</code>钩子中确定它。这个数字将定义卡应该“移动”到用户屏幕之外多远。</li><li id="a4e3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu og mb mc md bi translated">现在有更多的变量来管理事物的状态:<code class="fe no np nq nr b">shiftRequired</code>(以防我们需要移除顶部的卡片)，加上简单的状态变量来跟踪我们的UI的状态(<code class="fe no np nq nr b">transitionInProgress</code>、<code class="fe no np nq nr b">heartVisible</code>、<code class="fe no np nq nr b">crossVisible</code>)。</li></ul><p id="7eac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的<code class="fe no np nq nr b">userClickedButton</code>方法应该很容易理解:如果我们的用户点击了“yes”(心形)，我们将transform添加到顶部的卡片(<code class="fe no np nq nr b">array[0]</code>)，并迫使它开始向右飞去。</p><p id="f79b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果点击“否”，卡片会飞向左侧。现在，当这样的转换结束时，我们的另一个方法<code class="fe no np nq nr b">handleShift</code>将移除这样的卡，因为<code class="fe no np nq nr b">shiftRequired</code>状态是<code class="fe no np nq nr b">true</code>。</p><p id="614c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，这里我们调用了<code class="fe no np nq nr b">toggleChoiceIndicator</code>方法，它使Tinder status SVG在屏幕中央对用户可见。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="4a45" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">第4部分:实现拖动和选择输出</h1><p id="9ab7" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">最后一个实现步骤是拖动功能。为了启用它，我们将使用<a class="ae ky" href="https://hammerjs.github.io/" rel="noopener ugc nofollow" target="_blank"> Hammer.js </a>平移手势，它曾经是Ionic框架的一部分，但现在需要单独安装:</p><pre class="kj kk kl km gt oh nr oi oj aw ok bi"><span id="8fcb" class="nu ms it nr b gy ol om l on oo">npm i hammerjs</span></pre><p id="45f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上将安装软件包，然后您只需将以下内容添加到您的<code class="fe no np nq nr b">main.ts</code>:</p><pre class="kj kk kl km gt oh nr oi oj aw ok bi"><span id="28fc" class="nu ms it nr b gy ol om l on oo">import 'hammerjs'</span></pre><p id="c511" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">启用Hammer后，我们可以将(<code class="fe no np nq nr b">pan</code>)和(<code class="fe no np nq nr b">panend</code>)输入手势监听器添加到<code class="fe no np nq nr b">tinder — cards</code> div:</p><pre class="kj kk kl km gt oh nr oi oj aw ok bi"><span id="5696" class="nu ms it nr b gy ol om l on oo">&lt;div class="tinder--cards" (pan)="handlePan($event)" (panend)="handlePanEnd($event)"&gt;...&lt;/div&gt;</span></pre><p id="14fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以将方法<code class="fe no np nq nr b">handlePan</code>和<code class="fe no np nq nr b">handlePanEnd</code>添加到我们的<code class="fe no np nq nr b">tinder-ui.component.ts</code>中，并添加逻辑来发出用户的选择:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="9617" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="50e1" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">经过最近几次修改，我们的代码现在已经完成，可以在Ionic 4或pure Angular应用程序中使用。</p><p id="404a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这种实现还有改进的潜力(比如移除对Hammer.js的依赖等)，但是如果你只是需要一条前进的道路，这应该可以让你继续前进。</p><ul class=""><li id="5c6b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu og mb mc md bi translated">这里是<a class="ae ky" href="https://ionic-4-template-czmv63.stackblitz.io" rel="noopener ugc nofollow" target="_blank">演示</a>。</li><li id="2b96" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu og mb mc md bi translated">下面是<a class="ae ky" href="https://stackblitz.com/edit/ionic-4-template-czmv63" rel="noopener ugc nofollow" target="_blank">编辑器链接</a>。</li><li id="3da6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu og mb mc md bi translated">这是在构建这个代码片段时启发我的<a class="ae ky" href="https://codepen.io/RobVermeer/pen/japZpY" rel="noopener ugc nofollow" target="_blank"> codepen.io </a>。</li></ul></div></div>    
</body>
</html>