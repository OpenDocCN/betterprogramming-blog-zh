<html>
<head>
<title>How to Recreate the Default iOS ActivityIndicator Using SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用SwiftUI重新创建默认iOS活动指示器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/make-default-ios-activityindicator-from-scratch-using-swiftui-7f31bb2f4493?source=collection_archive---------19-----------------------#2022-05-16">https://betterprogramming.pub/make-default-ios-activityindicator-from-scratch-using-swiftui-7f31bb2f4493?source=collection_archive---------19-----------------------#2022-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1bcc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用渐变和圆形</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b680fb570426a5d25cf5d5e4a4eda50d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zf35tHud-LUYO5sz"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@mike_van_den_bos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈克·范·登博斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9a25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个<code class="fe ls lt lu lv b">UIActivityIndicatorView </code>是显示一个任务正在进行中的视图。<br/>今天我们将使用渐变和圆圈来分解SwiftUI中默认的iOS活动指示器。</p><p id="22ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注<em class="lw"> : </em> </strong>我不确定默认的iOS活动指示器是否也是这样构建的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/638a8fb7e83e10a17bd902a0f7b8b164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUKp-CkbA-uYhOVOd_TIsw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们将如何分解活动指示器视图的简短图片集</p></figure><h1 id="692a" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated"><strong class="ak">我们要如何创造</strong> <code class="fe ls lt lu lv b"><strong class="ak">ActivityIndicatorView</strong></code> <strong class="ak">？</strong></h1><p id="38a0" class="pw-post-body-paragraph kw kx iq ky b kz mq jr lb lc mr ju le lf ms lh li lj mt ll lm ln mu lp lq lr ij bi translated">我们将有两个圆圈。一个内圈一个外圈。</p><p id="4a25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">内圆将被用来掩盖交叉直径酒吧。外圆将用于放置一个角度渐变遮罩，该圆将随着动画旋转。交叉直径栏只是活动指示器栏。它将永远保持静止。</p><p id="5294" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你可能对我们将如何实现这一活动指标有了一个展望。</p><h1 id="a437" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">我们开始吧</h1><p id="9143" class="pw-post-body-paragraph kw kx iq ky b kz mq jr lb lc mr ju le lf ms lh li lj mt ll lm ln mu lp lq lr ij bi translated">我们将从Z堆栈开始。我们将在内容视图中创建一个Z堆栈。Z堆栈将包含内圆、外圆和十字直径条。这将从Z堆栈中心开始。</p><p id="3589" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将首先设置Z堆栈，然后我们将创建另一个视图，并用绑定变量输入命名它为<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>，让我们将该输入命名为<code class="fe ls lt lu lv b">rotationAngle</code>。</p><p id="6c4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里的<code class="fe ls lt lu lv b">rotationAngle</code>用于绘制不同位置的<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>。我们将使用那个<code class="fe ls lt lu lv b">rotationAngle</code>来设置<code class="fe ls lt lu lv b">rotationEffect</code>角度。确保<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>的<code class="fe ls lt lu lv b">rotationEffect</code>定位点必须是<code class="fe ls lt lu lv b">centered</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="17aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们的<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>设置好了。我们只需要给出不同的角度，为那些不同的角度设置不同的<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>。</p><p id="981d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们创建<code class="fe ls lt lu lv b">OuterGradientCircle</code>视图。我们只需要创建一个圆，并填充一个角度梯度与梯度:</p><pre class="kg kh ki kj gt mx lv my mz aw na bi"><span id="47b5" class="nb lz iq lv b gy nc nd l ne nf">static let gradientColors = Gradient(colors: [Color(UIColor(white: 1, alpha: 0.3)), Color(UIColor(white: 1, alpha: 0.9)), Color(UIColor(white: 1, alpha: 0.3))])</span></pre><p id="bbef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的渐变，用这个渐变填充圆。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="b508" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，一旦我们完成了<code class="fe ls lt lu lv b">OuterGradientCircle</code>和<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>的创建，我们将转到我们的内容视图，并开始设置我们的核心设置。</p><p id="0b33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们将有两个状态变量一个<code class="fe ls lt lu lv b">isAnimating</code>告诉视图，它需要动画意味着旋转器外圈将开始旋转。另一个<code class="fe ls lt lu lv b">capsuleAngles</code>将保存<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>的不同角度值。这将定位多个<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>,每个具有各自的角度，带有一个中心旋转锚。</p><p id="e7cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用<code class="fe ls lt lu lv b">[0, 30, 60, 90, 120, 150]</code>值输入<code class="fe ls lt lu lv b">capsuleAngles</code>。</p><p id="9817" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们将创建多个<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>。为此，我们将在capsuleAngles上运行一个<code class="fe ls lt lu lv b">ForEach</code>循环。并且我们将通过<code class="fe ls lt lu lv b">rotationAngle</code>为<code class="fe ls lt lu lv b">CustomActivityIndicatorBar</code>传递<code class="fe ls lt lu lv b">capsuleAngle</code>作为ForEach项。</p><p id="9b3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我们将设置内圆和外圆的框架。外圈应该是内圈的两倍大。我们只需要设置动画，砰的一声，一个工作活动指示器出现了，为我们做好了准备。内容视图可参考如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b198ebd29338dcf5efe7459a2457be1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/1*St_zoa6ryOWVx89Y7CFqFg.gif"/></div></figure></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="d753" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的代码可以从我的GitHub库获得:</p><div class="no np gp gr nq nr"><a href="https://github.com/Nikilicious09/ActivityIndicatorSwiftUI" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">GitHub-nikilicious 09/ActivityIndicatorSwiftUI</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kp nr"/></div></div></a></div></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="feb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你明白如何创建默认iOS <code class="fe ls lt lu lv b">UIActivityIndicatorView</code>的副本。如果你有任何疑问或建议，请告诉我。</p></div></div>    
</body>
</html>