<html>
<head>
<title>Reveal Animation With Bounce in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android中显示带弹跳的动画</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/reveal-animation-with-bounce-in-android-578454f20d0b?source=collection_archive---------5-----------------------#2020-09-15">https://betterprogramming.pub/reveal-animation-with-bounce-in-android-578454f20d0b?source=collection_archive---------5-----------------------#2020-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="19fa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">展示有风格的新东西</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/61ab326bb349e359c0a81faea4b374b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ggWNPpkD0SJ0sq5F"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">JOSHUA COLEMAN 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="629d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将学习如何在Android的任何视图中应用带有反弹动画的显示。我在之前的应用程序中使用了这个特殊的reveal动画来显示加分。出于本教程的目的，我们将在一个简单的定制视图上使用它。这个最终结果可以在文末看到。</p><p id="f5e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们为添加动画打下基础。这包括:</p><ol class=""><li id="9370" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">我们想展示的观点。</li><li id="dc4e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">它将驻留的活动。</li><li id="f722" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">动画师资源目录。</li></ol><p id="ec16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里值得注意的是，您没有<em class="mg">也没有</em>来使用活动。这正是我将在本教程中使用的。</p><p id="3327" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用的自定义视图是一个简单的<code class="fe mh mi mj mk b">ConstraintLayout</code>，中间有一个<code class="fe mh mi mj mk b">TextView</code>。它看起来会像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/73038a95074d3675887b9afd74f73f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*y5KOStJDbIDcG7rXk41-vQ.png"/></div></figure><p id="9b37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是这个视图的XML。我们将把它命名为<code class="fe mh mi mj mk b">view_bonus</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="0b92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在其中放置该视图的活动是主活动(启动活动)。我们将在它完全显示的状态下对它进行定位和约束，并给它一个ID<code class="fe mh mi mj mk b">vBonus</code>。我们还将在底部添加一个按钮，用于演示reveal动画。我们给它一个<code class="fe mh mi mj mk b">bRevealBounce</code>的ID。它看起来是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/1e27b4d2a62f0f32fa46bb571db5b423.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*oNEhlW6DxIn3Ek9fm0Zs3A.png"/></div></figure><p id="ab47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是活动的XML。请注意，我们将把<code class="fe mh mi mj mk b">vBonus</code>的可见性设置为<code class="fe mh mi mj mk b">gone</code>，因为我们稍后会公布它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="aa61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果在“res”下没有动画师资源目录，那么你必须添加它。为此，右击“RES”-&gt;“New”-&gt;“Android Resource Directory”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/d65ddb05e5bdb79c607b9702baf69d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wcha0OeAixLNGvRRubcYYA.png"/></div></div></figure><p id="8310" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在“资源类型”下，选择“animator”，然后点按“好”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/99c592624a6f2924f80f9bb90c23e877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1xUE_MwqfTGcN0eXRe-SQ.png"/></div></div></figure><p id="2d94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您已经有了一个animator资源目录，让我们继续添加Animator资源文件，我们将在其中实现动画。要做到这一点，右键单击“动画”-&gt;“新建”-&gt;“动画资源文件”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/44ec58e9337e1bf502f3fd5160481191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4QPzgId2nqZgN0_d_MhXg.png"/></div></div></figure><p id="3d2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">animator资源文件将由一组动画组成，所以要确保“根元素”是“set”将文件命名为<code class="fe mh mi mj mk b">reveal_bounce</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/9ae6b36d4c02569a78c09b8efaf930d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W7fjPICD0Phs65DEgHzlLA.png"/></div></div></figure><p id="08e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经准备好实现实际的动画了，让我简单解释一下我们打算做什么。我们希望以下事情按顺序发生:</p><ol class=""><li id="a123" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">完全水平展开<code class="fe mh mi mj mk b">vBonus</code>，同时稍微垂直展开，这样就不会完全隐藏。</li><li id="cb21" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">用<code class="fe mh mi mj mk b">bounce</code>垂直完全展开<code class="fe mh mi mj mk b">vBonus</code>。</li><li id="b9c0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">等待一会儿，然后完全垂直收缩<code class="fe mh mi mj mk b">vBonus</code>，同时将它的alpha设置为0，这样它就会在结束时消失。</li></ol><p id="4577" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">集合的默认排序是<code class="fe mh mi mj mk b">together</code> —而不是<code class="fe mh mi mj mk b">sequentially</code> —所以我们需要做的第一件事就是将<code class="fe mh mi mj mk b">reveal_bounce</code>中父集合的排序显式设置为<code class="fe mh mi mj mk b">sequentially</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="ff76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个父集合中，我们将添加另外三个集合来实现我们前面解释的三个步骤。</p><p id="b429" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一组将有两个<code class="fe mh mi mj mk b">objectAnimators</code>。一个将属性<code class="fe mh mi mj mk b">scaleX</code>从0f动画到1f，这意味着它将完全水平扩展视图。第二个将属性<code class="fe mh mi mj mk b">scaleY</code>的动画从0f到0.1f，这意味着它将垂直扩展视图一点点。在这个例子中，我们将持续时间设置为100毫秒。</p><p id="2c82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个数字后面的<em class="mg"> f </em>表示它是一个浮点值，而不是一个整数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="ff4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二组将有一个<code class="fe mh mi mj mk b">objectAnimator</code>将属性<code class="fe mh mi mj mk b">scaleY</code>从0.1f动画到1f，这意味着它将完全垂直扩展视图。在这个例子中，我们将持续时间设置为300毫秒。</p><p id="3621" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要添加一个<code class="fe mh mi mj mk b">bounce</code>，我们必须将<code class="fe mh mi mj mk b">interpolator</code>属性设置为<code class="fe mh mi mj mk b">bounce_interpolator</code>。这个插值器已经存在，你可以使用它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="7983" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第三和最后一组将有两个<code class="fe mh mi mj mk b">objectAnimators</code>。一个将属性<code class="fe mh mi mj mk b">scaleY</code>从1f动画到0f，这意味着它将完全垂直收缩视图。第二个将使属性<code class="fe mh mi mj mk b">alpha</code>从1f变为0f，这意味着它将完全淡出视图。</p><p id="02a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，我们将持续时间设置为250毫秒，并让它在启动前等待350毫秒，以便视图在消失前有一点可见。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="3c78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">reveal_bounce</code>中的三个集合看起来会是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="e0c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们应用动画！在我们的<code class="fe mh mi mj mk b">MainActivity</code>中，我们将做几件事:</p><ol class=""><li id="b579" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">添加类型为<code class="fe mh mi mj mk b">Animator</code>的属性。这将保存动画本身、动画将在其上发生的视图，以及一个关于动画何时开始和何时结束的监听器。</li><li id="1303" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">添加一个<code class="fe mh mi mj mk b">setup</code>函数，它将为我们的<code class="fe mh mi mj mk b">Animator</code>设置上述所有内容，这些内容将在<code class="fe mh mi mj mk b">onCreate</code>函数中被调用。</li><li id="ab62" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">添加一个函数来启动动画。虽然启动动画已经是一行程序，但是我们确实想检查动画是否已经启动，这样我们就可以防止在动画已经启动时再次启动动画。</li><li id="3964" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">给<code class="fe mh mi mj mk b">bRevealBounce</code>添加一个<code class="fe mh mi mj mk b">OnClickListener</code>，它将调用<code class="fe mh mi mj mk b">start animation</code>函数。</li></ol><p id="02b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我们将在<code class="fe mh mi mj mk b">onCreate</code>中设置<code class="fe mh mi mj mk b">Animator</code>，而不是在Kotlin中使用可选的，我们将使用<code class="fe mh mi mj mk b">lateinit</code>，它基本上是一个非可选的，承诺在使用前初始化。我们将其命名为<code class="fe mh mi mj mk b">revealBounceAnim</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="192b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mh mi mj mk b">setup</code>函数将加载动画，将目标视图设置为<code class="fe mh mi mj mk b">vBonus</code>，添加一个监听器，使<code class="fe mh mi mj mk b">vBonus</code>在动画之前可见，并在动画结束时隐藏视图。我们将把这个函数命名为<code class="fe mh mi mj mk b">setupRevealBounceAnimation</code>。</p><p id="16b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了加载动画，我们将使用<code class="fe mh mi mj mk b">AnimatorInflator.loadAnimator</code>，它接受一个上下文和我们之前创建的动画文件。这将返回一个我们将设置为<code class="fe mh mi mj mk b">revealBounceAnim</code>的<code class="fe mh mi mj mk b">Animator</code>。</p><p id="ffce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了设置动画的目标视图，我们将使用<code class="fe mh mi mj mk b">revealBounceAnim</code>上的<code class="fe mh mi mj mk b">setTarget</code>功能。</p><p id="1959" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了添加一个监听器，我们将使用<code class="fe mh mi mj mk b">revealBounceAnim</code>上的<code class="fe mh mi mj mk b">addListener</code>函数。需要一个<code class="fe mh mi mj mk b">AnimatorListener</code>。这里我们特别关注两个回调:</p><ol class=""><li id="21f2" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在<code class="fe mh mi mj mk b">onAnimationStart</code>回调中，我们将使<code class="fe mh mi mj mk b">vBonus</code>可见和不透明。</li><li id="8485" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们将隐藏<code class="fe mh mi mj mk b">vBonus</code>的<code class="fe mh mi mj mk b">onAnimationEnd</code>回调。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="141e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mh mi mj mk b">onAnimationEnd</code>中<code class="fe mh mi mj mk b">vBonus</code>被视为可选的原因是为了防止应用程序在动画结束前被关闭，在这种情况下，视图将会消失，并可能导致应用程序崩溃。</p><p id="2b6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里值得一提的是，这是一个快速而肮脏的实现。理想情况下，我们希望使用反应式模式，这样我们就不会关心应用程序是否被驳回。不过，我将在不同的日子讨论这个话题。</p><p id="5d15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了开始动画，我们将添加一个函数，确保在开始动画之前动画还没有开始。我们将其命名为<code class="fe mh mi mj mk b">startRevealBounceAnimation</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8116" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后但同样重要的是，在<code class="fe mh mi mj mk b">onCreate</code>中，我们将调用<code class="fe mh mi mj mk b">setupRevealBounceAnimation</code>，然后我们将添加一个<code class="fe mh mi mj mk b">OnClickListener</code>到<code class="fe mh mi mj mk b">bRevealBounce</code>，它将简单地调用<code class="fe mh mi mj mk b">startRevealBounceAnimation</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="1c19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">整个<code class="fe mh mi mj mk b">MainActivity</code>文件将如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/40a440da2cfb924905be180396b0e2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/1*MTKRuu-5snzBqT8TKls6tg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最终结果。</p></figure><p id="1fd5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！当您点击该按钮时，奖金视图将在再次消失之前反弹显示。我希望这对你有用。直到下一次，这是开发咬签出！</p></div></div>    
</body>
</html>