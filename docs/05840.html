<html>
<head>
<title>When DRY Doesn’t Work, Go WET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当干燥不起作用时，去湿的</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/when-dry-doesnt-work-go-wet-6befda0444bf?source=collection_archive---------1-----------------------#2020-08-11">https://betterprogramming.pub/when-dry-doesnt-work-go-wet-6befda0444bf?source=collection_archive---------1-----------------------#2020-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0cb4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如果你重复你自己也没关系</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4c96e54bb573fd7fd3a412e9b58caebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_ypO9tgVaUiP-rmA"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@lsfineartphotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">舒米洛夫·卢德米拉</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1ada" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个错误我见过很多次了，我自己也犯过。当你第一次读到干式编程的概念时，你可能误解了它。</p><p id="689b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你脑子里在想的是:</p><p id="ff58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">维基百科:DRY代表不重复相同的代码两次。你:嗯，好吧，我会用抽象代替我所有的复制品。</p><p id="d4a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这似乎是一个很好的解决方案，但事实并非如此。你的抽象往往是错误的。</p><p id="0481" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">原因如下:</p><ol class=""><li id="554a" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">你看到了重复。</li><li id="6d8b" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">您将复制提取到一个新的抽象中(方法，类)。</li><li id="f20c" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">你用新的抽象代替了复制。</li><li id="840a" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">你认为你的代码是完美的。</li><li id="3631" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">时光流逝。</li><li id="e883" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">产品经理有了新的要求。你的抽象对他们来说几乎是完美的。</li><li id="0f68" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">你开始实现新的需求。</li><li id="f3ce" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">这里有一个小的<em class="ls">但是</em> : <br/>你的抽象几乎是完美的。为什么？新的需求只影响您提取到抽象中的95%的旧代码。另外5%不受影响。你决定改变你的抽象的代码，而不是用当前代码的95%来创建一个新的抽象。<br/>您添加了一个条件语句，例如<code class="fe mh mi mj mk b">if..else</code>，并传递了一个参数，因此您的抽象可以针对不同的决策执行不同的操作。</li><li id="0c66" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">现在你的抽象对于不同的情况有不同的表现。</li><li id="8197" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">另一个新的要求来了。另一个附加参数。又一个新条件。(循环直到代码变得非常难以理解和维护。)</li><li id="e3b0" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">恭喜你，你创造了一个错误的抽象。</li></ol><p id="5504" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码不再代表单一的、公共的抽象。它变成了一个充满条件的过程。很难理解，也很容易坏。添加新特性非常困难，每一个新特性都会使代码更加复杂。</p><p id="4a15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个无限循环。</p><p id="886f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那怎么办呢？</p><p id="0fc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">什么都写两遍。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="f5f9" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">湿的</h1><p id="0299" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">湿(每样东西写两遍)和干是相反的概念。当你开始开发一个新系统时，你并不知道所有的未来需求。所以不要急于抽象。</p><p id="ad9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你需要记住:复制比错误的抽象要便宜得多。</p><p id="c4e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您正在构建一个web应用程序，但现在还没有针对所有页面的UI设计。但是你也有许多按钮，并且它们在每一页上都是相似的。您决定将它们移到一个名为<code class="fe mh mi mj mk b">Button</code>的组件中，并在每个页面上重用它。似乎合乎逻辑。</p><p id="85bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“嘿嘿！”新的页面设计来自产品经理。你看着它，发现在页面底部有一个新的、别致的按钮。</p><p id="f59f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它看起来像旧的按钮，但它有一个“小东西”要实现它，您需要重写10%的<code class="fe mh mi mj mk b">Button</code>组件，并添加条件语句和新参数。</p><p id="170e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你有一个难题:</p><ol class=""><li id="1cb9" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">改变<code class="fe mh mi mj mk b">Button</code>。重写10%的抽象代码(添加逻辑条件以支持新的花式按钮逻辑)。</li><li id="3675" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">创建两个抽象:<code class="fe mh mi mj mk b">FancyButton</code>和<code class="fe mh mi mj mk b">Button</code>。将90%的代码从<code class="fe mh mi mj mk b">Button</code>复制到<code class="fe mh mi mj mk b">FancyButton</code>。</li></ol><p id="ba41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道你想选择第一个选项。你认为你能处理好。你不会构建错误的抽象。</p><p id="97cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但可悲的事实是，你会的(除非你是一个有经验的程序员，并且知道你在做什么)。</p><p id="93fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">复制代码。不要害怕。</p><p id="82d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">过一段时间你就知道你的按钮以后是什么样子了。然后，您可以分析当前的代码库，在按钮组件中找到重复的代码，并将它们移动到良好的抽象中。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="ad94" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">如果太晚了</h1><p id="52be" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">如果你发现处理一个错误的抽象为时已晚，那么前进的最快方式就是后退。</p><p id="a62f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请执行以下操作:</p><ol class=""><li id="3e84" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">将抽象的代码移回。</li><li id="7cf7" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">删除传递给抽象的未使用的参数，为不同的决策执行不同的操作。</li><li id="e97b" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">删除未使用的逻辑。</li></ol><p id="398c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这移除了每个调用者的抽象和条件语句。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="f9e2" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">最后…</h1><p id="f1cc" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">如果您发现自己通过共享代码传递参数和添加条件语句，那么您的抽象就是错误的。</p><p id="606a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比起错误的抽象，我更喜欢复制。</p><p id="0855" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！(灵感来自<a class="ae kv" href="https://sandimetz.com/blog/2016/1/20/the-wrong-abstraction" rel="noopener ugc nofollow" target="_blank">错误的抽象</a>)</p><p id="a14b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">干杯，</p><p id="7e0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">–<a class="ae kv" href="https://twitter.com/nickbulljs" rel="noopener ugc nofollow" target="_blank">尼克</a></p><p id="b317" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你喜欢这篇文章，你需要知道，每周一，我都会给4000多名web开发人员发一封信，里面有3篇来自技术世界的精选文章、2篇Web开发指南和1篇本周最佳Tweet</p><p id="eb1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">“你的通迅真是混账牛逼</em> </strong> <em class="ls">，真是尼克。这给了我一周的良好开端，让我学到了很多重要的知识。”</em></p><p id="f641" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里  <strong class="ky ir">加入免费获得短小精悍知识信的聪明开发者<a class="ae kv" href="https://nickbulljs.com/3-2-1/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">。</strong></a></strong></p></div></div>    
</body>
</html>