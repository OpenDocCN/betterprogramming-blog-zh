<html>
<head>
<title>Managing the Camera in SceneKit under SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI下的SceneKit中管理摄像机</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/managing-the-camera-in-scenekit-under-swiftui-6608e7a0de52?source=collection_archive---------6-----------------------#2022-04-14">https://betterprogramming.pub/managing-the-camera-in-scenekit-under-swiftui-6608e7a0de52?source=collection_archive---------6-----------------------#2022-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce39" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">穿越相机管理陷阱之旅</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dd77fb812c6f90bf806aec39d5744913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RgbXl2LJEHwUgi32FgHeyg.gif"/></div></div></figure><p id="28dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我前几周发表的一篇<a class="ae lq" rel="noopener ugc nofollow" target="_blank" href="/3-ways-to-rotate-objects-in-scenekit-86ed8c2f5490">文章</a>的结尾，我给出了一个在SceneKit中进行旋转的黄金标准的例子，实际上是在大多数计算机图形编码中，即四元数。</p><p id="7d3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我想更深入/实际地看看如何使用它们来管理3D编码中同样令人困惑的方面，即相机。</p><p id="4d8e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我先来一张动画GIF。行星和月球之一。使用此代码拍摄的地球和月球旋转的卫星图像。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="d68e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">其中的订阅由一个计时器触发，该计时器每秒向每个订阅发送一个值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/20fd0f9a1fe66d8b9618c45b0e92c3d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6pmV2fNS8nJvSgq0g1vstw.gif"/></div></div></figure><p id="c468" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，客户，想象一下SpaceX希望你用龙飞船取代月球。但很明显，他们不希望它有一半时间消失在星球后面；他们想让你跟着船。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="9488" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">旅程</h1><p id="30fa" class="pw-post-body-paragraph ku kv it kw b kx ms ju kz la mt jx lc ld mu lf lg lh mv lj lk ll mw ln lo lp im bi translated">你知道如何旋转物体吗？我们看到的是一件轻而易举的事，但摄像机却是另一回事。你开始使用我在这篇<a class="ae lq" href="https://medium.com/analytics-vidhya/shapes-with-paths-using-swiftui-part1-fb7250d3dce8" rel="noopener">论文</a>中用来构建圈子的相同技术——用那些旧的最爱s in和cos。然后，使用欧拉几何体围绕行星水平和垂直旋转预先构建的路径，并将摄影机附加到该路径。预先计算好的轨迹。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2b014a950a98d88971de9ffb59ecf3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yVmi1AeGAhVwavn19d0UfA.gif"/></div></div></figure><p id="e98d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如你所看到的，这是一次很棒的飞越，但是月球——龙模块在这张GIF中仍然是一个很小的角色。事实上地球也变成了这样，我们不会提到行星的扭曲或形状奇怪的月亮。</p><p id="15db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">希望问题很明显；您需要旋转相机来跟随旋转的行星—您可以使用以下代码完成这项任务:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="abf3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我在这里做的是将预先计算的位置与地球的旋转相匹配，以便地球/相机保持对齐。我向你保证，这是相同的代码，只是更多的旋转进行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eaf193a714f1fcba7978eec577e2ac5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wDHnu1Ta56Rjt4hPQogoHA.gif"/></div></div></figure><p id="e6eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这样效果更好；至少一切都在镜头里，但它并不完美——有一个小故障——你不需要做这么多的计算。</p><p id="b0d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好的——更简单的数学，你可以使用约束来做同样的事情[你从<code class="fe mx my mz na b">UIKit</code>开始就记得这些]。你可以约束相机，使其焦点保持在地球上；让<code class="fe mx my mz na b">SceneKit</code>计算一下。更好的是，你也可以限制距离。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="8690" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">bon——这个效果更好。没有故障，也没有复杂的数学运算。唯一剩下的问题是月球，也就是我们的龙模块仍然在框架之外。你需要改变预先计算好的路径来更好地跟随月亮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d72761a11e7a29dce619a90862fcc2bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VDYjNy4JwU0Zee312JrB7A.gif"/></div></div></figure><p id="8bf6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，虽然我们使用四元数来旋转行星，到目前为止，我们只是为相机使用了预烘焙的路线。</p><p id="e438" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要做一些更动态的事情，你需要像这样使用代码。在其中，我决定使用两个四元数，然后使用<code class="fe mx my mz na b">simd</code>库中的<code class="fe mx my mz na b">slerp</code>函数选择它们之间的最短路径。神奇的数字0.5表示中心点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="a2c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过HUD使用它，您可以水平或垂直移动，或者同时向两个方向移动。它看起来不错，但要注意，我们正在走向一个编码员的兔子洞。</p><p id="bfcf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">改变地球的外观，让你的疯狂变得更加明显，并在混合物中加入一些牙膏来显示路径。</p><p id="85eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过改变约束中gimble-lock周围的限制或在每次通过时动态重新计算角度来更改路径。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="02b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果看起来像这样，一个GIF显示了丑角色的地球——有一个非常好的地球映射路线穿过它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bc27799c68acbe16a953b1c87e99c0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*eWmNtbnLD1q0PrG-T7dGAg.gif"/></div></div></figure><p id="2197" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一条显示四元数计算的路径，描绘了行星向上攀爬，环绕，然后水平穿过赤道的概况。</p><p id="94d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所有这些使我想到了本文的结尾。我希望你在这里学到了一些东西，并像我写它一样喜欢阅读它。试着在你自己的版本中使用<code class="fe mx my mz na b">slerp</code>，并在这个过程中获得一些乐趣。</p><pre class="kj kk kl km gt nb na nc nd aw ne bi"><span id="b7ef" class="nf mb it na b gy ng nh l ni nj"><strong class="na iu">Want to Connect?</strong></span><span id="0a7d" class="nf mb it na b gy nk nh l ni nj">Join me on <a class="ae lq" href="https://www.linkedin.com/in/mark-lucking-4631049/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a> to connect, collaborate or just a chat.</span></pre></div></div>    
</body>
</html>