<html>
<head>
<title>Explore Data Wrangling With SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索与SQL的数据争论</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/explore-data-wrangling-with-sql-8166119e1776?source=collection_archive---------3-----------------------#2021-10-04">https://betterprogramming.pub/explore-data-wrangling-with-sql-8166119e1776?source=collection_archive---------3-----------------------#2021-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6574" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用SQL清理原始数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e363aef4a55a05c0fb51767f992a3383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgKI2k_xaGti4EeRZQZYdA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6060942" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的<a class="ae ky" href="https://pixabay.com/users/gdj-1086657/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6060942" rel="noopener ugc nofollow" target="_blank">戈登·约翰逊</a></p></figure><p id="6c28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当谈到数据操作时，每个人都意识到对SQL有很强的掌握的重要性。考虑到关系数据库在收集和存储数据方面是多么的流行，SQL是一种具有巨大效用的语言，并且是必备技能列表中的第一名。</p><p id="e648" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，SQL主要用于编写提取数据和帮助获得洞察力的查询。</p><p id="0552" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于数据清理，人们更倾向于依赖Python和R之类的语言，它们提供了大量的包来实现简单方便的数据预处理。有了这些包，复杂的任务可以用最少的代码行来完成。</p><p id="b321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相比之下，使用SQL执行相同的任务可能会因其语法而显得繁琐。然而，尽管使用Python/R处理数据有很多好处，但了解如何使用SQL作为数据清理工具还是值得的。毕竟，在大型数据集上使用Python和R包会带来额外的复杂性，并可能引发问题。</p><p id="2d7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL可能没有自带的方便的软件包，但是它拥有进行简单数据清理的方法。了解基本命令可以省去在使用SQL执行查询之前使用额外工具清理数据的麻烦。</p><p id="d516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然您使用SQL的大部分时间将用于编写带有“SELECT”和“FROM”的查询来过滤、聚集和连接数据，但是您可能偶尔会遇到需要您永久修改表的情况。</p><p id="8625" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，了解如何在SQL中应用基本的数据清理工具是值得的，这样您就可以在处理原始数据时省去一些麻烦。</p><h1 id="884e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">个案研究</h1><p id="7ba6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们做一个练习，在这个练习中，我们在数据集上实现了一个简单的数据预处理过程，以证明SQL作为数据清理工具的可用性。</p><p id="33fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:以下代码是在Microsoft SQL Server上编写的。因此，SQL语法可能与您最熟悉的语法略有不同。</p><p id="7ec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正在讨论的数据集存储了路易斯维尔市公共卫生和福利部报告的动物咬伤记录。点击<a class="ae ky" href="https://data.louisvilleky.gov/dataset/environmental-health-bulk-data/resource/af2c0cc3-280d-4812-871a-f33fceefc62e#{view-grid:{columnsWidth:[{column:!bite_date,width:185}]}}" rel="noopener ugc nofollow" target="_blank">此处</a> <em class="ms">可进入数据集。</em></p><p id="b97b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们预览一下数据，看看我们必须处理什么:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">选择前5行数据(由作者创建)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/7460c285073321017d1b7472b241b208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TGu-m_4bAjiaovYV7rkqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="a848" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的，这里提供了大量的特征，包括日期、位置和咬伤事件中涉及的动物。数据集还包含不相关的要素和缺失值。</p><p id="9e0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们执行简单的数据争论，以便编写查询和从数据集中提取必要的信息变得容易。</p><h1 id="0a88" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">移除不需要的功能</h1><p id="5748" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们可以从处理不想要的特性开始。假设我们计划对数据进行EDA，或者构建动物咬伤案例的时间序列。如果我们只对分析咬伤事件本身感兴趣，我们可以忽略与咬伤后果相关的特征。我们还可以删除多余的或不能提供额外见解的功能。</p><p id="6d5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的代码中，我们删除了符合这些条件的功能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">移除不需要的特征(由作者创建)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/b1e347138cb5099bf6f726c67ed4645f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDp1NQcnc3fe62gDnmIjBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><h1 id="ea64" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">输入缺失数据</h1><p id="b1e0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">只剩下相关的特性，下一步是处理缺失的值。出于保留尽可能多的数据的考虑，丢失的值将被替换，而不是尽可能删除。</p><p id="6778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了像“bite_date”和“victim_zip”这样的特性之外，没有一个特性需要特定的值。用新的类别替换空值来表示这些特性的未知值就足够了。</p><p id="4208" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此规则将应用于“BreedIDDesc”、“GenderIDDesc”、“color”和“WhereBittenIDDesc”列。对于这些功能，缺失值将被替换为“未知”值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">替换丢失的值(由作者创建)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/6003381276b9007bb429b42224d3fcf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_9kp7Aqz0oagxCi0Eq5bw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">插补后修改的数据集(由作者创建)</p></figure><h1 id="6a7e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">删除丢失的数据</h1><p id="f10b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后，将从数据集中移除剩余缺失值的记录。在这种情况下，咬伤的日期和位置以及涉及的动物种类对于数据争论后的分析至关重要。</p><p id="4e72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，“bite_date”、“SpeciesIDDesc”或“victim_zip”列中缺少值的所有记录都将被删除。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">删除缺少的值(由作者创建)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/4f11c313ace885bb5db917355d5dffb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOfoICJGJMwXW6jV343gHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">删除缺失值后修改的数据集(由作者创建)</p></figure><h1 id="41ac" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据清理后</h1><p id="e21d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">既然数据集已经过彻底的预处理，我们可以开始编写查询来从数据中提取我们想要的任何见解。</p><p id="5707" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，这个查询将向您显示构成狗咬伤案例数量最多的五种狗。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">根据案例数查找前5名犬种(由作者创建)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/3c7f3ce64078b280053cb9cd11756088.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*YiTDThCu1Y7K2fcv7djq6A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><h1 id="105a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="8ce5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">许多程序员(包括我自己)习惯于使用Python和R这样的通用编程语言来执行令人讨厌的数据清理任务。然而，SQL在这方面也有一些功能。</p><p id="9c66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">能够使用SQL管理原始数据使您的数据清理工作变得更加简单和方便。</p><p id="c9f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p></div></div>    
</body>
</html>