<html>
<head>
<title>How To Present a View Controller With Blurred Background in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在iOS中呈现背景模糊的视图控制器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-present-a-view-controller-with-blurred-background-in-ios-4350017e6073?source=collection_archive---------2-----------------------#2021-07-26">https://betterprogramming.pub/how-to-present-a-view-controller-with-blurred-background-in-ios-4350017e6073?source=collection_archive---------2-----------------------#2021-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="500a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">自定义UIBlurEffect的强度级别</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7876adf704fb72ac19b0b1db1593273a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGTunzpAchQPpIpFnAjtJw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不同强度等级的模糊背景示例(图片由作者提供)</p></figure><h1 id="a6d7" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">有什么问题？</h1><p id="8825" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">当我在搜索一个原生iOS API来创建一个模糊的背景视图，同时呈现一个如上图所示的模态ViewController时，问题就出现了。</p><p id="ecc2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我发现iOS已经为<code class="fe mo mp mq mr b"><a class="ae ms" href="https://developer.apple.com/documentation/uikit/uiblureffect" rel="noopener ugc nofollow" target="_blank">UIBlurEffect</a></code>提供了三种不同的风格，包括<code class="fe mo mp mq mr b">.light</code>、<code class="fe mo mp mq mr b">.dark</code>和<code class="fe mo mp mq mr b">.extraLight</code>。然而，我不能设置强度等级，默认的模糊等级相当高。</p><p id="4ba1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">可用的解决方案很少，但大多数都与<code class="fe mo mp mq mr b"><a class="ae ms" rel="noopener ugc nofollow" target="_blank" href="/three-approaches-to-apply-blur-effect-in-ios-c1c941d862c3">UIImage</a></code> <a class="ae ms" rel="noopener ugc nofollow" target="_blank" href="/three-approaches-to-apply-blur-effect-in-ios-c1c941d862c3">模糊效果</a> s有关，而不是应用于单个<code class="fe mo mp mq mr b">UIView</code>。</p><p id="5069" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一篇<a class="ae ms" href="https://prograils.com/adding-gaussian-blur-to-your-swift-mobile-app" rel="noopener ugc nofollow" target="_blank">文章</a>采用了类似的方法。它拍摄背景截图，并在截图图像中应用高斯模糊。这是很好的，但在处理和应用截屏图像上的模糊过滤器之前，它可以作为背景视图应用有几秒钟的延迟。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="ca51" class="kv kw iq bd kx ky na la lb lc nb le lf jw nc jx lh jz nd ka lj kc ne kd ll lm bi translated">解决办法</h1><p id="6e1d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">幸运的是，我发现了一个<a class="ae ms" href="https://gist.github.com/darrarski/29a2a4515508e385c90b3ffe6f975df7" rel="noopener ugc nofollow" target="_blank">简单的解决方案</a>，它通过基于强度级别改变<code class="fe mo mp mq mr b">UIViewPropertyAnimator</code>的值来实现<code class="fe mo mp mq mr b">UIBlurEffect</code>。</p><p id="faf0" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">它没有延迟，我们不必等待完成过程。而且还兼容iOS12及以上版本。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="cb9c" class="kv kw iq bd kx ky na la lb lc nb le lf jw nc jx lh jz nd ka lj kc ne kd ll lm bi translated">我们开始吧</h1><p id="268c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在本文中，我们将创建一个带有两个ViewControllers的简单UIKit应用程序。</p><ol class=""><li id="115e" class="nf ng iq lp b lq mj lt mk lw nh ma ni me nj mi nk nl nm nn bi translated"><code class="fe mo mp mq mr b">ViewController</code>，作为主页面，其中将呈现第二个视图控制器</li><li id="9091" class="nf ng iq lp b lq no lt np lw nq ma nr me ns mi nk nl nm nn bi translated"><code class="fe mo mp mq mr b">InfoViewController</code>，一个背景模糊的模态视图控制器。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/a0e0cb30b210fc55e8766bf216ac7266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYg32Y7H1E69pw-hmlnviQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预期结果、ViewController和显示的InfoViewController</p></figure><h2 id="8bb2" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">1.创建UIKit项目</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/a712b2726695e0d6a7e248075ac0a101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6zYTg55STzaGRV-W_0-zQ.png"/></div></div></figure><h2 id="a0e4" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">2.向我们的ViewController类添加标签、图像和按钮</h2><p id="abe2" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">打开<code class="fe mo mp mq mr b">Main.storyboard</code>并添加一个StackView作为主容器。</p><p id="568e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后，添加图像、标签和按钮。你可以添加你自己的内容，因为它不是那么重要。</p><p id="5127" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们的主要目的只是展示模糊效果将如何影响文字和图像。此外，该按钮用于显示新的模态控制器。</p><p id="8159" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">请记住，左侧窗格中的<code class="fe mo mp mq mr b">ViewController.swift</code>类已经链接(默认)到这个“视图控制器场景”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/10cef7ee75b38e4d1638570832a8db1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3OnS3Cne8g90Ay6UEdd5w.png"/></div></div></figure><h2 id="0781" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">3.创建InfoViewController</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/5649d2a888b6f3df58ecf173cd207282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYIP_iGxv2zuB7SyohZw8w.png"/></div></div></figure><p id="fee5" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">创建一个新的“可可触摸类”，并选择“UIViewController”。我们新的ViewController将被称为“InfoViewController”</p><p id="68a1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后，打开<code class="fe mo mp mq mr b">Main.storyboard</code>。添加一个新场景(UIViewController ),并通过在文本框中输入类名将其连接到我们新创建的InfoViewController类，如下图所示。</p><p id="c629" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">此外，输入故事板ID，以便稍后演示时调用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/9bab1dc64e953d23e039eba23691ea09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4JTmtP1yeLNlWHgN-Xrtw.png"/></div></div></figure><h2 id="7bea" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">4.将主容器视图添加到InfoViewController</h2><p id="2b09" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在本节中，我们将添加一个UIView作为主容器来保存包括标签和按钮在内的主要内容。这是因为在下一步中，当前背景视图将被更改为清晰的颜色。</p><p id="6fc3" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">因此，当显示InfoViewController时，只有这个主容器是可见的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/a761d2f64a11fecd151caa21f5387f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QlJjJaf1IKFmWBwdPDumBg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在底部添加UIView作为主容器</p></figure><p id="87b6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，设置视图背景颜色为<code class="fe mo mp mq mr b">.clear</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/2475722bc3574e1c6e292859714951cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ovobjsjfw5AuM1NnCloIVg.png"/></div></div></figure><h2 id="4d02" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">5.将IBAction添加到ViewController按钮以显示InfoViewController</h2><p id="de70" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在这一步中，将“Show Detail”按钮作为IBAction连接到ViewController，并输入函数名“showDetailAction ”,它将自动在ViewController中创建函数占位符。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/b9a01d228c1dafde1c7af630fd2bf18d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCJS8jaZz3sSXQDo63xsSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将按钮连接到ViewController</p></figure><p id="0af7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">然后，将下面的代码添加到<code class="fe mo mp mq mr b">showDetailAction</code>函数中，以呈现InfoViewController(如果需要，可以使用segue)。记住使用我们之前定义的相同标识符。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="1120" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这一阶段，如果您现在尝试运行项目并单击“显示细节”按钮，您将看到<code class="fe mo mp mq mr b">InfoViewController</code>以透明背景呈现在主<code class="fe mo mp mq mr b">ViewController</code>的顶部。</p><p id="92fa" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">太好了！是时候添加背景模糊视图了。</p><h2 id="3ab6" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">6.添加自定义UIVisualEffectView子类</h2><p id="5674" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">创建一个名为<code class="fe mo mp mq mr b">CustomUIVisualEffectView.swift</code>的新文件，并添加以下代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><h2 id="9224" class="nu kw iq bd kx nv nw dn lb nx ny dp lf lw nz oa lh ma ob oc lj me od oe ll of bi translated">7.向InfoViewController背景添加自定义BlurView</h2><p id="433f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">创建一个名为<code class="fe mo mp mq mr b">blurView</code>的UIView。然后，创建一个容器视图，我们将在其中设置模糊效果和模糊视图。</p><p id="a46b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">随后，我们需要在<code class="fe mo mp mq mr b">InfoViewController</code>中连接“解散”按钮作为IBAction(类似于步骤5)并处理解散动作。</p><p id="55c1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">现在，我们的<code class="fe mo mp mq mr b">InfoViewController</code>将看起来像下面的代码。您可以更改第10行的<code class="fe mo mp mq mr b">intensity</code>和第14行的灰色<code class="fe mo mp mq mr b">alpha</code>值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="adfb" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">酷！现在，当你尝试运行这个项目并再次点击“显示细节”按钮时，你将在后面看到模糊的视图。</p><p id="6ad4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">此外，您还可以在<code class="fe mo mp mq mr b">blurView</code>上添加一个<code class="fe mo mp mq mr b">UITapGestureRecognizer</code>，以允许点击时的解除动作。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/92928c2b48b5594d3af5453a695f4170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*obQj20IZtjkH9Oumyzlruw.gif"/></div></div></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="6d53" class="kv kw iq bd kx ky na la lb lc nb le lf jw nc jx lh jz nd ka lj kc ne kd ll lm bi translated">项目已完成</h1><p id="7f1b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">恭喜你！现在，我们已经完成了所有的步骤，这个项目正如我们所期望的那样运行良好。</p><p id="9ca2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">完整的源代码可以从我的GitHub <a class="ae ms" href="https://github.com/xmhafiz/CustomIntensityBlurEffectIOS" rel="noopener ugc nofollow" target="_blank">库</a>下载。</p><p id="acbd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">尝试将它实现到您的项目中，并通过创建一个ViewController子类来改进代码，该子类可被其他模态ViewController重用，以具有模糊的背景视图。</p><p id="e051" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">感谢阅读。编码快乐！</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="adaa" class="kv kw iq bd kx ky na la lb lc nb le lf jw nc jx lh jz nd ka lj kc ne kd ll lm bi translated">参考</h1><ul class=""><li id="3c1f" class="nf ng iq lp b lq lr lt lu lw oq ma or me os mi ot nl nm nn bi translated"><a class="ae ms" rel="noopener ugc nofollow" target="_blank" href="/three-approaches-to-apply-blur-effect-in-ios-c1c941d862c3">在iOS中应用模糊效果的3种方法</a></li><li id="3bb6" class="nf ng iq lp b lq no lt np lw nq ma nr me ns mi ot nl nm nn bi translated"><a class="ae ms" href="https://gist.github.com/darrarski/29a2a4515508e385c90b3ffe6f975df7" rel="noopener ugc nofollow" target="_blank">要旨</a></li><li id="4659" class="nf ng iq lp b lq no lt np lw nq ma nr me ns mi ot nl nm nn bi translated"><a class="ae ms" href="https://developer.apple.com/documentation/uikit/uiblureffect" rel="noopener ugc nofollow" target="_blank"> UIBlurEffect文档</a></li><li id="e494" class="nf ng iq lp b lq no lt np lw nq ma nr me ns mi ot nl nm nn bi translated"><a class="ae ms" href="https://prograils.com/adding-gaussian-blur-to-your-swift-mobile-app" rel="noopener ugc nofollow" target="_blank">高斯模糊示例</a></li><li id="a43d" class="nf ng iq lp b lq no lt np lw nq ma nr me ns mi ot nl nm nn bi translated"><a class="ae ms" href="https://github.com/xmhafiz/CustomIntensityBlurEffectIOS" rel="noopener ugc nofollow" target="_blank">自定义强度模糊GitHub项目</a></li></ul></div></div>    
</body>
</html>