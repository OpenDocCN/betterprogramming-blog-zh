<html>
<head>
<title>Using ESLint Right</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正确使用ESLint</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-eslint-right-4d18ef1e0d0b?source=collection_archive---------3-----------------------#2019-11-09">https://betterprogramming.pub/using-eslint-right-4d18ef1e0d0b?source=collection_archive---------3-----------------------#2019-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/26fb09b3cc9cf35c4af44f2c3cb6068b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAvIXE-AwnqvAnwEoA-FKA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">布鲁克·拉克在<a class="ae kc" href="https://unsplash.com/s/photos/a%2B?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="d3a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们在一个项目上合作时，最好(几乎每次)使用一些通用的编码风格，这样其他开发人员就可以轻松阅读你的代码(这样他们就不会来找你了)。但是如何确保每个人都知道通用的编码风格呢？你如何确保每个人都遵循共同的编码风格？</p><p id="7edd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个问题的答案是通过使用某种linter，这是一个突出偏离通用编码风格指南的程序。对于JavaScript来说，<a class="ae kc" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a>是开发者事实上的选择。</p><p id="475b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个问题的答案是给Git添加一个预提交钩子，告诉ESLint在提交代码之前对代码进行分析。如果与风格指南有一些偏差，应该突出显示出来，防止开发人员提交代码。</p><p id="fb7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用<a class="ae kc" href="https://www.npmjs.com/package/husky" rel="noopener ugc nofollow" target="_blank"> husky </a>向我们的项目添加git挂钩——这是我下一篇文章的主题。我们还应该在CI管道中添加这一点，以防开发人员设法绕过git挂钩。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="23bd" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第1部分:向项目中添加ESLint</h1><p id="bc75" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我们将使用<a class="ae kc" href="https://expressjs.com/en/starter/generator.html" rel="noopener ugc nofollow" target="_blank"> Express generator </a>来创建一个样本项目。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/b43877749c8d6a873bdff8d6adb6f228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFRtQsTICND77XAFxqYphg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">Express generator创建了一个示例项目</p></figure><p id="96cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们通过输入以下命令来运行它:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="41d6" class="mv lj iq mr b gy mw mx l my mz">cd myapp<br/>npm install<br/>DEBUG=myapp:* npm start</span></pre><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/0cb494f52b87875249421b71d8316939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swYqLri7Yr4JlSsnKUoBRg.png"/></div></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/052de560c38b4b57d4ae42b30446c880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMuUqi1fDgi6UCublcZ0Og.png"/></div></div></figure><p id="a388" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们的项目开始运行了。现在我们需要添加ESLint。</p><p id="70b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将通过使用以下命令来实现这一点:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="95c8" class="mv lj iq mr b gy mw mx l my mz">npm install --save-dev eslint</span></pre><p id="fdbb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不会在全球范围内安装ESLint这样做是错误的。我们将只把它作为一个开发依赖项来安装。</p><p id="1856" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了初始化配置，我们将运行:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="205f" class="mv lj iq mr b gy mw mx l my mz"> ./node_modules/.bin/eslint --init</span></pre><p id="7bf4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它会问我们一系列问题。我已经附上了所有八个问题的截图。我已经根据需要在标题中给出了解释。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/9f608c957499366222a04e8b076a666f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmkT40nWncrHcv11y0vRiQ.png"/></div></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/d675f9e8848503a846ef2343a162319c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RmF8PIn0t2m76CUEsyYHA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">如果我们使用CommonJS，那么我们需要使用common JS选项(ES5或更低版本)</p></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/bc1ac31496154853a1e32d3c16ebc560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qZIRCWMaqXbbngXUm9QqA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">如果你在使用React或Vue的前端应用程序中使用它，那么选择正确的选项</p></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/fb20cece43064ff24184b49a10dc1459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2R-D6t3Cw_otUBg1ulwG2A.png"/></div></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/7bc9f4595529bbe36a1418545a5c36a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GOGKTAP-zVRxcXNU9ntW1g.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">我们将在我们的后端使用这个应用程序。如果是前端应用，我们会选择浏览器。它允许在浏览器DOM中使用像窗口和文档对象这样的全局变量。</p></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/b720e619b9448ff63c872a6827571604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1La0Q9xM2VjFA6MKl5gTw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">我们将使用现有的风格指南</p></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/7c48bb13c67ffcc49b74fc66f21d6628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2NY2b2ZitSObDonZjbLsg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">有很多选项可供选择——为了演示，我用的是Airbnb的指南</p></figure><p id="b7a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我个人关注Airbnb指南。这是一本有趣的读物。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/38e0295e58bb7af38d36e4ae91c88e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wR2oBZJCsGhUSs4lJ0cWeA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">我们会选择JSON</p></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/6aa8641de04ee767b855c07abe1debc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNMD8-U9sDEwGoKxCHRaiQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">我们将安装所有的依赖项</p></figure><p id="86ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在我们项目的根中创建<code class="fe nl nm nn mr b">.eslintrc.json</code>。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/6dd99ea029a5058dc42652f3ab187a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MClTyskrBuU_A79DnW1lNw.png"/></div></div></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="b839" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第2部分:使用ESLint</h1><p id="0222" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">我们可以通过运行以下命令来检查整个项目:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="b2ba" class="mv lj iq mr b gy mw mx l my mz">./node_modules/.bin/eslint . # . represent the current directory</span></pre><p id="9705" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意<code class="fe nl nm nn mr b">eslint</code>是一个可执行文件，我们将使用我们项目中包含的版本。所有可执行文件都位于。<code class="fe nl nm nn mr b">node_modules</code>目录的bin目录。这让我们可以灵活地为不同的项目使用不同的ESLint版本，而不必在全球范围内安装它们。事实上，所有的可执行文件都应该这样使用——例如，<code class="fe nl nm nn mr b">nodemon</code>，<code class="fe nl nm nn mr b">pm2</code>等等。</p><p id="2cfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它给出了下面的输出，带有过多的文件错误/警告，最后是一个总报告。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/24a0b20b128a94268900ba01cbca5825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOl_RhSrb9FU_Dr_zrjeDw.png"/></div></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/b76b28a8a4f2a5e8463b041d5ca6f458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jIuTg6wk2YBpTD568DvQA.png"/></div></div></figure><p id="3935" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要在单个文件上运行ESLint，我们使用:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="7bb3" class="mv lj iq mr b gy mw mx l my mz">./node_modules/.bin/eslint app.js</span></pre><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/2a5e3cbe1e0396f879387b5c3d005550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F21ieswbBy66_piLvrXCYA.png"/></div></div></figure><p id="3a5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以添加另一个修复选项，这样ESLint就可以纠正它自己可以纠正的所有问题。</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="fe61" class="mv lj iq mr b gy mw mx l my mz"> ./node_modules/.bin/eslint app.js --fix</span></pre><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/9cbede60ef5bba19cd753eebb487b713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LP9FCLgxiHmcaeTLBshs2A.png"/></div></div></figure><p id="a6cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它修复了14个问题，现在只剩下一个未使用的变量。为了找出问题所在，我们搜索了规则<code class="fe nl nm nn mr b">no-unused-vars</code>，因为人们需要时间来适应Airbnb的风格指南。</p><p id="793d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我用一个<code class="fe nl nm nn mr b">fix</code>命令在整个项目上运行ESLint。</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="9af8" class="mv lj iq mr b gy mw mx l my mz">./node_modules/.bin/eslint . --fix</span></pre><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/675432d09d44c22dab09e295d45d8bab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdhAnKbIryJwyHKeiLAhYg.png"/></div></div></figure><p id="e756" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它为我修复了大部分错误。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="5094" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第3部分:向package.json添加命令</h1><p id="6524" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">一遍又一遍地键入整个命令非常困难。因此，我更喜欢在<code class="fe nl nm nn mr b">package.json</code>的脚本中创建一个速记命令。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/51a1f44b8c0c676750a7e663feea1238.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*LL1fgR5s2wN7mCJYhwZqjQ.png"/></div></figure><p id="5ccd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，如果我们必须运行ESLint，我们可以简单地使用:</p><pre class="mm mn mo mp gt mq mr ms mt aw mu bi"><span id="0c33" class="mv lj iq mr b gy mw mx l my mz">npm run lint</span></pre><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/a99dfa537ce3af6e3a96918edd41bd53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XtMRYVmqKDRn0TBjT0KhA.png"/></div></div></figure><p id="983b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它最后给出了一些<code class="fe nl nm nn mr b">npm ERR!</code>。那是因为ESLint抛出了一个非零的退出代码(你可以忽略它)。</p><p id="87c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这对于任何开发人员来说都非常容易记住和运行。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="5d45" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">第4部分:覆盖规则</h1><p id="23e0" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">如果我们想关掉<code class="fe nl nm nn mr b">no-unsed-vars rule</code>怎么办？我们将简单地在我们的<code class="fe nl nm nn mr b">.eslintrc.json</code>文件中覆盖这个规则。</p><p id="6a68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在将看到ESLint没有抛出任何错误。</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7c52106faed178311afacfaed32d342a.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*5E88MVy0Eih1jtajlhFvuA.png"/></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/8a312dd5007f7f2d6722145a268135f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QaN7imbPMKii02ZwC3yJTA.png"/></div></div></figure><p id="9175" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以谷歌，了解不同的规则不同的设置。一旦ESLint在您的项目中配置好并开始运行，您将会学到这一点。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="06e0" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">第5部分:结论</strong></h1><p id="5764" class="pw-post-body-paragraph kd ke iq kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">使用某种棉绒和导轨比不使用要好。将这一点添加到预提交挂钩中很重要。开发人员可以通过git挂钩——因此，在CI中拥有这一点也更重要。</p><p id="e2ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的下一篇文章将介绍使用husky的git挂钩。</p></div></div>    
</body>
</html>