<html>
<head>
<title>How to Implement Voice Commands in Your React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React应用中实现语音命令</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-implement-voice-command-in-your-react-app-f226edb2f202?source=collection_archive---------11-----------------------#2020-11-02">https://betterprogramming.pub/how-to-implement-voice-command-in-your-react-app-f226edb2f202?source=collection_archive---------11-----------------------#2020-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="abc8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用语音命令控制嵌入式视频</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/94b192b28950d7aed942467ac521f49c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hPV1a8CZN7IHzq3S"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">托马斯·勒在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="6a48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">语音命令是如何工作的？你能用语音命令控制视频吗？如何在React应用中实现语音命令功能？这些是我在开发一个嵌入视频的应用程序时问自己的问题。我希望能够使用语音命令免提控制视频。</p><p id="eb22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我遇到了一个常见的问题:我没有找到为我的特定用例设置它所需的步骤的资源。我没有发现一个网站有内置的语音命令来控制内容，我也没有发现许多博客走过设置这种功能的过程。</p><p id="7aee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管如此，现在我已经找到了一个解决方案，下面是我关于如何在React应用程序中设置语音命令功能来控制视频的演练。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="6084" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">1.集成Web语音API</h1><p id="2879" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对于语音识别，我使用了React钩子<a class="ae kv" href="https://www.npmjs.com/package/react-speech-recognition" rel="noopener ugc nofollow" target="_blank"> react-speech-recognition </a>，它在幕后使用Web Speech API。这让我可以非常快速地使用电脑麦克风的功能来跟踪用户在说什么。</p><p id="2e10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要安装它，请在终端中使用以下命令:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="184a" class="nb ma iq mx b gy nc nd l ne nf">npm install — save react-speech-recognition</span></pre><p id="8f53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在React文件的顶部，使用以下代码导入它:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="205f" class="nb ma iq mx b gy nc nd l ne nf">import SpeechRecognition, { useSpeechRecognition } from 'react-speech-recognition'</span></pre><p id="5e19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的应用程序是一个食谱和烹饪网站，我有一个每个食谱嵌入的视频。我想使用语音命令来控制那个视频，所以我将这个语音识别功能导入到我的<code class="fe ng nh ni mx b">Recipe Detail Page</code>组件中。对于您的项目，将其直接导入到将访问语音识别功能的组件中。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="cf93" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">2.查找并保存视频元素</h1><p id="d58a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">下一步是瞄准你想要控制的视频。在我的应用中，我通过我的Rails API访问视频文件，我使用<a class="ae kv" href="https://cloudinary.com/" rel="noopener ugc nofollow" target="_blank"> Cloudinary </a>来管理视频上传和存储。我将组件的状态设置为recipe对象，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从RecipeDetail.js组件文件中的fetch设置状态</p></figure><p id="6491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用state，我能够使用来自state的视频作为源，在组件的<code class="fe ng nh ni mx b">return</code>语句中创建一个视频元素:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">RecipeDetail.js组件文件中的Return语句</p></figure><p id="1572" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe ng nh ni mx b">video</code>的ID，我创建了一个变量:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="b1fe" class="nb ma iq mx b gy nc nd l ne nf">let video = document.getElementById('video')</span></pre><p id="c995" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个访问视频元素的变量，我们准备好设置命令了。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="a6c8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">3.设置语音命令</h1><p id="1dc5" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">所有视频都有标准控制的编码命令，包括播放、暂停、快进等。在做研究时，我发现W3 的一个<a class="ae kv" href="https://www.w3.org/2010/05/video/mediaevents.html" rel="noopener ugc nofollow" target="_blank">示例站点已经设置了所有的视频命令，它们能够通过使用按钮来控制视频。在检查每个按钮后，我发现了如何使用命令来控制视频，我可以在我的应用程序中应用这些命令:</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在RecipeDetail.js组件文件中设置语音控制命令</p></figure><p id="9e6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我设置了一组命令。我决定播放，暂停，倒回十秒，快进十秒，静音和取消静音。我还包含了一个用于语音命令脚本的<code class="fe ng nh ni mx b">clear</code>命令，但是更多的是在测试和实现过程中使用。对于每个命令，您包括要监听的命令词以及实际控制嵌入视频的回调函数。</p><p id="44e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我设置了两个回调函数(一个名为<code class="fe ng nh ni mx b">listen</code>，一个名为<code class="fe ng nh ni mx b">stopListening</code>，用于切换语音识别的开关。打开后，<code class="fe ng nh ni mx b">SpeechRecognition</code>将从电脑的麦克风中拾取脚本，并聆听您设置的特定命令。关闭后，<code class="fe ng nh ni mx b">SpeechRecognition</code>将停止收听，并且不再跟踪记录。</p><p id="9670" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，我还调用了以下内容:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="9ee6" class="nb ma iq mx b gy nc nd l ne nf">setVoiceOn(true)</span></pre><p id="9314" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="c76a" class="nb ma iq mx b gy nc nd l ne nf">setVoiceOn(false)</span></pre><p id="66b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了在我的recipe详细信息页面上将recipe对象的状态设置为access之外，我还有一个语音命令的状态:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="c569" class="nb ma iq mx b gy nc nd l ne nf">const [voiceOn, setVoiceOn] = useState(false);</span></pre><p id="e73a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你在我的<code class="fe ng nh ni mx b">return</code>声明中所提到的，我已经设置了一个显示按钮的开关。当<code class="fe ng nh ni mx b">voiceOn</code>为<code class="fe ng nh ni mx b">false</code>时，app上出现一个按钮，可以让你“打开语音命令”。当<code class="fe ng nh ni mx b">voiceOn</code>为<code class="fe ng nh ni mx b">true</code>时，按钮将变为允许您“关闭语音命令”这是使用<code class="fe ng nh ni mx b">listen</code>和<code class="fe ng nh ni mx b">stopListening</code>功能打开和关闭麦克风的地方。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="64f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在遵循关于设置react-speech-recognition的<a class="ae kv" href="https://www.npmjs.com/package/react-speech-recognition#basic-example" rel="noopener ugc nofollow" target="_blank"> npm指南</a>中，有一个使用命令的示例实现，因此您也可以参考它。</p><p id="1137" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！</p><p id="62dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你设置了这些与你的视频相关的命令，你就可以运行你的应用程序并进行测试了！请随意观看我的演示，了解语音命令的实际效果(跳到2:53):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl nk l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5882" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">来源</h1><div class="nm nn gp gr no np"><a href="https://www.npmjs.com/package/react-speech-recognition#basic-example" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">反应语音识别</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">一个React挂钩，将来自麦克风的语音转换为文本，并使其可用于您的React组件…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.npmjs.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od kp np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://www.w3.org/2010/05/video/mediaevents.html" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">HTML5视频</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">这个页面演示了新的HTML5视频元素、它的媒体API和媒体事件。在…中播放、暂停和搜索</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.w3.org</p></div></div></div></a></div></div></div>    
</body>
</html>