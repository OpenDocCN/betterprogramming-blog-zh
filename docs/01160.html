<html>
<head>
<title>How To Programmatically Add Shadow and Rounded Corners to a View — Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何以编程方式为视图添加阴影和圆角— Swift</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-programmatically-add-shadow-rounded-corners-to-a-view-swift-df004ac98fa5?source=collection_archive---------6-----------------------#2019-08-19">https://betterprogramming.pub/how-to-programmatically-add-shadow-rounded-corners-to-a-view-swift-df004ac98fa5?source=collection_archive---------6-----------------------#2019-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be3e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">仅仅定义属性并添加圆角半径并不总是足够的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d5d3d4ff15fd9a08d996bc290996cdc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwtgxkveD343qF-p5mTSLg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@marsumilae?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Sam Cid </a>在<a class="ae ky" href="https://unsplash.com/search/photos/concrete-building?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f158" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在读这篇文章，你可能正在绞尽脑汁想弄明白为什么你的UIView没有阴影。不要难过。所有的iOS开发者迟早都要搞清楚这一点。有很多方法可以解决这个问题，我发现这个方法是最有效的。</p><p id="90d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想直接得到答案，你可以在我的<a class="ae ky" href="https://github.com/JosiahRininger/AddShadowAndRoundedCornersToView/blob/master/AddingShadowAndRoundedCornersToView/ViewController.swift" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到我的解决方案。否则，让我们看看为什么你看不到你的影子，并找出如何修复这一点。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0a69" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我的影子在哪里？</h1><p id="e557" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你们大多数人可能已经建立了这样的观点。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a935" class="ne md it na b gy nf ng l nh ni">view.layer.shadowRadius = 8<br/>view.layer.shadowOffset = CGSize(width: 3, height: 3)<br/>view.layer.shadowOpacity = 0.5</span><span id="cfb5" class="ne md it na b gy nj ng l nh ni">view.layer.cornerRadius = 20<br/>view.layer.masksToBounds = true</span></pre><p id="eb86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，你已经定义了创建投影所需的属性，并且添加了想要的圆角半径。这看起来应该可以，对吧？</p><p id="07cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不，这个问题是<code class="fe nk nl nm na b">masksToBounds = true</code>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a17f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">masksToBounds和这个有什么关系？</h1><p id="0aae" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><code class="fe nk nl nm na b">masksToBounds</code>是每个UIView的图层都有的属性。该属性将切断延伸到视图边界之外的任何子层或子视图。因此，通过将该属性设置为true，视图的边界现在变成了一个可见窗口，并且该窗口之外的所有视图内容都不再可见。所以当设置<code class="fe nk nl nm na b">masksToBounds</code>为假时，可能会导致你的视图以你不希望的方式呈现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1c1578d7f8b8d8d76dda00e2b703ba0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*Cw8w291_yGBB_bt2RyDfwQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">masksToBounds = false</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/30f023431b1e577284e5cde621c738a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SzYlICiZbST8qvV5IZQqOg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">masksToBounds = true</p></figure><p id="5ef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，在我们的例子中，<code class="fe nk nl nm na b">clipsToBounds</code>被设置为true与<code class="fe nk nl nm na b">masksToBounds</code>被设置为true的作用相同。</p><p id="f997" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有一个子视图在这个属性下是安全的，这包括阴影。想想吧。阴影位于视图边界之外。视图的投影将总是要求<code class="fe nk nl nm na b">maskToBounds</code>被设置为假以便可见。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7145" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">您可以通过使用contentsLayer来解决这个问题</h1><p id="a1e1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">什么是内容杀手？它只是一个子视图，与您的视图具有相同的宽度、高度和位置。它将保存视图的所有内容，并将其<code class="fe nk nl nm na b">masksToBounds</code>设置为true。</p><p id="c3c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这有什么帮助？现在你的<code class="fe nk nl nm na b">contentsLayer</code>已经开始注意将你的子视图屏蔽到它的边界，你终于可以给你的视图添加阴影了。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1a9b" class="ne md it na b gy nf ng l nh ni">// Creates your mainView<br/>var mainView: UIView = {<br/>    let view = UIView()<br/>    view.backgroundColor = .orange<br/>    view.layer.shadowRadius = 8<br/>    view.layer.shadowOffset = CGSize(width: 3, height: 3)   <br/>    view.layer.shadowOpacity = 0.5<br/>    view.layer.cornerRadius = 20   <br/>    view.translatesAutoresizingMaskIntoConstraints = false<br/>    return view<br/> }()</span><span id="fd64" class="ne md it na b gy nj ng l nh ni"> // Creates your contentsLayer<br/> // Add all your subsequent subviews to your contentsLayer<br/> var contentsLayer: UIView = {<br/>    let view = UIView()<br/>    view.backgroundColor = .orange<br/>    view.layer.cornerRadius = 20<br/>    view.layer.masksToBounds = true    <br/>    view.translatesAutoresizingMaskIntoConstraints = false<br/>    return view<br/> }()</span><span id="75c7" class="ne md it na b gy nj ng l nh ni">func setupView() {<br/>    view.backgroundColor = .white<br/>    view.addSubview(mainView)<br/>    mainView.addSubview(contentsLayer)</span><span id="db34" class="ne md it na b gy nj ng l nh ni">    NSLayoutConstraint.activate([</span><span id="bcdc" class="ne md it na b gy nj ng l nh ni">        // Constrains your mainView to the ViewController's view<br/>        mainView.centerYAnchor.constraint(equalTo: view.centerYAnchor),<br/>        mainView.centerXAnchor.constraint(equalTo: view.centerXAnchor),<br/>        mainView.heightAnchor.constraint(equalToConstant: view.frame.height * 0.5),<br/>        mainView.widthAnchor.constraint(equalToConstant: view.frame.width * 0.7),</span><span id="c9fe" class="ne md it na b gy nj ng l nh ni">        // Constrains your contentsLayer to the mainView<br/>        contentsLayer.centerYAnchor.constraint(equalTo: mainView.centerYAnchor),<br/>        contentsLayer.centerXAnchor.constraint(equalTo: mainView.centerXAnchor),<br/>        contentsLayer.heightAnchor.constraint(equalTo: mainView.heightAnchor),<br/>        contentsLayer.widthAnchor.constraint(equalTo: mainView.widthAnchor)<br/>    ])<br/>}</span></pre><p id="98ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是<a class="ae ky" href="https://github.com/JosiahRininger/AddShadowAndRoundedCornersToView/blob/master/AddingShadowAndRoundedCornersToView/ViewController.swift" rel="noopener ugc nofollow" target="_blank">的源代码</a>。</p><p id="766a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">额外提示:当一个视图没有背景色或者alpha小于1.0时，你不能给它一个阴影。相反，它的所有子视图都将继承阴影。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1dee" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">结论</strong></h1><p id="e73a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当您的视图的<code class="fe nk nl nm na b">masksToBounds</code>设置为true时，您的视图的阴影将不可见。这可以通过创建一个子视图来处理，这个子视图负责将你的内容屏蔽到它的边界。</p><p id="6bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的第一篇文章，但我真的希望我能帮助别人解决这个问题。我今年开始了iOS开发，还有很多东西要学，所以我希望听到其他的解决方案。</p></div></div>    
</body>
</html>