<html>
<head>
<title>Do I Need Python Scrapy to Build a Web Scraper?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我需要Python Scrapy来构建Web Scraper吗？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/do-i-need-python-scrapy-to-build-a-web-scraper-7cc7cac2081d?source=collection_archive---------9-----------------------#2019-09-16">https://betterprogramming.pub/do-i-need-python-scrapy-to-build-a-web-scraper-7cc7cac2081d?source=collection_archive---------9-----------------------#2019-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d72c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">否-使用简单的无头chrome爬虫</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9742c5d285601ceb748cf717f7ea599b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cO8QMVaKsE18btXOEK4XOw.png"/></div></div></figure><h1 id="fb89" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">总是好斗</h1><p id="bc87" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我谷歌了一下“如何构建一个网络爬虫”，第一个结果总是用Python写的，很多人建议使用来自<a class="ae mi" href="https://pypi.org/project/Scrapy/" rel="noopener ugc nofollow" target="_blank"> pip </a>的<a class="ae mi" href="https://scrapy.org" rel="noopener ugc nofollow" target="_blank"> Scrapy </a>库来构建它们。</p><p id="8d5b" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">我正在使用Node和JS构建这个特定项目的前端和后端，所以我不想切换语言，即使看起来有更多的人使用其他库或语言。</p><h2 id="9b42" class="mo kv it bd kw mp mq dn la mr ms dp le lv mt mu lg lz mv mw li md mx my lk mz bi translated">旁注:我不喜欢Python</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/641cc30586c8227e4fa0c108a95dddd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*HTtmbOf2VUX0mLwZr64w2Q.png"/></div></figure><p id="b262" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">我更喜欢使用可以清楚地看到我的函数或指令开始和结束的语言，我从来不喜欢使用Python，即使有时我真的需要在使用机器学习论文实现时处理它。</p><h1 id="aa95" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">我的JavaScript爬虫之旅</strong></h1><p id="78f1" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在阅读和测试Scrapy之后，我开始探索<a class="ae mi" href="https://github.com/search?l=JavaScript&amp;o=desc&amp;q=web+crawler&amp;s=stars&amp;type=Repositories" rel="noopener ugc nofollow" target="_blank"> npm </a>包的图库来解决同样的问题，但是在<a class="ae mi" href="https://github.com/search?l=JavaScript&amp;o=desc&amp;q=web+crawler&amp;s=stars&amp;type=Repositories" rel="noopener ugc nofollow" target="_blank"> Node.js </a>中:</p><ul class=""><li id="927f" class="nb nc it lo b lp mj ls mk lv nd lz ne md nf mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/apifytech/apify-js" rel="noopener ugc nofollow" target="_blank">Apify</a>:<a class="ae mi" href="https://github.com/apifytech/apify-js" rel="noopener ugc nofollow" target="_blank">https://github.com/apifytech/apify-js</a>JS+HTML+付费云</li><li id="bb04" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/yujiosaka/headless-chrome-crawler" rel="noopener ugc nofollow" target="_blank">无头浏览器爬虫</a>:<a class="ae mi" href="https://github.com/yujiosaka/headless-chrome-crawler" rel="noopener ugc nofollow" target="_blank">https://github.com/yujiosaka/headless-chrome-crawler</a>JS+HTML</li><li id="99ad" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/bda-research/node-crawler" rel="noopener ugc nofollow" target="_blank">爬虫</a>:<a class="ae mi" href="https://github.com/bda-research/node-crawler" rel="noopener ugc nofollow" target="_blank">https://github.com/bda-research/node-crawler</a>JS+HTML</li><li id="9a59" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/simplecrawler/simplecrawler" rel="noopener ugc nofollow" target="_blank">简单爬虫</a>:<a class="ae mi" href="https://github.com/simplecrawler/simplecrawler" rel="noopener ugc nofollow" target="_blank">https://github.com/simplecrawler/simplecrawler</a>只是HTML</li></ul></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="9329" class="ku kv it bd kw kx nw kz la lb nx ld le jz ny ka lg kc nz kd li kf oa kg lk ll bi translated">很好，但不适合我。</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/81a1ce76b9d88227f5d239cd319cbf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*uCNt7LmexBFcFSyHG6xVyA.png"/></div></figure><p id="1212" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">我花了一个小时试图用Apify SDK解析一个简单的页面，试图理解如何访问DOM和选择器。如果你想要一个伟大的爬虫，这可能对你有用，但你需要理解它的特殊逻辑，我没有时间。</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="0aad" class="ku kv it bd kw kx nw kz la lb nx ld le jz ny ka lg kc nz kd li kf oa kg lk ll bi translated">只是HTML</h1><p id="2194" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">由于速度快，我选择简单爬虫作为第一个从各种网站获取所有页面的程序。它很快，因为它只关注html文档，而不像其他使用Puppeteer的人那样拥有完整的JavaScript环境。</p><p id="3112" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">下面是一个简单爬虫的完整代码——只是纯HTML:<a class="ae mi" href="https://gist.github.com/Giorat/12be52223c9d6da5e7e872621bf009ca" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Giorat/12be 52223 c 9d 6 da 5 e 7 e 872621 BF 009 ca</a></p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="ab3f" class="mo kv it od b gy oh oi l oj ok">var supercrawler = require("supercrawler");<br/><br/>var crawler = new supercrawler.Crawler({<br/>    // Tme (ms) between requests<br/>    interval: 1000,<br/>    // Maximum number of requests at any one time.<br/>    concurrentRequestsLimit: 5,<br/>    // Time (ms) to cache the results of robots.txt queries.<br/>    robotsCacheTime: 3600000,<br/>    // Query string to use during the crawl.<br/>    userAgent: "Mozilla/5.0 (compatible; supercrawler/1.0; +https://github.com/brendonboshell/supercrawler)",<br/>});<br/><br/>crawler.addHandler("text/html", function (context) {<br/>    var sizeKb = Buffer.byteLength(context.body) / 1024;<br/>    console.dir(context.body.toString());<br/>    // here you can make all the parsing to the HTML of the body of the page<br/>    console.log("Processed", context.url, "Size=", sizeKb, "KB");<br/>});<br/><br/><br/>crawler.getUrlList()<br/>    .insertIfNotExists(new supercrawler.Url("https://gist.github.com/discover/"))<br/>    .then(function () {<br/>        return crawler.start();<br/>    });</span></pre><p id="b6bd" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">在解析了页面主体并确保所有需要解析的元素都存在之后，我继续解析元素。如果需要的话，我用另一个带有Javascript的爬虫开始了更深入的解析，以在客户端呈现SPA应用程序。</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="c40c" class="ku kv it bd kw kx nw kz la lb nx ld le jz ny ka lg kc nz kd li kf oa kg lk ll bi translated">无头Chrome爬虫胜出！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/fdc638dca2c9979b054db8fe7aa87ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywIS6nuX-ULYUuMTmRRcTA.png"/></div></div></figure><p id="d134" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated"><a class="ae mi" href="https://github.com/yujiosaka/headless-chrome-crawler" rel="noopener ugc nofollow" target="_blank"> HCC </a>或<a class="ae mi" href="https://github.com/yujiosaka/headless-chrome-crawler" rel="noopener ugc nofollow" target="_blank">无头Chrome爬虫</a>让我能够毫不费力地解析所有这些客户端渲染的页面，使用jQuery提供的所有选择器不到五分钟。</p><p id="4e6b" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">下面是一个简单爬虫的完整代码:<a class="ae mi" href="https://gist.github.com/Giorat/85d340b62a196eb70c1da500789cf402" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Giorat/85d 340 b 62 a 196 EB 70 C1 da 500789 cf 402</a></p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="87ff" class="mo kv it od b gy oh oi l oj ok">const HCCrawler = require('headless-chrome-crawler');<br/><br/>console.log('Starting the fetch');<br/><br/>const singlePage = false;<br/>let maxDepthCrawler = 6;<br/>if(singlePage)<br/>      maxDepthCrawler=1;<br/><br/>const makeupPageUrl = 'http://scrapoxy.io/';<br/><br/>(async () =&gt; {<br/>	const crawler = await HCCrawler.launch({<br/>        userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',<br/>        //headless: false,<br/>		//slowMo: 10,<br/>		evaluatePage: () =&gt; ({<br/>                  title: $('title').text(),<br/>                  //ADD here your other elements to parse from jQuery selectors<br/>		}),<br/>		onSuccess: (result) =&gt; {<br/>                  const results = result.result;<br/>                  console.log(`PRODUCT - ${results.title}.`);<br/>                  //ACCESS here the elements evaluted inside the page from the previous section, the name have to be the same  <br/>		}<br/>	});<br/><br/>	await crawler.queue({<br/>            url: makeupPageUrl,<br/>            maxDepth: maxDepthCrawler,<br/>            depthPriority: false,<br/>            allowedDomains: [/sephora\.it$/],<br/>	});<br/>	await crawler.onIdle();<br/>	await crawler.close();<br/>})();</span></pre><h1 id="fd91" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">查找选择器的速度提高了10倍</h1><p id="d2bf" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">为了让构建爬虫的JavaScript选择器的速度快十倍，我建议您安装以下浏览器扩展:</p><ul class=""><li id="603f" class="nb nc it lo b lp mj ls mk lv nd lz ne md nf mh ng nh ni nj bi translated">要在每个页面上安装<a class="ae mi" href="https://chrome.google.com/webstore/detail/jquery-injector/ekkjohcjbjcjjifokpingdbdlfekjcgi" rel="noopener ugc nofollow" target="_blank"> jQuery，请安装</a> this: <a class="ae mi" href="https://chrome.google.com/webstore/detail/jquery-injector/ekkjohcjbjcjjifokpingdbdlfekjcgi" rel="noopener ugc nofollow" target="_blank"> jQuery注入器</a>，<a class="ae mi" href="https://chrome.google.com/webstore/detail/jquery-injector/ekkjohcjbjcjjifokpingdbdlfekjcgi" rel="noopener ugc nofollow" target="_blank">在每个页面上启用</a>它。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://chrome.google.com/webstore/detail/jquery-injector/ekkjohcjbjcjjifokpingdbdlfekjcgi"><div class="gh gi om"><img src="../Images/be5b7d2416f44a3553152cbdc3da60f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*X0CfDAuaZ6vQTHZezeGFYg.png"/></div></a></figure><h2 id="333a" class="mo kv it bd kw mp mq dn la mr ms dp le lv mt mu lg lz mv mw li md mx my lk mz bi translated">如何找到合适的选择器？</h2><p id="150b" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">如果您尝试解析特定节点，您需要:</p><ul class=""><li id="2d40" class="nb nc it lo b lp mj ls mk lv nd lz ne md nf mh ng nh ni nj bi translated">打开你的浏览器</li><li id="90af" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated">打开检查器开发工具并选择控制台选项卡</li><li id="2b4c" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated">开始玩选择器吧！并在控制台中打印结果</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/2d14d86207a6e08c34775340f32c21e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SaLhL9r2qoZ70EymzUhMnA.png"/></div></div></figure></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="15a1" class="ku kv it bd kw kx nw kz la lb nx ld le jz ny ka lg kc nz kd li kf oa kg lk ll bi translated">结论</h1><p id="52fb" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">构建一个向自己提供web内容的爬虫应该基于一种技术，这种技术是每个网站web的一部分——像Javascript和Node，而不是Python！</p><p id="6098" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">未来对你的爬虫的改进可能是添加一个代理池来添加一个简单的负载平衡器，以减轻来自你的爬虫的所有请求，例如使用<a class="ae mi" href="https://github.com/fabienvauchelles/scrapoxy/" rel="noopener ugc nofollow" target="_blank">免费scrapoxy库</a>:【http://scrapoxy.io/】T2</p><p id="03e5" class="pw-post-body-paragraph lm ln it lo b lp mj ju lr ls mk jx lu lv ml lx ly lz mm mb mc md mn mf mg mh im bi translated">在这篇文章中，我刚刚分享了我的观点，我希望你能找到一些技巧或方法来加快你的工作，建立一个网络爬虫。如果你更喜欢使用Scrapy，请在twitter上告诉我！</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h1 id="0b06" class="ku kv it bd kw kx nw kz la lb nx ld le jz ny ka lg kc nz kd li kf oa kg lk ll bi translated"><strong class="ak">参考资料和资源</strong></h1><ul class=""><li id="c8ff" class="nb nc it lo b lp lq ls lt lv oo lz op md oq mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/brendonboshell/supercrawler" rel="noopener ugc nofollow" target="_blank">https://github.com/brendonboshell/supercrawler</a></li><li id="750f" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/yujiosaka/headless-chrome-crawler" rel="noopener ugc nofollow" target="_blank">https://github.com/yujiosaka/headless-chrome-crawler</a></li><li id="48cc" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="http://scrapoxy.io/" rel="noopener ugc nofollow" target="_blank">http://scrapoxy.io/</a></li><li id="4bf2" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/fabienvauchelles/scrapoxy/" rel="noopener ugc nofollow" target="_blank">https://github.com/fabienvauchelles/scrapoxy/</a></li><li id="5657" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://scrapy.org/" rel="noopener ugc nofollow" target="_blank">https://scrapy.org/</a></li><li id="207c" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://apify.com/" rel="noopener ugc nofollow" target="_blank">https://apify.com/</a></li><li id="040c" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://chrome.google.com/webstore/detail/jquery-injector/ekkjohcjbjcjjifokpingdbdlfekjcgi" rel="noopener ugc nofollow" target="_blank">https://chrome . Google . com/web store/detail/jquery-injector/ekkjohcjbjjifokpingdbdlfekjcgi</a></li><li id="15dc" class="nb nc it lo b lp nk ls nl lv nm lz nn md no mh ng nh ni nj bi translated"><a class="ae mi" href="https://github.com/search?l=JavaScript&amp;o=desc&amp;q=web+crawler&amp;s=stars&amp;type=Repositories" rel="noopener ugc nofollow" target="_blank">https://github.com/search?l=JavaScript&amp;o = desc&amp;q =网络+爬虫&amp;s =群星&amp;类型=仓库</a></li></ul></div></div>    
</body>
</html>