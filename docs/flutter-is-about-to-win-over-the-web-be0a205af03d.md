# Flutter 即将赢得网络

> 原文：<https://betterprogramming.pub/flutter-is-about-to-win-over-the-web-be0a205af03d>

## 跨平台框架提供了最引人注目的 web 开发体验

![](img/e00cfaf0a951b3826239b9ac18cf821a.png)

图片由作者创作(Flutter logo 来自 [Flutter 品牌指南](https://flutter.dev/brand)，HTML5 Logo 来自 [W3C](https://en.wikipedia.org/wiki/HTML5#/media/File:HTML5_logo_and_wordmark.svg) )。这张图什么都不代表。

今天的网站，包括你现在正在使用的网站，都是用 HTML、JavaScript 和 CSS 编写的。你可能读了之后会想，是的，这是显而易见的。如果我告诉你不用这三种技术中的任何一种来创建一个网站，你可能会有一些疑问。

然而，纵观历史，我们在这一领域有许多参与者。我们有 Flash，我们有 Silverlight，所有的竞争技术都试图从浏览器市场分一杯羹，让开发者使用不同的技术来创建网站。但是它们都没有真正起飞过。所以，亲爱的读者，我怎么可能来到你面前，告诉你在这个领域还会有竞争者呢？尤其是在这个领域的其他玩家尽管努力了多年，却没有一个人离开之后？

好吧，让我们花点时间来欣赏一下这些过去的尝试的共同点，即:

1.  **他们需要一个浏览器插件来运行。**他们通常需要一个特定于平台的浏览器插件才能在目标平台上运行。Silverlight 就是一个很好的例子——当时，使用 Linux 的人无法观看网飞，因为该网站依赖 Silverlight(Linux 不支持 Silverlight)。当然，有开源替代品，但没有第一方。
2.  他们引入了安全漏洞。 Flash 因此臭名昭著([有超过 1000 个已知漏洞](https://www.cvedetails.com/vulnerability-list/vendor_id-53/product_id-6761/Adobe-Flash-Player.html))。浏览器必须加载一个插件来显示内容，在这一点上，浏览器的任何安全保护都无关紧要，因为插件可以完全访问主机。
3.  **性能不如纯 HTML。**就加载插件和显示一些文本是否更快而言，只在原始 HTML 和 CSS 中进行总是比试图加载插件来显示一些内容更快。
4.  **HTML5 来了，CSS 进步了。突然之间，创造美好的体验不再是不可能的。更好的是，那些讨厌标准、使用奇怪的黑客技术、或者使用特定于供应商的实现而不是它们的 CSS 等价物(比如 Internet Explorer)的浏览器被淘汰了。**

所有这些都使得用原生 HTML 创建新的 web 应用程序变得容易。毕竟，如果你用来创建你的网络体验的技术被弃用，并停止接收安全补丁，那么你将别无选择，只能用一种新的、受支持的语言从头开始重写你的应用。但是我们最初是怎么来到这里的呢？HTML 是如何成为今天蓬勃发展的互联网的中流砥柱的？

![](img/f9bae8616d7ad647d94870196268fa1b.png)

由[约书亚·索蒂诺](https://unsplash.com/@sortino?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 新时代的开始

1991 年 8 月 6 日，[网络走向世界](https://thenextweb.com/insider/2011/08/06/20-years-ago-today-the-world-wide-web-opened-to-the-public/#:~:text=On%206%20August%201991%2C%20the,in%20Tim%20Berners-Lee's%20eye.)。最终，我们迎来了所谓的网络泡沫。想一想，网络在 1991 年才出现供公众使用，9 年后网络泡沫破裂，花费了惊人的 1.7 万亿美元。这意味着网络泡沫在同一年耗费了美国 15%的 GDP。

我们处在历史的那一部分，因为那是网络开始变得越来越正式的时候，我们写网站的方式变得越来越标准化。随着时间的推移，我们获得了可以使用的标准，如 HTML4，这些标准确保了您在您所在地区编写的 HTML 可以为大多数(如果不是全部)HTML 解释器工作。层叠样式表(CSS)也在 1996 年进入了流通领域，在那之前一年，JavaScript 也进入了这个领域。你能想象看到或使用一个没有 JavaScript 或 CSS 的网站吗？这肯定不会是一次愉快的经历。

但是纵观历史，网络的一些东西保持不变。公平地说，很多都是必须的:如果没有一个非常好的理由，你永远不会想要对 HTML 标准进行突破性的改变，所以在未来的版本中改变 web 的工作方式可能永远不会发生。这给我们留下了今天的网络，它包括什么？

## 文件

当网络首次出现时，人们并不像今天这样使用应用程序。你们中的一些人可能还记得使用终端作为瘦客户机，给你一个到主机的物理连接。人们拥有的“应用程序”(如果你可以这样称呼它们的话)只不过是屏幕上的几行文字。人们习惯于把东西当作文件，当作手中可以阅读的纸张。因此，HTML 页面的基础是生成 HTML 文档也就不足为奇了。如果你曾经使用过 JavaScript，你会对类似于`document.getElementById()`的函数很熟悉。你在网页上所做的一切都是为了制作和转换文档。

传统上，大多数网页都太高，无法放入一个视窗。所以用户必须用手指在页面上滑动或者用鼠标滚动。我想不出一个我今天使用的网站能很好地适应用户的视角(当然不是这种谩骂)，所以开发者总是可以保证页面的某个部分会在用户当前浏览页面的上方或下方。

但是，你仍然希望网页的某些部分保持在某个位置或者以某种方式对齐。您开始在 CSS 中使用类似于`position`的东西来控制元素的布局。有一大堆 CSS 属性(确切地说是[520](https://css-tricks.com/how-many-css-properties-are-there/#:~:text=520%20distinct%20property%20names%20from,reports%20and%2066%20editors'%20drafts.))，顾名思义，这些样式级联到它们的子元素中。当你试图让你的文档的某个特定部分看起来像某种方式时，它会变得相当混乱。如果你正在使用一个现有的样式框架，比如 Angular Material，那么它也会变得非常有趣，因为你开始覆盖内置的 CSS 来实现你所追求的某种外观。CSS 让你通过使用`!important`来覆盖这一点，但是一旦你开始这样做，战斗基本上就失败了。如果你读到这里，心里想“什么？这家伙听起来对 CSS 没什么希望，“那没关系，我不会在这一点上和你争论。但是当你的设计师追求某种外观时，CSS 会变得非常复杂。

![](img/52fea95359c536222657195996be9ad3.png)

照片由 [Pankaj Patel](https://unsplash.com/@pankajpatel?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

## 学习语言

为了创建一个简单的网站，你需要跨越三种不同的语言，这纯粹是为了网站本身。那就是 HTML，JavaScript，CSS。你的网站必须看起来和感觉起来都很棒，如果你不知道如何编写高性能的 JavaScript 或者你的 CSS 样式不好，它就不能做到这一点。

如果你真的想让你的网站做任何事情，那么你可以使用 Angular 或 React 这样的框架。随着你开始通过 npm 引入包，你的应用程序的大小开始增长，所以你也将使用像 [webpack](https://webpack.js.org/concepts/) 这样的捆绑器把你所有的包捆绑在一起，并适当地缩小它们。Webpack 本身就是一个话题(而且是一个很大的话题),但它是一个值得考虑的话题，并且确实构成了构建 web 应用程序的相当一部分。

## 捆绑和运输

一旦你有了自己的网站和软件包，你需要使用捆绑器来捆绑你的客户端应用程序，并确保它能在他们的浏览器中工作。根据用户使用的浏览器，你还需要“填充”某些功能，这样用户的浏览器才能真正使用你的网站。如果您使用的是 TypeScript 之类的语言，webpack 也会将文件从这种语言转换成 JavaScript。这没有什么本质上的不好，但它非常复杂，有很多活动的部分。如果你的网站崩溃了，是你弄乱了代码，还是缩小破坏了它，或者是 webpack 没有正确地包含它，或者是翻译过程引入了一个问题？这些复杂的管道可能会给调试或找到应用程序中问题的根本原因带来困难。

# Flutter 有什么好的吗？

如果你听说过 [Flutter](https://flutter.dev/docs) ，你可能在手机应用程序开发的背景下听说过它。那么它究竟如何应用于网站呢？嗯，对于一个普通的 HTML 网页，你可以把它当作一个文档来处理。不过在 Flutter 中，“页面”(或者用户与之交互的内容)实际上是被绘制到一个 HTML 画布上的。Flutter 实际上控制了绘制到屏幕上的每个像素，并且不使用 HTML、JavaScript 或 CSS 来定义它的任何外观或逻辑。(从技术上讲，原生 [Dart](https://dart.dev/guides) 代码是通过`dart2js`trans pile 到 JavaScript 的，实际上并没有用 JavaScript 写业务逻辑。)

你可能已经从这句话中得到了两点警示。第一，没有 HTML。第二，我们把一切都画到画布上。我明白——这听起来很奇怪，至少在直接在画布上画画的情况下，不是很有表现力。但是让我们更深入地研究一下。

![](img/058d9b641f9ba47ee286e48abc8d3eb6.png)

照片由[凯拉·霍泽尔](https://unsplash.com/@keilahoetzel?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄

## 在画布中而不是在文档中绘图

第一点是，我们没有使用 HTML 来编写网页，也没有将内容写入文档。乍一看，这完全是异端邪说。但是你用 HTML 开发一个网页，到底是在做什么呢？正如我们在本文前面所讨论的，您制作了一个对于用户设备的视窗来说太大的文档，然后它们会滚动。你现在正在阅读的这一页，文件的高度大于视窗的高度。你在浏览内容。

仔细想想，这难道不是一种奇怪的用户界面设计方式吗？期望内容在垂直方向上太大，用户不得不滚动浏览？如果您希望用户从左向右滚动，而不是从上到下滚动，该怎么办？在正常的网页上不是特别好表达。

在 Flutter 中，如果你想让某个特定的内容水平滚动而不是垂直滚动，那就像把小部件包装在一个`SingleChildScrollView`中一样简单。您还可以轻松地指定滚动本身的方向，无论它应该在垂直轴还是水平轴上滚动。

因为 Flutter 是基于在单个部件中布局页面的概念，而不是将文档绘制到屏幕上，所以开发人员可以更好地控制他们想要如何布局他们的应用程序。

## 坚持使用一种语言

如前所述，创建一个伟大的网站意味着你必须知道 HTML，JavaScript 和 CSS。这也意味着你的知识不能在这些语言之间转移，例如，你不能在 HTML 中重用你的 JavaScript 知识。HTML 纯粹是你的标记语言，CSS 纯粹是你的样式语法，JavaScript 纯粹是你的编程语言。这些选项都不包括类型检查，所以你的 CSS 可能完全是一派胡言，当用户试图使用你的网页时，它会悄无声息地失败。

Flutter 使用 Dart 作为它的语言，应用程序的所有外观和业务逻辑都是用它编写的。Dart 带有静态类型检查，而 [null safety 即将登陆](https://dart.dev/null-safety)，因此您应用程序中的每一行代码，无论是用来直观地描述您的应用程序，赋予您的应用程序风格，还是控制您的应用程序的业务逻辑，都是完全类型安全的。

## 更容易布置您的应用程序

概括地说，我们使用网站来显示来自另一个来源的数据:无论这个来源是数据库、API 还是其他什么，我们最终都会得到我们想要显示的数据。想象一下，我们有一个从 API 返回的对象数组，您使用类似 Angular 的东西来显示它们。通常，您会将这些对象加载到支持组件中，然后使用`*ngFor`遍历它们。你可能会把它附加到一个`div`上。然而，对于一个没有风格的`div`，它看起来会很简单。您可能希望列表中的项目出现在一列或一行中，因此您必须使用一些 CSS 或 flexbox 来实现这一点。

相反，使用 Flutter，您可以通过使用一个`Column`或一个`Row`来布局您的子节点，这些子节点具有一个接受对象数组的`children`属性。当你思考这个问题时，大多数时候，你可能希望你的对象数组排成一行(并排)或者一列(上下)。因为有了它，您可以更快地得到您想要的视觉布局，然后再开始对列表中的各个项目进行样式化。以我的经验来看，这导致了网站更快的搭建和原型制作，而不会影响最终结果。

## 控制视口中的每个像素

因为 Flutter 将每个像素渲染到屏幕上，这使得设计人员和开发人员能够更好地控制他们希望自己的应用程序或体验看起来是什么样子。将每个像素渲染到屏幕上听起来好像会带来巨大的性能冲击，不要误解我的意思，这肯定没有现在渲染原始 HTML 快，但 GPU 加速的画布等东西正在支撑这一领域的性能。传统上，用 HTML 设计你的网页意味着你必须考虑不同的浏览器。不过，在 Flutters 的例子中，因为你用某种字体布局了一个`Text`小部件，所以不管它在哪里显示，它看起来都是一样的，因为 Flutter 是在每像素的基础上控制那个特定小部件的外观。

## 再见，网络包！

因为 Flutter 使用 Dart，所以当针对其目标平台编译 Flutter 应用程序时，它也会将所有依赖包(也是用 Dart 编写的)转换为 JavaScript。Dart 是一种类型安全的语言，不支持反射，所以这样做的效果是编译器对你的应用程序调用什么和不调用什么有了更好的了解。这导致你的应用程序更好的树抖动和缩小。为 web 构建您的 Flutter 应用程序不使用 webpack，因为它不需要它，这对于 Flutter 本身来说是一个非常强有力的例子(至少在我看来是这样)。webpack 没什么问题；这是一个高质量的软件。但它是已经很复杂的管道中的一个复杂的工具。

# 但是我们还没到那一步

网络不仅仅是时髦的网页、华丽的动画和美好的体验。我们需要的不仅仅是这些。我们需要服务器端渲染(SSR)，所以我们的网页可以被搜索引擎抓取，以进行任何类型的搜索引擎优化(SEO)。目前，Flutter 网站只能由人来解释，而不是由搜索引擎来解释，所以这将对人们如何在你的网站上搜索和找到信息产生巨大的影响。(人们正在[就这个问题](https://github.com/flutter/flutter/issues/47600)进行讨论，看起来近期不会有解决方案)。

将一切都绘制到画布上也有其性能影响，但这些并不像您想象的那么糟糕。我做了一个大量使用视觉效果的[测试应用](https://vivid-explorer.web.app/#/)，它在我的 MacBook 上以接近 60fps 的速度运行。即使当您将表单拖到屏幕上时，它仍然表现良好，逐渐增加后面图像的模糊度。我不是 Dart 方面的专家，所以毫无疑问，这个过程可以进一步优化。

因此，在人们考虑将 Flutter 用于主流 web 开发之前，它需要在几个关键领域进行改进。但是想一想:Flutter 是在最近两年才真正问世的，它已经拥有的性能和功能集简直令人难以置信。

如果你可以制作一个高性能的网站，并且可以使用一种语言来设计、设计和编写你的 web 应用程序的业务逻辑，那会是什么呢？如果 webpack 对您的开发管道变得多余？如果有一天你能拥有服务器端的渲染和你今天在传统的基于 HTML 的网站上所拥有的所有搜索引擎优化功能，你会怎么样？

如果你拥有所有这些，那么 Flutter 就能赢得网络。

您是否正在考虑迁移到 Flutter，但是您已经有了视图绑定框架的经验，比如 Xamarin Forms？点击这里查看我关于这个主题的新视频系列:【guides.page.link/6SuK 