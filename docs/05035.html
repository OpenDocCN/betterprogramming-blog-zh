<html>
<head>
<title>Lyft Envoy. What’s That?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Lyft特使。那是什么？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/what-is-lyft-envoy-9dfb45470f19?source=collection_archive---------6-----------------------#2020-06-02">https://betterprogramming.pub/what-is-lyft-envoy-9dfb45470f19?source=collection_archive---------6-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b4e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Envoy是一个开源的云原生代理，致力于解决重要的分布式系统缺陷</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/541f196471825decc637c704cfaaec5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBgru4d1lsORR61EbNKq4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GitHub 上<a class="ae ky" href="https://github.com/envoyproxy/artwork/blob/master/PNG/Envoy_Logo_Final_PANTONE.png" rel="noopener ugc nofollow" target="_blank">特使的照片。</a></p></figure><p id="a5f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">长久以来，<a class="ae ky" href="https://www.lyft.com/" rel="noopener ugc nofollow" target="_blank"> Lyft </a>一直在为开源社区贡献一些<a class="ae ky" href="https://lyft.github.io/" rel="noopener ugc nofollow" target="_blank">的精彩项目</a>。</p><p id="acf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Envoy Proxy是他们顶级的开源产品之一，针对的是微软、网飞、SAP、VMware和优步等公司的许多开发人员正在努力解决的问题。</p><p id="98ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2017年9月，Envoy捐赠给<a class="ae ky" href="https://www.cncf.io/cncf-envoy-project-journey/" rel="noopener ugc nofollow" target="_blank">云原生计算基金会</a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6529" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍</h1><p id="b1b5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">时至今日，构建软件系统的现代方式是利用<a class="ae ky" href="https://docs.microsoft.com/en-us/azure/architecture/guide/architecture-styles/microservices" rel="noopener ugc nofollow" target="_blank">微服务架构</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/7f8f18103da8c2e28f26d7f73f30bebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qLosNHJ41MdznJQ1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@vladhilitanu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Vlad Hilitanu </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><blockquote class="na nb nc"><p id="e88b" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">“微服务(也称为微服务架构)是一种架构风格，它将应用程序构建为一组服务，这些服务具有以下特点:</p><p id="bd36" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">高度可维护和可测试</p><p id="0819" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">松散耦合</p><p id="d539" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">可独立部署</p><p id="05e9" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">围绕业务能力组织</p><p id="a808" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">由一个小团队拥有</p><p id="598e" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">微服务架构支持快速、频繁、可靠地交付大型复杂应用。它还使组织能够发展其技术堆栈。”— <a class="ae ky" href="https://microservices.io/" rel="noopener ugc nofollow" target="_blank">微服务io </a></p></blockquote><p id="aecb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，随着微服务架构的出现，行业正稳步走向云原生解决方案。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/5b690de2f008e183eebb72cebbedc6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6s07bYUuFlrdGmrG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个云原生实体|照片由<a class="ae ky" href="https://unsplash.com/@borisworkshop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">鲍里斯·斯莫克罗维奇</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><blockquote class="na nb nc"><p id="081c" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">“云原生技术使组织能够在现代动态环境(如公共云、私有云和混合云)中构建和运行可扩展的应用。容器、服务网格、微服务、不可变基础设施和声明式API就是这种方法的例子。</p><p id="80ae" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">这些技术使得松散耦合的系统具有弹性、可管理性和可观察性。与强大的自动化相结合，它们允许工程师以最少的劳动频繁地、可预测地做出高影响力的改变。“— <a class="ae ky" href="https://github.com/cncf/foundation/blob/master/charter.md" rel="noopener ugc nofollow" target="_blank">云原生计算基础</a></p></blockquote><p id="1f8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，总体而言，云原生微服务系统是一个非常好的策略，但不幸的是，没有不带刺的玫瑰。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e960" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">问题</h1><p id="a6e9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">微服务往往会给软件系统带来一些复杂性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/65c5e2861f1559249ef5f0b335e402e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AE1ijExggfH_pkE0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@punttim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">蒂姆·高</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="72d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很长一段时间以来，软件工程师一直在努力解决这些常见的微服务陷阱。</p><p id="12f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种软件架构引入的困难之一是<strong class="lb iu">调试</strong>。微服务几乎不可能调试，这很不幸，也绝对是一个严重的问题。</p><p id="5a6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是由于它们的模块化和异构性。使用许多不同的技术开发了许多不同的服务。这直接暗示了几个问题:</p><ol class=""><li id="8c20" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">由于在向系统发出一个请求的过程中会有多个服务调用，因此很难准确地追踪到请求执行的最终问题的根源。</li><li id="5301" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">此外，每个服务都可以有自己特定的日志记录机制，有自己的工作流和自己的缺点——如果这种机制存在的话。这意味着日志记录可能不一致，难以管理，并且可能很快失控。</li></ol><p id="9010" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于糟糕的调试功能，甚至缺乏调试功能，开发人员将无法快速准确地识别问题。这将不可避免地使工程师对系统失去信心，从而大大降低生产率。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9f3f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">解决方案</h1><p id="50c3" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这是特使开始发光的地方。</p><blockquote class="na nb nc"><p id="8942" class="kz la nd lb b lc ld ju le lf lg jx lh ne lj lk ll nf ln lo lp ng lr ls lt lu im bi translated">“Envoy Proxy是一款现代化、高性能、小尺寸的边缘和服务代理。Envoy为您的服务增加了弹性和可观察性，并且它以一种对您的服务实现透明的方式做到了这一点。”— <a class="ae ky" href="https://www.datawire.io/envoyproxy/getting-started-lyft-envoy-microservices-resilience/" rel="noopener ugc nofollow" target="_blank">数据线</a></p></blockquote><p id="e5aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Envoy不仅解决了这些问题，还提供了一些非常方便的特性来简化调试和开发。</p><p id="c4f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当用作服务代理时，Envoy被部署为一个<a class="ae ky" href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sidecar" rel="noopener ugc nofollow" target="_blank"> sidecar应用程序</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8c222a37ba2937256eab09fc88b12d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8Fig1ntr2LPWT-pE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@vonshnauzer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">叶戈尔·迈兹尼克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="f467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为某个服务的边车意味着特使直接连接到它。由于Envoy是一个代理，它的职责是接收、处理和监控所有进出服务的流量。</p><p id="fdd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在理想情况下，软件系统的每个服务都应该有一个特使代理侧柜，从而为系统带来多种重要好处:</p><ol class=""><li id="7c53" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">使用Envoy的服务发现机制，所有代理收集和分发收集的流量数据，从而提供分布式日志记录、跟踪和统计。这大大增强了调试能力。</li><li id="4232" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">同样，由于Envoy的服务发现功能，服务本质上只需要知道Envoy代理的地址，因为其他服务可以通过域名解析。这实现了网络透明性，允许开发人员主要关注业务逻辑，消除了他们了解网络拓扑和与其他服务通信的更深入逻辑的需要。网络透明的概念相当强大。</li><li id="1790" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">此外，Envoy代理在给定服务的所有副本之间提供了过多的高级负载平衡功能。仅举几个例子，主动/被动健康检查、电路断开、自动重试、超时、全局速率限制等等。其中一些特性可以很容易地提取到客户端库中，但当我们审视单个微服务系统中涉及的所有不同技术堆栈时，在这些新技术中反复移植这些库将需要相当多的努力。此外，维护这个库的所有端口也很麻烦。</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4897" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="e775" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Envoy为微服务软件系统、网络透明性和通用最佳实践通信设计模式提供关键的调试功能。</p><p id="31ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Envoy代理使软件系统更加透明、更有弹性、更易于开发、调试起来更简单。</p><p id="e1a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你觉得Envoy是你想了解的东西，你可以从官方文件开始，从T2 GitHub页面开始，或者从Lyft工程师Matt Klein的精彩视频开始。</p></div></div>    
</body>
</html>