<html>
<head>
<title>7 Custom React Hooks You Probably Need in Your Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的项目中可能需要的7个自定义React挂钩</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/7-custom-react-hooks-you-probably-need-in-your-project-12f86216df94?source=collection_archive---------2-----------------------#2021-08-19">https://betterprogramming.pub/7-custom-react-hooks-you-probably-need-in-your-project-12f86216df94?source=collection_archive---------2-----------------------#2021-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="86b3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提取和重用react代码和JS逻辑的有用钩子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ef431fe773b6406122e52b95a8e5a9e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEo6mn6sSWDM0lcBD7KvEw.jpeg"/></div></div></figure><p id="20a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">钩子非常适合将逻辑提取到可重用的函数中。有很多npm包提供了内置的定制钩子。我个人不喜欢安装一些npm模块来获得我自己只用十行代码就能编写的功能。</p><p id="3d6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我整理了一个列表，列出了我在项目中使用的七个有用的常用钩子。</p><h1 id="3b82" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">1.使用开关</h1><p id="9a0d" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这个钩子很常见，它用于在真和假之间切换布尔值。当我们想要显示/隐藏模态或打开/关闭侧菜单时，这很有用。这个钩子的一个基本版本如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="a882" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="ad6e" class="mp lr it nc b gy ng nh l ni nj">import useToggle from './useToggle';</span><span id="6d84" class="mp lr it nc b gy nk nh l ni nj">const App = () =&gt; {<br/>  const [show, toggleShow] = useToggle();</span><span id="fb9a" class="mp lr it nc b gy nk nh l ni nj">  return (<br/>    &lt;Modal show={show} onClose={toggleShow}&gt;<br/>      &lt;h1&gt;Hello there&lt;/h1&gt;<br/>    &lt;/Modal&gt;<br/>  );<br/>}</span></pre><p id="5517" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们想要显示/隐藏表中某一行的模态时，可以根据用例对这个钩子稍加修改。我添加了一个<code class="fe nl nm nn nc b">customToggle</code>方法，它将值设置为一个给定值，而不是切换之前的状态值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="55c1" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">用例</h2><p id="cf34" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">假设我们在一个表中有许多行，我们想提供一个删除行的选项。单击删除按钮应该会打开一个确认模式。</p><p id="703d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于这种类型的功能，我们需要状态中的两个变量。第一，保存用于确定是否显示删除确认模式的布尔值，第二，保存必须显示删除模式的行id。</p><p id="4e82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用这个钩子，我们可以用一个状态变量来完成。以下是如何做到这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="c3e8" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">2.使用页面底部</h1><p id="7fc1" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">使用这个钩子，您可以确定用户是否已经滚动到页面的底部。非常适合无限滚动的应用程序，当用户滚动到页面底部时，您需要获取更多数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="2b79" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="f7aa" class="mp lr it nc b gy ng nh l ni nj">import usePageBottom from './usePageBottom';</span><span id="b971" class="mp lr it nc b gy nk nh l ni nj">const App = (props) =&gt; {<br/>  // hook usage<br/>  const scrolledBottom = usePageBottom();</span><span id="356a" class="mp lr it nc b gy nk nh l ni nj">  return (<br/>    &lt;div className="App" style={{ height: '150vh' }}&gt;<br/>      &lt;h1&gt;This is app&lt;/h1&gt;<br/>      &lt;p&gt;Scrolled to bottom {scrolledBottom}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><h2 id="758e" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">添加节流阀(可选)</h2><p id="1c70" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">减少像窗口滚动事件这样多次触发的事件的通知是一个最佳实践，我们可以使用一个节流设置事件侦听器。我用的是lodash的油门；也可以使用去抖。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="fd0a" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">3.useElementBottom</h1><p id="4cba" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">就像page bottom一样，我们也可以确定用户是否已经滚动到元素的底部。在这个钩子中，传递了对元素的引用，因此我们可以使用元素的高度和当前滚动位置来确定元素是否滚动到底部。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="cbf2" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="3c19" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">4.使用以前的</h1><p id="9e3b" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">我们可以定制一个钩子来获取属性或状态的前一个值。有了React类组件，<code class="fe nl nm nn nc b">componentDidUpdate</code> lifecycle可以用来获取以前的prop和state值。对于功能组件，我们可以使用自定义挂钩来实现，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="22df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们使用一个<code class="fe nl nm nn nc b">useRef</code>钩子来存储先前的值。我们的钩子返回引用对象在<code class="fe nl nm nn nc b">useEffect</code>中更新之前的值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="6354" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">5.使用窗口大小</h1><p id="8452" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这个钩子返回窗口的宽度和高度。我们在调整窗口大小时设置了一个throttled set事件监听器，这样我们每次都能得到正确的宽度和高度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="1ce6" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><p id="ec81" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您想根据窗口的宽度或高度在JS代码中做一些事情时，这很有用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="7cdf" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">6.useEventListener</h1><p id="5130" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">有了这个钩子，将事件侦听器绑定到窗口或窗口元素变得很容易。在钩子的效果中，我们检查元素是否是来自<code class="fe nl nm nn nc b">useRef</code>的引用。如果没有，我们将把事件监听器添加到全局窗口对象中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h2 id="4fb2" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="f103" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们也可以使用相同的钩子将事件添加到窗口中</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="6d9d" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">7.使用位置</h1><p id="8f57" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">有时，您需要在本地存储和状态之间同步一个值。这个钩子做的完全一样。我们使用<code class="fe nl nm nn nc b">useState</code>并检查指定的键在本地存储中是否有值，这样我们就可以用它作为初始值。这允许我们在页面刷新时保持值与状态同步。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="7277" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当值更新时，会运行一个更新本地存储中的值的效果。</p><h2 id="ca0d" class="mp lr it bd ls mq mr dn lw ms mt dp ma ld mu mv mc lh mw mx me ll my mz mg na bi translated">例子</h2><p id="603f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">假设您想要在本地存储中存储一个用户主题偏好</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="1fe0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您点击更改主题按钮时，状态和本地存储中的值都将更新。在页面刷新之后，您将获得存储在本地存储中的最后一个值。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="f2c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您不局限于这些常见的挂钩，您还可以创建适合您的项目的定制挂钩。有没有什么可以在这里列出的？</p><p id="bced" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读。如果你喜欢你读到的东西，也可以看看这个故事:</p><div class="nv nw gp gr nx ny"><a rel="noopener  ugc nofollow" target="_blank" href="/10-modern-javascript-tricks-every-developer-should-use-377857311d79"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">每个开发人员都应该使用的10个现代JavaScript技巧</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">编写简短、简洁、干净的JavaScript代码的技巧</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">better编程. pub</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div></div></div>    
</body>
</html>