<html>
<head>
<title>How To Initialize Mint Accounts and Mint Tokens Using the Anchor Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Anchor框架初始化Mint帐户和Mint令牌</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-initialize-mint-accounts-and-mint-tokens-using-the-anchor-framework-c989d1ba4f97?source=collection_archive---------6-----------------------#2022-08-17">https://betterprogramming.pub/how-to-initialize-mint-accounts-and-mint-tokens-using-the-anchor-framework-c989d1ba4f97?source=collection_archive---------6-----------------------#2022-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0fea" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">该程序实验的简要指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5a4e7ceecba08461d744cfcdbf76a651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xQgLKAb-eWFLGKws"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@imagix_eye_studio_13?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> shehan levusara </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="5baf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文将向您展示如何在Anchor中使用derive宏来初始化Solana网络中的mint帐户和mint令牌。</p><p id="e8f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SOL(SOL)是sola网络的本地令牌。但是，如果您需要在Solana网络上创建另一个令牌，它会为您提供所需的所有资源。用于编写智能合同(程序)的anchor框架使用derive宏简化了这一过程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/3585d44453d83a0da5b08d52b893a7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5LeytLwJ5WTFANK4F5v5aw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@theshubhamdhage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Shubham Dhage </a>在<a class="ae kv" href="https://unsplash.com/s/photos/tokens?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="acdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">派生宏是锚定框架的一个特殊特性，用于简化结构的序列化/反序列化。根据此处找到的<a class="ae kv" href="https://docs.rs/anchor-lang/latest/anchor_lang/derive.Accounts.html" rel="noopener ugc nofollow" target="_blank">官方文档，派生宏可以通过使用属性和指令提供进一步的功能。</a></p><p id="2aad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，让我们来看看Anchor框架是如何使初始化mint帐户和向特定的关联令牌帐户(ATA)创建令牌的过程变得非常简单的。</p><h1 id="d213" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">第一步。先决条件</h1><p id="42e8" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">VS代码—代码编辑器<br/>锚版本— 0.24.2</p><p id="3a0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之前对锚框架的了解</p><h1 id="ebb6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">第二步。初始化薄荷账户</h1><p id="9e24" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是初始化新的mint帐户的rust代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="1de1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看这段代码是如何工作的。结构<code class="fe ms mt mu mv b">InitializeMint</code>是传递给函数<code class="fe ms mt mu mv b">initailize_mint</code>的内容。第17到24行的代码用一个给定的地址初始化一个mint帐户。当初始化一个新账户时，我们可以使用字段<code class="fe ms mt mu mv b">payer</code>指定谁将为该交易付款。除此之外，还可以指定<code class="fe ms mt mu mv b">authority</code>和<code class="fe ms mt mu mv b">freeze_authority</code>。</p><p id="3fc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们对所有三个字段都使用了<code class="fe ms mt mu mv b">payer</code>。但是如果你想用另一个地址作为<code class="fe ms mt mu mv b">authority</code>或<code class="fe ms mt mu mv b">freeze_authority</code>，我们非常欢迎你这样做。第26行中的<code class="fe ms mt mu mv b">payer</code>被定义为签名者账户。这是因为在第19行，我已经命名了<code class="fe ms mt mu mv b">payer = payer</code>，付款人必须在交易上签字。</p><p id="8b6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里提到的<code class="fe ms mt mu mv b">authority</code>帐号在创建后将被授权铸造和焚烧代币。<code class="fe ms mt mu mv b">freeze_authority</code>将是可以随时冻结mint账户功能的账户。为了完成该事务，需要将一些助手帐户传递给该结构。他们是<code class="fe ms mt mu mv b">system_program,token_program</code>和<code class="fe ms mt mu mv b">rent.</code></p><p id="4824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看如何从JS端测试这段代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="e9b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里需要注意的重要一点是，分别作为<code class="fe ms mt mu mv b">payer</code>和<code class="fe ms mt mu mv b">mint</code>的<code class="fe ms mt mu mv b">fromwallet</code>和<code class="fe ms mt mu mv b">mint</code>都必须签署交易。<code class="fe ms mt mu mv b">fromwallet</code>必须签名，因为它为交易付款，而<code class="fe ms mt mu mv b">mint</code>必须签名，以确认我们为初始化mint帐户而提供的帐户私钥归我们所有。</p><h1 id="b87a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">第三步。向ATA铸造代币</h1><p id="733a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是为ATA创建令牌的rust代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="6176" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ms mt mu mv b">MintToken</code>是传递给函数<code class="fe ms mt mu mv b">mint_token</code>的结构，用于将令牌转换为指定的ATA。在这个结构中，您需要在字段<code class="fe ms mt mu mv b">mint</code>中指定造币厂的地址。<code class="fe ms mt mu mv b">token_program</code>是需要指定的帮助者账户。<code class="fe ms mt mu mv b">token_account</code>是您将向其中铸造令牌的ATA。</p><p id="4652" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ms mt mu mv b">authority</code>字段需要包含初始化薄荷账户时设置的薄荷账户的权限。<code class="fe ms mt mu mv b">token_account</code>和<code class="fe ms mt mu mv b">mint</code>被设置为可变的(<code class="fe ms mt mu mv b">#[account(mut)]</code>)，因为在交易发生后，账户的余额将被改变。</p><p id="dfd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你看一下<code class="fe ms mt mu mv b">mint_token</code>函数，很明显在这个函数调用中发生了跨程序调用(CPI)。这个程序在第18行调用了<code class="fe ms mt mu mv b">token_program</code>帐户。<code class="fe ms mt mu mv b">token_program</code>是索拉纳所有令牌的管理机构。</p><p id="598d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，Solana上的任何铸造、燃烧或任何相关令牌都应该通过调用<code class="fe ms mt mu mv b">token_program</code>函数来执行。</p><p id="6f7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们看看铸造令牌的JS代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3b76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">需要注意的是，应该给字段<code class="fe ms mt mu mv b">tokeAccount</code>一个ATA作为输入。因此，在第8行，我们已经为特定的<code class="fe ms mt mu mv b">mint</code>导出了<code class="fe ms mt mu mv b">fromWallet</code>的相关令牌帐户。</p><p id="4cec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，您可以从您的mint帐户向您的目标ATA铸造任意数量的令牌。</p><p id="0248" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p><p id="2b29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇教程之后，我将会写另一篇关于如何在Solana中烧令牌以及如何用Anchor框架来完成的教程。</p><p id="1565" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">干杯！</p><h1 id="4a53" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak">资源</strong></h1><ol class=""><li id="a3bc" class="mw mx iq ky b kz ml lc mm lf my lj mz ln na lr nb nc nd ne bi translated">锚郎文档—<a class="ae kv" href="https://docs.rs/anchor-lang/latest/anchor_lang/derive.Accounts.html" rel="noopener ugc nofollow" target="_blank">https://docs.rs/anchor-lang/latest/anchor_lang/derive.Accounts.html</a></li></ol></div></div>    
</body>
</html>