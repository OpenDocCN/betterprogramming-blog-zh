<html>
<head>
<title>Use .every() to Validate JavaScript Array Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用。every()验证JavaScript数组值</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/use-every-to-validate-javascript-array-values-2ce548756543?source=collection_archive---------9-----------------------#2020-03-02">https://betterprogramming.pub/use-every-to-validate-javascript-array-values-2ce548756543?source=collection_archive---------9-----------------------#2020-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="513e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">检查数组中所有元素的最佳方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/66fe424d5548294cf889321f6e5dd7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rwwb2H-F8pJG-lDQFi0JFQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯文·梅勒弗在<a class="ae ky" href="https://unsplash.com/s/photos/check?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7290" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数组是主要的数据结构；对于任何程序员来说，学习使用它们的不同和最佳方式都是一项关键技能。数组有内置的方法用来用<a class="ae ky" href="https://medium.com/better-programming/stop-using-for-loops-to-iterate-over-arrays-5c46940e79d1" rel="noopener">替换</a> <code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/better-programming/stop-using-for-loops-to-iterate-over-arrays-5c46940e79d1" rel="noopener">for</a></code> <a class="ae ky" href="https://medium.com/better-programming/stop-using-for-loops-to-iterate-over-arrays-5c46940e79d1" rel="noopener">循环</a>。</p><p id="c269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener"/><code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">map()</a></code><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener"/><code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">filter()</a></code><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">和</a> <code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">reduce()</a></code> <a class="ae ky" href="https://medium.com/better-programming/how-to-start-using-map-filter-and-reduce-e01edba0d81" rel="noopener">方法</a>得到了大部分的关注，但它们不是唯一的。如果您手头的任务是验证数组中的所有元素，那么您需要使用<code class="fe lv lw lx ly b">every()</code>方法。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="8a1b" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">的。every()方法</h1><p id="0dc6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">根据<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/every" rel="noopener ugc nofollow" target="_blank"> MDN web docs </a>，通过传递回调函数调用<code class="fe lv lw lx ly b">every()</code>方法。箭头中的每个元素都将被传递给回调函数，如果所有元素都返回true，那么<code class="fe lv lw lx ly b">every()</code>将返回true。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="472b" class="nh mh it ly b gy ni nj l nk nl">function isFive(n) {<br/>  return n == 5;<br/>}</span><span id="4b2c" class="nh mh it ly b gy nm nj l nk nl">var nums = [5,5,5];</span><span id="b45e" class="nh mh it ly b gy nm nj l nk nl">console.log(nums.every(isFive)); // true</span></pre><p id="2fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的代码示例可以通过几种方式进行优化。如果回调只被使用一次，匿名的<a class="ae ky" href="https://medium.com/better-programming/learning-javascript-arrow-functions-36cce13351c2" rel="noopener">箭头函数</a>可以代替它使用。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="46fd" class="nh mh it ly b gy ni nj l nk nl">var nums = [5,5,5];</span><span id="9e0b" class="nh mh it ly b gy nm nj l nk nl">// full arrow syntax<br/>console.log(nums.every((n) =&gt; { return n == 5; }));</span><span id="40b2" class="nh mh it ly b gy nm nj l nk nl">// shorthand arrow syntax<br/>console.log(nums.every(n =&gt; n == 5));</span></pre><p id="7e59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在支持ES6的环境中工作，您应该使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43" rel="noopener ugc nofollow" target="_blank">let</a></code> <a class="ae ky" href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43" rel="noopener ugc nofollow" target="_blank">或</a> <code class="fe lv lw lx ly b"><a class="ae ky" href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43" rel="noopener ugc nofollow" target="_blank">const</a></code> <a class="ae ky" href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43" rel="noopener ugc nofollow" target="_blank">而不是</a> <code class="fe lv lw lx ly b"><a class="ae ky" href="https://levelup.gitconnected.com/stop-using-var-to-declare-variables-in-javascript-6c0caec16f43" rel="noopener ugc nofollow" target="_blank">var</a></code>来定义数组。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="8923" class="nh mh it ly b gy ni nj l nk nl">// use if nums will change<br/>let nums = [5,5,5];</span><span id="538b" class="nh mh it ly b gy nm nj l nk nl">// use if nums will not change<br/>const nums =  [5,5,5];</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="69c7" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">for循环呢？</h1><p id="95d6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果你坚持使用普通的<code class="fe lv lw lx ly b">for</code>循环，那么让我们看看前面重构为<code class="fe lv lw lx ly b">for</code>循环的例子。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="ebfa" class="nh mh it ly b gy ni nj l nk nl">let isFive = true;<br/>let nums = [5,5,5];</span><span id="fa07" class="nh mh it ly b gy nm nj l nk nl">for(let i=0; i &lt; nums.length; i++) {<br/>   if(nums[i] != 5) { isFive = false; }<br/>}</span></pre><p id="c6fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对我来说，<code class="fe lv lw lx ly b">for</code>循环更长，更难阅读。使用<code class="fe lv lw lx ly b">every()</code>——不管实际的回调是什么——让读者知道目标是验证所有元素。</p><p id="363e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://medium.com/better-programming/use-for-of-to-loop-through-your-javascript-arrays-57ebb900ab5a" rel="noopener">for…of</a></code> <a class="ae ky" href="https://medium.com/better-programming/use-for-of-to-loop-through-your-javascript-arrays-57ebb900ab5a" rel="noopener">循环</a>会产生类似的结果。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="841a" class="nh mh it ly b gy ni nj l nk nl">let isFive = true;<br/>let nums = [5,5,5];</span><span id="5224" class="nh mh it ly b gy nm nj l nk nl">for(n of nums) {<br/>   if(n != 5) { isFive = false; }<br/>}</span></pre><p id="20e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，注意这两个例子都需要一个否定，这会使你的代码更加复杂。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="a2c8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">与every()方法有关的问题</h1><p id="7202" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">遗憾的是，<code class="fe lv lw lx ly b">every()</code>并不是对所有场景都完美；这种方法存在一些挑战。</p><p id="679d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法不是通用的。从这张表中我们可以看到，由于W3Schools的帮助，这种方法被广泛接受，但也有一些例外。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/ac464736b609bf515ba3a48e4710f909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*db2lK8qW-NowWk8bZqDhJQ.png"/></div></div></figure><p id="f8df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法还有一些边缘行为，比如当传递一个空数组时返回<code class="fe lv lw lx ly b">true</code>。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="2627" class="nh mh it ly b gy ni nj l nk nl">let nums = [];</span><span id="9ffb" class="nh mh it ly b gy nm nj l nk nl">console.log(nums.every(n =&gt; n == 5)); // true</span></pre><p id="3db3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为回调永远不会被调用，因为没有元素传递给它。如果您希望空数组返回<code class="fe lv lw lx ly b">false</code>，您可以将回调嵌套在<code class="fe lv lw lx ly b">if</code>语句中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="0706" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然我们已经做了一些重构，让我们再试试用三元运算符优化<code class="fe lv lw lx ly b">if</code>语句。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="31a8" class="nh mh it ly b gy ni nj l nk nl">let nums = [];<br/>let result = (nums.length) ? nums.every(n =&gt; n==5) : false;</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b76a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="a483" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">every()</code>方法有效地从语义上验证数组元素。</p><p id="7148" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这对你来说是新的，你计划重构的一些块是什么？如果你是一个经验丰富的用户，你最喜欢的用例是什么？下面分享你的经历，感谢阅读！</p></div></div>    
</body>
</html>