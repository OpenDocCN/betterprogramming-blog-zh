<html>
<head>
<title>Create Beautiful Programmatic Random Drawing Easily With Perlin Noise in Jetpack Compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Jetpack Compose中的Perlin Noise轻松创建漂亮的编程随机绘图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-beautiful-programmatic-random-drawing-easily-with-perlin-noise-40e1eb1439e?source=collection_archive---------12-----------------------#2021-12-08">https://betterprogramming.pub/create-beautiful-programmatic-random-drawing-easily-with-perlin-noise-40e1eb1439e?source=collection_archive---------12-----------------------#2021-12-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc99" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用柏林噪声在40行代码下制作美丽的艺术品</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bf7da617c4b6b92a9c01735dc99dca12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pf2nn7Hqple0HnLV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@vorosbenisop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">本杰明·沃罗斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="8be5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随机数对很多事情都有用。然而，有时它们太随意了。我们想画一些光滑的东西，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/ac7479db5048f21675be2cba9cb922b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*1Tn4JOG6Zc9-xZ8s673OYw.gif"/></div></figure><p id="43c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我将尝试解释什么是Perlin噪声，并探索生成上述wavey动画的代码。</p><h1 id="62c3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">什么是柏林噪声？</h1><p id="1a45" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">随机值的参数为最小值和最大值。如果我们把它画出来，在0和高度之间，每个X像素1，它会看起来像下面，到处都是。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3f9b" class="my lx it mu b gy mz na l nb nc">for (x in 0 <em class="nd">until </em>width) {<br/>    val drawHeight = height - (0..height)<br/>    drawPoints(<br/>        <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>        PointMode.Points,<br/>        <em class="nd">Color</em>.WHITE,<br/>        2f<br/>    )<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/d21ed3299d061e1a9a387a578d45851a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZn-85anRt06pDkSUZxPSg.png"/></div></div></figure><p id="37e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Perlin_noise" rel="noopener ugc nofollow" target="_blank">柏林噪声</a>是一个具有1、2或3个参数的函数，取决于我们想要多少个维度。为了简化，我们从一维开始。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1e8c" class="my lx it mu b gy mz na l nb nc">for (x in 0 <em class="nd">until </em>width) {<br/>    val drawHeight = height - <strong class="mu iu"><em class="nd">noise1D</em>(x * 0.002)</strong> * height<br/>    drawPoints(<br/>        <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>        PointMode.Points,<br/>        <em class="nd">Color</em>.White,<br/>        2f<br/>    )<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/202d2e9baa14599002d9710399bebddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L310052aNXn9DySpVin5Uw.png"/></div></div></figure><p id="9862" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过random的值受它之前和之后的值的影响。我称之为平滑随机性。</p><h1 id="118e" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">2D·柏林噪声</h1><p id="69ca" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">那是针对单一维度的。让我们试试2D噪声参数。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2888" class="my lx it mu b gy mz na l nb nc">val 2Dcount = 2<br/>for (y in 0 <em class="nd">until </em>2Dcount) {<br/>    for (x in 0 <em class="nd">until </em>width) {<br/>        val drawHeight = <br/>            height - <strong class="mu iu"><em class="nd">noise2D</em>(x * 0.002, y * 0.02)</strong> * height<br/>        drawPoints(<br/>            <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>            PointMode.Points,<br/>            <em class="nd">Color</em>.White,<br/>            2f<br/>        )<br/>    }<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3b59544f8a80897d5c3a36f2e8a0fcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L1hhYe93nfjzk7N7XSFWhQ.png"/></div></div></figure><p id="c804" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会注意到，当我们稍微改变一下第二维度，我们会得到稍微不同的波。</p><p id="23fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将<code class="fe nf ng nh mu b">2Dcount</code>改为5，我们将生成5行，它们的变化彼此略有不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3e08036e95b0ee2b33fdae775e84f964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zCqPonlANjzOt8xl-rzanQ.png"/></div></div></figure><p id="9dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将<code class="fe nf ng nh mu b">2Dcount</code>改为更多行，我们会注意到每一行都以相对随机的方式彼此不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3e4f8fe694807516ff507c026f0c97a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrOu0KFjwsHQIM1kn8Kx-Q.png"/></div></div></figure><h1 id="cf09" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">3D柏林噪声</h1><p id="2b35" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果我们不使用2D，而是将值放在3D中会怎么样？</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="056b" class="my lx it mu b gy mz na l nb nc">val 3Dcount = 2<br/>for (z in 0 <em class="nd">until </em>3Dcount) {<br/>    for (x in 0 <em class="nd">until </em>width) {<br/>        val drawHeight = <br/>            height - <strong class="mu iu"><em class="nd">noise3D</em>(x * 0.002, 0.0, z * 0.02)</strong> * height<br/>        drawPoints(<br/>            <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>            PointMode.Points,<br/>            <em class="nd">Color</em>.White,<br/>            2f<br/>        )<br/>    }<br/>}</span></pre><p id="89cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅用2条线，我们将看到模式也逐渐变化，但随机性略有不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/a1f87728a02dc78d6d6e71ce8cdea9eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ydXmZ6Sn9mpF1QF8OvHCQ.png"/></div></div></figure><p id="0b84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将<code class="fe nf ng nh mu b">3Dcount</code>改为5，我们将生成5行，它们的变化彼此略有不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/c1ef8c9efcaf917cdd55a7944f9206b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfDWm2GNAWiF-ajOG8bqCw.png"/></div></div></figure><p id="99ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将<code class="fe nf ng nh mu b">3Dcount</code>改为5，我们将生成更多的线条，这些线条的变化彼此略有不同，但是当我们改变2D时，这些线条会有很大的不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/8be6d1e9180f8660d21c00cf7fc90e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDbDQbERyyfxUUustmaZ-A.png"/></div></div></figure><p id="a5ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许不用画每一条线，我们可以考虑通过它们制作动画，其中3D噪声值随着鼠标X坐标的移动而改变。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="1eb5" class="my lx it mu b gy mz na l nb nc">for (x in 0 <em class="nd">until </em>width) {<br/>    val drawHeight = <br/>        height - <strong class="mu iu"><em class="nd">noise3D</em>(x * 0.002, 0.0, mouse.x * 0.02)</strong> * height<br/>    drawPoints(<br/>        <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>        PointMode.Points,<br/>        <em class="nd">Color</em>.White,<br/>        2f<br/>    )<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/da3a2aec6b8d7924c21ab0dbf6f265fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*muQCfHkiPhzotzBmD8O9Gg.gif"/></div></figure><p id="d5d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看上面动画的流畅度。一切都是随机逐渐变化的。</p><p id="a357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们结合2D噪声的许多行，并且3D值随着我们移动鼠标的X坐标而改变，我们将得到如下效果。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f055" class="my lx it mu b gy mz na l nb nc">val 2Dcount = 2<br/>for (y in 0 <em class="nd">until </em>2Dcount) {<br/>    for (x in 0 <em class="nd">until </em>width) {<br/>        val drawHeight = <br/>            height - <strong class="mu iu"><em class="nd">noise2D</em>(<br/>                x * 0.002, y * 0.02, mouse.x * 0.02<br/>            )</strong> * height<br/>        drawPoints(<br/>            <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>            PointMode.Points,<br/>            <em class="nd">Color</em>.White,<br/>            2f<br/>        )<br/>    }<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/1a66fbb42a4ffb4b10c17eafad5dc695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*rjqXWph6bBYHYgDkhCbMkw.gif"/></div></figure><p id="52fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们也用噪声来产生颜色。生成颜色的一种方法如下</p><blockquote class="ni nj nk"><p id="1b7c" class="kz la nd lb b lc ld ju le lf lg jx lh nl lj lk ll nm ln lo lp nn lr ls lt lu im bi translated">我还添加了对基于mouse.y的行数的控制</p></blockquote><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8729" class="my lx it mu b gy mz na l nb nc">val 2Dcount = 250<br/>for (y in 0 <em class="nd">until </em>mouse.y) {<br/>    for (x in 0 <em class="nd">until </em>width) {<br/>        val drawHeight = <br/>            height - <strong class="mu iu"><em class="nd">noise2D</em>(<br/>                x * 0.002, y * 0.02, mouse.x * 0.02<br/>            )</strong> * height</span><span id="e8bf" class="my lx it mu b gy no na l nb nc"> <strong class="mu iu">       val red = (<em class="nd">noise1D</em>(noiseInputX) * 0xFF).toInt()<br/>        val green = (<em class="nd">noise2D</em>(0.0, noiseInputY) * 0xFF).toInt()<br/>        val blue = (<em class="nd">noise3D</em>(0.0, 0.0, noiseInputZ) * 0xFF).toInt()</strong></span><span id="2271" class="my lx it mu b gy no na l nb nc">        drawPoints(<br/>            <em class="nd">listOf</em>(<em class="nd">Offset</em>(x, drawHeight)),<br/>            PointMode.Points,<br/>            <em class="nd">Color</em>(<strong class="mu iu">red, green, blue</strong>),<br/>            2f<br/>        )<br/>    }<br/>}</span></pre><p id="93fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/d4c75076436e0ed709789d97c13a621b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*uiv3SvUlK0XIBGf7L2AuKw.gif"/></div></figure></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="ec41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要编译并运行它，你可以在<a class="ae ky" href="https://medium.com/mobile-app-development-publication/jetpack-compose-animation-under-50-lines-using-k5-compose-playground-bef35060c471" rel="noopener"> Compose K5游乐场</a>中运行下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div></div>    
</body>
</html>