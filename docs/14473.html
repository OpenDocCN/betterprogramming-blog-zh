<html>
<head>
<title>Track Locations Through VPN Using One Line of JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用一行JavaScript通过VPN跟踪位置</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-i-tracked-your-location-through-vpn-with-one-line-of-javascript-14c115a3ab39?source=collection_archive---------2-----------------------#2022-12-21">https://betterprogramming.pub/how-i-tracked-your-location-through-vpn-with-one-line-of-javascript-14c115a3ab39?source=collection_archive---------2-----------------------#2022-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3c41" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用国际化API</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f37e9db826a613d8f89b30a72e93b8fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TE82TBUw-6KMItKN"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">杰佛森·桑多斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e5ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">浏览器是用户和他们的服务之间的主要连接点。因此，为保护它们付出巨大努力就不足为奇了。</p><p id="bb4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一段时间以前，浏览器因为为开发者提供了更多的功能来创造更新更好的网络体验而备受推崇。自从科技巨头被曝光收集用户信息并跟踪每一个行动，甚至通过不同的网站，这种情绪已经发生了变化。</p><p id="0c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种认识引发了浏览器API开发人员和跟踪脚本开发人员之间的军备竞赛。从那时起，你的浏览器有越多的功能和选项，你就有越多的选项来更精细地跟踪每个用户。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="9111" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">追踪用户的最简单方法之一是将数据存储在cookies或本地存储中。你需要做的就是放一个足够大的随机值，用户就被唯一跟踪了。</p><p id="25c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这也带来了一些挑战。例如，这些数据可能会超时，并在浏览器重新启动或私人选项卡关闭后被删除。此外，在西方国家，用户必须明确允许通过这种方式被跟踪，因此这可能会使这些企图变得相当明显。</p><p id="f506" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一种追踪方法是这些方法都做不到的，那就是追踪用户的实际位置。现在很多人使用VPN都有很好的理由，他们可以给你一点额外的隐私。一个问题是，它可能会弄乱一些关于你的网站使用的统计数据，并使你的浏览器会话更难安全。</p><p id="6f0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您正在登录您的银行网站。登录后，您的银行会存储您的IP地址，甚至可能会尝试估计您的位置。突然，另一个连接与您的会话令牌一起出现，但这一次它来自世界的另一端。这有两个看似合理的原因:</p><ul class=""><li id="164c" class="lz ma iq ky b kz la lc ld lf mb lj mc ln md lr me mf mg mh bi translated">你的帐户刚刚被泄露了</li><li id="47b8" class="lz ma iq ky b kz mi lc mj lf mk lj ml ln mm lr me mf mg mh bi translated">您刚刚启用了从其他地方出现的VPN</li></ul><p id="e0b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的银行应该怎么做？禁止该会话并要求用户再次登录。从长远来看，这可能会让VPN给人们带来更多不便。允许连接吗？每年有成千上万的人受到这种方案的影响，这种额外的安全措施可以为他们节省大量的时间、精力和金钱。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="4252" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">拥有用户位置的真实统计数据是一场隐私噩梦，但有时这可能会有很大帮助。这就是为什么我开始挖掘浏览器API，并试图创建一个庞大的表格，列出它们可能向开发人员公开的所有内容。</p><p id="6490" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的第一个想法是:键盘布局。不是所有的键盘布局在确定位置上都非常有用。几乎所有的开发者都在全球范围内使用美国布局，但它给出了一个参考点。如果有人使用德语键盘布局登录，两秒钟后突然加载了另一个页面，而他们使用的是匈牙利语布局，这确实很可疑。</p><p id="a03e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">令我最惊讶的是，我发现了更好的东西。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="9a5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个现代浏览器中都嵌入了一个名为Intl的API。这是一个国际化API，它提供了显示为每个用户的语言习惯定制的数据的函数。例如，它有一个名为<code class="fe mn mo mp mq b">NumberFormat</code>的类，该类根据当地习俗格式化要显示的数字类型JavaScript对象。</p><pre class="kg kh ki kj gt mr mq ms bn mt mu bi"><span id="2805" class="mv mw iq mq b be mx my l mz na">Intl.NumberFormat().format(3.6) // '3.6' or '3,6'</span></pre><p id="4748" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个指标的“分辨率”不够高，不足以确定关于用户的更多信息，所以在进一步挖掘之后，我发现了一些更有趣的东西。</p><p id="97ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">时区。</strong></p><p id="127f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，在现代系统中，他们不再需要人们输入你与CET或UTC相差多少小时。相反，他们会问你你国家的首都或者附近的主要城市。浏览器可以查询这些数据，并将其传递给我们的JavaScript代码，代码只有一行:</p><pre class="kg kh ki kj gt mr mq ms bn mt mu bi"><span id="110a" class="mv mw iq mq b be mx my l mz na">const tz = Intl.DateTimeFormat().resolvedOptions().timeZone</span></pre><p id="6ab0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的例子中，它返回<code class="fe mn mo mp mq b">Europe/Budapest</code>。这并不精确，但是你可以看到，通过这一条信息，我们知道我们的用户位于欧洲匈牙利布达佩斯附近的某个地方。如果他们暴露给我们的IP地址来自美国德克萨斯州的一家小型电信公司，这可能会引发一些危险信号。</p><p id="b8c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们如何利用这些知识？</p><p id="080f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在GitHub上准备了一个简短的演示，供大家试用:</p><div class="nb nc gp gr nd ne"><a href="https://github.com/dubniczky/VPN-Detect" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">GitHub - dubniczky/VPN-Detect:使用JavaScript在浏览器中检测WPN</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">VPN检测在浏览器中使用JavaScript创建一个帐户并将API密钥复制到detect.js…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kp ne"/></div></div></a></div><p id="5930" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以按照指示打开页面，然后玩一玩，看看它如何试图预测你的真实位置，以及你当时是否在使用VPN。改变你的位置，打开和关闭你的VPN，看看真正的效果。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="d54b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决问题的最佳方案通常都很简单。事实上，这个非常简单。</p><p id="7736" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你已经学到了一些东西。黑客快乐！</p></div></div>    
</body>
</html>