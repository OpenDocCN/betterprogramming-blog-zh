# 向 SwiftUI 绘画应用程序添加更多控件

> 原文：<https://betterprogramming.pub/adding-more-controls-to-your-swiftui-painting-app-8edaede63e7e>

## 继续我们构建 iOS 画图应用的旅程

![](img/1da9883cbd1182a2e7a8ce10dab14120.png)

[Tamanna Rumee](https://unsplash.com/@tamanna_rumee?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 在 [Unsplash](https://unsplash.com/s/photos/shapes?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

我相信你已经阅读了这个简短系列的第一和第二部分，我希望在其中开发一个简单的绘画应用程序。如果你还没有，那么你应该停下来先读一读:

1.  [用 SwiftUI 在 iOS 15 中搭建绘画 App](/build-a-painting-app-in-ios-15-with-swiftui-bb757a925f6a)
2.  [向 SwiftUI 绘画应用添加形状和颜色](/adding-shapes-and-colors-to-your-swiftui-painting-app-751dbb6fdce3)

bon——感谢回来——和我一起继续在 iOS 15 下开发绘画应用程序。这是我在哪里的最新消息。

# 案情摘要

我想对 angle/sides 方法的工作方式做一个微妙的改变，以及管理对象的删除和它们的`z`层的变化的其他方法，更高或更低，在顶部，在后面。我还计划尝试对代码进行一点重组，从`ContentView`中删除应该在它自己的文件中的代码。

# 编码

先说移动方法`deselect`和`searchin`，前者出现两次。我将它们都移动到一个名为`Shapes.swift`的文件中，并将它们从`ContentView.swift`中移除。

接下来，我第一次尝试编写将形状移动到不同级别所需的方法，报告我有多少个形状，并删除我将与其视图一起添加的形状和控件，以便我可以将它们添加到界面中。

这里没有火箭科学，虽然我会回到这个代码，因为我们可以做得更好。接下来，我做了一组方法来管理不同的层次，这样我就可以将形状上下移动。

再次使用`deselect`和`searchin`方法，并做了一些小的改动:

在这一点上，我跳回到`ContentView`并添加访问这些方法所需的视图以及一些细微的变化。我从改变`Angle`和`Sides`的方法开始。在第二个版本中，除了在度数/边上加 1 之外，这没什么……但在我看来，更有意义的是使用一个简单的公式来确保圆被干净地分割，保持多边形的所有边长度相等，并进一步限制一个形状中不能有超过 60 个角，因为在那一点上它看起来像一个圆。我用一个类似的公式来改变这个形状的角度，这个角度在我的脑海中也是有意义的，相对于边的数量。我还添加了双击来重置。

接下来是删除对象方法的视图。这里有一个微妙的错误，我将在最后提到。

最后是设置界面的视图，这样您就可以在不同级别之间移动对象。

所有这些都让我们看到了展示新界面的动画 GIF。我先画一条形状线，然后用新算法旋转它。然后我给它们上色，并展示如何在图中所示的层次结构中上下移动它们。最后，我删除了一些形状。

![](img/d9e414d6fdaacc368fc8745e56e1ea58.png)

现在，将这些视图添加到界面的代码很琐碎，我不会在这里包括它，我也不想包括`ContentView.swift`以保持本文的合理长度，因为除了添加控制视图之外，我没有对其进行任何更改。你肯定会注意到我给这个项目添加了一种字体，让它看起来更有吸引力。好了，在我结束今天的工作之前，你是否发现了三个不受欢迎的特性(或者有人会说是 bug)。

*   第一个错误是在选择中。它从你放在画布上的第一个对象开始寻找坐标。这是一种错误的方式，因为它无法找到你放在其他物体上面的物体。
*   第二个 bug 与形状的选择有关，正如你在 GIF 中看到的，虽然你可以选择多个形状，但是你的操作只影响其中一个。
*   第三个错误是删除对象——它在不创建新对象的情况下删除对象，有效地减少了您可以创建的对象的数量——您从 128 个模板开始，如果您删除一个形状，您可以使用的模板就更少了。

我怀疑最后一个错误还有其他含义，如果你创建了超过 128 个对象而没有删除任何东西，应用程序将会崩溃。需要在下一篇文章中研究。敬请关注。