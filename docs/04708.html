<html>
<head>
<title>How Push Notifications Work in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推送通知在iOS中如何工作</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/intro-to-push-notification-in-swift-b2c5e21a07cf?source=collection_archive---------5-----------------------#2020-05-01">https://betterprogramming.pub/intro-to-push-notification-in-swift-b2c5e21a07cf?source=collection_archive---------5-----------------------#2020-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="000f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将推送通知添加到您的应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/578d168031578fc5c731f4351d83297f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WcDgNHyaRvkPq3MyocAFWg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jamie452?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae kv" href="https://unsplash.com/s/photos/notification?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4136" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">概观</h1><p id="89ba" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">在本文中，我将带你了解如何创建推送通知，并将其集成到你的应用中。我们将主要讨论:</p><ul class=""><li id="8143" class="mr ms iq lx b ly mt mb mu me mv mi mw mm mx mq my mz na nb bi translated">推送通知的重要性</li><li id="6353" class="mr ms iq lx b ly nc mb nd me ne mi nf mm ng mq my mz na nb bi translated">推送通知的组件</li><li id="4906" class="mr ms iq lx b ly nc mb nd me ne mi nf mm ng mq my mz na nb bi translated">推送通知的类型</li><li id="3a3e" class="mr ms iq lx b ly nc mb nd me ne mi nf mm ng mq my mz na nb bi translated">处理通知点击</li></ul></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="0d31" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">推送通知的重要性</h1><p id="6db5" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">推送通知就是让你的用户在有事情发生时在你的应用中采取行动。想想像Instagram或Medium这样的应用程序，每当有人喜欢你的照片或对你最近的文章发表评论时，你都会收到通知。但最重要的是，这就是为什么作为软件/产品工程师，您应该关心它:</p><h2 id="822b" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">参与+保留</h2><p id="1d7d" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">你希望你的应用对你的用户来说是互动的和有趣的。为了让你保持这种兴趣，你可以整理一个好内容的列表，并通过推送通知发送出去(不要发垃圾邮件！)让用户再次使用你的应用。你不希望他们只用一次就离开。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f36d" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">推送通知的组件</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/23777608459f01e778e98065316ae79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*p2a5A23d0sbztOva1L2YUw.png"/></div></figure><p id="a03d" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me nu mg mh mi nv mk ml mm nw mo mp mq ij bi translated">现在，我们来看看Swift中构成推送通知的不同组件。</p><h2 id="2235" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">用户通知框架</h2><p id="cdff" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">其核心是<code class="fe nx ny nz oa b"><a class="ae kv" href="https://developer.apple.com/documentation/usernotifications" rel="noopener ugc nofollow" target="_blank">UserNotifications</a></code>框架，它直接与操作系统级别的时钟和设置一起工作，以协调设备内不同应用程序的所有推送通知。</p><h2 id="d0d8" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">内容</h2><p id="c818" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">如上图所示，我们需要让系统知道实际上向用户显示什么。这是指通知的标题、副标题、正文和声音。这是由<code class="fe nx ny nz oa b">UNMutableNotificationContent()</code>类配置的。让我们仔细看看如何创建这个对象:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="6f33" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">触发器</h2><p id="197d" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">有时，我们可能需要我们的应用程序在特定的日期或时间发送推送通知。让我们以谷歌日历应用为例。您会在活动开始前15分钟或活动的特定时间收到推送通知。在这种情况下，OS时钟系统需要知道何时以及如何发送您的推送通知。你可以通过创建一个<code class="fe nx ny nz oa b">UNCalendarNotificationTrigger</code>对象来实现。让我们看下面的例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="8bc7" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">请求</h2><p id="f6c5" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">从<code class="fe nx ny nz oa b">UNNotificationRequest()</code>类构建，它接受内容和触发器对象。需要记住的一点是，触发器来自<code class="fe nx ny nz oa b">UNCalendarNotificationTrigger class</code>、<em class="od">、</em>是可选的。这是因为有时您可能希望发送基于操作的通知，而不是基于时间的通知。让我们快速看一下代码片段:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="f5c7" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">行动</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/91e9334c1fc610f086267d2bd517086b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*1mDUGaquuvSOLNoln6rmIQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">当用户按住通知时，他们能够看到他们可以立即执行的操作。</p></figure><p id="b740" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me nu mg mh mi nv mk ml mm nw mo mp mq ij bi translated">有时，您可能希望发送通知，要求用户采取行动，如购买、验证代码或导入文档。这是一个很好的方法，可以最大限度地减少用户在正常启动应用程序并继续操作时通常必须采取的步骤。这由两个类处理:<code class="fe nx ny nz oa b">UNNotificationAction</code>和<code class="fe nx ny nz oa b">UNNotificationCategory</code>。让我们来看看:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c80c" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">推送通知的类型</h1><h2 id="c5ef" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">基于行动的</h2><p id="a6ff" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">这是指当用户在应用程序中执行关键操作时必须发出的通知。让我们看看如何创建一个方法，当有人称赞你的媒体文章时，发送推送通知。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="ab26" class="nh le iq bd lf ni nj dn lj nk nl dp ln me nm nn lp mi no np lr mm nq nr lt ns bi translated">基于时间的</h2><p id="0d22" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">我们要看的下一种推送通知是调度。想象一个闹钟，当你醒来时它会发出声音并显示一个横幅，或者你每天早上8点从Medium收到的每日通知。如果你正在开发一个需要在特定时间进行某种提醒或操作的应用程序，那么预定通知是一个不错的选择。</p><p id="cf5c" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me nu mg mh mi nv mk ml mm nw mo mp mq ij bi translated">让我们看一下如何配置计划推送，以及它与常规推送有何不同。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="04f7" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">处理通知点击</h1><p id="3c94" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">最后，让我们看看如何设置我们的应用程序，当用户点击给定的推送通知时，我们可以定制逻辑。请记住，如果您没有正确处理您的通知，应用程序将只是在用户点击它时启动。</p><p id="7edc" class="pw-post-body-paragraph lv lw iq lx b ly mt jr ma mb mu ju md me nu mg mh mi nv mk ml mm nw mo mp mq ij bi translated">为了做到这一点，您应该在<code class="fe nx ny nz oa b">AppDelegate</code> <strong class="lx ir"> </strong>(必须符合<code class="fe nx ny nz oa b">UNUserNotificationCenterDelegate</code> ) <strong class="lx ir"> <em class="od"> </em> </strong>中添加两种<code class="fe nx ny nz oa b"><a class="ae kv" href="https://developer.apple.com/documentation/usernotifications" rel="noopener ugc nofollow" target="_blank">UserNotifications</a></code>方法:</p><ul class=""><li id="ddb2" class="mr ms iq lx b ly mt mb mu me mv mi mw mm mx mq my mz na nb bi translated"><code class="fe nx ny nz oa b"><a class="ae kv" href="https://developer.apple.com/documentation/usernotifications/unusernotificationcenterdelegate/1649518-usernotificationcenter" rel="noopener ugc nofollow" target="_blank">willPresent</a></code>:当应用程序在前台时，当通知到达时调用这个函数。</li><li id="64cd" class="mr ms iq lx b ly nc mb nd me ne mi nf mm ng mq my mz na nb bi translated"><code class="fe nx ny nz oa b">didReceiveNotificationResponse</code>:当用户点击通知时调用。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="b1a7" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">结论</h1><p id="81d4" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">我希望这篇文章对你有所帮助。有几件事我们没有涉及，比如<a class="ae kv" href="https://developer.apple.com/documentation/usernotificationsui/customizing_the_appearance_of_notifications" rel="noopener ugc nofollow" target="_blank">远程</a>和<a class="ae kv" href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server" rel="noopener ugc nofollow" target="_blank">丰富</a>通知。让我知道你是否有兴趣阅读它们。</p></div></div>    
</body>
</html>