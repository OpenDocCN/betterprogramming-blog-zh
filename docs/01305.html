<html>
<head>
<title>Serving a Node.js Express App From a Subfolder — a Routing Lifehack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从子文件夹为Node.js Express应用程序提供服务——路由生活黑客</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/serving-a-node-js-express-app-from-a-subfolder-a-routing-lifehack-a3c88da9840c?source=collection_archive---------3-----------------------#2019-08-30">https://betterprogramming.pub/serving-a-node-js-express-app-from-a-subfolder-a-routing-lifehack-a3c88da9840c?source=collection_archive---------3-----------------------#2019-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="56c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在快速应用程序中组织路线的简单方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d96a1f084ff74301d88520a7106d4379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_CUgL1RjRMp13O3elwzdQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.pexels.com/photo/beige-and-red-train-1181202/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae ky" href="https://www.pexels.com/@paul-ijsendoorn-148531?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Paul ijsendorn</a>摄影</p></figure><p id="4028" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Express可能是Node.js最流行的web框架，已经有大量关于它的教程和说明。然而，它们中的大多数并没有涵盖我将要告诉你的主题。</p><p id="e2ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">各种文档中常见的标准路由方法如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="a3bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="a1ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，您的路由结构可能看起来有点像下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/9e87b791ff8948b6c74a54ae14332a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/0*klU7cUEwffIFYMH9"/></div></figure><p id="b34c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这在您的本地开发环境中非常适用。然而，在现实世界中可能会有一个小问题。托管平台上应用程序的实际目录可能不是域根。</p><p id="4f4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，假设您部署了一个包含到<code class="fe ly lz ma mb b">yourdomain.com/hello</code>的路由的应用程序。现在，如果你在浏览器中打开<code class="fe ly lz ma mb b">yourdomain.com/hello</code>，你可能希望它显示“Hello World”。但是，你得到一个404错误。</p><p id="2078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了收到预期的问候，您应该将路线写成这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="bd0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">路由器的子路径也是如此。接受来自<code class="fe ly lz ma mb b">yourdomain.com/hello/foo</code>的“来自foo的问候”的正确方式是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="5e50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然在小应用程序中重写路径并不难，但在有大量路线(尤其是结构不良的路线)的大型应用程序中尝试这样做可能会成为一场噩梦。另外，以后想换个目录怎么办？在这种情况下，重新开始重写一切是一个坏主意。</p><p id="b8c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的选择是只制作一个<em class="mc">条目</em>点用于路由，并使这个<em class="mc">条目</em>路径可配置。</p><p id="e53a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，创建一个config.js来存储项目级变量:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="dc9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您应该重组路由结构，以便<em class="mc">条目</em>或<em class="mc">索引</em>路由器包括所有其他路由。它自己的路径将从<code class="fe ly lz ma mb b">config.js</code>开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="aff5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，我们所做的是将之前的结构转换成这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi md"><img src="../Images/a87cc27e87b66bdbba9b1ee31bbc9928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gtsN5jdjLcvCq3dY"/></div></div></figure><p id="c2d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样。现在，如果您将应用程序部署到一个子文件夹中—例如，<code class="fe ly lz ma mb b">yourdomain.com/hello</code> —将config.js更改为:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="25a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，所有路由都会自动更新。如果应用程序直接部署到<code class="fe ly lz ma mb b">yourdomain.com</code>根，就让<code class="fe ly lz ma mb b">baseUrl: '/'</code>保持原样。</p><p id="a362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这篇lifehack能帮助你更好的在Express app中整理路线。</p></div></div>    
</body>
</html>