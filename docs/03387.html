<html>
<head>
<title>The Problem With Mutable Types As Default Values in Functions in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中可变类型作为函数默认值的问题</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-problem-with-mutable-types-as-default-values-in-functions-in-python-81ca88ff4d91?source=collection_archive---------13-----------------------#2020-02-06">https://betterprogramming.pub/the-problem-with-mutable-types-as-default-values-in-functions-in-python-81ca88ff4d91?source=collection_archive---------13-----------------------#2020-02-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c058" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用简单的例子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6946fb8165a7b77c099753e2f59609c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nfbfdoOBCPJG4s5e"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">伊利亚·巴甫洛夫在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="e739" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据不同的需求，我们经常需要函数有默认值。用默认值定义一个函数很容易——只需在定义中赋值，并确保默认参数出现在最后。</p><p id="01af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这一块，我将编写一个非常简单的函数，只将两个数相加。</p><p id="7a69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以通过打开Python shell来跟进。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/e643dc1737deb451e982e9aa1f24591c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AcL4fLuHNNJJi7ZG6IE_uw.png"/></div></div></figure><p id="7b72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以通过提供参数值来调用该函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/7a52bf9a2ef9c1a20a8693bde9075f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O9uhYj3aai7BxsjC54NcNg.png"/></div></div></figure><p id="0c57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到该功能工作正常。现在，我们将只为参数<code class="fe lw lx ly lz b">a</code>提供值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/7e44ef8f91e51f25fa1eab23d847c5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXzaNwDCoaLd7y-e1YUOmg.png"/></div></div></figure><p id="04ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数仍在工作，它使用默认值<code class="fe lw lx ly lz b">3</code>作为参数<code class="fe lw lx ly lz b">b</code>。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="f691" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">可变和不可变对象</h1><p id="3aad" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">对于那些不知道的人，我将尝试用非常简单的术语解释可变和不可变对象的概念。</p><p id="ec1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可变对象是那些在创建后可以改变的对象。在Python中，字典是可变对象的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/aea5a6be950120459e4fe43b12b61546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uh3NRYowcYhLvzId667nQg.png"/></div></div></figure><p id="821f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，我们创建了一个列表，并更改了索引<code class="fe lw lx ly lz b">2</code>处的项目。它运行起来没有任何问题，因为列表在Python中是可变的。</p><p id="ea15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不可变对象是那些在创建后不能改变的对象。在Python中，元组是不可变类型的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/ec1adb909ace45a15b9527c5e13efb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vwjuXXmUWCq8WZaM8LQbQ.png"/></div></div></figure><p id="ad0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码片段中，我们创建了一个字符串，并试图改变索引<code class="fe lw lx ly lz b">1</code>处的项目。我们得到了一个错误，因为字符串是不可变的。</p><p id="ccdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然我们已经理解了如何用默认值和可变对象的概念来编写函数，我们将尝试理解不可变类型作为默认值的问题。</p><p id="b266" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个演示，我将编写一个简单的函数，它接受两个参数，将第一个参数附加到第二个参数上，并打印第二个参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/239dc3e004fbc7743a264241d00d68fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GRJweerxrxkLxkahvGmzdQ.png"/></div></div></figure><p id="ad30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将测试这个函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/cdf10be06be0c269b8c8aebbed9d7877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6RpxoeWq9mWzoQVA9Ev8FQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/96822b4e862656553c78b273188a05ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CIg4c_KanD91RL4To22T4A.png"/></div></div></figure><p id="ff99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的代码片段中我们可以看到，当我们为参数<code class="fe lw lx ly lz b">b</code>提供值时，该函数工作正常。当我们不为参数<code class="fe lw lx ly lz b">b</code>提供值时，我们开始发现问题，因为在后面的函数调用中，默认值不再是空列表。</p><p id="1c5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题在于，每个默认值都是在定义函数时计算的——通常是在加载模块时——默认值变成了函数对象的属性。因此，如果一个默认值是一个可变的对象，而你改变了它，这个改变将会影响函数的每一次调用。</p><p id="cd59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过检查函数的<code class="fe lw lx ly lz b">__defaults__</code>属性来查看默认值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/7c1204aa2800b67ef055f19a0d280700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRbJUVh6ksLbCyvmKUjMZw.png"/></div></div></figure><p id="0a27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，如何才能避免这个问题呢？</p><p id="423f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对此有一个非常简单的解决方法。每当需要使用可变类型作为参数的默认值时，就使用<code class="fe lw lx ly lz b">None</code>作为默认值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/f25726cf4743ea6391b86e84d56b4e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bhrsieNLJUy6gp8-Uhtprg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/b4ea8cb9002db760752d6f023df2b924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CManpPEr4enUllstdUxfFg.png"/></div></div></figure><p id="3dd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以看到我们的功能工作正常。</p><p id="8f9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章能提高你对函数的理解。</p></div></div>    
</body>
</html>