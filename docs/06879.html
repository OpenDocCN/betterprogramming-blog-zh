<html>
<head>
<title>Testing Your React Apps With Enzyme</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用酵素测试你的React应用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/testing-react-apps-with-enzyme-d3fad145b331?source=collection_archive---------17-----------------------#2020-11-12">https://betterprogramming.pub/testing-react-apps-with-enzyme-d3fad145b331?source=collection_archive---------17-----------------------#2020-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fd12" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Enzyme让测试React应用程序变得更加容易</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/44d79b6ece7cb77b9520e17309a386dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a_QrjUDTIYb7FBJt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Amy Lister 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="a9ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试前端应用程序可能是一件痛苦且耗时的事情。在本文中，让我们讨论一下Enzyme，以及如何使用它来使UI测试变得更加容易。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="65ba" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">酶是什么？</h1><p id="2a5f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><a class="ae ky" href="https://enzymejs.github.io/enzyme/" rel="noopener ugc nofollow" target="_blank"> Enzyme </a>是React的JavaScript测试工具。它通过断言、操作和遍历每个组件的输出，使测试React组件变得容易。目前，它是开源的，由Airbnb维护。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/bf0a8a0e90082ce290a602ee5c0a2409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qr4B-s1ZT0XEo1Ya"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://enzymejs.github.io/enzyme/" rel="noopener ugc nofollow" target="_blank">酵素</a>。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d84c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为什么是酵素？</h1><p id="6709" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在测试方面，你可能听说过摩卡和柴。这个JavaScript测试框架和断言库经常被用于编写单元和功能测试。</p><p id="5eec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是测试React组件呢？酶是解决方案，原因如下:</p><ul class=""><li id="553a" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">直观灵活的API</li><li id="5295" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">兼容主要和常见的测试跑步者</li><li id="7b92" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">支持浅层呈现、DOM呈现和静态呈现标记</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/6c7d97ab0978378d85c9ab8dec83ba99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NaDIb9oYJLLDsYYC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="fac5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">酶实施</h1><p id="3528" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在让我们学习如何使用带有Jest的酶来编写测试，Jest是React中的一个测试运行程序。</p><h2 id="3131" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">第一步:安装酵素</h2><p id="7213" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">首先，我们安装软件包:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="bc54" class="np md it oc b gy og oh l oi oj">npm install enzyme enzyme-adapter-react-16</span></pre><h2 id="2dfd" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">第二步:setupTests.js</h2><p id="0765" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当你创建一个新的React应用时，应该有一个默认初始化的<code class="fe ok ol om oc b">setupTests.js</code>文件。</p><p id="b14f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该文件中添加以下代码以导入酶:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="0933" class="np md it oc b gy og oh l oi oj">import { configure } from "enzyme";<br/>import Adapter from "enzyme-adapter-react-16";</span><span id="2abb" class="np md it oc b gy on oh l oi oj">configure({ adapter: new Adapter() });</span></pre><h2 id="0c2e" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">第三步:App.test.js</h2><p id="8e24" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这个例子中，让我们测试一下我们的<code class="fe ok ol om oc b">App.js</code>文件。Jest，我们的测试运行器，将自动运行测试文件，如果文件是:</p><ol class=""><li id="4368" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu oo ng nh ni bi translated">任何。js文件放在一个名为<code class="fe ok ol om oc b">tests</code>的文件夹中。</li><li id="36fd" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu oo ng nh ni bi translated">任何。文件名类似<code class="fe ok ol om oc b">[name].spec.js</code>的js文件。</li><li id="a496" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu oo ng nh ni bi translated">任何。文件名类似<code class="fe ok ol om oc b">[name].test.js</code>的js文件。</li></ol><p id="4cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们用一个<code class="fe ok ol om oc b">App.test.js</code>文件来测试我们的<code class="fe ok ol om oc b">App.js</code>。在该文件中，我们将编写一些简单测试，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="f57d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的第一个测试中，我们使用浅层渲染来隔离一个单独的组件，比如<code class="fe ok ol om oc b">&lt;App/&gt;</code>，并确保它能够渲染。</p><p id="1714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的下一个测试是快照测试，以测试UI是否正确呈现。根据<a class="ae ky" href="https://jestjs.io/docs/en/snapshot-testing" rel="noopener ugc nofollow" target="_blank"> Jest的文档</a>:</p><blockquote class="or"><p id="335d" class="os ot it bd ou ov ow ox oy oz pa lu dk translated"><em class="pb">“一个典型的快照测试用例呈现一个UI组件，获取一个快照，然后将它与存储在测试旁边的一个参考快照文件进行比较。”</em></p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f7f6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">运行测试</h1><p id="2e2b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">让我们用以下代码运行这两个简单的示例测试:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="e8c6" class="np md it oc b gy og oh l oi oj">npm test</span></pre><p id="6f68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果所有测试都通过，终端应显示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/7e62aba6f966efafbf84ddf4d8936920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/0*wW0snBDUQUN9ZP5n"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="72fa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">自动化您的测试</h1><p id="b5c1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">所以现在我们知道如何用Enzyme编写简单的UI测试。更多详情，请访问他们的<a class="ae ky" href="https://enzymejs.github.io/enzyme/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="868b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持测试自动化总是好的，而不是每次都手动运行<code class="fe ok ol om oc b">npm test</code>。Buddy CI/CD 是我用来轻松自动化测试的工具，它对React应用程序很有效。</p><h2 id="45ec" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">步骤1:添加管道</h2><p id="2bbd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要开始，只需在<a class="ae ky" href="https://buddy.works/?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=content_victoria_lo&amp;utm_content=react_enzyme" rel="noopener ugc nofollow" target="_blank"> buddy.works </a>上创建一个帐户，并通过选择您使用的Git提供者来添加您的项目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/5a2d707355a007e5615b58c1f6f93499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/0*TirMkTM-BImmwpgg"/></div></figure><p id="e604" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，添加一个管道，我们可以在React应用程序中自动化我们的测试。确保‘Trigger Mode’被设置为On Push，并且分支是<code class="fe ok ol om oc b">master</code>,这样我们的测试将在每次我们对项目进行更改时自动运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/3b0cdb7a3b8c2efe41cbd7ec2a67668f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lbNEQnTXmfdouwHG"/></div></div></figure><h2 id="618b" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">步骤2:添加节点操作</h2><p id="5527" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">因为我们使用命令<code class="fe ok ol om oc b">npm test</code>来运行我们的测试，我们可以添加一个节点动作到我们的管道中。</p><p id="ea4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的操作中，我们运行命令来安装我们的包并运行我们的测试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/280da58c4c87bb3a29fb994769dd1d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*94hH7jkxIVfXbiy_"/></div></div></figure><h2 id="4924" class="np md it bd me nq nr dn mi ns nt dp mm li nu nv mo lm nw nx mq lq ny nz ms oa bi translated">步骤3:添加通知</h2><p id="49b0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，我们可以发送一个电子邮件通知，以便我们知道测试何时结束。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/9b772113627186b585f3db1d83dcb132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3vjug4-PS45Z4m-a"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c783" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">跑管道！</h1><p id="4de6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果我们运行我们的管道，我们的测试将是自动化的，并且每次我们推进到我们的<code class="fe ok ol om oc b">master</code>分支时都会运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/b6d678daa231723ce68a7744efb6d6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y9TYSADrf7-Ly22T"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e982" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="04c6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Enzyme使得测试React应用程序的组件和UI变得简单。对于编写测试来说，自动化测试有助于尽早发现错误并节省开发时间。</p><p id="c74a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关如何为React应用和Buddy创建交付渠道的更多资源，请查看以下内容:</p><ul class=""><li id="4c40" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><a class="ae ky" href="https://youtu.be/mmexLa-o6E8" rel="noopener ugc nofollow" target="_blank">好友部署React应用网络研讨会</a></li><li id="4eb2" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><a class="ae ky" href="https://buddy.works/guides/reactjs-zero-downtime-deployment?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=content_victoria_lo&amp;utm_content=react_enzyme" rel="noopener ugc nofollow" target="_blank">构建和部署React应用，无需停机</a></li></ul><p id="44df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！干杯！</p></div></div>    
</body>
</html>