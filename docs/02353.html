<html>
<head>
<title>Angular Material: Build Your Own Generic MatTable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角材料:建立自己的通用MatTable</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/angular-material-build-your-own-generic-mattable-a49ba68a375a?source=collection_archive---------9-----------------------#2019-11-25">https://betterprogramming.pub/angular-material-build-your-own-generic-mattable-a49ba68a375a?source=collection_archive---------9-----------------------#2019-11-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="403a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用装饰者的力量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62c2bf7fe423980e33204cae7a57945e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pNg9FOSsyj-sU1BI5HEE1A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Ethan Sexton 在<a class="ae ky" href="https://unsplash.com/s/photos/car-museum?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="0636" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我将简单地向您展示如何创建一个带有角度材质的通用表格。</p><p id="7ccc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，理解Typescript中的装饰器概念以及<code class="fe lv lw lx ly b">MatTable</code>如何工作是很重要的。</p><p id="ba6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最初，这个概念是我的同事兼朋友弗朗西斯科想出来的，我只是修改了他的想法，让它更容易扩展，有更多的选项。</p><p id="f782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，您将有一个模型来管理如何在表中显示数据，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><p id="f65c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时我们的应用程序包含几个我们必须管理的表，我们拥有的表越多，维护就越繁重。然而，时间是开发人员生活中的一个重要因素。</p><p id="d0f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不是创建一个库来维护，而是一步一步地解释如何创建自己的通用表，并用一些例子来扩展它。就像这样，你可以根据自己的需要扩展任何东西。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="a6c3" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">步骤0:安装必要的node_modules</h1><p id="e9b5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated"><strong class="lb iu">必填</strong>:</p><ul class=""><li id="f81a" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><code class="fe lv lw lx ly b">@angular/material</code> (ng添加@角度/材料)</li><li id="c0fa" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe lv lw lx ly b">reflect-metadata</code> <strong class="lb iu"> </strong>(访问元数据属性)</li></ul><p id="386b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">可选:</strong></p><ul class=""><li id="042d" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><code class="fe lv lw lx ly b">lodash </code>(一组便捷功能)</li><li id="a7b4" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe lv lw lx ly b">cerializr </code>(在JS prop类中映射JSON属性的强大工具)</li></ul></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="cfa8" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">步骤1:准备您的表组件</h1><p id="ee46" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">让我们从创建汽车模型开始:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="c040" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了模拟数据，我选择了<a class="ae ky" href="https://mockaroo.com/" rel="noopener ugc nofollow" target="_blank"> Mockaroo </a>，创建了JSON文件，将它放在我的assets文件夹中，然后在我的app.component.ts中，我键入了以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="dcc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们准备创建我们的表组件。使用CLI生成组件，然后您的代码应该如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="242a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，在<code class="fe lv lw lx ly b">app.component.html</code>中调用您的表组件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="b505" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">步骤2:装饰栏</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="505e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">cerialize</code> <em class="nv"> </em>使用<code class="fe lv lw lx ly b">autoserializeAs</code>将JSON文件的属性自动绑定到JS对象实例。你只需要提供类型。参见<a class="ae ky" href="https://github.com/weichx/cerialize/tree/mw/v2" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="f274" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是一个装饰器，它允许我们选择想要在表格中显示的对象的属性。稍后，我们将看到我们将能够添加允许我们管理属性行为的选项。</p><p id="fb37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在创建我们的装饰器之前，有两个类会很有趣:</p><ul class=""><li id="1019" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">一个管理我们所有栏目的(<code class="fe lv lw lx ly b">TableModel</code>)</li><li id="e3d4" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">一个管理特定列的所有选项(<code class="fe lv lw lx ly b">ColumnModel</code>)</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="1941" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们有了构建室内装饰器的一切。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="2d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里发生了什么？首先，我们创建一个名为<code class="fe lv lw lx ly b">table</code>的符号(这只是为了调试——你可以随意调用它)。该符号将出现在对象的每个实例中，并允许我们通过引用访问该对象的<code class="fe lv lw lx ly b">TableModel</code>实例。</p><p id="19e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们检查<code class="fe lv lw lx ly b">TableModel</code>的实例是否存在——否则，我们创建它。</p><p id="173d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们用从装饰器获得的选项构建我们的<code class="fe lv lw lx ly b">ColumnModel</code>实例。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="faaa" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">步骤3:检索通用表中的列</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="84ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在<code class="fe lv lw lx ly b">AppComponent</code>中看到的，我创建了我的汽车对象的一个新实例。通过这样做，我触发了装饰器，所以我创建了我的<code class="fe lv lw lx ly b">TableModel</code>，它包含了要在我的表中显示的所有列的信息。</p><p id="24b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的<code class="fe lv lw lx ly b">TableComponent</code>中，我可以从数据列表中检索一个实例，并通过符号，得到<code class="fe lv lw lx ly b">TableModel</code>的实例。剩下的工作就是创建我们的列，然后您将拥有一个基于模型的通用表。</p><p id="e8d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也要注意适应HTML。<code class="fe lv lw lx ly b">column</code>现在是对象，不是字符串。<code class="fe lv lw lx ly b">column.key</code>是可以使用的正确属性，因为它表示我们的装饰器中的<code class="fe lv lw lx ly b">propertyKey</code>(或者您提供的自定义属性)。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="238e" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">更进一步</h1><h2 id="1637" class="nw ml it bd mm nx ny dn mq nz oa dp mu li ob oc mw lm od oe my lq of og na oh bi translated">示例1:管理我们的列的顺序</h2><p id="b803" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">目前，列是按照模型中定义的属性顺序显示的。在某些情况下，改变这个顺序会很有趣。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="33cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们已经明确声明所有列的顺序都是0——除了模型，它的顺序是1。因此，该列应该在最后一个位置。剩下的工作就是创建一个小方法来对我们的<code class="fe lv lw lx ly b">TableComponent</code>中的列进行排序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="8b7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样。</p><h2 id="e4ec" class="nw ml it bd mm nx ny dn mq nz oa dp mu li ob oc mw lm od oe my lq of og na oh bi translated">示例2:获取属性的类型</h2><p id="3255" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">如果您想知道将在表中使用的属性类型，这个示例可能会很有趣。如果我们检测到一个日期，把它转换成一种格式会很有趣。或者，如果它是一个数字，默认情况下将它向右对齐会更好——这由您决定！</p><p id="fae3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保在您的<code class="fe lv lw lx ly b">tsconfig.json</code>中启用这两个选项:</p><p id="96f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">experimentalDecorators</code>:真</p><p id="6594" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">emitDecoratorMetadata</code>:真</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h2 id="4e26" class="nw ml it bd mm nx ny dn mq nz oa dp mu li ob oc mw lm od oe my lq of og na oh bi translated">示例3:选择要排序的列</h2><p id="9856" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">默认情况下，我们没有为表启用排序。没问题，我们只需要调整一下桌子。</p><p id="0a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们添加这个新选项:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="5a01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道可以对哪一列进行排序。最后，我们改编我们的<code class="fe lv lw lx ly b">TableComponent</code> (TS <em class="nv">和</em> HTML):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="f1d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查<code class="fe lv lw lx ly b">TableComponent</code> TS文件。在<code class="fe lv lw lx ly b">data</code>的设置器中，我们保持数据的原始顺序。这对我们的新方法<code class="fe lv lw lx ly b">sortData</code>很有用。</p><p id="3847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要忘记修改HTML。我们可以创建一个简单的<code class="fe lv lw lx ly b">ngIfElse</code>来为该列添加排序特性。</p></div><div class="ab cl md me hx mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="im in io ip iq"><h1 id="c0f8" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">结论</h1><p id="41b5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">现在，您已经具备了用角形材料创建自己的通用表格所需的一切。只要有创意，您将构建一个强大的表，以便在每个项目中重用。</p><blockquote class="oi oj ok"><p id="ad52" class="kz la nv lb b lc ld ju le lf lg jx lh ol lj lk ll om ln lo lp on lr ls lt lu im bi translated">“我选择一个懒惰的人去做艰苦的工作。因为一个懒惰的人会找到一个简单的方法去做。”—比尔·盖茨</p></blockquote><p id="34f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是该项目的StackBlitz，如果你想玩的话:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo mc l"/></div></figure></div></div>    
</body>
</html>