# 编程时，记住大象不会咬人，蚊子会

> 原文：<https://betterprogramming.pub/when-programming-remember-that-elephants-dont-bite-mosquitoes-do-5eacde4bf451>

## 你犯的小错误才是最大的缺点

![](img/7c5f76064a3a0a42e17ca4e316b20a68.png)

在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上 [Nam Anh](https://unsplash.com/@bepnamanh?utm_source=medium&utm_medium=referral) 拍摄的照片。

1996 年 6 月 24 日，欧洲航天局的无人驾驶阿丽亚娜 5 号火箭在发射后仅 37 秒就爆炸了。3 . 7 亿美元和十年的发展在一瞬间付之东流。

原因？一个简单的软件错误，试图将一个可以表示数十亿个潜在值的 64 位浮点变量存储到一个只能表示 65，535 个潜在值的 16 位整数中。几乎没有足够的空间分配给它进入太空。

教训？正是最小的错误导致了最大、最昂贵和最具潜在危险的问题。

# 大象不会咬人，它们只是想成为你的朋友

当程序失败时，几乎每个明显的错误都会在代码中暴露出来。这些错误会导致明显的编译器或运行时错误，这些错误会通过用户界面或在编译时暴露它们的身份。

这些错误几乎不会引起我们的关注，因为对于开发人员来说，这些是需要立即解决的问题。

最有可能的情况是，当一个错误可见时，我们试图立即修复它，并且永远不会发现自己将一个毫无疑问未完成的产品或代码交付到产品中，而这个产品或代码不符合预期的目标。

大象不咬人，是因为我们很容易驯服它们，用直观的方式训练它们。从长远来看，它们不会造成任何问题，也不会造成任何损害，除非你允许它们这样做。他们让自己很容易被认出来，基本上是说，“嘿，朋友。看着我！给我你的关注，我会向你表达爱意。你不会后悔的。”

# 蚊子会蜂拥而至，给你带来莱姆病，然后杀死你

在光谱的另一端，我们有蚊子——代码中看似无关紧要的部分，它们并不明显，可能将自己伪装成隐藏在看似有效的代码中的隐藏人物。他们已经准备好猛扑过去，把你的代码压缩成一堆乱七八糟的东西。

这些可能是逻辑错误，不可扩展和不庞大的设计，不干净和混乱的代码，以及有缺陷的，非最佳的算法。

阿丽亚娜 5 号火箭发射中存在的问题是，他们从以前成功的阿丽亚娜 4 号火箭发射中复制了工作代码——他们显然认为这些代码可以翻译，但显然无法满足阿丽亚娜 5 号火箭所需环境的需求和更新要求。

这些类型的错误很小，但会以最大的方式暴露出来。

*   逻辑错误会导致你的产品在处理和显示信息的方式上出现问题，剥夺了你想要的功能，降低了你良好的用户体验。仅仅这一点就可能导致你失去观众的参与，即使你作为一个开发人员，并没有看到应用程序运行方式的任何令人担忧的或立即可察觉的问题。
*   不可扩展和不庞大的设计会导致诸如阿丽亚娜 5 爆炸的问题。他们有一段代码可以在计算强度较低的环境下工作，但不能在计算强度较高的环境下工作。忽略这些事情会导致系统故障，因为系统不是为处理大规模操作而设计的。这类问题通常会在精心编写的测试代码中发现，这些代码旨在对系统施加尽可能多的压力，但是如果您不编写处理这些情况的测试类，您可能会有一只黑天鹅等着自己出现，并以恶意的方式让您大吃一惊。
*   不干净和混乱的代码会让任何人都很难识别代码中的错误或问题。最重要的是，随着时间的推移，它会大大增加开发成本，因为代码变得越来越难以扩展和修改。反过来，这导致事物更容易破碎，错误更容易出现。只要看一眼杂乱的代码，你就会立刻发现危险信号，这会促使你开始重构。
*   当涉及到计算密集型操作时，非优化算法会再次导致糟糕的性能。很容易忽略这个细节——尤其是如果你还不习惯于重构代码以在算法上表现得更好。当您遇到长加载时间、超时或限制时(尤其是当您使用云后端时)，您通常会注意到这个细节。有些东西可能单独工作得很好，但是您需要在编程时知道，单独工作得很好的东西不一定与大型数据集和其他组件一起工作得很好。

让这些蚊子叮咬被忽视足够长的时间，你会在一个大的，不愉快的惊喜。好消息是，有许多方法可以减轻和最小化这些错误的影响。

# 去拿驱虫剂！

好吧，也许我这个比喻有点过了，但我想你明白了。让小事情不被注意，最终，你将面临最大的问题。

在某种程度上，我同情 Ariane 5 事件的程序员，但这些事情让你意识到非常仔细地编写代码的重要性，并有大量的压力测试和测试驱动的开发来支持。

编程不仅仅是编写编译和执行的代码。它需要仔细和深思熟虑的考虑——而不是困扰许多新的和经验丰富的程序员的醉酒水手方法，他们只是将代码片段拼凑在一起，就好像他们试图将圆柱体装进方孔一样。很合适，但就是不合适，无论如何也撑不住。

因此，这就是为什么在编写代码时最好考虑这些问题:

1.  我的代码是否过于复杂？我该如何简化这一点？
2.  我是否为我的代码编写了严格的测试类，对多种不同的数据饱和和计算密集型场景进行了强有力的断言和测试？我知道我的代码的所有限制吗？
3.  我的函数很小吗？我能把大函数中的方法抽象成更小的函数吗？
4.  我的变量、类和函数有非常清晰具体的名字吗？有人能看看我的代码，通过阅读名字就知道它到底在做什么吗？
5.  我是否复制了太多的方法，这些方法可以被重用，并且在多个不同的过程中具有通用的功能？我的重复方法是绝对必要的吗？它们值得不同的功能场景吗？
6.  我如何处理错误？我是否抛出了错误，使用了`try-catch`块，并对变量运行了`null`检查？当发现错误时，是否有指定的流程来确保顺利运行？
7.  我的代码容易扩展和伸缩吗？如果正在进行修改，我需要担心任何依赖性吗？
8.  我的代码是否为了处理大量数据而进行了扩展和优化？如果压力过大，我的代码会出现错误或超时吗？

当然，你还可以问自己更多的问题，这些问题可以汇编成一份详尽的清单。然而，我认为上述问题可能是最重要的，但却是最普遍缺乏的。

通过做一些事情来减少代码中任何错误的风险，这些事情限制了未知错误的可能性，并使薛定谔的猫的状态是已知的，而不是“直到观察到才知道”

# 离别之思

你坚持不懈地做的那些小事会产生最大的成果。你做的大事很少受到关注。

所以不要担心会犯大错。从长远来看，那些大错误并不是你应该关心的，因为你犯的大错误很容易被修复、解决和战略性地解决。

您每天输出的小错误和不一致才是真正值得关注的原因。总是找到减少这些错误的方法，并确保您可以在复杂多变的场景下得出代码库的最终结果。