<html>
<head>
<title>Storing Properly Wrapped Properties</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">存储正确包装的属性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/default-stored-properties-1c27e5edc586?source=collection_archive---------17-----------------------#2022-06-08">https://betterprogramming.pub/default-stored-properties-1c27e5edc586?source=collection_archive---------17-----------------------#2022-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c06b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Swift中的另一个用户默认属性包装</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0836704b2fd77848ee13a569bee85680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-zw8y9nikP95jhlIbgKFw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由Arturo Esparza 在<a class="ae kv" href="https://unsplash.com/s/photos/wrapper?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的基础照片</p></figure><p id="47dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您从事Swift和iOS开发，您很可能会遇到<strong class="ky ir"> UserDefaults </strong>，这是一种在键值存储上持久存储用户属性的简单方法。</p><blockquote class="ls lt lu"><p id="7186" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">更多关于UserDefaults的Apple文档:<a class="ae kv" href="https://developer.apple.com/documentation/foundation/userdefaults" rel="noopener ugc nofollow" target="_blank">https://developer . Apple . com/documentation/foundation/user defaults</a></p></blockquote><p id="d062" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！但是…为了使用它，您需要引用正确的Defaults实例，引用存储键，以便访问值…如果键还没有存储值，结果将是<code class="fe lz ma mb mc b">nil</code>，而不是某个预定义的默认值。</p><p id="ee44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，有没有一种方法可以在一个通用属性上使用UserDefaults，它存储最后一个值，下次我试图访问它时，它会给我带来支持自定义默认值的存储值？？？</p><p id="9415" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的开发伙伴，这就是我们使用<strong class="ky ir">属性包装器</strong>的地方。</p><h2 id="b33d" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">属性包装器？</h2><p id="095a" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">是的。属性包装。</p><p id="4e9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们是一个很好的Swift功能，允许我们添加属性修饰符。基本上，我们想要做的是创建一个包装器，它将封装所有的<code class="fe lz ma mb mc b">UserDefaults</code>逻辑，并给我们存储的值。</p><h1 id="9b54" class="nb me iq bd mf nc nd ne mi nf ng nh ml jw ni jx mo jz nj ka mr kc nk kd mu nl bi translated">准备地形</h1><p id="e786" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">由于<code class="fe lz ma mb mc b">UserDefaults</code>是一个键值存储单元，我们将需要一些东西作为我们的存储键，所以让我们稍后制定一个协议来帮助我们:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="47de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们有一个很好的协议和一个扩展，使得使用带有<code class="fe lz ma mb mc b">String</code>原始类型的枚举作为存储键变得更加容易。</p><p id="46c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了使使用我们的存储键访问UserDefault更加容易，让我们使用默认值和我们的StorageKey协议创建一些助手方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="dd90" class="nb me iq bd mf nc nd ne mi nf ng nh ml jw ni jx mo jz nj ka mr kc nk kd mu nl bi translated">构建包装器</h1><p id="6028" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">我们希望在包装器上支持一些东西:</p><ul class=""><li id="e845" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">属性<code class="fe lz ma mb mc b">Get</code>:获取存储值；</li><li id="29e3" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">属性<code class="fe lz ma mb mc b">Set</code>:更新存储值；</li><li id="a120" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">当键没有存储值时，支持默认值；</li><li id="592e" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">支持存储不同类型；</li></ul><p id="83b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，让我们开始编写我们的包装器，它需要2个依赖项，一个代表存储值类型的<code class="fe lz ma mb mc b">Value</code>，和我们的<code class="fe lz ma mb mc b">StorageKey</code>。通过它们，我们可以实现<code class="fe lz ma mb mc b">wrappedValue</code>属性来访问UserDefaults。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1ec0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，每次我们访问包装的属性时，我们实际上是在UserDefaults上获取值，如果它不存在，我们将返回默认值。</p><p id="8cd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们设置属性值时，它也会将它存储在用户默认值中。</p><h2 id="a8c0" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">使用它</h2><p id="8256" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">不错！我们做了一个新的属性包装器…但是我们如何使用它呢？</p><p id="e04e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们只需要将它包装在我们想要的任何属性周围，现在，每次我们访问它时，我们将间接地访问用户默认值上的存储值。</p><p id="271c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以创建一个存储类来集中所有的<code class="fe lz ma mb mc b">Stored</code>属性:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="7a77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以在需要的地方直接添加:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="442a" class="nb me iq bd mf nc nd ne mi nf ng nh ml jw ni jx mo jz nj ka mr kc nk kd mu nl bi translated">接下来呢？</h1><p id="5d44" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">属性包装器是封装行为和简化许多需要重复的地方的非常好的方法。</p><p id="33ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我实际使用过的代码的一部分，但我的想法更多的是展示如何在自己的项目中使用包装器来实现巧妙的解决方案。</p><p id="b662" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天到此为止！</p><p id="f32c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读，并继续包装您的财产！</p></div></div>    
</body>
</html>