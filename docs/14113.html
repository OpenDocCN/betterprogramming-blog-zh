<html>
<head>
<title>Exploring New Features in npm 9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索npm 9中的新功能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-new-features-in-npm-9-bea4631a96d6?source=collection_archive---------3-----------------------#2022-11-08">https://betterprogramming.pub/exploring-new-features-in-npm-9-bea4631a96d6?source=collection_archive---------3-----------------------#2022-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fe13" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">配置、计时、日志级别、登录、添加用户、查询、打包、访问和安装的更改，以及删除</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/596f397700a3c13626203c0c6a42602d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_AS8HV4ELhKV3vwe"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="e13a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="cc01" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">npm是node.js JavaScript平台的包管理器。它将模块放在适当的位置(<code class="fe mn mo mp mq b">node_modules</code>)，以便节点可以找到它们。它还智能地管理依赖冲突。</p><p id="bc51" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">npm是可配置的，以支持发布、发现、安装和开发节点程序的各种用例。它有一个强大的命令列表。</p><p id="21ae" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><a class="ae ky" href="https://newreleases.io/project/npm/npm/release/9.0.0" rel="noopener ugc nofollow" target="_blank"> npm 9 </a>发布于2022年10月19日。这个主要版本的目标是标准化适当的缺省值，并尽可能清理遗留配置。</p><p id="85f7" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">以下是安装npm 9的命令:</p><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="6598" class="na la it mq b gy nb nc l nd ne">% npm install -g npm@9</span></pre><p id="c8e6" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">安装后，npm的版本为9.0.1。</p><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="5109" class="na la it mq b gy nb nc l nd ne">% npm --version<br/>9.0.1</span></pre><p id="f9a7" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这是帮助手册:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="6aab" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">可以对任何支持的节点版本进行npm 9升级，<code class="fe mn mo mp mq b">^14.17.0 || ^16.13.0 || &gt;=18.0.0</code>。</p><p id="e173" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-nvm-to-manage-node-js-19-and-npm-9-bc5656d52d5f">nvm</a></code> <a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/how-to-use-nvm-to-manage-node-js-19-and-npm-9-bc5656d52d5f">是管理节点和npm版本的简单方法</a>。我们在<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/6-major-features-of-node-js-19-b98e28b9670c"> node.js 19 </a>工作环境中探索npm 9的特性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="af81" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这些是npm 9中的新功能:</p><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="b278" class="na la it mq b gy nb nc l nd ne"><a class="ae ky" href="#28fb" rel="noopener ugc nofollow">Changes </a><a class="ae ky" href="#28fb" rel="noopener ugc nofollow">in config</a></span><span id="7dfb" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#0358" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#0358" rel="noopener ugc nofollow">timing and loglevel</a></span><span id="c3ed" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#48ee" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#48ee" rel="noopener ugc nofollow">npm login and npm addUser</a></span><span id="e476" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#a5f5" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#a5f5" rel="noopener ugc nofollow">npm</a><a class="ae ky" href="#a5f5" rel="noopener ugc nofollow"> query</a></span><span id="0f01" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#3909" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#3909" rel="noopener ugc nofollow">npm</a><a class="ae ky" href="#3909" rel="noopener ugc nofollow"> pack</a></span><span id="7bbe" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#b612" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#b612" rel="noopener ugc nofollow">npm access</a></span><span id="7c50" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#51a9" rel="noopener ugc nofollow">Changes in </a><a class="ae ky" href="#51a9" rel="noopener ugc nofollow">npm</a><a class="ae ky" href="#51a9" rel="noopener ugc nofollow"> install</a></span><span id="9f30" class="na la it mq b gy nh nc l nd ne"><a class="ae ky" href="#0f52" rel="noopener ugc nofollow">Removals of</a><a class="ae ky" href="#0f52" rel="noopener ugc nofollow"> npm birthday</a><a class="ae ky" href="#0f52" rel="noopener ugc nofollow">,</a><a class="ae ky" href="#0f52" rel="noopener ugc nofollow"> npm set-script</a><a class="ae ky" href="#0f52" rel="noopener ugc nofollow">,</a><a class="ae ky" href="#0f52" rel="noopener ugc nofollow"> and npm bin</a></span></pre><h1 id="28fb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">npm配置中的更改</h1><p id="b53c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm config</code>管理npm配置文件。它支持以下用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="254a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm config fix</code>是一个验证配置和修复问题的新命令。</p><p id="cb0d" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是源代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2597" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我们在使用npm 9时遇到一个错误:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="68b3" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">执行<code class="fe mn mo mp mq b">npm config fix</code>解决了问题:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7c28" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">对于<code class="fe mn mo mp mq b">build</code>错误，npm在stdout上输出一些JSON错误。以前，npm会在stderr上输出所有JSON格式的错误，这使得很难解析，因为stderr流通常已经写入了日志。npm 9改进了它。</p><p id="c185" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">此外，<code class="fe mn mo mp mq b">npm config set</code>不再接受弃用或无效的配置选项。npm 9 config去掉了<code class="fe mn mo mp mq b">node-version</code>和<code class="fe mn mo mp mq b">npm-version</code>，<a class="ae ky" href="#51a9" rel="noopener ugc nofollow">让</a> <code class="fe mn mo mp mq b"><a class="ae ky" href="#51a9" rel="noopener ugc nofollow">install-links</a></code> <a class="ae ky" href="#51a9" rel="noopener ugc nofollow">默认为真</a>。</p><h1 id="0358" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">时间和日志级别的变化</h1><p id="bb83" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">所有npm命令都可以有一个选项标志，<code class="fe mn mo mp mq b">—-timing</code>。设置该标志后，npm会将计时数据与调试日志数据一起写入文件。日志位置由<code class="fe mn mo mp mq b">logs-dir</code>选项设置，并返回到<code class="fe mn mo mp mq b">&lt;CACHE&gt;/_logs/</code>。</p><p id="41ea" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是如何执行<code class="fe mn mo mp mq b">npm —-timing</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8410" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">每次运行定时命令后，在<code class="fe mn mo mp mq b">&lt;CACHE&gt;/_logs/</code>中会生成一个新的定时文件，如<code class="fe mn mo mp mq b">2022–11–01T02_31_07_194Z-timing.json</code>。</p><p id="6ccd" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">计时文件命名为<code class="fe mn mo mp mq b">&lt;ID&gt;-timing.json</code>，其中<code class="fe mn mo mp mq b">&lt;ID&gt;</code>为时间戳。这种命名方法类似于调试日志。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4842" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是<code class="fe mn mo mp mq b">2022–11–01T02_31_07_194Z-timing.json</code>中的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/exploring-json-json5-and-circular-references-2b5b0c5de532"> JSON </a>数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="1963" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">JSON数据有三个顶级键，<code class="fe mn mo mp mq b">metadata</code>(第4行)、<code class="fe mn mo mp mq b">timers</code>(第14行)和<code class="fe mn mo mp mq b">unfinishedTimers</code>(第40行)。</p><p id="6df7" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">从npm 9开始，<code class="fe mn mo mp mq b">timing</code>已经作为<code class="fe mn mo mp mq b">--loglevel</code>的值被删除。除了在<code class="fe mn mo mp mq b">--silent</code>时，<code class="fe mn mo mp mq b">--timing</code>将显示定时信息，与<code class="fe mn mo mp mq b">--loglevel</code>无关。</p><p id="19e1" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是带有<code class="fe mn mo mp mq b">--loglevel info</code>的<code class="fe mn mo mp mq b">timing</code>命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><ul class=""><li id="2fdd" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated">计时文件列在第59行。</li><li id="ff90" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated">调试文件列在第61行。</li></ul><p id="b653" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是带有<code class="fe mn mo mp mq b">--loglevel silent</code>的<code class="fe mn mo mp mq b">timing</code>命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2b89" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">无论<code class="fe mn mo mp mq b">--loglevel</code>的设置如何，定时文件和日志文件都在<code class="fe mn mo mp mq b">&lt;CACHE&gt;/_logs/</code>中生成。</p><h1 id="48ee" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">npm登录和npm addUser中的更改</h1><p id="9551" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在npm 9之前，有一个命令<code class="fe mn mo mp mq b">npm addUser</code>，它有两个别名<code class="fe mn mo mp mq b">login</code>和<code class="fe mn mo mp mq b">add-user</code>。</p><p id="5e48" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">在npm 9中，<code class="fe mn mo mp mq b">npm login</code>是一个单独的命令，它在指定的注册表中验证用户，并将凭据保存到<code class="fe mn mo mp mq b">.npmrc</code>文件中。如果没有指定注册表，将使用默认注册表。</p><p id="d273" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是如何执行<code class="fe mn mo mp mq b">npm login</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8101" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">按<code class="fe mn mo mp mq b">ENTER</code>，浏览器打开登录窗口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/6afe3b20bbbbaf8138f31115eb1f9876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eaz2LdLrwt6as1P7T8Vqww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e6b5" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">在npm 9中，<code class="fe mn mo mp mq b">npm addUser</code>有一个别名<code class="fe mn mo mp mq b">add-user</code>。它在指定的注册表中创建新用户，并将凭证保存到<code class="fe mn mo mp mq b">.npmrc</code>文件中。如果没有指定注册表，将使用默认注册表。</p><p id="bf1c" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">下面是如何执行<code class="fe mn mo mp mq b">npm addUser</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="489f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">按下<code class="fe mn mo mp mq b">ENTER</code>，浏览器打开登录窗口:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/597401be545899ce401351f7b096c8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MsvYikaFKzDKY0BCpORo0w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f8c3" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">对于<code class="fe mn mo mp mq b">npm login</code>和<code class="fe mn mo mp mq b">npm addUser</code>，仅支持两个<code class="fe mn mo mp mq b">auth-type</code>值:</p><ul class=""><li id="8843" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">web</code>:默认值。</li><li id="0f5d" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">legacy</code>:使用<code class="fe mn mo mp mq b">legacy</code>时，从提示中读入用户名和密码。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e1e3" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这些<code class="fe mn mo mp mq b">auth-type</code>值已在npm 9中删除:<code class="fe mn mo mp mq b">sso</code>、<code class="fe mn mo mp mq b">saml</code>、<code class="fe mn mo mp mq b">oauth</code>和<code class="fe mn mo mp mq b">webauthn</code>。</p><p id="b473" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">web</code>和<code class="fe mn mo mp mq b">legacy</code>只尝试各自的方法，即npm不再全部尝试，等着看哪个不失败。</p><p id="6c29" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">对于<code class="fe mn mo mp mq b">npm login</code>和<code class="fe mn mo mp mq b">npm addUser</code>，浏览器中的登录窗口看起来是一样的。然而，根据<code class="fe mn mo mp mq b">auth-type</code>的不同，它们也有一些不同之处:</p><ul class=""><li id="9505" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">web</code>:对<code class="fe mn mo mp mq b">/-/v1/login</code>的POST请求在其针对<code class="fe mn mo mp mq b">adduser</code>的有效载荷中包含一个<code class="fe mn mo mp mq b">{ create: true }</code>值。</li><li id="28c1" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">legacy</code>:对<code class="fe mn mo mp mq b">/-/user/org.couchdb.user:${username}</code> <br/>的<code class="fe mn mo mp mq b">PUT</code>请求在其针对<code class="fe mn mo mp mq b">adduser</code>的有效载荷中包含一个<code class="fe mn mo mp mq b">email</code>值。</li></ul><h1 id="ef07" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">npm查询中的更改</h1><p id="a5f5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm query</code>检索经过过滤的软件包列表。它使用CSS选择器来执行过滤，尽管没有标签选择器，比如<code class="fe mn mo mp mq b">div</code>、<code class="fe mn mo mp mq b">h1</code>和<code class="fe mn mo mp mq b"> a</code>。查询目标是<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/package-jsons-dependencies-in-depth-a1f0637a3129">依赖对象</a>。</p><p id="3898" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这些是受支持的选择器:</p><ul class=""><li id="55f6" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">*</code>万能选择器</li><li id="18c9" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">#&lt;name&gt;</code>依赖选择器(相当于<code class="fe mn mo mp mq b">[name="..."]</code>)</li><li id="d027" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">#&lt;name&gt;@&lt;version&gt;</code>(相当于<code class="fe mn mo mp mq b">[name=&lt;name&gt;]:semver(&lt;version&gt;)</code>)</li><li id="5d93" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">,</code>选择器列表分隔符</li><li id="119d" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">.</code>依赖类型选择器</li><li id="42c4" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">:</code>伪选择器</li></ul><p id="4813" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我们设置了<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/an-in-depth-guide-for-create-react-app-5-cra-5-b94b03c233f2"> Create React App </a>，其中包含了<code class="fe mn mo mp mq b">package.json</code>。</p><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="732b" class="na la it mq b gy nb nc l nd ne">% npx create-react-app my-app<br/>% cd my-app</span></pre><p id="55b3" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">查询套餐，<code class="fe mn mo mp mq b">react</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2f9a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">查询结果显示了<code class="fe mn mo mp mq b">react</code>包的详细信息。在第68行，<code class="fe mn mo mp mq b">queryContext</code>是<code class="fe mn mo mp mq b">{}</code>，这是npm 9中的一个新属性。</p><p id="d49c" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">queryContext</code>属性可以包括<code class="fe mn mo mp mq b">versions</code>、<code class="fe mn mo mp mq b">outdated.outOfRange, </code>和<code class="fe mn mo mp mq b">outdated.outOfRange</code>。我们来看三个例子。</p><p id="3c76" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">示例1:<code class="fe mn mo mp mq b">queryContext</code>属性包含<code class="fe mn mo mp mq b">versions</code>，这是给定节点的每个可用版本的数组。</p><p id="c3e1" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">:outdated(&lt;type&gt;)</code>是一个伪选择器，用来显示过时的依赖关系。<code class="fe mn mo mp mq b">:outdated &gt; #react</code>显示过期的React包。从下面代码的第69–111行开始，它显示了一长串过时的React包。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="d0b4" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">示例2:<code class="fe mn mo mp mq b">queryContext</code>属性包括<code class="fe mn mo mp mq b">outdated.inRange</code>，一个对象数组，每个对象都有一个<code class="fe mn mo mp mq b">from</code>和<code class="fe mn mo mp mq b">versions</code>。</p><p id="d2d8" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">from</code>是依赖于当前节点的节点在磁盘上的位置，<code class="fe mn mo mp mq b">versions</code>是满足该依赖性的所有可用版本的数组。</p><p id="8528" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">.prod:outdated(in-range)</code>返回与满足范围内至少一个边缘的新版本的生产相关性。</p><p id="8941" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">执行<code class="fe mn mo mp mq b">npm query ".prod:outdated(in-range)"</code>，我们可以看到<code class="fe mn mo mp mq b">queryContext</code>中的<code class="fe mn mo mp mq b">outdated</code>属性，有<code class="fe mn mo mp mq b">from</code>(第4行)和<code class="fe mn mo mp mq b">versions</code>(第5-9行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="d899" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">示例3:<code class="fe mn mo mp mq b">queryContext</code>属性包括<code class="fe mn mo mp mq b">outdated.outOfRange</code>，一个对象数组，每个对象都有一个<code class="fe mn mo mp mq b">from</code>和<code class="fe mn mo mp mq b">versions</code>。</p><p id="5fec" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">from</code>是依赖于当前节点的节点在磁盘上的位置，而<code class="fe mn mo mp mq b">versions</code>是不满足依赖性的每个可用版本的数组。</p><p id="3efc" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">.prod:outdated(out-of-range)</code>返回不满足依赖关系的生产依赖关系。</p><p id="76f0" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">执行<code class="fe mn mo mp mq b">npm query ".prod:outdated(out-of-range)"</code>，我们可以在一个<code class="fe mn mo mp mq b">queryContext</code>中看到<code class="fe mn mo mp mq b">outOfRange</code>属性，有一个<code class="fe mn mo mp mq b">from</code>(第4行)和<code class="fe mn mo mp mq b">versions</code>(第5-10行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h1 id="3909" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">国家预防机制包的变化</h1><p id="50ee" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm pack</code>从包中创建一个tarball。在Create React App工作环境内，执行<code class="fe mn mo mp mq b">npm pack</code>。它在目录中生成tarball，<code class="fe mn mo mp mq b">my-app-0.1.0.tgz</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8936" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">从npm 9开始，<code class="fe mn mo mp mq b">npm pack</code>在应用忽略规则时遵循严格的操作顺序。如果一个<code class="fe mn mo mp mq b">files</code>数组出现在<code class="fe mn mo mp mq b">package.json</code>中，那么来自根的<code class="fe mn mo mp mq b">.gitignore</code>和<code class="fe mn mo mp mq b">.npmignore</code>文件中的规则将被忽略。</p><h1 id="b612" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">国家预防机制准入方面的变化</h1><p id="fcde" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm access</code>设置已发布包的访问级别。以下是npm 8中的命令用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="f1bf" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">对于所有子命令，<code class="fe mn mo mp mq b">npm access</code>将对当前工作目录中的包执行操作，如果没有包名传递给子命令的话。</p><ul class=""><li id="b2ef" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">public</code> / <code class="fe mn mo mp mq b">restricted</code>(已弃用):将软件包设置为可公开访问或受限。</li><li id="830c" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">grant</code> / <code class="fe mn mo mp mq b">revoke</code>(已弃用):添加或删除用户和团队对包的只读或读写访问权限。</li><li id="728c" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">2fa-required</code> / <code class="fe mn mo mp mq b">2fa-not-required</code>(已弃用):配置软件包是否要求发布它的任何人在其帐户上启用双因素身份验证。</li><li id="febc" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">ls-packages</code>(已弃用):显示用户或团队可以访问的所有包，以及访问级别，只读公共包除外。它不会打印整个注册表列表。</li><li id="ef2f" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">ls-collaborators</code>(已弃用):显示软件包的所有访问权限。将只显示您至少拥有读取权限的包的权限。如果传入了<code class="fe mn mo mp mq b">&lt;user&gt;</code>,那么列表只过滤到用户所属的团队。</li><li id="6634" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><code class="fe mn mo mp mq b">edit</code>(未实施)</li></ul><p id="27e5" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm access</code>子命令已被重命名。以下是npm 9中的命令用法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="0605" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">尽管npm 9重命名了子命令，但功能保持不变。</p><h1 id="51a9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">npm安装中的更改</h1><p id="b451" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm install</code>命令安装一个包和它所依赖的任何包。<code class="fe mn mo mp mq b">install-strategy</code>是一个新标志，它有以下类型:</p><ul class=""><li id="25e2" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">hoisted</code>:在顶层安装不重复的，必要时在目录结构内复制。这是默认值。</li></ul><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="1531" class="na la it mq b gy nb nc l nd ne">npm install —-install-strategy=hoisted<!-- --> is the same as <!-- -->npm install<!-- -->.</span></pre><ul class=""><li id="ad35" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">nested</code>:安装到位。禁止吊装。</li></ul><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="7ef9" class="na la it mq b gy nb nc l nd ne">npm install --install-strategy=nested is the same as npm install --legacy-bundling. <!-- -->legacy-bundling<!-- --> has been deprecated in favor of  <!-- -->—-install-strategy=nested<!-- -->.</span></pre><ul class=""><li id="ee23" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><code class="fe mn mo mp mq b">shallow</code>:只在顶层安装直接依赖关系。</li></ul><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="388b" class="na la it mq b gy nb nc l nd ne">npm install --install-strategy=shallow is the same as npm install --global-style. global-style has been deprecated in favor of  --install-strategy=shallow.</span></pre><p id="250a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">许多配置参数对安装有一些影响，<code class="fe mn mo mp mq b">install-links</code>是选项之一。如果设置为true，协议依赖项将作为常规依赖项打包和安装，而不是创建符号链接。在npm 8中，默认值为false，在npm 9中已更改为true。</p><h1 id="0f52" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">删除npm生日、npm设置脚本和npm bin</h1><p id="58cb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b"><a class="ae ky" href="https://github.com/npm/cli/issues/4091" rel="noopener ugc nofollow" target="_blank">npm birthday</a></code>是复活节彩蛋。它要么显示离npmcli的生日还有多少毫秒，要么打印一堆气球表情符号和第一次提交到这个存储库的提交散列。前段时间被拆了，单独成了自己的包。</p><p id="548b" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm set-script</code>在<code class="fe mn mo mp mq b">package.json</code>的<code class="fe mn mo mp mq b">scripts</code>部分创建一个任务。</p><p id="a706" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">npm bin</code>打印npm将安装可执行文件的文件夹。</p><p id="a83a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这些是npm 8中的有效命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="3aed" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">但是，npm 9中删除了这些命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h1 id="be0a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="d636" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">npm 9已经发布。它支持节点版本<code class="fe mn mo mp mq b">^14.17.0 || ^16.13.0 || &gt;=18.0.0</code>。</p><p id="0fb1" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">npm 9改了<code class="fe mn mo mp mq b">config</code><code class="fe mn mo mp mq b">timing</code><code class="fe mn mo mp mq b">loglevel</code><code class="fe mn mo mp mq b">login</code><code class="fe mn mo mp mq b">addUser</code><code class="fe mn mo mp mq b">query</code><code class="fe mn mo mp mq b">pack</code><code class="fe mn mo mp mq b">access</code><code class="fe mn mo mp mq b">install</code>。它还删除了<code class="fe mn mo mp mq b">npm birthday</code>、<code class="fe mn mo mp mq b">npm set-script</code>和<code class="fe mn mo mp mq b">npm bin</code>。</p><p id="2cc0" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">如果您想了解以前版本的特性，请阅读以下文章:</p><ul class=""><li id="f73a" class="ni nj it lt b lu mr lx ms ma nk me nl mi nm mm nn no np nq bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/what-might-be-coming-in-npm-9-6985cf2678a6">快速浏览npm 8特性和对npm 9的预测—近距离观察es模块(ESM) </a></li><li id="add2" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated"><a class="ae ky" href="https://medium.com/better-programming/the-step-by-step-guide-to-understanding-and-adopting-npm-7-914504f7090f" rel="noopener">了解和采用npm 7的分步指南</a></li></ul><p id="50cb" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">感谢阅读。</p><pre class="kj kk kl km gt mw mq mx my aw mz bi"><span id="78fd" class="na la it mq b gy nb nc l nd ne"><strong class="mq iu">Want to Connect?</strong></span><span id="fe77" class="na la it mq b gy nh nc l nd ne">If you are interested, check out <a class="ae ky" href="https://jenniferfubook.medium.com/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">my directory of web development articles</a>.</span></pre></div></div>    
</body>
</html>