<html>
<head>
<title>How to Read and Understand API Documentations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何阅读和理解API文档</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-read-and-understand-api-documentations-2f894b51d0b7?source=collection_archive---------5-----------------------#2022-02-03">https://betterprogramming.pub/how-to-read-and-understand-api-documentations-2f894b51d0b7?source=collection_archive---------5-----------------------#2022-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e96b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Stripe API示例解释</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/12cbf372ae591cbbb9c8f0a89066a66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*ESnYM6nRY3ii8_w9QdulTA.jpeg"/></div></figure><p id="b2a5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果有人告诉你“检查API文档”,你照做了，但是不确定你在看什么，这是给你的。</p><p id="f051" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">API无处不在。它们将不同的应用程序连接在一起，是大多数集成的主干。换句话说，API是一种通用语言，用于不同系统之间的通信。</p><blockquote class="lm"><p id="f646" class="ln lo it bd lp lq lr ls lt lu lv ll dk translated">[API]文档越好，采用率就越高，对技术支持的问题就越少。</p></blockquote><p id="e54f" class="pw-post-body-paragraph kq kr it ks b kt lw ju kv kw lx jx ky kz ly lb lc ld lz lf lg lh ma lj lk ll im bi translated">不用担心，不需要有技术背景也能继续。主要思想是有一个请求和响应的交换。但是我们怎么可能知道该问什么和期待什么结果呢？答案在于理解API文档。</p><h1 id="f3c3" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">并非所有的API文档都是平等的</h1><p id="8e40" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">并非所有的API文档都是一样的。有些很优秀，有些则不怎么样(他们存在吗？).那么是什么让API文档比写得差的好呢？</p><p id="a501" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><em class="my">可读性。</em></p><p id="edd6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">最佳API文档是一个自助参考，它简明地解释了什么是可能的，什么是不可能的，以及如何开始。它也是一个让用户带着语法或功能问题返回的地方。那么，为什么这很重要呢？文档越好，采用率越高，对技术支持的问题就越少。</p><p id="ad25" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">虽然API文档可能因站点而异，但它们都遵循相同的结构，包括:</p><ul class=""><li id="0cda" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">证明</li><li id="3f2a" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">目标</li><li id="d7c3" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">请求</li><li id="263b" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">反应</li></ul><p id="8ff9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在接下来的部分中，我们将检查每个要点，并以Stripe API doc为例进行总结。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="cb40" class="mb mc it bd md me nu mg mh mi nv mk ml jz nw ka mn kc nx kd mp kf ny kg mr ms bi translated">种类</h1><p id="52ac" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">对于那些可能不熟悉Stripe的人来说，他们是互联网企业最大的在线支付处理软件之一，他们拥有最好的API文档之一。</p><p id="e809" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是他们API文档的链接【https://stripe.com/docs/api T2】</p><p id="a5fa" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><em class="my">免责声明——我与Stripe没有任何关系。我选择Stripe API文档的原因是它的可读性是一流的。它采用了时尚的双面板设计，左边是用简单英语写的解释，右边是代码片段。还有一个方便的侧边栏，可以让你快速浏览可用的资源。正如您所料，它包含了您需要的所有必要信息，可以让您立即开始工作。</em></p><h1 id="399c" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">证明</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi oa"><img src="../Images/62c3382424679e331c9afd602aae48db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kDzaMRWMcZgo6fM4ZQILw.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://stripe.com/docs/api/authentication" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/api/authentication</a></p></figure><p id="d8ec" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当您想到API认证时，您应该想到安全性🔒。</p><p id="75c0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Stripe需要知道是谁发出的请求，以及他们是否被授权这样做。为此，对于我们发出的每个请求，我们需要发送一个带有<strong class="ks iu"> API密钥</strong>、<strong class="ks iu"> </strong>或密码的请求，通常使用特定于帐户的信息(如用户名和密码)来生成。</p><p id="c63d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果请求包含有效的API密钥，Stripe将继续处理该请求。否则，Stripe将自动返回一个错误响应<code class="fe oj ok ol om b">401 — Unauthorized</code>，让请求者知道他们的凭证无效。如果你不知道401是什么意思，没关系，我们会在错误部分讨论这个问题。</p><p id="06b4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">就像密码一样，我们永远不应该公开分享这些信息。</p><h1 id="4977" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">目标</h1><p id="632e" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">对象<strong class="ks iu"> </strong>代表信息。从技术上讲，您可以将对象想象成数据库表中的记录。例如，假设我们有姓名和手机号码等客户数据。这可能会存储在customer表内的数据库中，我们可以通过支持customer对象的API与该表进行交互，比如创建新客户或检索现有客户。</p><p id="3fb2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">客户名称和移动电话是描述客户对象的数据属性。每个数据属性都有一个<strong class="ks iu">类型</strong> —无论是<em class="my">字符串</em>、<em class="my">整数</em>、<em class="my">日期</em>等等。这加强了值必须遵守的规则。例如，姓名可能是字符串类型，而生日可能是日期类型。如果您试图创建一个生日为“abcdef”的新客户，那么这可能会返回一个错误，说明您只能在生日字段中保存一个日期值。</p><p id="7c6c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们来看一个真实的客户对象。</p><h2 id="ae6b" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">条带化客户对象</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi oz"><img src="../Images/479949b8d8d55a72491220cd2fc48717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EuOSdfdP5YqWcyjyGCSPig.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://stripe.com/docs/api/customers/object" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/api/customers/object</a></p></figure><p id="12a5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Stripe在使客户对象易于阅读方面做得很好。右侧表示JSON格式的示例客户对象，而左侧定义数据属性。</p><p id="9c3a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果这种格式看起来“太专业”，不要惊慌。我将用简单的英语解释如何阅读，从右边开始。</p><pre class="kj kk kl km gt pa om pb pc aw pd bi"><span id="435e" class="on mc it om b gy pe pf l pg ph">{<br/>  "id": "cus_L3OFQQ0ihEvq03",<br/>  "object": "customer",<br/>  "address": null,<br/>  "balance": 0,<br/>  "created": 1643464809,<br/>  "currency": "usd",<br/>  "default_source": null,<br/>  "delinquent": false,<br/>  "description": null,<br/>  "discount": null,<br/>  "email": null,<br/>  "invoice_prefix": "B22171F",<br/>  "invoice_settings": {<br/>    "custom_fields": null,<br/>    "default_payment_method": null,<br/>    "footer": null<br/>  },<br/>  "livemode": false,<br/>  "metadata": {},<br/>  "name": null,<br/>  "next_invoice_sequence": 1,<br/>  "phone": null,<br/>  "preferred_locales": [],<br/>  "shipping": null,<br/>  "tax_exempt": "none"<br/>}</span></pre><p id="bbfe" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">上面的数据对象代表一个客户。</p><p id="ecbd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">从顶部<code class="fe oj ok ol om b">"id": "cus_L3OFQQ0ihEvq03"</code>开始，意味着这个客户的<code class="fe oj ok ol om b">id</code>是<code class="fe oj ok ol om b">cus_L3OFQQ0ihEvq03</code>。就这样？是的——真的就这么简单。</p><p id="e2cb" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">数据属性<em class="my">总是</em>遵循<code class="fe oj ok ol om b">key:value</code>模式。</p><p id="b368" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果您使用电子表格，您可以将键想象为列标题，将值想象为单元格行值。事实上，它们是可以互换的<em class="my"/>，这意味着你可以很容易地在表格格式和JSON格式之间转换。这是人类(和机器)阅读、理解和使用数据对象的另一种方式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi pi"><img src="../Images/6a27bcacf5d3a57586b9efcf7ae53ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28S4IbEOxc3kmKVASwfmZA.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated">电子表格中的客户对象</p></figure><h2 id="ccb8" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">条带客户属性</h2><p id="890e" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">数据属性很重要。它们帮助开发人员理解哪些字段可以用于数据对象。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi pj"><img src="../Images/b95d7b4735e0f8dca4c971210f2a0c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vi40wcNDpkOtvCYAqFQjfg.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://stripe.com/docs/api/customers/create" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/api/customers/create</a></p></figure><p id="6e8b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在API文档中引用数据对象时，您应该注意以下几点:</p><ul class=""><li id="ce5f" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">属性</li><li id="13c4" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">类型</li><li id="a531" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">必需/可选</li><li id="ae4b" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">描述</li></ul><p id="86c2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">请注意Stripe如何具备上述所有特性。我们可以以电子邮件为例。Stripe客户对象中的email属性是一个可选字段，类型为string。</p><p id="51fe" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这意味着Stripe不要求您在创建客户对象时拥有电子邮件值。但是，有些API可以，所以一定要仔细检查你正在使用的API文档。</p><p id="6076" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">描述也很重要，可以提供我们可能忽略的关键信息。在这种情况下，我们知道电子邮件有512个字符的限制。</p><h1 id="7e45" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">请求</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/b5a615bf0eca868c7aa58441cf15734a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*lwGY8gs_uVdr2a0qcra91g.jpeg"/></div><p class="of og gj gh gi oh oi bd b be z dk translated">提出请求</p></figure><p id="fb06" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当《雾都孤儿》要求更多时，他是在提出请求。API请求的行为方式类似，只是结构更标准(用HTTP方法、头和有效负载代替碗和勺子)。</p><h2 id="5a7a" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">方法</h2><p id="5647" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">在数据对象的上下文中，您可以使用API来执行四个基本的<strong class="ks iu"> CRUD </strong>功能:</p><ul class=""><li id="0e47" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">创造</li><li id="871e" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">阅读</li><li id="42d8" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">更新</li><li id="3c63" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">删除</li></ul><p id="9c5a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">例如，您可以创建客户、读取或检索客户、更新客户信息以及删除客户。</p><p id="3c1c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这些CRUD函数可以转换成四种HTTP方法:</p><ul class=""><li id="5d64" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">邮政</li><li id="e01b" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">得到</li><li id="2134" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">放</li><li id="2dbc" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">倒三角形</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi pl"><img src="../Images/f48a62e4a57c3ead687503e4f579f770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*plqXqEMiEJHC_bhKPa57HQ.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated">CRUD HTTP API示例</p></figure><p id="57b9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">上表是客户API及其与CRUD和HTTP方法关系的一个例子。<code class="fe oj ok ol om b">:id</code>是一个参数，您可以更改它来指定您正在请求的对象。例如，当你访问LinkedIn这样的网页时，你有没有注意到这个网址？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/9bed66500c86c77c8e89e6aac2a66ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*Viq3zttTINnR4cRNBVJBzw.png"/></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://www.linkedin.com/in/songthamtung/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/songthamtung/</a></p></figure><p id="5db4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这类似于<code class="fe oj ok ol om b">GET /customer/:id</code>请求。这里的<code class="fe oj ok ol om b">:id</code>是<em class="my">松坦通</em>。</p><p id="a8b5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">值得注意的是，这种结构不是绝对的，而是一个可以遵循的一般准则。举例来说，Stripe并没有完全遵循这一点——如果读者理解如何使用API，那也没关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi pn"><img src="../Images/2105ab054cafb860e0d080b4ccdfd714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8NBRKlfNYiKcs09OwzZPw.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated">Stripe的客户API</p></figure><p id="02f0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Stripe的客户API实际上甚至不包含PUT请求。相反，为了更新客户，他们使用POST方法并传入一个<code class="fe oj ok ol om b">:id</code>。您可能会注意到有一个额外的功能“列出所有客户”，这是一个GET请求，不接受任何<code class="fe oj ok ol om b">:id</code>。</p><p id="145d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有多种方法可以调用API端点。将此与请求有效负载结合起来，您将有更多的可能性。</p><h2 id="eb4c" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">请求有效负载</h2><p id="b725" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">请求负载或主体是与API请求一起发送的数据。您可以在这里指定要传递给正在调用的系统的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/e093f5971f25767d39a02d80182a136c.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*r3Bk0FJ0KjJkcrBkjsv9Mg.png"/></div><p class="of og gj gh gi oh oi bd b be z dk translated">使用cURL创建具有请求有效负载的客户</p></figure><p id="b517" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">例如，当您想要创建一个客户时，您必须传递特定的细节，比如姓名和电子邮件。该数据包含在请求有效负载中。</p><pre class="kj kk kl km gt pa om pb pc aw pd bi"><span id="b7cb" class="on mc it om b gy pe pf l pg ph">curl https://api.stripe.com/v1/customers \   <br/>-u sk_test_4eC39HqLyjWDarjtT1zdp7dc: \   <br/>-d description="My First Test Customer (created for API docs)"</span></pre><p id="2da1" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是一个cURL请求，允许您从命令行或shell脚本进行API调用。类似于我们分解客户对象的方式，我们可以对此进行剖析，以了解发生了什么。</p><ol class=""><li id="d206" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll pp nf ng nh bi translated">第一行是我们向<code class="fe oj ok ol om b">curl <a class="ae nz" href="https://api.stripe.com/v1/customer" rel="noopener ugc nofollow" target="_blank">https://api.stripe.com/v1/customer</a>s</code>发出请求的API URL。</li><li id="ed1f" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll pp nf ng nh bi translated">第二行用于认证<code class="fe oj ok ol om b">-u sk_test_4eC39HqLyjWDarjtT1zdp7dc</code>。</li><li id="14d4" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll pp nf ng nh bi translated">最后一行是我们发送的有效负载，以及我们创建一个带有描述<code class="fe oj ok ol om b">-d description=”My First Test Customer (created for API docs)”</code>的客户的请求。</li></ol><p id="0d91" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">使用下面的语法，我们可以很容易地向请求有效负载添加一个名称和一个电子邮件。</p><pre class="kj kk kl km gt pa om pb pc aw pd bi"><span id="fb3f" class="on mc it om b gy pe pf l pg ph">curl https://api.stripe.com/v1/customers \   <br/>-u sk_test_4eC39HqLyjWDarjtT1zdp7dc: \   <br/>-d description="My First Test Customer (created for API docs)" \<br/>-d name="Songtham Tung" \<br/>-d email="songthamtung@gmail.com"</span></pre><p id="370d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有关我们可以使用的可能属性的完整列表，请参考数据对象定义一节。我还想提一下，根据API的不同，请求负载可能不是必需的。</p><p id="ce3f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在你提出请求后，你总是可以期待得到回应。</p><h1 id="a3c3" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">反应</h1><p id="3eb8" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">牛顿没有说过，对于每个API请求，都有一个相等且相反的API响应。然而，在第三运动定律中发现的相同原理也可以应用在这里。</p><p id="195a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">无论是成功还是失败，您都会收到包含以下内容的回复</p><ul class=""><li id="0c97" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">状态代码</li><li id="ec4a" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">有效载荷</li></ul><h2 id="b71c" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">状态代码</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/297480464c8ed91a7b163eb0bdfe5816.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*cUuFm7EkAlcFybDE2W_2XQ.png"/></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://stripe.com/docs/api/errors" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/api/errors</a></p></figure><p id="3593" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">Stripe在上表中很好地封装了HTTP状态代码。左侧包含3位数字状态代码，右侧包含其含义的简要描述。</p><p id="8da4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一条经验法则是</p><ul class=""><li id="10eb" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">2XX —成功</li><li id="18b2" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">4XX —客户端错误</li><li id="3b19" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">5XX —服务器错误</li></ul><p id="a5b4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">换句话说，如果您使用Stripe API成功创建了一个客户，那么返回的状态代码将是200。否则，如果你犯了一个错误(无论是未经授权，错误的属性等)，那么你会收到4XX。最后，如果一切正常，但收到的是5XX，那么条带就有问题。</p><p id="0b46" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以下次当你听到开发者说“是的，我得到了200分！”或者“不，我得了500分！”，你就会知道他们在谈论什么。</p><h2 id="b3ec" class="on mc it bd md oo op dn mh oq or dp ml kz os ot mn ld ou ov mp lh ow ox mr oy bi translated">响应有效负载</h2><p id="c468" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">除了状态代码，API响应还包括一个有效负载。与请求有效负载类似，响应有效负载只是返回的数据。返回的数据包含重要的信息，开发人员可以使用这些信息优雅地处理成功和失败的响应。</p><p id="19fa" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是一个典型的流程图</p><ul class=""><li id="1806" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">如果响应成功，使用响应有效负载并执行以下操作</li><li id="0fc0" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">否则，如果由于客户端错误而失败，请使用响应有效负载并这样做</li><li id="4bc3" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">否则返回服务器错误</li></ul><p id="81fd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果我们以客户API <code class="fe oj ok ol om b">GET /customer/:id</code>为例</p><ul class=""><li id="746e" class="mz na it ks b kt ku kw kx kz nb ld nc lh nd ll ne nf ng nh bi translated">如果响应成功<code class="fe oj ok ol om b">200</code>，让客户返回应用程序</li><li id="3db8" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">否则，如果由于<code class="fe oj ok ol om b">404 — Not Found</code>失败，将未找到的客户返回给应用程序</li><li id="628e" class="mz na it ks b kt ni kw nj kz nk ld nl lh nm ll ne nf ng nh bi translated">否则返回服务器错误</li></ul><p id="7e97" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">处理错误(和成功)是如此重要，以至于Stripe甚至有一个专门的部分，包含来自支持库的示例代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi oz"><img src="../Images/b1d84da6a88347332e2e23e3cd902f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ITkIWW8lazyzdmi4ZflMg.png"/></div></div><p class="of og gj gh gi oh oi bd b be z dk translated"><a class="ae nz" href="https://stripe.com/docs/api/errors/handling?lang=python" rel="noopener ugc nofollow" target="_blank">https://stripe.com/docs/api/errors/handling?lang=python</a></p></figure><p id="cdb8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">由于我不期望你知道如何阅读和理解一门编程语言，所以我们不会在这里详细讨论。然而，我想向您展示在真实场景中处理API响应的样子。</p><p id="233b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">简而言之，代码告诉系统如何处理返回的API响应。</p><p id="3bbf" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果这个，那么那个。否则做点别的。</p><h1 id="8f57" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论</h1><p id="71eb" class="pw-post-body-paragraph kq kr it ks b kt mt ju kv kw mu jx ky kz mv lb lc ld mw lf lg lh mx lj lk ll im bi translated">恭喜你能走到这一步！这并不容易。乍一看，阅读API文档可能很困难，但是有一种潜在的模式或语言本身使它成为一种无处不在的交流形式。</p><p id="3f15" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">并非所有的API文档都是同等创建的，但是大多数API都倾向于像客户一样被分组到资源中。从这里，您可以看到示例请求和响应，以及有效负载中各自的属性和示例数据对象。</p><p id="8c3c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">你该怎么做…嗯，完全取决于你和你的团队。要获得关于API实现的更高级的教程，可以考虑看看另一篇文章，在这篇文章中我们探讨了如何使用序列图来可视化API编排<a class="ae nz" rel="noopener ugc nofollow" target="_blank" href="/designing-sequence-diagrams-for-api-orchestration-113ac45e16df">这里</a>。</p><p id="8469" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">快乐阅读！</p></div></div>    
</body>
</html>