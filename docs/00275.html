<html>
<head>
<title>Repeatable and Maintainable Development Environments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可重复和可维护的开发环境</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/repeatable-maintainable-development-environments-45f4589c824?source=collection_archive---------0-----------------------#2019-01-26">https://betterprogramming.pub/repeatable-maintainable-development-environments-45f4589c824?source=collection_archive---------0-----------------------#2019-01-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9707" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">随着一个可回答的，流动的，持续的整合</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f81c915e045768bf26e0e925a83c8619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9bYW05iDHJWdETR0wx0ng.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@rawfilm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> RawFilm </a>在<a class="ae ky" href="https://unsplash.com/search/photos/environment?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="a6da" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">问题</strong></h1><p id="c7ae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">开发人员需要一套特定的软件工具来完成工作。</p><p id="b0b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您的团队中可能有新成员，或者您可能需要以某种方式从根本上改变您当前团队使用的软件环境——也许迁移到不同的操作系统？</p><p id="ca51" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们都需要的软件工具的列表可能相当广泛。<strong class="lt iu"> </strong>虽然这些软件工具中的一部分可以从包管理器中获得(例如Aptitude、Snap、Homebrew等。)，它们仍然可能有相当复杂的安装步骤(可能会随机更改和中断)。</p><p id="69aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些步骤可能会被记录下来——但也可能不会。还有一个问题是，让开发人员维护他们自己的基础软件环境可能意味着不同开发机器之间的巨大不一致性，随着时间的推移，这种不一致性会变得更糟。</p><p id="7508" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">解决这个问题会对生产力造成巨大的打击。对于新入职的人来说，这可能意味着在接下来的x天内要花费大量的精力在您的团队中安排知识渊博的人来支持您的新入门者，或者如果您的问题需要改变开发团队现有的软件环境，这可能意味着一个漫长的迁移计划。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="5145" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">一个解决方案</h1><ul class=""><li id="eea7" class="ne nf it lt b lu lv lx ly ma ng me nh mi ni mm nj nk nl nm bi translated">利用<a class="ae ky" href="https://www.ansible.com/" rel="noopener ugc nofollow" target="_blank"> Ansible </a>的强大功能，将您的开发环境(及其所有工具和依赖项)编写成剧本</li><li id="ce50" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">使用<a class="ae ky" href="https://www.vagrantup.com/" rel="noopener ugc nofollow" target="_blank">流浪者</a>来启动一个<a class="ae ky" href="https://www.vagrantup.com/docs/virtualbox/" rel="noopener ugc nofollow" target="_blank"> VirtualBox </a>你的基本机器镜像(你正在使用的操作系统/发行版)</li><li id="1141" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">在构建虚拟机的过程中运行Ansible作为供应器，并使用您编写的剧本</li><li id="5c8c" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">输出供应步骤的成功或失败，并在持续集成(CI)工具中运行</li><li id="0f32" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">向您的团队传达本行动手册的更新和发布，并要求他们获取和运行更新</li></ul><p id="3978" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你得到了什么？一个在你的团队中保持一致的基础开发环境，你知道它将拥有开发人员入门所需的一切，并且每次安装时你都可以依赖它(假设它得到了积极的维护)。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ae83" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">什么是可能的？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/51999438aec62f14cc0ba2b4f7205f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/0*lw3NatmyGP6xQN20.png"/></div></figure><p id="7702" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Ansible 是一款IT自动化工具，可用于许多不同的任务和IT需求。它使用用YAML语言编写的声明性DSL，可以在本地运行，在虚拟机、云环境的配置中运行，或者通过安全外壳(SSH)针对一系列已知主机运行。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="d3f2" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">写剧本</h1><p id="2041" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了本文简洁起见，我将假设一些Ansible知识——下面有一个奇妙的零到英雄教程，它将带你了解Ansible语法和它使用的一些内置插件:</p><div class="nt nu gp gr nv nw"><a href="https://serversforhackers.com/c/an-ansible2-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">Ansible2教程</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">针对Ansible2更新！Ansible是最简单的服务器供应和配置管理工具之一。这是一个…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">serversforhackers.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><p id="8cad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将从一个基本剧本文件开始，它将引用我们创建开发环境所需的角色和任务:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这为我们的环境定义了变量，以及我们需要运行的三种不同类型的任务</p></figure><p id="6d47" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们将构建我们需要的角色/任务和var。我将只描述其中的第一个——如果您想了解其余步骤是如何实现的，以及项目应该如何构建，您可以<a class="ae ky" href="https://github.com/AndyMacDroo/ubuntu-development-environment-playbook" rel="noopener ugc nofollow" target="_blank">查阅剧本</a>。</p><h2 id="6442" class="on la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated"><strong class="ak">包任务</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在这里，我们根据vars文件中的一个var中的包列表来安装和删除aptitude包</p></figure><h2 id="1c77" class="on la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated"><strong class="ak">包任务的变量文件</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上述任务的附带变量文件</p></figure><h2 id="00a5" class="on la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated"><strong class="ak">运行行动手册</strong></h2><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="efee" class="on la it pa b gy pe pf l pg ph">ansible-playbook -i "localhost," -c local configure.yml</span><span id="4095" class="on la it pa b gy pi pf l pg ph">[00:00:30] <br/>[00:00:30] PLAY [all] *********************************************************************<br/>[00:00:30] <br/>[00:00:30] TASK [Gathering Facts] *********************************************************<br/>[00:00:31] ok: [localhost]<br/>[00:00:31] <br/>[00:00:54] TASK [packages : Install required apt packages] ********************************<br/>[00:02:59] changed: [localhost]<br/>[00:02:59] <br/>[00:02:59] TASK [packages : Remove unrequired apt packages] *******************************<br/>[00:02:59] ok: [localhost]</span></pre><p id="8531" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果任何步骤失败，剧本将失败并返回退出代码0(失败)。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="eeb6" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">将它们缝合在一起(并进行测试)</h1><p id="7e71" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">很好，我们现在有了一个剧本，可以用来安装和删除各种aptitude包——但是当我们扩展它时，我们应该如何运行和测试它以确保它不会阻塞我们的机器呢？</p><p id="03d3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果可以的话，我们真的不想冒险破坏我们当前的环境。这就是流浪者派上用场的地方。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ac41" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">流浪汉是什么鬼东西？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl pj"><img src="../Images/d224ebded1e4f01bab436cd15e13dd2d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*weuMknsLJV1t4lMq4lZIdw.png"/></div></figure><p id="10e1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://www.vagrantup.com/intro/index.html" rel="noopener ugc nofollow" target="_blank">vagger</a>是一款用于初始化和配置虚拟环境的开源工具。vagger提供了一个命令行界面来管理虚拟环境，并使用一个名为<code class="fe pk pl pm pa b">Vagrantfile</code>的文件来提供需要构建的环境的定义。</p><p id="02c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里有一个非常简单的<code class="fe pk pl pm pa b">Vagrantfile</code>创建一个包含Ubuntu操作系统的虚拟机:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="40b7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦我们选择的虚拟机启动，我们可以配置一个<code class="fe pk pl pm pa b">Vagrantfile</code>来运行我们的Ansible剧本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h2 id="dee1" class="on la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated"><strong class="ak">启动我们的开发机器</strong></h2><p id="8bc8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://www.vagrantup.com/intro/index.html" rel="noopener ugc nofollow" target="_blank"> HashiCorp </a>引以为豪的是培养一个流浪机器是多么简单——简单:<code class="fe pk pl pm pa b">vagrant up</code></p><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="d24c" class="on la it pa b gy pe pf l pg ph">Bringing machine 'dev' up with 'virtualbox' provider...<br/>==&gt; dev: Checking if box 'bento/ubuntu-18.04' is up to date...<br/>==&gt; dev: Running provisioner: ansible...</span><span id="9d4e" class="on la it pa b gy pi pf l pg ph">dev: Running ansible-playbook...<br/>PYTHONUNBUFFERED=1 ANSIBLE_FORCE_COLOR=true ANSIBLE_HOST_KEY_CHECKING=false ANSIBLE_SSH_ARGS='-o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes -o ControlMaster=auto -o ControlPersist=60s' ansible-playbook --connection=ssh --timeout=30 --limit="dev" --inventory-file=/home/andy/Projects/development-environment-playbook/.vagrant/provisioners/ansible/inventory -v configure.yml<br/>Using /home/andy/Projects/development-environment-playbook/ansible.cfg as config file</span><span id="4246" class="on la it pa b gy pi pf l pg ph">PLAY [all] *********************************************************************</span><span id="4179" class="on la it pa b gy pi pf l pg ph">TASK [Gathering Facts] *********************************************************<br/>ok: [dev]</span></pre><p id="96b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意:</strong>如果这是你第一次这么做，如果你的机器上还没有合适的虚拟机镜像，你会看到大量的输出。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="a381" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">将剧本构建集成到CI渠道中</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/d07b7a7cc3e41302c24eefa221560c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uQ8JfKfoCazDuHhE.png"/></div></div></figure><p id="14ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您熟悉<a class="ae ky" href="https://medium.com/@nilanyasiru/introduction-to-continuous-integration-continuous-deployment-38c3ebc07221" rel="noopener">持续集成</a>的概念和可用的工具，您可能会猜到这里会出现什么。根据您使用的CI解决方案，这里将有许多选项和差异。</p><p id="24f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，我将简要介绍如何在一个更受欢迎的解决方案中实现这一点:<a class="ae ky" href="https://jenkins.io/" rel="noopener ugc nofollow" target="_blank">Jenkins</a>——我也将假定这是一个实用的知识——这里有一个关于Jenkins管道的<a class="ae ky" href="https://medium.com/@mightywomble/jenkins-pipeline-beginners-guide-f3868f715ed9" rel="noopener">良好知识库</a>。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="022d" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">安装/配置Jenkins</h1><p id="b1cb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我假设已经安装了Jenkins——如果没有，这里有Docker的官方图片，您可以尝试一下:</p><div class="nt nu gp gr nv nw"><a href="https://github.com/jenkinsci/docker" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">詹金斯/码头工人</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">码头工人官方詹金斯回购。在GitHub上创建一个帐户，为jenkinsci/docker的开发做出贡献。</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="po l oh oi oj of ok ks nw"/></div></div></a></div><p id="a00a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里唯一的特殊考虑是确保Jenkins CI服务器、容器或虚拟机具有通过Vagrant运行虚拟机所需的所有依赖关系。</p><p id="9c00" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这显然会因基本操作系统和版本而异。<a class="ae ky" href="https://www.tecmint.com/how-to-install-vagrant-on-centos-7/" rel="noopener ugc nofollow" target="_blank">这里有一个在Centos 7上安装流浪者的例子。</a></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ca2c" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">简单的管道</h1><p id="6f26" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设你真的想知道你的构建什么时候失败了，在Jenkins的<a class="ae ky" href="https://github.com/jenkinsci/slack-plugin" rel="noopener ugc nofollow" target="_blank"> Slack插件的帮助下，</a>你的<code class="fe pk pl pm pa b">Jenkinsfile</code>可以简单到:</p><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="d224" class="on la it pa b gy pe pf l pg ph">pipeline {<br/>  stages {<br/>    stage ('Start') {<br/>      steps {<br/>        sh 'vagrant up'<br/>      }<br/>    }<br/>  }<br/>  post {<br/>    success {<br/>      slackSend (color: '#00FF00', message: "A new version of the development environment is available!")<br/>    }</span><span id="9e6c" class="on la it pa b gy pi pf l pg ph">failure {<br/>      slackSend (color: '#FF0000', message: "The latest build of the development environment FAILED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]' (${env.BUILD_URL})")<br/>    }<br/>  }<br/>}</span></pre><p id="61c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果一切顺利呢？瞧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/26a62c880f1b9d48a71518bd09e48ee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6E2FaviJXAnDhb9oIRtUyg.png"/></div></div></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="0418" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">铺开它</h1><p id="cf10" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您致力于这种方法并将其融入到您的团队中，您将会看到以下好处:</p><ul class=""><li id="dd9b" class="ne nf it lt b lu mn lx mo ma pq me pr mi ps mm nj nk nl nm bi translated">您现在已经有了团队正在使用的大部分软件的完整列表</li><li id="e9cf" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">你可以更快地让新员工加入进来，因为他们所需要做的就是运行一个自动化的剧本来拥有一个工作环境</li><li id="eec3" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">当开发人员发生意外，机器不可挽回地损坏时，一个新的干净的状态就不远了</li><li id="5f60" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">您可以通过创建行动手册的新发布版本来推出标准开发环境的更新</li><li id="fb5a" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">如果安装步骤更改或过时，构建将会失败，您将会提前看到您需要更新您的步骤，以免在不方便的时候成为需要解决的问题</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="68ea" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">其他OS？</h1><p id="980f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我已经在基于Linux的环境(特别是Ubuntu)中实现这种策略的细节上花了很多精力，但是这种策略实际上可以应用于任何操作系统(原则上，任何可以获得VM镜像的操作系统)。</p><p id="d9f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您在自己喜欢的环境中具有良好的脚本编写技能，那么您可以很容易地定制这个策略来满足您的需求。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="b439" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">最后的想法(和一个例子)</h1><p id="69d2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">显然有很多方法可以达到同样的效果，但是希望这篇文章可以帮助那些需要解决这个问题的人，以及那些可能受到限制而无法采用其他方法的人。</p><p id="55cb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里有一个完整的例子，是我在过去使用的开发设置中总结出来的。这绝不是完美的。</p><div class="nt nu gp gr nv nw"><a href="https://github.com/AndyMacDroo/ubuntu-development-environment-playbook" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">AndyMacDroo/Ubuntu-开发-环境-行动手册</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">ubuntu开发环境的Ansible playbook。-AndyMacDroo/Ubuntu-开发-环境-剧本</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">github.com</p></div></div><div class="of l"><div class="pt l oh oi oj of ok ks nw"/></div></div></a></div><p id="82a5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">注意:</strong>我在这里用来构建项目的基于云的CI集成，不幸的是没有使用VirtualBox/vagger，这是由于该领域的一些<a class="ae ky" href="https://stackoverflow.com/questions/31828555/using-vagrant-on-cloud-ci-services" rel="noopener ugc nofollow" target="_blank">已知限制</a>(简而言之，这相当于在云CI管道中初始化的虚拟化工作者内部运行和部署虚拟机的问题)。我在这里应用的配置只是在AppVeyor提供的Ubuntu Bionic VM上运行playbook。</p><p id="fa70" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">想法和进一步建议:</strong></p><ul class=""><li id="8e6e" class="ne nf it lt b lu mn lx mo ma pq me pr mi ps mm nj nk nl nm bi translated">添加对<code class="fe pk pl pm pa b">.bashrc</code>的替换，以包含开发人员可能需要的任何定制脚本或实用程序，或者将节省他们的时间添加到您的行动手册中</li><li id="cdd5" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">添加额外的测试运行状况检查，以确认重要软件和工具已正确安装，并且功能正常，从而提高CI构建的可靠性</li><li id="b15a" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">创建CI构建步骤以运行构建，在该构建中，您的新的、闪亮的开发环境行动手册的每个连续版本都在测试中累积应用到您的虚拟机上(开发机器很少长时间都是干净的—确保您的行动手册可以用于现有环境的更新以及干净的构建)</li><li id="a099" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">将您的行动手册分为基础行动手册和特定于开发环境的行动手册——如果您想使用Ansible来提供您的生产环境，为什么不确保您团队的开发机器也与您的生产环境共享一些东西呢？</li><li id="e798" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">使用类似于<a class="ae ky" href="https://medium.com/the-andela-way/building-custom-machine-images-with-packer-a21c6d932bf6" rel="noopener"> Packer </a>的技术来创建开发环境的映像，并围绕运行映像而不是生成虚拟机来构建CI流程</li></ul><p id="2e3f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读。希望你喜欢。</p></div></div>    
</body>
</html>