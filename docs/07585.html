<html>
<head>
<title>The Ultimate Programmer’s Guide to Bash Scripting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bash脚本编程的终极程序员指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-ultimate-programmers-guide-to-bash-scripting-2d11d4e6e978?source=collection_archive---------0-----------------------#2021-01-29">https://betterprogramming.pub/the-ultimate-programmers-guide-to-bash-scripting-2d11d4e6e978?source=collection_archive---------0-----------------------#2021-01-29</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="6e9a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">深入探究Bash脚本，帮助您自动化任务</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/12d7303acea0e19a57de3b71bf347116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*genmIQHyyGSzJ1Qg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">杰里米·毕晓普在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="098a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">[更新于2021年2月18日。代码更改为要点并添加了链接]</p><h1 id="826d" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">介绍</h1><p id="16dd" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Bash脚本允许您自动化命令行任务。比如看<a class="ae kz" href="https://www.youtube.com/watch?v=PS5vBJELtj4" rel="noopener ugc nofollow" target="_blank">这个视频</a>。该视频展示了如何使用Bash脚本自动创建YouTube频道。看完之后，你可能想创建自己的YouTube频道。再举一个例子，在这篇<a class="ae kz" href="https://towardsdatascience.com/4-bash-script-helpers-to-get-more-done-4144046be13" rel="noopener" target="_blank">文章</a>中，我自动化了常见的终端任务。</p><p id="8d41" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在本文中，我们将介绍面向初学者的基本Bash脚本，并创建简单的可执行脚本。</p><p id="2be9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们深入Bash脚本吧！</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="27e3" class="my lx iu mu b gz mz na l nb nc"><strong class="mu iv">Table of Contents</strong></span><span id="f7b9" class="my lx iu mu b gz nd na l nb nc">· <a class="ae kz" href="#826d" rel="noopener ugc nofollow">Introduction</a><br/>· <a class="ae kz" href="#c48e" rel="noopener ugc nofollow">Setting Things Up</a><br/>  ∘ <a class="ae kz" href="#dbce" rel="noopener ugc nofollow">Mac</a><br/>  ∘ <a class="ae kz" href="#9453" rel="noopener ugc nofollow">The bin directory</a><br/>· <a class="ae kz" href="#280c" rel="noopener ugc nofollow">VSCode Extensions</a><br/>· <a class="ae kz" href="#a9f0" rel="noopener ugc nofollow">Getting Started</a><br/>  ∘ <a class="ae kz" href="#4537" rel="noopener ugc nofollow">Shebang</a><br/>  ∘ <a class="ae kz" href="#16fc" rel="noopener ugc nofollow">Comment</a><br/>· <a class="ae kz" href="#e1fc" rel="noopener ugc nofollow">Variables</a><br/>  ∘ <a class="ae kz" href="#5a38" rel="noopener ugc nofollow">Variable assignment</a><br/>  ∘ <a class="ae kz" href="#1b60" rel="noopener ugc nofollow">Environment variables</a><br/>  ∘ <a class="ae kz" href="#3f49" rel="noopener ugc nofollow">Internal variables</a><br/>  ∘ <a class="ae kz" href="#8cef" rel="noopener ugc nofollow">Assigning the command output to a variable</a><br/>  ∘ <a class="ae kz" href="#18b6" rel="noopener ugc nofollow">Built-in commands</a><br/>· <a class="ae kz" href="#a6ca" rel="noopener ugc nofollow">Tests</a><br/>  ∘ <a class="ae kz" href="#d663" rel="noopener ugc nofollow">if statement</a><br/>  ∘ <a class="ae kz" href="#253a" rel="noopener ugc nofollow">Spaces Matter</a><br/>  ∘ <a class="ae kz" href="#e615" rel="noopener ugc nofollow">Test file expressions</a><br/>  ∘ <a class="ae kz" href="#46bc" rel="noopener ugc nofollow">Test string expressions</a><br/>  ∘ <a class="ae kz" href="#89ad" rel="noopener ugc nofollow">Test integer expressions</a><br/>  ∘ <a class="ae kz" href="#f609" rel="noopener ugc nofollow">Double parentheses</a><br/>· <a class="ae kz" href="#33be" rel="noopener ugc nofollow">How To Use if/else and if/elif/else Statements</a><br/>· <a class="ae kz" href="#b994" rel="noopener ugc nofollow">Double Brackets</a><br/>· <a class="ae kz" href="#98d4" rel="noopener ugc nofollow">How To Use for Loops</a><br/>  ∘ <a class="ae kz" href="#2e94" rel="noopener ugc nofollow">Using a for loop to rename files</a><br/>· <a class="ae kz" href="#199f" rel="noopener ugc nofollow">How To Use Parameters</a><br/>· <a class="ae kz" href="#eff3" rel="noopener ugc nofollow">How To Accept User Input</a><br/>· <a class="ae kz" href="#401b" rel="noopener ugc nofollow">Brace Expansion Using Ranges</a><br/>· <a class="ae kz" href="#3492" rel="noopener ugc nofollow">How To Use While Loops</a><br/>· <a class="ae kz" href="#5a36" rel="noopener ugc nofollow">What Are Exit Status/Return Codes?</a><br/>  ∘ <a class="ae kz" href="#9fb4" rel="noopener ugc nofollow">Checking the exit status</a><br/>· <a class="ae kz" href="#7d76" rel="noopener ugc nofollow">How To Connect Commands</a><br/>  ∘ <a class="ae kz" href="#0006" rel="noopener ugc nofollow">Logical operators and the command exit status</a><br/>  ∘ <a class="ae kz" href="#c933" rel="noopener ugc nofollow">Exit command</a><br/>  ∘ <a class="ae kz" href="#173c" rel="noopener ugc nofollow">Logical AND (&amp;&amp;)</a><br/>  ∘ <a class="ae kz" href="#977b" rel="noopener ugc nofollow">Logical OR (||)</a><br/>  ∘ <a class="ae kz" href="#16a4" rel="noopener ugc nofollow">The semicolon</a><br/>  ∘ <a class="ae kz" href="#c479" rel="noopener ugc nofollow">Pipe |</a><br/>· <a class="ae kz" href="#ebab" rel="noopener ugc nofollow">Functions</a><br/>  ∘ <a class="ae kz" href="#99c9" rel="noopener ugc nofollow">Function parameters</a><br/>· <a class="ae kz" href="#f0b6" rel="noopener ugc nofollow">Variable Scope</a><br/>  ∘ <a class="ae kz" href="#94c5" rel="noopener ugc nofollow">Local variables</a><br/>· <a class="ae kz" href="#6ed4" rel="noopener ugc nofollow">Function Exit Status</a><br/>· <a class="ae kz" href="#0381" rel="noopener ugc nofollow">Checklist</a><br/>· <a class="ae kz" href="#1343" rel="noopener ugc nofollow">Conclusion</a><br/>  ∘ <a class="ae kz" href="#2e8b" rel="noopener ugc nofollow">Newsletter</a><br/>  ∘ <a class="ae kz" href="#bd1d" rel="noopener ugc nofollow">References</a></span></pre><h1 id="c48e" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">设置事物</h1><h2 id="dbce" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak"> Mac </strong></h2><p id="4eae" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以检查您的Bash版本:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="c451" class="my lx iu mu b gz mz na l nb nc">$ bash --version<br/>GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin19)<br/>Copyright (C) 2007 Free Software Foundation, Inc.</span></pre><p id="bffe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们升级Bash版本:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="8070" class="my lx iu mu b gz mz na l nb nc">$ brew install bash</span></pre><p id="be70" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以列出找到的所有可执行文件的实例。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="e5b3" class="my lx iu mu b gz mz na l nb nc">$ which -a bash<br/>/usr/local/bin/bash<br/>/bin/bash</span></pre><p id="3f66" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们检查一下新安装的版本:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="d009" class="my lx iu mu b gz mz na l nb nc">$ /usr/local/bin/bash --version<br/>GNU bash, version 5.0.18(1)-release (x86_64-apple-darwin19.5.0)<br/>Copyright (C) 2019 Free Software Foundation, Inc.<br/>...</span></pre><p id="c3b6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们看看您使用的是哪个版本的Bash:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="aaae" class="my lx iu mu b gz mz na l nb nc">$ which bash<br/>/usr/local/bin/bash<br/># or<br/>$ type bash<br/>bash is /usr/local/bin/bash</span></pre><p id="da1b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果这不起作用，您需要在您的<code class="fe np nq nr mu b">~/.bashrc</code>(或者对于Zsh用户是<code class="fe np nq nr mu b">~/.zshrc</code>)中导出Bash路径。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="d7ec" class="my lx iu mu b gz mz na l nb nc">export PATH="/usr/local/bin:$PATH"</span></pre><p id="10ba" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">打开一个新的终端选项卡或重启终端，并检查Bash版本。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="cf7d" class="my lx iu mu b gz mz na l nb nc">$ bash --version<br/>GNU bash, version 5.0.18(1)-release (x86_64-apple-darwin19.5.0)<br/>Copyright (C) 2019 Free Software Foundation, Inc.<br/>...</span></pre><p id="3533" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">将<code class="fe np nq nr mu b">/usr/local/bin/bash</code>添加到<code class="fe np nq nr mu b">/etc/shells</code>作为可信外壳。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="e1dc" class="my lx iu mu b gz mz na l nb nc">$ vim /etc/shells<br/># List of acceptable shells for chpass(1).<br/># Ftpd will not allow users to connect who are not using<br/># one of these shells.</span><span id="8085" class="my lx iu mu b gz nd na l nb nc">/bin/bash<br/>/bin/csh<br/>/bin/ksh<br/>/bin/sh<br/>/bin/tcsh<br/>/bin/zsh<br/>/usr/local/bin/bash</span></pre><p id="f6d1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在Bash脚本中检查Bash版本。稍后我们将学习如何运行这个脚本。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1106" class="my lx iu mu b gz mz na l nb nc">#!/usr/local/bin/bash<br/>echo $BASH_VERSION</span></pre><p id="4d8e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv"> Mac gotcha <br/> </strong> Mac使用Zsh作为默认shell。例如，<code class="fe np nq nr mu b">echo $BASH_VERSION</code>不会在终端上工作。如果你使用的是<code class="fe np nq nr mu b">#!/bin/bash</code>，它可以在shell脚本中工作。</p><p id="5bb2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">在Mac上运行Linux<br/></strong>你可以使用<a class="ae kz" href="https://multipass.run/" rel="noopener ugc nofollow" target="_blank"> Multipass </a>在Mac/Windows上运行Ubuntu。<a class="ae kz" href="https://codeburst.io/run-an-instant-ubuntu-vms-on-mac-windows-linux-ff8421e25db0" rel="noopener" target="_blank">这篇文章</a>会帮你入门。另一种选择是使用Docker和Linux映像。</p><h2 id="9453" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">垃圾箱目录</strong></h2><p id="94da" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">让我们创建一个目录，并将路径添加到终端配置文件(<code class="fe np nq nr mu b">.bashrc</code>、<code class="fe np nq nr mu b">.zshrc</code>)。通过这样做，你可以以<code class="fe np nq nr mu b">myscript</code>而不是<code class="fe np nq nr mu b">./myscript</code>的身份运行你的脚本。</p><p id="6fe9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在您的主目录中，创建<code class="fe np nq nr mu b">bin</code>目录:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="f330" class="my lx iu mu b gz mz na l nb nc">$ mkdir bin</span></pre><p id="fe11" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在终端配置文件中添加该目录的路径。(或者<code class="fe np nq nr mu b">.bashrc</code>或者<code class="fe np nq nr mu b">.zshrc</code>)</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1e92" class="my lx iu mu b gz mz na l nb nc">export PATH="$PATH:$HOME/bin"</span></pre><p id="8ddf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">重新加载配置文件:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="fbc8" class="my lx iu mu b gz mz na l nb nc"># for .zshrc<br/>$ . ~/.zshrc <br/># or<br/>$ source ~/.zshrc<br/># for .bashrc<br/>$ . ~/.bashrc<br/># or<br/>$ source ~/.bashrc</span></pre><p id="d2b9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们将在这个<code class="fe np nq nr mu b">bin</code>目录中创建我们所有的脚本。</p><p id="0cd0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">多遍提示<br/> </strong>您可以将本地目录挂载到您的<a class="ae kz" href="https://codeburst.io/run-an-instant-ubuntu-vms-on-mac-windows-linux-ff8421e25db0#5dc0" rel="noopener" target="_blank">多遍实例</a>中，并导出 <code class="fe np nq nr mu b"><a class="ae kz" href="https://codeburst.io/run-an-instant-ubuntu-vms-on-mac-windows-linux-ff8421e25db0#95ba" rel="noopener" target="_blank">~/.bashrc</a></code>中的<code class="fe np nq nr mu b"><a class="ae kz" href="https://codeburst.io/run-an-instant-ubuntu-vms-on-mac-windows-linux-ff8421e25db0#95ba" rel="noopener" target="_blank">PATH</a></code> <a class="ae kz" href="https://codeburst.io/run-an-instant-ubuntu-vms-on-mac-windows-linux-ff8421e25db0#95ba" rel="noopener" target="_blank">。</a></p><h1 id="280c" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">VSCode扩展</h1><p id="4fcf" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">如果您使用VSCode，我推荐shellcheck [2]和shell-format [3]扩展。shellcheck为Bash、Zsh和sh的shell脚本添加了一个linter。shell-format是一种shellscript文档格式。</p><h1 id="a9f0" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">入门指南</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ns"><img src="../Images/1a508a401a0e86cb1674b1b20f71f41f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eSa0obfeG5yFp__p"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@bradencollum?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布拉登·科拉姆</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="407f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用一个<code class="fe np nq nr mu b">.sh</code>扩展是一个惯例，但是你不需要使用一个扩展。创建一个名为<code class="fe np nq nr mu b">myscript</code>的文件:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="2e25" class="my lx iu mu b gz mz na l nb nc">$ cd ~/bin<br/># create a empty file<br/>$ &gt; myscript<br/># or<br/>$ touch myscript</span></pre><p id="2922" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后添加以下内容:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="3000" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要使文件可执行。在终端中:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="a5bc" class="my lx iu mu b gz mz na l nb nc">$ chmod 755 myscript</span></pre><p id="4089" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您已经在终端配置文件(<code class="fe np nq nr mu b">~/.bashrc</code>或<code class="fe np nq nr mu b">~/.zshrc</code>)中添加了<code class="fe np nq nr mu b">bin</code>目录，那么您可以像下面这样运行它:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="275c" class="my lx iu mu b gz mz na l nb nc">$ myscript<br/>Welcome to Shell Scripting.</span></pre><h2 id="4537" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">射棒</strong></h2><p id="73d8" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">脚本开头的<code class="fe np nq nr mu b">#!</code>语法表示在UNIX/Linux操作系统下执行的解释器。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="3021" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/>echo "I use the newest bash interpreter."<br/>---<br/>#!/bin/csh<br/>echo "use csh interpreter."<br/>---<br/>#!/bin/ksh<br/>echo "use ksh interpreter."<br/>---<br/>#!/bin/zsh<br/>echo "use zsh interpreter."</span></pre><p id="7be7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用<code class="fe np nq nr mu b">which -a bash</code>的一个输出。如果您的Bash不在<code class="fe np nq nr mu b">/bin</code>目录中，您也可以使用<code class="fe np nq nr mu b">#!/usr/bin/env bash</code>。</p><h2 id="16fc" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">评论</strong></h2><p id="0503" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">使用<code class="fe np nq nr mu b">#</code>注释掉一行。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1f67" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/># This is a bash comment.<br/>echo "Hi"</span></pre><h1 id="e1fc" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">变量</h1><p id="22bc" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Bash变量是区分大小写的，用大写字母命名是一种惯例。但是您可以自由使用小写名称或混合大小写。变量名只能包含字母(<code class="fe np nq nr mu b">a-z</code>或A-Z)；数字(<code class="fe np nq nr mu b">0-9</code>)；或者以字母开头的下划线字符(<code class="fe np nq nr mu b">_</code>)。不要以数字开头，并且在<code class="fe np nq nr mu b">=</code>符号前后没有空格。</p><p id="3e17" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">请注意，一些网站建议使用全小写的变量名，因为系统变量名通常都是大写的。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="9a6c" class="my lx iu mu b gz mz na l nb nc"># valid<br/>FIRSTLETTERS="ABC"<br/>FIRST_THREE_LETTERS="ABC"<br/>firstThreeLetters="ABC"<br/>MY_SHELL="bash"<br/>my_another_shell="my another shell"<br/>My_Shell="My shell"</span><span id="db83" class="my lx iu mu b gz nd na l nb nc"># Invalid<br/>3LETTERS="ABC"<br/>first-three-letters="ABC"<br/>first@Thtree@Letters="ABC"<br/>ABC = "ABC "<br/>MY_SHELL = "bash"<br/>My-SHELL="bash"<br/>1MY_SHELL="My shell"</span></pre><p id="d629" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当在变量前/后使用字母时，使用<code class="fe np nq nr mu b">{}</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h2 id="5a38" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">变量赋值</strong></h2><p id="c82e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">除了<code class="fe np nq nr mu b">$</code>、<code class="fe np nq nr mu b">`</code>和<code class="fe np nq nr mu b">\</code>之外，双引号保留引号内的文字值。美元符号和反斜杠在双引号中保持其特殊含义，反斜杠<code class="fe np nq nr mu b">\</code>是转义字符。</p><p id="0362" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">单引号保留引号内的文字值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h2 id="1b60" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">环境变量</strong></h2><p id="9b91" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Linux环境变量将信息存储在系统中。全局变量也称为环境变量。</p><p id="20cd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在终端中找到一些环境变量:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="9edb" class="my lx iu mu b gz mz na l nb nc">$ env<br/># or<br/>$ printenv</span></pre><p id="d91b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在脚本中使用这些变量:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="30d3" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/>echo $SHELL, $USER, $HOME </span><span id="cc1a" class="my lx iu mu b gz nd na l nb nc"># /bin/zsh, shinokada, /Users/shinokada</span></pre><h2 id="3f49" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">内部变量</strong></h2><p id="bd3d" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">有Bourne shell保留变量、Bash保留变量和特殊Bash变量。[1]</p><h2 id="8cef" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">将命令输出分配给变量</strong></h2><p id="774f" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以使用<code class="fe np nq nr mu b">$(command)</code>将命令输出存储在一个变量中。例如，您可以输出<code class="fe np nq nr mu b">ls -l</code>:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="df2b" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/># file name ex1<br/>LIST=$(ls -l)<br/>echo "File information: $LIST"</span></pre><p id="a286" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在您的终端中运行它(不要忘记使文件可执行)。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="8884" class="my lx iu mu b gz mz na l nb nc">$ ex1<br/>File information total 40<br/>-rwxr-xr-x  1 shinokada  staff   272 Oct 27 08:52 ex1<br/>-rwxr-xr-x  1 shinokada  staff     0 Oct 26 14:14 ex2<br/>...</span></pre><p id="1749" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面将把时间和日期、用户名和系统正常运行时间保存到日志文件中。<code class="fe np nq nr mu b">&gt;</code>是重定向之一，它会覆盖一个文件。您可以使用<code class="fe np nq nr mu b">&gt;&gt;</code>将输出附加到文件中。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="b869" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="2736" class="my lx iu mu b gz nd na l nb nc">DATE=$(date -u) # date and time, -u option gives the UTC<br/>WHO=$(whoami) # user name<br/>UPTIME=$(uptime) # shows how long the system has been running<br/>echo "Today is $DATE. You are $WHO. Uptime info: $UPTIME" &gt; logfile</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nv"><img src="../Images/d8cad45b9a89607b9b6c9d328fbaf70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3dgqwX-rGFj28bz_y8PpQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">以上脚本的输出。图片由作者提供。</p></figure><h2 id="18b6" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">内置命令</strong></h2><p id="e40c" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Shell内置命令是可以在shell中运行的命令。您可以找到内置命令:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="bf2d" class="my lx iu mu b gz mz na l nb nc">$ compgen -b | sort<br/>-<br/>.<br/>:<br/>[<br/>alias<br/>autoload<br/>bg<br/>bindkey<br/>break<br/>...</span></pre><p id="f9f7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用<code class="fe np nq nr mu b">type</code>来查找命令的种类:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1805" class="my lx iu mu b gz mz na l nb nc">$ type cd<br/>cd is a shell builtin</span></pre><p id="ae31" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">which</code>命令返回文件路径名。它只对可执行程序有效:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="de03" class="my lx iu mu b gz mz na l nb nc">$ which ls<br/>/usr/bin/ls</span></pre><p id="e718" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当您将<code class="fe np nq nr mu b">which</code>命令用于替代实际可执行程序的一些内置或别名时，它要么不响应，要么返回一条错误消息:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="be2b" class="my lx iu mu b gz mz na l nb nc"># no response<br/>$ which cd<br/>$ which umask<br/>$ which alert</span></pre><p id="6096" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以通过<code class="fe np nq nr mu b">man builtin</code>找到更多关于<code class="fe np nq nr mu b">builtin</code>的细节:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="a301" class="my lx iu mu b gz mz na l nb nc">$ man builtin<br/>BUILTIN(1)  BSD General Commands Manual</span><span id="fa8c" class="my lx iu mu b gz nd na l nb nc">NAME<br/>     builtin, !, %, ., :, @, {, }, alias, alloc, bg, bind, bindkey,<br/>     break, breaksw, builtins, case, cd, chdir, command, complete, <br/>     continue, default, dirs, do, done, echo, echotc, elif, else, end, <br/>     ....</span></pre><h1 id="a6ca" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">试验</h1><p id="6037" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">test命令执行各种检查和比较，您可以将它与<code class="fe np nq nr mu b">if</code>语句一起使用。</p><h2 id="d663" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak"> if语句</strong></h2><p id="dc65" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated"><code class="fe np nq nr mu b">then</code>关键字跟在<code class="fe np nq nr mu b">if</code>语句之后:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="766e" class="my lx iu mu b gz mz na l nb nc">if [ condition-for-test ]<br/>then<br/>  command<br/>  ...<br/>fi</span></pre><p id="ce64" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在一行中使用<code class="fe np nq nr mu b">if</code>和<code class="fe np nq nr mu b">then</code>，使用<code class="fe np nq nr mu b">;</code>终止<code class="fe np nq nr mu b">if</code>语句:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="3935" class="my lx iu mu b gz mz na l nb nc">if [ condition-for-test ]; then<br/>  command<br/>  ...<br/>fi</span></pre><p id="bbd3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">(后面会有更多关于<code class="fe np nq nr mu b">if</code>的说法。)</p><p id="c2ff" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通常，当变量是一个单词时，比较使用双引号和单引号:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="c6a9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">单引号在某些情况下不起作用:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="8ecf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果没有双引号，可能会有问题:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="5ba3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在第一个测试中，有四个参数:来自<code class="fe np nq nr mu b">$VAR1</code>的两个参数，其中有<code class="fe np nq nr mu b">"my"</code>和<code class="fe np nq nr mu b">"var"</code>，然后是<code class="fe np nq nr mu b">=</code>和<code class="fe np nq nr mu b">"my var"</code>。</p><p id="695d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">简而言之，总是使用双引号。</p><h2 id="253a" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated">空间很重要</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nw"><img src="../Images/854d93eda33934a23bdd743a7a8e98a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H0-H3cNWMSdm77WY"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">太空照片由<a class="ae kz" href="https://unsplash.com/@jeremythomasphoto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰瑞米·托马斯</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="ad47" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果在<code class="fe np nq nr mu b">=</code>符号前后没有空格，则表达式被视为一个单词，然后被视为<code class="fe np nq nr mu b">true</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="0d1f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">记住在<code class="fe np nq nr mu b">[</code>和变量名以及等式操作符、<code class="fe np nq nr mu b">=</code>或<code class="fe np nq nr mu b">==</code>之间必须有一个空格。如果您遗漏了这里的任何空格，您可能会看到类似<code class="fe np nq nr mu b">‘unary operator expected’ or missing `]’</code>的错误。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="9cd1" class="my lx iu mu b gz mz na l nb nc"># correct, a space before and after = sign<br/>if [ $VAR2 = 1 ]; then<br/>    echo "\$VAR2 is 1."<br/>else<br/>    echo "It's not 1."<br/>fi</span><span id="4baa" class="my lx iu mu b gz nd na l nb nc"># wrong, no space before and after = sign<br/>if [ $VAR2=1 ]; then<br/>    echo "$VAR2 is 1."<br/>else<br/>    echo "It's not 1."<br/>fi</span></pre><h2 id="e615" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">测试文件表达式</strong></h2><p id="9eac" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">下表显示了测试文件的表达式。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="84e2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以通过使用<code class="fe np nq nr mu b">man test</code>找到所有的选项。</p><p id="26ac" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当表达式为<code class="fe np nq nr mu b">true</code>时，测试命令返回退出状态<code class="fe np nq nr mu b">0</code>，当表达式为<code class="fe np nq nr mu b">false</code>时，返回状态<code class="fe np nq nr mu b">1</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h2 id="46bc" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">测试字符串表达式</strong></h2><p id="a06b" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">下表显示了测试字符串的表达式。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="422f" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="0667" class="my lx iu mu b gz nd na l nb nc">STRING=""</span><span id="e320" class="my lx iu mu b gz nd na l nb nc">if [ -z "$STRING" ]; then<br/>  echo "There is no string." &gt;&amp;2 <br/>  exit 1<br/>fi</span><span id="2825" class="my lx iu mu b gz nd na l nb nc"># Output<br/># There is no string.</span></pre><p id="bdc7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">&gt;&amp;2</code>将错误消息重定向至标准错误:请读取<code class="fe np nq nr mu b">exit 1</code>的退出状态。</p><h2 id="89ad" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">测试整数表达式</strong></h2><p id="4bed" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">下表显示了测试整数的表达式。对于符合POSIX的使用表达式的左边，对于Bash使用右边。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><h2 id="f609" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">双括号</strong></h2><p id="83ba" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以使用双括号<code class="fe np nq nr mu b">((... ))</code>进行算术展开和求值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h1 id="33be" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用if/else和if/elif/else语句</h1><p id="e22f" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">以下是<code class="fe np nq nr mu b">if...else</code>和<code class="fe np nq nr mu b">if...elif...else</code>语句的示例。</p><p id="3873" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">if/else</code>语句的结构如下:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="d3a9" class="my lx iu mu b gz mz na l nb nc">if [ condition-is-true ]<br/>then<br/>  command A<br/>else<br/>  command B<br/>fi<br/># or<br/>if [ condition-is-true ]; then<br/>  command A<br/>else<br/>  command B<br/>fi</span></pre><p id="a0ad" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><p id="9c04" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">if/elif/else</code>语句的结构如下:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1905" class="my lx iu mu b gz mz na l nb nc">if [ condition-is-true ]<br/>then<br/>  command A<br/>elif [ condition-is-true ]<br/>then<br/>  command B<br/>else<br/>  command C<br/>fi<br/># or<br/>if [ condition-is-true ]; then<br/>  command A<br/>elif [ condition-is-true ]; then<br/>  command B<br/>else<br/>  command C<br/>fi</span></pre><p id="1195" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h1 id="b994" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">双括号</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nx"><img src="../Images/ffe177c188bc30e79ddff2b68fd658eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c9pM5bYQhxoZV06g"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">双彩虹。由<a class="ae kz" href="https://unsplash.com/@dbmartin00?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大卫·布鲁克·马丁</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="bcb5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果变量是一个单词，双括号条件复合命令<code class="fe np nq nr mu b">[[ condition-for-test ]]</code>不需要双引号；但是一个方括号<code class="fe np nq nr mu b">[ condition-for-test ]</code>需要一个变量的双引号。但是使用双引号是一个很好的习惯。</p><p id="6104" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">与单支架相比，双支架具有额外的功能。对于正则表达式，可以使用逻辑<code class="fe np nq nr mu b">&amp;&amp;</code>和<code class="fe np nq nr mu b">||</code>和<code class="fe np nq nr mu b">=~</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在网上试试这个。</p></figure><h1 id="98d4" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用for循环</h1><p id="5115" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated"><code class="fe np nq nr mu b">for</code>循环用于对序列进行迭代，其结构如下:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="628d" class="my lx iu mu b gz mz na l nb nc">for VARIABLE_NAME in ITEM_1 ITEM_N<br/>do<br/>  command A<br/>done</span></pre><p id="b30b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><p id="992a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以按如下方式使用变量:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><h2 id="2e94" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">使用</strong> <code class="fe np nq nr mu b"><strong class="ak">for</strong></code> <strong class="ak">循环重命名文件</strong></h2><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="5e8a" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="5923" class="my lx iu mu b gz nd na l nb nc">IMGS=$(ls *png)<br/>DATE=$(date +%F)</span><span id="7168" class="my lx iu mu b gz nd na l nb nc">for IMGin $IMGS<br/>do<br/>  echo "Renaming ${IMG} to ${DATE}-${IMG}"<br/>  mv ${IMG} ${DATE}-${IMG}<br/>done</span></pre><p id="bbe1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">+%F</code>中的<code class="fe np nq nr mu b">+</code>符号表示用户自定义的格式，<code class="fe np nq nr mu b">%F</code>表示完整的日期。关于<code class="fe np nq nr mu b">date</code>的更多细节，请使用<code class="fe np nq nr mu b">man date</code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/c7ddcca6573048266d1b4a9c13f47280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJuslw53FN20wo4KC9qxxA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">以循环为例。图片由作者提供。</p></figure><h1 id="199f" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用P <strong class="ak">参数</strong></h1><p id="4834" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Bash脚本可以接受多个参数，如下所示:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="4277" class="my lx iu mu b gz mz na l nb nc">$ scriptname param1 param2 param3</span></pre><p id="258b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">param1</code>至<code class="fe np nq nr mu b">param3</code>称为<em class="nz">位置参数。</em>可以用<code class="fe np nq nr mu b">$0</code>、<code class="fe np nq nr mu b">$1</code>、<code class="fe np nq nr mu b">$2</code>等。(经常我们用<code class="fe np nq nr mu b">${1}</code>、<code class="fe np nq nr mu b">${2}</code>等)输出参数。例如:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="ec35" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="416e" class="my lx iu mu b gz nd na l nb nc">echo "'\$0' is $0"<br/>echo "'\$1' is $1"<br/>echo "'\$2' is $2"<br/>echo "'\$3' is $3"</span></pre><p id="c77e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">产出:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="e0d0" class="my lx iu mu b gz mz na l nb nc">$ ex1 param1 param2 param3<br/>'$0' is /Users/shinokada/bin/ex1<br/>'$1' is param1<br/>'$2' is param2<br/>'$3' is param3</span></pre><p id="70db" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">$0</code>输出文件名，包括路径。</p><p id="d981" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要访问所有参数，您可以使用<code class="fe np nq nr mu b">$@</code>。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="3596" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="6eb6" class="my lx iu mu b gz nd na l nb nc">for PET in $@<br/>do<br/>  echo "My pet is: $PET"<br/>done</span></pre><p id="35ca" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用此脚本:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="371d" class="my lx iu mu b gz mz na l nb nc">$ ex1 cat dog gorilla<br/>My pet is: cat<br/>My pet is: dog<br/>My pet is: gorilla</span></pre><h1 id="eff3" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何接受用户输入</h1><p id="0bdd" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">用户输入被称为<em class="nz">标准输入。</em>你可以使用带有<code class="fe np nq nr mu b">-p</code>(提示)选项的<code class="fe np nq nr mu b">read</code>命令来读取用户输入。它将输出提示字符串。<code class="fe np nq nr mu b">-r</code>选项不允许反斜杠转义任何字符。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="741f" class="my lx iu mu b gz mz na l nb nc">read -rp "PROMPT" VARIABLE</span></pre><p id="bc69" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="9dd8" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="e13b" class="my lx iu mu b gz nd na l nb nc">read -rp "Enter your programming languages: " PROGRAMMES</span><span id="567b" class="my lx iu mu b gz nd na l nb nc">echo "Your programming languages are: "<br/>for PROGRAMME in $PROGRAMMES; do<br/>    echo "$PROGRAMME "<br/>done</span></pre><p id="b25c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">运行脚本:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="aadb" class="my lx iu mu b gz mz na l nb nc">$ ex1                     <br/>Enter your programming languages: python js rust <br/>Your programming languages are: <br/>python <br/>js <br/>rust</span></pre><h1 id="401b" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">使用范围进行大括号扩展</h1><p id="a1dc" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">使用范围的大括号展开是一个序列表达式。您可以将它用于整数和字符。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="fbeb" class="my lx iu mu b gz mz na l nb nc">$ echo {0..3}<br/>$ echo {a..d}<br/># output: <br/># 0 1 2 3<br/># a b c d</span></pre><p id="62d5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在<code class="fe np nq nr mu b">for</code>循环中使用这种括号扩展:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1837" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="b236" class="my lx iu mu b gz nd na l nb nc">for i in {0..9}; <br/>do <br/>  touch file_"$i".txt; <br/>done</span></pre><p id="8f9e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这将创建具有不同修改时间的不同文件名。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="7876" class="my lx iu mu b gz mz na l nb nc">$ ls -al<br/>-rw-r--r--    1 shinokada  staff      0 Jan 27 08:25 file_0.txt<br/>-rw-r--r--    1 shinokada  staff      0 Jan 27 08:25 file_1.txt<br/>-rw-r--r--    1 shinokada  staff      0 Jan 27 08:25 file_2.txt<br/>-rw-r--r--    1 shinokada  staff      0 Jan 27 08:25 file_3.txt<br/>-rw-r--r--    1 shinokada  staff      0 Jan 27 08:25 file_4.txt<br/>...</span></pre><h1 id="3492" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何使用While循环</h1><p id="c74a" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">当表达式为<code class="fe np nq nr mu b">true</code>时，<code class="fe np nq nr mu b">while</code>循环继续执行代码行。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="98b6" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="e702" class="my lx iu mu b gz nd na l nb nc">i=1<br/>while [ $i -le 5 ]; do<br/>  echo $i<br/>  ((i++))<br/>done</span></pre><p id="4e6f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="2f49" class="my lx iu mu b gz mz na l nb nc">1<br/>2<br/>3<br/>4<br/>5</span></pre><h1 id="5a36" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">什么是退出状态/返回代码？</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/6c7877520fab5758cc8e2f1825f9d029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DepelRj_vndTxyox"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@tar1k?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">塔里克·黑格</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a1eb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">每个命令返回一个范围从0-255的退出状态。<code class="fe np nq nr mu b">0</code>代表成功，除了<code class="fe np nq nr mu b">0</code>之外的任何东西都代表错误。我们可以用这个来检查错误。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">找到更多退出代码。</p></figure><h2 id="9fb4" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">检查退出状态</strong></h2><p id="8669" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated"><code class="fe np nq nr mu b">$?</code>包含之前执行的命令的返回代码:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="d568" class="my lx iu mu b gz mz na l nb nc">$ ls ./no/exist<br/>ls: cannot access './no/exist': No such file or directory<br/>$ echo "$?"<br/>2</span></pre><p id="131f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们在<code class="fe np nq nr mu b">if</code>语句中使用退出代码:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在if语句中使用退出代码。在线试试这个Bash脚本。</p></figure><p id="30d9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">-c 1</code>发送一个请求包后停止。这里我们检查退出状态是否等于<code class="fe np nq nr mu b">0</code>。</p><p id="4ed5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">输出:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="3fc2" class="my lx iu mu b gz mz na l nb nc">$ ex1<br/>PING google.com (216.58.197.206): 56 data bytes<br/>64 bytes from 216.58.197.206: icmp_seq=0 ttl=114 time=11.045 ms</span><span id="8626" class="my lx iu mu b gz nd na l nb nc">--- google.com ping statistics ---<br/>1 packets transmitted, 1 packets received, 0.0% packet loss<br/>round-trip min/avg/max/stddev = 11.045/11.045/11.045/0.000 ms<br/><strong class="mu iv">google.com reachable.</strong></span></pre><h1 id="7d76" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">如何连接命令</h1><h2 id="0006" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated">逻辑运算符和命令退出状态</h2><p id="6354" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">一个命令输出一个退出状态，我们可以用<code class="fe np nq nr mu b">&amp;&amp;</code>和<code class="fe np nq nr mu b">||</code>来决定下一步的动作。</p><h2 id="c933" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated">退出命令</h2><p id="eeaa" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以使用<code class="fe np nq nr mu b">exit</code>明确定义返回代码。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1b5d" class="my lx iu mu b gz mz na l nb nc">exit 0<br/>exit 1<br/>exit 2<br/>etc.</span></pre><p id="a7fa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">示例:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="aac0" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="b80b" class="my lx iu mu b gz nd na l nb nc">HOST="google.com"<br/>ping -c 1 $HOST  <br/>if [ "$?"" -ne "0" ]<br/>then<br/>  echo "$HOST unreachable."<br/>  exit 1<br/>fi<br/>exit 0</span></pre><p id="514d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为该脚本显式返回退出状态代码，所以您可以调用另一个shell脚本或命令。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="fcfa" class="my lx iu mu b gz mz na l nb nc">$ ex1 &amp;&amp; ls          <br/>...<br/>2020-10-03-image-1.png  ex1     myscript1<br/>2020-10-03-image-2.png  ifstatement  <br/>2020-10-03-image-3.png  logfile</span></pre><h2 id="173c" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">逻辑与(&amp; &amp; ) </strong></h2><p id="bd07" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">如果第一个命令返回<code class="fe np nq nr mu b">0</code>状态码，则第二个命令运行，这意味着它成功了。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="8b25" class="my lx iu mu b gz mz na l nb nc">mkdir /tmp/bak &amp;&amp; cp test.txt /tmp/bak</span></pre><h2 id="977b" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">逻辑或(||) </strong></h2><p id="1f27" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">如果第一个命令返回非<code class="fe np nq nr mu b">0</code>状态代码，则第二个命令运行，这意味着它失败了。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="ec12" class="my lx iu mu b gz mz na l nb nc">cp test.txt /tmp/bak/ || cp test.test.txt /tmp</span></pre><p id="cbe5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">例题</strong></p><p id="7649" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果ping命令成功，echo语句将运行。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="6d7b" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="62ef" class="my lx iu mu b gz nd na l nb nc">host="google.com"<br/>ping -c 1 $host &amp;&amp; echo "You can reach ${host}."</span></pre><p id="62a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果ping命令失败，将运行echo语句。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="27e1" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash</span><span id="4242" class="my lx iu mu b gz nd na l nb nc">host="google.com"<br/>ping -c 1 $host || echo "You can't reach ${host}."</span></pre><h2 id="16a4" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">分号</strong></h2><p id="34e1" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">分号不是逻辑运算符，但是您可以使用它来分隔命令，以确保它们都得到执行。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="b80d" class="my lx iu mu b gz mz na l nb nc">cp text.txt /tmp/bak/ ; cp test.txt /tmp<br/># This is the same as<br/>cp text.txt /tmp/bak/  <br/>cp test.txt /tmp</span></pre><h2 id="c479" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated">烟斗|</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/b9c888a32b67415cb199cfa662bf2391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q1lDq5uREKzi9UTt"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@spacexuan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">郭锦恩</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7e00" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">|</code>两侧的命令在各自的子外壳中运行，并且同时启动。</p><p id="5b5b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第一个命令将目录更改为主目录，并列出文件和目录。</p><p id="0932" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第二个命令只打印命令执行的目录。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="c345" class="my lx iu mu b gz mz na l nb nc">$ echo "$(cd ~ &amp;&amp; ls)"<br/>$ echo "$(cd ~ | ls)"</span></pre><h1 id="ebab" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">功能</h1><p id="b47b" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在Bash脚本中，您必须在使用函数之前定义它。您可以使用或不使用<code class="fe np nq nr mu b">function</code>关键字来创建函数。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="5623" class="my lx iu mu b gz mz na l nb nc">function function-name(){}<br/># or<br/>function-name(){}</span></pre><p id="155e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当你调用一个函数时，只使用不带<code class="fe np nq nr mu b">()</code>的函数名。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线尝试这个Bash脚本。</p></figure><p id="2213" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">函数可以调用其他函数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><p id="f0a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在调用<code class="fe np nq nr mu b">hello</code>函数之前声明了<code class="fe np nq nr mu b">now</code>函数。如果在调用<code class="fe np nq nr mu b">hello</code>函数后定义<code class="fe np nq nr mu b">now</code>函数，就不行了。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="6fc0" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/># this won't work<br/>function hello(){<br/>  echo "Hello!"<br/>  now<br/>}<br/>hello<br/>function now(){<br/>  echo "It's $(date +%r)"<br/>}</span></pre><p id="d243" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">date +%r</code>以05:04:12 PM的格式输出。</p><h2 id="99c9" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated"><strong class="ak">功能参数</strong></h2><p id="f068" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">正如我们在脚本参数一节中所讨论的，<code class="fe np nq nr mu b">$0</code>不是函数名，而是脚本本身。<code class="fe np nq nr mu b">$1</code>是函数的第一个参数。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1958" class="my lx iu mu b gz mz na l nb nc">#!/bin/bash<br/>function fullname(){<br/>  echo "$0"<br/>  echo "My name is $1 $2"<br/>}<br/>fullname John Doe</span><span id="6af6" class="my lx iu mu b gz nd na l nb nc"># Output<br/># /Users/shinokada/bin/ex1<br/># My name is John Doe</span></pre><p id="8d46" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">$@</code>包含所有的参数。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><h1 id="f0b6" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">变量作用域</h1><p id="c251" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">默认情况下，变量是全局的，您必须在使用它们之前定义它们。在顶部声明所有的全局变量是一个好习惯。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><h2 id="94c5" class="my lx iu bd ly ne nf dn mc ng nh dp mg lj ni nj mi ln nk nl mk lr nm nn mm no bi translated">局部变量</h2><p id="f93e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以使用<code class="fe np nq nr mu b">local</code>关键字访问函数中的局部变量。只有函数可以有局部变量。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在线试试这个Bash脚本。</p></figure><h1 id="6ed4" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">功能退出状态</h1><p id="eb6b" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">您可以在函数中显式返回退出状态:</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="1f7a" class="my lx iu mu b gz mz na l nb nc">return 0</span></pre><p id="5743" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">隐式返回函数中执行的最后一个命令的退出状态。有效代码范围为0-255。<code class="fe np nq nr mu b">0</code>表示成功，<code class="fe np nq nr mu b">$?</code>表示退出状态。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="2505" class="my lx iu mu b gz mz na l nb nc">$ my_function<br/>$ echo $?<br/>0</span></pre><p id="eb60" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以在<code class="fe np nq nr mu b">if</code>语句中使用<code class="fe np nq nr mu b">$?</code>:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="6749" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果没有争论的话，上面的脚本默认支持<code class="fe np nq nr mu b">/etc/hosts</code>。如果你给出一个参数，它会检查它是否是一个文件。如果是一个文件，它会在<code class="fe np nq nr mu b">/tmp</code>目录下创建一个副本。</p><p id="db6f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">$$</code>是<a class="ae kz" href="https://tldp.org/LDP/abs/html/internalvariables.html" rel="noopener ugc nofollow" target="_blank">脚本本身的进程ID(PID)</a>。每次运行脚本时，PID都是不同的。因此，如果您一天不止一次运行该脚本，它将非常有用。</p><p id="9956" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">basename ${1}</code>返回参数中的文件名。比如<code class="fe np nq nr mu b">/etc/hosts</code>的<code class="fe np nq nr mu b">basename</code>就是<code class="fe np nq nr mu b">hosts</code>。</p><p id="4f2e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">date +%F</code>的一个例子就是<code class="fe np nq nr mu b">2020-10-04</code>。</p><pre class="kk kl km kn gu mt mu mv mw aw mx bi"><span id="8f81" class="my lx iu mu b gz mz na l nb nc">$ ls /tmp</span><span id="dd28" class="my lx iu mu b gz nd na l nb nc">$ ex1           <br/>Backing up /etc/hosts to /tmp/hosts.2020-10-04.77124<br/>Backup succeeded.<br/>$ ls /tmp<br/>hosts.2020-10-04.77124</span></pre><p id="b61a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">退出和返回关键字</strong></p><p id="b29b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe np nq nr mu b">return</code>将导致当前函数超出范围，而<code class="fe np nq nr mu b">exit</code>将导致脚本在被调用的地方结束。</p><h1 id="0381" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">清单</h1><ul class=""><li id="9837" class="oc od iu lc b ld mo lg mp lj oe ln of lr og lv oh oi oj ok bi translated">从一个shebang开始。</li><li id="5b0a" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">描述脚本的目的</li><li id="90fc" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">首先声明所有的全局变量</li><li id="44c1" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">在全局变量之后声明所有的函数</li><li id="be02" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">在函数中使用局部变量。</li><li id="2ffe" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">在函数之后写主体</li><li id="d330" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">在函数、<code class="fe np nq nr mu b">if</code>语句和脚本末尾使用明确的退出状态代码</li></ul><h1 id="1343" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结论</h1><p id="2ca3" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们讨论了设置、变量、测试、<code class="fe np nq nr mu b">if</code>语句、双括号、<code class="fe np nq nr mu b">for</code>循环、参数、用户输入、<code class="fe np nq nr mu b">while</code>循环、退出状态、逻辑运算符、函数和变量范围。</p><p id="a2ec" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我希望这篇文章为您学习Bash脚本的下一步打下基础。各位编码愉快。</p></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><p id="43c5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">通过</strong> <a class="ae kz" href="https://blog.codewithshin.com/membership" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">成为</strong> </a> <strong class="lc iv">会员，可以完全访问媒体上的每一个故事。</strong></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ox"><img src="../Images/0be3ee559fee844cb75615290e4a8b29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*DjTM9iFtVc2wlcWcOms7VQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://blog.codewithshin.com/subscribe" rel="noopener ugc nofollow" target="_blank">https://blog.codewithshin.com/subscribe</a></p></figure><h1 id="bd1d" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">参考</h1><ol class=""><li id="377f" class="oc od iu lc b ld mo lg mp lj oe ln of lr og lv oy oi oj ok bi translated"><a class="ae kz" href="https://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html" rel="noopener ugc nofollow" target="_blank">变量</a>，<a class="ae kz" href="https://tldp.org/LDP/abs/html/internalvariables.html" rel="noopener ugc nofollow" target="_blank">内部变量</a></li><li id="f6f5" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oy oi oj ok bi translated"><a class="ae kz" href="https://marketplace.visualstudio.com/items?itemName=timonwong.shellcheck" rel="noopener ugc nofollow" target="_blank">外壳检查</a></li><li id="8da1" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oy oi oj ok bi translated"><a class="ae kz" href="https://github.com/koalaman/shellcheck/wiki" rel="noopener ugc nofollow" target="_blank"> shellcheck wiki </a></li><li id="daeb" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oy oi oj ok bi translated"><a class="ae kz" href="https://marketplace.visualstudio.com/items?itemName=foxundermoon.shell-format" rel="noopener ugc nofollow" target="_blank">壳格式</a></li><li id="7e96" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oy oi oj ok bi translated"><a class="ae kz" href="https://wiki.bash-hackers.org/start" rel="noopener ugc nofollow" target="_blank">痛击黑客维基</a></li><li id="b6e8" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oy oi oj ok bi translated"><a class="ae kz" href="https://tldp.org/LDP/abs/html/index.html" rel="noopener ugc nofollow" target="_blank">高级Bash脚本指南</a></li></ol></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu oz"><a href="https://medium.com/better-programming/13-fantastic-learning-tools-and-resources-for-bash-scripting-51a6de98015c" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd iv gz z fq pe fs ft pf fv fx it bi translated">13个精彩的Bash脚本学习工具和资源</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">您将每天使用的替代Bash脚本工具</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn kt oz"/></div></div></a></div><div class="po pp gq gs pq oz"><a href="https://medium.com/better-programming/27-simple-bash-scripting-tips-for-beginners-d6764c977546" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd iv gz z fq pe fs ft pf fv fx it bi translated">初学者的27个简单Bash脚本技巧</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">不要害怕Bash脚本。看完这些提示会更容易</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pr l pk pl pm pi pn kt oz"/></div></div></a></div><div class="po pp gq gs pq oz"><a href="https://towardsdatascience.com/comparing-sh-bash-ksh-and-zsh-speed-82a72bbc20ed" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd iv gz z fq pe fs ft pf fv fx it bi translated">比较上海、巴什、KSH和ZSH的速度</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">获胜者去…击鼓</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">towardsdatascience.com</p></div></div><div class="pi l"><div class="ps l pk pl pm pi pn kt oz"/></div></div></a></div></div></div>    
</body>
</html>