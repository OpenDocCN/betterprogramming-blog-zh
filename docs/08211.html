<html>
<head>
<title>Understand Basic Linear Regression Concepts To Get Started With Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解基本的线性回归概念，开始机器学习</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/understand-basic-linear-regression-concepts-to-get-started-with-machine-learning-49e2c7a02c39?source=collection_archive---------17-----------------------#2021-04-06">https://betterprogramming.pub/understand-basic-linear-regression-concepts-to-get-started-with-machine-learning-49e2c7a02c39?source=collection_archive---------17-----------------------#2021-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="df6a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么叫“回归”，如何找到回归线(直觉)，如何衡量它有多好</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2831ecd787d4b81783e52fba50053c3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tTQvj8zYr0bhznxG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯·劳顿在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="a9c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候在我的机器学习之旅中后退两步，深入幕后的数学、算法和直觉了。学习PyTorch、TensorFlow等框架以及Python语言本身非常有趣。但是我意识到我总是被卡住，不得不绕回来更好地理解事情。我想缩小这个差距。</p><p id="1a51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将从写线性回归开始。各种计算和公式我就不赘述了。相反，我想把重点放在建立直觉和教授基础知识上。</p><p id="c0cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/" rel="noopener ugc nofollow" target="_blank">线性回归</a>是机器学习中使用的一种建模方法和算法，用于评估一个因变量与一个或多个自变量之间的相关性。这里有几个例子:</p><ul class=""><li id="7e9f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">年工作经验和薪水——如果你想从一个人的经验预测他的薪水，那么“薪水”就是因变量<em class="me"> y ( </em>图中的纵轴/y轴<em class="me"> ) </em>，“经验”就是自变量<em class="me"> x </em>(图中的横轴/x轴<em class="me">)。</em>可以使用其他自变量(也称为解释变量)，如“教育程度”(如学士、硕士、博士)。</li><li id="57c5" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated">人的身高和鞋码-选择您想要预测的变量，并应用与上述相同的逻辑。</li></ul><p id="c1e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它可以回答诸如值<em class="me"> y </em>为什么会变化这样的问题？为什么在某一天，它高于平均水平？目标是根据其他属性<em class="me"> x </em>(例如经验年限)预测(仅是估计)一个值y(例如薪水)。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="109e" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">为什么叫“回归”？</h1><p id="4e20" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">首先，为什么叫“回归”这个名字？我想知道，因为在许多情况下，有一种增长的趋势——一种进步。例如，人越高，他们的鞋码就越大。随着一个公司在广告上花费更多，销售额往往会增加。</p><p id="d917" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">原来“回归”这个名字是偶然产生的。</p><p id="7684" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在1886年(研究结果发表的那一年)，一位名叫弗朗西斯·高尔顿的英国优生学家(奇怪的是，他是查理斯·达尔文的堂兄弟)研究并测量了数百人相对于他们父母的身高，发现孩子们的身高总会向平均值(T3)回归，或者像弗朗西斯爵士常说的那样，向T4的平庸(T5)回归。</p><blockquote class="no np nq"><p id="32b1" class="kz la me lb b lc ld ju le lf lg jx lh nr lj lk ll ns ln lo lp nt lr ls lt lu im bi translated">“如果父母比平庸之辈高，他们的孩子往往比他们矮。如果父母比平庸之辈矮，他们的孩子往往会比他们高。”</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/474fc1f7264400ad2b405292ca96b8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXq1K8gV4X-Krk5XCVzvpA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。遗传身材的退化率。摘自<a class="ae ky" href="https://galton.org/essays/1880-1889/galton-1886-jaigi-regression-stature.pdf" rel="noopener ugc nofollow" target="_blank">人类学杂记——遗传身材回归平庸</a>。</p></figure><p id="bfe7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果用例显示了一个渐进的行为，我们可以称之为“线性进展”或类似的东西。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="be9b" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">如何求回归线</h1><p id="b59a" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated"><a class="ae ky" href="https://www.amazon.co.uk/gp/product/1119293529/ref=as_li_tl?ie=UTF8&amp;tag=wiley01-20" rel="noopener ugc nofollow" target="_blank">回归线</a>，也称为最佳拟合线，向右上方或下方穿过图表。它表示y轴的变化与x轴的变化成比例。例如，如果工作经验增加了五年，工资会有多少变化？</p><p id="1405" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要找到这条线并最终找到它的关键属性:</p><ul class=""><li id="451f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">y轴截距<strong class="lb iu"> — </strong>直线与y轴相交的点。</li><li id="10a0" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated">斜率-线变化的速率。</li></ul><p id="c7f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以遵循几个不太难的<a class="ae ky" href="https://www.youtube.com/watch?v=JvS2triCgOY" rel="noopener ugc nofollow" target="_blank">计算步骤</a>，但是我不想把重点放在它们上面。</p><p id="de94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管不实用，另一种找到回归线的方法是比较不同位置的多条线，并测量它们到每个数据点的距离(图2)。</p><p id="c8ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从最差的线开始，代表<em class="me"> y </em>和<em class="me"> x </em>之间的相关性。在y轴的平均值处交叉的平坦曲线。想象一下，在没有变量<em class="me"> x </em>的情况下，你必须估计一个<em class="me"> y </em>值。假设您想预测一个人的工资，而不知道他的工作年限或任何其他信息，更安全的估计是y轴上的平均值。</p><p id="ee41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是旋转直线，并再次测量与数据的距离。然后你旋转并再次测量。诸如此类。</p><p id="52f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个距离叫做<em class="me">剩余</em> <strong class="lb iu">。</strong>从直线上的点减去每个数据点，将其平方，然后将它们相加。这就是每行的总残差:<em class="me">(数据point₁-线)+(数据point₂-线)+(数据点n线)</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/ae335974ca702f5de9a3e8d0fea8fcbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wr6x4nfoNvQ2UrS3jSAUgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。各种线的旋转表示。图片由作者提供。</p></figure><p id="1803" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你之所以平方距离，是为了让所有的值都是正值。从线下的观测值得到的距离是负的，线上的是正的。如果不平方，双方可以互相抵消。</p><p id="eb41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，尝试和比较这样的行是不实际的。即使你这样做了，仅仅通过目测图表也不会清楚线条变化的速率(斜率)。仍然需要计算斜率。</p><p id="c0ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，意识到如何不用数学(或只用一点点)就能完成大部分工作，有助于你更好地理解基本原理。</p><h2 id="d0d2" class="nw ms it bd mt nx ny dn mx nz oa dp nb li ob oc nd lm od oe nf lq of og nh oh bi translated">求斜率和y截距后如何预测y？</h2><p id="e42a" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">您可以将斜率和y轴截距代入图3中的等式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/998b032f22ee66ec194d8e3e0588592c.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*Bu9KurEt-Ei096C9hxbA7w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3。直线的方程。图片由作者提供。</p></figure><p id="99d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你知道一个人的工作年限，想估算一下他的工资。</p><ul class=""><li id="98cb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><em class="me"> y </em> =？(工资)</li><li id="521e" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me"> x </em> = 5(经验)</li><li id="d699" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me"> m </em> = 8(斜率——线条变化的速率)</li><li id="04d5" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me"> b </em> = 2 (y轴截距——直线在y轴的交叉点)</li></ul><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="a8eb" class="nw ms it ok b gy oo op l oq or">y = 8*5 + 2<br/>y = <strong class="ok iu">42 </strong>(in thousands)</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="0905" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">线(R <strong class="ak"> </strong>)有多好？</h1><p id="da5e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">找到回归线后，您需要评估它与数据的拟合程度— <a class="ae ky" href="https://www.khanacademy.org/math/ap-statistics/bivariate-data-ap/assessing-fit-least-squares-regression/a/r-squared-intuition" rel="noopener ugc nofollow" target="_blank">它消除了多少预测误差</a>？<em class="me"> R </em>的值可以在<em class="me"> 0 </em> (0%)和<em class="me"> 1 </em> (100%)之间。</p><p id="f3b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象两个没有太多相关性的变量。例如，看电视和草生长的速度(这是我能想到的最愚蠢的例子)。数据点是随机的。分散。一个变量不依赖于另一个变量。回归线测量值将具有较低的<em class="me"> R </em>。你不能相信预测。不会很准确。</p><p id="7daf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，如果根据一个人的身高来关联和预测鞋码，数据点将更接近回归线。你甚至可以通过目测图表看到上升趋势。你会有一个高<em class="me"> R </em> <strong class="lb iu"> </strong>值<strong class="lb iu">。</strong></p><p id="f819" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要计算<em class="me"> R </em>、<strong class="lb iu">T3，你需要测量回归和均值线之间的距离。中线是它存在的最小可能线。例如，如果只有<em class="me"> y </em>变量(没有x轴)，回归线代表平均值。考虑到没有<em class="me"> x </em>，对<em class="me"> y </em>的一个好的预测总是平均值，因为你没有任何其他东西来衡量它。</strong></p><p id="f4cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当与平均值进行比较时，您想要评估额外的变量<em class="me"> x </em>是否有所不同——有<em class="me"> x </em>比没有<em class="me">好多少。</em>回归与均值的偏差称为预期/解释残差或残差平方和(SSR)。</p><p id="6eaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了与平均线比较，你还需要测量误差。误差是回归线到数据点的距离，即误差平方和(SSE)。</p><p id="8e41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<em class="me"> R </em> <strong class="lb iu"> <em class="me"> </em> </strong>等于被解释的残差(SSR)取的平方和<strong class="lb iu"> </strong> ( <em class="me"> SST=SSR + SSE </em>)的比例。这意味着<em class="me"> R = SSR/SST </em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/02f6cfcee3670e4c4d3c892aeed19c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cc_CQ0jWjwmwjbMtSEfs_g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4。r计算。<strong class="bd ot"> </strong>图片作者。</p></figure><p id="ad8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">高SSR或低SSE意味着高<em class="me">R</em><strong class="lb iu"><em class="me"/></strong>—该模型可以解释数据点和线之间的所有偏差。这个预测非常准确。</p><p id="0938" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">低SSR或高SSE意味着低<em class="me"> R </em>。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="4bed" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">自由度(DF)</h1><p id="6801" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=4otEcA3gjLk" rel="noopener ugc nofollow" target="_blank">自由度</a>是给予回归线自由变化的数据点数量，从而更准确地评估<em class="me"> y </em>和<em class="me"> x </em>之间的强度。</p><p id="e4e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设你正试图评估<em class="me"> y </em>和一个独立变量<em class="me"> x </em>之间的相关性。先说工资和工作年限。如果只有一两个数据点，强度/ <em class="me"> R </em>永远是100%。不管线的位置如何，总是有可能穿过所有的观察。没有变化的自由。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/f55d10af786e4a9e4c117a9e43bd398a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wZgDPPKynRarQBmMjzZpA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5。没有自由度。图片由作者提供。</p></figure><p id="1ad1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您添加第三个数据点时，模型获得了一定的自由度。<em class="me"> R </em>有可能小于<em class="me"> 1 </em> (100%)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/7e6c49b8b7981f77504b897aae822d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*BIUG9qe_R42P_s62F-GTdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6。一个自由度。图片由作者提供。</p></figure><p id="1a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">公式为<em class="me"> df = n-k-1 </em>。</p><ul class=""><li id="8042" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><em class="me"> n </em> =数据点/观察值的数量。</li><li id="1893" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me"> k </em> =自变量个数<em class="me"> x </em>。</li></ul><p id="2c23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于图6所示的模型，<em class="me"> DF= 1 </em>。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="5036" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="b483" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">研究和学习线性回归是机器学习领域的一个很好的起点，因为它是最简单的算法之一。当然，我并没有涵盖所有需要了解的内容，但首先这已经是足够的信息了。</p><p id="467b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我写这篇文章是为了尽可能的清晰，而不是太关注数学。它帮助我更好地理解直觉，希望它对你也一样。感谢阅读。</p></div></div>    
</body>
</html>