<html>
<head>
<title>What’s New in UIButton for iOS 15?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS 15的UIButton有什么新功能？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/whats-new-in-uibutton-for-ios-15-eba1ce9ad899?source=collection_archive---------4-----------------------#2021-06-25">https://betterprogramming.pub/whats-new-in-uibutton-for-ios-15-eba1ce9ad899?source=collection_archive---------4-----------------------#2021-06-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="c87a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">UIKit的按钮类型系统获得了更多的定制样式和一个新的配置处理器</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/6e5af6f5483b994f4ec31f1673fec9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y4jfF2RZdRSuE95S"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@drewpatrickmiller?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">德鲁·帕特里克·米勒</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="cefc" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">SwiftUI可能会再次成为WWDC 2021事件的话题，但UIKit的故事还没有结束。事实上，今天大多数SwiftUI代码库都以某种形式依赖于UIKit。可以理解的是，今年我们在UIKit框架中加入了很多有趣的东西。其中<code class="fe lw lx ly lz b">UIButton</code>的变化最为显著。</p><p id="107d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe lw lx ly lz b">UIButton</code> API从一开始就差不多一样，在过去几年里只有一些有趣的更新——比如iOS 14引入了一个新的<code class="fe lw lx ly lz b">UIAction</code>作为设置控件的目标动作的<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/goodbye-target-actions-hello-uiactions-a60e1e2052d5">替代</a>。</p><p id="64f2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着iOS 15的发布，UIKit的按钮系统无疑获得了十年来最大的更新。我们现在有了更多的样式，全新的按钮配置样式，多行文本支持，等等。</p><p id="2691" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们浏览一下主要的更新，看看如何实现它们。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="606c" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">新的配置样式</h1><p id="ddb9" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">直到去年，UIKit的按钮式系统还有点拘束。iOS开发者通常会使用默认的<code class="fe lw lx ly lz b">system</code>类型，或者自己创建自定义类型。</p><p id="7d7c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着新<a class="ae kz" href="https://developer.apple.com/documentation/uikit/uibutton/configuration?changes=_4" rel="noopener ugc nofollow" target="_blank">配置</a> API的引入，我们有了一组预定义的风格可供选择:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="63c7" class="ni mi iu lz b gz nj nk l nl nm">UIButton.Configuration.filled()<br/>UIButton.Configuration.gray()<br/>UIButton.Configuration.plain()<br/>UIButton.Configuration.tinted()</span></pre><p id="368d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里先来看一下四种配置风格:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nn"><img src="../Images/1a468ec264eebf9fbe23e1ff9cbbe6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BkmdmKCjyCxxhtIk57jBeg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者截图</p></figure><p id="fbfe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过设置<code class="fe lw lx ly lz b">UIButton</code>上的<code class="fe lw lx ly lz b">configuration</code>实例属性，可以分配上述样式。</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="2a91" class="ni mi iu lz b gz nj nk l nl nm">let button = UIButton(type: .system)<br/>button.configuration = UIButton.Configuration.filled()</span></pre></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="ecb9" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">设置形状和大小的预定义值</h1><p id="a2f3" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">新的配置API不仅增加了按钮样式，还提供了一系列其他定制选项，从标题、副标题、图像和背景外观到设置预定义的形状和大小。</p><p id="d110" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们来看看<code class="fe lw lx ly lz b">UIButton</code> iOS 15中如何配置形状和大小。</p><h2 id="3341" class="ni mi iu bd mj no np dn mn nq nr dp mr lj ns nt mt ln nu nv mv lr nw nx mx ny bi translated">形状</h2><p id="7bc3" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">我们可以直接在配置样式上设置圆角半径，如下所示:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="754d" class="ni mi iu lz b gz nj nk l nl nm">var config = UIButton.Configuration.filled()<br/>config.background.cornerRadius = 0</span></pre><p id="944a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在我们又有了一个新的<code class="fe lw lx ly lz b">UIButton.Configuration.CornerStyle</code>来设置预定义的角样式，像<code class="fe lw lx ly lz b">capsule</code>、<code class="fe lw lx ly lz b">dynamic</code>、<code class="fe lw lx ly lz b">fixed</code>、<code class="fe lw lx ly lz b">small</code>、<code class="fe lw lx ly lz b">medium</code>、<code class="fe lw lx ly lz b">large</code>:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="2d29" class="ni mi iu lz b gz nj nk l nl nm">config.cornerStyle = UIButton.Configuration.CornerStyle.capsule</span></pre><p id="a2d0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">值得注意的是，除了<code class="fe lw lx ly lz b">fixed</code>和<code class="fe lw lx ly lz b">dynamic</code>，所有其他样式都忽略了<code class="fe lw lx ly lz b">cornerRadius</code>值。例如，在下图中，我们将每个按钮的圆角半径设置为0。查看<code class="fe lw lx ly lz b">capsule</code>、<code class="fe lw lx ly lz b">large</code>、<code class="fe lw lx ly lz b">medium</code>如何用其预定义的圆角半径覆盖它。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/8db04f5b5fe544835aa550d2f7ae5b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8OEEY_dTmfGpVtXn0jmFA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><h2 id="24b0" class="ni mi iu bd mj no np dn mn nq nr dp mr lj ns nt mt ln nu nv mv lr nw nx mx ny bi translated">大小</h2><p id="b7fa" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">像转角样式一样，我们也有一系列预定义的尺寸:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="ebbd" class="ni mi iu lz b gz nj nk l nl nm">UIButton.Configuration.Size.mini<br/>UIButton.Configuration.Size.small<br/>UIButton.Configuration.Size.medium<br/>UIButton.Configuration.Size.large</span></pre><p id="1ee4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要在<code class="fe lw lx ly lz b">UIButton</code>上设置大小，调用配置实例上的<code class="fe lw lx ly lz b">buttonSize</code>属性。</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="adff" class="ni mi iu lz b gz nj nk l nl nm">config.buttonSize = .medium</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/6c88e4d7c039e6429f924bc8e5793831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTe_NyLFPbR7hs79eu5Tsw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者截图</p></figure><p id="a53d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">注:iOS 15还为<code class="fe lw lx ly lz b">UIButton</code>引入了一个新的<code class="fe lw lx ly lz b">behaviorStyle</code>属性。它让您控制按钮控件的外观和行为。可以设置为<code class="fe lw lx ly lz b">mac</code>或<code class="fe lw lx ly lz b">pad</code>或<code class="fe lw lx ly lz b">automatic</code>(默认)。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="7d8f" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">自定义文本、图像内容和外观</h1><p id="ad7d" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated"><code class="fe lw lx ly lz b">UIButton</code>还接收了十几个定制内容的增强功能。默认情况下，<code class="fe lw lx ly lz b">title</code>下会显示一个<code class="fe lw lx ly lz b">subtitle</code>属性。我们还使用配置中的<code class="fe lw lx ly lz b">image</code>属性在<code class="fe lw lx ly lz b">UIButton</code>中插入一个<code class="fe lw lx ly lz b">UIImage</code>。</p><p id="624d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面这段代码对一些按钮属性进行了样式化，以组合成一个自定义按钮:</p><pre class="kk kl km kn gu ne lz nf ng aw nh bi"><span id="0b51" class="ni mi iu lz b gz nj nk l nl nm">var config = UIButton.Configuration.filled()</span><span id="66e0" class="ni mi iu lz b gz ob nk l nl nm">config.title = "Sign In"<br/>config.image = UIImage(systemName: "applelogo")<br/>config.imagePadding = 50<br/>config.titlePadding = 5<br/>config.subtitle = "With Apple"<br/>config.titleAlignment = .trailing</span></pre><ul class=""><li id="398e" class="oc od iu lc b ld le lg lh lj oe ln of lr og lv oh oi oj ok bi translated"><code class="fe lw lx ly lz b">titleAlignment</code>属性用于相对于副标题定位标题。</li><li id="8ab5" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated"><code class="fe lw lx ly lz b">textPadding</code>用于设定<code class="fe lw lx ly lz b">title</code>和<code class="fe lw lx ly lz b">subtitle</code>之间的间距。</li><li id="119d" class="oc od iu lc b ld ol lg om lj on ln oo lr op lv oh oi oj ok bi translated">还有一个<code class="fe lw lx ly lz b">imagePlacement</code>属性来设置图像相对于标题的位置。</li></ul><p id="6c1e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了内容外观之外，新的配置系统允许我们以不同的方式定制按钮颜色。<code class="fe lw lx ly lz b">baseBackgroundColor</code>和<code class="fe lw lx ly lz b">baseForegroundColor</code>属性允许您分别设置背景和内容颜色。</p><p id="bc6a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下是两种自定义按钮配置外观:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oq"><img src="../Images/6822bc66af7d77e664ff09a802c620bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2tQf0wgvdAHr1_E6b6cvg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">右边的按钮包含背景和内容颜色属性</p></figure><p id="5d5a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">作为<code class="fe lw lx ly lz b">UIButton.Configuration</code>的一部分，我们还获得了一个新的<code class="fe lw lx ly lz b">showsActivityIndicator</code>属性。它让您显示一个不确定的进度指示器来代替按钮。这在处理点击状态变化时很有帮助——这将我们带到最后一节。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="79ad" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">按钮状态更改的配置处理程序</h1><p id="0ad0" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated">在UIKit的<code class="fe lw lx ly lz b">UIButton</code>系统中，我最喜欢的改进之一是包含了一个集中式闭包来处理按钮状态随时间的变化:<code class="fe lw lx ly lz b">configurationUpdateHandler</code>。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="or os l"/></div></figure><p id="ed53" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在我们之前的按钮配置上应用它会产生以下结果:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ot"><img src="../Images/b35c2d3f8181c50a3d29955e2e9da5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/1*YBtei4wlLvYcRGwNUqhmJA.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者截屏</p></figure><p id="78fd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要以编程方式触发<code class="fe lw lx ly lz b">configurationUpdateHandler</code>，请调用<code class="fe lw lx ly lz b">setNeedsUpdateConfiguration()</code>函数。</p><p id="b5b9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们还获得了一个<code class="fe lw lx ly lz b">imageColorTransformer</code>属性来转换按钮状态变化时的图像。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h1 id="31a5" class="mh mi iu bd mj mk ml mm mn mo mp mq mr ka ms kb mt kd mu ke mv kg mw kh mx my bi translated">结论</h1><p id="4aec" class="pw-post-body-paragraph la lb iu lc b ld mz jv lf lg na jy li lj nb ll lm ln nc lp lq lr nd lt lu lv in bi translated"><code class="fe lw lx ly lz b">UIButton</code>是UIKit系统中最古老的控制类型。很高兴看到今年它的API有了重大改进。</p><p id="5aef" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">iOS 15引入的新框架<code class="fe lw lx ly lz b"><a class="ae kz" href="https://developer.apple.com/documentation/corelocationui/cllocationbutton?changes=latest_minor" rel="noopener ugc nofollow" target="_blank">CoreLocationUI</a></code>也公开了一个标准化按钮<code class="fe lw lx ly lz b">CLLocationButton</code>，用于处理位置授权。</p><p id="9d50" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">除了UIKit，SwiftUI的按钮系统也有了类似的变化。要了解更多信息，请查看<a class="ou ov ep" href="https://medium.com/u/2300266301b3?source=post_page-----eba1ce9ad899--------------------------------" rel="noopener" target="_blank"> Mohammad Azam </a>的文章，这篇文章深入探讨了iOS 15swift ui中的<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/customizing-buttons-in-swiftui-ios-15-97a02394417c">定制按钮。</a></p></div></div>    
</body>
</html>