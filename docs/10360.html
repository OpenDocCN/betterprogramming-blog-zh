<html>
<head>
<title>Know Python Functions Better: Going Beyond 4 Special Attributes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好地了解Python函数:超越4个特殊属性</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/know-python-functions-better-going-beyond-4-special-attributes-720183078c8e?source=collection_archive---------4-----------------------#2022-01-01">https://betterprogramming.pub/know-python-functions-better-going-beyond-4-special-attributes-720183078c8e?source=collection_archive---------4-----------------------#2022-01-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c539" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对Python函数有更深的理解</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f82f82f454611543088efdc9536e63ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2u508GVnTuGcEsyH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内森·詹宁斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3d37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数是任何应用程序的潜在驱动力。他们负责处理应用程序中的数据。因此，我们应该对Python函数有一个全面的了解。</p><p id="0d1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一种面向对象的编程语言，Python函数也是对象。这意味着它有自己的属性，就像一个普通的物体一样。一组特殊的属性是内置的，它们的名称格式为:<code class="fe lv lw lx ly b">__the_attr__</code>，名称前有两个下划线，名称后有两个下划线。你可能知道有些函数有这种命名约定，比如<code class="fe lv lw lx ly b">__init__</code>和<code class="fe lv lw lx ly b">__str__</code>，这就是所谓的特殊方法。使用相同的逻辑，我们可以将这些属性称为特殊属性。</p><p id="dcba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将介绍函数的4个特殊属性，除此之外，我们将讨论这些特殊属性背后的四个关键概念。事不宜迟，让我们开始吧。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="2e76" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">1.注释:__注释_ _</h1><p id="196a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">第一个特殊属性是<code class="fe lv lw lx ly b">__annotations__</code>，它访问函数的注释。函数注释是将表达式与Python函数的各种组件相关联的一种方式。下面是一个简单的例子。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="692b" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; def example(a: "something", b: 1) -&gt; True:<br/>...     pass<br/>... <br/>&gt;&gt;&gt; example.__annotations__<br/>{'a': 'something', 'b': 1, 'return': True}</span></pre><p id="33aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，<code class="fe lv lw lx ly b">__annotations__</code>是一个<code class="fe lv lw lx ly b">dict</code>对象，它包括参数名和作为键的<code class="fe lv lw lx ly b">“return”</code>以及作为值的相关表达式。然而，上面的例子不是很有用。函数注释的一个重要用途是函数中的类型提示:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="2fb9" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; def example(a: str, b: int) -&gt; bool:<br/>...     return True<br/>... <br/>&gt;&gt;&gt; example.__annotations__<br/>{'a': &lt;class 'str'&gt;, 'b': &lt;class 'int'&gt;, 'return': &lt;class 'bool'&gt;}</span></pre><p id="f83d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三方工具，如代码分析包，可以使用所有的类型信息来检查所使用的参数是否属于正确的类型。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="63c9" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">2.文档字符串:__doc__</h1><p id="5f14" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">当我们定义一个将被公开使用的函数时，最好的做法是包含该函数的适当文档。该文档称为docstrings，它提供了有关使用该函数的必要信息。下面是一个简单的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">函数文档字符串示例</p></figure><p id="382d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在函数的docstring中，我们应该包括三个关键部分:1 .函数操作的摘要；2.参数(类型和解释)；第三。返回值(类型和解释)。如果函数引发异常，您也应该指定它。值得注意的是，函数的docstring可以通过<code class="fe lv lw lx ly b">__doc__</code>属性来访问。因为docstring是多行字符串，为了以正确的格式显示它，我们可以使用内置的<code class="fe lv lw lx ly b">print</code>函数:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="d4f9" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; print(multiplier.__doc__)<br/>Multiply two numbers to get their product.<br/>    :param num1: float, first number for multiplication<br/>    :param num2: float, second number for multiplication<br/>    :return: float, the product of the two numbers</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="fd58" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">3.默认参数:__default__</h1><p id="66f7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">当我们定义函数时，我们可以为一些参数设置默认值，这样当我们调用函数时，我们就不需要设置这些参数。以下示例显示了一个包含默认参数的函数，以及两个不同的函数调用。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="032c" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; def example(a, b=1, c="Hello!"):<br/>...     print(a, b, c)<br/>... <br/>&gt;&gt;&gt; example("Hi")<br/>Hi 1 Hello!<br/>&gt;&gt;&gt; example("Hi", 2, "Python")<br/>Hi 2 Python</span></pre><p id="3867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，当函数使用默认参数时，可以省略这些参数。您可以通过访问<code class="fe lv lw lx ly b">__default__</code>属性来检查函数的默认参数:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="36d2" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; example.__defaults__<br/>(1, 'Hello!')</span></pre><p id="3923" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们设置默认参数时，如果参数是可变的，比如一个<code class="fe lv lw lx ly b">list</code>对象，我们应该小心。这是因为默认参数是在函数定义过程中计算的。请考虑以下情况:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="80c0" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; def example(a, b=list()):<br/>...     pass<br/>... <br/>&gt;&gt;&gt; example.__defaults__<br/>([],)</span></pre><p id="7b28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你通过多次省略<code class="fe lv lw lx ly b">b</code>参数来调用函数，你使用的是同一个<code class="fe lv lw lx ly b">list</code>对象。如果您有兴趣了解关于默认可变参数的更多信息，可以参考我以前的文章:</p><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/top-5-mistakes-you-make-when-declaring-functions-in-python-b7a0747711a4"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">在Python中声明函数时最容易犯的5个错误</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">编写更好的函数</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">better编程. pub</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0019" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">4.闭包:__closure__</h1><p id="be47" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">一个重要的函数概念是闭包。闭包是由另一个函数(称为外部函数)创建并返回的内部函数，内部函数使用外部函数的变量，称为非局部变量绑定。下面展示了如何在Python中创建闭包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乘数创建者</p></figure><p id="6d6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">double_multiplier</code>和<code class="fe lv lw lx ly b">triple_multiplier</code>都是闭包，因为它们满足三个要求:</p><ol class=""><li id="bc77" class="og oh it lb b lc ld lf lg li oi lm oj lq ok lu ol om on oo bi translated">它是在外部函数(<code class="fe lv lw lx ly b">multiplier_creator</code>)中创建的内部函数(<code class="fe lv lw lx ly b">multiplier</code>)。</li><li id="198a" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">创建的内部函数<code class="fe lv lw lx ly b">multiplier</code>是外部函数<code class="fe lv lw lx ly b">multiplier_creator</code>的返回值。</li><li id="473f" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">内部函数<code class="fe lv lw lx ly b">multiplier</code>使用了一个非局部变量<code class="fe lv lw lx ly b">n</code>。</li></ol><p id="25e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于非局部变量，我们需要知道LEGB规则:局部-&gt;封闭-&gt;全局-&gt;内置，它定义了变量的查找顺序。查找包括顺序检查不同的范围，封闭范围也称为非局部范围。关于作用域和闭包，可以参考我以前的文章:</p><div class="no np gp gr nq nr"><a rel="noopener  ugc nofollow" target="_blank" href="/5-essential-aspects-of-python-closures-494a04e7b65e"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">Python闭包的5个基本方面</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">揭开闭包的神秘面纱——这个概念让许多Python初学者感到困惑</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">better编程. pub</p></div></div><div class="oa l"><div class="ou l oc od oe oa of ks nr"/></div></div></a></div><p id="dcd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这些闭包，它们有一个特殊的属性:<code class="fe lv lw lx ly b">__closure__</code>。让我们看看:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="580d" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; double_multiplier.__closure__<br/>(&lt;cell at 0x7ff6e01742e0: int object at 0x7ff6d0028110&gt;,)</span></pre><p id="62aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">__closure__</code>特殊属性是一个<code class="fe lv lw lx ly b">tuple</code>对象，它包含非局部变量的代码单元。例如，如果您检查单元格的内容，您将看到闭包的绑定非局部变量是什么:</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="e07c" class="nh mh it ly b gy ni nj l nk nl">&gt;&gt;&gt; double_multiplier.__closure__[0].cell_contents<br/>2<br/>&gt;&gt;&gt; triple_multiplier.__closure__[0].cell_contents<br/>3</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="486c" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="9127" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在本文中，我们介绍了Python函数的四个特殊属性。这些特殊属性都有相关的底层函数概念。如果你知道这些特殊属性，那就太好了。更重要的是，你要熟知这些概念。</p><p id="c052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读这篇文章。</p><pre class="kj kk kl km gt nd ly ne nf aw ng bi"><span id="a227" class="nh mh it ly b gy ni nj l nk nl">Not a Medium member yet? Support my writing by <a class="ae ky" href="https://medium.com/@yong.cui01/membership" rel="noopener">using my membership link</a> (at no extra cost for you, but a portion of your membership dues is redistributed to me by Medium as an incentive).</span></pre></div></div>    
</body>
</html>