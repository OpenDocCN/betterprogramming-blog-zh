<html>
<head>
<title>Fuel Price Prediction Using Python and “scikit-learn”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和“scikit-learn”进行燃油价格预测</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-predict-fuel-prices-609f7ec417fb?source=collection_archive---------0-----------------------#2022-08-13">https://betterprogramming.pub/how-to-predict-fuel-prices-609f7ec417fb?source=collection_archive---------0-----------------------#2022-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d9fb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">燃料价格时涨时跌(大多是上涨)。我们能预测会发生什么吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/56ab16b27d32d6068420a3e2495b0429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6tvQNkUl6L8pPMc-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">道恩·麦克唐纳在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="87f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">汽油(E10)的价格时涨时跌。能源危机极大地影响了这些价格。据称它高度依赖于石油价格，跟随石油价格的上升趋势比跟随下降趋势要快。我们将看看这种说法是否属实，以及我们能否预测未来几天的燃料价格。</p><p id="f393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，首先，我们将收集我们的数据(石油和燃料价格)。第二步是分析这两者之间是否存在(视觉上的)相关性。最后，我们将尝试构建E10价格的预测器。</p><h1 id="cf0c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取石油和燃料价格</h1><p id="7f0e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">很容易找到最近几周/几个月的当前价格和图表。找到底层的表格数据有点困难。关于油价，我在investing.com的<a class="ae ky" href="https://www.investing.com/commodities/brent-oil-historical-data" rel="noopener ugc nofollow" target="_blank">上找到了。当你在网站上有一个免费帐户时，可以下载历史数据(每天，每周，每月)。</a></p><p id="ef99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你点击上面的链接，你会看到一个关于布伦特原油期货信息的页面。布伦特原油是世界上两个主要的石油交易场所之一(另一个是WTI)。期货是一种合同，规定了石油交易的价值、价格和日期。它是当前油价的一个很好的指标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/917b29a5f92ed0ebd8261a165bbf75c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3pDrAFm44goQwc2r.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图自investing.com</p></figure><p id="91a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保点击“历史数据”选项卡。在“下载数据”按钮的右侧，您可以指定想要下载的时间段，在左侧，您可以指定想要每天、每周还是每月的数据。时光倒流30多年是有可能的。</p><p id="bdd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您指定下载周期和数据频率时，您可以下载数据并接收CSV文件中的信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/970a990b37fa9a9425f38bf4f81d7658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DeOEMUMHTRDUZ9jS.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">石油价格数据示例(作者截图)</p></figure><p id="6d75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就目前的目的而言，这种获取数据的方式很好。当需要经常检索数据时，应该自动进行检索，例如使用BeautifoulSoup4。</p><p id="ed6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我对荷兰E10的价格感兴趣，燃料价格将以欧元为单位。布伦特原油期货以美元计价。欧元对美元的汇率在分析期间会发生变化，所以我们需要一种货币。在这种情况下，我选择了欧元，需要将美元价格转换成欧元。</p><p id="e46b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">汇率也可以在investing.com上找到<a class="ae ky" href="https://www.investing.com/currencies/eur-usd-historical-data" rel="noopener ugc nofollow" target="_blank">。下载这个数据等于油价。</a></p><p id="ce4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以现在我们有两个CSV文件，一个是石油期货价格，另一个是汇率。我们将用Pandas导入这些，应用更改率并执行一些数据清理:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b821" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第4行和第5行中，两个CSV都被导入到一个panda <code class="fe mv mw mx my b">dataframe</code>中，其中欧元兑美元汇率<code class="fe mv mw mx my b">dataframe</code>的列以“<code class="fe mv mw mx my b">_USD</code>”为后缀。两个CSV都有一些相同的列名，我们需要能够区分它们。这些数据框在日期列上合并。</p><p id="0a87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第7行中，用欧元计算未来价格，在第9行中，日期的字符串表示被转换成一个<code class="fe mv mw mx my b">datetime</code>对象。在第8行中，设置了正确的区域设置，以确保正确解释月份缩写。日期列包含月份的三个字母缩写，这些缩写因地区而异。最后，第10行保留了必需的列，并给出了适用的列名。<code class="fe mv mw mx my b">Oildata </code>长相如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/2fc3a2face22946df47669922b3dd299.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/0*zkcX39t9DWJhTYSQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每日油价(作者截图)</p></figure><p id="9003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了历史油价，下一步是获得E10的价格。在荷兰，国家统计局(CBS)每天都记录汽油价格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/8e228bd5bfe4d5662a65434d2d246368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lLRQbupZIRNqOiTX.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">荷兰汽油价格(截图网站CBS)</p></figure><p id="7332" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一个下载CBS数据的python库(<code class="fe mv mw mx my b"><a class="ae ky" href="https://www.cbs.nl/en-gb/our-services/open-data/statline-as-open-data/quick-start-guide" rel="noopener ugc nofollow" target="_blank">cbsodata</a></code>)由CBS维护。下载大型表格可能需要一些时间。因为大多数表不会频繁改变，所以我开发了一个围绕<code class="fe mv mw mx my b">cbsodata</code>的包装器来引入缓存。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5251" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">方法<code class="fe mv mw mx my b">get_cbs_odata()</code>返回两个数据帧，第一个包含数据，第二个包含表和列的描述。参数<code class="fe mv mw mx my b">cache</code>决定是否使用本地缓存。第13到15行对所有包含字符串的列执行string <code class="fe mv mw mx my b">strip()</code>函数。添加这一点是因为大多数字符串列都与空格对齐，删除这些空格会使数据更易于使用。</p><p id="82f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个方法的帮助下，我们检索汽油价格，然后清理这些数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="81af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将日期转换成<code class="fe mv mw mx my b">datetime</code>对象，我们需要Duch语言环境，因为date列包含荷兰的日和月名称(“2022 woensdag 13 juli”)。我们只保留E10和柴油价格:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/256446f540a412ee665a8262bde0a653.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/0*eidrD6BkeBVmZ06y.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">荷兰汽油每日价格(作者截图)</p></figure><h1 id="180d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">组合数据</h1><p id="e933" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下一步是结合石油和汽油数据框架。在前面的步骤中，两个表都获得了一个日期为<code class="fe mv mw mx my b">datetime</code>对象的列。这使得合并表变得很容易:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2289" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第1行合并了列“<code class="fe mv mw mx my b">Date</code>”上的<code class="fe mv mw mx my b">dataframes</code>。用于合并的列由<code class="fe mv mw mx my b">on</code>参数指定。两个表中都使用了指定的名称(如果合并键在两个数据集中有不同的列名，您可以使用<code class="fe mv mw mx my b">left_on</code> en <code class="fe mv mw mx my b">right_on</code>)。默认情况下，merge函数只返回两个表中都存在的键(在本例中为日期)。通过指定<code class="fe mv mw mx my b">how=’outer’</code>,所有键都是结果的一部分，如果它只出现在两个表中的一个表中也是如此。这确保了在其中一个数据集中有一行缺失的情况下，我们得到一个最终的<code class="fe mv mw mx my b">dataframe</code>，每个数据都有一行。</p><p id="a3d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第2行重新对表进行采样，以便在第一个日期和最后一个日期之间的每一天。它只对a <code class="fe mv mw mx my b">dataframe</code>的索引起作用。缺少的日期将被添加，出现多次的日期将被合并。<code class="fe mv mw mx my b">max()</code>选择一个日期出现多次时的最大列值。在这个数据框架中，这种情况很可能不会发生，但是当我们将它重新采样为weeks时，七天将被分组为一行，并且需要一个值选择器。还有用于例如最小值和平均值的值选择器。</p><p id="3852" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在<code class="fe mv mw mx my b">interpolate()</code>函数通过在缺失值周围的可用值之间执行线性回归来填充缺失的列值(许多函数要求填充所有列)。最后，<code class="fe mv mw mx my b">rolling(7).mean()</code>通过计算7个值范围内的平均值来平滑数据。这将消除数据中的噪声。最后一行删除2020年1月1日之前的所有日期。</p><h1 id="1cbd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">旁注:德国燃料价格</h1><p id="0b23" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">本文使用荷兰的燃料价格，但也可以对其他国家进行计算。例如，德国的历史价格可在<a class="ae ky" href="https://www.finanzen.net/rohstoffe/super-benzinpreis/historisch" rel="noopener ugc nofollow" target="_blank">finanzen.net</a>网站获得。</p><h1 id="25d9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">首次分析</h1><p id="56d2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该看数据了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="cdc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">石油价格在20至130欧元之间，而E10的价格在1.50至2.50欧元之间。将这些标绘在同一个轴上会使图表变得无用，因为E10的价格将显示为一条近乎平坦的线，因为y范围是由油价决定的。引入辅助y轴解决了这个问题。</p><p id="9446" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第1行绘制了石油价格，并使用了第2行中命名的左侧y轴。第3行绘制了E10价格，重用了第一个图中的<code class="fe mv mw mx my b">matplotlib </code>轴，并在右侧添加了一个辅助y轴(参数<code class="fe mv mw mx my b">secondary_y=True</code>)。第二个轴在第4行中命名，而第5行为该图添加了一个标题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/e7d02a513bc366a415988a973010e152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nRvnYQyzkJLPepPz.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">石油和E10价格对比(图片由作者提供)</p></figure><p id="218a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从图表中我们可以看到，E10的价格大致跟随油价，但有一点延迟。与油价相比，它也更平稳一些。放大到2022年可以更好地揭示这一点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/a399cd2c03d4b700484d8afe8a5fbea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dj-Ld-8C8H0e4Ob6.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">石油和E10价格对比[2022](图片由作者提供)</p></figure><p id="f8d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">E10价格紧随3月份价格飙升之后，略有延迟。七月到八月这段时间表明，下跌时也是如此。从这两个时期来看，油价上涨导致E10价格上涨的速度似乎比油价下跌更快。增加两个延时版本的油价(7天和14天延时)证实了这一点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/925ef8c79baeb87f8338edca31e5fb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C0oe8lREPGTd9yff.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比较时移序列(图片由作者提供)</p></figure><p id="64b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当上涨时，红线似乎与橙色虚线(延迟7天的油价)对齐，当下跌时，红线似乎与绿色虚线(延迟14天的油价)对齐。这证实了汽油价格跟随油价上涨比跟随油价下跌更快的假设。</p><h1 id="e451" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">预测价格</h1><p id="4f77" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">但是现在蛋糕上的樱桃。能否预测未来一段时间E10的价格？数据可以解释为一个时间序列，可以用几个特征(油价，延迟价格)来扩展。但是用回归这样简单的模型也是可能的。要计算的值(E10价格)和提到的特性之间似乎有明显的相关性。</p><p id="b994" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是首先，是时候使用熊猫<code class="fe mv mw mx my b">dataframe</code>的<code class="fe mv mw mx my b">corr()</code>功能来看看不同特征之间的相关性了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/55e52050ae37b744b324c12a908ddc9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4Qfsf6oIolnwyn0t.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相关性分析(图片由作者提供)</p></figure><p id="ba0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们最感兴趣的是显示E10价格和其他列之间相关性的顶行。_7d和_14d列是时移列(7天和14天)。_delta列包含7天前和14天前的价格之间的价格差值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="847b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关性最高的是油价、延迟的油价和延迟的E10价格。与δ值的相关性很小。使用我们想要预测的值的延迟版本是可能的，但是减少了我们可以预测的时间段。在这种情况下，我们需要7天前的E10价格，因此我们只能预测未来7天的价格(或者我们需要使用预测值的延迟版本)。</p><h1 id="1925" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据准备</h1><p id="c565" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我们可以应用机器学习之前，我们需要准备我们的测试数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c952" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用了<code class="fe mv mw mx my b">gas_data </code>数据帧的副本。在第3行中，我们定义了将被用作特性的列名。第5行标识了目标列，即我们将尝试预测的值。数据帧的最后7个值不会添加到<code class="fe mv mw mx my b">X</code>(特征)和<code class="fe mv mw mx my b">y</code>(目标值)数据集中。这阻止了我们使用我们想要预测的值作为模型的输入。</p><h1 id="a70c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">回归</h1><p id="0cef" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><code class="fe mv mw mx my b">statsmodel</code>包包含了<a class="ae ky" href="https://en.wikipedia.org/wiki/Ordinary_least_squares" rel="noopener ugc nofollow" target="_blank">普通最小二乘</a> (OLS)回归技术的实现。OLS通过最小化误差平方和来拟合要素的线性函数。维基百科对OLS有很好的描述。</p><p id="fc95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在以下4行代码中创建了OLS模型，对其进行了训练并用于预测接下来的7个值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="039d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第2行创建了一个OLS模型，<code class="fe mv mw mx my b">fit()</code>方法训练这个模型并找到最合适的。在第4行中，模型用于预测目标值，对于7个条目，我们没有用于训练。预测值存储在名为“<code class="fe mv mw mx my b">EstLR</code>”的新列中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/f9507f25bb6028ed0aa37a070cab977c.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/0*HYjIsdGJ0YKtWvA6.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实际值和预测值(作者截图)</p></figure><p id="2fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以计算均方根误差(RMSE)来检验这个预测有多好。RMSE是<code class="fe mv mw mx my b">0.025</code>，这意味着一个非常好的预测。图形形式的实际值和期望值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/bd55647b7d271278d1a2606190bc3296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_6OxZ3wubdeKMXqv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将实际值与预测值进行比较(由作者创建)</p></figure><p id="536b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">蓝线表示实际值，虚线部分表示最近七天在培训阶段没有使用的值。绿线是预测值。绿线确实很好地跟随了蓝线。4月份的延迟下降是由于消费税的变化。这些价格是由政府降低的，而且模型无法预测，因为它只关注石油和E10的历史价格。总的来说，我对预测的质量感到惊喜。基于这个结果，当E10价格预测在未来七天下降时，我有信心推迟给我的车加油。</p><h1 id="ee35" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">支持向量机</h1><p id="7295" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">支持向量机(SVM)是一种用于分类和回归目的的监督机器学习算法。SVM的工作原理是找到一个将数据集分成两个或更多类的超平面。因此，它主要用于分类，但也适用于回归。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6b38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将SVM的估计值添加到比较图中，结果显示其表现较差，低估了E10的价格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ac7a0865d537c8a75857c9794c6a852b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WFJYgQgXHNcATl0U.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比较所有三个预测(图片由作者提供)</p></figure><h1 id="85ae" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">多层感知器</h1><p id="cf17" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后测试的算法是<a class="ae ky" href="https://en.wikipedia.org/wiki/Multilayer_perceptron" rel="noopener ugc nofollow" target="_blank">多层感知器(MLP) </a>。MLP是由多层<a class="ae ky" href="https://en.wikipedia.org/wiki/Perceptron" rel="noopener ugc nofollow" target="_blank">感知器</a>组成的神经网络。它至少有一个输入层、一个输出层和一个隐藏层。它使用监督训练和反向传播来确定模型中的所有权重。</p><p id="1cfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与前两种算法相比，实现MLP要复杂一些:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="72a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">找到正确的层数和感知器是一个反复试验的过程。在这种情况下，64个感知器的三个隐藏层似乎给出了最佳结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/2c4639b76bcd215d633f4963725a4e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LDJO6_u9z1laAFfs.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比较预测结果(图片由作者提供)</p></figure><p id="72b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，MLP的预测似乎和回归一样好。查看<a class="ae ky" href="https://scikit-learn.org/stable/modules/model_evaluation.html" rel="noopener ugc nofollow" target="_blank">误差指标</a>，我们看到LR稍微好一点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/3fdf60530758b6aa80ceb785ac56d7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OcBm5qhi1cABmJwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型的度量分数(图片由authot提供)</p></figure><p id="5e5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，查看这些模型结果，可以相对较好地预测E10的价格。使用回归或神经网络得到的预测足以用于决策。</p><p id="c6a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">包含本文所有代码的笔记本可以在我的<a class="ae ky" href="https://github.com/lmeulen/FuelPrices/" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>上找到。它还包括一组用于计算和预测的CSV文件。</p><h1 id="cc5a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">最后的话</h1><p id="01ea" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我希望你喜欢这篇文章。要获得更多灵感，请查看我的其他文章:</p><ul class=""><li id="f8f4" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated"><a class="ae ky" href="https://towardsdatascience.com/solar-panel-power-generation-analysis-7011cc078900" rel="noopener" target="_blank">太阳能电池板发电分析</a></li><li id="d12e" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://towardsdev.com/perform-a-function-on-columns-in-a-csv-file-a889ef02ca03" rel="noopener ugc nofollow" target="_blank">对CSV文件中的列执行功能</a></li><li id="b397" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://towardsdatascience.com/create-a-heatmap-from-the-logs-of-your-activity-tracker-c9fc7ace1657" rel="noopener" target="_blank">根据活动跟踪器的日志创建热图</a></li><li id="b901" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://towardsdatascience.com/parallel-web-requests-in-python-4d30cc7b8989" rel="noopener" target="_blank">使用Python的并行web请求</a></li><li id="9386" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated"><a class="ae ky" href="https://towardsdatascience.com/all-public-transport-leads-to-utrecht-not-rome-bb9674600e81" rel="noopener" target="_blank">所有公共交通工具都通向乌得勒支，而不是罗马</a></li></ul><p id="d8c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这个故事，请点击关注按钮！</p><p id="5a7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nz">免责声明:本文包含的观点和看法仅归作者所有。</em></p></div></div>    
</body>
</html>