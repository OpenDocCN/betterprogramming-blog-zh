<html>
<head>
<title>How To Validate an Excel File in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript验证Excel文件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-validate-an-excel-file-in-javascript-a10fa12c171c?source=collection_archive---------3-----------------------#2021-04-23">https://betterprogramming.pub/how-to-validate-an-excel-file-in-javascript-a10fa12c171c?source=collection_archive---------3-----------------------#2021-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="01c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">验证。xlsx和。xls文件只需几个简单的步骤</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/934ab3d09eee5afff58f79a566f8eb05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HyQ5TgAjLfVtsz4k9m8NiQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank">上的电子表格未绘制</a>。</p></figure><p id="522c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您有一个包含许多列和行的Excel文件，您需要验证它。你会怎么做？下面的文章将描述一个简单的方法来做这件事，这个方法对大文件和小文件都适用。</p><p id="1853" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要知道我们想要验证哪些Excel列，以及要应用哪种验证。在这个例子中，我将使用一个具有五行和五列的文件，但是如果它具有30，000行和100列，这个方法也同样适用。</p><p id="3512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简单起见，我将只使用几个文件来构建它:<code class="fe lv lw lx ly b">index.html</code>和<code class="fe lv lw lx ly b">script.js</code>。显然，这可以通过将不同的部分分成不同的类和文件来改进。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b879" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">Index.html</h1><p id="b281" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们首先创建一个名为<code class="fe lv lw lx ly b">index.html</code>的文件，它将成为我们应用程序的接口。它有一个按钮，按下后，我们可以选择一个文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">index.html</p></figure><ul class=""><li id="890a" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">在第10行，我们定义了一个按钮，单击它将打开一个浏览器窗口，并允许我们选择一个. xls或. xlsx文件。</li><li id="e9d0" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">Excel验证的结果将显示在div的第18行。</li><li id="848f" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">在第20行，我们导入了包含所有应用程序逻辑的脚本。</li></ul></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="7f1c" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">剧本</h1><p id="cab5" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">创建一个名为<code class="fe lv lw lx ly b">script.js</code>的文件。它将包含我们应用程序的所有逻辑。</p><h2 id="1921" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">一些掩码的定义</h2><p id="36df" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们将使用正则表达式用普通的JS定义一些掩码，我们将在后面的步骤中使用它们来创建我们的验证。</p><p id="a50e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，这很简单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">script.js 1/1</p></figure><ul class=""><li id="fdcf" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated"><code class="fe lv lw lx ly b">_isInteger</code>对象定义了一个掩码，我们稍后将使用它来验证整数。</li><li id="d628" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe lv lw lx ly b">_isDecimal</code>对象定义了一个掩码，我们稍后将使用它来验证十进制和整数。</li><li id="1e2c" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><code class="fe lv lw lx ly b">_isPhone</code>对象定义了一个掩码，我们稍后将使用它来验证国际电话号码。</li></ul><p id="91ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们定义一些验证。</p><h2 id="6eba" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">确认</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">script.js 1/2</p></figure><ul class=""><li id="4601" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">第3行的<code class="fe lv lw lx ly b">validAge</code>验证年龄列的类型是<code class="fe lv lw lx ly b">Integer</code>。</li><li id="b489" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">第17行的<code class="fe lv lw lx ly b">validPhone</code>验证年龄列的类型是<code class="fe lv lw lx ly b">Phone</code>。</li><li id="12c8" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">第31行的<code class="fe lv lw lx ly b">validScore</code>验证年龄列的类型是<code class="fe lv lw lx ly b">Decimal</code>。</li></ul><h2 id="1e71" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">验证JSON内容的方法的定义</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">script.js 1/3</p></figure><p id="e313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们将Excel转换成JSON对象，我们将遍历它的所有元素并应用相应的验证。</p><p id="9124" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发现错误的结果将存储在另一个名为<code class="fe lv lw lx ly b">Errors</code>的数组中。</p><h2 id="3cab" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">加载文件、将其转换为JSON对象并验证它的方法的定义</h2><p id="2e52" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这是应用程序负责读取文件并使用xlsx-parse-json库将其转换为JSON对象的主要方法。然后它调用负责验证其内容的<code class="fe lv lw lx ly b">validateExcel</code>方法。如果有错误或没有错误，将会显示一条带有验证结果的消息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">script.js 1/4</p></figure><h2 id="6837" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">一起</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">script.js文件</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="c264" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">Excel文件</h1><p id="58ad" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">为了测试对文件应用验证的结果，我们创建了两个。包含以下内容的xlsx文件。</p><p id="51b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个文件号包含验证错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/4ca1738b55165a7c0479c55a919f3124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQrxt_1fTuCxBEdgS88iJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">correctFile.xlsx</p></figure><p id="5a49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个文件包含几个验证错误，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/04cd0425d084be7c26b50194c40b367c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7UIqYo1Mop6xdUfG6p0QtA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">errorsFile.xlsx</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4bea" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">测试应用程序</h1><h2 id="307b" class="nt mh it bd mi nu nv dn mm nw nx dp mq li ny nz ms lm oa ob mu lq oc od mw oe bi translated">将验证应用到Excel的结果</h2><p id="ff2d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这里，Excel文件包含几个验证错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/2c853edfda5c1e2444c2ec73b763f3ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ztf-dohDPKhwz8MhgQcHkg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">处理带有验证错误的Excel的结果。</p></figure><p id="4ff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此Excel文件不包含任何验证错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9fc55a6bda273d4ef8e90b9b43c1ce28.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*YNbBN4upgywqfWaGtcLSyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">没有验证错误的Excel处理结果。</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="e3a7" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="8087" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">通常，我们不需要将事情复杂化来执行任务。在这个例子中，我展示了如何在？xlsx格式的简单方法。这是一个可以改进的解决方案，但是我们的目标是展示验证一个Excel格式的文件是多么容易。</p><p id="aa19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以尝试从<a class="ae ky" href="https://codesandbox.io/s/autumn-https-9m7vr" rel="noopener ugc nofollow" target="_blank"> CodeSandbox </a>下载代码。</p><p id="460b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oj">注意:要在沙箱中尝试应用程序，您必须禁用无限循环保护。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/ec906251c38c1b38643a97a923e9adf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQyeBTncJQOOx_H4oYfvNQ.png"/></div></div></figure></div></div>    
</body>
</html>