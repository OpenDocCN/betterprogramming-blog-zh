<html>
<head>
<title>A Practical Guide to Android App Bundle for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的Android应用捆绑实用指南</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-practical-guide-to-android-app-bundle-for-beginners-7e8d93831828?source=collection_archive---------0-----------------------#2018-08-22">https://betterprogramming.pub/a-practical-guide-to-android-app-bundle-for-beginners-7e8d93831828?source=collection_archive---------0-----------------------#2018-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9639" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索Google Play的新应用发布格式</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb8cd5886ea6d00b5a244f914881f8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ckpSD55ksSrl9qddnm-X8A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://developer.android.com/guide/app-bundle/" rel="noopener ugc nofollow" target="_blank">安卓开发者</a></p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="faff" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><a class="ae kv" href="https://developer.android.com/platform/technology/app-bundle/" rel="noopener ugc nofollow" target="_blank"> Android应用捆绑包</a>是谷歌的一种应用发布格式，支持仅在您需要时下载您应用的部分内容。比起为你的Android应用构建一个单一的、通用的APK，这是一个更好的选择，而且这一切都不需要重构你的代码！</p><p id="8553" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">Android应用捆绑包的文件扩展名为<code class="fe lu lv lw lx b">.aab</code>，是将你的apk上传到Google Play控制台的一种替代方式。</p><p id="2927" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">当用户根据用户的设备配置从谷歌Play商店安装应用程序时，会为每个用户动态生成应用程序的APK。这样，他们只下载他们需要的应用程序的资源和代码，从而减小应用程序的大小。</p><p id="115a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在本文中，我将介绍如何为您的应用程序构建一个Android应用程序包。我还将为本教程提供一个示例应用程序，以防有人想看看源代码和文件结构。它可以在这里找到:</p><div class="ly lz gp gr ma mb"><a href="https://github.com/bapspatil/AndroidAppBundleDemo" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">bapspatil/AndroidAppBundleDemo</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">这是一个演示应用程序，展示了如何在你的Android应用程序中实现Android应用程序捆绑包。</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div></div></a></div></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="b11a" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">使用Android应用捆绑包的优势</h1><ul class=""><li id="0077" class="nj nk iq la b lb nl le nm lh nn ll no lp np lt nq nr ns nt bi translated">较小的应用程序大小-较小的APK大小意味着用户以较小的下载量获得您的应用程序。</li><li id="ed73" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">不再需要多个apk—您不再需要管理多个apk。Google Play控制台为您处理apk的生成和签名。</li><li id="a812" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">动态功能模块<strong class="la ir"> </strong> —仅在用户需要时，即按需将功能加载到您的应用中。这些特性应该作为不同的<em class="nz">模块</em>出现在你的应用程序项目中。</li><li id="3015" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">即时启用(即将推出)—您的用户无需安装应用程序，即可通过链接立即运行您的应用程序<em class="nz"/>。</li></ul></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="35ab" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">入门指南</h1><p id="ec05" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">请注意，Android应用捆绑需要Android Studio 3.2或以上版本。在写这篇文章的时候，<a class="ae kv" href="https://developer.android.com/studio/preview/" rel="noopener ugc nofollow" target="_blank">最新的测试版本</a>是Android Studio 3.2 beta 5，所以对于这篇文章，我将坚持使用Android插件为<a class="ae kv" href="https://gradle.org/" rel="noopener ugc nofollow" target="_blank"> Gradle </a> 3.2.0-beta05。</p><p id="54c4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将为一个应用程序构建一个Android应用程序包，该应用程序有一个基本模块(默认的<code class="fe lu lv lw lx b">app</code>模块)，以及两个我们将动态加载的功能模块(<code class="fe lu lv lw lx b">feature1</code>和<code class="fe lu lv lw lx b">feature2</code>)。</p><p id="542d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这些将为你不想包含在你的应用基础版本中的特性编码，并希望用户仅在需要时下载。</p><p id="4195" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">下面是向用户交付的应用模块的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/727108feced7dfc06b87c92b09194048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96wkJUEKcLpuVoYYaoIung.jpeg"/></div></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="bc38" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">构建您的第一个Android应用捆绑包</h1><h2 id="8e04" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第一步</h2><p id="da88" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">修改您的<code class="fe lu lv lw lx b">app</code>的<code class="fe lu lv lw lx b">build.gradle</code>文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op kx l"/></div></figure><h2 id="bf8a" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第二步</h2><p id="78cb" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">要构建<code class="fe lu lv lw lx b">feature1</code>模块，在Android Studio中进入<em class="nz">文件&gt;新建&gt;新建模块</em>。</p><p id="670c" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">从这里选择对话框中出现的<em class="nz">动态特征模块</em>，点击<em class="nz">下一步</em>。从那里开始:</p><ul class=""><li id="0f18" class="nj nk iq la b lb lc le lf lh oq ll or lp os lt nq nr ns nt bi translated">选择<code class="fe lu lv lw lx b">app</code>模块作为<em class="nz">基础应用模块。</em></li><li id="5896" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">指定<code class="fe lu lv lw lx b">feature1</code>作为<em class="nz">模块名称。</em></li><li id="7216" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">为<code class="fe lu lv lw lx b">feature1</code>模块指定一个<em class="nz">包名</em> <strong class="la ir"> </strong>和一个<em class="nz">最低API级别</em>，然后点击<em class="nz">下一个</em>。</li></ul><p id="b58f" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在<em class="nz">配置按需选项</em> <strong class="la ir"> </strong>部分:</p><ul class=""><li id="c071" class="nj nk iq la b lb lc le lf lh oq ll or lp os lt nq nr ns nt bi translated">将<em class="nz">模块标题</em>指定为“特征1”。</li><li id="dc3b" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">勾选<em class="nz">启用按需</em> <strong class="la ir"> </strong>和<em class="nz">定影</em>的复选框。</li></ul><p id="f902" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">然后，点击<em class="nz">完成</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/21e2a9efcbe0527c7459ae70fd7c5649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SzUFowGUsLw_bxXd8YEsNA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">第二步</p></figure><p id="fad5" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在添加活动后，您的<code class="fe lu lv lw lx b">feature1</code>清单文件应该包含以下内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op kx l"/></div></figure><p id="2c34" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">并且<code class="fe lu lv lw lx b">feature1</code>的<code class="fe lu lv lw lx b">build.gradle</code>文件应该在第一行有这个，因为它是一个动态特性:</p><pre class="kg kh ki kj gt ou lx ov ow aw ox bi"><span id="8875" class="od ms iq lx b gy oy oz l pa pb">apply plugin: 'com.android.dynamic-feature'</span></pre><p id="b8fe" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">对<code class="fe lu lv lw lx b">feature2</code>重复上述步骤。</p><h2 id="c411" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第三步</h2><p id="e417" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">让我们回到您的<code class="fe lu lv lw lx b">app</code>的<code class="fe lu lv lw lx b">build.gradle</code>文件，并检查动态特性是否指定如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op kx l"/></div></figure><h2 id="4d44" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第四步</h2><p id="94d4" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">现在，转到您的<code class="fe lu lv lw lx b">feature1</code>和<code class="fe lu lv lw lx b">feature2</code>的<code class="fe lu lv lw lx b">build.gradle</code>文件，检查您的<code class="fe lu lv lw lx b">app</code>模块是否被添加为依赖项。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op kx l"/></div></figure><h2 id="619f" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第五步</h2><p id="61c1" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">让我们在<code class="fe lu lv lw lx b">app</code>模块中编写代码，以便在需要时下载<code class="fe lu lv lw lx b">feature1</code>模块。</p><p id="b073" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">将以下依赖项添加到您的<code class="fe lu lv lw lx b">app</code>的<code class="fe lu lv lw lx b">build.gradle</code>文件中:</p><pre class="kg kh ki kj gt ou lx ov ow aw ox bi"><span id="6315" class="od ms iq lx b gy oy oz l pa pb">implementation 'com.google.android.play:core:1.3.4'</span></pre><p id="cf51" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在您希望动态特性按需加载的活动/片段中，编写以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op kx l"/></div></figure><p id="db52" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">同样，在需要的地方对<code class="fe lu lv lw lx b">feature2</code>重复同样的操作。</p><h2 id="76c0" class="od ms iq bd mt oe of dn mx og oh dp nb lh oi oj nd ll ok ol nf lp om on nh oo bi translated">第六步</h2><p id="1769" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">在引擎盖下，Android Studio、Gradle和Google Play使用一种叫做<code class="fe lu lv lw lx b">bundletool</code>的工具来构建你的应用捆绑包，这也是一种命令行工具。</p><p id="467a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">要构建应用捆绑包的<em class="nz">调试版本</em>:</p><p id="7d1c" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">点击<em class="nz">构建&gt;构建捆绑包/APK&gt;构建捆绑包</em>，或者您可以在命令行中完成如下操作:</p><pre class="kg kh ki kj gt ou lx ov ow aw ox bi"><span id="c06d" class="od ms iq lx b gy oy oz l pa pb">./gradlew :base:bundleDebug</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/fcc98cd69bbae2e1ef2912fc1ef6b44e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vjVheH-uz2Ns4WR1EUW3Ew.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤6:调试Android应用捆绑包的版本</p></figure><p id="ddeb" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">该包可以在:<code class="fe lu lv lw lx b">project-name/app/build/outputs/bundle/</code>找到。</p><p id="b104" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">要构建您的应用捆绑包的<em class="nz">签名发布版本</em>以上传到您的Google Play控制台:</p><ol class=""><li id="0f81" class="nj nk iq la b lb lc le lf lh oq ll or lp os lt pc nr ns nt bi translated">点击<em class="nz">Build&gt;Generate Signed Bundle/APK</em>，然后选择<em class="nz">Android App Bundle</em><strong class="la ir"/>，点击<em class="nz"> Next </em>。</li><li id="30b8" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt pc nr ns nt bi translated">然后，从<em class="nz">模块</em>下拉列表中选择<code class="fe lu lv lw lx b">app</code>模块，这是为其构建App Bundle的基础模块。</li><li id="6eaf" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt pc nr ns nt bi translated">选择密钥库后，输入密钥的详细信息，就像通常签署APK一样。在这一步，我建议选中<em class="nz">导出加密密钥</em>复选框。您需要稍后将这个加密的密钥文件上传到Google Play控制台。完成此处的操作后，单击下一步。</li><li id="e4d3" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt pc nr ns nt bi translated">选择您的<em class="nz">目标文件夹</em>并选择<em class="nz">构建类型</em>中的<code class="fe lu lv lw lx b">release</code>和<em class="nz">风格</em>中您想要构建应用捆绑包的所有风格，然后点击<em class="nz">完成</em>。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/74d82c7c92c11c70f4be02bd0e449895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*F_QgTqatrlDKBjAfwp64wg.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤6:发布Android应用捆绑包版本</p></figure><p id="97b0" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">上传到Google Play控制台:</p><ul class=""><li id="2eba" class="nj nk iq la b lb lc le lf lh oq ll or lp os lt nq nr ns nt bi translated">确保您注册了Google Play 的<a class="ae kv" href="https://support.google.com/googleplay/android-developer/answer/7384423" rel="noopener ugc nofollow" target="_blank">应用程序签名。</a></li><li id="360b" class="nj nk iq la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">在此申请<a class="ae kv" href="https://docs.google.com/forms/d/e/1FAIpQLSdjGJg_wLO7GwiMaP23ZI8-E1GHktAzN6rdaGZTCjd1h24axw/viewform" rel="noopener ugc nofollow" target="_blank">动态特性测试程序</a>。</li></ul><p id="5426" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">一旦您被授予访问权限，您就可以将您的Android应用捆绑包发布到生产环境中了！</p><p id="2534" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">仅此而已。您已经完成了您的第一个Android应用捆绑包！</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="689c" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">结论</h1><p id="1d69" class="pw-post-body-paragraph ky kz iq la b lb nl jr ld le nm ju lg lh oa lj lk ll ob ln lo lp oc lr ls lt ij bi translated">我用来构建Android应用捆绑包的演示应用的源代码可以在这里找到:</p><div class="ly lz gp gr ma mb"><a href="https://github.com/bapspatil/AndroidAppBundleDemo" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd ir gy z fp mg fr fs mh fu fw ip bi translated">bapspatil/AndroidAppBundleDemo</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">这是一个演示应用程序，展示了如何在你的Android应用程序中实现Android应用程序捆绑包。</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>