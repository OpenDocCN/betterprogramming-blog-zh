<html>
<head>
<title>Build a TextField for Numbers in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中为数字构建一个文本字段</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-textfield-for-numbers-in-swiftui-21030b58a41?source=collection_archive---------7-----------------------#2021-01-08">https://betterprogramming.pub/build-a-textfield-for-numbers-in-swiftui-21030b58a41?source=collection_archive---------7-----------------------#2021-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="df97" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">SwiftUI没有专门用于数字的TextField，所以让我们用UIViewRepresentable来构建一个</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b59327dbf46f3b9642d7546856fea69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tUvLFwXjy-HiWp0DknLvUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片。</p></figure><p id="95d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在SwiftUI中，我们通常没有选择在<code class="fe lu lv lw lx b">TextField</code>对象中正确使用数字。例如，如果您试图在一个<code class="fe lu lv lw lx b">TextField</code>元素上使用<code class="fe lu lv lw lx b">Int</code>变量，您将在代码中看到一个错误，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ly"><img src="../Images/741f25c5e71dcf83de8f0b2b72307b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CXzqdsyEyppspiv271wsyQ.png"/></div></div></figure><p id="a323" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是为什么你必须为一个普通的<code class="fe lu lv lw lx b">TextField</code>元素使用<code class="fe lu lv lw lx b">String</code>变量。这很成问题，因为你必须转换这个值，因为你通常使用一个<code class="fe lu lv lw lx b">String</code>值而不是一个<code class="fe lu lv lw lx b">Int</code>值。幸运的是，这里有一个解决方案:<code class="fe lu lv lw lx b">UIViewRepresentable</code>。</p><p id="5e5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将向您展示如何在SwiftUI中使用数字值制作一个可用的<code class="fe lu lv lw lx b">TextField</code>。开始吧！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4045" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">入门指南</h1><p id="7e28" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh na lj lk ll nb ln lo lp nc lr ls lt im bi translated">首先，让我们创建一个名为<code class="fe lu lv lw lx b">NumberTextField</code>的Swift文件，并编写以下代码:</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="1d1a" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">struct</strong> NumberTextField&lt;V&gt;: UIViewRepresentable <strong class="lx iu">where</strong> V: Numeric <strong class="lx iu">&amp;</strong> LosslessStringConvertible {<br/>    <br/>    <strong class="lx iu">typealias</strong> UIViewType = UITextField<br/>}</span></pre><p id="51ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">UIViewRepresentable</code>希望我们使用<code class="fe lu lv lw lx b">updateUIView</code>函数，这样我们正在创建的对象可以被更新。为此，我们定义了一个名为<code class="fe lu lv lw lx b">value</code>的通用值。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="7935" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">struct</strong> NumberTextField&lt;V&gt;: UIViewRepresentable <strong class="lx iu">where</strong> V: Numeric <strong class="lx iu">&amp;</strong> LosslessStringConvertible {<br/>    <br/>    <strong class="lx iu">typealias</strong> UIViewType = UITextField<br/>    <br/>    // MARK: - Properties<br/>    <strong class="lx iu">@Binding var</strong> value: V<br/>    <br/>    // MARK: - Functions<br/>    <strong class="lx iu">func</strong> updateUIView(_ editField: UITextField, context: UIViewRepresentableContext&lt;NumberTextField&gt;) {<br/>        editField.text = String(value)<br/>    }<br/>}</span></pre><p id="1b35" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让我们的<code class="fe lu lv lw lx b">TextField</code>基于数字工作，我们将创建一个名为<code class="fe lu lv lw lx b">Coordinator</code>的对象。这样，我们就可以在<code class="fe lu lv lw lx b">TextField</code>中直接使用数字。同样，对于这个对象，我们确保<code class="fe lu lv lw lx b">TextField</code>默认为零，这样当<code class="fe lu lv lw lx b">TextField</code>中没有值时，我们的应用程序就不会出错。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="e1e4" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">struct</strong> NumberTextField&lt;V&gt;: UIViewRepresentable <strong class="lx iu">where</strong> V: Numeric <strong class="lx iu">&amp;</strong> LosslessStringConvertible {<br/>    <br/>    <strong class="lx iu">typealias</strong> UIViewType = UITextField<br/>    <br/>    // MARK: - Properties<br/><strong class="lx iu">    @Binding var</strong> value: V<br/>    <br/>    // MARK: - Functions<br/>    <strong class="lx iu">func</strong> updateUIView(_ editField: UITextField, context: UIViewRepresentableContext&lt;NumberTextField&gt;) {<br/>        editField.text = String(value)<br/>    }<br/>    <br/>    <strong class="lx iu">class</strong> Coordinator: NSObject, UITextFieldDelegate {</span><span id="d886" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Properties<br/>        <strong class="lx iu">var</strong> value: Binding&lt;V&gt;</span><span id="e777" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Life Cycle<br/>        <strong class="lx iu">init</strong>(value: Binding&lt;V&gt;) {<br/>            <strong class="lx iu">self</strong>.value = value<br/>        }</span><span id="dac3" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Functions<br/>        <strong class="lx iu">func</strong> textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -&gt; Bool {<br/>            <strong class="lx iu">let</strong> text = textField.text as NSString?<br/>            <strong class="lx iu">let</strong> newValue = text?.replacingCharacters(in: range, with: string)</span><span id="bb28" class="nh mh it lx b gy nm nj l nk nl"><strong class="lx iu">            if</strong> <strong class="lx iu">let</strong> number = V(newValue ?? "0") {<br/>                <strong class="lx iu">self</strong>.value.wrappedValue = number</span><span id="a51e" class="nh mh it lx b gy nm nj l nk nl">                <strong class="lx iu">return true</strong><br/>            } <strong class="lx iu">else</strong> {<br/>                <strong class="lx iu">if</strong> <strong class="lx iu">nil</strong> == newValue || newValue!.isEmpty {<br/>                    <strong class="lx iu">self</strong>.value.wrappedValue = 0<br/>                }</span><span id="2c5c" class="nh mh it lx b gy nm nj l nk nl">                <strong class="lx iu">return</strong> <strong class="lx iu">false</strong><br/>            }<br/>        }</span><span id="2687" class="nh mh it lx b gy nm nj l nk nl"><strong class="lx iu">        func</strong> textFieldDidEndEditing(_ textField: UITextField, reason: UITextField.DidEndEditingReason) {<br/>            <strong class="lx iu">if</strong> reason == .committed {<br/>                textField.resignFirstResponder()<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="d592" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们使用这个<code class="fe lu lv lw lx b">Coordinator</code>对象定义<code class="fe lu lv lw lx b">makeUIView</code>和<code class="fe lu lv lw lx b">makeCoordinator</code>函数的输出。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="7afe" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">struct</strong> NumberTextField&lt;V&gt;: UIViewRepresentable <strong class="lx iu">where</strong> V: Numeric <strong class="lx iu">&amp; </strong>LosslessStringConvertible {<br/>    <br/>    <strong class="lx iu">typealias</strong> UIViewType = UITextField<br/>    <br/>    // MARK: - Properties<br/>    <strong class="lx iu">@Binding var</strong> value: V<br/>    <br/>    // MARK: - Functions<br/>    <strong class="lx iu">func</strong> updateUIView(_ editField: UITextField, context: UIViewRepresentableContext&lt;NumberTextField&gt;) {<br/>        editField.text = String(value)<br/>    }<br/>    <br/>    <strong class="lx iu">func</strong> makeUIView(context: UIViewRepresentableContext&lt;NumberTextField&gt;) -&gt; UITextField {<br/>        <strong class="lx iu">let</strong> editField = UITextField()<br/>        editField.delegate = context.coordinator<br/>        editField.keyboardType = .numberPad</span><span id="0f23" class="nh mh it lx b gy nm nj l nk nl">        <strong class="lx iu">return</strong> editField<br/>    }<br/>    <br/>    <strong class="lx iu">func</strong> makeCoordinator() -&gt; NumberTextField.Coordinator {<br/>        Coordinator(value: $value)<br/>    }<br/>    <br/>    <strong class="lx iu">class</strong> Coordinator: NSObject, UITextFieldDelegate {</span><span id="b22a" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Properties<br/>        <strong class="lx iu">var</strong> value: Binding&lt;V&gt;</span><span id="fcf2" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Life Cycle<br/>        <strong class="lx iu">init</strong>(value: Binding&lt;V&gt;) {<br/>            <strong class="lx iu">self</strong>.value = value<br/>        }</span><span id="b11f" class="nh mh it lx b gy nm nj l nk nl">        // MARK: - Functions<br/>        <strong class="lx iu">func</strong> textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -&gt; Bool {<br/>            <strong class="lx iu">let</strong> text = textField.text as NSString?<br/>            <strong class="lx iu">let</strong> newValue = text?.replacingCharacters(in: range, with: string)</span><span id="4844" class="nh mh it lx b gy nm nj l nk nl">            <strong class="lx iu">if let</strong> number = V(newValue ?? "0") {<br/>                <strong class="lx iu">self</strong>.value.wrappedValue = number</span><span id="4611" class="nh mh it lx b gy nm nj l nk nl">                <strong class="lx iu">return true</strong><br/>            } <strong class="lx iu">else</strong> {<br/>                <strong class="lx iu">if</strong> <strong class="lx iu">nil</strong> == newValue || newValue!.isEmpty {<br/>                    <strong class="lx iu">self</strong>.value.wrappedValue = 0<br/>                }</span><span id="d299" class="nh mh it lx b gy nm nj l nk nl">                <strong class="lx iu">return false</strong><br/>            }<br/>        }</span><span id="83f7" class="nh mh it lx b gy nm nj l nk nl">        <strong class="lx iu">func</strong> textFieldDidEndEditing(_ textField: UITextField, reason: UITextField.DidEndEditingReason) {<br/>            <strong class="lx iu">if</strong> reason == .committed {<br/>                textField.resignFirstResponder()<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="d138" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe lu lv lw lx b">NumberTextField</code>的对象已经准备好了。现在就用在一个app里吧！</p><p id="e30d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们更改一个经典SwiftUI项目中的<code class="fe lu lv lw lx b">ContentView</code>元素，如下所示。您将会看到，即使值<code class="fe lu lv lw lx b">selectedNumber</code>是一个<code class="fe lu lv lw lx b">Int</code>值，您也不会得到一个错误。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="502d" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">struct</strong> ContentView: View {<br/>    <br/>    // MARK: - Properties<br/>    <strong class="lx iu">@State var</strong> selectedNumber = 0<br/>    <br/>    // MARK: - UI Elements<br/>    <strong class="lx iu">var</strong> body: <strong class="lx iu">some</strong> View {<br/>        NavigationView {<br/>            Form {<br/>                Text("Number: \(selectedNumber)")<br/>                NumberTextField(value: $selectedNumber)<br/>            }<br/>            .navigationTitle("NumberTextField Example")<br/>        }<br/>    }<br/>}</span></pre><p id="7960" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际上，示例已经完成，但我想告诉您如何解决这个问题，因为您无法关闭单击<code class="fe lu lv lw lx b">TextField</code>后打开的键盘。我们唯一需要的是延期。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="bdda" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">extension</strong> View {<br/>    <br/>    // MARK: - Functions<br/>    <strong class="lx iu">func</strong> hideKeyboard() {<br/>       UIApplication.shared.sendAction(<strong class="lx iu">#selector</strong>(UIResponder.resignFirstResponder), to: <strong class="lx iu">nil</strong>, from: <strong class="lx iu">nil</strong>, for: <strong class="lx iu">nil</strong>)<br/>    }<br/>}</span></pre><p id="e793" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们在<code class="fe lu lv lw lx b">ContentView</code>中使用我们在<code class="fe lu lv lw lx b">View</code>扩展中编写的函数。</p><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="b44c" class="nh mh it lx b gy ni nj l nk nl">// MARK: - UI Elements<br/><strong class="lx iu">var</strong> body: <strong class="lx iu">some</strong> View {<br/>    NavigationView {<br/>        Form {<br/>            Text("Number: \(selectedNumber)")<br/>            NumberTextField(value: $selectedNumber)<br/>        }<br/>        .navigationTitle("NumberTextField Example")<br/>    }<br/>    .onTapGesture {<br/>        <strong class="lx iu">self</strong>.hideKeyboard()<br/>    }<br/>}</span></pre><p id="450a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在当你运行应用程序时，你会注意到触摸<code class="fe lu lv lw lx b">TextField</code>后出现的键盘会在你触摸屏幕的任何部分时消失。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/928ba0bd5cf1bab189bf9d5a9e3af633.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RLM9tursu5WyD3EeCe1dAg.gif"/></div></div></figure><p id="52f4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以通过下面的链接访问我们在本文中创建的项目。</p><div class="no np gp gr nq nr"><a href="https://github.com/canbalkya/TextField-for-Numbers-in-SwiftUI" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">canbalkya/TextField-for-Numbers-in-swift ui</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">这个项目是为我的文章创建的。你可以在这里看我的文章…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="7b79" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="0736" class="pw-post-body-paragraph ky kz it la b lb my ju ld le mz jx lg lh na lj lk ll nb ln lo lp nc lr ls lt im bi translated">通过用<code class="fe lu lv lw lx b">UIViewRepresentable</code>修改SwiftUI元素，可以用SwiftUI开发应用程序。本文中的例子也很好地说明了这一点。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt nd lx ne nf aw ng bi"><span id="ea3d" class="nh mh it lx b gy ni nj l nk nl"><strong class="lx iu">My Other Articles<br/></strong>-<strong class="lx iu"> </strong><a class="ae og" rel="noopener ugc nofollow" target="_blank" href="/whats-new-in-swift-5-4-88949071d538">What’s New in Swift 5.4?</a><br/>- <a class="ae og" rel="noopener ugc nofollow" target="_blank" href="/animation-in-swiftui-get-to-know-transactions-7cd57cfb299f">Animation in SwiftUI: Get to Know Transactions</a><br/>- <a class="ae og" rel="noopener ugc nofollow" target="_blank" href="/get-to-know-swiftuis-groupbox-c33ee71ff895">Get to Know SwiftUI’s GroupBox</a></span></pre><p id="b006" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想见我或有关于iOS开发等问题。你可以在这里和我<a class="ae og" href="https://superpeer.com/canbalkya" rel="noopener ugc nofollow" target="_blank">进行一对一的会谈。</a></p></div></div>    
</body>
</html>