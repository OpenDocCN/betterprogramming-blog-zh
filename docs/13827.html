<html>
<head>
<title>Engineering Apps for Reuse: A Practical Example Using Slack, MuleSoft, and Salesforce</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重用的工程应用程序:使用Slack、MuleSoft和Salesforce的实际例子</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/engineering-apps-for-reuse-a-practical-example-using-slack-mulesoft-and-salesforce-855a3116ea66?source=collection_archive---------8-----------------------#2022-09-30">https://betterprogramming.pub/engineering-apps-for-reuse-a-practical-example-using-slack-mulesoft-and-salesforce-855a3116ea66?source=collection_archive---------8-----------------------#2022-09-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f7dd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">设计、构建、部署和监控API</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0e7d86e9de6ca4562c16e0c929ad307b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUhqIyRp9WOUM0X5n_I9Dg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ASCII art .跨Slack和Salesforce重用的| image by author</p></figure><p id="97f3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本文描述了设计和构建可跨Slack和Salesforce重用的API的过程。它演示了如何在Slack中创建一个简单的斜杠命令，并在Salesforce中创建一个流来将文本转换为ASCII艺术。</p><blockquote class="lr ls lt"><p id="4845" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">重新利用现有的API来连接不同的系统是提高生产率和帮助降低组织成本的一个关键指标。</p></blockquote><h1 id="a088" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">这个想法</h1><p id="3ea9" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">假设我们的任务是在Slack中为用户创造一个交互体验。我们希望提供一个斜杠命令，允许用户指定一些文本，并让我们的应用程序将这些文本转换成ASCII艺术。</p><p id="0d27" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有三个问题我们应该思考；</p><ol class=""><li id="0afc" class="mv mw iq kx b ky kz lb lc le mx li my lm mz lq na nb nc nd bi translated">有没有我可以重用的现有编程库？</li><li id="86c6" class="mv mw iq kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">有没有我可以重用的现有API？</li><li id="7d59" class="mv mw iq kx b ky ne lb nf le ng li nh lm ni lq na nb nc nd bi translated">有多少客户想要使用这个特性？</li></ol><h1 id="d6d5" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">设计</h1><p id="7812" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">第一步是设计一个API规范，它可以将消息作为输入和输出ASCII码。</p><p id="193f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过使用MuleSoft的Anypoint平台，我不仅可以设计API规范，还可以在内部共享它，以便让其他希望为其应用程序添加类似功能的人发现它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/cc41c90b229548f16bfae84c88ebfe47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3uB0-QS6LswfiSWnh4D2VQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">任意点设计—创建API规范</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="e904" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我的下一个工作是决定是否有现有的编程库可以帮助我。</p><p id="bfea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">MuleSoft应用程序是基于Java的，作为世界上最广泛采用的编程语言之一，我发现了许多可以帮助我的Java类。</p><div class="nm nn gp gr no np"><a href="https://github.com/lalyos/jfiglet" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">GitHub—lalyos/jfiglet:fig fonts(http://www.figlet.org/)的Java实现创建ascii…</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">用Java实现FIGfonts来创建ascii艺术横幅。我的目标是:作为一个maven依赖项进行分发…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od kp np"/></div></div></a></div><p id="cca4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，松弛斜线命令期望输入和输出是松弛特定的格式。我没有将所有的逻辑封装在一个API调用中，而是将文本到ASCII的转换分解到一个可以重用的单独的API中。</p><p id="57de" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ascii-art-sapi将基于我们的api规范。设计用于重复使用。</p><p id="693d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">slack-ascii-art-xapi将为slack编排和转换消息。简而言之，它会把ASCII艺术转换成Slack里好看的东西。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/07d1e71fec6ef0f503448f8a80149616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTo6EMPYSh2tOWCehv_Lcg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建两个API来帮助我们走向成功</p></figure><p id="76a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了演示重用api的能力，我们还将使用ascii-art-sapi来创建在Salesforce中将文本转换为ascii的能力。</p><p id="cec3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这种情况下，我们将使用外部服务将API规范转换为可调用的Apex，我们可以在流中直接使用它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/3d417da67f712c841c91faa69100add4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cg9N-DCBQeEob1ww0hH-iw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">跨两种不同体验重用API</p></figure><h1 id="f19a" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">建筑</h1><h2 id="9feb" class="og lz iq bd ma oh oi dn me oj ok dp mi le ol om mk li on oo mm lm op oq mo or bi translated">ascii-art-sapi</h2><p id="28f3" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">对于构建阶段，我们使用MuleSoft的Anypoint Studio。这提供了连接器、处理器和模块，允许我用比编写代码更少的时间实现API逻辑。</p><p id="a763" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为MuleSoft编译成Java应用程序，所以我可以包含jfiglet库作为依赖项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/1db58d9d5c3eb636af5d402d032472c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4psNpoNFMurnrYMc0YFxg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将jfiglet作为依赖项包含在内</p></figure><p id="52c6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用转换消息模块允许我使用上面的Java类将输入转换成ASCII。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/e08b0d96a132d09b7ac51f34e207b516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K2jpIWQtsngAxvzHt6e3YQ.png"/></div></div></figure><p id="a4c2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我可以从依赖项中导入Java类，然后简单地使用里面的方法。在这种情况下，将给定的字符串转换为ASCII字符。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/60e9955dd2b59c84dd5ea998e1fb8da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cXHs__qiadyjqjqQ73_Jew.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">导入第三方库并调用它们的方法</p></figure><p id="c632" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在准备好部署API了。</p><h2 id="35b9" class="og lz iq bd ma oh oi dn me oj ok dp mi le ol om mk li on oo mm lm op oq mo or bi translated">slack-ascii-art-xapi</h2><p id="b89d" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">对于特定于松弛时间的逻辑，我们将构建以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/acedd1bfbcb6cb04f45d9074567e87a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CrNfmd5ZvKYNsIiJSjR8IQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">封装到新API中的特定于Slack的逻辑</p></figure><p id="1ab3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个API将从Slack slash命令接收输入，并立即将其发布到队列中进行异步处理。</p><p id="3c61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，异步侦听器将调用现有的ascii-art API，在将消息发送回Slack通道之前，将文本从slash命令转换为ascii。</p><p id="a6cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以，看起来是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/cea1a54ceb23ad1ce033a3a5a7f3eba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wGw3kjwQ4NosvGrzQ0yHSw.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斜线命令— ascii-art</p></figure><p id="dcfd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好了，现在我们有了一个正常运行的Slack slash命令。让我们看看如何将这种体验融入Salesforce。</p><p id="30f1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于我们设计了ascii-art API，我们可以使用外部服务将规范导入Salesforce。</p><p id="b519" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Salesforce中需要命名凭据来为Anypoint平台和ascii-art API提供端点和授权详细信息。</p><p id="33ea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从Salesforce导航至设置-&gt;外部服务并完成向导。在本例中，我们连接到MuleSoft Anypoint平台，以便Salesforce可以找到并创建Apex类来调用我们的ASCII art端点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/6101bf3df4ab0c850cf6721571d4df97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-yIGRfW3VgfeiFxRK_85Uw.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Salesforce中创建外部服务</p></figure><p id="16df" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们已经创建了外部服务，我们可以使用声明性工具来调用API。在这个例子中，我们将使用Flow。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/703442b3d42a9a9e1d5374595e7df246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YisCSQHkqa4hV6Mz1poXIQ.png"/></div></div></figure><p id="8877" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Flow自动包含使用我们通过外部服务导入的API所需的动作。我们为用户提供了一个屏幕来指定要转换成ASCII的文本，在上面的例子中，我们将输出保存到了<code class="fe oy oz pa pb b">Contact</code>对象的一个字段中。</p><p id="4390" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在配置结束时，您的用户体验应该如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/6b31d538ec99337d919e46bd505017bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HNe1XXte_wWbRfgswtqaEQ.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用外部服务调用API端点的Salesforce流程</p></figure><h1 id="e456" class="ly lz iq bd ma mb mc md me mf mg mh mi jw mj jx mk jz ml ka mm kc mn kd mo mp bi translated">摘要</h1><p id="05c4" class="pw-post-body-paragraph kv kw iq kx b ky mq jr la lb mr ju ld le ms lg lh li mt lk ll lm mu lo lp lq ij bi translated">设计可重用应用的关键要素之一是设计、构建、部署、管理和监控API的能力。</p><p id="8102" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">MuleSoft的Anypoint平台提供了这样的能力。将这种力量与Slack和Salesforce结合起来，你就能设计出一些很棒的体验。</p></div></div>    
</body>
</html>