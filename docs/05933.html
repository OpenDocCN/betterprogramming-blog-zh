<html>
<head>
<title>How to Combine Text Weights in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中组合文本权重</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-combine-text-weights-in-swiftui-b11a110412dc?source=collection_archive---------16-----------------------#2020-08-18">https://betterprogramming.pub/how-to-combine-text-weights-in-swiftui-b11a110412dc?source=collection_archive---------16-----------------------#2020-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9e4b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自定义SwiftUI应用程序中的文本</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0f8593b96a9601dd2ae30474eae5fcc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jXT3jKMSIc1hUN3j"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布鲁诺·马丁斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="1370" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">起初，在SwiftUI中组合多个文本权重可能看起来并不简单。如果你习惯于使用UIKit，你可能正在寻找对<code class="fe lv lw lx ly b">NSAttributedString</code>的支持，其中你可以为某些范围应用不同的文本样式。</p><p id="89d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SwiftUI使得通过内置的加号(+)操作符实现来组合不同的文本样式成为可能。多个文本视图被合并成一个，如果使用正确，可以很好地换行。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="05ca" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">你可能考虑过的方法</h1><p id="d655" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在我们深入研究对我的情况最有效的解决方案之前，我想先回顾一下论坛上经常推荐的几个解决方案，比如<a class="ae ky" href="https://stackoverflow.com/questions/59531122/how-to-use-attributed-string-in-swiftui" rel="noopener ugc nofollow" target="_blank"> Stack Overflow </a>。</p><h2 id="2429" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">h带包装的堆叠</h2><p id="bbea" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">您可以将在单个文本视图中组合多个权重视为在网格类型的视图中显示多个关键字。搜索解决方案可能会将您带到<a class="ae ky" href="https://stackoverflow.com/questions/58842453/swiftui-hstack-with-wrap" rel="noopener ugc nofollow" target="_blank">这个</a>页面，它告诉您使用与自定义对齐参考线结合的<code class="fe lv lw lx ly b">GeometryReader</code>来模拟文本换行。</p><p id="d1a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管该解决方案最终可能会成功，但是代码很复杂，并且规模调整可能并不总是如预期的那样工作。</p><h2 id="a72f" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">使用UIViewRepresentable</h2><p id="b2cc" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">最接近使用<code class="fe lv lw lx ly b">NSAttributedString</code>的解决方案是使用一个<code class="fe lv lw lx ly b">UIViewRepresentable</code>，它将一个属性化的字符串实现连接到SwiftUI。如果您正在将代码从UIKit迁移到SwiftUI，这可能是您最快的解决方案，但它感觉不太像原生SwiftUI代码。</p><h2 id="b46f" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">ForEach组合多个文本视图</h2><p id="81c7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我发现最有效的解决方案是使用一个<code class="fe lv lw lx ly b">ForEach</code>来迭代一个句子的单词，以在一个<code class="fe lv lw lx ly b">HStack</code>中组合多个<code class="fe lv lw lx ly b">Text</code>视图。</p><p id="2eb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法的缺点是，我们最终会得到不相关的单独文本视图，它们不能很好地包装在一起。视图之间互不了解，这就取消了对多行文本的支持。如果你把短句放在一行上，它可能会起作用，但是当你想增加多行文本内容的权重时，它很容易变得有限。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="f47a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在SwiftUI文本视图中添加对多个权重的支持</h1><p id="9aaf" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">组合多个权重可能有助于强调句子中的单词。在本例中，我们希望以粗体显示某些单词，结果如下:“SwiftLee —一个关于Swift、iOS和Xcode的每周博客<strong class="lb iu">提示和技巧</strong>。”</p><p id="5d75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了提高工作效率，我们需要一种方法来定义需要样式化的文本范围。我们还希望得到一个单个文本元素的结果，该元素负责将单词换行到多行上。</p><p id="5a64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a00e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，我们用星号标记了<code class="fe lv lw lx ly b">weekly blog</code>和<code class="fe lv lw lx ly b">Tips and Tricks</code>,表示这些单词应该被转换成粗体文本元素。为了做到这一点，我们使用了一个regex实现，它允许我们使用Markdown类型的样式。</p><p id="a2a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一步一步地检查代码。</p><h2 id="4935" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">创建自定义RichText视图</h2><p id="6567" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们首先创建一个名为<code class="fe lv lw lx ly b">RichText</code>的定制视图。该视图带有一个<code class="fe lv lw lx ly b">String</code>初始化器，并定义了一个<code class="fe lv lw lx ly b">Element</code>结构，我们将使用它来定义输入语句的不同元素。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">parseRichTextElements()</code>方法解析元素。这种方法使用星号分割句子，并使用粗体字粗细标记需要显示的元素:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d13c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是很多代码，但是使用行内注释通读它应该会让您对它在做什么有所了解。这篇文章的核心部分是告诉你如何从将多个<code class="fe lv lw lx ly b">Text</code>元素组合成一个元素中获益。例如，这可能是编写自己的Markdown解析文本元素的起点。</p><p id="824c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们需要为自定义视图创建一个主体，并将所有元素解析成一个<code class="fe lv lw lx ly b">Text</code>元素:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="517a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们身法的内容是最重要的部分。如果我们使用了一个<code class="fe lv lw lx ly b">ForEach</code>来代替，我们最终会得到多个独立的<code class="fe lv lw lx ly b">Text</code>元素，它们不能很好地在多行中包装在一起。</p><p id="15dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仔细看看这段代码:</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="dbf2" class="nd mh it ly b gy nv nw l nx ny">var content = text(for: elements.first!)<br/>elements.dropFirst().forEach { (element) in<br/>    content = content + self.text(for: element)<br/>}<br/>return content</span></pre><p id="cbb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先将第一个元素作为开始的<code class="fe lv lw lx ly b">Text</code>元素。我们检查元素集合并使用<code class="fe lv lw lx ly b">+</code>操作符，它基本上将现有的<code class="fe lv lw lx ly b">Text</code>视图与给定元素的新的<code class="fe lv lw lx ly b">Text</code>视图结合起来。</p><p id="d145" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们返回句子的合并版本，其中包含以粗体显示的标记单词:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/26dd93650ab3ead965bbfd165115afcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*aF7lCAGtIEyYOv0N.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建具有多个权重的SwiftUI文本视图。</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b673" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="f6e9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">SwiftUI带来了挑战，可能会吸引人们使用使用<code class="fe lv lw lx ly b">UIViewRepresentable</code>实现的定制解决方案。然而，有了正确的知识，它并不总是需要的，因为我们可以利用SwiftUI附带的高级API。将多个文本视图合并成一个视图允许我们将多个权重显示为一个合并的、包装良好的文本视图。</p><p id="b0c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div></div>    
</body>
</html>