<html>
<head>
<title>Increase Your Web Scraping Speed by 10x With This Python Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用这个Python库将您的网页抓取速度提高10倍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/faster-web-scraping-in-python-using-multithreading-496da9eaf0c2?source=collection_archive---------2-----------------------#2022-01-10">https://betterprogramming.pub/faster-web-scraping-in-python-using-multithreading-496da9eaf0c2?source=collection_archive---------2-----------------------#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="96ce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用多线程在Python中实现更快的web抓取</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9b6d4b4b43b6a6580876888be55f79d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2cc1ddWc0YMU88ukybjUg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://undraw.co/search" rel="noopener ugc nofollow" target="_blank"> Undraw </a></p></figure><p id="2377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有因为网页抓取速度太慢而烦恼过？你有很多网站要刮吗？是的，你不是一个人。</p><p id="ada4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据科学过程中，我们都需要数据集。但事情不可能进展顺利。许多数据集的格式都不清晰。在某些情况下，我们需要从互联网上提取。</p><p id="e4f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网络抓取是提取数据集的完美方式。我们可以使用编程语言自动提取数据集，而不是在电子表格上手动输入。</p><p id="937a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是有一个问题。刮削过程相当缓慢。如果我们不优化它，它可能需要几个小时到几天的时间来抓取大量的网站。那么我们能做什么呢？这篇文章将告诉你如何做。</p><p id="fe63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示如何使用多线程来提高Python中web抓取的速度。我们将使用一个名为<code class="fe lv lw lx ly b">concurrent.futures</code>的库来完成这个过程。</p><p id="423c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这种方法，我们可以根据数据集的大小将web抓取过程提高10倍。</p><p id="e4dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们使用小数据集时，你可能看不到好处。但是如果你在大数据集上使用它，你会看到好处。事不宜迟，我们开始吧！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3158" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">什么是多线程？</h1><p id="951f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">为了理解多线程，我们必须理解这些术语。这些术语是异步和线程。</p><p id="4fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">异步(async)是同时运行许多任务的一种方式。与异步相反的是同步，任务应该按顺序运行。</p><p id="5d86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了以异步的方式运行任务，线程来帮忙。线程是操作系统中最小的部分。</p><p id="d2ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个东西，计算过程就可以完成了。一台计算机可以由多个线程组成。因此，多线程应运而生。</p><p id="566d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">concurrent.futures</code>库允许您在async away上运行作业。因此，您可以比以往更快地解决任务。</p><p id="9be5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在抓取过程中，我们对许多链接应用一个函数。我们可以假设这些数据是相互独立的。因此，我们可以将数据分成块。从那里，这些块将被放入所有可用的线程中。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0a22" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">履行</h1><p id="7961" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在我们知道了多线程的概念。现在让我们进入实现阶段。</p><h2 id="d4df" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">源头</h2><p id="6f2e" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">对于这篇文章，我们将尝试从一个名为FBRef.com<strong class="lb iu">的网站收集数据。FBRef是一个汇编足球(英式足球)统计数据的网站。</strong></p><p id="85c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该网站包含许多联赛的数据，从英超联赛到职业足球大联盟。除此之外，我们可以捕捉球队或球员水平的数据。</p><h2 id="7f41" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">问题是</h2><p id="ec16" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">对于这个问题，我们希望提取球员姓名等数据，以及重定向到球员信息和统计数据的链接。</p><blockquote class="np nq nr"><p id="01d6" class="kz la ns lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">请记住。我不会教你如何刮一个网站。相反，我只向您演示如何应用多线程处理。</p></blockquote><h2 id="84f6" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">初始代码</h2><p id="2914" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">最初，我们有一个类似这样的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="11cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这段代码中，我们使用循环来提取玩家的名字和链接。使用它的原因是没有一个单独的页面来收集所有球员的名字。</p><p id="ee8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是问题所在。我们必须打开许多包含数据的页面。因为我们一次打开一页，这个过程变得非常慢。有了代码，任务在15分29秒内完成。</p><blockquote class="ny"><p id="6c45" class="nz oa it bd ob oc od oe of og oh lu dk translated">有了代码，任务在15分29秒内完成。</p></blockquote><p id="f270" class="pw-post-body-paragraph kz la it lb b lc oi ju le lf oj jx lh li ok lk ll lm ol lo lp lq om ls lt lu im bi translated">从这个问题出发，<code class="fe lv lw lx ly b">concurrent.futures</code>库来帮助我们。</p><h2 id="49dc" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">多线程管道</h2><p id="a781" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">从上一节中，我们可以看到刮擦过程相当缓慢。为了加快进程，我们可以使用多线程的概念来解决问题。</p><p id="cd8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用来自<code class="fe lv lw lx ly b">concurrent.futures</code>库中的一个名为<code class="fe lv lw lx ly b">ThreadPoolExecutor</code>的对象。</p><p id="99e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用多线程的蓝图如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on nx l"/></div></figure><p id="5faf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要实现三个部分。首先，我们需要导入库。第二，我们实现了这个函数，它是用来抓取数据的。最后，运行多线程。</p><h2 id="3ea2" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">并发期货的代码</h2><p id="427b" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">那么我们如何将多线程应用到我们的初始函数中呢？代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="1b29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了密码。看起来差不多吧？您只需将前面的代码包装到一个函数中，并添加ThreadPoolExecutor对象来将函数映射到数据块中。正如我之前提到的，螺纹可以加速刮削过程。但是有多快呢？</p><p id="2522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的例子中，代码在72秒内完成了任务。这几乎比之前的代码快了12倍！想象一下。如果你有超过十万个链接，你可以从中节省很多时间。</p><p id="9f2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我得到了另一个案例，我刮网站的链接数量。最初，完成这项任务的估计时间约为65小时。</p><p id="fbf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了多线程，我可以在6小时内完成这项工作！</p><p id="bccc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看我节省了多少时间！有了节省下来的时间，我们可以做任何我们喜欢的事情。</p><blockquote class="ny"><p id="5927" class="nz oa it bd ob oc od oe of og oh lu dk translated">代码在72秒内完成了任务。这几乎比之前的代码快了12倍！</p></blockquote></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="8e0e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结束语</h1><p id="9ebb" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">干得好！现在，您已经学习了如何在Python中实现多线程来加速您的web抓取过程。通过使用它，我们可以将任何任务的速度提高10倍。</p><p id="e2b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这个概念能解决你在网页抓取过程中的问题。因此，您可以利用节省下来的时间专注于解决任何任务。或者也许你可以用来看你喜欢的电视剧，哈哈。</p><p id="aca0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想要完整的笔记本，你可以看看这个<strong class="lb iu"> </strong> <a class="ae ky" href="https://jovian.ai/khalidmeister/multithreading-fbref" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="7dc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢你看我的文章！</p></div></div>    
</body>
</html>