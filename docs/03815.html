<html>
<head>
<title>Create a Line Chart in SwiftUI Using Paths</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用路径在SwiftUI中创建折线图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-line-chart-in-swiftui-using-paths-183d0ddd4578?source=collection_archive---------4-----------------------#2020-03-06">https://betterprogramming.pub/create-a-line-chart-in-swiftui-using-paths-183d0ddd4578?source=collection_archive---------4-----------------------#2020-03-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="358a" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">SWIFTUI实施</h2><div class=""/><div class=""><h2 id="b835" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">在你的iOS应用程序中创建漂亮的股票图表</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/03f4f5e116355e0b11f18e45616705a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eZh1HfzXfAjD_9ME"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">克里斯·利维拉尼在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="f1c0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">SwiftUI框架在WWDC 2019上推出，让iOS社区欢呼雀跃。用Swift编写的易于使用的声明式API让开发人员可以快速构建UI原型。</p><p id="bdee" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">虽然我们可以利用Shapes协议从头开始构建<a class="ae li" href="https://medium.com/better-programming/swiftui-bar-charts-274e9fbc8030" rel="noopener">条形图</a>，但对于折线图却不能这么说。谢天谢地，我们有<code class="fe mf mg mh mi b">Paths</code>结构来帮助我们。</p><p id="f8d3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">使用SwiftUI路径，它类似于核心图形框架中的<code class="fe mf mg mh mi b">CGPaths</code>，我们可以组合线条和曲线来构建漂亮的徽标和形状。</p><p id="1eac" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">按照编写UI的声明方式，SwiftUI路径是用一组指令构建的。在接下来的几节中，我们将讨论这意味着什么。</p></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="7647" class="mq mr iu bd ms mt mu mv mw mx my mz na kj nb kk nc km nd kn ne kp nf kq ng nh bi translated">我们的目标</h1><ul class=""><li id="24d0" class="ni nj iu ll b lm nk lp nl ls nm lw nn ma no me np nq nr ns bi translated">探索SwiftUI的路径API并从中创建简单的形状。</li><li id="6a4a" class="ni nj iu ll b lm nt lp nu ls nv lw nw ma nx me np nq nr ns bi translated">使用Combine和URLSession获取历史股票数据。我们将使用<a class="ae li" href="https://www.alphavantage.co/" rel="noopener ugc nofollow" target="_blank"> Alpha Vantage </a>的API来检索股票信息。</li><li id="b8cd" class="ni nj iu ll b lm nt lp nu ls nv lw nw ma nx me np nq nr ns bi translated">在SwiftUI中创建一个折线图，显示一段时间内的股票价格。</li></ul><p id="eb24" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在本文结束时，您应该能够创建一个类似于下面的iOS应用程序:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ny"><img src="../Images/0dd0866a0102f0e69f155b262d26b1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*0_IPSWXsxHgGDRk51CAPbw.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">一个印度NSE和两个美国股票图表。</p></figure></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="d138" class="mq mr iu bd ms mt mu mv mw mx my mz na kj nb kk nc km nd kn ne kp nf kq ng nh bi translated">创建一个简单的SwiftUI路径</h1><p id="65be" class="pw-post-body-paragraph lj lk iu ll b lm nk ke lo lp nl kh lr ls nz lu lv lw oa ly lz ma ob mc md me in bi translated">以下是在SwiftUI中使用路径创建直角三角形的示例:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="cfe8" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Path API由一系列函数组成。<code class="fe mf mg mh mi b">move</code>负责设置路径的起点。<code class="fe mf mg mh mi b">addLine</code>负责画一条直线到指定的目的地点。</p><p id="cd38" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mf mg mh mi b">addArc</code>、<code class="fe mf mg mh mi b">addCurve</code>、<code class="fe mf mg mh mi b">addQuadCurve</code>、<code class="fe mf mg mh mi b">addRect</code>和<code class="fe mf mg mh mi b">addEllipse</code>只是一些其他的方法，它们让我们在许多其他带有路径的事物中创建圆弧或贝塞尔曲线。</p><p id="c893" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">使用<code class="fe mf mg mh mi b">addPath</code>可以添加两个或多个路径。</p><p id="6405" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下图显示了一个三角形后面跟着一个圆形饼图:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oe"><img src="../Images/4cbb42446c3d26f398f2e984cf09d72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XNc1miVjNhzzDCYW44p8g.png"/></div></div></figure><p id="2012" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">现在我们已经了解了如何在SwiftUI中创建路径，让我们跳到SwiftUI中的折线图。</p></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="de4d" class="mq mr iu bd ms mt mu mv mw mx my mz na kj nb kk nc km nd kn ne kp nf kq ng nh bi translated">SwiftUI折线图</h1><p id="085b" class="pw-post-body-paragraph lj lk iu ll b lm nk ke lo lp nl kh lr ls nz lu lv lw oa ly lz ma ob mc md me in bi translated">下面给出了解码来自API的JSON响应的模型:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="e426" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">让我们创建一个<code class="fe mf mg mh mi b">ObservableObject</code>类。我们将使用URLSession的合并发布器执行API请求，并使用合并操作符转换结果。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="5f09" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">API结果由嵌套的JSON组成，关键字是日期。这些在字典中是无序的，我们需要对它们进行排序。为此，我们声明了一个扩展，将字符串转换为日期，并在<code class="fe mf mg mh mi b">sort</code>函数中进行比较。</p><p id="3fe1" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">既然我们已经在<code class="fe mf mg mh mi b">Published</code>属性中获得了价格和股票数据，我们需要将它们传递给<code class="fe mf mg mh mi b">LineView</code>——一个自定义SwiftUI视图，我们接下来将看到:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="3eda" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">上面的视图是从我们的SwiftUI ContentView调用的，其中传递了名称、价格和一组价格历史。使用GeometryReader，我们将把框架的宽度和高度传递给<code class="fe mf mg mh mi b">Line</code>结构，在那里我们将最终使用SwiftUI路径连接这些点:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="3ab2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe mf mg mh mi b">stepWidth</code>和<code class="fe mf mg mh mi b">stepHeight</code>被计算用于将图表约束在给定的框架宽度和高度内。然后将它们传递给<code class="fe mf mg mh mi b">Path</code>结构的扩展函数，以创建折线图:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="oc od l"/></div></figure><p id="f933" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">最后，显示股票图表的SwiftUI应用程序准备就绪。下图展示了:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oe"><img src="../Images/31df3561b2ca2c2bff5eb01e3a7d2288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51q3BlLa-XLLKtHn-mgTOA.png"/></div></div></figure></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="ed87" class="mq mr iu bd ms mt mu mv mw mx my mz na kj nb kk nc km nd kn ne kp nf kq ng nh bi translated">结论</h1><p id="8885" class="pw-post-body-paragraph lj lk iu ll b lm nk ke lo lp nl kh lr ls nz lu lv lw oa ly lz ma ob mc md me in bi translated">在本文中，我们设法再次将SwiftUI和Combine结合在一起——这一次是为了获取股票价格并在折线图中显示它们。了解SwiftUI路径的复杂性是使用SwiftUI形状的良好起点，这需要您实现<code class="fe mf mg mh mi b">path</code>功能。</p><p id="4a9a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">您可以通过使用手势突出显示点及其各自的值，将SwiftUI折线图向前推进一步。要了解如何做到这一点以及更多，请参考这个库<a class="ae li" href="https://github.com/AppPear/ChartView" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6b4d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">上述应用程序的完整源代码可以在<a class="ae li" href="https://github.com/anupamchugh/iowncode/tree/master/SwiftUILineChart" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中找到。</p><p id="b785" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这一次到此为止。感谢阅读。</p></div></div>    
</body>
</html>