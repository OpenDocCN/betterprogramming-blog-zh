<html>
<head>
<title>3 Ways To Handle State Better in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中更好地处理状态的3种方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-ways-to-handle-state-better-in-react-9a44c3e9162?source=collection_archive---------3-----------------------#2021-02-12">https://betterprogramming.pub/3-ways-to-handle-state-better-in-react-9a44c3e9162?source=collection_archive---------3-----------------------#2021-02-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1c4f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用useReducer、自定义挂钩等等</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fc0c723ac8408d50e29c082e1e4c5397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z7pvckYpPSiWvsz5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">费伦茨·阿尔马西</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="dfc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">React让开发人员完全自由地决定如何在组件中管理状态。React有两种类型的组件:类组件和功能组件，这是在React v16中引入的。</p><p id="a2e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类组件使用方法来管理状态，比如用<code class="fe ls lt lu lv b">this.state</code>和<code class="fe ls lt lu lv b">this.setState</code>来管理状态，用<code class="fe ls lt lu lv b">componentDidMount()</code>来管理组件挂载后的副作用。如果有兴趣，可以<a class="ae kv" href="https://reactjs.org/docs/state-and-lifecycle.html" rel="noopener ugc nofollow" target="_blank">多了解一下这些方法</a>。</p><p id="b271" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，由于大多数React开发人员现在使用React功能组件，我们将关注功能组件及其状态，这是使用<a class="ae kv" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"> React钩子</a>管理的。</p><p id="f713" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将了解一些我发现的在功能组件中管理状态的最佳实践，并真正利用React hooks API。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="56f3" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">对复杂状态使用useReducer</h1><p id="e365" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">有时候<code class="fe ls lt lu lv b">useState</code>钩子不能解决问题，尤其是在处理可能涉及大型对象的复杂状态行为时。<code class="fe ls lt lu lv b">useReducer</code>钩子是一个强大的React钩子，用于处理不需要第三方依赖的复杂状态管理。此外，它减少了每次渲染重新创建的数据量。</p><p id="7b29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当与上下文和类型脚本结合使用时，<code class="fe ls lt lu lv b">useReducer</code>会变得非常强大。</p><p id="32c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看看如何在现实生活中使用它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e92d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看看这是多么模块化和更容易阅读。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="a202" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">定制挂钩FTW(即，用于win)</h1><p id="6ba8" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">当使用React钩子时，有时会在一个组件中使用非常复杂的状态逻辑，这个组件利用多种类型的钩子来实现一个目的。</p><p id="8cc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">幸运的是，我们可以定制React钩子，将复杂的逻辑包含到一个可访问的钩子中。这对于表单、切换、异步行为以及组件中以一堆钩子结束的任何事情都很方便。</p><p id="7d10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将看一个定制钩子的例子，用来切换条目列表中的条目。代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1036" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过将所有这些逻辑抽象成一个自定义的React钩子，它不仅更容易阅读，而且可以在我们的应用程序中重用！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="7433" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">全局状态管理</h1><p id="3206" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">在大多数情况下，您不需要状态管理库。只有在处理复杂状态的大型应用程序中，才应该引入外部库来管理它。</p><p id="9a0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即便如此，如果您不能使用提供的<a class="ae kv" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">上下文API </a>在组件之间共享数据，请重新考虑。</p><p id="8203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你决定需要一个外部状态管理工具，我强烈推荐看看<a class="ae kv" href="https://recoiljs.org/" rel="noopener ugc nofollow" target="_blank">反冲</a>，这是一个超级轻量级和简单的管理全局状态的工具。另一个受欢迎的库是<a class="ae kv" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>。关于如何有效地使用这些工具，有大量的文章和讨论，所以我不会在本指南中涉及它们。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="1a0d" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">使用数据提取库</h1><p id="1d88" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">从外部API提取数据似乎是一个简单的问题，但是一旦您开始需要在内存中缓存数据(以减少API调用的数量)、更新数据以及在多个位置访问数据，问题就会变得非常复杂。</p><p id="b4f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">令人欣慰的是，有像<a class="ae kv" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank"> React Query </a>这样的现代数据获取库，可以有效地从外部来源获取、缓存、失效和刷新数据。它们还可以用于向一些外部客户端发送数据，真正包含与服务器交互的整个工作流。</p><p id="9fd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更好的是，其中一些库，如<a class="ae kv" href="https://www.apollographql.com/docs/react/" rel="noopener ugc nofollow" target="_blank"> Apollo Client </a>包含状态管理，以可预测、声明性和可读的方式处理获取数据、缓存数据和自动更新UI的整个过程。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e16f" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="66ef" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">管理React状态可能很复杂，但是通过这些技巧，我希望您能够以一种高效且可读的方式来完成。</p></div></div>    
</body>
</html>