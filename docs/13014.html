<html>
<head>
<title>Build a Simple CRM With Django and HTMX— Frontend Development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Django和HTMX构建一个简单的CRM前端开发</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-simple-crm-with-django-and-htmx-frontend-development-c067c9f02823?source=collection_archive---------9-----------------------#2022-07-19">https://betterprogramming.pub/build-a-simple-crm-with-django-and-htmx-frontend-development-c067c9f02823?source=collection_archive---------9-----------------------#2022-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="78c1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建应用程序模板</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0491e1a8a6dda80572215ef95735cddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8VPhsTBIGvMLwyZaoO0Nw.png"/></div></div></figure><p id="3622" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将继续我们离开的地方:为我们的<code class="fe ln lo lp lq b">client_relationship_manager</code>应用程序创建模板。我推荐阅读第一部分，如果你还没有的话，在那里我向你展示了如何为这个项目开发后端。</p><h1 id="a01e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">目标</h1><p id="f28a" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">本系列的目标是教您如何使用Django和HTMX创建动态CRUD应用程序来跟踪客户及其联系信息。</p><h1 id="b548" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建前端</h1><p id="e8ec" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">我将首先向您展示如何组织模板。<code class="fe ln lo lp lq b">HtmxResponseMiddleware</code>要求我们对它们进行独特的设置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/3edd393ac1a50f32af80557d93d2ef9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*lVs2H9HJkVpi_Nkr44UzDg.png"/></div></figure><p id="0dc8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">应用程序子目录中的任何页面模板都将从<code class="fe ln lo lp lq b">base.html</code>扩展而来。或者<code class="fe ln lo lp lq b">partial.html</code>如果是HTMX响应。</p><h2 id="62ad" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">templates/base.html</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="31db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">base.html</code>模板包括标准元素，如标题、元标签、CSS和JavaScript。我们还将一个<code class="fe ln lo lp lq b">csrf_token</code>传递给带有<code class="fe ln lo lp lq b">hx-headers</code>属性的头。</p><blockquote class="ne nf ng"><p id="a776" class="kr ks nh kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated">将<code class="fe ln lo lp lq b"><em class="iq">hx-headers</em></code>放在<code class="fe ln lo lp lq b"><em class="iq">&lt;body&gt;</em></code>标签上最方便，因为这样所有元素都会继承它。(来源:<a class="ae lr" href="https://django-htmx.readthedocs.io/en/latest/tips.html" rel="noopener ugc nofollow" target="_blank"> htmx文档</a>)。)</p></blockquote><p id="446c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来是一个非常简单的navbar，一个消息容器，一个面包屑容器和一个htmxCanvas容器。请注意，在navbar中，我们同时使用app名称空间和URL模式名称来反转URL，而不是硬编码它。</p><h2 id="e7a1" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">templates/partial.html</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="91d8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以上是用于HTMX响应的基本模板。它使用<code class="fe ln lo lp lq b">hx-swap-oob</code>属性更新页面标题、面包屑和请求返回的任何消息。块标签中的内容被交换到htmxCanvas中。</p><h2 id="e6e3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated"><strong class="ak">templates/CRM/index . html</strong></h2><p id="8668" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">所有的应用程序模板都将遵循类似的布局。首先，扩展从<code class="fe ln lo lp lq b">HtmxResponseMiddleware.</code>传入响应的<code class="fe ln lo lp lq b">base_template</code>，然后我们将提供页面标题、面包屑和画布内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="856e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在画布内容的第一行，我们放置了页面标题、一个<a class="ae lr" href="https://htmx.org/examples/active-search/" rel="noopener ugc nofollow" target="_blank"> htmx主动搜索</a>栏和一个添加新客户的按钮。页面的其余部分是一个for循环，用于在表中显示客户端列表。</p><p id="d82e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在搜索栏中，我们将请求发送到CRM应用程序中的搜索URL，将响应发送到htmxCanvas，并将URL推送到浏览器历史。此外，添加<code class="fe ln lo lp lq b">hx-preserve</code>属性，它将防止搜索栏在搜索结果呈现时重新加载。</p><blockquote class="ne nf ng"><p id="0866" class="kr ks nh kt b ku kv jr kw kx ky ju kz ni lb lc ld nj lf lg lh nk lj lk ll lm ij bi translated">属性允许你在HTML替换过程中保持元素不变。(来源:<a class="ae lr" href="https://htmx.org/attributes/hx-preserve/" rel="noopener ugc nofollow" target="_blank"> htmx文档</a>。)</p></blockquote><p id="72f7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此时，您可以进入默认的admin来添加一些测试客户端，并查看主页。它应该如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/c2b11ae3512e1dbb742b916a645dacc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tOsWsRTGRbtHtHDN7J_5XQ.png"/></div></div></figure><h2 id="4552" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">templates/CRM/search _ results . html</h2><p id="e9b6" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">搜索结果模板类似于索引模板。唯一的区别是标题、面包屑，而不是添加客户端的按钮，我们显示查询的结果数量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="1d86" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下图是该页面的外观:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/5a348cfba6d840e848f831fba115d561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMT0nZoNpO05JvIxd86vRA.png"/></div></div></figure><h2 id="0e2e" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">模板/crm/detail_client.html</h2><p id="ba7d" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">同样，在详细页面上，我们扩展<code class="fe ln lo lp lq b">base_template</code>，添加一个标题和一些面包屑，然后我们得到画布内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="0ad0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有两个按钮可以更新或删除客户端。然后我们显示所有客户的联系信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/d251b7ca458e676a081844168068f98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZuSg6JCjDmj_EBrPglgFdQ.png"/></div></div></figure><h2 id="4a6d" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">模板/crm/create_client.html</h2><p id="6498" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">这里我们将使用我们在<code class="fe ln lo lp lq b">forms.py</code>中创建的表单。注意，向表单字段添加属性更简单，所以现在我们可以使用<code class="fe ln lo lp lq b">{{ form }}</code>模板标签。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/6e242b5900e5321867bdc9e73c72ea3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_bu7oQUHMrpCArBW1N8Ww.png"/></div></div></figure><p id="6f7e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">提交表单会将您引导到新客户的详细信息页面，在这里您会看到我们添加到<code class="fe ln lo lp lq b">partial.html</code>文件中的消息。重新加载页面，使用关闭按钮，或者导航到一个新的页面，消息会像预期的那样消失。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/4f92c841d6811538dc3fab9e939f29f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxLH776pqGDzEgqHOoiZJg.png"/></div></div></figure><h2 id="65e3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">模板/crm/update_client.html</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="6e6f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">更新页面类似于创建页面。一个关键区别是表单字段中显示的客户端实例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/d9b6b75e807fff7421e793dce431e8d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2DnwFZuSOKbv5fng0W6hw.png"/></div></div></figure><p id="f3f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们接近尾声时，注意应用程序模板是如何遵循相同的基本布局的，被两个基本模板(<code class="fe ln lo lp lq b">base.html</code>和<code class="fe ln lo lp lq b">partial.html</code>)接受。这个框架使得添加更复杂的操作变得更加容易。</p><h2 id="92e9" class="mq lt iq bd lu mr ms dn ly mt mu dp mc la mv mw me le mx my mg li mz na mi nb bi translated">模板/crm/delete_client.html</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="f2a1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">DeleteClientView</code>给了我们一个确认页面，我们可以在这里确认是否要删除或取消。如果您更喜欢一个警告而不是一个专用的删除页面，您可以在客户机详细信息页面上使用HTMX的<code class="fe ln lo lp lq b"><a class="ae lr" href="https://htmx.org/attributes/hx-confirm/" rel="noopener ugc nofollow" target="_blank">hx-confirm</a></code>属性！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/5eb60370203cf35ae50a34d241c3f1c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBlxTlIDRu3p7ElUfNDD7g.png"/></div></div></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h1 id="5014" class="ls lt iq bd lu lv nu lx ly lz nv mb mc jw nw jx me jz nx ka mg kc ny kd mi mj bi translated">结论</h1><p id="dc6f" class="pw-post-body-paragraph kr ks iq kt b ku mk jr kw kx ml ju kz la mm lc ld le mn lg lh li mo lk ll lm ij bi translated">如果你跟进并完成了<code class="fe ln lo lp lq b">client_relationship_manager</code>的申请，那么恭喜你！下一篇教程，我将向您展示如何创建一个定制的用户模型和相关的认证页面。</p><h1 id="92c7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">资源</h1><ul class=""><li id="f52e" class="nz oa iq kt b ku mk kx ml la ob le oc li od lm oe of og oh bi translated">htmx <a class="ae lr" href="https://django-htmx.readthedocs.io/en/latest/tips.html" rel="noopener ugc nofollow" target="_blank"> hx-headers </a></li><li id="7011" class="nz oa iq kt b ku oi kx oj la ok le ol li om lm oe of og oh bi translated">htmx <a class="ae lr" href="https://htmx.org/examples/active-search/" rel="noopener ugc nofollow" target="_blank">主动搜索</a></li><li id="da40" class="nz oa iq kt b ku oi kx oj la ok le ol li om lm oe of og oh bi translated">htmx <a class="ae lr" href="https://htmx.org/attributes/hx-preserve/" rel="noopener ugc nofollow" target="_blank"> hx-preserve </a></li><li id="f5b0" class="nz oa iq kt b ku oi kx oj la ok le ol li om lm oe of og oh bi translated">htmx<a class="ae lr" href="https://htmx.org/attributes/hx-confirm/" rel="noopener ugc nofollow" target="_blank">hx-确认</a></li></ul></div></div>    
</body>
</html>