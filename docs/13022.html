<html>
<head>
<title>Create a Static Website With Middleman and Deploy It on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用中间人创建一个静态网站，并将其部署在AWS上</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/create-a-static-website-with-middleman-and-deloy-it-on-aws-1060f54d2ba3?source=collection_archive---------17-----------------------#2022-07-19">https://betterprogramming.pub/create-a-static-website-with-middleman-and-deloy-it-on-aws-1060f54d2ba3?source=collection_archive---------17-----------------------#2022-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b3b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建和托管低成本的登录页面</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/afe3aab173e2cffcf78628dcff7cf147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*DA3biyTYYWxH77Tp.png"/></div></figure><p id="dc62" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">几乎每个创业公司的起步都是一样的；带有登录页面。然而，许多用于登录页面的无代码解决方案要么价格昂贵，要么不提供用户可能需要的定制水平。我们将讨论如何使用中间人+ AWS来创建和托管您的登录页面！</p><p id="974d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">按照本教程，你将能够创建一个网站，如下面的<a class="ae lm" href="https://avantsoft.com.br/" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="0f45" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">先决条件</h1><p id="d8d8" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">为了遵循本教程，将假设一些事情:</p><ol class=""><li id="ec29" class="mk ml it ks b kt ku kw kx kz mm ld mn lh mo ll mp mq mr ms bi translated">您已经按照这里的说明<a class="ae lm" href="https://middlemanapp.com/basics/install/" rel="noopener ugc nofollow" target="_blank">安装了中间人</a>。</li><li id="3eee" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated">你有一个想要使用的网站模板(HTML、CSS、JS等)。</li><li id="e9d8" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated">你有一个AWS S3桶+ AWS Cloudfront网站托管设置与下面的设置相同的方式:</li></ol><div class="my mz gp gr na nb"><a href="https://thepaulo.medium.com/continuous-deployment-pipeline-for-react-app-on-aws-s3-cloudfront-ac60f455642a" rel="noopener follow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">AWS S3 + CloudFront上React应用的持续部署渠道</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">简单回顾了如何为单页面应用程序(ReactJS)创建一个连续的部署管道，而不需要…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">thepaulo.medium.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ko nb"/></div></div></a></div><h1 id="9edf" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">配置中间人</h1><h2 id="f0ed" class="nq lo it bd lp nr ns dn lt nt nu dp lx kz nv nw lz ld nx ny mb lh nz oa md ob bi translated">步骤1:设置文件夹和文件结构</h2><p id="6880" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">设置以下文件夹结构。</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="b5f4" class="nq lo it od b gy oh oi l oj ok">my-website/<br/>├── data/<br/>│   └── deploy.sh<br/>├── source/<br/>|   ├── images/<br/>|   ├── javascripts/<br/>|   ├── stylesheets/<br/>│   └── index.js<br/>├── .gitignore<br/>├── buildspec.yml<br/>├── config.rb<br/>└── Gemfile</span></pre><p id="2d46" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">应该创建三个文件，如下所示:</p><p id="bbf2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">AWS Codebuild将使用<code class="fe ol om on od b">buildspec.yml</code>来构建网站。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="ba6d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">中间人使用<code class="fe ol om on od b">config.rb</code>文件来配置其行为。该示例文件配置了一些所需的行为:</p><ol class=""><li id="9f83" class="mk ml it ks b kt ku kw kx kz mm ld mn lh mo ll mp mq mr ms bi translated"><code class="fe ol om on od b">directory_indexes</code>将使网站路径不以<code class="fe ol om on od b">.html</code>结尾。</li><li id="bd23" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated"><code class="fe ol om on od b">asset_hash</code>将确保每个构建生成唯一命名的资产，这样CDN缓存就不需要在新构建中失效。</li><li id="be74" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated"><code class="fe ol om on od b">minify_css</code>和<code class="fe ol om on od b">minify_javascript</code>会减小你的CSS和JS文件的大小。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="ba3d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe ol om on od b">Gemfile</code>将指定您将使用的<a class="ae lm" href="https://rubygems.org/" rel="noopener ugc nofollow" target="_blank"> gems </a>,包括对中间人的扩展，如<code class="fe ol om on od b">livereload</code>,它通过在文件更改后自动重新加载网站来使调试更容易。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="c92a" class="nq lo it bd lp nr ns dn lt nt nu dp lx kz nv nw lz ld nx ny mb lh nz oa md ob bi translated">步骤2:将CSS、JS和图像文件移动到正确的目录中</h2><p id="df3d" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">您应该按照以下方式放置所有资产文件:</p><ol class=""><li id="bad6" class="mk ml it ks b kt ku kw kx kz mm ld mn lh mo ll mp mq mr ms bi translated"><code class="fe ol om on od b">javascripts</code>文件夹中的Javascript文件。中间人惯例是为整个站点的JavaScript准备一个名为<code class="fe ol om on od b">site.js</code>的文件。但是，如果需要，您可以将其重命名。</li><li id="dc21" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated">在<code class="fe ol om on od b">stylesheets</code>文件夹中的样式文件(CSS，SCSS等)。你的大部分风格应该在一个名为<code class="fe ol om on od b">site.css</code>的文件中(或者其他合适的扩展名)。但是，如果需要，您可以将其重命名。</li><li id="72ff" class="mk ml it ks b kt mt kw mu kz mv ld mw lh mx ll mp mq mr ms bi translated">将你所有的图片移动到<code class="fe ol om on od b">images</code>文件夹。</li></ol><h2 id="9d14" class="nq lo it bd lp nr ns dn lt nt nu dp lx kz nv nw lz ld nx ny mb lh nz oa md ob bi translated">步骤3:创建你的HTML文件</h2><p id="80aa" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">我们将创建两个HTML文件。</p><p id="152e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个<code class="fe ol om on od b">index.html</code>文件将是你的网站HTML的主要部分。下面的文件来自中间人演示项目。注意顶部<code class="fe ol om on od b">---</code>里面的部分。此语法允许您声明可以在布局文件中使用的变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="224c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><code class="fe ol om on od b">layout.erb</code>将环绕你的<code class="fe ol om on od b">index.html.erb</code>(和其他)HTML文件。它将负责导入你的JS和CSS。这个文件还可以用于显示应该出现在网站所有页面上的页眉和页脚。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="8161" class="nq lo it bd lp nr ns dn lt nt nu dp lx kz nv nw lz ld nx ny mb lh nz oa md ob bi translated">第四步:构建</h2><p id="8358" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">你现在可以运行<code class="fe ol om on od b">bundle exec middleman build</code>。这将创建一个新文件夹，其中包含所有已编译的资产，准备好进行部署！</p><p id="c76c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然而，最好是设置一个自动部署，这样你的网站就可以无缝更新了。</p><h1 id="c557" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">部署自动化</h1><p id="d777" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">假设遵循了这里的步骤<a class="ae lm" href="https://thepaulo.medium.com/continuous-deployment-pipeline-for-react-app-on-aws-s3-cloudfront-ac60f455642a" rel="noopener">和</a>。我们将对Codepipeline进行两项更改，以便它在部署到S3之前构建中间人。</p><h2 id="a35b" class="nq lo it bd lp nr ns dn lt nt nu dp lx kz nv nw lz ld nx ny mb lh nz oa md ob bi translated">步骤1:添加构建阶段</h2><p id="dcfb" class="pw-post-body-paragraph kq kr it ks b kt mf ju kv kw mg jx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">在<code class="fe ol om on od b">source</code>和<code class="fe ol om on od b">deploy</code>阶段之间的管道中添加一个构建阶段。它的配置应该如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi oq"><img src="../Images/9670ea2aecc3e81ce0c643c874b499df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dnyp_3Oo6saTOWzeZD3Abw.png"/></div></div></figure><p id="5f93" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">点击上面菜单中的“创建项目”按钮。它会将您带到代码构建创建表单。按如下方式填写。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi ov"><img src="../Images/da879c7d4e368ab91a7d09b6d28c397c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gQfRjgCVhh95dJLbpNFBQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi ov"><img src="../Images/6925d8ca8a2d29ac8ad2bda2ea52679e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-8LDCM1NHH15GtbqbAb8A.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="or os di ot bf ou"><div class="gh gi ow"><img src="../Images/7be3a15e54916568fba28c351934f985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yyOmk-Cp59DL0-rG7eysxg.png"/></div></div></figure></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="b0fd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们已经走过了一条创建静态网站并以低成本部署的道路。这对于登录页面、博客或任何其他静态网站都很有用。</p></div></div>    
</body>
</html>