<html>
<head>
<title>Break the Monolith — Modularise Your App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打破单一模式——将您的应用模块化</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/break-the-monolith-a0a57301b6a3?source=collection_archive---------14-----------------------#2022-01-05">https://betterprogramming.pub/break-the-monolith-a0a57301b6a3?source=collection_archive---------14-----------------------#2022-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a1ba" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解拆分monolith应用程序的好处</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5fc291b1169084e31dacda25ffc7ebab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ESTJe5lZfaWYAPrY"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@kaleidico?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">万花筒</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8fd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">马丁·福勒</em>写道:</p><blockquote class="lt lu lv"><p id="fe4b" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">几乎所有我听说过的从零开始作为微服务系统构建的系统，最终都陷入了严重的困境。</p><p id="0a1c" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">你不应该用微服务开始一个新项目，即使你确信你的应用程序足够大，值得这么做。</p></blockquote><h1 id="5bdc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">我们应用的生命周期</h1><h2 id="e265" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">初始相位</h2><p id="acc7" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">很自然，在初始阶段，你的应用程序是一段代码。这当然有其充分的理由:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/46f23d693156b9762f6dc9f47436fa0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hyhECTWstA4aBf9EBOvErw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.geograph.ie/photo/4299750" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><ul class=""><li id="b49f" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated"><strong class="ky ir">小团队</strong>。所有开发人员在项目的所有部分紧密合作。</li><li id="82b5" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">加快上市时间</strong>。我们需要用有限的预算发布我们的应用程序和更新。</li><li id="0f65" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">成功的不确定性</strong>。该应用程序的未来版本只有在应用程序成功的情况下才会出现。</li><li id="7558" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">简约</strong>。该应用程序还不是很大，我们需要保持简单和快速。</li></ul><h2 id="90fa" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">发布阶段</h2><p id="cbab" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">过了一段时间，如果你有一个成功的产品上市，这个庞然大物就开始成长了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/147f26d5c69e1ad0909b7fb44163e187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R9cQqUIRfZfN_R1tQR7UOg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/photos/water-sea-seashore-travel-ocean-3375822/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><ul class=""><li id="1578" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">增加了更多的功能。我们的应用变得更大。</li><li id="28dc" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">团队成长</strong>。更多的开发人员被添加到项目中。</li><li id="93b6" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">多个</strong> <strong class="ky ir">独立团队</strong>在做同一个app。</li><li id="efb6" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">独石正在失去控制。每个人都在添加和修改代码库。</li></ul><h2 id="9ebc" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">过度生长阶段</h2><p id="b0c4" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">是时候打破巨石了？我们知道，当以下几点开始出现时，是时候打破这块巨石了。</p><ul class=""><li id="7ff2" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">构建时间是一个瓶颈。构建时间太长了，以至于开发人员花费了很大一部分工作时间来等待他们的构建完成。</li><li id="ca37" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">团队需要彼此独立工作。没有日常交流的多个团队使用同一个应用程序。</li><li id="ac7b" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">项目变得太复杂，需要重新简化。</li><li id="1671" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">新团队成员入职</strong>，由于App的复杂性，<strong class="ky ir">耗时太长</strong></li></ul><h1 id="1e3a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">模块化</h1><p id="3e58" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我们已经决定，我们需要把我们的应用程序分成多个模块。现在我们需要选择如何开始模块化。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="d9c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一种天真的方法是决定每个新特性都应该作为一个新模块来实现。虽然简单，但我们很快就会意识到模块分离过程的最大挑战:<strong class="ky ir">依赖性。</strong></p><p id="9d0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使是最简单的功能也至少有一个当前在主应用程序中的依赖项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/28c829fe92ce13c41df96351d5e00600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AAy_Ol4ky3Z0eBn-EA8KNw.png"/></div></div></figure><p id="55d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新功能通常需要应用程序中现有的组件。最有可能的是:日志、数据库、Rest客户端、UI组件…</p><p id="5f1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将使模块非常依赖于应用程序。尽管这种依赖性不被认为是阻碍因素，但也应该避免。应用程序应该使用模块，而不是相反。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="f986" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一种方法是首先将一些基本的实用工具，如日志、跟踪、分析、持久性、rest-client、UI组件转移到单独的模块中。那么每个新功能都可以使用这些基本模块，而不依赖于主应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/9adcc0adad0b3979e3a45559c517fba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oG2Bwn8Ji-Oig6CcMQ0p0Q.png"/></div></div></figure><p id="4a77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法在我看来是理想的。一个更大的重构来清理和拆分基本的东西。所有旧功能将保留在应用程序中，但因为实用程序将在单独的模块中，新功能从现在开始可以作为功能模块编写。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/ea0947d97ff8363d077b83668b634eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yR7bjmhU453C7AQpYprWyw.png"/></div></div></figure><p id="ffaa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，这里最大的障碍是说服涉众批准这么大的重构。开发人员会忙上一段时间，总会有新的bug被添加的风险，也不会有新的特性被发布。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="7b46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一种方法是确定当前应用程序的主要难点。它可以是一个功能，但也可以是一个实用程序，如数据库。</p><p id="6cfc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择重构这个痛点，将它移到一个单独的模块中，同时修复它所存在的错误。</p><p id="d194" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了将这一棘手问题转移到一个单独的模块中，很有可能一些实用程序也需要转换成模块。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/3b9a369cac3824d2033b3a3be61c1def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Y2jZ6KCcVxvHTnEp5aPhA.png"/></div></div></figure><p id="d69a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果与前面的方法类似，但是在这种情况下，我们将获得一些商业价值，解决一些错误，或者提高性能和/或稳定性。</p><h1 id="3892" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">模块类型</h1><p id="46e3" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">模块分为两大类。</p><ul class=""><li id="a3ba" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">实用模块</li><li id="d116" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">功能模块</li></ul><p id="4966" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有两条规则。</p><ul class=""><li id="fdba" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">实用模块不应依赖于其他实用模块或功能模块。</li><li id="abcd" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">功能模块应该只依赖于实用模块。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/3142c0546c436a8137046a46e2ed426d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACBuQfuA80E-KNcW8R562w.png"/></div></div></figure><p id="94a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果应用程序更大，可以添加另一层。在这个额外的层中，我们可以有域模块。这些模块可以被多个功能模块使用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/6ca3ed50029c02bcbaef6f5c80ed250b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txHqSe5cYWKppT4Cc_mInw.png"/></div></div></figure><h2 id="a215" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">证明文件</h2><p id="1612" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">我们建议我们的开发人员在每个模块的公共方法和类中遵循<a class="ae kv" href="https://en.wikipedia.org/wiki/Open–closed_principle" rel="noopener ugc nofollow" target="_blank">开-闭</a>原则。公共接口不应该改变！它也应该很好地记录和使用的例子应该提供。</p><h2 id="e0cc" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">自动化测试</h2><p id="4c23" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">每个模块都应该完全被测试覆盖。最好是通过单元测试，但是如果单元测试不可能或者不能覆盖整个模块，那么可以通过UI、屏幕截图或者集成测试。</p><h1 id="b58c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="dce3" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">分割这块巨石并不是一件容易的事情，但是它的好处甚至可以说服最怀疑的人。</p><ul class=""><li id="4f9e" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">新开发人员可以更快地提高工作效率。他们现在可以在独立的模块上工作，而不需要了解所有其他模块。</li><li id="6f71" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">在较小的模块上工作确实减少了构建和开发时间。</li><li id="3b7a" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">团队可以获得模块的完全所有权。</li><li id="9bee" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">关注点分离</li><li id="b04b" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">模块化迫使每个开发人员更多地考虑正确的架构。</li><li id="32e4" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">每个模块的自动化测试在几秒钟内完成。</li><li id="cb17" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">模块可以使用不同的技术(<strong class="ky ir"> Kotlin多平台)</strong>。</li></ul><p id="efbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">拆分现有应用的最初努力是巨大的，但好处远远大于坏处。</p><p id="29e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像往常一样，快乐编码。</p></div></div>    
</body>
</html>