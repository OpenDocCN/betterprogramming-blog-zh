<html>
<head>
<title>Creating a SwiftUI Looping Background Video</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建SwiftUI循环背景视频</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-swiftui-looping-background-video-f6fc3acd01b8?source=collection_archive---------11-----------------------#2022-03-15">https://betterprogramming.pub/creating-a-swiftui-looping-background-video-f6fc3acd01b8?source=collection_archive---------11-----------------------#2022-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1d18" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">仔细看看在SwiftUI中实现平滑的视频背景</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/78cada85e4fb34a09cc4c634cf9f55da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aVE02t90mUfRKA4F"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@sammoqadam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">萨姆·穆卡达姆</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="44ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都见过很多平滑背景的应用程序循环播放视频，这让我们感到惊讶。</p><p id="de05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入研究一下，看看我们如何为我们的应用程序做同样的事情。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="5bde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe mc md me mf b">UIKit</code>中，我们通过利用<code class="fe mc md me mf b">AVFoundation</code>框架和<code class="fe mc md me mf b">UIView</code>来做到这一点。既然苹果有强大的机制与<code class="fe mc md me mf b">UIKit</code>沟通，为什么不在<code class="fe mc md me mf b">SwiftUI</code>中做同样的事情呢？</p><p id="4bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，如果您过去使用<code class="fe mc md me mf b">UIKit</code>与类似的任务进行过交互，您可能会注意到，为了创建流畅的视频体验，我们还需要考虑一些特定的状态:</p><ol class=""><li id="c433" class="mg mh it lb b lc ld lf lg li mi lm mj lq mk lu ml mm mn mo bi translated">推动/弹出下一个<code class="fe mc md me mf b">View</code>或<code class="fe mc md me mf b">UIViewController</code></li><li id="0c67" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ml mm mn mo bi translated">应用程序进入后台</li><li id="b356" class="mg mh it lb b lc mp lf mq li mr lm ms lq mt lu ml mm mn mo bi translated">应用程序重回前台</li></ol><p id="ee67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些特殊的突变可能会产生奇怪的副作用和故障，比如视频停止，不再继续，甚至快进到未来的某个特定点。</p><p id="d50e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为软件工程师，我们的目标是不遗余力。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="0527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从一个简单的<code class="fe mc md me mf b">UIView</code>开始，就像我们在<code class="fe mc md me mf b">UIKit</code>时代一样，利用<code class="fe mc md me mf b">AVFoundation</code>框架及其组件。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="de5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候通过使用<code class="fe mc md me mf b">UIViewRepresentable</code>来桥接<code class="fe mc md me mf b">UIKit</code>和<code class="fe mc md me mf b">SwiftUI</code>了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="79bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拼图的最后一块是将上面的所有代码组装到一个<code class="fe mc md me mf b">SwiftUI</code> <code class="fe mc md me mf b">View</code>中，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f092" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们从<code class="fe mc md me mf b">UIKit</code> → <code class="fe mc md me mf b"> UIViewRepresentable</code>(两个世界之间的桥梁)→ <code class="fe mc md me mf b">View</code> ( <code class="fe mc md me mf b">SwiftUI</code>)</p><p id="d72d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意我们是如何通过控制播放器和在不同的状态变化时暂停/恢复来处理和控制我们之前提到的所有四种状态的？</p><p id="59a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有，<code class="fe mc md me mf b">AVQueuePlayer</code>需要有状态；否则，它将被无效，并在每次屏幕更新和重绘时重置为视频的开始。</p><p id="c6c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果您想在代码中的任何地方使用这种新的<code class="fe mc md me mf b">View</code>,使用下面的命令调用它:</p><pre class="kj kk kl km gt mw mf mx my aw mz bi"><span id="02a2" class="na nb it mf b gy nc nd l ne nf">BgdFullScreenVideoView(videoName: "dashboard_video")</span></pre><p id="aa32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于完整的演示和完整的源代码，GitHub上什么都有。</p><div class="ng nh gp gr ni nj"><a href="https://github.com/catalinpatrascu/SwiftUIBackgroundVideoPlayer" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">GitHub-catalinpatrascu/SwiftUIBackgroundVideoPlayer:swift ui中的全屏视频背景</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">SwiftUI使用中的全屏视频背景:只需将BgdFullScreenVideoView添加到任何视图的主体中，然后…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ks nj"/></div></div></a></div></div></div>    
</body>
</html>