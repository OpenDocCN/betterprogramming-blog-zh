<html>
<head>
<title>Using Environment Variables in ReactJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在ReactJS中使用环境变量</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/using-environment-variables-in-reactjs-9ad9c5322408?source=collection_archive---------1-----------------------#2019-11-04">https://betterprogramming.pub/using-environment-variables-in-reactjs-9ad9c5322408?source=collection_archive---------1-----------------------#2019-11-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d21" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么需要它们以及如何使用它们</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fe8e7f1346c7b925183f60d0841f4549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEu705A3H9zm7_9Q2ot6rA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·米尔利亚在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="de89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您正在使用ReactJS并正在访问某个API端点，您可能会遇到环境变量。在本教程中，我将带您了解如何使用环境变量。</p><p id="1852" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设:您熟悉<a class="ae ky" href="https://create-react-app.dev/d" rel="noopener ugc nofollow" target="_blank"> Create React App </a>，并使用它来创建您的React应用程序。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="01f0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为什么需要环境变量</h1><p id="5925" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">您需要环境变量做两件事:</p><ol class=""><li id="e96f" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">存储敏感信息。像API密匙和密码这样的东西是高度敏感的，你不应该把它们推到版本控制中。在将变量添加到<code class="fe ni nj nk nl b">.env</code>文件之后，将<code class="fe ni nj nk nl b">.env</code>文件添加到<code class="fe ni nj nk nl b">.gitignore</code>文件，以确保它们不会被暴露(我们将在后面讨论)。如果你正在使用GitHub，它会告诉你是否不小心推送了敏感信息，但是你不应该依赖它。</li><li id="ed76" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">根据您的环境定制变量，例如它是在生产、开发还是暂存环境中，等等。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/208c181bb7096f183c9dff17b97178d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTFle_02FzReJXXh6DskeQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GitGuardian在无意中暴露了一个API密钥后拯救了我</p></figure><p id="1e66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Create React App支持自定义环境变量，无需安装任何其他包。</p><p id="2681" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">添加环境变量有两种方法:</p><ol class=""><li id="8007" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">通过shell(临时的，与shell会话持续的时间一样长，并根据操作系统类型而有所不同)。</li><li id="b7be" class="mz na it lb b lc nm lf nn li no lm np lq nq lu ne nf ng nh bi translated">使用<code class="fe ni nj nk nl b">.env</code>文件(这是我们将要使用的方法)。</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4ffd" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如何使用？包封/包围（动词envelop的简写）</h1><p id="12af" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><strong class="lb iu">第一步:</strong>转到应用程序的根文件夹，创建一个名为<code class="fe ni nj nk nl b">.env</code>的文本文件。您的工作目录将如下所示:</p><pre class="kj kk kl km gt ns nl nt nu aw nv bi"><span id="e864" class="nw md it nl b gy nx ny l nz oa">my-react-app/ <br/> |-node-modules/<br/> |-src/<br/> |-public/<br/><strong class="nl iu"> |-.env<br/></strong> |-gitignore<br/> |-package.json<br/> |-package.lock.json.<br/> |-README.md</span></pre><p id="4ebc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二步:</strong>创建您的自定义变量。Create React App(CRA)在每个自定义变量上强制使用前缀<code class="fe ni nj nk nl b">REACT_APP</code>。请注意，没有前缀的变量在绑定过程中会被忽略。如果你想知道CRA是如何做到这一点的，请点击这里查看他们的文档。</p><pre class="kj kk kl km gt ns nl nt nu aw nv bi"><span id="b50e" class="nw md it nl b gy nx ny l nz oa">REACT_APP_CLIENT_ID=jfjffffaddfeettgydgdffv<br/>REACT_APP_KEY=aaddddawrfffvvvvssaa</span></pre><p id="9283" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三步:</strong>将它们赋给变量，打印到屏幕上等等，但是它们在你的Javascript文件中是只读的。</p><pre class="kj kk kl km gt ns nl nt nu aw nv bi"><span id="a2ad" class="nw md it nl b gy nx ny l nz oa">console.log(process.env.REACT_APP_CLIENT_ID); console.log(process.env.REACT_APP_KEY);</span></pre><p id="dfba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第四步:</strong>有一个内置的环境变量叫做<code class="fe ni nj nk nl b">NODE_ENV</code>。你可以从<code class="fe ni nj nk nl b">process.env.NODE_ENV</code>进入。该变量根据您当前所处的模式而变化。运行<em class="ob"> </em> <code class="fe ni nj nk nl b">npm start</code>时，等于‘开发’，运行<code class="fe ni nj nk nl b">npm test</code>时，等于‘测试’，运行<strong class="lb iu"> <em class="ob"> </em> </strong> <code class="fe ni nj nk nl b">npm run build</code>时，等于‘生产’。这个变量很特殊，因为它可以用于根据您的模式访问不同的环境配置。例如，如果您的生产和开发有不同的数据库(通常是为了防止干扰)，您可以使用它来有条件地访问某些变量。您不能手动覆盖<code class="fe ni nj nk nl b">NODE_ENV</code>的事实防止了开发人员意外地将开发构建部署到生产中。关于这个用例的更多信息可以在<a class="ae ky" href="https://dev.to/jam3/managing-env-variables-for-provisional-builds-h37" rel="noopener ugc nofollow" target="_blank">这个很棒的教程中找到。</a></p><p id="93b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第五步</strong>:打开<code class="fe ni nj nk nl b">.gitignore</code>文件。我喜欢把<code class="fe ni nj nk nl b">.env</code>和其他环境变量放在<code class="fe ni nj nk nl b">#misc</code>下面，如下所示。</p><pre class="kj kk kl km gt ns nl nt nu aw nv bi"><span id="07de" class="nw md it nl b gy nx ny l nz oa"># dependencies <br/>/node_modules </span><span id="97d9" class="nw md it nl b gy oc ny l nz oa"># testing <br/>/coverage </span><span id="efd9" class="nw md it nl b gy oc ny l nz oa"># production <br/>/build </span><span id="3d8a" class="nw md it nl b gy oc ny l nz oa"># misc <br/>.DS_Store <br/>.env    #&lt;--------Put the custom env files here <br/>.env.local <br/>.env.development.local <br/>.env.test.local <br/>.env.production.local </span><span id="06ea" class="nw md it nl b gy oc ny l nz oa">npm-debug.log* <br/>yarn-debug.log* <br/>yarn-error.log*</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="618f" class="nw md it bd me od oe dn mi of og dp mm li oh oi mo lm oj ok mq lq ol om ms on bi translated">为什么即使遵循这些流程，它还是不起作用？</h2><ul class=""><li id="57fa" class="mz na it lb b lc mu lf mv li oo lm op lq oq lu or nf ng nh bi translated">确保在每个变量上都使用了前缀<code class="fe ni nj nk nl b">REACT_APP</code></li><li id="4fdc" class="mz na it lb b lc nm lf nn li no lm np lq nq lu or nf ng nh bi translated">确认<code class="fe ni nj nk nl b">.env</code>文件上的变量名与js文件上的变量名匹配。例如，<code class="fe ni nj nk nl b">REACT_APP_KEY</code>在。环境与<code class="fe ni nj nk nl b">process.env.REACT_APP_KEY</code></li><li id="e136" class="mz na it lb b lc nm lf nn li no lm np lq nq lu or nf ng nh bi translated">如果开发服务器正在运行，停止它，然后使用<em class="ob"> npm start </em> it重新运行。我真的很纠结这个(变量是<em class="ob">未定义</em>错误)。</li><li id="71b1" class="mz na it lb b lc nm lf nn li no lm np lq nq lu or nf ng nh bi translated">每次更新。env文件，您需要停止服务器并重新运行它，因为环境变量只在构建期间更新(变量是<em class="ob">未定义的</em>错误)。</li><li id="824e" class="mz na it lb b lc nm lf nn li no lm np lq nq lu or nf ng nh bi translated">从变量值中删除引号。</li></ul><pre class="kj kk kl km gt ns nl nt nu aw nv bi"><span id="8a97" class="nw md it nl b gy nx ny l nz oa">Wrong </span><span id="428c" class="nw md it nl b gy oc ny l nz oa">REACT_APP_KEY=”AHEHEHR”</span><span id="0d5e" class="nw md it nl b gy oc ny l nz oa">Right</span><span id="ab8b" class="nw md it nl b gy oc ny l nz oa">REACT_APP_KEY=AHEHEHR</span></pre><p id="f29f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="ob">注意</em> </strong> <em class="ob">:将敏感内容放在环境变量中并不能保证它们的安全。它们在构建过程中被注入到捆绑文件中，因此任何人都可以通过检查您的文件来查看它们。我发现它们最大的用途是在将我的代码推送到远程存储库之前隐藏信息。</em></p><p id="fe7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Create React App环境变量的官方文档可以在<a class="ae ky" href="https://create-react-app.dev/docs/adding-custom-environment-variables/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>