<html>
<head>
<title>Writing Serverless Business Logic With Hasura Actions and Azure Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Hasura动作和Azure函数编写无服务器业务逻辑</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/writing-serverless-business-logic-with-hasura-actions-and-azure-functions-505c7c9f743b?source=collection_archive---------12-----------------------#2022-02-02">https://betterprogramming.pub/writing-serverless-business-logic-with-hasura-actions-and-azure-functions-505c7c9f743b?source=collection_archive---------12-----------------------#2022-02-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2af1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在NET 6和C#中用Azure函数为Hasura设置无服务器后端</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b66520db0a5347a12e61ffe4b255ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wc9p-JcjN16rbeqy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5053" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://hasura.io/" rel="noopener ugc nofollow" target="_blank"> Hasura </a>有很多好处。您有一个中央网关，通过它您可以同时连接到许多后端服务，包括SQL数据库、GraphQL端点或REST端点，并且一切都可以使用<a class="ae ky" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL语言</a>进行查询。</p><p id="5ce6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Hasura操作，您可以实现自定义逻辑，这可以由GraphQL变异或查询调用。您必须为此设置一个REST端点，它需要能够被Hasura访问。你可以选择设置一个一直运行的服务器，或者简单地设置一个不浪费资源的无服务器功能。</p><p id="52cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，每种变体都有其优缺点，但这是另一个话题，我将在以后讨论。在这个展示中，我将向你展示如何建立一个<a class="ae ky" href="https://azure.microsoft.com/en-us/services/functions/" rel="noopener ugc nofollow" target="_blank"> Azure函数</a>，它可以处理来自Hasura的调用，并将作为你的后端逻辑。我就用<a class="ae ky" href="https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-6" rel="noopener ugc nofollow" target="_blank">。NET 6 </a>和C#为例，不过，你当然可以自由选择另一种语言。</p><p id="32bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您还没有使用过Hasura，<a class="ae ky" href="https://medium.com/@tobias.streng/hasura-graphql-and-auto-code-generation-with-angular-2e6321e4d532" rel="noopener">这里的</a>是我的另一篇文章，它涵盖了在Angular中设置Hasura演示和自动为GraphQL客户端生成类型脚本代码。</p><h1 id="7075" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">概观</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/ad67cae637a41acce2b7ef1f7296f345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Crd8S-RFDro4tr-x43pEPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">架构概述</p></figure><p id="94ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图展示了这个陈列柜的结构。当你建立一个<a class="ae ky" href="https://cloud.hasura.io/" rel="noopener ugc nofollow" target="_blank"> Hasura Cloud </a>时，Hasura托管在<a class="ae ky" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">Amazon Web Services</a>Cloud上，这是默认环境。PostgreSQL数据库和我们的无服务器Azure Functions应用程序托管在Microsoft Azure Cloud上。</p><p id="0c9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个showcase的Azure Functions应用程序的代码可以在我的Github <a class="ae ky" href="https://github.com/TobiStr/Demo.Hasura.AzureFunctions" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="5915" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Azure功能的初始设置</h1><p id="b293" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">设置Azure函数非常简单。如果你还没有Azure帐户，我建议你注册并自己尝试一些东西。大多数Azure云计算环境都可以免费测试。此外，微软为你提供免费课程，通常包括一个沙盒，你可以尝试任何东西，而不用担心账单。</p><p id="ffb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要添加Azure功能，请登录您的Azure门户，然后点击<strong class="lb iu">创建资源</strong>。在搜索栏中搜索<strong class="lb iu">功能App </strong>，点击<strong class="lb iu">创建</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/a5e9af8d01eedc40e58f257124cafeb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ED3X-CeDFuXctPn73oNxxw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建功能应用程序</p></figure><ul class=""><li id="4d54" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">在此表单中选择一个资源组，如果还没有资源组，请创建一个。</li><li id="a553" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">输入一个全球唯一的名称，因为Azure将根据该名称为您创建一个公共地址。</li><li id="4e8c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">根据您的首选语言选择一个运行时堆栈，并为运行时选择一个版本。</li><li id="fb08" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">选择您希望托管应用的地区。</li></ul><p id="2ab0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击<strong class="lb iu">下一个:托管</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/b1397859e9c3405977786eec647f3b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xACYnCtXh2LEVkrjps9XjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托管设置</p></figure><ul class=""><li id="b525" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">选择或创建新的存储帐户。</li><li id="a58d" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">选择您的首选操作系统。</li><li id="90af" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">选择<strong class="lb iu">消费(无服务器)</strong>作为您的计划类型。这只会在使用时汇总成本。</li></ul><p id="a9fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ni">你还不需要担心成本，因为</em> <a class="ae ky" href="https://azure.microsoft.com/en-us/pricing/details/functions/" rel="noopener ugc nofollow" target="_blank"> <em class="ni"> Azure Functions消费计划</em> </a> <em class="ni">非常便宜，而且一开始就有100万个免费请求。</em></p><p id="38eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你可以点击<strong class="lb iu"> Review + create </strong>来创建你的第一个Azure函数！</p><h1 id="98f7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Azure函数编程</h1><p id="5d6e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在，让我们进入编码部分。如果你已经安装了带有Azure扩展的Visual Studio，你可以简单地从你的<strong class="lb iu">创建项目</strong>对话框中选择Azure Functions模板。否则，您可以通过CLI 创建一个新项目<a class="ae ky" href="https://docs.microsoft.com/en-us/azure/azure-functions/create-first-function-cli-csharp" rel="noopener ugc nofollow" target="_blank">。我推荐使用Azure扩展，因为这也将使发布变得更容易。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6c29222ac41aca2acfd506a514e7b13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*UfaXcDO1dXp6nkIg_-D5AA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Azure函数模板</p></figure><p id="74d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在设置过程中，系统会询问您想要创建什么类型的功能。选择Http触发器和授权级别:函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/e3d0fb04b7d6c57e168fbf85b4ae35d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KkftJR7ZL1-R8DSZWWqC6g.png"/></div></div></figure><p id="245d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">授权级别<strong class="lb iu"> Function </strong>意味着，你的Functions App默认会受到一个秘密的保护。只有知道这个秘密或者具有有效认证头的客户端可以调用该函数。</p><p id="91b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建项目后，你将面对一个名为<strong class="lb iu"> Function1 </strong>的演示功能。这是作为静态函数实现的。然而，我总是更喜欢非静态类，因为这允许我使用依赖注入，并在我的项目中使用一些依赖:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/7d10d64459c48099606146166bce96cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1Xks0BQtbkPy9WGcKN4sg.png"/></div></div></figure><p id="943c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数<strong class="lb iu"> Run </strong>上面的属性被Azure用来生成这个函数的端点URL，例如<code class="fe nm nn no np b">https://hasura-actions-demo.azurewebsites.net/api/hasura-demo-action</code>。</p><p id="8690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够使用微软的依赖注入，您首先需要添加以下包:</p><ul class=""><li id="e13d" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated"><a class="ae ky" href="https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection/" rel="noopener ugc nofollow" target="_blank">微软。扩展. DependencyInjection </a></li><li id="6642" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><a class="ae ky" href="https://www.nuget.org/packages/Microsoft.Azure.Functions.Extensions/" rel="noopener ugc nofollow" target="_blank">微软。Azure.Functions.Extensions </a></li></ul><p id="f445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">直接在项目文件夹下创建一个名为<strong class="lb iu"> Startup </strong>的类，并添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="f5e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过该属性，Azure Functions应用程序主机知道使用什么作为启动逻辑，因此您可以在这里将您的依赖项添加到IoC容器。</p><p id="b1c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，要开始实现一个可以被Hasura调用的函数，我们需要了解来自Hasura Actions的调用是什么样子的。对于这个问题，我们看一下<a class="ae ky" href="https://hasura.io/docs/latest/graphql/core/actions/action-handlers.html" rel="noopener ugc nofollow" target="_blank">文档</a>，发现它是一个JSON序列化对象，包含四个对象:</p><ul class=""><li id="acb8" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">动作名称</li><li id="f910" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">来自Hasura的会话变量</li><li id="33cc" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">输入数据</li><li id="2ddd" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">和原始请求查询</li></ul><p id="9d3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我选择实现一个泛型类型，我们可以反序列化来自Hasura的每个调用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">HasuraActionPayload类型定义</p></figure><p id="9925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们不需要原始查询，所以可以放心地忽略它。如果你愿意，你也可以实现一个Hasura动作，它没有输入负载，这就是为什么我在这里还添加了一个非泛型类型。</p><p id="3593" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以使用这个类型来反序列化HttpRequest，它将由Hasura传递给我们的函数。</p><h1 id="7bc6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建一个Hasura操作</h1><p id="7c97" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要创建新的操作，您必须在您的Hasura Cloud仪表盘上点击<strong class="lb iu">操作</strong> → <strong class="lb iu">创建</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/74692b96c34b18888e0d457b1ec98b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*2hY829g02UZnpBIyLo3nuQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建行动</p></figure><p id="dd45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将出现一个对话框，您必须在其中输入一个<strong class="lb iu">动作定义</strong>。您可以在这里输入以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/d678419d5c6a144122c49bf777e8f406.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*zd0PGWcTg6LsbEJLMPsv3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">突变定义</p></figure><ul class=""><li id="0243" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">作为类型，可以输入<strong class="lb iu">查询</strong>或<strong class="lb iu">突变</strong>。</li><li id="7c57" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">下一个字符串是操作的名称</li><li id="9261" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">在括号中插入参数，这些参数将被传递给你的查询，然后传递给Azure Functions应用程序。</li><li id="4512" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">在“:”之后，您可以输入结果类型</li></ul><p id="19a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在动作定义的旁边，您必须定义您想要在您的动作中使用的<strong class="lb iu">类型</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/68bf959bcfa818605442cfae2edb48e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*ka-Rbtp8yz2r4KHIKv30Ug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">类型定义</p></figure><p id="c8f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我强烈推荐使用单个参数，并且总是为你的输入创建一个自定义类型。通过这种方法，当您更改输入时，您的自动代码生成器将简单地为您生成输入类型，您不必更改太多代码。</p><p id="27f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于处理程序，您将需要输入您的函数的URL，然后是秘密，这将由Azure自动创建。在下一步，我们将看到如何上传我们的功能应用到Azure，并获得网址和秘密。</p><p id="d74d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，保存你在Hasura上的操作，继续从上面打开Azure Functions应用程序项目。</p><h1 id="65b6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在Azure上托管一个功能应用</h1><p id="6cb5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在我们准备将我们的应用程序发布到Azure之前，我们首先需要实现我们的业务逻辑。</p><p id="8adc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们在单独的文件中定义请求和结果类型。正如我正在使用的。NET 6，我可以只使用记录类型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3cef65c315dc2ddd79ed614667fcb150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*zCXKY1AJYbQF1Rt-5Ihb1Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Hasura请求和结果类型</p></figure><p id="b2dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了反序列化来自Hasura的请求，我们的代码将如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终函数定义</p></figure><p id="f555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这些代码，我们就可以将我们的函数应用发布到Azure了。为此，您可以右键单击您的项目并选择<strong class="lb iu"> Publish </strong>。</p><ul class=""><li id="3fe8" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">会出现一个对话框，你可以选择<strong class="lb iu"> Azure。</strong></li><li id="6038" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">在下一个窗口中，根据您在Azure上的功能应用中的设置，选择<strong class="lb iu"> Azure功能应用(Windows/Linux) </strong>。</li><li id="92ea" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">现在选择您的订阅，以及我们在上面创建的功能应用程序。</li></ul><p id="5516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择<strong class="lb iu">完成</strong>和<strong class="lb iu">发布</strong>。你的应用现在将上传并托管在Azure上。</p><h1 id="c04d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">和哈苏拉连线</h1><p id="ba44" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">最后一步是填写动作的处理程序URL，我们在上面的Hasura中定义了它。获取URL登录到您的Azure门户并导航到您的功能应用。</p><p id="f5ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击<strong class="lb iu">功能</strong> → <strong class="lb iu">功能</strong>，在现在出现的窗口中选择您的HTTP触发功能。在此面板上选择<strong class="lb iu">获取功能Url </strong>，您将看到Url，后面是您的<strong class="lb iu">功能授权级别</strong>自动生成的密码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/2e057378733f1e014c103256c5938ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zQFTsyZhRPDpstEsFsEWQ.png"/></div></div></figure><p id="fa6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制这个URL并将其粘贴到Hasura动作定义中。</p><p id="b132" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧，您已经成功地为Hasura设置了一个Azure函数作为动作处理程序。</p><p id="3e91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Hasura上API窗格下的GraphiQL Explorer来测试您新创建的变异:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/76178e48690380df765e8b2ceed12834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoB82VLxN_ZGZmghI_8-aw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成功执行突变</p></figure><p id="503a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">顺便说一下，如果你想调试你的函数，你可以使用Visual Studio或者看看Azure上你的函数应用下的<strong class="lb iu">监控</strong> → <strong class="lb iu">日志流</strong>功能。当函数成功执行时，输出应该是这样的:</p><pre class="kj kk kl km gt ny np nz oa aw ob bi"><span id="9e42" class="oc lw it np b gy od oe l of og">2022-02-01T19:36:50.384 [Information] Executing 'hasura-demo-action' (Reason='This function was programmatically called via the host APIs.', Id=04b3a0c7-4a89-48af-952c-d20528467c20)</span><span id="0b07" class="oc lw it np b gy oh oe l of og">2022-02-01T19:36:50.385 [Information] Executed 'hasura-demo-action' (Succeeded, Id=04b3a0c7-4a89-48af-952c-d20528467c20, Duration=1ms)</span></pre><h1 id="1c80" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">后续步骤</h1><p id="408b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">从现在开始，你有可能在Azure Functions应用中实现你的整个业务逻辑。这种设置具有向上扩展的能力，因此您不会受到后端性能不佳的影响。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="bf35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您花时间阅读这篇文章。我希望，你会觉得它有知识性、教育性和趣味性。非常感谢您的支持和参与。</p><p id="2403" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有兴趣了解干净架构、干净编码和最新技术栈的最新趋势、技巧和诀窍，尤其是在C#环境中。净和有棱角——如果你考虑跟踪我，我会很感激。</p><p id="5f27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">祝你有美好的一天！</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/429378e6a7aee01df92851fb0e90e385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fK4zVN8TtnIM37dhEhE54g.png"/></div></div></figure><p id="2357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你还没有每天使用媒体来增长你的知识，现在是开始的最佳时机！借助Medium，您可以轻松获得更多关于高度专业的主题的知识，发布高质量的内容，并接触到更广泛的受众。要开始，只需使用以下链接创建一个中型帐户:</p><p id="28a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/@tobias.streng/membership" rel="noopener"> <em class="ni">加入中现</em> </a></p><p id="cb60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这样做，你将获得一个强大的平台，可以帮助你联系新的作者和读者，每天学习新的东西。</p></div></div>    
</body>
</html>