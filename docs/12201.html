<html>
<head>
<title>Elixir API for NEAR Blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适用于近区块链的Elixir API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/elixir-api-for-near-blockchain-b3c2c112dbb8?source=collection_archive---------16-----------------------#2022-05-18">https://betterprogramming.pub/elixir-api-for-near-blockchain-b3c2c112dbb8?source=collection_archive---------16-----------------------#2022-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fc58" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我的第一次体验是在区块链附近的</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/5643ffd374ebb614b1461000248186ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88ylhO2NGZ5KMjeP_8f7LQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">酏剂的近似API</p></figure><p id="9da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">我叫亚历克斯，我为区块链附近的</em>  <em class="lv">创造了</em> <a class="ae ki" href="https://github.com/alexfilatov/near-api-ex" rel="noopener ugc nofollow" target="_blank"> <em class="lv">仙丹API。我希望这对你有用，如果你有任何问题，请联系我。</em></a></p><p id="c9ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我承认——我通常不写文章，但我真的想和你分享我的成就，因为我对最终结果很满意！那是我第一次在区块链附近体验<a class="ae ki" href="https://near.org" rel="noopener ugc nofollow" target="_blank">，我在建造这个图书馆的时候非常兴奋。</a></p><p id="c777" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想直接跳到代码示例，跳过我的故事和对附近区块链的赞美，向下滚动到“用法和代码示例”。</p><h1 id="db37" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">为什么我需要Elixir API用于近</strong></h1><p id="b872" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">有一天，我的一个朋友告诉我，他正在开发一款回合制战略游戏，看起来像是《部落冲突》,这款游戏将在区块链附近开发。我问为什么我们有以太坊和智能合约？他的回答是:“想象一下，你的区块链交易在几毫秒内就完成了，而且不花你10美元，只是零头”。我是(现在仍然是)区块链开发的新手，但是我听说以太坊有这样的问题——缓慢而昂贵的交易。</p><p id="f5f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我决定为自己做点什么，我的选择是一个简单的实时多人TicTacToe游戏，有锦标赛和奖金(剧透:最终我建立了smth else)。</p><p id="489f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设游戏必须是有大量并发用户的实时游戏，我决定Elixir将是这项工作的正确工具，我开始在谷歌上搜索Elixir world能给我提供什么，但什么也没有。嗯，听起来像是一个连接两个伟大世界的好机会——具有所有可伸缩性和强大容错能力的Elixir，以及附近一个真正快速和廉价的区块链，因为智能合同而具有巨大的可能性。</p><p id="191a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将这两者结合起来应该会给我们带来很棒的东西！</p><h1 id="2e6a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">什么是接近协议</h1><p id="3dc4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我假设你们都有软件开发经验，听说过Elixir，并且知道<a class="ae ki" href="https://curiosum.com/blog/why-elixir-phoenix-great-choice-for-modern-web-app" rel="noopener ugc nofollow" target="_blank">为什么Elixir和Phoenix这么棒</a>，那么让我来讲几句关于NEAR Protocol的事情。</p><p id="fafa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NEAR——这是一款可扩展、快速且廉价的区块链，在Rust和AssemblyScript中有<a class="ae ki" href="https://docs.near.org/docs/develop/contracts/overview" rel="noopener ugc nofollow" target="_blank">智能合约。</a></p><p id="35a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我喜欢接近<a class="ae ki" href="https://www.investopedia.com/terms/g/gas-ethereum.asp" rel="noopener ugc nofollow" target="_blank">气</a>价/成交价。</p><p id="1c8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，你有一个区块链，你应该支付大约10美元来完成交易。你将不得不把它包含在你项目的商业模式中，并最终以用户为代价。这不是你想对你的用户做的事情，如果你想在以太坊上构建，这是一个真正的挑战。</p><p id="d3bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了NEAR就便宜多了——交易成本低于0.1美元。如果我们谈论数字，在写这篇文章的时候，以太坊交易的平均价格是<a class="ae ki" href="https://etherscan.io/gastracker" rel="noopener ugc nofollow" target="_blank">$ 6-$ 180</a>，在附近是<a class="ae ki" href="https://explorer.near.org/transactions/5PAesxLE1ZeKwJ5g2DyoJFEkmk6FZ5VfBdwzPgdjHbmp" rel="noopener ugc nofollow" target="_blank"> ~$0.017 </a>，差别很大，嗯？</p><p id="257b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我喜欢NEAR中添加交易的速度。NEAR平台有一个“时钟”——几乎每秒钟在区块链产生一个新的区块。这允许限制天然气价格和更快地提交区块。NEAR拥有<a class="ae ki" href="https://near.org/blog/near-launches-nightshade-sharding-paving-the-way-for-mass-adoption/" rel="noopener ugc nofollow" target="_blank">分片设计</a>和1秒的小块，添加交易的速度非常快。</p><p id="40d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，智能合约在<a class="ae ki" href="https://www.rust-lang.org" rel="noopener ugc nofollow" target="_blank"> Rust </a>和<a class="ae ki" href="https://www.assemblyscript.org" rel="noopener ugc nofollow" target="_blank"> AssemblyScript </a>中。这两种语言在合同中使用都很简单，而且有很多例子。</p><h1 id="9aba" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">用法和代码示例</h1><p id="00f1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">好了，聊够了，怎么用这个，你说的代码示例在哪里？</p><p id="6ddc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在编程级别上使用区块链总是与块和事务有关——您可以<strong class="lb iu">查看</strong>现有事务，也可以创建一个新的事务，通过添加您的事务来<strong class="lb iu">修改</strong>区块链。</p><h2 id="e12f" class="mt lx it bd ly mu mv dn mc mw mx dp mg li my mz mi lm na nb mk lq nc nd mm ne bi translated">“视图-区块链”示例</h2><p id="e0bd" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要查看区块链事务，您并不总是需要访问键，一些NEAR APIs允许您使用<a class="ae ki" href="https://github.com/alexfilatov/near-api-ex#near-api-rpc-functions" rel="noopener ugc nofollow" target="_blank"> RPC函数</a>查看没有键的块和事务。</p><p id="51e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，要查看一个现有的块，你需要调用<code class="fe nf ng nh ni b"><a class="ae ki" href="https://docs.near.org/docs/api/rpc/block-chunk" rel="noopener ugc nofollow" target="_blank">Block</a></code> RPC函数。</p><p id="25ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们告诉我们的库我们将使用哪个网络:<code class="fe nf ng nh ni b">export NEAR_NODE_URL=<a class="ae ki" href="https://rpc.testnet.near.org" rel="noopener ugc nofollow" target="_blank">https://rpc.testnet.near.org</a></code>——这是<code class="fe nf ng nh ni b">testnet</code></p><p id="bc88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后仅仅简单的调用<code class="fe nf ng nh ni b">NearApi.RPC.Block.block()</code>就给出了区块链最新确认区块的丰富信息(我截断了响应，实际上会有更多):</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e19a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API中有更多的仅供查看的<a class="ae ki" href="https://github.com/alexfilatov/near-api-ex#near-api-rpc-functions" rel="noopener ugc nofollow" target="_blank"> RPC函数，</a>我为它们中的每一个创建了一个<a class="ae ki" href="https://livebook.dev" rel="noopener ugc nofollow" target="_blank"> Livebook </a>示例，因此您将能够在本地(或在<a class="ae ki" href="https://fly.io/launch/livebook" rel="noopener ugc nofollow" target="_blank"> Fly.io </a>上)运行它们，并查看来自附近RPC API的实时响应。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nl"><img src="../Images/7d205609bd9896a84ac4366d8bdc70eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Gz4_uwQFqohu1ge-IcOGg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">NearApi的Livebook示例。RPC.Block.block/2</p></figure><h2 id="4d97" class="mt lx it bd ly mu mv dn mc mw mx dp mg li my mz mi lm na nb mk lq nc nd mm ne bi translated">“修改-区块链”示例</h2><p id="8b99" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要在NEAR中创建一个新的交易，你需要被“认证”——区块链需要有一个交易的所有者。换句话说，您需要一个签名者密钥对(公共和私有)，这样您就可以在将事务发送到区块链之前对其进行签名。要获得密钥对，您需要<a class="ae ki" href="https://wallet.near.org/create" rel="noopener ugc nofollow" target="_blank">创建一个近距离钱包</a>。</p><p id="e999" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于签名者密钥，重要的是它们有两种类型:</p><ul class=""><li id="3a06" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">Full Access Keys</code>，当你创建一个钱包时，你会得到一个，它存储在你的浏览器中。</li><li id="b6c4" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">FunctionCall Access Keys</code>，这样你就可以给一个智能合约有限的访问你钱包的权限，而不可能转移附近的代币。<br/> ( <a class="ae ki" href="https://docs.near.org/docs/concepts/access-keys" rel="noopener ugc nofollow" target="_blank">关于访问键的更多信息</a>)</li></ul><p id="0770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您创建钱包时，NEAR平台会将FullAccess KeyPair存储在您的浏览器存储器中，因此您将能够在您的浏览器中签署交易:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oa"><img src="../Images/0526ea594f995fd7ab04e049f47b52dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NaVSDnCt0Q6Voa6xf05Wcg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">Safari储物盒，带有近钱包钥匙</p></figure><h2 id="4a02" class="mt lx it bd ly mu mv dn mc mw mx dp mg li my mz mi lm na nb mk lq nc nd mm ne bi translated">发送邻近令牌示例</h2><p id="f1f5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">作为一个例子，让我们发送一些附近的令牌。你需要一把<code class="fe nf ng nh ni b">FullAccess</code>钥匙来做那件事。为了获取<code class="fe nf ng nh ni b">FullAccess</code>密钥，您可以从浏览器存储器中获取密钥，如上图所示，或者在CLI 附近使用<a class="ae ki" href="https://github.com/near/near-cli" rel="noopener ugc nofollow" target="_blank">登录，并从本地文件存储器中获取密钥，例如，如果您的NEAR Wallet <code class="fe nf ng nh ni b">testnet</code>地址为<code class="fe nf ng nh ni b">mintbot.testnet</code>，您的密钥文件将位于此处:<br/> <code class="fe nf ng nh ni b">~/.near-credentials/testnet/mintbot.testnet.json</code>，其内容如下:</a></p><pre class="kk kl km kn gt ob ni oc od aw oe bi"><span id="f020" class="mt lx it ni b gy of og l oh oi">{<br/>  "account_id": "mintbot.testnet",<br/>  "public_key": "ed25519:XXXXXXXXXXXXXXXXXXX",<br/>  "private_key": "ed25519:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"<br/>}</span></pre><p id="7ebb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的mix项目中，您可以执行以下操作来发送NEAR令牌，并且不要忘记添加<code class="fe nf ng nh ni b">{:near_api, "~&gt; 0.1"}</code>作为依赖项:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">仙丹近API送钱示例</p></figure><p id="7ae5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成功的结果将是创建一个JSON，其中包含所有关于交易和收据的信息。</p><p id="453a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是<a class="ae ki" href="https://github.com/alexfilatov/near_api/blob/main/notebooks/near_api/account.livemd" rel="noopener ugc nofollow" target="_blank">发送令牌Livebook </a>示例，您可以在本地尝试响应。</p><h2 id="0822" class="mt lx it bd ly mu mv dn mc mw mx dp mg li my mz mi lm na nb mk lq nc nd mm ne bi translated">近似智能合同呼叫示例</h2><p id="76ff" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">称之为智能合同——这是改变区块链状态的另一种方式。这是一种特殊类型的近距离交易— <code class="fe nf ng nh ni b">FunctionCall</code>。NEAR中的智能契约有自己的地址，例如<code class="fe nf ng nh ni b">nft.mintbot.com</code>和我们可以调用的方法列表。</p><p id="1660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">签署<code class="fe nf ng nh ni b">FunctionCall</code>交易多数情况下不需要<code class="fe nf ng nh ni b">FullAccess</code>键，<code class="fe nf ng nh ni b">LimitedAccess</code>键就够了。</p><p id="c95a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Elixir NEAR API有一个调用智能合约的函数:</p><pre class="kk kl km kn gt ob ni oc od aw oe bi"><span id="4726" class="mt lx it ni b gy of og l oh oi">{:ok, result} = <br/>  NearApi.Contract.call(<br/>    caller_account, <br/>    contract_address,<br/>    contract_function,<br/>    function_params<br/>  )</span></pre><p id="e073" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个调用Mintbot智能合约的例子。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">Elixir NEAR API函数调用示例</p></figure><p id="58b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数的参数是:</p><ul class=""><li id="a97e" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">caller_account</code> —进行函数调用的账户</li><li id="5008" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">"nft.mintbot.near"</code> —智能合同的地址</li><li id="91b1" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">nft_mint</code> —智能合约的功能</li><li id="a0ce" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><code class="fe nf ng nh ni b">params</code> —您正在传递的智能合约函数的参数</li></ul><p id="83b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于<code class="fe nf ng nh ni b">FunctionCall</code>的更多细节，你可以点击<a class="ae ki" href="https://nomicon.io/RuntimeSpec/FunctionCall" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="6c96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">近<code class="fe nf ng nh ni b">FunctionCall</code>事务Livebook这里是<a class="ae ki" href="https://github.com/alexfilatov/near_api/blob/main/notebooks/near_api/contract.livemd" rel="noopener ugc nofollow" target="_blank">这里是</a>，有请求和响应示例。</p><h1 id="7d6b" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">引擎盖下是什么？</h1><p id="5ee6" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">上面所有的修改区块链的例子都使用带有一个或多个不同的<a class="ae ki" href="https://github.com/alexfilatov/near_api/tree/main/lib/actions" rel="noopener ugc nofollow" target="_blank">动作</a>的<code class="fe nf ng nh ni b"><a class="ae ki" href="https://github.com/alexfilatov/near_api/blob/main/lib/transaction.ex" rel="noopener ugc nofollow" target="_blank">NearApi.Transaction</a></code>模块&amp;结构。</p><h2 id="45f5" class="mt lx it bd ly mu mv dn mc mw mx dp mg li my mz mi lm na nb mk lq nc nd mm ne bi translated"><strong class="ak">在Elixir中创建近交易</strong></h2><p id="b1e1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">该过程包含4个步骤:</p><ol class=""><li id="5305" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu oj ns nt nu bi translated">创建交易结构</li><li id="97f5" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu oj ns nt nu bi translated">用<a class="ae ki" href="https://borsh.io" rel="noopener ugc nofollow" target="_blank"> Borsh </a>将事务序列化为二进制</li><li id="540a" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu oj ns nt nu bi translated">用您的密钥对签署交易</li><li id="5dee" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu oj ns nt nu bi translated">base64编码并将事务发送到区块链</li></ol><p id="2af5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是<code class="fe nf ng nh ni b"><a class="ae ki" href="https://github.com/alexfilatov/near_api/blob/main/lib/transaction.ex#L7" rel="noopener ugc nofollow" target="_blank">NearApi.Transaction.t()</a></code>，它包含有效交易的6个必填字段:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated"><code class="fe nf ng nh ni b"><a class="ae ki" href="https://github.com/alexfilatov/near_api/blob/main/lib/transaction.ex#L7" rel="noopener ugc nofollow" target="_blank">NearApi.Transaction.t()</a></code></p></figure><p id="6d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，基本上，NEAR中的事务是应用于区块链的动作列表，带有一些辅助信息。</p><p id="1810" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有交易都必须序列化为二进制代码，因为NEAR只接受二进制格式。我用我的<a class="ae ki" href="https://github.com/alexfilatov/borsh" rel="noopener ugc nofollow" target="_blank"> Borsh二进制串行器实现了Elixir </a>。</p><p id="0717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将交易发送到区块链，我跳过了您需要做的所有细节，您可以在源代码<a class="ae ki" href="https://github.com/alexfilatov/near-api-ex/blob/main/lib/transaction.ex" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae ki" href="https://github.com/alexfilatov/near-api-ex/blob/main/lib/account.ex#L27" rel="noopener ugc nofollow" target="_blank">这里</a>中查看，但是请查看您在发送签名序列化交易时执行的最终函数调用:</p><pre class="kk kl km kn gt ob ni oc od aw oe bi"><span id="e33b" class="mt lx it ni b gy of og l oh oi">tx =<br/>"DwAAAG1pbnRib3QudGVzdG5ldABBxGVmSnc0VBAFqP1zcbviUut4vLbS/JK9UyECT5xGUgFeAb8uTgAAGgAAAG5mdF90ZXN0MTAubWludGJvdC50ZXN0bmV0AD7PlYhteyB6OGGxA6jG557JRwkL9vKXNlXlz0VTn9cBAAAAAggAAABuZnRfbWludDoBAAB7Im1ldGFkYXRhIjp7ImNvcGllcyI6MSwiZGVzY3JpcHRpb24iOiJORlQgZm9yIG1pbnRib3QudGVzdG5ldCBieSBNaW50Ym90IiwibWVkaWEiOiJodHRwczovL2lwZnMuaW8vaXBmcy9iYWZrcmVpYndxdGFkbmMyc3A0ZHNsMmt6ZDRqemFsNGR2eWo1bWx6czJhanNnNmRteGxrdXY1YTY1ZSIsInRpdGxlIjoiTkZUIGZvciBtaW50Ym90LnRlc3RuZXQgYnkgTWludGJvdCJ9LCJyZWNlaXZlcl9pZCI6Im1pbnRib3QudGVzdG5ldCIsInRva2VuX2lkIjoibWludGJvdC1uZnQtR2VYeDZwYTRybjVNSHBGcVlKUlJLeVAxaDZzVjJtWDZBdVg2MWdNOFE2aTMifQDAbjHZEAEAAAAAAAAAAAAAAAAAAAAAAAAQ3ktoL2UqPz0oTlYklUgUsNfhhd6MbdYubdrZsdRTCwIv3cYK7+zDHyvW2gLec1NR5AsipbGy405NyqMyvV0J"<br/><br/>NearApi.RPC.Transactions.send_transaction_commit(tx)</span></pre><p id="a1f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，<code class="fe nf ng nh ni b">tx</code>这里是<code class="fe nf ng nh ni b">Ed25519</code>签名，<code class="fe nf ng nh ni b">Borsh</code>序列化成二进制，<code class="fe nf ng nh ni b">Base64</code>编码的事务。</p><p id="a915" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nf ng nh ni b">NearApi.RPC.Transactions.send_transaction_commit</code> —同步函数，将<code class="fe nf ng nh ni b">tx</code>发送给区块链，将<code class="fe nf ng nh ni b">waits</code> <strong class="lb iu"> </strong>发送给结果(异步为<code class="fe nf ng nh ni b">NearApi.RPC.Transactions.send_transaction_async</code>)</p><h1 id="8e1f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">生产中接近API的酏剂</h1><p id="fee9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">正如我之前所说，我的计划是创建一个TicTacToe游戏。但是后来，在我和来自<a class="ae ki" href="https://humanguild.io" rel="noopener ugc nofollow" target="_blank">人类协会</a>的人谈过之后，我改变了主意，决定做一个不那么复杂的东西——一个铸造NFT的工具。</p><p id="365f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际上，NEAR <a class="ae ki" href="https://examples.near.org/NFT" rel="noopener ugc nofollow" target="_blank">有制作NFT的工具</a>，但是你必须熟练才能做到，这需要一些学习曲线来安装<a class="ae ki" href="https://github.com/near/near-cli" rel="noopener ugc nofollow" target="_blank"> NEAR CLI </a>，学习命令，这不是很友好。我在这里试图解决的问题是完全消除技术方面，使铸造过程像在信使中发送图片一样简单。</p><p id="2f12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准备好Elixir API MVP(有了<code class="fe nf ng nh ni b">NearApi.RPC</code>和发送<code class="fe nf ng nh ni b">FunctionCall</code>事务的能力)后，我开始着手这个项目。</p><p id="4ac3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是<a class="ae ki" href="https://www.mintbot.me" rel="noopener ugc nofollow" target="_blank"> Mintbot </a>的诞生。mint bot——是一个聊天机器人平台，用于在区块链附近创建NFT。</p><p id="659a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用Mintbot同时瞄准了3个目标:</p><ul class=""><li id="efcf" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated">创建一个非常简单的工具来铸造NFT(观看YouTube上的演示展示<a class="ae ki" href="https://www.youtube.com/watch?v=GaGphi5Fj5o" rel="noopener ugc nofollow" target="_blank">这里</a></li><li id="6732" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">在API附近创建<a class="ae ki" href="https://github.com/alexfilatov/near_api/" rel="noopener ugc nofollow" target="_blank">酏剂的工作证明</a></li><li id="ced0" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">向<a class="ae ki" href="https://devpost.com/software/mintbot" rel="noopener ugc nofollow" target="_blank"> METABUILD Hackathon </a>提交项目并获胜(剧透:我没有赢哈哈)</li></ul><p id="7886" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我还没有准备好的Elixir API，并且需要先构建一个MVP版本的库，那么构建它是非常有趣的。我设法构建了一个版本的库，它允许组合一个事务，对它进行二进制编码，并提交给区块链。</p><p id="8a8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这足以在截止日期前成功地将<code class="fe nf ng nh ni b">Mintbot</code>项目提交给黑客马拉松了！</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="1d7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用长生不老药做了一些有趣的事情。我希望你能从我的文章中得到一些有用的东西。请让我知道你对这一切的想法。</p><h1 id="4fd6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">资源</h1><p id="0452" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">除此之外，这里还有一些关于NEAR和Elixir的好资料:</p><ul class=""><li id="c107" class="nm nn it lb b lc ld lf lg li no lm np lq nq lu nr ns nt nu bi translated"><a class="ae ki" href="https://hackmd.io/@nearly-learning/near-201" rel="noopener ugc nofollow" target="_blank">面向高级开发人员的NEAR简介</a>(基本上，这本书涵盖了开始使用NEAR所需了解的一切)</li><li id="c21f" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ki" href="https://github.com/near-examples/nft-tutorial" rel="noopener ugc nofollow" target="_blank"> NFT附近教程</a></li><li id="3db8" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ki" href="https://examples.near.org" rel="noopener ugc nofollow" target="_blank">近码示例</a></li><li id="21df" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated">如果你想从仙丹开始，你应该去这里</li><li id="1453" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ki" href="https://elixirforum.com" rel="noopener ugc nofollow" target="_blank">长生不老药论坛</a>，长生不老药开发者的好去处</li><li id="2d91" class="nm nn it lb b lc nv lf nw li nx lm ny lq nz lu nr ns nt nu bi translated"><a class="ae ki" href="http://github.com/alexfilatov/borsh" rel="noopener ugc nofollow" target="_blank">仙丹中的博什二进制连载</a></li></ul></div></div>    
</body>
</html>