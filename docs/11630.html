<html>
<head>
<title>Start Building a 3D Chess Game Using SceneKit and SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SceneKit和SwiftUI开始构建3D象棋游戏</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/start-building-a-3d-chess-game-using-scenekit-and-swiftui-3d072b025db2?source=collection_archive---------19-----------------------#2022-04-04">https://betterprogramming.pub/start-building-a-3d-chess-game-using-scenekit-and-swiftui-3d072b025db2?source=collection_archive---------19-----------------------#2022-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6808" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何构建流行的国际象棋棋盘游戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62ff0c6bcb044ed36aa1d0e908fa66b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OaPyEw_qRJOYZwHy5Llfnw.gif"/></div></div></figure><p id="3eb4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">继续调查SceneKit &amp; SwiftUI的旅程，我想我可能会尝试另一个经典。本文的目标是构建一个3D象棋游戏。</p><h2 id="bf67" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">模型</h2><p id="0836" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我开始用模型看SceneKit和SwiftUI。“usdz”格式的《星球大战》模型，它支持十几种或更多格式中的一种。</p><p id="fa13" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">SceneKit支持的格式肯定是一个移动的目标。我尝试在这个版本中使用“usdz”、“obj”格式和一个原生的“scn”。它们都可以工作，但有些比另一些更好，有一些细微的差异。例如，在“obj”模型上的Xcode编辑器中，虽然您可以更改颜色，但在渲染时这些更改不会反映出来。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="4ba8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你试图加载一个它不理解的模型，最好的情况是它会忽略你并且无法渲染——最坏的情况是它会崩溃。</p><p id="a4a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有用的提示；看看苹果开发者网站上的<a class="ae mq" href="https://developer.apple.com/augmented-reality/tools/" rel="noopener ugc nofollow" target="_blank"/>工具/应用。有一个是把不同格式的文件转换成“usdz”。</p><h1 id="a52d" class="mr lr it bd ls ms mt mu lv mv mw mx ly jz my ka mb kc mz kd me kf na kg mh nb bi translated">棋盘</h1><p id="3f24" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我最初的想法是使用一个你可以用核心图像框架构建的纹理贴图。但是因为我希望/需要能够处理每个方块，所以用黑白方格来创建白板更有意义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/ceee4073e922823e84a5864eefcb124b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JuOWchwTHzQGXGkFg17Tg.png"/></div></div></figure><p id="eeb0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你在这张图片顶部看到的绿色图标是管理棋盘位置的HUD的开始。当触发时，它们通过订阅运行操作来链接到电路板。棋盘本身是用一个简单的循环构建的，这个代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><h1 id="a138" class="mr lr it bd ls ms mt mu lv mv mw mx ly jz my ka mb kc mz kd me kf na kg mh nb bi translated">平视显示器</h1><p id="d17e" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">HUD使用Combine框架将SwiftUI接口链接到<code class="fe nd ne nf ng b">GameScene</code>类。我发现使用<code class="fe nd ne nf ng b">@Published</code> / <code class="fe nd ne nf ng b">@ObservedObjects</code>的代码模式效果更好。</p><p id="2976" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">类似这样的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><h1 id="58d2" class="mr lr it bd ls ms mt mu lv mv mw mx ly jz my ka mb kc mz kd me kf na kg mh nb bi translated">照相机</h1><p id="416c" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我认为相机是SceneKit编码中最具挑战性的方面之一。在这个项目中，我从使用。我的SceneView调用上的allowcameracontrol选项。</p><p id="06c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">设置好HUD后，我用一些选项替换了它，让你可以在棋盘上来回移动来玩不同的游戏。</p><p id="52bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我想出了两个原则动作——绕着棋盘旋转相机，然后把它带到对面。弄清楚我需要做哪些操作超出了本文的范围，这是我计划在未来讨论的主题。与此同时，下面是将棋盘前后翻转的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="acf7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">运行如下所示的代码——这里有五个动作，最初是成对并行运行，然后是单个动作，然后是另一对动作。我旋转棋盘的原因是我需要这样做，因为相机在那个点是上下颠倒的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d1eed6e82f1ad2fb2fa3aeed09fd8daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*nyPYReemzbSJrxfJaY-yrQ.gif"/></div></div></figure><h1 id="e675" class="mr lr it bd ls ms mt mu lv mv mw mx ly jz my ka mb kc mz kd me kf na kg mh nb bi translated">动作</h1><p id="e31e" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我的第一个问题是，我不能使用触摸来检测模型上的点击。我把SceneKit和SpriteKit搞混了，在sprite kit中，你可以定义一个模型，给它一个实体，然后检测与另一个实体的接触。为了检测触摸，我需要通过创建一个隐藏的节点来给每一个部分一个几何图形，在这个节点上我附加了我的模型。我最初也想象用户拿起棋子并在棋盘上拖动它，但是这样做与移动棋盘本身相冲突[两者都需要拖动]，所以我使用了一个双重动作，用户选择他想要移动的棋子，然后选择他想要移动的方格。</p><p id="0f14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很明显，在游戏的第一个版本中，我不会尝试验证你移动到了哪个方格——我相信玩家不会尝试进行非法移动。</p><p id="91e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我写这篇文章的时候，我突然想到，事实上我可以给每一个棋子和方块一个物理模型来促进不同类型的移动，作为思考的食粮，也许是后续行动。</p><p id="f2ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我没有花太多时间来说明当你拿起一块时会发生什么；我只是让它消失了，取而代之的是胜利者。更多<code class="fe nd ne nf ng b">SCNActions</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ffc15c1228c9804ff0509fe14848dfa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0olV8S8haMFDrf9yZDIsrg.gif"/></div></div></figure><h2 id="5fca" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">未来</h2><p id="9658" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">正如他们所说，我现在有了一个最低限度的可行产品，至少从演示的角度来看是这样的。根据它被接受的程度，我可能还会回到这个项目上。未来的工作包括—</p><ul class=""><li id="c996" class="nh ni it kw b kx ky la lb ld nj lh nk ll nl lp nm nn no np bi translated">在HUD上实现一个乐谱，也许还有一个片段。</li><li id="179d" class="nh ni it kw b kx nq la nr ld ns lh nt ll nu lp nm nn no np bi translated">验证所做的动作，以确保没有人作弊。</li><li id="8d06" class="nh ni it kw b kx nq la nr ld ns lh nt ll nu lp nm nn no np bi translated">实现一些网络代码，这样你就可以玩另一个玩家了。</li><li id="3b64" class="nh ni it kw b kx nq la nr ld ns lh nt ll nu lp nm nn no np bi translated">实现一个拖放类型的界面，让游戏体验更真实一点。</li><li id="f122" class="nh ni it kw b kx nq la nr ld ns lh nt ll nu lp nm nn no np bi translated">让说话/失败更加戏剧化:)</li><li id="e330" class="nh ni it kw b kx nq la nr ld ns lh nt ll nu lp nm nn no np bi translated">实现某种计算机播放器。</li></ul><p id="b173" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望您喜欢阅读它，并在这里找到一些适用的代码，您将能够在您的项目中使用。</p><pre class="kj kk kl km gt nv ng nw nx aw ny bi"><span id="8509" class="lq lr it ng b gy nz oa l ob oc"><strong class="ng iu">Want to Connect?</strong></span><span id="abfe" class="lq lr it ng b gy od oa l ob oc">Join me on <a class="ae mq" href="https://www.linkedin.com/in/mark-lucking-4631049/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a> to connect, collaborate or just a chat.</span></pre></div></div>    
</body>
</html>