<html>
<head>
<title>SSH Reverse Proxy and Tunneling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SSH反向代理和隧道</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/ssh-reverse-proxy-and-tunneling-b6d96ab2325?source=collection_archive---------6-----------------------#2020-04-15">https://betterprogramming.pub/ssh-reverse-proxy-and-tunneling-b6d96ab2325?source=collection_archive---------6-----------------------#2020-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8589" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将端口转发到本地机器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b93ab2a08574bb9b55a97de0614aac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7l9gZiLPsTsbOIbp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·赫雷斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片。</p></figure><p id="0071" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您拥有域<code class="fe lv lw lx ly b">example.com</code>并且端口<code class="fe lv lw lx ly b">22</code>作为某个虚拟机/服务器的SSH端口。这意味着您可以像这样SSH到它:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="e9ac" class="md me it ly b gy mf mg l mh mi">ssh user@example.com</span></pre><p id="4ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是宋承宪可以做得更多。它的一个特性是反向TCP代理，可以通过一个命令暴露本地设备上的端口:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="7a72" class="md me it ly b gy mf mg l mh mi">ssh -R \*:80:localhost:8080 -N root@example.com</span></pre><p id="682e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不需要<code class="fe lv lw lx ly b">-N</code>标志，也就是说我们不需要在隐藏后执行任何命令。这将适用于任何使用TCP的东西，比如web服务器、SSH端口，甚至你的<em class="mj">《我的世界》</em>服务器。</p><p id="97ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会将<code class="fe lv lw lx ly b">example.com:80</code>绑定到你的<code class="fe lv lw lx ly b">localhost:8080</code>。请记住，为了绑定到低端口(如<code class="fe lv lw lx ly b">80</code>或<code class="fe lv lw lx ly b">443</code>)，您需要以root身份使用SSH。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="8e3d" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">使用密码启用Root登录</h1><p id="61bb" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果您还想启用带密码的SSH root登录:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="2630" class="md me it ly b gy mf mg l mh mi">echo "PermitRootLogin yes" | sudo tee -a /etc/ssh/sshd_config<br/>sudo systemctl restart sshd</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="1d8d" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">绑定到所有地址</h1><p id="387c" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果您想让它在<code class="fe lv lw lx ly b">localhost</code>以外的地址上可用(例如<code class="fe lv lw lx ly b">0.0.0.0</code>让它公开可用):</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="2546" class="md me it ly b gy mf mg l mh mi">echo "GatewayPorts=clientspecified" | sudo tee -a /etc/ssh/sshd_config<br/>sudo systemctl restart sshd</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="40b1" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">启动简单的HTTP服务器</h1><p id="4f70" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果您在本地端口<code class="fe lv lw lx ly b">8080</code>上启动一个HTTP服务器，它也将在<code class="fe lv lw lx ly b">example.com</code>端口<code class="fe lv lw lx ly b">80</code>上可用:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="994a" class="md me it ly b gy mf mg l mh mi">python -m http.server 8080</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/fc58a9b46c79722e1e190e997eb6ca02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ej23oXsFcj6WrWaQqouFQg.png"/></div></div></figure></div></div>    
</body>
</html>