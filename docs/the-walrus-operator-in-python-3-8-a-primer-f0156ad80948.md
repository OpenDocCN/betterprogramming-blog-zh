# Python 3.8 中的 Walrus 算子:初级读本

> 原文：<https://betterprogramming.pub/the-walrus-operator-in-python-3-8-a-primer-f0156ad80948>

## 知道如何使用它

![](img/8c83fb5220e281b485353e9e53823ce5.png)

照片由[元素 5 数码](https://unsplash.com/@element5digital?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

尽管作为 2018 年 [Python 3.8](https://docs.python.org/3/whatsnew/3.8.html) 版本中引入的最受关注的功能之一，walrus 运算符(`:=`)对许多 Python 程序员来说仍然相当陌生。

它独特的名字第一次引起了我的注意，我想进一步了解它。虽然理解它的概念相对简单，但我花了一些时间来思考如何在实际用例中应用它。

在本文中，主要的焦点是基于我以前的一些经验来分享 walrus 操作符的应用程序。希望你会发现它们对你的理解有用。

# 它是如何工作的？

在开始潜在的用例之前，让我先为那些不熟悉这个操作符的人简单介绍一下这个操作符。根据定义，walrus 运算符`:=`将值赋给变量，作为更大表达式的一部分。

让我们来看看它的实际应用:

Walrus 操作符，通过结合赋值和 if 表达式步骤。

注意赋值步骤(`n= len(list)`)和 if 表达式(`n<10`)是如何变成代码中的一个步骤的。这就是为什么它也被称为赋值表达式，以更好地反映其功能。

注意:walrus 操作符两边的括号非常重要！

```
if n := len(lst) < 10:   ## n= True
```

在上面没有括号的表达式中，`n`保存的是`True`的值，而不是列表的长度`3`。

# 如何使用 Walrus 运算符

如前所述，让我们看一些如何使用 walrus 操作符的例子。

## 检查用户输入(if 语句)

下面是另一个带有 if 语句的例子:

然而，您可能会注意到，只允许一种猜测并不是一个很好的例子。

## 验证用户尝试(while-loop)

在这个例子中，用户将得到提示，直到输入与`valid_users`列表中的有效名称匹配。只有这样，才会打印出欢迎信息。

注意`user_answer= input()`在我们的普通代码块中是如何重复的。我希望你会同意带`:=`的第二块更干净。

嗯…也许我应该限制尝试的次数？

## 读取文件

类似地，在`while`循环中实现操作符可能如下所示:

当读取一个文件并打印文件中的行时，你不需要在代码中重复`line = fp.readline()`和`while`循环的迭代。

## 列表理解

在这个例子中，我们没有重复使用`x**2`，而是将变量`square`命名为`x**2`，并重用`square`作为存储在列表中的返回元素。

当我们有一个很长的列表和一个复杂的函数(操作)时，这特别方便。

假设我们有一个计算量非常大的函数。在传统方法中，列表中的每个值将被计算两次:一次是针对条件，一次是针对列表中的返回值(如果满足条件)。

```
[complex_func(x) for x in numbers if complex_function(x) > 100]
```

使用赋值表达式，`:=`被赋值的变量将只被计算一次。

## 字符串格式

您可以使用赋值表达式作为函数`format()`的参数的一部分，而不是预先赋值`x=4`。

然而，有些人认为这实际上可能会降低可读性。我的观点是不要过度使用它，这样你的代码变得不可读。

## 正则表达式

在最后一个例子中，您可以将这个操作符与正则表达式(regex)一起使用来识别任何模式匹配。这里有一个例子:

# 摘要

walrus 操作符`:=`(赋值操作符)是一个帮助 Python 程序员的特性:

*   避免重复的代码行
*   重新使用计算开销很大的值
*   用紧凑代码提高可读性(视情况而定。不要过度使用)

感谢您花时间阅读我的文章。你可以在 [LinkedIn](https://www.linkedin.com/in/jia-wei-teh/) 上联系我。