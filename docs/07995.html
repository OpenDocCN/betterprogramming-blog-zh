<html>
<head>
<title>What’s a Pipeline Style in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的管道风格是什么？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/whats-a-pipeline-style-in-javascript-2084b66133f0?source=collection_archive---------2-----------------------#2021-03-12">https://betterprogramming.pub/whats-a-pipeline-style-in-javascript-2084b66133f0?source=collection_archive---------2-----------------------#2021-03-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="90ad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">采用这种编程风格编写更好的函数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/264cc7c95c0267e0406ed5ce18b11e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b3Nrt7xSISVZuvz-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">米歇尔·玛特隆在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/whats-the-cookbook-style-in-javascript-be98658d5be1">上一篇关于JavaScript编程风格的文章</a>中，我讨论并演示了菜谱风格。在本文中，我将讨论管道风格，并演示如何使用它来编写一个程序，从Jonathan Swift的文本<em class="lv">一个适度的建议</em>中计算词频。</p><p id="0b49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章和我以前的文章都是基于Cristina Videira Lopes的《编程风格 中的<a class="ae ky" href="https://www.amazon.com/Exercises-Programming-Style-Cristina-Videira/dp/0367350203" rel="noopener ugc nofollow" target="_blank"> <em class="lv">练习》一书。</em></a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b0bb" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">定义的管道样式</h1><p id="f5cf" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">管道风格的最佳类比是工厂管道，例如汽车工业中使用的管道。汽车是沿着一条“传送带”一件一件地组装起来的，传送带上有完成单独任务的工位，比如安装发动机、装上车门、安装发动机罩和行李箱等。</p><p id="5bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个任务也可以由子任务组成。例如，汽车内部必须分别安装座椅、仪表板和其他部件，尽管每个任务都是整个“装配汽车内部”任务的子任务。</p><p id="68fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">流水线风格也借鉴了函数的数学理论。在数学中，函数是一个接受输入并返回唯一输出的过程。数学函数也可以由其他函数组成，使得函数<em class="lv"> f </em>可以包含函数<em class="lv"> g </em> <strong class="lb iu"> </strong>，只要这两个函数在同一个域上运算。</p><p id="48a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在编程中，使用返回值函数来开发管道样式。问题中的每个任务都被分配了一个函数，前一个函数的输出成为后一个函数的输入。所有数据都表示为函数的输入或函数的输出，但作为管道中第一个函数的输入的原始数据除外。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="029c" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">管道样式示例:Unix管道</h1><p id="369a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">软件管道的一个很好的例子是Unix <a class="ae ky" href="https://en.wikipedia.org/wiki/Pipeline_(Unix)" rel="noopener ugc nofollow" target="_blank"> pipe </a>命令。您可以使用管道将一系列程序链接在一起，这些程序从上一个程序获取输出，以某种方式转换或操作数据，并将结果发送给另一个程序。</p><p id="1bcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">软件管道的概念是在Unix的早期版本中发展起来的，但是它已经存在了很长时间。1964年，贝尔实验室的一名成员道格·麦克洛伊写了一份备忘录，概述了他对管道的概念。他在Unix诞生之初担任主管Unix开发团队的部门主管。在备忘录中，他提到应该有一些连接软件程序的方法，就像花园里的软管连接在一起，形成一条更长的软管。由此诞生了软件管道的概念。</p><p id="e252" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用于管道的Unix命令是bar ( <code class="fe na nb nc nd b">|</code>)。起初，使用了<code class="fe na nb nc nd b">&gt;</code>字符，但是后来决定这个字符更适合用于输出重定向，所以选择了<code class="fe na nb nc nd b">|</code>字符。</p><p id="af86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个在Unix中使用管道的例子。假设您想要统计所有包含单词<code class="fe na nb nc nd b">system</code>的目录条目。单独的命令是<code class="fe na nb nc nd b">ls</code>列出目录条目，<code class="fe na nb nc nd b">grep “system”</code>匹配包含<code class="fe na nb nc nd b">system</code>的行，<code class="fe na nb nc nd b">wc</code>计算行数。</p><p id="09d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是实现这一点的管道命令:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="c4e4" class="ni me it nd b gy nj nk l nl nm">ls | grep “system” | wc -l</span></pre><p id="4889" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">允许管道在Unix中工作的一个关键概念是所有文件都是文本文件。开发一组希望输入是文本而不是其他专有格式(如Word文档格式或Excel电子表格格式)的程序要简单得多。当然，您可以将Word文档和电子表格转换成其他格式，但是您失去了许多要求文件为文本文件的简单性。</p><p id="7513" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Windows DOS shell中，您可以通过管道传输DOS命令，但只能传输DOS命令，而不能传输特定程序的输出。例如，我可以列出输出到<code class="fe na nb nc nd b">more</code>命令的文件夹和管道的目录，以便限制显示的文件数量。这里有一个例子:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="1cbd" class="ni me it nd b gy nj nk l nl nm">C:\Windows\System32&gt;dir | more<br/>Volume in drive C has no label.<br/>|Volume Serial Number is 1290-1953</span><span id="3e77" class="ni me it nd b gy nn nk l nl nm">Directory of C:\Windows\System32<br/>02/27/2021  01:50 PM    &lt;DIR&gt;          .<br/>02/27/2021  01:50 PM    &lt;DIR&gt;          ..<br/>12/07/2019  03:49 AM    &lt;DIR&gt;          0409<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1028<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1031<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1033<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1036<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1040<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1041<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1042<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1045<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1046<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1049<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          1055<br/>01/14/2021  01:38 PM    &lt;DIR&gt;          2052<br/>-- More  --</span></pre><p id="ff95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有另一个例子，我用这篇文章来统计词频——乔纳森·斯威夫特的《一个小小的建议》。这个示例将文章中的文本通过管道传递给<code class="fe na nb nc nd b">DOHere’s the</code>命令和<code class="fe na nb nc nd b">output:S</code>命令<code class="fe na nb nc nd b">find</code>，这两个命令搜索单词<code class="fe na nb nc nd b">children</code>，然后使用命令<code class="fe na nb nc nd b">sort</code>根据文本行中的第一个单词按字母顺序对包含<code class="fe na nb nc nd b">children</code>的行进行排序。</p><p id="8f7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是命令和输出:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="2867" class="ni me it nd b gy nj nk l nl nm">C:\js&gt;type text.txt | find "children" | sort<br/>children in the arms, or on the backs, or at the heels of their<br/>children sound and useful members of the commonwealth, would deserve sodyet, there are more children born in Roman Catholick countries <br/>for those women who miscarry, or whose children die by accident or<br/>four, or six children, all in rags, and importuning every passenger <br/>giving some pleasure to the rich. I have no children, by which I can<br/>hundred and twenty thousand children, already computed, twenty <br/>murdering their bastard children, alas! too frequent among us,<br/>not be wanting; although I rather recommend buying the children <br/>reason is, that these children are seldom the fruits of marriage, a<br/>sterling per annum by the sale of their children, will be rid of the<br/>the children of professed beggars: it is of a much greater extent,<br/>their children, when they were sure of a settlement for life to the<br/>Thirdly, Whereas the maintainance of a hundred thousand children, <br/>thirty thousand couple, who are able to maintain their own children,<br/>thousand children of poor parents annually born. The question <br/>to have the best title to the children.<br/>with their wives and children, who are beggars in effect; I desire</span></pre><p id="1d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望您现在对软件管道是如何工作的有了很好的了解。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0377" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">一个流水线式的词频统计程序</h1><p id="1c89" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">让我们开门见山吧。以下是词频程序的管道版本代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="033b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是该程序的输出:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="b400" class="ni me it nd b gy nj nk l nl nm">children: 18<br/>kingdom: 15<br/>thousand: 15<br/>country: 11<br/>own: 10<br/>child: 10<br/>hundred: 8<br/>parents: 7<br/>little: 7<br/>shillings: 7</span></pre><p id="146b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，除了第一个函数<code class="fe na nb nc nd b">read_words</code>之外，每个函数都将前一个函数的输出作为其输入，第一个函数接收包含文章的文本文件。</p><p id="febb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如Lopes在她的书中指出的那样，用这种流水线、函数式的风格编写程序，并不等同于仅仅编写一个包含返回值函数的程序。如果我选择以一种更有状态的方式来使用这些函数，我会编写这样的主程序:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="8042" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数式流水线风格在主程序中没有任何变量(状态),而是将数据结构传递给函数。函数式的流水线风格看起来有点像纯粹的函数式语言，比如Lisp或Haskell，但只是一点点。如果你是一个函数式程序员，请不要对这种说法生气。</p><p id="831c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就结束了关于管道风格的这篇文章。在我的下一篇文章中，我计划从面向对象编程(OOP)的角度来计算词频，但是使用一些您可能不熟悉的OOP风格。</p><p id="6735" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。请随意留下任何意见或建议。</p></div></div>    
</body>
</html>