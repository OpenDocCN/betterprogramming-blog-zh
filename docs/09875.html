<html>
<head>
<title>5 Xcode Tricks to Refactor Your Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构代码的5个Xcode技巧</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/5-xcode-tricks-to-refactor-your-code-2b7a45e110da?source=collection_archive---------3-----------------------#2021-10-25">https://betterprogramming.pub/5-xcode-tricks-to-refactor-your-code-2b7a45e110da?source=collection_archive---------3-----------------------#2021-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec0a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何利用Xcode快速有效地重构代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/648b1ba798fd6d387d221bc43d99d647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BQkglP5hvw_XZ6DY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@parkerabyrd?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">帕克·伯德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="696a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为软件工程师，我们60%以上的时间都在重构代码。知道如何正确地重构一段代码是软件工程师需要开发的最重要的技能之一。它有很多好处，例如:</p><ul class=""><li id="ea3d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们从一开始就编写更干净、更安全的代码。</li><li id="fcc8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们能够简化我们的代码库。</li><li id="695e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们改进了代码库的可测试性。</li><li id="2ee3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们更擅长进行代码评审，因为我们知道要寻找什么。</li></ul><p id="c0cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个话题如此重要，以至于有<a class="ae ky" href="https://www.amazon.it/Refactoring-Improving-Design-Existing-Code/dp/0201485672" rel="noopener ugc nofollow" target="_blank">本书</a>和<a class="ae ky" href="https://refactoring.guru/" rel="noopener ugc nofollow" target="_blank">个网站</a>致力于如何正确检测代码气味以及如何重构代码库。</p><p id="49ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，我想展示一些我们可以使用Xcode重构代码的技巧。</p><h1 id="4596" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">1.从上下文菜单中重命名</h1><p id="97e1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为我们的类型、变量和方法选择正确的名称可以使代码库更容易理解。当我们选择一个糟糕的名字时，我们可能想要改变它，并更新我们代码库中所有使用该元素的地方。Xcode可以帮助我们一次性更新所有的名字。</p><p id="3936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过右击定义了的代码元素<strong class="lb iu">来触发该功能。上下文菜单打开，我们可以选择<code class="fe ng nh ni nj b">Refactor</code>，然后选择<code class="fe ng nh ni nj b">Rename</code>。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/30191a2f1be64fdc5cf7444f6f18755e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*xOoJhkMvjfUmYJogAy1BuQ.gif"/></div></figure><p id="14d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Xcode将花费几秒钟搜索所有使用该元素的站点，然后将高亮显示的布局更改为我们可以编辑的内容。通过更改元素名称，所有使用地点都将被更新。</p><p id="bbe3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种机制不仅可以用于变量！我们也可以用它来重构<code class="fe ng nh ni nj b">types</code>、<code class="fe ng nh ni nj b">enum</code>案例和<code class="fe ng nh ni nj b">function</code>名字。将它与函数一起使用的一个很酷的事情是，我们还可以重命名参数的名称和标签。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/74059a8a467d5712af92d1730a30c02c.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*swsKiJqDrVMznEBsvfAq2A.gif"/></div></figure><blockquote class="nm nn no"><p id="f9c6" class="kz la np lb b lc ld ju le lf lg jx lh nq lj lk ll nr ln lo lp ns lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>使用该功能时要小心。Xcode可以深入其他模块，有时它也会考虑文档。在更改元素之前，查看所有的调用位置，并取消选中您不想修改的调用位置。</p></blockquote><h1 id="44df" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">2.生成成员式初始值设定项</h1><p id="ffeb" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">尤其是在处理模块、SDK和库时，我们不能完全依赖初始化器的自动合成。很多时候我们需要创建公共的初始化器，我们需要通过复制粘贴一个<code class="fe ng nh ni nj b">struct</code>的所有属性来烦自己。幸运的是，Xcode有一个方便的特性，可以自动创建成员式初始化器。</p><p id="1d59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用该功能，我们必须右击需要<code class="fe ng nh ni nj b">init</code>的类型，选择<code class="fe ng nh ni nj b">Refactor</code>，然后选择<code class="fe ng nh ni nj b">Generate Memberwise Initializer</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/035b09f60ec0458fe7033371248e4a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*JHBY-6xJe3aATgwITiOPuQ.gif"/></div></figure><p id="e682" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Xcode用<code class="fe ng nh ni nj b">internal</code>关键字在类型声明的正下方创建初始化器。我们可以把关键字改成<code class="fe ng nh ni nj b">public</code>(或者改成我们需要的值)，剪切粘贴到我们想要的地方。</p><h1 id="02ca" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">3.展开开关盒</h1><p id="9346" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">如果我们使用许多带有许多情况和复杂关联值的<code class="fe ng nh ni nj b">enums</code>, Xcode可能需要一段时间才能意识到我们正在编写一个<code class="fe ng nh ni nj b">switch</code>,我们希望所有情况都显式展开。</p><p id="65e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过明确要求IDE填充所有缺失的案例来给它一点帮助。为了启用这个特性，我们必须首先编写一个<code class="fe ng nh ni nj b">switch</code>语句的语法。然后，通过右键单击<code class="fe ng nh ni nj b">switch</code>，我们可以选择<code class="fe ng nh ni nj b">Refactor</code>，并在项目列表的最末端选择<code class="fe ng nh ni nj b">Expand Switch Cases</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/27bee9f15a0e3b74ef1bccf3f5c5a0e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*BOCEDWOByEXf5vhbI8FE1A.gif"/></div></figure><h1 id="8ca8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">4.多行编辑</h1><p id="0a0e" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在某些情况下，我们需要编写完全相同的代码行，并将其应用于不同的元素。</p><p id="59f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个典型的例子是<code class="fe ng nh ni nj b">UIView</code>中的<code class="fe ng nh ni nj b">view.addSubview</code>，或者将一组元素的<code class="fe ng nh ni nj b">translatesAutoresizingMaskIntoConstraints</code>属性设置为<code class="fe ng nh ni nj b">false</code>。</p><p id="f778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然我们可以创建助手或者利用<code class="fe ng nh ni nj b"><a class="ae ky" href="https://developer.apple.com/documentation/swift/mirror" rel="noopener ugc nofollow" target="_blank">Mirror API</a></code>来自动完成这项工作，但是使用多行编辑来快速输入这些行通常更容易，也没那么糟糕。</p><p id="c22b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有两种方法激活它:</p><ol class=""><li id="0316" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nt mb mc md bi translated">按住<code class="fe ng nh ni nj b">control+shift</code> ( <code class="fe ng nh ni nj b">⌃+⇧</code>)并向上或向下按箭头。</li><li id="60f7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nt mb mc md bi translated">通过选择多行代码，然后点击<code class="fe ng nh ni nj b">Editor</code>、<code class="fe ng nh ni nj b">Selection</code>和<code class="fe ng nh ni nj b">Split Selection By Lines</code>。</li></ol><p id="7ce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦激活，我们就可以开始打字，字符将通过光标添加到每一行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b1f464d28a0c0c8948250870b6eca1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*FvsCgdXNs3lMk70Yev7ZZg.gif"/></div></figure><h1 id="0a2d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">5.快速找到所有呼叫站点</h1><p id="872a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这不是重构技巧，而是我在任何情况下都愿意分享的技巧。当处理大型代码库时，我们可能会想知道所有使用函数或变量的地方。</p><p id="5fa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Xcode可以通过使用上下文菜单中<code class="fe ng nh ni nj b">Refactor</code>下面的<code class="fe ng nh ni nj b">Find</code>菜单来帮助我们进行搜索。例如，如果我们突出显示一个函数声明，我们可以选择<code class="fe ng nh ni nj b">Find</code>，然后选择<code class="fe ng nh ni nj b">Find Call Hierarchy</code>来搜索调用该函数的所有站点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/a24e04c4ca4c553849c17ac86d7a4816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ivtQoWRIcTauJ3DI26zbVA.gif"/></div></div></figure><p id="7fb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">搜索调用层次结构后，我们不仅可以看到所搜索方法的所有调用位置。我们还可以更深入，检查所有调用调用被搜索方法的方法的二级方法。</p><p id="3600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这让我们可以创建一种可能调用的静态堆栈跟踪。这是一个非常有用的工具，用于:</p><ol class=""><li id="9938" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nt mb mc md bi translated">了解代码库如何工作。</li><li id="93f9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nt mb mc md bi translated">调查我们在应用程序中观察到的错误或奇怪行为。</li></ol><h1 id="b4d8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="1550" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在今天的文章中，我们探索了一些利用Xcode更快重构代码的方法。我们学习了如何在一个镜头中改变许多元素的名称；如何自动创建成员式初始值设定项；如何要求Xcode展开一个开关的所有案例；如何一次编辑多行；以及如何搜索使用某个元素的所有位置。</p><p id="9fab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">知道如何使用我们的工具是变得高效和有效的必要条件。它不会让我们成为更好的软件工程师，但它肯定会让我们的工作和生活更轻松。</p><p id="3ce7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最重要的是，这表明我们花时间了解我们的环境，这可以给你的同事甚至是检查你编码技能的面试官留下深刻印象。</p></div></div>    
</body>
</html>