<html>
<head>
<title>Swipe To Dismiss Android RecyclerView Items Using Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">滑动以关闭Android RecyclerView使用Kotlin查看项目</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/swipe-to-dismiss-android-recyclerview-items-using-kotlin-95ca20cfb812?source=collection_archive---------9-----------------------#2021-02-24">https://betterprogramming.pub/swipe-to-dismiss-android-recyclerview-items-using-kotlin-95ca20cfb812?source=collection_archive---------9-----------------------#2021-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b9ed" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在你的Android应用中创建漂亮的、可定制的列表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c4fa558b8c0283e63f7fac715b798237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OL18TGVsVBbhoPId"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯莉·西克玛</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="b6e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将学习如何实现<code class="fe lv lw lx ly b">RecyclerView</code>，它为您提供了滑动项目的能力。我们将在不使用任何第三方库的情况下做到这一点。我们将使用<code class="fe lv lw lx ly b">RecyclerView</code>默认装饰器和一些接口来实现这一点。</p><p id="c1c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您感兴趣，本文末尾嵌入了一个带有实现的GitHub repo链接。</p><p id="79f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6e0f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">介绍</h1><p id="ac97" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果你是一名Android开发者，你会知道<code class="fe lv lw lx ly b">RecyclerView</code>是显示大型数据集的优化解决方案，并具有有效的内存管理。</p><p id="6d8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与它的前辈(<code class="fe lv lw lx ly b">listview</code>)不同的是，<code class="fe lv lw lx ly b">RecyclerView</code>拥有像<code class="fe lv lw lx ly b">ItemTouchHelper</code>这样的巨大支持，简单的动画，以及强大的更新功能，如<code class="fe lv lw lx ly b">insert</code>、<code class="fe lv lw lx ly b">remove</code>等等。</p><p id="8d87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">RecyclerView</code>中的<code class="fe lv lw lx ly b">ItemTouchHelper</code>，我们可以在不添加任何第三方库的情况下，快速添加令人敬畏的功能，如重新排序和滑动。您可以阅读下面的文章，了解如何使用项目装饰器对项目进行重新排序:</p><div class="nd ne gp gr nf ng"><a href="https://medium.com/better-programming/drag-to-reorder-android-recyclerview-items-using-kotlin-afcaee1b7fb5" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">使用Kotlin拖移以重新排序Android RecyclerView项目</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">在你的Android应用中创建漂亮的可定制列表</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ks ng"/></div></div></a></div><p id="1c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将了解滑动以消除。为此，我们将使用<code class="fe lv lw lx ly b">ItemTouchHelper</code>。它只是从<code class="fe lv lw lx ly b">RecyclerView.ItemDecoration</code>扩展而来的一个简单的类。这提供了多个回调，例如<code class="fe lv lw lx ly b">onMove</code>、<code class="fe lv lw lx ly b">onSwiped</code>、<code class="fe lv lw lx ly b">onSelectedChanged</code>、<code class="fe lv lw lx ly b">Clearview</code>等等。随着所有这些回调的及时使用，我们将在<code class="fe lv lw lx ly b">RecyclerView</code>中实现重新排序。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b7dd" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">实现ItemTouchHelper</h1><p id="472b" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">首先，我们需要创建一个Kotlin类并用<code class="fe lv lw lx ly b">ItemTouchHelper.Callback</code>扩展它。然后我们覆盖<code class="fe lv lw lx ly b">getMovementFlags</code>、<code class="fe lv lw lx ly b">onMove</code>和<code class="fe lv lw lx ly b">onSwiped</code>功能，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="1f17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们使用<code class="fe lv lw lx ly b">onSwiped</code>函数为<code class="fe lv lw lx ly b">RecyclerView</code>项添加滑动功能。<code class="fe lv lw lx ly b">onMove</code>函数用于实现重新排序等功能。<code class="fe lv lw lx ly b">getMovementFlags</code>是一个功能，通过它我们可以注册运动标志<em class="nx"> </em>到<em class="nx"> </em> <code class="fe lv lw lx ly b">RecyclerView</code>项。我们可以使用<code class="fe lv lw lx ly b">makeMovementFlags</code>函数注册<code class="fe lv lw lx ly b">swipe</code>和<code class="fe lv lw lx ly b">drag</code>标志:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="50f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经注册了<code class="fe lv lw lx ly b">swipe</code>和<code class="fe lv lw lx ly b">drag</code>。如果不想包含拖动功能，那么将<code class="fe lv lw lx ly b">0</code>作为第一个参数传递。我们的目标是实现滑动功能，所以我将<code class="fe lv lw lx ly b">START</code>和<code class="fe lv lw lx ly b">END</code>作为<code class="fe lv lw lx ly b">swipe</code>标志。</p><p id="827d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，一旦用户成功刷过<code class="fe lv lw lx ly b">RecyclerView</code>项，就会调用<code class="fe lv lw lx ly b">onSwiped</code>功能。这个函数将接收用户滑动的视图容器实例，通过它我们可以找到<code class="fe lv lw lx ly b">adapterposition</code>，我们稍后会谈到。</p><p id="5501" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要关注的下一部分是如何传输用户已经滑动了一个视图容器，以便在适配器中执行必要的操作。为了解决这个问题，我们使用了一个接口。这是一个简单的界面，有两个功能(<code class="fe lv lw lx ly b">onItemMove</code>)和(<code class="fe lv lw lx ly b">onItemDismiss</code>)，分别在用户执行<code class="fe lv lw lx ly b">drag</code>和<code class="fe lv lw lx ly b">swipe</code>动作时触发。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="1526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要传递我们在<code class="fe lv lw lx ly b">SwipeHelperCallback</code>构造函数中创建的接口。之后，我们需要做的就是通过使用<code class="fe lv lw lx ly b">viewHolder</code>实例传递<code class="fe lv lw lx ly b">adapterPosition</code>来调用接口实例上的<code class="fe lv lw lx ly b">onItemDismiss</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="50f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至此，我们已经基本完成了核心逻辑。默认情况下，当用户开始在任何<code class="fe lv lw lx ly b">RecyclerView</code>项目上滑动时，将触发滑动。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b561" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">回收视图支架和适配器</h1><p id="e63a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">首先，我们需要创建一个简单的<code class="fe lv lw lx ly b">RecyclerView</code>容器，并从适配器<code class="fe lv lw lx ly b">onBindViewHolder</code>函数调用<code class="fe lv lw lx ly b">setData</code>函数来更新其中的UI:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7ba2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要实现一个简单的具有必要功能的<code class="fe lv lw lx ly b">RecyclerView</code>适配器(例如<code class="fe lv lw lx ly b">onCreateViewHolder</code>、<code class="fe lv lw lx ly b">onBindViewHolder</code>等等)。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3a82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经完成了基本功能，是时候实现滑动功能了。我们已经创建了<code class="fe lv lw lx ly b">ItemTouchHelperAdapter</code>接口来监听一个项目何时被滑动。这将覆盖<code class="fe lv lw lx ly b">onItemDismiss</code>函数，在该函数中，我们将删除适配器列表中该位置的项目，并调用<code class="fe lv lw lx ly b">notifyItemRemoved</code>函数来更新UI。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="834f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">调用滑动以消除</h1><p id="bb19" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">最后，我们完成了<code class="fe lv lw lx ly b">ItemTouchHelper</code>、适配器、<code class="fe lv lw lx ly b">ViewHolder</code>和接口。是时候给<code class="fe lv lw lx ly b">RecyclerView</code>分配适配器了。我们需要创建一个<code class="fe lv lw lx ly b">SwipeHelperCallback</code>实例，并将其传递给附加到<code class="fe lv lw lx ly b">RecyclerView</code>的<code class="fe lv lw lx ly b">ItemTouchHelper</code>构造函数的构造函数。看一看:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="3ef5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅此而已！您已经在没有任何第三方库的情况下成功地用<code class="fe lv lw lx ly b">swipe</code>项实现了<code class="fe lv lw lx ly b">RecyclerView</code>！</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="5cf8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">输出</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/02544d1386e43dd04ad1e8e844eadf96.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/1*uAbYPCBYzbeOBvVDBooZcQ.gif"/></div></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3051" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">奖金</h1><p id="9547" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">要了解有关Android中的<code class="fe lv lw lx ly b">RecyclerView</code>适配器的更多信息，请阅读以下文章:</p><ul class=""><li id="b4a1" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated"><a class="ae ky" href="https://medium.com/android-dev-hacks/building-a-reactive-heterogeneous-adapter-in-kotlin-eed9487df29b" rel="noopener">在Kotlin中构建反应式&amp;异构适配器</a></li><li id="cf60" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><a class="ae ky" href="https://medium.com/better-programming/evolution-of-adapters-in-android-2e2ff58c0f98" rel="noopener">Android中适配器的演变</a></li><li id="0bbb" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><a class="ae ky" href="https://medium.com/better-programming/how-to-merge-adapters-sequentially-in-android-11914eac53d" rel="noopener">如何在Android中顺序合并适配器</a></li><li id="2fa2" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><a class="ae ky" href="https://medium.com/better-programming/android-recyclerview-with-kotlin-sealed-classes-6d2985aac3e5" rel="noopener"> Android RecyclerView与Kotlin密封类</a></li></ul></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="b170" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">GitHub回购</h1><div class="nd ne gp gr nf ng"><a href="https://github.com/SG-K/RecyclerviewWithBenefits#drag-and-reorder-recyclerview-items" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">SG-K/recyclerviewithsbenefits</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">这是一个演示应用程序，旨在为开发人员展示如何实现复杂的功能，如重新排序、滑动等…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">github.com</p></div></div><div class="np l"><div class="on l nr ns nt np nu ks ng"/></div></div></a></div><p id="2140" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前就这些。希望你学到了有用的东西。感谢阅读！</p></div></div>    
</body>
</html>