<html>
<head>
<title>Build a Question Answering App Using Pinecone And Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用松果和Python构建一个问答应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-a-question-answering-app-using-pinecone-and-python-1d624c5818bf?source=collection_archive---------8-----------------------#2022-03-21">https://betterprogramming.pub/build-a-question-answering-app-using-pinecone-and-python-1d624c5818bf?source=collection_archive---------8-----------------------#2022-03-21</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="d482" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何使用松果为你的应用添加语义搜索</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/cc35bc4804b82e3bc52499ee2bd59a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b3A-pn9igzrbku8j"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Antonio Janeski 在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="61de" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">项目动机</h1><p id="e666" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">假设你有一个网站，客户可以在那里找到常见问题的答案。你选择创建一个强大的智能搜索引擎，而不是维护一个客户支持服务。人们只需在搜索栏中输入他们的问题，就可以看到类似的问题。通过这种方式，您可以减少重复的主题，并且客户可以轻松找到他们想要的内容。<br/>如何保证搜索足够智能，向用户展示最佳匹配结果？这就是语义搜索发挥作用的时候了。它试图理解搜索查询的意图和上下文，以提供更准确的结果。</p><p id="303c" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">在本文中，我们将创建一个相似性搜索引擎。我们将使用Python和完全托管的矢量数据库<a class="ae kz" href="https://www.pinecone.io/docs/overview/" rel="noopener ugc nofollow" target="_blank">松果</a>来实现这个目标。</p><p id="d7a4" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">我们开始吧！</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="a5dd" class="la lb iu bd lc ld na lf lg lh nb lj lk ka nc kb lm kd nd ke lo kg ne kh lq lr bi translated">松果关键概念</h1><h2 id="4558" class="nf lb iu bd lc ng nh dn lg ni nj dp lk mb nk nl lm mf nm nn lo mj no np lq nq bi translated">物体的矢量表示</h2><p id="1f41" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">在机器学习(ML)中，<a class="ae kz" href="https://www.pinecone.io/learn/vector-embeddings" rel="noopener ugc nofollow" target="_blank">向量嵌入</a>表示一组连续数字，以确定各种对象之间的相似性。我们计算物体的向量在向量空间中有多接近。</p><h2 id="69e1" class="nf lb iu bd lc ng nh dn lg ni nj dp lk mb nk nl lm mf nm nn lo mj no np lq nq bi translated">距离度量</h2><p id="e0ce" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">距离度量取决于用例。例如，Pinecone支持一些最常用的度量:<a class="ae kz" href="https://en.wikipedia.org/wiki/Euclidean_distance" rel="noopener ugc nofollow" target="_blank">欧几里德</a>、<a class="ae kz" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦</a>和<a class="ae kz" href="https://nlp.stanford.edu/IR-book/html/htmledition/dot-products-1.html" rel="noopener ugc nofollow" target="_blank">点积</a>。</p><p id="4d32" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">在我们的演示应用中，我们将使用余弦度量。它用于查找不同文档之间的相似之处。结果分数范围在[0，1]之间。</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="947b" class="la lb iu bd lc ld na lf lg lh nb lj lk ka nc kb lm kd nd ke lo kg ne kh lq lr bi translated">松果快速概览</h1><p id="5c55" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">松果是一个免费增值工具。您可以免费注册，并在一个单独的pod中使用较小项目的服务。对于<a class="ae kz" href="https://www.pinecone.io/pricing/#performance" rel="noopener ugc nofollow" target="_blank">1M左右的矢量，100ms的延迟</a>应该足够了。对于高级计划，请查看<a class="ae kz" href="https://www.pinecone.io/pricing/" rel="noopener ugc nofollow" target="_blank">定价页面</a>。</p><p id="8fe2" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><strong class="lu iv">你能用松果做什么？</strong></p><ul class=""><li id="f94c" class="nr ns iu lu b lv mo ly mp mb nt mf nu mj nv mn nw nx ny nz bi translated">语义文本搜索</li><li id="b6a9" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">图像相似性搜索</li><li id="60db" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">视频/音频/文本推荐</li><li id="8386" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">时间序列相似性搜索</li><li id="93fd" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">文档去重检测</li></ul><p id="4c5f" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">…以及更多。</p><p id="88da" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><strong class="lu iv">使用松果的主要优势是什么？</strong></p><ul class=""><li id="ad77" class="nr ns iu lu b lv mo ly mp mb nt mf nu mj nv mn nw nx ny nz bi translated">完全托管的服务—无需担心基础架构</li><li id="5679" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">高性能和可扩展性</li><li id="3d6b" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">用户友好的界面，详细的文档，大量的示例原型，实验项目免费</li></ul><p id="19a7" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><strong class="lu iv">工作流程是怎样的？</strong></p><p id="4360" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">工作流程非常简单:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj of"><img src="../Images/2590da2446a1fe535f5e37dc58e182d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/0*j5c-ZrHVc8cB9ruH.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来源于Pipecone在https://www.pinecone.io/docs/overview/<a class="ae kz" href="https://www.pinecone.io/docs/overview/" rel="noopener ugc nofollow" target="_blank">的官方文件</a></p></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="16da" class="la lb iu bd lc ld na lf lg lh nb lj lk ka nc kb lm kd nd ke lo kg ne kh lq lr bi translated">准备应用程序</h1><ol class=""><li id="1115" class="nr ns iu lu b lv lw ly lz mb og mf oh mj oi mn oj nx ny nz bi translated">注册一个免费账户。</li><li id="26e0" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn oj nx ny nz bi translated">创建索引。</li></ol><p id="41ef" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">请注意，您可以以编程方式执行这些步骤。我想给你一个松果的UI控制台的概述，所以我将手动执行步骤。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ok"><img src="../Images/3e9502956f84609c07da14b6a030b0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlNOLft_0MNnezDMiDMdKg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">通过控制台创建新索引</p></figure><p id="def9" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">您应该最终拥有这样一个仪表板:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/1400c677e61d58b1993e178b33d2607f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RzMC7NsCwQQwTrnQjdRyg.png"/></div></div></figure><p id="4fa7" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><em class="om">注意，您可以创建一个新的API密钥。我保留默认的。</em></p><p id="bc78" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">当您的索引被创建时，<strong class="lu iv">状态</strong>字段应该变成绿色。</p><p id="37e1" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">3.为索引收集数据。</p><p id="a52e" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">我们将索引一组用向量表示的问题。然后，我们将检索最相似的问题以及任何新问题的答案。</p><p id="986b" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">我从kaggle.com<em class="om">下载了一个公开的<a class="ae kz" href="https://www.kaggle.com/archaeocharlie/comcastcomplaints" rel="noopener ugc nofollow" target="_blank">数据集</a>，其中包含了客户对一家名为<em class="om">康卡斯特</em>的公司的投诉。下面是一些快速浏览的数据:</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj on"><img src="../Images/f49317fc6d3629ccf1b3ae68f6fee292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PGpX-dkYcHY6TUakcD6rzw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">康卡斯特kaggle.com客户投诉摘录</p></figure><p id="5f12" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">我们将很快通过Python代码将其插入到松果索引中。</p><p id="2a52" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">4.安装松果依赖项:</p><pre class="kk kl km kn gu oo op oq or aw os bi"><span id="3e49" class="nf lb iu op b gz ot ou l ov ow">pip install -qU matplotlib pinecone-client ipywidgets<br/>pip install -qU sentence-transformers --no-cache-dir</span></pre><p id="26f0" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">5.创建包含以下内容的Python文件:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">问答app</p></figure><p id="a723" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">代码解释:</p><ul class=""><li id="98fe" class="nr ns iu lu b lv mo ly mp mb nt mf nu mj nv mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">pandas </code>库用于读取和操作数据。</li><li id="b1d2" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">pinecone </code>库提供了像索引和查询这样的松果操作。</li><li id="19fe" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">itertools </code>用于产生更复杂的迭代器。</li><li id="2113" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">我们需要<code class="fe oz pa pb op b">sentence_transformers </code>来定义我们的模型——“T4”。这是一种无监督学习算法，用于检索单词的矢量表示。</li><li id="a510" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">api_key </code>应该是你从松果的控制台拿的私人钥匙。</li><li id="5205" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">index_name </code>应该与您之前通过控制台创建的相匹配。</li><li id="0ea1" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">确保相应地重命名您的<code class="fe oz pa pb op b">.csv </code>文件以匹配<code class="fe oz pa pb op b">DATA_FILE</code>。</li><li id="f922" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">query_questions</code>数组包含要检查的用户查询。</li><li id="4a3a" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">query_vectors</code>为向量提取嵌入。</li><li id="dd86" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated"><code class="fe oz pa pb op b">query_results</code>包含具有最相似索引问题的结果。</li><li id="8be9" class="nr ns iu lu b lv oa ly ob mb oc mf od mj oe mn nw nx ny nz bi translated">最后，我们遍历问题和结果，并根据索引相似性显示最相似的问题。为了更好地理解，我们显示了问题的票证id、问题本身和分数，以表明结果的确定性。</li></ul></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="db8c" class="la lb iu bd lc ld na lf lg lh nb lj lk ka nc kb lm kd nd ke lo kg ne kh lq lr bi translated">测试应用程序</h1><p id="1c9a" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">让我们运行应用程序，看看结果:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pc"><img src="../Images/4c43decbd3108c2be19a8ed3feea9147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*bdbSbJ6eMaC-S4BTv98ykA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">松果矢量搜索的查询结果</p></figure><p id="00b6" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">太好了！结果看起来相当准确。</p><p id="e9b7" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><em class="om">提示:票号可以是找到的问题的链接。它会带用户找到答案。</em></p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="3447" class="la lb iu bd lc ld na lf lg lh nb lj lk ka nc kb lm kd nd ke lo kg ne kh lq lr bi translated">结论</h1><p id="b394" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">在本文中，您了解了如何使用Pinecone向Python应用程序添加语义搜索。</p><p id="4162" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">为了增强项目，您可以创建一个前端。用户可以在搜索栏中键入他们的问题，并根据松果矢量搜索检索最相似的问题。或者你可以创建一个聊天机器人来为用户提供信息。我会把这个场景留给你去想象。</p><p id="f02e" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">我希望你喜欢这篇文章。感谢您的阅读，祝您编码愉快！</p></div></div>    
</body>
</html>