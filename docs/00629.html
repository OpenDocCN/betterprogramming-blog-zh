<html>
<head>
<title>Creating a Pet Sticker App on iOS with Fritz Pet Segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Fritz宠物分割在iOS上创建宠物贴纸应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/creating-a-pet-sticker-app-on-ios-with-fritz-pet-segmentation-35bce07f344f?source=collection_archive---------6-----------------------#2019-06-20">https://betterprogramming.pub/creating-a-pet-sticker-app-on-ios-with-fritz-pet-segmentation-35bce07f344f?source=collection_archive---------6-----------------------#2019-06-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1eba" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将狗和猫变成贴纸，在你最喜欢的信息应用程序中使用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d12fdfc1fb4ec7c13cdd6a3aebbf80dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EeJofJ9pmhvZ8ZVQkCxd2w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/Zqy-x7K5Qcg" rel="noopener ugc nofollow" target="_blank">图像来源</a></p></figure><p id="5b3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">手机摄像头理解得越多，手机应用程序就越强大，越有创意。很少有主题比我们的宠物更需要理解:狗狗、弗卢弗、弗卢弗、云彩、低音喇叭，甚至猫(至少我是这么听说的)。</p><p id="fccb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将学习如何使用iOS和Android的移动机器学习平台<a class="ae ky" href="https://www.fritz.ai" rel="noopener ugc nofollow" target="_blank"> Fritz </a>，让iOS应用程序能够在照片和视频中生成像素完美的宠物分割遮罩。</p><p id="6a8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用这个面具来创建有趣的贴纸，你可以在WhatsApp或Messenger等应用程序中分享，但你也可以使用面具来跟踪它们随时间的增长，改变它们皮毛的颜色，或在AR应用程序中执行遮挡。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="732b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">定义任务</h1><p id="0926" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以教会手机摄像头执行许多任务:识别品种、定位动物的确切位置、检查狗是否坐下等等。在我们的例子中，我们想知道图像中哪些像素属于动物，哪些只是背景。这个任务被称为语义<a class="ae ky" href="https://www.fritz.ai/features/image-segmentation.html" rel="noopener ugc nofollow" target="_blank">图像分割</a>。</p><p id="97c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实证明，深度神经网络非常擅长进行图像分割。在Fritz，我们投入了大量努力来训练足够小、足够快的神经网络，以便在移动应用程序中分割图像。因为一切都在设备上运行，所以可以在没有互联网连接的情况下实时使用，同时还可以保护用户数据的隐私。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f989" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">用Fritz分割宠物</h1><h2 id="e00d" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">开始</h2><p id="a9a7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">下载并打开本教程的资源库。</p><p id="f2e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用Cocoapods设置Fritz是最简单的。在starter项目文件夹中，运行:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="0d8f" class="mz md it nm b gy nq nr l ns nt">pod repo update<br/>pod install</span></pre><p id="1cd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Xcode中打开fritzpetstickerdemo . xc workspace。</p><h2 id="75ab" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">概观</h2><p id="5f93" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://www.fritz.ai/features/image-segmentation.html" rel="noopener ugc nofollow" target="_blank"> Fritz iOS图像分割</a>功能为照片中的宠物生成遮罩。Fritz SDK附带了各种可以直接在手机上运行的<a class="ae ky" href="https://www.fritz.ai/features/" rel="noopener ugc nofollow" target="_blank">预建特性</a>。</p><p id="d1b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有Fritz Vision APIs都使用一些结构:</p><ul class=""><li id="d275" class="nu nv it lb b lc ld lf lg li nw lm nx lq ny lu nz oa ob oc bi translated"><strong class="lb iu"> FritzVisionImage </strong>:模型运行的图像。它将包装提供的像素缓冲区或您提供的其他图像。</li><li id="e9fe" class="nu nv it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><strong class="lb iu">选项</strong>:传递给模型的配置选项，让您调整模型如何运行。</li><li id="3d39" class="nu nv it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><strong class="lb iu">模型:</strong>对输入图像进行预测的实际模型。</li><li id="d66d" class="nu nv it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated"><strong class="lb iu">结果:</strong>模型的输出。每个预测器都有不同类型的结果。在本教程中，结果是一列<code class="fe oi oj ok nm b">FritzVisionSegmentationResult</code>对象。</li></ul><h2 id="9e4d" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">设置Fritz帐户</h2><p id="46d8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">建立一个Fritz账户很容易。按照<a class="ae ky" href="https://docs.fritz.ai/develop/get-started-sdk.html" rel="noopener ugc nofollow" target="_blank">入门</a>指示设置您的Fritz帐户，并将演示连接到您的帐户。以下是您将经历的步骤:</p><ol class=""><li id="8b7f" class="nu nv it lb b lc ld lf lg li nw lm nx lq ny lu ol oa ob oc bi translated">创建一个帐户。</li><li id="72f4" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">创建一个iOS应用。确保项目的包ID与您创建的包ID相匹配。</li><li id="e739" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">将<code class="fe oi oj ok nm b">Fritz-Info.plist</code>文件拖到您的项目中。</li></ol><p id="068d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成初始化步骤后，构建并运行您的应用程序。当你的应用成功登录Fritz后，你会在web应用中看到一条成功消息。</p><h2 id="a119" class="mz md it bd me na nb dn mi nc nd dp mm li ne nf mo lm ng nh mq lq ni nj ms nk bi translated">设置图像拾取器</h2><p id="2468" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">接下来，我们将把摄像头添加到我们的应用程序中。您可以对来自“相机胶卷”或实时预览的静态图像或视频使用Pet分段。在本教程中，我们将从相机胶卷中选择一张好男孩的照片。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="5d7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此代码片段打开一个图像拾取器，并在背景上替换选定的图像。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="aa07" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建Pet预测器</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/418c99c4624ea699c1026b3d6194a34d.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*tvp-j8K8oyzDOgOo3yseiA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个好男孩</p></figure><p id="5321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候把选中的图片变成贴纸了。</p><p id="173c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将pet分割模型初始化为视图控制器中的变量，并在createSticker函数中运行该模型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="ed46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一步一步地完成这个过程:</p><ol class=""><li id="8ac5" class="nu nv it lb b lc ld lf lg li nw lm nx lq ny lu ol oa ob oc bi translated">我们首先设置一些用于调整模型输出的参数。</li><li id="a68c" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">然后我们创建一个<code class="fe oi oj ok nm b">FritzVisionPetSegmentationModel()</code>,用于从图像中剪切出宠物。</li><li id="5a44" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">我们更新我们的<code class="fe oi oj ok nm b">imagePickerController</code>,用用户选择的图像调用<code class="fe oi oj ok nm b">createSticker</code>函数。</li><li id="f28b" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">该图像被输入到分割模型中，分割模型返回一个<code class="fe oi oj ok nm b">FritzVisionSegmentationResult</code>对象。有关不同访问方法的更多详情，请查看<a class="ae ky" href="https://docs.fritz.ai/develop/vision/image-segmentation/ios.html#mask-a-specific-class" rel="noopener ugc nofollow" target="_blank">官方文档</a>。</li><li id="e898" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">分割结果包含关于每个像素属于特定类别(例如背景或pet)的可能性的信息。我们使用<code class="fe oi oj ok nm b">buildSingleClassMask</code>方法从模型认为是宠物的像素创建一个alpha蒙版。</li><li id="bfba" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">使用核心图像将该蒙版与原始图像结合，使用<code class="fe oi oj ok nm b">masked </code>方法生成一个具有透明背景的贴纸。</li><li id="3ac0" class="nu nv it lb b lc od lf oe li of lm og lq oh lu ol oa ob oc bi translated">该标签被显示给用户。您还可以保存该标签供以后用户使用。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/9f66c342e38f8b0830faf81c1a4b1fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*OUCcCNCC_8M2tQfUtemlEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您的消息应用程序的可粘贴标签。</p></figure><p id="0036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我们所做工作的直观展示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/7d056ef310fc6b6754b7357def96c07c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YYDefeGyQEvl4cYD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原图(左)。包含我们宠物的像素的alpha蒙版，紫色表示背景，亮黄色表示宠物(中间)。最后的贴纸(右)。</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="38f9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">调整遮罩灵敏度</h1><p id="e9ab" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，我们来看看分段掩码。使用预测结果，您可以制作不同灵敏度的遮罩。两个重要的参数是<code class="fe oi oj ok nm b">clippingScoresAbove</code>和<code class="fe oi oj ok nm b">zeroingScoresBelow</code>。模型输出的置信度得分在0和1之间。所有高于<code class="fe oi oj ok nm b">clippingScoresAbove</code>的信心分数都将变为1。所有低于<code class="fe oi oj ok nm b">zeroingScoresBelow</code>的置信度分数将为零。您可以修改这些参数来创建软边。</p><p id="b637" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看我们的<a class="ae ky" href="https://github.com/fritzlabs/fritz-ios-tutorials/tree/master/FritzPetStickerDemo" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>以了解完成的实现。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="37f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过宠物细分，开发人员能够在用户和他们的动物之间创建有趣的互动。只需添加几行代码，即可创建极具吸引力的功能，让您的iOS应用与众不同。</p><p id="74ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://app.fritz.ai/register" rel="noopener ugc nofollow" target="_blank">创建一个免费的Fritz帐户</a>开始使用。如需更多资源，<a class="ae ky" href="https://docs.fritz.ai/develop/vision/image-segmentation/ios.html" rel="noopener ugc nofollow" target="_blank">深入阅读文档</a>或在<a class="ae ky" href="https://github.com/fritzlabs/heartbeat-ios" rel="noopener ugc nofollow" target="_blank">开源心跳应用</a>中查看完整演示。</p></div></div>    
</body>
</html>