<html>
<head>
<title>Building a Layer Two Neural Network From Scratch Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从头开始构建第二层神经网络</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-2-layer-neural-network-from-scratch-in-python-4dd44a13ebba?source=collection_archive---------1-----------------------#2019-06-21">https://betterprogramming.pub/how-to-build-2-layer-neural-network-from-scratch-in-python-4dd44a13ebba?source=collection_archive---------1-----------------------#2019-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="db5f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于建立人工智能网络的深入教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/07c8807ae3d5209d582cebe992ca3282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Di_uKxK7iQF9t13X"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@herfrenchness?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Clarisse Croset </a>拍摄的照片</p></figure><p id="54b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AI粉丝你好！我很兴奋能和你分享如何建立一个有隐藏层的神经网络！跟随我们，让我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b2fb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">导入库</h1><p id="52f5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">本教程唯一需要的库是NumPy。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2752" class="ne md it na b gy nf ng l nh ni"><em class="nj">import </em>numpy <em class="nj">as </em>np</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="38fb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">激活功能</h1><p id="d710" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在隐藏层，我们将使用tanh激活函数，在输出层，我将使用sigmoid函数。很容易找到关于sigmoid函数和tanh函数图的信息。我不想用解释来烦你，所以我只是实现它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/435803b21086e7161de4f8716d16f74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*10ajc-U0TjOYU5QgEeKMWg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乙状结肠函数。下面给出了这个函数的代码。</p></figure><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="0298" class="ne md it na b gy nf ng l nh ni"><em class="nj">def </em>sigmoid(<em class="nj">x</em>):<br/>    <em class="nj">return </em>(1 / (1 + np.exp(-<em class="nj">x</em>)))</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7bae" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">设置参数</h1><p id="7214" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">什么是参数和超参数？参数是权重和偏差。超参数在学习开始前影响参数和。一开始完全正确地设置超参数不是一件容易的事，您需要修补和调整您的值。学习率、迭代次数和正则化率等等都可以被认为是超参数。</p><p id="140c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想知道如何设置矩阵的大小？答案就在下面！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/afa39586efea7963788a030a0f2daec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3MP-7vGyNt7npC_69zJI9g.png"/></div></div></figure><p id="3a2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一切意味着什么？例如:<br/>(第0层所以L = 0)输入层神经元数= 3 <br/>(第1层所以L = 1)隐藏层神经元数= 5 <br/>(第2层所以L = 2)输出层神经元数= 1</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/f15461132bc702cf1fdb876db4d50150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSMkP5YLdb8qUv9QP18KyQ.png"/></div></div></figure><p id="0a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这一切都有意义！让我们设置参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8be3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们定义W1、b1、W2和b2。如果你一开始就把你的偏见设为零，那也没什么坏处。但是，初始化权重时要非常小心。<strong class="lb iu">千万不要</strong>一开始就把权重设为零。到底为什么？好吧，如果你这样做了，那么在Z = Wx + b中，Z永远是零。如果您正在构建一个多层神经网络，每一层中的神经元将表现为只有一个神经元。那么一开始我们如何初始化权重呢？我用<strong class="lb iu">和<em class="nj">初始化他。</em>T12】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/038d4ad9c6ef06ea7f35afd250952af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*xY0tFMVjwdoJQs8x9byJ1Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">公式</p></figure><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="dfa2" class="ne md it na b gy nf ng l nh ni"># Python implementation<br/>np.random.randn(output_size, <em class="nj">hidden_size</em>)*<strong class="na iu">np.sqrt(2/<em class="nj">hidden_size</em>)</strong></span></pre><p id="234a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你不必用<strong class="lb iu"> <em class="nj">贺初始化，</em> </strong>你也可以用这个:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9781" class="ne md it na b gy nf ng l nh ni">np.random.randn(output_size, <em class="nj">hidden_size</em>)*<strong class="na iu">0.01</strong></span></pre><p id="6021" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议在初始化参数时，不要将权重设置为零或很大的数字。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8328" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">正向传播</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/9c0e94831594f998d6b21484d619874f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mO1O1oUsu9FkYK_81DPfTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正向传播</p></figure><p id="b357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图应该能让你很好地理解什么是前向传播。Python中的实现是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="9a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么我们要存储{'Z1': Z1，' Z2': Z2，' A1': A1，' y': y}？因为我们将在反向传播时使用它们。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e7e6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">价值函数</h1><p id="d7a1" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们只是观察正向传播，并得到一个预测(<strong class="lb iu"> y </strong>)。我们用成本函数来计算。下图解释了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/a67447c65025a9993820ac58b47d358d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aKnE6EmYInHoSQeYxbk86g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9191ebddc3099bdaa4278f3b5660c8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*kAU9URuNxT9vA4CGPwZYUw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更新参数</p></figure><p id="dddd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们更新我们的参数，并找到最佳参数，使我们的最低可能成本。我不打算深究导数，但请注意，在上面的图表中，如果你在抛物线的右侧，导数(斜率)将为正，因此参数将减少并向左移动，接近返回最小成本的参数。在左侧，斜率将是负的，因此参数朝着我们想要的值增加。让我们看看我们将使用的成本函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/7134fb06eb05fdbc5f57def25ce6437e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7U1JGoTlw3ocTbY-1TTeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">价值函数</p></figure><p id="4b6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">成本函数的Python代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d016" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">反向传播</h1><p id="014b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们已经找到了成本，现在让我们回去，找到我们的权重和偏差的导数。在以后的文章中，我计划向您展示如何一步一步地推导它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="470e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw na b">def backPropagation(<em class="nj">X</em>, <em class="nj">Y</em>, <em class="nj">params</em>, <em class="nj">cache</em>)</code>中的<code class="fe nu nv nw na b">params</code>和<code class="fe nu nv nw na b">cache</code>是什么？<strong class="lb iu"> </strong>当我们使用前向传播时，我们存储值以便在后向传播时使用。Params是参数(权重和偏差)。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d7f4" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">更新参数</h1><p id="9e5d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们有了导数，我们可以使用下面的等式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9191ebddc3099bdaa4278f3b5660c8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*kAU9URuNxT9vA4CGPwZYUw.png"/></div></figure><p id="243e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该等式中，alpha (α)是学习率超参数。我们需要在学习开始前将其设置为某个值。学习率右边的项是导数。我们知道α和导数，让我们更新我们的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9d69" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">关于循环的一切</h1><p id="60c8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们需要运行许多迭代来找到返回最小成本的参数。让我们循环吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="32ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw na b">Hidden_size</code> <strong class="lb iu"> </strong>表示隐藏层中神经元的数量。它看起来像一个超参数。因为你在学习开始前就设定好了！<em class="nj"/><code class="fe nu nv nw na b">return params, cost_</code><strong class="lb iu"><em class="nj"/></strong>告诉我们什么。<code class="fe nu nv nw na b">params</code> <strong class="lb iu"> </strong>是我们找到的最佳参数，<code class="fe nu nv nw na b">cost_</code>只是我们每集估算的成本。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2362" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">让我们试试我们的代码！</h1><p id="7490" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">使用<a class="ae ky" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> sklearn </strong> </a>创建数据集。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="96d6" class="ne md it na b gy nf ng l nh ni"><em class="nj">import </em>sklearn.datasets<br/>X, Y = sklearn.datasets.make_moons(n_samples=500, noise=.2)<br/>X, Y = X.T, Y.reshape(1, Y.shape[0])</span></pre><p id="618d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nu nv nw na b">X</code> <strong class="lb iu"> </strong>输入，<code class="fe nu nv nw na b">Y</code> <strong class="lb iu"> </strong>实际输出。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7627" class="ne md it na b gy nf ng l nh ni">params, cost_ = fit(X, Y, 0.3, 5, 5000)</span></pre><p id="1dca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我把学习率设为0.3，隐层神经元数设为5，迭代次数设为5000。</p><p id="c124" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随意尝试不同的价值观。</p><p id="deba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们画一张图，展示成本函数如何随着每集而变化:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f786" class="ne md it na b gy nf ng l nh ni"><em class="nj">import </em>matplotlib.pyplot <em class="nj">as </em>plt<br/>plt.plot(cost_)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/48026e77e35290bc10980595bd173e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*g5o4cvlG4_Afm6Z8YUYjrw.png"/></div></div></figure><p id="f16d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答对了。我们做到了！</p><blockquote class="ny nz oa"><p id="7cf7" class="kz la nj lb b lc ld ju le lf lg jx lh ob lj lk ll oc ln lo lp od lr ls lt lu im bi translated">first _ cost = 0.7383781203733911<br/>last _ cost = 0.063875631</p></blockquote><p id="6044" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d1d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！我希望这个教程是有帮助的！</p></div></div>    
</body>
</html>