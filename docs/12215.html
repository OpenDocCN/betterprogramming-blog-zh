<html>
<head>
<title>New in Google I/O 2022: Exploring the HTML Dialog Element</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google I/O 2022的新功能:探索HTML对话框元素</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/exploring-the-html-dialog-element-ee945503efe?source=collection_archive---------10-----------------------#2022-05-19">https://betterprogramming.pub/exploring-the-html-dialog-element-ee945503efe?source=collection_archive---------10-----------------------#2022-05-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b791" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看看web平台的新更新</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/da4b6266875aa0d5cd078dc65c2c8c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egTJSB_QJXkcfLgzzbtA1Q.png"/></div></div></figure><p id="7b25" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对话框和模态是任何web应用程序的基本组件。</p><p id="ebf3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">尽管如此，使用现有的<code class="fe lq lr ls lt b">div</code>元素为它创建和定义默认的行为逻辑仍然需要我们付出相当大的努力。</p><p id="26d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，我们通常以第三方对话框组件来结束这一天。</p><p id="9c72" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是现在，我们有了<code class="fe lq lr ls lt b">dialog</code>元素，根据<a class="ae lu" href="https://io.google/2022/program/3c60e411-5340-4c54-a037-3aceb2825b16/" rel="noopener ugc nofollow" target="_blank">最新的Google I/O 2022对Web平台的更新</a>，它现在被所有主流浏览器完全支持。</p><p id="f725" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们来看看对话框元素，好吗？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ff0b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介绍<code class="fe lq lr ls lt b">dialog</code>元素</h1><p id="fb75" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">对话框元素<code class="fe lq lr ls lt b">dialog</code>是一个非常新的HTML5元素，可以和<code class="fe lq lr ls lt b">&lt;dialog&gt;</code>标记一起使用，如下例所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="a85f" class="nd md it lt b gy ne nf l ng nh">&lt;dialog&gt;<br/>  &lt;div&gt;<br/>    I’m a dialog!<br/>  &lt;/div&gt;<br/>&lt;/dialog&gt;</span></pre><p id="5d54" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与其他HTML5元素不同，<code class="fe lq lr ls lt b">dialog</code>元素带有内置的API和一些基本的CSS样式。根据设计，<code class="fe lq lr ls lt b">dialog</code>元素有两种状态- <em class="ni">可见</em>(打开)或<em class="ni">隐藏</em>(关闭)，由单个属性<code class="fe lq lr ls lt b">open</code>表示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="5e1a" class="nd md it lt b gy ne nf l ng nh">&lt;dialog <em class="ni">open</em>&gt;<br/>  &lt;div&gt;<br/>    This dialog is opened and visible!<br/>  &lt;/div&gt;<br/>&lt;/dialog&gt;</span><span id="4afc" class="nd md it lt b gy nj nf l ng nh">&lt;dialog&gt;<br/>  &lt;div&gt;<br/>    This dialog is hidden!<br/>  &lt;/div&gt;<br/>&lt;/dialog&gt;</span></pre><p id="10a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">dialog</code>的初始状态为“<em class="ni">隐藏</em>”。<code class="fe lq lr ls lt b">dialog</code>元素公开了以下API方法来控制其条件:</p><ul class=""><li id="b40f" class="nk nl it kw b kx ky la lb ld nm lh nn ll no lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">showModal()</code> -通过将属性<code class="fe lq lr ls lt b">open</code>设置为元素来打开对话框。它还添加了一个<code class="fe lq lr ls lt b">::backdrop</code>伪元素来覆盖元素外部的内容，作为一种叠加效果。</li><li id="61a1" class="nk nl it kw b kx nt la nu ld nv lh nw ll nx lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">show()</code> -类似于<code class="fe lq lr ls lt b">showModal</code>，但没有添加背景。该方法对于使用<code class="fe lq lr ls lt b">dialog</code>作为toast通知非常有用。</li><li id="0f73" class="nk nl it kw b kx nt la nu ld nv lh nw ll nx lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">close(newReturnValue)</code> -通过删除<code class="fe lq lr ls lt b">open</code>属性关闭对话框，如果有任何<code class="fe lq lr ls lt b">newReturnValue</code>被传递，则更新<code class="fe lq lr ls lt b">dialog</code>元素的<code class="fe lq lr ls lt b">returnValue</code>。</li></ul><p id="c1b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了上面给定的API，接下来让我们实现一个简单的对话框。</p><h1 id="5cc7" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">创建简单的对话框</h1><p id="031c" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">我们将创建一个包含三个部分的简单对话框:</p><ul class=""><li id="c53e" class="nk nl it kw b kx ky la lb ld nm lh nn ll no lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">header</code>，它有一个对话框标题和一个取消按钮(带有一个X指示器)</li><li id="e4ae" class="nk nl it kw b kx nt la nu ld nv lh nw ll nx lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">main</code>显示对话框所有内容的部分。在我们的例子中，它只是一个简单的字符串。</li><li id="a130" class="nk nl it kw b kx nt la nu ld nv lh nw ll nx lp np nq nr ns bi translated"><code class="fe lq lr ls lt b">footer</code>包含一个<code class="fe lq lr ls lt b">menu</code>的动作按钮，如取消和确认按钮。</li></ul><p id="afce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的对话框的草图如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/0a0994c599265893c89652cf242a5aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0GEsTtPL-so7fsb1"/></div></div><p class="oe of gj gh gi og oh bd b be z dk translated">对话框组件的示例草图</p></figure><p id="56a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们将一个包含上述部分的<code class="fe lq lr ls lt b">dialog</code>标记元素添加到一个<code class="fe lq lr ls lt b">HTML</code>文件的<code class="fe lq lr ls lt b">body</code>部分。<code class="fe lq lr ls lt b">dialog</code>有一个值为<code class="fe lq lr ls lt b">main-dialog</code>的<code class="fe lq lr ls lt b">id</code>属性，如下所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="35b0" class="nd md it lt b gy ne nf l ng nh">&lt;html&gt;<br/>  &lt;body&gt;<br/>    &lt;dialog <em class="ni">id</em>=”main-dialog”&gt;<br/>       &lt;header&gt;<br/>         &lt;h2&gt;Dialog header&lt;/h2&gt;<br/>         &lt;button&gt;X&lt;/button&gt;<br/>       &lt;/header&gt;<br/>       &lt;main&gt;<br/>         Dialog content<br/>       &lt;/main&gt;<br/>       &lt;footer&gt;<br/>         &lt;menu&gt;<br/>           &lt;button&gt;Cancel&lt;/button&gt;<br/>           &lt;button&gt;Confirm&lt;/button&gt;<br/>         &lt;/menu&gt;<br/>       &lt;/footer&gt;<br/>     &lt;/dialog&gt;<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="50b6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们向<code class="fe lq lr ls lt b">body</code>添加一个<code class="fe lq lr ls lt b">main</code>元素，该元素包含一个用于打开对话框的<code class="fe lq lr ls lt b">button</code>:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="0759" class="nd md it lt b gy ne nf l ng nh">&lt;body&gt;</span><span id="0858" class="nd md it lt b gy nj nf l ng nh"> &lt;main <em class="ni">id</em>=”app”&gt;</span><span id="d458" class="nd md it lt b gy nj nf l ng nh">  &lt;button <em class="ni">id</em>=”open-dialog-btn”&gt;Open dialog&lt;/button&gt;</span><span id="0e31" class="nd md it lt b gy nj nf l ng nh"> &lt;/main&gt;</span><span id="1c83" class="nd md it lt b gy nj nf l ng nh"> &lt;dialog <em class="ni">id</em>=”main-dialog”&gt;</span><span id="1ea3" class="nd md it lt b gy nj nf l ng nh">  &lt;!-dialog content--&gt;</span><span id="b1c2" class="nd md it lt b gy nj nf l ng nh"> &lt;/dialog&gt;</span><span id="e182" class="nd md it lt b gy nj nf l ng nh">&lt;/body&gt;</span></pre><p id="591c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在浏览器上运行about代码时，您将看不到对话框，因为默认情况下它是不可见的。我们需要使用<code class="fe lq lr ls lt b">addEventListener</code>方法将<code class="fe lq lr ls lt b">button</code>的<code class="fe lq lr ls lt b">onclick</code>事件与<code class="fe lq lr ls lt b">id</code><em class="ni">open-dialog-BTN</em>绑定，如下所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="6c17" class="nd md it lt b gy ne nf l ng nh">//<em class="ni">1. Query for open dialog button</em></span><span id="b457" class="nd md it lt b gy nj nf l ng nh">const<em class="ni"> openBtn </em>=<em class="ni"> document.getElementById</em>(‘open-dialog-btn’);</span><span id="73aa" class="nd md it lt b gy nj nf l ng nh">//<em class="ni">2. Query for dialog element</em></span><span id="4735" class="nd md it lt b gy nj nf l ng nh">const<em class="ni"> dialog </em>=<em class="ni"> document.getElementById</em>(‘main-dialog’);</span><span id="99fd" class="nd md it lt b gy nj nf l ng nh">//<em class="ni">3. Add event listener to open dialog on click</em></span><span id="7e9e" class="nd md it lt b gy nj nf l ng nh"><em class="ni">openBtn.addEventListener</em>(‘click’, () =&gt; {</span><span id="0e90" class="nd md it lt b gy nj nf l ng nh"><em class="ni">  dialog.showModal</em>();</span><span id="f2b2" class="nd md it lt b gy nj nf l ng nh">})</span></pre><p id="8002" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">刷新浏览器，现在您可以看到无论何时单击<em class="ni">打开对话框</em>按钮，对话框都会打开:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/d5e2987c7a534cc669094fa553bca9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pI5s6W5kL8PvDrw8.gif"/></div></div></figure><p id="5a3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦对话框打开，我们必须将其他菜单按钮和标题按钮绑定到适当的事件处理程序，并相应地关闭对话框。为此，我们将相关的<code class="fe lq lr ls lt b">id</code>添加到<code class="fe lq lr ls lt b">button</code>控件中:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="89b0" class="nd md it lt b gy ne nf l ng nh">&lt;header&gt;</span><span id="d9d8" class="nd md it lt b gy nj nf l ng nh"> &lt;h2&gt;Dialog header&lt;/h2&gt;</span><span id="1232" class="nd md it lt b gy nj nf l ng nh"> &lt;button <em class="ni">id</em>=”dialog-header--cancel-btn”&gt;X&lt;/button&gt;</span><span id="c700" class="nd md it lt b gy nj nf l ng nh">&lt;/header&gt;</span><span id="26f5" class="nd md it lt b gy nj nf l ng nh">&lt;main&gt;</span><span id="88b7" class="nd md it lt b gy nj nf l ng nh"> Dialog content</span><span id="6f6c" class="nd md it lt b gy nj nf l ng nh">&lt;/main&gt;</span><span id="6587" class="nd md it lt b gy nj nf l ng nh">&lt;footer&gt;</span><span id="6f82" class="nd md it lt b gy nj nf l ng nh"> &lt;menu&gt;</span><span id="c684" class="nd md it lt b gy nj nf l ng nh">  &lt;button <em class="ni">id</em>=”dialog-footer--cancel-btn”&gt;Cancel&lt;/button&gt;</span><span id="aac3" class="nd md it lt b gy nj nf l ng nh">  &lt;button <em class="ni">id</em>=”dialog-footer--confirm-btn”&gt;Confirm&lt;/button&gt;</span><span id="f3f4" class="nd md it lt b gy nj nf l ng nh"> &lt;/menu&gt;</span><span id="518b" class="nd md it lt b gy nj nf l ng nh">&lt;/footer&gt;</span></pre><p id="2534" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后查询并绑定这些按钮上的<code class="fe lq lr ls lt b">click</code>事件来触发<code class="fe lq lr ls lt b">dialog.close()</code>，如下所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="b059" class="nd md it lt b gy ne nf l ng nh">//<em class="ni">1. Query for the buttons</em></span><span id="5ffc" class="nd md it lt b gy nj nf l ng nh">const<em class="ni"> cancelBtn </em>=<em class="ni"> document.getElementById</em>(‘dialog-footer--cancel-btn’);</span><span id="7efc" class="nd md it lt b gy nj nf l ng nh">const<em class="ni"> confirmBtn </em>=<em class="ni"> document.getElementById</em>(‘dialog-footer--confirm-btn’);</span><span id="a081" class="nd md it lt b gy nj nf l ng nh">const<em class="ni"> headerCancelBtn </em>=<em class="ni"> document.getElementById</em>(‘dialog-header--cancel-btn’);</span><span id="6612" class="nd md it lt b gy nj nf l ng nh">//<em class="ni">2. Bind to onclick event</em></span><span id="d2cc" class="nd md it lt b gy nj nf l ng nh"><em class="ni">cancelBtn.addEventListener</em>(‘click’, () =&gt; <em class="ni">dialog.close</em>());</span><span id="bd0d" class="nd md it lt b gy nj nf l ng nh"><em class="ni">confirmBtn.addEventListener</em>(‘click’, () =&gt; <em class="ni">dialog.close</em>());</span><span id="5dda" class="nd md it lt b gy nj nf l ng nh"><em class="ni">headerCancelBtn.addEventListener</em>(‘click’, () =&gt; <em class="ni">dialog.close</em>())</span></pre><p id="52c2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在拥有了完全可用的组件，如下例所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/63b392dfe0200c2c12f0091e91255766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_rCydtbiBS2fRsHA.gif"/></div></div></figure><p id="7f17" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你猜怎么着，它内置了导航辅助功能！</p><h1 id="e7b1" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">使用<code class="fe lq lr ls lt b">dialog</code>的可访问性</h1><p id="4ca0" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">一旦对话框打开，浏览器将聚焦于第一个按钮(在这种情况下，是对话框标题上的关闭按钮)或对话框中任何具有<code class="fe lq lr ls lt b">autofocus</code>属性的按钮。当您关闭对话框时，浏览器将焦点恢复到我们用来打开它的按钮上。</p><p id="0c0a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面演示了导航键盘和焦点在对话框元素中的外观:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/16d422104d02aa5bf5682ebd0045850b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*ll_Hc9D2pgg8YFHi.gif"/></div></figure><p id="03f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，对话框元素自动处理ESC ( <em class="ni"> escape </em>)键事件，从而减少了用户在使用对话框时为用户提供轻松体验所需的负担和工作量。</p><p id="e822" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，如果你想在关闭和打开对话框时添加动画效果，注意你将会失去这个内置的特性支持，并且不得不自己实现标签导航焦点。</p><p id="cf99" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到目前为止，一切顺利吗？接下来，我们将看看如何使用对话框中的表单？</p><h1 id="f674" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">在对话框中使用表单</h1><p id="f10b" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">表单和对话框是用来协同工作的。对话框的一个普遍用例是接收用户输入的信息。例如订阅表单、提交表单等。</p><p id="755e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，<code class="fe lq lr ls lt b">dialog</code>元素为<code class="fe lq lr ls lt b">form</code>提供了内置支持。为了启用对话框和表单之间的连接，您将<code class="fe lq lr ls lt b">form</code>元素的<code class="fe lq lr ls lt b">method</code>属性设置为<code class="fe lq lr ls lt b">dialog</code>，如下所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="3fa8" class="nd md it lt b gy ne nf l ng nh">&lt;dialog&gt;</span><span id="38a7" class="nd md it lt b gy nj nf l ng nh"> &lt;form <em class="ni">method</em>=’dialog’&gt;</span><span id="4ae4" class="nd md it lt b gy nj nf l ng nh"> &lt;/form&gt;</span><span id="338e" class="nd md it lt b gy nj nf l ng nh">&lt;/dialog&gt;</span></pre><p id="0877" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过这样做，触发任何表单的按钮元素(除了带有<code class="fe lq lr ls lt b">type='reset"</code>的按钮)也会自动关闭对话框，而不是手动在每个按钮上绑定<code class="fe lq lr ls lt b">close()</code>功能。</p><p id="aa1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在可以重构之前的示例对话框，用<code class="fe lq lr ls lt b">method='dialog"</code>将所有部分包装在一个<code class="fe lq lr ls lt b">form</code>下，并移除对话框按钮的所有点击事件监听器。最终代码应类似于以下内容:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="eb18" class="nd md it lt b gy ne nf l ng nh">&lt;body&gt;</span><span id="2b7e" class="nd md it lt b gy nj nf l ng nh"> &lt;main <em class="ni">id</em>=”app”&gt;</span><span id="a577" class="nd md it lt b gy nj nf l ng nh">  &lt;button <em class="ni">id</em>=”open-dialog-btn”&gt;Open dialog&lt;/button&gt;</span><span id="3dc3" class="nd md it lt b gy nj nf l ng nh"> &lt;/main&gt;</span><span id="feaa" class="nd md it lt b gy nj nf l ng nh"> &lt;dialog <em class="ni">id</em>=”main-dialog”&gt;</span><span id="1260" class="nd md it lt b gy nj nf l ng nh">  &lt;form <em class="ni">method</em>=”dialog”&gt;</span><span id="e914" class="nd md it lt b gy nj nf l ng nh">   &lt;header&gt;</span><span id="b488" class="nd md it lt b gy nj nf l ng nh">    &lt;h2&gt;Dialog header&lt;/h2&gt;</span><span id="f971" class="nd md it lt b gy nj nf l ng nh">    &lt;button <em class="ni">id</em>=”dialog-header--cancel-btn”&gt;X&lt;/button&gt;</span><span id="bf46" class="nd md it lt b gy nj nf l ng nh">   &lt;/header&gt;</span><span id="f0a2" class="nd md it lt b gy nj nf l ng nh">   &lt;main&gt;</span><span id="500d" class="nd md it lt b gy nj nf l ng nh">     Dialog content</span><span id="c2dc" class="nd md it lt b gy nj nf l ng nh">   &lt;/main&gt;</span><span id="950e" class="nd md it lt b gy nj nf l ng nh">   &lt;footer&gt;</span><span id="405b" class="nd md it lt b gy nj nf l ng nh">     &lt;menu&gt;</span><span id="9f4c" class="nd md it lt b gy nj nf l ng nh">      &lt;button <em class="ni">id</em>=”dialog-footer--cancel-btn”&gt;Cancel&lt;/button&gt;</span><span id="fdad" class="nd md it lt b gy nj nf l ng nh">      &lt;button <em class="ni">id</em>=”dialog-footer--confirm-btn”&gt;Confirm&lt;/button&gt;</span><span id="b6c2" class="nd md it lt b gy nj nf l ng nh">     &lt;/menu&gt;</span><span id="4901" class="nd md it lt b gy nj nf l ng nh">   &lt;/footer&gt;</span><span id="b0ed" class="nd md it lt b gy nj nf l ng nh">  &lt;/form&gt;</span><span id="9f2b" class="nd md it lt b gy nj nf l ng nh"> &lt;/dialog&gt;</span><span id="51d2" class="nd md it lt b gy nj nf l ng nh"> &lt;script&gt;</span><span id="a8ca" class="nd md it lt b gy nj nf l ng nh"> const<em class="ni"> openBtn </em>=<em class="ni"> document.getElementById</em>(‘open-dialog-btn’);</span><span id="c940" class="nd md it lt b gy nj nf l ng nh"> //<em class="ni">Query for dialog element</em></span><span id="83a1" class="nd md it lt b gy nj nf l ng nh"> const<em class="ni"> dialog </em>=<em class="ni"> document.getElementById</em>(‘main-dialog’);</span><span id="edb0" class="nd md it lt b gy nj nf l ng nh"> //<em class="ni">Add event listener to open dialog on click</em></span><span id="3a69" class="nd md it lt b gy nj nf l ng nh"><em class="ni"> openBtn.addEventListener</em>(‘click’, () =&gt; {</span><span id="045d" class="nd md it lt b gy nj nf l ng nh"><em class="ni">  dialog.showModal</em>(); </span><span id="b3ee" class="nd md it lt b gy nj nf l ng nh"> })</span><span id="5ead" class="nd md it lt b gy nj nf l ng nh"> &lt;/script&gt;</span><span id="37b2" class="nd md it lt b gy nj nf l ng nh">&lt;/body&gt;</span></pre><p id="0141" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该对话框的功能应该和以前一样。</p><p id="b756" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很酷，对吧？如果您希望每当从对话框外部关闭对话框时触发额外的逻辑，该怎么办？为此，我们使用了一个<code class="fe lq lr ls lt b">close</code>事件监听器。</p><h1 id="187f" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">监听对话的<code class="fe lq lr ls lt b">close</code>事件</h1><p id="0533" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated"><code class="fe lq lr ls lt b">dialog</code>有一个<code class="fe lq lr ls lt b">close</code>事件，我们可以使用以下语法将事件处理程序附加到该事件:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="a13c" class="nd md it lt b gy ne nf l ng nh"><em class="ni">dialog.addEventListener</em>(‘close’, () =&gt; {</span><span id="f5bb" class="nd md it lt b gy nj nf l ng nh"> //<em class="ni">your handler logic</em></span><span id="d6c3" class="nd md it lt b gy nj nf l ng nh">})</span></pre><p id="7380" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每当对话框关闭时，都会触发该功能，您可以使用<code class="fe lq lr ls lt b">data.returnValue</code>来决定用户是点击取消按钮还是提交按钮。为此，您需要向提到的按钮添加<code class="fe lq lr ls lt b">value</code>属性，如下所示:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="0e84" class="nd md it lt b gy ne nf l ng nh">&lt;menu&gt;</span><span id="d24b" class="nd md it lt b gy nj nf l ng nh"> &lt;button <em class="ni">value</em>=”cancel”&gt;Cancel&lt;/button&gt;</span><span id="4b87" class="nd md it lt b gy nj nf l ng nh"> &lt;button <em class="ni">value</em>=”confirm”&gt;Confirm&lt;/button&gt;</span><span id="4502" class="nd md it lt b gy nj nf l ng nh">&lt;/menu&gt;</span></pre><p id="c4f1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe lq lr ls lt b">close</code>事件监听器逻辑中，您可以执行一个简单的检查:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="bf97" class="nd md it lt b gy ne nf l ng nh"><em class="ni">dialog.addEventListener</em>(‘close’, () =&gt; {</span><span id="ce1a" class="nd md it lt b gy nj nf l ng nh"> if (<em class="ni">dialog.</em>returnValue === ‘cancel’) {</span><span id="605f" class="nd md it lt b gy nj nf l ng nh">  //<em class="ni">do something</em></span><span id="fe73" class="nd md it lt b gy nj nf l ng nh"> } else if (<em class="ni">dialog.</em>returnValue === ‘confirm) {</span><span id="6dc2" class="nd md it lt b gy nj nf l ng nh">  //<em class="ni">do something</em></span><span id="6171" class="nd md it lt b gy nj nf l ng nh"> }</span><span id="57e3" class="nd md it lt b gy nj nf l ng nh">})</span></pre><p id="616c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong>这里如果用户点击ESC键，<code class="fe lq lr ls lt b">returnValue</code>不会有任何值。</p><p id="14d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">至此，您已经熟悉了如何使用<code class="fe lq lr ls lt b">dialog</code>及其API。这个对话框带有基本的CSS样式，但是公平地说，它并没有我们想要的那么漂亮。</p><p id="b167" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们将对对话框外观进行一些必要的定制。</p><h1 id="7eb3" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">设置对话框样式</h1><p id="32a0" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">当使用<code class="fe lq lr ls lt b">showModal()</code>方法打开对话框时，对话框会自动生成一个带有默认背景颜色的<code class="fe lq lr ls lt b">::backdrop</code>元素。</p><p id="587a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以使用选择器<code class="fe lq lr ls lt b">::backdrop</code>来定制背景或者改变它的不透明度。例如，让我们将背景颜色更改为柔和的紫色(<code class="fe lq lr ls lt b">#d2cbff</code>)，透明度为70%:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="b830" class="nd md it lt b gy ne nf l ng nh">#<em class="ni">main-dialog</em>::<em class="ni">backdrop</em> {</span><span id="f854" class="nd md it lt b gy nj nf l ng nh"> background-color: #d2cbff;</span><span id="2931" class="nd md it lt b gy nj nf l ng nh"> opacity: 0.7;</span><span id="b1fa" class="nd md it lt b gy nj nf l ng nh">}</span></pre><p id="d323" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对话框打开时的输出如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e8cca10848bb5beb8f6f95d3754855db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/0*ddCUM2Ah3gsV9XD1"/></div></figure><p id="10ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，让我们改变对话框的边界，添加一些阴影，并使角落有点圆:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="7560" class="nd md it lt b gy ne nf l ng nh">#<em class="ni">main-dialog</em> {</span><span id="4621" class="nd md it lt b gy nj nf l ng nh"> box-shadow: 0 4px 5px rgb(0 0 0 / 30%);</span><span id="052b" class="nd md it lt b gy nj nf l ng nh"> border-radius: 8px;</span><span id="29ac" class="nd md it lt b gy nj nf l ng nh"> border: 1px solid #fff;</span><span id="692f" class="nd md it lt b gy nj nf l ng nh">}</span></pre><p id="ec0a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们使用CSS Flexbox将标题内容对齐到一行:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="68ca" class="nd md it lt b gy ne nf l ng nh">#<em class="ni">main-dialog </em>header {</span><span id="8281" class="nd md it lt b gy nj nf l ng nh"> display: flex;</span><span id="32b8" class="nd md it lt b gy nj nf l ng nh"> gap: 2rem;</span><span id="5ad7" class="nd md it lt b gy nj nf l ng nh"> justify-content: space-between;</span><span id="516f" class="nd md it lt b gy nj nf l ng nh"> align-items: center;</span><span id="5c05" class="nd md it lt b gy nj nf l ng nh">}</span><span id="d3be" class="nd md it lt b gy nj nf l ng nh">#<em class="ni">main-dialog </em>header<em class="ni"> </em>h2 {</span><span id="868f" class="nd md it lt b gy nj nf l ng nh"> margin-block: 0px;</span><span id="0cc7" class="nd md it lt b gy nj nf l ng nh">}</span></pre><p id="295c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">并为按钮添加一些CSS样式:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="1064" class="nd md it lt b gy ne nf l ng nh">#<em class="ni">main-dialog </em>footer<em class="ni"> </em>menu {</span><span id="b1d9" class="nd md it lt b gy nj nf l ng nh"> display: flex;</span><span id="ab21" class="nd md it lt b gy nj nf l ng nh"> justify-content: flex-end;</span><span id="17b9" class="nd md it lt b gy nj nf l ng nh"> gap: 0.5rem;</span><span id="7f37" class="nd md it lt b gy nj nf l ng nh"> margin: 0;</span><span id="377a" class="nd md it lt b gy nj nf l ng nh">}</span><span id="f530" class="nd md it lt b gy nj nf l ng nh">#<em class="ni">main-dialog </em>button {</span><span id="780f" class="nd md it lt b gy nj nf l ng nh"> padding: 0.75rem 1rem;</span><span id="bd8e" class="nd md it lt b gy nj nf l ng nh"> background: none;</span><span id="b0ac" class="nd md it lt b gy nj nf l ng nh"> font-size: 1rem;</span><span id="6e23" class="nd md it lt b gy nj nf l ng nh"> cursor: pointer;</span><span id="1ba7" class="nd md it lt b gy nj nf l ng nh"> font-size: 1rem;</span><span id="f827" class="nd md it lt b gy nj nf l ng nh"> border-radius: 5px;</span><span id="f910" class="nd md it lt b gy nj nf l ng nh"> border: 1px solid white;</span><span id="3309" class="nd md it lt b gy nj nf l ng nh">}</span><span id="82e2" class="nd md it lt b gy nj nf l ng nh">footer<em class="ni"> </em>#<em class="ni">dialog-footer — confirm-btn</em> {</span><span id="e440" class="nd md it lt b gy nj nf l ng nh"> background: #be4b80;</span><span id="202f" class="nd md it lt b gy nj nf l ng nh"> color: white;</span><span id="1b60" class="nd md it lt b gy nj nf l ng nh">}</span><span id="eac9" class="nd md it lt b gy nj nf l ng nh">footer<em class="ni"> </em>#<em class="ni">dialog-footer — cancel-btn</em>:<em class="ni">hover</em> {</span><span id="5c8a" class="nd md it lt b gy nj nf l ng nh"> background: #f7f3f3;</span><span id="0d8e" class="nd md it lt b gy nj nf l ng nh">}</span><span id="2291" class="nd md it lt b gy nj nf l ng nh">#<em class="ni">dialog-header — cancel-btn</em> {</span><span id="7ddc" class="nd md it lt b gy nj nf l ng nh"> height: fit-content;</span><span id="e64a" class="nd md it lt b gy nj nf l ng nh">}</span></pre><p id="2b8e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，对主<code class="fe lq lr ls lt b">form</code>应用CSS网格以保持<code class="fe lq lr ls lt b">header-content-footer</code>部分的布局:</p><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="b3bc" class="nd md it lt b gy ne nf l ng nh">#<em class="ni">main-dialog </em>form {</span><span id="e8be" class="nd md it lt b gy nj nf l ng nh">  display: grid;</span><span id="4c70" class="nd md it lt b gy nj nf l ng nh">  grid-template-rows: auto 1fr auto;</span><span id="c4b0" class="nd md it lt b gy nj nf l ng nh">  grid-gap: 1.5rem;</span><span id="82ca" class="nd md it lt b gy nj nf l ng nh">}</span></pre><p id="235e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终输出将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/95b27363e39f2713ab6c37014d7a3da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/0*8NPwdiRAWV9ZjB7z"/></div></figure><p id="0177" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就是这样！我们已经使用<code class="fe lq lr ls lt b">dialog</code>元素创建了对话框，并使用CSS Flexbox和Gridbox对其进行了定制！</p><h1 id="3bf0" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">演示</h1><p id="3d02" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">演示代码可供尝试。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><h1 id="94b2" class="mc md it bd me mf ny mh mi mj nz ml mm jz oa ka mo kc ob kd mq kf oc kg ms mt bi translated">浏览器支持</h1><p id="a0ca" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">好消息是谷歌最近宣布在除了ie浏览器之外的所有主流浏览器中全面支持T5及其API。我们现在可以享受内置对话框元素的好处，并开始根据我们的需要定制它。太棒了，不是吗？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d371" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">摘要</h1><p id="66e2" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">在这篇文章中，我们已经介绍了使用HTML和DOM APIs构建对话框组件的基础知识。我们还使用CSS Flexbox和Gridbox对对话框组件进行了一些定制。</p><p id="6d32" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了<code class="fe lq lr ls lt b">dialog</code>元素，在前端框架中构建一个可重用的对话框组件变得更加简单，开销也更小，尤其是在可访问性支持方面。您也可以使用相同的方法来创建一个模态或Toast通知组件。接下来，尝试使用<code class="fe lq lr ls lt b">dialog</code>元素在你最喜欢的框架中制作一个对话框组件怎么样，比如Vue或者React？应该很好玩吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt mz lt na nb aw nc bi"><span id="89b8" class="nd md it lt b gy ne nf l ng nh"><strong class="lt iu">Want to Connect?</strong></span><span id="436f" class="nd md it lt b gy nj nf l ng nh">If you’d like to catch up with me sometimes, follow me on <a class="ae lu" href="https://twitter.com/MayaShavin" rel="noopener ugc nofollow" target="_blank">Twitter</a> | <a class="ae lu" href="https://www.facebook.com/mayashavin/" rel="noopener ugc nofollow" target="_blank">Facebook</a>.</span><span id="0a6a" class="nd md it lt b gy nj nf l ng nh">Originally published at <a class="ae lu" href="https://mayashavin.com/articles/build-a-dialog-with-dialog-element" rel="noopener ugc nofollow" target="_blank">https://mayashavin.com</a>.</span></pre></div></div>    
</body>
</html>