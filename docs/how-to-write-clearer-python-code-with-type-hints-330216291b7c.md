# 如何用类型提示编写更清晰的 Python 代码

> 原文：<https://betterprogramming.pub/how-to-write-clearer-python-code-with-type-hints-330216291b7c>

## 通过使变量和函数更加自文档化来避免错误

![](img/ea2350101b676817e4ef16858089dfd4.png)

照片由[大卫·特拉维斯](https://unsplash.com/@dtravisphd?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

我们都经历过在一个项目中工作和对着屏幕咒骂的麻烦，因为变量和函数似乎毫无意义，到处都是`TypeError` s。这些情况使得开发人员希望 Python 中有静态类型，就像其他语言一样。还好有！是否使用它们以及在哪里使用它们完全取决于你！

# 什么是类型提示

顾名思义，类型提示是一种内置的方式，可以给出关于变量和函数代表什么的提示。您可以指定变量的类型或函数的返回类型，而无需改变程序的逻辑或添加任何代码行。您也可以创建自己的类型。需要指出的是，与静态类型语言不同，Python 解释器完全忽略了类型提示:事实上，它们只是提示，而不是规则。

# 类型提示的好处

与传统的动态 Python 风格相比，使用类型提示有很多好处:

*   **清晰度提高**:告别无意义的符号。能够容易地识别一个变量意味着什么将会加速开发时间。
*   更少的错误:去掉你程序中愚蠢的错误。
*   **自文档化代码**:懒得为你的代码写文档？写一些简单的函数来帮助那些可能会看你代码库的人。
*   **更好的 IDE 集成**:你的 IDE 将使用你给它的类型提示来更好地分析你的代码中的问题并帮助你编码。

# 如何实现类型提示

我将从一个简单的类型提示的例子开始，帮助您发展直觉。然后我将深入讨论它们。

虽然很酷，但这似乎帮助不大。显而易见，变量代表什么，甚至需要更多的时间来注释类型。但是类型提示并不止于此。Python 中有很多可用的类型，你可以从`typing`模块中导入更多，如下所示:

还有很多类型我就不在这里讨论了。你可以在[文档](https://docs.python.org/3/library/typing.html)中找到它们。

# 更高级的类型提示

到目前为止，你只是看到了一些很酷但没用的变量赋值。现在是时候真正使用类型提示了。

## 变量声明

您可以声明一个类型化变量，而不用给它赋值。这里有一个例子:

## 多种类型(联合)

`Union`表示类型可以是指定的类型之一:

## 类型化函数

类型化函数是编写良好的模块的主要部分。您可以指定参数的类型以及返回类型。这里有一个例子:

## 可选类型

请注意，可选类型不是可选参数。`Optional[x]`表示参数可以是`None`或`x.`

## 创建类型

如果愿意，您也可以创建自己的类型。以下是文档中的一个示例:

## 文字类型

一种类型，指示变量值必须是指定集合中的一个。看看这个例子:

## 使用类键入

同样，你可以用`NewType`定义你自己的类型。也可以用类；一个如下所示:

# 结论

类型提示是在程序中使用的一个很好的编码实践。它不仅使您的代码更容易理解，而且还有助于您的 IDE 的类型检查器识别并突出显示愚蠢的错误。除此之外，想象一下必须处理一个具有如下功能的模块:

作为`ip`应该传什么？对于`port`？`timeout`是`datetime.timedelta`对象还是`int`？`on_connection`和`on_error`带什么论点？`make_connection`还要返回什么？

创建更长但更清晰的自文档化代码值得花时间来注释类型，尤其是当其他人可能会阅读您的代码时。无论是公共模块还是你的团队正在进行的项目，清晰都是很重要的。

静态类型是一种祝福，而不是诅咒。尽可能使用它们。

如果你有更多类型提示的用例，请在评论中分享。我总是乐于学习新技术；他们肯定会受到赞赏。

如果您希望您的代码不仅可读性更好，而且运行速度也快几个数量级，那么您应该看看我关于 Python 的 C 扩展的文章:

[](/speed-up-your-python-codebases-with-c-extensions-94859875eb70) [## 用 C 扩展加速你的 Python 代码库

### 给你的 Python 程序带来 C 语言的速度

better 编程. pub](/speed-up-your-python-codebases-with-c-extensions-94859875eb70) 

感谢您的阅读！