<html>
<head>
<title>How to Do Angular Reactive Form Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何进行角反应形式验证</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-do-angular-reactive-form-validation-ecda45afa11f?source=collection_archive---------10-----------------------#2020-12-03">https://betterprogramming.pub/how-to-do-angular-reactive-form-validation-ecda45afa11f?source=collection_archive---------10-----------------------#2020-12-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7e9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Angular 9+中验证表单的有用代码示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9b45dd909cd2055da0a5c1bbe0a2a682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qRM0qprJzsMHMNTj"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@viniciusamano?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">vini cius“amnx”Amano</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="157a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文通过构建一个注册表单，提供了一个在Angular 9+中进行简单表单验证的例子。</p><ul class=""><li id="1580" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们将使用Angular的内置<code class="fe me mf mg mh b">Validators</code>来验证用户输入，这是框架提供的一组函数。</li><li id="9cee" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">我们将访问表单控件属性来管理何时应该显示哪些错误。</li><li id="94f1" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">只有当所有表单控件都有效时，我们才会启用提交按钮。</li></ul></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="25f4" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">验证器</h1><p id="e7fe" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">Angular为我们提供了一个<code class="fe me mf mg mh b">Validators</code>类，它包含一组静态函数，涵盖了常见的表单输入类型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3425" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些函数接受一个表单控件，如果验证失败，返回一个错误映射(如果输入有效，返回<code class="fe me mf mg mh b">null</code>)。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="71b9" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">验证注册表单</h1><h2 id="6f3e" class="nt mv it bd mw nu nv dn na nw nx dp ne li ny nz ng lm oa ob ni lq oc od nk oe bi translated">开发环境</h2><ul class=""><li id="8e58" class="lv lw it lb b lc nm lf nn li of lm og lq oh lu ma mb mc md bi translated">如果你在你的机器上使用过Angular应用程序，确保你已经安装了<a class="ae ky" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>和<a class="ae ky" href="https://angular.io/guide/setup-local" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>。</li><li id="98a4" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">我将展示如何使用<a class="ae ky" href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git" rel="noopener ugc nofollow" target="_blank"> Git </a>下载启动文件，如果您以前从未使用过，这也需要安装。</li></ul><h2 id="3ba0" class="nt mv it bd mw nu nv dn na nw nx dp ne li ny nz ng lm oa ob ni lq oc od nk oe bi translated">起始文件</h2><p id="25eb" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">要获得启动项目，从这个GitHub <a class="ae ky" href="https://github.com/jessipearcy/form-validation-start" rel="noopener ugc nofollow" target="_blank"> repo </a>中把它拉下来。要从命令行执行此操作，请导航到您想要下载应用程序的位置，并键入以下Git命令:</p><pre class="kj kk kl km gt oi mh oj ok aw ol bi"><span id="ba74" class="nt mv it mh b gy om on l oo op">git clone <a class="ae ky" href="https://github.com/jessipearcy/form-validation-start.git" rel="noopener ugc nofollow" target="_blank">https://github.com/jessipearcy/form-validation-start.git</a></span></pre><p id="d617" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把文件复制到文件夹中。接下来，运行以下两个命令导航到该文件夹，并安装Angular应用程序运行所需的软件包:</p><pre class="kj kk kl km gt oi mh oj ok aw ol bi"><span id="ac93" class="nt mv it mh b gy om on l oo op">cd form-validation-start<br/>npm ci</span></pre><p id="49cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在所有的软件包安装完成后，在命令行中输入<code class="fe me mf mg mh b">ng serve</code>，按enter键，然后导航到<code class="fe me mf mg mh b"><a class="ae ky" href="http://localhost:4202/" rel="noopener ugc nofollow" target="_blank">http://localhost:420</a>0</code>，你应该会看到正在运行的应用程序。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="f0c3" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">必填字段</h1><p id="9d08" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果您现在就检查正在运行的应用程序，用户可以输入几乎任何数据(或者没有数据！)到表单中，并在没有任何防护栏的情况下提交它，以确保我们从它们那里获得一些有用的东西。让我们首先确保用户必须输入所需的数据，以便我们知道他们是谁以及注册所需的任何信息。</p><p id="7a82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe me mf mg mh b">form.component.ts</code>中，让我们将<code class="fe me mf mg mh b">required</code>验证器添加到所有必填字段:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="896e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，让我们添加一些getter属性，这样我们就可以轻松地从HTML模板中访问与每个表单控件相关联的数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="8746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe me mf mg mh b">form.component.html</code>中，我们将添加错误消息和逻辑来指示消息何时出现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="d68e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">控制属性</h1><p id="001c" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">如果您将这些表单控件之一注销到控制台，您将能够看到我们可以访问的属性，以便知道我们何时需要显示错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/4ad409fec0c156c93e4c390df19382f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xozQ2V72PqC5hriOY5A1tQ.png"/></div></div></figure><p id="88e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为在有输入之前，必填字段会将控件的状态设置为“无效”，所以我们需要使用<code class="fe me mf mg mh b">touched</code>属性来知道用户已经尝试填写表单，但是没有满足我们的验证要求。类似地，当一个字段有多个验证类型时，我们稍后将使用<code class="fe me mf mg mh b">errors</code>属性来管理我们的消息传递。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="dd33" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">对无效输入禁用提交</h1><p id="484f" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated"><code class="fe me mf mg mh b">signup</code>表单组还有一个<code class="fe me mf mg mh b">status</code>属性，我们可以检查这个属性，以了解所有的字段都已经过验证并且是可接受的。要禁用按钮，我们只需将<code class="fe me mf mg mh b">disabled</code>属性绑定到表单的<code class="fe me mf mg mh b">invalid</code>属性的值:</p><pre class="kj kk kl km gt oi mh oj ok aw ol bi"><span id="f711" class="nt mv it mh b gy om on l oo op">&lt;button [disabled]="signup.invalid" type="submit"&gt;Submit&lt;/button&gt;</span></pre><p id="f388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，保存后，您应该会看到按钮被禁用，直到所有字段都已填写完毕！</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="a2db" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">验证数据</h1><p id="5f29" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">接下来，我们将添加一些额外的验证器来确保用户不仅输入了<em class="or">一些东西</em>，而且这也是我们所期望的。两个突出的字段是电子邮件地址(我们希望确保它是一个真实的地址)和消息长度(我们不希望有人只输入一个字符就可以提交表单！).让我们更新这两个控件，使用内置的<code class="fe me mf mg mh b">email</code>和<code class="fe me mf mg mh b">minLength</code>验证器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="578d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，当使用多个验证器时，您将一个数组作为第二个参数传递给<code class="fe me mf mg mh b">FormControl</code>构造函数。</p><p id="d9be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在HTML中添加两个额外的提醒。我们可以使用括号符号和错误名称来检查<code class="fe me mf mg mh b">errors</code>对象中我们期望错误:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="482c" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">业务逻辑验证</h1><p id="bb3d" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">假设我们的客户不仅要求我们验证基本的表单功能，还要求一些额外的验证来满足他们的特殊需求。接下来，我们将添加验证来检查输入的数量是否可被客户端接受，并验证用户是否已经注册。</p><p id="c513" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将以下代码添加到<code class="fe me mf mg mh b">form.component.ts</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a5c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于这段代码的几点说明:</p><ul class=""><li id="d765" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">验证我们的客户列表超出了Angular的Validators类提供的内置函数的范围，所以我们创建了自己的函数！是一个函数，我们可以将它添加到传递给表单控件的验证器数组中。</li><li id="d351" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">对于这个例子，我们的客户列表只是一个简单的硬编码在类中的字符串数组。在现实生活中，您最有可能遇到从某个地方的存储中检索客户列表的服务。</li><li id="4180" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">validator函数中的语法有点不可靠，乍一看可能会觉得奇怪！这个函数在说，“返回一个新函数”，这个函数本身将返回一个格式为<code class="fe me mf mg mh b">{ [key: string]: any }</code>的对象，它与我们期望用于验证控件对象的<code class="fe me mf mg mh b">errors</code>对象相匹配。</li><li id="39b8" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated">您在返回对象中命名的属性就是我们将在HTML中检查的内容。它将是<code class="fe me mf mg mh b">errors</code>对象中的键，并将导致表单无效，直到它通过验证。</li></ul><p id="e626" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe me mf mg mh b">form.component.html</code>，让我们连接新的验证:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2d13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！一个经过验证的表单，它将确保我们总是得到一些数据，我们不会得到错误的数据，并且我们满足工作流所需的要求。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7900" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">资源</h1><ul class=""><li id="7fff" class="lv lw it lb b lc nm lf nn li of lm og lq oh lu ma mb mc md bi translated"><a class="ae ky" href="https://stackblitz.com/edit/angular-ivy-95kx4c" rel="noopener ugc nofollow" target="_blank"> Stackblitz演示</a></li><li id="b7b1" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><a class="ae ky" href="https://github.com/jessipearcy/form-validation" rel="noopener ugc nofollow" target="_blank"> Github回购</a></li><li id="4a72" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><a class="ae ky" href="https://angular.io/guide/form-validation" rel="noopener ugc nofollow" target="_blank">角形验证文件</a></li><li id="6276" class="lv lw it lb b lc mi lf mj li mk lm ml lq mm lu ma mb mc md bi translated"><a class="ae ky" href="https://www.freecodecamp.org/news/how-to-validate-angular-reactive-forms/" rel="noopener ugc nofollow" target="_blank"> FreeCodeCamp表单验证教程</a></li></ul></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="5014" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">附加媒体文章</h1><div class="os ot gp gr ou ov"><a href="https://medium.com/better-programming/learn-angular-basics-by-building-a-simple-app-using-angular-material-9bbc19aa33cf" rel="noopener follow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">通过使用角度材料构建一个简单的应用程序来学习角度基础知识</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">奖励:包括使用角度反应形态的一瞥</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">medium.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div><div class="os ot gp gr ou ov"><a href="https://medium.com/better-programming/routing-101-in-angular-9-c76144b28cbd" rel="noopener follow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">角度为9+的路径101</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">关于使用角度布线显示视图和在零部件之间传递数据的快速教程</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">medium.com</p></div></div><div class="pe l"><div class="pk l pg ph pi pe pj ks ov"/></div></div></a></div><div class="os ot gp gr ou ov"><a href="https://medium.com/better-programming/teaching-yourself-to-code-focus-on-getting-in-the-reps-2ef979ee971b" rel="noopener follow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">自学编码？专注于销售代表</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">如何通过更多、更高质量的练习来取得显著的进步</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">medium.com</p></div></div><div class="pe l"><div class="pl l pg ph pi pe pj ks ov"/></div></div></a></div></div></div>    
</body>
</html>