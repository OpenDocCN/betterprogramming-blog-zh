<html>
<head>
<title>How to Get Started With iOS Animation (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何开始使用iOS动画(第1部分)</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/getting-start-with-ios-animation-part-1-7bd3a673bee4?source=collection_archive---------7-----------------------#2020-06-09">https://betterprogramming.pub/getting-start-with-ios-animation-part-1-7bd3a673bee4?source=collection_archive---------7-----------------------#2020-06-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fc70" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何制作视图组件的动画</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1d9c2702a2fdf2afb2005255b85259e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-67-5Vh7VIHqkjJI9j3dHg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@cosmictimetraveler?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">宇宙时间旅行者</a>在<a class="ae kv" href="https://unsplash.com/s/photos/frame?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3b27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">动画是让我们的应用程序变得有趣和专业的关键。如果用户觉得开发者投入了精力，一丝不苟地让应用程序更加用户友好，他们就会更加信任你的应用程序，并参与其中。</p><p id="30a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个由三部分组成的系列中，我们将看到我们可以在iOS中制作的一整套动画:</p><ul class=""><li id="029a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">查看动画。在第一篇文章中，我们将创建一个视图，并让视图的组件来回移动。</li><li id="9fb4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">电影般的动画。在本文中，我们将学习如何实现Lottie框架和图像序列。最后，我们将比较视频、GIF、图像序列、编码动画和Lottie框架。</li><li id="7cdd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">过渡动画。在本文中，我们将触及iOS动画的最后也是最复杂的部分:视图控制器过渡动画。</li></ul><p id="0f76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">先决条件:读者应该知道如何创建像<code class="fe mg mh mi mj b">UIView</code>、<code class="fe mg mh mi mj b">UIButton</code>和<code class="fe mg mh mi mj b">UIImageView</code>这样的视图组件。</p><p id="123e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第一部分中，我们将看到如何实现所有推荐的使视图组件动画化的方法。此外，我们分析了每种方法的限制和使用情况。</p><p id="537b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为一个动画图像胜过千言万语，所以下面是最终的结果(实际上我们会添加更多的用户互动动画作为奖励):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/99f685cfd3b646383510014f3790524b.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*y8bQvtkE_J0Ii9NKECx2NA.gif"/></div></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="30f8" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">本教程的设置</h1><p id="3c84" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">在进入动画之前，我们必须初始化一些视图组件，并将它们添加到主视图中。这是我们所有动画的起点。请在您的初始视图控制器中添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="3e72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上，我们在这里做的是在视图中央插入应用程序徽标图像和打开按钮(隐藏)。我们还在屏幕的底部添加了一辆汽车<code class="fe mg mh mi mj b">ImageView</code>。这是我们现在所拥有的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3fb15d58ae026c4e21e00bac0df8a825.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*a8QuHBab46H0olp5mWO7og.png"/></div></figure><p id="ad1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在深入研究动画代码之前，值得一提的是，创建一个动画需要大量的试验和错误。我们需要多次测试，以找出最佳的持续时间、帧定时、位置和其他参数值。为了方便测试，我们应该使用模拟器的慢动作工具(模拟器-&gt;调试-&gt;慢速动画)来监控动画。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="8125" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">最简单的视图动画形式:UIView.animated函数</h1><p id="1b40" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">制作视图动画最简单的方法是使用<code class="fe mg mh mi mj b">UIView.animated</code>功能。这里我们要做两件事:将app logo“Animation”移动到顶部，淡入打开按钮。</p><p id="9f53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将此函数添加到当前代码中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a5c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，这个函数非常简单。它包含三个输入:</p><ul class=""><li id="6bfc" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><code class="fe mg mh mi mj b">withDuration</code>:指定动画的持续时间。这里我们要在一秒钟内移动logo。</li><li id="87f5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe mg mh mi mj b">animations</code>:描述该动画的最终状态。这里我们指定了徽标图像视图的最终位置(框架)。该函数本身将插入源帧值和目标帧值来激活动作。</li><li id="fdca" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe mg mh mi mj b">completion</code>(可选):这是一个完成处理程序，通知我们动画序列是否完成。在这里，我们让它成为我们自己的完成。</li></ul><p id="4e96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们在<code class="fe mg mh mi mj b">viewDidAppear</code>中执行这个函数。另外，当动画标志结束时，我们还使用<code class="fe mg mh mi mj b">UIView.animate</code>功能淡入打开按钮:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="952e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在运行我们的应用程序。我们应该看到这一点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/fcc000d874d9b398b765618eb95f2c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*loggser7ayOCXIH1L4QmIw.gif"/></div></figure><p id="62ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个函数能够处理视图的边框、边界、中心、变换、alpha和背景颜色。</p><p id="588d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mg mh mi mj b">UIView</code>的动画功能有一些变体，允许指定更多的动画属性，如阻尼、动画选项(容易进入、容易退出等)。)，延迟，等等。我们建议您阅读Apple的文档以了解更多细节。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="7558" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">动画层属性:CABasicAnimation</h1><p id="68d6" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated"><code class="fe mg mh mi mj b">CABasicAnimation</code>是一个为层属性提供基本的单关键帧动画功能的对象。您使用继承的<code class="fe mg mh mi mj b">init(keyPath:)</code>方法创建CABasicAnimation的一个实例，指定要在呈现中动画化的属性的关键路径。像<code class="fe mg mh mi mj b">UIView.animated</code>函数一样，通过指定<code class="fe mg mh mi mj b">fromValue</code>和<code class="fe mg mh mi mj b">toValue</code>，核心动画将插入过渡值并制作动画。您可以参考核心动画编程指南、<a class="ae kv" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/AnimatableProperties/AnimatableProperties.html" rel="noopener ugc nofollow" target="_blank">附录B </a>和<a class="ae kv" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Key-ValueCodingExtensions/Key-ValueCodingExtensions.html#//apple_ref/doc/uid/TP40004514-CH12-SW2" rel="noopener ugc nofollow" target="_blank">附录C </a>中关键路径的完整列表。</p><p id="3e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用<code class="fe mg mh mi mj b">CABasicAnimation</code>动画绘制打开按钮周围的线条。为此，我们采用四个步骤:</p><ol class=""><li id="2759" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ns ly lz ma bi translated">为那条线创建贝塞尔路径。</li><li id="f83b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ns ly lz ma bi translated">将该路径注入到一个<code class="fe mg mh mi mj b">CAShapeLayer</code>中。</li><li id="44c5" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ns ly lz ma bi translated">通过指定我们的动画参数创建<code class="fe mg mh mi mj b">CABasicAnimation</code>对象。</li><li id="57fd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ns ly lz ma bi translated">通过使用<code class="fe mg mh mi mj b">CATransaction</code>在我们的<code class="fe mg mh mi mj b">CAShapeLayer</code>上执行这个<code class="fe mg mh mi mj b">CABasicAnimation</code>。</li></ol><p id="33cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1d92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码看起来很吓人，但实际上大部分是用来指定我们的动画参数，比如持续时间、开始位置、结束位置、时间<code class="fe mg mh mi mj b">easyInEasyOut</code>等。这些值是通过反复试验找到的。</p><p id="ab64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们通过用函数<code class="fe mg mh mi mj b">self.animateLoginButton()</code>替换<code class="fe mg mh mi mj b">animateLogo</code>的完成来执行这个函数。我们收到下面的结果(请忽略汽车移动；我们稍后再做):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/4d830b412fc13f342d23223b3a63a63f.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*fy0_CZJl4xbE-SZZJqsbIg.gif"/></div></figure><p id="b09a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于我们刚刚在这里学到的，我们可以很容易地创建一个基于用户触摸的“摇动”动画。基本上，当用户触摸动画标志时，我们希望标志被摇动。正如您可能已经发现的那样，该动画将是一个位置类型(从左到右)，自动反转，并循环大约四到五次。代码应该如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d740" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了将点击事件连接到该函数，我们可以在<code class="fe mg mh mi mj b">setupUI</code>函数中将手势识别器注册到徽标图像视图:</p><pre class="kg kh ki kj gt nt mj nu nv aw nw bi"><span id="277e" class="nx mt iq mj b gy ny nz l oa ob">logoImageView.isUserInteractionEnabled = true<br/>logoImageView.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(shakeLogo)))</span></pre><p id="3097" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行代码，下面是点击徽标图像时的结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/60b3587659d3c8d0dcdd586479a99bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*Avj2NSXasDagSnScvHBLHQ.gif"/></div></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="a521" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">通过用户交互制作动画</h1><p id="55c5" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">与视图动画交互最方便的方式是使用<code class="fe mg mh mi mj b">UIViewPropertyAnimator</code>。来自<a class="ae kv" href="https://developer.apple.com/documentation/uikit/uiviewpropertyanimator" rel="noopener ugc nofollow" target="_blank">苹果的文档</a>:</p><blockquote class="oc od oe"><p id="5b7e" class="kw kx of ky b kz la jr lb lc ld ju le og lg lh li oh lk ll lm oi lo lp lq lr ij bi translated">“一个<code class="fe mg mh mi mj b">UIViewPropertyAnimator</code>对象可以让您将视图的更改制作成动画，并在它们完成之前动态修改您的动画。使用属性动画师，您可以正常地从头到尾运行您的动画，或者您可以将它们转换为交互式动画并自己控制时间。动画师操作视图的动画属性，如帧、中心、alpha和变换属性，从您提供的块创建所需的动画。</p></blockquote><p id="bbf1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其实<code class="fe mg mh mi mj b">UIViewPropertyAnimator</code>和<code class="fe mg mh mi mj b">UIView.animated</code>功能比较类似。当我们创建这个对象时，我们必须指定一个包含代码的块，该代码修改一个或多个视图的属性、时间曲线、持续时间以及动画完成时要执行的完成块。</p><p id="53cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将应用这个对象来制作汽车的动画。我们想让它无限地向右移动，然后再向左移动。另外，我们需要捕捉用户的点击手势，然后让汽车后退。所以基本上我们需要三个功能。一个函数在用户点击汽车时运行，一个函数使汽车向右运行，最后一个函数使汽车向左移动:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d5f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们将这些函数连接到我们在<code class="fe mg mh mi mj b">viewDidAppear</code>中的视图，并添加<code class="fe mg mh mi mj b">self.animateCarToRight()</code>。在<code class="fe mg mh mi mj b">setupUI()</code>中，添加以下内容:</p><pre class="kg kh ki kj gt nt mj nu nv aw nw bi"><span id="23a5" class="nx mt iq mj b gy ny nz l oa ob">carImageView.isUserInteractionEnabled = true<br/>carImageView.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(userTapOnCar)))</span></pre><p id="543c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行应用程序，尝试点击汽车，看看它是否会后退。结果如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/577aff37da55a4b200a1838d34f651cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*qgtMuzQQUwxsqe-RUxtgfA.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">轻敲汽车使它返回</p></figure></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="a5a6" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">从这里去哪里</h1><p id="198e" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">可以<a class="ae kv" href="https://www.dropbox.com/sh/nnfgxk6umaypb8o/AABVjUozrFZ1aZLJEYCIlRrra?dl=0" rel="noopener ugc nofollow" target="_blank">下载本教程</a>的代码。</p><p id="be29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们学习了如何使用<code class="fe mg mh mi mj b">UIView.animated</code>函数制作一个<code class="fe mg mh mi mj b">UIView</code>的动画。我们还看到了核心动画如何帮助我们使用贝塞尔路径和<code class="fe mg mh mi mj b">CABasicAnimation</code>绘制层动画。最后，我们想出了如何让用户与动画互动。</p><p id="ef7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在是制作视图组件动画的专家。在下一篇文章中，我们的目标是制作一系列图像的动画(类似电影的动画)，在最后一篇文章中，我们将制作视图控制器之间的过渡动画。</p><p id="c819" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是第二部分之后的内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/8a8876f8839f26753e6212eda6b6c66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*rA5aAEi4i48lDFsMxXhG2A.gif"/></div></figure><p id="20d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在最后一部分，我们制作了当前转换和解散转换的动画。我们还将学习如何以编程方式控制动画的进度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/ae4218c55e267815d44b611deb15882a.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*Nbh4E2lhoN9OrlkjqCD1ZQ.gif"/></div></figure><p id="a365" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这个教程。下一集再见。</p></div></div>    
</body>
</html>