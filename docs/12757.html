<html>
<head>
<title>How to Implement an Animated Tab in React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React Native中实现动画标签</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-implement-an-animated-tab-in-react-native-c1952ad7103e?source=collection_archive---------5-----------------------#2022-06-29">https://betterprogramming.pub/how-to-implement-an-animated-tab-in-react-native-c1952ad7103e?source=collection_archive---------5-----------------------#2022-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6653" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用React Native动画平滑选项卡动画</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/019334fe8354c7226c2e58ddd9c26953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUZSnIjT09CQq5Sj14XkBw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@fakurian" rel="noopener ugc nofollow" target="_blank"> Milad Fakurianon </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄。</p></figure><p id="4573" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章将指导你如何使用<a class="ae ky" href="https://github.com/satya164/react-native-tab-view" rel="noopener ugc nofollow" target="_blank"> react-native-tab-view </a>和<a class="ae ky" href="https://github.com/software-mansion/react-native-reanimated" rel="noopener ugc nofollow" target="_blank">React-Native-reanimated</a>在React Native中创建动画选项卡视图。动画选项卡的最后一个示例如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/99dcc81f0919e70b6174733e1a98bcae.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*fqV4t6P-wgr91AXDcpgIgg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最后一个例子</p></figure><h1 id="639f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">示例存储库</h1><p id="2b54" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这是基于<a class="ae ky" href="https://github.com/manakuro/react-native-animated-tab-view-example" rel="noopener ugc nofollow" target="_blank"> GitHub </a>的最终代码</p><h1 id="db66" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">概观</h1><ul class=""><li id="5bf0" class="mt mu it lb b lc mo lf mp li mv lm mw lq mx lu my mz na nb bi translated">设置本地反应</li><li id="d3eb" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">介绍react-native-tab-view</li><li id="1c27" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">自定义标签栏</li></ul><h1 id="6666" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">设置本地反应</h1><p id="20ba" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">首先，设置React原生app。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="e75a" class="nm lx it ni b gy nn no l np nq">npx react-native init AnimatedTabViewExample --template react-native-template-typescript</span></pre><p id="a227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并启动iOS应用程序:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="fc2e" class="nm lx it ni b gy nn no l np nq">yarn ios</span></pre><p id="7b17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">初始页面应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/93f13c5112eeafaaad7de594d1015022.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*fgYScygLOSS7VgO9gL-5lg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">黑暗模式下的ios应用程序</p></figure><h1 id="9456" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">介绍react-native-tab-view</h1><p id="1aa2" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，安装react-native-tab-view。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0b65" class="nm lx it ni b gy nn no l np nq">yarn add react-native-tab-view@3.1.1 react-native-pager-view@5.4.24</span></pre><p id="00a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到ios文件夹并安装Cocoapods:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="bde9" class="nm lx it ni b gy nn no l np nq">$ cd ios<br/>$ bundle exec pod install</span></pre><p id="131d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe ns nt nu ni b">App.tsx</code>并编写如下标签视图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="04d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建两个如下所示的选项卡:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/eafd969963fbe3a06f72794cff43ee8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*yH_8dZikvP56xQCkyxb8Gg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">初始选项卡</p></figure><h1 id="a546" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">自定义标签栏</h1><p id="eb38" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">既然我们已经在应用程序中引入了选项卡视图。接下来，让我们自定义选项卡栏。</p><p id="d0f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，创建<code class="fe ns nt nu ni b">src/components/TabBar.tsx</code>并编写一个标签栏组件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5e18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并创造出这样的<code class="fe ns nt nu ni b">src/components/TabBarItem.tsx</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="2887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了定制默认的dab栏，给<code class="fe ns nt nu ni b">App.tsx</code>中的<code class="fe ns nt nu ni b">renderTabBar</code>道具提供一个组件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="e2db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并为<code class="fe ns nt nu ni b">App.tsx</code>中的第一个和第二个选项卡调整一些样式。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="cd41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，选项卡视图如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/b6796b14bcb68bfe3fc023f638a4b5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*FfFfyg4k4WjDvGVJky6h8A.gif"/></div></figure><h1 id="87e6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">不透明度动画</h1><p id="fa0a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，让我们使用<a class="ae ky" href="https://reactnative.dev/docs/animations#interpolation" rel="noopener ugc nofollow" target="_blank">插值</a>为标签栏添加不透明度动画。插值允许您控制和连接两个动画。您可以连接标签页的不透明度和位置，然后以完全相同的时间转换，并反向操作。</p><p id="7e13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个应用程序中，我们将添加一个动画，当切换标签时，不透明度从0逐渐变为1。</p><p id="cbfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe ns nt nu ni b">src/components/TabBar.tsx</code>，向组件添加插值，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="4c4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu ni b">position</code>是一个动画节点，代表标签的当前位置，具有插值功能。当当前选项卡切换到下一个选项卡时，不透明度将从0.5变为1。</p><p id="2b5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe ns nt nu ni b">src/components/TabBarItem.tsx</code>，像这样添加不透明道具:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="584d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">动画看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/f22f42148f87c85ccbb154de98a4a125.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*cIgWjTVejl5H61B9fGGSPg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不透明度动画</p></figure><p id="56fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">切换标签时，您可以看到标签栏中项目的不透明度发生了变化。</p><h2 id="03a1" class="nm lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">边框宽度动画</h2><p id="f00d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，我们将使用react-native-reanimated实现一个边框宽度动画。react-native-reanimated允许本机代码在UI线程而不是JS线程上动画显示宽度，以获得更好的性能。基本上，React Native不支持宽度动画，除非<code class="fe ns nt nu ni b">useNativeDriver</code>设置为true。</p><p id="8fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装react-native-reaniated。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="63f3" class="nm lx it ni b gy nn no l np nq">yarn react-native-reanimated</span></pre><p id="c977" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转到ios文件夹并安装Cocoapods:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="52f0" class="nm lx it ni b gy nn no l np nq">$ cd ios<br/>$ bundle exec pod install</span></pre><p id="a945" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给<code class="fe ns nt nu ni b">babel.config.js</code>添加reanimated的巴别塔插件像这样:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="9d65" class="nm lx it ni b gy nn no l np nq">module.exports = {<br/>  presets: ['module:metro-react-native-babel-preset'],<br/>  plugins: ['react-native-reanimated/plugin'],<br/>};</span></pre><p id="aa77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开<code class="fe ns nt nu ni b">src/components/TabBar.tsx</code>，写下这段代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="b488" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ns nt nu ni b">measureLayout</code>允许你根据父视图的尺寸动态计算子视图的尺寸。所以<code class="fe ns nt nu ni b">measures</code>的结果包括这样的东西:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="8a6a" class="nm lx it ni b gy nn no l np nq">[<br/>  {<br/>    height: 23.333335876464844,<br/>    width: 31.666667938232422,<br/>    x: 16,<br/>    y: 16,<br/>  },<br/>  {<br/>    height: 23.333335876464844,<br/>    width: 55.333335876464844,<br/>    x: 79.66666793823242,<br/>    y: 16,<br/>  },<br/>];</span></pre><p id="d18f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且创建<code class="fe ns nt nu ni b">src/components/TabBarIndicator.tsx</code>并这样写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="d7ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该组件跟踪选项卡的位置，并根据从父级传递的尺寸连接宽度和位置的动画。</p><p id="6797" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，动画看起来应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/5ca168c1c20780b0710e97c61dac57fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*6wtPoJGgzOZVTqZgu8E9WQ.gif"/></div></figure><p id="424a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，滑动标签改变了边框的宽度和位置。</p><p id="0588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们在<code class="fe ns nt nu ni b">App.tsx</code>中添加了更多的标签项，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="2bf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，最终的动画应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/99dcc81f0919e70b6174733e1a98bcae.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*fqV4t6P-wgr91AXDcpgIgg.gif"/></div></figure><h1 id="557b" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="502e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们已经介绍了如何在React Native中实现选项卡视图的动画。最终的代码库在<a class="ae ky" href="https://github.com/manakuro/react-native-animated-tab-view-example" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上，你可以尝试一下。</p></div></div>    
</body>
</html>