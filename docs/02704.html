<html>
<head>
<title>Displaying Photos From Your Photo Library in Flutter Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter应用程序中显示照片库中的照片</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/displaying-photos-from-your-photo-library-in-flutter-applications-34b8799a3849?source=collection_archive---------6-----------------------#2019-12-18">https://betterprogramming.pub/displaying-photos-from-your-photo-library-in-flutter-applications-34b8799a3849?source=collection_archive---------6-----------------------#2019-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e00d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向您的Flutter应用程序介绍美丽的图像</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/057b20bdcbed6fce91b5f92a1a079910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RV8ab9U3q3QX3hHU0eh8jg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@alex_andrews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亚历山大·安德鲁斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/photo-album?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="d9ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">信不信由你，大多数人购买智能手机是为了给他们的猫、狗和孩子拍出精彩的照片。iOS和Android平台都提供了大量不同的照片库。</p><p id="cc09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>没有什么不同，有几个包可以从相机中捕捉照片或从照片库中挑选照片。</p><p id="58c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将介绍如何使用图像拾取器包在Flutter应用程序中显示照片库中的照片。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3fdb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">入门指南</h1><p id="68d8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在添加任何额外的包来与照片库集成之前，我们需要构建一个基本的用户界面，允许用户预览来自相机或照片库的图片。</p><p id="e802" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的实现创建了一个基本的接口来满足我们的需求。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3ae8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e6fc7e8e31e2afcac457482f857c21de.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*fTiA5AQal6dGO-VkNFR-MQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">应用程序的用户界面</p></figure><p id="d435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经使用这个美丽的休斯顿市中心的图像作为我们的应用程序占位符图像。</p><p id="c015" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“拍照”按钮应该为用户提供从相机中拍照或从照片库中选择照片的选项。按钮<code class="fe nc nd ne nf b">onTap</code>的实现代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0f25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nc nd ne nf b">_showOptions</code>方法显示一个底部模态表，由两个选项组成。他们可以从相机中拍照，也可以从照片库中选择一张照片。这显示在下面的动画中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/aaa34eeb79afb7ffcbc50230045c7afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*UKbM-SfwRB035CrE3UT6gg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">底部模板</p></figure><p id="ff79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这太棒了！在下一节中，我们将安装所需的包，并开始从照片库中选择照片。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="36c2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从照片图库中选择照片</h1><p id="3017" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Flutter中的<a class="ae ky" href="https://pub.dev/packages/image_picker" rel="noopener ugc nofollow" target="_blank">图像拾取器</a>包允许用户从照片库中拾取图像。图像拾取器也允许用户使用相机捕捉照片，但为此，我们将使用不同的包。</p><p id="20a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先安装图像拾取器包，将其添加到<code class="fe nc nd ne nf b">pubspec.yaml </code>文件中，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="93f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，您必须配置iOS平台所需的权限。打开位于<em class="nh"> iOS &gt; Runner </em>文件夹中的<code class="fe nc nd ne nf b">info.plist</code>文件，添加以下键值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="58dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当用户从底部表单小部件中选择<em class="nh">从照片库中选择</em>选项时，图像拾取器将会出现。<code class="fe nc nd ne nf b"> _showPhotoLibrary</code>方法实现如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="1bd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！当您运行应用程序并点击<em class="nh">从照片库选择</em>选项时，它将触发<code class="fe nc nd ne nf b">_showPhotoLibrary</code>方法，该方法将启动照片库。如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a5a97b3a6bcb922323e05720f50f0575.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*QpUUd7NDwJJkDe04t4OZ7g.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">展示照片库</p></figure><p id="f4cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来棒极了！</p><p id="4154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们仍然需要替换占位符图像，并在其位置显示所选图像。</p><p id="261b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像拾取器允许我们访问与图像相关的<code class="fe nc nd ne nf b">File</code>对象。<code class="fe nc nd ne nf b">File</code>对象有一个包含图像路径的path属性。上面图像的路径如下所示:</p><pre class="kj kk kl km gt ni nf nj nk aw nl bi"><span id="346d" class="nm md it nf b gy nn no l np nq">/Users/azamsharp/Library/Developer/CoreSimulator/Devices/5091AD3A-FCFF-4C0D-B3E2–984BE1CC757C/data/Containers/Data/Application/922A8DFF-D441–48A4-A0C7-BABCCC37E502/tmp/image_picker_061D8B5D-4BF8–4B11-B739–85410C14C4E0–12357–0000E8DRAFA1C474.jpg</span></pre><p id="e867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了持久化路径，我们需要将它保存在状态中。这需要将我们的小部件从无状态改为有状态，并公开一个<code class="fe nc nd ne nf b">_path</code>属性，如下面的实现所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="fa8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当<code class="fe nc nd ne nf b">ImagePicker</code>返回新路径时，它被分配给<code class="fe nc nd ne nf b">setState</code>闭包内的<code class="fe nc nd ne nf b">_path</code>属性。这触发了构建方法，我们可以在其中更新<code class="fe nc nd ne nf b">Image</code>小部件，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="6519" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1cd37caf83916108dd5fe999ecbc8338.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*C-PaJawMDusvRjtBTWjiaA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从照片图库中选择照片</p></figure><p id="0e68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你们中的一些人可能已经注意到，一旦照片被选中，底部的表单不会关闭。下面的实现解决了这个问题，并使用导航器弹出底部的工作表视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="70f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！这是由两部分组成的系列文章的第一部分。在下一篇文章中，你将学习如何集成手机摄像头并在视图中显示拍摄的照片。</p><ul class=""><li id="aa15" class="nr ns it lb b lc ld lf lg li nt lm nu lq nv lu nw nx ny nz bi translated"><a class="ae ky" href="https://github.com/azamsharp/AzamSharp-Weekly/blob/master/photo_app.zip" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li></ul><p id="39b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢谢，祝编码愉快！</p></div></div>    
</body>
</html>