<html>
<head>
<title>The End of Unix Time: What Will Happen?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Unix时代的终结:会发生什么？</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-end-of-unix-time-what-will-happen-1b1a25ec1c20?source=collection_archive---------0-----------------------#2022-02-14">https://betterprogramming.pub/the-end-of-unix-time-what-will-happen-1b1a25ec1c20?source=collection_archive---------0-----------------------#2022-02-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="b248" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">日期回滚将如何影响计算机系统？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/04d2eacc282bcfd0994e77d36a22fc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m4zi0JNeP-PqOYUu"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae le" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aron视觉</a>拍摄的照片</p></figure><p id="0da0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">自从有时间以来，人们就觉得有必要记录时间。从简单的刻在岩石上的刻痕到像巨石阵这样的天文钟，我们一直在尝试新的更精确的方法来表现时间的流动。快进几千年，我们就在这里，在我们的每个电子设备中携带着高精度的时钟。</p><p id="18c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你只是有点好奇，你可能想知道你的电脑或手机如何处理时间的流动，并以人类可读的格式来表达它。</p><h1 id="ed6e" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是Unix时间？</h1><p id="9e2f" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">为了理解计算领域中的时间系统，我们必须首先谈论纪元。在年代学中，一个纪元是时间上的一个瞬间，被选择作为一个特定的日历纪元的起点，从这个起点开始计算时间。例如，大多数国家都采用耶稣基督的诞生作为他们日历的起始年。</p><p id="5add" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">回到计算领域，类Unix系统同意将它们的纪元定在1970年1月1日，即世界协调时0:00:00。这个日期被任意选择作为计算时间的参考时刻。其他系统，如微软的Windows，从1601年1月1日开始计时，因为这是设计Windows NT时<a class="ae le" href="https://en.wikipedia.org/wiki/Gregorian_calendar" rel="noopener ugc nofollow" target="_blank">公历</a>周期的第一年(<a class="ae le" href="https://devblogs.microsoft.com/oldnewthing/20090306-00/?p=18913" rel="noopener ugc nofollow" target="_blank">微软博客</a>)。</p><p id="6020" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Unix时间标准测量自其出现以来经过的秒数，尽管许多现代实现提供了更高的精度，高达几纳秒。</p><h2 id="5eec" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">代表时间</h2><p id="5289" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">在计算机系统中，时间通常被表示为一个整数或浮点数字，它随着计算机的<a class="ae le" href="https://en.wikipedia.org/wiki/Real-time_clock" rel="noopener ugc nofollow" target="_blank">实时时钟</a> (RTC)的每一次滴答而不断增加，RTC是一种测量时间流逝的电子设备。</p><p id="880b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，时间如何存储在存储器中取决于具体的系统实现。大多数32位类Unix系统以32位(4字节)有符号整数存储时间，因此能够表示136年的范围，从1901年到2038年。其他32位实现使用无符号整数，可以表示2106年之前的年份，但不能处理纪元之前的日期。</p><p id="99de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现代个人使用设备运行64位操作系统，该操作系统使用64位有符号值来跟踪时间，并能够表示从现在起大约2920亿年后的日期，顺便说一下，这比宇宙的估计年龄大得多。</p><h2 id="cf76" class="mi lg it bd lh mj mk dn ll ml mm dp lp kb mn mo lt kf mp mq lx kj mr ms mb mt bi translated">时间的尽头</h2><p id="7be4" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">时钟迟早会达到系统所能表示的最高时间值。最迫在眉睫的溢出日期是32位有符号整数基系统，计划于2038年1月19日03:14:07 UTC。一秒钟后，计算机将回落到1901年12月13日，世界协调时20:45:52。</p><p id="2ffc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种行为是由于在添加下一秒时发生的<a class="ae le" href="https://en.wikipedia.org/wiki/Integer_overflow" rel="noopener ugc nofollow" target="_blank">整数溢出</a>。当算术运算产生的数值超出可以用给定位数表示的范围时，就会发生整数溢出，在32位有符号日期的情况下是-2到2。</p><p id="b2d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">日期回滚到1901年的原因是有符号整数使用它们的<a class="ae le" href="https://en.wikipedia.org/wiki/Bit_numbering" rel="noopener ugc nofollow" target="_blank">最高有效位</a>来判断它们是正(0)还是负(1)。下面你可以看到一个很好的关于溢出如何影响日期的直观解释。记住，最左边的位代表二进制数的符号。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5848a9669629fbfe9f82cbc4f51eb970.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*k2-G9NVw7p1HhIfSdruZtg.gif"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">有符号整数溢出导致日期回滚(来自<a class="ae le" href="https://upload.wikimedia.org/wikipedia/commons/e/e9/Year_2038_problem.gif" rel="noopener ugc nofollow" target="_blank">维基百科</a>)</p></figure><p id="f06d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不幸的是，这个整数溢出不仅会影响屏幕上显示的日期，还会导致许多意想不到的行为。现在让我们探索几个场景。</p><p id="d96e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先想到的问题是无法正确测量时间。例如，让我们测量在时间回滚时执行某个操作需要多长时间:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="e80b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出是:</p><pre class="kp kq kr ks gt mx my mz na aw nb bi"><span id="6857" class="mi lg it my b gy nc nd l ne nf">It took -4294967290 seconds to complete the task.<br/>In human-readable terms: -49711 days, 17:31:50</span></pre><p id="9b21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然这个函数只花了6秒钟执行，但我们得到了一个明显错误的测量值-49，711天。如您所见，这个bug会给许多应用程序带来很多问题。</p><p id="88c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">休眠负时间增量会使您的程序无限期等待，从而导致永无休止的拒绝服务，您可以通过运行以下简单的C代码片段看到这一点:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="ee46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，负时间戳可能会欺骗版本控制系统，认为回滚后创建的某个文件或资源比2038年之前创建的任何文件或资源都旧。这可能会导致各种错误，包括无法更新数据存储和各种奇怪的同步问题。</p><h1 id="7227" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="68c5" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">尽管出现了这些灾难性的情况，所有关键系统都将被64位体系结构所取代，或者采用一种变通方法来缓解可能无法取代的旧系统的问题。</p><p id="7ac7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">32位无人维护软件呢？不幸的是，回滚后它可能不再可用，或者您可以将系统日期设置回1970年，然后就到此为止。无论如何，你不应该在有任何重要性的系统中使用未经维护的软件。</p><p id="28c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，一些具体的问题可能会出现在利用时间的嵌入式32位系统中，例如家用电器或旧汽车中的计算机。这些设备可能会停止工作，你对此无能为力。</p><p id="3f90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我希望你喜欢这篇文章。</p><p id="3a3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读！</p></div></div>    
</body>
</html>