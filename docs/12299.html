<html>
<head>
<title>5 Linux Commands You Should Memorize If You Manage Servers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如果你管理服务器，你应该记住5个Linux命令</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/linux-commands-you-should-memorize-if-you-manage-servers-1b7d371237ac?source=collection_archive---------1-----------------------#2022-05-26">https://betterprogramming.pub/linux-commands-you-should-memorize-if-you-manage-servers-1b7d371237ac?source=collection_archive---------1-----------------------#2022-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1a52" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">跟踪系统日志中的错误，获取设备的UUID，等等</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bc49a45762e9ec952d4acbb816c50c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oM6j2s8NGUte-k2p1sBcUg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@burst?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">爆裂</a>上<a class="ae ky" href="https://unsplash.com/s/photos/typing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">未飞溅</a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="a331" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在当今点击式云服务器的环境中，没有什么可以替代老式的命令行方式。你可以访问GUI只能梦想的机器部件，更快地完成编程任务，最重要的是:<em class="mc">解决问题</em>。</p><p id="52ab" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当火警响起时，知道一些常用的导航和调试命令可以节省宝贵的时间。</p><p id="c541" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在本文中，我们将探究其中的一些命令，并解释它们对于Linux服务器上的日常命令行工作是如何重要的。</p><h1 id="8d8c" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">查找正在使用/打开的端口</h1><p id="510e" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">创建一个新的服务，却发现可怕的“<em class="mc">地址正在使用</em>”消息，这让人抓狂。尤其是你不知道谁在用的时候。幸运的是，有几种方法可以查看Linux系统上当前正在使用的端口。最流行的工具之一是<code class="fe na nb nc nd b">netstat</code>。</p><p id="4cc1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了按进程查看所有打开的端口，您可以发出以下命令:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="0ccd" class="ni me it nd b gy nj nk l nl nm">sudo netstat -nltp</span></pre><p id="72b1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这将显示所有打开的端口，它们的详细信息，如协议和状态以及调用它们的程序。使用这个你应该可以追踪到谁占用了你迫切需要的那个端口。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/7cbe05011ed378ca6d872aa39e135d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBDiDFHclonsU-bgM5Gb6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">覆盆子Pi上的Netstat输出。</p></figure><p id="c207" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果您想显示程序名和PID，记得使用<code class="fe na nb nc nd b">sudo</code>来运行。</p><h1 id="e023" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">转发您的SSH代理</h1><p id="381a" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">如果您在管理服务器时频繁地从一台主机跳到另一台主机，确保您转发了您的密钥会非常有帮助。使用SSH转发可以很容易地实现这一点，并且您可以在使用自己的公钥保持访问的同时四处跳跃。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/915844d7d88a913df55f4451c83b8c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*vf1GL75W3f2LAjcQmOfiiw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">服务器之间的连接。</p></figure><p id="81fc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">假设您想连接到<code class="fe na nb nc nd b">server A</code>，然后立即从那里SSH到<code class="fe na nb nc nd b">server B</code>。如果您没有转发您的SSH代理(包含您的SSH密钥),那么您将会止步不前。</p><p id="8e0b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了将您的代理转发到您的下一个主机，您必须通过<code class="fe na nb nc nd b">-A</code>标志。完整的命令可能如下所示:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="3307" class="ni me it nd b gy nj nk l nl nm">ssh -A serverA</span></pre><p id="abcd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><code class="fe na nb nc nd b">-A</code>标志获取本地正在运行的任何东西<code class="fe na nb nc nd b">ssh-agent</code>,并将附属于它的密钥转发给你的目标主机。您还可以使用主机条目中的<code class="fe na nb nc nd b">ForwardAgent yes</code>指令将它添加到您的SSH配置文件中。</p><p id="7c27" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果您的SSH代理没有运行，您需要启动它并添加所需的密钥:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="b030" class="ni me it nd b gy nj nk l nl nm">eval $(ssh-agent)<br/>ssh-add</span></pre><p id="6211" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，当你需要在几个服务器之间跳跃时，你可以确定你的密钥会跟着你。</p><h1 id="2cee" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">错误的尾部系统日志</h1><p id="da31" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">你如何知道服务器内部发生了什么？您首先在哪里寻找错误消息？是否有一个包罗万象的记录设施？</p><p id="fed6" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">Syslog通常是最好的地方。这个实用程序已经存在了30多年，并继续被许多应用程序定期用于消息传递和日志记录。</p><p id="686d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">默认情况下，大多数运行在Linux上的程序都会登录到<code class="fe na nb nc nd b">syslog</code>。即使某个程序不支持，您也很有可能可以轻松地将其配置为支持。您可以像查看任何其他日志文件一样查看<code class="fe na nb nc nd b">syslog</code>:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="567a" class="ni me it nd b gy nj nk l nl nm"># Debian<br/>less /var/log/syslog</span><span id="b343" class="ni me it nd b gy np nk l nl nm"># RHEL/CentOS<br/>less /var/log/messages</span></pre><p id="60f8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">或者你也可以<code class="fe na nb nc nd b">tail</code>这个文件，跟着它去关注新邮件:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="7e50" class="ni me it nd b gy nj nk l nl nm"># Debian<br/>tail -f /var/log/syslog</span><span id="6f66" class="ni me it nd b gy np nk l nl nm"># RHEL/CentOS<br/>tail -f /var/log/messages</span></pre><p id="ea94" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">每条<code class="fe na nb nc nd b">syslog</code>消息都包含丰富的信息，并提供了一种简单的方法来快速排除服务故障。</p><p id="781c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">你也可以很容易地把它传送到<code class="fe na nb nc nd b">grep</code>，过滤出你想要的设备或程序名。只需在命令末尾添加<code class="fe na nb nc nd b">| grep &lt;name&gt;</code>。</p><p id="a829" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下一次出现错误时，这里应该是第一个查看的地方。</p><h1 id="b1bd" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">查找服务器的当前公共IP</h1><p id="d7b7" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">如果你使用的是带有GUI的桌面发行版，你可以很容易地打开浏览器，算出你的公共IP。有很多像whatismyipaddress.com这样的网站可以向你展示你的公共IP地址。但是，如果您在一个无头服务器上，并且您只能访问CLI，会发生什么呢？</p><p id="c95c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当然，你可以打开AWS或GCP控制台搜索它。您也可以打开一个像VMware这样的内部解决方案，甚至是一个电子表格来找到它，但是这些解决方案需要时间。当遇到麻烦时，您最不想做的事情就是寻找一个实例ID，并将其与一个巨大的其他ID列表进行匹配。</p><p id="df0e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果你想快速找到你连接的机器的公共IP，你可以卷曲公共网页使用的相同端点。有许多免费的纯文本公共API可供使用。我个人最喜欢的是:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="5f6c" class="ni me it nd b gy nj nk l nl nm">curl whatismyip.akamai.com</span></pre><p id="4733" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这将向您显示一行包含您的反射公共IP地址。这是一个快速、简单的命令，可以快速提供您需要的信息(无需离开CLI)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9ecf5441afe2b375616f803104c9c035.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/1*BkW3jBAIwuCNpZXUAX6QeQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为你的公共IP冰壶。</p></figure><p id="b125" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">还有一个<a class="ae ky" href="http://whatismyip.akamai.com/advanced" rel="noopener ugc nofollow" target="_blank">高级端点</a>提供关于你的IP的更多细节，比如位置和网络。</p><p id="219b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">另一个额外的好处是，由于它是纯文本，您可以在脚本或其他需要IP信息的编程服务中轻松使用它。不过要记住的一点是，这些公共端点对您可以发出的请求数量有限制。试图将它添加到数千个服务器上的cron作业中是不明智的。</p><h1 id="d0bd" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">获取设备的UUID</h1><p id="178f" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">如果您在一个有很多附加磁盘或其他存储的服务器上工作，那么您可能会遇到一些使用临时设备名的陷阱。根据发行版本的不同，设备名称可能会有很大差异。在一台服务器上使用一个设备名称可能无法同等地转换到下一台服务器。这就是UUIDs发挥作用的地方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/c56fc291565fa9e43037c105eb858e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MzhgqREHQNyXkLOG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Arctype的UUID格式。<a class="ae ky" href="https://arctype.com/blog/postgres-uuid/" rel="noopener ugc nofollow" target="_blank">来源</a>。</p></figure><p id="54de" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果您想要装载磁盘或其他媒体，使用设备的UUID通常是个好主意。这可以防止任何混淆，并确保您想要安装的设备每次都能以正确的方式安装。</p><p id="743f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了找到块级设备的UUIDs，您可以使用以下命令:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="4c28" class="ni me it nd b gy nj nk l nl nm">sudo blkid</span></pre><p id="41fd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这将显示磁盘列表及其相关的UUID值。您可以使用这些值来挂载磁盘或将它们添加到<code class="fe na nb nc nd b">/etc/fstab</code>。现在，当你想参考一个设备时，你可以<em class="mc">确定</em>它是正确的。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="0792" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">感谢您的阅读！你有哪些保持系统正常运行的关键命令？</p><p id="f25a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">寻找更多文章？看看我下面的一些其他帖子:</p><ul class=""><li id="2ee3" class="ns nt it li b lj lk lm ln lp nu lt nv lx nw mb nx ny nz oa bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/become-a-better-apt-user-with-these-commands-ecd7b13fd502"> <em class="mc">使用这些命令</em> </a>成为更好的“apt”用户</li><li id="5d04" class="ns nt it li b lj ob lm oc lp od lt oe lx of mb nx ny nz oa bi translated"><a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/5-basic-terraform-commands-you-should-know-d613f539fb9b"> <em class="mc">你应该知道的5个基本地形命令</em> </a></li></ul></div></div>    
</body>
</html>