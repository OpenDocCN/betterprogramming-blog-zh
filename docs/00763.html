<html>
<head>
<title>A Gentle Introduction to SQL Basics in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中SQL基础知识的简明介绍</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/a-gentle-introduction-to-sql-basics-in-python-b137651ed1ff?source=collection_archive---------10-----------------------#2019-07-10">https://betterprogramming.pub/a-gentle-introduction-to-sql-basics-in-python-b137651ed1ff?source=collection_archive---------10-----------------------#2019-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1eb7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用结构化查询语言编写简单的查询</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e7c8c7b2a5e1260413be3b1f0c25efb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-NfgBteJ0tzuzx3WSSqW3Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@casparrubin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡斯帕·卡米尔·鲁宾</a>在<a class="ae ky" href="https://unsplash.com/search/photos/sql-database?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="a9dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想看代码，你可以在我的<a class="ae ky" href="https://github.com/rmacaraeg/SQL_lessons" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><p id="aa14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Metis学习数据科学时，我们需要学习的一项内容是结构化查询语言(SQL)。SQL对我来说是新的，所以我花了一些时间来掌握它并理解它是如何工作的。</p><p id="433b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想写一个包含所有SQL基础知识的博客，这样我就可以在继续学习数据科学时参考它。希望这也能帮到你。</p><p id="0fac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将回顾:</p><ol class=""><li id="47da" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">基本查询。</li><li id="bb25" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">筛选(where子句)。</li><li id="6d4d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">多重条件。</li><li id="16f2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">排序值。</li><li id="59e2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">独特的价值观。</li><li id="1551" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">聚合函数。</li><li id="ef74" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">分组依据。</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="52f8" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">数据</h1><p id="5154" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">对于这些例子，我将使用SQLite教程的<a class="ae ky" href="http://www.sqlitetutorial.net/sqlite-sample-database/" rel="noopener ugc nofollow" target="_blank"> Chinook示例数据库</a>。</p><p id="6fcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>和SQLite，我们可以创建一个类似于运行普通查询的环境，只使用SQL。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/c36c4f8b7da8ad78a66b7c166451de70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gb-XPoulp0aKbBlpKOU0fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">奇努克数据库的辉煌</p></figure><p id="14cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看Chinook数据库，每个表顶部的名称以深蓝色背景显示(媒体类型、播放列表、员工等。).</p><p id="bddb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每个表中，都有ArtistId、Name、Title、InvoiceDate等列。为了访问每个表中的信息，我们使用SQL。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="e3e3" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">基本查询</h1><p id="fa45" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们从简单的东西开始。要从表中获取所有的列和行(让我们使用tracks表),我们使用以下代码:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="51b3" class="nt mr it np b gy nu nv l nw nx">SELECT * <br/>FROM tracks;</span></pre><p id="ff69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回3503行9列数据。</p><p id="3646" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常情况下，我们不希望看到表中的所有数据都是这样，我们可能会使用它来快速检查几行，以确保没有任何异常情况发生:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0988" class="nt mr it np b gy nu nv l nw nx">SELECT * <br/>FROM tracks <br/>LIMIT 10;</span></pre><p id="79a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个查询与上面的查询做的一样，但是这次它将结果限制在前10行/结果。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="5273" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">筛选(Where子句)</h1><p id="3158" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们可以使用过滤来更深入地研究我们的查询。</p><p id="8cd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用相同的曲目表，假设我们想知道列表中的第222首歌曲是什么。</p><p id="1e63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将利用<code class="fe ny nz oa np b">WHERE</code>子句:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="9323" class="nt mr it np b gy nu nv l nw nx">SELECT name, composer<br/>FROM tracks<br/>WHERE trackid = 222;</span></pre><p id="e62a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将输出福斯托·尼罗—阿曼迪尼奥创作的<em class="ob">维达·博亚</em>。</p><p id="9741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更进一步，我们可以在<code class="fe ny nz oa np b">WHERE</code>子句中使用许多操作符来查找与我们想要的相匹配的数据行:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c009" class="nt mr it np b gy nu nv l nw nx">SELECT * <br/>FROM tracks<br/>WHERE milliseconds&gt;300000 <br/>  AND bytes&lt;5000000;</span></pre><p id="e184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将输出两个过滤器都符合的三首歌曲。使用<code class="fe ny nz oa np b">WHERE</code>子句，我们可以找到与我们的分析实际需要相匹配的特定数据。</p><p id="a420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa np b">AND</code> / <code class="fe ny nz oa np b">OR</code>是SQL查询中常用的。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="ec45" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">排序值</h1><p id="cc1e" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">如果添加带有列名的<code class="fe ny nz oa np b">ORDER BY</code>，它将从该列排序的表中以升序返回信息(默认为升序)。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="5fdf" class="nt mr it np b gy nu nv l nw nx">SELECT *<br/>FROM tracks<br/>ORDER BY name;</span></pre><p id="f8b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回曲目表中的所有行，按歌曲标题排序(以<em class="ob">“40”</em>开始，以<em class="ob">→ltimo Pau-De-Arara</em>结束)。</p><p id="20bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要更改它并按降序获取信息:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="30a2" class="nt mr it np b gy nu nv l nw nx">SELECT *<br/>FROM tracks<br/>ORDER BY name DESC;</span></pre><p id="22a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将以相反的顺序输出相同的列表。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d2ad" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">独特的价值观</h1><p id="8b28" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">有时，我们会使用有大量重复信息的数据库。为了补救这一点，我们利用了<code class="fe ny nz oa np b">DISTINCT</code>条款:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="86fe" class="nt mr it np b gy nu nv l nw nx">SELECT DISTINCT(composer)<br/>FROM tracks;</span></pre><p id="f148" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该查询删除作曲者列中的重复值，并仅返回作曲者。这将原来的3503行数据减少到853行。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="958b" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">用于聚合的SQL函数</h1><p id="1e02" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在SQL中，有五个重要的聚合函数:</p><ul class=""><li id="1c95" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu oc mb mc md bi translated"><code class="fe ny nz oa np b">COUNT()</code></li><li id="76e4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu oc mb mc md bi translated"><code class="fe ny nz oa np b">SUM()</code></li><li id="25b6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu oc mb mc md bi translated"><code class="fe ny nz oa np b">AVG()</code></li><li id="db7e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu oc mb mc md bi translated"><code class="fe ny nz oa np b">MIN()</code></li><li id="fcb1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu oc mb mc md bi translated"><code class="fe ny nz oa np b">MAX()</code></li></ul><p id="ba31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这些函数，我们可以开始进一步处理数据，以获得有洞察力的结果。</p><p id="ca59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些查询示例:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="2c16" class="nt mr it np b gy nu nv l nw nx">SELECT COUNT(*)<br/>FROM tracks<br/>WHERE name LIKE 'a%';</span></pre><p id="c675" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将进入tracks表，查找并统计所有以字母a开头的歌曲名称。该代码输出以字母a开头的199首歌曲。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0221" class="nt mr it np b gy nu nv l nw nx">SELECT MAX(unitprice)<br/>FROM invoice_items;</span></pre><p id="15f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回1.99，即invoice_items表中任何商品的最高价格。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="d68f" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">分组依据</h1><p id="0fc3" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated"><code class="fe ny nz oa np b">GROUP BY</code>子句通常与聚合函数结合使用。它根据给定的列值对行进行分组，然后计算每个组的聚合。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e65d" class="nt mr it np b gy nu nv l nw nx">SELECT composer, SUM(milliseconds)<br/>FROM tracks<br/>GROUP BY composer;</span></pre><p id="73e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回表中每个作曲者的总时间(以毫秒为单位)。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="2e36" class="nt mr it np b gy nu nv l nw nx">SELECT composer, COUNT(trackid)<br/>FROM tracks<br/>GROUP BY composer;</span></pre><p id="a7bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该查询计算每个作曲者的曲目id数。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a84e" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结论</h1><p id="0466" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">希望这能帮助您开始使用简单的SQL查询。</p><p id="ebcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将很快发表另一篇文章，介绍SQL的更多特性，如<code class="fe ny nz oa np b">JOIN</code>和子查询，敬请关注！</p></div></div>    
</body>
</html>