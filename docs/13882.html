<html>
<head>
<title>Forty-Seven Best Practice Refactoring Techniques for Better Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为了更好的Python代码，47种最佳实践重构技术</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/forty-seven-best-practice-refactoring-techniques-for-better-python-code-6e5d6e091f9a?source=collection_archive---------1-----------------------#2022-10-08">https://betterprogramming.pub/forty-seven-best-practice-refactoring-techniques-for-better-python-code-6e5d6e091f9a?source=collection_archive---------1-----------------------#2022-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f747" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python最佳实践重构</h2><div class=""/><div class=""><h2 id="ddcf" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从我的同事那里收集的用于Python文档、编码、测试、验证和持续集成的技术和代码片段</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/be4e195df3a89b8d7a90077d8340d947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKxAvVSGc0W5Sy47B_sVQA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python编程。图片来源:截图和Python logo</p></figure><p id="7ce1" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我从同事那里收集了这四十种重构技术，多年来，我和他们一起学习了很多高级软件工程。三十多年来，编程之旅一直在多个项目中使用多种语言。</p><p id="283b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">应用每种技术之前和之后都有Python代码示例。</p><p id="6f26" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些技术分为五类:</p><ul class=""><li id="9caa" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">文档技术</li><li id="38f0" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">编码技术</li><li id="f1c2" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">测试技术</li><li id="2303" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">验证技术</li><li id="ae8d" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">持续集成(CI)技术</li></ul><p id="ceac" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">但是首先，我将介绍我们将用于应用这些技术的项目或代码库。</p><blockquote class="mr ms mt"><p id="3f4e" class="lh li mu lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated"><strong class="lj jd">注意</strong> : PyCharm是本博客使用的IDE。这里显示的所有技术也可以用MS Visual Basic IDE来完成。</p></blockquote><h1 id="4c8f" class="my mz it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">PHOTONAI是什么？</h1><p id="a828" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PHOTONAI <strong class="lj jd"> </strong>将sci-kit-learn <strong class="lj jd"> </strong>和<strong class="lj jd"> </strong>其他机器学习(ML)或深度学习(DL)框架整合到一个统一的范例中。PHOTONAI采用sci-kit-learn <code class="fe nv nw nx ny b">Transformer</code>类方法架构。</p><p id="f9ca" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">几位软件工程师对PHOTONAI进行了重构，以进行机器学习(ML)的快速实验，因为时间限制，我们使用了大型数据集的样本。</p><p id="5428" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我使用PHOTONAI，而不是作为一个ML框架的好(或坏)例子。而是展示代码重构。</p><p id="bd33" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我给出了Python之前和之后的代码示例，展示了PHOTONAI使用该技术的转变。</p><h2 id="8bd9" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">文档技术</h2><h2 id="3a8a" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术# 1–3</strong></h2><p id="d7da" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">创建新版本，并记录主要更改。</p><ul class=""><li id="a604" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated">如果有大量的架构变更、大量的代码变更和/或大量的新行为添加，创建一个新版本，a+1.0.0。</li><li id="4924" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">创建一个新的subversion，a.b+1.0，如果有微小的架构变化，微小的代码变化，和/或微小的新行为增加。</li><li id="2c15" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated">如果添加少量代码和/或有错误修复，创建一个新的subversion，a.b.c+1。</li></ul><h2 id="e05e" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧4</h2><p id="b410" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">我使用<a class="ae ok" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> PyCharm </a>到【PHOTONAI 1.1.0项目的所有变更和新文件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/e2a84f92bf98ec4fe99ff08c7140870b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1P9-2nBbDznefYGO-4EC9w.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm git为project PHOTONAI 1.1.0中所有更改的文件添加了。瑞秋·科特曼的动画。</p></figure><blockquote class="mr ms mt"><p id="9f3b" class="lh li mu lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated"><strong class="lj jd">注意</strong>:你可以用和项目一样的方式<code class="fe nv nw nx ny b">git add</code>一个单独的文件。左键单击文件名，而不是项目目录名。</p></blockquote><p id="203a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里显示的变化导致了一个新的subversion，从1.0.0到1 . 1 . 0 *。</p><h2 id="2dee" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧5</h2><p id="82a2" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">我使用Git进行版本控制和协作。代码如下:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="649b" class="nz mz it ny b gy oq or l os ot">git checkout -b 1.1.0<br/>git status</span></pre><p id="fc9c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">终端输出:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="a53e" class="nz mz it ny b gy oq or l os ot">On branch 1.1.0</span><span id="7fad" class="nz mz it ny b gy ou or l os ot">Changes to be committed:</span><span id="0413" class="nz mz it ny b gy ou or l os ot">(use "git reset HEAD &lt;file&gt;..." to unstage)<br/>modified:   photonai/base/registry/element_dictionary.py<br/>modified:   photonai/base/registry/registry.py<br/>new file:   photonai/custom_elements/CustomElements.json<br/>new file:   photonai/driver.py<br/>modified:   photonai/processing/metrics.py<br/>modified:   photonai/tests/processing_tests/metrics_test.py<br/>new file:   photonai/tests_ext/CustomElements/CustomElements.json<br/>new file:   photonai/tests_ext/base/test_hyperpipe.py<br/>new file:   photonai/tests_ext/base/test_register.py<br/>new file:   photonai/tests_ext/processing/test_metrics.py<br/>new file:   photonai/util.py</span></pre><blockquote class="mr ms mt"><p id="b79c" class="lh li mu lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated"><strong class="lj jd">注:</strong>以上是PHOTONAI 1.1.0项目更改或添加的所有文件列表。</p></blockquote><h2 id="7034" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧6</h2><p id="8b9a" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">在本地记录任何重要的代码添加或更改</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="f1b0" class="nz mz it ny b gy oq or l os ot">class Scorer(object):<br/>    <em class="mu">"""<br/>    Transforms a string literal into a callable instance of a<br/>    particular metric<br/>    BHC 1.1.0 - support cluster scoring by add clustering <br/>    scores and type<br/>            - added METRIC_METADATA dictionary<br/>            - added ML_TYPES = ["Classification", "Regression",<br/>                                "Clustering"]<br/>            - added METRIC_&lt;&gt;ID Postion index of metric <br/>              metadata list<br/>            - added SCORE_TYPES<br/>            - added SCORE_SIGN<br/>    """</em></span></pre><h2 id="ac49" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧7</h2><p id="50e6" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">为常量、变量、函数和类方法创建长的描述性名称</p><h2 id="bf9c" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧8</h2><p id="44fb" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">将行为上不恰当的评论转化为行为上正确的评论，以降低维护成本和bug的生成</p><h2 id="e6b9" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧9</h2><p id="0a48" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">添加注释以增加代码的可读性。</p><p id="82e5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">评论是有维护成本的，不恰当的评论维护成本更高。</p><p id="88f0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">注释是代码的一部分。他们有与任何行为改变相关的维护成本。</p><p id="8778" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面是修改前的评论:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="c4d6" class="nz mz it ny b gy oq or l os ot">@staticmethod<br/>def <strong class="ny jd">get_json(photon_package):</strong><em class="mu"><br/>"""<br/>Load JSON file in which the elements for the PHOTON submodule are stored.</em></span><span id="b328" class="nz mz it ny b gy ou or l os ot"><em class="mu">The JSON files are stored in the framework folder by the name convention 'photon_package.json'</em></span><span id="96ea" class="nz mz it ny b gy ou or l os ot"><em class="mu">Parameters:<br/>-----------<br/>* 'photon_package' [str]:<br/>  The name of the photonai submodule</em></span><span id="2963" class="nz mz it ny b gy ou or l os ot"><em class="mu">Returns:<br/>--------<br/>JSON file as dict, file path as str<br/>"""</em></span></pre><p id="8b5a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">更改后的注释:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="2e90" class="nz mz it ny b gy oq or l os ot">@staticmethod<br/>def <strong class="ny jd">load_json(photon_package: str) -&gt; Any</strong>:<br/>    <em class="mu">"""<br/>    load_json Loads JSON file.</em></span><span id="bbcf" class="nz mz it ny b gy ou or l os ot"><em class="mu">The class init PipelineElement('name',...)<br/>    stores the element metadata in a json file.</em></span><span id="a654" class="nz mz it ny b gy ou or l os ot"><em class="mu">The JSON files are stored in the framework folder<br/>    by the name convention 'photon_&lt;package&gt;.json'.<br/>    (example:$HOME/PROJECTS/photon/photonai/base/registry/PhotonCore.json)</em></span><span id="10e3" class="nz mz it ny b gy ou or l os ot"><em class="mu">The file is of format<br/>    { name-1: ['import-pkg-class-path-1', class-path-1)],<br/>      name-2: ['import-pkg-class-path-2', class-path-2)],<br/>     ....}</em></span><span id="8a20" class="nz mz it ny b gy ou or l os ot"><em class="mu">Parameters<br/>    ----------<br/>        photon_package:  The name of the photonai package of element metadata<br/>    Returns<br/>    -------<br/>        [file_content, file_name]<br/>    Notes<br/>    -------<br/>    if  JSON file does not exist, then create blank one.<br/>"""</em></span></pre><h2 id="08f7" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧10</h2><p id="d767" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">选择一个<a class="ae ok" href="https://www.datacamp.com/community/tutorials/docstrings-python" rel="noopener ugc nofollow" target="_blank"> docstring样式，并在整个项目(包、库等)中一致地使用它。我们使用NumPy风格，因为它适合于类、方法、函数和参数的详细文档。</a></p><h2 id="0b27" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧11</h2><p id="1cb2" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm docstring格式是从顶部功能区序列py charm | Preferences | Tools | Python集成工具中设置的，如下图GIF所示。我在苹果电脑上。在Windows或Linux上是不同的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/ab33c452a4665c1f086ca977145cae2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*W6BAcegGIUALl0J-u5BLgg.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm为PHOTONAI 1.1.0项目设置了docstring样式。瑞秋·科特曼的动画。</p></figure><p id="c645" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用NumPy <strong class="lj jd"> </strong>样式<strong class="lj jd"> </strong>并纠正任何缺口，注释变成:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="0222" class="nz mz it ny b gy oq or l os ot">@staticmethod<br/>def get_json(photon_package: str) -&gt; Any:<br/>    <em class="mu">"""<br/>    get_json Loads JSON file.</em></span><span id="73fa" class="nz mz it ny b gy ou or l os ot"><em class="mu">The class init PipelineElement('name',...)<br/>    stores the element metadata in a json file.</em></span><span id="bda5" class="nz mz it ny b gy ou or l os ot"><em class="mu">The JSON files are stored in the framework folder<br/>    by the name convention 'photon_&lt;package&gt;.json'.<br/>    (example:$HOME/PROJECTS/photon/photonai/base/registry/PhotonCore.json)</em></span><span id="bded" class="nz mz it ny b gy ou or l os ot"><em class="mu">The file is of format<br/>    { name-1: ['import-pkg-class-path-1', class-path-1)],<br/>      name-2: ['import-pkg-class-path-2', class-path-2)],<br/>     ....}</em></span><span id="1c5f" class="nz mz it ny b gy ou or l os ot"><em class="mu">Parameters<br/>    ----------<br/>    photon_package:  The name of the photonai package<br/>    of element metadata.</em></span><span id="8415" class="nz mz it ny b gy ou or l os ot"><em class="mu">Returns<br/>    -------<br/>    [file_content, file_name]</em></span><span id="41da" class="nz mz it ny b gy ou or l os ot"><em class="mu">Notes<br/>    -------<br/>    If  JSON file does not exist, then create a blank one.<br/>    """</em></span></pre><h2 id="592f" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧#12</h2><p id="0d5c" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">类型提示减少了函数或方法的文档。</p><h2 id="c55f" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧13</h2><p id="72b0" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm进入NumPy docstring模板。PyCharm只插入<code class="fe nv nw nx ny b">return</code>，因为函数没有参数。如果右键单击，它会列出所有允许的NumPy docstring关键字。酷！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/312d07806623da55837e9aa5ebcdc9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5bgsgADZvStZmvF9bc8c4A.gif"/></div></div></figure><h2 id="3ec0" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧#14</h2><p id="34a2" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">应用PEP-8命名约定</p><p id="5189" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下面的例子中，全局常量<code class="fe nv nw nx ny b">ELEMENT_TYPE</code>是大写的，变量<code class="fe nv nw nx ny b">machine_learning_type</code>是小写的。</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="c197" class="nz mz it ny b gy oq or l os ot">Globals:</span><span id="fc5d" class="nz mz it ny b gy ou or l os ot">ELEMENT_TYPE -&gt; ML_TYPE<br/>ELEMENT_DICTIONARY   -&gt;  METRIC_METADATA</span><span id="9414" class="nz mz it ny b gy ou or l os ot">variables:</span><span id="0434" class="nz mz it ny b gy ou or l os ot"><em class="mu">machine_learning_type -&gt; element_type</em></span></pre><h2 id="3f51" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧15</h2><p id="c2d9" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm可以运行外部工具进行格式化。我使用black，它将一个<code class="fe nv nw nx ny b">.py </code>文件或整个项目格式化为符合PEP-8的格式。结果是所有文件的格式都相同。接下来的结果是可读性分数增加了。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/251818e019c3672dda10754858400ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lYoThCZ3Ac50ua2gWDG86g.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm外部工具:黑色适用于所有。PHOTONAI 1.1.0项目的py文件。瑞秋·科特曼的动画。</p></figure><h2 id="1f95" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧16</h2><p id="f81a" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm可以更改包中任何地方使用的名称。我知道有些人可能认为重构这个词是有害的。但是，在整个项目中更改名称是有用的。请忽略PyCharm如何对其特性进行分类。从头开始使用<code class="fe nv nw nx ny b">rename</code>，这样你就不必重构你的代码了！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/eaad9734cb1ca8d2f4bcd4a268358f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mQKxiWco4DoaXJv5fDlsPw.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm git重命名特性。瑞秋·科特曼的动画。</p></figure><h2 id="dc9a" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧#17</h2><p id="9c5c" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm <code class="fe nv nw nx ny b">find usage</code>查找项目引用中的所有文件——例如常量、变量、函数、类或类方法。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/716b290afce6b08269498e721805b673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zeaTAaoAjAYWrPNeWv4rvA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm查找用法功能。瑞秋·科特曼的动画。</p></figure><h2 id="9e22" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧18</h2><p id="6998" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">向每个函数或类方法添加类型提示。</p><p id="f2b7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Python是一种动态类型语言。Python 3.5及更高版本允许启用类型提示(<a class="ae ok" href="https://www.python.org/dev/peps/pep-0484/" rel="noopener ugc nofollow" target="_blank"> PEP 484 </a>)。我想强调单词<em class="mu">提示</em>，因为类型提示不会影响Python解释器。就你而言，Python解释器会忽略类型提示。</p><p id="a79e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">类型提示(注意:不是强类型检查)使得在第一次通过编码和单元测试后完成bug搜索、发现安全漏洞和静态类型检查成为可能。</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="fc63" class="nz mz it ny b gy oq or l os ot">def is_machine_learning_type(ml_type: str) -&gt; bool:</span></pre><h2 id="017e" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧#19</h2><p id="44b9" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">docstring不再需要记录每个<code class="fe nv nw nx ny b">arg</code>和<code class="fe nv nw nx ny b">return</code>数据类型。签名变得不言自明。</p><h2 id="dfd3" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧20</h2><p id="d8fa" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">可读性以及后期代码检查工具的信息都增加了。</p><h2 id="e35e" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧21</h2><p id="8cc0" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">将不相关的评论转化为相关的评论</p><p id="0e1a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">版本1.0.0(原始版本)</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="7345" class="nz mz it ny b gy oq or l os ot"># register new <strong class="ny jd">object</strong><br/>PhotonRegister.<strong class="ny jd">save</strong>("ABC1", "namespace.filename.ABC1", "Transformer")</span></pre><p id="0bed" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">版本1.1.0</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="0439" class="nz mz it ny b gy oq or l os ot"><em class="mu"># register new </em><strong class="ny jd"><em class="mu">element</em></strong><em class="mu"><br/>PhotonRegister.</em><strong class="ny jd"><em class="mu">register</em></strong><em class="mu">("ABC1", "namespace.filename.ABC1", "Transformer")</em></span></pre><h2 id="e2b3" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧22</h2><p id="bf05" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">只保留建筑方面的<code class="fe nv nw nx ny b">#todo</code>评论</p><h2 id="36f3" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧23</h2><p id="1dab" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">PyCharm已经为PHOTONAI 1.1.0项目找到了所有的<code class="fe nv nw nx ny b">#Todo</code>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/8c8d8065d1ce319682fa9e8cd801d271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fG5dkhvq0b4ZfQmVc6IR9w.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyCharm找到了PHOTONAI 1.1.0项目的所有Todo。瑞秋·科特曼的动画。</p></figure><h2 id="e9c6" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧24</h2><p id="db15" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">删除被注释掉的旧代码。</p><p id="1c4f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">版本1.1.0(注释掉1.1.0代码之前):</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oz pa l"/></div></figure><p id="f424" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">版本1.1.0(删除注释掉的1.1.0代码后):</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="a7fd" class="nz mz it ny b gy oq or l os ot">def __post_init__(self):<br/>    if self.custom_elements_folder:<br/>        self._load_custom_folder(self.custom_elements_folder)</span></pre><blockquote class="mr ms mt"><p id="a6a8" class="lh li mu lj b lk ll kd lm ln lo kg lp mv lr ls lt mw lv lw lx mx lz ma mb mc im bi translated"><strong class="lj jd">注意</strong> <em class="it"> : </em>代码行(LOC)的复杂性通过消除被注释掉的旧代码而降低。可读性分数增加。</p></blockquote><h1 id="23a8" class="my mz it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">编码技术</h1><h2 id="fe90" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧25</h2><p id="bb87" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">不要多此一举</p><p id="20ff" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在你为你的想法或任务写一行代码之前，搜索其他人已经编码的解决方案。外面有很棒的仓库。发现你的最爱。</p><p id="fa7c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为了让你开始，这里有一些我最喜欢的:</p><ul class=""><li id="64f3" class="md me it lj b lk ll ln lo lq mf lu mg ly mh mc mi mj mk ml bi translated"><a class="ae ok" href="https://github.com/paperswithcode" rel="noopener ugc nofollow" target="_blank">编号为</a>的文件</li><li id="52b6" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated"><a class="ae ok" href="https://github.com/dictcp/awesome-git" rel="noopener ugc nofollow" target="_blank">牛逼的饭桶</a></li><li id="582d" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated"><a class="ae ok" href="https://github.com/sindresorhus/awesome" rel="noopener ugc nofollow" target="_blank">牛逼榜单</a></li><li id="288d" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated"><a class="ae ok" href="http://Awesome Awesomeness" rel="noopener ugc nofollow" target="_blank">牛逼牛逼(编程语言)</a></li><li id="2f2e" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated"><a class="ae ok" href="https://github.com/josephmisiti/awesome-machine-learning" rel="noopener ugc nofollow" target="_blank">牛逼的机器学习</a></li><li id="4f7a" class="md me it lj b lk mm ln mn lq mo lu mp ly mq mc mi mj mk ml bi translated"><a class="ae ok" href="https://paperswithcode.com/lib/mmdetection" rel="noopener ugc nofollow" target="_blank">视觉机器学习</a></li></ul><h2 id="9d6f" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧26</h2><p id="6050" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">借鉴别人的代码。</p><p id="82d3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">NumPy、<a class="ae ok" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>、Keras、fast.ai、TensorFlow、<a class="ae ok" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>、Kubernetes、Hadoop、PySpark以及其他数百个软件包教授先进的计算机科学和最好的编码技术。</p><p id="b6c5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">利用Python和其他语言的开源世界。</p><h2 id="cf81" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧#27</h2><p id="1eb3" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">日志；不要打印</p><h2 id="687f" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧28</h2><p id="d151" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">不要编码全局数据结构；使用参数文件</p><p id="65ac" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">日志和参数文件是您的实体或在线课程中很少涉及或根本不会教授的主题。</p><p id="1ec7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">你可以在硬碰硬的学校里学习日志和参数文件，或者，如果你幸运的话，通过观察一位高级软件工程师(或者通过使用技巧12和13)。</p><p id="da19" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我在下面的文章中详细介绍了日志和参数文件的优点:</p><div class="pb pc gp gr pd pe"><a href="https://medium.com/codex/pasos-offering-of-logging-and-parameter-services-for-your-python-project-c3ae2fd6869a" rel="noopener follow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd jd gy z fp pj fr fs pk fu fw jc bi translated">Python项目的日志记录和参数服务</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">日志和参数文件对于任何生产可维护服务的部署都是至关重要的。</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">medium.com</p></div></div><div class="pn l"><div class="po l pp pq pr pn ps lb pe"/></div></div></a></div><h2 id="a4e9" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧29</h2><p id="53ac" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">创建一个函数或方法来封装值检查</p><p id="dc11" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面的例子创建了一个方法来检查一个值是否在全局常量<em class="mu">中。</em></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oz pa l"/></div></figure><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="7cc4" class="nz mz it ny b gy oq or l os ot">@staticmethod<br/>def is_machine_learning_type(ml_type: str) -&gt; bool:<br/>    <em class="mu">"""<br/>    </em><strong class="ny jd"><em class="mu">:raises</em></strong><em class="mu"><br/>    if not known machine_learning_type</em></span><span id="7e8b" class="nz mz it ny b gy ou or l os ot"><strong class="ny jd"><em class="mu">    :param</em></strong><em class="mu"> machine_learning_type<br/>    </em><strong class="ny jd"><em class="mu">:return</em></strong><em class="mu">: True<br/>    """<br/>    </em>if ml_type in Scorer.ML_TYPES:<br/>        return True<br/>    else:<br/>        logger.error(<br/>            "Specify valid ml_type to choose best config:  {}".format(ml_type))<br/>        raise_PhotonaiError(            "Specify valid ml_type. invalid :{} of supported: [{}]".format(ml_type, Scorer.ML_TYPES))</span></pre><h2 id="20bc" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧30</h2><p id="96dd" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">创建包错误类型</p><p id="22e8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于包Photoai，我们创建了错误类型<code class="fe nv nw nx ny b">Photonai</code>。</p><h2 id="114b" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated">技巧31</h2><p id="30ad" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">创建一个具有包错误类型的提升函数</p><p id="7564" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于错误类型，我们创建了函数<code class="fe nv nw nx ny b">raise_PhotonaiError</code>。</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="9e35" class="nz mz it ny b gy oq or l os ot">import logging</span><span id="e4a6" class="nz mz it ny b gy ou or l os ot">class PhotoaiError(Exception):<br/>    pass</span><span id="31d3" class="nz mz it ny b gy ou or l os ot">def raise_PhotoaiError(msg):<br/>    logger.error(msg)<br/>    raise PhotoaiError(msg)</span></pre><p id="d6dd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">方法<code class="fe nv nw nx ny b">is_machine_learning_type</code>变成了:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="ca24" class="nz mz it ny b gy oq or l os ot">@staticmethod<br/>def is_machine_learning_type(ml_type: str) -&gt; bool:<br/>    <em class="mu">"""<br/>    Parameters:<br/>    -----------<br/>    machine_learning_type</em></span><span id="2391" class="nz mz it ny b gy ou or l os ot"><em class="mu">Returns</em><strong class="ny jd"><em class="mu"><br/>   </em></strong><em class="mu">-----------<br/></em><strong class="ny jd"><em class="mu">   </em></strong><em class="mu">True</em></span><span id="91bf" class="nz mz it ny b gy ou or l os ot"><em class="mu">Raises</em><strong class="ny jd"><em class="mu"><br/>   </em></strong><em class="mu">-----------<br/>   if not known machine_learning_type<br/>   """<br/>   </em>if ml_type in Scorer.ML_TYPES:<br/>        return True</span><span id="a2db" class="nz mz it ny b gy ou or l os ot">raise_PhotoaiError(<br/>        "Specify valid ml_type:{} of [{}]".format(ml_type,<br/>        Scorer.ML_TYPES))</span></pre><p id="cb45" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">注:</strong> <code class="fe nv nw nx ny b">raise_PhotoaiError</code>结合了日志和运行时错误。<em class="mu">不是</em> <code class="fe nv nw nx ny b">true<em class="mu"> </em></code>的情况下停止并显示堆栈。作为一个运行时错误，如果它传递一个未知的值，它的行为与预期的一样。请注意可读性和维护成本的提高。</p><h2 id="fc04" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#32 </strong></h2><p id="c650" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">使用<code class="fe nv nw nx ny b">faulthandler</code></p><p id="7892" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">从Python 3.3开始，一个名为<a class="ae ok" href="https://pypi.org/project/faulthandler/" rel="noopener ugc nofollow" target="_blank">错误处理程序</a>的库显示错误或Python segfault的调用堆栈回溯。</p><h2 id="5a7f" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#33 </strong></h2><p id="baf0" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">消除全局变量——或者至少尝试一下</p><p id="e48a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您使用<code class="fe nv nw nx ny b">globals()</code>列出您的包中的所有全局变量。</p><h2 id="0468" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#34 </strong></h2><p id="d8fb" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">消除所有未使用的局部变量</p><p id="30da" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">通常，您的IDE会为您识别所有悬挂变量。如果没有，你用<code class="fe nv nw nx ny b">locals()</code>，用搜索。</p><h2 id="06c0" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#35 </strong></h2><p id="418e" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">在类定义之前应用Python 3.7+ <code class="fe nv nw nx ny b">@dataclass</code>装饰器。</p><p id="09f6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe nv nw nx ny b">@dataclass</code>是<strong class="lj jd"> </strong> Python 3.7的新增特性。主要的驱动力是在一个<code class="fe nv nw nx ny b">def class</code>定义中消除与国家相关的样板文件。</p><p id="9362" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe nv nw nx ny b">@dataclass</code>修饰一个<code class="fe nv nw nx ny b">def class</code>定义，自动生成五个double dunder方法:<code class="fe nv nw nx ny b">__init__()</code>、<code class="fe nv nw nx ny b">__repr__()</code>、<code class="fe nv nw nx ny b">__str__</code>、<code class="fe nv nw nx ny b">__eq__()</code>和<code class="fe nv nw nx ny b">__hash__()</code>。</p><p id="4c37" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><code class="fe nv nw nx ny b">@dataclass</code>几乎消除了定义一个基本类所需的重复样板代码。注意，所有这五个double dunder方法都直接处理类的封装状态。</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="504d" class="nz mz it ny b gy oq or l os ot">class PhotonRegistry:<br/>    <em class="mu">"""<br/>    Helper class to manage the PHOTON Element Register<br/>    ...<br/>    """</em></span><span id="819c" class="nz mz it ny b gy ou or l os ot">base_PHOTON_REGISTRIES = ['PhotonCore', 'PhotonNeuro']<br/>PHOTON_REGISTRIES = ['PhotonCore', 'PhotonNeuro']</span><span id="9010" class="nz mz it ny b gy ou or l os ot">def __init__(self, custom_elements_folder: str = None):<br/>    if custom_elements_folder:<br/>        self._load_custom_folder(custom_elements_folder)<br/>    else:<br/>        self.custom_elements = None<br/>        self.custom_elements_folder = None<br/>        self.custom_elements_file = None</span></pre><p id="8d3c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<code class="fe nv nw nx ny b">@dataclass</code>装饰器之后:</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="6802" class="nz mz it ny b gy oq or l os ot">@dataclass<br/>class PhotonRegistry:<br/>    <em class="mu">"""<br/>    Helper class to manage the PHOTON Element Register<br/>    ...<br/>    """</em><br/>    custom_elements_folder: str = None<br/><em class="mu">    </em>custom_elements: str = None<br/>    custom_elements_file: str = None<br/>    base_PHOTON_REGISTRIES: ClassVar[List[str]] =/<br/>   ["PhotonCore", "PhotonNeuro"]<br/>    PHOTON_REGISTRIES: ClassVar[List[str]] =/<br/>   ["PhotonCore", "PhotonNeuro"]</span><span id="051c" class="nz mz it ny b gy ou or l os ot">def __post_init__(self):<br/>    if self.custom_elements_folder:<br/>        self._load_custom_folder(self.custom_elements_folder)</span></pre><p id="fad0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">关于<code class="fe nv nw nx ny b">dataclass:</code>使用的详细博客文章</p><div class="pb pc gp gr pd pe"><a href="https://towardsdatascience.com/12-examples-of-how-to-write-better-code-using-dataclass-d7c121ee0239" rel="noopener follow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd jd gy z fp pj fr fs pk fu fw jc bi translated">如何使用@dataclass编写更好的代码的12个示例</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">我们正在将使用scikit-learn、Keras和其他包的聚类算法添加到Photonai包中。有了十二个…</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">towardsdatascience.com</p></div></div><div class="pn l"><div class="pt l pp pq pr pn ps lb pe"/></div></div></a></div><p id="3169" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">注</strong>:通过将<code class="fe nv nw nx ny b">@dataclass </code>与<code class="fe nv nw nx ny b"> type hinting</code>配合使用，可读性大幅提高。</p><h1 id="b235" class="my mz it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">测试技术</h1><h2 id="bd48" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#36 </strong></h2><p id="711a" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">代码开发人员开发单元测试</p><h2 id="ce3d" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#37 </strong></h2><p id="5f4f" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">在PyCharm中设置工具<a class="ae ok" href="https://pytest-cov.readthedocs.io" rel="noopener ugc nofollow" target="_blank"> pytest </a>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/72366333a7c004240da56ad0638c04db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OIso8RkT3TN2Yp-ILNjALA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">在PyCharm中为项目PHOTONAI 1.1.0设置工具<a class="ae ok" href="https://pytest-cov.readthedocs.io" rel="noopener ugc nofollow" target="_blank"> pytest </a>。瑞秋·科特曼的动画。</p></figure><h2 id="0209" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#38 </strong></h2><p id="ac17" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">单元测试有80%以上的覆盖率。我们使用<a class="ae ok" href="https://coverage.readthedocs.io/en/coverage-5.0.4/" rel="noopener ugc nofollow" target="_blank">覆盖</a>。</p><h2 id="77ba" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技巧39号</strong></h2><p id="b010" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">集成测试必须100%覆盖所有外部(API)函数、类、类属性和类方法。</p><h2 id="183b" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#40 </strong></h2><p id="1f77" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">开发人员没有完成验收测试。</p><p id="a39a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如，我们从<code class="fe nv nw nx ny b">test_metrics.py</code>中的24个单元测试中选择了这些单元测试。</p><pre class="ks kt ku kv gt om ny on oo aw op bi"><span id="197b" class="nz mz it ny b gy oq or l os ot"># 22<br/>def test_is_machine_learning_type_bad():<br/>    with pytest.raises(PhotoaiError):<br/>        assert Scorer.is_machine_learning_type("fred")<em class="mu"> <br/></em># 23<br/>def test_is_machine_learning_type():<br/>    assert Scorer.is_machine_learning_type("Clustering")</span></pre><h2 id="9f2e" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#41 </strong></h2><p id="78a3" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">一旦选择了测试工具，PyCharm就会标记各个可运行的测试。这些在左栏中用实心箭头标记。使用pytest进行单独测试的示例:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/c36c2eb9c063b5d26d346e6354d3c61e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SpZAeSBAF9SdX8pZXVGPLA.gif"/></div></div></figure><p id="78d5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用PyCharm <strong class="lj jd">、</strong>，您可以使用pytest <strong class="lj jd">、</strong>运行一个测试文件或整个测试文件夹，结果会显示出来。<strong class="lj jd"> </strong>参考底板-色带(通过39/40测试— 32毫秒)。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/945e19ed53c2e7a186986bed7ef8197a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Sw7r1IVV8V7CFBorSAHCeA.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">为项目PHOTONAI 1.1.0指定的PyCharm测试工具。瑞秋·科特曼的动画。</p></figure><h2 id="735c" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#42 </strong></h2><p id="86cc" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">代码类型提示检查。</p><p id="5436" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">类型提示只是像Mypy这样的第三方工具可以用来指出潜在bug的提示。</p><h2 id="9311" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#43 </strong></h2><p id="bf1e" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">测试覆盖率</p><h2 id="c129" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#44 </strong></h2><p id="ed84" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">性能分析</p><h2 id="8f04" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#45 </strong></h2><p id="7547" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">检查安全性</p><h2 id="7171" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#46 </strong></h2><p id="e219" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">代码可靠性</p><p id="3f88" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面的文章详细介绍了可用于测试覆盖率、性能分析、检查输入数据安全性和代码可靠性的工具。</p><div class="pb pc gp gr pd pe"><a rel="noopener  ugc nofollow" target="_blank" href="/seventeen-coding-tools-for-your-python-developer-sandbox-35d033c3075a"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd jd gy z fp pj fr fs pk fu fw jc bi translated">Python开发者沙盒的18种编码工具</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">编写Pythonic代码</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">better编程. pub</p></div></div><div class="pn l"><div class="pu l pp pq pr pn ps lb pe"/></div></div></a></div><h1 id="f77d" class="my mz it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">验证技术</h1><h2 id="e657" class="nz mz it bd na oa ob dn ne oc od dp ni lq oe of nk lu og oh nm ly oi oj no iz bi translated"><strong class="ak">技术#47 </strong></h2><p id="547d" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">代码审查</p><h1 id="dbe3" class="my mz it bd na nb nc nd ne nf ng nh ni ki nj kj nk kl nl km nm ko nn kp no np bi translated">摘要</h1><p id="f696" class="pw-post-body-paragraph lh li it lj b lk nq kd lm ln nr kg lp lq ns ls lt lu nt lw lx ly nu ma mb mc im bi translated">我从Python 3.5和更早版本的同事那里收集了这47种重构技术。这些技术中的大部分在Python 3.9中仍然有效。Python 3.9中包含了其中的一些技术。</p><p id="f72a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">随着我加入你的评论和更多的技巧，我的清单会继续增长。</p><p id="6cdd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我没有提到使用数据类的技术。但是，您可以在以下位置找到讨论:</p><div class="pb pc gp gr pd pe"><a href="https://medium.com/geekculture/nine-dataclass-techniques-for-better-python-code-e56b8aa98d8b" rel="noopener follow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd jd gy z fp pj fr fs pk fu fw jc bi translated">九个@dataclass技术可以获得更好的Python代码</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">我展示了29个用@dataclass替换def类的Python示例。</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">medium.com</p></div></div><div class="pn l"><div class="pv l pp pq pr pn ps lb pe"/></div></div></a></div><p id="ab79" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">继续高效地编码！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/61d6bfa9a36d1e72cf8c707c71f65b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UcgmjntGx_ypwwNC.png"/></div></figure></div></div>    
</body>
</html>