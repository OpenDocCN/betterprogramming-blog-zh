<html>
<head>
<title>Sending Test Results From Protractor/Jasmine to TestRail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将量角器/Jasmine的测试结果发送到TestRail</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/sending-test-results-from-protractor-jasmine-to-testrail-e10dabf9c9bb?source=collection_archive---------7-----------------------#2019-07-08">https://betterprogramming.pub/sending-test-results-from-protractor-jasmine-to-testrail-e10dabf9c9bb?source=collection_archive---------7-----------------------#2019-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2fbc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">记录自动化测试运行的解决方案</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/50aa520461f429634bca663be6444642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLcGpYeTKl-UVJlg1EuaIQ.png"/></div></div></figure><p id="38a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们最近在工作中有一些空闲时间，所以我们致力于解决记录我们的自动化测试运行的问题。</p><p id="3a0d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们认为向我们的利益相关者展示比自动化测试结果的控制台输出更多的东西会更好，所以我们决定使用<a class="ae lq" href="https://www.gurock.com/testrail" rel="noopener ugc nofollow" target="_blank"> TestRail </a>作为我们记录测试用例及其结果的平台。</p><p id="6642" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">TestRail有一个API，我们找到了一个与它交互的库，所以我们决定使用它在自动化测试运行结束时上传结果。</p><p id="1e38" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们只需要创建一个工具，可以在运行后立即自动上传来自<a class="ae lq" href="https://www.protractortest.org/#/frameworks" rel="noopener ugc nofollow" target="_blank">量角器</a> ( <a class="ae lq" href="https://jasmine.github.io/" rel="noopener ugc nofollow" target="_blank">茉莉</a>)的测试结果。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0f28" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">为什么选择TestRail？</h1><blockquote class="mq mr ms"><p id="9969" class="ku kv mt kw b kx ky ju kz la lb jx lc mu le lf lg mv li lj lk mw lm ln lo lp im bi translated">“TestRail帮助您管理和跟踪您的软件测试工作，并组织您的QA部门。其直观的基于web的用户界面使创建测试用例、管理测试运行和协调整个测试过程变得非常容易。”— <a class="ae lq" href="https://www.gurock.com/testrail" rel="noopener ugc nofollow" target="_blank"> <em class="it">测试轨</em> </a>。</p></blockquote><p id="baa5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们选择TestRail是因为它的可定制的测试计划结构、API访问和易用性。这个API给了我们从自定义插件中创建测试运行和发布测试结果的能力。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/cdceb21f383d9ca76548e2883e62bb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hItmd7wSgPie2s7fqpTOVg.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">在TestRail中成功试运行</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0b0c" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">茉莉记者</h1><p id="4070" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">在研究了我们的选项之后，我们发现连接量角器和TestRail的最佳方式是创建一个定制的Jasmine reporter，因为它让我们能够访问所有的测试用例数据和结果。</p><p id="e5a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们继承了<a class="ae lq" href="https://github.com/onury/jasmine-console-reporter" rel="noopener ugc nofollow" target="_blank"> Jasmine控制台报告器</a>,因为它为我们提供了所有必要的功能，我们可以用我们的定制方法升级这些功能。</p><p id="0ed5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它有一个很好的可定制的测试运行控制台输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/e36ffea86eefb8af96b04c8ee62942d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TktPn8zjVbrNe-1Oe3Ia1w.jpeg"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">测试结果显示在控制台报告程序中</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e3ed" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">Jasmine 2测试轨道</h1><p id="a6d5" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">我们通过创建一个定制的Jasmine reporter:Jasmine 2 TestRail解决了我们的(也可能是您的)问题。</p><p id="394c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在<a class="ae lq" href="https://github.com/Slobo989/jasmine-2-testrail" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到:</p><div class="ni nj gp gr nk nl"><a href="https://github.com/Slobo989/jasmine-2-testrail" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">Slobo989/jasmine-2-testrail</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">将量角器与测试轨结合使用的模块。- Slobo989/jasmine-2-testrail</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="36bd" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">启用TestRail API</h1><p id="4908" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">为了使用TestRail API，需要由管理员在您的TestRail <em class="mt">站点设置</em>中启用它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/f022e7593cf4b01f857c35c7e3653473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIuzVi5fbo_WTtRlO59cTA.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">在网站设置中启用API</p></figure><p id="962f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，如果您想使用API认证而不是密码，请在TestRail站点设置中启用API的会话认证，并在您的<em class="mt">用户</em>设置中添加API密钥。我们建议您这样做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/39b6d82f9a7412c53b735b12c86f63b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDQqPgGSP-p7OmURhVPH3A.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">在用户设置中添加API密钥</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="a7c0" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">安装和使用此软件包</h1><p id="0069" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">这个软件包托管在<a class="ae lq" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>上，您可以通过运行npm命令来安装它:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="daa3" class="oh lz it od b gy oi oj l ok ol">npm i jasmine-2-testrail</span></pre><p id="e67f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">报告器必须在配置<br/>之外导入和声明，并包含在量角器配置文件的<code class="fe om on oo od b">onPrepare</code>部分。</p><p id="ff5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您在TestRail中创建新项目时，您可以为您的测试用例组织选择不同的选项。</p><p id="30a6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您需要选择“使用多个测试套件来管理案例”来使我们的插件正确工作，因为特定的项目和套件id是发送测试结果所必需的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/74869ea8bcf7930330385ab3f205a803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfFoWXH_7Dec9jPJ-4fd4w.png"/></div></div></figure><p id="4ab0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在您的量角器配置文件中，您需要导入我们的reporter并添加一个<code class="fe om on oo od b">afterLaunch</code>部分，其中您必须调用<code class="fe om on oo od b">createRun()</code>方法。</p><p id="483d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该方法有3个参数:</p><ul class=""><li id="3229" class="oq or it kw b kx ky la lb ld os lh ot ll ou lp ov ow ox oy bi translated">项目ID(必填)是您在TestRail上创建的项目的ID。</li><li id="544a" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated">Suite ID(必填)是您要从中添加案例的套件的ID。</li><li id="5170" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated"><code class="fe om on oo od b">runName</code>(可选)是将要创建的运行的自定义名称。</li></ul><p id="f3fe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要忘记在<code class="fe om on oo od b">afterLaunch</code>的末尾加上<code class="fe om on oo od b">return new Promise(() =&gt; true)</code>，因为需要它来完整地完成我们的方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="4778" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak">附加参数</strong></h1><h2 id="24fd" class="oh lz it bd ma pg ph dn me pi pj dp mi ld pk pl mk lh pm pn mm ll po pp mo pq bi translated"><strong class="ak">发送结果到测试轨道</strong></h2><p id="45c9" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">如果您不想每次都向TestRail发送结果，也可以添加一个参数。</p><p id="4ea4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在配置文件中，添加:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="e18c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还需要在<code class="fe om on oo od b">if</code>语句中添加<code class="fe om on oo od b">afterLaunch</code>部分的所有内容，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="5845" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这使您能够默认发送结果，如果您愿意，您可以通过运行如下所示的量角器来禁用它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="b2b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">默认情况下，如果不想发送结果，也可以反转这些值(<code class="fe om on oo od b">sendResultsToTestRail: false</code>)。</p><h2 id="aab8" class="oh lz it bd ma pg ph dn me pi pj dp mi ld pk pl mk lh pm pn mm ll po pp mo pq bi translated"><strong class="ak">运行名称</strong></h2><p id="fb5b" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">您可以添加一个参数来命名TestRail中的运行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="7011" class="oh lz it od b gy oi oj l ok ol">protractor conf <strong class="od iu">--</strong>params.runName<strong class="od iu">=</strong>TestRun1</span></pre><p id="4c36" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您没有指定运行名称，它默认为“套件名称+当前日期和时间+自动测试运行”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/62911a0964ccc90d67eb79abffa92f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtdGSO-xQlPbXPQXk-BD_w.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">使用Jasmine 2 Testrail创建的默认名称运行测试</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="a895" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">测试示例</h1><p id="a054" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">必须将来自TestRail的案例ID添加到每个<code class="fe om on oo od b">it()</code>描述的开头，并用冒号— <code class="fe om on oo od b">:</code>与测试名称隔开。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure><p id="16a8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，案例ID是每个测试案例的唯一且永久的ID(例如C125)。它不应该与测试用例ID混淆，后者是在创建新的运行时分配给测试用例的(例如T325)。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="ee7f" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak">失败的测试案例</strong></h1><p id="ba15" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">如果一个或多个测试失败，您可以在新的测试运行中从控制台检查完整的错误信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/c501d6696b50bdf63e177b9245779f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOztydLKaPpzr9lcCAnJRw.png"/></div></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="501b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">。环境文件示例</h1><p id="b886" class="pw-post-body-paragraph ku kv it kw b kx nc ju kz la nd jx lc ld ne lf lg lh nf lj lk ll ng ln lo lp im bi translated">这个文件需要创建在与conf文件相同的目录中。</p><p id="230a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它必须包含您的TestRail的URL、用户名(电子邮件地址)和密码(或API密钥)。该文件需要正确填写所有三个参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pe pf l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="fcca" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">资源</h1><ul class=""><li id="3bcb" class="oq or it kw b kx nc la nd ld pt lh pu ll pv lp ov ow ox oy bi translated"><a class="ae lq" href="https://www.gurock.com/testrail" rel="noopener ugc nofollow" target="_blank">https://www.gurock.com/testrail</a></li><li id="575e" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated">http://docs.gurock.com/testrail-api2/start<a class="ae lq" href="http://docs.gurock.com/testrail-api2/start" rel="noopener ugc nofollow" target="_blank"/></li><li id="75c0" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated">【https://github.com/dlenroc/node-testrail-api T4】</li><li id="0f1f" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated"><a class="ae lq" href="https://www.protractortest.org/#/" rel="noopener ugc nofollow" target="_blank">https://www.protractortest.org/</a></li><li id="9e02" class="oq or it kw b kx oz la pa ld pb lh pc ll pd lp ov ow ox oy bi translated"><a class="ae lq" href="https://github.com/onury/jasmine-console-reporter" rel="noopener ugc nofollow" target="_blank">https://github.com/onury/jasmine-console-reporter</a></li></ul><p id="bb39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢<a class="ae lq" href="https://github.com/markoarsenal" rel="noopener ugc nofollow" target="_blank"> Marko Rajevic </a>帮助编写和发布这个插件。</p></div></div>    
</body>
</html>