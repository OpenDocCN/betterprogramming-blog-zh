<html>
<head>
<title>4 Principles When Refactoring Your Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构函数时的4个原则</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/4-principles-when-refactoring-your-functions-81ce7f365e6d?source=collection_archive---------5-----------------------#2020-10-15">https://betterprogramming.pub/4-principles-when-refactoring-your-functions-81ce7f365e6d?source=collection_archive---------5-----------------------#2020-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="392f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提高代码的可读性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ad30f1dbc35aed22ca8a7dfa28bb2444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CQIpzVh9Kp_OixxU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@saketi11?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历山大·卡尼扎</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄。</p></figure><p id="a33f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个编程项目都以某种方式处理数据。函数是操纵数据的基本组件，使数据可以用数字或图形格式表示。因此，编写好的函数是程序员应该具备的最重要的技能之一。</p><p id="2948" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些初级程序员可能有的一个误解是，有经验的程序员第一次尝试就写出好的函数，这是完全错误的。这可能发生在简单的函数中，但是对于我们在实际项目中编写的大多数函数，在我们说这些函数足够好之前，我们必须编写多个版本。重写函数的过程通常被称为重构——准确地说，是对函数的重构。</p><p id="da8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我敢说，如果你对如何重构函数有很好的判断力(前提是知道什么构成了一个好的函数)，你就可以称自己是一个有经验的程序员。在这篇文章中，我想和你分享一些我用来重构函数的技巧。我希望你会发现它们有用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3db8" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.删除重复</h1><p id="677a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">很多初级程序员的第一个障碍是不知道什么时候重构函数。因此，第一个原则适用于这个问题。重复是需要重构的最明显迹象。出于演示目的，假设我们有以下伪代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码复制</p></figure><p id="8b54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，函数<code class="fe nb nc nd ne b">sayHello</code>和<code class="fe nb nc nd ne b">sayHi</code>之间有重复的代码。这是重构你的函数的好时机。通常你需要做的就是把共享的代码提取出来，让它成为一个函数。因此，第一步将产生以下版本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码复制—重构V1</p></figure><p id="a284" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个版本删除了许多重复的代码。然而，您可能会注意到，<code class="fe nb nc nd ne b">sayHelloV1</code>和<code class="fe nb nc nd ne b">sayHiV1</code>使用稍微不同的字符串作为问候词，输出仍然有一点重复。因此，我们应该考虑以下版本作为更好的重构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码复制—重构V2</p></figure><p id="d316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，我们通过抽象这两个函数之间的所有共享组件来组合<code class="fe nb nc nd ne b">sayHello</code>和<code class="fe nb nc nd ne b">sayHi</code>函数。更重要的是，通过允许用户使用不同于<code class="fe nb nc nd ne b">Hi</code>或<code class="fe nb nc nd ne b">Hello</code>的问候词(例如<code class="fe nb nc nd ne b">Good morning</code>，该功能更加通用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e107" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.保持小规模</h1><p id="e61b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">要遵循的一个重要编程原则是，您希望编写易于更改的代码。你可能听说过脱钩论。想象一个有200块的小型乐高玩具。你不想用胶水来搭建布景，因为所有的部分会紧密地结合在一起，当你决定搭建其他东西时，你几乎不可能重复使用这个布景。</p><p id="c377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了解耦的概念之外，对于函数来说，易变原则的重要含义是保持它们的小。假设您有以下函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个大函数的例子</p></figure><p id="1d7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有显示实际的代码，这只是为了让您对可能的复杂函数有一个概念性的了解。虽然这里没有重复的代码，但是读起来并不容易。除非您为函数的每个组件编写注释，否则单独的目的不会太简单。此外，当你的程序有问题时，你可能不容易调试。考虑以下重构版本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重构的较小函数</p></figure><p id="c97c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段向您展示了重构后的版本。如您所见，我们正在创建更多的函数，每个函数都有可管理的行数。换句话说，这些函数更小，这有以下好处:</p><ul class=""><li id="c786" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">每个功能都有一个目的，其意图非常明确。</li><li id="7a1d" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">更改一个小函数更容易，因为我们将处理一个数据入口点和一个出口点。</li><li id="cb16" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">通过简单地查看单个函数，逻辑更加清晰、结构化。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6380" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.给有意义的名字</h1><p id="5233" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这一点在前面的章节中已经暗示过了。当我们定义一个函数时，首先考虑的通常是如何命名这个新函数。这个阶段不能马虎。毕竟，它是函数中执行操作的代码。</p><p id="20d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，您可能仍然想要负责任，因此您编写了一些注释来指示该函数做了什么。下面显示了一个可能场景的简单示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">名字不清楚</p></figure><p id="1aab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述函数存在两个问题。首先，这个函数不清楚它得到的是什么数据。第二，也不清楚<code class="fe nb nc nd ne b">id</code>对参数意味着什么。有趣的是，程序员试图在评论中解释一切。这是许多初级程序员都会犯的错误:他们试图用注释来部分补充他们的代码。很多场合，真的没必要。考虑以下重构版本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">清除名称</p></figure><ul class=""><li id="634d" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">函数名清楚地表明了函数的用途。</li><li id="de6f" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">参数也应该有有意义的名称。</li></ul><p id="cd2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一节中，我们只讨论给一个函数起一个有意义的名字。但是，应为所有函数指定有意义的名称，并且应考虑以下因素:</p><ul class=""><li id="e8d0" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">目的相似的函数应该有相似的名字。例如，如果一组函数正在获取某种数据，我们可以用以<code class="fe nb nc nd ne b">get</code>开头的方式来命名它们，比如<code class="fe nb nc nd ne b">getUserAccountInfo</code>和<code class="fe nb nc nd ne b">getUserFriendList</code>。</li><li id="d05b" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">不要怕起长名字。现代ide具有自动完成功能。系统将提示您使用适用的变量列表，因此您只需键入几个字母，就可以找到您刚刚给出的所需函数名。记住一个有意义的长名字总是比一个短但不清楚的名字好。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3070" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">4.尽量减少参数的数量</h1><p id="b21b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我不是一个极简主义者，但是我喜欢尽可能地减少参数的数量。它不仅使你的函数声明更加清晰，而且使你的函数易于调用。考虑下面的例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带参数的函数</p></figure><p id="074a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所示，该函数有五个参数，您需要在调用该函数时设置它们。如果您错误地传递了错误的订单，操作将导致数据中的错误。下面这个重构后的版本怎么样？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带参数的函数(重构1)</p></figure><p id="96fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码将相关参数包装在一个字典中，这减少了函数的视觉噪声。函数的调用者很清楚，重构后的函数以字典格式获取用户信息。然而，更常见的是通过创建适当的数据模型来重构函数，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带参数的函数(重构2)</p></figure><ul class=""><li id="254a" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">我们现在有了<code class="fe nb nc nd ne b">User</code>类来为用户捕获相关信息，而不是使用字典。</li><li id="fca4" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">我们在构造函数之外留了一些可选的信息(比如<code class="fe nb nc nd ne b">phone number</code>)，为用户创建提供一些灵活性。此外，它降低了施工方法的噪音。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a815" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="afe9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我们回顾了在重构代码时可以尝试实现的四个基本原则。如果您在代码中遇到许多bug，不要感到沮丧。这正是你学习提高编程技能的方法——通过犯错误和改正错误。重构是贯穿整个项目过程的持续过程。</p><p id="52de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">培养你的编码技能需要时间。对自己要有耐心。</p></div></div>    
</body>
</html>