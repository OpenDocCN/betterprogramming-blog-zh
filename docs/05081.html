<html>
<head>
<title>How Recoil Got Me Excited About the Future of State Management in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反冲如何让我对React中状态管理的未来感到兴奋</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-recoil-js-got-me-excited-about-the-future-of-state-management-in-react-f07ce57af681?source=collection_archive---------0-----------------------#2020-06-07">https://betterprogramming.pub/how-recoil-js-got-me-excited-about-the-future-of-state-management-in-react-f07ce57af681?source=collection_archive---------0-----------------------#2020-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6729" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">反冲入门</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7843878571a0e78f111f1aa7ccf216dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qpiQHR4QXbCDtbdb.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">归属:由pikisuperstar创建的背景向量—<a class="ae ky" href="http://www.freepik.com/" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></p></figure><p id="25ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">围绕前端开发，尤其是React前端开发的领域每天都变得越来越令人兴奋。<br/>大约一个月前，脸书软件工程师Dave McCabe开源了React的新状态管理库。</p><p id="98f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没错，伙计们，这个新的家伙叫做<a class="ae ky" href="https://recoiljs.org" rel="noopener ugc nofollow" target="_blank">后座力</a>。它是直接从React的厨房出来的，看起来它会留在这里。很刺激，对吧？</p><p id="a474" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一个反应过激的人，你可能已经听说过它，甚至尝试过一点。对于那些还没有，让我给你一些快速的琐事:</p><ul class=""><li id="657c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">反冲是一个React的状态管理库。</li><li id="ba83" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它仍然被认为是实验性的(不是生产就绪)。当前版本是0.0.8。</li><li id="d76e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它基于React的所有最新产品，如<a class="ae ky" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">钩子</a>和<a class="ae ky" href="https://reactjs.org/docs/concurrent-mode-suspense.html" rel="noopener ugc nofollow" target="_blank">悬念</a>，甚至还准备好支持并发模式(至少根据文档来看是这样的)。</li><li id="76bc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">这个库很小，很快，而且基本上没有样板文件。</li></ul><p id="3c06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望我现在已经引起你的注意了。好了，闲聊够了，让我们看看整个大惊小怪是怎么回事，并检查它是如何工作的。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="e5df" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">首先，设置</h1><p id="d90f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">当然，第一步是安装库。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="786d" class="ns mr it no b gy nt nu l nv nw">npm i recoil</span></pre><p id="26da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="a13b" class="ns mr it no b gy nt nu l nv nw">yarn add recoil</span></pre><p id="e3d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我已经提到的，反冲被开发成无样板文件，并且非常容易上手。请看:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/257e3740ed747c6ac3e4b7939def48a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*5bHeszPqs2vlhTW8.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">反冲设置</p></figure><p id="2d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是在您的项目中设置和启动它是多么容易。</p><p id="c490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我已经向你展示了设置反冲的最常见的方法，这是在你的应用程序的根组件中，所以全局状态将在你的应用程序的任何地方可用。但是你可以选择用<code class="fe ny nz oa no b">&lt;RecoilRoot&gt;</code>只包装应用程序的一部分，并且只在你需要的地方使用全局状态。很酷，对吧？</p><p id="238e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，这就是你需要知道的关于设置的所有内容，所以下一站:原子。</p><p id="ad6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一切都从单个原子开始。我喜欢反冲让我在开发过程中使用所有的化学和宇宙隐喻。这只会让一切听起来更酷。</p><p id="41c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，对，原子…</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="ddab" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">什么是原子？</h1><p id="b778" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">原子基本上是保存你的状态的东西，是你定义并赋予你初始状态的单元。您可以显式地订阅组件来监听atom状态的任何变化。一旦你这样做了，你的组件将在每次状态更新时重新呈现。一旦您使用反冲钩子从您的原子状态中读取或写入，就会发生对原子的订阅。</p><p id="9b12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如何创建原子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ea476a48d92639cdc4796a4ffeda4032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/0*PCzK-SJ7ZaKqajAK.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单的原子例子</p></figure><p id="4799" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，这真的很简单。我们有一个惟一的键用于状态的持久化，并区分应用程序可能具有的多个atom状态，还有一个默认值，顺便说一下，它是可选的。</p><p id="6979" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，原子可能有更复杂的结构。默认值可以保存一组不同类型的值，甚至可以保存一个返回动态数据的异步函数，但稍后会详细介绍。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="08df" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">我们如何在组件中使用原子？</h1><p id="e7b8" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">别担心，制造一个原子就像制造一个原子一样容易。谢天谢地，反冲有一套很好的预定义钩子，如果需要的话，可以让我们读写原子。<br/>以下是你可能会用到的最常见挂钩的快速列表:</p><ul class=""><li id="2ba3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe ny nz oa no b">useRecoilState(state</code>)，它是<code class="fe ny nz oa no b">React.useState()</code>的孪生兄弟——您有状态值和一个覆盖您当前状态的设置器。</li><li id="41ad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ny nz oa no b">useRecoilValue(state </code> —使用这个钩子，你只接收你所在州的当前值。使用这个钩子的组件自动订阅状态的任何变化。</li><li id="99b0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ny nz oa no b">useSetRecoilState(state)</code> —顾名思义，这个钩子只用于更新状态值，而不读取它。</li></ul><p id="5da6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，够干理论了。我们来看几个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/4bc30b838d217a64c10f9fba7fcec520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Advt1u4GYqDbDUro.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">useRecoilState示例</p></figure><p id="123d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我已经提到的，<code class="fe ny nz oa no b">useRecoilState</code>的用法和<code class="fe ny nz oa no b">React.useState()</code>一样。我相信你们很多人已经知道它是如何运作的了。在这个例子中，<code class="fe ny nz oa no b">greetMessage</code>保存了原子的当前状态，我们只能读取，而使用<code class="fe ny nz oa no b">setGreetMessage</code>，我们可以更新状态的值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/0079d268c4b968b97dc9b4a7ac2046a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eFZUgmQ4C35GHx2-.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">useRecoilValue和useSetRecoilState示例</p></figure><p id="54ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，反冲提供的下两个钩子，<code class="fe ny nz oa no b">useRecoilValue</code>和<code class="fe ny nz oa no b">useSetRecoilState</code>，是<code class="fe ny nz oa no b">useRecoilState</code>的一种析构版本。</p><p id="c472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe ny nz oa no b">useRecoilValue</code>，我们接收原子的当前状态，并将其赋给<code class="fe ny nz oa no b">greetMessage</code>变量。在这里提到<code class="fe ny nz oa no b">/</code>是一个只读变量可能会更好，这意味着我们不能以任何方式覆盖它。为了做到这一点，我们需要<code class="fe ny nz oa no b">/</code>钩子，在它的帮助下，我们可以覆盖或改变状态。</p><p id="b7ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想在这里补充一点，反冲对我们改变原子现有状态的方式是非常严格的。这只能以几种明确定义的方式发生，其中一种你已经看到了，在反冲钩的帮助下。在我们讨论选择器的时候，我还想给你们展示另一种方式。</p><p id="ee93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了清楚起见，我想指出的是，在官方页面上记录了另外四个反冲钩，但是由于我到目前为止还没有使用过它们，所以我没有在示例中包括它们中的任何一个。更多信息请参考<a class="ae ky" href="https://recoiljs.org/docs/api-reference/core/useResetRecoilState" rel="noopener ugc nofollow" target="_blank">文件</a>。</p><p id="292d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候看看这个难题的最后一个主要部分了:选择器。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="ff38" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">什么是选择器？</h1><p id="3e67" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">根据文件:</p><blockquote class="oe of og"><p id="24fb" class="kz la oh lb b lc ld ju le lf lg jx lh oi lj lk ll oj ln lo lp ok lr ls lt lu im bi translated"><em class="it">"选择器</em>代表一个功能，或反冲中的派生状态。你可以把它们想象成一个没有副作用的‘纯函数’，对于一组给定的依赖值，它总是返回相同的值。”</p></blockquote><p id="0683" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我第一次阅读选择器的定义时，它并没有马上给我留下印象，但是当我玩了一会儿后，它变得更清楚了，选择器是一种辅助功能，你可以用它来导出/计算你的当前状态，甚至在你需要的时候改变它。</p><p id="8033" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一如既往，我觉得举个例子会让事情更容易理解。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/3c41e6fba622ef520cce31fe83020659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B_uV2xR2BLiD7HP6.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单选择器示例</p></figure><p id="dfba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧，那我们这里有什么？让我们从上到下阅读文件:</p><ul class=""><li id="e017" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">首先，我们从反冲导入选择器。</li><li id="8399" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后，我们导入原子<code class="fe ny nz oa no b">greetings</code>持有的当前状态。</li><li id="f411" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后我们定义我们的选择器<code class="fe ny nz oa no b">greetingsMike</code>并用它做一些魔术。</li></ul><p id="ee78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，选择器有点像原子。我们有一个键，它也应该是一个惟一的值，但是这里我们有一个getter，而不是缺省值。从示例中可以看出，getter用于获取<code class="fe ny nz oa no b">greetings</code>原子的当前状态。我们使用当前状态的结果来返回一个新的问候；在这种情况下，返回值将是字符串“Hello Mike”</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a0ad" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">如何在我们的组件中使用选择器</h1><p id="6bf1" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">选择器利用了我们在atom上使用的同一套反冲钩。正如你将看到的，它在我们的组件中的使用方式与原子相似。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/841939304565e7c29cd052f4354eaabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Uq6Y9xN1YR-L7g1J.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单选择器示例</p></figure><p id="bf28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了之前在<code class="fe ny nz oa no b">&lt;Hello&gt;</code>组件中的内容之外，<br/>现在我们导入新创建的选择器并投入使用。当我们看到这个组件的输出时，我们将看到一个输入字段，默认值为Hello，问候消息为“Hello Mike”</p><p id="c8b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每次我们改变输入字段的值时，问候消息文本也会改变，因为在我们的选择器中，我们通过getter读取当前状态，还记得吗？</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9103" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">如何通过选择器覆盖和改变状态</h1><p id="fdd7" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">实际上，这很简单。这里有一个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/4031e6a9355132be77898d7feb359cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kd1SKS3Ht5hXaLul.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单选择器示例</p></figure><p id="776e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们有相同的选择器设置，唯一的区别是，这次我们没有使用getter，而是使用了选择器的其他内置功能:setter。</p><p id="f29a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会注意到我们在这里不仅析构了setter，还析构了我们一分钟前用过的getter。原因是我们仍然需要原子持有的当前状态，因此我们可以相应地读取和更新它。</p><p id="d051" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，我们使用getter做了与上例完全相同的事情，但是这次我们使用set方法直接改变状态。</p><p id="c442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到，为了做到这一点，我们作为第一个参数传递保存我们状态的原子，作为第二个参数，传递我们希望作为状态的更新的greet版本。</p><p id="5f1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">厉害！最后但同样重要的是，我将向您展示一些原子和选择器的异步示例。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="c4e4" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">原子和选择器的异步示例</h1><p id="2d72" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">实际上，在下面的例子中，您会注意到原子和选择器中的异步回调看起来非常相似。</p><p id="c9d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这次我将使用我最近参与的另一个示例项目:一个简单的应用程序，它接受用户输入并从该输入中获取Giphys。</p><p id="dddb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个<code class="fe ny nz oa no b">CodeSandbox</code> <a class="ae ky" href="https://codesandbox.io/s/giphy-search-no-api-key-tv4o2" rel="noopener ugc nofollow" target="_blank">链接</a>到这个项目，可以查看和使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/c7f85fbd6f744f1482a08e321c9b250f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QfyhvuzqKBIF-WOo.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">异步选择器示例</p></figure><p id="9e0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">快速浏览文件:</p><ul class=""><li id="86ef" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">首先，我们导入我们的<code class="fe ny nz oa no b">searchStringState</code> atom，正如您可能已经猜到的，它保存用户输入的搜索字符串。</li><li id="7e53" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">接下来，我们使用的getter位于获取Giphys的异步回调函数中。</li><li id="40cf" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">最后一步，我们返回API调用的结果。</li></ul><p id="574a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是呈现提取的Giphys的组件的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/82c92623aa387379cc351fc95f316c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PWI02DoKEKxCm1zQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">异步选择器示例</p></figure><p id="cfcd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我所承诺的，这个概念非常简单易懂。在上面的例子中只有一个问题:如果我们现在尝试渲染<code class="fe ny nz oa no b">GetGiphy</code>组件，我们将会看到下面的输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/417a1d7c48fce44e80c14efea9aecfd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yWrGBpSDOAweGYEW.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">暂停错误信息</p></figure><p id="8b51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们在选择器或atom中使用异步回调时，使用它们的父组件应该用一个悬念回退元素包装。多酷啊！在这里，我们可以清楚地看到，反冲实际上已经在使用React的最新功能，这些功能已经深入集成到库中。</p><p id="a472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们如何利用atom，它异步获取一些资源。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/0aa84ef73652315a1559ae8215a67495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HtM3fRXp8Ez94rsC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">异步原子</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="ad7b" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">关于反冲的最后的话和想法</h1><p id="de65" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我花在玩反冲的时间产生了一个小游戏<br/>，我称之为Brain-teaser，这是一个概念验证应用程序，我试图快速测试反冲到底能做什么。</p><p id="d310" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在<a class="ae ky" href="https://github.com/Squiff88/BrainTeaser" rel="noopener ugc nofollow" target="_blank"> Github </a>上随意检查和使用它，或者在这里试用部署版本<a class="ae ky" href="https://stoic-wiles-a05a55.netlify.app/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a6ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我目前的最好成绩是20秒——试着打破它！</p><p id="c4a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我尽量避免与我们周围的其他状态管理库进行任何直接的比较。我的观点是，根据不同的用例，不同的库可能比其他库有优势，有几个可供选择是很好的。</p><p id="bde4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我真正喜欢反冲的是它感觉非常快，很容易上手，对我来说最重要的是，它真的经过了微调，为React量身定制。我可以很容易地将反冲视为<a class="ae ky" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">语境AP </a> I和<a class="ae ky" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>之间的一线希望。</p><p id="7435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与Redux相比，学习曲线相对适中，更不用说随后的所有设置和样板文件，但仍然感觉它可以很好地处理更大和更复杂的应用程序，这通常是与上下文API的斗争。</p><p id="0a6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，这个图书馆给人的感觉还是很年轻，文档也不是很全面——它们甚至到处都不见了。尽管如此，我对反冲感觉非常积极，我期待着看到这个项目将如何随着时间的推移而发展。</p><p id="7bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我这边就这样。祝编码愉快！</p></div></div>    
</body>
</html>